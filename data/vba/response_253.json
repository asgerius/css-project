[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1573683600, "post_id": 58846382, "comment_id": 103966645, "body": "You can change the size of the cell comments (manually or with code), but there is no event that is triggered."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573684437, "post_id": 58846382, "comment_id": 103966969, "body": "So no way to change the size of the comment each time I edit the text, aside from what Excel does when autosize = true?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1573684480, "post_id": 58846382, "comment_id": 103966984, "body": "If you could also edit (even just enter/exit a cell itself), you could use the <code>Worksheet Change()</code> function."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573684503, "post_id": 58846382, "comment_id": 103966988, "body": "You could include code to change the size of the comment box for the cell when the content of the cell itself changes, but I dont see how that would do you much good."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1573685011, "post_id": 58846382, "comment_id": 103967165, "body": "Any way to rig it so that when I exit the comment (escape twice) it automatically jumps into and out of the parent cell?  Otherwise I have to hit escape twice, then F2, then enter every time."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573685156, "post_id": 58846382, "comment_id": 103967221, "body": "Maybe you could make a UserForm for comment editing that does a bunch of things when you click OK on the form? Granted, it&#39;s a bit more work..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573693603, "post_id": 58846382, "comment_id": 103969250, "body": "You might be able to use the <code>SelectionChange</code> event, but it&#39;ll still be a bit of a hack."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1573696176, "creation_date": 1573696176, "answer_id": 58848223, "question_id": 58846382, "link": "https://stackoverflow.com/questions/58846382/how-to-trigger-macro-when-comment-is-modified/58848223#58848223", "title": "How to trigger macro when comment is modified?", "body": "<p>You could do something along these lines, its a bit clunky as not fully tested as late here now :)</p>\n\n<pre><code>Dim rPrev As Excel.Range\nDim sPrev As String\nDim cPrev As Comment\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nIf Not rPrev Is Nothing Then\n    If Not cPrev Is Nothing Then\n        cPrev.Shape.Width = Len(rPrev.Comment.Text) * 5\n    End If\nEnd If\n\nSet rPrev = Target\n\nIf Not Target.Comment Is Nothing Then\n    Set cPrev = Target.Comment\n    sPrev = cPrev.Text\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573696176, "creation_date": 1573682922, "question_id": 58846382, "link": "https://stackoverflow.com/questions/58846382/how-to-trigger-macro-when-comment-is-modified", "title": "How to trigger macro when comment is modified?", "body": "<p>Is there a way to trigger a macro that would resize comments (I don't like the way autosize=true is doing it) whenever a comment is modified in Excel?  Everything I'm reading says comment changes won't trigger any type of worksheet change event.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1573680610, "post_id": 58845897, "comment_id": 103965422, "body": "Where do you determine <code>LastRow</code>? Note - no need for <code>FillDown</code>, you can write the formula to the entire range in one line."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573681635, "post_id": 58845897, "comment_id": 103965862, "body": "If <code>LastRow</code> has no value, then <code>Range(&quot;B1:B&quot;)</code> isn&#39;t a valid range expression that Excel can parse, so you get error 1004. If it&#39;s declared as a <code>Long</code> but wasn&#39;t assigned, then you get <code>Range(&quot;B1:B0&quot;)</code> and that isn&#39;t a valid range expression either."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 12203043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a195f23264bea1789d667bc731abad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan S", "link": "https://stackoverflow.com/users/12203043/ryan-s"}, "edited": false, "score": 0, "creation_date": 1573744725, "post_id": 58845979, "comment_id": 103991162, "body": "This works perfectly! Thanks Scott. and thanks for the lesson on the formula!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1573680944, "creation_date": 1573680944, "answer_id": 58845979, "question_id": 58845897, "link": "https://stackoverflow.com/questions/58845897/apply-formula-and-filldown-on-each-sheet/58845979#58845979", "title": "apply formula and FillDown on each sheet", "body": "<p>As the comment stated, <code>LastRow</code> is not declared or given a value.</p>\n\n<p>Also the <code>FillDown</code> is not needed, and neither is the IF part of the formula:</p>\n\n<pre><code>Dim sht As Worksheet\nFor Each sht In ThisWorkbook.Worksheets\n    Dim LastRow As Long\n    LastRow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\n    sht.Range(\"B1:B\" &amp; LastRow) = \"=A1=EOMONTH(TODAY(),-1)\"\nNext sht\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12203043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a195f23264bea1789d667bc731abad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan S", "link": "https://stackoverflow.com/users/12203043/ryan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58845979, "answer_count": 1, "score": 0, "last_activity_date": 1573686621, "creation_date": 1573680510, "last_edit_date": 1573686621, "question_id": 58845897, "link": "https://stackoverflow.com/questions/58845897/apply-formula-and-filldown-on-each-sheet", "title": "apply formula and FillDown on each sheet", "body": "<p>I am trying to apply a formula to an entire column (B) in all sheets but just as far down as there is data in column A. I was trying the Filldown formula and am running into: </p>\n\n<blockquote>\n  <p>Related to Error 1004:</p>\n</blockquote>\n\n<p><code>Range(\"B1:B\" &amp; LastRow).FillDown</code></p>\n\n<p>Full Macro:</p>\n\n<pre><code>Dim sht As Worksheet\nFor Each sht In ThisWorkbook.Worksheets\nRange(\"B1\") = \"=IF(A1=EOMONTH(TODAY(),-1),TRUE,FALSE)\": Range(\"B1:B\" &amp; LastRow).FillDown\nNext sht\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1573684729, "post_id": 58845842, "comment_id": 103967071, "body": "if this is under the Worksheet_Chage event in the Worksheet you will want to use <code>If Not Intersect(Target, me.place range here)) Is Nothing Then</code> syntax.  Hopefully that will get you pointed in the right direction."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573684797, "post_id": 58845842, "comment_id": 103967094, "body": "First of all, you cannot change the name of a <code>Worksheet_Change</code> event.  You can use the drop-downs in the editor to get it correct.  Secondly, <code>Option Explicit</code> goes above the subroutine.  You can read about the change event here <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.worksheet.chan&zwnj;&#8203;ge</a>"}, {"owner": {"reputation": 31, "user_id": 10177128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53cd9fdb880b610d6992e68a943d50de?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremie Tomkins", "link": "https://stackoverflow.com/users/10177128/jeremie-tomkins"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573702369, "post_id": 58845842, "comment_id": 103971144, "body": "@Darrell H Right, the sub was just called Worksheet_Change, but I chose it in the drop down list. And I&#39;ll check out the Option Explicit  information"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573702801, "post_id": 58845842, "comment_id": 103971244, "body": "You may have chosen from the drop-down, but you edited out all the information in parentheses, which won\u2019t work.  If you read the link, you will find that <code>Target</code> is the range that determines what changed."}], "owner": {"reputation": 31, "user_id": 10177128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53cd9fdb880b610d6992e68a943d50de?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremie Tomkins", "link": "https://stackoverflow.com/users/10177128/jeremie-tomkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573680486, "creation_date": 1573680253, "last_edit_date": 1573680486, "question_id": 58845842, "link": "https://stackoverflow.com/questions/58845842/worksheet-change-event-vba-with-if-and-indexing", "title": "Worksheet Change event? VBA with If and Indexing", "body": "<p>I need to accomplish the following:</p>\n\n<blockquote>\n  <ol>\n  <li>Capture changes in column I, where, if cell value in that column goes over a number, then index/match cell in column G and cut and paste it in the T column, starting at T13. (strictly the value of the cell only, not the formula). </li>\n  </ol>\n</blockquote>\n\n<p>I have formulas in columns G-N, which rely on the existence of a value in the G column. So once the macro gets triggered to cut the cell from column G, all rows from G-N will also delete.</p>\n\n<p>Maybe this is a <code>worksheet_change</code> event, but how can it detect numerous cell changes and keep track? Also not sure about the condition and index. Below is what I have so far: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Worksheet_Change()\n    Option Explicit\n\n    Dim C As Range\n    Dim G As Range\n\n    Set C = Range(\"I2:I615\")\n    Set G = Range(\"G2:G615\")\n\n    If Application.WorksheetFunction.CountIf(C) &gt; (\"U5\") Then\n        rowNum = Application.WorksheetFuntion.Match(G, C, 0).CutRange(\"U5:U\" &amp; Range(\"U65536\").End(xlUp).Row)\n    End If\n\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formatting", "conditional-formatting"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573679994, "post_id": 58845773, "comment_id": 103965143, "body": "Is conditional formatting not an option? &quot;with a red or yellow color&quot; - how do you choose between red or yellow?"}, {"owner": {"reputation": 1, "user_id": 12369289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b229031ae7283c10f49e7070f0de4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/12369289/kevin"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573680382, "post_id": 58845773, "comment_id": 103965309, "body": "I haven&#39;t been able to write a formula that works.  I believe it is finding the correct syntax to complete an if than statement.  I am unfamiliar with VB for a macro and excel syntax to write a working format.  It doesn&#39;t have to be red or yellow both just one to call out a cell.  If B12 has data I need the operator to also enter information into c12.  Something to call the attention to operator that there is a missing data point."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573680477, "post_id": 58845773, "comment_id": 103965363, "body": "The formula you need is <code>=AND(B12&lt;&gt;&quot;&quot;,C12=&quot;&quot;)</code>."}, {"owner": {"reputation": 1, "user_id": 12369289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b229031ae7283c10f49e7070f0de4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/12369289/kevin"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573821763, "post_id": 58845773, "comment_id": 104021965, "body": "Thank you! That was pretty easy.  I wasn&#39;t using the AND formula and probably trying to over complicate it.  Thanks a bunch"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1573680632, "creation_date": 1573680632, "answer_id": 58845916, "question_id": 58845773, "link": "https://stackoverflow.com/questions/58845773/formatting-a-cell-based-on-another-cell-having-data/58845916#58845916", "title": "Formatting a cell based on another cell having data", "body": "<p>Use a conditional formatting rule based on the formula:</p>\n\n<pre><code>=AND(B12&lt;&gt;\"\",C12=\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2gKRB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2gKRB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 12369289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b229031ae7283c10f49e7070f0de4c3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/12369289/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606984589, "creation_date": 1573679973, "last_edit_date": 1606984589, "question_id": 58845773, "link": "https://stackoverflow.com/questions/58845773/formatting-a-cell-based-on-another-cell-having-data", "title": "Formatting a cell based on another cell having data", "body": "<p>I am looking to do the following:</p>\n<p>If B12 contains any data and C12 is blank fill in C12 with a red or yellow color.</p>\n<p>If B12 is blank then C12 also stays clear/Blank.</p>\n"}, {"tags": ["vba", "api", "ms-access", "events", "handler"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "edited": false, "score": 0, "creation_date": 1573733925, "post_id": 58853837, "comment_id": 103984731, "body": "Kostas K. I am very grateful for the trouble you have taken over this. The code I am using to dial out from Zoiper, which works fine, is as follows: ``` Set il = CreateObject(&quot;idefisk.IdefiskAPI&quot;) strTarget = txtTelNo il.Dial txtTelNo, &quot;&quot; ``` However, I do not think my Zoiper class is correct and we are making no mention of the Idefisk.IdefiskAPI anywhere in the code to find the caller number. If the Wrapper Class is dependent on the Zoiper Class being correct, I have a feeling that that is where the problem is."}, {"owner": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "edited": false, "score": 0, "creation_date": 1573733946, "post_id": 58853837, "comment_id": 103984741, "body": "In the Wrapper Class that I have called ZoiperWrapper should the  ``` Private WithEvents objZoiper As Zoiper be Private WithEvents objZoiper As Idefisk.IdefiskAPI ``` I am just so confused. Thanks again for all your help."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "edited": false, "score": 0, "creation_date": 1573734476, "post_id": 58853837, "comment_id": 103984993, "body": "I&#39;m not familiar with the API to be honest with you, I just wanted to point out that you need to create an instance of the object and listen to its events. Then the wrapper should raise an event for the view to be updated. Try changing to <code>Idefisk.IdefiskAPI</code> and see if that works."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "edited": false, "score": 0, "creation_date": 1573734706, "post_id": 58853837, "comment_id": 103985107, "body": "The wrapper in just a middle man between the UI and the API. Send commands to dial but also capture and propagate events the API raises."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1573725108, "creation_date": 1573725108, "answer_id": 58853837, "question_id": 58845682, "link": "https://stackoverflow.com/questions/58845682/event-handler-for-api-call/58853837#58853837", "title": "Event Handler for API call", "body": "<p>I haven't worked with the API, nor I have the API installed, so this is just a suggestion. </p>\n\n<p>Try to build a wrapper around Zoiper and listen to its <code>OnLineStateEvent</code>. Then if the <code>state</code> is <code>lsRinging</code>, raise the wrapper's event in order to update the UI.</p>\n\n<p><strong>Important:</strong>\nYou need to replicate the <code>TLineState</code> enum as per the api's documentation. The values should match in order to be able to compare the state.</p>\n\n<p>In this example, I haven't defined any values, so <code>lsDown</code> equals to 0, <code>lsDialing</code> equals to 1 etc, but as I said, the numeric values behind the enum should match the api in order to be able to compare them.</p>\n\n<p>The <code>TLineState</code> enum:</p>\n\n<pre><code>Public Enum TLineState\n    lsDown\n    lsDialing\n    lsActive\n    lsRinging\n    lsWaitForAnswer\n    lsUp\n    lsResolvingPort\nEnd Enum\n</code></pre>\n\n<p>Our wrapper class. </p>\n\n<pre><code>Option Explicit\nPublic Event RingingEvent(ByVal calledId As Long)\n\nPrivate WithEvents objZoiper As Zoiper\n\n' Zoiper OnLineStateEvent.\n' Listen to it and raise our RingingEvent if the state is 'lsRinging'\nPrivate Sub objZoiper_OnLineStateEvent(ByVal state As TLineState, ByVal callerid As Long)\n    If state = TLineState.lsRinging Then\n        RaiseEvent RingingEvent(callerid)\n    End If\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    Set objZoiper = New Zoiper\nEnd Sub\nPrivate Sub Class_Terminate()\n    Set objZoiper = Nothing\nEnd Sub\n</code></pre>\n\n<p>The form which our wrapper class resides. </p>\n\n<p>Create an instance of the wrapper class when the form loads, and destroy it when it closes. You can change that behavior as per your needs.</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents objWrapper As ZoiperWrapper\n\nPrivate Sub Form_Load()\n    Set objWrapper = New ZoiperWrapper\nEnd Sub\n\nPrivate Sub Form_Close()\n    Set objWrapper = Nothing\nEnd Sub\n\nPrivate Sub objWrapper_RingingEvent(ByVal calledId As Long)\n    txtCallerNumber.Value = calledId\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593731928, "creation_date": 1573679549, "last_edit_date": 1593731928, "question_id": 58845682, "link": "https://stackoverflow.com/questions/58845682/event-handler-for-api-call", "title": "Event Handler for API call", "body": "<p>We are using an old version of Zoiper Biz that uses an old api, not the current zoiper one. I am trying to code a handler, in Ms Access vba, that when zoiper rings, the handler will give the caller id that can then be used to call up the customer details and display them in a form.</p>\n\n<p>The problem I am having, is telling the handler to listen for a change to the API's OnLineStateEvent. I can use the API to make a call from the database and I can use the API to answer the call, I just cannot find a way to trap the caller id.</p>\n\n<p>The passage from the API documentation that relates to OnLineStateEvent is as follows:</p>\n\n<p>OnLineStateEvent - (line: integer; state: TLineState; accountname: string;\nformat: TCodecs; callerid: string; releasecause: integer) - the line state\nevent is fired when a line changes its state and provides the line, the new\nstate, the account used for the call, the format that is used for the call,\nthe callerid and the release cause if the new state is lsDown. </p>\n\n<p>TLineState as as follows:</p>\n\n<p>TLineState - this enum type is used to hold one of the line state constants and\nrepresents the current state of a given line. It is used with the information\nevents and cannot be set to a line.</p>\n\n<p>\u21d2 The Line state constants are as follows:\n\u2022 lsDown - there is no call on the line. Also indicates that a call has ended.\n\u2022 lsDialing - the line is dialing but still no meaningful state.\n\u2022 lsActive - the line is active i.e. has voice activity from the remote side\n(probably IVR or some server side ringing sounds), but the call is not\nanswered.\n\u2022 lsRinging - there is an incoming call on the line.\n\u2022 lsWaitForAnswer - the outgoing call is ringing on the remote side.\n\u2022 lsUp - the call is on, both sides are hearing each other. This is the only\ncall state that can be transferred and put on hold.\n\u2022 lsResolvingPort - resolving STUN port. </p>\n\n<p>I have attempted to write a class called Zoiper to handle the line state event.</p>\n\n<pre><code>\nOption Explicit\nPublic Event LineStatus(ByVal state As String, ByVal callerid As String)\n\nPublic Ring As String\nPublic ThisCallerID As String\n\nPublic Function MyEventHandler(state, callerid)\n    If state = \"IsRinging\" Then\n        ThisCallerID = callerid\n    End If\n    MyEventHandler = ThisCallerID\n    RaiseEvent LineStatus(state, callerid)\nEnd Function\n</code></pre>\n\n<p>The calling function is as follows:</p>\n\n<pre><code>Private Sub cmdAnswer_Click()\nStop\nSet il = CreateObject(\"idefisk.IdefiskAPI\")\nDim Listener As Zoiper\nSet Listener = New Zoiper\n\nWith Listener\n    .MyEventHandler(state, callerid) = il.OnLineStateEvent(state, callerid)\nEnd With\n\nIf Listener.Ring = \"IsRinging\" Then\n    Me.txtCallerNumber = Listener.ThisCallerID\nEnd If\n\n'il.answer 0\n\nEnd Sub\n</code></pre>\n\n<p>cmdAnswer_click falls over when it gets to .MyEventHandler(state, callerid) = il.OnLineStateEvent(state, callerid) with object does not support this property or method, which I guess is relating to the il.OnLineStateEvent(state, callerid).</p>\n\n<p>il.Answer 0 is remmed out as I don't want it to answer the call until I have sorted this out.</p>\n\n<p>I have changed so many lines of code so much that I cannot remember what I have tried and what I haven't.\nIf anyone could please point me in the right direction I would be so grateful.</p>\n"}, {"tags": ["vba", "com", "setup-deployment"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573680227, "post_id": 58845604, "comment_id": 103965240, "body": "You can&#39;t have that, MSCOMCTL.OCX isn&#39;t a redistributable library. Also it won&#39;t work in 64-bit VBA hosts."}, {"owner": {"reputation": 107, "user_id": 6238085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Hw6oA.jpg?s=128&g=1", "display_name": "Paul LeDuc", "link": "https://stackoverflow.com/users/6238085/paul-leduc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573737287, "post_id": 58845604, "comment_id": 103986660, "body": "So, is there a 64 bit version of the control available?  Or is there an alternative library I should be utilizing?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573738802, "post_id": 58845604, "comment_id": 103987521, "body": "There isn&#39;t... it&#39;s a VB6 control library. Depending on what you&#39;re trying to do, consider making your UI in C# with modern tech (WinForms, WPF/XAML), and exposing a presenter and your model to VBA/COM; then if you follow modern UI patterns (not have all the logic in the form&#39;s code-behind) you can have VBA code providing/receiving data to/from the .NET UI."}], "owner": {"reputation": 107, "user_id": 6238085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Hw6oA.jpg?s=128&g=1", "display_name": "Paul LeDuc", "link": "https://stackoverflow.com/users/6238085/paul-leduc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573679232, "creation_date": 1573679232, "question_id": 58845604, "link": "https://stackoverflow.com/questions/58845604/properly-create-setup-msi-for-excel-application", "title": "Properly create Setup/MSI for Excel Application", "body": "<p>I have an Excel 2016 solution that contains C# COM components as part of the deployment.  I am able to get the COM components to register OK.  However, there were a couple controls that were used, that existed on the development system that need to package as well.</p>\n\n<p>TreeView and ListView controls are added in the references in the VBA IDE.  It referenced MSCOMCTL.OCX.  I have added this file as a dependency in the installer.  However, the installation fails to register the file.  I suspect that there may be additional dependencies I am missing?  </p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1573679456, "post_id": 58845524, "comment_id": 103964909, "body": "You don&#39;t have a reference to the <code>ie</code> object in BarcodeDetailYesterday. You either need to create a new object, or pass the existing reference to the BarcodeDetailYesterday sub."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1573687387, "post_id": 58845524, "comment_id": 103967841, "body": "Are those fields in an ieframe?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12369158"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1574100775, "post_id": 58845524, "comment_id": 104102447, "body": "@RyanWildry I was concerned about that, but the ie.navigate &quot;new url&quot; works regardless, so why would .navigate work but .document.getelementbyid not work?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1574101251, "post_id": 58845524, "comment_id": 104102633, "body": "Neither should, you don&#39;t have a reference to that object unless it is declared globally, but that isn&#39;t indicated in the code. Are you sure it isn&#39;t navigating in <code>websiteLogin</code> and not <code>BarcodeDetailYesterday</code>?"}], "owner": {"user_type": "does_not_exist", "display_name": "user12369158"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573678777, "creation_date": 1573678777, "question_id": 58845524, "link": "https://stackoverflow.com/questions/58845524/browser-document-getelementbyidelement-name-value-failing", "title": "Browser.document.getElementById(&quot;element_name&quot;).Value Failing", "body": "<p>So, my question is related to a method call that works in one part of the code and not in another.</p>\n\n<p>I have some globally declared things and then 3 subs. Here's the global</p>\n\n<pre><code>Declare Function apiShowWindow Lib \"user32\" Alias \"ShowWindow\" _\n(ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n\nGlobal Const SW_MAXIMIZE = 3\nGlobal Const SW_SHOWNORMAL = 2\nGlobal Const SW_SHOWMINIMIZED = 1\nDim ie As InternetExplorerMedium\n</code></pre>\n\n<p>And here's the main body. It's made up of 3 Subs, one for the login, one for waiting, and another for accessing another page after you log in. Everything works until the last few lines of the \"barcodedetailyesterday\" Sub. The exact same method call that works in the \"websiteLogin\" Sub doesn't work in the \"BarcodeDetailYesterday\" one. The error is \"Run-time error 91: Object variable or With block variable not set\". I have tried adding extra delays to make sure it had time to load, I've tried doing everything piece wise, and it breaks down at the getElementById(\"\").Value piece every time.</p>\n\n<p>Does anyone have any ideas?</p>\n\n<pre><code>Sub websiteLogin()\n\nSet ie = New InternetExplorerMedium\nConst Url$ = \"url\"\nDim Username As String, Password As String\n\nUsername = \"username\"\nPassword = \"password\"\n'#####Open Internet Explorer and sign#####\n'create IE instance &amp; navigate to login page\nie.navigate Url\nCall waitonIE\n'use data from Excel file to log in\nie.document.getElementById(\"fm_username\").Value = Username\nie.document.getElementById(\"fm_password\").Value = Password\nie.document.forms(0).submit\nEnd Sub\n\nSub waitonIE()\n'####Wait on Internet Explorer to become stable before working with it####\nie.Visible = True\napiShowWindow ie.hwnd, SW_MAXIMIZE\nWhile ie.Busy Or ie.readyState &lt;&gt; 4:\nDoEvents:\nWend\nEnd Sub\n\n\nSub BarcodeDetailYesterday()\n\n'open Internet Explorer and sign in\nCall websiteLogin\n'navigate to page\nie.navigate \"new url\"\n'create time/date parameters\nDim Yesterday As Date\nYesterday = Date - 1\nstartDate = Yesterday\nstartTime = \"00:00:00\"\nendDate = Yesterday\nendTime = \"23:59:59\"\nCall waitonIE\n'insert data into fields\n'Application.Wait (Now + TimeValue(\"0:00:03\"))\nie.document.getElementById(\"fm_date\").Value = startDate\nie.document.getElementById(\"fm_time\").Value = startTime\nie.document.getElementById(\"fm_date2\").Value = endDate\nie.document.getElementById(\"fm_time2\").Value = endTime\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms", "beforeupdate"], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 9642355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wrulj.png?s=128&g=1", "display_name": "Fil", "link": "https://stackoverflow.com/users/9642355/fil"}, "is_accepted": false, "score": 0, "last_activity_date": 1594365959, "creation_date": 1594365959, "answer_id": 62829270, "question_id": 58845478, "link": "https://stackoverflow.com/questions/58845478/beforeupdate-with-a-new-record-button/62829270#62829270", "title": "BeforeUpdate with a &quot;new record&quot; button", "body": "<p>I don't really understand what <code>njno</code> is. If the textboxes are bound to the form's <code>RecordSource</code> then.\nOn form <code>Current</code> event use:</p>\n<pre><code>Private Sub Form_Current ()\n\nIf Me.NewRecord Then\nJob.Value = njno \nEnd if\n\nEnd Sub\n</code></pre>\n<p>Then on the button Click event use:</p>\n<pre><code>Private Sub new_Click()\nDoCmd.GoToRecod,,acNewRec\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12369103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dDBfhpiTztQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc73BFIjbQ2ORspE6DuCLeY1H489Q/photo.jpg?sz=128", "display_name": "Sim", "link": "https://stackoverflow.com/users/12369103/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610278680, "creation_date": 1573678572, "last_edit_date": 1610278680, "question_id": 58845478, "link": "https://stackoverflow.com/questions/58845478/beforeupdate-with-a-new-record-button", "title": "BeforeUpdate with a &quot;new record&quot; button", "body": "<p>I have an Access form users sometimes forget to save. I put in a BeforeUpdate trigger to pop up message reminding users to save or cancel before taking any action.<br />\nI found this code on the net and it works for everything except my &quot;New Record&quot; button.<br />\nAs far as I know <code>Me.Dirty</code> should do the trick.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n    Dim ctl As Control\n    On Error GoTo Err_BeforeUpdate\n\n    ' The Dirty property is True if the record has been changed.\n    If Me.Dirty Then\n        ' Prompt to confirm the save operation.\n        If MsgBox(&quot;Do you want to save?&quot;, vbYesNo + vbQuestion, _\n          &quot;Save Record&quot;) = vbNo Then\n            Me.Undo\n        End If\n    End If\n\nExit_BeforeUpdate:\n    Exit Sub\n\n    Err_BeforeUpdate:\n    MsgBox Err.Number &amp; &quot; &quot; &amp; Err.Description\n    Resume Exit_BeforeUpdate\nEnd Sub\n</code></pre>\n<p>The code for the new record</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub new_Click()\n    njno = NewJobNbr()\n    Job.Value = njno\n    RnK.Value = &quot;&quot;\n    Date_Requested.Value = &quot;&quot;\n    Est_Time.Value = &quot;&quot;\n    Originator.Value = &quot;&quot;\n    Date_Required.Value = &quot;&quot;\n    Description.Value = &quot;&quot;\n    Reason_for_Request.Value = &quot;&quot;\n    Comments.Value = &quot;&quot;\n    Priority_Tasks.Value = &quot;&quot;\n    TName.Value = &quot;&quot;\n    Required.Value = &quot;&quot;\n    Costing.Value = &quot;&quot;\n    Completed.Value = &quot;&quot;\n    Date_Completed.Value = &quot;&quot;\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1573691308, "post_id": 58845416, "comment_id": 103968769, "body": "Are the items with multiple entries in column 4 contained within a single cell as it appears from your screenshot? Or are there really multiple rows.  If the former, it&#39;s just a matter of splitting the column on the LF character (done simply in Power Query)."}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 4925676, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/000d092f7af6da5c514a3c11d4e132f7?s=128&d=identicon&r=PG&f=1", "display_name": "MrPea", "link": "https://stackoverflow.com/users/4925676/mrpea"}, "is_accepted": false, "score": 0, "last_activity_date": 1573824071, "last_edit_date": 1573824071, "creation_date": 1573684748, "answer_id": 58846721, "question_id": 58845416, "link": "https://stackoverflow.com/questions/58845416/move-data-from-cells-to-the-end-of-an-existing-row/58846721#58846721", "title": "Move data from cells to the end of an existing row", "body": "<p>There's probably better ways but this works (assuming that values in column D are all individual rows/cells)</p>\n\n<pre><code>Sub script()\n For Each cell In Range(\"A1:A15\")\n   Do Until cell.Offset(1, 0) &lt;&gt; \"\" Or cell.Offset(1, 3) = \"\"\n     With cell\n       .Offset(1, 0).End(xlToRight).Copy cell.End(xlToRight).Offset(0, 1)\n       .Offset(1, 0).EntireRow.Delete\n     End With\n   Loop\n Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12369171, "user_type": "registered", "profile_image": "https://graph.facebook.com/2784533138231694/picture?type=large", "display_name": "Rich Delzell", "link": "https://stackoverflow.com/users/12369171/rich-delzell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573824071, "creation_date": 1573678263, "last_edit_date": 1573679027, "question_id": 58845416, "link": "https://stackoverflow.com/questions/58845416/move-data-from-cells-to-the-end-of-an-existing-row", "title": "Move data from cells to the end of an existing row", "body": "<p>I am trying to move data from rows where columns A and B are empty to the end of the previous row where column A and B have values using VBA. </p>\n\n<p>From</p>\n\n<p><a href=\"https://i.stack.imgur.com/18acF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/18acF.jpg\" alt=\"Initial Data\"></a></p>\n\n<p>To </p>\n\n<p><a href=\"https://i.stack.imgur.com/OeZQI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OeZQI.png\" alt=\"Rearranged Data\"></a></p>\n\n<p>To do this I was thinking of iterating through the Range of cells with a While Wend command but don't know how to actually get the text to move to the end of the row without knowing the cell number at the end of the previous row in advance.</p>\n"}, {"tags": ["excel", "vba", "input", "copy-paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573678994, "post_id": 58845355, "comment_id": 103964688, "body": "What line throws the error?"}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573680772, "post_id": 58845355, "comment_id": 103965492, "body": "the respective case in the statement. So in case the user copies several cells with an &quot;A&quot;, then the line with this case throws it"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573682210, "post_id": 58845355, "comment_id": 103966117, "body": "have you tried removing the existing comment in <code>cell</code> before you add another one?"}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "edited": false, "score": 0, "creation_date": 1573682955, "post_id": 58845355, "comment_id": 103966401, "body": "you mean in the vba-code or manually? Removing manually would not be an option and my problem is exactly that I don&#39;t have an understanding on how to implement a solution into the code, that would do this"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573683719, "post_id": 58845355, "comment_id": 103966695, "body": "Are you sure it wasn&#39;t when a comment already existed?  You cannot have multiple comments."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573684264, "post_id": 58845355, "comment_id": 103966903, "body": "If you add <code>Cell.Comment.Delete</code> above your <code>Select</code> line you can replace the comment if A,B or C and no need for the last case."}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573685403, "post_id": 58845355, "comment_id": 103967311, "body": "@DarrellH: I am not sure, what exactly you mean. My problem case is, that if I copy several cells at the same time and they contain a content relevant for this macro and then I paste those cells into other empty cells, Excel throws an error."}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573685636, "post_id": 58845355, "comment_id": 103967379, "body": "@DarrellH: thanks for the suggestion, but it throws immediately a runtime error 91"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 1, "creation_date": 1573686849, "post_id": 58845355, "comment_id": 103967690, "body": "Try this line in place of the delete, a one line <code>If..Then</code>, <code>If Not cell.Comment Is Nothing Then cell.Comment.Delete</code>.  This will replace the comment if one exists and add if not."}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573716407, "post_id": 58845355, "comment_id": 103975356, "body": "@DarrellH Thank you very much! This is the solution to my problem :)"}], "owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573678418, "creation_date": 1573677933, "last_edit_date": 1573678418, "question_id": 58845355, "link": "https://stackoverflow.com/questions/58845355/how-to-enable-copy-paste-of-several-cells-in-a-switch-statement", "title": "How to enable copy-paste of several cells in a switch statement?", "body": "<p>the presented code snippet does automatically add a comment to cells with a certain value inside. It works for multiple inputs, so e.g. if I drag the green frame from one cell over several further cells. Furthermore, it works for copy-pasting one cell (for this I implemented the error handling). If a cell is empty, the comment is automatically removed.</p>\n\n<p>However, if I copy several cells with a comment and then paste it, I receive a runtime error 1004. The reason for the problem seems to be connected to the fact, that Excel, when you copy something deletes the comment and then automatically adds it into the new cell when you paste it. So in my case, 2 comments are added at once to the same cell, which is probably why the error occurs. At least, that's my guess.</p>\n\n<p>Does somebody know, how to solve this? Is my explanation right?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim cell As Range\n    For Each cell In Target\n        On Error GoTo AVOID_ERROR_WHEN_COPY_PASTING\n        Application.EnableEvents = False\n        Select Case cell.Value\n            Case Is = \"A\": cell.AddComment (\"some comment\")\n            Case Is = \"B\": cell.AddComment (\"some comment\")\n            Case Is = \"C\": cell.AddComment (\"some comment\")\n            Case Is = \"\": cell.ClearComments\n        End Select\n\n        AVOID_ERROR_WHEN_COPY_PASTING:\n        Application.EnableEvents = True\n        On Error GoTo 0\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "database", "vba", "ssms"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573707288, "post_id": 58845318, "comment_id": 103972268, "body": "There are no &quot;empty rows&quot; in a database table - only records which have been inserted.  You will need to construct a SQL insert statement to add a record, or open an editable recordset, call <code>AddNew</code> on that recordset, add your field values then call <code>Update</code>  see <a href=\"https://www.vb-helper.com/howto_ado_insert.html\" rel=\"nofollow noreferrer\">vb-helper.com/howto_ado_insert.html</a>  or <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/addnew-method-example-vb?view=sql-server-ver15\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/reference/ado-api/&hellip;</a> for example."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573707423, "post_id": 58845318, "comment_id": 103972302, "body": "Example of both approaches here:  <a href=\"https://stackoverflow.com/questions/10708077/fastest-way-to-transfer-excel-table-data-to-sql-2008r2\" title=\"fastest way to transfer excel table data to sql 2008r2\">stackoverflow.com/questions/10708077/&hellip;</a>"}, {"owner": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "edited": false, "score": 0, "creation_date": 1573720961, "post_id": 58845318, "comment_id": 103977366, "body": "I assume you have considered querying excels from power query, negating the requirement to involve sql...?"}, {"owner": {"reputation": 61, "user_id": 10574433, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JMHkjf14hK0/AAAAAAAAAAI/AAAAAAAAAV4/KcfiX8cMCQI/photo.jpg?sz=128", "display_name": "Noah Thomas", "link": "https://stackoverflow.com/users/10574433/noah-thomas"}, "reply_to_user": {"reputation": 579, "user_id": 7471560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86af0401de69dad1bb3edd70a4920976?s=128&d=identicon&r=PG&f=1", "display_name": "LJ01", "link": "https://stackoverflow.com/users/7471560/lj01"}, "edited": false, "score": 0, "creation_date": 1573740229, "post_id": 58845318, "comment_id": 103988346, "body": "@LJ01 I&#39;ve considered it but ISO/IATF requires record retention for 10 years so I want to have somewhere to permanently put it and not have thousands of excel sheets floating around."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 10574433, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JMHkjf14hK0/AAAAAAAAAAI/AAAAAAAAAV4/KcfiX8cMCQI/photo.jpg?sz=128", "display_name": "Noah Thomas", "link": "https://stackoverflow.com/users/10574433/noah-thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1573759265, "creation_date": 1573759265, "answer_id": 58864311, "question_id": 58845318, "link": "https://stackoverflow.com/questions/58845318/push-excel-range-to-sql-table-via-vba/58864311#58864311", "title": "Push Excel Range to SQL Table via VBA", "body": "<p>I was able to successfully write an entire row from Excel to an SQL Database using the following:</p>\n\n<pre><code>Sub Connection()\n\n  Const Tbl As String = \"NEIN\"\n\n        Dim InsertQuery As String, xlRow As Long, xlCol As Integer\n\n        Dim DBconnection As Object\n\n        Set DBconnection = CreateObject(\"ADODB.Connection\")\n\n        DBconnection.Open \"Provider=SQLOLEDB.1;Password=NEIN\" &amp; _\n            \";Persist Security Info=false;User ID=NEIN\" &amp; _\n            \";Initial Catalog=NEIN;Data Source=NEIN\"\n\n        InsertQuery = \"\"\n        xlRow = 1   'only one row being used *as of now*, and that is the top row in the excel sheet\n        xlCol = 119 'First column of data\n        While Cells(xlRow, xlCol) &lt;&gt; \"\"\n\n            InsertQuery = InsertQuery &amp; \"INSERT INTO \" &amp; Tbl &amp; \" VALUES('\"\n\n            For xlCol = 119 To 229 'columns DO1 to HT1\n                InsertQuery = InsertQuery &amp; Replace(Cells(xlRow, xlCol), \"'\", \"''\") &amp; \"', '\"  'Includes mitigation for apostrophes in the data\n            Next xlCol\n            InsertQuery = InsertQuery &amp; Format(Now(), \"M/D/YYYY\") &amp; \"')\" &amp; vbCrLf 'The last column is a date stamp, either way, don't forget to close that parenthesis\n\n        Wend\n\n        DBconnection.Execute InsertQuery\n        DBconnection.Close\n        Set DBconnection = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10574433, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JMHkjf14hK0/AAAAAAAAAAI/AAAAAAAAAV4/KcfiX8cMCQI/photo.jpg?sz=128", "display_name": "Noah Thomas", "link": "https://stackoverflow.com/users/10574433/noah-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 58864311, "answer_count": 1, "score": 0, "last_activity_date": 1573759265, "creation_date": 1573677744, "last_edit_date": 1573720546, "question_id": 58845318, "link": "https://stackoverflow.com/questions/58845318/push-excel-range-to-sql-table-via-vba", "title": "Push Excel Range to SQL Table via VBA", "body": "<p>I am in need of pushing a range in Excel to a new row in an SQL table each time an associate executes a VBA macro. So far, I have segregated the data into a single row and multiple columns (110 cells of data in total) in Excel. My problem right now is stemming from how to insert each one of these individual cells from the Excel sheet into the corresponding column and the first <em>empty</em> row in an SQL table. I've done some pretty extensive searches of the internet and have found nothing remotely close to what I am trying to do.</p>\n\n<p>Is there a correct procedure that would allow me to dump a 110-column row into the first empty row in an SQL table?</p>\n\n<p>I have the tables written and I have the range set: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set DataBaseData = ActiveSheet.Range(\"DO1:HT1\")\n</code></pre>\n\n<p>Beyond this I have no idea in which manner to open a connection with the Server, Database and Table. This is what I've winged so far:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Connection()\n    Dim Conn As ADODB.Connection\n    Dim Command As ADODB.Command\n\n    Set Conn = New ADODB.Connection\n    Set Command = New ADODB.Command\n\n    Dim i As Integer\n    Dim columnnumber As Integer\n\n    i = 0\n\n    Conn.ConnectionString = \"Provider=SQLOLEDB; Data Source=[Nope];Initial Catalog=[NopeNope];User ID=[NopeNopeNope];Password=[AbsolutelyNot]; Trusted_Connection=no;\"\n\n    Conn.Open\n    Command.ActiveConnection = Conn\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>If you have the curiosity as to what I'm trying to do: I'm pushing a series of data from a CMM to the Database so I can store the data for the needed amount of time, and call that data back to PowerBI and Minitab.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 1, "creation_date": 1573677195, "post_id": 58845082, "comment_id": 103963951, "body": "Try InnerText Property i.e. mtbl = webpage.getElementById(&quot;warrantyExpiringLabel&quot;).InnerText"}, {"owner": {"reputation": 3, "user_id": 12369053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf77af073b0c56c4d4b8327dadaa57?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/12369053/jose-ramirez"}, "reply_to_user": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1573679228, "post_id": 58845082, "comment_id": 103964799, "body": "@Bilal I&#39;ve tried that, but I still get the runtime error &#39;91&#39; Object variable or with block variable not set when running it"}, {"owner": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1573679554, "post_id": 58845082, "comment_id": 103964944, "body": "You can get a better suggestion if you could post some html code where the tag with id &quot;warrantyExpiringLabel&quot; can be seen."}, {"owner": {"reputation": 3, "user_id": 12369053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf77af073b0c56c4d4b8327dadaa57?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/12369053/jose-ramirez"}, "reply_to_user": {"reputation": 228, "user_id": 4216021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab71f9dbaf2788463adc85da03061ea?s=128&d=identicon&r=PG&f=1", "display_name": "Bilal", "link": "https://stackoverflow.com/users/4216021/bilal"}, "edited": false, "score": 0, "creation_date": 1573680438, "post_id": 58845082, "comment_id": 103965342, "body": "@Bilal thanks for pointing that out. I&#39;ve attached a snippet of the HTML code where it shows the &quot;warrantyExpiringLabel&quot; id"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12369053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf77af073b0c56c4d4b8327dadaa57?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/12369053/jose-ramirez"}, "edited": false, "score": 0, "creation_date": 1573688428, "post_id": 58845879, "comment_id": 103968080, "body": "Thanks so much for your help! Here thinking it was some sort of syntax issue."}], "tags": [], "owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "is_accepted": true, "score": 0, "last_activity_date": 1573680410, "creation_date": 1573680410, "answer_id": 58845879, "question_id": 58845082, "link": "https://stackoverflow.com/questions/58845082/how-to-extract-data-from-a-site-using-getelementbyid-on-excel/58845879#58845879", "title": "How to extract data from a site using getElementbyID on Excel", "body": "<p>The page need a short manual break to open complete. Place this line in the line after Loop and use .innertext like Bilal wrote:</p>\n\n<pre><code>Application.Wait (Now + TimeSerial(0, 0, 3))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12369053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf77af073b0c56c4d4b8327dadaa57?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/12369053/jose-ramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58845879, "answer_count": 1, "score": 0, "last_activity_date": 1573680410, "creation_date": 1573676738, "last_edit_date": 1573680111, "question_id": 58845082, "link": "https://stackoverflow.com/questions/58845082/how-to-extract-data-from-a-site-using-getelementbyid-on-excel", "title": "How to extract data from a site using getElementbyID on Excel", "body": "<p>I'm trying to extract the value of a given ID and place it on a spreadsheet. I'm trying to use the getElementbyID to extract the value, but not entirely sure how to go about it. I've got the code shown below so far. However, every time I run it I get an object is not specified error. Any assistance would be appreciated. Thanks.</p>\n\n<pre><code>Sub ServiceTagSearch2()\n\nDim ie As InternetExplorer\nDim webpage As HTMLDocument\nSet ie = New InternetExplorer\nDim mtbl As String\n\nie.Visible = True\n\nie.navigate (\"https://www.dell.com/support/home/us/en/04/product-support/servicetag/1zylzf2\")\n\nDo While ie.Busy = True\nLoop\n\nSet webpage = ie.document\nmtbl = webpage.getElementById(\"warrantyExpiringLabel\")\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gFdrE.jpg\" rel=\"nofollow noreferrer\">HTML code showing warrantyExpiringLabel ID</a></p>\n"}, {"tags": ["arrays", "excel", "vba", "class", "dictionary"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1573673513, "post_id": 58844187, "comment_id": 103962309, "body": "<code>Set dict(keyx) = lst</code>  since <code>lst</code> is an object"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573673655, "post_id": 58844187, "comment_id": 103962374, "body": "That simple.... thanks @TimWilliams. Care to post as answer to close the question? I spent literally hours on this :S"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1573673862, "post_id": 58844187, "comment_id": 103962468, "body": "GetArray is incorrect.  You are returning a variable &#39;vals&#39; which is not declared.  If your intent is to return the private array of the class then your code should be getarray=lst.  dict(keyx)  should probably be &#39;set dict.item(x)&#39; (I prefer to not omit the default property). And arr = dict(keys).GetArray should probably be arr = dict.item(key).GetArray."}], "answers": [{"comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1573674055, "post_id": 58844357, "comment_id": 103962546, "body": "There is no variable declared as &#39;keyx&#39;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573674453, "post_id": 58844357, "comment_id": 103962720, "body": "@Freeflow -  Yes - that also!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1573673700, "creation_date": 1573673700, "answer_id": 58844357, "question_id": 58844187, "link": "https://stackoverflow.com/questions/58844187/error-438-object-doesnt-support-this-property-or-method-class-object-with-dic/58844357#58844357", "title": "Error 438 Object doesn&#39;t support this property or method - Class Object with Dictionary", "body": "<pre><code>Set dict(keyx) = lst \n</code></pre>\n\n<p>Since the variable <code>lst</code> refers to an object, <code>Set</code> is required here.</p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573675912, "post_id": 58844677, "comment_id": 103963395, "body": "Thanks for your feedback, I&#39;ll look into it when I&#39;m on a pc tomorrow more. Cheers! Btw, typos are my bad."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 4, "last_activity_date": 1573675038, "creation_date": 1573675038, "answer_id": 58844677, "question_id": 58844187, "link": "https://stackoverflow.com/questions/58844187/error-438-object-doesnt-support-this-property-or-method-class-object-with-dic/58844677#58844677", "title": "Error 438 Object doesn&#39;t support this property or method - Class Object with Dictionary", "body": "<p>The OP code has quite a few typos, undeclared variables and usable but not 'correct' property Let/Get.  This is how I would write the code of the op.  Having now been well trained by the code inspections of the fantastic RubberDuck addin I no longer use 'default' properties but ensure that I use the fully qualified name.  </p>\n\n<p>Class code</p>\n\n<pre><code>Option Explicit\n\nPrivate Type Properties\n\n    List                                As Variant\n\nEnd Type\n\nPrivate p                               As Properties\n\n\nPublic Sub Class_Initialize()\n\n    ReDim p.List(2)\n\nEnd Sub\n\n\nPublic Property Let Item(ByVal i As Long, ByVal NewVal As Variant)\n    p.List(i) = NewVal\nEnd Property\n\nPublic Property Get Item(ByVal i As Long) As Variant\n    Item = p.List(i)\nEnd Property\n</code></pre>\n\n<p>' Typically VBA uses the plural of the 'item name' when returning the array.</p>\n\n<pre><code>Public Function Items() As Variant\n    Items = p.List\nEnd Function\n</code></pre>\n\n<p>Module code </p>\n\n<pre><code>Sub Test()\n\nDim x As Long, arr As Variant, lst As Class1\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    For x = 1 To 3\n        Set lst = New Class1\n        lst.Item(0) = x\n        lst.Item(1) = x\n        lst.Item(2) = x\n        dict.Add x, lst\n    Next x\n\n    For x = 4 To 3 Step -1\n        If dict.Exists(x) = False Then\n            Set lst = New Class1\n            lst.Item(0) = x\n            lst.Item(1) = x\n            lst.Item(2) = x\n            dict.Add x, lst\n        Else\n\n            With dict.Item(x)\n\n                .Item(1) = lst.Item(1) + 2\n                .Item(2) = lst.Item(2) + 2\n\n            End With\n\n        End If\n\n    Next x\n\nDim myKey                       As Variant\n\n    For Each myKey In dict.Keys\n        arr = dict.Item(myKey).GetArray\n    Next Key\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573679984, "post_id": 58844925, "comment_id": 103965139, "body": "Thanks for the thorough explanation Mathieu."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1573691068, "last_edit_date": 1573691068, "creation_date": 1573676158, "answer_id": 58844925, "question_id": 58844187, "link": "https://stackoverflow.com/questions/58844187/error-438-object-doesnt-support-this-property-or-method-class-object-with-dic/58844925#58844925", "title": "Error 438 Object doesn&#39;t support this property or method - Class Object with Dictionary", "body": "<p><a href=\"https://stackoverflow.com/a/58844357/1188513\">As Tim correctly points out</a>, <code>Set</code> is required here, because <code>lst</code> is an object.</p>\n\n<p>What isn't clear, is why a missing <code>Set</code> keyword would cause run-time error 438, an error that's typically encountered with buggy late-bound code. The reason is, in a word, <em>let-coercion</em>: in the absence of a <code>Set</code> keyword, an assignment is an implicit <code>Let</code> (value) assignment.</p>\n\n<p>If <code>Class1</code> had a <em>default member</em>, <code>dict(keyx) = lst</code> would be let-coercing the <code>lst</code> object and storing the value returned by that default member in the dictionary.</p>\n\n<p>Since <code>Class1</code> has no <em>default member</em> (and the reference isn't <code>Nothing</code>), error 438 is raised (would be error 91 if <code>lst</code> was <code>Nothing</code>), because VBA is looking to invoke the member with a <code>VB_UserMemId=0</code> attribute, and cannot find it.</p>\n\n<blockquote>\n  <p>The error 438 will occur on <code>dict(keyx) = lst</code> and tells me that the object (a <code>Dictionary</code>) doesn't support this Property or Method. </p>\n</blockquote>\n\n<p>The object isn't the dictionary here, but your <code>Class1</code> instance; the missing \"property or method\" is that object's default member, implicitly invoked through let-coercion. And since the member call is implicit, it's easily missed, and the error number/message is easily confusing.</p>\n\n<p><a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (free, open-source VBIDE add-in project that I manage) fires an inspection result for <a href=\"http://rubberduckvba.com/Inspections/Details/ValueRequired\" rel=\"nofollow noreferrer\">Value Required</a> here, that explains exactly what's going on:</p>\n\n<blockquote>\n  <p><em>In a context that requires a value type, the expression 'lst' of object type 'VBAProject.Class1' is used that does not have a suitable default member.</em></p>\n</blockquote>\n\n\n\n<blockquote>\n  <p><strong>Object used where a value is required</strong></p>\n  \n  <p>The VBA compiler does not raise an error if an object is used in a place that requires a value type and the object's declared type does not have a suitable default member. Under almost all circumstances, this leads to a run-time error 91 'Object or With block variable not set' or 438 'Object doesn't support this property or method' depending on whether the object has the value 'Nothing' or not, which is harder to detect and indicates a bug.</p>\n</blockquote>\n\n<p>In other words, that's one of many places where the VBA compiler defers to run-time instead of warning of something fishy at compile-time. Static code analysis is therefore the only way to reliably detect such bugs before they show up at run-time.</p>\n"}], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 58844357, "answer_count": 3, "score": 1, "last_activity_date": 1573691068, "creation_date": 1573673100, "last_edit_date": 1573675695, "question_id": 58844187, "link": "https://stackoverflow.com/questions/58844187/error-438-object-doesnt-support-this-property-or-method-class-object-with-dic", "title": "Error 438 Object doesn&#39;t support this property or method - Class Object with Dictionary", "body": "<p><strong><em><sub>Background:</sub></em></strong></p>\n\n<p>This is a follow-up question on <a href=\"https://stackoverflow.com/q/58838720/9758194\">this</a> recent question I asked on how to return an array of <code>Class</code> module properties directly from an <code>Dictionary</code> item.</p>\n\n<p>I have now tried my way to work with <code>Property Let</code> and <code>Property Get</code> to populate a <code>Private Array</code> to populate the <code>Dictionary</code> with. However, running some test I encountered an <code>Error 438</code>.</p>\n\n<p><strong><em><sub>Code:</sub></em></strong></p>\n\n<p>Imagine <code>TstClass</code> as a class module with the following code:</p>\n\n<pre><code>Private lst(0 To 2) As Variant\n\nPublic Property Let Add(ByVal i As Long, ByVal NewVal As Variant)\n    lst(i) = NewVal\nEnd Property\nPublic Property Get Val(ByVal i As Long) As Variant\n    Val = lst(i)\nEnd Property\n\nPublic Function GetArray() As Variant\n    GetArray = vals\nEnd Function\n</code></pre>\n\n<p>Then this code to test in a Module:</p>\n\n<pre><code>Sub Test()\n\nDim x As Long, arr As Variant, lst As Class1\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\nFor x = 1 To 3\n    Set lst = New Class1\n    lst.Add(0) = x\n    lst.Add(1) = x\n    lst.Add(2) = x\n    dict.Add x, lst\nNext x\n\nFor x = 4 To 3 Step -1\n    If dict.Exists(x) = False Then\n        Set lst = New Class1\n        lst.Add(0) = x\n        lst.Add(1) = x\n        lst.Add(2) = x\n        dict.Add x, lst\n    Else\n        Set lst = dict(x)\n        lst.Add(1) = lst.Val(1) + 2\n        lst.Add(2) = lst.Val(2) + 2\n        dict(x) = lst '&lt; Error 438 on this line\n    End If\nNext x\n\nFor Each key In dict.keys\n    arr = dict(keys).GetArray\nNext key\n\nEnd Sub\n</code></pre>\n\n<p><strong><em><sub>Problem:</sub></em></strong></p>\n\n<p>The error 438 will occur on <code>dict(keyx) = lst</code> and tells me that the object (a Dictionary) doesn't support this <code>Property</code> or <code>Method</code>. The problem seems dodgy to me as the <code>lst</code> Object didn't seem to be a problem on <code>dict.Add x, lst</code>. As a matter of fact, the method to change an <code>Item</code> through its <code>Key</code> like this seems to be a very <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">common</a> practice.</p>\n\n<p><strong><em><sub>Question:</sub></em></strong></p>\n\n<p>Whereas something like <code>Dict.Add x, \"Hello\"</code> and then <code>Dict(x) = \"Hello World\"</code> seems to work. The code errors out on using a <code>Class</code> object in the second method. Does anybody know why and if so, how to deal with this problem?</p>\n\n<p>Thank you,\nJvdV</p>\n"}, {"tags": ["excel", "database", "vba", "hyperlink", "inputbox"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573672608, "post_id": 58843968, "comment_id": 103961895, "body": "Can&#39;t the user use Ctrl+V themselves?  That already works..."}, {"owner": {"reputation": 3, "user_id": 12368590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7b03af56948636274cd9e47db87b92?s=128&d=identicon&r=PG&f=1", "display_name": "ryanms", "link": "https://stackoverflow.com/users/12368590/ryanms"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573673133, "post_id": 58843968, "comment_id": 103962147, "body": "Yes, they could, but I&#39;m trying to include it as part of a larger macro that prompts the user for a an ID#, Name, Date, Location, and the hypderlink."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573673461, "post_id": 58843968, "comment_id": 103962287, "body": "Instead of giving them an inputbox, could you give them a &quot;paste hyperlink&quot; button which would trigger the paste operation?  Or a &quot;Paste hyperlink?&quot; Msgbox with Yes/No options."}, {"owner": {"reputation": 3, "user_id": 12368590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7b03af56948636274cd9e47db87b92?s=128&d=identicon&r=PG&f=1", "display_name": "ryanms", "link": "https://stackoverflow.com/users/12368590/ryanms"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573679019, "post_id": 58843968, "comment_id": 103964703, "body": "Hm, I hadn&#39;t thought of that. I think I&#39;ll use that. Good thinking, thanks :)"}], "owner": {"reputation": 3, "user_id": 12368590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7b03af56948636274cd9e47db87b92?s=128&d=identicon&r=PG&f=1", "display_name": "ryanms", "link": "https://stackoverflow.com/users/12368590/ryanms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573672151, "creation_date": 1573672151, "question_id": 58843968, "link": "https://stackoverflow.com/questions/58843968/prompting-the-user-for-a-hyperlink", "title": "Prompting the user for a Hyperlink", "body": "<p>Short(ish) question: I know that you can prompt the user for a string (ex. a URL), but if a user copies a hyperlink from another program (in this case a web page or an email), is it possible for the user to paste that hyperlink into an InputBox, or something similar, so that the macro can paste that into a cell in excel and retain the hyperlink format?</p>\n\n<p>Details: Currently, I'm using the following macro to prompt the user to input the destination URL followed by the text to be displayed for the link:</p>\n\n<pre><code>Selection.Hyperlinks.Add Selection, InputBox(\"hyperlink destination\", \"add a hyperlink\"), , , InputBox(\"text to display\", \"add a hyperlink\")\n</code></pre>\n\n<p>However, this requires an extra step that I'm looking to avoid. Without using VBA, I can right click a link, \"Copy Hyperlink\", and use Ctrl+V in a cell. This automatically pastes the link with the same text displayed as the original link without requiring the user to enter that text.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673197, "post_id": 58843918, "comment_id": 103962170, "body": "<code>Copy</code> is creating (and activating) a new worksheet. OP&#39;s code means to set the <code>Name</code> of the new sheet - this code doesn&#39;t do that, it renames the copied sheet instead."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673552, "post_id": 58843918, "comment_id": 103962328, "body": "@MathieuGuindon - and this is why <code>Activate</code> and <code>Select</code> should be avoided :) I have changed it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673698, "post_id": 58843918, "comment_id": 103962395, "body": "Hm, why not just <code>Set newSheet = ActiveSheet</code> after the copy? The sheet ordering is dependent on the preceding line of code, so if that changes, the wrong sheet gets the new name.. ActiveSheet side-effect isn&#39;t ideal, but still better than repeating the ordering logic IMO."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673859, "post_id": 58843918, "comment_id": 103962465, "body": "@MathieuGuindon - no idea. I am a bit &quot;allergic&quot; to <code>ActiveSheet</code>, but I left it only to make it easy for the the OP to understand what is going on."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1573673507, "last_edit_date": 1573673507, "creation_date": 1573671909, "answer_id": 58843918, "question_id": 58843813, "link": "https://stackoverflow.com/questions/58843813/created-copied-excel-worksheet-throws-424-error/58843918#58843918", "title": "Created copied Excel Worksheet throws 424 error", "body": "<p>The problem is in <code>Set ws = ActiveSheet.Copy(after:=wb.Sheets(wb.Sheets.Count))</code>, because it is trying to <code>Copy</code> and <code>Set</code> in the same time and this is a bit too much.\nChange the code in the condition to this:</p>\n\n<pre><code>If Not ws Is Nothing Then\n    MsgBox \"something\"\n    Exit Sub\nElse:\n    Set ws = ActiveSheet\n    ws.Copy after:=wb.Sheets(wb.Sheets.Count)\n    wb.Worksheets(wb.Sheets.Count).Name = nowMonth &amp; \", \" &amp; nowYear\nEnd If\n</code></pre>\n\n<p>In general, avoid using <code>Active</code> and <code>Select</code> in VBA - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1573676841, "creation_date": 1573676841, "answer_id": 58845104, "question_id": 58843813, "link": "https://stackoverflow.com/questions/58843813/created-copied-excel-worksheet-throws-424-error/58845104#58845104", "title": "Created copied Excel Worksheet throws 424 error", "body": "<p><code>Worksheet.Copy</code> disappointingly doesn't return a reference to the created sheet. Instead, it has the side-effect of adding a new sheet to the workbook, <em>and activating it</em>.</p>\n\n<p>So after running <code>Worksheet.Copy</code>, the <code>ActiveSheet</code> is the newly created sheet.</p>\n\n<pre><code>ActiveSheet.Copy after:=wb.Sheets(wb.Sheets.Count)\nActiveSheet.Name = nowMonth &amp; \", \" &amp; nowYear\n</code></pre>\n\n<p>Now, this code is confusing/misleading, because it <em>looks</em> like the two statements are qualified with the same object, but they aren't.</p>\n\n<p>What's not clear, is why and how the <code>ActiveSheet</code> is guaranteed to be the correct sheet to copy; we're working off the <code>ActiveWorkbook</code> and we don't really care which sheet is active.</p>\n\n<p>I'd suggest to make the copy work off an explicit sheet:</p>\n\n<pre><code>Dim sourceSheet As Worksheet\nSet sourceSheet = wb.Sheets(wb.Sheets.Count)\n\nsourceSheet.Copy after:=sourceSheet '&lt;~ new sheet becomes ActiveSheet\nActiveSheet.Name = nowMonth &amp; \", \" &amp; nowYear\n</code></pre>\n\n<p>And now everything is as clear as it gets.</p>\n"}], "owner": {"reputation": 11, "user_id": 12368659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10221246558859868/picture?type=large", "display_name": "Xio", "link": "https://stackoverflow.com/users/12368659/xio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573676841, "creation_date": 1573671427, "last_edit_date": 1573673746, "question_id": 58843813, "link": "https://stackoverflow.com/questions/58843813/created-copied-excel-worksheet-throws-424-error", "title": "Created copied Excel Worksheet throws 424 error", "body": "<p>The goal is to create a copied sheet that is renamed in the current month and year. The copied sheet is being created in the workbook, however a default name is given to the sheet. What am I missing? </p>\n\n<pre><code>Private Sub Button3_Click()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim nowMonth As Integer, nowYear As Integer\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nnowMonth = Month(Now)\nnowYear = Year(Now)\n\nSet wb = ActiveWorkbook\n\nOn Error Resume Next\n\nSet ws = wb.Sheet(nowMonth &amp; \", \" &amp; nowYear)\n\nOn Error GoTo 0\n\nIf Not ws Is Nothing Then\n    MsgBox \"The Sheet called \" &amp; nowMonth &amp; \", \" &amp; nowYear &amp; \" already exists in the workbook.\", vbExclamation, \"Sheet Already Exists!\"\n    Exit Sub\n\nElse\n    Set ws = ActiveSheet.Copy(after:=wb.Sheets(wb.Sheets.Count))\n    ws.Name = nowMonth &amp; \", \" &amp; nowYear\n\nEnd If\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "offset"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1573671445, "post_id": 58843790, "comment_id": 103961381, "body": "You will need to loop the range, you will not be able to compare an array of values to a single value."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573671448, "post_id": 58843790, "comment_id": 103961385, "body": "You get a type mismatch error because you can&#39;t compare an entire range to <code>9</code>. You need to loop over it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573671527, "post_id": 58843790, "comment_id": 103961416, "body": "What exactly are you wanting to do in the second example?"}, {"owner": {"reputation": 13, "user_id": 12368556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cdbb66957e7837e4da9a7a2008d4179?s=128&d=identicon&r=PG&f=1", "display_name": "KB731", "link": "https://stackoverflow.com/users/12368556/kb731"}, "edited": false, "score": 0, "creation_date": 1573671623, "post_id": 58843790, "comment_id": 103961465, "body": "I just want to get the first example (which works for that particular line), to do the same for all additional lines in the sheet. I am currently looking up how to loop correctly based on the first two comments as that appears to be my problem."}, {"owner": {"reputation": 13, "user_id": 12368556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cdbb66957e7837e4da9a7a2008d4179?s=128&d=identicon&r=PG&f=1", "display_name": "KB731", "link": "https://stackoverflow.com/users/12368556/kb731"}, "edited": false, "score": 0, "creation_date": 1573672067, "post_id": 58843790, "comment_id": 103961659, "body": "Can any of you tell me - do I need to add the loop to the first example (the one that works for the one line), or is it something that is missing from the 2nd example??"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1573671986, "creation_date": 1573671986, "answer_id": 58843930, "question_id": 58843790, "link": "https://stackoverflow.com/questions/58843790/conditional-value-entered-in-specific-cell-in-a-range-unlocks-another-specific/58843930#58843930", "title": "Conditional value entered in specific cell in a range, unlocks another specific cell in another range (VBA, Range Offset)", "body": "<p>As mentioned above, you need to loop.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Range\n    ActiveSheet.Unprotect \"password\"\n    For Each c In Me.Range(\"U13:U200\").Cells\n        c.Offset(0, 31).Locked = c.Value &lt;&gt; 9\n    Next c\n    ActiveSheet.Protect \"password\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12368556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cdbb66957e7837e4da9a7a2008d4179?s=128&d=identicon&r=PG&f=1", "display_name": "KB731", "link": "https://stackoverflow.com/users/12368556/kb731"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 58843930, "answer_count": 1, "score": 1, "last_activity_date": 1573671986, "creation_date": 1573671324, "question_id": 58843790, "link": "https://stackoverflow.com/questions/58843790/conditional-value-entered-in-specific-cell-in-a-range-unlocks-another-specific", "title": "Conditional value entered in specific cell in a range, unlocks another specific cell in another range (VBA, Range Offset)", "body": "<p>I am VERY new to VBA, but trying my best to catch on, reading everything I can, and testing as much as I can. I simply cannot figure this out after days of trying and I am begging for help, please!</p>\n\n<p>What I specifically need:\nIf a value of 9 (and only 9) is entered into cell U13, then cell AZ13 is unlocked (no other value entered will unlock AZ13). OR if a value of 9 is entered into cell U14, then cell AZ14 is unlocked, and so on down the sheet to approximately U300/AZ300. </p>\n\n<p>I have successfully achieved the desired result on the first line U13/AZ13 with the code below.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    ActiveSheet.Unprotect \"password\"\n    If Range(\"U13\").Value &lt;&gt; 9 Then\n        Range(\"AZ13\").Locked = True\n    ElseIf Range(\"U13\").Value = 9 Then\n        Range(\"AZ13\").Locked = False\n    End If\n    ActiveSheet.Protect \"password\"\nEnd Sub\n</code></pre>\n\n<p>The part I can't for the life of me get to work is moving to the next line.  I have tried several variations of the above code and about 100 other codes including:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    ActiveSheet.Unprotect \"password\"\n    If Range(\"U13:U200\").Value &lt;&gt; 9 Then\n        Range(\"U13:U200\").Offset(0, 31).Select.Locked = True\n    ElseIf Range(\"U13:U200\").Value = 9 Then\n        Range(\"U13:U200\").Offset(0, 31).Select.Locked = False\n    End If\n    ActiveSheet.Protect \"password\"\nEnd Sub\n</code></pre>\n\n<p>I have tried the above with \".select.locked\" as well as just \".locked\".\nI am just learning about using range offset, but did try to modify to only move 1 cell over (0,1) just in case I counted the wrong number of cells, but that did not work either. This particular code gives me a run-time error (type mismatch); debug points to this line: </p>\n\n<pre><code>If Range(\"U13:U200\").Value &lt;&gt; 9 Then\n</code></pre>\n\n<p>Any help in the right direction is GREATLY APPRECIATED!!!</p>\n\n<p>Kay</p>\n"}, {"tags": ["excel", "vba", "concatenation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1573670022, "post_id": 58843315, "comment_id": 103960782, "body": "<code>destination:=Worksheets(...</code>   and missing <code>Next ws</code>.  &quot;Having difficulty&quot; is not a very useful description of the problem - please clarify exactly what the issue is."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573670120, "post_id": 58843315, "comment_id": 103960823, "body": "Lots of issues here (missing <code>Next</code>, missing <code>With...End With</code>, unqualified <code>Range</code> calls, etc.) Would suggest that you break this down into pieces and get them working separately before trying to combine code together."}], "owner": {"reputation": 1, "user_id": 5442946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1652673ed83705240fb7da2c4abc2c83?s=128&d=identicon&r=PG&f=1", "display_name": "Swmeyers", "link": "https://stackoverflow.com/users/5442946/swmeyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573716646, "creation_date": 1573669370, "last_edit_date": 1573716646, "question_id": 58843315, "link": "https://stackoverflow.com/questions/58843315/consolidate-columns-in-vba-and-remove-duplicates", "title": "Consolidate Columns in VBA and Remove Duplicates", "body": "<p>Having difficulty with the code below. I am trying to copy the data from cells B6 to the last row in each worksheet and paste it into a summary sheet. I would then like to remove duplicates. I searched through a few forums and still have no luck. </p>\n\n<pre><code>Sub ConsolidateCustomers()\n\nDim ws As Worksheet\n\nFor Each ws In Sheets\n\n    If ws.Name &lt;&gt; \"Detailed Aging Summary\" And ws.Name &lt;&gt; \"Structuring\" Then\n    Range(\"B6\", .Cells(Rows.Count, 1).End(xlUp).Row).Copy\n        destination=Worksheets(\"Detailed Aging Summary\").Range(\"B3\", .Cells(Rows.Count, \n        1).End(xlUp).Row)\n\n    End If\n\n    With Worksheets(\"Detailed Aging Summary\").Range(\"B3\", .Cells(Rows.Count, \n       1).End(xlUp).Row).RemoveDuplicates\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sendkeys", "foxit", "foxit-reader"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573668571, "post_id": 58842860, "comment_id": 103960154, "body": "Unrelated, but the hotkey for SaveAs is actually F12, not Ctrl+S. Are you sure that <code>+</code> and the parentheses belong there?"}, {"owner": {"reputation": 1, "user_id": 12368346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDDV0lxBkL6IX42rX1x-cKRtJqvn0M7xCDpDaLP4pE=k-s128", "display_name": "Mark Bailey", "link": "https://stackoverflow.com/users/12368346/mark-bailey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673400, "post_id": 58842860, "comment_id": 103962260, "body": "The Save As works as Ctrl+Shift+S."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673479, "post_id": 58842860, "comment_id": 103962294, "body": "Ctrl+Shift+S does not &quot;SaveAs&quot; in Excel. SaveAs is F12."}, {"owner": {"reputation": 1, "user_id": 12368346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDDV0lxBkL6IX42rX1x-cKRtJqvn0M7xCDpDaLP4pE=k-s128", "display_name": "Mark Bailey", "link": "https://stackoverflow.com/users/12368346/mark-bailey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573678485, "post_id": 58842860, "comment_id": 103964460, "body": "Correct. Ctrl+Shift+S saves in Foxit PDF. My question pertains to vba commands in Excel to populate a &#39;live&#39; pdf form.  I was hoping someone here would know how to get the command to work.  I have assigned the shortcut to Foxit but the vba command doesn&#39;t seem to execute."}], "owner": {"reputation": 1, "user_id": 12368346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDDV0lxBkL6IX42rX1x-cKRtJqvn0M7xCDpDaLP4pE=k-s128", "display_name": "Mark Bailey", "link": "https://stackoverflow.com/users/12368346/mark-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573829501, "creation_date": 1573667470, "last_edit_date": 1573829501, "question_id": 58842860, "link": "https://stackoverflow.com/questions/58842860/shortcut-keys-for-foxit-in-macro", "title": "Shortcut keys for Foxit in macro", "body": "<p>I have written a macro to fill in a Foxit pdf from Excel. The macro populates all info on the first customer row via SendKeys and then loops to the second customer, etc. The code executes without issue. My problem is that when I try to reset the form using shortcut keys that I have assigned, nothing happens.  Here is the command:</p>\n\n<pre><code>Application.SendKeys \"^+(r)\", True 'Reset Form\nApplication.Wait Now + 0.00006\n</code></pre>\n\n<p>I need to reset the form as some of the options are checkboxes and some of the fields may be blank. I created a longer wait time to attempt to ensure the command executes. No luck.  Similar code for saving the pdf works fine:</p>\n\n<pre><code>Application.SendKeys \"^+(s)\", True 'Save As\nApplication.SendKeys \"C:\\Users\\......\" &amp; LastName &amp; \"\\\" &amp; FirstName &amp; \"_\" &amp; \"Arrangement\" &amp; \".pdf\"\nApplication.Wait Now + 0.00003\n</code></pre>\n\n<p>Thank you for any help.</p>\n"}, {"tags": ["sql", "excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 1248, "user_id": 10012519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UXVWJ2vzUBg/AAAAAAAAAAI/AAAAAAAAAEU/_-laWnURd4A/photo.jpg?sz=128", "display_name": "alexherm", "link": "https://stackoverflow.com/users/10012519/alexherm"}, "edited": false, "score": 0, "creation_date": 1573667160, "post_id": 58842737, "comment_id": 103959455, "body": "What error are you getting?"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1573667274, "post_id": 58842737, "comment_id": 103959512, "body": "this line seems strange [Text;FMT=Delimited;HDR=Yes;DATABASE=&quot; &amp; csvPath &amp; &quot;].users.csv. shouldnt be [Text;FMT=Delimited;HDR=Yes;DATABASE=&quot; &amp; csvPath &amp; &quot;users.csv&quot;]. and the same for the other join."}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1573667602, "post_id": 58842737, "comment_id": 103959666, "body": "Edited my post. I&#39;m pretty sure that line is correct, because it works just fine with one join."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1573667754, "post_id": 58842737, "comment_id": 103959746, "body": "Perhaps drop the unnecessary parentheses. I can&#39;t imagine why it wouldn&#39;t work with them in there though."}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1573667886, "post_id": 58842737, "comment_id": 103959809, "body": "When I do that, i get a syntax error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573668452, "post_id": 58842737, "comment_id": 103960089, "body": "try <code>LEFT JOIN ({your subquery}) b ON a.Name=b.full_name</code> - I don&#39;t think <i>these</i> parentheses are unnecessary."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1573668548, "post_id": 58842737, "comment_id": 103960146, "body": "Please show or post the header rows of both CSVs. You may be misspelling column names. If you have MS Access, try running exact query (with hard-coded paths) in a Query Design window. Tell us what column is prompted for you to enter data."}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1573669168, "post_id": 58842737, "comment_id": 103960401, "body": "Tried moving parentheses, receive a syntax error in FROM clause.  Checked header names, they match. I don&#39;t have MS Access."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573669556, "post_id": 58842737, "comment_id": 103960585, "body": "Have you tried doing this with PowerQuery (/Get &amp; Transform) instead?"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1573669654, "post_id": 58842737, "comment_id": 103960624, "body": "I have not, I&#39;ve never used PowerQuery."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1573669681, "post_id": 58842737, "comment_id": 103960635, "body": "When you do, you&#39;ll wonder why it took so long to try it!"}, {"owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "edited": false, "score": 0, "creation_date": 1573675491, "post_id": 58842737, "comment_id": 103963222, "body": "That works well. Thanks"}], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573669082, "creation_date": 1573666954, "last_edit_date": 1573668177, "question_id": 58842737, "link": "https://stackoverflow.com/questions/58842737/excel-vba-sql-multi-join-multi-file-types", "title": "Excel VBA SQL multi JOIN, Multi file types", "body": "<p>I've looked for awhile now and have found some useful tips for formatting but I still can't get my code to work. It works when I remove the second <code>JOIN</code> but gives a Parameter error with the second <code>JOIN</code> added.</p>\n\n<p>My code is:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MultiJoinQuery()\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim csvPath As String\n    Dim xlsxPath As String\n    Dim con As String\n    Dim strSQL As String\n    Dim i As Long\n\n    Set cn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n\n    csvPath = \"C:\\Users\\Me\\\"\n    xlsxPath = \"C:\\Users\\Somewhere Else\\Book1.xlsx\"\n\n    con = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; xlsxPath &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes;\"\";\"\n\n    strSQL = \"SELECT * \" _\n       &amp; \"FROM ([Sheet1$] a \" _\n       &amp; \"LEFT JOIN [Text;FMT=Delimited;HDR=Yes;DATABASE=\" &amp; csvPath &amp; \"].users.csv b ON a.[Name]=b.[full_name]) \" _\n       &amp; \"LEFT JOIN [Text;FMT=Delimited;HDR=Yes;DATABASE=\" &amp; csvPath &amp; \"].enrollments.csv c ON c.[user_id]=b.[user_id] \"\n\n\n    rs.Open strSQL, con, 3, 3\n\n\n    For i = 0 To rs.Fields.Count - 1\n        Cells(1, i + 1).value = rs.Fields(i).Name\n    Next\n    Range(\"A2\").CopyFromRecordset rs\n\n    ''Tidy up\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>With parentheses I get <a href=\"https://i.stack.imgur.com/I6ZWV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I6ZWV.png\" alt=\"Param Error\"></a> </p>\n\n<p>Without parentheses, I get <a href=\"https://i.stack.imgur.com/NCFoy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NCFoy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why do I keep getting a Param error? How can I make this code work?</p>\n\n<p>Your help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573665663, "post_id": 58842331, "comment_id": 103958738, "body": "Looks like a job for dynamic controls. I&#39;d have a class responsible for managing a <code>TextBox</code> and two <code>CheckBox</code> MSForms controls, and then have it expose the <code>Text</code> of the textbox and the two <code>Boolean</code> properties abstracting away the checkboxes, and then all the form would need to care about would be 25 instances of that class, and you wouldn&#39;t need to iterate every single checkbox anymore. Why not use the textbox&#39; name for the group?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573665709, "post_id": 58842331, "comment_id": 103958770, "body": "Groups are needed when all the controls have the same parent. If you put the textbox and its two checkboxes inside a <code>Frame</code> control, you don&#39;t need groups anymore."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573666634, "post_id": 58842331, "comment_id": 103959212, "body": "Or, consider naming the checkboxes after the textbox they&#39;re associated with: <code>FooBox</code> is associated with <code>FooCheckA</code> and <code>FooCheckB</code> - then you can dereference the checkboxes off the form&#39;s <code>Controls</code> collection, by name."}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573667869, "post_id": 58842331, "comment_id": 103959801, "body": "Thanks Mathieu Guindon... would you post an example of how you would do that? I have been looking through examples but have not hit on the right one."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573668283, "post_id": 58842331, "comment_id": 103960001, "body": "Unfortunately I don&#39;t have 2 hours to do this right now, but <a href=\"https://stackoverflow.com/a/10224992/1188513\">this</a> should get you started."}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1573668436, "post_id": 58842331, "comment_id": 103960083, "body": "You can also use the Tag property to associate things"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1573671066, "post_id": 58843452, "comment_id": 103961216, "body": "Thanks Tim, I will try and see if I can make this work."}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1573672745, "post_id": 58843452, "comment_id": 103961961, "body": "How do I name the checkboxes? Do I create groups?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1573673035, "post_id": 58843452, "comment_id": 103962106, "body": "No you just set their names in the Properties pane - &quot;Grp_1_CHKA&quot; , &quot;Grp_1_CHKB&quot;, ..., &quot;Grp_25_CHKA&quot;, Grp_25_CHKB&quot;  Similar deal for the textboxes  &quot;Grp_1_TB&quot;, ..., &quot;Grp_25_TB&quot;"}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1573677112, "post_id": 58843452, "comment_id": 103963919, "body": "I got it.. I think this will work great. Thanks for the help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1573669907, "creation_date": 1573669907, "answer_id": 58843452, "question_id": 58842331, "link": "https://stackoverflow.com/questions/58842331/get-status-of-check-boxes-on-userform/58843452#58843452", "title": "Get Status of Check boxes on Userform", "body": "<p>With a consistent naming pattern you can do this:</p>\n\n<pre><code>Dim i As Long, tb As Control, chkA As Control, chkB As Control\n\nFor i = 1 To 25\n    Set tb = Me.Controls(\"Grp_\" &amp; i &amp; \"_TB\")\n    Set chkA = Me.Controls(\"Grp_\" &amp; i &amp; \"_CHKA\")\n    Set chkB = Me.Controls(\"Grp_\" &amp; i &amp; \"_CHKB\")\n\n    'work with tb, chkA, chkB\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58843452, "answer_count": 1, "score": 0, "last_activity_date": 1573669907, "creation_date": 1573665297, "last_edit_date": 1573665323, "question_id": 58842331, "link": "https://stackoverflow.com/questions/58842331/get-status-of-check-boxes-on-userform", "title": "Get Status of Check boxes on Userform", "body": "<p>I have many checkboxes and textboxes on my userform. I have these in groups as in, one textbox goes with two checkboxes. What I need to figure out is a short way to get the status of the checkboxes and the contents of the textbox so I can write this to a text file.</p>\n\n<p>The info I will need to write to text would be any of the 25 textboxes:  TextboxValue + (checkbox1 checked?) and/or (checkbox2 checked?) and so on... </p>\n\n<p>Right now I only have this, but I have set approx 25 groups total, but not sure if groups are the right way to go. I hope I am making sense of this to all of you.  Thanks</p>\n\n<pre><code>Dim ctrl As Control\n\nFor Each ctrl In Me.Controls\n\nIf TypeOf ctrl Is MSForms.CheckBox Then\n  If ctrl.GroupName = \"GroupA\" Then\n    If ctrl.Value = True Then\n    MsgBox ctrl.Caption &amp; \": \" &amp; Me.TextBox1.Text\n    End If\n End If\nEnd If\n\nIf TypeOf ctrl Is MSForms.CheckBox Then\n  If ctrl.GroupName = \"GroupB\" Then\n    If ctrl.Value = True Then\n    MsgBox ctrl.Caption\n    End If\n End If\nEnd If\nNext ctrl\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 4, "creation_date": 1573664885, "post_id": 58842159, "comment_id": 103958379, "body": "Have you attempted to format the column?  <code>columns(6).numberformat=&quot;#.##0&quot;</code> etc?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1573665753, "post_id": 58842159, "comment_id": 103958798, "body": "Is your decimal separator a dot or a comma?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1573673149, "post_id": 58842159, "comment_id": 103962151, "body": "Is your result supposed to be a number, or a string?  If the latter, format the cell as text before doing the Replace.  If the former,  this may just be a formatting problem In any event, more information is required."}, {"owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "edited": false, "score": 0, "creation_date": 1573680181, "post_id": 58842159, "comment_id": 103965222, "body": "Hi, thank for your answers, the decimal separator is by comma and the final result has to be a number because i perform a mathematical operation."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574075570, "post_id": 58842159, "comment_id": 104088519, "body": "@Adriiboom How does the data get onto your excel sheet?  If you are importing it from a CSV or TXT file, for example, you should be setting the separator during the import routine, so that Excel will properly interpret the data.  If by some other method, please clarify.  Also, please start your comments with <code>@name</code> so that the person to whom you are responding will be notified of your response."}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "is_accepted": true, "score": 0, "last_activity_date": 1573716560, "creation_date": 1573716560, "answer_id": 58851484, "question_id": 58842159, "link": "https://stackoverflow.com/questions/58842159/excel-macro-for-replace-points-with-commas/58851484#58851484", "title": "Excel macro for replace points with commas", "body": "<p>The answer is given by Cyril</p>\n\n<p>Just have to add</p>\n\n<pre><code>columns(6).numberformat=\"#.##0\"\nColumns(\"F\").Replace What:=\"g\", _\n                    Replacement:=\"\", _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    MatchCase:=False, _\n                    SearchFormat:=False, _\n                    ReplaceFormat:=False\n</code></pre>\n\n<p>And it works, this change the points for commas also and doesn't delete the other data.</p>\n\n<p>Thanks to all.</p>\n"}], "owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58851484, "answer_count": 1, "score": 0, "last_activity_date": 1573716560, "creation_date": 1573664742, "last_edit_date": 1573665260, "question_id": 58842159, "link": "https://stackoverflow.com/questions/58842159/excel-macro-for-replace-points-with-commas", "title": "Excel macro for replace points with commas", "body": "<p>I'm trying to make a macro where I select one column and only for that column i replace all points for commas and also i want to delete letter \"g\" which is added to all cells in that column</p>\n\n<p>So instead of having 24.56 g i want to have 24,56</p>\n\n<p>I made a macro</p>\n\n<pre><code>Sub Macro5()\n\nColumns(\"F\").Replace What:=\"g\", _\n                        Replacement:=\"\", _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False, _\n                        SearchFormat:=False, _\n                        ReplaceFormat:=False\nColumns(\"F\").Replace What:=\".\", _\n                        Replacement:=\",\", _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False, _\n                        SearchFormat:=False, _\n                        ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n\n<p>When I perform this task manually using find and replace it works fine but my problem is when i run this macro and all the cells in that columns lose their comma</p>\n\n<p>so cells with 123,456 change to 123456\nand cells with 21.56 g change to 2156</p>\n\n<p>Could you tell me what i'm doing wrong please?</p>\n"}, {"tags": ["vba", "ms-access", "combobox", "subform"], "answers": [{"tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": false, "score": 0, "last_activity_date": 1573676617, "last_edit_date": 1573676617, "creation_date": 1573671458, "answer_id": 58843822, "question_id": 58841949, "link": "https://stackoverflow.com/questions/58841949/access-combo-box-and-subform/58843822#58843822", "title": "Access combo box and subform", "body": "<p>The error you get <code>syntax error (missing operator) in query expression</code> points out that <code>Me.cbo_st_no</code> doesn't return a value.</p>\n\n<p>That could happen if no entry is selected in the combobox yet.</p>\n\n<p>So in case no entry is selected yet in the combo box, you should think about if all or no record should be displayed in the subform.</p>\n\n<p>This is a full example assuming <code>st_no</code> is a number field:</p>\n\n<pre><code>Private Sub cbo_st_no_AfterUpdate()\n    Dim standardNo As String\n\n    If Len(Nz(Me.cbo_st_no)) = 0 Then\n        'To show nothing:\n        standardNo = \"Select * From StandardsList Where False\"\n        'To show all:\n        standardNo = \"Select * From StandardsList\"\n    Else\n        standardNo = \"Select * From StandardsList Where [st_no] = \" &amp; Me.cbo_st_no\n    End If\n\n    Me.WhoDoneItSubformy.Form.RecordSource = standardNo\n    Me.WhoDoneItSubformy.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>More info:</p>\n\n<p>If the field <code>st_no</code> is a text field then you have to wrap the value in <code>'</code>:</p>\n\n<pre><code>\"Select * From StandardsList Where [st_no] = '\" &amp; Me.cbo_st_no &amp; \"'\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1573676292, "creation_date": 1573676292, "answer_id": 58844958, "question_id": 58841949, "link": "https://stackoverflow.com/questions/58841949/access-combo-box-and-subform/58844958#58844958", "title": "Access combo box and subform", "body": "<p>The answer by <code>Unhandled Exception</code> is good, but the code can be simplified significantly, both yours and the solution. This is what I would do:</p>\n\n<pre><code>Private Sub cbo_st_no_AfterUpdate()\n    Me.WhoDoneItSubformy.RecordSource = \"SELECT * from StandardsList WHERE st_no=\" &amp; Nz(Me.cbo_st_no,0)\n    Me.WhoDoneItSubformy.Requery\nEnd Sub\n</code></pre>\n\n<p>If zero is an existing value for <code>st_no</code> use -1 or any other value guaranteed not to match an existing record.\nIf you prefer that a null value shows all records instead of none use </p>\n\n<pre><code>Nz(Me.cbo_st_no,\"st_no\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12339193, "user_type": "registered", "profile_image": "https://graph.facebook.com/607934643908/picture?type=large", "display_name": "Jessica Radliff", "link": "https://stackoverflow.com/users/12339193/jessica-radliff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573676617, "creation_date": 1573664097, "last_edit_date": 1573669949, "question_id": 58841949, "link": "https://stackoverflow.com/questions/58841949/access-combo-box-and-subform", "title": "Access combo box and subform", "body": "<p>I've got a subform on a form with a combo box. I want to select a standard number from the box and have the subform only show those records. I've run into a syntax error (missing operator) in query expression. Can someone help?</p>\n\n<pre><code>Private Sub cbo_st_no_AfterUpdate()\n\n    Dim standardNo As String\n\n    standardNo = \"Select * from StandardsList where ([st_no] = \" &amp; Me.cbo_st_no &amp; \")\"\n\n    Me.WhoDoneItSubformy.Form.RecordSource = standardNo\n    Me.WhoDoneItSubformy.Form.Requery\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "list", "file", "ms-access", "directory"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1573679836, "post_id": 58841851, "comment_id": 103965067, "body": "The code provided does not output file path and name as one value, they are separate values. Did you post Allen&#39;s original code instead of your adapted version?"}, {"owner": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1573682590, "post_id": 58841851, "comment_id": 103966260, "body": "You&#39;re right. I updated the original post with what is partially working for me."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "edited": false, "score": 0, "creation_date": 1573683470, "post_id": 58845929, "comment_id": 103966601, "body": "This isn&#39;t quite working for me. How would I isolate the FPath and the Location value fields?   I have updated my original post to reflect what is working to combine the file name and path in to one field."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "edited": false, "score": 0, "creation_date": 1573684039, "post_id": 58845929, "comment_id": 103966825, "body": "And why is it not working - error message, wrong result, nothing happens? Because it works for me. The code isolating those values is in the SQL. Ooops, I was using Debug.Print, not the SQL, in my test. Small but critical typo in the SQL syntax - was missing closing paren. I have edited. Or go back to the SELECT version instead of VALUES."}, {"owner": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "edited": false, "score": 0, "creation_date": 1573685204, "post_id": 58845929, "comment_id": 103967247, "body": "This is working to output the path and file name in the FPath field, but the Location field is not getting populated with anything. Any ideas?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "edited": false, "score": 0, "creation_date": 1573688703, "post_id": 58845929, "comment_id": 103968151, "body": "Okay, went and built table to test SQL. Went with creating a new variable because handling strFolder variable and trailing slash got too complicated. Revised Answer."}, {"owner": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "edited": false, "score": 0, "creation_date": 1573691848, "post_id": 58845929, "comment_id": 103968898, "body": "I was able to get your previous revision working by changing &quot;+ 1&quot; to &quot;- 9&quot;. All of my location folders are 9 digits long. The only trouble is, there is a trailing backslash the output. Thanks for the help!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "edited": false, "score": 0, "creation_date": 1573692086, "post_id": 58845929, "comment_id": 103968944, "body": "Then you are using Len() instead of InStrRev? Might review my latest edit of answer."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1573696666, "last_edit_date": 1573696666, "creation_date": 1573680696, "answer_id": 58845929, "question_id": 58841851, "link": "https://stackoverflow.com/questions/58841851/vba-output-previous-folder-name-in-field/58845929#58845929", "title": "VBA output previous folder name in field", "body": "<p>Declare a new variable:<br>\n<code>Dim strLocation As String</code></p>\n\n<p>Set variable and modify your SQL statement. </p>\n\n<pre><code>    'Add the files to the folder.\n    strLocation = Mid(strFolder, InStrRev(strFolder, \"\\\") + 1)\n    strFolder = TrailingSlash(strFolder)\n    strTemp = Dir(strFolder &amp; strFileSpec)\n    Do While strTemp &lt;&gt; vbNullString\n         gCount = gCount + 1\n         SysCmd acSysCmdSetStatus, gCount\n         strSQL = \"INSERT INTO Files (FPath, Location) \" _\n          &amp; \" SELECT '\" &amp; strFolder &amp; strTemp &amp; \"','\" &amp; strLocation &amp; \"'\"\n         CurrentDb.Execute strSQL\n         colDirList.Add strFolder &amp; strTemp\n         strTemp = Dir\n    Loop\n</code></pre>\n\n<p>Assumes strFolder will not have a trailing slash when extracting last subfolder.   So maybe go with this version.</p>\n\n<pre><code>strFolder = TrailingSlash(strFolder)\nstrLocation = Left(strFolder, Len(strFolder) - 1)\nstrLocation = Mid(strLocation, InStrRev(strLocation, \"\\\") + 1)\n</code></pre>\n\n<p>If you want to depend on final folder name always being 9 characters as stated in your comment, don't need strLocation variable.</p>\n\n<pre><code>strSQL = \"INSERT INTO Files (FPath, Location) \" &amp; _\n  \"SELECT '\" &amp; strFolder &amp; strTemp &amp; \"','\" &amp; Left(Mid(strFolder, Len(strFolder) - 9), 9) &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12367918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a84b8305e72dcb9c582dfd67ea3f2e?s=128&d=identicon&r=PG&f=1", "display_name": "PMcMillen", "link": "https://stackoverflow.com/users/12367918/pmcmillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 58845929, "answer_count": 1, "score": 1, "last_activity_date": 1573696666, "creation_date": 1573663766, "last_edit_date": 1573682556, "question_id": 58841851, "link": "https://stackoverflow.com/questions/58841851/vba-output-previous-folder-name-in-field", "title": "VBA output previous folder name in field", "body": "<p>I'm having trouble with figuring out how to get the name of a folder to output to a separate field in MS Access. So far I've managed to use this Allen Browne script and tweaked it to output the file name and the path as one field.</p>\n\n<p>All of the files in this search are contained within sub folders, and it is important to output the last sub folder name in a separate field for my purposes. Something like this:\n<img src=\"https://i.stack.imgur.com/BWN47.png\" alt=\"ExampleTable\"></p>\n\n<p>Here's the code:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n'list files to tables\n'http://allenbrowne.com/ser-59alt.html\n\nDim gCount As Long ' added by Crystal\n\nSub runListFiles()\n    'Usage example.\n    Dim strPath As String _\n    , strFileSpec As String _\n    , booIncludeSubfolders As Boolean\n\n    strPath = \"H:\\Pictures\\2019\"\n    strFileSpec = \"*.*\"\n    booIncludeSubfolders = True\n\n    ListFilesToTable strPath, strFileSpec, booIncludeSubfolders\nEnd Sub\n\n'crystal modified parameter specification for strFileSpec by adding default value\nPublic Function ListFilesToTable(strPath As String _\n    , Optional strFileSpec As String = \"*.*\" _\n    , Optional bIncludeSubfolders As Boolean _\n    )\nOn Error GoTo Err_Handler\n    'Purpose:   List the files in the path.\n    'Arguments: strPath = the path to search.\n    '           strFileSpec = \"*.*\" unless you specify differently.\n    '           bIncludeSubfolders: If True, returns results from subdirectories of strPath as well.\n    'Method:    FilDir() adds items to a collection, calling itself recursively for subfolders.\n\n    Dim colDirList As New Collection\n    Dim varitem As Variant\n    Dim rst As DAO.Recordset\n\n   Dim mStartTime As Date _\n      , mSeconds As Long _\n      , mMin As Long _\n      , mMsg As String\n\n   mStartTime = Now()\n   '--------\n\n    Call FillDirToTable(colDirList, strPath, strFileSpec, bIncludeSubfolders)\n\n   mSeconds = DateDiff(\"s\", mStartTime, Now())\n\n   mMin = mSeconds \\ 60\n   If mMin &gt; 0 Then\n      mMsg = mMin &amp; \" min \"\n      mSeconds = mSeconds - (mMin * 60)\n   Else\n      mMsg = \"\"\n   End If\n\n   mMsg = mMsg &amp; mSeconds &amp; \" seconds\"\n\n   MsgBox \"Done adding \" &amp; Format(gCount, \"#,##0\") &amp; \" files from \" &amp; strPath _\n      &amp; IIf(Len(Trim(strFileSpec)) &gt; 0, \" for file specification --&gt; \" &amp; strFileSpec, \"\") _\n      &amp; vbCrLf &amp; vbCrLf &amp; mMsg, , \"Done\"\n\nExit_Handler:\n   SysCmd acSysCmdClearStatus\n   '--------\n\n    Exit Function\n\nErr_Handler:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, , \"ERROR\"\n\n    'remove next line after debugged -- added by Crystal\n\n\n    Resume Exit_Handler\nEnd Function\n\nPrivate Function FillDirToTable(colDirList As Collection _\n    , ByVal strFolder As String _\n    , strFileSpec As String _\n    , bIncludeSubfolders As Boolean)\n\n    'Build up a list of files, and then add add to this list, any additional folders\n    On Error GoTo Err_Handler\n\n    Dim strTemp As String\n    Dim colFolders As New Collection\n    Dim vFolderName As Variant\n    Dim strSQL As String\n\n    'Add the files to the folder.\n    strFolder = TrailingSlash(strFolder)\n    strTemp = Dir(strFolder &amp; strFileSpec)\n    Do While strTemp &lt;&gt; vbNullString\n         gCount = gCount + 1\n         SysCmd acSysCmdSetStatus, gCount\n         strSQL = \"INSERT INTO Files \" _\n          &amp; \" (FPath) \" _\n          &amp; \" SELECT \"\"\" &amp; strFolder &amp; \"\"\"\" _\n          &amp; \"&amp; \"\"\" &amp; strTemp &amp; \"\"\";\"\n         CurrentDb.Execute strSQL\n        colDirList.Add strFolder &amp; strTemp\n        strTemp = Dir\n    Loop\n\n    If bIncludeSubfolders Then\n        'Build collection of additional subfolders.\n        strTemp = Dir(strFolder, vbDirectory)\n        Do While strTemp &lt;&gt; vbNullString\n            If (strTemp &lt;&gt; \".\") And (strTemp &lt;&gt; \"..\") Then\n                If (GetAttr(strFolder &amp; strTemp) And vbDirectory) &lt;&gt; 0&amp; Then\n                    colFolders.Add strTemp\n                End If\n            End If\n            strTemp = Dir\n        Loop\n        'Call function recursively for each subfolder.\n        For Each vFolderName In colFolders\n            Call FillDirToTable(colDirList, strFolder &amp; TrailingSlash(vFolderName), strFileSpec, True)\n        Next vFolderName\n    End If\n\nExit_Handler:\n\n    Exit Function\n\nErr_Handler:\n    strSQL = \"INSERT INTO Files \" _\n    &amp; \" (FPath) \" _\n    &amp; \" SELECT \"\"  ~~~ ERROR ~~~\"\"\" _\n    &amp; \", \"\"\" &amp; strFolder &amp; \"\"\";\"\n    CurrentDb.Execute strSQL\n\n    Resume Exit_Handler\nEnd Function\n\nPublic Function TrailingSlash(varIn As Variant) As String\n    If Len(varIn) &gt; 0&amp; Then\n        If Right(varIn, 1&amp;) = \"\\\" Then\n            TrailingSlash = varIn\n        Else\n            TrailingSlash = varIn &amp; \"\\\"\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 4, "creation_date": 1573664161, "post_id": 58841834, "comment_id": 103958006, "body": "When you protect the sheet, use <code>UserInterfaceOnly</code>.  This will allow macros to run, but no editing.  More can be found in the Microsoft documentation <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.worksheet.prot&zwnj;&#8203;ect</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573664622, "post_id": 58841834, "comment_id": 103958252, "body": "Suggestion: declare a <code>Worksheet</code> local variable and assign it to <code>ActiveWorkbook.Worksheets(&quot;January&quot;)</code> (for equivalency with the current code - if the sheet exists in the same workbook as your VBA project&#39;s host document, then that should be <code>ThisWorkbook</code> ...and then you should just have a <code>JanuarySheet</code> code name for that sheet and zero need to dereference anything anywhere). e.g. <code>Dim sheet As Worksheet</code>; <code>Set sheet = ActiveWorkbok.Worksheets(&quot;January&quot;)</code>; and then you can do <code>sheet.Range(...).Value = vbNullString</code>. Also consider <code>Union</code>-ing the ranges so you don&#39;t need to do it 100 times."}, {"owner": {"reputation": 23, "user_id": 12368063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91342c7fa6df7ec0b279816de203aeb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ceo Kevin Jones", "link": "https://stackoverflow.com/users/12368063/ceo-kevin-jones"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573670022, "post_id": 58841834, "comment_id": 103960783, "body": "Thanks to each of you. I&#39;ll start with @DarrellH since this may be easier for me because of my skill level (newbie). How do I insert that phrase into the code? Can you please provide the format? Also, by &quot;no editing&quot;, do you mean no editing to the code or to the document? If the code, that&#39;s perfect because I don&#39;t want anyone to be able to even access the code. I have 12 sheets, a sheet for each month, so I need to know what to enter to test that code you mentioned."}, {"owner": {"reputation": 23, "user_id": 12368063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91342c7fa6df7ec0b279816de203aeb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ceo Kevin Jones", "link": "https://stackoverflow.com/users/12368063/ceo-kevin-jones"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573670626, "post_id": 58841834, "comment_id": 103961039, "body": "@MathieuGuindon You probably said exactly what I need. However, I have no idea how to implement any of it. I knew what I wanted to do with the sheet I created so I googled how to do it and VBA popped up so after days of wrong coding I was finally successful. However, when I saved the doc and tried using the micro it no longer worked. My skill level and terminology recognition is almost non existent. If you can guide me bro I&#39;m willing to try your solution as well. I just need to get this done today so I can deliver as promised. Thanks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573671020, "post_id": 58841834, "comment_id": 103961198, "body": "&quot;I don&#39;t want anyone to be able to even access the code&quot; is doomed, you cannot prevent anyone from accessing your VBA code - password protection for your VBA project is about as effective as a screen door on a submarine: don&#39;t bother with that. If someone wants to see your code, they&#39;ll get to it no matter how many speedbumps you put, often in a matter of seconds."}, {"owner": {"reputation": 23, "user_id": 12368063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91342c7fa6df7ec0b279816de203aeb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ceo Kevin Jones", "link": "https://stackoverflow.com/users/12368063/ceo-kevin-jones"}, "edited": false, "score": 0, "creation_date": 1573752477, "post_id": 58841834, "comment_id": 103995971, "body": "I&#39;ve been reading that too. I saw a program that may help but yeah it appears nothing is totally foolproof. XLS Padlock seems to be a good one though. I may check it out. Saw some decent reviews for it."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12368063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91342c7fa6df7ec0b279816de203aeb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ceo Kevin Jones", "link": "https://stackoverflow.com/users/12368063/ceo-kevin-jones"}, "edited": false, "score": 1, "creation_date": 1573752610, "post_id": 58844183, "comment_id": 103996050, "body": "Works perfectly now. It&#39;s good to be able to learn what you just showed me for future sheets I create because doing things that way would have saved me a ton of time. Thanks dude!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23, "user_id": 12368063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91342c7fa6df7ec0b279816de203aeb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ceo Kevin Jones", "link": "https://stackoverflow.com/users/12368063/ceo-kevin-jones"}, "edited": false, "score": 0, "creation_date": 1573752846, "post_id": 58844183, "comment_id": 103996181, "body": "@CeoKevinJones you&#39;re welcome! If you&#39;re wondering what all these <code>@Folder</code> and <code>@Ignore</code> annotations/comments are, know that they are <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> annotations that enhance navigation and static code analysis tooling: it&#39;s free and open-source (I manage the project), and its code inspections can help you avoid <i>many</i> VBA language traps. Cheers!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1573673083, "creation_date": 1573673083, "answer_id": 58844183, "question_id": 58841834, "link": "https://stackoverflow.com/questions/58841834/run-time-error-1004-macros-dont-work-after-protecting-sheet/58844183#58844183", "title": "Run Time Error 1004: Macros Don&#39;t Work After Protecting Sheet", "body": "<p>Assuming the sheet <code>January</code> is one of 12 sheets and that all these sheets have the exact same layout and all need a similar \"clean up\" macro, I'd do it as follows.</p>\n\n<p>First, add a standard module to your VBA project if you haven't already. Give it a meaningful name, e.g. <code>CleanUpMacro</code>.</p>\n\n<p>The module would look like this - it's a bit hectic, because there doesn't seem to be any clear pattern in what's being cleared. Also, your code is clearing several cells multiple times; several ranges can be streamlined.</p>\n\n<pre><code>'@Folder(\"Macros\")\nOption Explicit\n\nPublic Sub CleanUpFields(ByVal monthSheet As Worksheet)\n    With monthSheet\n        Dim toClear As Range\n        Set toClear = .Range(\"D3,D5,G3,G4,D21,H21,L21,P21,T21,X21\")\n        Set toClear = Union(toClear, .Range(\"C14:E18,G14:AP18,C27:E31,G27:G31\"))\n        Set toClear = Union(toClear, .Range(\"D34,H34,L34,P34,T34,X34\"))\n        '...\n        toClear.ClearContents\n\n        MsgBox \"'\" &amp; .Name &amp; \"' sheet cleared!\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that the <code>,</code> comma is union-ing the ranges; the reason you would want multiple <code>Union</code> is to keep the list somewhat organized, and the address strings under 255 characters.</p>\n\n<p>If the ranges correspond to specific sections, name them. Then <code>.Range(\"theGivenName\")</code> will refer to these named ranges, and I believe they can be non-contiguous, so it's possible all you need is <code>monthSheet.Range(\"AllEditableFields\").ClearContents</code>, if each month sheet defines a sheet-scoped <code>AllEditableFields</code> named range - the advantage of this, is that it abstracts away the actual cell addresses, which means your code will not break if someone inserts a row or column somewhere, for whatever reason. It's also much easier to maintain a bunch of named ranges than a 200-liner VBA macro that refers to a bunch of individual specific cells.</p>\n\n<p>Now you'll want 12 macros that invoke this procedure, each passing a different worksheet.</p>\n\n<p>So the January sheet's code-behind might look like this:</p>\n\n<pre><code>'@Folder(\"MonthlyWorkheets\")\nOption Explicit\n\n'@Ignore ProcedureNotUsed\nPublic Sub CleanUpFields()\n    CleanUpMacro.CleanUpFields Me\nEnd Sub\n</code></pre>\n\n<p>And the February sheet's code-behind might look like this:</p>\n\n<pre><code>'@Folder(\"MonthlyWorkheets\")\nOption Explicit\n\n'@Ignore ProcedureNotUsed\nPublic Sub CleanUpFields()\n    CleanUpMacro.CleanUpFields Me\nEnd Sub\n</code></pre>\n\n<p>And the March sheet's code-behind might look like this:</p>\n\n<pre><code>'@Folder(\"MonthlyWorkheets\")\nOption Explicit\n\n'@Ignore ProcedureNotUsed\nPublic Sub CleanUpFields()\n    CleanUpMacro.CleanUpFields Me\nEnd Sub\n</code></pre>\n\n<p>And ...well you get the idea :)</p>\n\n<p>At that point all that's left to do is to wire up some <code>Shape</code> on the sheet to run the sheet's <code>CleanUpFields</code> macro when clicked, and we're done.</p>\n\n<p>If you're using an ActiveX <code>CommandButton</code>, then your worksheets' code-behind might look like this instead:</p>\n\n<pre><code>'@Folder(\"MonthlyWorkheets\")\nOption Explicit\n\n'@Ignore ProcedureNotUsed\nPrivate Sub CleanUpButton_Click()\n    CleanUpMacro.CleanUpFields Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12368063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91342c7fa6df7ec0b279816de203aeb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ceo Kevin Jones", "link": "https://stackoverflow.com/users/12368063/ceo-kevin-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58844183, "answer_count": 1, "score": 2, "last_activity_date": 1573673083, "creation_date": 1573663715, "last_edit_date": 1573668122, "question_id": 58841834, "link": "https://stackoverflow.com/questions/58841834/run-time-error-1004-macros-dont-work-after-protecting-sheet", "title": "Run Time Error 1004: Macros Don&#39;t Work After Protecting Sheet", "body": "<p>I created a worksheet for my team and other agents in my field to help track sales and sales projections for each month of the year. However, everytime I set a password and save the file I get an error message stating:</p>\n\n<blockquote>\n  <p>Run-time error 1004 Application defined or object defined error</p>\n</blockquote>\n\n<p>My code is below. Please help. I don't want to share this file unprotected. How can I protect each worksheet and still have Macros enabled without someone having to put in a code or being allowed to unprotect then protect, which would give them access to my code. Here is my code:</p>\n\n<pre><code>Public Sub ResetValues_Click()\n\nSheets(\"January\").Range(\"D3:D3\").Value = \"\"\nSheets(\"January\").Range(\"D21:D21\").Value = \"\"\nSheets(\"January\").Range(\"H21:H21\").Value = \"\"\nSheets(\"January\").Range(\"L21:L21\").Value = \"\"\nSheets(\"January\").Range(\"P21:P21\").Value = \"\"\nSheets(\"January\").Range(\"T21:T21\").Value = \"\"\nSheets(\"January\").Range(\"X21:X21\").Value = \"\"\nSheets(\"January\").Range(\"D5:D5\").Value = \"\"\nSheets(\"January\").Range(\"G3:G3\").Value = \"\"\nSheets(\"January\").Range(\"G4:G4\").Value = \"\"\nSheets(\"January\").Range(\"C14:C18\").Value = \"\"\nSheets(\"January\").Range(\"G14:G18\").Value = \"\"\nSheets(\"January\").Range(\"D14:D18\").Value = \"\"\nSheets(\"January\").Range(\"E14:E18\").Value = \"\"\nSheets(\"January\").Range(\"G18:AP18\").Value = \"\"\nSheets(\"January\").Range(\"G17:AP17\").Value = \"\"\nSheets(\"January\").Range(\"G16:AP16\").Value = \"\"\nSheets(\"January\").Range(\"G15:AP15\").Value = \"\"\nSheets(\"January\").Range(\"G14:AP14\").Value = \"\"\nSheets(\"January\").Range(\"C27:C31\").Value = \"\"\nSheets(\"January\").Range(\"D27:D31\").Value = \"\"\nSheets(\"January\").Range(\"E27:E31\").Value = \"\"\nSheets(\"January\").Range(\"G27:G31\").Value = \"\"\nSheets(\"January\").Range(\"D34:D34\").Value = \"\"\nSheets(\"January\").Range(\"H34:H34\").Value = \"\"\nSheets(\"January\").Range(\"L34:L34\").Value = \"\"\nSheets(\"January\").Range(\"P34:P34\").Value = \"\"\nSheets(\"January\").Range(\"T34:T34\").Value = \"\"\nSheets(\"January\").Range(\"X34:X34\").Value = \"\"\nSheets(\"January\").Range(\"G27:AP27\").Value = \"\"\nSheets(\"January\").Range(\"G28:AP28\").Value = \"\"\nSheets(\"January\").Range(\"G29:AP29\").Value = \"\"\nSheets(\"January\").Range(\"G30:AP30\").Value = \"\"\nSheets(\"January\").Range(\"G31:AP31\").Value = \"\"\nSheets(\"January\").Range(\"C40:C44\").Value = \"\"\nSheets(\"January\").Range(\"D40:D44\").Value = \"\"\nSheets(\"January\").Range(\"E40:E44\").Value = \"\"\nSheets(\"January\").Range(\"D47:D47\").Value = \"\"\nSheets(\"January\").Range(\"G40:G44\").Value = \"\"\nSheets(\"January\").Range(\"G40:AP40\").Value = \"\"\nSheets(\"January\").Range(\"G41:AP41\").Value = \"\"\nSheets(\"January\").Range(\"G42:AP42\").Value = \"\"\nSheets(\"January\").Range(\"G43:AP43\").Value = \"\"\nSheets(\"January\").Range(\"G44:AP44\").Value = \"\"\nSheets(\"January\").Range(\"H47:H47\").Value = \"\"\nSheets(\"January\").Range(\"L47:L47\").Value = \"\"\nSheets(\"January\").Range(\"P47:P47\").Value = \"\"\nSheets(\"January\").Range(\"T47:T47\").Value = \"\"\nSheets(\"January\").Range(\"X47:X47\").Value = \"\"\nSheets(\"January\").Range(\"C53:C57\").Value = \"\"\nSheets(\"January\").Range(\"D53:D57\").Value = \"\"\nSheets(\"January\").Range(\"E53:E57\").Value = \"\"\nSheets(\"January\").Range(\"G53:G47\").Value = \"\"\nSheets(\"January\").Range(\"G53:AP53\").Value = \"\"\nSheets(\"January\").Range(\"G54:AP54\").Value = \"\"\nSheets(\"January\").Range(\"G55:AP55\").Value = \"\"\nSheets(\"January\").Range(\"G56:AP56\").Value = \"\"\nSheets(\"January\").Range(\"G57:AP57\").Value = \"\"\nSheets(\"January\").Range(\"D60:D60\").Value = \"\"\nSheets(\"January\").Range(\"H60:H60\").Value = \"\"\nSheets(\"January\").Range(\"L60:L60\").Value = \"\"\nSheets(\"January\").Range(\"P60:P60\").Value = \"\"\nSheets(\"January\").Range(\"T60:T60\").Value = \"\"\nSheets(\"January\").Range(\"X60:X60\").Value = \"\"\nSheets(\"January\").Range(\"C66:C70\").Value = \"\"\nSheets(\"January\").Range(\"D66:D70\").Value = \"\"\nSheets(\"January\").Range(\"E66:E70\").Value = \"\"\nSheets(\"January\").Range(\"G66:G70\").Value = \"\"\nSheets(\"January\").Range(\"D73:D73\").Value = \"\"\nSheets(\"January\").Range(\"G66:AP66\").Value = \"\"\nSheets(\"January\").Range(\"G67:AP67\").Value = \"\"\nSheets(\"January\").Range(\"G68:AP68\").Value = \"\"\nSheets(\"January\").Range(\"G69:AP69\").Value = \"\"\nSheets(\"January\").Range(\"G70:AP70\").Value = \"\"\nSheets(\"January\").Range(\"H73:H73\").Value = \"\"\nSheets(\"January\").Range(\"L73:L73\").Value = \"\"\nSheets(\"January\").Range(\"P73:P73\").Value = \"\"\nSheets(\"January\").Range(\"T73:T73\").Value = \"\"\nSheets(\"January\").Range(\"X73:X73\").Value = \"\"\n\nMsgBox \"Values Successfully Reset!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1573664269, "post_id": 58841780, "comment_id": 103958055, "body": "Side note - I suggest that you use sheet code names instead of String constants for your worksheets."}, {"owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573664771, "post_id": 58841780, "comment_id": 103958326, "body": "still pretty new to this, what is the benefit?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573664900, "post_id": 58841780, "comment_id": 103958383, "body": "More details <a href=\"https://stackoverflow.com/questions/41477794/refer-to-sheet-using-codename\">here</a>."}, {"owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573837308, "post_id": 58841780, "comment_id": 104030322, "body": "Do you think that solution will fix my problem?"}], "owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1573664172, "creation_date": 1573663555, "last_edit_date": 1573664172, "question_id": 58841780, "link": "https://stackoverflow.com/questions/58841780/how-to-keep-formula-and-formatting-after-a-copy-and-clear-data-macro-excel", "title": "How to keep formula and formatting after a copy and clear data macro Excel", "body": "<p>I have some VBA code that links to a button when clicked the data on Sheet1 will copy to Sheet2 and clear the data on Sheet1. My problem is the formulas and formatting on Sheet1 will ultimately end up being erased as well. In the past i was able to use constants under find and select but this is not working. Is there any code I could add to make sure Sheet1 keeps the formulas and formatting, I do not need them on sheet2 but if it is easier to keep them than that would work as well</p>\n\n<pre><code> Sub CopyPasteClear()\n\n'Source\nConst cSource As String = \"Receive Tracker\"   ' Worksheet Name\nConst cFirstRsrc As Long = 7                  ' First Row Number\nConst cClr As String = \"A7,J7\"                ' Clear Cells\nConst cRowClr As Long = 7                     ' First Clear Row\nConst cFinal As String = \"A7\"                ' Final Select Cell Address\n' Target\nConst cTarget As String = \"ReceiveData\"              ' Worksheet Name\n' Both\nConst cCol1 As Variant = \"A\"                  ' First Column Letter/Number\nConst cCol2 As Variant = \"J\"                  ' Second Column Letter/Number\n\nDim vntVal As Variant   ' Value Array\nDim LastRsrc As Long    ' Source Last Row Number\nDim LastRtgt As Long    ' Target Last Row Number\n\n' Source Range into Source Array\nWith ThisWorkbook.Worksheets(cSource)\n    ' Calculate Source Last Row Number of First Column.\n    LastRsrc = .Columns(cCol1).Find(\"*\", , -4123, , 2, 2).Row\n    ' Prevent copying data above First Row. Rows from First Row to\n    ' one less than First Clear Row will still be copied. To prevent this,\n    ' change cFirstRsrc to cRowClr in the following line only.\n    If LastRsrc &lt; cFirstRsrc Then Exit Sub\n    ' Copy Source Range into Source Array\n    vntVal = .Range(.Cells(cFirstRsrc, cCol1), .Cells(LastRsrc, cCol2))\nEnd With\n\n' Source Array into Target Range\nWith ThisWorkbook.Worksheets(cTarget)\n    ' Calculate Target Last Row Number of First Column.\n    LastRtgt = .Columns(cCol1).Find(\"*\", , -4123, , 2, 2).Row\n    ' Copy Source Array into Target Range. Note that Target Last Row\n    ' Number has to be inreased by 1 to get the first empty row.\n    .Cells(LastRtgt + 1, cCol1) _\n            .Resize(UBound(vntVal), UBound(vntVal, 2)) = vntVal\nEnd With\n\nWith ThisWorkbook.Worksheets(cSource)\n    ' Prevent deleting data above First Clear Row.\n    If LastRsrc &lt; cRowClr Then Exit Sub\n    ' Clear contents of Clear Cells and modified Source Range.\n    Union(.Range(cClr), .Range(.Cells(cRowClr, cCol1), _\n            .Cells(LastRsrc, cCol2))).ClearContents\n    ' Activate Source Worksheet if it is not active (not the ActiveSheet).\n    ' The following Select method will produce an error if the program\n    ' was started while a different worksheet than the Source Worksheet\n    ' was active.\n    If .Parent.ActiveSheet.Name &lt;&gt; .Name Then\n        .Activate\n    End If\n    ' Select Final Select Cell.\n    .Range(cFinal).Select\nEnd With\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ibm-doors"], "answers": [{"tags": [], "owner": {"reputation": 426, "user_id": 8534345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d762686d612f4fffe96eb9ac979286f9?s=128&d=identicon&r=PG&f=1", "display_name": "Russell Bregman", "link": "https://stackoverflow.com/users/8534345/russell-bregman"}, "is_accepted": false, "score": 0, "last_activity_date": 1573775943, "creation_date": 1573775943, "answer_id": 58868348, "question_id": 58841695, "link": "https://stackoverflow.com/questions/58841695/run-dxl-from-vba/58868348#58868348", "title": "Run DXL from VBA", "body": "<p>Yes.</p>\n\n<p>You can run a DOORS dxl script via command line- and you can run in batch mode if you don't want to open the DOORS interface to the user.</p>\n\n<p>Be aware some behaviors of DOORS are different in batch mode.</p>\n"}], "owner": {"reputation": 47, "user_id": 6425922, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/486596abda80a1b82d657b29652f335c?s=128&d=identicon&r=PG&f=1", "display_name": "user6425922", "link": "https://stackoverflow.com/users/6425922/user6425922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573775943, "creation_date": 1573663280, "last_edit_date": 1573720598, "question_id": 58841695, "link": "https://stackoverflow.com/questions/58841695/run-dxl-from-vba", "title": "Run DXL from VBA", "body": "<p>Is there is any way to execute doors dxl from Excel VBA?</p>\n"}, {"tags": ["excel", "vba", "robustness"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1573662400, "post_id": 58841409, "comment_id": 103957002, "body": "<code>wks.Range(&quot;A1&quot;,lookUp).EntireRow.Delete</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1573662486, "post_id": 58841409, "comment_id": 103957063, "body": "@ScottCraner - probably <code>lookUp.offset(-1)</code>."}, {"owner": {"reputation": 61, "user_id": 11442234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30221d1179a13aaf6d84e7f7544db79c?s=128&d=identicon&r=PG&f=1", "display_name": "radeg", "link": "https://stackoverflow.com/users/11442234/radeg"}, "edited": false, "score": 0, "creation_date": 1573668566, "post_id": 58841409, "comment_id": 103960151, "body": "wks.range(&quot;A1&quot;, lookup.offset(-1)).EntireRow.Delete did the trick"}], "owner": {"reputation": 61, "user_id": 11442234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30221d1179a13aaf6d84e7f7544db79c?s=128&d=identicon&r=PG&f=1", "display_name": "radeg", "link": "https://stackoverflow.com/users/11442234/radeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573664169, "creation_date": 1573662285, "last_edit_date": 1573664169, "question_id": 58841409, "link": "https://stackoverflow.com/questions/58841409/how-can-i-delete-all-rows-above-a-specific-row", "title": "How can I delete all rows above a specific row?", "body": "<p>I am working on some code that imports data from an external source; the issue however is that the header row sometimes contains blank rows above it. Since these rows are unnecessary, I would like to delete all rows above the header row.</p>\n\n<p>Currently, I have the below code looking for a word in the header row (the word \"organization\") and deleting the row above. Ideally, I would like to make the code more robust as the amount of rows above the header row varies from time to time. If I can somehow get the code to delete all rows above the header, I would be more than satisfied.</p>\n\n<pre><code>Option Explicit\n\nDim wks As Worksheet\nDim strSearch As String\nDim lookUp As Range\n\nPrivate Sub cmdRefresh_Click()\n\nSet wks = Sheets(\"Data\")\nwks.Activate\n\n'Delete rows (if any) above header row\nstrSearch = \"Organization\"\nSet lookUp = wks.Cells.Find(what:=strSearch, lookat:=xlWhole, searchorder:=xlByRows, MatchCase:=False)\nlookUp.Select\n\nIf lookUp.Row &lt;&gt; 1 Then\n    wks.Range(lookUp, lookUp.Offset(-1)).EntireRow.Delete\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "colors", "pie-chart"], "comments": [{"owner": {"reputation": 1, "user_id": 12367709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c3c46e634230df717bd7919cadf08c?s=128&d=identicon&r=PG&f=1", "display_name": "Rfur", "link": "https://stackoverflow.com/users/12367709/rfur"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573815924, "post_id": 58840881, "comment_id": 104018979, "body": "Hi and thanks for your reply. There aren&#39;t any errors showing when I open up VB. I&#39;ll try and share a picture of the graphs so I can clarify what I&#39;m attempting to do."}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1574397775, "creation_date": 1574397775, "answer_id": 58987658, "question_id": 58840881, "link": "https://stackoverflow.com/questions/58840881/update-colours-of-pie-chart-segments-to-the-cell-fill-colours/58987658#58987658", "title": "Update colours of pie chart segments to the cell fill colours", "body": "<p>With minor adjustments, this worked fine:</p>\n\n<pre><code>Private Sub SheetActivate()\n    Dim cht As ChartObject\n    Dim i As Long\n    Dim vntValues As Variant\n    Dim s As String\n    Dim mySeries As Series\n\n    For Each cht In ActiveSheet.ChartObjects\n\n        For Each mySeries In cht.Chart.SeriesCollection\n\n            If mySeries.ChartType &lt;&gt; xlPie Then GoTo SkipNotPie\n\n            s = Split(mySeries.Formula, \",\")(2)\n            vntValues = mySeries.Values\n\n            For i = 1 To UBound(vntValues)\n                mySeries.Points(i).Interior.Color = Range(s).Cells(i).Interior.Color\n            Next i\nSkipNotPie:\n        Next mySeries\n    Next cht\nEnd Sub\n</code></pre>\n\n<p>Make sure you don't have <code>Option Base 1</code> at the top of the module. If you do, then change</p>\n\n<pre><code>            s = Split(mySeries.Formula, \",\")(2)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>            s = Split(mySeries.Formula, \",\")(3)\n</code></pre>\n\n<p>I haven't used <code>Option Base 1</code> since I learned to count starting at zero.</p>\n"}], "owner": {"reputation": 1, "user_id": 12367709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c3c46e634230df717bd7919cadf08c?s=128&d=identicon&r=PG&f=1", "display_name": "Rfur", "link": "https://stackoverflow.com/users/12367709/rfur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582260251, "creation_date": 1573660480, "last_edit_date": 1582260251, "question_id": 58840881, "link": "https://stackoverflow.com/questions/58840881/update-colours-of-pie-chart-segments-to-the-cell-fill-colours", "title": "Update colours of pie chart segments to the cell fill colours", "body": "<p>I'm trying to colour my pie chart segments, according to the cells the data is drawn from, using Excel 2016.</p>\n\n<p>I pinched code from a YouTube <a href=\"https://www.youtube.com/watch?v=tm0j4dstJiI\" rel=\"nofollow noreferrer\">video</a> but this is hard to read in places (1, l &amp; i are particularly hard to differentiate) so I'm not convinced I have it right.</p>\n\n<pre><code>Private Sub SheetActivate(ByVal Sh As Object)\nDim cht As ChartObject\nDim i As Integer\nDim vntValues As Variant\nDim s As String\nDim mySeries As Series\n\nFor Each cht In ActiveSheet.ChartObjects\n\n    For Each mySeries In cht.Chart.SeriesCollection\n\n        If mySeries.ChartType &lt;&gt; xlPie Then GoTo SkipNotPie\n\n        s = Split(mySeries.Formula, \",\")(2)\n        vntValues = mySeries.Values\n\n        For i = 1 To UBound(vntValues)\n            mySeries.Points(i).Interior.Color = Range(s).Cells(i).Interior.Color\n        Next l\nSkipNotPie:\n    Next mySeries\nNext cht\n\nEnd Sub\n</code></pre>\n\n<p>Update: here is a snip showing the charts - I'm trying to update the chart segments to represent the cell fill colours in the second column.<br>\n<a href=\"https://i.stack.imgur.com/8Laru.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Laru.png\" alt=\"Table &amp; Charts\"></a></p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1573660841, "post_id": 58840814, "comment_id": 103956053, "body": "Ranges being unioned are all set and all on the same worksheet?"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573661431, "post_id": 58840814, "comment_id": 103956399, "body": "There are no named ranges in the worksheet itself.  These are programatically defined ranges in VBA.  An example would be Set Module1.Fixed = ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1,C3,F40&quot;)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573661525, "post_id": 58840814, "comment_id": 103956459, "body": "I wasn&#39;t asking about named ranges - I was asking if all the range variables were set to a range before being used in Union, and if they&#39;re all on the same worksheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1573661656, "post_id": 58840814, "comment_id": 103956523, "body": "Try adding Debug.Print  <code>Module1.Fixed.Address(), Module1.Fixed.Parent.Name</code> and the same for Drive just before the failing <code>Union</code> call"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573661669, "post_id": 58840814, "comment_id": 103956533, "body": "All base ranges are set to a range on workbook open.  This particular range however, is the one that is made up of range variables that are adjusted per user input (selecting check boxes).  The unions based on the checkboxes seem to work but this final union to make the final check set fails."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573662186, "post_id": 58840814, "comment_id": 103956880, "body": "Sorry for my ignorance but you must have meant me to alter part of your suggested debug line as it fails for me."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1573662425, "post_id": 58840814, "comment_id": 103957017, "body": "If you fill your <code>Module1</code>-Variables at Workbook-Open and run your code later: Are you sure that all your variables are still filled? There are several things that could cause that they where reset in the meantime: Unhandled errors, code recompile and some more."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573663057, "post_id": 58840814, "comment_id": 103957421, "body": "I assume that&#39;s what Tim was having me check for, I&#39;m just having trouble formatting the debug commands to work right."}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573663911, "post_id": 58840814, "comment_id": 103957894, "body": "Ok, I think I formatted them correctly.  The issue is apparently with how I&#39;m handling my dynamic ranges.  They are definitely &quot;nothing&quot; per the debug which will error the union.  I think I&#39;m beginning to understand the issues I&#39;m having are with variables being flushed on error and/or needing initialized differently."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "is_accepted": true, "score": 0, "last_activity_date": 1573664079, "creation_date": 1573664079, "answer_id": 58841939, "question_id": 58840814, "link": "https://stackoverflow.com/questions/58840814/why-am-i-getting-an-invalid-procedure-call-or-argument-on-a-range-union/58841939#58841939", "title": "Why am I getting an Invalid Procedure call or argument on a Range union", "body": "<p>I was trying to union a range that was \"nothing\" which always throws an error with Application.Union</p>\n\n<p>Adding the following code:</p>\n\n<pre><code>Debug.Print Module1.Fixed.Address, Module1.Fixed.Parent.Name\nDebug.Print Drive.Address, Drive.Parent.Name\n</code></pre>\n\n<p>helped me troubleshoot and see what was going on.</p>\n"}], "owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 58841939, "answer_count": 1, "score": 1, "last_activity_date": 1573664079, "creation_date": 1573660258, "question_id": 58840814, "link": "https://stackoverflow.com/questions/58840814/why-am-i-getting-an-invalid-procedure-call-or-argument-on-a-range-union", "title": "Why am I getting an Invalid Procedure call or argument on a Range union", "body": "<p>As the final step before checking for blank cells, I create a range to use in the check.  That range is based on some fixed sets and how the sets go together is variable.  All the application.unions work fine except for the final one.  I had all my variables defined globally in a module, I tried taking the sub specific variables and defining them just in my sub.  I made sure to remove one set that isn't finished because it might be empty.  I still get an Invalid Procedure error.</p>\n\n<p>The public variables are in Module1.  There is a sub that runs on workbook open that defines the ranges being used.  Here is the sub running before save:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nDim Drive As Range\nDim Stage As Range\nDim Required As Range\n\n'Create the final range of cells for checking\nIf Module1.DriveChk = \"G\" Then\n    Set Drive = Module1.Engine\nElseIf Module1.DriveChk = \"E\" Then\n    Set Drive = Module1.Motor\nEnd If\n\nIf Module1.StageChk = 1 Then\n    Set Stage = Module1.Stage1\nEnd If\n\nIf Module1.StageChk = 2 Then\n    Set Stage = Application.Union(Module1.Stage1, Module1.Stage2)\nEnd If\n\nIf Module1.StageChk = 3 Then\n    Set Stage = Application.Union(Module1.Stage1, Module1.Stage2, Module1.Stage3)\nEnd If\n\nSet Required = Application.Union(Module1.Fixed, Drive)\n\n'Check if all required cells are filled in\nIf WorksheetFunction.CountA(Required) &lt; Required.Count Then\n    Cancel = True\n    MsgBox \"Please Completed Shaded Cells!\", vbOK + vbExclamation, \"SAVE CANCELLED\"\n\nEnd If\n\n'Set the report date before saving\nRange(\"AG60\") = Format(Now(), \"mm-dd-yyyy hh:mm:ss AM/PM\")\n\n'Old code probably to ensure saving macro enabled that is currently commented out\n'  Dim sFN As String\n '   If SaveAsUI Then\n  '      Cancel = True\n   '     sFN = Application.GetSaveAsFilename(, _\n    '       fileFilter:=\"Excel Macro-Enabled Workbooks (*.xlsm),*.xlsm\")\n     '   Debug.Print sFN\n      '  If sFN &lt;&gt; \"False\" Then _\n       '     ThisWorkbook.SaveAs sFN, xlOpenXMLWorkbookMacroEnabled\n    'End If\nEnd Sub\n</code></pre>\n\n<p>The error occurs on Set Required = Application.Union(Module1.Fixed, Drive)</p>\n\n<p>I can post the other code if needed.</p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1573660105, "post_id": 58840562, "comment_id": 103955631, "body": "Do you want the function itself inserted into the cells, or just the result of it&#39;s calculations?"}, {"owner": {"reputation": 19, "user_id": 9718943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d949b96adb0c0a79d9d093e4eea55e00?s=128&d=identicon&r=PG&f=1", "display_name": "gsawdy", "link": "https://stackoverflow.com/users/9718943/gsawdy"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1573660963, "post_id": 58840562, "comment_id": 103956117, "body": "Just the results of the calculations."}, {"owner": {"reputation": 19, "user_id": 9718943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d949b96adb0c0a79d9d093e4eea55e00?s=128&d=identicon&r=PG&f=1", "display_name": "gsawdy", "link": "https://stackoverflow.com/users/9718943/gsawdy"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1573663060, "post_id": 58840562, "comment_id": 103957425, "body": "Now that I think about it, either way is fine. Would the function be entered into the VBA as &quot;text&quot;?"}, {"owner": {"reputation": 1651, "user_id": 7004653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f467ac348911486e70d074f19a42871?s=128&d=identicon&r=PG&f=1", "display_name": "RNHTTR", "link": "https://stackoverflow.com/users/7004653/rnhttr"}, "edited": false, "score": 0, "creation_date": 1573663251, "post_id": 58840562, "comment_id": 103957531, "body": "you might be able to use <code>Application.WorksheetFunction.&lt;your function&gt;</code>. You might be able to look around <a href=\"https://spreadsheeto.com/vba-vlookup/\" rel=\"nofollow noreferrer\">here</a> for help."}, {"owner": {"reputation": 19, "user_id": 9718943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d949b96adb0c0a79d9d093e4eea55e00?s=128&d=identicon&r=PG&f=1", "display_name": "gsawdy", "link": "https://stackoverflow.com/users/9718943/gsawdy"}, "edited": false, "score": 0, "creation_date": 1573679065, "post_id": 58840562, "comment_id": 103964718, "body": "I tried that, that&#39;s what I have been fighting with and don&#39;t have time now."}, {"owner": {"reputation": 19, "user_id": 9718943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d949b96adb0c0a79d9d093e4eea55e00?s=128&d=identicon&r=PG&f=1", "display_name": "gsawdy", "link": "https://stackoverflow.com/users/9718943/gsawdy"}, "edited": false, "score": 0, "creation_date": 1573744643, "post_id": 58840562, "comment_id": 103991114, "body": "Then why bother at all? Just move on and actually, I am familiar with arrays and functions, I posted a function i created in excel in the comment. I am just trying to convert it to a VBA format, that&#39;s all I was asking for."}], "owner": {"reputation": 19, "user_id": 9718943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d949b96adb0c0a79d9d093e4eea55e00?s=128&d=identicon&r=PG&f=1", "display_name": "gsawdy", "link": "https://stackoverflow.com/users/9718943/gsawdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574459867, "creation_date": 1573659460, "last_edit_date": 1574459867, "question_id": 58840562, "link": "https://stackoverflow.com/questions/58840562/how-to-insert-a-function-into-my-code-block", "title": "How to insert a function into my code block", "body": "<p>I would like to insert a function in this vba code block. What I am trying to do here is look for matches based on two criteria. The first criteria is their ID(Col:B) and the second is the amount they paid (Col:C). The idea being that the function would then cycle through the columns referenced and return the index function until the end of the data.</p>\n\n<p>The VBA code block is listed below:</p>\n\n<p>Update:</p>\n\n<blockquote>\n<pre><code>Last = Cells(Rows.Count, \"B\").End(xlUp).Row\nFor i = Last To 1 Step -1\n    If (Cells(i, \"B\").Value) &gt; 0 And (Cells(i, \"C\").Value) &gt; 0 Then\n    Cells(i, \"D\") = \"=IFERROR(INDEX($F$2:$F$500,MATCH(1,INDEX((B2 = $G$2:$G$500)*(C2=$H$2:$H$500),0,1),0)), No Match)\"\n    End If\nNext i\n</code></pre>\n</blockquote>\n\n<p>This will now paste the function into the cells. I am having two problems:</p>\n\n<ol>\n<li><p>I need to figure out how to use a range in the \"D\" column so that it adjusts the cell selection one down as the function pastes down. I know the \"Range\" does this, but I want it to stop when there is no longer any data, range will continue past the end of the data to the cell selected for the range end, and the way it's set up now stops at the end of the data. </p></li>\n<li><p>The \"No Match\" part isn't transfering over because it has something to do with the quotes. It's reconginizing it as something different than text. </p></li>\n</ol>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573660117, "post_id": 58840543, "comment_id": 103955643, "body": "<code>&quot;UPDATE [People] &quot; &amp; SET [Machine] = &#39;&quot;</code> this doesn&#39;t look right, should it be <code>&quot;UPDATE [People] SET [Machine] = &#39;&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1573669089, "post_id": 58840851, "comment_id": 103960374, "body": "That&#39;s not the issue. See the duplicate, this is a highly specific issue introduced by a Windows Update."}], "tags": [], "owner": {"reputation": 128, "user_id": 12195276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xkJTbt3sa_M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceWScWVfOMzwJOwm-w9LM8na_Aqg/photo.jpg?sz=128", "display_name": "tomBob", "link": "https://stackoverflow.com/users/12195276/tombob"}, "is_accepted": false, "score": 0, "last_activity_date": 1573660381, "creation_date": 1573660381, "answer_id": 58840851, "question_id": 58840543, "link": "https://stackoverflow.com/questions/58840543/an-access-database-vba-update-sql-command-has-stopped-working-after-microsoft-n/58840851#58840851", "title": "An access database vba UPDATE SQL command has stopped working after Microsoft .NET Framework 4.8 Version 4.8.03761 installation today", "body": "<p>Looks like your SQL String could cause the issue. You have SET and WHERE out of the string</p>\n\n<pre><code>TEST_SQL_command = \"UPDATE [People] SET [Machine] = '\" &amp; ComputerUsed &amp; \"' WHERE [Personid] = \" &amp; UserPersonID &amp; \";\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12367674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BnTrSz5T7pc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regedwCs3ol81V5eVMc9DsVul0nww/photo.jpg?sz=128", "display_name": "Nath Parry", "link": "https://stackoverflow.com/users/12367674/nath-parry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "closed_date": 1573669330, "answer_count": 1, "score": 0, "last_activity_date": 1573667539, "creation_date": 1573659395, "last_edit_date": 1573667539, "question_id": 58840543, "link": "https://stackoverflow.com/questions/58840543/an-access-database-vba-update-sql-command-has-stopped-working-after-microsoft-n", "closed_reason": "Duplicate", "title": "An access database vba UPDATE SQL command has stopped working after Microsoft .NET Framework 4.8 Version 4.8.03761 installation today", "body": "<p>An access database vba <code>UPDATE SQL</code> command has stopped working after <strong>Microsoft .NET Framework 4.8 Version 4.8.03761 installation</strong> today.</p>\n\n<p>Users encounter the message: </p>\n\n<pre><code>\"Run-time error '3340': Query \" is corrupt.\n</code></pre>\n\n<p>The code that now fails is:</p>\n\n<pre><code>Public Function UpdateMachine()\n\nDim TEST_SQL_command As String\n\nTEST_SQL_command = \"UPDATE [People] \" &amp; SET [Machine] = '\" &amp; ComputerUsed &amp; \"' WHERE [Personid] = \" &amp; UserPersonID &amp; \";\"\n\nDoCmd.SetWarnings False\nDoCmd.RunSQL (TEST_SQL_Command)\nDoCmd.SetWarning True\n\nDoCmd.Save\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1573659517, "post_id": 58840397, "comment_id": 103955224, "body": "Office Ribbon Customizations are better handled with the Ribbon X Editor <a href=\"https://github.com/fernandreu/office-ribbonx-editor\" rel=\"nofollow noreferrer\">github.com/fernandreu/office-ribbonx-editor</a> Here some reference: <a href=\"https://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s2/win001.htm</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573659534, "post_id": 58840397, "comment_id": 103955244, "body": "Do you mean you open another <code>xlsm</code> file before or after you delete the controls? Bacause if you edit the ribbon like that it is applied to the <code>Application</code> which means it is visible in all Excel-Files you open until you delete the controls."}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 0, "creation_date": 1573659761, "post_id": 58840397, "comment_id": 103955393, "body": "@Peh, I close the file which has the customization for the ribbon. After that I open normal .xls file then menu is not visible. However if I open a copy of that file from where I have deleted almost everthing ,  I mean literally everything and the extension is .xlsm, it still bring up the custom menu. I am baffled."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573659868, "post_id": 58840397, "comment_id": 103955474, "body": "does it also happen if you create a brand new <code>xlsm</code> file?"}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 0, "creation_date": 1573659949, "post_id": 58840397, "comment_id": 103955530, "body": "@PeH, when I say copy of the file, I meant copy of the file which had custom code for ribbon and menu. But like I said, I have deleted everything from this file, but still menu comes up. Actually I received the code from somewhere and now I need to change the entries in custom menu, but unable to do so. Hence trying to remove everything to understand where the custom entries are coming from."}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 0, "creation_date": 1573659985, "post_id": 58840397, "comment_id": 103955556, "body": "@PeH, it does not happen if I create a new xlsm file."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573660847, "post_id": 58840397, "comment_id": 103956059, "body": "@Alok Then you didn&#39;t delete the VBA code properly or your file is corrupt. If I add your code to a file save it. Copy it. Delete the code, and save it. And open it it doesn&#39;t happen. So I cannot reproduce your issue."}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "edited": false, "score": 0, "creation_date": 1573662122, "post_id": 58840397, "comment_id": 103956832, "body": "@PeH Is there a way to share the file with you"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573664401, "post_id": 58840397, "comment_id": 103958131, "body": "@Alok Sorry no one here wants neither a corrupt file nor a file with VBA code from a unknown source that is known to cause weird stuff. Re-Check your VBA codes, or create a new file and copy over the data to the new file to solve it. Or save it as <code>xlsx</code> to remove all the VBA code, and then re-save it as <code>xlsm</code> and insert only the macros you need. Any of these solutions should fix it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573667509, "post_id": 58840397, "comment_id": 103959630, "body": "@P\u1d07\u029c I expect what is happening is that the toolbar customizations aren&#39;t being removed - that the VBA in the question hasn&#39;t completely removed them. Just deleting that VBA won&#39;t remove toolbar customizations that may be saved in the workbook, will it? (If this were Word, the problem would have entirely different dimensions, which was one very positive side of getting Ribbon XML in place of CommandBars...)"}, {"owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573719673, "post_id": 58840397, "comment_id": 103976736, "body": "@Cindy Meister, are you saying that even if one deletes the entire VBA, the .xlsm file still has some location within it to save the toolbard customizations, which results in menu showing up when we open that file."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573722384, "post_id": 58840397, "comment_id": 103978095, "body": "@Alok no, that&#39;s not the case. Again I assume your file is corrupt. You can test it doing the following: \u2460 Open a new Excel file. Add a module and insert your code (the first part). Run it so the menu gets added. \u2461 Save that file with the menu visible. Close it without deleting the menu. \u2462 Re-open that file: And the menu is gone. That means the menu only persists until you close Excel completely or until you remove the menu (using the last procedure of your code). \u2022 The menu is NOT saved in the file."}], "owner": {"reputation": 127, "user_id": 205983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27832716ae6b4b4e978128dad52bb1db?s=128&d=identicon&r=PG", "display_name": "Alok", "link": "https://stackoverflow.com/users/205983/alok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573667162, "creation_date": 1573658917, "last_edit_date": 1573667162, "question_id": 58840397, "link": "https://stackoverflow.com/questions/58840397/custom-ribbon-in-excel-2016-using-vba", "title": "Custom Ribbon in Excel 2016 using VBA", "body": "<p>I created an additional Menu and sub menu under it (i.e. customized the Excel ribbon). I also delete the custom menu when workbook closes. All works fine. </p>\n\n<pre><code>Private Const My_TAG = \"MYXla\"    \nPrivate Const MY_TOOLS_MENU_ID As Long = 30007&amp;    \n\nDim ToolsMenu As Office.CommandBarControl    \nDim ToolsMenuItem As Office.CommandBarControl    \nDim ToolsMenuControl As Office.CommandBarControl    \n\n    Set ToolsMenu = Application.CommandBars.FindControl(ID:=MY_TOOLS_MENU_ID)  \n    If ToolsMenu Is Nothing Then  \n        MsgBox \"Unable to access Tools menu.\", vbOKOnly  \n        Exit Sub  \n    End If  \n\n    Set ToolsMenuItem = ToolsMenu.Controls.Add(Type:=msoControlPopup, temporary:=True)  \n    If ToolsMenuItem Is Nothing Then  \n        MsgBox \"Unable to add item to the Tools menu.\", vbOKOnly  \n        Exit Sub  \n    End If  \n\n    With ToolsMenuItem  \n        .Caption = \"&amp;My Custom function name\"  \n        .BeginGroup = True  \n        .Tag = My_TAG  \n    End With  \n\n    Set ToolsMenuControl = ToolsMenuItem.Controls.Add(Type:=msoControlButton, temporary:=True)  \n    If ToolsMenuControl Is Nothing Then  \n        MsgBox \"Unable to add item to Tools menu item.\", vbOKOnly  \n        Exit Sub  \n    End If  \n\nPrivate Sub Workbook_Close()   \n   DeleteControls  \nEnd Sub  \n\nPrivate Sub DeleteControls()  \n\n   Dim Ctrl As Office.CommandBarControl  \n\n   On Error Resume Next  \n    Set Ctrl = Application.CommandBars.FindControl(Tag:=My_TAG)  \n\n    Do Until Ctrl Is Nothing  \n        Ctrl.Delete  \n        Set Ctrl = Application.CommandBars.FindControl(Tag:=My_TAG)  \n    Loop  \n\nEnd Sub  \n</code></pre>\n\n<p>However when I open another .xlsm file, I see the same custom menu is still visible in the ribbon. I am surprised from where the values are coming.</p>\n\n<p>Please suggest as I am sure it must be something small.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "oracle", "odbc", "database-connection"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1573656859, "post_id": 58839549, "comment_id": 103953695, "body": "Try padding it with single quote <code>Pwd=&#39;&quot; &amp; password &amp; &quot;&#39;;&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 10633364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4543ab9ec43e0dbd87c758cea360a27a?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Litzel", "link": "https://stackoverflow.com/users/10633364/stefan-litzel"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1573659264, "post_id": 58839549, "comment_id": 103955054, "body": "Thank you for your answer - unfortunately I also got the error &#39;invalid string or buffer length&#39; as an error..."}, {"owner": {"reputation": 1, "user_id": 10633364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4543ab9ec43e0dbd87c758cea360a27a?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Litzel", "link": "https://stackoverflow.com/users/10633364/stefan-litzel"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1573660035, "post_id": 58839549, "comment_id": 103955593, "body": "As a side node, I think the error with the invalid string or buffer length is a bit weird - could it be an 32bit - 64bit issue?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10633364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4543ab9ec43e0dbd87c758cea360a27a?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Litzel", "link": "https://stackoverflow.com/users/10633364/stefan-litzel"}, "edited": false, "score": 0, "creation_date": 1573659944, "post_id": 58839686, "comment_id": 103955526, "body": "Thanks for your help! The first suggestion did unfortunately not work as I received the response that the password was wrong. For the second suggestion: VBA does not need to know the object for this - do you know the name of the reference that needs to be included?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "reply_to_user": {"reputation": 1, "user_id": 10633364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4543ab9ec43e0dbd87c758cea360a27a?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Litzel", "link": "https://stackoverflow.com/users/10633364/stefan-litzel"}, "edited": false, "score": 0, "creation_date": 1573672350, "post_id": 58839686, "comment_id": 103961787, "body": "<code>OdbcConnectionStringBuilder</code> is a .NET class, so could be difficult to use it in VBA. However when you get response &quot;wrong password&quot; then the connection string should work in general."}, {"owner": {"reputation": 1, "user_id": 10633364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4543ab9ec43e0dbd87c758cea360a27a?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Litzel", "link": "https://stackoverflow.com/users/10633364/stefan-litzel"}, "edited": false, "score": 0, "creation_date": 1573746974, "post_id": 58839686, "comment_id": 103992636, "body": "In general yes, but unfortunately this method also seems to have problems with a semicolon in the password :/"}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": false, "score": 0, "last_activity_date": 1573656588, "creation_date": 1573656588, "answer_id": 58839686, "question_id": 58839549, "link": "https://stackoverflow.com/questions/58839549/how-to-connect-to-oracle-with-a-password-that-includes-semicolon/58839686#58839686", "title": "How to connect to Oracle with a password that includes semicolon", "body": "<p>Try this one:</p>\n\n<pre><code>strCon = \"Driver={Oracle in OracleClient32_home1};Dbq=\" &amp; tnsName\ncn.Open strCon, user, password \n</code></pre>\n\n<p>Or use the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.data.odbc.odbcconnectionstringbuilder?view=netframework-4.8\" rel=\"nofollow noreferrer\">OdbcConnectionStringBuilder</a> (syntax could be wrong)</p>\n\n<pre><code>Dim strCon As New OdbcConnectionStringBuilder\nstrCon.Driver = \"Oracle in OracleClient32_home1\"\n\nstrCon.Add(\"Dbq\", tnsName)\nstrCon.Add(\"Uid\", user)\nstrCon.Add(\"Pwd\", password)\n\ncn.Open strCon.ToString()\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.data.common.dbconnectionstringbuilder?view=netframework-4.8\" rel=\"nofollow noreferrer\">DbConnectionStringBuilder</a> might be another option</p>\n"}], "owner": {"reputation": 1, "user_id": 10633364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4543ab9ec43e0dbd87c758cea360a27a?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Litzel", "link": "https://stackoverflow.com/users/10633364/stefan-litzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584940299, "creation_date": 1573656101, "last_edit_date": 1584940299, "question_id": 58839549, "link": "https://stackoverflow.com/questions/58839549/how-to-connect-to-oracle-with-a-password-that-includes-semicolon", "title": "How to connect to Oracle with a password that includes semicolon", "body": "<p>I am using VBA to connect to an Oracle database. Everything is working fine unless the password contains a semicolon. </p>\n\n<p>This is how I connect to the database:</p>\n\n<pre><code>Dim cn As ADODB.Connection\nDim strCon As String\n\nSet cn = New ADODB.Connection\n\nstrCon = \"Driver={Oracle in OracleClient32_home1};Dbq=\" &amp; tnsName &amp; \";\" &amp; _\n          \"Uid=\" &amp; user &amp; \"; Pwd=\" &amp; password &amp; \";\"\n\n'Open the connection\ncn.Open strCon\n</code></pre>\n\n<p>If the password is something like \"<code>pass;word</code>\", then the log-in fails saying that the password is wrong. </p>\n\n<p>I tried:</p>\n\n<ul>\n<li><p>Enclosing the password in curly braces:</p>\n\n<pre><code>Pwd={\" &amp; password &amp; \"};\"\n</code></pre>\n\n<p>This returned invalid string or buffer length as an error.</p></li>\n<li><p>Enclosing with double quotes:</p>\n\n<pre><code>Pwd=\" &amp; Chr(34) &amp; password &amp; Chr(34) &amp; \";\"\n</code></pre>\n\n<p>This also returened invalid string or buffer length as an error.</p></li>\n</ul>\n"}, {"tags": ["database", "vba", "ms-access", "ms-access-2010", "monitoring"], "comments": [{"owner": {"reputation": 1, "user_id": 6319747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe8756e5d5a58366b6dc86605a9672a?s=128&d=identicon&r=PG&f=1", "display_name": "lwc0724", "link": "https://stackoverflow.com/users/6319747/lwc0724"}, "edited": false, "score": 0, "creation_date": 1573656510, "post_id": 58839057, "comment_id": 103953498, "body": "Thank you for the information. I originally had it set up that way, but having the tables linked was causing problems so I made it a stand alone database. Another issue is we can&#39;t get each user to copy the database to their desktops. I&#39;m not sure how to solve for individuals failing to copy to the database to their desktops. \u2013"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1573654890, "creation_date": 1573654890, "answer_id": 58839213, "question_id": 58839057, "link": "https://stackoverflow.com/questions/58839057/is-it-possible-to-kick-users-out-of-a-stand-alone-access-database-that-is-housed/58839213#58839213", "title": "Is it possible to kick users out of a stand alone Access database that is housed in a shared folder?", "body": "<p>You should leave that setup and arrange for each user to always have <em>their own copy</em> of the frontend - having tables linked from one backend, if they need that.</p>\n\n<p>A script and a shortcut is used for that. It is described in detail in my article:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/33417/Deploy-and-update-a-Microsoft-Access-application-with-one-click.html\" rel=\"nofollow noreferrer\">Deploy and update a Microsoft Access application with one click</a></p>\n\n<p><em>(if you don't have an account, browse for the link: Read the full article)</em></p>\n"}], "owner": {"reputation": 1, "user_id": 6319747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe8756e5d5a58366b6dc86605a9672a?s=128&d=identicon&r=PG&f=1", "display_name": "lwc0724", "link": "https://stackoverflow.com/users/6319747/lwc0724"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593731946, "creation_date": 1573654361, "last_edit_date": 1593731946, "question_id": 58839057, "link": "https://stackoverflow.com/questions/58839057/is-it-possible-to-kick-users-out-of-a-stand-alone-access-database-that-is-housed", "title": "Is it possible to kick users out of a stand alone Access database that is housed in a shared folder?", "body": "<p>I built an Access DB and placed it in a shared folder where users are to copy and paste directly to their desktops.  There are some that are accessing the database directly from the folder; hence locking the database up for any updates to be made.</p>\n\n<p>There are no log in or user credentials used when accessing the database so I can't place any kind of audit trail on it to determine the users that continue to open the database directly from the folder.</p>\n\n<p>Is it possible to close the database; knocking out these individuals that continue to lock it up?  Or is it possible to place some sort of an audit trail in the database to capture user data that would identify the individual; i.e. computer address, computer name, etc.</p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1573654625, "post_id": 58838933, "comment_id": 103952404, "body": "Study <a href=\"https://stackoverflow.com/a/11325/4717755\">this answer</a> and <a href=\"https://stackoverflow.com/a/4550621/4717755\">this answer</a> to understand how to parse the XML."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6579710"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1573658076, "post_id": 58838933, "comment_id": 103954379, "body": "PeterT, I didn&#39;t find in your links anything that I can use to convert XML to array."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1573659170, "post_id": 58838933, "comment_id": 103955003, "body": "Parse the XML.  As you parse it, write the results into your VBA Array.  You may want to first collect the results in a Dictionary if you don&#39;t know what the eventual array size will be."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6579710"}, "edited": false, "score": 0, "creation_date": 1573660719, "post_id": 58838933, "comment_id": 103955982, "body": "Ron Rosenfeld, I dont know how to do it, i&#39;m on this issue for 7 hours, trying, without any luck."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573661373, "post_id": 58838933, "comment_id": 103956370, "body": "What you&#39;re asking for is not a simple matter, particuarly &quot;so it works with any given URL&quot;.  If you&#39;re not an experienced programmer then this might be a good use case for hiring someone who is to do this for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6579710"}, "edited": false, "score": 0, "creation_date": 1573661777, "post_id": 58838933, "comment_id": 103956617, "body": "Tim Williams, if it is not a simple question I think Stack Overflow is the place to ask , if it complicated, ask here :) Additionally, you know, when you ask a question, you really dont know if the answer is simple or not, I thought maybe there is a &quot;xmlToArray&quot; function in some VBA library or someone here already has a code like that."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1573669411, "post_id": 58838933, "comment_id": 103960516, "body": "With little coding experience you can use the following and do minor sprucing  <a href=\"https://stackoverflow.com/a/33311483/6241235\">stackoverflow.com/a/33311483/6241235</a> e.g update to run from thisworkbook and use fully qualified ranges; disable events during run and enable after and output to row 2. Have your headers already in row 1."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1573682576, "post_id": 58838933, "comment_id": 103966256, "body": "Looking at the <a href=\"https://api.evemarketer.com/ec/\" rel=\"nofollow noreferrer\">API docs</a>, the array you have shown is populated from multiple separate parts: attributes on the &quot;ExecAPI&quot; element; part of the initial query string; elements descended from the &quot;buy&quot; element; elements descended from the &quot;sell&quot; element. You could parse out the relevant parts with <a href=\"https://www.w3.org/TR/1999/REC-xpath-19991116/#path-abbrev\" rel=\"nofollow noreferrer\">XPath</a> and combine them into an array"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1573684064, "post_id": 58838933, "comment_id": 103966832, "body": "or just use html parser just as easily."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574076358, "post_id": 58838933, "comment_id": 104088939, "body": "You can also use <code>Power Query</code>, available in Excel 2010+, along with one of the <code>ExpandAll</code> connections available through a web search."}], "owner": {"user_type": "does_not_exist", "display_name": "user6579710"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573655210, "creation_date": 1573653969, "last_edit_date": 1573655210, "question_id": 58838933, "link": "https://stackoverflow.com/questions/58838933/get-array-from-xml-web-page-using-vba", "title": "Get Array from XML web page using VBA", "body": "<p>I have this code:</p>\n\n<pre><code>Dim xmlOBject As Object\nSet xmlOBject = CreateObject(\"MSXML2.DOMDocument.6.0\")\nxmlOBject.async = False\nxmlOBject.Load (\"https://api.evemarketer.com/ec/marketstat?typeid=2268&amp;typeid=2305&amp;typeid=2267&amp;typeid=2268&amp;regionlimit=10000032\")' just example URL\n</code></pre>\n\n<p>The xmlOBject variable contain the XML resulte.</p>\n\n<p>Is there a way to convert a XML resulte to array, VBA only, without using the sheet to paste the XML resulte, also it should be dynamically, it means that no matter how many xml levels/nodes there are, so it will works with any given URL ? </p>\n\n<p>The above URL should provide the this array(like the attached image without the titles):</p>\n\n<p><a href=\"https://i.stack.imgur.com/4fdwG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4fdwG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba", "class", "dictionary"], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573660076, "post_id": 58839517, "comment_id": 103955616, "body": "Thank you for the suggestion. Creating a method within the class seems to be as doing all the work (building an array) behind the scenes of the module. It&#39;s not quite what I&#39;m after (which might not even exists)."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573662943, "post_id": 58839517, "comment_id": 103957356, "body": "I&#39;ve taken the idea of creating a <code>Public Function</code> to return the array, but used another approach to build an <code>Private</code> array using <code>Property Let</code>. I&#39;ve posted the answer. Please be welcome to provide feedback/ideas on how to improve. Thanks again for your input."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573668143, "post_id": 58839517, "comment_id": 103959934, "body": "Yup, I hear you. The pro of this approach, is you only need to define this once."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573668688, "post_id": 58839517, "comment_id": 103960203, "body": "It sounds you are trying to represent properties in a class as an array, I&#39;m unaware of a direct way of doing this. I don&#39;t think Classes structure their data  like this, happy to be wrong though. If you want to dynamically reference properties in a Class, maybe the CallByName function  (<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/early-late-binding/calling-a-property-or-method-using-a-string-name\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/programming-gu&zwnj;&#8203;ide/&hellip;</a>) would help?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573670180, "post_id": 58839517, "comment_id": 103960847, "body": "Not really, as I&#39;m fairly new to <code>Class</code> modules, I was looking for a way to reference their properties in a more dynamic way. And the <code>GetArray</code> idea of yours has taken me that step further in understanding it&#39;s stuctures which resulted in the attempt in my post =)"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1573655935, "creation_date": 1573655935, "answer_id": 58839517, "question_id": 58838720, "link": "https://stackoverflow.com/questions/58838720/return-array-of-class-properties-from-dictionary/58839517#58839517", "title": "Return array of class properties from dictionary", "body": "<p>Not sure if this is <em>exactly</em> what you are after, but it is possible to make a method inside your class that would build an array of the properties you desire. You can then call that on each of the instances of the class to get the array details.</p>\n\n<p><strong>Class - named 'Example':</strong></p>\n\n<pre><code>Public val1 As Variant\nPublic val2 As Variant\nPublic val3 As Variant\n\nPublic Function GetArray() As Variant\n    GetArray = Array(Me.val1, Me.val2, Me.val3)\nEnd Function\n</code></pre>\n\n<p><strong>Client Code - In a Standard Module:</strong></p>\n\n<pre><code>Sub SOExample()\n\n    Dim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n    Dim lst As Example, arr As Variant, key As Variant\n\n    For x = 1 To 3\n        Set lst = New Example\n        lst.val1 = \"A\" &amp; x\n        lst.val2 = \"B\" &amp; x\n        lst.val3 = \"C\" &amp; x\n        dict.Add x, lst\n    Next\n\n    For Each key In dict.keys\n        arr = dict(key).GetArray\n        Debug.Print Join(arr, \",\")\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>A1,B1,C1\nA2,B2,C2\nA3,B3,C3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1573670278, "last_edit_date": 1573670278, "creation_date": 1573662849, "answer_id": 58841575, "question_id": 58838720, "link": "https://stackoverflow.com/questions/58838720/return-array-of-class-properties-from-dictionary/58841575#58841575", "title": "Return array of class properties from dictionary", "body": "<p>Taken inspiration form the answer by @RyanWildry, I figured out that, despite being unable to use a <code>Public</code> variant array, we could use a <code>Private</code> one. Therefor, I made it such that <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/property-let-statement\" rel=\"nofollow noreferrer\"><code>Property Let</code></a> would assign the value to a specific index within the array.</p>\n\n<p>Creating a <code>Public Function</code> to return the <code>Private</code> array variable would then return the array in one go.</p>\n\n<hr>\n\n<p><strong><em><sub>Class module, named <code>TstClass</code></sub></em></strong></p>\n\n<pre><code>Private vals(0 To 2) As Variant\n\nPublic Property Let val(ByVal x As Long, ByVal NewVal As Variant)\n    vals(x) = NewVal\nEnd Property\n\nPublic Function GetArray() As Variant\n    GetArray = vals\nEnd Function\n</code></pre>\n\n<p><strong><em><sub>Code under Module1</sub></em></strong></p>\n\n<pre><code>Sub Test()\n\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\nDim lst As TstClass, key As Variant, arr As Variant\n\nFor x = 1 To 3\n    Set lst = New TstClass\n    lst.val(0) = \"A\" &amp; x\n    lst.val(1) = \"B\" &amp; x\n    lst.val(2) = \"C\" &amp; x\n    dict.Add x, lst\nNext x\n\nFor Each key In dict\n    arr = dict(key).GetArray\nNext key\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Another way would be to leave the idea of an <code>Class</code> module alone, and go with (for example) an <code>ArrayList</code> object:</p>\n\n<pre><code>Sub Test()\n\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\nDim lst As Object: Set lst = CreateObject(\"System.Collections.ArrayList\")\nDim arr As Variant\n\nFor x = 1 To 3\n    lst.Add \"A\" &amp; x\n    lst.Add \"B\" &amp; x\n    lst.Add \"C\" &amp; x\n    dict.Add x, lst.Toarray\n    lst.Clear\nNext x\n\nFor Each key In dict\n    arr = dict(key)\nNext key\n\nEnd Sub\n</code></pre>\n\n<p>However, the latter approach would surpass the purpose of this question. </p>\n\n<p>This is as close as I can get as to returning an array directly from a dictionary item. I'm happy to recieve constructive feedback or other/better ways as <code>Class</code> modules are rather new to me and this still doesn't answer the essence of the question on how to return an array of the properties directly.</p>\n"}], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1573670278, "creation_date": 1573653353, "last_edit_date": 1573661414, "question_id": 58838720, "link": "https://stackoverflow.com/questions/58838720/return-array-of-class-properties-from-dictionary", "title": "Return array of class properties from dictionary", "body": "<p><strong><em><sub>Background:</sub></em></strong></p>\n\n<p>While recently trying to answer a <a href=\"https://stackoverflow.com/q/58835358/9758194\">question</a>, I had myself thinking if it would be possible to return an array of class object properties directly from a dictionary item.</p>\n\n<p><strong><em><sub>Code:</sub></em></strong></p>\n\n<p>Imagine <code>TstClass</code> as a class module with the following code:</p>\n\n<pre><code>Public val1 As Variant\nPublic val2 As Variant\nPublic val3 As Variant\n</code></pre>\n\n<p>Then this code to test:</p>\n\n<pre><code>Sub Test()\n\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\nDim lst As TstClass, key As Variant, arr As Variant\n\nFor x = 1 To 3\n    Set lst = New TstClass\n    lst.val1 = \"A\" &amp; x\n    lst.val2 = \"B\" &amp; x\n    lst.val3 = \"C\" &amp; x\n    dict.Add x, lst\nNext x\n\nFor Each key In dict\n    arr = Array(dict(key).val1, dict(key).val2, dict(key).val3)\nNext key\n\nEnd Sub\n</code></pre>\n\n<p><strong><em><sub>Problem:</sub></em></strong></p>\n\n<p>In the above case <code>Array(dict(key).val1, dict(key).val2, dict(key).val3)</code> will return the array just fine, but if we imagine <code>val4-val50</code> it will become a lot more code. Either with <code>Array(...)</code> or writing it out line by line <code>Debug.Print Dict(key).Valx</code>.</p>\n\n<p><strong><em><sub>Question:</sub></em></strong></p>\n\n<p>Is it possible to return an array directly from the class object properties from the dictionary key? The most obvious thing to try for me was <code>arr = Dict(key)</code> hoping it would somehow recognize I needed all properties from the item. On top of that it's not allowed to declare Constants, Arrays, User Defined Types as Public, so something like <code>Public Vals(0 to 2)</code> won't work either.</p>\n\n<p>Thank you,\nJvdV </p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1573651466, "post_id": 58838059, "comment_id": 103950512, "body": "Do you mean <code>Motor.FormatConditions.Delete</code> errors?"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573651933, "post_id": 58838059, "comment_id": 103950808, "body": "Yes Motor.FormatConditions.Delete errors.  If I substitute the full range definition for Motor it errors with the same error at With Motor.FormatConditions _"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573651981, "post_id": 58838059, "comment_id": 103950838, "body": "Also, I originally defined the variables within the workbook but I read that its best practice to put your global variables in a separate module.  I got the same error either way."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1573652559, "post_id": 58838059, "comment_id": 103951210, "body": "Not sure your CF syntax is quite right (though wouldn&#39;t give an RTE 91 error), e..g see <a href=\"https://stackoverflow.com/questions/13661965/conditional-formatting-using-excel-vba-code\" title=\"conditional formatting using excel vba code\">stackoverflow.com/questions/13661965/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573653087, "post_id": 58838059, "comment_id": 103951485, "body": "I wondered too.  It&#39;s very hard to find USEFUL examples on here or in Microsoft&#39;s documentation.  But...I just substituted the full range definition for &quot;Motor&quot; in all the appropriate spots in the checkbox sub and the CF worked exactly as it should.  So it&#39;s definitely an issue with my defined range variables."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573653605, "post_id": 58838757, "comment_id": 103951787, "body": "I presume then, the same concept would apply if I defined them on Workbook open as well?  Meaning, they would need to be called as ThisWorkbook.Motor"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573654445, "post_id": 58838757, "comment_id": 103952274, "body": "Well, I tried that suggestion.  Still no go.  Using Module1.Motor didn&#39;t work."}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573655160, "post_id": 58838757, "comment_id": 103952765, "body": "did you run your <code>Workbook_Open()</code> before further testing? if error occurs Excel drops all variables, I reconstructed your code and it works. Maybe even prefixing variables could be omitted, they were just not initialized"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573656368, "post_id": 58838757, "comment_id": 103953415, "body": "I&#39;m not sure I follow your suggestion.  Are you asking if I moved the declarations to workbook and used ThisWorkbook.Motor?  Are you asking if I reran Workbook_Open() after changing the checkbox sub to Module1.Motor?  Which error causes Excel to drop all variables?"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573656713, "post_id": 58838757, "comment_id": 103953616, "body": "each error that stops code execution, so Workbook_Open() should be rerun or Workbook reopened - does not matter which module your variables are stored"}, {"owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573657986, "post_id": 58838757, "comment_id": 103954333, "body": "Thanks! That did the trick.  I thought I had closed and reopened for just that reason, but perhaps I did not.  I&#39;ve run into a possibly related issue.  Should I start another question or continue here? (Different code dealing with range calls)"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "edited": false, "score": 0, "creation_date": 1573658428, "post_id": 58838757, "comment_id": 103954568, "body": "ask another one"}], "tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": true, "score": 0, "last_activity_date": 1573653448, "creation_date": 1573653448, "answer_id": 58838757, "question_id": 58838059, "link": "https://stackoverflow.com/questions/58838059/excel-vba-why-doesnt-sheet-code-recognize-my-global-range-variable-defined-in/58838757#58838757", "title": "Excel VBA - Why doesn&#39;t sheet code recognize my global range variable defined in a module?", "body": "<p>Your module variables are public but still local to module so should be prepended with module name:</p>\n\n<pre><code>Module1.Motor\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12366672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAo1U.png?s=128&g=1", "display_name": "jimm", "link": "https://stackoverflow.com/users/12366672/jimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 58838757, "answer_count": 1, "score": 0, "last_activity_date": 1573653448, "creation_date": 1573651186, "last_edit_date": 1573651493, "question_id": 58838059, "link": "https://stackoverflow.com/questions/58838059/excel-vba-why-doesnt-sheet-code-recognize-my-global-range-variable-defined-in", "title": "Excel VBA - Why doesn&#39;t sheet code recognize my global range variable defined in a module?", "body": "<p>Full disclosure, I've done basic programming in a few languages but this is me dipping the toe back in VBA after a long time.  I may have missed very basic concepts or syntax...</p>\n\n<p>The purpose of the code is to check a set of cells to make sure they are completed on an excel pseudo form before saving.  I define the various cell ranges as public range variables and union various subsets together depending on a check box and radio button.</p>\n\n<p>I want to use the checkbox click sub to set some variables to use for this union and to automatically adjust the conditional format of blank cells that must be completed.  That's where I'm running into a problem where the public variables aren't being recognized in the Click Sub.  It's probably a simple variable definition error but I'd love an assist on this.</p>\n\n<p>I get a:</p>\n\n<blockquote>\n  <p>Run-Time error '91':</p>\n  \n  <p>Object variable or With block variable not set</p>\n</blockquote>\n\n<p>on the Motor call in the checkbox sub.  If I explicitly call out the range in one spot, it gives me the same error on the next motor.</p>\n\n<p>Module Code For Defining Variables:</p>\n\n<pre><code>Option Explicit\n\nPublic DriveChk As String\nPublic StageChk As Integer\nPublic Fixed As Range\nPublic Motor As Range\nPublic Engine As Range\nPublic Stage1 As Range\nPublic Stage2 As Range\nPublic Stage3 As Range\nPublic Required As Range\nPublic Stage As Range\nPublic Drive As Range\n</code></pre>\n\n<p>Code for Workbook</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n'Ensure that the workbook stays protected but that the VBA script has full access to change cells.\nThisWorkbook.Worksheets(\"Field Service Report\").Protect Password:=\"xxxxx\", UserInterfaceOnly:=True\n\n'Message to field service rep\nMsgBox \"Please complete FSR on the day of service.\" &amp; vbNewLine &amp; \"All fields highlighted in red must be completed in order to save.\" &amp; vbNewLine &amp; \"Please submit completed FSR to xxxxx\", vbOK + vbInformation, \"REMINDERS\"\n\n'Set all of the cell check and formatting ranges\nSet Fixed = ThisWorkbook.Worksheets(\"Field Service Report\").Range(\"E6,Q6,Z6,J7,AB7,J8,D28,O28,D29,A46,A58,F58,L58,P58,U57,V58,Y58\")\nSet Motor = ThisWorkbook.Worksheets(\"Field Service Report\").Range(\"Z28,AI28,Z29,AF29,AL29,Z30,AI30,AB31\")\nSet Engine = ThisWorkbook.Worksheets(\"Field Service Report\").Range(\"D15,M15,T15,AG15,AL15,T17,AB17,AE17,J23,J24,J25,AB20,AB21,AB22,AB23,AB24,AB25,AL20,AL21,AL22,AL23,AL24,AL25\")\nSet Stage1 = ThisWorkbook.Worksheets(\"Field Service Report\").Range(\"I38,O38,AC38,AI38,I39,L39,O39,R39,AC39,AF39,AI39,AL39\")\nSet Stage2 = ThisWorkbook.Worksheets(\"Field Service Report\").Range(\"I40,O40,AC40,AI40,I41,L41,O41,R41,AC40,AI40,AC41,F41,AI41,AL41\")\nSet Stage3 = ThisWorkbook.Worksheets(\"Field Service Report\").Range(\"I42,O42,AC42,AI42,I43,O43,R43,AC43,AI43,AL43\")\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n'Create the final range of cells for checking\nIf DriveChk = \"G\" Then\n    Set Drive = Engine\nElseIf DriveChk = \"E\" Then\n    Set Drive = Motor\nEnd If\n\nIf StageChk = 1 Then\n    Set Stage = Stage1\nEnd If\n\nIf StageChk = 2 Then\n    Set Stage = Application.Union(Stage1, Stage2)\nEnd If\n\nIf StageChk = 3 Then\n    Set Stage = Application.Union(Stage1, Stage2, Stage3)\nEnd If\n\nSet Required = Application.Union(Fixed, Drive, Stage)\n\n'Check if all required cells are filled in\nIf WorksheetFunction.CountA(Required) &lt; Required.Count Then\n    Cancel = True\n    MsgBox \"Please Completed Shaded Cells!\", vbOK + vbExclamation, \"SAVE CANCELLED\"\n\nEnd If\n\n'Set the report date before saving\nRange(\"AG60\") = Format(Now(), \"mm-dd-yyyy hh:mm:ss AM/PM\")\n\n'Old code probably to ensure saving macro enabled that is currently commented out\n'  Dim sFN As String\n '   If SaveAsUI Then\n  '      Cancel = True\n   '     sFN = Application.GetSaveAsFilename(, _\n    '       fileFilter:=\"Excel Macro-Enabled Workbooks (*.xlsm),*.xlsm\")\n     '   Debug.Print sFN\n      '  If sFN &lt;&gt; \"False\" Then _\n       '     ThisWorkbook.SaveAs sFN, xlOpenXMLWorkbookMacroEnabled\n    'End If\nEnd Sub\n</code></pre>\n\n<p>Sheet Code</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CheckBox26_Click()\nIf CheckBox26.Value = True Then\n    'MsgBox text to verify sub is working\n    MsgBox \"CB26 is true\"\n    DriveChk = \"E\"\n    Motor.FormatConditions _\n        .Delete\n    With Motor.FormatConditions _\n        .Add(Type:=xlBlanksCondition)\n        .Interior.ColorIndex = 30\n        .StopIfTrue = True\n    End With\nElse\n    'MsgBox text to verify sub is working\n    MsgBox \"CB26 is false\"\n    DriveChk = \"Z\"\n    Motor.FormatConditions _\n        .Delete\n    With Motor.FormatConditions _\n        .Add(Type:=xlBlanksCondition)\n        .Interior.ColorIndex = 5\n        .StopIfTrue = True\n    End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks for the help!  Sorry, I don't fully understand the shorthand that will keep long commands from wrapping.  I tried to figure it out and my code wouldn't work right.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1573649829, "post_id": 58837637, "comment_id": 103949549, "body": "<a href=\"https://stackoverflow.com/questions/50957565/there-is-no-wait-method-associated-with-application-in-visualbasic-word\" title=\"there is no wait method associated with application in visualbasic word\">stackoverflow.com/questions/50957565/&hellip;</a> (see TinMan&#39;s answer)."}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573650226, "post_id": 58837637, "comment_id": 103949771, "body": "How can I put my random Number in his code`?CreateObject(&quot;Excel.Application&quot;).Wait (Now + TimeValue(&quot;00:00:05&quot;))"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573650258, "post_id": 58837637, "comment_id": 103949791, "body": "Don&#39;t use <code>Excel.Application</code>, use <code>Sleep</code>."}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573650370, "post_id": 58837637, "comment_id": 103949872, "body": "I&#39;ve heard that it can crash with &quot;Sleep&quot;, the program will run for about 6-9 hours. Will this cause problems?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573650415, "post_id": 58837637, "comment_id": 103949903, "body": "I am not sure, you&#39;ll have to try it."}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573650620, "post_id": 58837637, "comment_id": 103950013, "body": "Could you do the Sleep example on my code, please? I got an error during compilation"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573650653, "post_id": 58837637, "comment_id": 103950033, "body": "Can you <a href=\"https://stackoverflow.com/posts/58837637/edit\">edit</a> your question with the revised code you&#39;re using, and the specific error?"}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573651003, "post_id": 58837637, "comment_id": 103950263, "body": "done. the error is translated from german"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573651119, "post_id": 58837637, "comment_id": 103950331, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/constants-fixed-length-strings-arrays-user-defined-types-and-declare-statements\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>. See the last point (change <code>Public</code> to <code>Private</code>)."}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573651869, "post_id": 58837637, "comment_id": 103950770, "body": "The code works with the change from public to private, but the window freezes, making a crash probable. Isn&#39;t there another way?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1573655717, "post_id": 58837637, "comment_id": 103953073, "body": "&quot;The window freezes&quot; - yes! That&#39;s what you&#39;ve asked for. You&#39;ve requested Word halts execution for a period of time. I suspect what you&#39;re really after is more along the lines of the macro stopping for a while and Word sits idle. That can be done with timers etc. but is a very different process."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573651238, "post_id": 58838031, "comment_id": 103950396, "body": "As noted in the edit, this is in an object module, so <code>Public</code> should be <code>Private</code>."}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "edited": false, "score": 0, "creation_date": 1573652220, "post_id": 58838031, "comment_id": 103950982, "body": "Have you another Solution? Word is freezing"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "edited": false, "score": 0, "creation_date": 1573652483, "post_id": 58838031, "comment_id": 103951160, "body": "@FabianBreuer how many second do you set?  Try Ctrl+c or Ctrl+z to break the sub."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1573651791, "last_edit_date": 1573651791, "creation_date": 1573651063, "answer_id": 58838031, "question_id": 58837637, "link": "https://stackoverflow.com/questions/58837637/application-wait-for-word/58838031#58838031", "title": "Application.wait for Word", "body": "<p>If you work on Windows...</p>\n\n<p>Open a <strong>normal</strong> module (in VBE press <kbd>Alt</kbd>+<kbd>I</kbd>, <kbd>M</kbd>) then place the code below at the beginning.</p>\n\n<pre><code>#If VBA7 And Win64 Then\n    ' For 64bit version of Excel\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds As LongPtr)\n#Else\n    ' For 32bit version of Excel\n    Public Declare Sub Sleep Lib \"kernel32.dll\" (ByVal dwMilliseconds As Long)\n#End If\n</code></pre>\n\n<p>Then you could use <code>sleep 1000</code> to wait for one second.</p>\n"}], "owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 995, "favorite_count": 0, "closed_date": 1573772018, "answer_count": 1, "score": 0, "last_activity_date": 1573651791, "creation_date": 1573649753, "last_edit_date": 1573651534, "question_id": 58837637, "link": "https://stackoverflow.com/questions/58837637/application-wait-for-word", "closed_reason": "Duplicate", "title": "Application.wait for Word", "body": "<p>I would like to have a break where it randomly waits between 5-10 minutes before going to the next i.</p>\n\n<p>Unfortunately the function <code>Application.Wait</code> does not work in Word.</p>\n\n<p>Do you have another solution for me?\nI don't know much about macros.</p>\n\n<blockquote>\n  <p>-\n  The Error is: Error during compilation:</p>\n  \n  <p>Constants, character strings of fixed length, user-defined data fields and Declare statements are not permitted as public elements of object modules.</p>\n  \n  <hr>\n</blockquote>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n\nSub Test_DE()\n    If MsgBox(\"Wirklich senden?\", vbYesNo, \"Senden\") &lt;&gt; vbYes Then Exit Sub\n    Application.ScreenUpdating = False\n    Dim i As Long\n    With ActiveDocument\n      For i = 1 To .MailMerge.DataSource.RecordCount\n        With .MailMerge\n          .Destination = wdSendToEmail\n          .MailSubject = \"xxxx\"\n          .MailFormat = wdMailFormatHTML\n          .MailAddressFieldName = \"EMAIL\"\n          .SuppressBlankLines = True\n\n          With .DataSource\n            .FirstRecord = i\n            .LastRecord = i\n            .ActiveRecord = i\n          End With\n          .Execute Pause:=False\n        End With\n        Delay = Int((600000 - 300000 + 1) * Rnd + 300)\n        Sleep (Delay)\n        'CreateObject(\"Excel.Application\").Wait (Now + TimeValue(\"00:00:Delay\"))\n        'Dim PauseDelay As Long\n        'PauseDelay = Int((600 - 300 + 1) * Rnd + 300) ' Stores the random interval between 300-480\n        'Call Pause(PauseDelay) ' Calls Pause with the random interval\n      Next i\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "error-handling"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573651226, "post_id": 58837577, "comment_id": 103950389, "body": "You don&#39;t need <code>GoTo Skip_Error_Handler</code>.  Just put <code>Next i</code> in its place.  Then you will need a resume or exit sub to exit the error handler."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573651840, "post_id": 58837577, "comment_id": 103950756, "body": "Within <code>Does_Not_Exist</code> you should end with <code>resume next</code> so that it continues through to the next line in your loop (After the error causing line) and doesn&#39;t terminate."}, {"owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573652573, "post_id": 58837577, "comment_id": 103951221, "body": "SJR i have tried this, the code functions well as VBA.dir returns a nullstring on error, but the FileDateTime returns the error &#39; file does not exist&#39; when it in fact, does not exist.  @Darrel H I just tried this (having &#39;Next i&#39; above the error handler and removing skip_err_handler) this results in the sub ending after the first error."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 2, "creation_date": 1573652703, "post_id": 58837577, "comment_id": 103951291, "body": "Write code that doesn&#39;t need an error handler.  If you use the scripting.filesystemobject instead of VBA dir you can use the FileExists check to determine if a file exists.  The scripting.filesystemobject requres a reference to the Microsoft Scripting runtime.  Also, looking at how you have declared your variables, you should insert &#39;Option explicit&#39; as the start of each module and also install the fantastic RubberDuck addin and look at the code inspection results you get.  You will learn a lot."}, {"owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573653071, "post_id": 58837577, "comment_id": 103951475, "body": "@Freeflow i have option explicit, just didnt include in the post :)  VB.Dir works perfectly as it does not return an error message but a vbnullstring when a file does not exist. The error message occurs when the FileDateTime function is applied to a non-existing file for the second time in the loop. I generally agree regarding the error handling, but i do not know of a method to determin a files creation date and time using the fso method."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573657424, "post_id": 58837577, "comment_id": 103954020, "body": "When you have created your scripting.filesystemobject you use the get file method as in &lt;fsoreference&gt;.GetFIle(&lt;Filename&gt;).DateCreated."}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "is_accepted": true, "score": 0, "last_activity_date": 1573654858, "creation_date": 1573654858, "answer_id": 58839200, "question_id": 58837577, "link": "https://stackoverflow.com/questions/58837577/vba-error-handling-only-works-once-in-loop/58839200#58839200", "title": "VBA: Error handling only works once in loop", "body": "<p>The solution was quite simple, add 'Resume Skip_Err_Handler' and it works like a charm. It assigns the value 1 to paths that exist, and 0 to paths that do not exist.\nCode attached for others with the same loop error-handling issue:</p>\n\n<pre><code>Sub File_Check()\n    Dim Filename, Trade_day, Today, lastmodified As String\n    Dim MasterTable As ListObject\n    Dim i As Integer\n\n    Today = Format(Now(), \"DD-MM-YYYY\")\n    Trade_day = Range(\"Trade_day_file\")\n\nSet MasterTable = ThisWorkbook.Sheets(\"Dashboard\").ListObjects(\"MasterTable\")\n\n\nMasterTable.ListColumns(1).DataBodyRange = 0\n\nFor i = 1 To MasterTable.ListRows.Count\n\n\n    On Error GoTo Does_Not_Exist\n\n\n    'Check date in filename\n        Filename = VBA.Dir(MasterTable.DataBodyRange(i, 3).Value &amp; Trade_day &amp; MasterTable.DataBodyRange(i, 4).Value)\n\n        If Filename &lt;&gt; vbNullString Then\n\n            MasterTable.DataBodyRange(i, 1) = 1\n\n    'Check file creation date instead\n        ElseIf Format(FileDateTime(MasterTable.DataBodyRange(i, 3).Value &amp; MasterTable.DataBodyRange(i, 4).Value), \"DD-MM-YYYY\") = Today Then\n            MasterTable.DataBodyRange(i, 1) = 1\n\n        End If\n\n\n    GoTo Skip_Err_Handler\n\n\nDoes_Not_Exist:\n\n         MasterTable.DataBodyRange(i, 1) = 0\n         Err.Clear\n         Resume Skip_Err_Handler\n\n\nSkip_Err_Handler:\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 689, "user_id": 9423196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cJuOc.jpg?s=128&g=1", "display_name": "Daghan", "link": "https://stackoverflow.com/users/9423196/daghan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 1, "accepted_answer_id": 58839200, "answer_count": 1, "score": 0, "last_activity_date": 1573654858, "creation_date": 1573649544, "last_edit_date": 1573649769, "question_id": 58837577, "link": "https://stackoverflow.com/questions/58837577/vba-error-handling-only-works-once-in-loop", "title": "VBA: Error handling only works once in loop", "body": "<p>My code checks the existence of a list of files from their paths listed in an Excel table. Existing files are valued 1 in the table and non-existing files are valued 0.</p>\n\n<p>The error handler works for the first error, continues the loop and carries on to verify right until it hits the second error after which it displays the error message and halts the macro.</p>\n\n<p>I have tried different iterations of including resume and resume next as suggested elsewhere which either results in 'false positives' as the code resumes the 'then' code under the failed if-statement and values them as 1 (exists) or gets stuck in an infinite loop at the second error.  </p>\n\n<pre><code>Sub File_Check()\n    Dim Filename, Trade_day, Today, lastmodified As String\n    Dim MasterTable As ListObject\n    Dim i As Integer\n\n    Today = Format(Now(), \"DD-MM-YYYY\")\n    Trade_day = Range(\"Trade_day_file\")\n\nSet MasterTable = ThisWorkbook.Sheets(\"Dashboard\").ListObjects(\"MasterTable\")\n\n\nMasterTable.ListColumns(1).DataBodyRange = 0\n\nFor i = 1 To MasterTable.ListRows.Count\n\n\n    On Error GoTo Does_Not_Exist\n\n\n    'Check date in filename\n        Filename = VBA.Dir(MasterTable.DataBodyRange(i, 3).Value &amp; Trade_day &amp; MasterTable.DataBodyRange(i, 4).Value)\n\n        If Filename &lt;&gt; vbNullString Then\n\n            MasterTable.DataBodyRange(i, 1) = 1\n\n    'Check file creation date instead\n        ElseIf Format(FileDateTime(MasterTable.DataBodyRange(i, 3).Value &amp; MasterTable.DataBodyRange(i, 4).Value), \"DD-MM-YYYY\") = Today Then\n            MasterTable.DataBodyRange(i, 1) = 1\n\n        End If\n\n\n    GoTo Skip_Err_Handler\n\n\n\nDoes_Not_Exist:\n\n         MasterTable.DataBodyRange(i, 1) = 0\n         Err.Clear\n\n\nSkip_Err_Handler:\n\nNext i \n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573649199, "post_id": 58837378, "comment_id": 103949204, "body": "It is only possible with VBA, yes."}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "is_accepted": false, "score": 0, "last_activity_date": 1573649310, "creation_date": 1573649310, "answer_id": 58837512, "question_id": 58837378, "link": "https://stackoverflow.com/questions/58837378/hlookup-to-copy-colour-and-formatting-of-a-cell-using-vba/58837512#58837512", "title": "HLOOKUP to copy colour and formatting of a cell using VBA", "body": "<p>After you get what you want with <code>HLOOKUP</code> you can paste it on your desired cell or cell range with </p>\n\n<pre><code>Worksheets(\"name\").Cells(x, x).PasteSpecial Paste:=xlPasteFormats\nWorksheets(\"name\").Cells(x, x).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12366760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d04aba6ee9abcfe779bcbc7d6d4fe70?s=128&d=identicon&r=PG&f=1", "display_name": "Laurence", "link": "https://stackoverflow.com/users/12366760/laurence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573649310, "creation_date": 1573648876, "question_id": 58837378, "link": "https://stackoverflow.com/questions/58837378/hlookup-to-copy-colour-and-formatting-of-a-cell-using-vba", "title": "HLOOKUP to copy colour and formatting of a cell using VBA", "body": "<p>I am working on a spreadsheet which summarises data from another page (within the same workbook) using a drop down selection and HLOOKUP to bring up the required cells. \nI need the cells to also copy across the formatting as they are colour coded red and green to signify completion. \nI realise V/HLookup only copies across the content and not formatting and was wondering whether it is possible to achieve this with VBA?</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "pivot-table", "powerpivot"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1573649865, "post_id": 58837310, "comment_id": 103949568, "body": "Possible duplicate, look at this first <a href=\"https://stackoverflow.com/questions/34817213/getting-unable-to-set-currentpage-property-of-pivotfield-class-error\" title=\"getting unable to set currentpage property of pivotfield class error\">stackoverflow.com/questions/34817213/&hellip;</a>"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1573710944, "post_id": 58837310, "comment_id": 103973282, "body": "You can solve this problem without VBA. Instead of page filter, create a slicer, and set it to control both pivot tables. Simple and reliable."}], "owner": {"reputation": 1, "user_id": 12366385, "user_type": "registered", "profile_image": "https://graph.facebook.com/2447497408824179/picture?type=large", "display_name": "Luc Haems", "link": "https://stackoverflow.com/users/12366385/luc-haems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573649137, "creation_date": 1573648625, "last_edit_date": 1573649137, "question_id": 58837310, "link": "https://stackoverflow.com/questions/58837310/cant-synchronize-pivot-tables-created-with-power-pivot", "title": "Can&#39;t synchronize pivot tables created with Power Pivot", "body": "<p>I'm trying to use VBA to synchronize the filters of two pivot tables that are created with PowerPivot ... I want to apply the filter settings in pf \"OU\" from pt \"pt_ECperMonth\" to another pt named \"pt_SurfacePerMonth\" ... \nBelow the code I thought would do the job .... on .CurrentPage= \"(All)\" (line4) I get Runtime error 1004 \"Unable to set the CurrentPage property of the PivotField class\"</p>\n\n<p>Somebody who knows how to get out of this issue? \none remark : I used to successfully apply the same method to synchronize pt that were not created with PowerPivot!</p>\n\n<pre><code>Set pf = Sheets(\"Surface per month\").PivotTables(\"pt_SurfacePerMonth\").PivotFields(\"[SML_Sites1].[OU].[OU]\")\nWith pf\n    .ClearAllFilters\n    .CurrentPage = \"(All)\"\n    For Each pi In Sheets(\"EC per month\").PivotTables(\"pt_ECPerMonth\").PivotFields(\"[SML_Sites].[OU].[OU]\").PivotItems\n        .PivotItems(pi.Name).Visible = pi.Visible\n    Next pi\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink", "href", "username"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 12302233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19a52f2becffe9b9095856a2eb3811b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/12302233/jackson"}, "is_accepted": false, "score": 0, "last_activity_date": 1573761113, "last_edit_date": 1573761113, "creation_date": 1573651332, "answer_id": 58838105, "question_id": 58837276, "link": "https://stackoverflow.com/questions/58837276/insert-the-username-of-person-opening-a-file-into-a-hyperlink/58838105#58838105", "title": "Insert the username, of person opening a file, into a hyperlink", "body": "<p>So the following VBA will enter the current user into a hyperlink:</p>\n\n<pre><code>\u201c&lt;A HREF=\u201c\u201dC:\\users\u201d &amp; (environ$(\u201cusername\u201d)) &amp; \u201c\\Spiral ltd.....\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12302233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19a52f2becffe9b9095856a2eb3811b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/12302233/jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581493104, "creation_date": 1573648531, "last_edit_date": 1581493104, "question_id": 58837276, "link": "https://stackoverflow.com/questions/58837276/insert-the-username-of-person-opening-a-file-into-a-hyperlink", "title": "Insert the username, of person opening a file, into a hyperlink", "body": "<p>The following VBA enters the below path as a hyperlink in an automated email when a spreadsheet is completed. This works just for me:</p>\n\n<pre><code>&lt;A HREF=\"\"C:\\Users\\james.jordan\\Spiral Ltd\\Eng Sales\n</code></pre>\n\n<p>The spreadsheet and directory (SharePoint) is available for numerous people to access and complete.</p>\n\n<p>Is there a way for VBA to identify the user amending the spreadsheet to enter their username in the path instead of mine?</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "webautomation", "ie-automation"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573647605, "post_id": 58836289, "comment_id": 103948377, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary that you show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "edited": false, "score": 0, "creation_date": 1573647608, "post_id": 58836289, "comment_id": 103948378, "body": "Can you post the related web page html resource, it is better for us to know which HTML elements are you using and help you solve the problem. You could create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 1, "user_id": 12366425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb6fd4b3d3993591f1eab60097e562?s=128&d=identicon&r=PG&f=1", "display_name": "user12366425", "link": "https://stackoverflow.com/users/12366425/user12366425"}, "edited": false, "score": 0, "creation_date": 1573704803, "post_id": 58836289, "comment_id": 103971672, "body": "Thanks for letting me know about this. I have tried to reach the page using the below code:"}, {"owner": {"reputation": 1, "user_id": 12366425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb6fd4b3d3993591f1eab60097e562?s=128&d=identicon&r=PG&f=1", "display_name": "user12366425", "link": "https://stackoverflow.com/users/12366425/user12366425"}, "edited": false, "score": 0, "creation_date": 1573704814, "post_id": 58836289, "comment_id": 103971676, "body": "Sub Automate_IE_Load_Page() Dim i As Long Dim URL As String Dim IE As Object Dim objElement As Object Dim objCollection As Object  Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)  IE.Visible = True  URL = &quot;&lt;&lt;website&gt;&gt;&quot;  IE.Navigate URL  Application.StatusBar = URL &amp; &quot; is loading. Please wait...&quot;  Do While IE.ReadyState = 4: DoEvents: Loop   &#39;Do While Do Until IE.ReadyState = 4: DoEvents: Loop   &#39;Do Until  Application.StatusBar = URL &amp; &quot; Loaded&quot;  Set IE = Nothing Set objElement = Nothing Set objCollection = Nothing End Sub"}, {"owner": {"reputation": 1, "user_id": 12366425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb6fd4b3d3993591f1eab60097e562?s=128&d=identicon&r=PG&f=1", "display_name": "user12366425", "link": "https://stackoverflow.com/users/12366425/user12366425"}, "edited": false, "score": 0, "creation_date": 1573714395, "post_id": 58836289, "comment_id": 103974495, "body": "ahhhh why is the code pasted this way :("}, {"owner": {"reputation": 1, "user_id": 12366425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb6fd4b3d3993591f1eab60097e562?s=128&d=identicon&r=PG&f=1", "display_name": "user12366425", "link": "https://stackoverflow.com/users/12366425/user12366425"}, "edited": false, "score": 0, "creation_date": 1573714467, "post_id": 58836289, "comment_id": 103974528, "body": "ok, am able to launch the IE and reach the desired page. But am stuck where it comes to copy the data and paste it."}], "answers": [{"tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1573824486, "last_edit_date": 1592644375, "creation_date": 1573824486, "answer_id": 58878046, "question_id": 58836289, "link": "https://stackoverflow.com/questions/58836289/copy-text-from-an-ie-page-and-paste-it-back-to-a-text-box-in-the-same-page-using/58878046#58878046", "title": "Copy text from an IE page and paste it back to a text box in the same page using excel VBA", "body": "<p>Since you didn't post the html resource, so, we don't know which HTML element are you using, I suggest you could refer to the following general method to copy and set the value.</p>\n<p>Generally, we could use the <strong>getElementById()</strong>, <strong>getElementsByClassName()</strong>, <strong>getElementsByName()</strong>, <strong>getElementsByTagName()</strong>, <strong>querySelector()</strong> and <strong>querySelectorAll()</strong> to find the web page elements first, then, using the <strong>innerText</strong> or <strong>innerHtml</strong> property to set the value.</p>\n<p>From the screenshot, it seems that you are creating a schedule, so, I suppose it is an html table elements, and you want to copy values from one row to target row (which might be using input text or not), please refer to the following sample code:</p>\n<p>The web page resource:</p>\n<pre><code>&lt;table &gt;\n    &lt;tr&gt;\n        &lt;td&gt;11 MON&lt;/td&gt;\n        &lt;td&gt;12 TUE&lt;/td&gt;\n        &lt;td&gt;13 WED&lt;/td&gt;\n        &lt;td&gt;14 THU&lt;/td&gt;\n        &lt;td&gt;15 FRI&lt;/td&gt;\n        &lt;td&gt;16 SAT&lt;/td&gt;\n        &lt;td&gt;17 SUN&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td id=&quot;label2_1&quot; class=&quot;class2_1&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; /&gt;&lt;/td&gt;\n        &lt;td id=&quot;label2_2&quot; class=&quot;class2_2&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; /&gt;&lt;/td&gt;\n        &lt;td id=&quot;label2_3&quot; name=&quot;wedtime2_3&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; /&gt;&lt;/td&gt;\n        &lt;td id=&quot;label2_4&quot;&gt;&lt;/td&gt;\n        &lt;td id=&quot;label2_5&quot; class=&quot;class2_5&quot;&gt;&lt;/td&gt;\n        &lt;td id=&quot;label2_6&quot; name=&quot;wedtime&quot;&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;input id=&quot;txt7&quot; type=&quot;text&quot; value=&quot;&quot; /&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td id=&quot;label3_1&quot;&gt;08:28&lt;/td&gt;\n        &lt;td id=&quot;label3_2&quot; class=&quot;class3_2&quot;&gt;02:46&lt;/td&gt;\n        &lt;td id=&quot;label3_3&quot; name=&quot;wedtime3_3&quot;&gt;03:46&lt;/td&gt;\n        &lt;td id=&quot;label3_4&quot;&gt;04:46&lt;/td&gt;\n        &lt;td id=&quot;label3_5&quot; class=&quot;class3_5&quot;&gt;05:46&lt;/td&gt;\n        &lt;td id=&quot;label3_6&quot; name=&quot;wedtime&quot;&gt;06:46&lt;/td&gt;\n        &lt;td&gt;07:46&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n<p>Then, using the following VBA script to copy data:</p>\n<pre><code>Sub Test()\n    Dim IE As Object\n\n    Dim startDateText As Object, endDateText As Object\n\n    Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)\n    With IE\n        .Visible = True\n        .Navigate &quot;&lt;web page url&gt;&quot;\n\n        While IE.ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        'using getElementById() method to get the td tag, then using getElementsByTagName() method to get the input text box.\n        'using the innertext property to set the input text box value, using the innerHtml property to get the value.\n        IE.Document.getElementById(&quot;label2_1&quot;).getElementsByTagName(&quot;input&quot;)(0).innerText = IE.Document.getElementById(&quot;label3_1&quot;).innerHtml\n        \n        'using getElementsByClassName method to get the elements.\n        IE.Document.getElementsByClassName(&quot;class2_2&quot;)(0).getElementsByTagName(&quot;input&quot;)(0).innerText = IE.Document.getElementsByClassName(&quot;class3_2&quot;)(0).innerHtml\n        \n        'using getElementsByName method to get the elements.\n        IE.Document.getElementsByName(&quot;wedtime2_3&quot;)(0).getElementsByTagName(&quot;input&quot;)(0).innerText = IE.Document.getElementsByName(&quot;wedtime3_3&quot;)(0).innerHtml\n       \n       'Using innerHtml property to set the value.\n        'using getElementsByClassName method to get the elements.\n        IE.Document.getElementById(&quot;label2_4&quot;).innerHtml = IE.Document.getElementById(&quot;label3_4&quot;).innerHtml\n        \n        'using getElementsByClassName method to get the elements.\n        IE.Document.getElementsByClassName(&quot;class2_5&quot;)(0).innerHtml = IE.Document.getElementsByClassName(&quot;class3_5&quot;)(0).innerHtml\n        \n        'using getElementsByName method to get the elements.\n        IE.Document.getElementsByName(&quot;wedtime&quot;)(0).innerHtml = IE.Document.getElementsByName(&quot;wedtime&quot;)(1).innerHtml\n       \n    End With\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n<p>Besides, you could also use the following script to loop through the <code>td</code> tag and set the value</p>\n<pre><code>        'find all of the tr.           \n        Dim TableRows As Object\n        Set TableRows = IE.Document.getElementsByTagName(&quot;table&quot;)(0).getElementsByTagName(&quot;tr&quot;)\n        'Debug.Print TableRows.Length\n        \n        Dim targetrow As Object\n        Dim datarow As Object\n        Set targetrow = TableRows(1).getElementsByTagName(&quot;td&quot;)\n        Set datarow = TableRows(2).getElementsByTagName(&quot;td&quot;)\n        \n        Dim i As Integer\n        Dim text As Object\n        'loop through the td and set value.\n        For i = 0 To targetrow.Length - 1\n            Set text = targetrow(i).getElementsByTagName(&quot;input&quot;)(0)\n            If Not text Is Nothing Then\n                text.innerText = datarow(i).innerHtml\n            Else\n                targetrow(i).innerHtml = datarow(i).innerHtml\n            End If\n        Next i\n</code></pre>\n<p>The result as below:</p>\n<p><a href=\"https://i.stack.imgur.com/p7SRf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p7SRf.png\" alt=\"enter image description here\" /></a></p>\n<p>More detail information about using these methods, please refer the <a href=\"http://automatetheweb.net/common-vba-methods-properties-web-automation/\" rel=\"nofollow noreferrer\">common VBA method or properties</a>.</p>\n<p>If still not solve your problem, please post the related web page html resource, it is better for us to know which HTML elements are you using and help you solve the problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 12366425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08bb6fd4b3d3993591f1eab60097e562?s=128&d=identicon&r=PG&f=1", "display_name": "user12366425", "link": "https://stackoverflow.com/users/12366425/user12366425"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573824486, "creation_date": 1573645162, "last_edit_date": 1573647531, "question_id": 58836289, "link": "https://stackoverflow.com/questions/58836289/copy-text-from-an-ie-page-and-paste-it-back-to-a-text-box-in-the-same-page-using", "title": "Copy text from an IE page and paste it back to a text box in the same page using excel VBA", "body": "<p>Using Excel VBA, am trying to create a macro.</p>\n\n<p>Purpose is to make it navigate across Internet explorer for a task.</p>\n\n<p>Am trying to copy a text from from red marked box (each are separate entries) within a web page and paste that to an input box above in the same page.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HBLwb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HBLwb.jpg\" alt=\"Source data\"></a></p>\n\n<p>say, the 08:28 should be copied to the above text box.</p>\n\n<p>Similarly each entries should be copied to their corresponding input box above them as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/54FSb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/54FSb.jpg\" alt=\"Expected output\"></a></p>\n\n<p>Please enlighten me on how to find, copy and paste the data using Excel VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1573647726, "post_id": 58836232, "comment_id": 103948444, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/6100944/code-an-excel-vba-sort-with-a-custom-order-and-a-value-containing-commas\">Code an Excel VBA sort with a custom order and a value containing commas</a> or this <a href=\"https://stackoverflow.com/questions/52848753/excel-vba-custom-order-sort\">Custom order sort</a>"}, {"owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573688246, "post_id": 58836232, "comment_id": 103968040, "body": "only partial of it, as the season is dynamic, therefore I need to get the current season and then sort by current season, but I don&#39;t know how to get the current season"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 0, "creation_date": 1573688353, "post_id": 58840214, "comment_id": 103968058, "body": "right now we are using this method, however, I need to write a vba for user so that they don&#39;t need to do this step, also current season is autumn but I have to write another one once the season is changed."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 1, "creation_date": 1573700248, "post_id": 58840214, "comment_id": 103970698, "body": "@wingkithui turn on the macro recorder and do the above. Then review the code. Perhaps then just use a dictionary or something to store the months/seasons. Also see Peh&#39;s links in the comment on your original post."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1573658332, "creation_date": 1573658332, "answer_id": 58840214, "question_id": 58836232, "link": "https://stackoverflow.com/questions/58836232/how-to-sort-current-season/58840214#58840214", "title": "How to sort current season", "body": "<p>FYI - You can do this without VBA.  If you select the data to be sorted, go to Data -> Sort.  Then, in the \"Order\" box, click the dropdown and click \"Custom List...\".</p>\n\n<p>Here, type your order in the \"List Entries\" box, and click \"Add\".</p>\n\n<p>Then back in the Sort box, choose your column to sort by.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vRkJc.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vRkJc.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573658332, "creation_date": 1573644966, "last_edit_date": 1573647666, "question_id": 58836232, "link": "https://stackoverflow.com/questions/58836232/how-to-sort-current-season", "title": "How to sort current season", "body": "<p>I have a column in Excel contains season value, let say <code>spring</code>, <code>summer</code>, <code>autumn</code> and <code>winter</code>.</p>\n\n<p>How can I sort this season by current season?</p>\n\n<p>Now it's autumn, therefore the order would be <code>autumn</code>, <code>winter</code>, <code>spring</code> and <code>summer</code></p>\n"}, {"tags": ["vba", "solidworks"], "answers": [{"tags": [], "owner": {"reputation": 1107, "user_id": 6316515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OBgUG.png?s=128&g=1", "display_name": "spacer", "link": "https://stackoverflow.com/users/6316515/spacer"}, "is_accepted": true, "score": 2, "last_activity_date": 1573654346, "creation_date": 1573654346, "answer_id": 58839052, "question_id": 58835613, "link": "https://stackoverflow.com/questions/58835613/how-to-change-hole-table-axis-orientation-via-solidworks-api/58839052#58839052", "title": "How to change Hole Table axis orientation via SolidWorks API?", "body": "<p>I have figured it out. This time digging through SolidWorks API Help was useful.</p>\n\n<p>By using <code>HoleTable.DatumOrigin.SetAxisPoints()</code> method it is possible to change points that define the Hole Table axes.<br>\nImportant to notice is that <code>SetAxisPoints()</code> changes <strong>only the end points</strong> of the axis arrows (tips of the arrowheads). Start points get updated automatically.</p>\n\n<p>You can get current point values with <code>HoleTable.DatumOrigin.GetAxisPoints2()</code> method.</p>\n\n<p>Another thing to notice is that values in the hole table do not get updated automatically. They did update after I manually dragged a an axis point.\nTo get them update by the code set <code>HoleTable.EnableUpdate</code> property to <code>False</code> before and back to <code>True</code> after the call to <code>SetAxisPoints()</code>.</p>\n\n<p>Here is the code excerpt that does what I needed:</p>\n\n<pre><code>Dim ht As SldWorks.HoleTable\nDim htdo As SldWorks.DatumOrigin\nDim htdaxpts() As Double\nDim htdaxptsnew(0 To 3) As Double\nDim ystarty As Double\nDim yendx As Double\nDim yendy As Double\nDim xstartx As Double\nDim xendx As Double\nDim xendy As Double\n\n    '...\n    'here comes code to prepare for Hole Table insertion\n    '...\n\n    'insert the Hole Table\n    Set htann = theView.InsertHoleTable2(False, anchorx, anchory, swBOMConfigurationAnchor_BottomLeft, \"A\", holetemplatepath)\n\n    If Not htann Is Nothing Then\n        Set ht = htann.HoleTable\n        Set htdo = ht.DatumOrigin\n\n        'disable hole table update to get it refresh when done\n        ht.EnableUpdate = False\n\n        'get coordinates of the axis arrows (4 pairs of (x,y) doubles: X start(0,1), X end(2,3), Y start(4,5), Y end(6,7))\n        htdaxpts = htdo.GetAxisPoints2()\n        'take the values we use\n        xstartx = htdaxpts(0)\n        xendx = htdaxpts(2)\n        xendy = htdaxpts(3)\n        ystarty = htdaxpts(5)\n        yendx = htdaxpts(6)\n        yendy = htdaxpts(7)\n        'change direction only if Y arrow points up\n        If ystarty &lt; yendy Then\n            yendy = ystarty - (yendy - ystarty)\n        End If\n        'change direction only if X arrow points left\n        If xstartx &gt; xendx Then\n            xendx = xstartx - (xendx - xstartx)\n        End If\n        'change position only if X arrow is below Y arrow\n        If xendy &lt; ystarty Then\n            'we can change end point only so change X end y only\n            xendy = xendy + (ystarty - xendy) * 2\n        End If\n        'prepare new axis points (2 pairs of (x,y) doubles: X end(0,1), Y end(2,3))\n        htdaxptsnew(0) = xendx\n        htdaxptsnew(1) = xendy\n        htdaxptsnew(2) = yendx\n        htdaxptsnew(3) = yendy\n        'set new axis end points\n        htdo.SetAxisPoints htdaxptsnew\n\n        'enable hole table update to refresh the values\n        ht.EnableUpdate = True\n\n    End If\n</code></pre>\n"}], "owner": {"reputation": 1107, "user_id": 6316515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OBgUG.png?s=128&g=1", "display_name": "spacer", "link": "https://stackoverflow.com/users/6316515/spacer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 58839052, "answer_count": 1, "score": 1, "last_activity_date": 1573654346, "creation_date": 1573642718, "question_id": 58835613, "link": "https://stackoverflow.com/questions/58835613/how-to-change-hole-table-axis-orientation-via-solidworks-api", "title": "How to change Hole Table axis orientation via SolidWorks API?", "body": "<p>Is there a way to change <strong>orientation (direction) of Hole Table axes</strong> with SolidWorks API?</p>\n\n<p>I can do it manually by dragging the handles but recorded VBA macro does not contain actual changes.</p>\n\n<p>This is what I would like to achieve:</p>\n\n<p>Before<br>\n<a href=\"https://i.stack.imgur.com/pGw2F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pGw2F.png\" alt=\"before\"></a></p>\n\n<p>After<br>\n<a href=\"https://i.stack.imgur.com/aYclM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aYclM.png\" alt=\"enter image description here\"></a></p>\n\n<p>I don't have Visual Studio Tools on this PC so I cannot record a C# or VB macro and see if it contains more code. If somebody could check that on their PC I would be grateful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1573642222, "post_id": 58835358, "comment_id": 103945704, "body": "You claim you check <code>A:E</code> but the code seems to check <code>A:C</code> (<code>dict.Exists(arr(x, 1) &amp; &quot;|&quot; &amp; arr(x, 2) &amp; &quot;|&quot; &amp; arr(x, 3))</code>). Can you clarify it?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573642700, "post_id": 58835358, "comment_id": 103945949, "body": "First thing to notice in your code is that you have used <code>.Range(&quot;A1:F&quot; &amp; x).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6), Header:=xlYes</code> outside the <code>With</code> statement. Also, you have included column F (which equals 6 in the array) but you would only need 1-5. You also populated the <code>arr</code> before you have cleared out the unneccesary duplicates. Haven&#39;t checked other parts of the code yet =)"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1573644643, "post_id": 58835358, "comment_id": 103946973, "body": "Hi @user3819867 :) that is because if columns a to c are the same, then corresponding values from columns d and e sums up and deletes another row.. But if columns from a to e are the same, then it just deletes duplicate row and doesn&#39;t sum anything. Hopefully i explained clearly :)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573725832, "post_id": 58836324, "comment_id": 103980133, "body": "Hi @JvdV :) You have helped me so much with these codes, I really really appreciate it!! Thank you. I tested this in my actual excel, where is 18 columns and 8000 rows. This code works so well in test excels, just how I want it to work, but when I run it in my actual excel, it somehow deletes almost every value on column 17 and moves some names from column 18 to 17.. Why is this. Should I post the edited version here :)?"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573730930, "post_id": 58836324, "comment_id": 103983133, "body": "sorry, my bad!! I had a typo and now it works :) thank you once again!"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573732550, "post_id": 58836324, "comment_id": 103984036, "body": "Well actualle, there is one question @JvdV :) (after all, haha) When I run the code from the VBA &#39;bar&#39; it works, but if I click after that from the excels command button, it deletes every value from the table.. why is this?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573734499, "post_id": 58836324, "comment_id": 103985011, "body": "Hello @Emppunen, I&#39;m not quite sure what you mean with that. Would all data get deleted on a second run?"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573801083, "post_id": 58836324, "comment_id": 104011681, "body": "Yes, if I run it second time it deletes all the data (and this doesnt happen when I run it in a test excel, just in an actual excel).. @JvdV"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573807120, "post_id": 58836324, "comment_id": 104014112, "body": "I try to explain better. When I run the code in Visual basic program, it works correctly. If I try to press after this command button, it deletes every value from my table and gives me an error code <i>type mismatch</i>. But I dont have this problem in my test excel, only in this actual one :D"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573807310, "post_id": 58836324, "comment_id": 104014195, "body": "I am drawing a complete blank here I&#39;m afraid. I would have no clue as to why that would happen in your real sheet. Only suggestion I have is to make sure your references are 100% correct. @emppunen"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573812547, "post_id": 58836324, "comment_id": 104017054, "body": "Im sorry @JvdV , what do you mean with references? :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1573812636, "post_id": 58836324, "comment_id": 104017113, "body": "@emppunen, all references made to sheets, ranges, column numbers etc etc. If you really can&#39;t figure it out maybe post your excel in your original question for people to have a look (allthough it&#39;s not recommended)"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1574075331, "post_id": 58836324, "comment_id": 104088395, "body": "Can I ask from the code @JvdV :) What is that clear.contents command? What it actually does? I didnt quite understand when I googled it. AND if I populate my dictionary, should I add every column there, or just those which I &#39;use&#39;. Hopefully I explained it clearly :)"}, {"owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1574075922, "post_id": 58836324, "comment_id": 104088701, "body": "Now I deleted the clear.contents part 3 from my code and it doesnt delete every value in the table anymore on the second run. But no if I run it second time, it gives me type mismatch and highlights this part: KeyX = Join(Array(arr(x, 1), arr(x, 2), arr(x, 3), arr(x, 4), arr(x, 5), arr(x, 6)), &quot;|&quot;)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "edited": false, "score": 0, "creation_date": 1574086768, "post_id": 58836324, "comment_id": 104094730, "body": "@emppunen, <code>ClearContents</code> simply deletes the contents from the given range. This makes sure that the new data is not superseded by information that should not be there."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1573650220, "last_edit_date": 1573650220, "creation_date": 1573645271, "answer_id": 58836324, "question_id": 58835358, "link": "https://stackoverflow.com/questions/58835358/how-to-delete-duplicates-in-excel-in-different-situations-vba/58836324#58836324", "title": "How to delete duplicates in excel in different situations (VBA)?", "body": "<p>Some mistakes in your code, including populating your array before deleting first duplicates and having your <code>RemoveDuplicates</code> outside your <code>With</code> statement and including column F. To make your code work properly you could try the below:</p>\n\n<p><strong><em><sub>Before</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/aLyWE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aLyWE.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Test()\n\nDim x As Long, arr As Variant, lst As Class1\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\nWith Sheet1\n\n    'Step one: Delete duplicates over columns A-E\n    x = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Range(\"A1:F\" &amp; x).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5), Header:=xlYes\n\n    'Step two: Populate your array\n    x = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr = .Range(\"A2:F\" &amp; x).Value\n\n    'Step three: Clear range\n    .Range(\"A2:F\" &amp; x).ClearContents\n\n    'Step Four: Go through your array and populate a dictionary\n    For x = LBound(arr) To UBound(arr)\n        Set lst = New Class1\n        lst.Col1 = arr(x, 1)\n        lst.Col2 = arr(x, 2)\n        lst.Col3 = arr(x, 3)\n        lst.Col4 = arr(x, 4)\n        lst.Col5 = arr(x, 5)\n        lst.Col6 = arr(x, 6)\n        KeyX = Join(Array(arr(x, 1), arr(x, 2), arr(x, 3)), \"|\")\n        If dict.Exists(KeyX) = False Then\n            dict.Add KeyX, lst\n        Else\n            dict(KeyX).Col4 = dict(KeyX).Col4 + arr(x, 4)\n            dict(KeyX).Col5 = dict(KeyX).Col5 + arr(x, 5)\n        End If\n    Next x\n\n    'Step five: Go through your dictionary and write to sheet\n    x = 2\n    For Each key In dict.Keys\n        .Range(.Cells(x, 1), .Cells(x, 6)).Value = Array(dict(key).Col1, dict(key).Col2, dict(key).Col3, dict(key).Col4, dict(key).Col5, dict(key).Col6)\n        x = x + 1\n    Next key\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong><em><sub>After</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/LIM1j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LIM1j.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know how it went =)</p>\n"}], "owner": {"reputation": 55, "user_id": 12180626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b240bc4567a06b0060150bd2c7c001e4?s=128&d=identicon&r=PG&f=1", "display_name": "emppunen", "link": "https://stackoverflow.com/users/12180626/emppunen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58836324, "answer_count": 1, "score": 1, "last_activity_date": 1573650220, "creation_date": 1573641858, "last_edit_date": 1573642826, "question_id": 58835358, "link": "https://stackoverflow.com/questions/58835358/how-to-delete-duplicates-in-excel-in-different-situations-vba", "title": "How to delete duplicates in excel in different situations (VBA)?", "body": "<p>I need to sum corresponding values in to the right columns, but also delete duplicates. Here's the deal:</p>\n\n<p>If, for example, I have columns from A to F. If columns A to E are the same with another row, macro deletes the row and saves older one. \nIF columns A to C are same with another existing row, macro deletes another row and adds those corresponding values from column D and E to the remaining row. Here is an example:</p>\n\n<pre><code>cell1 cell2 cell3 cell4 cell5 cell6\n1      1     1     1     1     1\n2      2     2     2     2     2\n2      2     2     2     2     2\n1      1     1     2     2     1\n3      3     3     3     3     3\n\nAfter macro:\n\ncell1  cell2 cell3 cell4 cell5 cell6\n1      1     1      3     3     1 \n2      2     2      2     2     2\n3      3     3      3     3     3 \n</code></pre>\n\n<p>So now, macro has deleted row 4 (because it has same values on column A to C as row 1 has) an adds corresponding values from columns D and E to row 1. Also, rows 2 and 3 are duplicates from column A to E, so macro deletes row 3.</p>\n\n<p>Here is an example what I have tried (I got help before with sum-problem (from @JvdV) and adding corresponding values in to right ones works, but I don't know, how to remove duplicates correctly..)</p>\n\n<p>Class module:</p>\n\n<pre><code>Public Col1 As Variant\nPublic Col2 As Variant\nPublic Col3 As Variant\nPublic Col4 As Variant\nPublic Col5 As Variant\nPublic Col6 As Variant\n</code></pre>\n\n<p>Module: </p>\n\n<pre><code>Dim x As Long, arr As Variant, lst As Class1\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\nWith Sheet1\n    x = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr = .Range(\"A1:F\" &amp; x).Value\nEnd With\n\n.Range(\"A1:F\" &amp; x).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6), Header:=xlYes\n\nFor x = LBound(arr) To UBound(arr)\n    If Not dict.Exists(arr(x, 1) &amp; \"|\" &amp; arr(x, 2) &amp; \"|\" &amp; arr(x, 3)) Then\n        Set lst = New Class1\n        lst.Col1 = arr(x, 1)\n        lst.Col2 = arr(x, 2)\n        lst.Col3 = arr(x, 3)\n        lst.Col4 = arr(x, 4)\n        lst.Col5 = arr(x, 5)\n        lst.Col6 = arr(x, 6)\n        dict.Add arr(x, 1) &amp; \"|\" &amp; arr(x, 2) &amp; \"|\" &amp; arr(x, 3), lst\n    Else\n        dict(arr(x, 1) &amp; \"|\" &amp; arr(x, 2) &amp; \"|\" &amp; arr(x, 3)).Col4 = dict(arr(x, 1) &amp; \"|\" &amp; arr(x, 2) &amp; \"|\" &amp; arr(x, 3)).Col4 + arr(x, 4)\n        dict(arr(x, 1) &amp; \"|\" &amp; arr(x, 2) &amp; \"|\" &amp; arr(x, 3)).Col5 = dict(arr(x, 1) &amp; \"|\" &amp; arr(x, 2) &amp; \"|\" &amp; arr(x, 3)).Col5 + arr(x, 5)\n    End If\nNext x\n\nWith Sheet1\n    x = 1\n    For Each Key In dict.Keys\n        .Cells(x, 1).Value = dict(Key).Col1\n        .Cells(x, 2).Value = dict(Key).Col2\n        .Cells(x, 3).Value = dict(Key).Col3\n        .Cells(x, 4).Value = dict(Key).Col4\n        .Cells(x, 5).Value = dict(Key).Col5\n        .Cells(x, 6).Value = dict(Key).Col6\n        x = x + 1\n    Next Key\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573649565, "post_id": 58837138, "comment_id": 103949398, "body": "Run time error 13 in line Set pf = SellOut.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Date&quot;)"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573649985, "post_id": 58837138, "comment_id": 103949649, "body": "My answer did not modifiy anything about <code>pf</code> variable, did you?"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573650250, "post_id": 58837138, "comment_id": 103949787, "body": "No this code from recorder work fine but is static:  ActiveSheet.PivotTables(&quot;PivotTable2&quot;).PivotCache.Refresh     ActiveSheet.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Date&quot;).C&zwnj;&#8203;learAllFilters     ActiveSheet.PivotTables(&quot;PivotTable2&quot;).PivotFields(&quot;Date&quot;).C&zwnj;&#8203;urrentPage = &quot;Oct&quot;"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573650411, "post_id": 58837138, "comment_id": 103949899, "body": "what is <code>SellOut</code>? it should be <code>Worksheet</code> type object pointing to proper worksheet"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573650981, "post_id": 58837138, "comment_id": 103950249, "body": "sorry it&#39;s declaration Dim WBM As Workbook Set WBM = Workbooks(&quot;MASTER SellOut.xlsx&quot;) Dim SellOut As Worksheet Set SellOut = WBM.Worksheets(&quot;SellOut&quot;)"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "reply_to_user": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1573654166, "post_id": 58837138, "comment_id": 103952134, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/202272/discussion-between-vaggelis-and-avb\">continue this discussion in chat</a>."}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573656392, "post_id": 58837138, "comment_id": 103953425, "body": "ok i will start again tomorrow i thing i have problem because the date field is in Greek language thank you very much avb!"}], "tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1573648038, "creation_date": 1573648038, "answer_id": 58837138, "question_id": 58835196, "link": "https://stackoverflow.com/questions/58835196/vba-change-pivot-month-filter-dynamic/58837138#58837138", "title": "VBA Change Pivot Month Filter Dynamic", "body": "<p>Your <code>pi</code> should be <code>PivotItem</code> not <code>PivotField</code> :</p>\n\n<pre><code>Dim pi As PivotItem\n...\nWith pf\n    On Error Resume Next\n    ' check, if pivotfield exists\n    Set pi = .PivotItems(strMonth)\n    On Error GoTo 0\n    If Not pi Is Nothing Then\n        pi.Visible = True\n        For Each pi In .PivotItems\n            If pi.Name &lt;&gt; strMonth Then pi.Visible = False\n        Next pi\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573651701, "creation_date": 1573641341, "last_edit_date": 1573651701, "question_id": 58835196, "link": "https://stackoverflow.com/questions/58835196/vba-change-pivot-month-filter-dynamic", "title": "VBA Change Pivot Month Filter Dynamic", "body": "<p>I have the following code to change pivot filter and I want to select the previus month from the current but the code doesn\u2019t do anything For example the filter is \u201cSep\u201d and I want to go to \u201cOct\u201d we have November I need to run the macro and change the filter to \u201cOct\u201d</p>\n\n<pre><code>Sub PivotChange()\nApplication.ScreenUpdating = False\n\nDim WBM As Workbook\nSet WBM = Workbooks(\"MASTER SellOut.xlsx\")\nDim SellOut As Worksheet\nSet SellOut = WBM.Worksheets(\"SellOut\")\nDim pf As PivotField\n\nSet pf = SellOut.PivotTables(\"PivotTable2\").PivotFields(\"Date\")\n\nDim pi As PivotField\nDim strMonth As String\n\n' current month as string\nstrMonth = Format(Date, \"mmm\")\n\n' refresh pivottable\n\nSellOut.PivotTables(\"PivotTable2\").PivotCache.Refresh\n\nWith SellOut.PivotTables(\"PivotTable2\").PivotFields(\"Date\")\n    On Error Resume Next\n    ' check, if pivotfield exists\n    Set pi = .PivotField(strMonth)\n    On Error GoTo 0\n    If Not pi Is Nothing Then\n        pi.Visible = True\n        For Each pi In .PivotField\n            If pi.Name &lt;&gt; strMonth Then pi.Visible = False\n        Next pi\n    End If\nEnd With\n\n Application.ScreenUpdating = True\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573641779, "post_id": 58835186, "comment_id": 103945480, "body": "Hello and welcome to SO. I&#39;m afraid your question is too unclear to answer, you will have to be more specific (include your code and pinpoint where you go wrong). Please take the <a href=\"https://stackoverflow.com/tour\">tour</a>, check <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> a question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and edit your question accordingly =)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573642017, "post_id": 58835186, "comment_id": 103945610, "body": "Scroll down this page and look at the list of questions in the bottom right of the page - they closely match your question. You may find something of value there."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1573642276, "post_id": 58835186, "comment_id": 103945734, "body": "You have to preserve batch values to a column when adding incomplete record set. Then use that column as listbox data source."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1573654448, "post_id": 58835186, "comment_id": 103952277, "body": "How did you load your listbox? And, please add your code to your question."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574103088, "post_id": 58835186, "comment_id": 104103445, "body": "See <a href=\"https://docs.microsoft.com/de-de/office/vba/language/reference/user-interface-help/additem-method\" rel=\"nofollow noreferrer\">AddItem method</a> and check examples at SO."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1573648275, "post_id": 58835509, "comment_id": 103948720, "body": "You probably want to rework your original question with this information."}], "tags": [], "owner": {"reputation": 1, "user_id": 12354735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2b_OyKJUukA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcpVcbqGU4Az0lf6LfxHzJxTRv4VQ/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/12354735/danny"}, "is_accepted": false, "score": 0, "last_activity_date": 1573642380, "creation_date": 1573642380, "answer_id": 58835509, "question_id": 58835186, "link": "https://stackoverflow.com/questions/58835186/how-to-add-an-item-to-a-listbox/58835509#58835509", "title": "how to add an item to a listbox", "body": "<p>hi sorry still new at vba</p>\n\n<p>i have the following set of code </p>\n\n<pre><code>enter code here\n</code></pre>\n\n<pre><code>\nDim i As Integer\nDim J As Integer\nDim uppercolJ As Integer\nDim Mistakes As Integer\nDim x As Integer\n'    cmas = UserForm3.MultiPage1.Pages(UserForm3.MultiPage1.Value).Controls(\"Txtbox\" &amp; 1 &amp; \"A\" &amp; J)\n\n\nSet Form = UserForm3.MultiPage1.Pages(UserForm3.MultiPage1.Value)\nuppercolJ = 41\nMistakes = 0\n        For J = 28 To uppercolJ\n            ActiveTextBoxName = \"Txtbox\" &amp; 1 &amp; \"A\" &amp; J\n\n            If UserForm3.MultiPage1.Pages(3).Controls(ActiveTextBoxName) = \"\" Then\n                Mistakes = Mistakes + 1\n\n            Else\n\n\n    End If\n        Next J\n         If Mistakes &gt; 0 Then\n  MsgBox \"Cells are incomplete, saving for later completion\"\n\nElse\nMsgBox \"comp\"\n'Call save\nEnd If\nEnd Sub`````\n\n\n\n\n\n\nnow when Mistakes &gt; 0 \nthen i would like it to save the batch no. of the product which can be found in Txtbox10A10\nto a listbox i have created. so that if i come back tomorroww  to finish all my data i can call that information from the batch no. in my listbox,\n\n\ni have all coding already done just not sure how to get it to add my backnumber to the listbox upon Mistakes &gt; 0\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12354735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2b_OyKJUukA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcpVcbqGU4Az0lf6LfxHzJxTRv4VQ/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/12354735/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573643341, "creation_date": 1573641321, "last_edit_date": 1573643341, "question_id": 58835186, "link": "https://stackoverflow.com/questions/58835186/how-to-add-an-item-to-a-listbox", "title": "how to add an item to a listbox", "body": "<p>I have a set of data on a Userform in multiple textboxes.</p>\n\n<p>I have written a code to find if there is a blank textbox left which would make the data sheet incomplete.</p>\n\n<p>If the data is incomplete I want it to take my batch number (which is in <code>Txtbox10A10</code>) and put the batch number in my listbox so that I can access it later to complete the data.</p>\n\n<p>Is there any way I can accomplish this? I have tried multiple ways with many errors.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573641444, "post_id": 58834825, "comment_id": 103945266, "body": "Since <code>cell</code> is a <code>Range</code> object, it also contains a value (or is empty). So this &quot;someone else&quot; made it such that <code>go.Range(&quot;B&quot; &amp; b).Value</code> will be equal to <code>cell</code> its value."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1573646661, "creation_date": 1573646661, "answer_id": 58836747, "question_id": 58834825, "link": "https://stackoverflow.com/questions/58834825/range-variable-not-defined/58836747#58836747", "title": "Range variable not defined", "body": "<p>Try:</p>\n\n<p><code>go.Range(\"B\" &amp; b).Value = cell.value</code></p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1573646979, "creation_date": 1573646979, "answer_id": 58836819, "question_id": 58834825, "link": "https://stackoverflow.com/questions/58834825/range-variable-not-defined/58836819#58836819", "title": "Range variable not defined", "body": "<p>Your question: <strong><em>how is the cell variable defined as a specific cell in the spreadsheet</em></strong>?</p>\n\n<p>The original author has created a loop (commonly known as a FOR..NEXT loop) that iterates through each child item of, in this case, a range <code>batch.Range(\"tbl_batches[BATCH_NO]\")</code>. (If not specified otherwise, such as <code>Columns</code>, or <code>Rows</code> - the child item defaults to <code>Cells</code>)</p>\n\n<pre><code>For Each cell In batch.Range(\"tbl_batches[BATCH_NO]\")\n</code></pre>\n\n<p>This could (and probably should) read:</p>\n\n<pre><code>For Each cell In batch.Range(\"tbl_batches[BATCH_NO]\").Cells\n</code></pre>\n\n<p>So each time the loop runs, it uses the next cell from the range specified and loads it to a Range object called <code>cell</code> - which is then used within the loop. This is why it's not always the best idea to name your cell range <code>cell</code> - as it can be confusing.</p>\n"}], "owner": {"reputation": 152, "user_id": 10327971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qlbv-iexsM4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNIgrvbz_ugnEHHtC0vEKuH5KI9gw/mo/photo.jpg?sz=128", "display_name": "pam_param", "link": "https://stackoverflow.com/users/10327971/pam-param"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 58836819, "answer_count": 2, "score": 0, "last_activity_date": 1573646979, "creation_date": 1573640171, "question_id": 58834825, "link": "https://stackoverflow.com/questions/58834825/range-variable-not-defined", "title": "Range variable not defined", "body": "<p>I've been tasked to correct someone elses code and it's not commented and I'm not a VBA pro. My question is, how is the cell variable defined as a specific cell in the spreadsheet.\nThis is the part I'm talking about:     <code>go.Range(\"B\" &amp; b).Value = cell</code></p>\n\n<p>First he sets it to be a Range dimension, and then all of a sudden it's being set equal to a cell, but how does it know that it contains anything? </p>\n\n<p>Let me know if I'm being too vague</p>\n\n<pre><code>    Dim batch As Worksheet\n    Dim go As Worksheet\n    Set batch = Worksheets(\"BATCHES\")\n    Set go = Worksheets(\"GoLive\")\n\n    Dim cell As Range\n    Dim b As Integer\n    Dim idag As Date\n    Dim modtaget As Date\n    idag = Format(Now(), \"YYYY-MM-DD\")\n\n\nb = 10\nDim N As Integer\n\n\n\nFor Each cell In batch.Range(\"tbl_batches[BATCH_NO]\")\n\n        If batch.Cells(cell.Row, batch.Range(\"tbl_batches[PKQA]\").Column) &lt;&gt; \"\" And batch.Cells(cell.Row, batch.Range(\"tbl_batches[PGAQA]\").Column) = \"\" Then\n\n                If batch.Cells(cell.Row, batch.Range(\"tbl_batches[QARP]\").Column) = \"\" Then\n                    go.Range(\"B\" &amp; b).Value = cell\n\n                    modtaget = batch.Cells(cell.Row, batch.Range(\"tbl_batches[PKQA]\").Column)\n                    go.Range(\"C\" &amp; b).Value = modtaget\n\n                    N = Application.WorksheetFunction.NetworkDays(modtaget, idag)\n                    go.Range(\"D\" &amp; b).Value = N\n\n                    b = b + 1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1573637370, "post_id": 58833884, "comment_id": 103943070, "body": "Note when using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Range.Find method</a> <b>always</b> specify the <code>LookAt</code> parameter als <code>xlWhole</code> or <code>xlPart</code>. If you don&#39;t do that Excel will use whatever was used last by either VBA or the user interface. That means the result will be unpredictable! \u2022 Using <code>GoTo</code> is a very bad practice! And <code>GoTo NextB</code> is not defined so nothing to jump to! \u2022 Also don&#39;t use <code>.Select</code> and <code>Activate</code> see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 1, "user_id": 12365653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/510c46d404bcf314f595297e82fdc523?s=128&d=identicon&r=PG&f=1", "display_name": "ShroomBear", "link": "https://stackoverflow.com/users/12365653/shroombear"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573638164, "post_id": 58833884, "comment_id": 103943491, "body": "The Goto reference is not included as this this isn&#39;t the full code, so it&#39;s further down. Good call on LookAt parameter, just added it to the rest of the body."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573638256, "post_id": 58833884, "comment_id": 103943541, "body": "Well, still don&#39;t use <code>GoTo</code> use a <code>If \u2026 Then \u2026 Else \u2026 End If</code> structure instead."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1573638294, "post_id": 58833884, "comment_id": 103943560, "body": "Also, you can eliminate the If...ElseIf...ElseIf block with <code>Sheets(&quot;Trans Out&quot;).Range(&quot;$I$4&quot;).Offset(ToutControl-1,0).Value = ActiveCell.Value</code>."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1573638511, "post_id": 58833884, "comment_id": 103943687, "body": "@ShroomBear: When will you have multiple values to sum?"}, {"owner": {"reputation": 1, "user_id": 12365653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/510c46d404bcf314f595297e82fdc523?s=128&d=identicon&r=PG&f=1", "display_name": "ShroomBear", "link": "https://stackoverflow.com/users/12365653/shroombear"}, "edited": false, "score": 0, "creation_date": 1573640110, "post_id": 58833884, "comment_id": 103944566, "body": "So in the example above I listed 1 value being pulled from the intersection. What I&#39;m trying to do is do that 3 times from different intersection locations, then print the sum of the 3 values to the same cell. The column in the intersection will always be there, however the external data will exclude entire rows if the value I need from it is 0. So if the row is missing the statement needs to be able to exclude skip and move on or list the intersected value as 0. Hence the goto&#39;s which I realize is bad, however I don&#39;t know a workaround with if-then"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573640263, "post_id": 58833884, "comment_id": 103944647, "body": "Not really getting what you want. Obviously <code>xPath</code> will only get the first cell containing &quot;Rowheader&quot;, but you might have three values like that? Is that why you try to loop?"}, {"owner": {"reputation": 1, "user_id": 12365653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/510c46d404bcf314f595297e82fdc523?s=128&d=identicon&r=PG&f=1", "display_name": "ShroomBear", "link": "https://stackoverflow.com/users/12365653/shroombear"}, "edited": false, "score": 0, "creation_date": 1573641737, "post_id": 58833884, "comment_id": 103945445, "body": "Yes, I&#39;ll get a value when I intersect rowheader with columnheader, but I&#39;ll have between 0 to 3 values from different rows with different headers that would need to get added together and printed into a cell onto a different sheet"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1573647345, "creation_date": 1573647345, "answer_id": 58836921, "question_id": 58833884, "link": "https://stackoverflow.com/questions/58833884/intersect-multiple-rows-and-columns-then-sum-them/58836921#58836921", "title": "Intersect multiple rows and columns then SUM them", "body": "<p>Try:</p>\n\n<pre><code>'Use Long to avoid error in case of a number bigger than 32,767\nDim ToutControl As Long\n\n'9 is the number of column I\nSheets(\"Trans Out\").Cells(ToutControl + 3, 9).Value = ActiveCell.Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12365653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/510c46d404bcf314f595297e82fdc523?s=128&d=identicon&r=PG&f=1", "display_name": "ShroomBear", "link": "https://stackoverflow.com/users/12365653/shroombear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573647345, "creation_date": 1573637117, "last_edit_date": 1573637688, "question_id": 58833884, "link": "https://stackoverflow.com/questions/58833884/intersect-multiple-rows-and-columns-then-sum-them", "title": "Intersect multiple rows and columns then SUM them", "body": "<p>so I'm working on an excel macro that simply prints values from external data to another sheet. The column and row headers can change position based on the external data so I used find then intersect to get the values I needed. It works well enough until I needed to print the SUM of multiple values. I'm also using option buttons to change what rows the values print to based on which is checked. An example of the working code:</p>\n\n<pre><code>Sub XXXXTest()\nApplication.ScreenUpdating = False\nDim ToutControl As Integer\n\n'XXXX\n'Selects XXXX total by finding string headers then intersecting\nDim xPath As String\nDim xTot As String\nDim xCol As Range\nDim xRow As Range\n\nActiveWorkbook.Sheets(\"Rodeo1\").Activate\n\nxPath = \"Rowheader\"\nxTot = \"ColumnHeader\"\n\nSet xRow = Columns(1).Find(xPath)\nIf xRow Is Nothing Then GoTo NextB\nSet xCol = Rows(1).Find(xTot)\nIf xCol Is Nothing Then msg = msg &amp; vbLf &amp; xTot\nIf msg = \"\" Then\n    Intersect(xRow.EntireRow, xCol.EntireColumn).Activate\nElse\n\nEnd If\n\n\n'Looks at option button control value and depending on said value, will write Trans value from above in different rows\nToutControl = Sheets(\"Trans Out\").Range(\"$A$3\").Value\n\nIf ToutControl = 1 Then\n    Sheets(\"Trans Out\").Range(\"$I$4\").Value = ActiveCell.Value\nElseIf ToutControl = 2 Then\n    Sheets(\"Trans Out\").Range(\"$I$5\").Value = ActiveCell.Value\nElseIf ToutControl = 3 Then\n    Sheets(\"Trans Out\").Range(\"$I$6\").Value = ActiveCell.Value\nElseIf ToutControl = 4 Then\n    Sheets(\"Trans Out\").Range(\"$I$7\").Value = ActiveCell.Value\nElseIf ToutControl = 5 Then\n    Sheets(\"Trans Out\").Range(\"$I$8\").Value = ActiveCell.Value\nElseIf ToutControl = 6 Then\n    Sheets(\"Trans Out\").Range(\"$I$9\").Value = ActiveCell.Value\nElseIf ToutControl = 7 Then\n    Sheets(\"Trans Out\").Range(\"$I$10\").Value = ActiveCell.Value\nElseIf ToutControl = 8 Then\n    Sheets(\"Trans Out\").Range(\"$I$11\").Value = ActiveCell.Value\nElseIf ToutControl = 9 Then\n    Sheets(\"Trans Out\").Range(\"$I$12\").Value = ActiveCell.Value\nElseIf ToutControl = 10 Then\n    Sheets(\"Trans Out\").Range(\"$I$13\").Value = ActiveCell.Value\nElseIf ToutControl = 11 Then\n    Sheets(\"Trans Out\").Range(\"$I$14\").Value = ActiveCell.Value\nElse: MsgBox \"Please Select A Time\"\n    End If\n</code></pre>\n\n<p>How would I go about doing the same thing but with multiple rows intersecting with the same column and then printing the sum of the returned values into cells like I did above?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573637054, "post_id": 58833838, "comment_id": 103942908, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1573646845, "creation_date": 1573646845, "answer_id": 58836790, "question_id": 58833838, "link": "https://stackoverflow.com/questions/58833838/refresh-all-on-all-open-worksheets/58836790#58836790", "title": "Refresh all on all open worksheets", "body": "<p>You could try:</p>\n\n<ol>\n<li>Loop all open workbooks</li>\n<li>Refresh</li>\n</ol>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub LoopOpenWorkbook()\n\n    Dim wb As Workbook\n\n    For Each wb In Application.Workbooks\n\n        wb.RefreshAll\n\n    Next wb\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58836790, "answer_count": 1, "score": 0, "last_activity_date": 1573646845, "creation_date": 1573636941, "last_edit_date": 1573637128, "question_id": 58833838, "link": "https://stackoverflow.com/questions/58833838/refresh-all-on-all-open-worksheets", "title": "Refresh all on all open worksheets", "body": "<p>I have master sheet in which data from various \"options\" sheets pulled now I want to refresh all \"options\" sheets to get refresh on specific interval for that I have following vba code in master sheet</p>\n\n<pre><code>Public interval As Double\nSub Dosomething()\nDim xSh As Worksheet\nApplication.ScreenUpdating = False\nFor Each xSh In Worksheets\n    xSh.Select\n    Call macro_timer\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n\nSub macro_timer()\n interval = Now + TimeValue(\"00:03:00\")\n Application.OnTime interval, \"my_macro\"\n End Sub\n\n\nSub my_macro()\n For Each wb In Application.Workbooks: wb.RefreshAll: Next wb\n Call macro_timer\n End Sub\n</code></pre>\n\n<p>However code is not working as I wanted somewhere I am lacking, don't know where. pls help.thx</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1573637500, "post_id": 58833828, "comment_id": 103943145, "body": "Please include the code you are working on in your question."}, {"owner": {"reputation": 29, "user_id": 12074970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2a720444802b6f55c995e761a88d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/12074970/christian"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573639040, "post_id": 58833828, "comment_id": 103943996, "body": "@braX sorry but so far I only have the whole macro to create the template for my file from a SAP script. However, I just need to include in the code to copy from these five sheets. My current macro won&#39;t help on this matter, as it only creates the original file."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12074970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2a720444802b6f55c995e761a88d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/12074970/christian"}, "edited": false, "score": 0, "creation_date": 1573641056, "post_id": 58834052, "comment_id": 103945067, "body": "Hi Nathan. Thanks im gonna try that out!"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1573637782, "creation_date": 1573637782, "answer_id": 58834052, "question_id": 58833828, "link": "https://stackoverflow.com/questions/58833828/vba-copying-from-changing-date-file/58834052#58834052", "title": "VBA Copying from changing date file", "body": "<p>Something along these lines, using <code>split</code> and <code>mid</code></p>\n\n<p>Called like so</p>\n\n<p><code>SortDateOut(\"TTDU 20191123\")</code></p>\n\n<pre><code>Function SortDateOut(strInput As String) As Date\n\nDim s As String\n\ns = Split(strInput, Chr(32))(1)\n\nSortDateOut = DateSerial(Mid(s, 1, 4), Mid(s, 5, 2), Mid(s, 7, 2))\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12074970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2a720444802b6f55c995e761a88d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/12074970/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58834052, "answer_count": 1, "score": 0, "last_activity_date": 1573637782, "creation_date": 1573636899, "last_edit_date": 1573637482, "question_id": 58833828, "link": "https://stackoverflow.com/questions/58833828/vba-copying-from-changing-date-file", "title": "VBA Copying from changing date file", "body": "<p>I have an issue I hope you can assist me with. \nI need to copy 5 files into one, the challenge though is the files is named after the dates they were created.</p>\n\n<p>eg. file names could be; </p>\n\n<pre><code>TTDU 20191113 (for today).\nTTDU 20191112\nTTDU 20191111\netc. \n</code></pre>\n\n<p>(TTDU is name of the report and will never change)\nIs there a way to create a line of code, where it subtracts -1 day from file name? And can it work for workdays and not include weekend?\nOr maybe you have an idea how to do it in another way</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["regex", "excel", "vba", "dropbox"], "owner": {"reputation": 101, "user_id": 8490765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdcfa0b3de9e6b40afd5959fa7a4ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hall", "link": "https://stackoverflow.com/users/8490765/robert-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573638924, "creation_date": 1573636030, "last_edit_date": 1573638924, "question_id": 58833597, "link": "https://stackoverflow.com/questions/58833597/find-dropbox-path-not-working-on-some-computers", "title": "Find dropbox path not working on some computers", "body": "<p>The code below is causing some trouble. I have used it on 5 computers and it works fine. My company has now brought 5 more computers and now it doesn't want to work on the new ones. It is supposed to find the dropbox path using the JSON file. </p>\n\n<pre><code>Function DownloadF()\nDim RegEx As Object\nDim MatchColl As Object\nDim DataLine As String\nDim DropboxPath\nConst FileNum = 1 ' Assumes no other files are open!!\n\nSet RegEx = CreateObject(\"VBScript.RegExp\")\nRegEx.Global = True\nRegEx.IgnoreCase = False\n\n\nOpen Environ(\"LOCALAPPDATA\") &amp; \"\\Dropbox\\info.json\" For Input As #FileNum\n\nDo While Not EOF(FileNum)\n   Line Input #FileNum, DataLine  ' read in data 1 line at a time\n   ' decide what to do with dataline,\n   ' depending on what processing you need to do for each case\nLoop\n\nClose #FileNum\n\nRegEx.Pattern = \"^.*\"\"path\"\": \"\"([^\"\"]*).*\"\n\nDropboxPath = Replace(RegEx.Replace(DataLine, \"$1\"), \"\", \"\")\n\n' If there are multiple dropbox accounts on this machine, this will\n' only get the first one\n\nDownloadF = DropboxPath &amp; Range(\"Pathway\")\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ZAae0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZAae0.jpg\" alt=\"Working Code\"></a></p>\n\n<p>The above picture is what it is supposed to show but the below is what it returns.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rTaCI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rTaCI.jpg\" alt=\"Non-working\"></a></p>\n\n<p>All the settings are the same for excel. Has anyone came across this problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573635619, "post_id": 58833354, "comment_id": 103942180, "body": "You should not use <code>.Activate</code> and <code>ActiveSheet</code> (bad practice and not reliable!) instead <code>Set</code> your sheet to a variable name and use that instead of <code>ActiveSheet</code>. Make sure <b>every</b> <code>Cells</code> and <code>Range</code> object is referenced to a sheet. For example <code>Range(PasteStartCell, PasteEndCell)</code> and others are not referenced! If you open a new workbook set it to a variable eg <code>Set MyWb =  Workbooks.Open(BureauplannersFile)</code> to directly access it later. \u2022 Besides these minor coding style issues I see nothing that could be improved much in speed."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573635832, "post_id": 58833354, "comment_id": 103942291, "body": "In this line <code>.Range(Cells(9, CurrentweekColumn.Column).Address)</code> in which workbook do you expect <code>Cells</code> to be? In the same as the <code>Range</code> object? If yes then you must specify it by using <code>.Cells(\u2026)</code> so it uses the sheet from the <code>With</code> block. Otherwise you might get unexpected results if Excel guesses the sheet wrong."}, {"owner": {"reputation": 47, "user_id": 12342220, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hHu9jyh0Jj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaO4U2ga47k690TcUHvqD4R2rvgg/photo.jpg?sz=128", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/12342220/jelle-van-der-heijden"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573636249, "post_id": 58833354, "comment_id": 103942508, "body": "Thanks for the fast reply. I will add your suggestions to my code. Further, I just found something that could be interesting. Is it smart to clear the memory from my variables like set pasterange = nothing"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573636632, "post_id": 58833354, "comment_id": 103942701, "body": "This will actually happen at <code>End Sub</code> automatically anyway (when the variable runs out of scope). So this will not help you in this case. Also see <a href=\"https://stackoverflow.com/questions/517006/is-there-a-need-to-set-objects-to-nothing-inside-vba-functions\">Is there a need to set Objects to Nothing inside VBA Functions</a>. There are only rare cases wher this would be needed/useful."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1573642435, "post_id": 58833354, "comment_id": 103945812, "body": "This would be better suited to <a href=\"https://codereview.stackexchange.com/\">Code Review</a>."}], "owner": {"reputation": 47, "user_id": 12342220, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hHu9jyh0Jj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaO4U2ga47k690TcUHvqD4R2rvgg/photo.jpg?sz=128", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/12342220/jelle-van-der-heijden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573635732, "creation_date": 1573635157, "last_edit_date": 1573635732, "question_id": 58833354, "link": "https://stackoverflow.com/questions/58833354/ways-to-optimize-codes", "title": "Ways to optimize codes", "body": "<p>I have written a code in VBA editor (Excel). Basically the code defines which project this is (because there are multiple sheets working with this code). Then it copies and paste the data in the right column and row in an overview workbook (where all the files send their data). So I get a nice overview of my projects.</p>\n\n<p>But now I like to optimize my code so it's faster. I have two different codes, one of the codes is shown below. </p>\n\n<p>I'm aware of making my codes faster with disabling things like screen updating and calculations.</p>\n\n<p>My question is: How can I improve the code itself?</p>\n\n<pre><code>Option Explicit\nPrivate Sub SyncToBureauplanner()\n\nOn Error GoTo Errormessage\n\n'|  Define current projectplanner\n    Dim Projectnumber As String\n        Projectnumber = ActiveWorkbook.Sheets(\"Planning\").Range(\"A6\").Value2\n\n    Dim Projectplanner As String\n        Projectplanner = Projectnumber &amp; \".xlsm\"\n\n'|  Define this week then find the column of this week\n    Dim Currentweek As String\n        Currentweek = Workbooks(Projectplanner).Sheets(\"Planning\").Range(\"B5\").Value2\n\n    Dim CurrentweekColumn As Range\n        With Workbooks(Projectplanner).Sheets(\"Planning\").Range(\"2:2\")\n            Set CurrentweekColumn = .Find(What:=Currentweek, LookIn:=xlValues, Lookat:=xlWhole, MatchCase:=False, Searchformat:=False)\n        End With\n\n'|  Define phasedata range\n    Dim PhaseStart As Range\n    Dim PhaseEnd As Range\n    Dim Phasedata As Range\n\n         With Workbooks(Projectplanner).Sheets(\"Planning\")\n            Set PhaseStart = .Range(Cells(9, CurrentweekColumn.Column).Address)\n            Set PhaseEnd = .Range(Cells(10, CurrentweekColumn.Offset(0, 106).Column).Address)\n            Set Phasedata = .Range(PhaseStart, PhaseEnd)\n        End With\n\n'|  Locate the Bureauplanning and open it | Disable filters\n    Dim BureauplannersPath As String\n        BureauplannersPath = \"J:\\Planning\\Bureauplanning\\\"\n\n    Dim Bureauplanner As String\n        Bureauplanner = \"Bureauplanning.xlsm\"\n\n    Dim BureauplannersFile As String\n        BureauplannersFile = BureauplannersPath &amp; Bureauplanner\n\n        Workbooks.Open (BureauplannersFile)\n            Workbooks(Bureauplanner).Sheets(\"planning\").Activate\n                If ActiveSheet.AutoFilterMode Then ActiveSheet.AutoFilter.ShowAllData\n\n\n'|  Define column where Phasedata is going to be pasted\n    Dim CurrentWeekBureauplanner As Range\n        With Workbooks(Bureauplanner).Sheets(\"planning\").Range(\"L2:DO2\")\n            Set CurrentWeekBureauplanner = .Find(What:=Currentweek, LookIn:=xlValues, Lookat:=xlWhole, MatchCase:=False, Searchformat:=False)\n                If Not CurrentWeekBureauplanner Is Nothing Then\n                End If\n    End With\n\n'|  Define row where Phasedata is going to be pasted\n    Dim ThisProjectRow As Range\n        With Workbooks(Bureauplanner).Sheets(\"planning\").Range(\"A:A\")\n            Set ThisProjectRow = .Find(What:=Projectnumber, LookIn:=xlValues, Lookat:=xlWhole, MatchCase:=False, Searchformat:=False)\n                If Not ThisProjectRow Is Nothing Then\n                End If\n        End With\n\n'|  Define range where Phasedata is going to be pasted\n    Dim PasteStartCell As Range\n    Dim PasteEndCell As Range\n        With Workbooks(Bureauplanner).Sheets(\"planning\")\n            Set PasteStartCell = .Cells(ThisProjectRow.Offset(-1, 0).Row, CurrentWeekBureauplanner.Column)\n            Set PasteEndCell = .Cells(ThisProjectRow.Row, CurrentWeekBureauplanner.Offset(0, 106).Column)\n        End With\n\n    Dim PasteRange As Range\n        Set PasteRange = Range(PasteStartCell, PasteEndCell)\n\n'|  Execute copy and paste\n    PasteRange = Phasedata.Value\n\n'|  Save and close the Bureauplanner\n    With Workbooks(Bureauplanner)\n        .Save\n        .Close\n    End With\n\n'|  End of the Code\nExit Sub\n\n'|  Error messages\nErrormessage:\nMsgBox (\"Er is iets mis gegaan, controleer de code\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 9, "creation_date": 1573637802, "post_id": 58833831, "comment_id": 103943297, "body": "<a href=\"https://stackoverflow.com/q/58833923/7296893\">This post</a> seems to encounter the same error using the 64-bit Access runtime and OLEDB. Scary stuff, this will make many applications that use Access to store data unuseable."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 4, "creation_date": 1573684092, "post_id": 58833831, "comment_id": 103966840, "body": "I just checked a system with Office 2013 32-bit and on that particular machine the UUID for the update is <code>90150000-006E-0409-0000-0000000FF1CE</code> ... that&#39;s <code>-0409-</code>, not <code>-0407-</code>."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 4, "creation_date": 1573689638, "post_id": 58833831, "comment_id": 103968399, "body": "I just checked another machine in the office that has Office 2013 64-bit and the UUID is <code>-006E-0409-</code> as well. Both machines have Service Pack 1 for Microsoft Office 2013 (KB2850036) installed."}, {"owner": {"reputation": 1411, "user_id": 4121863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43e77d8245591671b702eda73a4f3a2a?s=128&d=identicon&r=PG", "display_name": "AdamsTips", "link": "https://stackoverflow.com/users/4121863/adamstips"}, "edited": false, "score": 4, "creation_date": 1573689733, "post_id": 58833831, "comment_id": 103968415, "body": "For Office 2010 Pro Plus (SP2) we needed to use <code>{90140000-0011-0000-0000-0000000FF1CE}</code> in the batch script. Note <code>{9014...</code> not <code>{9114..}</code>"}, {"owner": {"reputation": 101, "user_id": 8053928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c80fb0606dee7cecc44e75f41579d16?s=128&d=identicon&r=PG", "display_name": "user218076", "link": "https://stackoverflow.com/users/8053928/user218076"}, "edited": false, "score": 2, "creation_date": 1575819040, "post_id": 58833831, "comment_id": 104685306, "body": "I have patched with the official update to resolve the issue but I&#39;m still getting the error. Anyone else got that problem?"}], "tags": [], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "is_accepted": true, "score": 93, "last_activity_date": 1576062076, "last_edit_date": 1576062076, "creation_date": 1573636917, "answer_id": 58833831, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58833831#58833831", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<h1>Summary</h1>\n\n<p>This is a <a href=\"https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec\" rel=\"nofollow noreferrer\">known bug</a> caused by the Office updates released on November 12, 2019. The bug affects all versions of Access currently supported by Microsoft (from Access 2010 to 365).</p>\n\n<p><strong>This bug has been fixed.</strong></p>\n\n<ul>\n<li>If you use a C2R (Click-to-Run) version of Office, <a href=\"https://support.office.com/en-us/article/install-office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5\" rel=\"nofollow noreferrer\">use \"Update now\"</a>:\n\n<ul>\n<li>Access 2010 C2R: Fixed in Build 7243.5000</li>\n<li>Access 2013 C2R: Fixed in Build 5197.1000</li>\n<li>Access 2016 C2R: Fixed in Build 12130.20390</li>\n<li>Access 2019 (v1910): Fixed in Build 12130.20390</li>\n<li>Access 2019 (Volume License): Fixed in Build 10353.20037</li>\n<li>Office 365 Monthly Channel: Fixed in Build 12130.20390</li>\n<li>Office 365 Semi-Annual: Fixed in Build 11328.20480</li>\n<li>Office 365 Semi-Annual Extended: Fixed in Build 10730.20422</li>\n<li>Office 365 Semi-Annual Targeted: Fixed in Build 11929.20494</li>\n</ul></li>\n<li>If you use an MSI version of Office, install the update matching your Office version. All of these patches have been released on Microsoft Update, so <a href=\"https://support.microsoft.com/en-us/help/12373/windows-update-faq\" rel=\"nofollow noreferrer\">installing all pending Windows Updates</a> should suffice:\n\n<ul>\n<li>Access 2010 MSI: Fixed in <a href=\"https://support.microsoft.com/en-us/help/4484193/security-update-for-office-2010-december-10-2019\" rel=\"nofollow noreferrer\">KB4484193</a></li>\n<li>Access 2013 MSI: Fixed in <a href=\"https://support.microsoft.com/en-us/help/4484186/security-update-for-office-2013-december-10-2019\" rel=\"nofollow noreferrer\">KB4484186</a></li>\n<li>Access 2016 MSI: Fixed in <a href=\"https://support.microsoft.com/en-us/help/4484180/security-update-for-office-2016-december-10-2019\" rel=\"nofollow noreferrer\">KB4484180</a></li>\n</ul></li>\n</ul>\n\n<hr>\n\n<h1>Example</h1>\n\n<p>Here is a minimal repro example:</p>\n\n<ol>\n<li>Create a new Access database.</li>\n<li>Create a new, empty table \"Table1\" with the default ID field and a Long Integer field \"myint\".</li>\n<li><p>Execute the following code in the VBA editor's Immediate Window:</p>\n\n<p><code>CurrentDb.Execute \"UPDATE Table1 SET myint = 1 WHERE myint = 1\"</code></p></li>\n</ol>\n\n<p><strong>Expected result</strong>: The statement successfully finishes.</p>\n\n<p><strong>Actual result</strong> with one of the buggy updates installed: Run-time error 3340 occurs (\"Query '' is corrupt\").</p>\n\n<hr>\n\n<p>Related links:</p>\n\n<ul>\n<li><a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/7e7f24cc-f1f3-43f8-a9a2-45b77812b211/the-cve20191402-updates-kb4484119-etc-break-access-201020132016365-query-is-corrupt?forum=accessdev\" rel=\"nofollow noreferrer\">MSDN forum thread</a></li>\n<li><a href=\"https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec\" rel=\"nofollow noreferrer\">Official Microsoft page for this bug</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1281, "user_id": 75187, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4648188107455bbcb7d9e78dffddbb7?s=128&d=identicon&r=PG", "display_name": "dsteele", "link": "https://stackoverflow.com/users/75187/dsteele"}, "edited": false, "score": 0, "creation_date": 1573690861, "post_id": 58834545, "comment_id": 103968659, "body": "I uninstalled it, but it re-installed the next time I started Windows. How do you prevent it from reinstalling?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 1281, "user_id": 75187, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4648188107455bbcb7d9e78dffddbb7?s=128&d=identicon&r=PG", "display_name": "dsteele", "link": "https://stackoverflow.com/users/75187/dsteele"}, "edited": false, "score": 5, "creation_date": 1573693711, "post_id": 58834545, "comment_id": 103969281, "body": "@dsteele If MSI version and no WSUS, use <a href=\"https://support.microsoft.com/en-us/help/3073930/how-to-temporarily-prevent-a-driver-update-from-reinstalling-in-window\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/3073930/&hellip;</a> troubleshooting tool. On CTR disable updates in Office-Account-Settings.."}], "tags": [], "owner": {"reputation": 151, "user_id": 12366037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d018b581184a7b10940159ec0d34ffa?s=128&d=identicon&r=PG", "display_name": "Grant", "link": "https://stackoverflow.com/users/12366037/grant"}, "is_accepted": false, "score": 15, "last_activity_date": 1573639298, "creation_date": 1573639298, "answer_id": 58834545, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58834545#58834545", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>To temporarily resolve this issue depends on the Access version in use: <br/>\nAccess 2010        Uninstall update KB4484127<br/>\nAccess 2013        Uninstall update KB4484119<br/>\nAccess 2016        Uninstall update KB4484113<br/>\nAccess 2019        IF REQUIRED (tbc). Downgrade from Version 1808 (Build 10352.20042) to  Version 1808 (Build 10351.20054)<br/>\nOffice 365 ProPlus           Downgrade from Version 1910 (Build 12130.20344) to a previous build, see <a href=\"https://support.microsoft.com/en-gb/help/2770432/how-to-revert-to-an-earlier-version-of-office-2013-or-office-2016-clic\" rel=\"noreferrer\">https://support.microsoft.com/en-gb/help/2770432/how-to-revert-to-an-earlier-version-of-office-2013-or-office-2016-clic</a><br/></p>\n"}, {"comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 13, "creation_date": 1573679430, "post_id": 58836471, "comment_id": 103964886, "body": "Are you actually saying with a straight face  that we go to 100s of thousands of lines of code deployed across multiple applications and fix all the sql updates that simple update a row of data? I suppose if you writing a new query today,and right now, then such a workaround is possible. But for existing code and applications the idea that sql updates are to be changed is of course not a practical approach to probelm solving in any possbile way."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 5, "creation_date": 1573681134, "post_id": 58836471, "comment_id": 103965652, "body": "@AlbertD.Kallal, you should know from the MVP list, that I just refer to the explanation for the source of the issue. How to deal with the issue is really up to you and what may fit your scenario. The method described here is just one of several."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 1, "creation_date": 1573681463, "post_id": 58836471, "comment_id": 103965791, "body": "@AlbertD.Kallal Shouldn&#39;t renaming tables and creating QueryDefs with old table-name fix that? (I will test that and post the script if it works)"}, {"owner": {"reputation": 1480, "user_id": 4836581, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206454381101857/picture?type=large", "display_name": "Zvi Redler", "link": "https://stackoverflow.com/users/4836581/zvi-redler"}, "edited": false, "score": 0, "creation_date": 1573714751, "post_id": 58836471, "comment_id": 103974646, "body": "You can do it with no programing, for example rename table &quot;users&quot; to &quot;userst&quot; and then create query name &quot;users&quot; - and then it will work with no programing chane...."}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 9, "creation_date": 1573719497, "post_id": 58836471, "comment_id": 103976652, "body": "@AlbertD.Kallal: I share your pain - if this were a bug affecting the VC runtime library, I don&#39;t think that MS would delay the fix for one month and suggest a &quot;rewrite, recompile and redeploy&quot; workaround. (To be fair, they fixed and released the VBA issue in late August quickly.) But let&#39;s not shoot the messenger - Gustav does not seem to be an MS employee. Let&#39;s hope they reconsider and release a patch earlier; after all, it also affects <a href=\"https://stackoverflow.com/q/58833923/87698\">applications written in other languages that just happen to use the Access DB engine</a>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 20, "last_activity_date": 1573662348, "last_edit_date": 1573662348, "creation_date": 1573645758, "answer_id": 58836471, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58836471#58836471", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>This is not a Windows update problem, but a problem that was introduced with the November Patch Tuesday Office release.  A change to fix a security vulnerability causes some legitimate queries to be reported as corrupt.\nBecause the change was a security fix, it impacts ALL builds of Office, including 2010, 2013, 2016, 2019, and O365.</p>\n\n<p>The bug has been fixed in all channels, but the timing of delivery will depend on what channel you are on.</p>\n\n<p>For 2010, 2013, and 2016 MSI, and 2019 Volume License  builds, and the O365 Semi-annual channel, the fix will be in the December Patch Tuesday build, Dec 10.\nFor O365, Monthly Channel, and Insiders, this will be fixed when the October fork is released, currently planned for Nov 24.</p>\n\n<p>For the Semi-Annual channel, the bug was introduced in 11328.20468, which was released Nov 12, but doesn\u2019t roll out to everyone all at once.\nIf you can, you might want to hold off on updating until Dec 10.</p>\n\n<p>The issue occurs for update queries against a single table with a criteria specified (so other types of queries shouldn\u2019t be impacted, nor any query that updates all rows of a table, nor a query that updates the result set of another query).\nGiven that, the simplest workaround in most cases is to change the update query to update another query that selects everything from the table, rather than updating the query directly.</p>\n\n<p>I.e., if you have a query like: </p>\n\n<pre><code>UPDATE Table1 SET Table1.Field1 = \"x\" WHERE ([Table1].[Field2]=1);\n</code></pre>\n\n<p>Then, create a new query (Query1) defined as: </p>\n\n<pre><code>Select * from Table1;\n</code></pre>\n\n<p>and update your original query to: </p>\n\n<pre><code>UPDATE Query1 SET Query1.Field1 = \"x\" WHERE ([Query1].[Field2]=1);\n</code></pre>\n\n<p>Official page: <a href=\"https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec\" rel=\"noreferrer\">Access error: \"Query is corrupt\"</a></p>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 4, "creation_date": 1573720589, "post_id": 58846497, "comment_id": 103977167, "body": "Note that this workaround will ruin subforms bound to tables (will need to be rebound to queries) and code working with tabledefs with a hardcoded table name. Use with great caution, odds are this fixes one bug only to create two new ones depending on what your application is doing."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1573722905, "post_id": 58846497, "comment_id": 103978388, "body": "@ErikA Of course only a workaround, but I can bind<code>Inventory to reorder Subform for Home</code>to<code>Inventory</code>table in<code>Home</code>form, without problems. Even isn&#39;t it recomended to bind forms to queries instead of tables (isn&#39;t binding to table like<code>Select * From table</code> ?)."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1573723071, "post_id": 58846497, "comment_id": 103978490, "body": "If I bind a subform to a table, I generally do it using the <code>Table.TableName</code> notation. If you do <code>SELECT * FROM TableName</code> instead, you&#39;re of course fine. But if you use <code>Table.TableName</code>, your subform will become unbound if you rename the table."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1573723584, "post_id": 58846497, "comment_id": 103978781, "body": "@ErikA: That true. Any benefit by doing that?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1573725595, "post_id": 58846497, "comment_id": 103979979, "body": "Not as far as I know, except that it&#39;s more brief. There is a substantial advantage of <code>TableDefs!MyTableName.OpenRecordset(dbOpenTable)</code>, though (support of index seeking), which I also tend to use and will also cause errors with your approach"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 3, "last_activity_date": 1573774811, "last_edit_date": 1573774811, "creation_date": 1573683573, "answer_id": 58846497, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58846497#58846497", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>VBA-Script for MS-Workaround:</p>\n\n<p>It is recommended to remove the buggy update, if possible (if not try my code), at least for the MSI Versions. See answer <a href=\"https://stackoverflow.com/a/58833831/9439330\">https://stackoverflow.com/a/58833831/9439330</a> . </p>\n\n<p>For CTR(Click-To-Run) Versions, you have to remove all Office November-Updates, what may cause serious security issues (not sure if any critical fixes would be removed).</p>\n\n<p>From @Eric's comments:</p>\n\n<ul>\n<li>If you use<code>Table.Tablename</code>to bind forms, they get unbound as the former table-name is now a query-name!.</li>\n<li><code>OpenRecordSet(FormerTableNowAQuery, dbOpenTable)</code> will fail ( as its a query now, not a table anymore)</li>\n</ul>\n\n<p><strong>Caution!</strong> Just quick tested against <a href=\"https://github.com/fsprojects/DynamicsNAVProvider/blob/master/docs/files/msaccess/Northwind.accdb\" rel=\"nofollow noreferrer\">Northwind.accdb</a> on Office 2013 x86 CTR <strong>No Warranty!</strong> </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub RenameTablesAndCreateQueryDefs()\nWith CurrentDb\n    Dim tdf As DAO.TableDef\n    For Each tdf In .TableDefs\n\n        Dim oldName As String\n        oldName = tdf.Name\n\n        If Not (tdf.Attributes And dbSystemObject) Then 'credit to @lauxjpn for better check for system-tables\n            Dim AllFields As String\n            AllFields = vbNullString\n\n            Dim fld As DAO.Field\n\n            For Each fld In tdf.Fields\n                AllFields = AllFields &amp; \"[\" &amp; fld.Name &amp; \"], \"\n            Next fld\n\n            AllFields = Left(AllFields, Len(AllFields) - 2)\n            Dim newName As String\n            newName = oldName\n\n            On Error Resume Next\n            Do\n                Err.Clear\n                newName = newName &amp; \"_\"\n                tdf.Name = newName\n            Loop While Err.Number = 3012\n            On Error GoTo 0\n\n            Dim qdf As DAO.QueryDef\n\n            Set qdf = .CreateQueryDef(oldName)\n            qdf.SQL = \"SELECT \" &amp; AllFields &amp; \" FROM [\" &amp; newName &amp; \"]\"\n        End If\n    Next\n    .TableDefs.Refresh\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>For testing:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub TestError()\nWith CurrentDb\n    .Execute \"Update customers Set City = 'a' Where 1=1\", dbFailOnError 'works\n\n    .Execute \"Update customers_ Set City = 'b' Where 1=1\", dbFailOnError 'fails\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1411, "user_id": 4121863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43e77d8245591671b702eda73a4f3a2a?s=128&d=identicon&r=PG", "display_name": "AdamsTips", "link": "https://stackoverflow.com/users/4121863/adamstips"}, "is_accepted": false, "score": 3, "last_activity_date": 1573696623, "creation_date": 1573696623, "answer_id": 58848268, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58848268#58848268", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>For those looking to <strong>automate</strong> this process via <strong>PowerShell</strong>, here are a few links I found that may be helpful:</p>\n\n<h2>Detect and Remove the Offending Updates</h2>\n\n<p>There is a PowerShell script available here <a href=\"https://www.arcath.net/2017/09/office-update-remover\" rel=\"nofollow noreferrer\">https://www.arcath.net/2017/09/office-update-remover</a> that searches the registry for a specific Office update (passed in as a kb number) and removes it using a call to <code>msiexec.exe</code>. This script parses out both GUIDs from the registry keys to build the command to remove the appropriate update. </p>\n\n<p>One change that I would suggest would be using the <code>/REBOOT=REALLYSUPPRESS</code> as described in <a href=\"https://social.technet.microsoft.com/Forums/en-US/24b5a52c-ea2f-44e7-9fd3-57aae4d44ba4/how-to-uninstall-kb4011626-and-other-office-updates?forum=ConfigMgrCompliance\" rel=\"nofollow noreferrer\">How to uninstall KB4011626 and other Office updates</a> (Additional reference: <a href=\"https://docs.microsoft.com/en-us/windows/win32/msi/uninstalling-patches\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/msi/uninstalling-patches</a>). The command line you are building looks like this:</p>\n\n<pre><code>msiexec /i {90160000-0011-0000-0000-0000000FF1CE} MSIPATCHREMOVE={9894BF35-19C1-4C89-A683-D40E94D08C77} /qn REBOOT=REALLYSUPPRESS\n</code></pre>\n\n<p>The command to run the script would look something like this:</p>\n\n<pre><code>OfficeUpdateRemover.ps1 -kb 4484127\n</code></pre>\n\n<h2>Prevent the Updates from Installing</h2>\n\n<p>The recommended approach here seems to be <strong>hiding the update</strong>. Obviously this can be done manually, but there are some PowerShell scripts that can help with automation.\nThis link: <a href=\"https://www.maketecheasier.com/hide-updates-in-windows-10/\" rel=\"nofollow noreferrer\">https://www.maketecheasier.com/hide-updates-in-windows-10/</a> describes the process in detail, but I will summarize it here.</p>\n\n<ol>\n<li>Install the <a href=\"https://gallery.technet.microsoft.com/scriptcenter/2d191bcd-3308-4edd-9de2-88dff796b0bc\" rel=\"nofollow noreferrer\">Windows Update PowerShell Module</a>.</li>\n<li><p>Use the following command to hide an update by KB number:</p>\n\n<p>Hide-WUUpdate -KBArticleID KB4484127</p></li>\n</ol>\n\n<p>Hopefully this will be a help to someone else out there.</p>\n"}, {"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1573773831, "post_id": 58863891, "comment_id": 104005337, "body": "I like your determing a systemtable with<code>TableDef.Attributes</code>and copy that to my answer ;) and an undo function is a good idea (but old and new name should be stored in a table as depending on no tables with suffix before the rename). Some other parts are faulty (e.g. tables can end with the suffix or newname is allready in use or <code>On Error Resume Next</code>without handling errors later). Do you know <a href=\"https://github.com/rubberduck-vba/Rubberduck/\" rel=\"nofollow noreferrer\">RubberduckVBA</a>? This Addin can inspect your code and makes nice suggestions for improvemnt, besides all the other features."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1573774019, "post_id": 58863891, "comment_id": 104005392, "body": "And you should point to the bugs our approach can cause (See @Erics comments on my answer)"}, {"owner": {"reputation": 3378, "user_id": 2618319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13144016bb3af78d51a9807d334355d6?s=128&d=identicon&r=PG", "display_name": "lauxjpn", "link": "https://stackoverflow.com/users/2618319/lauxjpn"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1573865383, "post_id": 58863891, "comment_id": 104040008, "body": "Ah, I didn&#39;t see that there was already a similar answer here, so thanks for the review! The suffix is defined in its own constant, so it can easily be changed in case there is an already preexisting object defined that already uses the suffix. Otherwise the script works as is but anybody should feel encouraged to modify it to their individual needs. The script has been tested on fairly large projects (400+ tables) including external/linked tables to different external database sources.  I did not know about Rubberduck (only about MZ-Tools). I will definitely check them out!"}], "tags": [], "owner": {"reputation": 3378, "user_id": 2618319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13144016bb3af78d51a9807d334355d6?s=128&d=identicon&r=PG", "display_name": "lauxjpn", "link": "https://stackoverflow.com/users/2618319/lauxjpn"}, "is_accepted": false, "score": 4, "last_activity_date": 1575916908, "last_edit_date": 1575916908, "creation_date": 1573757472, "answer_id": 58863891, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58863891#58863891", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>Use the following module to automatically implement Microsofts suggested workaround (using a query instead of a table). As a precaution, backup your database first.</p>\n\n<p>Use <code>AddWorkaroundForCorruptedQueryIssue()</code> to add the workaround and <code>RemoveWorkaroundForCorruptedQueryIssue()</code> to remove it at any time.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPrivate Const WorkaroundTableSuffix As String = \"_Table\"\n\nPublic Sub AddWorkaroundForCorruptedQueryIssue()\n    On Error Resume Next\n\n    With CurrentDb\n        Dim tableDef As tableDef\n        For Each tableDef In .tableDefs\n            Dim isSystemTable As Boolean\n            isSystemTable = tableDef.Attributes And dbSystemObject\n\n            If Not EndsWith(tableDef.Name, WorkaroundTableSuffix) And Not isSystemTable Then\n                Dim originalTableName As String\n                originalTableName = tableDef.Name\n\n                tableDef.Name = tableDef.Name &amp; WorkaroundTableSuffix\n\n                Call .CreateQueryDef(originalTableName, \"select * from [\" &amp; tableDef.Name &amp; \"]\")\n\n                Debug.Print \"OldTableName/NewQueryName\" &amp; vbTab &amp; \"[\" &amp; originalTableName &amp; \"]\" &amp; vbTab &amp; _\n                            \"NewTableName\" &amp; vbTab &amp; \"[\" &amp; tableDef.Name &amp; \"]\"\n            End If\n        Next\n    End With\nEnd Sub\n\nPublic Sub RemoveWorkaroundForCorruptedQueryIssue()\n    On Error Resume Next\n\n    With CurrentDb\n        Dim tableDef As tableDef\n        For Each tableDef In .tableDefs\n            Dim isSystemTable As Boolean\n            isSystemTable = tableDef.Attributes And dbSystemObject\n\n            If EndsWith(tableDef.Name, WorkaroundTableSuffix) And Not isSystemTable Then\n                Dim originalTableName As String\n                originalTableName = Left(tableDef.Name, Len(tableDef.Name) - Len(WorkaroundTableSuffix))\n\n                Dim workaroundTableName As String\n                workaroundTableName = tableDef.Name\n\n                Call .QueryDefs.Delete(originalTableName)\n                tableDef.Name = originalTableName\n\n                Debug.Print \"OldTableName\" &amp; vbTab &amp; \"[\" &amp; workaroundTableName &amp; \"]\" &amp; vbTab &amp; _\n                            \"NewTableName\" &amp; vbTab &amp; \"[\" &amp; tableDef.Name &amp; \"]\" &amp; vbTab &amp; \"(Query deleted)\"\n            End If\n        Next\n    End With\nEnd Sub\n\n'From https://excelrevisited.blogspot.com/2012/06/endswith.html\nPrivate Function EndsWith(str As String, ending As String) As Boolean\n     Dim endingLen As Integer\n     endingLen = Len(ending)\n     EndsWith = (Right(Trim(UCase(str)), endingLen) = UCase(ending))\nEnd Function\n</code></pre>\n\n<p>You can find the latest code on my <a href=\"https://github.com/lauxjpn/CorruptQueryAccessWorkaround\" rel=\"nofollow noreferrer\">GitHub repository</a>.</p>\n\n<p><code>AddWorkaroundForCorruptedQueryIssue()</code> will add the suffix <code>_Table</code> to all non-system tables, e.g. the table <code>IceCreams</code> would be renamed to <code>IceCreams_Table</code>.</p>\n\n<p>It will also create a new query using the original table name, that will select all columns of the renamed table. In our example, the query would be named <code>IceCreams</code> and would execute the SQL <code>select * from [IceCreams_Table]</code>.</p>\n\n<p><code>RemoveWorkaroundForCorruptedQueryIssue()</code> does the reverse actions.</p>\n\n<p>I tested this with all kinds of tables, including external non-MDB tables (like SQL Server). But be aware, that using a query instead of a table can lead to non-optimized queries being executed against a backend database in specific cases, especially if your original queries that used the tables are either of poor quality or very complex.</p>\n\n<p>(And of course, depending on your coding style, it is also possible to break things in your application. So after verifying that the fix generally works for you, it's never a bad idea to export all your objects as text and use some find replace magic to ensure that any occurrences of table names use will be run against the queries and not the tables.)</p>\n\n<p>In my case, this fix works largely without any side effects, I just needed to manually rename <code>USysRibbons_Table</code> back to <code>USysRibbons</code>, as I hadn't marked it as a system table when I created it in the past.</p>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 2475837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LzxKU.jpg?s=128&g=1", "display_name": "LukeChung-FMS", "link": "https://stackoverflow.com/users/2475837/lukechung-fms"}, "is_accepted": false, "score": 5, "last_activity_date": 1573773043, "creation_date": 1573773043, "answer_id": 58867945, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58867945#58867945", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>We and our clients have struggled with this the last two days and finally wrote a paper to discuss the issue in detail along with some solutions: <a href=\"http://fmsinc.com/MicrosoftAccess/Errors/query_is_corrupt/\" rel=\"noreferrer\">http://fmsinc.com/MicrosoftAccess/Errors/query_is_corrupt/</a></p>\n\n<p>It includes our findings that it impacts Access solutions when running update queries on local tables, linked Access tables, and even linked SQL Server tables.</p>\n\n<p>It also impacts non-Microsoft Access solutions using the Access Database Engine (ACE) to connect to Access databases using ADO. That includes Visual Studio (WinForm) apps, VB6 apps, and even web sites that update Access databases on machines that never had Access or Office installed on them.</p>\n\n<p>This crash can even impact Microsoft apps that use ACE such as PowerBI, Power Query, SSMA, etc. (not confirmed), and of course, other programs such as Excel, PowerPoint or Word using VBA to modify Access databases.</p>\n\n<p>In addition to the obvious uninstallation of the offending Security Updates, we also include some options when it's not possible to uninstall due to permissions or distribution of Access applications to external customers whose PCs are beyond your control. That includes changing all the Update queries and distributing the Access applications using Access 2007 (retail or runtime) since that version isn't impacted by the security updates.</p>\n"}, {"tags": [], "owner": {"reputation": 461, "user_id": 11878745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7ebfcff3c19b130d298c97ded8b632e?s=128&d=identicon&r=PG", "display_name": "Joe Marinucci", "link": "https://stackoverflow.com/users/11878745/joe-marinucci"}, "is_accepted": false, "score": 34, "last_activity_date": 1575899909, "last_edit_date": 1592644375, "creation_date": 1573836551, "answer_id": 58881416, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58881416#58881416", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<h1>Simplest Solution</h1>\n<p>For my users, waiting nearly a month till December 10 for a fix release from Microsoft is not an option. Nor is uninstalling the offending Microsoft update across several government locked down workstations.</p>\n<p>I need to apply a workaround, but am not exactly thrilled with what Microsoft suggested - creating and substituting a query for each table.</p>\n<p>The solution is to replace the Table name with a simple <code>(SELECT * FROM Table)</code> query directly in the <code>UPDATE</code> command. This does not require creating and saving a ton of additional queries, tables, or functions.</p>\n<p>EXAMPLE:</p>\n<p>Before:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE Table1 SET Field1 = &quot;x&quot; WHERE (Field2=1);  \n</code></pre>\n<p>After:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE (SELECT * FROM Table1) SET Field1 = &quot;x&quot; WHERE (Field2=1);  \n</code></pre>\n<p>That should be much easier to implement across several databases and applications (and later rollback).</p>\n"}, {"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 2, "last_activity_date": 1574265843, "last_edit_date": 1574265843, "creation_date": 1574180607, "answer_id": 58938643, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/58938643#58938643", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>I replaced the <code>currentDb.Execute</code> and <code>Docmd.RunSQL</code> with a helper function. That can pre-process and change the SQL Statement if any update statement contains only one table. I already have a <code>dual</code>(single row, single column) table so i went with a fakeTable option.</p>\n\n<p><strong>Note</strong>: This won't change your query objects. It will only help SQL executions via VBA. <code>If you would like to change your query objects, use FnQueryReplaceSingleTableUpdateStatements and update your sql in each of your querydefs. Shouldn't be a problem either.</code></p>\n\n<p>This is just a concept <code>(If it's a single table update modify the sql before execution)</code>. Adapt it as per your needs. This method does not create replacement queries for each table (which may be the easiest way but has it's own drawbacks. i.e performance issues)</p>\n\n<p><strong>+Points:</strong> \nYou can <strong>continue</strong> to use this helper even after MS fixing the bug it won't change anything. In case, future brings another problem, you are ready to <code>pre-process</code> your SQL in one place. I didn't go for <strong>uninstalling updates</strong> method because that requires Admin access + gonna take too long to get everyone on the correct version + even if you uninstall, some end users's group policy installs the latest update again. You are back to the same problem. </p>\n\n<p>If you have access to the source-code, <code>use this method</code> and you are 100% sure that no enduser is having the issue.</p>\n\n<pre><code>Public Function Execute(Query As String, Optional Options As Variant)\n    'Direct replacement for currentDb.Execute\n\n    If IsBlank(Query) Then Exit Function\n\n    'invalid db options remove\n    If Not IsMissing(Options) Then\n        If (Options = True) Then\n            'DoCmd RunSql query,True ' True should fail so transactions can be reverted\n            'We are only doing this so DoCmd.RunSQL query, true can be directly replaced by helper.Execute query, true.\n            Options = dbFailOnError\n        End If\n    End If\n\n    'Preprocessing the sql command to remove single table updates\n    Query = FnQueryReplaceSingleTableUpdateStatements(Query)\n\n    'Execute the command\n    If ((Not IsMissing(Options)) And (CLng(Options) &gt; 0)) Then\n        currentDb.Execute Query, Options\n    Else\n        currentDb.Execute Query\n    End If\n\nEnd Function\n\nPublic Function FnQueryReplaceSingleTableUpdateStatements(Query As String) As String\n    ' ON November 2019 Microsoft released a buggy security update that affected single table updates.\n    'https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql\n\n    Dim singleTableUpdate   As String\n    Dim tableName           As String\n\n    Const updateWord        As String = \"update\"\n    Const setWord           As String = \"set\"\n\n    If IsBlank(Query) Then Exit Function\n\n    'Find the update statement between UPDATE ... SET\n    singleTableUpdate = FnQueryContainsSingleTableUpdate(Query)\n\n    'do we have any match? if any match found, that needs to be preprocessed\n    If Not (IsBlank(singleTableUpdate)) Then\n\n        'Remove UPDATe keyword\n        If (VBA.Left(singleTableUpdate, Len(updateWord)) = updateWord) Then\n            tableName = VBA.Right(singleTableUpdate, Len(singleTableUpdate) - Len(updateWord))\n        End If\n\n        'Remove SET keyword\n        If (VBA.Right(tableName, Len(setWord)) = setWord) Then\n            tableName = VBA.Left(tableName, Len(tableName) - Len(setWord))\n        End If\n\n        'Decide which method you want to go for. SingleRow table or Select?\n        'I'm going with a fake/dual table.\n        'If you are going with update (select * from T) as T, make sure table aliases are correctly assigned.\n        tableName = gDll.sFormat(\"UPDATE {0},{1} SET \", tableName, ModTableNames.FakeTableName)\n\n        'replace the query with the new statement\n        Query = vba.Replace(Query, singleTableUpdate, tableName, compare:=vbDatabaseCompare, Count:=1)\n\n    End If\n\n    FnQueryReplaceSingleTableUpdateStatements = Query\n\nEnd Function\n\nPublic Function FnQueryContainsSingleTableUpdate(Query As String) As String\n    'Returns the update ... SET statment if it contains only one table.\n\n    FnQueryContainsSingleTableUpdate = \"\"\n    If IsBlank(Query) Then Exit Function\n\n    Dim pattern     As String\n    Dim firstMatch  As String\n\n    'Get the pattern from your settings repository or hardcode it.\n    pattern = \"(update)+(\\w|\\s(?!join))*set\"\n\n    FnQueryContainsSingleTableUpdate = FN_REGEX_GET_FIRST_MATCH(Query, pattern, isGlobal:=True, isMultiline:=True, doIgnoreCase:=True)\n\nEnd Function\n\nPublic Function FN_REGEX_GET_FIRST_MATCH(iText As String, iPattern As String, Optional isGlobal As Boolean = True, Optional isMultiline As Boolean = True, Optional doIgnoreCase As Boolean = True) As String\n'Returns first match or \"\"\n\n    If IsBlank(iText) Then Exit Function\n    If IsBlank(iPattern) Then Exit Function\n\n    Dim objRegex    As Object\n    Dim allMatches  As Variant\n    Dim I           As Long\n\n    FN_REGEX_GET_FIRST_MATCH = \"\"\n\n   On Error GoTo FN_REGEX_GET_FIRST_MATCH_Error\n\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    With objRegex\n        .Multiline = isMultiline\n        .Global = isGlobal\n        .IgnoreCase = doIgnoreCase\n        .pattern = iPattern\n\n        If .test(iText) Then\n            Set allMatches = .Execute(iText)\n            If allMatches.Count &gt; 0 Then\n                FN_REGEX_GET_FIRST_MATCH = allMatches.item(0)\n            End If\n        End If\n    End With\n\n    Set objRegex = Nothing\n\n   On Error GoTo 0\n   Exit Function\n\nFN_REGEX_GET_FIRST_MATCH_Error:\n    FN_REGEX_GET_FIRST_MATCH = \"\"\n\nEnd Function\n</code></pre>\n\n<p>Now just <kbd>CTRL</kbd>+<kbd>F</kbd> </p>\n\n<p>Search and replace <code>docmd.RunSQL</code> with <code>helper.Execute</code></p>\n\n<p>Search and replace <code>[currentdb|dbengine|or your dbobject].execute</code> with <code>helper.execute</code></p>\n\n<p>have fun!</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "is_accepted": false, "score": 0, "last_activity_date": 1576860516, "creation_date": 1576860516, "answer_id": 59428753, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql/59428753#59428753", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>Ok I'll chime in here as well, because even though this bug has been fixed, that fix has yet to populate fully through various enterprises where the end users may not be able to update (like my employer...)</p>\n\n<p>Here's my workaround for <code>DoCmd.RunSQL \"UPDATE users SET uname= 'bob' WHERE usercode=1\"</code>.  Just comment out the offending query and drop in the code below.</p>\n\n<pre><code>    'DoCmd.RunSQL \"UPDATE users SET uname= 'bob' WHERE usercode=1\"\n    Dim rst As DAO.Recordset\n    Set rst = CurrentDb.OpenRecordset(\"users\")\n    rst.MoveLast\n    rst.MoveFirst\n    rst.FindFirst \"[usercode] = 1\" 'note: if field is text, use \"[usercode] = '1'\"\n    rst.Edit\n    rst![uname] = \"bob\"\n    rst.Update\n    rst.Close\n    Set rst = Nothing\n</code></pre>\n\n<p>I can't say it's pretty, but it gets the job done.</p>\n"}], "owner": {"reputation": 1480, "user_id": 4836581, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206454381101857/picture?type=large", "display_name": "Zvi Redler", "link": "https://stackoverflow.com/users/4836581/zvi-redler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31871, "favorite_count": 12, "protected_date": 1573720036, "accepted_answer_id": 58833831, "answer_count": 10, "score": 84, "last_activity_date": 1578102022, "creation_date": 1573630363, "last_edit_date": 1578102022, "question_id": 58832269, "link": "https://stackoverflow.com/questions/58832269/getting-error-3340-query-is-corrupt-while-executing-queries-docmd-runsql", "title": "Getting Error 3340 Query &#39; &#39; is corrupt while executing queries DoCmd.RunSQL", "body": "<p>Since installing <a href=\"https://support.microsoft.com/en-us/help/4484127/security-update-for-office-2010-november-12-2019\" rel=\"nofollow noreferrer\">the windows update for Office 2010 resolving KB 4484127</a> I get an error while executing queries which contain a WHERE clause.</p>\n\n<p>For example executing this query:</p>\n\n<pre><code>DoCmd.RunSQL \"update users set uname= 'bob' where usercode=1\"\n</code></pre>\n\n<p>Results in this error:</p>\n\n<blockquote>\n  <p>Error number = 3340 Query ' ' is corrupt</p>\n</blockquote>\n\n<p>The <a href=\"https://support.microsoft.com/en-us/help/20191112/security-update-deployment-information-november-12-2019\" rel=\"nofollow noreferrer\">update in question</a> is currently still installed:</p>\n\n<p><a href=\"https://i.stack.imgur.com/V5hEf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V5hEf.png\" alt=\"Screenshot showing Microsoft Office 2010 Service Pack 2 update 448127\"></a></p>\n\n<p>How can I successfully run my queries? Should I just uninstall this update?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1573629646, "post_id": 58832076, "comment_id": 103939389, "body": "Please include what the error message is and on which line it occurs in your question."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573630812, "post_id": 58832076, "comment_id": 103939932, "body": "Remove the <code>OnError</code> handler, it&#39;s hiding the fact one of your lines throws an error!"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1573636989, "post_id": 58832076, "comment_id": 103942864, "body": "You know that DateNow and dateLastModified are not actualized in real time, do you?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1573640751, "post_id": 58832076, "comment_id": 103944893, "body": "@VincentG what do you mean by this? How to check that file is up to date? How to compare that files date of &quot;Date modified&quot; matches today&#39;s date?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1573641141, "post_id": 58832076, "comment_id": 103945112, "body": "In your initial code you are getting the date of the file before copying the file, the date stored won&#39;t change even if the date of modification of the file is changed. You need to get it again after the copy to get the actualized date."}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1573641378, "post_id": 58832076, "comment_id": 103945227, "body": "I have changed it now to check for date first. Does code after EDIT section looks correct now?"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 8322319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dxVRvoIP6Hg/AAAAAAAAAAI/AAAAAAAADGU/G_AU_h2mTAU/photo.jpg?sz=128", "display_name": "Judge", "link": "https://stackoverflow.com/users/8322319/judge"}, "is_accepted": true, "score": 1, "last_activity_date": 1573639856, "creation_date": 1573639856, "answer_id": 58834726, "question_id": 58832076, "link": "https://stackoverflow.com/questions/58832076/ensure-that-file-on-network-drive-is-up-to-date/58834726#58834726", "title": "Ensure that file on network drive is up to date", "body": "<p>I have a distant memory of Application.Wait being unreliable.</p>\n\n<p>Try using <code>sleep</code> instead and see if that works more reliably.</p>\n\n<p>Put this at the top of your sheet/module:</p>\n\n<pre><code>#If VBA7 Then ' Excel 2010 or later\nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As LongPtr)\n#Else ' Excel 2007 or earlier\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As Long)\n#End If\n</code></pre>\n\n<p>Then use this in your code instead of <code>Application.Wait (Now + TimeValue(\"0:00:15\"))</code>:</p>\n\n<pre><code>Sleep 15000\n</code></pre>\n\n<p>The above <code>Sleep 15000</code> asks the application to wait for 15,000 milliseconds.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58834726, "answer_count": 1, "score": 1, "last_activity_date": 1573640629, "creation_date": 1573629536, "last_edit_date": 1573640629, "question_id": 58832076, "link": "https://stackoverflow.com/questions/58832076/ensure-that-file-on-network-drive-is-up-to-date", "title": "Ensure that file on network drive is up to date", "body": "<p>My target is:</p>\n\n<ol>\n<li>Copy file </li>\n<li>Ensure that it is copied</li>\n<li>Ensure that file on network drive has been updated = date modified is today</li>\n<li>If it is not up to date throw an error and proceed to ErrorHandler</li>\n</ol>\n\n<p>Current problem is (I guess) that it somehow goes straight for checking for date modified without taking in account the timer. So I am getting an error message all the time. If I remove part for date modified checking, everything works fine.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub CopyFile()\n\nOn Error GoTo ErrorHandler\n\n            Dim fso As Object\n            Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\n            Dim FileIsHere: FileIsHere = \"L:\\15\\File.CSV\"\n            Dim PasteItHere: PasteItHere = \"C:\\temp\\\"\n\n            Dim ChechDateFile: ChechDateFile = \"C:\\temp\\File.CSV\"\n            Dim dateLastModified: dateLastModified = fso.GetFile(ChechDateFile).dateLastModified\n            Dim DateNow: DateNow = Now()\n\n            'MsgBox (Day(DateNow) &amp; \".\" &amp; Month(DateNow) &amp; \".\" &amp; Year(DateNow))\n            'MsgBox (Day(dateLastModified) &amp; \".\" &amp; Month(dateLastModified) &amp; \".\" &amp; Year(dateLastModified))\n\n            Call fso.CopyFile(FileIsHere, PasteItHere, True)\n\n            Application.Wait (Now + TimeValue(\"0:00:15\"))\n\n            If Day(DateNow) &amp; \".\" &amp; Month(DateNow) &amp; \".\" &amp; Year(DateNow) &lt;&gt; Day(dateLastModified) &amp; \".\" &amp; Month(dateLastModified) &amp; \".\" &amp; Year(dateLastModified) Then\n\n            'On Error Resume Next\n            MsgBox 1 / 0\n\n            Else\n\n            End If\n\nErrorHandler:\n\n' Send an email message with error\n\nEnd Sub\n</code></pre>\n\n<p>After running this script: Files is not modified, I am receiving an error message. </p>\n\n<p>Error message is from errorhandler. Date of file modified is different, even if it is copied. Then IF is true and code goes to MsgBox 1 / 0. Looks like timer does not work?</p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I don't have any errors in the code, also after commenting out </p>\n\n<pre><code>On Error GoTo ErrorHandler\n</code></pre>\n\n<p>I think the problem was just in the logic of the code. I have made it so now, that first it checks for file \"Date modified\" on network drive, so it is up to date and is updated TODAY. Then if this statement is correct it does the copy. Otherwise if dates does not match it throws an error and code goes to <code>ErrorHandler</code></p>\n\n<p>My code:</p>\n\n<pre><code>Sub CopyFile()\n\nOn Error GoTo ErrorHandler\n\n            Dim fso As Object\n            Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\n            Dim FileIsHere: FileIsHere = \"L:\\15\\File.CSV\"\n            Dim PasteItHere: PasteItHere = \"C:\\temp\\\"\n\n            Dim ChechDateFile: ChechDateFile = \"C:\\temp\\File.CSV\"\n            Dim dateLastModified: dateLastModified = fso.GetFile(ChechDateFile).dateLastModified\n            Dim DateNow: DateNow = Now()\n\n            If Day(DateNow) &amp; \".\" &amp; Month(DateNow) &amp; \".\" &amp; Year(DateNow) &lt;&gt; Day(dateLastModified) &amp; \".\" &amp; Month(dateLastModified) &amp; \".\" &amp; Year(dateLastModified) Then\n\n            'On Error Resume Next\n            MsgBox 1 / 0\n\n            Else\n\n               Call fso.CopyFile(FileIsHere, PasteItHere, True)\n\n            End If\n\nErrorHandler:\n\n' Send an email message with error\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12341131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd34d5ce2262a39a511dab18ef5f3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tanty", "link": "https://stackoverflow.com/users/12341131/tanty"}, "edited": false, "score": 1, "creation_date": 1573630813, "post_id": 58832200, "comment_id": 103939933, "body": "ah, thank you so much! very appreciated. but there&#39;s an error in line <code>With .Sheets(&quot;MM&quot;)             &#39;First Sheet Name</code> . Error: Object Required. i think your code already great."}, {"owner": {"reputation": 146, "user_id": 8322319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dxVRvoIP6Hg/AAAAAAAAAAI/AAAAAAAADGU/G_AU_h2mTAU/photo.jpg?sz=128", "display_name": "Judge", "link": "https://stackoverflow.com/users/8322319/judge"}, "reply_to_user": {"reputation": 5, "user_id": 12341131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd34d5ce2262a39a511dab18ef5f3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tanty", "link": "https://stackoverflow.com/users/12341131/tanty"}, "edited": false, "score": 0, "creation_date": 1573631155, "post_id": 58832200, "comment_id": 103940100, "body": "Fixed it. I had made a typo when adding &#39;ActiveWorkbook&#39;. If it works, meets your needs, and taught you something, please accept the answer :-)."}, {"owner": {"reputation": 5, "user_id": 12341131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd34d5ce2262a39a511dab18ef5f3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tanty", "link": "https://stackoverflow.com/users/12341131/tanty"}, "edited": false, "score": 1, "creation_date": 1573631660, "post_id": 58832200, "comment_id": 103940338, "body": "ah, sorry. that&#39;s my fault. i didn&#39;t see the typo. and your code run sooo smoothly. very very great! thank you so much for your help! also there&#39;s a typo in line <code>Range2.Interior.Pattern = xlNone</code> , bro. you type twice. that should be <code>Range3.Interior.Pattern = xlNone</code> . but, i&#39;ve changed. THANK YOU SO MUCH~"}, {"owner": {"reputation": 146, "user_id": 8322319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dxVRvoIP6Hg/AAAAAAAAAAI/AAAAAAAADGU/G_AU_h2mTAU/photo.jpg?sz=128", "display_name": "Judge", "link": "https://stackoverflow.com/users/8322319/judge"}, "reply_to_user": {"reputation": 5, "user_id": 12341131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd34d5ce2262a39a511dab18ef5f3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tanty", "link": "https://stackoverflow.com/users/12341131/tanty"}, "edited": false, "score": 0, "creation_date": 1573631975, "post_id": 58832200, "comment_id": 103940473, "body": "Fixed that in the answer. Hope it helps."}], "tags": [], "owner": {"reputation": 146, "user_id": 8322319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dxVRvoIP6Hg/AAAAAAAAAAI/AAAAAAAADGU/G_AU_h2mTAU/photo.jpg?sz=128", "display_name": "Judge", "link": "https://stackoverflow.com/users/8322319/judge"}, "is_accepted": true, "score": 0, "last_activity_date": 1573631878, "last_edit_date": 1573631878, "creation_date": 1573630095, "answer_id": 58832200, "question_id": 58831570, "link": "https://stackoverflow.com/questions/58831570/vba-macro-compare-check-3-sheets-and-return-differences-value/58832200#58832200", "title": "VBA Macro : Compare / check 3 sheets and return differences value", "body": "<p>Based on the information you've provided, you want to:</p>\n\n<ol>\n<li>Check three tables across three sheets in the <code>ActiveWorkbook</code></li>\n<li>Check to see if the same number of constants exists in the table ranges</li>\n<li>Highlight cells red where the values between the three sheets aren't the same</li>\n</ol>\n\n<p>I've simplified the code in order to achieve these targets</p>\n\n<pre><code>Sub MatchValue()\n\n  Dim Range1 As Range, Range2 As Range, Range3 As Range\n\n  With ActiveWorkbook\n    With .Sheets(\"MM\")            'First Sheet Name\n      Set Range1 = .Range(\"B6\")   'Address of first row on First Sheet\n      Set Range1 = .Range(Range1, .Cells(.Rows.Count, Range1.Column).End(xlUp))\n    End With\n\n    With .Sheets(\"PP\")            'Second Sheet Name\n      Set Range2 = .Range(\"B6\")   'Address of first row on second Sheet\n      Set Range2 = .Range(Range2, .Cells(.Rows.Count, Range2.Column).End(xlUp))\n    End With\n\n    With .Sheets(\"CO\")            'Third Sheet Name\n      Set Range3 = .Range(\"B6\")   'Address of first row on third Sheet\n      Set Range3 = .Range(Range3, .Cells(.Rows.Count, Range3.Column).End(xlUp))\n    End With\n  End With\n\n'Delete this part if you don't want to remove the existing fill (might be handy)\n  Range1.Interior.Pattern = xlNone\n  Range2.Interior.Pattern = xlNone\n  Range3.Interior.Pattern = xlNone\n\n'Checks to see if the same number of constants exist within the test ranges\n  If Range1.SpecialCells(xlCellTypeConstants).Count &lt;&gt; _\n     Range2.SpecialCells(xlCellTypeConstants).Count Then\n    MsgBox \"Range 1 and Range 2 constant count doesn't match\", vbCritical, \"Error Report\"\n  ElseIf Range2.SpecialCells(xlCellTypeConstants).Count &lt;&gt; _\n         Range3.SpecialCells(xlCellTypeConstants).Count Then\n    MsgBox \"Range 1 and Range 2 constant count doesn't match\", vbCritical, \"Error Report\"\n  End If\n\n  Dim Temp1 As Variant, Temp2 As Variant, Temp3 As Variant, x As Long\n\n'Checks to see if all the values entered are the same, if not, fills them red\n  Temp1 = Range1.Value\n  Temp2 = Range2.Value\n  Temp3 = Range3.Value\n\n  For x = 1 To UBound(Temp1, 1)\n    If Temp1(x, 1) &lt;&gt; Temp2(x, 1) Or _\n       Temp2(x, 1) &lt;&gt; Temp3(x, 1) Then\n      Range1.Cells(x, 1).Interior.Color = RGB(255, 0, 0)\n      Range2.Cells(x, 1).Interior.Color = RGB(255, 0, 0)\n      Range3.Cells(x, 1).Interior.Color = RGB(255, 0, 0)\n    End If\n  Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12341131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd34d5ce2262a39a511dab18ef5f3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tanty", "link": "https://stackoverflow.com/users/12341131/tanty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58832200, "answer_count": 1, "score": 0, "last_activity_date": 1573631878, "creation_date": 1573627093, "last_edit_date": 1573630013, "question_id": 58831570, "link": "https://stackoverflow.com/questions/58831570/vba-macro-compare-check-3-sheets-and-return-differences-value", "title": "VBA Macro : Compare / check 3 sheets and return differences value", "body": "<p>I have 3 sheets that need to check if they have same value. All value on column B6 until last row should be same in Sheets MM, PP and CO. If there's difference value, the different value should be on highlight (the color is red).</p>\n\n<p>But, my syntax didn't run. The syntax just can read if there's an empty column in range. This is my syntax.. <strong>Not including highlight.</strong> First, i tried to place the difference value to the other sheets. But, failed. Thank you.</p>\n\n<pre><code>Sub MatchValue()\n\nDim x As Integer\nDim y As Integer\nDim z As Integer\n\nLastRowB = Cells(Rows.Count, \"B\").End(xlUp).Row\n\nx = ActiveWorkbook.Worksheets(\"MM\").Range(\"B6:B\" &amp; LastRowB).Cells.SpecialCells(xlCellTypeConstants).Count\ny = ActiveWorkbook.Worksheets(\"PP\").Range(\"B6:B\" &amp; LastRowB).Cells.SpecialCells(xlCellTypeConstants).Count\nz = ActiveWorkbook.Worksheets(\"CO\").Range(\"B6:B\" &amp; LastRowB).Cells.SpecialCells(xlCellTypeConstants).Count\n\nIf x &lt;&gt; y Then\nMsgBox \"MM &lt;&gt; PP\", vbCritical, \"Error Report\"\nEnd If\nIf y &lt;&gt; z Then\nMsgBox \"PP &lt;&gt; CO\", vbCritical, \"Error Report\"\nEnd If\nIf z &lt;&gt; x Then\nMsgBox \"CO &lt;&gt; MM\", vbCritical, \"Error Report\"\nEnd If\n\nSheetMM = \"MM\"\nDataColumnMM = \"B6\"\nSheetPP = \"PP\"\nDataColumnPP = \"B6\"\nSheetCO = \"CO\"\nDataColumnCO = \"B6\"\nSheetUnmatched = \"Data Unmatched\"\nDataColumnUnmatched = \"A1\"\n\nDataRowMM = Range(DataColumnMM).Row\nDataColMM = Range(DataColumnMM).Column\nDataRowPP = Range(DataColumnPP).Row\nDataColPP = Range(DataColumnPP).Column\nDataRowCo = Range(DataColumnCO).Row\nDataColCo = Range(DataColumnCO).Column\nDataRowUnmatched = Range(DataColumnUnmatched).Row\nDataColUnmatched = Range(DataColumnUnmatched).Column\n\n\nLastDataMM = Sheets(SheetMM).Cells(Rows.Count, DataColMM).End(xlUp).Row\nLastDataPP = Sheets(SheetPP).Cells(Rows.Count, DataColPP).End(xlUp).Row\nLastDataCO = Sheets(SheetCO).Cells(Rows.Count, DataColCo).End(xlUp).Row\nLastDataUnmathced = Sheets(SheetUnmatched).Cells(Rows.Count, DataColUnmatched).End(xlUp).Row\n\n    For counter = DataRowMM To LastDataRowMM\n        If WorksheetFunction.CountIf(LastDataPP, counter) = 0 Then\n            LastDataUnmathced.Offset(1) = counter\n        End If\n    Next\n    For counter = DataRowMM To LastDataRowMM\n        If WorksheetFunction.CountIf(LastDataCO, counter) = 0 Then\n            LastDataUnmathced.Offset(1) = counter\n        End If\n    Next\n        For counter = DataRowPP To LastDataRowPP\n        If WorksheetFunction.CountIf(LastDataCO, counter) = 0 Then\n            LastDataUnmathced.Offset(1) = counter\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1573625658, "post_id": 58831251, "comment_id": 103938014, "body": "This is not error proof, some error catching needs to be done, i.e. when &#39;Dataset Here&#39; has not been found etc."}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": false, "score": 0, "last_activity_date": 1573625450, "creation_date": 1573625450, "answer_id": 58831251, "question_id": 58830882, "link": "https://stackoverflow.com/questions/58830882/copy-pasting-range-of-cells-with-dynamic-start-point/58831251#58831251", "title": "Copy Pasting Range of Cells with Dynamic Start Point", "body": "<p>Hello Crystal and Welcome.</p>\n\n<p>You could do something like the below. This works with the assumption that all your cells and columns below the 'Dataset Here' are populated (otherwise the copy range might not be correctly defined). The following example copies cells A6:B9 to cell F1</p>\n\n<p><a href=\"https://i.stack.imgur.com/lewvl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lewvl.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nPublic Sub sCopyCells()\n\n  Call sCopyCellsForWorksheet(Worksheets(\"Sheet1\"))\n\nEnd Sub\n\nPrivate Sub sCopyCellsForWorksheet(ByRef ws As Worksheet)\n\n  Dim target As Range, source As Range, destination As Range\n\n  Set target = ws.Range(\"A:A\").Find(\"Dataset Here\")\n  Set source = Range(target.Offset(1, 0), target.End(xlDown).End(xlToRight))\n  Set destination = ws.Range(\"F1\")\n\n  source.Copy\n  destination.PasteSpecial xlPasteAll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12364752, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCPCv8S0fG1qzmv-5U97-FEDAaZvgqi3dbgaOyG1A=k-s128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/12364752/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573625450, "creation_date": 1573623261, "last_edit_date": 1573623311, "question_id": 58830882, "link": "https://stackoverflow.com/questions/58830882/copy-pasting-range-of-cells-with-dynamic-start-point", "title": "Copy Pasting Range of Cells with Dynamic Start Point", "body": "<p>I'm having trouble copy pasting a range of cells based on a dynamic start point (the start point is 1 cell beneath a cell with a specified value).  </p>\n\n<p>This specific range of cells will always be in columns A-Z, but the row is dynamic across worksheets. However, this range of cells is always preceded by a row above with a specific cell value, let's say \"Dataset Here\". </p>\n\n<p>So in an example sheet, I need to copy A650:Z700, and the cell \"Dataset Here\" is in A649. </p>\n\n<p>How can I copy a range based on the requirement that the range falls underneath the cell with the value \"Dataset Here\"? </p>\n\n<p>I was able to identify the starting row, but am lost how to turn it into a dynamic version of Range(\"A650:Z700\").Copy: </p>\n\n<pre><code>Dim StartRow As Long\n    StartRow = Range(\"A:BA\").Find(\"Dataset Here\").Row + 1\n</code></pre>\n"}, {"tags": ["vba", "checkbox", "ms-word", "onclick"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1573635998, "post_id": 58830662, "comment_id": 103942385, "body": "Hi. Shouldnt be  ActiveDocument.Bookmarks(&quot;approve&quot;).Range.Font.Hidden=true ?"}, {"owner": {"reputation": 47, "user_id": 7857064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c83f8078257021ff2fa1b62d6c813a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordy Stewart", "link": "https://stackoverflow.com/users/7857064/jordy-stewart"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1573689922, "post_id": 58830662, "comment_id": 103968457, "body": "I&#39;ve added that and it still does&#39;t help"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 0, "creation_date": 1573725042, "post_id": 58830662, "comment_id": 103979660, "body": "FWIW f you want to show/hide the text, using ActiveDocument.Bookmarks(&quot;approve&quot;).Range.Font.Hidden = checkbox1.Value (or Not checkbox1.Value, as appropriate) should work. It works here, assuming that your checkbox1 is an ActiveX control in the document surface. Is the event code definitely running (e.g. you could put Msgbox &quot;We&#39;re in!&quot; in there to check). Your nearby question was about doing much the same thing with content controls. If you have the choice - I would stick to CCs and avoid using ActiveX controls in the document."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573753379, "post_id": 58830662, "comment_id": 103996439, "body": "Jordy, could you please use the <a href=\"https://stackoverflow.com/posts/58830662/edit\">edit</a> link to update your question with the current code. Then: 1) What does &quot;it doesn&#39;t seem to be working&quot; mean? Nothing is getting hidden? Is there an error? 2) If you go to the Insert/Bookmarks dialog box, select the bookmark name and click &quot;Go to&quot; does it <i>select text</i> or does the cursor just &quot;blink&quot;?"}], "owner": {"reputation": 47, "user_id": 7857064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c83f8078257021ff2fa1b62d6c813a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordy Stewart", "link": "https://stackoverflow.com/users/7857064/jordy-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573623592, "creation_date": 1573621742, "last_edit_date": 1573623592, "question_id": 58830662, "link": "https://stackoverflow.com/questions/58830662/how-to-hide-text-when-checkbox-is-clicked", "title": "How to hide text when checkbox is clicked", "body": "<p>I've created a checkbox and a small section of text bookmarked as approve to attempt to hide when a checkbox is clicked, but it doesn't seem to be working. I feel that I mus be over-simplifying it for it not to be working, so am I missing anything (still very new to VBA). Here's what I've got:</p>\n\n<pre><code>Private Sub checkbox1_Click()\n ActiveDocument.Bookmarks(\"approve\").Range.Font.Hidden\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573620119, "post_id": 58829806, "comment_id": 103936595, "body": "&quot;Department&quot; is both a Column field and a Page field ?"}, {"owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573621149, "post_id": 58829806, "comment_id": 103936831, "body": "I wanted to filter both by fiscal year and department in the tables and chart after auto generation"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573621355, "post_id": 58829806, "comment_id": 103936874, "body": "You can&#39;t manually add the same field to both &quot;Columns&quot; and &quot;Filters&quot; in a pivot table, so maybe that&#39;s a limitation here?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573625088, "post_id": 58829806, "comment_id": 103937844, "body": "If I add a Field to &quot;Columns&quot; and then drag it (from the fields list) to &quot;Filters&quot;, it disappears from &quot;Columns&quot; and appears in &quot;Filters&quot;"}, {"owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573626166, "post_id": 58829806, "comment_id": 103938174, "body": "Ah ok ,i see,thanks for clarifying ,i guess my memory is from selecting the chart generation from the excel ribbon than vba macro creation"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1573625660, "creation_date": 1573625660, "answer_id": 58831285, "question_id": 58829806, "link": "https://stackoverflow.com/questions/58829806/addfield-method-of-pivottable-class-failed-on-macro/58831285#58831285", "title": "AddField Method of PivotTable Class failed on macro", "body": "<p>You cannot add the same field (\"Department\") to both <code>ColumnFields</code> and <code>PageFields</code>. </p>\n"}], "owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573625660, "creation_date": 1573615026, "last_edit_date": 1592644375, "question_id": 58829806, "link": "https://stackoverflow.com/questions/58829806/addfield-method-of-pivottable-class-failed-on-macro", "title": "AddField Method of PivotTable Class failed on macro", "body": "<p>I'm trying to develop a macro for automated process of creating a PivotChart based on an access table exported into excel format. However everytime when i attempt to insert two page fields into the PivotTable from the macro,i always get this error:</p>\n<blockquote>\n<p>Run-Time error '1004'</p>\n<p>AddFields Method Of PivotTable class failed</p>\n</blockquote>\n<p>And the line it always shows to be the cause is this line of code</p>\n<pre><code>pt.AddFields RowFields:=&quot;RecordMonth&quot;, ColumnFields:=&quot;Department&quot;, PageFields:=Array(&quot;FiscalYear&quot;, &quot;Department&quot;)\n\n</code></pre>\n<p>For reference,this is my code for the pivottable generation macro</p>\n<pre><code>Option Explicit\n\nSub CreatePivotTable()\n\nDim pc As PivotCache\nDim ws As Worksheet\nDim pt As PivotTable\n\n\n\nSet pc = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=Sheet1.Name &amp; &quot;!&quot; &amp; Sheet1.Range(&quot;A1&quot;).CurrentRegion.Address, Version:=xlPivotTableVersion15)\n\nSet ws = Worksheets.Add\nws.Name = &quot;MonthlyCalcTableTest&quot;\nRange(&quot;A3&quot;).Select\n\nSet pt = pc.CreatePivotTable(TableDestination:=ActiveCell, TableName:=&quot;AutoGenTest&quot;)\n\npt.AddFields RowFields:=&quot;RecordMonth&quot;, ColumnFields:=&quot;Department&quot;, PageFields:=Array(&quot;FiscalYear&quot;, &quot;Department&quot;)\n\n\npt.AddDataField pt.PivotFields(&quot;MonthlyDepartmentBudget&quot;), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(&quot;ConfirmedValue&quot;), Function:=XlConsolidationFunction.xlSum\n\n\npt.DataFields(1).NumberFormat = &quot;#,##0&quot;\n\n\nEnd Sub\n\n</code></pre>\n<p>And these are the table column names in excel:</p>\n<blockquote>\n<p>ID, Department, MonthlyDepartmentBudget, FiscalYear, RecordMonth, Confirmation, AttachmentConfirmation, ConfirmedValue</p>\n</blockquote>\n<p>AttachmentConfirmation is an attachment datatype and confirmation is true/false datatype</p>\n<p>I would like to have some insight of why i was getting this error</p>\n"}, {"tags": ["vba", "ms-word", "onclick"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 2348440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jyW5v.png?s=128&g=1", "display_name": "Aaron Rykhus", "link": "https://stackoverflow.com/users/2348440/aaron-rykhus"}, "is_accepted": true, "score": 1, "last_activity_date": 1573620368, "last_edit_date": 1573620368, "creation_date": 1573619246, "answer_id": 58830341, "question_id": 58829795, "link": "https://stackoverflow.com/questions/58829795/is-there-an-onclick-function-for-contentcontrol/58830341#58830341", "title": "Is there an OnClick function for ContentControl", "body": "<p>ContentControlOnEnter, just select Document on the drop down of the VBA editor right above the code window, and then select ContentControlOnEnter, and copy the code from ContentControlOnExit into ContentControlOnEnter</p>\n\n<p><a href=\"https://i.stack.imgur.com/CLN4A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CLN4A.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "is_accepted": false, "score": 0, "last_activity_date": 1573661115, "creation_date": 1573661115, "answer_id": 58841073, "question_id": 58829795, "link": "https://stackoverflow.com/questions/58829795/is-there-an-onclick-function-for-contentcontrol/58841073#58841073", "title": "Is there an OnClick function for ContentControl", "body": "<p>There isn't an OnClick event for content controls. </p>\n\n<p>Using the OnEnter and OnExit events only really works when you actually click on the control after clicking elsewhere, click elsewhere after clicking on the control, or tab in or out of the control. If you hover over the control and click more than once, none of those fire. </p>\n\n<p>If you map your content control to an element in a CustomXMLPart, then you get some more options. At first sight it looks as if you can use the ContentControlBeforeStoreUpdate event (clicking on a checkbox will result in an immediate update of the mapped element's value). But that doesn't actually work in this case because Word does not let you access the parts of the object model you need when executing that event. (There is in fact a way to work around this problem using a Timer and other things but I can only give a link to that, and AIUI that's discouraged here).</p>\n\n<p>You can use the CustomXmlPart's events instead.</p>\n\n<p>Based on your code, the following code (re)creates a suitable CustomXmlPart (CXP) and connects the checkboxes to it. You should only need to run it once.</p>\n\n<pre><code>Sub recreateCXPandMapCCs()\n' Specify a namespace for your CXP\nConst myns As String = \"checkboxevents\"\nDim ccs As Word.ContentControls\nDim cxp As Office.CustomXMLPart\nDim cxps As Office.CustomXMLParts\nDim i As Integer\nDim r As Word.Range\nDim s As String\ns = \"\"\ns = s &amp; \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" &amp; vbCrLf\ns = s &amp; \"&lt;checkboxvalues xmlns='\" &amp; myns &amp; \"'&gt;\" &amp; vbCrLf\ns = s &amp; \"  &lt;checkbox1value/&gt;\" &amp; vbCrLf\ns = s &amp; \"  &lt;checkbox2value/&gt;\" &amp; vbCrLf\ns = s &amp; \"  &lt;checkbox3value/&gt;\" &amp; vbCrLf\ns = s &amp; \"  &lt;checkbox4value/&gt;\" &amp; vbCrLf\ns = s &amp; \"  &lt;checkbox5value/&gt;\" &amp; vbCrLf\ns = s &amp; \"&lt;/checkboxvalues&gt;\"\n\nWith ActiveDocument\n  ' select and delete any existing CXPs with the specified namespace\n  Set cxps = .CustomXMLParts.SelectByNamespace(myns)\n  For Each cxp In cxps\n    cxp.Delete\n  Next\n  Set cxps = Nothing\n  ' Create a new CXP\n  Set cxp = .CustomXMLParts.Add(s)\n  ' Connect your checkboxes. There are various ways you could do this,\n  ' but here we're relying on a consistent naming convention.\n  ' and the knowledge that Word will assign the prefix name \"ns0\" to\n  ' our namespace\n  For i = 1 To 5\n    .SelectContentControlsByTitle(\"Checkbox\" &amp; CStr(i)).Item(1).XMLMapping.SetMapping \"//ns0:checkbox\" &amp; CStr(i) &amp; \"value[1]\", , cxp\n  Next\n  Set cxp = Nothing\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, unlike handling Content Control events, where you can just put the event handlers in the ThisDocument module and Word fires them, to set up Word to fire these events you have to run some code when the document is created or opened, and preferably run some code when the document is closed. In this example, you can put the following code in your ThisDocument module, and manually run the linkupCxpEvents and unlinkCxpEvents procedures to start and stop event processing. </p>\n\n<pre><code>Option Explicit\n' This needs to have the same namespace name as you\n' use to create the CXP\nConst myns As String = \"checkboxevents\"\n\nDim WithEvents cxp As CustomXMLPart\n\n' You might call this sub from an AutoOpen macro, Document.Open event etc.\nSub linkupCxpEvents()\nSet cxp = ActiveDocument.CustomXMLParts.SelectByNamespace(myns).Item(1)\nEnd Sub\n\nSub unlinkCxpEvents()\nSet cxp = Nothing\nEnd Sub\n\n' Notice that we don't actually need to know the checkbox Titles or Tags,\n' just the names of the elements they are connected to in the data store\nPrivate Sub cxp_NodeAfterReplace(ByVal OldNode As Office.CustomXMLNode, ByVal NewNode     As Office.CustomXMLNode, ByVal InUndoRedo As Boolean)\nSelect Case NewNode.ParentNode.BaseName\n  Case \"checkbox1value\"\n    ActiveDocument.Bookmarks(\"approve\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n  Case \"checkbox2value\"\n    ActiveDocument.Bookmarks(\"sign1\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n    ActiveDocument.Bookmarks(\"sign2\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n  Case \"checkbox3value\"\n    ActiveDocument.Bookmarks(\"note\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n  Case \"checkbox4value\"\n    ActiveDocument.Bookmarks(\"AP2\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n  Case \"checkbox5value\"\n    ActiveDocument.Bookmarks(\"Bookmark2\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n    ActiveDocument.Bookmarks(\"AP1\").Range.Font.Hidden = CBool(NewNode.NodeValue)\n  Case Else\nEnd Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7857064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c83f8078257021ff2fa1b62d6c813a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordy Stewart", "link": "https://stackoverflow.com/users/7857064/jordy-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 58830341, "answer_count": 2, "score": 0, "last_activity_date": 1573661115, "creation_date": 1573614933, "last_edit_date": 1573620351, "question_id": 58829795, "link": "https://stackoverflow.com/questions/58829795/is-there-an-onclick-function-for-contentcontrol", "title": "Is there an OnClick function for ContentControl", "body": "<p>I'm incredibly new to Visual Basic, but have been tasked with trying to adjust a function from an old word document so that it is more responsive.</p>\n\n<p>Essentially, the document has a series of checkboxes that when clicked, hide or display various elements of the document using content controls. Currently, a user has to check a checkbox, and then click out of the checked checkbox for the hide/display to happen, but ideally, I wanted this to be instantaneous with the initial click/check.</p>\n\n<p>I'm just wanting to know i there's some kind of OnClick or something I can substitute ContentControlOnExit so that it is more responsive.</p>\n\n<pre><code>Sub Document_ContentControlOnExit(ByVal ContentControl As ContentControl, Cancel As Boolean)\n\n    If ContentControl.Title = \"checkbox4\" Then\n        ActiveDocument.Bookmarks(\"AP2\").Range.Font.Hidden = ContentControl.Checked\n    End If\n\n    If ContentControl.Title = \"checkbox5\" Then\n        ActiveDocument.Bookmarks(\"Bookmark2\").Range.Font.Hidden = ContentControl.Checked\n        ActiveDocument.Bookmarks(\"AP1\").Range.Font.Hidden = ContentControl.Checked\n    End If\n\n    If ContentControl.Title = \"checkbox1\" Then\n        ActiveDocument.Bookmarks(\"approve\").Range.Font.Hidden = ContentControl.Checked\n    End If\n\n    If ContentControl.Title = \"checkbox2\" Then\n        ActiveDocument.Bookmarks(\"sign1\").Range.Font.Hidden = ContentControl.Checked\n        ActiveDocument.Bookmarks(\"sign2\").Range.Font.Hidden = ContentControl.Checked\n    End If\n\n    If ContentControl.Title = \"checkbox3\" Then\n        ActiveDocument.Bookmarks(\"note\").Range.Font.Hidden = ContentControl.Checked\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Hope this wasn't too vague or unclear, and thanks for any pointers or help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1573610197, "post_id": 58829181, "comment_id": 103934593, "body": "Your code worked fine for me after fixing two things: declaring <code>Dim i As Long</code> and setting <code>rw = sh2.Cells(sh2.Cells.Rows.Count, &quot;C&quot;).End(xlUp).Offset(1, 0).Row</code>. Notice the <code>sh2.Cells.Rows.Count</code> value for the rows and it references the worksheet <code>sh2</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573611180, "post_id": 58829181, "comment_id": 103934818, "body": "Note: add <code>Option Explicit</code> to the top of the module."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573620281, "post_id": 58829181, "comment_id": 103936625, "body": "FYI - &quot;not working&quot; is not a very useful description of what happens when you run your code.  Do you get an error, or maybe your code does something unexpected?  Always helps to say what the actual problem is."}, {"owner": {"reputation": 1, "user_id": 12364133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38f92390e07f3f997e0232c40c4c584?s=128&d=identicon&r=PG&f=1", "display_name": "lynxmarks", "link": "https://stackoverflow.com/users/12364133/lynxmarks"}, "edited": false, "score": 0, "creation_date": 1573667409, "post_id": 58829181, "comment_id": 103959579, "body": "After doing that, I&#39;m having a different problem- previously it wasn&#39;t running at all, now it&#39;s telling me that the rw variable is not defined"}, {"owner": {"reputation": 1, "user_id": 12364133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38f92390e07f3f997e0232c40c4c584?s=128&d=identicon&r=PG&f=1", "display_name": "lynxmarks", "link": "https://stackoverflow.com/users/12364133/lynxmarks"}, "edited": false, "score": 0, "creation_date": 1573667453, "post_id": 58829181, "comment_id": 103959601, "body": "If I remove &quot;Option Explicit&quot;, I get the error &quot;400&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1581434002, "creation_date": 1581434002, "answer_id": 60172020, "question_id": 58829181, "link": "https://stackoverflow.com/questions/58829181/save-values-from-one-sheet-to-another/60172020#60172020", "title": "Save values from one sheet to another", "body": "<p>I replaced some piece of code as follows:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim r1 As Range, r2 As Range\n    Dim v1 As Variant, v2 As Variant\n    Dim i, rw, Rows_Count As Integer 'you forgot some variables\n\n    Rows_Count = 0 'This, obviously, is just an example. I have no idea what the value should be.\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12364133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38f92390e07f3f997e0232c40c4c584?s=128&d=identicon&r=PG&f=1", "display_name": "lynxmarks", "link": "https://stackoverflow.com/users/12364133/lynxmarks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581434002, "creation_date": 1573609616, "last_edit_date": 1581433609, "question_id": 58829181, "link": "https://stackoverflow.com/questions/58829181/save-values-from-one-sheet-to-another", "title": "Save values from one sheet to another", "body": "<p>I made similar code in other workbooks without trouble.</p>\n\n<p>I get the error \"400\".</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim r1 As Range, r2 As Range\n    Dim v1 As Variant, v2 As Variant\n\n    Set sh1 = Worksheets(\"Tool\")\n    Set sh2 = Worksheets(\"SaveFile\")\n\n    v1 = Array(\"D3\", \"D4\", \"D5\", \"D6\", \"D7\", \"D8\", \"D9\", \"D10\", \"D11\", \"D12\", \"D13\", \"H4\", \"H5\", \"H8\", \"H9\", \"H10\", \"H11\", \"H12\", \"H13\", \"E17\")\n    v2 = Array(\"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\")\n    rw = sh2.Cells(Rows_Count, \"C\").End(xlUp).Offset(1, 0).Row\n\n    For i = LBound(v1) To UBound(v1)\n        Set r1 = sh1.Range(v1(i))\n        Set r2 = sh2.Cells(rw, v2(i))\n        r2.Value = r1.Value\n    Next i\nEnd Sub\n</code></pre>\n\n<p>With <code>Option Explicit</code> I get rw variable is not defined.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573607267, "post_id": 58828804, "comment_id": 103933929, "body": "There is a &quot;possible code&quot; which you first try to write, and <i>then</i> we try to help.  You might also want to review your previous questions and consider accepting any answers which helped you."}], "answers": [{"tags": [], "owner": {"reputation": 206, "user_id": 11725556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c1ca11a711222bac6b21d4c68c3e13?s=128&d=identicon&r=PG&f=1", "display_name": "Javiers", "link": "https://stackoverflow.com/users/11725556/javiers"}, "is_accepted": false, "score": 0, "last_activity_date": 1573612160, "last_edit_date": 1573612160, "creation_date": 1573609877, "answer_id": 58829211, "question_id": 58828804, "link": "https://stackoverflow.com/questions/58828804/how-do-i-hide-rows-with-duplicates-between-two-excel-files-workbooks/58829211#58829211", "title": "How do I hide rows with duplicates between two excel files/workbooks?", "body": "<p>Excel has a tool to consolidate different list, sheets or workbooks. From a 3rd workbook go to the \"DATA\" tab, and click on the \"consolidate\" button as shown on the Fig. 1. Then, click on the \"Browse\" button, select the first workbook and click \"add\" button. Then repeat the same with the second workbook.Finally clik on the 3 check boxes and press ok. Please find below a link to an explanation of the consolidate funtion. If the funtion does not reads from the workbooks, you can try copying the two sheets you want to compare in one worbook</p>\n\n<p><a href=\"https://i.stack.imgur.com/eh4Zy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eh4Zy.png\" alt=\"Fig.1\"></a></p>\n\n<p>Example: <a href=\"https://www.youtube.com/watch?v=Lk7HPyOHr0E\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=Lk7HPyOHr0E</a></p>\n"}], "owner": {"reputation": 29, "user_id": 6457966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16670f30413e72304a522c3ffeff063?s=128&d=identicon&r=PG&f=1", "display_name": "Cutie Pie", "link": "https://stackoverflow.com/users/6457966/cutie-pie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573612160, "creation_date": 1573606306, "last_edit_date": 1573610303, "question_id": 58828804, "link": "https://stackoverflow.com/questions/58828804/how-do-i-hide-rows-with-duplicates-between-two-excel-files-workbooks", "title": "How do I hide rows with duplicates between two excel files/workbooks?", "body": "<p>I need help automating a daily task at work since I'm not a programmer. In short, I work with excel files and I am required to compare data between two workbooks for any duplicate values in any given columns (could be same or different columns) from both of the workbooks and hide the rows with the duplicate values in any one of those given workbooks. Since these workbooks are all different every time, is there a possible code that will allow me to hide the row with the duplicate values as needed on any workbook instead of me having to go through each row in every single workbook manually?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1573610806, "post_id": 58828665, "comment_id": 103934731, "body": "What&#39;s the difference between the two images?? Both are too much to look at and at the same time don&#39;t show which column you want to sum."}, {"owner": {"reputation": 1, "user_id": 12363866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4a0fe70aab9ec94f8ec7145e6575c4?s=128&d=identicon&r=PG&f=1", "display_name": "Yachrishere", "link": "https://stackoverflow.com/users/12363866/yachrishere"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1573618232, "post_id": 58828665, "comment_id": 103936204, "body": "The image was doubled up, sorry. The column that I was trying to sum has the heading &#39;Quantity&#39;, there are some hidden columns which makes this column &quot;I&quot; on the work sheet."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12363866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4a0fe70aab9ec94f8ec7145e6575c4?s=128&d=identicon&r=PG&f=1", "display_name": "Yachrishere", "link": "https://stackoverflow.com/users/12363866/yachrishere"}, "is_accepted": false, "score": 0, "last_activity_date": 1573672717, "creation_date": 1573672717, "answer_id": 58844097, "question_id": 58828665, "link": "https://stackoverflow.com/questions/58828665/sum-dynamic-ranges-based-on-numbers-in-a-helper-column/58844097#58844097", "title": "Sum dynamic ranges based on numbers in a helper column", "body": "<p>I have managed to find the answer with some others help.\nWould like to share it here for anyone else who looks up a similar question.</p>\n\n<pre><code>Sub Sumtask()\n           Dim Rf As Range, Rg As Range, A$\n    With ActiveSheet.UsedRange.Columns(1)\n           Set Rf = .Find(4, , xlValues, xlWhole)\n        If Not Rf Is Nothing Then\n                   A = Rf.Address\n                   Application.ScreenUpdating = False\n            Do\n                   Set Rg = .Find(7, Rf):  If Rg.Row &lt; Rf.Row Then Exit Do\n                    If Rg.Row &gt; Rf.Row + 1 Then Rg(1, 9).Value2 = Application.Sum(Range(Rf(2, 9), Rg(0, 9)))\n                   Set Rf = .Find(4, Rg)\n            Loop Until Rf.Address = A\n                   Set Rf = Nothing:   Set Rg = Nothing\n                   Application.ScreenUpdating = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>This seems a better way by using the Address syntax</p>\n"}], "owner": {"reputation": 1, "user_id": 12363866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4a0fe70aab9ec94f8ec7145e6575c4?s=128&d=identicon&r=PG&f=1", "display_name": "Yachrishere", "link": "https://stackoverflow.com/users/12363866/yachrishere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573672717, "creation_date": 1573604882, "last_edit_date": 1573629107, "question_id": 58828665, "link": "https://stackoverflow.com/questions/58828665/sum-dynamic-ranges-based-on-numbers-in-a-helper-column", "title": "Sum dynamic ranges based on numbers in a helper column", "body": "<p>I have a sheet with a list of numbers I want to sum.</p>\n\n<p>There are varying ranges after I have imported the data and am struggling to find the ranges and insert the totals(sum) of each category.</p>\n\n<p>There is a Helper column in column \"A\" which has the number 4 where the category starts and the number 7 where it ends.</p>\n\n<p>I want to sum the numbers in column \"I\" for rows between 4 (where 4 appears in column \"A\") and 7 (where 7 appears in column \"A\") and place the total in column \"I\" in the row that 7 appears in column \"A\".</p>\n\n<p>Here is the code I have so far.</p>\n\n<pre><code>    Sub Sumtask()\nDim s As Long, p1 As Range, p2 As Range, p4 As Range, p7 As Range\n\nFor s = 10 To 500\n     Set p1 = Range(\"A\" &amp; s)\n     Set p2 = Range(\"I\" &amp; s)\n     Set p4 = Range(\"I\" &amp; s)\n     Set p7 = Range(\"I\" &amp; s)\n     If p1.Value = 4 Then p4 = Range(\"I\" &amp; s)\n     If p1.Value = 7 Then p7 = Range(\"I\" &amp; s)\n     p2.Offset(9, -1).Value = Application.Sum(Range(p4.Offset(, -1), p7.Offset(, -1)))\nNext s\nEnd Sub\n</code></pre>\n\n<p>I also have </p>\n\n<p><img src=\"https://i.stack.imgur.com/Y5uUF.png\" alt=\"image of worksheet\"></p>\n\n<p>Any help would be helpful as I have been searching for the right syntax for some time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1577832186, "post_id": 58828648, "comment_id": 105266904, "body": "Comment or note?"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1577832259, "post_id": 58828648, "comment_id": 105266921, "body": "Sorry, technically note."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1577836680, "post_id": 58828648, "comment_id": 105267521, "body": "You can use <code>Application.DisplayCommentIndicator = xlNoIndicator</code> to prevent the mouse over effect.  Whether this affects your code, will depend on your code..."}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577832343, "creation_date": 1573604738, "last_edit_date": 1577832343, "question_id": 58828648, "link": "https://stackoverflow.com/questions/58828648/how-to-disable-mouseover-for-a-note-in-excel", "title": "How to disable mouseover for a note in Excel?", "body": "<p>I have a spreadsheet in excel with some vba code that makes a note show up when I navigate the cursor to the cell and turn off when I navigate the cursor away.</p>\n\n<p>However, the note still shows up when the mouse is hovering over the cell, which I want to prevent.</p>\n\n<p>Is there a way to disable this mouseover functionality without disabling the note feature entirely?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 1665282, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5ca18e1c0479cb7bda96d44d891876b5?s=128&d=identicon&r=PG", "display_name": "Lift", "link": "https://stackoverflow.com/users/1665282/lift"}, "is_accepted": false, "score": 0, "last_activity_date": 1573604922, "creation_date": 1573604922, "answer_id": 58828670, "question_id": 58828624, "link": "https://stackoverflow.com/questions/58828624/ms-access-only-showing-one-result/58828670#58828670", "title": "MS Access only showing one result", "body": "<p>Always the way - post on here and finally work it out.</p>\n\n<p>The answer was to change it to a continuous form if anyone else ever has this issue!</p>\n"}], "owner": {"reputation": 514, "user_id": 1665282, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5ca18e1c0479cb7bda96d44d891876b5?s=128&d=identicon&r=PG", "display_name": "Lift", "link": "https://stackoverflow.com/users/1665282/lift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594349320, "creation_date": 1573604579, "last_edit_date": 1594349320, "question_id": 58828624, "link": "https://stackoverflow.com/questions/58828624/ms-access-only-showing-one-result", "title": "MS Access only showing one result", "body": "<p>I'm working on a MS Access application but have encountered an issue.\nI've tried searching around, however, haven't had any luck so I've come here!</p>\n\n<p>I created a multiple items form and have a search button which activates the query it's linked to. This all works fine and all the right information is returned, however, only one record displays at a time.</p>\n\n<p>Say there are 5 results I have to use the record selector to scroll through them each individually despite there being heaps of room left on the form.</p>\n\n<p>None of my other multiple item forms do this.</p>\n\n<p>Any help is appreciated. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573641079, "post_id": 58828111, "comment_id": 103945077, "body": "I&#39;m not certain I understand correctly, so to clarify: You have tables that contain content that is numbered? And you want to continue the numbering in text outside the table? Have you considered creating a specific paragraph style to link with a custom list style so that all you&#39;d need to do is apply the paragraph style? That would be simplest and most robust."}, {"owner": {"reputation": 27, "user_id": 9131829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68be4a8c96b33b73cb50cbecd53a674b?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9131829/jordan"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573654256, "post_id": 58828111, "comment_id": 103952171, "body": "A system we export written data from has an odd syntax. We have a numbered list and in the middle of the list is a table. The table doesn&#39;t have any numbering. After the table the list will either continue or stop. After export we sometimes need to add to the numbered list after the table and that is what I am trying to build a macro to do. Clear as mud?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573666803, "post_id": 58828111, "comment_id": 103959280, "body": "Clearer :-) And my suggestion about using dedicated, linked list and paragraph styles?"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1573733310, "post_id": 58828111, "comment_id": 103984414, "body": "Is the numbering part of the exported data? If so the numbers will just be plain text and there will not be a numbered list to continue."}], "owner": {"reputation": 27, "user_id": 9131829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68be4a8c96b33b73cb50cbecd53a674b?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9131829/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573600733, "creation_date": 1573600733, "question_id": 58828111, "link": "https://stackoverflow.com/questions/58828111/vba-to-continue-a-numbered-list", "title": "VBA to continue a numbered list", "body": "<p>I export Word documents that contain tables in a numbered lists. I cannot control the export. I am trying to create a formatting macro that, starting from the last character in the table, exits the table but continues the numbering of the list above it. I tried to record it but it codes the start number and I just want it to continue from the number before the table. When I was recording I would put the cursor at the end of the last character in the table, press down, select my normal style and then click on the numbered list button. </p>\n\n<p>Here is what I have tried:</p>\n\n<pre><code>Sub PITA()\nSelection.MoveDown Unit:=wdLine, Count:=1\nSelection.Style = ActiveDocument.Styles(\"Normal\")\nListGalleries(wdOutlineNumberGallery).ListTemplates(7).Name = \"\"\nSelection.range.ListFormat.ApplyListTemplateWithLevel1 ListTemplate:= _\n    ListGalleries(wdOutlineNumberGallery).ListTemplates(7), _\n    ContinuePreviousList:=True, ApplyTo:=wdListApplyToWholeList, _\n    DefaultListBehavior:=Word10ListBehavior\nEnd Sub\n</code></pre>\n\n<p>It is very frustrating because I see the ContinuePreviousList is set to true. I didn't copy over the recorded version of the macro because it has excess amount of unneeded formatting. </p>\n"}, {"tags": ["json", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1573603173, "creation_date": 1573603173, "answer_id": 58828451, "question_id": 58828016, "link": "https://stackoverflow.com/questions/58828016/vba-jsonconverter-adding-additional-quotes/58828451#58828451", "title": "VBA JsonConverter adding additional quotes", "body": "<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/yxw69s8t(v=vs.90)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/yxw69s8t(v=vs.90)?redirectedfrom=MSDN</a></p>\n\n<blockquote>\n  <p>Unlike the Print function, the Write function inserts commas between\n  items and quotation marks around strings as they are written to the\n  file.</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 11319244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c70fd3f80728e29d4fd360d4e09cefe?s=128&d=identicon&r=PG&f=1", "display_name": "justart5", "link": "https://stackoverflow.com/users/11319244/justart5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 58828451, "answer_count": 1, "score": 1, "last_activity_date": 1573603173, "creation_date": 1573600088, "question_id": 58828016, "link": "https://stackoverflow.com/questions/58828016/vba-jsonconverter-adding-additional-quotes", "title": "VBA JsonConverter adding additional quotes", "body": "<p>I am currently attempting to parse JSON using the VBA module add in found <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">here</a>. I currently have JSON files stored as text documents locally, so I call them into VBA, make the necessary changes, and then send them back to a new file. For reasons I cannot figure out, it seems that the code is adding quotation marks at the beginning and end (because it is a string) and also adding quotes to every key/value pair. The later is a show-stopper for what I am trying to do (these are large Json Files). The Solution I have currently is to print them into a cell, and then re copy/paste the JSON into a text file, and even that is not very straightforward. Is there a solution to this problem that is better than what I am trying?</p>\n\n<pre><code>Dim Json As Object\n\nFilePath = \"Path to file.txt\"\nOpen FilePath For Input As #1\n    Data = Input$(LOF(1), #1)\nClose #1\nSet Json = JsonConverter.ParseJson(Data)\nJson(\"key 1\")(\"key 2\") = \"value\"\n\noutputfile =\"path to file.txt\"\n    Write #1, JsonConverter.ConvertToJson(Json, Whitespace:=2)\nClose #1\nOpen outputfile For Input As #1\n    NewData = Input$(LOF(1), #1)\nClose #1\nNewData = Replace(NewData, \"\"\"\", \"!\")  \nNewData = Replace(NewData, \"!!\", \"\"\"\") \nNewData = Replace(NewData, \"!\", \"\")   \nm1.Cells(x,y) = NewData\n</code></pre>\n\n<p>So If you look at the input JSON vs the outputfile JSON, the key is successfully edited, but it looks like this</p>\n\n<pre><code>input file\n{\"key1\":{\"key2\":\"Blank\"}} \n\noutputfile\n\"{\"\"key1\"\":{\"\"key2\"\":\"\"value\"\"}}\"\n</code></pre>\n\n<p>The files are much to large to post here, so removing the extra quotes from the keys and values, and the outside is a bear, and excel's replace function seems ill suited for this. </p>\n\n<p>Like I said, the 3 lines of code starting with NewData handle this, and then the 4th line after that pastes the whole thing into a single cell, which I then paste back into a text file. This is the most efficient way I have come up with to remove both types of unwanted quotes. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573599209, "post_id": 58827886, "comment_id": 103932136, "body": "Are events enabled? And you&#39;re sure the <code>Exit Sub</code> isn&#39;t being executed? What debugging have you done?"}, {"owner": {"reputation": 71, "user_id": 3381431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376706ab43b787a9a6dacaa2d83feed1?s=128&d=identicon&r=PG&f=1", "display_name": "user3381431", "link": "https://stackoverflow.com/users/3381431/user3381431"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573600451, "post_id": 58827886, "comment_id": 103932448, "body": "how can i debug this? i just know it works fine when i execute it manually in the wba editor. I have this line in my code <code>Public WithEvents App As Application</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573600867, "post_id": 58827886, "comment_id": 103932553, "body": "Use of <code>Debug.Print</code> is one option."}, {"owner": {"reputation": 1567, "user_id": 8488913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oF9AE.png?s=128&g=1", "display_name": "Cristian Buse", "link": "https://stackoverflow.com/users/8488913/cristian-buse"}, "edited": false, "score": 0, "creation_date": 1605878652, "post_id": 58827886, "comment_id": 114794631, "body": "Related: <a href=\"https://stackoverflow.com/a/63328366/8488913\">https://stackoverflow.com/a/63328366/8488913</a>"}], "owner": {"reputation": 71, "user_id": 3381431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376706ab43b787a9a6dacaa2d83feed1?s=128&d=identicon&r=PG&f=1", "display_name": "user3381431", "link": "https://stackoverflow.com/users/3381431/user3381431"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573599310, "creation_date": 1573599154, "last_edit_date": 1573599310, "question_id": 58827886, "link": "https://stackoverflow.com/questions/58827886/excel-addin-workbook-open-procedure-not-firing", "title": "excel addin workbook_open procedure not firing", "body": "<p>I have an excel addin which creates some menu items in the workbook_open procedure. However it doesn't seem to fire all the time and I need to manually run it in the vba editor. I've posted a sample below. Any ideas why this might be happening?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_Open()\n\n    Set App = Application\n\n    'Avoid placing multiple menus on worksheet.\n    Dim Counter As Integer\n    For Counter = 1 To Application.CommandBars(\"Worksheet Menu Bar\").Controls.Count\n        If Application.CommandBars(\"Worksheet Menu Bar\").Controls.Item(Counter).Caption = \"Investment Database\" Then\n            Exit Sub\n        End If\n    Next Counter\n\n    'Add Investment Database menu to main menu bar and populate with buttons.\n    Dim newMenu As CommandBarPopup\n    Dim btnQuery As CommandBarButton\n    Dim btnEditQuery As CommandBarButton\n    Dim btnFillQuery As CommandBarButton\n    Dim btnRequest As CommandBarButton\n    Dim btnRequestWS As CommandBarButton\n    Dim btnRequestAll As CommandBarButton\n    Dim btnDatabaseUpload As CommandBarButton\n\n    Set newMenu = Application.CommandBars(\"Worksheet Menu Bar\").Controls.Add(msoControlPopup, , , , True)\n    newMenu.Caption = \"Investment Database\"\n\n    Set btnQuery = newMenu.Controls.Add(msoControlButton, , , , True)\n    btnQuery.Caption = \"Generate Query...\"\n    btnQuery.OnAction = \"Load_Generate_Query\"\n    btnQuery.FaceId = 599\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 5, "creation_date": 1573593268, "post_id": 58826634, "comment_id": 103930090, "body": "Use the <code>Dir</code> Function - it accepts wildcards, and you can then step thru each file in the folder. If you need to check the actual file date, you can use a FileSystemObject - <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dir-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573593289, "post_id": 58826634, "comment_id": 103930095, "body": "That code can&#39;t work. The <code>Type</code> argument of <code>Sheets.Add</code> needs to be an <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlsheettype\" rel=\"nofollow noreferrer\"><code>XlSheetType</code></a> enum value, not a file/path... at least as far as <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.sheets.add\" rel=\"nofollow noreferrer\">documentation</a> goes."}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573593352, "post_id": 58826634, "comment_id": 103930118, "body": "@MathieuGuindon works very well. Been using it for about 5 months now. Never had an issue (as long as the file name exists)"}, {"owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573593395, "post_id": 58826634, "comment_id": 103930133, "body": "@braX I&#39;d like to automate it. I don&#39;t want to have to step through the files myself."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573593399, "post_id": 58826634, "comment_id": 103930136, "body": "Ah, missed that part &quot;If you are inserting a sheet based on an existing template, specify the path to the template&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1573593500, "post_id": 58826634, "comment_id": 103930173, "body": "@Gitty I think what braX meant is that you can pair <code>Dir</code> with a loop to find the next file."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1573593557, "post_id": 58826634, "comment_id": 103930194, "body": "The <code>Dir</code> function will help you automate it - by &quot;step&quot; i meant &quot;loop&quot; - it&#39;s automatic"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1573593587, "post_id": 58826634, "comment_id": 103930205, "body": "<code>Dim dtTest As Date  dtTest = Range(&quot;E2&quot;).Text  Do Until Dir(&quot;E:\\MyFolder\\Manipulated Data\\Test\\&quot; &amp; dtTest &amp; &quot;.csv&quot;) &lt;&gt; &quot;&quot;     dtTest = dtTest + 1 Loop  Sheets.Add Type:=&quot;E:\\MyFolder\\Manipulated Data\\Test\\&quot; &amp; dtTest &amp; &quot;.csv&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "is_accepted": false, "score": 0, "last_activity_date": 1573595724, "creation_date": 1573595724, "answer_id": 58827268, "question_id": 58826634, "link": "https://stackoverflow.com/questions/58826634/find-next-file-in-folder-based-on-name/58827268#58827268", "title": "Find Next File in Folder based on Name", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub LookForFile()\n    Dim sBaseFolder As String\n    Dim objFSO As Object\n    Dim datFileName As Date\n\n    Set objFSO = CreateObject(\"FileSystemObject\")\n    sBaseFolder = \"E:\\MyFolder\\Manipulated Data\\Test\\\"\n\n    ' Initalize date\n    datFileName = CDate(Range(\"E2\"))\n\n    Do While Not objFSO.FileExists(sBaseFolder &amp; GetFileNameFromDate(datFileName) &amp; \".csv\")\n\n        datFileName = DateAdd(\"d\", 1, datFileName)\n\n        ' Maybe place a limit here in case file doesn't exist\n\n    Loop\n\n    ' datFileName should now contain the date of a matching file\n\nEnd Sub\n\nFunction GetFileNameFromDate(ByVal p_date As Date)\n    ' Returns YY-MM-DD format\n    GetFileNameFromDate = Year(p_date) &amp; \"-\" &amp; Right(\"0\" &amp; Month(p_date), 2) &amp; \"-\" &amp; Right(\"0\" &amp; Day(p_date), 2)\nEnd Function\n</code></pre>\n\n<p>The <code>GetFileNameFromDate</code> function lets you specify the file name format since I imagine it's not a direct date but probably a string with the slashes removed. </p>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1573596535, "post_id": 58827364, "comment_id": 103931223, "body": "Suggest you use the <code>.Value2</code> property and the <code>Format</code> function instead of the <code>.Text</code> property.  The <code>.Text</code> property is easily changed.  And if the column width gets narrowed, it may return only <code>###</code> instead of the date. But using <code>Format(newdate.Value2,&quot;your_required_date_format&quot;)</code> should be more bulletproof."}], "tags": [], "owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "is_accepted": true, "score": 0, "last_activity_date": 1573596214, "creation_date": 1573596214, "answer_id": 58827364, "question_id": 58826634, "link": "https://stackoverflow.com/questions/58826634/find-next-file-in-folder-based-on-name/58827364#58827364", "title": "Find Next File in Folder based on Name", "body": "<p>Thanks everyone! The code below works well. I had to use <code>Range</code> instead of <code>Date</code> because I had to convert it to <code>Text</code> for it to be able to work as a file name.</p>\n\n<pre><code>Dim newdate As Range\nSet newdate = Range(\"E2\")\nDo Until Dir(\"E:\\MyFolder\\Manipulated Data\\Test\\\" &amp; newdate.Text &amp; \".csv\") &lt;&gt; vbNullString\nnewdate = newdate + 1\nLoop\nSheets.Add Type:=\"E:\\MyFolder\\Manipulated Data\\Test\\\" &amp; newdate.Text &amp; \".csv\"\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58827364, "answer_count": 2, "score": 0, "last_activity_date": 1573596214, "creation_date": 1573592703, "question_id": 58826634, "link": "https://stackoverflow.com/questions/58826634/find-next-file-in-folder-based-on-name", "title": "Find Next File in Folder based on Name", "body": "<p>I have a folder with files, all named by date. I have the file name (date) that I'm looking for, in cell <code>E2</code>. The cell has already been formatted so that it's in the same format as the file names. Here's what I have so far:</p>\n\n<pre><code>Sub Step2Importsheet()\n\nSheets.Add Type:= _\n\"E:\\MyFolder\\Manipulated Data\\Test\\\" &amp; Range(\"E2\").Text &amp; \".csv\"\n\nEnd Sub\n</code></pre>\n\n<p>This code works great if the date in cell <code>E2</code> exists as a file in the folder.</p>\n\n<p>Now here's my problem: In some cases, I have a date listed in <code>E2</code> that does not exist as a file in the folder. I want to expand the code so that if it doesn't exist, it looks for the next sequential date until it finds a file. (In most cases this will be one or two dates after the date in <code>E2</code> but it might go as far as five days out. It will never hit an indefinite loop).</p>\n\n<p>Appreciate any and all help!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1573646262, "post_id": 58826628, "comment_id": 103947745, "body": "it can be done, see my edited answer!"}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1573652673, "post_id": 58826762, "comment_id": 103951273, "body": "There doesn&#39;t seem to be an \\0 available, to get all that was captured. Not needed here anyway. To do the search manually, <a href=\"http://www.gmayor.com/replace_using_wildcards.htm\" rel=\"nofollow noreferrer\">gmayor.com/replace_using_wildcards.htm</a> explains the menu in an extensive way."}], "tags": [], "owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "is_accepted": true, "score": 0, "last_activity_date": 1573646132, "last_edit_date": 1573646132, "creation_date": 1573593215, "answer_id": 58826762, "question_id": 58826628, "link": "https://stackoverflow.com/questions/58826628/vba-word-formatting-the-color-of-a-word-depending-on-its-first-letter/58826762#58826762", "title": "VBA Word -- formatting the color of a word depending on its first letter", "body": "<p>According to the macro I just recorded from the advanced search and replace \"wizzard\", this should work to find the first char:</p>\n\n<pre><code>.Text = \"&lt;a\"\n.MatchWildcards = True\n</code></pre>\n\n<p>&lt; is \"beginning of word\", from the special characters list</p>\n\n<p>To change the full word, it should then be this:</p>\n\n<pre><code>.Text = (&lt;[aA]*&gt;)\n.MatchWildcards = True\n.Replacement.Text = \"\\1\"\n</code></pre>\n\n<p>Plus your code to change the color, and the rest of the code you already have. Assuming here that the upper case A gets the same color than the lower case.</p>\n\n<p>After more tries, it appears you don't even have to give any replacement, and can get rid of the ():</p>\n\n<pre><code>.Text = &lt;[aA]*&gt;\n.MatchWildcards = True\n.Replacement.Text = \"\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12363283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a69a4b05cce3d57604e0b4217687ab6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Carter", "link": "https://stackoverflow.com/users/12363283/michael-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58826762, "answer_count": 1, "score": 1, "last_activity_date": 1573646132, "creation_date": 1573592665, "last_edit_date": 1573592697, "question_id": 58826628, "link": "https://stackoverflow.com/questions/58826628/vba-word-formatting-the-color-of-a-word-depending-on-its-first-letter", "title": "VBA Word -- formatting the color of a word depending on its first letter", "body": "<p>I am trying to create a macro that sets the color of each word in a document to a predefined color according to the word's first letter (e.g. if \"a\" = red, \"apple\" = red). This is to simulate a specific form of <a href=\"https://en.wikipedia.org/wiki/Grapheme-color_synesthesia\" rel=\"nofollow noreferrer\">grapheme-color synesthesia</a>.</p>\n\n<p>Here's an example what I currently have:</p>\n\n<pre><code> Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \"a\"\n    .MatchCase = False\n    .Replacement.Text = \"a\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchWholeWord = False\n    .MatchByte = False\n    .CorrectHangulEndings = True\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Replacement.Font.Color = a_color\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>Obviously this just changes the color of each individual letter, not entire words. </p>\n\n<p>Is there an easy way to do this? Or is there a way to find a selection based on its first letter?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573591847, "post_id": 58826379, "comment_id": 103929554, "body": "Place the cursor on the <code>For</code> keyword, press F9 to toggle a breakpoint, then run your code. When the breakpoint is hit, press F8 to run the code line by line, and you&#39;ll find that the <code>For</code> loop has nothing to do with it... and that this <code>ElseIf</code> condition makes no sense inside this loop body ;-)"}, {"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1573591859, "post_id": 58826379, "comment_id": 103929561, "body": "Because you are in a For loop, else will be called if any of the characters in Firstname is a letter and the length is not over 100. This is not what you want (I suspect). You need to change your logic."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 3, "last_activity_date": 1573591720, "creation_date": 1573591720, "answer_id": 58826441, "question_id": 58826379, "link": "https://stackoverflow.com/questions/58826379/vba-if-statement-within-for-else-running-even-when-if-condition-is-met/58826441#58826441", "title": "VBA If Statement within For (Else Running even when If condition is met)", "body": "<p>Really you only want the first condition to exist in that FOR loop. The rest of it should be tested afterwards and only if that first condition never trips. </p>\n\n<p>Consider instead:</p>\n\n<pre><code>Dim nameHasNumbers as boolean: nameHasNumbers = False\nFor iCnt = 1 To Len(Firstname)\n    If IsNumeric(Mid(Firstname, iCnt, 1)) Then\n        'number found toggle flag and exit the loop\n        nameHasNumbers = True\n        exit For\n    End If    \nNext iCnt\n\n'Now alert the user or update the name cell\nIf nameHasNumbers Then\n    MsgBox \"The Firstname cannot contain Numeric values\"\nElseIf Len(Firstname) &gt; 100 Then\n    MsgBox \"The Firstname exceeds the character limit (100)\"\nElse\n    Sheet3.Cells(lRow, 2).Value = Me.Firstname.Value\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "is_accepted": false, "score": 1, "last_activity_date": 1573592315, "creation_date": 1573592315, "answer_id": 58826565, "question_id": 58826379, "link": "https://stackoverflow.com/questions/58826379/vba-if-statement-within-for-else-running-even-when-if-condition-is-met/58826565#58826565", "title": "VBA If Statement within For (Else Running even when If condition is met)", "body": "<p>For each letter in the name you are going to get the Else to happen. Need to restructure the whole thing. I would put the checking into a function and then based on that result do your other work. If you need a message to inform the user of the reason for the name being invalid add that to the function. Your function can then do other testing on other conditions without affecting your calling code.</p>\n\n<pre><code>Private Function IsValidName(ByVal value As String) As Boolean\n    If Len(value) &gt; 100 Then\n        IsValidName = False\n        Exit Function\n    Else\n        Dim charCounter As Long\n        For charCounter = 1 To Len(value)\n            If IsNumeric(Mid(value, charconter, 1)) Then\n                IsValidName = False\n                Exit Function\n            End If\n        Next\n        IsValidName = True\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1573593959, "creation_date": 1573593959, "answer_id": 58826914, "question_id": 58826379, "link": "https://stackoverflow.com/questions/58826379/vba-if-statement-within-for-else-running-even-when-if-condition-is-met/58826914#58826914", "title": "VBA If Statement within For (Else Running even when If condition is met)", "body": "<p>When you want to check whether a string includes a digit, you can compare it to a <code>Like</code> pattern which matches a digit: <code>FirstName Like \"*[0-9]*\"</code></p>\n\n<p>That approach is simpler than looping through the string checking whether each character is a digit.  And since it does not require the <code>For</code> loop, it should be easier to avoid the logic error in your code sample.  (As long as the string length did not exceed 100 characters, it wrote a value to <code>Sheet3.Cells(lRow, 2).Value</code> again for each and every non-numeric character contained in <code>FirstName</code>.)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If FirstName Like \"*[0-9]*\" Then\n    MsgBox \"The Firstname cannot contain Numeric values\"\nElseIf Len(FirstName) &gt; 100 Then\n    MsgBox \"The Firstname exceeds the character limit (100)\"\nElse\n    Sheet3.Cells(lRow, 2).Value = Me.FirstName.Value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12363227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ff7333bc89732de30002ab423f5d55?s=128&d=identicon&r=PG&f=1", "display_name": "RyanP", "link": "https://stackoverflow.com/users/12363227/ryanp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1573593959, "creation_date": 1573591435, "last_edit_date": 1573593054, "question_id": 58826379, "link": "https://stackoverflow.com/questions/58826379/vba-if-statement-within-for-else-running-even-when-if-condition-is-met", "title": "VBA If Statement within For (Else Running even when If condition is met)", "body": "<p>I'm pretty new to VBA and having issues with a Else statements running even when If conditions are met.</p>\n\n<p>Pretty sure this is due to the If statement being within a For &amp; Next</p>\n\n<pre><code>For iCnt = 1 To Len(Firstname)\n    If IsNumeric(Mid(Firstname, iCnt, 1)) Then\n        MsgBox \"The Firstname cannot contain Numeric values\"\n    ElseIf Len(Firstname) &gt; 100 Then\n        MsgBox \"The Firstname exceeds the character limit (100)\"\n    Else\n        Sheet3.Cells(lRow, 2).Value = Me.Firstname.Value\n    End If\nNext iCnt\n</code></pre>\n\n<p>Please any suggestions how to fix this?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1573591658, "post_id": 58826348, "comment_id": 103929462, "body": "Does it work? What is the problem with this code?"}, {"owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1573592458, "post_id": 58826348, "comment_id": 103929793, "body": "It works. Thought it takes too long (2 mins for 120 sections) to loop through all the sections. Wondering if there is any other method to code this."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573604104, "post_id": 58826348, "comment_id": 103933261, "body": "Scan the document to ensure that each section is linked to the previous section. Then you only need to do the page setup once."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573640660, "post_id": 58826348, "comment_id": 103944843, "body": "Try commenting out the status bar updates and add <code>Application.ScreenUpdating = False</code> at the beginning. Does that make any difference? And test using <code>For Each sec in oDoc.Sections</code> instead of a<code>Do</code>-loop. Theoretically, it is possible to use <code>oDoc.PageSetup...</code> instead of addressing each section individually, but this can cause problems when a document is large, but you can try it..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573640741, "post_id": 58826348, "comment_id": 103944892, "body": "@Freeflow Linking to previous is only for header and footer <i>content</i>. It has no relation to margin settings."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573643372, "post_id": 58826348, "comment_id": 103946347, "body": "@CindyMeister thanks for the clarification.  In this case, if all pages need the same margins, I&#39;d just do a select all and then set the margin."}, {"owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573649554, "post_id": 58826348, "comment_id": 103949390, "body": "@CindyMeister I do have application.screenupdating = false at the beginning of the code . For Each Sec in oDoc.sections and  Do loop takes around the same time to run. I tried oDoc.Pagesetup and it gives a &quot;rt error 4608: value Out of range error&quot;.                                                     oDoc.PageSetup.HeaderDistance = Application.InchesToPoints(0.25)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573666710, "post_id": 58826348, "comment_id": 103959245, "body": "If you&#39;re not getting this error with the original code, on the same document, then you may be running into that &quot;oddness&quot; working with the entire document can cause. In that case the only other thing that occurs to me would be to work with a <code>Range</code> object the covers multiple <code>Section</code>s. You can test to find out what&#39;s optimal. An example: <code>Set rngSecs = oDoc.Sections(1).Range : rngSecs.End = oDoc.Sections(10).Range.End : With rngSecs.PageSetup</code> and then sections 11 through 20, and so on. Whatever number of sections gives an optimal speed (assuming the approach works without error)."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "edited": false, "score": 0, "creation_date": 1573649140, "post_id": 58835977, "comment_id": 103949172, "body": "I get a runtime error &#39;5941&#39;: Requested member of the collection does not exist at line...storyranges.pagesetup. I&#39;m running this from excel and i have everything linked to word object. Not sure what i&#39;m missing."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "edited": false, "score": 0, "creation_date": 1573650259, "post_id": 58835977, "comment_id": 103949793, "body": "Because I&#39;m getting old and my fingers don&#39;t always do what I think they&#39;ve done.  Replace &#39;wdCommentsStory&#39; with &#39;wdMainTextStory&#39;"}, {"owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "edited": false, "score": 0, "creation_date": 1573650826, "post_id": 58835977, "comment_id": 103950154, "body": "Thanks. Now i get a 4608 error: Value out of range in the .headerDistance line. This is the same error i get when i do a activedocument.pagesetup. Did the above code run fine for you?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "edited": false, "score": 0, "creation_date": 1573652345, "post_id": 58835977, "comment_id": 103951077, "body": "Yes.  Your error may mean that the printer installed as the default printer doesn&#39;t support the margin size you have set."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1573643925, "creation_date": 1573643925, "answer_id": 58835977, "question_id": 58826348, "link": "https://stackoverflow.com/questions/58826348/applying-pagesetup-for-whole-word-document/58835977#58835977", "title": "Applying pagesetup for whole word document", "body": "<p>If you need all pages to be the same and you don't have to consider orientation then the code below will do the job.</p>\n\n<pre><code>With ActiveDocument.StoryRanges(wdCommentsStory).PageSetup\n\n    .HeaderDistance = Application.InchesToPoints(0.25)\n    .FooterDistance = Application.InchesToPoints(0.25)\n    .LeftMargin = Application.InchesToPoints(0.75)\n    .RightMargin = Application.InchesToPoints(0.75)\n    .TopMargin = Application.InchesToPoints(0.25)\n    '.BottomMargin= Application.InchesToPoints(0.25) ?\n\nEnd With\n</code></pre>\n\n<p>If you have different page requirements and also have different orientations then you may need to work section by section.  In this case turn off screen updating before you start and then turn it on when you finish.  (Application.ScreenUpdating=false/true)  This will stop word taking the time to reformat your document each time you make a change to a page format parameters (e.g 5 reformats for each section in your original code).</p>\n"}], "owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573643925, "creation_date": 1573591259, "last_edit_date": 1573592559, "question_id": 58826348, "link": "https://stackoverflow.com/questions/58826348/applying-pagesetup-for-whole-word-document", "title": "Applying pagesetup for whole word document", "body": "<p>I have a Word document with 120 sections. I wrote a simple Do Until loop to apply pagesetup as shown in the code. It takes little over 2 mins to loop through all the sections, which is too long. Is there any faster way to solve this issue?</p>\n\n<pre><code>Dim oSecRange As Word.Range\nDim iSecCounter As Long\niSecCounter = 0\nDo\n    Set oSecRange = oDoc.Sections(iSecCounter + 1).Range\n    Application.StatusBar = \"Adjusting HEADER &amp; FOOTER distance &amp; Page Margins - \" &amp; \n    Application.Round((iSecCounter / oDoc.Sections.Count) * 100, 0) &amp; \"% Completed.\"\n    oSecRange.PageSetup.HeaderDistance = Application.InchesToPoints(0.25)\n    oSecRange.PageSetup.FooterDistance = Application.InchesToPoints(0.25)\n    oSecRange.PageSetup.LeftMargin = Application.InchesToPoints(0.75)\n    oSecRange.PageSetup.RightMargin = Application.InchesToPoints(0.75)\n    oSecRange.PageSetup.TopMargin = Application.InchesToPoints(0.25)\n    iSecCounter = iSecCounter + 1\nLoop Until iSecCounter = oDoc.Sections.Count\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox", "activex"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1573589823, "post_id": 58825917, "comment_id": 103928720, "body": "You&#39;ll want to do this though the sheet&#39;s <code>OLEObjects</code> collection - see the answer on the linked post/duplicate. Note that the OLEObject&#39;s <code>Object</code> property will be your <code>MSForms.Checkbox</code> control - you&#39;ll want to have a <code>Dim chkBox As MSForms.CheckBox</code> variable to access the members, otherwise working with the <code>Object</code> property will be all late-bound, which is like coding blindfolded (expect error 438 if you make a mistake)"}, {"owner": {"reputation": 105, "user_id": 8891380, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1814839565196309/picture?type=large", "display_name": "Bryan Arreola", "link": "https://stackoverflow.com/users/8891380/bryan-arreola"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573592548, "post_id": 58825917, "comment_id": 103929815, "body": "@MathieuGuindon Awesome, thanks, I&#39;ll let you know if a I make it work."}, {"owner": {"reputation": 105, "user_id": 8891380, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1814839565196309/picture?type=large", "display_name": "Bryan Arreola", "link": "https://stackoverflow.com/users/8891380/bryan-arreola"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573673179, "post_id": 58825917, "comment_id": 103962162, "body": "@MathieuGuindon I ran into the error you just wrote, this is the code <a href=\"https://pastebin.com/bxpnKh6h\" rel=\"nofollow noreferrer\">link</a>, it creates the CheckBox, but absolutely ignores the <code>With objChkBx</code> code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1573673384, "post_id": 58825917, "comment_id": 103962252, "body": "Declare <code>objChkBx</code> (could use a few more vowels...) with <code>Dim objChkBx As MSForms.CheckBox</code>, and then change your code to do <code>With Sheets(&quot;...&quot;).OLEObjects.Add(...)</code>. Then inside the <code>With</code> block, do <code>Set objChkBx = .Object</code>. Now you have an early-bound checkbox object and you&#39;ll get intellisense/autocompletion for the member calls against it."}, {"owner": {"reputation": 105, "user_id": 8891380, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1814839565196309/picture?type=large", "display_name": "Bryan Arreola", "link": "https://stackoverflow.com/users/8891380/bryan-arreola"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573674077, "post_id": 58825917, "comment_id": 103962559, "body": "I just did, and it&#39;s exactly what I was looking for, thanks a lot!"}], "owner": {"reputation": 105, "user_id": 8891380, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1814839565196309/picture?type=large", "display_name": "Bryan Arreola", "link": "https://stackoverflow.com/users/8891380/bryan-arreola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1573589786, "answer_count": 0, "score": 0, "last_activity_date": 1573589068, "creation_date": 1573589068, "question_id": 58825917, "link": "https://stackoverflow.com/questions/58825917/edit-properties-activex-checkbox-vba-excel", "closed_reason": "Duplicate", "title": "Edit properties ActiveX CheckBox VBA Excel", "body": "<p>I'm trying to add a new CheckBox when the \"Sensitive data\" checkbox is checked and have the same height and width as the others.</p>\n\n<p>I've just see this <a href=\"https://stackoverflow.com/a/16992392\">answer</a> and it works, the code adds a new checkbox, but its like below</p>\n\n<p><a href=\"https://i.imgur.com/XRSakV7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/XRSakV7.png\" alt=\"this\"></a></p>\n\n<p>I want the \"Checkbox\" to have a name, like chkPCI, and the caption \"PCI\", I've tried the following code, but adds a form control, and not an ActiveX control.</p>\n\n<pre><code>    ActiveSheet.CheckBoxes.Add(Cells(10, \"A\").Left, _\n                            Cells(10, \"A\").Top, _\n                            72, 17.25).Select\n    With Selection\n        .Caption = \"PCI\"\n        .Value = xlOff '\n        .Display3DShading = False\n    End With\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-project"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1573590696, "post_id": 58825865, "comment_id": 103929088, "body": "Certainly not valid syntax. Declared rs as variable but reference re. Need to include <code>Option Explicit</code> at top of every module. Set this as default in VBA editor &gt; Tools &gt; Options &gt; Editor &gt; Require Variable Declaration. What is &#39;trouble&#39; - error message, wrong result, nothing happens?"}, {"owner": {"reputation": 1, "user_id": 9749653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001bc27357d62378b0684f382abf1789?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Wicktora", "link": "https://stackoverflow.com/users/9749653/jackson-wicktora"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1573593119, "post_id": 58825865, "comment_id": 103930040, "body": "I&#39;m simply using pseudo code for the logic, I made a mistake and typed &quot;re&quot; instead of &quot;rs&quot; sorry about that.  &quot;Option Explicit&quot; is at the top in the actual code.  By &quot;trouble&quot; I mean that I&#39;ve been unable to find the syntax on referencing MS project in Acess vba, nothing happens when I run it since its obviously not valid."}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1573594643, "post_id": 58825865, "comment_id": 103930597, "body": "Do you want to update an MS Project schedule with data from Access? Or update Access with MS Project data?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1573598717, "post_id": 58825865, "comment_id": 103931999, "body": "The typical way to do this is through automation. Here&#39;s a good SO post about automating Excel from Access; the concepts apply to Project as well: <a href=\"https://stackoverflow.com/questions/894799/how-to-use-vba-to-automate-several-office-applications\">stackoverflow...how-to-use-vba-to-automate-several-office-ap&zwnj;&#8203;plications</a>. Learn about automation and the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.object\" rel=\"nofollow noreferrer\">Project object model</a>, try it yourself and when you have a specific issue with the code, post a question about it."}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1573598963, "post_id": 58825865, "comment_id": 103932076, "body": "Also see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">How to create a Minimal, Reproducible Example</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1573611546, "post_id": 58825865, "comment_id": 103934906, "body": "Also from that same MSKB reference <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.application\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/project.application</a>."}], "owner": {"reputation": 1, "user_id": 9749653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001bc27357d62378b0684f382abf1789?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Wicktora", "link": "https://stackoverflow.com/users/9749653/jackson-wicktora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573592859, "creation_date": 1573588848, "last_edit_date": 1573592859, "question_id": 58825865, "link": "https://stackoverflow.com/questions/58825865/trying-to-compare-an-access-column-to-ms-project-column-using-access-vba-module", "title": "Trying to compare an Access Column to MS Project Column using Access vba module", "body": "<p>Trying to call the MS project in the Access Module, but I'm having trouble with the syntax. Basically I'm looping through both to compare the ID and if they match, update another cell.</p>\n\n<p>Here's what I have so far </p>\n\n<pre><code>Dim rs As DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(\"Select * From ['Access'])\n\nAllForms='MS Project'\n\nWhile Not rs.EOF\n  While Not AllForms.EOF\n    If ('Access Column')=('MS Project Column') Then\n\n    'Access Cell' = 'Ms Project Cell'  \n\n\n    End if\n   Allforms.MoveNext \n   Wend\nrs.MoveNext\nWend\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "edited": false, "score": 0, "creation_date": 1573593079, "post_id": 58825779, "comment_id": 103930022, "body": "If I understand correctly, you want to format numbers in listbox. How do you load data to listbox ? If with .Additem method, then you may use e.g. ListBox1.AddItem Format(mynumber, &quot;000 000.00&quot;) and setting format whatever you want."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "edited": false, "score": 0, "creation_date": 1573593412, "post_id": 58825779, "comment_id": 103930143, "body": "I don&#39;t believe I am using the .AddItem method. <code>If LCase(Mid(Sheet8.Cells(i, 3), x, a)) = Me.txtKitKeyword And Me.txtKitKeyword &lt;&gt; &quot;&quot; Then     Me.lstKitResult.AddItem Sheet8.Cells(i, 3)     Me.lstKitResult.List(lstKitResult.ListCount - 1, 1) = &quot;&quot; &amp; Sheet8.Cells(i, 2)     Me.lstKitResult.List(lstKitResult.ListCount - 1, 2) = &quot;&quot; &amp; Sheet8.Cells(i, 4)     Me.lstKitResult.List(lstKitResult.ListCount - 1, 3) = &quot;&quot; &amp; Sheet8.Cells(i, 5)</code> This is the code that is pulling data and adding it to the ListBox."}, {"owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "edited": false, "score": 0, "creation_date": 1573595005, "post_id": 58825779, "comment_id": 103930731, "body": "Look <a href=\"https://docs.microsoft.com/pl-pl/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">here</a> it&#39;s more info about Format function"}], "owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573588471, "creation_date": 1573588471, "question_id": 58825779, "link": "https://stackoverflow.com/questions/58825779/how-to-format-listbox-selection-as-accounting-value-in-excel-sheet", "title": "How to format ListBox selection as Accounting Value in excel sheet?", "body": "<p>I have a ListBox that populates based on a keyword search. After I make a selection I am able to populate an excel sheet with the columns of data that are in the ListBox. However, the numeric values populate in a \"Currency\" number format rather than \"Accounting\".</p>\n\n<p>The ListBox is populated from a database excel sheet where all values are in \"Accounting\" format. A generic number format is shown in the ListBox. And as previously mentioned, the sheet to populate with the ListBox selection changes the numbers to \"Currency\".</p>\n\n<p>The code below shows the values from the database sheet that would be transferred over to the new excel once the selection is made in the ListBox. </p>\n\n<pre><code>ListRow = lstKitResult.ListIndex + 3\nCells(Num, 2).Value = Worksheets(\"Kit_database\").Cells(ListRow, 2).Value\nCells(Num, 3).Value = Worksheets(\"Kit_database\").Cells(ListRow, 3).Value\n</code></pre>\n"}, {"tags": ["html", "vba", "internet-explorer", "getelementbyid"], "comments": [{"owner": {"reputation": 1974, "user_id": 694286, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2799043909f51ad0f159c6b0a13f5db1?s=128&d=identicon&r=PG", "display_name": "nageeb", "link": "https://stackoverflow.com/users/694286/nageeb"}, "edited": false, "score": 1, "creation_date": 1573590085, "post_id": 58825744, "comment_id": 103928834, "body": "There shouldn&#39;t be any space between your function call and its arguments. <code>btn.FireEvent(&quot;onmousedown&quot;)</code> and <b>not</b> <code>btn.FireEvent (&quot;onmousedown&quot;)</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573591274, "post_id": 58825744, "comment_id": 103929325, "body": "have you tried <code>btn.form.submit</code> this <code>walkscore-form&#39;).submit(); </code> makes me think its a form submission button."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1573886138, "post_id": 58825744, "comment_id": 104042619, "body": "can you share the url?"}], "answers": [{"tags": [], "owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "is_accepted": false, "score": 0, "last_activity_date": 1573724897, "last_edit_date": 1573724897, "creation_date": 1573624694, "answer_id": 58831110, "question_id": 58825744, "link": "https://stackoverflow.com/questions/58825744/webpage-button-will-not-respond-to-getelementbyid/58831110#58831110", "title": "Webpage button will not respond to getElementById", "body": "<p><del>Is there any error and which line throw the error? Can the button submit the form in IE without VBA? I tried your code and it worked. You could refer to the simple sample below:</del> </p>\n\n<p><strong>VBA code:</strong></p>\n\n<pre><code>Sub LOADIE()\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.navigate \"https://www.walkscore.com/score/1730-blake-st-denver-co-80202\"\n    Do Until IE.readyState = 4\n       DoEvents\n    Loop\n\n    Set searchbar = IE.document.getElementById(\"addrbar-street\")\n    searchbar.Value = \"B30 3LT\"\n    Application.Wait (Now + TimeValue(\"0:00:03\"))        'add a wait here  \n    Set btn = IE.document.getElementById(\"gs-address-go\")\n    btn.FireEvent (\"onmousedown\")\n    btn.FireEvent (\"onclick\")\n    btn.Focus\n    btn.Click\n\n    'IE.Quit\n    'Set IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>Besides, you could also try <code>btn.FireEvent \"onmousedown\"</code> and <code>btn.FireEvent \"onclick\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1573724396, "post_id": 58851594, "comment_id": 103979257, "body": "Thanks for posting the solution for this issue. I tried with the website you provided and I found that we can add a wait before the button click, then the click function can work. You could check my updated answer."}], "tags": [], "owner": {"reputation": 11, "user_id": 10138728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f501e83436e46df2e214e4d9627cae2f?s=128&d=identicon&r=PG&f=1", "display_name": "pjs6557", "link": "https://stackoverflow.com/users/10138728/pjs6557"}, "is_accepted": false, "score": 0, "last_activity_date": 1573717039, "creation_date": 1573717039, "answer_id": 58851594, "question_id": 58825744, "link": "https://stackoverflow.com/questions/58825744/webpage-button-will-not-respond-to-getelementbyid/58851594#58851594", "title": "Webpage button will not respond to getElementById", "body": "<p>I have discovered that I can simply use <a href=\"https://www.walkscore.com/score/B30\" rel=\"nofollow noreferrer\">https://www.walkscore.com/score/B30</a> 3LT with the B30 3LT being the search criteria. None of the above seem to work.</p>\n"}], "owner": {"reputation": 11, "user_id": 10138728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f501e83436e46df2e214e4d9627cae2f?s=128&d=identicon&r=PG&f=1", "display_name": "pjs6557", "link": "https://stackoverflow.com/users/10138728/pjs6557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573724897, "creation_date": 1573588327, "last_edit_date": 1573612270, "question_id": 58825744, "link": "https://stackoverflow.com/questions/58825744/webpage-button-will-not-respond-to-getelementbyid", "title": "Webpage button will not respond to getElementById", "body": "<p>I have tried many different ways but cannot get a button to respond on a webpage from VBA.\nCode I am trying:</p>\n\n<pre><code>Set btn = IE.document.getElementById(\"gs-address-go\")\nbtn.FireEvent (\"onmousedown\")\nbtn.FireEvent (\"onclick\")\nbtn.Focus\nbtn.Click\n</code></pre>\n\n<p>HTML extract of the object:</p>\n\n<pre><code>&lt;button id=\"gs-address-go\" class=\"b-btn bold go-btn\" onclick=\"$('#splash-get-walkscore-form').submit(); return false;\" aria-label=\"Go\"&gt;&lt;span class=\"icon big-search\"&gt;&lt;/span&gt;&lt;/button&gt;\n</code></pre>\n\n<p>Any help appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 12362952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1461c858e1986201bbe8c1d6b798c0?s=128&d=identicon&r=PG&f=1", "display_name": "cdortiz", "link": "https://stackoverflow.com/users/12362952/cdortiz"}, "edited": false, "score": 0, "creation_date": 1573587822, "post_id": 58825594, "comment_id": 103927888, "body": "I would like to add that I am aware there is inconsistency within the code with respect to references.  I&#39;ve been messing with only the first few lines to try to clear the error before fixing everything else."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573592426, "post_id": 58825594, "comment_id": 103929771, "body": "Worth noting that whether or not <code>Workbooks(&quot;fileNameNoExtension&quot;)</code> works or not (at least on Windows) is dependent on the Windows Explorer &quot;Hide extensions for known file types&quot; setting (on the View tab in the Folder Options dialog).  If this is unchecked, you need to include the extension - if it&#39;s not checked then you don&#39;t.  Note it <i>always</i> works if you just include the extension by default."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12362952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1461c858e1986201bbe8c1d6b798c0?s=128&d=identicon&r=PG&f=1", "display_name": "cdortiz", "link": "https://stackoverflow.com/users/12362952/cdortiz"}, "edited": false, "score": 0, "creation_date": 1573588528, "post_id": 58825659, "comment_id": 103928181, "body": "Hmm... tentatively good I&#39;m past this error... excuse me while I cry myself to sleep.  Will iron it out fully and see if it&#39;s gone for good."}], "tags": [], "owner": {"reputation": 46, "user_id": 9316171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad00c01999dfdd88dc7334e7ccd6d5e?s=128&d=identicon&r=PG&f=1", "display_name": "jcft2", "link": "https://stackoverflow.com/users/9316171/jcft2"}, "is_accepted": true, "score": 0, "last_activity_date": 1573587952, "creation_date": 1573587952, "answer_id": 58825659, "question_id": 58825594, "link": "https://stackoverflow.com/questions/58825594/troubles-with-subscript-out-of-range-error-9/58825659#58825659", "title": "Troubles with Subscript out of range (Error 9)", "body": "<p>I've just tried on a piece of my own code - adding the file extension to the name (.xlsx or whatever format your file is in) fixed a similar issue for me.  So \"ISRTrack.xlsx\" in your case.</p>\n"}], "owner": {"reputation": 3, "user_id": 12362952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1461c858e1986201bbe8c1d6b798c0?s=128&d=identicon&r=PG&f=1", "display_name": "cdortiz", "link": "https://stackoverflow.com/users/12362952/cdortiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58825659, "answer_count": 1, "score": 0, "last_activity_date": 1573587952, "creation_date": 1573587628, "question_id": 58825594, "link": "https://stackoverflow.com/questions/58825594/troubles-with-subscript-out-of-range-error-9", "title": "Troubles with Subscript out of range (Error 9)", "body": "<p>I've read a number of previous posts about this error.  An answer has appeared a few times noting that, essentially, VBA can't find the object I'm trying to point it to.  I've checked multiple times, and the names are correct (as far as I can tell).  I have also been testing this little macro on a different machine prior to this and nothing was wrong.</p>\n\n<p>My code is fairly long (for me) and I'm happy to admit it's the rambling of an amateur.  I've dumped the whole thing in but my problems happen immediately at the top where the program cannot find the ISRTrack workbook and then subsequently the same thing throughout - the ISRTrack workbook can never be found.</p>\n\n<p>I do not understand.  I have a similar process where I open two workbooks at the same time and run a macro and they copy and paste to each other - everyone's happy - granted it's not this ISRTrack workbook.  For some reason this just doesn't work...</p>\n\n<p>Are there other reasons that this error might come up that I'm not thinking of?</p>\n\n<p>Please and thank you in advance.</p>\n\n<pre><code>Sub ISRtoTable()\n\n'check if ISR already exists\n\nDim ISR_Check As String\n\nSet wISRSTC = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\")\nSet wISRTLD = Workbooks(\"ISRTrack\").Worksheets(\"ListData\")\nSet wISRIT = Workbooks(\"ISRTrack\").Worksheets(\"ISR_Tracker\")\n\nwISRSTC.Range(\"C51\").Copy _\n    wISRTLD.Range(\"L19\")\n\nISR_Check = wISRTLD.Range(\"L20\")\n\nIf ISR_Check = False Then\n\n'Dim for insertion of row into ISR_Tracker sheet\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\n\n'Dim for insertion of row into ISR_Notes sheet\nDim Nthe_sheet As Worksheet\nDim Ntable_list_object As ListObject\nDim Ntable_object_row As ListRow\n\n'Dim for insertion of row into ISR_Financial sheet\nDim Fthe_sheet As Worksheet\nDim Ftable_list_object As ListObject\nDim Ftable_object_row As ListRow\n\nDim ISR_Yr As String\nDim DT As String\nDim ISR_No As String\nDim FY_One As String\nDim FY_Two As String\nDim FY_Three As String\n\n'Put date and time from ISRT into variable\nDT = Workbooks(\"ISRT\").Worksheets(\"ISR_Tracker\").Range(\"A3\")\n\n'Put fiscal year fields into variables for later ISR transferring\nFY_One = Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K13\")\nFY_Two = Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K14\")\nFY_Three = Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K15\")\n\n'Add a row to the ISR_Tracker sheet table\nSet the_sheet = Workbooks(\"ISRT\").Worksheets(\"ISR_Tracker\")\nSet table_list_object = the_sheet.ListObjects(1)\nSet table_object_row = table_list_object.ListRows.Add\n\n'place the year from the List_Data table into a variable\nISR_Yr = Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K8\")\n\n'Generate an ISR number and put it into the newly created row in the table located in ISR_Tracker\nWith table_object_row\n\n    If (.Range(1).Row - Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K9\")) &lt; 10 Then\n        .Range(1) = ISR_Yr &amp; \"00\" &amp; (.Range(1).Row - Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K9\"))\n    Else\n        If (.Range(1).Row - Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K9\")) &lt; 100 Then\n            .Range(1) = ISR_Yr &amp; \"0\" &amp; (.Range(1).Row - Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K9\"))\n        Else\n            .Range(1) = ISR_Yr &amp; (.Range(1).Row - Workbooks(\"ISRT\").Worksheets(\"List_Data\").Range(\"K9\"))\n        End If\n    End If\n\n    .Range(2) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"G4\")\n    .Range(3) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"D18\")\n    .Range(4) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"D20\")\n    .Range(5) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"D10\")\n    .Range(8) = \"IMPORTED\"\n\n    'Import ISR number back into ISR Template\n    ISR_No = .Range(1)\n    ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"C51\") = ISR_No\n\nEnd With\n\n'Add a row to the ISR_Notes sheet table\nSet Nthe_sheet = Workbooks(\"ISRT\").Worksheets(\"Notes\")\nSet Ntable_list_object = Nthe_sheet.ListObjects(1)\nSet Ntable_object_row = Ntable_list_object.ListRows.Add\n\n'Populate new ISR_Notes table with a note about a new ISR being imported\nWith Ntable_object_row\n\n    .Range(1) = ISR_No\n    .Range(2) = DT\n    .Range(3) = Application.UserName\n    .Range(4) = \"New ISR Imported\"\n\nEnd With\n\n'Add a row to the Financial sheet table to import fiscal year one - if one exists\nIf ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"E41\") &gt; 0 Then\n\n    Set Fthe_sheet = Workbooks(\"ISRT\").Worksheets(\"Financial\")\n    Set Ftable_list_object = Fthe_sheet.ListObjects(1)\n    Set Ftable_object_row = Ftable_list_object.ListRows.Add\n\n        With Ftable_object_row\n\n            .Range(1) = ISR_No\n            .Range(2) = DT\n            .Range(3) = Application.UserName\n            .Range(4) = \"N/A\"\n            .Range(5) = FY_One\n            .Range(6) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"E41\")\n            .Range(7) = \"ESTIMATE\"\n            If ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"H47\") = \"Yes\" Then\n                .Range(8) = \"Recoverable\"\n            Else\n            End If\n\n        End With\n\nElse\nEnd If\n\n'Add a row to the Financial sheet table to import fiscal year two - if one exists\nIf ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"G41\") &gt; 0 Then\n\n    Set Fthe_sheet = Workbooks(\"ISRT\").Worksheets(\"Financial\")\n    Set Ftable_list_object = Fthe_sheet.ListObjects(1)\n    Set Ftable_object_row = Ftable_list_object.ListRows.Add\n\n        With Ftable_object_row\n\n            .Range(1) = ISR_No\n            .Range(2) = DT\n            .Range(3) = Application.UserName\n            .Range(4) = \"N/A\"\n            .Range(5) = FY_Two\n            .Range(6) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"E41\")\n            .Range(7) = \"ESTIMATE\"\n            If ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"H47\") = \"Yes\" Then\n                .Range(8) = \"Recoverable\"\n            Else\n            End If\n\n        End With\n\nElse\nEnd If\n\n\n'Add a row to the Financial sheet table to import fiscal year three - if one exists\nIf ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"I41\") &gt; 0 Then\n\n    Set Fthe_sheet = Workbooks(\"ISRT\").Worksheets(\"Financial\")\n    Set Ftable_list_object = Fthe_sheet.ListObjects(1)\n    Set Ftable_object_row = Ftable_list_object.ListRows.Add\n\n        With Ftable_object_row\n\n            .Range(1) = ISR_No\n            .Range(2) = DT\n            .Range(3) = Application.UserName\n            .Range(4) = \"N/A\"\n            .Range(5) = FY_Three\n            .Range(6) = ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"E41\")\n            .Range(7) = \"ESTIMATE\"\n            If ThisWorkbook.Worksheets(\"ISR - CPDB Staff to Complete\").Range(\"H47\") = \"Yes\" Then\n                .Range(8) = \"Recoverable\"\n            Else\n            End If\n\n        End With\n\nElse\nEnd If\n\n\n'Bottom of check for existing ISR\nElse\n    MsgBox (\"This ISR number already exists in the table.  Operation cancelled.\")\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1573587870, "post_id": 58825372, "comment_id": 103927912, "body": "You call <code>turnonFunctionality</code> at the end of <code>SortbyEcode</code> that might affect it, depending on what kind of events and calculations you have going, as they now run for the duration of <code>EcodeKeep</code>."}, {"owner": {"reputation": 109, "user_id": 10508937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3112d44576ab4ab57e82b79d637f64c2?s=128&d=identicon&r=PG", "display_name": "PhilNBlanks", "link": "https://stackoverflow.com/users/10508937/philnblanks"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1573588284, "post_id": 58825372, "comment_id": 103928088, "body": "@Warcupine That was it! Thanx so much.  Now I just need to resove the <code>wks.Range(&quot;AM2:AM&quot; &amp; i + 1).Value = Results</code> issue"}], "owner": {"reputation": 109, "user_id": 10508937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3112d44576ab4ab57e82b79d637f64c2?s=128&d=identicon&r=PG", "display_name": "PhilNBlanks", "link": "https://stackoverflow.com/users/10508937/philnblanks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573586930, "creation_date": 1573586649, "last_edit_date": 1573586930, "question_id": 58825372, "link": "https://stackoverflow.com/questions/58825372/calling-a-macro-from-within-another-macro-slows-execution", "title": "Calling a macro from within another macro slows execution", "body": "<p>This is a follow up on a duration I posted yesterday \"Why does this code causes an infinite loop\"</p>\n\n<p>Running \"SortByEcode\" first takes 5.51 seconds\nRunning \"KeepEcode\" next takes 1.65 seconds</p>\n\n<p>But if I call \"SortByEcode\" from within \"KeepEcode\", KeepEcode takes 4min 54sec to run.</p>\n\n<pre><code>Sub EcodeKeep()\n'Needs REH to be sorted first by ECode\nTurnOffFunctionality           ' Turn off Calculations, DisplayStatusBar, EnableEvents and ScreenUpdating\n     Dim i As Long\n     Dim j As Long\n     Dim LastRow As Long\n     Dim StartTime As Double\n\n      'Sort REH by ECode first\n     Call SortByEcode                   'THIS IS STILL THE BIG PROBLEM\n\n     Dim wks As Worksheet\n     Set wks = rawData5            'Work in sheet(\"RawEquipHistory\")\n     LastRow = wks.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n     StartTime = Timer\n\n     Dim Ecodes() As Variant\n     Ecodes = Application.Transpose(wks.Range(\"A1:A\" &amp; LastRow).Value)\n     Dim Results As Variant\n     ReDim Results(UBound(Ecodes) - 1)\n\n     wks.Range(\"AM1\") = \"ECODE KEEP\"  'Add the header to \"S1\"\n\n     For i = LBound(Results) To UBound(Results) - 1\n          Results(i) = Ecodes(i + 1) &lt;&gt; Ecodes(i + 2)\n     Next i\n\n     'wks.Range(\"AM2:AM\" &amp; i + 1).Value = Results 'I cannot get this line of code to work at all, so added a \"write\" loop\n                                                                  ' outside of maim loop\n\n     For j = 0 To i\n          wks.Range(\"AM\" &amp; j + 2) = Results(j)\n     Next j\n\nTurnOnFunctionality            ' Turn back on at the end\nCall EndTimer(\"EcodeKeep\", StartTime)\nEnd Sub\n</code></pre>\n\n<pre><code>Sub SortByEcode()\nTurnOffFunctionality           ' Turn off at the start\n      Dim LastRow As Long\n     LastRow = ThisWorkbook.Sheets(\"RawEquipHistory\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n     With ThisWorkbook.Sheets(\"RawEquipHistory\").Sort               '  SORT sheet by E-Code(a)\n          .SortFields.Clear\n          .SortFields.Add Key:=Range(\"A1:A\" &amp; LastRow), Order:=xlAscending\n          .SetRange Range(\"A1:AZ\" &amp; LastRow)\n          .Header = xlYes\n          .Apply\n     End With\n\nTurnOnFunctionality            ' Turn back on at the end\nDebug.Print \"SortByEcode is Done\"\nEnd Sub\n</code></pre>\n\n<p>Also, I cannot get the line of code provided by Mathieu Guindon @MathieuGuindonto run at all. The code does not kick up any errors but every cell in Range(\"AM2:AM\" &amp; LastRow) equals TRUE. However, if I loop over the Range(\"AM2:AM\" &amp; LastRow)and write the values one at a time I get the correct values.  </p>\n\n<p>And if I loop and debug.Pring Results(i) I get the correct results in the immediate window. So I know that the Results array has correct values.</p>\n\n<pre><code>wks.Range(\"AM2:AM\" &amp; i + 1).Value = Results\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1573592368, "post_id": 58825213, "comment_id": 103929755, "body": "If you are only selecting one <code>ListBox</code> item then your current code is not right, the code in your question is used to add multiple selected items in the<code>ListBox1</code> to the current text In the textbox. You don&#39;t need to loop through each <code>ListBox1</code> item. If you want to put the clicked item from <code>ListBox1</code> into <code>TextBox1</code> you only need <code>TextBox1.Text = ListBox1</code> all the other code is excess."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1573586515, "post_id": 58825277, "comment_id": 103927317, "body": "Is it a multiline textbox ?  By default it will not be."}, {"owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "edited": false, "score": 0, "creation_date": 1573586597, "post_id": 58825277, "comment_id": 103927352, "body": "I removed my comment since I can add <code>myString = Left(myString, Len(myString) - 1)</code> to remove the paragraph sign"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1573586218, "creation_date": 1573586218, "answer_id": 58825277, "question_id": 58825213, "link": "https://stackoverflow.com/questions/58825213/listbox-selection-become-textbox-selection/58825277#58825277", "title": "Listbox selection become textbox selection", "body": "<p><code>selectedItems</code> is a String and strings don't have any properties such as <code>Text</code></p>\n\n<pre><code>TextBox1.Value = selectedItems\n</code></pre>\n\n<p>would be what you need</p>\n"}], "owner": {"reputation": 79, "user_id": 12257698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee271f8e6d052fc7f7521298dd0fec3?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/12257698/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58825277, "answer_count": 1, "score": 2, "last_activity_date": 1573586644, "creation_date": 1573585963, "question_id": 58825213, "link": "https://stackoverflow.com/questions/58825213/listbox-selection-become-textbox-selection", "title": "Listbox selection become textbox selection", "body": "<p>I want a user to be able to click a value from the listbox and have the value selected become the textbox value. I'm getting an error from <code>Textbox1.Value = selectedItems.Text</code> as a compile error: invalid qualifier for <code>selecteditems</code>. I want the value selected to appear in the textbox as well. </p>\n\n<pre><code>Private Sub ListBox1_Click()\nDim selectedItems As String, i As Integer\n    For i = 0 To ListBox1.ListCount - 1\n        If ListBox1.Selected(i) = True Then\n        selectedItems = selectedItems &amp; ListBox1.List(i) &amp; vbNewLine\n    End If\nNext i\n\nTextBox1.Value = selectedItems.Text\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sharepoint", "sharepoint-online"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573584608, "post_id": 58824852, "comment_id": 103926540, "body": "you don&#39;t have an extension on your <code>wsdest</code> workbook.  You need to choose an actual workbook."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573584751, "post_id": 58824852, "comment_id": 103926597, "body": "Are you opening the destination workbook from SharePoint? At some point you need to call <code>workbooks.Open()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10784198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JP5by.jpg?s=128&g=1", "display_name": "Andy Latham", "link": "https://stackoverflow.com/users/10784198/andy-latham"}, "edited": false, "score": 0, "creation_date": 1573656741, "post_id": 58825032, "comment_id": 103953632, "body": "Tim, You are the man! I am sure I can just find this answer on SO but I will also ask here. now that this is working, after running the macro, it leaves the destination sheet I called still open. what additional code would I need to simply close this? would I just do something like ``` Workbooks.Close(Dest_WB_PATH) ```"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 39, "user_id": 10784198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JP5by.jpg?s=128&g=1", "display_name": "Andy Latham", "link": "https://stackoverflow.com/users/10784198/andy-latham"}, "edited": false, "score": 0, "creation_date": 1573660212, "post_id": 58825032, "comment_id": 103955703, "body": "<code>wbDest.Close True</code> to save changes"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1573586567, "last_edit_date": 1573586567, "creation_date": 1573585172, "answer_id": 58825032, "question_id": 58824852, "link": "https://stackoverflow.com/questions/58824852/write-values-from-workbook-to-one-stored-on-sharepoint/58825032#58825032", "title": "Write values from workbook to one stored on Sharepoint", "body": "<p>You can do something like this:</p>\n\n<pre><code>'Note needs the workbook name included, not just the path\nConst DEST_WB_PATH As String = \"https://tangandbiscuitcom.sharepoint.com/sites/tills/\" &amp; _\n                            \"Shared%20Documents/Safe%20Deposit/Safe_Deposit_Summary/Data.xlsx\"\nDim wbDest As Workbook, wsDest As Worksheet\n\nSet wbDest = Workbooks.Open(DEST_WB_PATH)\nSet wsDest = wbDest.Worksheets(\"Deposit Summary\")\n\nWith wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1).EntireRow\n    .Cells(1).Value = tillDate\n    .Cells(2).Value = hundredCountDeposit\n    '... etc etc\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10784198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JP5by.jpg?s=128&g=1", "display_name": "Andy Latham", "link": "https://stackoverflow.com/users/10784198/andy-latham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58825032, "answer_count": 1, "score": 0, "last_activity_date": 1581407528, "creation_date": 1573584368, "last_edit_date": 1581407528, "question_id": 58824852, "link": "https://stackoverflow.com/questions/58824852/write-values-from-workbook-to-one-stored-on-sharepoint", "title": "Write values from workbook to one stored on Sharepoint", "body": "<p>I am attempting to take data from specific cells in a workbook, and then save to a new row in a workbook on our corporate SharePoint.</p>\n\n<p>I think my primary issue is \"finding\" the SharePoint document. I have a sample path in my code below.</p>\n\n<p>I pulled code off of a website for sharing from workbook to workbook and that is the heavily commented section of my code and the area I believe may have the issue.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub depositSummaryUpdater()\n\nActiveSheet.Unprotect \"password\"\n\nDim managerName As String\nmanagerName = ActiveSheet.Cells(6, 4).Value\n\nDim depositActual As Currency\ndepositActual = ActiveSheet.Cells(11, 9).Value\n\nDim depositRevel As Currency\ndepositRevel = ActiveSheet.Cells(18, 3).Value\n\nDim depositVariance As Currency\ndepositVariance = ActiveSheet.Cells(15, 3).Value\n\nDim hundredCountDeposit As Currency\nhundredCountDeposit = ActiveSheet.Cells(12, 7).Value\n\nDim fiftyCountDeposit As Currency\nfiftyCountDeposit = ActiveSheet.Cells(11, 7).Value\n\nDim twentyCountDeposit As Currency\ntwentyCountDeposit = ActiveSheet.Cells(10, 7).Value\n\nDim tenCountDeposit As Currency\ntenCountDeposit = ActiveSheet.Cells(9, 7).Value\n\nDim fiveCountDeposit As Currency\nfiveCountDeposit = ActiveSheet.Cells(8, 7).Value\n\nDim twoCountDeposit As Currency\ntwoCountDeposit = ActiveSheet.Cells(7, 7).Value\n\nDim oneCountDeposit As Currency\noneCountDeposit = ActiveSheet.Cells(6, 7).Value\n\nDim quarterCountDeposit As Currency\nquarterCountDeposit = ActiveSheet.Cells(9, 10).Value\n\nDim dimeCountDeposit As Currency\ndimeCountDeposit = ActiveSheet.Cells(8, 10).Value\n\nDim nickelCountDeposit As Currency\nnickelCountDeposit = ActiveSheet.Cells(7, 10).Value\n\nDim pennyCountDeposit As Currency\npennyCountDeposit = ActiveSheet.Cells(6, 10).Value\n\nDim tillDate As Date\ntillDate = Format(ActiveSheet.Cells(4, 4), \"YY-MM-DD\")\n\nDim wsDest As Worksheet\nDim destLastRow As Integer\n\n'Dim depositPathString As String\n'depostPathString = \"https://ourcorporatesharpointaddress.sharepoint.com/sites/tills/Shared%20Documents/Safe%20Deposit/Safe_Deposit_Summary\"\n\n'Set variables for destination sheet\n'Set wsDest = Workbooks(depositPathString).Worksheets(\"Deposit Summary\")\nSet wsDest = Workbooks(\"https://ourcorporatesharepointaddress.sharepoint.com/sites/tills/Shared%20Documents/Safe%20Deposit/Safe_Deposit_Summary\").Worksheets(\"Deposit Summary\")\n\n'2. Find first blank row in the destination range based on data in column A\n'Offset property moves down 1 row\ndestLastRow = wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1).Row\n\n'3. Copy &amp; Paste Data\nSet wsDest.Cells(destLastRow, 1) = tillDate\nSet wsDest.Cells(destLastRow, 2) = hundredCountDeposit\nSet wsDest.Cells(destLastRow, 3) = fiftyCountDeposit\nSet wsDest.Cells(destLastRow, 4) = twentyCountDeposit\nSet wsDest.Cells(destLastRow, 5) = tenCountDeposit\nSet wsDest.Cells(destLastRow, 6) = fiveCountDeposit\nSet wsDest.Cells(destLastRow, 7) = twoCountDeposit\nSet wsDest.Cells(destLastRow, 8) = oneCountDeposit\nSet wsDest.Cells(destLastRow, 9) = quarterCountDeposit\nSet wsDest.Cells(destLastRow, 10) = dimeCountDeposit\nSet wsDest.Cells(destLastRow, 11) = nickelCountDeposit\nSet wsDest.Cells(destLastRow, 12) = pennyCountDeposit\nSet wsDest.Cells(destLastRow, 13) = depositActual\nSet wsDest.Cells(destLastRow, 14) = depositRevel\nSet wsDest.Cells(destLastRow, 15) = depositVariance\nSet wsDest.Cells(destLastRow, 16) = managerName\n\nActiveSheet.Protect \"password\", True, True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1573583339, "post_id": 58824569, "comment_id": 103925986, "body": "Where do you set <code>r</code> and declare <code>RootFolder</code>?  In any case, you could do <code>MkDir Range(&quot;J2&quot;) &amp; &quot;\\&quot; &amp; r.Text &amp; &quot;\\2018&quot;</code>..."}, {"owner": {"reputation": 419, "user_id": 3257196, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f709f13863ec9bcfa170d4d5b3326e0b?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesEF", "link": "https://stackoverflow.com/users/3257196/charlesef"}, "edited": false, "score": 1, "creation_date": 1573583579, "post_id": 58824569, "comment_id": 103926102, "body": "Is J2 going to contain the full path/file name?  Or, is J2 going to contain the year only?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1573583742, "post_id": 58824569, "comment_id": 103926170, "body": "Curious what you&#39;re up to that the year 2018 hasnt rolled over yet"}, {"owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1573584757, "post_id": 58824569, "comment_id": 103926599, "body": "The <code>Next r</code> doesn&#39;t have a matching <code>For</code>. Please provide the whole code that pertains to this. As @BruceWayne asked, where is <code>r</code> coming from and what is <code>RootFolder</code> defined as?"}, {"owner": {"reputation": 11, "user_id": 10414456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cfde5559924241167a0ee53693a73a?s=128&d=identicon&r=PG&f=1", "display_name": "lamar", "link": "https://stackoverflow.com/users/10414456/lamar"}, "edited": false, "score": 0, "creation_date": 1573585737, "post_id": 58824569, "comment_id": 103926995, "body": "J2 will just have the year in that cell. D1 creates a folder with the contents from that cell."}, {"owner": {"reputation": 11, "user_id": 10414456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cfde5559924241167a0ee53693a73a?s=128&d=identicon&r=PG&f=1", "display_name": "lamar", "link": "https://stackoverflow.com/users/10414456/lamar"}, "edited": false, "score": 0, "creation_date": 1573589382, "post_id": 58824569, "comment_id": 103928534, "body": "Thanks, that worked"}], "answers": [{"tags": [], "owner": {"reputation": 875, "user_id": 1393894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AijdQ.jpg?s=128&g=1", "display_name": "hammythepig", "link": "https://stackoverflow.com/users/1393894/hammythepig"}, "is_accepted": false, "score": 0, "last_activity_date": 1573586587, "creation_date": 1573586587, "answer_id": 58825359, "question_id": 58824569, "link": "https://stackoverflow.com/questions/58824569/how-to-create-folders-subfolders-in-excel-using-cell-value/58825359#58825359", "title": "How to create folders &amp; subfolders in Excel using cell value", "body": "<p>It's easy enough to add J2 to your code:</p>\n\n<pre><code>Sub IfNewFolder()\nDim R As Range\nDim RootFolder As String\nDim CurrYear as String\n\nRootFolder = \"R:\\Sales\\Quotes (Commercial)\\\" '&lt;&lt;&lt; CHANGE 1\nCurrYear = \"\\\" &amp; Range(\"J2\").Value\n\nFor Each R In Range(\"D1\") '&lt;&lt;&lt; CHANGE 2\n   If Len(R.Text) &gt; 0 Then\n       On Error Resume Next\n       MkDir RootFolder &amp; \"\\\" &amp; R.Text\n       MkDir RootFolder &amp; \"\\\" &amp; R.Text &amp; CurrYear\n\n       On Error GoTo 0\n   End If\nNext R\nEnd Sub\n</code></pre>\n\n<p>I would suggest specifying your range a bit,<br>\ninstead of just using <code>Range(\"D1\")</code> I would use <code>Workbooks(Thisworkbook.name).Worksheets(\"Sheet1\").Range(\"D1\")</code>,<br>\nIn your for loop state it as:</p>\n\n<pre><code> For Each R in Workbooks(Thisworkbook.name).Worksheets(\"Sheet1\").Range(\"D1:D10\")\n 'Rest of loop code here\n Next R\n</code></pre>\n\n<p>Also, if you are only looking at D1, you don't need to have a loop for it,<br>\nyou can simply set R to D1 then check if its .Text length is 0.</p>\n"}], "owner": {"reputation": 11, "user_id": 10414456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cfde5559924241167a0ee53693a73a?s=128&d=identicon&r=PG&f=1", "display_name": "lamar", "link": "https://stackoverflow.com/users/10414456/lamar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573587868, "creation_date": 1573583086, "last_edit_date": 1573587868, "question_id": 58824569, "link": "https://stackoverflow.com/questions/58824569/how-to-create-folders-subfolders-in-excel-using-cell-value", "title": "How to create folders &amp; subfolders in Excel using cell value", "body": "<p>How do I make this code use the value in cell J2 to make a sub folder so when the year rolls around I can just change the date in cell J2 without having to go into the code?</p>\n\n<p>Here is all the  code:</p>\n\n<pre><code>     Sub IfNewFolder()\n   Dim R As Range\n   Dim RootFolder As String\n   RootFolder = \"R:\\Sales\\Quotes (Commercial)\\\" '&lt;&lt;&lt; CHANGE 1\n   For Each R In Range(\"D1\") '&lt;&lt;&lt; CHANGE 2\n\n\n       If Len(R.Text) &gt; 0 Then\n           On Error Resume Next\n           MkDir RootFolder &amp; \"\\\" &amp; R.Text\n           MkDir RootFolder &amp; \"\\\" &amp; R.Text &amp; \"\\2019\"\n\n           On Error GoTo 0\n       End If\n   Next R\n      End Sub\n</code></pre>\n\n<p>How do I remove <code>MkDir RootFolder &amp; \"\\\" &amp; r.Text &amp; (\"\\2019\")</code> and make it use the value in Cell J2 for that folder name.</p>\n\n<p>Thanks,</p>\n\n<p>Lamar</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2019"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573583085, "post_id": 58824533, "comment_id": 103925865, "body": "Delete from <code>Select &#47;&#47; .Selection</code> from each line and subsequent line (<code>sheets().listobject.</code>), plus the <code>select</code> before <code>calculate</code> ... that&#39;ll be the first big help."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573583196, "post_id": 58824533, "comment_id": 103925924, "body": "What is in the Hours tab?  Is it a dependent formula?"}, {"owner": {"reputation": 29, "user_id": 7480940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e1c0b60e9d8e8de200e1d92c16ded5b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott P", "link": "https://stackoverflow.com/users/7480940/scott-p"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573584507, "post_id": 58824533, "comment_id": 103926494, "body": "sorry my &quot;hours&quot; are on the template page. It is a dependent formula that relies on my &quot;Years DB - CY&quot;"}], "owner": {"reputation": 29, "user_id": 7480940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e1c0b60e9d8e8de200e1d92c16ded5b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott P", "link": "https://stackoverflow.com/users/7480940/scott-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573585356, "creation_date": 1573582905, "last_edit_date": 1573585356, "question_id": 58824533, "link": "https://stackoverflow.com/questions/58824533/having-to-refresh-twice-to-get-one-certain-column-of-data", "title": "Having to refresh twice to get one certain column of data", "body": "<p>I am running a macro on excel, and for some reason, the \"Hours\" tab doesn't seem to run if I press my macro once. But if I click my macro twice, it populates. My code is the following</p>\n\n<pre><code>Sub Refresh()\n'\n' Refresh Macro\n'\n\n'\n    Sheets(\"P DB\").Select\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n    Sheets(\"Cn DB\").Select\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n    *Sheets(\"Years DB - CY\").Select\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False*\n    Sheets(\"E DB\").Select\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n    Sheets(\"Template\").Select\n    Calculate\nEnd Sub\n</code></pre>\n\n<p>This code:\n    <code>Sheets(\"Years DB - CY\").Select\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False</code> is what is running twice. FYI, Years DB - CY has a password and is connected to a server. So it should be able to refresh and ask for a password for the server each time.\nAny help would be great! Thank you so much</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1573582726, "post_id": 58824471, "comment_id": 103925710, "body": "That should be fine.  FYI you only declare <code>bar</code> as double: foo is Variant.  You need to declare the type for each variable"}, {"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573582831, "post_id": 58824471, "comment_id": 103925753, "body": "I did NOT know that, thanks!"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1573583906, "post_id": 58824471, "comment_id": 103926232, "body": "Never use <code>Dim</code> on global variables. Define their scope with <code>Private</code> or <code>Public</code>."}, {"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1573583967, "post_id": 58824471, "comment_id": 103926260, "body": "@HackSlash I am happy to comply, but just for my own enlightenment, why? Does Dim default to Public?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1573584120, "post_id": 58824471, "comment_id": 103926326, "body": "Depends on where it is used. It&#39;s best to be clear about your intention. <code>Dim</code> offers no indicator of scope. <a href=\"https://stackoverflow.com/questions/7853298/dim-vs-private-public\" title=\"dim vs private public\">stackoverflow.com/questions/7853298/dim-vs-private-public</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1573585379, "post_id": 58824471, "comment_id": 103926845, "body": "@HackSlash that link is for VB.NET. In VBA the <code>Dim</code> keyword declares a local variable in a procedure scope, or a <code>Private</code> variable in module scope."}], "answers": [{"comments": [{"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 0, "creation_date": 1573583913, "post_id": 58824577, "comment_id": 103926237, "body": "Perhaps whoever downvoted this can explain why they did. As for me, my concern with this method is its verbosity. I have fifty parameters for a model I am working on, and this method would generate about five hundred lines of code, which some would view as error-prone. Any words of wisdom?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 1, "creation_date": 1573584035, "post_id": 58824577, "comment_id": 103926287, "body": "My advice is to reconsider why you need 50 global variables. That sounds like bad design. What are you making that requires such a large number of external properties? Do they need to be visible outside this module or can they be private to the module?"}, {"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 0, "creation_date": 1573584617, "post_id": 58824577, "comment_id": 103926545, "body": "Well, these are excellent questions. To answer them, this is a financial model, so there are things like borrowing interest rate, inflation rate, various fixed costs, and so on - these can change depending on circumstances, so should be variable. , or variable-like. Now, as for visibility, there are the default values, which I initialize in &quot;ThisWorkbook&quot;, but also the user can set them by filling in cells (which live in an &quot;Inputs&quot; sheet), and if an input cell is changed, the has to be a recalc. This seems to indicate that I need them public, but (obviously) I am no VBA expert."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 1, "creation_date": 1573585259, "post_id": 58824577, "comment_id": 103926790, "body": "Gleesh. I would store all user facing data on the spreadsheet. Never hard code numbers in to your code unless they are part of a formula that never changes, like the constant for Pi. Each formula needs it&#39;s own function with inputs passed in to the function and the answer as the return value. No global variables are needed when passing values between functions. You can chain the functions together, passing the answers around until your calculation is complete, at which point you return the value to the spreadsheet. Inputs and outputs are then user facing on the spreadsheet."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 1, "last_activity_date": 1573583134, "creation_date": 1573583134, "answer_id": 58824577, "question_id": 58824471, "link": "https://stackoverflow.com/questions/58824471/vba-globals-declarations/58824577#58824577", "title": "VBA globals declarations", "body": "<p>Use Properties instead. That is what they are for. This gives you a globally readable property that can only be set locally by the initializer.</p>\n\n<p>EXAMPLE:</p>\n\n<pre><code>Option Explicit\n\nPrivate localFoo As Double\n\nPrivate Property Let foo(fooval As Double)\n    localFoo = fooval\nEnd Property\n\nPublic Property Get foo() As Double\n    foo = localFoo\nEnd Property\n\nPrivate Sub Auto_open()\n    initFoo\nEnd Sub\n\nPrivate Sub initFoo()\n    foo 3.14\nEnd Sub\n</code></pre>\n\n<p>SOURCE:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/property-set-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/property-set-statement</a></p>\n"}, {"comments": [{"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 0, "creation_date": 1573586008, "post_id": 58825051, "comment_id": 103927101, "body": "My general preference is for functional languages, so I feel your pain re globals, however, the truth is that often one does need state, and a lot of it. The &quot;clean&quot;(er) way is to use closures/classes, but that is not functionally different from Private variables (since, if I understand correctly, &quot;ThisWorkbook&quot; IS in fact a class). Giving every procedure fifty arguments is generally a poor idea, and passing a dictionary of key value pairs is, functionally identical to the Private mechanism, and produces ugly code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 0, "creation_date": 1573586311, "post_id": 58825051, "comment_id": 103927232, "body": "@IgorRivin <code>ThisWorkbook</code> is indeed a class, and I never said you don&#39;t need any state. In fact nothing prevents you from adding a class module to your project and making it expose 50 public fields (that compiles down to 50 read/write properties on the class&#39; default interface). Careful not to confuse <i>state</i> for <i>data</i>: VBA code hosted in an Excel document has the opportunity to leverage worksheets to persist data; state in code is fine, data in code isn&#39;t. I&#39;d suggest posting your finished, working code to <a href=\"https://codereview.stackexchange.com\">Code Review</a> if you want feedback on any/all aspects of it. Cheers!"}, {"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "edited": false, "score": 0, "creation_date": 1573586712, "post_id": 58825051, "comment_id": 103927410, "body": "Thank you! I will check out Code Review!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1573585224, "creation_date": 1573585224, "answer_id": 58825051, "question_id": 58824471, "link": "https://stackoverflow.com/questions/58824471/vba-globals-declarations/58825051#58825051", "title": "VBA globals declarations", "body": "<p><code>Dim</code> can't be used to declare globals. Use <code>Dim</code> for declaring local variables inside a procedure scope.</p>\n\n<p>When used at module level, <code>Dim</code> is equivalent to <code>Private</code>, and you should use <code>Private</code> instead, for consistency (<code>Private</code> antagonizes <code>Public</code> much more clearly than <code>Dim</code> does).</p>\n\n<blockquote>\n<pre><code>Dim foo, bar as Double\n</code></pre>\n</blockquote>\n\n<p>Note that this makes <code>bar</code> a <code>Double</code>, and leaves <code>foo</code> an implicit <code>Variant</code>. If both are intended to be <code>Double</code>, then the declaration should look like this:</p>\n\n<pre><code>Dim foo As Double, bar As Double\n</code></pre>\n\n<p>I would recommend declaring one single variable per statement.</p>\n\n<pre><code>Dim foo As Double\nDim bar As Double\n</code></pre>\n\n<p>Much easier to maintain that way.</p>\n\n<p>As for your question, assuming everything is in the same module, you're fine - and the variables don't need to be global (<code>Public</code> - there's a <code>Global</code> keyword too, but you can only use it in a standard module, and it's functionally identical to <code>Public</code>, so don't use <code>Global</code>, it's obsolete), since no other module needs to access them.</p>\n\n<p>Note that it's very, very, very rare that you <strong>need</strong> global variables. Most of the time, you'll be passing parameters between procedures instead.</p>\n"}], "owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1573585224, "creation_date": 1573582642, "question_id": 58824471, "link": "https://stackoverflow.com/questions/58824471/vba-globals-declarations", "title": "VBA globals declarations", "body": "<p>This is a really naive question, I am guessing. I have some global variables</p>\n\n<pre><code>Dim foo, bar as Double\n</code></pre>\n\n<p>Which are then set to something:</p>\n\n<pre><code>Sub setter()\n   foo = 3.14\n   bar = 2.718\nEnd Sub\n</code></pre>\n\n<p>I want the variables to be initialized on startup, which, I gather can be done with </p>\n\n<pre><code> Private Sub Auto_open()\n     Call setter\n End Sub\n</code></pre>\n\n<p>The question is: will this pick up the declarations, or is there some other magic I need to do?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1573581421, "post_id": 58824144, "comment_id": 103925142, "body": "It depends on what <code>testEIRR</code> does. I assume it updated a cell in this same <code>Worksheet</code> based on that error and since a cell is updated that will trigger the <code>worksheet_Change()</code> event which will fire this code which will cause that cell to get updated which will cause the <code>worksheet_change()</code> event to fire which will update that cell which will... Set <code>Application.EnableEvents = False</code> at the top of this subroutine and then toggle it back on when it&#39;s complete."}, {"owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1573581669, "post_id": 58824144, "comment_id": 103925250, "body": "Aha!  Thank you!"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1573583595, "post_id": 58824144, "comment_id": 103926109, "body": "Well done @IgorRivin ! I&#39;ve never seen a stack overflow from VBA!"}], "answers": [{"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 4, "last_activity_date": 1573581872, "last_edit_date": 1573581872, "creation_date": 1573581419, "answer_id": 58824175, "question_id": 58824144, "link": "https://stackoverflow.com/questions/58824144/vba-stack-overflow/58824175#58824175", "title": "VBA stack overflow", "body": "<p>You get a stack overflow because <code>Worksheet_Change</code> calls <code>Worksheet_Change</code> which calls <code>Worksheet_Change</code> .. etc</p>\n\n<p>You need to disable events before calling your function and enable them afterwards.</p>\n\n<p>Consider</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Application.Intersect(Range(\"H11:H13\"), Range(Target.Address)) Is Nothing Then\n        Application.EnableEvents = False\n        Call ThisWorkbook.testEIRR\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/15764839/380384\">this answer</a> to a similar question.</p>\n"}], "owner": {"reputation": 3445, "user_id": 2977256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b2b87c8281161bba80ee253b820a850f?s=128&d=identicon&r=PG", "display_name": "Igor Rivin", "link": "https://stackoverflow.com/users/2977256/igor-rivin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1573595859, "answer_count": 1, "score": 1, "last_activity_date": 1573581872, "creation_date": 1573581287, "question_id": 58824144, "link": "https://stackoverflow.com/questions/58824144/vba-stack-overflow", "closed_reason": "Duplicate", "title": "VBA stack overflow", "body": "<p>Consider the following VBA (whatever the latest version is) Subroutine:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'If Not Application.Intersect(Range(\"H11:H13\"), Range(Target.Address)) Is Nothing Then\n            Call ThisWorkbook.testEIRR\n    'End If\nEnd Sub\n</code></pre>\n\n<p>Now, if the commented out lines are NOT commented out, then changing the contents of cell H11 does the right thing (]updates the value computed by some function and stores it where it is supposed to). However, with the condition commented out (as above), I get a stack overflow (o, the irony!)</p>\n\n<p>Any idea how to fix it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573582922, "post_id": 58823973, "comment_id": 103925789, "body": "you need to have your input box value captured and used as opposed to hard coding, e.g., your formula would look like <code>&quot;=&quot; &amp; inputcol1 &amp; &quot;&#47;&quot; &amp; inputcol2</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573586314, "post_id": 58823973, "comment_id": 103927234, "body": "where did you define <code>myValue</code> and <code>myVolume</code>?   it may come down to syntax... what was the error you received when trying to run your code?"}, {"owner": {"reputation": 3, "user_id": 12362443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sUVNm9jMg4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9B6jirp59kZtwsCoj9US952fxgw/photo.jpg?sz=128", "display_name": "yash mishra", "link": "https://stackoverflow.com/users/12362443/yash-mishra"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573586473, "post_id": 58823973, "comment_id": 103927296, "body": "Hey thanks for the suggestion, I have added the code in edit, I am not getting any errors the code runs fine, however the desired column is not added."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573587076, "post_id": 58823973, "comment_id": 103927548, "body": "I believe I left out the apostrophe in the syntax for a column... try <code>&quot;=&#39;&quot; &amp; myValue &amp; &quot;&#39;&#47;&#39;&quot; &amp; myVolume &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 12362443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sUVNm9jMg4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9B6jirp59kZtwsCoj9US952fxgw/photo.jpg?sz=128", "display_name": "yash mishra", "link": "https://stackoverflow.com/users/12362443/yash-mishra"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1573587295, "post_id": 58823973, "comment_id": 103927665, "body": "It worked now, thanks a lot."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1573587413, "creation_date": 1573587413, "answer_id": 58825552, "question_id": 58823973, "link": "https://stackoverflow.com/questions/58823973/how-to-use-user-defined-column-names-for-calculating-a-field-in-excel-vba/58825552#58825552", "title": "How to use user defined column names for calculating a field in excel vba?", "body": "<p>Posting comments as answer to close-out this resolved issue:</p>\n\n<hr>\n\n<p>Try: </p>\n\n<pre><code>\"='\" &amp; myValue &amp; \"'/'\" &amp; myVolume &amp; \"'\"\n</code></pre>\n\n<p>The inputbox values need captured as variables and then used with appropriate syntax, e.g., <code>'column_name'</code></p>\n"}], "owner": {"reputation": 3, "user_id": 12362443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sUVNm9jMg4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9B6jirp59kZtwsCoj9US952fxgw/photo.jpg?sz=128", "display_name": "yash mishra", "link": "https://stackoverflow.com/users/12362443/yash-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58825552, "answer_count": 1, "score": 0, "last_activity_date": 1573587413, "creation_date": 1573580581, "last_edit_date": 1573587127, "question_id": 58823973, "link": "https://stackoverflow.com/questions/58823973/how-to-use-user-defined-column-names-for-calculating-a-field-in-excel-vba", "title": "How to use user defined column names for calculating a field in excel vba?", "body": "<p>I am using excel vba, to make a pivot table. After I build my pivot using the two columns in the value section of pivot \"Value MAT19\" and \"Volume(Kg) MAT 19\", I want to add a derived field i.e 'Value MAT19'/'Volume(Kg) MAT 19' to the pivot. However I don't want to fix the column names myself instead give user the control to select the columns in the pivot (it could be Value MAT18 or Value MAT17 and similarly for the Volume column) and hence I am using the InputBox feature of VBA. But I after I run my macro the calculated field does not show up. Here is the code I wrote for it. I have declared myValue and myVolume as String variables. The column Final API is getting displayed in the pivot but Final Val/Vol is not showing up.</p>\n\n<pre><code> ActiveSheet.PivotTables(\"PivotTable1\").CalculatedFields.Add \"Final Val/Vol\", _\n        \"=myValue /myVolume\", True\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Final Val/Vol\"). _\n        Orientation = xlDataField\n\n    ActiveSheet.PivotTables(\"PivotTable1\").CalculatedFields.Add \"FinalAPI\", _\n        \"='Value MAT19' /'Volume(Kg) MAT 19'\", True\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"FinalAPI\").Orientation = _\n        xlDataField \n</code></pre>\n\n<p>EDIT: This is the code that I have added according to Cyril's suggestion, but it still doesn't add the \"Final Val/Vol\" column.                                           </p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").CalculatedFields.Add \"Final Val/Vol\", _\n    \"=\" &amp; myValue &amp; \"/\" &amp; myVolume, True\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Final Val/Vol\"). _\n    Orientation = xlDataField\n</code></pre>\n\n<p>This is where I add myValue and myVolume and ask use for input, also declaring default column values:</p>\n\n<pre><code>    Dim myVolume As String\n    Dim myValue As String\n\n    myVolume = InputBox(\"Please enter volume column name\", \"Volume\", \"Volume(Kg) MAT 19\")\n    myValue = InputBox(\"Please enter value column name\", \"Value\", \"Value MAT19\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573580982, "post_id": 58823691, "comment_id": 103924951, "body": "Are all the order numbers numeric?"}, {"owner": {"reputation": 45, "user_id": 5418963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216d697aa813c3dcc4df3b4af06e619d?s=128&d=identicon&r=PG&f=1", "display_name": "MsCr3ole", "link": "https://stackoverflow.com/users/5418963/mscr3ole"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573581764, "post_id": 58823691, "comment_id": 103925296, "body": "Yes. all the OrderNo&#39;s are numeric."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 2, "creation_date": 1573583787, "post_id": 58823691, "comment_id": 103926192, "body": "looks like there are null references to <code>rs</code> inside of <code>UpdateTextBoxes</code>. Please put <code>Option Explicit</code> at the top of your code, above all other code, and recompile."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1573589603, "post_id": 58823691, "comment_id": 103928621, "body": "Why use Excel for data entry? rs is declared and set in one procedure and referenced in others. How are you making recordset available to multiple procedures?"}, {"owner": {"reputation": 45, "user_id": 5418963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216d697aa813c3dcc4df3b4af06e619d?s=128&d=identicon&r=PG&f=1", "display_name": "MsCr3ole", "link": "https://stackoverflow.com/users/5418963/mscr3ole"}, "edited": false, "score": 0, "creation_date": 1573604566, "post_id": 58823691, "comment_id": 103933375, "body": "I&#39;m using Excel because it&#39;s an assignment."}], "owner": {"reputation": 45, "user_id": 5418963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216d697aa813c3dcc4df3b4af06e619d?s=128&d=identicon&r=PG&f=1", "display_name": "MsCr3ole", "link": "https://stackoverflow.com/users/5418963/mscr3ole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573606706, "creation_date": 1573579354, "last_edit_date": 1573606706, "question_id": 58823691, "link": "https://stackoverflow.com/questions/58823691/add-delete-a-record-in-access-using-excel", "title": "Add/Delete a record in Access using Excel", "body": "<p>Need help with my assignment. I would like to add and delete a record for a selected customer. I can add a new record to the selected customer but when I delete the order it deletes the customer too. I believe it could be the RefreshRecordset call but if I only call orders then I will get everyone's record and not just the selected customer. I'm pretty much stuck on what's wrong with this code. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ZTPlD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZTPlD.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private RecCount As Integer\nPrivate CurrentOrderNo As Integer\n\nPrivate Sub UserForm_Activate()\n    EnableButtons\n    CreateDbObjects\n    With Sheets(\"Data\").cboCustomer\n        CurrentOrderNo = .List(.ListIndex, 1)\n    End With\n    RefreshRecordset CurrentOrderNo\nEnd Sub\n\n\nPrivate Sub RefreshRecordset(ByVal ThisCusNo As Integer)\n    ' This routine opens the recordset and selects the\n    ' desired record (based on ThisCusNo)\n\n   On Error GoTo error_handle:\n    sql = \"Select * From Customers INNER JOIN Orders ON Orders.CusNo = Customers.CusNo WHERE Orders.CusNo = \" &amp; ThisCusNo\n     rs.Open sql\n    If rs.BOF And rs.EOF Then  'No customer records, so go into 'Add' mode\n        RecCount = 0\n        cmdAdd_Click\n    Else\n        rs.MoveLast ' &lt;&lt;--This is done to ensure a correct RecordCount in the next line\n        RecCount = rs.RecordCount\n        rs.MoveFirst\n        rs.Find \"CusNo = \" &amp; ThisCusNo\n        UpdateTextBoxes\n    End If\n    Exit Sub\nerror_handle:\n    Select Case Err.Number\n    Case 91\n        CreateDbObjects\n        Resume\n    Case 3705\n        rs.Close\n        Resume\n     Case Else\n        MsgBox Err.Number &amp; \": \" &amp; Err.Description\n     End Select\nEnd Sub\n\nPrivate Sub UpdateTextBoxes()\n    ' This routine is used to place values for the current record into the userform text boxes\n    If RecCount = 0 Then\n        Me.Caption = \"Order Maintenance - Record 0 of 0\"\n    Else\n        Me.Caption = \"Order Maintenance - Record \" &amp; _\n           rs.AbsolutePosition &amp; \" of \" &amp; RecCount\n        lblCustomer = rs.Fields(\"LName\") &amp; \", \" &amp; rs.Fields(\"FName\")\n        txtDate = rs(\"PurchDate\").Value\n        txtProduct = rs(\"Product\").Value\n        txtUnits = rs(\"Units\").Value\n        txtAmount = rs(\"Amount\").Value\n        lblOrderNo = rs(\"CusNo\").Value\n    End If\nEnd Sub\n\n\nPrivate Sub cmdAdd_Click()\n    Me.Caption = \"Order Maintenance - Add new record...\"\n    Me.Tag = \"Add\"  ' Indicates that we're in 'Add' mode\n    AddChangeClick\nEnd Sub\n\nPrivate Sub cmdChange_Click()\n    Me.Caption = \"Order Maintenance - Change current record...\"\n    Me.Tag = \"Change\"  ' Indicates that we're in 'Change' mode\n    AddChangeClick\nEnd Sub\n\n\nPrivate Sub cmdOK_Click()\n    ' Note: The user can click OK to exit Add/Change mode OR to dismiss the user form\n    If Me.Tag = \"Add\" Or Me.Tag = \"Change\" Then ' User clicked OK while in Add/Change mode\n        If DataMissing() = True Then\n            msg = \"Required data is missing.\" &amp; vbCrLf &amp; \"Please Try again.\"\n            MsgBox msg, vbExclamation, \"Error\"\n            Exit Sub\n        End If\n        AddOrChangeRecord\n        Me.Tag = vbOK   ' Takes us out of Add/Change mode\n        EnableButtons\n    Else ' User clicked OK while not in Add/Chnage mode\n        Me.Hide\n    End If\n\nEnd Sub\n\nPrivate Function DataMissing() As Boolean\n    ' This routine just checks to see if any TextBoxes are empty\n    DataMissing = False\n    For Each ctl In Controls\n        If TypeName(ctl) = \"TextBox\" Then\n            If ctl.Text = \"\" Then DataMissing = True: Exit Function\n        End If\n    Next\nEnd Function\n\nPrivate Sub AddOrChangeRecord()\n    Dim rs2 As New ADODB.Recordset\n\n    If Me.Tag = \"Add\" Then\n        ' If we're Adding a record we need a new (unused) value for OrderNo\n        sql = \"Select Max(OrderNo) From Orders\"\n        rs2.Open sql, db, adOpenDynamic, adLockOptimistic\n        rs.AddNew\n        rs(\"CusNo\").Value = CurrentCusNo\n    End If\n\n    rs(\"PurchDate\").Value = CStr(txtDate)\n    rs(\"Product\").Value = CStr(txtProduct)\n    rs(\"Units\").Value = CStr(txtUnits)\n    rs(\"Amount\").Value = CStr(txtAmount)\n    rs(\"CusNo\").Value = CStr(lblOrderNo)\n    rs.Update\n\n    RefreshRecordset CurrentCusNo\nEnd Sub\n\nPrivate Sub cmdDelete_Click()\n    Dim rs2 As New ADODB.Recordset\n    Dim CurrentRecord As Integer\n\n    ' First see if there are records in the Orders table for this customer\n    ' If so, we don't want to delete the customer record\n    CusIdNo = rs(\"CusNo\").Value\n    sql = \"Select Count(*) As RecordsLeft From Orders Where CusNo = \" &amp; CusIdNo\n    rs2.Open sql, db, adOpenDynamic, adLockOptimistic\n\n    If rs2.Fields(\"RecordsLeft\") &lt; 0 Then\n        MsgBox \"Orders remain for this customer.\", vbExclamation, \"Cannot Delete...\"\n    Else\n        msg = \"Are you sure you want to delete this record?\"\n        If MsgBox(msg, vbYesNo, \"Warning...\") = vbYes Then\n            CurrentRecord = WorksheetFunction.Max(rs.AbsolutePosition - 1, 1)\n            rs.Delete  ' AbsolutePosition is undefined after deleting a record!\n            RecCount = RecCount - 1\n            If RecCount = 0 Then\n                Me.Tag = \"Quit\"\n                cmdOK_Click\n            Else\n                rs.AbsolutePosition = CurrentRecord\n                MsgBox \"Record deleted.\", vbInformation, \"Confirmation\"\n                UpdateTextBoxes\n            End If\n        End If\n    End If\n\nEnd Sub\n\nPrivate Sub cmdCancel_Click()\n    ' Recall that cmdCancel is only visible in Add/Change mode\n    If RecCount = 0 Then\n        Me.Hide\n    Else\n        EnableButtons\n        Me.Tag = vbCancel  ' We're no longer in Add/Change mode\n        UpdateTextBoxes\n    End If\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    ' This prevents the user from dismissing the form by clicking the close button\n    Cancel = vbYes\n    If Me.Tag = \"Add\" Or Me.Tag = \"Change\" Then\n        cmdCancel_Click\n    Else\n        cmdOK_Click\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573580598, "post_id": 58823334, "comment_id": 103924777, "body": "Sounds like a good approach might be to create a mapping table of data table Column Name to named range name, and use that to drive the code which transfers values."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573581029, "post_id": 58823334, "comment_id": 103924966, "body": "@Tim Williams are you saying to create a separate named range say, &quot;TableHeaderRange&quot; to list all the headers I am using from my Employee Data Table? Can I still use a dictionary approach going that route?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573581404, "post_id": 58823334, "comment_id": 103925137, "body": "You can use a dictionary - did you try that already and run into problems?  It&#39;s not exactly clear from your question what the source data looks like, but why not just make a start and see where you get?"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573581809, "post_id": 58823334, "comment_id": 103925314, "body": "@Tim Williams, I&#39;ll write something up in a bit, I&#39;ll be editing my question to include my code."}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573577963, "creation_date": 1573577963, "question_id": 58823334, "link": "https://stackoverflow.com/questions/58823334/how-to-use-a-dictionary-in-vba-to-transfer-data-from-a-table-to-a-worksheet", "title": "How to use a Dictionary in VBA to transfer data from a Table to a Worksheet?", "body": "<p>I am building an Excel application that takes data from an \"Employee Data Table\" and transfers it to a \"Coaching Form\". </p>\n\n<p>The Coaching Form is created if an employee id match exists. The struggle I am facing is transferring the data from the Employee Data Table to nearly 200+ named ranges on the Coaching Form.  </p>\n\n<p>Not all the columns of data are being used, and they are not organized to follow the coaching form structure. </p>\n\n<blockquote>\n  <p><strong>Example</strong></p>\n</blockquote>\n\n<p><strong>Data table</strong>: \"employee_ID\"</p>\n\n<p><strong>Coaching Form</strong>: <code>Sheets(\"Sheet2\").Range(\"EmployeeID_Field\").value = employee_ID</code></p>\n\n<p><strong>Data table</strong>: \"employee_Office\"</p>\n\n<p><strong>Coaching Form</strong>: <code>Sheets(\"Sheet2\").Range(\"EmployeeOffice_Field\").value = employee_Office</code></p>\n\n<p>(...<em>and so on</em>)</p>\n\n<blockquote>\n  <p><strong>Coaching Form Layout</strong>\n  Header, Body, Footer</p>\n</blockquote>\n\n<ul>\n<li>Header - Contains over 10 named ranges</li>\n<li>Body - Contains over 100 named ranges</li>\n<li>Footer - Contains over 50 named ranges</li>\n</ul>\n\n<blockquote>\n  <p><strong>Employee Data Table Layout</strong>\n  3,000+ Rows, 30+ plus columns </p>\n</blockquote>\n\n<p><strong>Possible Dictionary Solution</strong></p>\n\n<p><em>Dictionary 1</em> </p>\n\n<p>Using a loop, store each header value I will be using from the Employee Data Table as my <code>*Key*</code>, and saving the data from the matching Employee ID record as the <code>*Value*</code></p>\n\n<p>How can I implement a second <code>Dictionary</code> to merge the data from <code>employee_ID</code> <code>key</code> to equal the value of <code>EmployeeID_Field</code> <code>key</code> in a second Dictionary?</p>\n\n<p><a href=\"https://i.stack.imgur.com/9JO8d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9JO8d.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p><strong>Coaching Form shows named ranges in yellow</strong></p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/G7BrP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G7BrP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1573577499, "post_id": 58823158, "comment_id": 103923252, "body": "Possible workaround, though it may run into its own set of problems: <code>=IF(AND(A1=B1,LEN(A1)=LEN(B1)),&quot;same&quot;,&quot;different&quot;)</code>"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1573577619, "post_id": 58823158, "comment_id": 103923324, "body": "You might even only need <code>LEN(A1)=LEN(B1)</code> since <code>TRUE</code> and <code>FALSE</code> don&#39;t contain the same amount of letters."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1573577777, "post_id": 58823158, "comment_id": 103923398, "body": "What format are your cells?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573577780, "post_id": 58823158, "comment_id": 103923403, "body": "<code>TEXT(H11,&quot;@&quot;)=TEXT(I11,&quot;@&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1573578863, "last_edit_date": 1573578863, "creation_date": 1573577973, "answer_id": 58823340, "question_id": 58823158, "link": "https://stackoverflow.com/questions/58823158/excel-evaluates-false-and-blank-cell-as-equal/58823340#58823340", "title": "Excel evaluates &quot;FALSE&quot; and blank cell as equal", "body": "<p>The reason is that it is defined as <code>FALSE = 0</code> and <code>TRUE = 1</code> (in formulas) or <code>TRUE = -1</code> (in VBA). </p>\n\n<p>If you compare <code>A1=B1</code> you compare the <strong>values</strong> of these cells. And the value of <code>FALSE</code> is <code>0</code> exactly as the value of a blank cell is <code>0</code>. So their value is equal and therefore they are considered the same.</p>\n\n<p>In addition to only check if the values are the same <code>A1=B1</code> also check if the data type is the same <code>TYPE(A1)=TYPE(B1)</code> using the <a href=\"https://support.office.com/en-us/article/type-function-45b4e688-4bc3-48b3-a105-ffa892995899\" rel=\"nofollow noreferrer\">TYPE function</a>:</p>\n\n<pre><code>=IF(AND(A1=B1,TYPE(A1)=TYPE(B1)),\"same\",\"different\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OgnXb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OgnXb.png\" alt=\"enter image description here\"></a></p>\n\n<p>This prevents implicit data type conversion (for example from a boolean <code>FALSE</code> to a integer <code>0</code> and vice versa).</p>\n\n<p><code>TYPE()</code> can distinguish between the following data types:</p>\n\n<ul>\n<li>1 = Number </li>\n<li>2 = Text</li>\n<li>4 = Logical value (Boolean)</li>\n<li>16 = Error value</li>\n<li>64 = Array (Matrix)</li>\n<li>128 = Compound data</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1573590923, "creation_date": 1573590923, "answer_id": 58826273, "question_id": 58823158, "link": "https://stackoverflow.com/questions/58823158/excel-evaluates-false-and-blank-cell-as-equal/58826273#58826273", "title": "Excel evaluates &quot;FALSE&quot; and blank cell as equal", "body": "<p>You can use EXACT:</p>\n\n<pre><code>=IF(EXACT(A1,B1),\"Same\",\"Different\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/C2wCz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C2wCz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 183, "user_id": 10687113, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lowZ4c_Si4E/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAckRwWHodRCnUEehP4aERPIP8dIQ/mo/photo.jpg?sz=128", "display_name": "lizziv", "link": "https://stackoverflow.com/users/10687113/lizziv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 1, "accepted_answer_id": 58826273, "answer_count": 2, "score": 2, "last_activity_date": 1573590923, "creation_date": 1573577232, "last_edit_date": 1573577542, "question_id": 58823158, "link": "https://stackoverflow.com/questions/58823158/excel-evaluates-false-and-blank-cell-as-equal", "title": "Excel evaluates &quot;FALSE&quot; and blank cell as equal", "body": "<p>I have a spreadsheet that uses VBA to retrieve data from a database and copy it into a worksheet. I need to compare two columns to see if they match. The possible values are \"TRUE\", \"FALSE\", or a blank cell.</p>\n\n<p>I have a simple formula to flag the row if the values are different: <code>=IF(I2=J2,\"Same\",\"Difference\")</code></p>\n\n<p>This formula works fine if the values match, or if they are TRUE/Blank or TRUE/FALSE, but it does not evaluate as expected when there's a FALSE and a blank cell!\n<a href=\"https://i.stack.imgur.com/cFjbY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cFjbY.png\" alt=\"Screenshot of formula not evaluating as expected\"></a></p>\n\n<p>If I type in the word \"FALSE\" the formula evaluates properly (like in the image below). The formula only seems to be tripped up when the data is pasted from the database by VBA.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fwzCl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fwzCl.png\" alt=\"screenshot of formula evaluating correctly when I type in the word &quot;False&quot;\"></a></p>\n\n<p>I suspect this has something to do with Excel treating FALSE and blank cells as both equivalent to \"0\", but I cannot figure out how to easily workaround this \"feature.\" A couple things I tried:</p>\n\n<ul>\n<li>I confirmed the cell types are set to \"Text\" for all cells and I tried using VBA to force the format to be text by using <code>Range(\"I:J\").NumberFormat = \"@\"</code>. Still evaluates to \"Same.\"</li>\n<li>I tried manually recalculating the formula by using the \"Calculate Now\" option in the Formulas ribbon. Still evaluates to \"Same.\"</li>\n<li>I can write an ugly formula in the IF statement to check if the cells match: <code>=IF(OR(AND(I2=\"FALSE\",J2=\"FALSE\"), AND(I2=\"TRUE\",J2=\"TRUE\"), AND(I2=\"\",J2=\"\")),\"Same\",\"Difference\")</code> Is there a way to simplify this formula  or force the I2=J2 formula to calculate correctly in case we ever have to handle data other than true/false/blank?</li>\n</ul>\n"}, {"tags": ["python", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "edited": false, "score": 0, "creation_date": 1573635481, "post_id": 58823214, "comment_id": 103942085, "body": "I changed it as you suggested and tried different combinations of double-triple quotes but I cannot make it work yet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "edited": false, "score": 0, "creation_date": 1573648065, "post_id": 58823214, "comment_id": 103948602, "body": "@svzap do you know what output string you want to achieve? Try running the command in cmd.exe"}, {"owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "edited": false, "score": 0, "creation_date": 1573667172, "post_id": 58823214, "comment_id": 103959464, "body": "Yes, I want to get the full path of the workbook. But right now I am getting the workbook path up to the first space in the path, the rest of the path after the space is not returned. I used to have &lt;&quot;cmd /k&quot; &amp; &quot; &quot; &amp;&gt; before the &lt;exePath&gt;  as shellCommand, then I removed it, but I was having the same problem with and without it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "edited": false, "score": 0, "creation_date": 1573667300, "post_id": 58823214, "comment_id": 103959525, "body": "What I mean is, write the actual shell command in the actual command-line interface, so you know what you want the string to look like. <i>Then</i> make your VBA code generate that exact same string. If you don&#39;t know what the CLI syntax is, then this isn&#39;t a VBA question."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1573577488, "creation_date": 1573577488, "answer_id": 58823214, "question_id": 58823027, "link": "https://stackoverflow.com/questions/58823027/passing-arguments-with-spaces-to-python-script-in-vba/58823214#58823214", "title": "Passing arguments with spaces to python script in VBA", "body": "\n\n<blockquote>\n<pre class=\"lang-vb prettyprint-override\"><code>shell.Run exePath &amp; \" \" &amp; scriptPath &amp; \" \" &amp; workbook_folder &amp; \" \" &amp; workbook_name\n</code></pre>\n</blockquote>\n\n<p>That instruction is doing too many things, and that's making your code harder to debug than it needs to be.</p>\n\n<p>Introduce a variable.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim shellCommand As String\nshellCommand = exePath &amp; \" \" &amp; scriptPath &amp; \" \" &amp; workbook_folder &amp; \" \" &amp; workbook_name\n\nDebug.Print shellCommand\nStop ' validate the string in the immediate pane, tweak double quotes, fix, F5 to resume execution\n\nshell.Run shellCommand\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "is_accepted": false, "score": 0, "last_activity_date": 1573738373, "creation_date": 1573738373, "answer_id": 58858009, "question_id": 58823027, "link": "https://stackoverflow.com/questions/58823027/passing-arguments-with-spaces-to-python-script-in-vba/58858009#58858009", "title": "Passing arguments with spaces to python script in VBA", "body": "<p>I reviewed the syntax and I solved it as follow:</p>\n\n<pre><code>Dim workbook_folder As String\nDim workbook_name As String\n\nworkbook_folder = Application.ThisWorkbook.path\nworkbook_name = Application.ThisWorkbook.Name\n\n\nDim shell As Object\nDim exePath, scriptPath As String\n\nSet shell = VBA.CreateObject(\"Wscript.Shell\")\n\nexePath = \"\"\"&lt;fpth of python exe&gt;\"\"\"\nscriptPath = \"&lt;fpth of python script\"\n\nDim shellCommand As String\nshellCommand = exePath &amp; \" \" &amp; scriptPath &amp; \" \" &amp; \"\"\"\" &amp; workbook_folder &amp; \"\"\"\" &amp; \" \" &amp; \"\"\"\" &amp; workbook_name &amp; \"\"\"\"\n\nshell.Run shellCommand\n\n</code></pre>\n\n<p>Thanks for your help Mathieu!</p>\n"}], "owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573738373, "creation_date": 1573576781, "last_edit_date": 1573577360, "question_id": 58823027, "link": "https://stackoverflow.com/questions/58823027/passing-arguments-with-spaces-to-python-script-in-vba", "title": "Passing arguments with spaces to python script in VBA", "body": "<p>I am trying to pass two arguments to a python script in VBA and run it. </p>\n\n<p>The arguments are the workbook_folder and workbook_name, both of them contain spaces.</p>\n\n<p>The code below passes only the workbook_folder argument up to the first space to the python script and it does not pass the workbook_name argument. </p>\n\n<p>I have tried a few things but I cannot find a way to make it work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim workbook_folder As String\nDim workbook_name As String\n\nworkbook_folder = Application.ThisWorkbook.path\nworkbook_name = Application.ThisWorkbook.Name\n\n\nDim shell As Object\nDim exePath, scriptPath As String\n\nSet shell = VBA.CreateObject(\"Wscript.Shell\")\n\nexePath = \"\"\"&lt;fpth of python exe&gt;\"\"\"\nscriptPath = \"&lt;fpth of python script\"\n\nshell.Run exePath &amp; \" \" &amp; scriptPath &amp; \" \" &amp; workbook_folder &amp; \" \" &amp; workbook_name\n</code></pre>\n"}, {"tags": ["excel", "vba", "compilation"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573575495, "post_id": 58822594, "comment_id": 103922157, "body": "Google the error :) <code>Next ws</code> for example <code>ws</code> doesn&#39;t have a loop"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573575988, "post_id": 58822594, "comment_id": 103922430, "body": "Consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to make nested structures look... nested. It tends to help with lining up beginning &amp; end of code blocks."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1573575997, "post_id": 58822594, "comment_id": 103922437, "body": "Proper indenting would help you track down the syntax error.  Hint:  you are missing a <code>Next</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573576075, "post_id": 58822594, "comment_id": 103922481, "body": "FWIW there&#39;s no need to have <code>ws</code> (or anything) in <code>Next ws</code>: just <code>Next</code> is enough."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573576386, "post_id": 58822594, "comment_id": 103922681, "body": "@MathieuGuindon - Shouldn&#39;t <code>Next ws</code> throw an error? The for loop that starts it is <code>For each Cell</code>...Or does VBA actually ignore whatever comes after <code>Next</code>?  (I always typically include the <code>Next</code> variable, e.g. <code>Next ws &#47; Next Cell</code>, so I can readily see what loop I&#39;m in, but never really considered if VBA actually &quot;uses&quot; that info or not."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1573576640, "post_id": 58822594, "comment_id": 103922827, "body": "@BruceWayne yes, <code>Next ws</code> is a syntax error, because <code>ws</code> isn&#39;t a loop variable. I never specify the loop variable in <code>Next</code>, because if that loop variable has any value being there, then the loop body is likely doing too many things and should be refactored into its own procedure scope. There&#39;s syntactically only ever one single loop variable that&#39;s legal immediately after a <code>Next</code> token, and that&#39;s the loop variable for the loop that was last entered. This <code>Next foo</code> syntax exists only to support the sheer abomination that <code>Next foo, bar</code> is."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573582547, "post_id": 58822594, "comment_id": 103925619, "body": "@MathieuGuindon - Thanks for that! I hesitate to ask what <code>Next foo, bar</code> even could be? Is that a valid construction in VBA, if abominatious ..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1573584846, "post_id": 58822594, "comment_id": 103926636, "body": "@BruceWayne <code>For foo = 1 To 10</code>; <code>For bar = 1 To 10</code>; <code>Debug.Print foo, bar</code>; <code>Next foo, bar</code> -- believe it or not, that&#39;s legal! (<code>thingsLearnedWhileWorkingOnRubberduck++;</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1573577117, "creation_date": 1573577117, "answer_id": 58823131, "question_id": 58822594, "link": "https://stackoverflow.com/questions/58822594/vba-for-if-then-else-statement/58823131#58823131", "title": "VBA for if -then- else statement", "body": "<p>Don't put a loop variable after the <code>Next</code> keyword, it's useless. The only thing it can do, is make VBA throw a compiler error if you use the wrong loop variable - as is the case here. If there's so much code in the a loop body that you no longer know where you're at by the time you reach the bottom, then the loop body is doing too many things. The solution is to pull code from the loop body into smaller, more specialized procedures.</p>\n\n<p>Use an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> if you aren't sure how to properly indent your code: it makes this kind of syntax error blatantly obvious:</p>\n\n<pre><code>Dim c As Range\nDim ws As Worksheet: Set ws = Sheet2\nDim range1 As Range: Set range1 = ws.Range(\"Q13\")\nDim Cell As Range\n\nFor Each Cell In range1\n|   If Cell.Value = \"45\" Then\n|   |   NextRow = ws.Cells(ws.Rows.Count, \"P\").End(xlUp).Offset(1, 0).Row\n|   |   Cell.Copy ws.Range(\"P\" &amp; NextRow)\n|   Else\n|   |   For Each c In Range(\"B2:B\" &amp; Range(\"B65536\").End(xlUp).Row)\n|   |   |   Dim R As Range\n|   \\   |   Set R = Worksheets(\"Sheet2\").Cells(Rows.Count, \"E\").End(xlUp) 'last cell in Column E with data\n\\   |\\  /   If Len(R.Value) &gt; 0 Then Set R = R.Offset(1)\n \\  | \\/    R.Value = Worksheets(\"Sheet2\").Range(\"Q13\").Value\n  \\ / /\\    Exit For\n   /\\/  End If\n  / Next\nEnd If\n</code></pre>\n\n<p>The <code>If...Else...End If</code> block is terminated with a <code>Next</code>; the inner <code>For Each...Next</code> loop is terminated with an <code>End If</code>, and the outer <code>For Each...Next</code> loop is terminated with <code>End If</code> - you need to de-tangle this.</p>\n\n<pre><code>Dim c As Range\nDim ws As Worksheet: Set ws = Sheet2\nDim range1 As Range: Set range1 = ws.Range(\"Q13\")\nDim Cell As Range\n\nFor Each Cell In range1\n    If Cell.Value = \"45\" Then\n        NextRow = ws.Cells(ws.Rows.Count, \"P\").End(xlUp).Offset(1, 0).Row\n        Cell.Copy ws.Range(\"P\" &amp; NextRow)\n    Else\n        For Each c In Range(\"B2:B\" &amp; Range(\"B65536\").End(xlUp).Row)\n            Dim R As Range\n            Set R = Worksheets(\"Sheet2\").Cells(Rows.Count, \"E\").End(xlUp) 'last cell in Column E with data\n            If Len(R.Value) &gt; 0 Then Set R = R.Offset(1)\n            R.Value = Worksheets(\"Sheet2\").Range(\"Q13\").Value\n            Exit For\n        Next\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10177128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53cd9fdb880b610d6992e68a943d50de?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremie Tomkins", "link": "https://stackoverflow.com/users/10177128/jeremie-tomkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573577117, "creation_date": 1573575247, "last_edit_date": 1573575280, "question_id": 58822594, "link": "https://stackoverflow.com/questions/58822594/vba-for-if-then-else-statement", "title": "VBA for if -then- else statement", "body": "<p>Below is code that I came up which copies values from cell Q13, and pastes them into column E until the list is complete (Q13 is updated with a new value each time). I have a condition which says if Q13 reads \"45\" copy that value and paste it into the p column. I know this an  if -then- else statment, but I get a couple different compile errors (block if without end if, and if without block if) and realize it's most likely my syntax. If someone could review this that would be fantastic. </p>\n\n<pre><code>Sub Test()\nDim c As Range\nDim ws As Worksheet: Set ws = Sheet2\nDim range1 As Range: Set range1 = ws.Range(\"Q13\")\nDim Cell As Range\n\nFor Each Cell In range1\nIf Cell.Value = \"45\" Then\n    NextRow = ws.Cells(ws.Rows.Count, \"P\").End(xlUp).Offset(1, 0).Row\n    Cell.Copy ws.Range(\"P\" &amp; NextRow)\n    Else\n For Each c In Range(\"B2:B\" &amp; Range(\"B65536\").End(xlUp).Row)\nDim R As Range\nSet R = Worksheets(\"Sheet2\").Cells(Rows.Count, \"E\").End(xlUp) 'last cell in Column E with data\n If Len(R.Value) &gt; 0 Then Set R = R.Offset(1)\nR.Value = Worksheets(\"Sheet2\").Range(\"Q13\").Value\nExit For\nEnd If\nNext ws\nEnd If\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "iframe", "web-scraping"], "comments": [{"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1573587589, "post_id": 58822560, "comment_id": 103927788, "body": "Updated.  Thank you again."}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1573592764, "post_id": 58822560, "comment_id": 103929914, "body": "Sorry new to HTML.  I&#39;ve edited the paste  I think I pasted it the way you need it."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573655225, "post_id": 58826566, "comment_id": 103952799, "body": "Tried to implement this to no avail. Did you see anything else I&#39;m missing after the new HTML paste?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573659585, "post_id": 58826566, "comment_id": 103955279, "body": "The html still doesn\u2019t seem valid. As an aside, can you give me more detail about tried to implement to no avail. What happened? Error messages?"}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573672767, "post_id": 58826566, "comment_id": 103961971, "body": "Hmm ok, not sure what I&#39;m omitting with the copy/paste.  I get a compile error on .document of line 2, invalid or unqualified reference."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573673260, "post_id": 58826566, "comment_id": 103962196, "body": "can you paste the line here? There should be oIE in front of the .document"}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573681508, "post_id": 58826566, "comment_id": 103965807, "body": "Yup did it both ways.  Error without oIE, nothing happens with.  Dim evt As Object Set evt = oIE.document.createEvent(&quot;HTMLEvents&quot;) evt.initEvent &quot;mousedown&quot;, True, False  oIE.document.querySelector(&quot;[vjs*=VxApprovable_Approve]&quot;).di&zwnj;&#8203;spatchEvent"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573683636, "post_id": 58826566, "comment_id": 103966657, "body": "so that means it is selecting the element. It may mean another event needs to happen. You can view the associated events under event listeners in dev tools F12 when you right click inspect the target element you are clicking for option."}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573685526, "post_id": 58826566, "comment_id": 103967347, "body": "Got it, either IE11 doesn&#39;t have an event listener option or this particular app has it blocked.  Looking still."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573687395, "post_id": 58826566, "comment_id": 103967843, "body": "I\u2019d use chrome to inspect"}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573691879, "post_id": 58826566, "comment_id": 103968903, "body": "Yeah I&#39;ve seen that peppered everywhere.  Unfortunately the application can&#39;t be opened in Chrome.  It auto closes the tab and opens in IE when you try.  I appreciate your continued communication on this."}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573692716, "post_id": 58826566, "comment_id": 103969082, "body": "Noticing as I&#39;m stepping through the code evt = nothing"}, {"owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573695747, "post_id": 58826566, "comment_id": 103969716, "body": "As I&#39;ve been researching.  I found something that worked...which you had previously posted last year!   oIE.document.parentWindow.execScript &quot;my script here&quot;, &quot;javascript&quot;  - it worked!  Thank you QHarr"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573696700, "post_id": 58826566, "comment_id": 103969916, "body": "No worries. Glad you got there!  If you indicate which answer I will close this as duplicate."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "edited": false, "score": 0, "creation_date": 1573698373, "post_id": 58826566, "comment_id": 103970276, "body": "Ah ok... not such a clear duplicate. You can post your own answer here and accept it within two days."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1573593070, "last_edit_date": 1573593070, "creation_date": 1573592322, "answer_id": 58826566, "question_id": 58822560, "link": "https://stackoverflow.com/questions/58822560/clicking-a-drop-down-option-in-iframe-with-vba-excel/58826566#58826566", "title": "Clicking a drop down option in iFrame with VBA excel", "body": "<p>Looks like tr is outside an iframe and has a mousedown event you can try attaching and firing. I'm targeting the vjs attribute of the tr.</p>\n\n<pre><code>Dim evt As Object\nSet evt = .document.createEvent(\"HTMLEvents\")\nevt.initEvent \"mousedown\", True, False\n\noIE.document.querySelector(\"[vjs*=VxApprovable_Approve]\").dispatchEvent evt\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12340970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ff0202293b6a754d2271898ce5713?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Falbo", "link": "https://stackoverflow.com/users/12340970/anthony-falbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573593070, "creation_date": 1573575104, "last_edit_date": 1573592716, "question_id": 58822560, "link": "https://stackoverflow.com/questions/58822560/clicking-a-drop-down-option-in-iframe-with-vba-excel", "title": "Clicking a drop down option in iFrame with VBA excel", "body": "<p>I'm trying to click the drop down option \"Approve the Deal\" in the below code.  I have solid VBA backround but this is my first attempt at HTML automation with VBA excel.  Thus far I'm able to navigate and login to the website, select the deal that needs to be approved, and show the drop down.  However, I cannot figure out how to click the drop down option/trigger the event.  I believe my gaps are dealing with the iFrame and/or table (something I did not have to deal with in the code to this point)</p>\n\n<p>I have tested a lot of different web found code so I won't regurgitate every copy/pasted modied failure I've had.  Below is the code I'm attempting to interact with. The \"Approve the Deal\" is what I'm trying to click/trigger.</p>\n\n<p>Thank you in advance for any advice you could provide!</p>\n\n<p>Edited to include HTML and my code below.  I have been deleting non working things and just plugging and playing different options.  The piece I identified is likely very wrong.</p>\n\n<pre><code>    &lt;IFRAME id=VCommonBlockerVxActionMenu_68_SUPPORT style=\"BORDER-TOP: 0px; HEIGHT: 62px; BORDER-RIGHT: 0px; WIDTH: 98px; BORDER-BOTTOM: 0px; POSITION: absolute; LEFT: 1402px; FILTER: progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0); BORDER-LEFT: 0px; Z-INDEX: 12; DISPLAY: block; TOP: 98px; BACKGROUND-COLOR: #ffffff; 0: \" src=\"javascript:false\" frameBorder=0 scroll=\"no\"&gt;&lt;/IFRAME&gt;\n\n&lt;DIV id=VxActionMenu_68_SUPPORT class=VDropDown_support style=\"HEIGHT: 62px; WIDTH: 98px; LEFT: 1402px; Z-INDEX: 13; DISPLAY: inline; TOP: 98px\"&gt;&lt;TABLE id=VxActionMenu_68_OPTIONS class=VDropDown_options style=\"WIDTH: 100%\" cellSpacing=0 cellPadding=0 border=0&gt;\n&lt;COLGROUP&gt;\n&lt;COL width=22&gt;&lt;/COL&gt;\n&lt;COL width=\"100%\"&gt;&lt;/COL&gt;\n&lt;COL width=22&gt;&lt;/COL&gt;\n&lt;TBODY&gt;\n&lt;TR onmouseover=VPage.VxActionMenu_68.hilite(event); onmousedown=VPage.VxActionMenu_68.select(event); class=\"VDropDown_hiderow VDropDown_option\" vvalue=\"null\"&gt;\n&lt;TD class=VDropDown_leftimg&gt;&amp;nbsp;&lt;/TD&gt;\n&lt;TD class=VDropDown_option&gt;More Actions&lt;/TD&gt;\n&lt;TD class=VDropDown_rightimg&gt;&amp;nbsp;&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR onmouseover=VPage.VxActionMenu_68.hilite(event); onmousedown=VPage.VxActionMenu_68.select(event); class=\"VDropDown_option VDropDown_select\" vfixed=\"true\" vupdateLabel=\"true\" vjs=\"VxManager.invokeActionHandler('vx.actions.VxAgreement_CommitHandler,vx.actions.VxApprovable_Approve',{statusMsg: 'Approving...'}, {vx_wsid: 'WS3',okHandler:'vx.actions.VxAgreement_CommitHandler,vx.actions.VxApprovable_Approve',showDialog:'true',statusMsg:'Approving...'});\"&gt;\n&lt;TD title=\"Approve the Deal\" class=VDropDown_option colSpan=2&gt;&lt;NOBR&gt;Approve&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD class=VDropDown_rightimg&gt;&lt;IMG src=\"http://venprd.na.odcorp.net/vendavo/images/icons/clear.gif\" width=16 align=absBottom height=1&gt;&lt;/IMG&gt;&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR onmouseover=VPage.VxActionMenu_68.hilite(event); onmousedown=VPage.VxActionMenu_68.select(event); class=VDropDown_option vfixed=\"true\" vupdateLabel=\"true\" vjs=\"VxManager.invokeActionHandler('vx.actions.VxAgreement_CommitHandler,vx.actions.VxApprovable_Deny',{statusMsg: 'Denying...'}, {vx_wsid: 'WS3',okHandler:'vx.actions.VxAgreement_CommitHandler,vx.actions.VxApprovable_Deny',showDialog:'true',statusMsg:'Denying...'});\"&gt;\n&lt;TD title=\"Deny the Deal\" class=VDropDown_option colSpan=2&gt;&lt;NOBR&gt;Deny&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD class=VDropDown_rightimg&gt;&lt;IMG src=\"http://venprd.na.odcorp.net/vendavo/images/icons/clear.gif\" width=16 align=absBottom height=1&gt;&lt;/IMG&gt;&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR onmouseover=VPage.VxActionMenu_68.hilite(event); onmousedown=VPage.VxActionMenu_68.select(event); class=VDropDown_option vfixed=\"true\" vupdateLabel=\"true\" vjs=\"VxManager.invokeActionHandler('vx.publishing.VxPublishingDocActions_OpenOrNew',{statusMsg: 'Publishing...'}, {vx_wsid: 'WS3'});\"&gt;\n&lt;TD title=\"Create a document from the deal\" class=VDropDown_option colSpan=2&gt;&lt;NOBR&gt;Publish&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD class=VDropDown_rightimg&gt;&lt;IMG src=\"http://venprd.na.odcorp.net/vendavo/images/icons/clear.gif\" width=16 align=absBottom height=1&gt;&lt;/IMG&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;/DIV&gt;\n</code></pre>\n\n<p>I have another working sub to navigate to the website and login.</p>\n\n<pre><code>Sub VendavoApprove()\n    Dim elmButton As MSHTML.IHTMLElement\n\n    'Activate previously opened Vendavo page\n    'Set shellWins = New SHDocVw.ShellWindows\n\n    'For Each explorer In shellWins\n    'If explorer.Name = \"Internet Explorer\" Then\n    'Debug.Print explorer.LocationURL\n    'Debug.Print explorer.LocationName\n    'End If\n    'Next\n\n    'Set shellWins = Nothing\n    'Set explorer = Nothing\n\n    AppTitle = \"Powered by Vendavo\"\n\n    AppActivate AppTitle\n\n    Set oApp = CreateObject(\"Shell.Application\")\n\n    For i = 0 To 25\n\n        strName = \"\"\n\n        On Error Resume Next\n\n        strName = oApp.Windows(i).document.URL\n\n        If InStr(strName, \"http://venprd.na.odcorp.net/vendavo/pc?page=vx.core.BasicPage&amp;menuId=deals&amp;folderId=quotes\") Then\n\n            Set oIE = oApp.Windows(i)\n\n            Exit For\n\n        End If\n\n    Next\n\n    oIE.Visible = True\n\n    oIE.document.all(\"VTree_VxFolderNav_deals.13.icon\").Click\n    oIE.document.all(\"table_VxCanvasListing_inner_1_COL_1_FILTER\").Click\n    oIE.document.all(\"table_VxCanvasListing_inner_COL_1_FILTER\").Click\n    oIE.document.all(\"table_VxCanvasListing_inner_1_FILTER_VALUE1\").Value = 9792365\n    oIE.document.all(\"table_VxCanvasListing_inner_FILTER_VALUE1\").Value = 9792365\n    oIE.document.all(\"id1_label\").Click\n    oIE.document.all(\"table_VxCanvasListing_inner_1$x0_ROWHDR\").Click\n    'oIE.document.all(\"table_VxCanvasListing_inner_1_ActionMenus_LABEL\").Click\n    oIE.document.all(\"table_VxCanvasListing_inner_1$x0_1\").FireEvent \"ondblclick\", 1, 2\n    oIE.document.all(\"table_VxCanvasListing_inner$x0_1\").FireEvent \"ondblclick\", 1, 2\n    oIE.document.getElementById(\"VxActionMenu_68_LABEL\").Click 'Dynamic\n    oIE.document.getElementById(\"VxActionMenu_67_LABEL\").Click 'Dynamic\n    oIE.document.getElementById(\"VxActionMenu_237_LABEL\").Click 'Dynamic\n    'Approve the core - this is the part I'm working on\n    Set htm = oIE.document.frames(\"VCommonBlockerVxActionMenu_68_SUPPORT\").document\n    Set frms = htm.forms(\"TargetForm\")\n    Set Class1 = frms.document.getElementsByTagName(\"VxActionMenu_68_OPTIONS\")\n\n    For Each inputelement In Class1\n        If inputelement.getAttribute(\"title\") = \"Approve the Deal\" Then\n            inputelement.Click\n            Exit For\n        End If\n    Next\n    'ending here\n    oIE.document.all(\"VxApprovableComments_71_COMMENT\").Value = \"Approved\"\n    oIE.document.all(\"id1_label\").Click\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 2, "creation_date": 1573575474, "post_id": 58822524, "comment_id": 103922152, "body": "<code>For i = -7 to -1</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573576152, "post_id": 58822524, "comment_id": 103922529, "body": "Consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to make nested structures look nested. This tends to enhance readability and makes it much easier to track which block starts &amp; ends where."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1573576344, "post_id": 58822524, "comment_id": 103922647, "body": "Looking at your code I&#39;d recommend a <code>AutoFilter</code> and ditch the looping. Right now you are iterating over your range like 7 times which can be avoided."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1573640358, "post_id": 58822524, "comment_id": 103944698, "body": "@jsheeran can you be more specific as to where exactly I&#39;d add this line in my code or which line would I replace?"}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1573640541, "post_id": 58822878, "comment_id": 103944781, "body": "hi, I have tried to replace Date -7 with dayNumber but unfortunately it didn&#39;t work."}, {"owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "edited": false, "score": 0, "creation_date": 1573763731, "post_id": 58822878, "comment_id": 104001596, "body": "Welcome to the stackoverflow @mrAnalyzers"}], "tags": [], "owner": {"reputation": 11, "user_id": 12361598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f0eb5c5d598eb54a9aca099a8fd81a?s=128&d=identicon&r=PG&f=1", "display_name": "mrAnalyzers", "link": "https://stackoverflow.com/users/12361598/mranalyzers"}, "is_accepted": false, "score": 1, "last_activity_date": 1573673867, "last_edit_date": 1573673867, "creation_date": 1573576235, "answer_id": 58822878, "question_id": 58822524, "link": "https://stackoverflow.com/questions/58822524/vba-how-to-loop-date-search-for-7-days-day-after-day/58822878#58822878", "title": "VBA: How to loop date search for 7 days (day after day)?", "body": "<p>If Cell.Value = Date - 7 Then\ny.Range(\"AW\" &amp; list) = Cell.Offset(0, 1).Value</p>\n\n<p>End If</p>\n\n<p>could change to:</p>\n\n<pre><code>dim dayNumber as integer\nfor dayNumber = 7 to 1 step -1\n   If Cell.Value = Date - dayNumber Then\n       y.Range(\"AW\" &amp; list) = Cell.Offset(0, 1).Value\n   end if\nnext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "is_accepted": true, "score": 1, "last_activity_date": 1573736770, "creation_date": 1573736770, "answer_id": 58857521, "question_id": 58822524, "link": "https://stackoverflow.com/questions/58822524/vba-how-to-loop-date-search-for-7-days-day-after-day/58857521#58857521", "title": "VBA: How to loop date search for 7 days (day after day)?", "body": "<p>have a go with this one:</p>\n\n<pre><code>Sub bbb()\n\nApplication.ScreenUpdating = False: Application.EnableEvents = False\n\nDim Cell, cRange As Range: Dim list As Long\nDim test, databse As Workbook: Dim x, y As Worksheet\nDim i As Integer\n\n'open if closed &lt;&lt;&lt; I assume you would like to open one (or both) of the workbooks if it's closed?\n'if so, the following paragraphs will help:\n\nOn Error Resume Next: Set test = Workbooks(\"empty.csv\")\n   If Err &lt;&gt; 0 Then Workbooks.Open \"C:\\empty.csv\"\n      End If: On Error GoTo 0\n\nOn Error Resume Next: Set databse = Workbooks(\"empty1.csv\")\n   If Err &lt;&gt; 0 Then: Workbooks.Open \"C:\\empty1.csv\"\n      End If: On Error GoTo 0\n\nFor i = -7 To -1\n         Set test = Workbooks(\"empty.csv\"): Set x = test.Sheets(1)\n         Set database = Workbooks(\"empty1.csv\"): Set y = database.Sheets(\"Data\")\n         list = y.Cells(Rows.Count, \"AW\").End(xlUp).Row + 1\n\nSet cRange = x.Range(\"B1:B1200\")\n      For Each Cell In cRange\n         If Cell.Value = Date + i Then\n            y.Range(\"AW\" &amp; list) = Cell.Offset(0, 1).Value\n         End If\n      Next Cell\nNext i\n\nApplication.ScreenUpdating = True: Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 58857521, "answer_count": 2, "score": 1, "last_activity_date": 1573736770, "creation_date": 1573574970, "last_edit_date": 1573576096, "question_id": 58822524, "link": "https://stackoverflow.com/questions/58822524/vba-how-to-loop-date-search-for-7-days-day-after-day", "title": "VBA: How to loop date search for 7 days (day after day)?", "body": "<p>I have written the following code:</p>\n\n<pre><code>Sub bbb()\nDim Cell, cRange As Range: Dim list As Long\nDim test, databse As Workbook: Dim x, y As Worksheet\n\n'open if closed\n\nSet test = Workbooks(\"test.xlsx\")\nSet x = test.Sheets(1)\n\nSet database = Workbooks(\"xxx.xlsm\")\nSet y = database.Sheets(\"Data\")\n\nlist = y.Cells(Rows.Count, \"AW\").End(xlUp).Row + 1\n\nSet cRange = x.Range(\"b1:b1200\")\nFor Each Cell In cRange\n\nIf Cell.Value = Date - 7 Then\ny.Range(\"AW\" &amp; list) = Cell.Offset(0, 1).Value\n\nEnd If\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p>As you can see am pulling the value for TODAY minus 7 days. How can I create a loop to do -7, then -6, -5 ....until -1 ? One value after the other being added to the bottom of the <code>y.Range(\"AW\" &amp; list)</code></p>\n\n<p>Thanks\nWest</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573581659, "post_id": 58822506, "comment_id": 103925245, "body": "Lose the <code>.Select</code> and  probably also the <code>.CurrentRegion</code>"}, {"owner": {"reputation": 1, "user_id": 12362045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82034ddab6af900df1a444fd57f29a5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/12362045/rob"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573657529, "post_id": 58822506, "comment_id": 103954079, "body": "@TimWilliams worked first time. Thank you so much!!"}], "owner": {"reputation": 1, "user_id": 12362045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82034ddab6af900df1a444fd57f29a5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/12362045/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573576329, "creation_date": 1573574901, "last_edit_date": 1573576329, "question_id": 58822506, "link": "https://stackoverflow.com/questions/58822506/cant-fix-code-for-sorting-only-used-cells-in-a-range", "title": "Can&#39;t fix code for sorting only used cells in a range", "body": "<p>I have an incomplete table with a  lot of empty cells right now:\nHeader line Row 3\nData Cells A4:H13\nAs yet empty Cells which will be needed later A14:H38</p>\n\n<p>I am trying to create a macro to auto-sort the data based on Column B which is numerical (since I can't seem to record a macro automatically which lets me sort 'Largest to Smallest'??). So far I have the following:</p>\n\n<pre><code>Sub sortonmcols()\nlastRow = ActiveSheet.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nRange(\"A4:H\" &amp; lastRow).Select.CurrentRegion.Sort _\nkey1:=Range(\"B3\"), order1:=xlDescending, Header:=xlYes, _\nkey2:=Range(\"A3\"), order1:=xlAscending, Header:=xlYes\nEnd Sub\n</code></pre>\n\n<p>I had the simple sortonmcols working but it put all the empty cells to the top, so I found the lastRow code and added that in, and now when running it I get the Runtime Error 424: Object Required error. I'm not clear why, as I haven't changed the final two rows! </p>\n\n<p>Any help much appreciated!</p>\n\n<p>P.S. EDIT: An edit to the above, which I hadn't thought of: only Columns A and B are guaranteed to have content in for all the rows of data. Cols C-H have VLOOKUP formulae for all 34 rows already, but may not be showing any results for any given row.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 0, "creation_date": 1573576888, "post_id": 58821958, "comment_id": 103922962, "body": "If you inspect the last character of hlPageNo you will probably see it is a chr(13), i.e. you need to change the code to hlPageNo = &quot;p&quot; &amp; mid(cRng.Text, 1, Len(cRng.Text) - 2). If I do that, the code works here, i.e. inserts in column 6 not column 1. As an observation, your code will also go wrong when you reach iTableRow = tableRowCount because of the reference to iTableRow+1"}, {"owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "edited": false, "score": 0, "creation_date": 1573585814, "post_id": 58821958, "comment_id": 103927029, "body": "Thank you. That worked."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573640337, "post_id": 58821958, "comment_id": 103944688, "body": "@yokki Why don&#39;t you write the answer, please?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "is_accepted": true, "score": 0, "last_activity_date": 1573753071, "creation_date": 1573753071, "answer_id": 58862759, "question_id": 58821958, "link": "https://stackoverflow.com/questions/58821958/inserting-a-cross-reference-link-to-a-table-cell/58862759#58862759", "title": "Inserting a cross reference link to a table cell", "body": "<p>The problem is in this line:</p>\n\n<pre><code>hlPageNo = \"p\" &amp; mid(cRng.Text, 1, Len(cRng.Text) - 1)\n</code></pre>\n\n<p>which should be changed to this:</p>\n\n<pre><code>hlPageNo = \"p\" &amp; mid(cRng.Text, 1, Len(cRng.Text) - 2)\n</code></pre>\n\n<p>When a Word Range such as cRng is set to be the Range of a Table Cell, it always ends with the 2-character sequence ChrW(13) &amp; ChrW(7). Removing 1 character just removes the ChrW(7). So hlPageNo would always end in ChrW(13) which (a) would not match with any of the bookmark names in the document and (b) would not necessarily be obvious when debugging.</p>\n\n<p>Working with Word Table Cell ranges can be confusing because different code samples may show the range length being used without adjustment, or being reduced by 1 or even being reduced by 2, and it isn't immediately obvious why. For example, you can set the Text of a Cell's range without having to deal with those extra characters at all, e.g.</p>\n\n<pre><code>Dim r as Word.Range\nSet r = ActiveDocument.Tables(1).Cell(1,1).Range\nr.Text = \"abc\"\nSet r = Nothing\n</code></pre>\n\n<p>causes no problem. But if you want to add a field to the range and you try</p>\n\n<pre><code>Dim r as Word.Range\nSet r = ActiveDocument.Tables(1).Cell(1,1).Range\nr.Fields.Add r, WdFieldType.wdFieldEmpty, \"QUOTE \"\"abc\"\"\", False\nSet r = Nothing\n</code></pre>\n\n<p>you will get RunTime error 4605. To avoid that, you have to ensure that the Range does not include the ChrW(7) EndOfCell character, e.g. </p>\n\n<pre><code>Dim r as Word.Range\nSet r = ActiveDocument.Tables(1).Cell(1,1).Range\nr.End = r.End - 1\nr.Fields.Add r, WdFieldType.wdFieldEmpty, \"QUOTE \"\"abc\"\"\", False\nSet r = Nothing\n</code></pre>\n\n<p>and in that case it makes no difference if you use r.End = r.End - 2 either.</p>\n\n<p>Finally, there is another unrelated problem in the posted code which is when iTableRow reaches tableRowCount, </p>\n\n<pre><code>iTableRow + 1\n</code></pre>\n\n<p>will be larger than the number of rows in the table.</p>\n"}], "owner": {"reputation": 25, "user_id": 9169206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c459312c4db8eabb3967c6062f4b72a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kannan Rajan", "link": "https://stackoverflow.com/users/9169206/kannan-rajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58862759, "answer_count": 1, "score": 0, "last_activity_date": 1573753071, "creation_date": 1573573132, "last_edit_date": 1573604744, "question_id": 58821958, "link": "https://stackoverflow.com/questions/58821958/inserting-a-cross-reference-link-to-a-table-cell", "title": "Inserting a cross reference link to a table cell", "body": "<p>the following code works if the ReferenceItem is hard coded with bookmark name, but inserts the cross reference link the incorrect cell (inserts in cell(2, 1) instead of cell(2, 6). if i use hlpageNo as shown here then it throws an error. Not sure what i'm wrong here. Appreciate any support. Thanks. </p>\n\n<pre><code>Sub setMSPageCrossRef()\n  Dim iRng As Word.Range\n  Dim cRng As Word.Range\n  Dim iDoc As Word.Document\n  Dim tableRowCount, iTableRow, rownow As Long\n  Dim hlPageNo As String\n  Set iDoc = ActiveDocument\n  Set iRng = iDoc.Range    \n  iRng.Find.Text = \"Failure Mode\"\n\n  Do While iRng.Find.Execute(Forward:=True, Wrap:=wdFindStop) = True\n    Pageno = iRng.Information(wdActiveEndAdjustedPageNumber)\n    rowno = iRng.Information(wdEndOfRangeRowNumber)\n    Colno = iRng.Information(wdEndOfRangeColumnNumber)\n    tableRowCount = iRng.Tables(1).Range.Rows.Count\n    Call RemoveBlanksinTable(iRng.Tables(1).Range)\n\n    For iTableRow = rowno To tableRowCount\n        Set cRng = iRng.Tables(1).Cell(iTableRow + 1, 6).Range\n        hlPageNo = \"p\" &amp; mid(cRng.Text, 1, Len(cRng.Text) - 1)\n        cRng.Collapse wdCollapseStart        \n        cRng.InsertCrossReference ReferenceType:=\"Bookmark\", ReferenceKind:= _\n        wdPageNumber, ReferenceItem:=hlPageNo, InsertAsHyperlink:=True, _\n        IncludePosition:=False, SeparateNumbers:=False, SeparatorString:=\" \"\n    Next    \n  Loop    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573573623, "post_id": 58821696, "comment_id": 103921106, "body": "Code that works well but leaves you with a bad taste is likely better of posted on <a href=\"https://codereview.stackexchange.com\">Code Review</a>. That said, <code>AH:AN</code> looks like contiguous ranges, why not do <code>AH3:AN&quot; &amp; lastrow</code>? What is the <code>Interior.Color</code> you&#39;re copying over? Is it the same for all these cells? Consider including a screenshot of your worksheet, and give reviewers as much context as possible."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573573945, "post_id": 58821696, "comment_id": 103921278, "body": "Also unclear why you&#39;re asking about a conditional, when there&#39;s nothing conditional in your working code."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1573573668, "creation_date": 1573573668, "answer_id": 58822098, "question_id": 58821696, "link": "https://stackoverflow.com/questions/58821696/fill-down-header-interior-color-to-last-row-in-used-range/58822098#58822098", "title": "fill down header interior color to last row in used range?", "body": "<p>Since there's no real pattern to the columns (that I can see) you need something to set them up to loop or make them unique.</p>\n\n<p>In your case, it might make sense to name the columns you want to change. Then use intersect/usedrange to make changes in one motion.</p>\n\n<p>Example:</p>\n\n<pre><code>Sub quickExample()\nConst theNamedRanged As String = \"Bang\"\n\n    Dim ws As Worksheet, changrange As Range\n    Set ws = Sheets(\"file\")\n\n    Set changrange = Intersect(ws.Range(\"A2:zz999999\"), ws.Range(theNamedRanged), ws.UsedRange)\n\n    'then do what you need with the range.\n    changerange.Interior.Color = xlBOOM\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 12080212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b330125a4e9269e6b5f3facfb651ca77?s=128&d=identicon&r=PG&f=1", "display_name": "NidenK", "link": "https://stackoverflow.com/users/12080212/nidenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573573668, "creation_date": 1573572247, "last_edit_date": 1573573275, "question_id": 58821696, "link": "https://stackoverflow.com/questions/58821696/fill-down-header-interior-color-to-last-row-in-used-range", "title": "fill down header interior color to last row in used range?", "body": "<p>I wrote some code in order to filldown header interior colors to only the lastrow in my used range. It works fine, but I feel like there has to be a more elegant way of doing this instead of having this massive block of code. </p>\n\n<pre><code>Option Explicit\n\nSub FillColors()\n\n    Dim wb As Workbook\n    Set wb = Workbooks(\"Template.xlsx\")\n    Dim lastrow As Long\n    Dim rng As range\n\n\n\n    With wb.Sheets(\"File\")\n\n    lastrow = .range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    .range(\"AH3:AI\" &amp; lastrow).Interior.Color = .range(\"AH2:AI2\").Interior.Color\n    .range(\"AJ3:AL\" &amp; lastrow).Interior.Color = .range(\"AJ2:AL2\").Interior.Color\n    .range(\"AM3:AN\" &amp; lastrow).Interior.Color = .range(\"AM2:AN2\").Interior.Color\n    .range(\"AO3:AO\" &amp; lastrow).Interior.Color = .range(\"AO2\").Interior.Color\n    .range(\"AX3:AX\" &amp; lastrow).Interior.Color = .range(\"AX2\").Interior.Color\n    .range(\"AY3:AY\" &amp; lastrow).Interior.Color = .range(\"AY2\").Interior.Color\n    .range(\"BC3:BD\" &amp; lastrow).Interior.Color = .range(\"BC2:BD2\").Interior.Color\n    .range(\"BF3:BF\" &amp; lastrow).Interior.Color = .range(\"BF2\").Interior.Color\n    .range(\"BG3:BG\" &amp; lastrow).Interior.Color = .range(\"BG2\").Interior.Color\n    .range(\"BK3:BL\" &amp; lastrow).Interior.Color = .range(\"BK2:BL2\").Interior.Color\n\n    Set rng = .range(\"A3:BP\" &amp; lastrow)\n\n        With rng.Borders\n            .LineStyle = xlContinuous\n            .Color = vbBlack\n            .Weight = xlThin\n        End With\n\n    End With\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Is there an easier way of doing this by implementing an <code>if cell.interior &lt;&gt; blank Then filldown interior</code> or something like that?</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1573572403, "post_id": 58821646, "comment_id": 103920432, "body": "Did you try the macro recorder to see how the code would look like? And actually you <b>must not</b> format your dates. Instead filter for their value <code>cDbl(Now() + 5)</code> formatted filter on dates don&#39;t work, because <code>Format()</code> returns a string. And strings cannot work with <code>&gt;</code> or <code>&lt;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 12093744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x8R4bYRFLPI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd66ISv07cIsEylWlQPY8GlwkIp5w/photo.jpg?sz=128", "display_name": "SB_VB", "link": "https://stackoverflow.com/users/12093744/sb-vb"}, "is_accepted": false, "score": 1, "last_activity_date": 1573575212, "creation_date": 1573575212, "answer_id": 58822586, "question_id": 58821646, "link": "https://stackoverflow.com/questions/58821646/autofilter-for-multiple-columns-in-excel-vba/58822586#58822586", "title": "Autofilter for multiple columns in excel VBA", "body": "<p>this gave me an answer</p>\n\n<pre><code>Worksheets(\"Demo_Sheet\").Activate\nSelection.AutoFilter\nActiveSheet.Range(\"A1\").AutoFilter field:=8, Criteria1:=\"&lt;=\" &amp; Format(Now() + 5, \"m/d/yyyy\"), Criteria2:=\"&gt;=\" &amp; Format(Now() - 5, \"m/d/yyyy\"), Operator:=xlAnd\nActiveSheet.Range(\"A1\").AutoFilter field:=9, Criteria1:=\"&gt;=.95\"\nRange(\"A1\").CurrentRegion.Copy\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12093744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x8R4bYRFLPI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd66ISv07cIsEylWlQPY8GlwkIp5w/photo.jpg?sz=128", "display_name": "SB_VB", "link": "https://stackoverflow.com/users/12093744/sb-vb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573575212, "creation_date": 1573572050, "last_edit_date": 1573572273, "question_id": 58821646, "link": "https://stackoverflow.com/questions/58821646/autofilter-for-multiple-columns-in-excel-vba", "title": "Autofilter for multiple columns in excel VBA", "body": "<p>Can you please let check what is the error in below vba macro? Trying to autofilter two columns based on \ncriteria. I am not able to filter field 8 and field 9 based on below code.</p>\n\n<pre><code>Worksheets(\"Demo_Sheet\").Activate\nWith Worksheets(\"Demo_Sheet\").Range(\"A1\")\n.AutoFilter field:=8, Criteria1:=\"&lt;=\" &amp; Format(Now() + 5, \"m/d/yyyy\"), Criteria2:=\"&gt;=\" &amp; Format(Now() - 5, \"m/d/yyyy\"), Operator:=xlAnd\n.AutoFilter field:=9, Criteria1:=\"&gt;=.95\"\nEnd With\nRange(\"A1\").CurrentRegion.Copy\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1573571874, "post_id": 58821475, "comment_id": 103920132, "body": "You might benefit from reading  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a>. We need a bit more detailed information about where exactly you got stuck or errors."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1573571882, "post_id": 58821475, "comment_id": 103920139, "body": "Does this need to happen directly in Excel?  I.e., can you just direct the output of your <code>wmic</code> command into a text file and open in in Excel?  Or must it be triggered from within Excel?"}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1573572151, "post_id": 58821475, "comment_id": 103920310, "body": "Also, what you&#39;re trying to do appears to be discussed here: <a href=\"https://stackoverflow.com/questions/29505486/piping-the-output-of-a-shell-command-executed-in-vba-to-a-specific-shell/29509003\" title=\"piping the output of a shell command executed in vba to a specific shell\">stackoverflow.com/questions/29505486/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11234582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5BPGf5tTwVc/AAAAAAAAAAI/AAAAAAAAV1k/szIiqXLrHr8/photo.jpg?sz=128", "display_name": "Denis Santana", "link": "https://stackoverflow.com/users/11234582/denis-santana"}, "edited": false, "score": 0, "creation_date": 1573574892, "post_id": 58821741, "comment_id": 103921843, "body": "Great! With the code I have a text file in c:\\hostname.txt with content:   SerialNumber  (line 1)  6LF4VW2 (line 2)   I think I need a loop to get all the A:A items and send to text file only the second line of the command to get only the serial number.  Is it possible to have this result?"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "reply_to_user": {"reputation": 1, "user_id": 11234582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5BPGf5tTwVc/AAAAAAAAAAI/AAAAAAAAV1k/szIiqXLrHr8/photo.jpg?sz=128", "display_name": "Denis Santana", "link": "https://stackoverflow.com/users/11234582/denis-santana"}, "edited": false, "score": 0, "creation_date": 1573667624, "post_id": 58821741, "comment_id": 103959675, "body": "after the WshShell.run, u have to read the file, ignore the first line and get just the second line"}], "tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": 0, "last_activity_date": 1573572638, "last_edit_date": 1573572638, "creation_date": 1573572369, "answer_id": 58821741, "question_id": 58821475, "link": "https://stackoverflow.com/questions/58821475/retrieve-information-from-remote-computers-list/58821741#58821741", "title": "Retrieve information from remote computers list", "body": "<p>You can try this</p>\n\n<pre><code>Private Sub btn_WScript_CMD_Click()\n    Set WshShell = CreateObject(\"WScript.Shell\")\n    x = WshShell.Run(\"CMD.EXE /k wmic /node:node:Laptop01 bios get serialnumber &gt; c:\\PATH_TO_TXT_FILE\", 0, False)\nEnd Sub\n</code></pre>\n\n<p>it creates a text file silently and then you must read it and import the data to Excel.</p>\n"}], "owner": {"reputation": 1, "user_id": 11234582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5BPGf5tTwVc/AAAAAAAAAAI/AAAAAAAAV1k/szIiqXLrHr8/photo.jpg?sz=128", "display_name": "Denis Santana", "link": "https://stackoverflow.com/users/11234582/denis-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573574047, "creation_date": 1573571475, "last_edit_date": 1573574047, "question_id": 58821475, "link": "https://stackoverflow.com/questions/58821475/retrieve-information-from-remote-computers-list", "title": "Retrieve information from remote computers list", "body": "<p>I need to create Spreadsheet for retrieving information of remote computers list (A:A), by filling only first column with Machine Name and the Service Tag is automatically retrieved.</p>\n\n<pre><code>Machine Name | Service Tag\nLaptop01     | \nLaptop02     |\n</code></pre>\n\n<p>I just discovered how to execute cmd commands in Excel, but I need help to treat the data.</p>\n\n<pre><code>Private Sub btn_WScript_CMD_Click()\n    CreateObject(\"WScript.Shell\").Run \"CMD.EXE /k wmic /node:Laptop01 bios get serialnumber\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 753, "user_id": 7526564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9yKl.jpg?s=128&g=1", "display_name": "Vlado", "link": "https://stackoverflow.com/users/7526564/vlado"}, "is_accepted": false, "score": 0, "last_activity_date": 1573572060, "creation_date": 1573572060, "answer_id": 58821650, "question_id": 58821407, "link": "https://stackoverflow.com/questions/58821407/if-statement-in-vba-that-proceeded-incorrectly/58821650#58821650", "title": "IF statement in VBA that proceeded incorrectly", "body": "<p>Try this statement: </p>\n\n<pre><code>If ERDBDate &lt; DateAdd(\"d\", -2, Now()) then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 12361417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b16955e94a0b75962b98cb6a8e8dfb?s=128&d=identicon&r=PG&f=1", "display_name": "ClydeL", "link": "https://stackoverflow.com/users/12361417/clydel"}, "edited": false, "score": 1, "creation_date": 1573609493, "post_id": 58822486, "comment_id": 103934445, "body": "This makes sense, I&#39;ll give it a try. I&#39;m still a little confused why what I had worked ... until it didn&#39;t. Perhaps it&#39;s simplistic thinking but I was working under the assumption that if a statement didn&#39;t throw any errors and &quot;worked&quot; that it was good to go. I hope this is not something that is going to crop very frequently."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1573574846, "creation_date": 1573574846, "answer_id": 58822486, "question_id": 58821407, "link": "https://stackoverflow.com/questions/58821407/if-statement-in-vba-that-proceeded-incorrectly/58822486#58822486", "title": "IF statement in VBA that proceeded incorrectly", "body": "<p><em>DateDiff</em> is the proven method for comparing date and time. Or use <em>Date()</em> to have no time (with DateDiff however, that doesn't matter):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' check to see if data is out of date\nIf DateDiff(\"d\", ERDBDate, Date) &gt;= 2 Then\n   ' send notification of old data\nElse\n   ' send updated spreadsheets\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12361417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b16955e94a0b75962b98cb6a8e8dfb?s=128&d=identicon&r=PG&f=1", "display_name": "ClydeL", "link": "https://stackoverflow.com/users/12361417/clydel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58822486, "answer_count": 2, "score": 1, "last_activity_date": 1594349331, "creation_date": 1573571253, "last_edit_date": 1594349331, "question_id": 58821407, "link": "https://stackoverflow.com/questions/58821407/if-statement-in-vba-that-proceeded-incorrectly", "title": "IF statement in VBA that proceeded incorrectly", "body": "<p>I have an Access VBA Function that sends a number of emails containing updated Excel spreadsheets, but only if the underlying data has been updated recently. This piece has been working just fine until last night when if seems that the IF statement incorrectly compared the system date to the data date and sent emails using the older data instead of sending a warning email to the person responsible for correcting the issue of having old data.</p>\n\n<p>Access 2016 on a VM running Windows 10. The current data date is contained in a table and that date is correct. The system date is correct. Everything worked as it should except for comparing the dates. There were no failures or error codes generated.</p>\n\n<p>Boiled down to the trouble spot the code reads ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' check to see if data is out of date\nIf ERDBDate &lt; Now() - 2 Then\n   ' send notification of old data\nElse\n   ' send updated spreadsheets\nEnd If\n</code></pre>\n\n<p>Although my experience in coding is not that great, I have never seen an IF statement improperly evaluate like this. All I can assume is either I am using a \"shaky\" method of comparing the dates or there was some kind of hickup on the server side that caused an incorrect system date to be returned (does this even seem possible?). I would rather it be me then not being able to rely on something as \"simple\" as the system date.</p>\n\n<p>I have learned a tremendous amount from the answers and help posted on this site. Thanks for all your efforts!</p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1573571124, "post_id": 58821236, "comment_id": 103919655, "body": "ugh. can you just create a view in your database? that is some nasty SQL to render through VBA. Not impossible, but not fun to do. I can see just at first glance that you have no space before each <code>FROM</code>."}, {"owner": {"reputation": 778, "user_id": 5450577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ips5K.png?s=128&g=1", "display_name": "Aleksandar Zoric", "link": "https://stackoverflow.com/users/5450577/aleksandar-zoric"}, "edited": false, "score": 1, "creation_date": 1573571180, "post_id": 58821236, "comment_id": 103919692, "body": "Your CASE WHEN does not look right either I think.  Syntax I am used to is CASE  WHEN condition1 THEN result1."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1573572130, "post_id": 58821236, "comment_id": 103920296, "body": "Are you missing a space after <code>External_Sales</code> and <code>cd2</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573574074, "post_id": 58821236, "comment_id": 103921346, "body": "Store the SQL in a worksheet cell and read it from there - you can avoid all of that concatenation..."}, {"owner": {"reputation": 21, "user_id": 12361446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd33531b921086a49103caad4ecff28e?s=128&d=identicon&r=PG&f=1", "display_name": "RBL219", "link": "https://stackoverflow.com/users/12361446/rbl219"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573576028, "post_id": 58821236, "comment_id": 103922453, "body": "@Scott Holtzman You are right, issue was with  no spaces before from and one ampersand &amp; before virtual table q , so thank you for hint &amp; help :)"}], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 1, "last_activity_date": 1573571501, "last_edit_date": 1573571501, "creation_date": 1573571025, "answer_id": 58821339, "question_id": 58821236, "link": "https://stackoverflow.com/questions/58821236/why-am-i-getting-error-message-using-sql-in-vba-code/58821339#58821339", "title": "Why am I getting error message using SQL in vba code?", "body": "<p>Since you are not adding newline to your sql, you should at least add space after openig or before closing <code>\"</code>.<br>\nThe sql you posted concats into something messed.\nfor readibility I would suggest:</p>\n\n<pre><code>Dim sql as String\nsql = sql &amp; vbCRLF &amp; \"SELECT concat(q.CHSeries, q.CHNumber) as Chassino,q.Model, \"\nsql = sql &amp; vbCRLF &amp; \"Case q.BRANCH when '6' then 'branch 6' when '2' then 'branch 2'  Else 'XX' end Branch, \"\nsql = sql &amp; vbCRLF &amp; \"q.ORDER,q.indt  DeofInvoice,  q.invn Invoice_no, q.customer Customer, \"\nsql = sql &amp; vbCRLF &amp; \"(select coalesce(sum(amnt*ICVL),0) from lbr2 where pcno&lt;&gt;0 and q.order=orno) + (select coalesce(sum(amnt*ICVL),0) from parts2 where pcno&lt;&gt;0 and q.order=orno)+ \"\nsql = sql &amp; vbCRLF &amp; \"(select coalesce(sum(amnt*ICVL),0) from lbr1 where pcno&lt;&gt;0 and q.order=orno) + (select coalesce(sum(amnt*ICVL),0) from parts1 where pcno&lt;&gt;0 and q.order=orno) \"\nsql = sql &amp; vbCRLF &amp; \"Internal_Sales, \"\nsql = sql &amp; vbCRLF &amp; \"coalesce(case q.InvoiceCredit when 'F' then  (q.RetailwithV-q.V) else -1*(q.RetailwithV-q.V)end,0)  External_Sales \"\nsql = sql &amp; vbCRLF &amp; \"FROM (select VIN2, VIN3, PRDT, GNN2, orno,  indt, invn, ca30, itot, vx,cd2 \"\nsql = sql &amp; vbCRLF &amp; \"FROM HEADER1 , PARTS1 WHERE BRNN=header1.GNN2 AND ORNO=header1.ORNO union select VIN2, VIN3, PRDT, GNN2, orno,  indt, invn, ca30,  itot, vx,cd2 \"\nsql = sql &amp; vbCRLF &amp; \"FROM HEADER1, LBR1 WHERE BRNN=header1.GNN2 AND ORNO=header1.ORNO \"\nsql = sql &amp; vbCRLF &amp; \"Union select VIN2, VIN3, PRDT, GNN2, orno, indt, invn, ca30, itot, vx,cd2 \"\nsql = sql &amp; vbCRLF &amp; \"FROM HEADER2 , PARTS2 WHERE BRNN=header2.GNN2 AND ORNO=header2.ORNO union select VIN2, VIN3, PRDT, GNN2, orno, indt, invn, ca30,  itot, vx, cd2 \"\nsql = sql &amp; vbCRLF &amp; \"FROM HEADER2 , LBR2 WHERE BRNN=header2.GNN2 AND ORNO=header2.ORNO) \"\nsql = sql &amp; vbCRLF &amp; \"where indt ='2019-09-30'  order by branch \"\n\n    Set rs = con.Execute(sql)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12361446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd33531b921086a49103caad4ecff28e?s=128&d=identicon&r=PG&f=1", "display_name": "RBL219", "link": "https://stackoverflow.com/users/12361446/rbl219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1574185561, "answer_count": 1, "score": 0, "last_activity_date": 1573571501, "creation_date": 1573570693, "last_edit_date": 1573571261, "question_id": 58821236, "link": "https://stackoverflow.com/questions/58821236/why-am-i-getting-error-message-using-sql-in-vba-code", "closed_reason": "Not suitable for this site", "title": "Why am I getting error message using SQL in vba code?", "body": "<p>Can you please help me make this code run? I am getting an error</p>\n\n<blockquote>\n  <p>Token ( was not valid</p>\n</blockquote>\n\n<pre><code>con.Open strCon\nSet rs = con.Execute(\"SELECT concat(q.CHSeries, q.CHNumber) as Chassino,q.Model,\" &amp; _\n\"Case q.BRANCH when '6' then 'branch 6' when '2' then 'branch 2'  Else 'XX' end Branch,\" &amp; _\n\"q.ORDER,q.indt  DeofInvoice,  q.invn Invoice_no, q.customer Customer,\" &amp; _\n\"(select coalesce(sum(amnt*ICVL),0) from lbr2 where pcno&lt;&gt;0 and q.order=orno) + (select coalesce(sum(amnt*ICVL),0) from parts2 where pcno&lt;&gt;0 and q.order=orno)+\" &amp; _\n\"(select coalesce(sum(amnt*ICVL),0) from lbr1 where pcno&lt;&gt;0 and q.order=orno) + (select coalesce(sum(amnt*ICVL),0) from parts1 where pcno&lt;&gt;0 and q.order=orno)\" &amp; _\n\"Internal_Sales,\" &amp; _\n\"coalesce(case q.InvoiceCredit when 'F' then  (q.RetailwithV-q.V) else -1*(q.RetailwithV-q.V)end,0)  External_Sales\" &amp; _\n\"FROM (select VIN2, VIN3, PRDT, GNN2, orno,  indt, invn, ca30, itot, vx,cd2\" &amp; _\n\"FROM HEADER1 , PARTS1 WHERE BRNN=header1.GNN2 AND ORNO=header1.ORNO union select VIN2, VIN3, PRDT, GNN2, orno,  indt, invn, ca30,  itot, vx,cd2\" &amp; _\n\"FROM HEADER1, LBR1 WHERE BRNN=header1.GNN2 AND ORNO=header1.ORNO\" &amp; _\n\"Union select VIN2, VIN3, PRDT, GNN2, orno, indt, invn, ca30, itot, vx,cd2\" &amp; _\n\"FROM HEADER2 , PARTS2 WHERE BRNN=header2.GNN2 AND ORNO=header2.ORNO union select VIN2, VIN3, PRDT, GNN2, orno, indt, invn, ca30,  itot, vx, cd2\" &amp; _\n\"FROM HEADER2 , LBR2 WHERE BRNN=header2.GNN2 AND ORNO=header2.ORNO)  &amp; q (CHSeries, CHNumber, Model, BRANCH, ORDER,  indt, invn, customer, RetailwithV, V, InvoiceCredit)\" &amp; _\n\"where indt ='2019-09-30'  order by branch\")\n    For iCols = 0 To rs.Fields.Count - 1\n        Worksheets(\"Sheet1\").Cells(1, iCols + 1).Value = rs.Fields(iCols).Name\n    Next``` \n</code></pre>\n"}]