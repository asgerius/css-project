[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1565825979, "post_id": 57503275, "comment_id": 101475308, "body": "<code>Sht.Rows.Count</code>"}, {"owner": {"reputation": 3, "user_id": 11889845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8872752a1e72ce6383267012d8703449?s=128&d=identicon&r=PG&f=1", "display_name": "hunjah", "link": "https://stackoverflow.com/users/11889845/hunjah"}, "edited": false, "score": 0, "creation_date": 1565826496, "post_id": 57503275, "comment_id": 101475397, "body": "Thanks @TimWilliams. You&#39;re a legend!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1565825856, "creation_date": 1565825856, "answer_id": 57503275, "question_id": 57503250, "link": "https://stackoverflow.com/questions/57503250/need-to-copy-only-the-last-few-characters-of-a-string-and-automatically-move-to/57503275#57503275", "title": "Need to copy only the last few characters of a string and automatically move to the first empty row before copying data", "body": "<p>For example:</p>\n\n<pre><code>Sht.Cells(i + 1, 1).Value = Right(.Range(\"A16\").Value, 3) \n</code></pre>\n\n<p>Start on next empty row:</p>\n\n<pre><code>i = Sht.Cells(Rows.Count, 1).End(xlUp).Row + 1 \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11889845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8872752a1e72ce6383267012d8703449?s=128&d=identicon&r=PG&f=1", "display_name": "hunjah", "link": "https://stackoverflow.com/users/11889845/hunjah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565825856, "creation_date": 1565825546, "question_id": 57503250, "link": "https://stackoverflow.com/questions/57503250/need-to-copy-only-the-last-few-characters-of-a-string-and-automatically-move-to", "title": "Need to copy only the last few characters of a string and automatically move to the first empty row before copying data", "body": "<p>This is a two part issue:</p>\n\n<ol>\n<li><code>.Range(\"A16\").Copy Sht.Cells(i + 1, 1)\n.Range(\"A13\").Copy Sht.Cells(i + 1, 2)\n.Range(\"A14\").Copy Sht.Cells(i + 1, 3)</code></li>\n</ol>\n\n<p>This currently copies the entire content of one cell to another. I need only the last few characters (varies for each row). </p>\n\n<ol start=\"2\">\n<li>Everytime I run the macro, data is copied back to the beginning of the sheet. This sheet helps populate other sheets, and therefore I need to keep old data. How do I move to the first empty row before pasting any data when I run the macro?</li>\n</ol>\n\n<p>Here's my code\n` \n   Option Explicit</p>\n\n<pre><code>Sub LoopThroughDirectory()\n\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim MyFolder As String\nDim Sht As Worksheet, ws As Worksheet\nDim WB As Workbook\nDim i As Integer\nDim LastRow As Integer\n\nApplication.ScreenUpdating = False\n\nMyFolder = \"C:\\Users\\max\\Desktop\\\"\n\nSet Sht = Workbooks(\"Test.xlsm\").Sheets(\"Log\")\n\n'create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'get the folder object\nSet objFolder = objFSO.GetFolder(MyFolder)\ni = 1\n'loop through directory file and print names\nFor Each objFile In objFolder.Files\n    If LCase(Right(objFile.Name, 3)) = \"csv\" Then\n        'print file name\n\n        Workbooks.Open Filename:=MyFolder &amp; objFile.Name\n        Set WB = ActiveWorkbook\n\n        With WB\n            For Each ws In .Worksheets\n                Sht.Cells(i + 1, 1) = objFile.Name\n\n                With ws\n                    .Range(\"A16\").Copy Sht.Cells(i + 1, 1)\n                    .Range(\"A13\").Copy Sht.Cells(i + 1, 2)\n                    .Range(\"A14\").Copy Sht.Cells(i + 1, 3)\n                End With\n                i = i + 1\n            Next ws\n            .Close SaveChanges:=False\n        End With\n    End If\nNext objFile\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>`\nAny help is appreciated. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23, "user_id": 11607127, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8aw0CFcfEpg/AAAAAAAAAAI/AAAAAAAAkBs/Q6JYhI6LLPs/photo.jpg?sz=128", "display_name": "AJ Suarez", "link": "https://stackoverflow.com/users/11607127/aj-suarez"}, "edited": false, "score": 0, "creation_date": 1565825557, "post_id": 57503225, "comment_id": 101475241, "body": "Could it be a clue for you that the missing rows count (21) matches exactly the (21) rows over the table databodyrange? Why is it? How should I avoid this issue?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565828054, "post_id": 57503225, "comment_id": 101475651, "body": "You really should fully qualify your Range/Cells objects with a sheet variable to avoid confusion like this instead of relying on which worksheet/workbook is active at the time."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565834495, "post_id": 57503225, "comment_id": 101476689, "body": "Also see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select</a> and avoid using <code>Select</code>, <code>Selection</code>, <code>ActiveCell</code>, and <code>ActiveSheet</code>."}, {"owner": {"reputation": 23, "user_id": 11607127, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8aw0CFcfEpg/AAAAAAAAAAI/AAAAAAAAkBs/Q6JYhI6LLPs/photo.jpg?sz=128", "display_name": "AJ Suarez", "link": "https://stackoverflow.com/users/11607127/aj-suarez"}, "edited": false, "score": 0, "creation_date": 1565836352, "post_id": 57503225, "comment_id": 101476993, "body": "Thank you guys. Thing is they really paste data. It&#39;s very strange, later below in my script, I copy the range in Column X to pasteit right beside the first range, and it pastes as if I had copied the Column C. It&#39;s kind of getting the data according to same column position..."}], "owner": {"reputation": 23, "user_id": 11607127, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8aw0CFcfEpg/AAAAAAAAAAI/AAAAAAAAkBs/Q6JYhI6LLPs/photo.jpg?sz=128", "display_name": "AJ Suarez", "link": "https://stackoverflow.com/users/11607127/aj-suarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565825367, "creation_date": 1565825367, "question_id": 57503225, "link": "https://stackoverflow.com/questions/57503225/how-can-i-avoid-a-copy-paste-issue-which-misteriously-pastes-different-range-fro", "title": "How can I avoid a Copy/Paste issue which misteriously pastes different range from the copied one?", "body": "<p>Hello guys I'm here for a new question... For me, never seen like this before (Too misterious): Copy/Paste Data from temporary workbook 1 to a table in main workbook 2.</p>\n\n<p>I'm making a code to copy a specific range (A2:B100) with raw data from a temporary workbook to paste in a table databodyrange (A22:B120) on the main workbook.</p>\n\n<p>Here's the problem: 1st cell (in A2) in the copied range is not matching 1st cell in the table, but curiously, it misses the first 21 upper copied data rows.</p>\n\n<p>This usually is very simple: Basically, On the main workbook, I 1st reset my table (by removing all databodyrange rows), and then go to the other workbook, copy the range and then come back to my main workbook, select the table and paste the data.</p>\n\n<pre><code>    Sub CopyPaste()\n\n    'A few Variable declaration\n\n    'Copying range from the Rawdata workbook\n    Range(Cells(2, 1), Cells(2, 1).End(xlDown).Offset(0, 1)).Select\n    Selection.Copy\n    'Pasting range in the main workbook\n    LibroPpal.Activate\n    TablaDetalle.DataBodyRange.Select\n    ActiveCell.Select\n    ActiveSheet.Paste\n    End Sub\n</code></pre>\n\n<p>I was expecting to paste exactly my selection.</p>\n"}, {"tags": ["sql", "vba", "csv", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1565881456, "post_id": 57503644, "comment_id": 101491670, "body": "Yep, that was it. Thanks a lot!"}], "tags": [], "owner": {"reputation": 415, "user_id": 9729824, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MPost", "link": "https://stackoverflow.com/users/9729824/mpost"}, "is_accepted": true, "score": 1, "last_activity_date": 1565830023, "creation_date": 1565830023, "answer_id": 57503644, "question_id": 57503214, "link": "https://stackoverflow.com/questions/57503214/sorting-and-selecting-from-3-csv-files/57503644#57503644", "title": "Sorting and selecting from 3 CSV files", "body": "<p>I believe if this is an Access-like syntax you need parentheses like this:</p>\n\n<pre><code>FROM (HAPData.csv AS Data INNER JOIN HAPGoals.csv ON Data.id = Goals.hapid)\n           INNER JOIN HapActionSteps.csv AS Actions ON Goals.id = Actions.goalid\n</code></pre>\n"}], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 57503644, "answer_count": 1, "score": 0, "last_activity_date": 1594549818, "creation_date": 1565825245, "last_edit_date": 1594549818, "question_id": 57503214, "link": "https://stackoverflow.com/questions/57503214/sorting-and-selecting-from-3-csv-files", "title": "Sorting and selecting from 3 CSV files", "body": "<p>Every month I receive a data dump of several CSV files. Some of the files exceed the Microsoft Excel maximum rows, but I was able to use an ADODB recordset and connection to select and sort the files and only load the values I need. I can get it to work for two files, but in one case, I need it to go to three files, and there is the problem.</p>\n\n<p>The following code works for two files:</p>\n\n<pre><code>Dim cnD As New ADODB.Connection\ncnD.Provider = \"Microsoft.ACE.OLEDB.12.0\"\ncnD.ConnectionString = \"Data Source=\" + fullFolder + \";Extended Properties=\"\"text;HDR=Yes;\" + _\n        \"FMT=Delimited(,)\"\"\"\ncnD.Open\nDim rsD As New ADODB.Recordset\nrsD.ActiveConnection = cnD\nrsD.Source = \"SELECT Data.id AS HapDataId, Data.createtimestamp, \" + _\n                    \"Data.lastmodified, Goals.* \" + _\n        \"FROM HAPData.csv AS Data \" + _\n            \"INNER JOIN HAPGoals.csv AS Goals ON Data.Id = Goals.hapid \" + _\n        \"WHERE Format(Data.createtimestamp, \" + \"\"\"\" + \"yyyy-MM-dd\" + \"\"\"\" + \") &gt;= \" + _\n                    \"Format(#\" + startDateStr + \"#, \" + \"\"\"\" + \"yyyy-MM-dd\" + \"\"\"\" + \") OR \" + _\n                \"Format(Data.lastmodified, \" + \"\"\"\" + \"yyyy-MM-dd\" + \"\"\"\" + \") &gt;= \" + _\n                    \"Format(#\" + startDateStr + \"#, \" + \"\"\"\" + \"yyyy-MM-dd\" + \"\"\"\" + \") \" + _\n        \"ORDER BY Data.id, Data.lastmodified, Data.createtimestamp, Goals.id \"\nrsD.Open\n</code></pre>\n\n<p>and generates the following SQL:</p>\n\n<pre><code>SELECT Data.id AS HapDataId, Data.createtimestamp, Data.lastmodified, Goals.* \nFROM HAPData.csv AS Data INNER JOIN HAPGoals.csv AS Goals ON Data.id = Goals.hapid \nWHERE Format(Data.createtimestamp, \"yyyy-MM-dd\") &gt;= Format(#7/1/2019#, \"yyyy-MM-dd\") OR \n    Format(Data.lastmodified, \"yyyy-MM-dd\") &gt;= Format(#7/1/2019#, \"yyyy-MM-dd\") \nORDER BY Data.id, Data.lastmodified, Data.createtimestamp, Goals.id \n</code></pre>\n\n<p>If I modify it to add the third file, I get the following SQL:</p>\n\n<pre><code>SELECT Data.id AS HapDataId, Data.createtimestamp, Data.lastmodified, Goals.*, Actions.* \nFROM HAPData.csv AS Data INNER JOIN HAPGoals.csv AS Goals ON Data.id = Goals.hapid \n    INNER JOIN HAPActionSteps.csv AS Actions ON Goals.id = Actions.goalid \nWHERE Format(Data.createtimestamp, \"yyyy-MM-dd\") &gt;= Format(#7/1/2019#, \"yyyy-MM-dd\") OR \n    Format(Data.lastmodified, \"yyyy-MM-dd\") &gt;= Format(#7/1/2019#, \"yyyy-MM-dd\") \nORDER BY Data.id, Data.lastmodified, Data.createtimestamp, Goals.id, Actions.id\n</code></pre>\n\n<p>which creates the following error on the rsD.Open line: </p>\n\n<p>Syntax error (missing operator) in query expression 'Data.id = Goals.hapid INNER JOIN HAPActionSteps.csv AS Actions ON Goals.id = Actions.goali'with an error code of -2147217900</p>\n\n<p>Can anyone see what's wrong with my SQL?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 10225649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6tjzX.png?s=128&g=1", "display_name": "InExSu VBAGem t2d2", "link": "https://stackoverflow.com/users/10225649/inexsu-vbagem-t2d2"}, "is_accepted": true, "score": 1, "last_activity_date": 1565824134, "creation_date": 1565824134, "answer_id": 57503097, "question_id": 57503026, "link": "https://stackoverflow.com/questions/57503026/runtime-error-13-handling-continue-for-loop/57503097#57503097", "title": "Runtime error 13 handling - continue For Loop", "body": "<pre><code>For i = 2 To lastRow\n    If IsError(ws.Cells(i, 2)) = False Then\n        strString = (ws.Cells(i, 2).Value)    'get value of cell\n        ' Do other stuff\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11929554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xVXKNnrEnQc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcqf0bGIz-rngL_TmfDthh7MQC_Kg/photo.jpg?sz=128", "display_name": "Emily Clauson", "link": "https://stackoverflow.com/users/11929554/emily-clauson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57503097, "answer_count": 1, "score": 1, "last_activity_date": 1565863226, "creation_date": 1565823394, "last_edit_date": 1565863226, "question_id": 57503026, "link": "https://stackoverflow.com/questions/57503026/runtime-error-13-handling-continue-for-loop", "title": "Runtime error 13 handling - continue For Loop", "body": "<p>I have a VBA for Loop, and occasionally are getting a Runtime Error 13 which I want to handle by increment i.</p>\n\n<p>I have attempted to handle the error but it still throws Runtime error 13.</p>\n\n<pre><code>For i = 2 To lastRow\n    On Error GoTo stringNotFound\n    strString = (ws.Cells(i, 2).Value) 'get value of cell\n    ' Do other stuff\n    stringNotFound:\nNext i\n</code></pre>\n\n<p>How do I handle it so that in the event of a error the cell is skipped and i is incremented?</p>\n"}, {"tags": ["excel", "vba", "pdf", "userform", "openpdf"], "comments": [{"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1565909352, "post_id": 57503023, "comment_id": 101501974, "body": "the value in textbox26 is from a hyperlinked cell on sheet &quot;Hyperlink&quot; when i click on the cell it opens the hyperlink in adobe. i like for textbox26 value to do the same. is this possible?"}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 992413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rxVsU.jpg?s=128&g=1", "display_name": "Francisco Araujo", "link": "https://stackoverflow.com/users/992413/francisco-araujo"}, "is_accepted": false, "score": 0, "last_activity_date": 1565826774, "creation_date": 1565826774, "answer_id": 57503362, "question_id": 57503023, "link": "https://stackoverflow.com/questions/57503023/how-to-use-textbox-value-to-search-folder-for-pdf-file-and-open-pdf-file/57503362#57503362", "title": "how to use textbox value to search folder for pdf file and open pdf file", "body": "<p>You can open the a pdf file using:</p>\n\n<pre><code>Sub test()\n    Filename = TextBox1.Text\n    ActiveWorkbook.FollowHyperlink Filename\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565909197, "creation_date": 1565823389, "last_edit_date": 1565909197, "question_id": 57503023, "link": "https://stackoverflow.com/questions/57503023/how-to-use-textbox-value-to-search-folder-for-pdf-file-and-open-pdf-file", "title": "how to use textbox value to search folder for pdf file and open pdf file", "body": "<p>i want to use textbox1 value to search for the pdf file in a folder and open the pdf file.</p>\n\n<pre><code>    iso = Me.TempCombo.Value\n    If Me.TempCombo.Value = \"\" Then\n        Exit Sub\n    End If\nfinalrow = Sheets(\"Hyperlink\").Range(\"A6000\").End(xlUp).Row\n\nFor i = 2 To finalrow\n    If Sheets(\"Hyperlink\").Cells(i, 1) = iso Then\n        Me.TextBox26 = Cells(i, 1).Value &amp; Worksheets(\"Hyperlink\").Cells(i, 1).Value\n\n\n        End If\n\n    Next i\n\nActiveWorkbook.FollowHyperlink Address:=\"\\\\OPDD-2UA8302DBK\\Users\\rossa1\\Desktop\\Portal to Andrew Side\\TORQUE MAPS\\\" ' &amp; Me.TextBox26.Value\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565864154, "post_id": 57502862, "comment_id": 101484055, "body": "And does it work without VBA, when you try to send it manually?"}, {"owner": {"reputation": 3, "user_id": 11903060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_fX-fkJ5UZg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1cYJu7cte8NZ9z9uTlopHr6O8og/photo.jpg?sz=128", "display_name": "Ignacio Ramirez", "link": "https://stackoverflow.com/users/11903060/ignacio-ramirez"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1565881584, "post_id": 57502862, "comment_id": 101491722, "body": "@z32a7ul Yes it does, now the error appearing is asking who to send it to, but I already inputted the email that should be sent to."}], "answers": [{"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1565900588, "creation_date": 1565900588, "answer_id": 57515793, "question_id": 57502862, "link": "https://stackoverflow.com/questions/57502862/how-can-i-fix-an-automatic-email-reminder-issue/57515793#57515793", "title": "How can I fix an automatic email reminder issue", "body": "<p>I refactored your code (moved variable declarations directly before initialization, changed Integer to Long, reordered the statements to group the ones related to Outlook together, and removed the superfluous Settings to Nothing).</p>\n\n<pre><code>Sub SendReminderMail()\n    Dim MailDest As String: MailDest = vbNullString\n    Dim iCounter As Long: For iCounter = 1 To WorksheetFunction.CountA(Columns(4))\n        If MailDest = \"\" And Cells(iCounter, 8).Offset(0, -1) = \"Send Reminder\" Then\n            MailDest = Cells(iCounter, 8).Value\n        ElseIf MailDest &lt;&gt; \"\" And Cells(iCounter, 8).Offset(0, -1) = \"Send Reminder\" Then\n            MailDest = MailDest &amp; \";\" &amp; Cells(iCounter, 8).Value\n        End If\n    Next iCounter\n\n    Dim OutLookApp As Object: Set OutLookApp = CreateObject(\"Outlook.Application\")\n    Dim OutLookMailItem As Object: Set OutLookMailItem = OutLookApp.CreateItem(0)\n    With OutLookMailItem\n        .BCC = MailDest\n        .Subject = \"FYI\"\n        .Body = \"Reminder: The patient is overdue please contact the patient to reschedule. Please ignore if appointment has been made.\"\n        .Send\n    End With\nEnd Sub\n</code></pre>\n\n<p>However, I don't think that these changes would correct the error.</p>\n\n<p>I found in Microsoft's Knowledge Base an article regarding this issue: <a href=\"https://support.microsoft.com/en-us/help/189618/you-may-receive-the-run-time-error-2147023174-800706ba-error-message-o\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/189618/you-may-receive-the-run-time-error-2147023174-800706ba-error-message-o</a></p>\n\n<p>To summarize it quickly: If you use unqualified references to refer to variables (e.g. <code>Set a = ActiveDocument</code> instead of <code>Set a = WordApp.ActiveDocument</code>) then VBA creates a hidden global variable to store which Application's ActiveDocument it refers to. Therefore if you try to quit that Application, you won't succeed and the Application will continue to run (without a visible window and without an error message) and the next time you want to refer to the ActiveDocument, it won't refer to the that Application's ActiveDocument which you started last time but the old Application's ActiveDocument, which, however was destroyed when the old Application started its process of exiting.</p>\n\n<p>I examined your code and found no such unqualified reference.</p>\n\n<p>My theory is that either (A) you judged some part of your code irrelevant to the problem and did not post it; and that contains such an unqualified reference; or (B) you are in the middle of developing this Sub and previous versions of the code created some dangling references.</p>\n\n<p>In case (A) please post all other parts of your code that handles Outlook in any way.</p>\n\n<p>In case (B) check in the Task Manager how many Outlook processes are running. Sign out from windows to make sure that all your Applications are closed, sign in, and try if the error still occurs.</p>\n"}], "owner": {"reputation": 3, "user_id": 11903060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_fX-fkJ5UZg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1cYJu7cte8NZ9z9uTlopHr6O8og/photo.jpg?sz=128", "display_name": "Ignacio Ramirez", "link": "https://stackoverflow.com/users/11903060/ignacio-ramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565904143, "creation_date": 1565821934, "last_edit_date": 1565904143, "question_id": 57502862, "link": "https://stackoverflow.com/questions/57502862/how-can-i-fix-an-automatic-email-reminder-issue", "title": "How can I fix an automatic email reminder issue", "body": "<p>The code is asking me who to send this to, but the purpose of the email would be to send it to multiple people at a time. The problem in the code is \".send\". I need the code to send it automatically without having to manually input each email within the code.</p>\n\n<p>The first thing I tried was being specific to who I wanted the email to be send with in the code itself. It did not work.</p>\n\n<pre><code>Sub SendReminderMail()\n    Dim OutLookApp As Object\n    Dim OutLookMailItem As Object\n    Dim iCounter As Integer\n    Dim MailDest As String\n    Dim StrFrom As String\n    Dim StrTo As String\n\n    Set OutLookApp = CreateObject(\"Outlook.Application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n    With OutLookMailItem\n        MailDest = \"\"\n        For iCounter = 1 To WorksheetFunction.CountA(Columns(4))\n            If MailDest = \"\" And Cells(iCounter, 8).Offset(0, -1) = \"Send Reminder\" Then\n                MailDest = Cells(iCounter, 8).Value\n            ElseIf MailDest &lt;&gt; \"\" And Cells(iCounter, 8).Offset(0, -1) = \"send Reminder\" Then\n                MailDest = MailDest &amp; \";\" &amp; Cells(iCounter, 8).Value\n            End If\n        Next iCounter\n        .BCC = MailDest\n        .Subject = \"FYI\"\n        .Body = \"Reminder: The patient is overdue please contact the patient to reschedule. Please ignore if appointment has been made.\"\n        .Send\n    End With\n    Set OutLookMailItem = Nothing\n    Set OutLookApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>The error I get is \"run-time error 462\" stating the remote machine does not exist.</p>\n"}, {"tags": ["excel", "vba", "settings", "with-statement"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565820989, "post_id": 57502654, "comment_id": 101474371, "body": "What do you mean by &quot;loops back&quot;? Are you stepping through the code with F8?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1565821554, "post_id": 57502654, "comment_id": 101474503, "body": "Do you have any event handlers set up?"}, {"owner": {"reputation": 1, "user_id": 9146490, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tO1i54FtZ_0/AAAAAAAAAAI/AAAAAAAAHeo/We3IPgkVorY/photo.jpg?sz=128", "display_name": "Moni", "link": "https://stackoverflow.com/users/9146490/moni"}, "edited": false, "score": 0, "creation_date": 1565821979, "post_id": 57502654, "comment_id": 101474587, "body": "Yes I f8 through it, no to event handler, it started working again, the code works but after a few runs, as I write more code it breaks on the same spot. Ima go bananas. . . thx ppl"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1565824829, "post_id": 57502654, "comment_id": 101475110, "body": "There&#39;s nothing in the code you posted which explains the problem you&#39;re seeing."}], "owner": {"reputation": 1, "user_id": 9146490, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tO1i54FtZ_0/AAAAAAAAAAI/AAAAAAAAHeo/We3IPgkVorY/photo.jpg?sz=128", "display_name": "Moni", "link": "https://stackoverflow.com/users/9146490/moni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565864780, "creation_date": 1565820330, "last_edit_date": 1565864780, "question_id": 57502654, "link": "https://stackoverflow.com/questions/57502654/vba-executes-one-minute-then-loops-back-to-a-with-statement-seemingly-without-c", "title": "VBA executes one minute, then loops back to a with statement seemingly without cause", "body": "<p>At work it worked like 5 times then broke. At home it worked 10 times until it started doing it again: It executes the only with statement but instead of ending the with it jumps back to the beginning code (Set rng) of the with statement. </p>\n\n<p>I'm only executing one line of code and the behavior seems freaKn erratic.</p>\n\n<pre><code>With ws\nSet rng = .[A3:A7]\nrng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\nTextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\nSemicolon:=False, Comma:=False, Space:=True, Other:=True, OtherChar:= _\n\":\", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), \nArray(5, 1), Array(6, 1)), TrailingMinusNumbers:=True\nEnd With\n</code></pre>\n\n<p>Why is it not executing consistently? Shouldn't it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1565820431, "post_id": 57502601, "comment_id": 101474237, "body": "<a href=\"https://stackoverflow.com/q/10714251/62576\">How to avoid using Select in Excel VBA</a> is a must-read, especially when you&#39;re using it 10 times in 20 lines of code."}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 11790961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181fec4f4b5794cf6783c793c51b0e8e?s=128&d=identicon&r=PG&f=1", "display_name": "TiagoSantos", "link": "https://stackoverflow.com/users/11790961/tiagosantos"}, "is_accepted": true, "score": 0, "last_activity_date": 1565821942, "creation_date": 1565821942, "answer_id": 57502864, "question_id": 57502601, "link": "https://stackoverflow.com/questions/57502601/easy-way-to-assign-a-macro-to-button-to-copy-data-from-sheet1-sheet-2-to-datashe/57502864#57502864", "title": "Easy way to assign a macro to button to copy data from sheet1/sheet 2 to DATAsheet than delete", "body": "<p>I'm gonna share with you one of my best friends:</p>\n\n<pre><code>last_cell_data = Sheets(\"DATA\").Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>It gives you the last line in column \"A\",with a value, so gives you an integer. If you want the column \"O\", just replace \"A\" for \"O\".</p>\n\n<p>For your issue use like this:</p>\n\n<pre><code>Range(\"O\" &amp; last_cell_Data + 1 ).Select\n</code></pre>\n\n<p>Now you won't overwrite anymore.</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1565878478, "creation_date": 1565878478, "answer_id": 57511027, "question_id": 57502601, "link": "https://stackoverflow.com/questions/57502601/easy-way-to-assign-a-macro-to-button-to-copy-data-from-sheet1-sheet-2-to-datashe/57511027#57511027", "title": "Easy way to assign a macro to button to copy data from sheet1/sheet 2 to DATAsheet than delete", "body": "<p>For my issue with clearing the data and keeping the formula I used...</p>\n\n<pre><code>Range(\"A2:I150\").SpecialCells(xlCellTypeConstants).ClearContents\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57502864, "answer_count": 2, "score": 0, "last_activity_date": 1565878478, "creation_date": 1565820024, "last_edit_date": 1565864854, "question_id": 57502601, "link": "https://stackoverflow.com/questions/57502601/easy-way-to-assign-a-macro-to-button-to-copy-data-from-sheet1-sheet-2-to-datashe", "title": "Easy way to assign a macro to button to copy data from sheet1/sheet 2 to DATAsheet than delete", "body": "<p>I have a workbook that has a receive tracker and a production tracker that will be updated daily and needs to be saved to a master DATA sheet that holds all the info. For ease of use to my coworkers that are not computer savvy I want them to be able to hit a button to save the info they put in that copies and saves the data and clears the form. also i can not get it through my head how to use getLastRow</p>\n\n<p>I have created a macro and a button for both sheets that copy and paste the data but I believe my range is wrong. If I click the button on receive tracker everything is fine, with the exception of not being able to do get last row correctly. When there is already data in the DATA worksheet from receive traker and I click on the button for Production Tracker it will paste it both where I want it and also over cells of receive tracker. Also I need to keep the formula on the production tracker it gets delete when I do Delete or clearcontets</p>\n\n<p>Macro for Receive tracker is </p>\n\n<pre><code>'''    Sub Macro3()\n'\n' Macro3 Macro\n'\n\n'\n    Sheets(\"RecieveTracker\").Select\n    Range(\"A7:J105\").Select\n    Selection.copy\n    Sheets(\"DATA\").Select\n    Range(\"A7\").Select\n    ActiveSheet.Paste\n    Sheets(\"RecieveTracker\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\nEnd Sub\n'''\n</code></pre>\n\n<p>for Production tracker is\n    '''\n        Sub Macro5()\n    '\n    ' Macro5 Macro\n    '</p>\n\n<pre><code>'\n    Sheets(\"DailyProduction\").Select\n    Range(\"A2:I150\").Select\n    Selection.copy\n    Sheets(\"DATA\").Select\n    Range(\"O7\").Select\n    ActiveSheet.Paste\n    Sheets(\"DailyProduction\").Select\n    Application.CutCopyMode = False\n    Selection.ClearContents\nEnd Sub\n'''\n</code></pre>\n\n<p>I do not get an error message when I run it but i loose the formulas on my production tracker and all the other data just gets copied over for reference on the DATA sheet the Recieve tracker should range   from A7-J7 and down and the data from Production tracker should be o7-w7 and down</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565820057, "post_id": 57502463, "comment_id": 101474138, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42503316/how-can-i-insert-variable-into-formula-in-vba\">How can I insert variable into formula in VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "edited": false, "score": 0, "creation_date": 1566323105, "post_id": 57504570, "comment_id": 101617908, "body": "Thank you! Separating it out into the workbook name and active sheet name to get the right formatting was exactly what I needed."}], "tags": [], "owner": {"reputation": 178, "user_id": 2046179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKM4P.jpg?s=128&g=1", "display_name": "T4roy", "link": "https://stackoverflow.com/users/2046179/t4roy"}, "is_accepted": true, "score": 1, "last_activity_date": 1565840189, "creation_date": 1565840189, "answer_id": 57504570, "question_id": 57502463, "link": "https://stackoverflow.com/questions/57502463/variable-workbook-name-in-formula/57504570#57504570", "title": "Variable Workbook Name in Formula", "body": "<p>It always helps to place a Break Point into the line where you are having issues then use the Intermediate Window to figure out where it is going wrong. For example;</p>\n\n<ol>\n<li>Place a Break Point at the last line where you have ActiveCell.Formula =</li>\n<li>Run the code</li>\n<li>In the Intermediate Window type <code>?\"=IF(ISERROR(GETPIVOTDATA(\"\"Sec QTY Sum\"\", 'InvRptName'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\")),0,GETPIVOTDATA(\"\"Sec QTY Sum\"\", 'InvRptName'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\"))\"</code></li>\n<li>Note; The ? instructs the Intermediate Window that you want to see a return value.</li>\n<li>If it compiles ok you should see a resulting string, see if it looks as you expected. I'd guess your result will include the text <strong>'InvRptName'</strong> where you are expecting <strong>'[8-14-19 AM INVENTORY.xls]Sheet2'</strong>.</li>\n</ol>\n\n<p>To get <strong>'[8-14-19 AM INVENTORY.xls]Sheet2'!$A$4</strong> try using;</p>\n\n<pre><code>?\"'[\" &amp; ActiveWorkbook.Name &amp; \"]\" &amp; ActiveSheet.Name &amp; \"'!$A$4\"\n</code></pre>\n\n<p>Another couple hot tips;</p>\n\n<ol>\n<li>Use <code>Debug.Print \"add your messages here or a variable \" &amp; InvRptName</code> within your code to output debug messages.</li>\n<li>Use the Intermediate Widow to fix variables during execution <code>InvRptName = \"'[\" &amp; ActiveWorkbook.Name &amp; \"]\" &amp; ActiveSheet.Name &amp; \"'!$A$4\"</code> notice I excluded the ? this time.</li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 57504570, "answer_count": 1, "score": 0, "last_activity_date": 1565864887, "creation_date": 1565819137, "last_edit_date": 1565864887, "question_id": 57502463, "link": "https://stackoverflow.com/questions/57502463/variable-workbook-name-in-formula", "title": "Variable Workbook Name in Formula", "body": "<p>I am trying to write a code that takes a variable workbook name (declared earlier) and inputs it into a formula that will be pasted into a cell. </p>\n\n<p>I have it to the point where the formula works if I just write the workbook in, and I have the variable declaration with the workbook path working okay, I just can't figure out the formatting to drop the variable into the formula code.</p>\n\n<pre><code>'''Spreadsheet opening and variable declaration\n\nstrFileToOpen = Application.GetOpenFilename _\n(Title:=\"Select an updated Inventory Report\", _\nFileFilter:=\"Excel Files *.xls* (*.xls*),\")\n\nIf strFileToOpen = False Then\n\n    'Displaying a message if file not choosedn in the above step\n    MsgBox \"No file selected.\", vbExclamation, \"Sorry!\"\n\n    'And existing from the procedure\n    Exit Sub\nElse\n\nEnd If\n\nWorkbooks.Open Filename:=strFileToOpen\n\n\n\nSet InvRpt = ActiveWorkbook\n\nInvRptName = ActiveWorkbook.FullName\n\nSet InvSht = InvRpt.Worksheets(\"ALL\")\n\n'''Formula insert\n\nActiveCell.Formula = \"=IF(ISERROR(GETPIVOTDATA(\"\"Sec QTY Sum\"\", 'InvRptName'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\")),0,GETPIVOTDATA(\"\"Sec QTY Sum\"\", 'InvRptName'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\"))\"\n</code></pre>\n\n<p>The end result would be for this code to work exactly like this, but with a variable instead of the workbook/sheet name:</p>\n\n<pre><code> ActiveCell.Formula = \"=IF(ISERROR(GETPIVOTDATA(\"\"Sec QTY Sum\"\", '[8-14-19 AM INVENTORY.xls]Sheet2'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\")),0,GETPIVOTDATA(\"\"Sec QTY Sum\"\", '[8-14-19 AM INVENTORY.xls]Sheet2'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\"))\"\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1565821342, "post_id": 57502522, "comment_id": 101474458, "body": "HI, thanks for this. It looks as if it should do the job but it doesn&#39;t work in my code and I&#39;m now thinking that my array isn&#39;t the 2 dimension array that I think it should be."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1565821385, "post_id": 57502522, "comment_id": 101474468, "body": "I kind of guessed that was the issue :) Can you edit your question to include the array declaration?"}, {"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1565821920, "post_id": 57502522, "comment_id": 101474578, "body": "My code is quite convoluted but I&#39;m now pretty sure that I&#39;ve got a 1D array of 1D arrays rather than a 2D array. Each item of the main array is the result of a SPLIT function."}, {"owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "edited": false, "score": 0, "creation_date": 1565825109, "post_id": 57502522, "comment_id": 101475154, "body": "All fixed now with a 2D array in place of the previous one and no transpose function. Many thanks for your help. It pointed me in the right direction."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1565819501, "creation_date": 1565819501, "answer_id": 57502522, "question_id": 57502360, "link": "https://stackoverflow.com/questions/57502360/vba-excel-printing-array-to-worksheet-double-transpose/57502522#57502522", "title": "VBA Excel Printing Array to Worksheet - Double Transpose", "body": "<p>Without using <code>Transpose</code>, here is a more robust method:</p>\n\n<pre><code>Dim numRows As Long\nnumRows = UBound(MyArray, 1) - LBound(MyArray, 1) + 1\n\nDim numCols As Long\nnumCols = UBound(MyArray, 2) - LBound(MyArray, 2) + 1\n\nActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Resize(numRows, numCols).Value = MyArray\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5265966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8061a64dfda659e68d38e25d0d9b8dd7?s=128&d=identicon&r=PG&f=1", "display_name": "JC_RMB", "link": "https://stackoverflow.com/users/5265966/jc-rmb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565819501, "creation_date": 1565818350, "question_id": 57502360, "link": "https://stackoverflow.com/questions/57502360/vba-excel-printing-array-to-worksheet-double-transpose", "title": "VBA Excel Printing Array to Worksheet - Double Transpose", "body": "<p>I have a two dimensional dynamic array in my VBA code where the array dimensions are typically (1800,5) using option base 0. When I attempt to print this array to a range of 1801 rows x 6 columns on an Excel worksheet, I have to use the Worksheet transpose function twice. Any ideas why I have to do this and is there a better way of doing it without using the transpose function?</p>\n\n<p>This code works;</p>\n\n<p><code>ActiveWorkbook.Worksheets(\"Sheet1\").[a1].Resize(UBound(MyArray) - LBound(MyArray) + 1, 6) = WorksheetFunction.Transpose(WorksheetFunction.Transpose(MyArray))</code></p>\n\n<p>This code does not work;</p>\n\n<p><code>ActiveWorkbook.Worksheets(\"Sheet1\").[a1].Resize(UBound(MyArray) - LBound(MyArray) + 1, 6) = MyArray</code></p>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1565818882, "post_id": 57502348, "comment_id": 101473799, "body": "Have you used <code>Debug.Print LastRow</code> to determin what it is returning?"}, {"owner": {"reputation": 1, "user_id": 8649568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f57bcab04f97b51a21afd9f19f453c?s=128&d=identicon&r=PG&f=1", "display_name": "Christine D", "link": "https://stackoverflow.com/users/8649568/christine-d"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1565819931, "post_id": 57502348, "comment_id": 101474100, "body": "I have not; I am not familiar with that or how it is used; is that something I would just add to my existing VBA (what is included in above)?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1565849377, "post_id": 57502348, "comment_id": 101479077, "body": "Add it after you set <code>LastRow</code>. It will print a number to the Immediate Window in your editor. But, why don&#39;t you adjust your formula in your cell to return something like &quot;PASTE&quot; instead of &quot;&quot;??"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8649568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f57bcab04f97b51a21afd9f19f453c?s=128&d=identicon&r=PG&f=1", "display_name": "Christine D", "link": "https://stackoverflow.com/users/8649568/christine-d"}, "edited": false, "score": 0, "creation_date": 1565825901, "post_id": 57503154, "comment_id": 101475293, "body": "No luck. I did run a simple VBA code to make sure there were no other issues going on. Not sure if I should trash my code and start from scratch or if there is some small something I am missing."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "reply_to_user": {"reputation": 1, "user_id": 8649568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f57bcab04f97b51a21afd9f19f453c?s=128&d=identicon&r=PG&f=1", "display_name": "Christine D", "link": "https://stackoverflow.com/users/8649568/christine-d"}, "edited": false, "score": 0, "creation_date": 1565876826, "post_id": 57503154, "comment_id": 101489320, "body": "I&#39;ve tested this on numerous different worksheets and it&#39;s run correctly. Do you have an example of the worksheets you&#39;re using?"}, {"owner": {"reputation": 1, "user_id": 8649568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f57bcab04f97b51a21afd9f19f453c?s=128&d=identicon&r=PG&f=1", "display_name": "Christine D", "link": "https://stackoverflow.com/users/8649568/christine-d"}, "edited": false, "score": 0, "creation_date": 1565978524, "post_id": 57503154, "comment_id": 101524484, "body": "Pardon my lack of knowledge about how SO works - are you asking me for the file, which I can share - if I could figure out how to upload or are you asking for screenshots?"}], "tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1565902944, "last_edit_date": 1565902944, "creation_date": 1565824668, "answer_id": 57503154, "question_id": 57502348, "link": "https://stackoverflow.com/questions/57502348/how-to-copy-paste-to-next-empty-row/57503154#57503154", "title": "How to Copy/Paste to next empty row?", "body": "<h3>Finding the last row</h3>\n\n<p>Try using <code>UsedRange</code> to find the last used row as this is safer than using <code>Find</code>. </p>\n\n<p><code>LastRow = DestSheet.UsedRange.Rows.Count</code></p>\n\n<hr>\n\n<h3>A side note</h3>\n\n<p>If your code resides in the same place as these worksheets then I would recommend using their <a href=\"https://stackoverflow.com/a/41481428/8309643\">code name</a>. This will protect you from running into an error if the sheet doesn't exist.</p>\n"}], "owner": {"reputation": 1, "user_id": 8649568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f57bcab04f97b51a21afd9f19f453c?s=128&d=identicon&r=PG&f=1", "display_name": "Christine D", "link": "https://stackoverflow.com/users/8649568/christine-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 580, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565949889, "creation_date": 1565818290, "last_edit_date": 1565949889, "question_id": 57502348, "link": "https://stackoverflow.com/questions/57502348/how-to-copy-paste-to-next-empty-row", "title": "How to Copy/Paste to next empty row?", "body": "<p>I have code to copy a Worksheet A, columns A:C (no set row quantities, this will be re-used and the quantities will change) and paste to the first blank row in the same workbook, different sheet, Worksheet B (this also has no set row quantities and will change). </p>\n\n<p>Worksheet B has a formula in the same columns that I want to paste to that returns \"\" if there is no data. I think VBA is seeing the \"\" and assuming there is data there; however, it is not pasting even to lines without said formula. </p>\n\n<pre><code>Sub Copy_Created_Fringe_Accounts()\n    Dim SourceRange As Range\n    Dim DestRange As Range\n    Dim DestSheet As Worksheet\n    Dim LastRow As Long\n\n'Source sheet and range\n    Set SourceRange = Sheets(\"CREATED FRINGE ACCTS\").Range(\"A2:C500\")\n\n'Destination sheet and range\n    Set DestSheet = Sheets(\"99 BUDGET WORKSHEET\")\n\n'Last Row\n    LastRow = DestSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n'Copy and paste to destination\n    Set DestRange = DestSheet.Range(\"A\" &amp; LastRow + 1)\n    SourceRange.Copy DestRange\n\nEnd Sub\n</code></pre>\n\n<p>Nothing happens when I run it. I expect to see the data from Worksheet A copied to Worksheet B, starting at the first available empty row. </p>\n\n<p>I am fairly new to VBA so any help/understanding is appreciated.</p>\n"}, {"tags": ["arrays", "excel", "vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1565827823, "creation_date": 1565827823, "answer_id": 57503457, "question_id": 57502283, "link": "https://stackoverflow.com/questions/57502283/excelvba-converting-from-an-array-to-a-collection-then-insertion-of-said-coll/57503457#57503457", "title": "ExcelVBA - Converting from an array to a collection, then insertion of said collection into combobox list", "body": "<p>First, you should assign your range dynamically to CustomerArray...</p>\n\n<pre><code>With Sheet2\n    CustomerArray() = .Range(\"A5:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Value\nEnd With\n</code></pre>\n\n<p>Then, you should disable error handling after you've finished adding the items to your collection.  Since you did not do so, it hid the fact that your range reference in assigning the values to your listbox was incorrect, and that you didn't use the Value property to assign them.  So you should disable the error handling...</p>\n\n<pre><code>On Error Resume Next\nFor Each customer In CustomerArray\n    ComboBoxArray.Add customer, customer\nNext\nOn Error GoTo 0\n</code></pre>\n\n<p>Then, when transferring newarray to your worksheet, you'll need to transpose the array...</p>\n\n<pre><code>Sheet3.Range(\"A1\").Resize(UBound(newarray) + 1).Value = Application.Transpose(newarray)\n</code></pre>\n\n<p>Then, as already mentioned, you should assign the items to your listbox with Sheet3.Range(\"A1:A2000\").Value.  However, since newarray already contains a list of the items, you can simply assign newarray to your listbox...</p>\n\n<pre><code>Sheet1.ComboBox1.List = newarray\n</code></pre>\n\n<p>So the complete code would be as follows...</p>\n\n<pre><code>Sub PopulateComboBoxes()\n\n    Dim ComboBoxArray As New Collection, customer As Variant\n    Dim CustomerArray() As Variant\n    Dim newarray() As Variant\n\n    With Sheet2\n        CustomerArray() = .Range(\"A5:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Value\n    End With\n\n    On Error Resume Next\n    For Each customer In CustomerArray\n        ComboBoxArray.Add customer, customer\n    Next\n    On Error GoTo 0\n\n    newarray = collectionToArray(ComboBoxArray)\n\n    Sheet3.Range(\"A1\").Resize(UBound(newarray) + 1).Value = Application.Transpose(newarray)\n\n    Sheet1.ComboBox1.List = newarray\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1565829132, "creation_date": 1565829132, "answer_id": 57503585, "question_id": 57502283, "link": "https://stackoverflow.com/questions/57502283/excelvba-converting-from-an-array-to-a-collection-then-insertion-of-said-coll/57503585#57503585", "title": "ExcelVBA - Converting from an array to a collection, then insertion of said collection into combobox list", "body": "<p>it could be achieved in a number of ways. using collection or dictionary object. i am just presenting simple method without going through collection or dictionary since only 5000 rows is to be processed. it could be further shortened if used directly with combo box without using <code>OutArr</code>. As  @Domenic already answered it with explanations, may please go along with  that solution.</p>\n\n<pre><code>Option Explicit\nSub test()\nDim InArr As Variant, OutArr() As Variant\nDim i As Long, j As Long, Cnt As Long\nDim have As Boolean\nInArr = ThisWorkbook.Sheets(\"sheet2\").Range(\"A5:A2000\")\nReDim OutArr(1 To 1)\n    Cnt = 0\n    For i = 1 To UBound(InArr, 1)\n    If InArr(i, 1) &lt;&gt; \"\" Then\n    have = False\n        For j = 1 To UBound(OutArr, 1)\n            If OutArr(j) = InArr(i, 1) Then\n            have = True\n            Exit For\n            End If\n        Next j\n\n        If have = False Then\n        Cnt = Cnt + 1\n        ReDim Preserve OutArr(1 To Cnt)\n        OutArr(Cnt) = InArr(i, 1)\n        End If\n    End If\n    Next i\n\n    Sheet3.Range(\"A1\").Resize(UBound(OutArr)).Value = Application.Transpose(OutArr)\n    Sheet1.ComboBox1.Clear\n    Sheet1.ComboBox1.List = OutArr\n    Debug.Print Sheet1.ComboBox1.ListCount\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 0, "creation_date": 1565873528, "post_id": 57503587, "comment_id": 101487607, "body": "Works like a charm. Being fairly new to VBA, I greatly appreciate the time each of you took to give me informative answers. I tried all 3 methods to try and better understand the code. I choose Mikku&#39;s simply because it was, well, most simple and it does the job.  The only thing that this answer is missing is an auto sort for when the ComboBoxArray values are added into the combobox. I added a command button to the sheet2 table so that when values are added, the editor can click the button putting all the table values into alphabetical order."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "edited": false, "score": 0, "creation_date": 1565877249, "post_id": 57503587, "comment_id": 101489528, "body": "Glad it worked for you @rz ... Accept and upvote the answer  :)"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1565829134, "creation_date": 1565829134, "answer_id": 57503587, "question_id": 57502283, "link": "https://stackoverflow.com/questions/57502283/excelvba-converting-from-an-array-to-a-collection-then-insertion-of-said-coll/57503587#57503587", "title": "ExcelVBA - Converting from an array to a collection, then insertion of said collection into combobox list", "body": "<p>You don't need that function to make a New Array, seems Excessive to me.</p>\n\n<ul>\n<li>Assigning to <code>CustomerArray</code> will take care of Future Additions in column</li>\n<li>You can directly pass on the Collection value to <code>ComboBox</code></li>\n<li>You are missing <code>On Error Goto 0</code> in your code after addition to Collection. That is making all to errors after that invisible and hard for you to identify which part of code is causing problems.</li>\n</ul>\n\n<hr>\n\n<p><strong>Here Try this:</strong></p>\n\n<pre><code>Sub PopulateComboBoxes()\n\nDim ComboBoxArray As New Collection\nDim CustomerArray() As Variant\nDim newarray() As Variant\nDim i As Long\n\n\nWith Worksheets(\"Sheet2\")\n    CustomerArray = .Range(\"A5:A\" &amp; .Range(\"A5\").End(xlDown).row).Value\nEnd With\n\nOn Error Resume Next\nFor i = LBound(CustomerArray) To UBound(CustomerArray)\n    ComboBoxArray.Add CustomerArray(i, 1), CustomerArray(i, 1)\nNext\nOn Error GoTo 0\n\nFor Each Itm In ComboBoxArray\n    Worksheets(\"Sheet1\").ComboBox1.AddItem Itm\nNext\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 11890257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WPUCCfI6R34/AAAAAAAAAAI/AAAAAAAAAGA/XSXgTWUhWEs/photo.jpg?sz=128", "display_name": "r z", "link": "https://stackoverflow.com/users/11890257/r-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57503587, "answer_count": 3, "score": 0, "last_activity_date": 1565829134, "creation_date": 1565818002, "question_id": 57502283, "link": "https://stackoverflow.com/questions/57502283/excelvba-converting-from-an-array-to-a-collection-then-insertion-of-said-coll", "title": "ExcelVBA - Converting from an array to a collection, then insertion of said collection into combobox list", "body": "<p>I have Sheet1.ComboBox1 that I would like to fill with an array of values. This array is stored on Sheet2. This array is a list of all customers to be used in the excel file. All customers are listed in one single column. </p>\n\n<p>Some customers appear more than once in the column. It varies by how many part numbers a customer has. </p>\n\n<p>I would like to fill a Sheet1.ComboBox1 with this array, however, I don't want duplicate values. </p>\n\n<p>I read online that I can convert the array into a collection which will automatically weed out duplicates. </p>\n\n<p>I would like to take this collection and input it into the Sheet1.ComboBox1, however, upon some research, I've found that collections are read-only...(am I wrong in this conclusion?)</p>\n\n<p>One strategy I saw was to convert the customer array into a collection and then back into a new simplified array. The hope is to store this new array into Sheet 3, then pull this array into ComboBox1.List. I've posted my code below of this attempt. </p>\n\n<pre><code>'Converts collection to an accessible array\n  Function collectionToArray(c As Collection) As Variant()\n    Dim a() As Variant: ReDim a(0 To c.Count - 1)\n    Dim i As Integer\n    For i = 1 To c.Count\n        a(i - 1) = c.item(i)\n    Next\n    collectionToArray = a\nEnd Function\n\nSub PopulateComboBoxes()\nDim ComboBoxArray As New Collection, customer\nDim CustomerArray() As Variant\nDim newarray() As Variant\nDim i As Long\n\nCustomerArray() = Sheet2.Range(\"A5:A2000\")\n\nOn Error Resume Next\nFor Each customer In CustomerArray\n    ComboBoxArray.Add customer, customer\nNext\n    newarray = collectionToArray(ComboBoxArray)\n    Sheet3.Range(\"A1:A2000\") = newarray\n\n\nSheet1.ComboBox1.List = Sheet3.Range(\"A1:2000\")\n</code></pre>\n\n<p>I used ' CustomerArray() = Sheet2.Range(\"A5:2000\") ' not because there are that many rows full of values in Sheet 2, rather, that I cover all bases when more customers are eventually added to the list. The total size of my Sheet 2 is currently A1:A110, but I want to future proof it. </p>\n\n<p>When I run the code, the Array is successfully reduced and the new array is placed into Sheet3 with no duplicates. However, the first Customer entry is repeated after the last unique customer value is defined. (A46 is last unique customer, A47:A2000 its the same customer repeated)</p>\n\n<p>Additionally, Sheet1.ComboBox1 remains empty. </p>\n\n<p>Is anyone able to explain how to restrict the number of rows filled by 'collectionToArray' , instead of filling all 2000?</p>\n\n<p>Also, where am I going wrong with filling the ComboBox1? Am I missing a command/function to cause the box to fill?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565880396, "post_id": 57503480, "comment_id": 101491106, "body": "Steve. Thank you so much for this guidance. It didn&#39;t quite work. I had the source file open. I had four other presentations open. I entered the macro in presentation 1. The macro copied the right slide in the source file, deleted the same SlideID in the target file but pasted the copied version at the end. I need it copied in the same location as the deleted version. Also, it only ran in presentation 1 but not any of the others that were open. I deleted &quot;Next i&quot; at the end because I got a bug window that said &quot;Next i without For&quot;. Here is what I ran:"}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565880462, "post_id": 57503480, "comment_id": 101491142, "body": "Sub ReplaceOneSlideInOpenPresentations()  Dim sourcePresentation As Presentation     On Error Resume Next     Set sourcePresentation = Application.Presentations(&quot;X:\\Marketing Presentations (Final) \\Slide Library\\Slide Library.pptm&quot;) &#39;change the name accordingly     If sourcePresentation Is Nothing Then         MsgBox &quot;Source presentation not found!&quot;, vbExclamation         Exit Sub     End If     On Error GoTo 0      Dim lSlideIDs As Long  Dim oSld As Slide &#39;more in next box"}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565880470, "post_id": 57503480, "comment_id": 101491147, "body": "lSlideIDs = 1854 &#39;change the slide IDs accordingly         sourcePresentation.Slides.FindBySlideID(lSlideIDs).Copy         ActivePresentation.Slides.FindBySlideID(lSlideIDs).Delete         ActivePresentation.Slides.Paste              End Sub"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565891374, "post_id": 57503480, "comment_id": 101495975, "body": "Re Next i, sorry, my mistake. Shouldn&#39;t be there. And see edited version for moving the pasted slide to what I think is the position you want."}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565900682, "post_id": 57503480, "comment_id": 101499556, "body": "OK. Many thanks. Didn&#39;t work. Same setup. Four target presentations open + source file open. Ran macro in Presentation 1. It copied right slide, then pasted it at the end, without deleting bad slide, which is closer to the front of the deck. Also got runtime error saying &quot;Slide (unknown member): Integer out of range. 53 is not in the valid range of 1 to 38&quot; . 53 is slide NUMBER in source but I need to use its slideID. Target deck had 38 slides (once new slide was added at end)."}, {"owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565900723, "post_id": 57503480, "comment_id": 101499567, "body": "Also, none of the other target presentations changed."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "edited": false, "score": 0, "creation_date": 1565982891, "post_id": 57503480, "comment_id": 101525944, "body": "The code as it stands won&#39;t change any but the active presentation (not all open presentations).  Let&#39;s get the basics working then mod it to do all open presentations. I&#39;d post whatever code you CURRENTLY have and explain what&#39;s not working."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1565891321, "last_edit_date": 1565891321, "creation_date": 1565828003, "answer_id": 57503480, "question_id": 57501968, "link": "https://stackoverflow.com/questions/57501968/replacing-one-slide-in-several-open-presentations/57503480#57503480", "title": "Replacing one slide in several open presentations", "body": "<p>Why are you using an array to hold one value?</p>\n\n<pre><code>  Dim vSlideIDs As Variant\n    vSlideIDs = Array(1846) 'change the slide IDs accordingly\n\n    Dim i As Long\n    For i = LBound(vSlideIDs) To UBound(vSlideIDs)\n        sourcePresentation.Slides.FindBySlideID(vSlideIDs(i)).Copy\n        ActivePresentation.Slides.Paste\n    Next i\n</code></pre>\n\n<p>Instead try something like this (largely air)code:</p>\n\n<pre><code> Dim lSlideIDs As Long\n Dim oSld as Slide\n Dim lIndex as long\n\n    lSlideIDs = 1846 'change the slide IDs accordingly\n        lIndex = sourcePresentation.Slides.FindBySlideID(lSlideIDs).SlideIndex\n        sourcePresentation.Slides.FindBySlideID(lSlideIDs).Copy\n        ActivePresentation.Slides.Paste\n        Set oSld = ActivePresentation.Slides(ActivePresentation.Slides.Count)\n        oSld.MoveTo lIndex\n    'Next i ' commenting this out, per OP's comment; my bad\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11919364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc387d6e44665831e9ce29b9822a46d?s=128&d=identicon&r=PG&f=1", "display_name": "PaulFH", "link": "https://stackoverflow.com/users/11919364/paulfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593682072, "creation_date": 1565816368, "last_edit_date": 1593682072, "question_id": 57501968, "link": "https://stackoverflow.com/questions/57501968/replacing-one-slide-in-several-open-presentations", "title": "Replacing one slide in several open presentations", "body": "<p>I cobbled together some VBA code in the hopes of replacing a single, identical slide in several open presentations.</p>\n\n<p>This pasted the new slide at the end rather than where the old slide was deleted. Also, I'd need this to happen with all open presentations. Note that I identify slides by SlideID.</p>\n\n<pre><code>Sub ReplaceOneSlide()\nActivePresentation.Slides.FindBySlideID(1846).Delete\nDim sourcePresentation As Presentation\n    On Error Resume Next\n    Set sourcePresentation = Application.Presentations(\"X:\\Marketing Presentations (Final) \\Slide Library\\Slide Library.pptm\") 'change the name accordingly\n    If sourcePresentation Is Nothing Then\n        MsgBox \"Source presentation not found!\", vbExclamation\n        Exit Sub\n    End If\n    On Error GoTo 0\n\n    Dim vSlideIDs As Variant\n    vSlideIDs = Array(1846) 'change the slide IDs accordingly\n\n    Dim i As Long\n    For i = LBound(vSlideIDs) To UBound(vSlideIDs)\n        sourcePresentation.Slides.FindBySlideID(vSlideIDs(i)).Copy\n        ActivePresentation.Slides.Paste\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 796, "user_id": 2058855, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/x3nq3.jpg?s=128&g=1", "display_name": "Frank H.", "link": "https://stackoverflow.com/users/2058855/frank-h"}, "edited": false, "score": 0, "creation_date": 1565817480, "post_id": 57501932, "comment_id": 101473388, "body": "Are you sure you&#39;re not getting the error on the &quot;DataSheet.Activate&quot; line? DataSheet does not appear to be defined. Try replacing it with <code>ActiveWorkbook.Sheets(&quot;SheetName&quot;).Activate</code> where <i>SheetName</i> is the name of your worksheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 796, "user_id": 2058855, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/x3nq3.jpg?s=128&g=1", "display_name": "Frank H.", "link": "https://stackoverflow.com/users/2058855/frank-h"}, "edited": false, "score": 0, "creation_date": 1565817605, "post_id": 57501932, "comment_id": 101473425, "body": "@FrankH. Presumably <code>DataSheet</code> is the <i>code name</i> of a workshet that exists in <code>ThisWorkbook</code> at compile-time -- and if that&#39;s the case, it&#39;s a million times safer than dereferencing that worksheet by name off whatever workbook is currently active."}, {"owner": {"reputation": 31, "user_id": 11787196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NnhY1_OrBQg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej3pD1Mq70oSoMEhWgu_S_W1JUJA/photo.jpg?sz=128", "display_name": "Claire Spriggs", "link": "https://stackoverflow.com/users/11787196/claire-spriggs"}, "edited": false, "score": 0, "creation_date": 1565817690, "post_id": 57501932, "comment_id": 101473453, "body": "No that did not fix it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1565817747, "post_id": 57501932, "comment_id": 101473469, "body": "The main problem is <code>DataSheet.Activate</code>, with the rest of the code using <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit ActiveSheet references</a>. Instead of <code>Range(&quot;...&quot;)</code>, qualify the member calls with the worksheet you mean to work with: <code>DataSheet.Range(&quot;...&quot;)</code>."}, {"owner": {"reputation": 796, "user_id": 2058855, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/x3nq3.jpg?s=128&g=1", "display_name": "Frank H.", "link": "https://stackoverflow.com/users/2058855/frank-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565817950, "post_id": 57501932, "comment_id": 101473523, "body": "@MathieuGuindon yes of course, but I only suggested using the explicit sheet name to eliminate the possibility of the error being caused by what appears to be an undefined object in the provided code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565818345, "post_id": 57501932, "comment_id": 101473640, "body": "Look, we&#39;re trying to help."}, {"owner": {"reputation": 31, "user_id": 11787196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NnhY1_OrBQg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej3pD1Mq70oSoMEhWgu_S_W1JUJA/photo.jpg?sz=128", "display_name": "Claire Spriggs", "link": "https://stackoverflow.com/users/11787196/claire-spriggs"}, "edited": false, "score": 0, "creation_date": 1565818451, "post_id": 57501932, "comment_id": 101473677, "body": "I very much appreciate it I just don&#39;t  think it is how I am referencing my data sheets as I have used this exact  code on other projects before"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1565818819, "post_id": 57501932, "comment_id": 101473784, "body": "I&#39;ve probably answered this error 1004 question well over 100 times, and pretty much <i>every single time</i>, it was because of implicit ActiveSheet references. So much so, I wrote a code inspection in a VBIDE add-in to locate these buggers. Now, I&#39;m trying to make sense of this code, and it&#39;s extremely difficult for several reasons - variable names with a number suffix changing meaning/purpose over the course of execution being the chief reason. Poor indentation with nested loop structures is another. <code>.Offset</code> is making things even more mind-blowingly hard to track what <code>Count2</code> is."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 9499980, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u041c\u0438\u0445\u0430\u0438\u043b \u041f\u043e\u043f\u043e\u0432", "link": "https://stackoverflow.com/users/9499980/%d0%9c%d0%b8%d1%85%d0%b0%d0%b8%d0%bb-%d0%9f%d0%be%d0%bf%d0%be%d0%b2"}, "is_accepted": false, "score": 0, "last_activity_date": 1565822474, "creation_date": 1565822474, "answer_id": 57502928, "question_id": 57501932, "link": "https://stackoverflow.com/questions/57501932/how-to-fix-run-time-error-1004-method-range-of-object-global-failed/57502928#57502928", "title": "How to fix run-time error 1004 Method Range of object global failed", "body": "<p>Launched your code.\nOn line</p>\n\n<pre><code>Set Cells1 = Range (Count2, Range ('N2'). End (xlDown))\n</code></pre>\n\n<p>Count2 became Nothing</p>\n\n<p>As a solution, move the code</p>\n\n<pre><code>If Count2 Is Nothing Then\n  Exit do\nEnd if\n</code></pre>\n\n<p>Before the line</p>\n\n<pre><code>Set Cells1 = Range (Count2, Range ('N2'). End (xlDown))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1565844817, "creation_date": 1565844817, "answer_id": 57505008, "question_id": 57501932, "link": "https://stackoverflow.com/questions/57501932/how-to-fix-run-time-error-1004-method-range-of-object-global-failed/57505008#57505008", "title": "How to fix run-time error 1004 Method Range of object global failed", "body": "<p>I don't know what your data looks like, but the outer loop breaks on the second iteration with an empty <code>DataSheet</code>, with the error you describe. That's a good thing, because <code>cells1.Address</code> is <code>$N$2:$N$1048576</code> on an empty sheet... but it doesn't matter, because the first empty cell meets the condition and exits the first inner loop.</p>\n\n<p>But that's merely a symptom, not the real problem.</p>\n\n<p>The second loop is iterating the exact same range as the first loop, but this time none of the empty cells meets the condition, and the loop goes on to iterate every single agonizing row on the worksheet.</p>\n\n<p>And when that loop exits, the <code>count2</code> loop variable reference is <code>Nothing</code> - that's why the 2nd iteration explodes: <code>[_Global|Worksheet].Range</code> accepts several different ways to specify a range of cells, but <code>Nothing</code> is an illegal argument to give it; it raises an error, and execution abruptly stops.</p>\n\n<p>What's happening? The VBA language specifications are relevant here:</p>\n\n<blockquote>\n  <p>When the <code>&lt;for-each-statement&gt;</code> has finished executing, the value of <code>&lt;bound-variable-expression&gt;</code> is the data value of the last element in <code>&lt;collection&gt;</code>.</p>\n  \n  <p><sup><sub><a href=\"https://docs.microsoft.com/en-us/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/b132463a-fd25-4143-8fc7-a443930e0651\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/b132463a-fd25-4143-8fc7-a443930e0651</a></sub></sup></p>\n</blockquote>\n\n<p>It seems as per specs, both <code>count1</code> and <code>count2</code> should have a valid object reference when the loops exit. However it seems Microsoft's implementation of the VBA language specifications work differently. Here's a minimal repro example:</p>\n\n<pre><code>Public Sub Test()\n    Dim c As Collection\n    Set c = New Collection\n    c.Add New Collection 'any object will do\n    Dim o As Object\n    For Each o In c\n        'Exit For\n    Next\n    Debug.Print o Is Nothing\nEnd Sub\n</code></pre>\n\n<p>Run this code once with <code>Exit For</code> commented-out, then un-comment the statement and run it again. The \"bound variable\" of a <code>For Each</code> loop that is iterating an object collection will be <code>Nothing</code> <strong>if the loop runs to completion</strong>.</p>\n\n<p>That means if the first inner loop ran to completion, you would be having the same error here:</p>\n\n<blockquote>\n<pre><code>  Set Cells2 = Range(Count1, Range(\"N2\").End(xlDown))\n</code></pre>\n</blockquote>\n\n<p>Because <code>Count1</code> would be <code>Nothing</code> then. On an empty sheet, <code>Count1</code> is pointing to <code>$N$2</code> at this point, so <code>Cells2</code> gets to be <code>$N$2:$N$1048576</code>.</p>\n\n<p><strong>When the second inner loop runs to completion</strong>, <code>Count2</code> is <code>Nothing</code>, and since the loop condition is only looking at <code>Count1</code>...</p>\n\n<blockquote>\n<pre><code> Loop Until Count1 Is Nothing\n</code></pre>\n</blockquote>\n\n<p>...the second iteration of the outer loop blows up when <code>Count2</code> is passed as an argument to <code>_Global.Range</code>, which fails with error 1004:</p>\n\n<blockquote>\n<pre><code>  Set Cells1 = Range(Count2, Range(\"N2\").End(xlDown))\n</code></pre>\n</blockquote>\n\n<p>I suppose a band-aid solution could be to <a href=\"https://stackoverflow.com/a/57502928/1188513\">verify whether <code>Count2 Is Nothing</code> before using it</a>, although that's exactly the same as changing the exit condition to check for both <code>Count1</code> and <code>Count2</code>:</p>\n\n<pre><code>Loop Until Count1 Is Nothing Or Count2 Is Nothing\n</code></pre>\n\n<p>...and I don't think that's the right solution. In fact I'm not sure it's <em>a</em> solution.</p>\n\n<p>I can't be 100% sure because I haven't spent too much time trying to work out how <code>Count2</code> not being <code>Nothing</code> affects the outer loop (plus I didn't have any data to toy with), but I think this <em>might</em> just happen to be doing the same thing:</p>\n\n<pre><code>Dim interestingCells As Range\nSet interestingCells = DataSheet.Range(\"N2:N\" &amp; DataSheet.Rows.Count).End(xlUp)\n\nDim cell As Range\nFor Each cell In interestingCells\n    If cell.Value &lt; 1 And cell.Offset(3).Value &lt; 1 Then\n        cell.Offset(0, 20).Value = cell.Offset(0, -12).Value\n    ElseIf cell.Value &gt; 1 And cell.Offset(3).Value &gt; 1 Then\n        cell.Offset(0, 21).Value = cell.Offset(0, -12).Value\n        cell.Offset(1, 22).Value = cell.Offset(1).Value\n    End If\nNext\n</code></pre>\n\n<p>I honestly think the <em>real</em> solution is to take a step back and re-assess exactly what this loop means to be doing, scrap the old code, and rewrite it from scratch. Anything else would add complexity to an already incredibly hard-to-follow piece of code. Other than the recycled <code>For Each</code> loop variables, the <em>row</em> offsets are particularly confusing: a comment detailing <em>why</em> the next row needs to be affected would be in order - note that such logic probably requires the data to be sorted in a particular way... which might be a bad assumption to make, i.e. a disastrous bug waiting to show its ugly head. Also note that if the iterated range happens to span the entire column, then <code>cell.Offset(n)</code> will fail for any positive value of <code>n</code> when <code>cell</code> is in the very last row, and for any value of <code>n</code> greater than the number of rows left under it if it's <em>near</em> the very last row on the worksheet.</p>\n\n<p>Also note the <code>.End(xlUp)</code> logic to get the last row/cell with data: with that, an empty sheet will not run a single iteration.</p>\n\n<p>Lastly, note the explicitly qualified <code>Range</code> call, so that it resolves to <code>DataSheet.Range</code> rather than <code>_Global.Range</code> - this is one of the very few times I've seen error 1004 thrown by <code>_Global.Range</code> where the root of the issue wasn't the use of unqualified <code>Range</code> calls implicitly referring to whatever the <code>ActiveSheet</code> is.</p>\n"}], "owner": {"reputation": 31, "user_id": 11787196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NnhY1_OrBQg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej3pD1Mq70oSoMEhWgu_S_W1JUJA/photo.jpg?sz=128", "display_name": "Claire Spriggs", "link": "https://stackoverflow.com/users/11787196/claire-spriggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "accepted_answer_id": 57505008, "answer_count": 2, "score": 2, "last_activity_date": 1565874521, "creation_date": 1565816151, "last_edit_date": 1565874521, "question_id": 57501932, "link": "https://stackoverflow.com/questions/57501932/how-to-fix-run-time-error-1004-method-range-of-object-global-failed", "title": "How to fix run-time error 1004 Method Range of object global failed", "body": "<p>Hi I am trying to run this code and it has worked before on other projects so I do not understand why it is not working on this code.</p>\n\n<p>I have tried looking to see if I have  missed stuff from previous code but I don't think I am</p>\n\n<pre><code>    Sub DepolPotential()\n    DataSheet.Activate\n    Dim DepolPotential As Range\n    Dim Count1 As Range\n    Dim Cells1 As Range\n    Dim Count2 As Range\n    Set Cells1 = Range(\"N2\", Range(\"N2\").End(xlDown))\n    Set Cells2 = Range(\"N2\", Range(\"N2\").End(xlDown))\n    Set Count2 = Range(\"N2\")\n\n    Do\n    Set Cells1 = Range(Count2, Range(\"N2\").End(xlDown))\n    Set Count1 = Count2\n    For Each Count1 In Cells1\n      If Count2 Is Nothing Then\n        Exit Do\n      End If\n      If Count1.Value &lt; 1 And Count1.Offset(3, 0).Value &lt; 1 Then\n        Set DepolPotential = Count1.Offset(0, -12)\n         Count1.Offset(0, 20).Value = DepolPotential.Value\n         Exit For\n      End If\n    Next Count1\n    Dim InstOn As Range\n      If Count1 Is Nothing Then\n        Exit Do\n      End If\n   Set Cells2 = Range(Count1, Range(\"N2\").End(xlDown))\n   For Each Count2 In Cells2\n    If Count2.Value &gt; 1 And Count1.Offset(3, 0).Value &gt; 1 Then\n      Set InstOn = Count2.Offset(0, -12)\n      Count2.Offset(0, 21).Value = InstOn.Value\n      Count2.Offset(1, 22).Value = InstOn.Offset(1, 0).Value\n      Set Count2 = Count2.Offset(2, 0)\n      Exit For\n    End If\n   Next Count2\n   Loop Until Count1 Is Nothing\n</code></pre>\n\n<p>I am getting the error on line  </p>\n\n<pre><code>Set Cells1 = Range(Count2, Range(\"N2\").End(xlDown)) \n</code></pre>\n\n<p>I am not sure why I am getting this error in previous codes this did not give me an error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565816446, "post_id": 57501920, "comment_id": 101473093, "body": "Welcome to SO! Your question is unfortunately <i>too broad</i> to be reasonably answerable on this forum - this site is all about <i>specific</i> coding issues, not whiteboard general-idea design. Are you able to populate the customer codes box? <i>How</i> are you populating them? Are you handling the box&#39; <code>Change</code> event? Or are you just struggling to come up with a proper data source for the contact box?"}, {"owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565816600, "post_id": 57501920, "comment_id": 101473132, "body": "Thanks for the response, I will try to elaborate on your specific questions in the hope I can provide enough detail!   The customer code and contacts comboboxes are populated when the UserForm is initialised    cbxCustList.RowSource = &quot;Customers!A2:B&quot; &amp; Sheets(&quot;Customers&quot;).Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Row  The contacts combobox is populated in the same way  cbxConList.RowSource = &quot;Contacts!A2:B&quot; &amp; Sheets(&quot;Contacts&quot;).Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Row  The issue is that the contacts list using the above logic always displays all contacts"}, {"owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565816801, "post_id": 57501920, "comment_id": 101473190, "body": "As a housekeeping point, am I best raising a new question with this detail?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565817217, "post_id": 57501920, "comment_id": 101473319, "body": "Best <a href=\"https://stackoverflow.com/posts/57501920/edit\">edit</a> your question to make it as detailed as possible :)"}, {"owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565817614, "post_id": 57501920, "comment_id": 101473427, "body": "Edited, apologies.. I don&#39;t know what I don&#39;t know! Would including the data structure in my worksheets be helpful?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1565830214, "post_id": 57501920, "comment_id": 101475960, "body": "What I understand is that you have to repopulate Contract combo box with filtered Customer code for a particular customer (selected in customer combo) using Customer combo box change event. To work out the required the code the the layout/details  of contract list along with customer code is required. May please add the details of same or image.."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1565872141, "creation_date": 1565872141, "answer_id": 57509673, "question_id": 57501920, "link": "https://stackoverflow.com/questions/57501920/creating-dependent-comboxes-based-on-relational-data-in-worksheet-rows/57509673#57509673", "title": "Creating dependent comboxes based on relational data in worksheet rows", "body": "<p>Hi I have solved this now using advanced filtering, M2 is populated from the customer combobox. </p>\n\n<pre><code>Dim r As Integer\nr = 2\n    RefData.Range(\"M2\") = cbxCustList.Value\n\n            Sheets(\"Contacts\").Columns(\"A:B\").AdvancedFilter Action:=xlFilterCopy, _\n            CriteriaRange:=RefData.Range(\"M1:M2\"), CopyToRange:=RefData.Range(\"O1:P1\"), Unique:=False\n</code></pre>\n\n<p>cbxCon.Clear</p>\n\n<p>Do Until RefData.Cells(r, 16).Value = \"\"</p>\n\n<pre><code>cbxCon.AddItem RefData.Cells(r, 16).Value\n   r = r + 1\n</code></pre>\n\n<p>Loop\nEnd Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565872141, "creation_date": 1565816086, "last_edit_date": 1565817450, "question_id": 57501920, "link": "https://stackoverflow.com/questions/57501920/creating-dependent-comboxes-based-on-relational-data-in-worksheet-rows", "title": "Creating dependent comboxes based on relational data in worksheet rows", "body": "<p>I am creating a UserForm to record Sales Leads. </p>\n\n<p>One of the comboboxes on the UserForm records the \"Customer Code\" from the \"customers\" worksheet. Another of the comboboxes contains a list of contacts from the \"contacts\" worksheet</p>\n\n<p>Each row on the \"Contact\" worksheet contains the \"Customer Code\" (you may see where this is going by now!) </p>\n\n<p>The \"customers\" worksheet contains a unique list of customers, however the \"Contact\" Worksheet contains numerous contact names per customer. </p>\n\n<p>I need the Contacts combobox to only display contacts based on the selection of customer code from the customer code combobox. </p>\n\n<p>Currently, the customers combobox is populated when the userform is intialized using the below code</p>\n\n<pre><code>cbxCustList.RowSource = \"Customers!A2:B\" &amp; Sheets(\"Customers\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>The contacts box is also populated when the form is initialized </p>\n\n<pre><code>cbxConList.RowSource = \"Contacts!A2:B\" &amp; Sheets(\"Contacts\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>The issue here is that all contacts will always be displayed, the requirement is for the contacts to be filtered based on customer selection. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565814448, "post_id": 57501529, "comment_id": 101472471, "body": "You could use <code>.Text</code> instead of <code>.Value</code> to retrieve what is displayed as formatted instead, but it will be slower."}, {"owner": {"reputation": 294, "user_id": 187793, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/14f3d87905569f88a5ecb6b528eedec7?s=128&d=identicon&r=PG", "display_name": "Unfundednut", "link": "https://stackoverflow.com/users/187793/unfundednut"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565814824, "post_id": 57501529, "comment_id": 101472593, "body": "@braX well changing that fixed the 00:00 issue."}], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 187793, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/14f3d87905569f88a5ecb6b528eedec7?s=128&d=identicon&r=PG", "display_name": "Unfundednut", "link": "https://stackoverflow.com/users/187793/unfundednut"}, "edited": false, "score": 0, "creation_date": 1565815087, "post_id": 57501703, "comment_id": 101472695, "body": "Perfect, thank you. I have been staring at this for far to long."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 294, "user_id": 187793, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/14f3d87905569f88a5ecb6b528eedec7?s=128&d=identicon&r=PG", "display_name": "Unfundednut", "link": "https://stackoverflow.com/users/187793/unfundednut"}, "edited": false, "score": 0, "creation_date": 1565815112, "post_id": 57501703, "comment_id": 101472705, "body": "@Unfundednut I&#39;d recommend explicitly specifying a <code>Delimiter</code> argument for the <code>Split</code> function."}], "tags": [], "owner": {"reputation": 166, "user_id": 11384581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ7fG.jpg?s=128&g=1", "display_name": "TheJeebo", "link": "https://stackoverflow.com/users/11384581/thejeebo"}, "is_accepted": true, "score": 2, "last_activity_date": 1565814944, "creation_date": 1565814944, "answer_id": 57501703, "question_id": 57501529, "link": "https://stackoverflow.com/questions/57501529/excel-vba-subscript-out-of-range-on-0000-split/57501703#57501703", "title": "Excel VBA Subscript Out Of Range on 00:00 Split", "body": "<p>Since rLastRow is a range you need to call the <code>.row</code> property to end the Loop. This with the <code>.Text</code> suggestion should do the trick.</p>\n\n<pre><code>Sub SplitCells()\nRange(\"A2:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).row).Copy Destination:=Range(\"B2\")\nDim rLastRow As Range\nDim row As Integer\nSet ws = Sheets(\"Monthly Queue activity by hour-\")\nrow = 2\nSet rLastRow = Cells(Rows.Count, \"B\").End(xlUp)\nrLastRow = rLastRow - 1\n\nDim TestArray As Variant\nWith ws\n    Do\n        TestArray = Split(CStr(.Cells(row, 1).Text))\n        .Cells(row, 2) = TestArray(1)\n        row = row + 1\n    Loop Until row = rLastRow.row + 1\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 294, "user_id": 187793, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/14f3d87905569f88a5ecb6b528eedec7?s=128&d=identicon&r=PG", "display_name": "Unfundednut", "link": "https://stackoverflow.com/users/187793/unfundednut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57501703, "answer_count": 1, "score": 0, "last_activity_date": 1565814944, "creation_date": 1565814119, "question_id": 57501529, "link": "https://stackoverflow.com/questions/57501529/excel-vba-subscript-out-of-range-on-0000-split", "title": "Excel VBA Subscript Out Of Range on 00:00 Split", "body": "<p>I am looping through a table in Excel with VBA to split the value into the next column. The table looks like this.</p>\n\n<pre><code>+---------------------+---------------------+\n| Interval Start Date | Interval Start Time |\n+---------------------+---------------------+\n| 2019-07-01 04:00    |                     |\n| 2019-07-01 05:00    |                     |\n| 2019-07-01 05:00    |                     |\n| 2019-07-01 05:00    |                     |\n| 2019-07-01 06:00    |                     |\n+---------------------+---------------------+\n</code></pre>\n\n<p>The first column is A the second is B.\nI am using this code that I have written/acquired.</p>\n\n<pre><code>Sub SplitCells()\n    Range(\"A2:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).row).Copy Destination:=Range(\"B2\")\n    Dim rLastRow As Range\n    Dim row As Integer\n    Set ws = Sheets(\"Monthly Queue activity by hour-\")\n    row = 2\n    Set rLastRow = Cells(Rows.Count, \"B\").End(xlUp)\n    rLastRow = rLastRow - 1\n\n    Dim TestArray As Variant\n    With ws\n        Do\n            TestArray = Split(CStr(.Cells(row, 1).Value))\n            .Cells(row, 2) = TestArray(1)\n            row = row + 1\n        Loop Until row = rLastRow\n    End With\nEnd Sub\n</code></pre>\n\n<p>It will give me the Subscript Out Of Range if the timestamp I am splitting out is 00:00. I have tried searching and I can't seem to track down how to fix this.</p>\n\n<p>I remove the entries with the 00:00 timestamp and it works, except I still get the Out Of Range when it reaches the end.</p>\n"}, {"tags": ["excel", "vba", "powershell", "automation"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1565816264, "post_id": 57501447, "comment_id": 101473044, "body": "What&#39;s the reason you want to convert the files? .xls files are still working fine and there is no need to bulk convert them to .xlsx. Why don&#39;t you convert them as you open them over time? If you never open them, chances are you don&#39;t need them, anyway. Other than that, not being very good with scripts does not get you a ticket for a free script here. If you show your efforts and have a question or are stuck, then post your code and you will get help."}, {"owner": {"reputation": 31, "user_id": 10530749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d97411bf405432193e98b4088beedb8?s=128&d=identicon&r=PG&f=1", "display_name": "Flodias", "link": "https://stackoverflow.com/users/10530749/flodias"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1565817389, "post_id": 57501447, "comment_id": 101473366, "body": "@teylyn I need to convert the files to use them with a label software so I can print the data, but the software doesn&#39;t recognize the xls files when I want to import data. My goal is to gain time because i do this task many times during the day so i don&#39;t want to open every files to save them in xlsx it will take me too much time, if I can automate this task it will be great."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1565827673, "post_id": 57501447, "comment_id": 101475586, "body": "So, what have you tried? A simple search for what you want to do has lots of results with code."}, {"owner": {"reputation": 31, "user_id": 10530749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d97411bf405432193e98b4088beedb8?s=128&d=identicon&r=PG&f=1", "display_name": "Flodias", "link": "https://stackoverflow.com/users/10530749/flodias"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1565879177, "post_id": 57501447, "comment_id": 101490534, "body": "@teylyn post edited, can you help me with the automatically run the script when I download an .xls file ?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1565923760, "post_id": 57501447, "comment_id": 101504432, "body": "Thanks for updating the question. This started out as a VBA question, but now you&#39;re using PowerShell. I see that the script simply renames the file to a new file extension. I&#39;m not sure if that is sufficient, since xlsx is a totally different internal format than xls.  The first version of the script opened the file in Excel, then saved it in the new file format.  That would definitely be the preferred way, but I dont know PowerShell. You&#39;ll need to wait for PowerShell expertise to help you out here."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1565929340, "post_id": 57501447, "comment_id": 101505293, "body": "For the OP, look into <code>Workbook.SaveCopyAs</code> @teylyn <code>What&#39;s the reason you want to convert the files?</code> an overabundance of paranoia makes me convert or delete every .xls because they may have macros.  I have macros disabled unless signed - but I still change the Trust Center to disable all macros before opening an .xls   The first thing I do is Alt+F11 and comment out any code.  I convert it to .xlsx if I need the file but the code does not impress, if I am impressed then I save an .xlsx and an .xlsm, otherwise it goes to the Recycle Bin.  It may be overkill but I sleep better at night."}], "owner": {"reputation": 31, "user_id": 10530749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d97411bf405432193e98b4088beedb8?s=128&d=identicon&r=PG&f=1", "display_name": "Flodias", "link": "https://stackoverflow.com/users/10530749/flodias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2249, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1565903418, "creation_date": 1565813703, "last_edit_date": 1565903418, "question_id": 57501447, "link": "https://stackoverflow.com/questions/57501447/automatically-convert-xls-files-to-xlsx", "title": "Automatically convert xls files to xlsx", "body": "<p>I have a software that just allows me to download my data in xls files but I want to use it as an xlsx file.</p>\n\n<p>Currently I have an excel macro when I click on a button it converts all my xls files in xlsx but I want to automate this task so I don't have to open the excel file and click on the button. </p>\n\n<p>I was thinking of a script that start when I log in windows or something like that, and it converts automatically my xls file when I download it. But I'm not very good with scripts so anyone can help me with that ? It's on windows 7 and 10.</p>\n\n<p>Thank you for your help.</p>\n\n<p><strong>Edit:</strong> </p>\n\n<p>Here is my Powershell script, now I have to automate it so that it runs automatically when I download a new .xls file, I know I can use the task scheduler but how can I do that automation on en event like adding a new xls file to a folder ? Or maybe we can do it in powershell ?</p>\n\n<p>My script:</p>\n\n<pre><code>$xlFixedFormat = [Microsoft.Office.Interop.Excel.XlFileFormat]::xlOpenXMLWorkbook\nwrite-host $xlFixedFormat\n$excel = New-Object -ComObject excel.application\n$excel.visible = $false\n$folderpath = \"C:\\Users\\Mgtspare\\Downloads\\\"\n$filetype =\"*xls\"\nGet-ChildItem -Path $folderpath -Include $filetype -recurse | \nForEach-Object `\n{\n    $path = ($_.fullname).substring(0, ($_.FullName).lastindexOf(\".\"))\n\n    \"Converting $path\"\n    $workbook = $excel.workbooks.open($_.fullname)\n\n    $path += \".xlsx\"\n    $workbook.saveas($path, $xlFixedFormat)\n    $workbook.close()\n\n    remove-item $_.fullname\n\n}\n$excel.Quit()\n$excel = $null\n[gc]::collect()\n[gc]::WaitForPendingFinalizers()\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I changed my script to have a new script faster and I put a watcher so I run the script when a new xls file is downloaded, I will use task manager to run this script when I log in windows so it can watch without doing anything.</p>\n\n<p>Here is my new script: </p>\n\n<pre><code>### SET FOLDER TO WATCH + FILES TO WATCH + SUBFOLDERS YES/NO\n    $watcher = New-Object System.IO.FileSystemWatcher\n    $watcher.Path = \"C:\\Users\\Mgtspare\\Downloads\"\n    $watcher.Filter = \"*.xls\"\n    $watcher.IncludeSubdirectories = $false\n    $watcher.EnableRaisingEvents = $true  \n\n### DEFINE ACTIONS AFTER AN EVENT IS DETECTED\n    $action = { \n                $watcher.Path *.xls | rename-item -newname { [io.path]::ChangeExtension($_.name, \"xlsx\") }\n              }    \n### DECIDE WHICH EVENTS SHOULD BE WATCHED \n    Register-ObjectEvent $watcher \"Created\" -Action $action\n    while ($true) {sleep 5}\n</code></pre>\n\n<p><strong>Issue:</strong></p>\n\n<p>My script run in the ISE but when i want to run it in cmd or with the right click on my script file and run with with powershell I have this issue</p>\n\n<blockquote>\n  <p>You must provide a value expression on the right-hand side of the '*' operator.</p>\n</blockquote>\n\n<p><strong>Final solution:</strong></p>\n\n<p>New script automatically run each morning with Task Manager. Enjoy :)</p>\n\n<pre><code>### SET FOLDER TO WATCH + FILES TO WATCH + SUBFOLDERS YES/NO\n    $watcher = New-Object System.IO.FileSystemWatcher\n    $watcher.Path = \"C:\\Users\\Mgtspare\\Downloads\"\n    #$watcher.Filter = \"*.*\"\n    $watcher.IncludeSubdirectories = $true\n    $watcher.EnableRaisingEvents = $true\n\n### DEFINE ACTIONS AFTER AN EVENT IS DETECTED\n    $action = { \n                Get-ChildItem -Path C:\\Users\\Mgtspare\\Downloads *.xls | rename-item -newname { [io.path]::ChangeExtension($_.name, \"xlsx\") }\n              }\n\n### DECIDE WHICH EVENTS SHOULD BE WATCHED \n    Register-ObjectEvent $watcher 'Created' -SourceIdentifier 'FileCreated' -Action $action\n    while ($true) {sleep 1000}\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "edited": false, "score": 0, "creation_date": 1565816839, "post_id": 57501675, "comment_id": 101473199, "body": "Thank you so much! This is exactly what I was looking for and it worked perfectly. I even had that worksheet defined as a variable already, but wasn&#39;t using it for this specific line of code when I should have. I was working around the specific sheet problem by activating the sheet I was working with before doing any &quot;ActiveSheet&quot; functions."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1565815817, "last_edit_date": 1565815817, "creation_date": 1565814829, "answer_id": 57501675, "question_id": 57501271, "link": "https://stackoverflow.com/questions/57501271/copying-table-range-and-pasting-as-value/57501675#57501675", "title": "Copying Table Range and Pasting as Value", "body": "<p>You're making a late-bound member call, so <em>IntelliSense</em> can't help you. Error 438 happens when you code blindfolded against <code>Object</code> or <code>Variant</code>, and try to guess what members exist on the runtime interface of the object you're working with... and the member happens to not exist.</p>\n\n<p><code>ActiveSheet</code> is an <code>Object</code>. Make it a <code>Worksheet</code>.</p>\n\n<pre><code>Dim sh As Worksheet\nSet sh = ActiveSheet 'cast to Worksheet, don't work with Object.\n</code></pre>\n\n<p>Copying and pasting are <code>Range</code> operations, so work with the <code>Range</code> property:</p>\n\n<pre><code>With sh.ListObjects(\"Table62\").ListColumns(5).Range\n    .Copy\n    .PasteSpecial Paste:=xlPasteValues\nEnd With\n</code></pre>\n\n<p>None of the involved properties/objects here are <code>Object</code>, so everything is early-bound and you get autocompletion/intellisense every step of the way. Making sure your code is always early-bound is the single best way to avoid error 438.</p>\n\n<p>That said, working with <code>ActiveSheet</code> is a trap here: if the active sheet doesn't have a table named <code>Table62</code>, expect run-time error 9 \"subscript out of range\". If you mean to be working with a specific worksheet, <em>work with a specific sheet</em>, not just whatever sheet happens to be active.</p>\n"}], "owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 57501675, "answer_count": 1, "score": 1, "last_activity_date": 1565815817, "creation_date": 1565812835, "last_edit_date": 1565814507, "question_id": 57501271, "link": "https://stackoverflow.com/questions/57501271/copying-table-range-and-pasting-as-value", "title": "Copying Table Range and Pasting as Value", "body": "<p>I have some code that updates an inventory sheet from another downloaded report by dropping formulas into some table cells, but I need to change them to just values instead of the formulas after updating.</p>\n\n<p>I just need to copy the full column (which needs to be a variable amount of cells) and then paste it right back into the same spot, but as values. (Similar to manually copying, pasting, and then doing ctrl+v again to paste as values)</p>\n\n<p>I'm open to any solutions as long as the cells become values.</p>\n\n<p>I've tried standard ListObjects Range Copy code with PasteSpecial, but I get an error 438, \"Object doesn't support this property or method\" when it gets to the pasting line. I can't figure out what other options I have based on research I've done.</p>\n\n<pre><code> '''This is the formula going into the cells\n\n ActiveCell.Formula = \"=IF(ISERROR(GETPIVOTDATA(\"\"Sec QTY Sum\"\", '[8-14-19 AM INVENTORY.xls]Sheet2'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\")),0,GETPIVOTDATA(\"\"Sec QTY Sum\"\", '[8-14-19 AM INVENTORY.xls]Sheet2'!$A$4,\"\"Alias\"\",\"\"\" &amp; y &amp; \"\"\"))\"\n\n '''The second line of this code is where it messes up with the error 438\n\n ActiveSheet.ListObjects(\"Table62\").ListColumns(5).Range.Copy\n\n ActiveSheet.ListObjects(\"Table62\").ListColumns(5).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Trying to get values so that the spreadsheet isn't dependent on another spreadsheet being open/unchanged. Getting error message 438</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565813749, "post_id": 57501247, "comment_id": 101472185, "body": "Use an array instead. You can dump a 2D variant array onto a worksheet with a single, essentially-instantaneous operation."}, {"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 1, "creation_date": 1565813784, "post_id": 57501247, "comment_id": 101472202, "body": "See <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">VBA Arrays And Worksheet Ranges</a>."}, {"owner": {"reputation": 53, "user_id": 5106668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d73d6612c0293b88216f215189dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Fernandes", "link": "https://stackoverflow.com/users/5106668/marc-fernandes"}, "edited": false, "score": 0, "creation_date": 1565816356, "post_id": 57501247, "comment_id": 101473069, "body": "Thank you both, I&#39;m having much more success writing the collection to an array, then writing that array to the sheet. Cuts way down on the # of times the sheet is accessed (5 to 100 times rather than 1250 to 25000 times)"}], "owner": {"reputation": 53, "user_id": 5106668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d73d6612c0293b88216f215189dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Fernandes", "link": "https://stackoverflow.com/users/5106668/marc-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565813292, "creation_date": 1565812733, "last_edit_date": 1565813292, "question_id": 57501247, "link": "https://stackoverflow.com/questions/57501247/how-to-more-efficiently-write-a-collection-to-a-worksheet", "title": "How to more efficiently write a collection to a worksheet", "body": "<p>I have a larger code that extracts 250 cells worth of data in one sheet of a workbook (cells are scattered all over the sheet and I need them in a table) and adds it into a collection, to then be written to a single row on a worksheet in another workbook. This code is part of a loop that loops anywhere from 5 to 100 times. The entire code runs rather quickly when looping 5 times but gets bogged down or sometimes even freezes when it loops up to 100 times. In doing some debugging, I found that the speed/freezing issues are entirely isolated to the part of the code that loops through each item in the collection and writes it to the worksheet. Is there a more efficient way to write the collection to the worksheet than what I'm using? Should I transfer the collection to an array then transfer it to the sheet? I've pasted the relevant part of the code below as the whole thing is long but can paste the entire thing on request (not sure it'd help though). I do have the usual code speeding up tricks in place (Application.ScreenUpdating = False, Application.Calculation = xlManual, etc.) already. [note for clarity: colOutput is a Collection and wsOutput is a Sheet, j = the first empty row on the sheet, i is just a counter to iterate through all 250 items in the collection]</p>\n\n<pre><code>For i = 1 To colOutput.Count\n    wsOutput.Cells(j, i) = colOutput(i)\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010", "powerquery"], "comments": [{"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1565831616, "post_id": 57501145, "comment_id": 101476195, "body": "I think it can be done with some excel formulas but there is a potential problem that your results table is either too big or not big enough for all matching results. You may end up having hundreds of empty rows in your results sheet filled will excel formulas (and possibly they are all array formulas). A better approach would be using Power Query (or maybe VBA which is not my specialty). If you are open to the Power Query option, let me know, I can do a demonstration solution for you when I have time. You can also add Power Query to your tag so other PQ contributors can assist you."}, {"owner": {"reputation": 5, "user_id": 11745563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739996845f588a2016e735553d2902ae?s=128&d=identicon&r=PG&f=1", "display_name": "Maram_Safi", "link": "https://stackoverflow.com/users/11745563/maram-safi"}, "reply_to_user": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1565871350, "post_id": 57501145, "comment_id": 101486641, "body": "I would be open to a pq solution. Please let me know when you have time to create it."}], "answers": [{"tags": [], "owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1565938649, "creation_date": 1565938649, "answer_id": 57520176, "question_id": 57501145, "link": "https://stackoverflow.com/questions/57501145/extracting-multiple-columns-with-search/57520176#57520176", "title": "Extracting Multiple Columns with Search", "body": "<p>The following solution is using <strong>Power Query</strong> which is available in <strong>Excel 2010 and later versions</strong>. Mine is <strong>Excel 2016</strong>.</p>\n\n<p>To tackle your question, I used the following sample data. It is stored in an Table called <strong>Tbl_ESP</strong>.</p>\n\n<p>Please note I've added a new column called <strong>Hyperlinks</strong> which displays the link behind each functional hyperlinks in column A. At the moment there is no excel formula to do that automatically so you have to either use <strong>VBA</strong> or manually copy and paste links in the new column. The purpose of this step is to allow you to have the hyperlinks working in the Search Result Table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yczhp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yczhp.png\" alt=\"Tbl_ESP\"></a></p>\n\n<p>In another worksheet I created the following Table called <strong>Tbl_Search</strong>, in which you can type in the key words and it is <strong>case insensitive</strong>. In my solution you can only use '<strong>space</strong>' to separate each key word (you can change the setting to use comma or other preferred delimiter to separate each key word).</p>\n\n<p><a href=\"https://i.stack.imgur.com/sC8Mg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sC8Mg.png\" alt=\"Tbl_Search\"></a></p>\n\n<p>Then you can use <strong>From Table</strong> function in the <strong>Data</strong> tab to add both tables to the Power Query Editor. You can add one first, then exit the editor and add another one using the same function. Check this article out for other methods: <a href=\"https://www.excelcampus.com/install-power-query/\" rel=\"nofollow noreferrer\">The Complete Guide to Installing Power Query</a></p>\n\n<blockquote>\n  <p>I started working with <strong>Tbl_Search</strong> first in the Power Query Editor with the following steps:</p>\n</blockquote>\n\n<ol>\n<li>changed the text string to <strong>lower-case</strong>;</li>\n<li><strong>Split</strong> the text by \"space\" and put each word in a new row; </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/HWOi3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HWOi3.png\" alt=\"Split column\"></a></p>\n\n<ol start=\"3\">\n<li><strong>Filled Down</strong> the column to overwrite null in case there is only one key word;</li>\n<li>Convert the column to a <strong>List</strong>.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/owBOE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/owBOE.png\" alt=\"List\"></a></p>\n\n<p>I have re-named this query as <strong>Search</strong>, which will be used as the search criteria later on.</p>\n\n<blockquote>\n  <p>Then I started working on the <strong>Tbl_ESP</strong> in the following steps:</p>\n</blockquote>\n\n<ol>\n<li><strong>Added a custom column</strong> called <code>Combined</code> to concatenate the strings in <code>Description</code> and <code>KeyWords</code> column into one text string with a space in between;</li>\n<li>convert the text string from last step into <strong>lower-case</strong>;</li>\n<li><strong>Added another custom column</strong> called <code>Match</code> with the following formula, which aims to find out if any of the key words from the <strong>Search</strong> list is contained in the text string from previous step, if so returns <strong>TRUE</strong> otherwise <strong>FALSE</strong>;</li>\n</ol>\n\n<p><code>=List.Count(Splitter.SplitTextByAnyDelimiter(Search)([Combined]))&gt;1</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/xIhCh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xIhCh.png\" alt=\"Match\"></a></p>\n\n<ol start=\"4\">\n<li><strong>Filter</strong> the <code>Match</code> column with <strong>TRUE</strong> only;</li>\n<li><strong>Remove other columns</strong> except <code>Description</code>, <code>KeyWords</code>, and <code>Hyperlinks</code>;</li>\n<li><strong>Added an Index Column</strong> starts from 1 and move this column to the beginning of the table, then I have the following:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/c6WL9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c6WL9.png\" alt=\"Result Table\"></a></p>\n\n<p>Now it's time to <strong>Close and Load</strong> the above table to the worksheet where your Search table sits.</p>\n\n<p><a href=\"https://i.stack.imgur.com/T8f9L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T8f9L.png\" alt=\"Close and Load\"></a></p>\n\n<p>The last step is to add a column to the end of the above table and type in the following formula:</p>\n\n<pre><code>=IF(ISBLANK(G4),LEFT(E4,6)&amp;\" Obsolete\",HYPERLINK(G4,LEFT(E4,6)))\n</code></pre>\n\n<p>Then you should have the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NkhGv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NkhGv.png\" alt=\"Final\"></a></p>\n\n<p>You can choose to <strong>hide Column G</strong> <code>Hyperlinks</code> so it will only show the name of the ESP # with hyperlink embedded.</p>\n\n<p>Each time you type in a new string of key words in the search cell, you need to go to <strong>Data</strong> tab to <strong>Refresh Data</strong>, or press <strong><code>Ctrl+Alt+F5</code></strong> to get an updated search result.</p>\n\n<p>Please note all steps performed above are using <strong>built-in functions</strong> of Power Query Editor, and you can google all the know-hows online but feel free to ask me any questions.</p>\n\n<p>Here are the codes behind the scene for reference only:</p>\n\n<p>For <strong>Tbl_Search</strong></p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Tbl_Search\"]}[Content],\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Search\", type text}}),\n    #\"Lowercased Text\" = Table.TransformColumns(#\"Changed Type\",{{\"Search\", Text.Lower, type text}}),\n    #\"Split Column by Delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Lowercased Text\", {{\"Search\", Splitter.SplitTextByDelimiter(\" \", QuoteStyle.Csv), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Search\"),\n    #\"Filled Down\" = Table.FillDown(#\"Split Column by Delimiter\",{\"Search\"}),\n    Column1 = #\"Filled Down\"[Search]\nin\n    Column1\n</code></pre>\n\n<p>For <strong>Tbl_ESP</strong></p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Tbl_ESP\"]}[Content],\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"ESP #\", type text}, {\"Description\", type text}, {\"KeyWords\", type text}}),\n    #\"Added Custom1\" = Table.AddColumn(#\"Changed Type\", \"Combined\", each [Description]&amp;\" \"&amp;[KeyWords]),\n    #\"Lowercased Text\" = Table.TransformColumns(#\"Added Custom1\",{{\"Combined\", Text.Lower, type text}}),\n    #\"Added Custom\" = Table.AddColumn(#\"Lowercased Text\", \"Match\", each List.Count(Splitter.SplitTextByAnyDelimiter(Search)([Combined]))&gt;1),\n    #\"Filtered Rows\" = Table.SelectRows(#\"Added Custom\", each ([Match] = true)),\n    #\"Removed Other Columns\" = Table.SelectColumns(#\"Filtered Rows\",{\"Description\", \"KeyWords\", \"Hyperlinks\"}),\n    #\"Added Index\" = Table.AddIndexColumn(#\"Removed Other Columns\", \"Index\", 1, 1),\n    #\"Renamed Columns\" = Table.RenameColumns(#\"Added Index\",{{\"Index\", \"#\"}}),\n    #\"Reordered Columns\" = Table.ReorderColumns(#\"Renamed Columns\",{\"#\", \"Description\", \"KeyWords\", \"Hyperlinks\"})\nin\n    #\"Reordered Columns\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11745563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739996845f588a2016e735553d2902ae?s=128&d=identicon&r=PG&f=1", "display_name": "Maram_Safi", "link": "https://stackoverflow.com/users/11745563/maram-safi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 57520176, "answer_count": 1, "score": 0, "last_activity_date": 1565938649, "creation_date": 1565812224, "last_edit_date": 1565895485, "question_id": 57501145, "link": "https://stackoverflow.com/questions/57501145/extracting-multiple-columns-with-search", "title": "Extracting Multiple Columns with Search", "body": "<p>I am having trouble getting my table to extract information across multiple columns. Currently I have two excel sheets:</p>\n\n<p>The first excel sheet is a master log with a giant table filled with the hyperlinks and names of all the Engineering Standard Procedures for my company. This is the table I am extracting information from. </p>\n\n<p><a href=\"https://i.stack.imgur.com/E1Vfy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E1Vfy.png\" alt=\"Master Log\"></a></p>\n\n<p>The second excel sheet is pictured below. It's purpose is that any word typed into the search bar returns any partial results from that first excel sheet in it. Currently my table functions by only searching one column and returning the hyperlink for that esp stated. </p>\n\n<p><a href=\"https://i.stack.imgur.com/NeW1x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NeW1x.png\" alt=\"Search Results\"></a></p>\n\n<p><a href=\"https://imgur.com/a/4GxwBcT\" rel=\"nofollow noreferrer\">Here</a> is the original link to the screenshots. Thanks to the help of @Jvdv. </p>\n\n<p>What I would like is either of the following..</p>\n\n<ol>\n<li>After a keyword is entered into the search bar. The results show the keywords associated with that ESP along with the ESP name and Hyperlink. </li>\n</ol>\n\n<p>For example: If I type in the word Sales. The first column of my extraction table would read \"Material Vendor Identification Chart\" The keywords column would have \"materials sales\" in it and the hyperlink column would provide the respective hyperlink.</p>\n\n<p>or</p>\n\n<ol start=\"2\">\n<li>After a keyword is entered into the search bar. The program searches both the keywords and the Name of the ESP and returns a partial match with the hyperlink.</li>\n</ol>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565812569, "post_id": 57501137, "comment_id": 101471727, "body": "If the <code>TPAID_Autorun = Cells(r, 1)</code> should always refer to what&#39;s on <code>Sheet5</code>, then you need to qualify it as such -- it seems likely that at least one of your other <code>Call</code> procedures is changing the active worksheet/workbook, and as a result the global <code>Cells</code> always refers to <i>whatever worksheet is active</i>, unless qualified to a book/sheet."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565813007, "post_id": 57501137, "comment_id": 101471883, "body": "<code>TPAID_Autorun = ThisWorkbook.Sheet5.Cells(r, 1)</code>. If that still doesn&#39;t solve the problem, then you&#39;ll need to provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Right now you&#39;re calling 6 other functions/subs that are, effectively for anyone trying to help you, black holes. We have no idea what those are doing or how they&#39;re altering the environment during runtime, and without that information, may not be possible to answer fully."}, {"owner": {"reputation": 1, "user_id": 8705686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c56cc3626199cd810c7e9e4242832a?s=128&d=identicon&r=PG&f=1", "display_name": "M. Low", "link": "https://stackoverflow.com/users/8705686/m-low"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565874477, "post_id": 57501137, "comment_id": 101488062, "body": "I went back through all of the call procedures to made sure they were returning to Sheet4 cell C4 (some of them were going back to cell C5). Then I added &quot;Sheet5&quot; to the TPAID_Autorun line and it worked perfectly. Thank you!!!!"}], "owner": {"reputation": 1, "user_id": 8705686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37c56cc3626199cd810c7e9e4242832a?s=128&d=identicon&r=PG&f=1", "display_name": "M. Low", "link": "https://stackoverflow.com/users/8705686/m-low"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565864930, "creation_date": 1565812202, "last_edit_date": 1565864930, "question_id": 57501137, "link": "https://stackoverflow.com/questions/57501137/how-can-i-write-a-vba-loop-to-run-multiple-modules-for-a-list-of-customer-number", "title": "How can I write a VBA Loop to run multiple modules for a list of customer numbers?", "body": "<p>I am trying to automate the creation of customer reporting. I have written the module to update the customer list, the module to create each section of the report for a single customer and the module to save the data to a separate file. I have been unsuccessful in writing the loop to move to the next customer number and rerun the modules for each customer in the list.</p>\n\n<p>I have tried to loop through all of the customer numbers to create separate files. Only the first customer number gets populated, then the cell is blank but the process continues to create new files. I stop the process when the second blank file asks if I want to over write the first blank file.</p>\n\n<pre><code>Sub Update_All()\n\nSheet5.Select\n\nDim FindLastRow As String\n    FindLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nDim LastRow As Integer\nLastRow = FindLastRow\n\n\nFor r = 2 To LastRow\n\nDim TPAID_Autorun As String\nTPAID_Autorun = Cells(r, 1)\n\nSheet4.Range(\"C4\").Value = \"'\" &amp; TPAID_Autorun\n\n'This line was used to test the loop\n'MsgBox Sheet4.Range(\"C4\").Value\n\n\nCall RefreshPayorSummary\nCall ExceptionsToResolve\nCall RefreshPayeeSummary\nCall RefreshNonProfitTINs\nCall RefreshCorrectedTINs\nCall SaveClientFile\n\n\nNext r\n\nEnd \nEnd Sub\n</code></pre>\n\n<p>I am hoping to have all of the files created and the process stop when the customer number is blank.</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565813989, "post_id": 57501127, "comment_id": 101472290, "body": "did you have an url in mind or some test html? Also, is this not possible with an html parser?"}, {"owner": {"reputation": 29, "user_id": 1500370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e925174410c25ef9e135a4096dc2e94e?s=128&d=identicon&r=PG", "display_name": "Colin", "link": "https://stackoverflow.com/users/1500370/colin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565987744, "post_id": 57501127, "comment_id": 101527725, "body": "Sample: &lt;td align=&quot;center&quot; id=&quot;3_T_9&quot; nowrap=&quot;&quot;&gt;6:00:00 AM - 10:00:00 AM&lt;/td&gt;  And you speak of this mystery element called &quot;an html parser&quot; which interests me greatly because I&#39;ve been writing my own forever and ever, ..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1565987876, "post_id": 57501127, "comment_id": 101527773, "body": "can you use snippet tool via <a href=\"https://stackoverflow.com/posts/57501127/edit\">edit</a> to show more of the table html? Preferably all if possible."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 1500370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e925174410c25ef9e135a4096dc2e94e?s=128&d=identicon&r=PG", "display_name": "Colin", "link": "https://stackoverflow.com/users/1500370/colin"}, "edited": false, "score": 0, "creation_date": 1565988648, "post_id": 57501331, "comment_id": 101528028, "body": "I tried my sample from above in the page and it fails."}], "tags": [], "owner": {"reputation": 18299, "user_id": 2191572, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWbVr.png?s=128&g=1", "display_name": "MonkeyZeus", "link": "https://stackoverflow.com/users/2191572/monkeyzeus"}, "is_accepted": false, "score": 0, "last_activity_date": 1565813063, "creation_date": 1565813063, "answer_id": 57501331, "question_id": 57501127, "link": "https://stackoverflow.com/questions/57501127/need-finer-tuning-on-regular-expression-with-html/57501331#57501331", "title": "Need finer tuning on regular expression with html", "body": "<p>It's crude and fails miserably for edge cases but something like this could work:</p>\n\n<pre><code>&lt;[a-zA-Z]{1}[a-zA-Z\\d]*&gt;([^&gt;&lt;]*)&lt;/[a-zA-Z]{1}[a-zA-Z\\d]*&gt;\n</code></pre>\n\n<p><code>$1</code> will contain the inner text</p>\n\n<p><a href=\"https://regex101.com/r/iuLdJV/3\" rel=\"nofollow noreferrer\">https://regex101.com/r/iuLdJV/3</a></p>\n"}], "owner": {"reputation": 29, "user_id": 1500370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e925174410c25ef9e135a4096dc2e94e?s=128&d=identicon&r=PG", "display_name": "Colin", "link": "https://stackoverflow.com/users/1500370/colin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565813063, "creation_date": 1565812144, "question_id": 57501127, "link": "https://stackoverflow.com/questions/57501127/need-finer-tuning-on-regular-expression-with-html", "title": "Need finer tuning on regular expression with html", "body": "<p>What I want to do is to figure out how you use a regular expression to extract the inner most item from a HTML tag collection. That is:\nTARGET TEXT</p>\n\n<pre><code>Function FindInnerHtml(Work As String) As String\nDim Results As String, myRegExp, myMatches As Object, thisMatch As Object\n  Let myRegExp = New RegExp\n  myRegExp.IgnoreCase = True\n  myRegExp.Global = True\n  myRegExp.Pattern = \"&gt;(.*?)&lt;\"\n  Set myMatches = myRegExp.Execute(Work)\n  If (myMatches.Count = 0) Then\n    Results = myMatches(0)\n    Results = Replace$(Replace$(Results, \"&gt;\", \"\"), \"&lt;\", \"\")\n  End If\n  FindInnerHtml = Results\nEnd Function\n</code></pre>\n\n<p>What I do get from the function is the inner HTML, that is the target text, what I would rather be able to do is to ensure I'm not in need of adding that double replace$() to clean up the results.</p>\n"}, {"tags": ["vba", "outlook", "office-interop", "com-automation"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1565986372, "post_id": 57500877, "comment_id": 101527259, "body": "You do not explain why you need a .Net solution.  I would convert this VB.Net code to an Outlook VBA macro.  VBA\u2019s <code>On Error</code> is the equivalent of VB.Net\u2019s <code>Try</code> block although it is not as convenient.  The code to open Outlook would not be needed because the macro would be within Outlook.  Everything else just uses the InterOp to call standard Outlook VBA statements."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1565811847, "creation_date": 1565811847, "answer_id": 57501066, "question_id": 57500877, "link": "https://stackoverflow.com/questions/57500877/migrating-away-from-office-interop-outlook/57501066#57501066", "title": "Migrating away from Office.Interop.Outlook", "body": "<p>There is no other way to open the installed Outlook version with a preformatted email except the <code>mailto</code> protocol. Technology remains the same through all Outlook versions. See <a href=\"https://code.msdn.microsoft.com/office/CSAutomateOutlook-a3b7bdc9\" rel=\"nofollow noreferrer\">C# app automates Outlook (CSAutomateOutlook)</a> for more information.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5838899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bbb79b03385d0f73bad83d4e9183cb?s=128&d=identicon&r=PG&f=1", "display_name": "thinkjohn", "link": "https://stackoverflow.com/users/5838899/thinkjohn"}, "edited": false, "score": 0, "creation_date": 1568053161, "post_id": 57501435, "comment_id": 102144715, "body": "Creating the .EML file works great.  It is not easy as you have to use reflection and create an Extension to Save a System.Net.Mail.MailMessage."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 3, "user_id": 5838899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bbb79b03385d0f73bad83d4e9183cb?s=128&d=identicon&r=PG&f=1", "display_name": "thinkjohn", "link": "https://stackoverflow.com/users/5838899/thinkjohn"}, "edited": false, "score": 0, "creation_date": 1568059445, "post_id": 57501435, "comment_id": 102147268, "body": "EML is a text file (you can open it in Notepad) - you can create a template once and just insert your custom data in the relevant places at run-time."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1565813632, "creation_date": 1565813632, "answer_id": 57501435, "question_id": 57500877, "link": "https://stackoverflow.com/questions/57500877/migrating-away-from-office-interop-outlook/57501435#57501435", "title": "Migrating away from Office.Interop.Outlook", "body": "<p>You can use either a <code>mailto</code> link (which does not support attachments) or create an MSG (binary) or EML (MIME text) file: Outlook will be happy to open and show it. </p>\n\n<p>In the latter case (.EML file), don't forget to add <code>\"X-Unsent: 1\"</code> MIME header to force Outlook to treat the message as unsent and show the Send button.</p>\n"}], "owner": {"reputation": 3, "user_id": 5838899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bbb79b03385d0f73bad83d4e9183cb?s=128&d=identicon&r=PG&f=1", "display_name": "thinkjohn", "link": "https://stackoverflow.com/users/5838899/thinkjohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57501435, "answer_count": 2, "score": 0, "last_activity_date": 1587876204, "creation_date": 1565810782, "last_edit_date": 1587876204, "question_id": 57500877, "link": "https://stackoverflow.com/questions/57500877/migrating-away-from-office-interop-outlook", "title": "Migrating away from Office.Interop.Outlook", "body": "<p>We currently use Microsoft.Office.Interop.Outlook to Open Outlook with a preformatted MailItem.  This is so the user can change any information before the email is sent.</p>\n\n<p>Searched Exchange WebServices but did not find equivalent.</p>\n\n<p>I cleaned the code below as much as possible.  We would like to open a message in the current version of Outlook on our users Desktops.  For now, we have Exchange on prem and Office 2010 we are moving to Office 2016 and O365 in the cloud.</p>\n\n<pre><code>    Public Function OpenOutlookSendWithAttachment(ByVal Subject As String, ByVal Body As String, ByVal FileName As String) As Boolean\n        Dim bSuccess As Boolean = True\n        Dim OutlookApplication As Microsoft.Office.Interop.Outlook.Application\n        Dim OutlookMailItem As Microsoft.Office.Interop.Outlook.MailItem\n\n        Try\n            OutlookApplication = New Microsoft.Office.Interop.Outlook.Application\n            Try\n                If OutlookApplication.Session.Offline Then OutlookApplication.Session.Logon(\"\", \"\", True, True)\n            Catch ex As Exception\n            End Try\n            OutlookMailItem = OutlookApplication.CreateItem(Microsoft.Office.Interop.Outlook.OlItemType.olMailItem)\n            OutlookMailItem.Subject = Subject\n            OutlookMailItem.Body = Body &amp; vbNewLine\n            OutlookMailItem.Attachments.Add(FileName)\n            OutlookMailItem.Display(True)\n        Catch ex As Exception\n            bSuccess = False\n        Finally\n            OutlookMailItem = Nothing\n            OutlookApplication = Nothing\n        End Try\n\n        Return bSuccess\n    End Function\n</code></pre>\n\n<p>Looking for any .Net method to perform the equivalent.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1565809965, "post_id": 57500688, "comment_id": 101470816, "body": "At what line in the code does this occur? What is your code? Are you making the correct references to the worksheets?"}, {"owner": {"reputation": 3, "user_id": 10883287, "user_type": "registered", "profile_image": "https://graph.facebook.com/2370359789671963/picture?type=large", "display_name": "Miriam List", "link": "https://stackoverflow.com/users/10883287/miriam-list"}, "edited": false, "score": 0, "creation_date": 1565810091, "post_id": 57500688, "comment_id": 101470863, "body": "I don&#39;t know if I&#39;m linking it right . The error is coming in the button link Compare2WorkSheets Worksheets(\u201cSheet1\u201d), Worksheets(\u201cSheet2\u201d)"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565810104, "post_id": 57500688, "comment_id": 101470867, "body": "And add the actual text of the code to your question so that we can easily copy/paste it"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565810599, "post_id": 57500688, "comment_id": 101471053, "body": "Instead of pictures"}, {"owner": {"reputation": 3, "user_id": 10883287, "user_type": "registered", "profile_image": "https://graph.facebook.com/2370359789671963/picture?type=large", "display_name": "Miriam List", "link": "https://stackoverflow.com/users/10883287/miriam-list"}, "edited": false, "score": 0, "creation_date": 1565811332, "post_id": 57500688, "comment_id": 101471304, "body": "Now it is fixed bc once I was uploading I could normally upload the pictures. it would only show the link"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565811597, "post_id": 57500688, "comment_id": 101471395, "body": "If all the picture is good for is the text in the picture, then Stack Overflow prefers text rather than the picture."}, {"owner": {"reputation": 3, "user_id": 10883287, "user_type": "registered", "profile_image": "https://graph.facebook.com/2370359789671963/picture?type=large", "display_name": "Miriam List", "link": "https://stackoverflow.com/users/10883287/miriam-list"}, "edited": false, "score": 0, "creation_date": 1565812360, "post_id": 57500688, "comment_id": 101471649, "body": "Can you give me any advice on why I&#39;m getting an error"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1565814371, "post_id": 57500688, "comment_id": 101472430, "body": "A problem I can see from your picture implies that your code line <code>Compare2WorkSheets Worksheets(&quot;Sheet1&quot;), Worksheets(&quot;Sheet2&quot;)</code> <b><i>looks</i></b> like you typed it in a different editor and pasted the code into your VBA editor. I&#39;m saying this because the double-quotes look like smart-quotes (<code>\u201c</code> and <code>\u201d</code>) to me, instead of using the normal double-quote (<code>&quot;</code>)."}, {"owner": {"reputation": 3, "user_id": 10883287, "user_type": "registered", "profile_image": "https://graph.facebook.com/2370359789671963/picture?type=large", "display_name": "Miriam List", "link": "https://stackoverflow.com/users/10883287/miriam-list"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1565851632, "post_id": 57500688, "comment_id": 101479679, "body": "@PeterT thank you a lot. it seems like the problem was  on quotes."}], "owner": {"reputation": 3, "user_id": 10883287, "user_type": "registered", "profile_image": "https://graph.facebook.com/2370359789671963/picture?type=large", "display_name": "Miriam List", "link": "https://stackoverflow.com/users/10883287/miriam-list"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565865004, "creation_date": 1565809820, "last_edit_date": 1565865004, "question_id": 57500688, "link": "https://stackoverflow.com/questions/57500688/how-to-link-module-with-a-button-in-vba", "title": "How to link Module with a Button in VBA", "body": "<p>I open-up VBA and then create a module where I put the code into. I then co create a Comman button (Activex Control) and then link it to the module. </p>\n\n<p>However, I\u2019m doing something wrong because I\u2019m getting an error \u201csubscript out of range\u201d</p>\n\n<p><a href=\"https://i.stack.imgur.com/w1k1A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w1k1A.jpg\" alt=\"Code in Module\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/pn1Vd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pn1Vd.jpg\" alt=\"Button linking to module\"></a></p>\n\n<p>Can anyone give me some advice regarding linking modules with button in VBA</p>\n\n<pre><code>Sub Compare2WorkSheets(ws1 As Worksheet, ws2 As Worksheet)\n\n  Dim ws1row As Long, ws2row As Long, ws1col As Integer, ws2col As Integer\n  Dim maxrow As Long, maxcol As Integer, colval1 As String, colval2 As String\n  Dim report As Workbook, difference As Long\n  Dim row As Long, col As Integer\n\n  Set report = Workbooks.Add\n\n  With ws1.UsedRange\n    ws1row = .Rows.Count\n    ws1col = .Columns.Count\n  End With\n\n  With ws2.UsedRange\n    ws2row = .Rows.Count\n    ws2col = .Columns.Count\n  End With\n\n  maxrow = ws1row\n  maxcol = ws1col\n  If maxrow &lt; ws2row Then maxrow = ws2row\n  If maxcol &lt; ws2col Then maxcol = ws2col\n\n  difference = 0\n\n  For col = 1 To maxcol\n    For row = 1 To maxrow\n      colval1 = \"\"\n      colval2 = \"\"\n      colval1 = ws1.Cells(row, col).Formula\n      colval2 = ws2.Cells(row, col).Formula\n      If colval1 &lt;&gt; colval2 Then\n        difference = difference + 1\n        Cells(row, col).Formula = colval1 &amp; \"&lt;&gt; \" &amp; colval2\n        Cells(row, col).Interior.Color = 255\n        Cells(row, col).Font.ColorIndex = 2\n        Cells(row, col).Font.Bold = True\n      End If\n    Next row\n  Next col\n\n  Columns(\"A:B\").ColumnWidth = 25\n  report.Saved = True\n\n  If difference = 0 Then\n    report.Close False\n  End If\n  Set report = Nothing\n  MsgBox difference &amp; \" cells contain different data! \", vbInformation, _\n         \"Comparing Two       Worksheets\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula", "mismatch"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1565807068, "post_id": 57500118, "comment_id": 101469736, "body": "what does <code>debug.print</code> say the value of <code>Sheets(&quot;Today&quot;).Range(startAddy, endAddy)</code> is?"}, {"owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565807301, "post_id": 57500118, "comment_id": 101469815, "body": "@braX it says it is an empty variant. But startAddy and endAddy both have values assigned to them in the locals window"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565807421, "post_id": 57500118, "comment_id": 101469863, "body": "And what values would those be?"}, {"owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565807482, "post_id": 57500118, "comment_id": 101469890, "body": "@braX startAddy = &quot;$B$2&quot; endAddy = &quot;$B$3&quot;"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565807492, "post_id": 57500118, "comment_id": 101469897, "body": "@abbsichel are you declaring your variables anywhere? (I don&#39;t see that here)"}, {"owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "reply_to_user": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1565807806, "post_id": 57500118, "comment_id": 101470020, "body": "@GlennG no, I am not. I understand it&#39;s a bad habit not to declare my variables but I don&#39;t like to for some reason."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565808128, "post_id": 57500118, "comment_id": 101470141, "body": "If you want to insert a formula via VBA you have to build a string as if you were entering it in the sheet. Think about what you would type and then compare to what you trying to use - how does it differ?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 1, "creation_date": 1565808219, "post_id": 57500118, "comment_id": 101470174, "body": "@abbsichel ok, was just checking in case it was a case of misspell and accidentally created new variable"}], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "edited": false, "score": 0, "creation_date": 1565808574, "post_id": 57500384, "comment_id": 101470301, "body": "So simple, how did I not see that?? Thank you so much!!"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 2, "creation_date": 1565809005, "post_id": 57500384, "comment_id": 101470463, "body": "another way to write that (maybe not the most correct way) is <code>Range(RelAddy).Formula = &quot;=COUNTA(&#39;Today&#39;!&quot; &amp; StartAddy &amp; &quot;:&quot; &amp; EndAddy &amp; &quot;)&quot;</code>"}], "tags": [], "owner": {"reputation": 162, "user_id": 7298188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc774c72bcfc8c9dab142622286a01ba?s=128&d=identicon&r=PG&f=1", "display_name": "rodrigo.cantunes", "link": "https://stackoverflow.com/users/7298188/rodrigo-cantunes"}, "is_accepted": true, "score": 3, "last_activity_date": 1565808307, "creation_date": 1565808307, "answer_id": 57500384, "question_id": 57500118, "link": "https://stackoverflow.com/questions/57500118/type-mismatch-range-formula/57500384#57500384", "title": "Type Mismatch: Range Formula", "body": "<p>The problem is in <code>Range(\"B2\").Formula = \"=COUNTA(\" &amp; Sheets(\"Today\").Range(startAddy, endAddy) &amp; \")\"</code></p>\n\n<p>Try <code>Range(\"B2\").Formula = \"=COUNTA(\" &amp; Sheets(\"Today\").Range(startAddy, endAddy).Address &amp; \")\"</code></p>\n\n<p>In order to use a formula you need to get the Address of the range instead of just the range</p>\n"}], "owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57500384, "answer_count": 1, "score": 1, "last_activity_date": 1565808307, "creation_date": 1565806939, "question_id": 57500118, "link": "https://stackoverflow.com/questions/57500118/type-mismatch-range-formula", "title": "Type Mismatch: Range Formula", "body": "<p>I am completely at a loss as to why I am getting the \"type mismatch\" error. </p>\n\n<p>The error appears on the Range(RelAddy).Formula line.</p>\n\n<pre><code>Sub CallingUserformAssignJC()\n\nBeforeLastRow = Sheets(\"Information\").Cells(Rows.Count, 19).End(xlUp).Row\nSheets(\"Information\").Range(\"U2:U\" &amp; BeforeLastRow).ClearContents\n\nLastRowAC = Sheets(\"Information\").Cells(Rows.Count, 19).End(xlUp).Row\nLastCol = Sheets(\"Today\").Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor j = 1 To LastCol\n    CurrLastRow = Sheets(\"Today\").Cells(Rows.Count, j).End(xlUp).Row\n    startAddy = Sheets(\"Today\").Cells(2, j + 1).Address\n    endAddy = Sheets(\"Today\").Cells(CurrLastRow, j + 1).Address\n    RelAddy = Sheets(\"Today\").Cells(CurrLastRow + 1, j + 1).Address\n    Range(RelAddy).Formula = \"=COUNTA(\" &amp; Sheets(\"Today\").Range(startAddy, endAddy) &amp; \")\"\n    unassignedMilestone = Sheets(\"Today\").Cells(CurrLastRow + 1, j + 1).Value\n    Do While unassignedMilestone &lt;&gt; 0\n        frmAssignJC.Show\n        frmAssignJC.Hide\n    Loop\n    j = j + 3\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>I have looked at the locals window, and startAddy, endAddy, and RelAddy are all type Variant/String. Any help would be appreciated thank you.</p>\n"}, {"tags": ["vba", "search", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 1, "creation_date": 1565811092, "post_id": 57500530, "comment_id": 101471229, "body": "Thanks for the comment but those options dont include the email addresses and unfortunatley I dont have any of those extras you mentioned :( . I did find one method which might work actually though using &quot;<a href=\"http://schemas.microsoft.com/mapi/proptag/0x007D001F\" rel=\"nofollow noreferrer\">schemas.microsoft.com/mapi/proptag/0x007D001F</a>&quot; . This includes the from and to in list format which could allow extracting the values needed since their delimited. I would note though that the bcc does not seem to be included. Also, is there not a header for emails you send? I try to pull this property from my sent box and it doesnt return anything."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1565815923, "post_id": 57500530, "comment_id": 101472956, "body": "PR_TRANSPORT_MESSAGE_HEADERS is only available on the <i>received</i> messages, that is why you do not see it in the Sent Items folder. Take a look at the messages with OutlookSpy (click IMessage button)."}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1565837596, "post_id": 57500530, "comment_id": 101477214, "body": "I am going to give redemption a try but unfortunately our computers are locked down pretty tight so we cannot install any software. Can I download these dll&#39;s and just reference them from the vbe editor and then create object?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1565844599, "post_id": 57500530, "comment_id": 101478227, "body": "You can copy redemption.dll to any folder and register it using regsvr32.exe. It can install itself in HKCU if there is no write access to HKCR."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1565844721, "post_id": 57500530, "comment_id": 101478247, "body": "To create a restriction in Redemption, you can use Recipients / To / CC / BCC properties in a SQL statement used by RDOItems.Find or Restrict. It will use the specified value to match against PR_DISPLAY_NAME / PR_EMAIL_ADDRESS / PR_SMTP_ADDRESS recipient properties."}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1566422769, "post_id": 57500530, "comment_id": 101655927, "body": "How does it install itself in HKCU if there is no write access? Just want to know before trying this due to the strict security settings in our environment."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1566428919, "post_id": 57500530, "comment_id": 101657516, "body": "It installs itself on per-user (HKCU hive) rather than machine-wide (HKCR hive) basis if the current user does not have elevated privileges."}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567534923, "post_id": 57500530, "comment_id": 101988827, "body": "Can it be removed from the HKCU hive easily also and if so how? Thanks as usual!"}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567745479, "post_id": 57500530, "comment_id": 102062630, "body": "Does redemption also allow to suppress security warnings for non MAPI properties such as the outlook model objects like mailitem.body , mailitem.senderemailaddress"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567745629, "post_id": 57500530, "comment_id": 102062656, "body": "Of course - that was the primary reason why it was created almost 20 years ago. Redemption never raises any security prompts, only OOM does."}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567746582, "post_id": 57500530, "comment_id": 102062873, "body": "See I am basically using an excel application that communicates with outlook. All users use the same vb script to open the excel application in read only and the user form initiated. If I am goin to try and use redemption I need to figure out a way to programmatically add redemption either from the vbscript or from inside vba. I\u2019d prefer the vba as when closing the form I want to remove redemption. Does this seem feasible or even logical for that matter? Security is a bit strict here hence all the questions."}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567747164, "post_id": 57500530, "comment_id": 102063004, "body": "Since you have more outlook experience I\u2019m sure this issue has really come across you a bunch. So with some strong programming in the windows api should it be possible to accurately find that button to initiate?. Since that message text remains always I was thinking narrowing down that hwnd for the button may be possible to autopress when available."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567748934, "post_id": 57500530, "comment_id": 102063439, "body": "Which button? The security prompt?"}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567775341, "post_id": 57500530, "comment_id": 102075382, "body": "Yea the allow access checkbox then the allow button. I would think using windows API you could capture the handler of these and initiate them right?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1567791933, "post_id": 57500530, "comment_id": 102083209, "body": "You probably can - there is a product that does this: <a href=\"https://www.contextmagic.com/express-clickyes/\" rel=\"nofollow noreferrer\">contextmagic.com/express-clickyes</a> . But the button is disabled for a few seconds and the prompt cannot be immediately dismissed."}, {"owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1568698512, "post_id": 57500530, "comment_id": 102346046, "body": "So I decided to give redemption a try for this. I added the redemption.dll file to a folder then went to references in the vba editor window and browsed for it and added it. However when I create the redemption object i get a &quot;ActiveX component cannot create object&quot; error. I checked that excel vba its running in is 32bit and so is my outlook. Any ideas why it would do that?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "edited": false, "score": 0, "creation_date": 1568736067, "post_id": 57500530, "comment_id": 102365656, "body": "Have you tried to register the dll with regsvr32.exe?"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1565809040, "creation_date": 1565809040, "answer_id": 57500530, "question_id": 57500026, "link": "https://stackoverflow.com/questions/57500026/fastest-way-to-pull-gettable-recipient-email-addresses-in-outlook-vba/57500530#57500530", "title": "Fastest way to pull getTable() Recipient Email Addresses in Outlook VBA", "body": "<p>Recipient information cannot be pulled from a MAPI table. The best you can do is <code>PR_DISPLAY_TO</code> / <code>PR_DISPLAY_CC</code> / <code>PR_DISPLAY_BCC</code>, but these message properties do not (in general) contain email addresses or entry ids.</p>\n\n<p>You can create search conditions based on the recipient properties, but you'd need Extended MAPI (C++ or Delphi) or Redemption (any language) for that.</p>\n"}], "owner": {"reputation": 161, "user_id": 5021945, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a389fe76ef651c9766c5b4c20657a5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Irish Redneck", "link": "https://stackoverflow.com/users/5021945/irish-redneck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565809040, "creation_date": 1565806517, "question_id": 57500026, "link": "https://stackoverflow.com/questions/57500026/fastest-way-to-pull-gettable-recipient-email-addresses-in-outlook-vba", "title": "Fastest way to pull getTable() Recipient Email Addresses in Outlook VBA", "body": "<p>I have found a few sources on here about individuals trying to get recipient information from a getTable() result and one of the sources pointed to a microsoft forum which the MVP indicates a potential solution but didnt expand on it all. My current code is as follows:</p>\n\n<pre><code>    Set MyTable = MySearch.GetTable\nMyTable.Columns.Add (\"http://schemas.microsoft.com/mapi/proptag/0x0E03001E\")\n\nDo Until MyTable.EndOfTable\n    Set nextRow = MyTable.GetNextRow()\n    For Each OutRecip In Session.GetItemFromID(nextRow(\"EntryID\")).Recipients\n        OutRecip.PropertyAccessor.GetProperty (\"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\")\n    Next\nLoop\n</code></pre>\n\n<p>Currently I have to pull the entry id then find the mail item and then get the recipient list from it. I find it slow and was hoping for a faster method considering I am using the advance search function which the point is to be efficient. Is there any schema property which has the to, cc, and bcc in which I can extract somehow with a text function of some sort in vba?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1565806309, "post_id": 57499916, "comment_id": 101469394, "body": "Maybe turn off automatic calculations as well. There is doubtless a more efficient way of doing things, but with only 366 passes through the loop, there is no reason for code like this to take more than a fraction of a second. This code is interacting with something else. Also -- what does this code have to do with <i>saving</i> data? There is writing to the worksheet, but no saving as saving is usually understood in Excel VBA."}, {"owner": {"reputation": 19, "user_id": 11928747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a21038746a76583f29c47f062417a2df?s=128&d=identicon&r=PG&f=1", "display_name": "anoa anoa", "link": "https://stackoverflow.com/users/11928747/anoa-anoa"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1565815803, "post_id": 57499916, "comment_id": 101472924, "body": "the suggestion to turn off automatic calculations works well. it&#39;s just that I have no idea about automatic calculations. Thank you for the advice"}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 992413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rxVsU.jpg?s=128&g=1", "display_name": "Francisco Araujo", "link": "https://stackoverflow.com/users/992413/francisco-araujo"}, "is_accepted": true, "score": 1, "last_activity_date": 1565816400, "last_edit_date": 1565816400, "creation_date": 1565809380, "answer_id": 57500595, "question_id": 57499916, "link": "https://stackoverflow.com/questions/57499916/save-data-to-long-in-excel-vba/57500595#57500595", "title": "save data to long in excel vba", "body": "<p>You can disable automatic calculation and events to improve processing speed and reenable when you are done processing.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i as Integer\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    For i = 1 To 366 \n    If range(\"C\" &amp; i + 67) &lt;&gt; \"\" Then \n    range(\"E\" &amp; i + 67) = \"EB\": End If\n    If Format(range(\"A\" &amp; i + 67), \"dddd\") = \"Sunday\" Then\n    range(\"E\" &amp; i + 67) = \"AP\"\n    If range(\"D\" &amp; i + 67) = \"\" Then\n    range(\"D\" &amp; i + 67) = \"Aspalt\"\n    End If\n    End If\n    Next i\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic 'just change xlCalculationActomatic t xlCalculationAutomatic\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11928747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a21038746a76583f29c47f062417a2df?s=128&d=identicon&r=PG&f=1", "display_name": "anoa anoa", "link": "https://stackoverflow.com/users/11928747/anoa-anoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57500595, "answer_count": 1, "score": 0, "last_activity_date": 1565865025, "creation_date": 1565805975, "last_edit_date": 1565865025, "question_id": 57499916, "link": "https://stackoverflow.com/questions/57499916/save-data-to-long-in-excel-vba", "title": "save data to long in excel vba", "body": "<p>I made a button for save the results input data. but in process of saving too long. can this process take quickly? this is line I write:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i as Integer\n    Application.ScreenUpdating = False\n    For i = 1 To 366 \n        If range(\"C\" &amp; i + 67) &lt;&gt; \"\" Then \n            range(\"E\" &amp; i + 67) = \"EB\": End If\n        If Format(range(\"A\" &amp; i + 67), \"dddd\") = \"Sunday\" Then\n            range(\"E\" &amp; i + 67) = \"AP\"\n        If range(\"D\" &amp; i + 67) = \"\" Then\n            range(\"D\" &amp; i + 67) = \"Aspalt\"\n        End If\n        End If\n    Next i\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "google-apps-script", "google-sheets"], "comments": [{"owner": {"reputation": 2473, "user_id": 11427375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qg6Nk.jpg?s=128&g=1", "display_name": "ross", "link": "https://stackoverflow.com/users/11427375/ross"}, "edited": false, "score": 1, "creation_date": 1565806106, "post_id": 57499896, "comment_id": 101469309, "body": "Voting to close this as too broad, you have not even included an attempt at converting it yourself."}, {"owner": {"reputation": 457, "user_id": 11826524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58e4792e10b850f5189dcd52b148073?s=128&d=identicon&r=PG", "display_name": "Passer-By", "link": "https://stackoverflow.com/users/11826524/passer-by"}, "edited": false, "score": 0, "creation_date": 1565806222, "post_id": 57499896, "comment_id": 101469357, "body": "So you&#39;re trying to change the background color of a cell/range of cells?"}], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 11826524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58e4792e10b850f5189dcd52b148073?s=128&d=identicon&r=PG", "display_name": "Passer-By", "link": "https://stackoverflow.com/users/11826524/passer-by"}, "edited": false, "score": 1, "creation_date": 1565808961, "post_id": 57500161, "comment_id": 101470446, "body": "I&#39;m curious, is there a purpose or some advantage to declaring range with a logical <code>or</code> or is this some special syntax to declare the type of the variable? To be specific I&#39;m referring to <code>var color=color||&quot;#ffff00&quot;;</code>"}, {"owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "reply_to_user": {"reputation": 457, "user_id": 11826524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58e4792e10b850f5189dcd52b148073?s=128&d=identicon&r=PG", "display_name": "Passer-By", "link": "https://stackoverflow.com/users/11826524/passer-by"}, "edited": false, "score": 2, "creation_date": 1565809635, "post_id": 57500161, "comment_id": 101470699, "body": "It&#39;s just an easy way to get a default if the parameter <code>color</code> is not provided.  You could also say <code>var color=(color!=&quot;undefined&quot;)?color:&#39;#ffff00&#39;;</code>"}, {"owner": {"reputation": 457, "user_id": 11826524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58e4792e10b850f5189dcd52b148073?s=128&d=identicon&r=PG", "display_name": "Passer-By", "link": "https://stackoverflow.com/users/11826524/passer-by"}, "edited": false, "score": 0, "creation_date": 1565809748, "post_id": 57500161, "comment_id": 101470742, "body": "Oh that&#39;s neat, thank you for explaining"}], "tags": [], "owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "is_accepted": false, "score": 1, "last_activity_date": 1565810660, "last_edit_date": 1565810660, "creation_date": 1565807162, "answer_id": 57500161, "question_id": 57499896, "link": "https://stackoverflow.com/questions/57499896/convert-vba-to-google-apps-script/57500161#57500161", "title": "Convert VBA to Google Apps Script", "body": "<p>This will set the color of a range in a spreadsheet:</p>\n\n<pre><code>function setColor(range,color) {\n  var range=range||\"Sheet177!A1:G10\";//default range\n  var color=color||\"#ffff00\";//default color\n  try {\n    SpreadsheetApp.getActive().getRange(range).setBackground(color);//has to be range in form of SheetName!A1:G10\n    //sets the background to yellow as the default\n  }\n  catch(e) {\n    SpreadsheetApp.getUi().alert(e);\n  }\n}\n</code></pre>\n\n<p><a href=\"https://developers.google.com/apps-script/reference/\" rel=\"nofollow noreferrer\">Apps Script Reference</a></p>\n\n<p><a href=\"https://developers.google.com/apps-script/reference/spreadsheet/range\" rel=\"nofollow noreferrer\">Class Range</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7944278, "user_type": "registered", "profile_image": "https://graph.facebook.com/1444448765611467/picture?type=large", "display_name": "Fauzi", "link": "https://stackoverflow.com/users/7944278/fauzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1565816928, "answer_count": 1, "score": -3, "last_activity_date": 1566202775, "creation_date": 1565805883, "last_edit_date": 1566202775, "question_id": 57499896, "link": "https://stackoverflow.com/questions/57499896/convert-vba-to-google-apps-script", "closed_reason": "Needs more focus", "title": "Convert VBA to Google Apps Script", "body": "<p>I would like to convert my VBA to something I can use for Google Apps Script.</p>\n\n<p>This is my VBA Code</p>\n\n<p><code>Function InteriorColor(CellColor As Range)\nApplication.Volatile\nInteriorColor = CellColor.Interior.ColorIndex\nEnd Function</code></p>\n\n<p>But i don't know how to convert that to a Google Apps Script</p>\n"}, {"tags": ["excel", "vba", "constants"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565807376, "post_id": 57499875, "comment_id": 101469841, "body": "Similar/related: <a href=\"https://stackoverflow.com/q/56465548/1188513\">stackoverflow.com/q/56465548/1188513</a>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1565809550, "last_edit_date": 1565809550, "creation_date": 1565809006, "answer_id": 57500523, "question_id": 57499875, "link": "https://stackoverflow.com/questions/57499875/can-i-define-a-constant-in-vba-to-be-used-in-excel-worksheet/57500523#57500523", "title": "Can I define a constant in VBA to be used in Excel worksheet?", "body": "<blockquote>\n  <p>That works, but an actual constant would be better. Is there a way to do that?</p>\n</blockquote>\n\n<p>Nope.</p>\n\n<p>Excel and VBA are two separate things: they talk to each other using a predefined pipeline, and that interface says public procedures in standard modules are exposed as \"macros\", and public functions in standard modules are exposed as user-defined functions. In the other direction, VBA gets to talk to Excel through its object model.</p>\n\n<p>The Excel calc engine knows nothing of the VBA runtime context that's holding the runtime values of your global variables and constants: that's purely on the VBA side of things. In fact, it wouldn't be unreasonable to assume a constant doesn't even exist in the compiled code - that's actually the case in C# code: the compiler \"burns\" the value of constants in-place, at the call sites. I wouldn't be surprised to crack open the compiled p-code and find that all constants are just inlined into their call sites... but that's all just speculation.</p>\n\n<p>For whatever it's worth, that magic-string driven function isn't ideal; callers might end up scratching their heads wondering whether it wants \"KB\", \"Kb\", \"kB\" or \"kb\" (<code>Option Compare Binary</code> being the default string comparison mechanism in VBA, i.e. case-sensitive), or maybe it was \"KiB\"? Make sure the supported values are well-documented, and use <code>StrComp</code> with <em>text</em> rather than <em>binary</em> comparison to make the match case-insensitive.</p>\n\n<p>Consider exposing a single function / UDF per constant. That'll eliminate the magic strings and enhance the UDF usability.</p>\n\n<pre><code>Public Function BytesInKB() As Long\n    BytesInKB = CLng(1024)\nEnd Function\n\nPublic Function BytesInMB() As Long\n    BytesInMB = CLng(1024) ^ 2\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 640, "user_id": 5803910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e96477b88f83ffbe7edd8e993d8f235?s=128&d=identicon&r=PG", "display_name": "NewSites", "link": "https://stackoverflow.com/users/5803910/newsites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1565809550, "creation_date": 1565805761, "question_id": 57499875, "link": "https://stackoverflow.com/questions/57499875/can-i-define-a-constant-in-vba-to-be-used-in-excel-worksheet", "title": "Can I define a constant in VBA to be used in Excel worksheet?", "body": "<p>Instead of using the same defined name in multiple workbooks, can I define a constant in my xlam file that can then be used in all my workbooks?</p>\n\n<p>For example, in VBA:</p>\n\n<pre><code>Public Const nKilobyte = 1024\n</code></pre>\n\n<p>Then in a worksheet:</p>\n\n<pre><code>=A1 / nKilobyte \n</code></pre>\n\n<p>I tried this and I get a <code>#NAME?</code> error. Right now, it looks like a worksheet can refer to functions defined in VBA, but not constants. So as a workaround, I made up the following function:</p>\n\n<pre><code>Public Function vConstant(sName As String) As Variant\n    Select Case sName\n        Case \"kb\": vConstant = 1024\n        Case \"Mb\": vConstant = 1024 ^ 2\n      End Select\nEnd Function\n</code></pre>\n\n<p>which I can then call in a worksheet as:</p>\n\n<pre><code>=A1 / vConstant(\"kb\")\n</code></pre>\n\n<p>That works, but an actual constant would be better. Is there a way to do that?</p>\n"}, {"tags": ["arrays", "excel", "vba", "variant"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1565805507, "post_id": 57499797, "comment_id": 101469083, "body": "You need to specify a delimiter for <code>Split</code>, viz <code>arr = Split(str, &quot;,&quot;)</code>. By default it is space I think."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1565805583, "post_id": 57499797, "comment_id": 101469108, "body": "you can also skip the need for the variable <code>value</code> since you can set M1.value = arr(1)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565805729, "post_id": 57499797, "comment_id": 101469170, "body": "Or just use <code>str = array(15,123,4)</code>."}], "owner": {"reputation": 37, "user_id": 7901587, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/56e8bfa969d453c6fdc5d83820847820?s=128&d=identicon&r=PG&f=1", "display_name": "Jaymes", "link": "https://stackoverflow.com/users/7901587/jaymes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565865069, "creation_date": 1565805309, "last_edit_date": 1565865069, "question_id": 57499797, "link": "https://stackoverflow.com/questions/57499797/how-do-i-assign-the-value-of-an-element-in-an-array-to-a-variable-and-then-assig", "title": "How do I assign the value of an element in an array to a variable and then assign that value to a cell", "body": "<p>I am creating an array, and once created I would like to be able to get the value of each element and put them into a cell. Whenever I try it seems that this is not possible to do. </p>\n\n<pre><code>Sub example()\nDim arr As Variant\nDim str As String\nDim value As String\n\n\nstr = (\"15,123,4\")\narr = Split(str)\nvalue = arr(1)\nRange(\"M1\").value = value\n\n\n\nEnd Sub \n</code></pre>\n\n<p>I would like to be able to collect the values and put them into a cell. Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1565803218, "post_id": 57499227, "comment_id": 101468174, "body": "&quot;it does not seem to work&quot; -- what happens when <code>Count = 999</code>? You may need to move that test to the end of your <code>While</code> block instead of the beginning, when Count = 999 should prevent any subsequent iteration."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1565803365, "post_id": 57499227, "comment_id": 101468228, "body": "Alternatively, <code>While Count &lt;= 10 And Not IsEmpty(Cells(Count, &quot;W&quot;))</code>. Now there are two conditions which break the loop: 1) If count &gt; 10 2) if the cell is empty."}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1565804172, "post_id": 57499429, "comment_id": 101468534, "body": "Ben, i think we were on the exact same path there... thoguh i do have to ask about <code>dim total</code> in your loop; should that not be outside the loop as to not reset <code>total = 0</code>?  if it doesn&#39;t do that, then no worries, but i will say i&#39;ve always treated it similar to <code>set</code> or <code>redim</code> where the memory for it is anew. (same for <code>counter</code>)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1565804962, "post_id": 57499429, "comment_id": 101468852, "body": "@Cyril, no, <code>Dim</code> statements are not executed like that, so <code>total</code> and <code>counter</code> do not &quot;reset.&quot;"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1565803746, "creation_date": 1565803746, "answer_id": 57499429, "question_id": 57499227, "link": "https://stackoverflow.com/questions/57499227/vba-code-to-add-first-10-even-numbers-regardless-of-number-of-inputs-in-a-column/57499429#57499429", "title": "VBA Code to add first 10 even numbers regardless of number of inputs in a column", "body": "<p>Just for fun - here is an approach that uses a <code>For...Next</code> loop, allows for non-numeric entries in Column W, and handles the possibility of blank rows between entries.</p>\n\n<pre><code>Sub TenPosInt()\n    Dim lastRow As Long\n    lastRow = Cells(Rows.Count, \"W\").End(xlUp).Row\n\n    Dim i As Long\n    For i = 1 To lastRow\n        If Not IsEmpty(Cells(i, \"W\")) Then\n            If IsNumeric(Cells(i, \"W\")) Then\n                If Cells(i, \"W\").Value Mod 2 = 0 Then\n                    Dim counter As Long\n                    counter = counter + 1\n\n                    Dim total As Long\n                    total = total + Cells(i, \"W\").Value\n                    If counter = 10 Then Exit For\n                End If\n            End If\n        End If\n    Next\n\n    MsgBox total\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1565804780, "last_edit_date": 1565804780, "creation_date": 1565804046, "answer_id": 57499503, "question_id": 57499227, "link": "https://stackoverflow.com/questions/57499227/vba-code-to-add-first-10-even-numbers-regardless-of-number-of-inputs-in-a-column/57499503#57499503", "title": "VBA Code to add first 10 even numbers regardless of number of inputs in a column", "body": "<p>Why not use a standard <code>for</code> loop across a range?  this would give more specific inputs for the subroutine.</p>\n\n<hr>\n\n<p><em>Description of what is occuring below has been commented out to allow for copy/pasting more easily.</em></p>\n\n<hr>\n\n<p>'Define your range (you use columns(\"W\"), but narrow that)... assuming you start in row 2 (assumes row 1 is headers), move to the last row, of the same columns:</p>\n\n<pre><code>lr = cells(rows.count,\"W\").end(xlup).row\n</code></pre>\n\n<p>'so you know the last row, loop through the rows:</p>\n\n<pre><code>for i = 2 to lr\n</code></pre>\n\n<p>'Now you will be doing your assessment for each cell in column \"W\"</p>\n\n<pre><code>    if isnumeric(cells(i,\"W\").value) AND cells(i,\"W\").value mod 2 = 0 then\n        s = s + cells(i,\"W\").value\n        counter = counter + 1\n        if counter = 10 then exit for\n    end if\n</code></pre>\n\n<p>'Do that for each i, so close the loop</p>\n\n<pre><code>next i\n</code></pre>\n\n<p>'You now have determined a total of 10 items in the range and have added your items.  Print it:</p>\n\n<pre><code>debug.print s\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong> got a comment to not break-up the code in an explanatory fashion, so I have added <code>'</code> to comment out my explanations in an effort to make my coding portion copy/pasteable as a lump.</p>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1565804328, "creation_date": 1565804328, "answer_id": 57499566, "question_id": 57499227, "link": "https://stackoverflow.com/questions/57499227/vba-code-to-add-first-10-even-numbers-regardless-of-number-of-inputs-in-a-column/57499566#57499566", "title": "VBA Code to add first 10 even numbers regardless of number of inputs in a column", "body": "<p>A <code>Do-While/Until</code> loop is recommended instead of <code>While-Wend</code> (see <a href=\"https://stackoverflow.com/questions/32728334/do-while-loop-and-while-wend-loop-whats-the-difference\">this</a>).*</p>\n\n<p>Here I use a separate counter for row and the number of even values (and stole David's idea of combining the two conditions in the <code>Do</code> line).</p>\n\n<pre><code>Sub TenPosInt()\n\nDim Total As Long, r As Long, Count As Long\n\nr = 1\n\nDo Until Count = 10 Or Cells(r, \"W\") = vbNullString\n    If Cells(r, \"W\").Value Mod 2 = 0 Then\n        Total = Total + Cells(r, \"W\").Value\n        Count = Count + 1\n    End If\n    r = r + 1\nLoop\n\nMsgBox Total &amp; \" (\" &amp; Count &amp; \" even numbers)\"\n\nEnd Sub\n</code></pre>\n\n<p>*Actually I would be more inclined to use one of the other gent's answers, but I have tried to stick as close to yours as possible. (Also a good idea to check a cell is numeric before checking for even-ness.)</p>\n"}], "owner": {"reputation": 3, "user_id": 11928488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3212564014e4136098e0278cd02bd1f?s=128&d=identicon&r=PG&f=1", "display_name": "pinedelaconifers", "link": "https://stackoverflow.com/users/11928488/pinedelaconifers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 1, "accepted_answer_id": 57499566, "answer_count": 3, "score": 0, "last_activity_date": 1565865086, "creation_date": 1565802751, "last_edit_date": 1565865086, "question_id": 57499227, "link": "https://stackoverflow.com/questions/57499227/vba-code-to-add-first-10-even-numbers-regardless-of-number-of-inputs-in-a-column", "title": "VBA Code to add first 10 even numbers regardless of number of inputs in a column", "body": "<p>I ran into a problem when I try to add the first 10 even numbers in a column regardless of the number of inputs someone has entered into said column. </p>\n\n<p>The issue occurs when there are less than 10 inputs (in my case 7) and I have tried to break the loop if there are no more numbers after the last one but it doesn't seem to work as it crashes Excel; most probably because it loops infinitely.</p>\n\n<p>The original code was fine until I entered below 10 even numbers. When I did it would loop infinitely and crash so I inputted a forceful break in the code (hence the <code>Count=999</code>) but it does not seem to work</p>\n\n<pre><code>Sub TenPosInt()\n\n    Dim Total As Integer, size As Integer, myRange As range\n    Dim Count  As Integer\n    Count = 1\n    Set myRange = range(\"W:W\")\n    size = WorksheetFunction.CountA(myRange)\n\n    While Count &lt;= 10\n        If IsEmpty(Cells(Count, \"W\")) Then\n            Count = 999\n        End If\n\n        If Cells(Count, \"W\").Value Mod 2 = 0 Then\n            Total = Total + Cells(Count, \"W\").Value\n            Count = Count + 1\n        End If\n    Wend\n\n    MsgBox Total\n\n\nEnd Sub\n</code></pre>\n\n<p>My Inputs are currently <code>2,4,6,5,2,4,6,8,1,3,5</code> so it does not meet the 10 even integers, however I still want it to run regardless (hence the <code>Count=999</code> line). The correct return should be 32.</p>\n"}, {"tags": ["excel", "vba", "pivot"], "owner": {"reputation": 11, "user_id": 11928376, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9KjggagkGDE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd5nnY61L9IBS_8bKZUP9GHuI9GAg/photo.jpg?sz=128", "display_name": "Adiboo", "link": "https://stackoverflow.com/users/11928376/adiboo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565802200, "creation_date": 1565802200, "question_id": 57499093, "link": "https://stackoverflow.com/questions/57499093/vba-pivot-swap-pivot-source-in-a-loop", "title": "VBA pivot swap pivot source in a loop", "body": "<p>I have a loop with pivot tables to create different files from the same source file. Some data is added, then pivoted then the file is saved somewhere under a different name, the file is reused for the next iteration.</p>\n\n<p>As I need the xlDistinctCount function, I am using \n/code</p>\n\n<pre><code>        ActiveWorkbook.PivotCaches.Create(SourceType:=xlExternal, SourceData:= _\n            ActiveWorkbook.Connections(\"Pivot_Data\")\n</code></pre>\n\n<p>/code\nBut that also might be the issue. (I am not familiar with setting Ranges for pivot tables.)</p>\n\n<p>Anyways, right now it is saving the Data from the first iteration and then only part of the data is updated.</p>\n\n<p>'''code''''</p>\n\n<pre><code>Sheets(\"Data\").Select\n                Dim Pivot_Data As Range\n                Set Pivot_Data = Range(\"A3\", ActiveCell.End(xlDown).End(xlToRight))\n                Workbooks(\"SourceFile.xlsx\").Connections.Add2 _\n                    \"Pivot_Data\", \"\", _\n                    \"WORKSHEET; C:\\\\Path\\SourceFile.xlsx]Data\" _\n                    , \"Data!$A$3:$R$1941\", 7, True, False\n                ActiveWorkbook.PivotCaches.Create(SourceType:=xlExternal, SourceData:= _\n                    ActiveWorkbook.Connections(\"Pivot_Data\"), Version _\n                    :=6).CreatePivotTable TableDestination:=\"Pivot!R1C1\", TableName:= _\n                    \"PivotTable1\", DefaultVersion:=6\n\n                Sheets(\"Pivot\").Select\n                Cells(1, 1).Select\n                With ActiveSheet.PivotTables(\"PivotTable1\")\n                    .ColumnGrand = True\n                    .HasAutoFormat = True\n                    .DisplayErrorString = False\n                    .DisplayNullString = True\n                    .EnableDrilldown = True\n                    .ErrorString = \"\"\n                    .MergeLabels = False\n                    .NullString = \"\"\n                    .PageFieldOrder = 2\n                    .PageFieldWrapCount = 0\n                    .PreserveFormatting = True\n                    .RowGrand = True\n                    .PrintTitles = False\n                    .RepeatItemsOnEachPrintedPage = True\n                    .TotalsAnnotation = True\n                    .CompactRowIndent = 1\n                    .VisualTotals = False\n                    .InGridDropZones = False\n                    .DisplayFieldCaptions = True\n                    .DisplayMemberPropertyTooltips = True\n                    .DisplayContextTooltips = True\n                    .ShowDrillIndicators = True\n                    .PrintDrillIndicators = False\n                    .DisplayEmptyRow = False\n                    .DisplayEmptyColumn = False\n                    .AllowMultipleFilters = False\n                    .SortUsingCustomLists = True\n                    .DisplayImmediateItems = True\n                    .ViewCalculatedMembers = True\n                    .FieldListSortAscending = False\n                    .ShowValuesRow = False\n                    .CalculatedMembersInFilters = True\n                    .RowAxisLayout xlCompactRow\n                End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565803531, "post_id": 57499046, "comment_id": 101468287, "body": "Either <code>getElementsByClassName</code> returns <code>Nothing</code> and the implicit <code>.Item(0)</code> call is going against <code>Nothing</code>, or the implicit <code>.Item(0)</code> call yields <code>Nothing</code> and the <code>.Click</code> call is going against <code>Nothing</code>. In either case, that code is doing way too many things and has too many reasons to fail. Break it down into smaller instructions, and <b>validate</b> the object references aren&#39;t <code>Nothing</code> before you make a member call."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565803552, "post_id": 57499046, "comment_id": 101468293, "body": "Could be that <code>Document</code> is <code>Nothing</code>, too."}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565805408, "post_id": 57499046, "comment_id": 101469044, "body": "Thanks for the response. I actually realized that the button should be <code>objIE.Document.getElementsByClassName(&quot;physician-toggle&quot;)(0)&zwnj;&#8203;.Click</code> and not <code>objIE.Document.getElementsByClassName(&quot;physician-toggle active&quot;)(0).Click</code>  When you say too many reasons to fial what are you referring to? I&#39;m a beginner so I&#39;m curious about mistakes I&#39;m making. Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1565807033, "post_id": 57499046, "comment_id": 101469723, "body": "I&#39;m referring to the chained member calls, each assuming the previous was successful. That said I&#39;m not blaming you for it - these chained member calls are everywhere in docs, blogs, and SO answers. <code>Dim physicianToggleButton As Object</code> and go <code>Set physicianToggleButton = objIE.Document.getElementsByClassName(&quot;physician-toggle&quot;)</code> and then <code>If Not physicianToggleButton Is Nothing Then physicianToggleButton(0).Click</code> (else debug.print &quot;could not find element blablabla&quot;), i.e. break things down, validate that you&#39;re getting a valid object reference before you make a member call against it."}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565809028, "post_id": 57499046, "comment_id": 101470472, "body": "Ah, I see. That&#39;s good advice."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1566046005, "post_id": 57503092, "comment_id": 101537336, "body": "Did this answer your question?"}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1566575836, "post_id": 57503092, "comment_id": 101712772, "body": "Thanks for this. This was able to pull incredibly quickly but didn&#39;t pull everything for some reason. I still need to dig deeper into why this is. There are a lot of functions here I don&#39;t completely understand yet"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1566575979, "post_id": 57503092, "comment_id": 101712840, "body": "Can you give me an example of what wasn&#39;t pulled back please? Be specific as possible so I can re-create. As for stuff you don&#39;t undertand - ask away :-)"}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569353448, "post_id": 57503092, "comment_id": 102567691, "body": "For me, it is only pulling about 1/3 of the doctors. I&#39;ve tried to recreate my issue but now I&#39;m getting a run time error 13 on the following line:  <code>numResults = resultsInfo(UBound(resultsInfo))</code> Also sorry for my late response I have been out of the country"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569353780, "post_id": 57503092, "comment_id": 102567831, "body": "Which line is that?"}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569450795, "post_id": 57503092, "comment_id": 102605240, "body": "I&#39;m not sure the best way to reference lines, but its the 36th line after option explicit."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569450839, "post_id": 57503092, "comment_id": 102605253, "body": "You could just paste the line here in comment"}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569538968, "post_id": 57503092, "comment_id": 102639622, "body": "<code>numResults = resultsInfo(UBound(resultsInfo))</code> Gives me runtime error 13"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569550900, "post_id": 57503092, "comment_id": 102641591, "body": "before that line add the line <i>debug.print .document.querySelector(&quot;.paginator&quot;).innerText</i>"}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569867357, "post_id": 57503092, "comment_id": 102727194, "body": "Sorry, I get a compile error when I try to do that, invalid or unqualified unique reference. I might be being dense on this one"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "edited": false, "score": 0, "creation_date": 1569867736, "post_id": 57503092, "comment_id": 102727358, "body": "Put ie in front of the dot"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1565825369, "last_edit_date": 1565825369, "creation_date": 1565824043, "answer_id": 57503092, "question_id": 57499046, "link": "https://stackoverflow.com/questions/57499046/web-scraping-button-clicking-and-help-navigating-through-paths/57503092#57503092", "title": "Web Scraping: Button clicking and help navigating through paths", "body": "<p>You don't need to loop all pages. You can use the browser to get to that page and click on <code>Doctors</code> if required. After that, grab the number of results and then mimic the <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">xhr request</a> the page makes for listings - which is returned as json. Alter the query string the page makes i.e. the parameter for limit to get all listings. Use a json parser (I use jsonconverter - instructions in the code for installation) to parse out your info.</p>\n\n<p>There is a proper page load wait and a couple of loops to ensure elements are present. These should really be timed loops. See loop format <a href=\"https://stackoverflow.com/a/57350051/6241235\">here</a>. </p>\n\n<p>I add an additional test to ensure you do not attempt to click <code>Doctors</code> when it is not required to do so.</p>\n\n<p>Not all listings has all info hence the <code>On Error Resume Next</code> paired with <code>On Error GoTo 0</code>. Looks like you may be able to build a dictionary to fill in some of the blank values based on existing paired values (or using ids present in json object).</p>\n\n<p>I store all results in an array and write out in one go.</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\n' Microsoft Scripting Runtime\n'Download and add to standard module called jsonconverter from https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\nPublic Sub GetListings()\n    Dim ie As InternetExplorer, s As String, json As Object, newUrl As String\n\n    Set ie = New InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://albertafindadoctor.ca/find-a-doc/directory\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document.querySelector(\"[data-cp-option=physician]\")\n            If Not .className = \"physician-toggle active\" Then .Click\n        End With\n\n        Dim resultsInfo() As String, numResults As Long, ele As Object\n\n        Do\n            On Error Resume Next\n            Set ele = .document.querySelector(\".paginator\")\n            On Error GoTo 0\n        Loop While ele Is Nothing\n\n        Do\n        Loop While .document.querySelector(\".paginator\").innerText = vbNullString\n\n        resultsInfo = Split(Trim$(.document.querySelector(\".paginator\").innerText), \"of \")\n\n        .Quit\n    End With\n\n    numResults = resultsInfo(UBound(resultsInfo))\n    newUrl = \"https://albertafindadoctor.ca/search/directory/physicians?page=1&amp;limit=\" &amp; numResults &amp; \"&amp;with[]=pcn&amp;with[]=clinics&amp;with[]=languages&amp;with[]=specialties\"\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", newUrl, False\n        .send\n        Set json = JsonConverter.ParseJson(.responseText)(\"items\")     \n    End With\n\n    Dim row As Object, results(), r As Long, headers(), ws As Worksheet, key As Variant\n\n    headers = Array(\"clinicCategory\", \"clinicName\", \"doctorName\", \"clinicAddress\")\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    ReDim results(1 To json.Count, 1 To UBound(headers) + 1)\n\n    For Each row In json\n        r = r + 1\n        On Error Resume Next\n        For Each key In row.keys\n            Select Case key\n                Case \"clinical_name\"\n                    results(r, 3) = row(key)\n                Case \"pcn\"\n                    results(r, 1) = row(key)(\"name\")\n                Case \"clinics\"\n                    results(r, 2) = row(key)(1)(\"name\")\n                    results(r, 4) = Join$(Array(row(key)(1)(\"street_address\"), row(key)(1)(\"city\"), row(key)(1)(\"province\"), row(key)(1)(\"postal_code\")), \", \")\n            End Select\n        Next\n        On Error GoTo 0\n    Next\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Sample output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ypQ44.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ypQ44.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Reading:</p>\n\n<ol>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector\" rel=\"nofollow noreferrer\">querySelector</a></li>\n<li><a href=\"https://www.json.org/\" rel=\"nofollow noreferrer\">json</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">css selectors</a></li>\n<li><a href=\"http://www.cpearson.com/excel/VBAArrays.htm\" rel=\"nofollow noreferrer\">arrays</a> and <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">arrays2</a></li>\n</ol>\n"}], "owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 57503092, "answer_count": 1, "score": 1, "last_activity_date": 1565825369, "creation_date": 1565801958, "last_edit_date": 1565805532, "question_id": 57499046, "link": "https://stackoverflow.com/questions/57499046/web-scraping-button-clicking-and-help-navigating-through-paths", "title": "Web Scraping: Button clicking and help navigating through paths", "body": "<p>I am trying to scrape some doctor names and addresses from the website: <a href=\"https://albertafindadoctor.ca/find-a-doc/directory\" rel=\"nofollow noreferrer\">https://albertafindadoctor.ca/find-a-doc/directory</a></p>\n\n<p>I am trying to solve the following issue:</p>\n\n<ol>\n<li>Once on the doctor's toggle, I want to pull 4 pieces of data from the entire page, not just the first 25 displayed.</li>\n</ol>\n\n<p>While the code works for the initial webpage, it only pulls the first 25 pieces of data. There are a significant number of other pages that I still need to pull (3822 different doctors). </p>\n\n<p>Unfortunately, I'm at a loss on how to navigate and pull from these different pages. When I inspect elements to see how to navigate between pages a see matrix changing so I'm not sure if that has something to do with it? </p>\n\n<pre><code>Option Explicit\n\nSub GetAlbertaDoctors()\n\n    Dim objIE As InternetExplorer\n    Dim clinicEle As Object\n\n    Dim clinicName As String\n    Dim clinicAddress As String\n    Dim clinicCategory As String\n    Dim doctorName As String\n\n    Dim y As Integer\n\n    Set objIE = New InternetExplorer\n    objIE.Visible = True\n\n    objIE.Navigate \"https://albertafindadoctor.ca/find-a-doc/directory\"\n    While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Wend\n    Application.Wait (Now + TimeValue(\"0:00:5\"))\n    objIE.Document.getElementsByClassName(\"physician-toggle\")(0).Click\n    Application.Wait (Now + TimeValue(\"0:00:5\"))\n\n    y = 2\n\n    For Each clinicEle In objIE.Document.getElementsByClassName(\"clinic\")\n        clinicCategory = clinicEle.getElementsByClassName(\"pcn\")(0).innerText\n        clinicName = clinicEle.getElementsByClassName(\"clinic-name\")(0).innerText\n        doctorName = clinicEle.getElementsByTagName(\"h3\")(0).innerText\n        clinicAddress = clinicEle.getElementsByClassName(\"address\")(0).innerText\n\n        Sheets(\"Sheet2\").Range(\"A\" &amp; y).Value = clinicCategory\n        Sheets(\"Sheet2\").Range(\"B\" &amp; y).Value = clinicName\n        Sheets(\"Sheet2\").Range(\"C\" &amp; y).Value = doctorName\n        Sheets(\"Sheet2\").Range(\"D\" &amp; y).Value = clinicAddress\n\n        y = y + 1\n    Next\n\n    objIE.Quit\nEnd Sub\n</code></pre>\n\n<p>When I run this, I get the error 91 \"Object variable or With block variable not set\" on the clicking line:</p>\n\n<pre><code>objIE.Document.getElementsByClassName(\"physician-toggle active\")(0).Click\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1565801015, "post_id": 57498814, "comment_id": 101467297, "body": "You could just use <code>Find()</code>? e.g. <code>Dim fCell as Range &#47; Set fCell = Worksheets(&quot;Sheet1&quot;).Cells.Find(What:=&quot;Rep 1&quot;)</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1565801830, "post_id": 57498814, "comment_id": 101467641, "body": "You could also use conditional formatting to highlight it...the rule could just be <code>=A1=&quot;Rep 1&quot;</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": false, "score": 1, "last_activity_date": 1565802511, "last_edit_date": 1565802511, "creation_date": 1565801043, "answer_id": 57498887, "question_id": 57498814, "link": "https://stackoverflow.com/questions/57498814/how-to-use-instr-in-vba-to-find-a-cell/57498887#57498887", "title": "How to use Instr in VBA to find a cell", "body": "<p>Use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Find function</a>.</p>\n\n<p>Using a wildcard operator *, this code will find all values that start with Rep (so it covers both, Rep1 and Rep2).\nSets all matches to bold.</p>\n\n<pre><code>Set Results = ActiveSheet.Cells.Find(\"Rep*\", LookIn:=xlValues, MatchCase:=False)\nIf Not Results Is Nothing Then\n   firstAddress = Results.Address\n   Do\n        Results.Font.Bold = True\n        Set Results = ActiveSheet.Cells.FindNext(After:=Results)\n    Loop While Not Results Is Nothing And Results.Address &lt;&gt; firstAddress\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1565801163, "creation_date": 1565801163, "answer_id": 57498908, "question_id": 57498814, "link": "https://stackoverflow.com/questions/57498814/how-to-use-instr-in-vba-to-find-a-cell/57498908#57498908", "title": "How to use Instr in VBA to find a cell", "body": "<p>Looping through the selected cells and \"bold-ing\" the cells with \"Rep 1\" in it is a possible solution:</p>\n\n<p><a href=\"https://i.stack.imgur.com/X4O9s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X4O9s.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub BoldValue()\n\n    Dim myCell As Range\n    Dim char As Long\n\n    For Each myCell In Selection\n        If InStr(1, myCell, \"Rep 1\") &gt; 0 Then\n            myCell.Font.Bold = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11295549, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nITnvDCRLb4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddRarFYloYJdfE8li1OigFRONiFw/mo/photo.jpg?sz=128", "display_name": "Chase Dixon", "link": "https://stackoverflow.com/users/11295549/chase-dixon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1565802511, "creation_date": 1565800750, "last_edit_date": 1565800817, "question_id": 57498814, "link": "https://stackoverflow.com/questions/57498814/how-to-use-instr-in-vba-to-find-a-cell", "title": "How to use Instr in VBA to find a cell", "body": "<p>I am attempting to write a macro that will tell me where in the worksheet is the terms \"Rep 1\" \"Rep 2\" </p>\n\n<p>I am new to VBA and am trying to write this at my internship. I have tried to use a get function but it is not working. I found the Instr function and was curious about how to implement it into my code. </p>\n\n<pre><code>Sub Value()\n    Dim rCell As Range\n    Dim Char As Integer\n    For Each rCell In Selection\n    CharCount = Len(rCell)\n    Char = InStr(1, rCell, \"(\")\n    rCell.Characters(1, Char - 1).Font.Bold = True\n    Next rCell\nEnd Sub\n</code></pre>\n\n<p>This is just an example of what I would like to do.<a href=\"https://i.stack.imgur.com/uGLOg.png\" rel=\"nofollow noreferrer\">Data I Am Using</a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1565803547, "post_id": 57498808, "comment_id": 101468290, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34211496/run-a-macro-from-another-workbook\">this</a> SO question?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11928212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbf8c0a5971f1c7fea49e9df639b88?s=128&d=identicon&r=PG&f=1", "display_name": "Domo", "link": "https://stackoverflow.com/users/11928212/domo"}, "edited": false, "score": 0, "creation_date": 1565801257, "post_id": 57498878, "comment_id": 101467389, "body": "see bottom of post"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11928212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbf8c0a5971f1c7fea49e9df639b88?s=128&d=identicon&r=PG&f=1", "display_name": "Domo", "link": "https://stackoverflow.com/users/11928212/domo"}, "edited": false, "score": 2, "creation_date": 1565802228, "post_id": 57498878, "comment_id": 101467793, "body": "@Domo read up on the basics of how procedure scopes work in VBA. Your largest procedure should be something like 50 lines, tops. 2000 lines is well beyond what&#39;s acceptable. Put it in some <code>Private Sub DoSomething</code> procedure, and then make that msgbox conditional block call <code>DoSomething</code> where this very correct answer says &quot;run your code&quot;."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1565800997, "creation_date": 1565800997, "answer_id": 57498878, "question_id": 57498808, "link": "https://stackoverflow.com/questions/57498808/how-to-use-a-message-box-to-open-a-new-set-of-code-and-run-it/57498878#57498878", "title": "How to use a message box to open a new set of code and run it?", "body": "<p>You can do this: </p>\n\n<pre><code>If MsgBox(\"Would you like to populate the team lists?\", vbOKCancel) = vbOK Then\n    'run your code\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11928212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27dbf8c0a5971f1c7fea49e9df639b88?s=128&d=identicon&r=PG&f=1", "display_name": "Domo", "link": "https://stackoverflow.com/users/11928212/domo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565807016, "creation_date": 1565800732, "last_edit_date": 1565807016, "question_id": 57498808, "link": "https://stackoverflow.com/questions/57498808/how-to-use-a-message-box-to-open-a-new-set-of-code-and-run-it", "title": "How to use a message box to open a new set of code and run it?", "body": "<p>So what I have been doing is running my first set of code which will open new workbooks with specific data and then pasting different code into the new workbooks made and running it.</p>\n\n<p>I was wondering if there is a way to use a message box in the first set of code to run the second set of code at the end?</p>\n\n<pre><code>MsgBox \"Would you like to populate the team lists?\", vbOKCancel\nIf Result = vbYes Then\n</code></pre>\n\n<p>Need to know what to put into the <code>Then</code>. I know I can just put the code in the <code>Then</code> but it's 2000 lines so I was hoping it could run somewhere else.</p>\n"}, {"tags": ["vba", "if-statement", "inputbox"], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 11384581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ7fG.jpg?s=128&g=1", "display_name": "TheJeebo", "link": "https://stackoverflow.com/users/11384581/thejeebo"}, "is_accepted": false, "score": 0, "last_activity_date": 1565817993, "last_edit_date": 1565817993, "creation_date": 1565817301, "answer_id": 57502161, "question_id": 57498694, "link": "https://stackoverflow.com/questions/57498694/how-to-have-an-input-box-pop-up-in-vba-only-if-certain-criteria-is-met/57502161#57502161", "title": "How to have an input box pop up in VBA only if certain criteria is met?", "body": "<p>You should be able to accomplish this with a Do While Loop that will keep going until the user inputs a value or presses cancel. Additionally, you can then place their answer where you need it with the <code>.Value</code> property.</p>\n\n<pre><code>Sub testing123()\n\nDim FileImport As String\nDim AnsBool As Boolean\n\nAnsBool = True\n\nIf Range(\"A4\") &gt; 0 Then\n\n    FileImport = InputBox(\"File Not Yet Imported, Please Provide Reasoning\")\n\n    Do While AnsBool\n        If StrPtr(FileImport) = 0 Then Exit Sub\n        If FileImport &lt;&gt; \"\" Then Exit Do\n        MsgBox \"Please Provide Reasoning\"\n        FileImport = InputBox(\"File Not Yet Imported, Please Provide Reasoning\")\n    Loop\nEnd If\n\n'You can change this to the range needed\nRange(\"A1\").Value = FileImport\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11928330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935f6890f55ed021ae1d2ef36d334e3b?s=128&d=identicon&r=PG&f=1", "display_name": "Drewnick10", "link": "https://stackoverflow.com/users/11928330/drewnick10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565817993, "creation_date": 1565800240, "last_edit_date": 1565800417, "question_id": 57498694, "link": "https://stackoverflow.com/questions/57498694/how-to-have-an-input-box-pop-up-in-vba-only-if-certain-criteria-is-met", "title": "How to have an input box pop up in VBA only if certain criteria is met?", "body": "<p>I'm attempting to set up an input box that will come up if the value in a certain cell (I4) is greater than 0.  I then want to make it so that if nothing is entered in the cell it will prompt the user to enter information.  If the user presses cancel, then the macro should stop.</p>\n\n<pre><code>Sub testing123()\n\nRe_Enter_FileImport:\nFileImport = InputBox(\"File Not Yet Imported, Please Provide Reasoning\")\n\nIf Range(\"I4\") &lt;&gt; 0 Then\n    Answer = FileImport\n\n 'Code if user pressed cancel\n\nIf StrPtr(FileImport) = 0 Then\n    Exit Sub\n\nElseIf FileImport = \"\" Then\n    MsgBox \"Please Provide Reasoning\"\n    GoTo Re_Enter_FileImport:\nElse\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>When I try this code, the Input Box pops up no matter if the info in cell I4 is 0 or not.  Also, how do I define where the user's answer will be entered?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1565801521, "post_id": 57498672, "comment_id": 101467522, "body": "That&#39;s an add-in, right? Can you try recording macro and using it to see what code it produces, if any?"}, {"owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1565805068, "post_id": 57498672, "comment_id": 101468897, "body": "Well, I think it is! I tried recording macro, but it appears nothing sadly."}], "answers": [{"comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1587905172, "post_id": 57499479, "comment_id": 108687152, "body": "Good answer, even though no easy solution for VBA devs! I&#39;d suggest if the method is exposed, then simply make the API call from VBA. But yeah, last resort is AA (should be oleacc.dll or oleaut.dll from memory) . I actually prefer UIAutomationCore.dll these days, although it can be slow if not done right. But it is easier to script IMHO"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 3, "last_activity_date": 1565803966, "creation_date": 1565803966, "answer_id": 57499479, "question_id": 57498672, "link": "https://stackoverflow.com/questions/57498672/how-to-classify-e-mail-in-outlook-before-sending-from-excel/57499479#57499479", "title": "How to classify e-mail in Outlook before sending from Excel", "body": "<p>These controls belong to the Azure Information Protection add-in. Unfortunately, Office (nor VBA or VSTO) doesn't provide any trivial way for customizing a custom UI or dealing with it. Your options are listed below:</p>\n\n<ol>\n<li>Try to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/office.commandbars.executemso\" rel=\"nofollow noreferrer\">CommandBars.ExecuteMso</a> method which executes the control identified by the <code>idMso</code> parameter. You must find the ID of controls you need to launch programmatically.</li>\n<li>Ask or find the command which is run by clicking the corresponding button in the UI. Note, you can use a late biding technology for that. So, you could call the method from VBA. Read more about that in the <a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/walkthrough-calling-code-in-a-vsto-add-in-from-vba?view=vs-2019\" rel=\"nofollow noreferrer\">Walkthrough: Call code in a VSTO Add-in from VBA</a> article.</li>\n<li>Use <a href=\"https://docs.microsoft.com/en-us/windows/win32/winauto/microsoft-active-accessibility\" rel=\"nofollow noreferrer\">Microsoft Active Accessibility</a> API. Microsoft Active Accessibility is a Component Object Model (COM)-based technology that improves the way accessibility aids work with applications running on Microsoft Windows. It provides dynamic-link libraries that are incorporated into the operating system as well as a COM interface and API elements that provide reliable methods for exposing information about UI elements.</li>\n</ol>\n\n<p>Anyway, I'd suggest contacting AIP add-in developers. </p>\n"}], "owner": {"reputation": 311, "user_id": 10176057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ca2na.jpg?s=128&g=1", "display_name": "Guilherme Matheus", "link": "https://stackoverflow.com/users/10176057/guilherme-matheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "accepted_answer_id": 57499479, "answer_count": 1, "score": 0, "last_activity_date": 1587876217, "creation_date": 1565800159, "last_edit_date": 1587876217, "question_id": 57498672, "link": "https://stackoverflow.com/questions/57498672/how-to-classify-e-mail-in-outlook-before-sending-from-excel", "title": "How to classify e-mail in Outlook before sending from Excel", "body": "<p>I've got a macro in Excel that send e-mail through Outlook and it works perfectly.\nBut in my company they recently added an e-mail classification.\nCan I insert on my code?</p>\n\n<p>Example: If send 2.000 e-mails at once, I'll have to click 2.000 times on any of the classification button.</p>\n\n<p>The language is in Portuguese (Brazil), so by order is: Confidential, Reserved, Internal, Public.</p>\n\n<p>Classification:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mcT9l.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mcT9l.jpg\" alt=\"Example of Classification\"></a></p>\n\n<pre><code>    Sub ContatoAtivo()\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Dim OutlookApp As Object\n    Dim OutlookMail As Object\n    Dim xTexto As String\n    Dim Texto As String\n    Dim X, Y, Z As Integer\n    Dim Email As String\n    Dim Assunto As String\n    Dim Qtd As Integer\n    Dim rng As Range\n\n    Qtd = Planilha2.ListObjects(1).DataBodyRange.Rows.Count\n\n    For X = 1 To 1\n        Email = Planilha2.Cells(X + 6, 8).Value\n        Subject = Planilha3.Cells(11, 1).Value\n\n        If Email &lt;&gt; \"\" Then\n\n            Set rng = Nothing\n            Set rng = Planilha3.Range(\"E12:F22\").SpecialCells(xlCellTypeVisible)\n\n            Set OutlookApp = CreateObject(\"Outlook.Application\")\n            Set OutlookMail = OutlookApp.CreateItem(0)\n\n            Text = \"Test\"\n\n            With OutlookMail\n                .To = \"test.test@test.com.br\"\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = Planilha3.Range(\"A5\").Value &amp; \" | \" &amp; Subject\n                .HTMLBody = Text\n                '.Display\n                .Send\n\n            End With\n\n            Set OutlookMail = Nothing\n            Set OutlookApp = Nothing\n\n            Texto = \"\"\n\n        End If\n\n    Next X\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565800383, "post_id": 57498613, "comment_id": 101467057, "body": "You are mixing up syntax for evaluating functions in VBA and implanting worksheet functions in the sheet using VBA. So you need <code>application.index</code> etc and ensure your range syntax is consistent - see how yours changes - the match bit is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "is_accepted": true, "score": 2, "last_activity_date": 1565800692, "creation_date": 1565800692, "answer_id": 57498799, "question_id": 57498613, "link": "https://stackoverflow.com/questions/57498613/using-index-match-in-vba-between-two-sheets/57498799#57498799", "title": "Using index,match in vba between two sheets?", "body": "<p>You want to have the other sheet also included in the lookup of match.</p>\n\n<p>Assuming that you have variables set to Sheet1 and Sheet2 that are worksheets, you could do this.</p>\n\n<pre><code>=WorksheetFunction.Index(Sheet1.Range(\"J96:J143\"),_\n WorksheetFunction.Match(Sheet2.Range(\"B4\"), Sheet1.Range(\"H96:H143\"),0))\n</code></pre>\n\n<p>The VBA documentation is helpful here for both <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.index\" rel=\"nofollow noreferrer\">Index</a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match\" rel=\"nofollow noreferrer\">Match</a></p>\n"}], "owner": {"reputation": 51, "user_id": 11765363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ffaee7b71f8eab85d195a0783444fc0?s=128&d=identicon&r=PG&f=1", "display_name": "jrwaller", "link": "https://stackoverflow.com/users/11765363/jrwaller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 57498799, "answer_count": 1, "score": 0, "last_activity_date": 1565865122, "creation_date": 1565799912, "last_edit_date": 1565865122, "question_id": 57498613, "link": "https://stackoverflow.com/questions/57498613/using-index-match-in-vba-between-two-sheets", "title": "Using index,match in vba between two sheets?", "body": "<p>I am taking a name from one sheet, indexing/matching to get data from a chart in another sheet, and then performing a calculation with that data. I am getting syntax errors with the line trying to perform the matching.</p>\n\n<p>I have also tried vbLookup with similar syntax errors.</p>\n\n<p>I have based this section of code off of this simple video:\n<a href=\"https://www.youtube.com/watch?v=BIGH-Q8cnrI\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=BIGH-Q8cnrI</a>\nI have also seen some stack overflow questions where users are trying to call data from different workbooks.</p>\n\n<p>Say I am trying to Match \"Maryland\" from a cell (B4) in sheet2 to the following chart(in Range H96:J143 on sheet1), using this index to call the land cost value next to it.</p>\n\n<pre><code>State      Region     Land Cost\nDelaware    NE         8300\nMaryland    NE         6620\nNew Jersey  NE         12900\n</code></pre>\n\n<p>where my code to call this out right now is:</p>\n\n<pre><code>'statecost = Application.VLookup(Range(\"B4\").Text, Sheet1.Range(\"H96:J143\"), 2, False)\nstatecost =Index(Sheet1.Range(\"J96:J143\"),match(B4,H96:H143,0))\n</code></pre>\n\n<p>I would want these lines to spit out a statecost = 6620. The index/match section gives me syntax errors while the vblookup line gives me no match.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba", "copy-paste", "paste", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 11449605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e5ec0e95934c7c7db67125924e4979?s=128&d=identicon&r=PG&f=1", "display_name": "skedaddle_waznook", "link": "https://stackoverflow.com/users/11449605/skedaddle-waznook"}, "edited": false, "score": 0, "creation_date": 1565798767, "post_id": 57498148, "comment_id": 101466320, "body": "I was afraid of this situation. <code>ActiveSheet.Name</code> for me in the the second module does show <code>Sheet1</code> to be active, using <code>MsgBox &quot;Sheet 2 was activated, and ActiveSheet.Name gives: &quot; &amp; ActiveSheet.Name</code> in the module code. Thank you, though!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1565798007, "creation_date": 1565798007, "answer_id": 57498148, "question_id": 57497806, "link": "https://stackoverflow.com/questions/57497806/activation-event-getting-triggered-by-pastespecial-operation/57498148#57498148", "title": "Activation event getting triggered by PasteSpecial operation", "body": "<p>It seems to be one of the odd things you may have when dealing with Excel: <code>PasteSpecial</code> quickly \"activates\" the sheet you are pasting to. You can see the screen flicker (at least I can, using a VM that is rather slow when it comes to screen updating). Also, if you put similar event code to sheet2, you will see that it is triggered also. </p>\n\n<p>The strange thing is that in the triggered sheet you see still sheet1 as <code>ActiveSheet</code>. So the following code (as event routine of Sheet2) will print <em>\"activate 2 Sheet1\"</em></p>\n\n<pre><code>Public Sub Worksheet_Activate()\n     Debug.Print \"activate 2 \" &amp; ActiveSheet.Name\nEnd Sub\n</code></pre>\n\n<p>I doubt that you will find any documentation for that behaviour. And your best bet is to accept this and (as you already wrote) use <code>Application.EnableEvents = False</code> </p>\n"}], "owner": {"reputation": 310, "user_id": 11449605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e5ec0e95934c7c7db67125924e4979?s=128&d=identicon&r=PG&f=1", "display_name": "skedaddle_waznook", "link": "https://stackoverflow.com/users/11449605/skedaddle-waznook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 57498148, "answer_count": 1, "score": 1, "last_activity_date": 1565801593, "creation_date": 1565796722, "last_edit_date": 1565801593, "question_id": 57497806, "link": "https://stackoverflow.com/questions/57497806/activation-event-getting-triggered-by-pastespecial-operation", "title": "Activation event getting triggered by PasteSpecial operation", "body": "<p>While programming a module in VBA that operates on copy-pasting a range based on formulae on a sheet, the currently activated sheet's <code>Worksheet_Activate</code> event is triggered.</p>\n\n<p>I know that I can use <code>Application.EnableEvents = False</code> to disable the trigger, however, I would like to understand why the <code>PasteSpecial</code> operation for a <code>Range</code> object triggers the <code>Worksheet_Activate</code> method, as I cannot find any mention of the same on the Range.PasteSpecial <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.pastespecial\" rel=\"nofollow noreferrer\">documentation</a>, or what <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.activate%28even%29\" rel=\"nofollow noreferrer\">actions trigger</a> the <code>Worksheet_Activate</code> event.</p>\n\n<p>For a reproducible example, please create a workbook with two sheets, <code>Sheet1</code> and <code>Sheet2</code>, and insert code in <code>Sheet1</code> as so:</p>\n\n<pre><code>Public Sub Worksheet_Activate()\n\n    MsgBox \"Sheet 1 has been activated.\"\n\nEnd Sub\n</code></pre>\n\n<p>Add a separate module with code as so:</p>\n\n<pre><code>Public Sub copy_and_paste_in_sheet2()\n\n    Set Rng1 = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A1:A10\")\n    Rng1.Copy\n\n    Set rng2 = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"B2:B12\")\n    rng2.PasteSpecial xlPasteFormulas\n\nEnd Sub\n</code></pre>\n\n<p><strong>While <code>Sheet1</code> is activated</strong>, run the <code>copy_and_paste_in_sheet2</code> macro, and it will be evident that the <code>Worksheet_Activate</code> event for <code>Sheet1</code> is triggered despite no apparent code in the second module explicitly doing so.</p>\n\n<p>I would expect that notwithstanding any use of <code>Select</code> operations that require the <code>Activate</code> command to work, the <code>PasteSpecial</code> operation should not ideally trigger the <code>Worksheet_Activate</code> event. Could you please direct me to the relevant documentation for this behaviour?</p>\n"}, {"tags": ["excel", "vba", "sorting"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "edited": false, "score": 0, "creation_date": 1565797886, "post_id": 57497865, "comment_id": 101465897, "body": "I tried recording a macro on sorting out the values. But I selected Sort from &quot;Smallest to Largest&quot; by using Filter found in Excel ribbon. The recorded code is actually very similar to the one i found online.., I would paste it here but there is a limit to the no. of characters in the comments. Where can I include <code>=ABS(B2-Sheet2!$A$1)</code> in the recorded macro? I am really not sure..so sorry about it.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "edited": false, "score": 0, "creation_date": 1565799176, "post_id": 57497865, "comment_id": 101466508, "body": "ok...so i digged deeper and did you mean something like this: ` =INDEX(A1:A20,MATCH(MIN(ABS(A1:A20-D1)),ABS(A1:A20-D1),0))` ? But am I also able to do this in VBA? Whereby <code>If col &lt;&gt; &quot;&quot; Then</code> ....Then sort using the formula?"}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1565804865, "post_id": 57497865, "comment_id": 101468817, "body": "Add an extra column to the data you are trying to sort that has the formula I suggested. Sort on that column. The reason I suggested to record the macro was so you could see how it was done. You can run that macro each time"}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": false, "score": 1, "last_activity_date": 1565796955, "creation_date": 1565796955, "answer_id": 57497865, "question_id": 57497781, "link": "https://stackoverflow.com/questions/57497781/vba-sort-column-by-the-closest-value-to-answer-closest-answer-will-appear-at/57497865#57497865", "title": "VBA - Sort column by the closest value to answer. Closest answer will appear at the top of the sorted list", "body": "<p>Add a helper column.<br>\nUse the formula <code>=ABS(B2-Sheet2!$A$1)</code> (assuming your answer is in A1 of sheet2).<br>\nSort by the helper column.  </p>\n\n<p>Record a macro that does the sort, so you can see the code Excel creates. It's more wordy than the code you tend to find online, so you may have to trim it down, but the code should work.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565797329, "creation_date": 1565796586, "last_edit_date": 1565797329, "question_id": 57497781, "link": "https://stackoverflow.com/questions/57497781/vba-sort-column-by-the-closest-value-to-answer-closest-answer-will-appear-at", "title": "VBA - Sort column by the closest value to answer. Closest answer will appear at the top of the sorted list", "body": "<p>I am trying to automatically sort a column in excel using VBA. </p>\n\n<p>I want the closest value to my answer (my answer is found in sheet 2 but its hidden) to appear at the top of the sorted list. (The answer will be in a separate sheet, say sheet2, but my list will be in sheet1)</p>\n\n<p>for example, my answer is 4,000 and the closest answer is 3,998. I want the row where the answer is 3,998 to be shifted to the top of the list and likewise sort for all the other rows. So the whole list will be sorted based on which ones are the closest to the answer.</p>\n\n<p>This is the sorting code I found online, but idk how to include the part where I can sort according to my answer in another cell. Is that even possible?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nIf Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\nRange(\"B1\").Sort Key1:=Range(\"B2\"), _\nOrder1:=xlAscending, Header:=xlYes, _\nOrderCustom:=1, MatchCase:=False, _\nOrientation:=xlTopToBottom\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1565798260, "post_id": 57497723, "comment_id": 101466108, "body": "I&#39;m very curious about whether Word and the rest of Office breaks in the same way."}, {"owner": {"reputation": 685, "user_id": 373915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa7779b8497e0823b067168cc819d3?s=128&d=identicon&r=PG", "display_name": "Dave Huang", "link": "https://stackoverflow.com/users/373915/dave-huang"}, "edited": false, "score": 2, "creation_date": 1565808797, "post_id": 57497723, "comment_id": 101470388, "body": "I&#39;m seeing the same thing too :( VB6 apps also break. BTW, I think this is a problem with the August 2019 Windows update, rather than a problem with an Office update. At least uninstalling KB4512501 fixes the problem for me."}, {"owner": {"reputation": 685, "user_id": 373915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1fa7779b8497e0823b067168cc819d3?s=128&d=identicon&r=PG", "display_name": "Dave Huang", "link": "https://stackoverflow.com/users/373915/dave-huang"}, "edited": false, "score": 0, "creation_date": 1565814546, "post_id": 57497723, "comment_id": 101472505, "body": "I reported this breaking change to MS via the Feedback Hub: <a href=\"https://aka.ms/AA5uz8p\" rel=\"nofollow noreferrer\">aka.ms/AA5uz8p</a>"}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "is_accepted": false, "score": 2, "last_activity_date": 1565796427, "creation_date": 1565796427, "answer_id": 57497742, "question_id": 57497723, "link": "https://stackoverflow.com/questions/57497723/sending-object-array-to-variant-works-before-august-2019-windows-update-but-fai/57497742#57497742", "title": "Sending object array to variant works before August 2019 Windows update, but fails after update", "body": "<p>To fix, change the ByVal to ByRef in the function:</p>\n\n<pre><code>Public Sub RunMe()\n  Dim wksTestArray() As Worksheet\n  MsgBox SendArrayToFunction(wksTestArray())\nEnd Sub\n\nPublic Function SendArrayToFunction(ByRef vntArray As Variant) As Boolean\n  SendArrayToFunction = True\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 106, "user_id": 2874604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFMAv.jpg?s=128&g=1", "display_name": "Ben Siron", "link": "https://stackoverflow.com/users/2874604/ben-siron"}, "edited": false, "score": 3, "creation_date": 1565832711, "post_id": 57503661, "comment_id": 101476366, "body": "I also received this error after I got this update when I tried creating an empty array by calling the Array() function in VBA with no arguments.  Uninstalling the update made this problem go away."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 106, "user_id": 2874604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFMAv.jpg?s=128&g=1", "display_name": "Ben Siron", "link": "https://stackoverflow.com/users/2874604/ben-siron"}, "edited": false, "score": 0, "creation_date": 1566088939, "post_id": 57503661, "comment_id": 101545929, "body": "@BenSiron There is a workaround for creating empty arrays <a href=\"https://stackoverflow.com/a/57540873/9439330\">stackoverflow.com/a/57540873/9439330</a>"}, {"owner": {"reputation": 106, "user_id": 2874604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFMAv.jpg?s=128&g=1", "display_name": "Ben Siron", "link": "https://stackoverflow.com/users/2874604/ben-siron"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1566269125, "post_id": 57503661, "comment_id": 101593432, "body": "@ComputerVersteher confirmed the workaround works as an alternative to calling Array().  Though I still had to uninstall the update because I also use functions with ParamArray parameters which I was calling with zero arguments.  I also had trouble figuring out how to install KB4517298 on Windows 10."}, {"owner": {"reputation": 993, "user_id": 433069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce5a6c5a55242bccf4b1cc226a7c0b0f?s=128&d=identicon&r=PG", "display_name": "aolszowka", "link": "https://stackoverflow.com/users/433069/aolszowka"}, "edited": false, "score": 0, "creation_date": 1566579231, "post_id": 57503661, "comment_id": 101714279, "body": "Installing KB4517298 fixes this issue for us; but triggers this issue: <a href=\"https://stackoverflow.com/questions/17312657/winapi-createdc-hangs-on-win-8/57630317#57630317\" title=\"winapi createdc hangs on win 8\">stackoverflow.com/questions/17312657/&hellip;</a> which is not good."}, {"owner": {"reputation": 106, "user_id": 2874604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFMAv.jpg?s=128&g=1", "display_name": "Ben Siron", "link": "https://stackoverflow.com/users/2874604/ben-siron"}, "edited": false, "score": 1, "creation_date": 1567287759, "post_id": 57503661, "comment_id": 101922594, "body": "I&#39;ve been watching <a href=\"https://docs.microsoft.com/en-us/windows/release-information/status-windows-10-1903#629msgdesc\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/release-information/&hellip;</a> and saw that Microsoft recently released KB4512941 to fix this issue on 8/30.  I installed KB4512508 thru windows update as before, restarted, then checked for updates again.  KB4512941 showed up, I then installed that which took 15 minutes and a restart.  The problem no longer occurs.  (I&#39;m running Windows 10)"}], "tags": [], "owner": {"reputation": 1050, "user_id": 1640090, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Agqxf.png?s=128&g=1", "display_name": "vbguyny", "link": "https://stackoverflow.com/users/1640090/vbguyny"}, "is_accepted": false, "score": 6, "last_activity_date": 1565997993, "last_edit_date": 1565997993, "creation_date": 1565830228, "answer_id": 57503661, "question_id": 57497723, "link": "https://stackoverflow.com/questions/57497723/sending-object-array-to-variant-works-before-august-2019-windows-update-but-fai/57503661#57503661", "title": "Sending object array to variant works before August 2019 Windows update, but fails after update", "body": "<p>The update affects VB6, VBA (including all versions of Office) as well as VBScript!</p>\n\n<p>Microsoft is currently looking into the issue: <a href=\"https://support.microsoft.com/en-us/help/4512488/windows-8-1-update-kb4512488\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/4512488/windows-8-1-update-kb4512488</a> (look at the last row under the section entitled \"Known issues in this update\")</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Microsoft just released a patch for this issue: <a href=\"https://support.microsoft.com/en-us/help/4517298/windows-8-1-update-kb4517298\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/4517298/windows-8-1-update-kb4517298</a></p>\n"}, {"comments": [{"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 1, "creation_date": 1566054306, "post_id": 57534709, "comment_id": 101539274, "body": "Currently this patch seems to be only for Windows 10 version <b>1709</b>."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1566073568, "post_id": 57534709, "comment_id": 101543557, "body": "Yes, each version a specific patch. The next patches should follow soon."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1566219063, "post_id": 57534709, "comment_id": 101576035, "body": "Meanwhile there are some more patches for different Windows 10 versions."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1566073581, "last_edit_date": 1566073581, "creation_date": 1566031430, "answer_id": 57534709, "question_id": 57497723, "link": "https://stackoverflow.com/questions/57497723/sending-object-array-to-variant-works-before-august-2019-windows-update-but-fai/57534709#57534709", "title": "Sending object array to variant works before August 2019 Windows update, but fails after update", "body": "<p>For Windows 10 version 1709, this issue has been corrected with this update:</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/4512494/windows-10-update-kb4512494\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/4512494/windows-10-update-kb4512494</a></p>\n"}], "owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 2, "answer_count": 3, "score": 10, "last_activity_date": 1566304355, "creation_date": 1565796356, "last_edit_date": 1565961191, "question_id": 57497723, "link": "https://stackoverflow.com/questions/57497723/sending-object-array-to-variant-works-before-august-2019-windows-update-but-fai", "title": "Sending object array to variant works before August 2019 Windows update, but fails after update", "body": "<p>Running the subroutine RunMe works before August 2019 Windows update.</p>\n\n<p>Running the subroutine RunMe fails after August 2019 Windows update. It reports the following error message: \"Invalid procedure call or argument (Error 5)\"</p>\n\n<pre><code>Public Sub RunMe()\n  Dim wksTestArray() As Worksheet\n  MsgBox SendArrayToFunction(wksTestArray())\nEnd Sub\n\nPublic Function SendArrayToFunction(ByVal vntArray As Variant) As Boolean\n  SendArrayToFunction = True\nEnd Function\n</code></pre>\n\n<p>Please note: The error only occurs for an unallocated array.</p>\n\n<p>It can be useful for a function to accept a Variant, which can be either an Array of values, or an Array of objects, for example, IsArrayAllocated is an example function where this would be required.</p>\n\n<p>Is there a fix?</p>\n"}, {"tags": ["vba", "get", "filenames"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1565795948, "post_id": 57497268, "comment_id": 101464888, "body": "You asked 5 questions, and none were marked as answered. please respect the repliers and if you get a valid answer, mark it as such."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11062610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEFxr9bA1lU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNXm5HlTV7IXCo-4sikasj70c-Q6A/mo/photo.jpg?sz=128", "display_name": "Balasubramanian Seshadri", "link": "https://stackoverflow.com/users/11062610/balasubramanian-seshadri"}, "edited": false, "score": 0, "creation_date": 1565874170, "post_id": 57497531, "comment_id": 101487898, "body": "Thanks for your reply and reminding to mark as answered."}, {"owner": {"reputation": 5, "user_id": 11062610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEFxr9bA1lU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNXm5HlTV7IXCo-4sikasj70c-Q6A/mo/photo.jpg?sz=128", "display_name": "Balasubramanian Seshadri", "link": "https://stackoverflow.com/users/11062610/balasubramanian-seshadri"}, "edited": false, "score": 0, "creation_date": 1566043213, "post_id": 57497531, "comment_id": 101536815, "body": "Hi Patrick, For learning, If the Function GetFileNames(ByVal FolderPath As String) As Variant doesn&#39;t return anything, Function GetFileNames, How to retrieve the filenames from result variable. Thanks and Regards, Balu."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1565796118, "last_edit_date": 1565796118, "creation_date": 1565795581, "answer_id": 57497531, "question_id": 57497268, "link": "https://stackoverflow.com/questions/57497268/vba-excel-get-filenames-from-a-folder/57497531#57497531", "title": "VBA excel get filenames from a folder", "body": "<p>At first reading, I think your function is OK, but you use it badly.<br>\nI would use (quickly written - not tested, sorry)</p>\n\n<pre><code>Sub GetFileNamesToExcel()\n    dim ar \n    ar = GetFileNames(\"d:\\somefolder\")\n    'for results on a row\n    range(\"a1\").resize(1,ubound(ar))= ar  \n    'for results in column (more probably what you want)\n    range(\"a1\").resize(ubound(ar),1) = application.transpose(ar)\nEnd Sub\n</code></pre>\n\n<p>And you definitely don't need to use Result as a global variable. That's generally a bad practice, unless you have a specific reason to do that.</p>\n"}], "owner": {"reputation": 5, "user_id": 11062610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GEFxr9bA1lU/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNXm5HlTV7IXCo-4sikasj70c-Q6A/mo/photo.jpg?sz=128", "display_name": "Balasubramanian Seshadri", "link": "https://stackoverflow.com/users/11062610/balasubramanian-seshadri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565796118, "creation_date": 1565794755, "question_id": 57497268, "link": "https://stackoverflow.com/questions/57497268/vba-excel-get-filenames-from-a-folder", "title": "VBA excel get filenames from a folder", "body": "<p>From the below function I not able get the filenames to excel. Result variable is blank. Please help.</p>\n\n<pre><code>Dim Result As Variant\n\nFunction GetFileNames(ByVal FolderPath As String) As Variant\nDim i As Integer\nDim MyFile As Object\nDim MyFSO As Object\nDim MyFolder As Object\nDim MyFiles As Object\nSet MyFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet MyFolder = MyFSO.GetFolder(FolderPath)\nSet MyFiles = MyFolder.Files\nReDim Result(1 To MyFiles.Count)\ni = 1\nFor Each MyFile In MyFiles\nResult(i) = MyFile.Name\ni = i + 1\nNext MyFile\nGetFileNames = Result\nEnd Function\n\nSub GetFileNamesToExcel()\nFor Each MyFile In MyFiles\nResult(i) = MyFile.Name\nActiveCell.Cells(i, 1).Value = Result(i)\ni = i + 1\nNext MyFile\nEnd Sub\n</code></pre>\n\n<p>Thanks for your help.\nRegards,\nBalu.</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 11, "user_id": 11927788, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157826075860809/picture?type=large", "display_name": "Brad Farkas", "link": "https://stackoverflow.com/users/11927788/brad-farkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565794414, "creation_date": 1565794414, "question_id": 57497155, "link": "https://stackoverflow.com/questions/57497155/copy-column-between-tables-replicates-first-cell-in-target-rather-than-copying-c", "title": "Copy Column between tables replicates first cell in target rather than copying column", "body": "<p>I'm copying a column of formulas between 2 tables of similar size and format.  I can copy values between tables with no problem, but if I try to copy formulas, and there is a formula in the first row of the source data, that formula gets replicated to the whole target column and the rest of the source data is ignored.  Works fine if there are other formulas in source as long as none is in the first row.</p>\n\n<p>I've tried turning off autofill with</p>\n\n<pre><code>Application.AutoCorrect.AutoFillFormulasInLists = False (doesn't work)\n</code></pre>\n\n<p>Also tried using:</p>\n\n<pre><code>SrcTable.DataBodyRange.Columns(1).Copy DestTable.DataBodyRange.Columns(1)  \n</code></pre>\n\n<p>but it results in absolute table column references so if a source formula referred to a column in its own table, it would refer back to that column rather than a column of the same name in the new table (doesn't work for my case).</p>\n\n<pre><code>DestTable.DataBodyRange.Columns(1).Formula = _\nSrcTable.DataBodyRange.Columns(1).Formula\n</code></pre>\n\n<p>The above code works as I need it to, as long as a formula isn't in the first row of the source column.  Anyone know how to make it work in that use case without having to copy the first row separately to avoid the inexplicable replication problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1565794550, "post_id": 57497154, "comment_id": 101464074, "body": "I would put all the items inside an array and then loop through them all, using a Range variable to find the item for each loop and if it&#39;s found, insert the row. Pretty simple."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1565795312, "post_id": 57497154, "comment_id": 101464538, "body": "As per your example, I would loop through, set a string variable to the first item (add row) then match the cell values to the string, and when it returns different, insert a row and set the string to the new value."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 10609408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05205d061d53c93f7dc53cfec02ec877?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10609408/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1565795667, "creation_date": 1565795667, "answer_id": 57497546, "question_id": 57497154, "link": "https://stackoverflow.com/questions/57497154/how-to-insert-row-above-below-groups-in-a-column-using-vba/57497546#57497546", "title": "How to insert row above/below groups in a column using VBA", "body": "<p>Here's a subroutine that should do what you're looking for. </p>\n\n<pre><code>Sub main()\n    Dim lastRow As Long\n    Dim firstFruit As String\n\n    With Sheets(\"Sheet1\")\n        'find last row containing a value\n        lastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        'initialize our first fruit as the first cell with a value.\n        firstFruit = .Cells(1, 1).Value\n\n        For ctr = 1 To lastRow\n            If (.Cells(ctr, 1).Value &lt;&gt; firstFruit) Then 'we've found a new fruit\n                .Rows(ctr &amp; \":\" &amp; ctr).Insert 'insert our row above where we found it\n                firstFruit = .Cells(ctr + 1, 1).Value 'set our fistFruit to equal the value of the new fruit\n                lastRow = lastRow + 1 'add +1 to lastRow because we've added a new one\n            End If\n        Next ctr\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11909135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e592eff7f87409d0862f92442c9c17?s=128&d=identicon&r=PG&f=1", "display_name": "CaptJackSparrow", "link": "https://stackoverflow.com/users/11909135/captjacksparrow"}, "edited": false, "score": 1, "creation_date": 1565797911, "post_id": 57497636, "comment_id": 101465909, "body": "This worked great, thanks.   In the line <code>For i = 1 To 15</code> , I changed 15 to 500 since I do have many rows that I am working with. Is it possible to find the last row and enter that number in place of the 15?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 13, "user_id": 11909135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e592eff7f87409d0862f92442c9c17?s=128&d=identicon&r=PG&f=1", "display_name": "CaptJackSparrow", "link": "https://stackoverflow.com/users/11909135/captjacksparrow"}, "edited": false, "score": 0, "creation_date": 1565798060, "post_id": 57497636, "comment_id": 101465994, "body": "Yes of course you can. Make sure you declare <code>lRow</code> as a long, and you should be good to go."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 13, "user_id": 11909135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e592eff7f87409d0862f92442c9c17?s=128&d=identicon&r=PG&f=1", "display_name": "CaptJackSparrow", "link": "https://stackoverflow.com/users/11909135/captjacksparrow"}, "edited": false, "score": 0, "creation_date": 1565798207, "post_id": 57497636, "comment_id": 101466078, "body": "@CaptJackSparrow I have edited my answer above for your use. Don&#39;t forget to mark it as the answer if it works for you so the ticket can be closed :)"}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": true, "score": 1, "last_activity_date": 1565798163, "last_edit_date": 1565798163, "creation_date": 1565795997, "answer_id": 57497636, "question_id": 57497154, "link": "https://stackoverflow.com/questions/57497154/how-to-insert-row-above-below-groups-in-a-column-using-vba/57497636#57497636", "title": "How to insert row above/below groups in a column using VBA", "body": "<p>Here is some code that will do what you want.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub LoopAddRow()\n\n    Dim i As Long\n    Dim sTemp As String\n    Dim ws As Worksheet\n\n    Set ws = Sheets(\"Sheet2\")\n\n    For i = 1 To 15\n        If i = 1 Then\n            sTemp = ws.Cells(i, 1).Value\n            ws.Rows(i).EntireRow.Insert\n        Else\n            If ws.Cells(i, 1).Value &lt;&gt; sTemp Then\n                sTemp = ws.Cells(i, 1).Value\n                ws.Rows(i).EntireRow.Insert\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Before &amp; After below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VWxGG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VWxGG.png\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT: Added <code>lRow</code> variable, per OP request</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub LoopAddRow()\n\n    Dim i As Long\n    Dim sTemp As String\n    Dim ws As Worksheet\n    Dim lRow As Long\n\n    Set ws = Sheets(\"Sheet2\")\n    lRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    For i = 15 To lRow\n        If i = 1 Then\n            sTemp = ws.Cells(i, 1).Value\n            ws.Rows(i).EntireRow.Insert\n        Else\n            If ws.Cells(i, 1).Value &lt;&gt; sTemp Then\n                sTemp = ws.Cells(i, 1).Value\n                ws.Rows(i).EntireRow.Insert\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11909135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e592eff7f87409d0862f92442c9c17?s=128&d=identicon&r=PG&f=1", "display_name": "CaptJackSparrow", "link": "https://stackoverflow.com/users/11909135/captjacksparrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 57497636, "answer_count": 2, "score": 1, "last_activity_date": 1565798163, "creation_date": 1565794410, "question_id": 57497154, "link": "https://stackoverflow.com/questions/57497154/how-to-insert-row-above-below-groups-in-a-column-using-vba", "title": "How to insert row above/below groups in a column using VBA", "body": "<p>I am having trouble even starting a macro for this. Any help would be greatly appreciated. </p>\n\n<p>Referring to the example below, is it possible to find the first value of a group and insert a row above it. Such as: find the first \"apple\" in column A and insert row above, find the first \"banana\" in column A and insert row above, etc. It would also work to find the last value in a group and insert row below, such as: find the last \"apple\" in column A and insert row below. </p>\n\n<p>Also needed is if there are no \"apple\"s in column A, move on to \"banana\"s. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code> \t  A\r\n1\tapple\r\n2\tapple\r\n3\tapple\r\n4\tapple\r\n5\tbanana\r\n6\tbanana\r\n7\tbanana\r\n8\tbanana\r\n9\tbanana\r\n10\torange\r\n11\torange\r\n12\torange\r\n13\torange\r\n14\torange\r\n15\torange</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1565794986, "post_id": 57497074, "comment_id": 101464342, "body": "That seems to have solved that problem. I&#39;ve updated my original post with the 2 remaining issues - I appreciate your help!"}, {"owner": {"reputation": 88, "user_id": 8359424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c43d8d88c23001b0b5ad5d98efd4be?s=128&d=identicon&r=PG&f=1", "display_name": "JAclark", "link": "https://stackoverflow.com/users/8359424/jaclark"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 1, "creation_date": 1565795107, "post_id": 57497074, "comment_id": 101464407, "body": "Do you mean that you have to click your button again to reset after it shows the next number? Or that it briefly shows the next number before automatically resetting? If the latter, you may want to use <code>application.screenupdating = false</code> to avoid seeing those in-between steps. Though make sure to set screenupdating back to true before you end the subroutine lol."}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 1, "creation_date": 1565795253, "post_id": 57497074, "comment_id": 101464502, "body": "That seems to have solved problem 1, thanks! Any ideas about problem 2?"}, {"owner": {"reputation": 88, "user_id": 8359424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c43d8d88c23001b0b5ad5d98efd4be?s=128&d=identicon&r=PG&f=1", "display_name": "JAclark", "link": "https://stackoverflow.com/users/8359424/jaclark"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1565796485, "post_id": 57497074, "comment_id": 101465215, "body": "Honestly not too sure. My first instinct was to see if editing the counter messed anything up, but I can&#39;t see anywhere where that would be the case. Glad i could help at least halfway though!"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1565797102, "post_id": 57497074, "comment_id": 101465518, "body": "Ah I had this issue before I started including a counter. Thanks for your help though, appreciate it!"}], "tags": [], "owner": {"reputation": 88, "user_id": 8359424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6c43d8d88c23001b0b5ad5d98efd4be?s=128&d=identicon&r=PG&f=1", "display_name": "JAclark", "link": "https://stackoverflow.com/users/8359424/jaclark"}, "is_accepted": true, "score": 2, "last_activity_date": 1565794123, "creation_date": 1565794123, "answer_id": 57497074, "question_id": 57496932, "link": "https://stackoverflow.com/questions/57496932/excel-vba-using-a-counter-to-count-filter-results/57497074#57497074", "title": "Excel VBA: Using a counter to count filter results", "body": "<p>Your <code>If</code> statement doesn't reset the <code>counter</code> variable. Consider changing your <code>Then</code> statement to simply making <code>counter</code> = 1</p>\n\n<pre><code>    If ActiveSheet.Shapes(\"txtbox1\").DrawingObject.Text = First_Row_Filtered Then counter = 1\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 57497074, "answer_count": 1, "score": 0, "last_activity_date": 1565795412, "creation_date": 1565793636, "last_edit_date": 1565795412, "question_id": 57496932, "link": "https://stackoverflow.com/questions/57496932/excel-vba-using-a-counter-to-count-filter-results", "title": "Excel VBA: Using a counter to count filter results", "body": "<p>My sheet named Database has numerous rows of data. The first 2 columns have titles, and the user can select from these titles in a drop down list and filter the data so it only displays results that contain these titles.</p>\n\n<p>In addition to this, I have another subroutine called GetNextResult. The purpose of this is to insert certain values from the filtered results into a text box. This is so the user doesn't have to see rows and rows of results, they can click this button and it'll insert the data into a text box, and every time they click it, it shows another result. When it has shown all of the results, it goes back to showing the first result again. It loops round.</p>\n\n<p>The trouble with this, is the user doesn't know when they've gone back to the first result. I want to add a counter to keep track of what result they're looking at. So the first filtered result will make the counter go to 1, and any subsequent results will be + 1</p>\n\n<p>I have a variable named </p>\n\n<pre><code>First_Row_Filtered\n</code></pre>\n\n<p>which gives me the value of the C column, on the first row that appears when you filter the data.</p>\n\n<p>Using this variable, I have set up an if statement so that if the textbox contains the same value, the counter will reset to 1, the default position.</p>\n\n<p>The problem I have is that the counter isn't adding 1 to the other results correctly. It has an odd behaviour. When it reaches the value of the first result, it does reset back to 1 which is correct, but the next counter number will remember where it was before it reset and continue counting from there, rather than counting from 1.</p>\n\n<p>As an example:\nLet's say there are 3 results when you filter the data.\nWhen you click the button for the first time, the counter shows 1. This is correct.\nWhen you click it the 2nd time it shows 2, correct.\nWhen you click it the 3rd time it shows 3, correct.\nWhen you click it the 4th time, it shows 1, correct because there is no 4th result, it has looped back to the first result.\nWhen you click it the 5th time, it shows 4, it should show 2, but it's continuing the count from before the reset back to 1.</p>\n\n<p>I hope this makes sense, I've put the code below:</p>\n\n<p>Any help would be much appreciated!</p>\n\n<pre><code>Public Sub GetNextResult()\n\n\n\n    Call FilterData\n\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Database\")\n\n\n    Dim header As String\n    header = \"txtbox1\"\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"J\" &amp; LastRow)\n\n\n    Dim FilteredData As Range\n    Set FilteredData = DataRange.Resize(ColumnSize:=1).SpecialCells(xlCellTypeVisible)\n\n\n\n    First_Row_Filtered = Range(\"C6:C\" &amp; Rows.Count).SpecialCells(xlVisible)(1).Value\n\n\n\n    If CurrentRow + 1 &gt; FilteredData.Cells.Count Then\n        CurrentRow = 1\n    End If\n\n\n\n\n    CurrentRow = CurrentRow + 1\n\n\n\n\n    Dim i As Long\n    Dim cell As Variant\n    Static counter As Long\n\n\n\n    ActiveSheet.Shapes(\"Cardcounter\").TextFrame.Characters.Text = counter\n\n\n\n\n\n\n\n    For Each cell In FilteredData\n\n\n        i = i + 1\n        If i = CurrentRow Then\n            Call ShowAll\n\n\n            TextboxName = \"txtbox1\"\n            ActiveSheet.Shapes(TextboxName).DrawingObject.Text = cell.Offset(0, 2)\n\n            TextboxName2 = \"txtbox2\"\n            ActiveSheet.Shapes(TextboxName2).DrawingObject.Text = cell.Offset(0, 3)\n\n            TextboxName3 = \"txtbox3\"\n            ActiveSheet.Shapes(TextboxName3).DrawingObject.Text = cell.Offset(0, 4)\n\n\n            If ActiveSheet.Shapes(TextboxName).DrawingObject.Text = header Then\n\n\n                Call GetNextResult\n            End If\n\n            Call quick_artwork\n\n\n        Else\n            Call ShowAll\n\n\n        End If\n\n\n\n    Next cell\n\n\n\n    If ActiveSheet.Shapes(\"txtbox1\").DrawingObject.Text = First_Row_Filtered Then\n    ActiveSheet.Shapes(\"Cardcounter\").TextFrame.Characters.Text = 1\n    Else\n    counter = counter + 1\n    End If\n\n\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: Actually I just realised that when you open the document fresh, the first result shows 1, correct, but the 2nd result shows 0 and then it counts up from there</p>\n\n<p>EDIT2: Updating post with modified code based on responses below:</p>\n\n<pre><code>Public Sub GetNextResult()\n\n\n\n    Call FilterData\n\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Database\")\n\n\n    Dim header As String\n    header = \"txtbox1\"\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"J\" &amp; LastRow)\n\n\n    Dim FilteredData As Range\n    Set FilteredData = DataRange.Resize(ColumnSize:=1).SpecialCells(xlCellTypeVisible)\n\n\n\n    First_Row_Filtered = Range(\"C6:C\" &amp; Rows.Count).SpecialCells(xlVisible)(1).Value\n\n\n\n    If CurrentRow + 1 &gt; FilteredData.Cells.Count Then\n        CurrentRow = 1\n    End If\n\n\n\n\n    CurrentRow = CurrentRow + 1\n\n\n\n\n    Dim i As Long\n    Dim cell As Variant\n    Static counter As Long\n\n\n\n    ActiveSheet.Shapes(\"Cardcounter\").TextFrame.Characters.Text = counter\n\n\n\n\n\n\n\n    For Each cell In FilteredData\n\n\n        i = i + 1\n        If i = CurrentRow Then\n            Call ShowAll\n\n\n            TextboxName = \"txtbox1\"\n            ActiveSheet.Shapes(TextboxName).DrawingObject.Text = cell.Offset(0, 2)\n\n            TextboxName2 = \"txtbox2\"\n            ActiveSheet.Shapes(TextboxName2).DrawingObject.Text = cell.Offset(0, 3)\n\n            TextboxName3 = \"txtbox3\"\n            ActiveSheet.Shapes(TextboxName3).DrawingObject.Text = cell.Offset(0, 4)\n\n\n            If ActiveSheet.Shapes(TextboxName).DrawingObject.Text = header Then\n\n\n                Call GetNextResult\n            End If\n\n            Call quick_artwork\n\n\n        Else\n            Call ShowAll\n\n\n        End If\n\n\n\n    Next cell\n\n\n\n    If ActiveSheet.Shapes(\"txtbox1\").DrawingObject.Text = First_Row_Filtered Then\n    ActiveSheet.Shapes(\"Cardcounter\").TextFrame.Characters.Text = 1\n    counter = 2\n    Else\n    counter = counter + 1\n    End If\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The last 2 remaining issues are:</p>\n\n<ol>\n<li>When the counter should reset, it actually increases by 1 more for half a second and THEN resets to 1. I'm wondering if there's a way to make it happen instantly?</li>\n</ol>\n\n<p>EDIT: This is now resolved, see responses</p>\n\n<ol start=\"2\">\n<li>This isn't really related to the counter, but for some reason the GetNextResult button will always insert the 2nd result instead of the 1st when you first click the button. So if you changed the criteria, the first result that would be inserted into the textbox is the 2nd row of the filtered data, not the first. Any idea why?</li>\n</ol>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1565804083, "post_id": 57496808, "comment_id": 101468501, "body": "What code do you have in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.inspector.activate(even)\" rel=\"nofollow noreferrer\">Activate</a> event ?"}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1565805709, "post_id": 57496808, "comment_id": 101469162, "body": "See new info above."}], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1565799011, "post_id": 57498272, "comment_id": 101466448, "body": "I suppose it&#39;s another question, but I had DoEvents in there because there were times when the Activate event fired, the macro executed, but the Explorer object had not fully updated yet--in the specific instance, the last item in the explorer was deleted via an inspector. When the inspector closed, the explorer was activated, but it still showed a selection count of 1, which raised an error when the code tried to access the &quot;selected&quot; item that wasn&#39;t really there. DoEvents solved that problem but created a new one."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1565800458, "post_id": 57498272, "comment_id": 101467090, "body": "You can trap that exception and ignore it if you know what is causing it."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1565802058, "post_id": 57498272, "comment_id": 101467732, "body": "That is what I did. I was just curious about the strange window behavior."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1565798454, "creation_date": 1565798454, "answer_id": 57498272, "question_id": 57496808, "link": "https://stackoverflow.com/questions/57496808/outlook-explorer-activate-handler-doevents-causes-outlook-window-to-maximize/57498272#57498272", "title": "Outlook explorer activate handler--DoEvents causes Outlook window to maximize", "body": "<p>There is absolutely no reason to use DoEvents. Ever. You might be stealing some of the Windows messages that Outlook itself expected to handle. </p>\n"}, {"comments": [{"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1565816828, "post_id": 57499962, "comment_id": 101473197, "body": "No viruses found when I scanned it today. I have gotten the message that DoEvents is not necessary, but in fact it prevented the error I was getting (see my comment to Dmitry&#39;s answer below). I&#39;d rather prevent an error than trap and bypass it if possible. But thanks for the advice."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1565806205, "creation_date": 1565806205, "answer_id": 57499962, "question_id": 57496808, "link": "https://stackoverflow.com/questions/57496808/outlook-explorer-activate-handler-doevents-causes-outlook-window-to-maximize/57499962#57499962", "title": "Outlook explorer activate handler--DoEvents causes Outlook window to maximize", "body": "<p>First of all, I'd suggest scanning your machine for viruses. </p>\n\n<p>Then I'd recommend checking the list of running add-ins in Outlook. You may try to turn them off and see how Outlook works after.</p>\n\n<p>There is no need to use the <code>DoEvents</code> in the <code>Activate</code> event handler.</p>\n"}], "owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1587876233, "creation_date": 1565793245, "last_edit_date": 1587876233, "question_id": 57496808, "link": "https://stackoverflow.com/questions/57496808/outlook-explorer-activate-handler-doevents-causes-outlook-window-to-maximize", "title": "Outlook explorer activate handler--DoEvents causes Outlook window to maximize", "body": "<p>I have a macro that runs when an explorer is activated. I discovered that if I put a DoEvents function/statement in the macro, then any time I use another app (say, a browser) and then click back on the main Outlook (i.e., explorer) window title bar, the Outlook window maximizes, as if I had double-clicked on it.</p>\n\n<p>If I comment DoEvents out, the window behaves normally.</p>\n\n<p>This behavior occurs even when DoEvents is the <strong>only</strong> statement in the Activate macro.</p>\n\n<p>The macro runs as expected when the Activate event occurs, but the window state changes for no apparent reason if DoEvents is present.</p>\n\n<p>Is this a known issue? </p>\n\n<p>Thanks!</p>\n\n<p>==== EDIT =====</p>\n\n<p>If I run the following code in ThisOutlookSession, the strange window behavior occurs:</p>\n\n<pre><code>Private WithEvents my_x As Explorer\n\nPrivate Sub Application_Startup()\n    Set my_x = Application.ActiveExplorer\nEnd Sub \n\nPrivate Sub my_x_Activate()\n    DoEvents\nEnd Sub\n</code></pre>\n\n<p>In addition, clicking once on an item in an explorer <strong>when Outlook does not have the focus</strong> causes the item to open, as if double-clicked. Plus occasional other strange behaviors.</p>\n\n<p>I am using Outlook 2013 in Win10.</p>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1565794157, "post_id": 57496792, "comment_id": 101463834, "body": "instead of using Sheet1, maybe create your own worksheet variable and set the sheet explicitly?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1565794340, "post_id": 57496792, "comment_id": 101463960, "body": "That isnt the issue and unfortunately, my suggestion to define the Code Name of the sheet was denied."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 1, "creation_date": 1565794444, "post_id": 57496792, "comment_id": 101464009, "body": "OH, derp, i just read what error 3021 is, before you do <code>cfRS.MoveFirst</code>, do <code>If not(cfRS.bof and cfRS.eof) then</code> &lt;insert rest of code&gt;"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 1, "creation_date": 1565794623, "post_id": 57496792, "comment_id": 101464126, "body": "To expand on why i suggest to do that, when your query&#39;s Where clause is <code>WHERE cfcif# = &#39;&#39;</code> then you have no rows, when you try to execute a <code>cfRS.MoveFirst</code> when you have no records, you get your error 3012. so you will want to ensure that you HAVE records before you try to navigate the recordset and then manipulate it."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 2, "creation_date": 1565795307, "post_id": 57496792, "comment_id": 101464535, "body": "Awesome!  Thank you for that simple fix.  Please post it as an answer, so I can accept it.  Now off to Code Review so i can get help cleaning the code up :)"}], "answers": [{"tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": true, "score": 3, "last_activity_date": 1565797626, "creation_date": 1565797626, "answer_id": 57498054, "question_id": 57496792, "link": "https://stackoverflow.com/questions/57496792/error-handling-not-working-as-expected-on-err-num-3021/57498054#57498054", "title": "Error Handling not working as expected on Err.Num 3021", "body": "<p>Before you do <code>cfRS.MoveFirst</code>, do <code>If not(cfRS.bof and cfRS.eof) then</code>. </p>\n\n<p>When your query's Where clause is <code>WHERE cfcif# = ''</code> then you have no rows. When you try to execute a <code>cfRS.MoveFirst</code> when you have no records, you get your error 3012. so you will want to ensure that you HAVE records before you try to navigate the recordset and then manipulate it.</p>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 57498054, "answer_count": 1, "score": 0, "last_activity_date": 1565797626, "creation_date": 1565793190, "last_edit_date": 1565793819, "question_id": 57496792, "link": "https://stackoverflow.com/questions/57496792/error-handling-not-working-as-expected-on-err-num-3021", "title": "Error Handling not working as expected on Err.Num 3021", "body": "<p>First let me apologize for the spaghetti code as I am not sure of the best way to handle errors like this.</p>\n\n<p>The situation I run into is that our data gets moved between two different data centers throughout the year, so I need to test the connection based on the error number -2147467259, which happens on <code>cfRS.Open CIFstr, adoConn</code> in the top section of the code if there is no connection to that server.</p>\n\n<p>I have tried using <code>IF</code> statements to look at the above error number, but those were not succesful, so below is the wonderful spaghetti code I have written.</p>\n\n<p>Error Number 3021 happens on <code>cfRS.MoveFirst</code> within the <code>Branson:</code> section of this code when I delete the value from <code>Sheet1.Range(\"B103\")</code> and I am not sure why the error is not being handled with the <code>On Error GoTo Err3021</code>.  The <code>ErrHandler:</code> in the top section of the code works just fine.  Any help is greatly appreciated.</p>\n\n<p>CODE:</p>\n\n<pre><code>Option Explicit\nSub CIFIncoming()\n    Dim adoConn As New ADODB.Connection\n    Dim cfRS As New ADODB.Recordset\n    Dim Name As String, Address1 As String, Address2 As String\n    Dim City As String, State As String, Zip As String\n    Dim HomePhone As String, CellPhone As String\n    Dim BSA As String\n    Dim strConn As String\n    Dim CIFstr As String, CIF As String\n\n    On Error GoTo ErrHandler\n\n'\\\\\\\\BEGIN DATABASE INFORMATION GRAB////\n'   1.  Sets the Connection String to the Data Base\n'   2.  Opens the connection to the database\n'   3.  Sets the SQL String to get the fields from the Data Base\n'   4.  Defines the CIF Number to use in the SQL String\n'   5.  Opens the Recordset\n'   6.  Moves the cursor in the DataBase to first position\n\n\n\n    strConn = [REDACTED]\n\n    adoConn.Open strConn\n\n    CIF = UCase(Sheet1.Range(\"B103\").Text)\n\n    CIFstr = \"SELECT \" &amp; _\n             \"cfna1, cfna2, cfna3, cfcity, cfstat, LEFT(cfzip, 5), cfhpho, cfcel1, cfudsc6 \" &amp; _\n             \"FROM cncttp08.jhadat842.cfmast cfmast \" &amp; _\n             \"WHERE cfcif# = '\" &amp; CIF &amp; \"'\"\n\n\n    cfRS.Open CIFstr, adoConn\n\n    cfRS.MoveFirst\n\n'\\\\\\\\END DATABASE INFORMATION GRAB////\n\n'\\\\\\\\BEGIN WORKSHEET INFORMATION PLACEMENT////\n'   1.  Assigns each field from the Database to a variable\n'   2.  Moves data from Database to specific cells\n\n    Name = cfRS.Fields(0)        'cfna1\n    Address1 = cfRS(1)           'cfna2\n    Address2 = cfRS(2)           'cfna3\n    City = Trim(cfRS.Fields(3))  'cfcity\n    State = Trim(cfRS.Fields(4)) 'cfstat\n    Zip = cfRS.Fields(5)         'cfzip\n    HomePhone = cfRS.Fields(6)   'cfhpho\n    CellPhone = cfRS.Fields(7)   'cfcel1\n    BSA = cfRS.Fields(8)         'cfudsc6\n\n    With Sheet1\n        .Range(\"B104\") = Name\n        .Range(\"B105\") = Address1\n        .Range(\"B106\") = Address2\n        .Range(\"B107\") = City &amp; \", \" &amp; State &amp; \" \" &amp; Zip\n    End With\n\n'\\\\\\\\END WORKSHEET INFORMATION PLACEMENT////\n\n'\\\\\\\\BEGIN FINAL DATABASE OPERATIONS////\n'   1.  Closes connection to Database\n'   2.  Sets the Recordset from the Database to Nothing\n'   3.  Exits sub when there are no errors\n\n    cfRS.Close\n    Set cfRS = Nothing\n    Exit Sub\n'\\\\\\\\END FINAL DATABASE OPERATIONS\n\nErrHandler:\n'THIS HANDLES ERROR 3021\n    If Err.Number = 3021 Then\n        With Sheet1\n            .Range(\"B104\") = vbNullString\n            .Range(\"B105\") = vbNullString\n            .Range(\"B106\") = vbNullString\n            .Range(\"B107\") = \"\"\n        End With\n    End If\n\n    If Err.Number = -2147467259 Then GoTo Branson\n\n\nBranson:\n    On Error GoTo Err3021\n    CIF = UCase(Sheet1.Range(\"B103\").Text)\n\n    CIFstr = \"SELECT \" &amp; _\n             \"cfna1, cfna2, cfna3, cfcity, cfstat, LEFT(cfzip, 5), cfhpho, cfcel1, cfudsc6 \" &amp; _\n             \"FROM bhschlp8.jhadat842.cfmast cfmast \" &amp; _\n             \"WHERE cfcif# = '\" &amp; CIF &amp; \"'\"\n\n    cfRS.Open CIFstr, adoConn\n\n    cfRS.MoveFirst  \n\n'\\\\\\\\END DATABASE INFORMATION GRAB////\n\n'\\\\\\\\BEGIN WORKSHEET INFORMATION PLACEMENT////\n'   1.  Assigns each field from the Database to a variable\n'   2.  Moves data from Database to specific cells\n\n    Name = cfRS.Fields(0)        'cfna1\n    Address1 = cfRS(1)           'cfna2\n    Address2 = cfRS(2)           'cfna3\n    City = Trim(cfRS.Fields(3))  'cfcity\n    State = Trim(cfRS.Fields(4)) 'cfstat\n    Zip = cfRS.Fields(5)         'cfzip\n    HomePhone = cfRS.Fields(6)   'cfhpho\n    CellPhone = cfRS.Fields(7)   'cfcel1\n    BSA = cfRS.Fields(8)         'cfudsc6\n\n    With Sheet1\n        .Range(\"B104\") = Name\n        .Range(\"B105\") = Address1\n        .Range(\"B106\") = Address2\n        .Range(\"B107\") = City &amp; \", \" &amp; State &amp; \" \" &amp; Zip\n    End With\n\n'\\\\\\\\END WORKSHEET INFORMATION PLACEMENT////\n\n'\\\\\\\\BEGIN FINAL DATABASE OPERATIONS////\n'   1.  Closes connection to Database\n'   2.  Sets the Recordset from the Database to Nothing\n'   3.  Exits sub when there are no errors\n\n    cfRS.Close\n    Set cfRS = Nothing\n    Exit Sub\n'\\\\\\\\END FINAL DATABASE OPERATIONS\n\nErr3021:\n'THIS HANDLES ERROR 3021\n    If Err.Number = 3021 Then\n        With Sheet1\n            .Range(\"B104\") = vbNullString\n            .Range(\"B105\") = vbNullString\n            .Range(\"B106\") = vbNullString\n            .Range(\"B107\") = \"\"\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1565793387, "creation_date": 1565793387, "answer_id": 57496861, "question_id": 57496769, "link": "https://stackoverflow.com/questions/57496769/userform-iniialize-until-value-changes-in-textbox/57496861#57496861", "title": "Userform: Iniialize until value changes in TextBox", "body": "<p>Everytime you change the value in the textbox you are triggering the change event and over writing C6. The trick is to stop the triggering in your initialise and other events by turning off EnableEvents while you make your change</p>\n\n<pre><code>Private Sub UserForm_Initialize()\napplication.EnableEvents = false\nMe.TextBox3.Text = ThisWorkbook.Worksheets(\"Other Data\").Range(\"C6\").Value\napplication.EnableEvents = true\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 57496861, "answer_count": 1, "score": 0, "last_activity_date": 1565793387, "creation_date": 1565793114, "question_id": 57496769, "link": "https://stackoverflow.com/questions/57496769/userform-iniialize-until-value-changes-in-textbox", "title": "Userform: Iniialize until value changes in TextBox", "body": "<p>I have UserForm with TextBox. Then there is value in <code>'Other Data'!C6</code>, in cell C6 on Other Data is formula <code>=D6</code>.</p>\n\n<p>Then by this I am passing value to cell:</p>\n\n<pre><code>Private Sub TextBox3_Change()\nThisWorkbook.Worksheets(\"Other Data\").Range(\"C6\").Value = Me.TextBox3.Text\nEnd Sub\n</code></pre>\n\n<p>Getting value from cell:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nMe.TextBox3.Text = ThisWorkbook.Worksheets(\"Other Data\").Range(\"C6\").Value\nEnd Sub\n\nPrivate Sub UserForm_Activate()\nMe.TextBox3.Text = ThisWorkbook.Worksheets(\"Other Data\").Range(\"C6\").Value\nEnd Sub\n\nPrivate Sub UserForm_Click()\nMe.TextBox3.Text = ThisWorkbook.Worksheets(\"Other Data\").Range(\"C6\").Value\nEnd Sub\n</code></pre>\n\n<p>The problem is that number from UserForm is overriding formula in <code>'Other Data'!C6</code> while opening UserForm. This is affecting other formulas and calculations in my Excel applivcation. How to prevent <code>'Other Data'!C6</code> override until I manually change value in TextBox on UserForm? </p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "edited": false, "score": 0, "creation_date": 1565884574, "post_id": 57496727, "comment_id": 101493172, "body": "Hey David, thanks. I implemented your method and it works sometimes, but not always. I want to start pasting at slide 18, so before the loop, I set lPowerPointCurrentSlide to 18. About 70% of the time, the macro works, chugging away, pasting the correct information from slide 18 onwards (18,19,20, etc), until the loop terminates correctly..."}, {"owner": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "edited": false, "score": 0, "creation_date": 1565884683, "post_id": 57496727, "comment_id": 101493235, "body": "...However, the other ca. 30% of the time, the macro somehow disregards that I want to start at slide 18. Instead it starts at slide 1, copies the information I wanted on slide 18 to slide 1, and then doesn\u2019t continue, just exiting the macro (without any crash or anything similar). So, to sum it up, 70% of the time I end up with the result I want (distinct information copied correctly to slides 18,19,20... etc), and the other 30% of the time I end with only the information that is supposed to be on slide 18, this information however being located on slide 1 for some reason.... any ideas?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "edited": false, "score": 0, "creation_date": 1565886719, "post_id": 57496727, "comment_id": 101494105, "body": "nope. you need to step through the code using some breakpoints &amp; F8 key to step through &amp; see what&#39;s happening internally. not something I can debug without your files."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1565793001, "creation_date": 1565793001, "answer_id": 57496727, "question_id": 57496558, "link": "https://stackoverflow.com/questions/57496558/run-time-error-in-vba-on-pasting-from-excel-to-powerpoint/57496727#57496727", "title": "Run-time error in VBA on pasting from excel to powerpoint", "body": "<p>My recollection is that the <code>ExecuteMso</code> and/or Paste operation is asynchronous, so what often happens is that it hasn't finished <em>pasting</em> by the time it gets to the next iteration. I'm not 100% sure this will solve the problem but I would try something like this, to hopefully ensure the paste is completed before continuing the loop.</p>\n\n<pre><code>Dim numShapes as Long ' get the current number of shapes on the slide\nDim sld as PowerPoint.Slide\nSet sld = myPresentation.Slides(lPowerPointCurrentSlide)\nsld.Select\nnumShapes = sld.Shapes.Count\nPowerPointApp.CommandBars.ExecuteMso \"Paste\"\nWhile sld.Shapes.Count &lt; numShapes + 1\n    DoEvents\nWend\nlPowerPointCurrentSlide = lPowerPointCurrentSlide + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "edited": false, "score": 0, "creation_date": 1566219119, "post_id": 57498742, "comment_id": 101576063, "body": "Hey John, thanks for your help. Could you elaborate this a bit more? Where does the Exit Sub statement you mention go? and where do I put the TooFastPaste1 block? I have tried implementing this as per your suggestion, but on execution of Resume TryPaste1 I get Run-time error &#39;20&#39;: Resume without error."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "edited": false, "score": 0, "creation_date": 1566230111, "post_id": 57498742, "comment_id": 101582041, "body": "When a Sub includes error trapping, you normally put the error coding at the bottom with an Exit Sub just before it so that normal processing of the Sub lets the code quit rather than run through all the error coding. The TooPastePaste1 block goes immediately after the Exit Sub statement. The run-time error is complaining that you didn&#39;t include an Exit Sub statement, so execution ran through the error handling when there wasn&#39;t any error."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 1, "last_activity_date": 1565800488, "creation_date": 1565800488, "answer_id": 57498742, "question_id": 57496558, "link": "https://stackoverflow.com/questions/57496558/run-time-error-in-vba-on-pasting-from-excel-to-powerpoint/57498742#57498742", "title": "Run-time error in VBA on pasting from excel to powerpoint", "body": "<p>As David has pointed out, this is a timing problem. Here's how I solve this kind of issue. First make a Sleep declaration:</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n</code></pre>\n\n<p>Then add error-checking to the problem line:</p>\n\n<pre><code>TryPaste1:\n  On Error GoTo TooFastPaste1\n  .InsertAfter(vbCr).PasteSpecial msoClipboardFormatPlainText\n  On Error GoTo 0\n</code></pre>\n\n<p>Then, after an Exit Sub statement, add the Sleep statement:</p>\n\n<pre><code>TooFastPaste1:\n  Sleep 10\n  Resume TryPaste1\n</code></pre>\n\n<p>This will retry the paste operation at 10 millisecond intervals until it finally succeeds.</p>\n"}], "owner": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1565800488, "creation_date": 1565792367, "last_edit_date": 1565794835, "question_id": 57496558, "link": "https://stackoverflow.com/questions/57496558/run-time-error-in-vba-on-pasting-from-excel-to-powerpoint", "title": "Run-time error in VBA on pasting from excel to powerpoint", "body": "<p>I have some fairly straightforward VBA code to copy either 1 or 2 rows at a time from Excel onto successive PowerPoint slides.</p>\n\n<p>When I run it line for line in debug mode, the code works perfectly. However, when I run it without stepping trhough it manually, I get an error very early in the while-loop (<strong>usually around the 2nd or 3rd iteration</strong>).</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Sub CommandButtonExportToPowerPoint_Click()\n\n\nDim rng As Range\nDim PowerPointApp As Object\nDim myPresentation As Object\nDim mySlide As Object\nDim myShape As Object\n\nDim lFirstRow As Long\nDim lLastRow As Long\nDim sRangeString As String\n\nDim lNumberOfPptSlidesToAdd As Long\n\nlFirstRow = 84\nlLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nlNumberOfPptSlidesToAdd = (lLastRow - lFirstRow) / 2\n\nsRangeString = \"B\" &amp; lFirstRow &amp; \":B\" &amp; lLastRow &amp; \",L\" &amp; lFirstRow &amp; \":L\" &amp; lLastRow &amp; \",M\" &amp; lFirstRow &amp; \":M\" &amp; lLastRow &amp; \",N\" &amp; lFirstRow &amp; \":N\" &amp; lLastRow\n\nSet rng = ThisWorkbook.ActiveSheet.Range(sRangeString)\nrng.Select\n\nOn Error Resume Next\n\n\nSet PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n\nErr.Clear\n\n\nIf PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n\nIf Err.Number = 429 Then\nMsgBox \"PowerPoint could not be found, aborting.\"\nExit Sub\nEnd If\n\nOn Error GoTo 0\n\n\nApplication.ScreenUpdating = False\nPowerPointApp.Visible = True\nPowerPointApp.Activate\n\n\nSet myPresentation = PowerPointApp.Presentations.Open(\"C:\\some\\path\\to\\existingppt\\test.pptx\")\nrng.Copy\n\nSheets(\"Sheet1\").Range(\"E1\").PasteSpecial Paste:=xlPasteValues\nSheets(\"Sheet1\").Range(\"E1\").PasteSpecial Paste:=xlPasteFormats\nDim lCurrentFirstRowToCopy As Long\nlCurrentFirstRowToCopy = 2 + 1\n\nlLastRow = lLastRow - lFirstRow + 1\n\nDim lPowerPointCurrentSlide As Long\nlPowerPointCurrentSlide = 18\n\nDim sFirstRowValue, sSecondRowValue As String\n\n\n\nWhile lCurrentFirstRowToCopy &lt;= lLastRow\n\n    If Sheets(\"Sheet1\").Range(\"E\" &amp; lCurrentFirstRowToCopy).MergeCells = True Then\n        MsgBox (\"Cell E\" &amp; lCurrentFirstRowToCopy &amp; \" is merged: \" &amp; Sheets(\"Sheet1\").Range(\"E\" &amp; lCurrentFirstRowToCopy).MergeCells)\n    End If\n\n    sFirstRowValue = Sheets(\"Sheet1\").Range(\"E\" &amp; lCurrentFirstRowToCopy).Value\n    sSecondRowValue = Sheets(\"Sheet1\").Range(\"E\" &amp; lCurrentFirstRowToCopy + 1).Value\n    If Left(sFirstRowValue, 5) = Left(sSecondRowValue, 5) Then\n        Set rng = Sheets(\"Sheet1\").Range(\"E\" &amp; lCurrentFirstRowToCopy &amp; \":H\" &amp; lCurrentFirstRowToCopy + 1)\n        lCurrentFirstRowToCopy = lCurrentFirstRowToCopy + 2\n    Else\n        Set rng = Sheets(\"Sheet1\").Range(\"E\" &amp; lCurrentFirstRowToCopy &amp; \":H\" &amp; lCurrentFirstRowToCopy)\n        lCurrentFirstRowToCopy = lCurrentFirstRowToCopy + 1\n    End If\n    Application.CutCopyMode = True\n    rng.Copy\n    myPresentation.Slides(lPowerPointCurrentSlide).Select\n    PowerPointApp.CommandBars.ExecuteMso \"Paste\"\n    Application.CutCopyMode = False\n    lPowerPointCurrentSlide = lPowerPointCurrentSlide + 1\n\nWend\n\n\nrng.Clear\n\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>As mentioned, when running the code \"live\", i.e. not stepping through it, the code always fails on <strong>either</strong> line </p>\n\n<pre><code>myPresentation.Slides(lPowerPointCurrentSlide).Select\n</code></pre>\n\n<p>or line</p>\n\n<pre><code>PowerPointApp.CommandBars.ExecuteMso \"Paste\"\n</code></pre>\n\n<p>The error I get is usually this one: <a href=\"https://i.stack.imgur.com/o6fsE.png\" rel=\"noreferrer\">Run-time error -2147023170: Automation Error: The remote procedure call failed</a></p>\n\n<p>However, sometimes I also get Run-time error 462 or even Run-time error -2147467259 (Method 'ExecuteMso' of object '_CommandBars' failed.</p>\n\n<p>The fact that it works when stepping through the code makes me think it may have  something to do with timing / process priorities, but adding Application.Wait statements to wait 10 seconds did not fix this.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "error-handling", "vbscript", "syntax-error"], "comments": [{"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565792323, "post_id": 57496489, "comment_id": 101462846, "body": "Okay, I tried it and I get the same error. Updated the question."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1565793110, "post_id": 57496489, "comment_id": 101463290, "body": "Copy and pasting your code into a general module in excel runs fine. Where are you running it?"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565793465, "post_id": 57496489, "comment_id": 101463466, "body": "It&#39;s compiling and running in an independent program. I don&#39;t have the details of what compiler it&#39;s using, but that may be the problem."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1565793714, "post_id": 57496489, "comment_id": 101463589, "body": "Are you sure you are talking about VBA? Not VB.Net? Does this code live within Excel or Word or similar?"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565794041, "post_id": 57496489, "comment_id": 101463775, "body": "Hmm, I thought it was VBA. It&#39;s not within a Microsoft program. I guess I didn&#39;t know the distinction. Pretty new to this language, and was trying to edit something that already existed. Try Catch hasn&#39;t worked either.. -_-"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1565794335, "post_id": 57496489, "comment_id": 101463956, "body": "If you even don&#39;t know which language you are using, how can we help you. Where do you edit your code? How do you call it? Where does the compiler error come from?"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1565794583, "post_id": 57496489, "comment_id": 101464090, "body": "@FunThomas I edit in Notepad++, I call it as <code>HandleAnError()</code> on one line, and the compiler error comes from a janky application my work uses that compiles and runs the source code every time the application starts."}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565795015, "post_id": 57496489, "comment_id": 101464361, "body": "Or interpreted rather than compiled. This is new terminology to me. I believe it&#39;s interpreted based on how the application runs and can be changed while it&#39;s running. VBA is interpreted, so this is VBA to my knowledge."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1565795752, "post_id": 57496489, "comment_id": 101464781, "body": "Probably you deal with VB.Script (something really different than VBA!!!). Have a look to <a href=\"https://stackoverflow.com/a/157785/7599798\">stackoverflow.com/a/157785/7599798</a>"}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1565797592, "post_id": 57496489, "comment_id": 101465757, "body": "@FunThomas You&#39;re right, this fixed my problem. Thank you for your help"}], "answers": [{"comments": [{"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565792393, "post_id": 57496526, "comment_id": 101462889, "body": "I get the same error when I fixed that."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565794237, "post_id": 57496526, "comment_id": 101463886, "body": "Don&#39;t think this should have been downvoted. It solves the problem as posted - OP has since moved the goalposts."}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565794384, "post_id": 57496526, "comment_id": 101463982, "body": "@SJR That wasn&#39;t the error that I was asking about. If I fixed the error I was asking about, then I would get an error about this, but I never got an error about this..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565794601, "post_id": 57496526, "comment_id": 101464110, "body": "If you put your code into the VBE with this amendment the code runs as expected. Perhaps you should close the question and start again."}, {"owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "edited": false, "score": 0, "creation_date": 1565795273, "post_id": 57496526, "comment_id": 101464516, "body": "This answer didn&#39;t answer my question as it was when it was first opened. It was a simple syntax error unrelated to my question."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": -1, "last_activity_date": 1565792268, "creation_date": 1565792268, "answer_id": 57496526, "question_id": 57496489, "link": "https://stackoverflow.com/questions/57496489/syntax-error-at-goto-on-line-on-error-goto-label/57496526#57496526", "title": "Syntax Error at GoTo on line &quot;On Error GoTo [label]&quot;", "body": "<pre><code>Dim X = 1/0  \n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Dim X\n\nX=1/0\n</code></pre>\n"}], "owner": {"reputation": 722, "user_id": 8049790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3927a57c023479b1d1edad79125dbf4e?s=128&d=identicon&r=PG&f=1", "display_name": "ejderuby", "link": "https://stackoverflow.com/users/8049790/ejderuby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "closed_date": 1565798185, "answer_count": 1, "score": -1, "last_activity_date": 1565875763, "creation_date": 1565792124, "last_edit_date": 1592644375, "question_id": 57496489, "link": "https://stackoverflow.com/questions/57496489/syntax-error-at-goto-on-line-on-error-goto-label", "closed_reason": "Duplicate", "title": "Syntax Error at GoTo on line &quot;On Error GoTo [label]&quot;", "body": "<p>On compilation, I get a syntax error on the line <code>On Error GoTo ErrorHandler</code> &quot;Near Column 15&quot; which is the beginning of <code>GoTo</code>. I also tried adding a colon to the end of the line (<code>On Error GoTo ErrorHandler:</code>) as I've seen some people do, and I get the same error. What is the syntax error that I'm missing?</p>\n<h3>Subroutine:</h3>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub HandleAnError()\n    On Error GoTo ErrorHandler\n    \n    Dim X\n    X = 1/0\n    \n    Exit Sub\n    \nErrorHandler:\n    MsgBox &quot;Error &quot; &amp; Err.Number &amp; &quot;: &quot; &amp; Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "string", "variables", "range"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565791647, "post_id": 57496264, "comment_id": 101462479, "body": "No, you could use named ranges or use an array of ranges."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1565792945, "post_id": 57496264, "comment_id": 101463205, "body": "not sure if this is intentional, but <code>rng2a</code> is referring to 2 different columns <code>D</code> and <code>E</code>"}, {"owner": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1565793864, "post_id": 57496264, "comment_id": 101463678, "body": "@Slai Yeah, that&#39;s intentional, the second range is the data within two columns. Thanks for noticing and pointing it out just in case :)"}], "answers": [{"comments": [{"owner": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "edited": false, "score": 0, "creation_date": 1565793453, "post_id": 57496429, "comment_id": 101463455, "body": "I don&#39;t have the confidence and experience yet to even play around with arrays - involves FAR too many new variables and properties compared to what I&#39;ve got in my toolbox so far. I always have my variables declared properly and reference workbooks and worksheets in my code, but is it something that would be helpful within questions and answers on here??"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "edited": false, "score": 0, "creation_date": 1565794119, "post_id": 57496429, "comment_id": 101463813, "body": "@Emily as for what I&#39;ve read on the comments, if source and destination are on different workbooks, the need to reference them is even higher my code is copying from the same sheet and workbook, so are all the codes provided by us because your code seems to be like that."}, {"owner": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "edited": false, "score": 0, "creation_date": 1565858223, "post_id": 57496429, "comment_id": 101481878, "body": "Thanks for the concern, but I&#39;m able to understand enough about code to translate references to the same sheet and edit them to suit. I&#39;ll change this if necessary in the future, but I didn&#39;t think it was necessary in this situation as it isn&#39;t even slightly related to the problem in question - the problem is converting a string and range so that they are interchangeable in a sense (which has now been solved thanks to the property of named ranges), not referencing a range in another workbook or worksheet and so I fail to see why it would be necessary to include in my example code."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1565791921, "creation_date": 1565791921, "answer_id": 57496429, "question_id": 57496264, "link": "https://stackoverflow.com/questions/57496264/is-there-a-way-to-reference-a-range-variable-using-strings/57496429#57496429", "title": "Is there a way to reference a range variable using strings?", "body": "<p>This should do it:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim i As Long, LastRow As Long\n    Dim arrRanges(1 To 2) As Range\n\n    With ThisWorkbook.Sheets(\"NameYourSheet\") 'change the sheet name\n        Set arrRanges(1) = .Range(\"B2\", .Range(\"B2\").End(xlDown))\n        Set arrRanges(2) = .Range(\"D2\", .Range(\"E2\").End(xlDown))\n        For i = LBound(arrRanges) To UBound(arrRanges)\n            LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n            arrRanges(i).Copy .Range(\"A\" &amp; LastRow)\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Remember to always declare all your variables, and reference to workbooks and worksheets.</p>\n"}, {"comments": [{"owner": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "edited": false, "score": 1, "creation_date": 1565793216, "post_id": 57496446, "comment_id": 101463341, "body": "THANK YOU! Named ranges worked. I&#39;ve never heard of the Name property for ranges, but it works perfectly. Arrays would probably work, looking at your answer and comparing to what I need, but I don&#39;t have the experience using them to have the confidence to start playing around with them yet - maybe one day :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1565791966, "creation_date": 1565791966, "answer_id": 57496446, "question_id": 57496264, "link": "https://stackoverflow.com/questions/57496264/is-there-a-way-to-reference-a-range-variable-using-strings/57496446#57496446", "title": "Is there a way to reference a range variable using strings?", "body": "<p>I haven't tested either of these, but I think they should work.</p>\n\n<p>Be wary of using <code>End(xldown)</code> as if you don't have anything underneath the first cell you will go straight to the very last cell. Better to work up from the bottom (see Damian's answer).</p>\n\n<pre><code>Sub x1()\n\n'Array\n\nDim rng(1 To 2) As Range, i As Long\n\nSet rng(1) = Range(\"B2\", Range(\"B2\").End(xlDown))\nSet rng(2) = Range(\"D2\", Range(\"E2\").End(xlDown))\n\nFor i = 1 To 2\n    rng(i).Copy\n    Range(\"A2\").End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\nNext i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub x2()\n\n'Named ranges\n\nDim i As Long\n\nRange(\"B2\", Range(\"B2\").End(xlDown)).Name = \"rng1a\"\nRange(\"D2\", Range(\"E2\").End(xlDown)).Name = \"rng2a\"\n\nFor i = 1 To 2\n    Range(\"rng\" &amp; i &amp; \"a\").Copy\n    Range(\"A2\").End(xlDown).Offset(1, 0).PasteSpecial xlPasteValues\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "edited": false, "score": 0, "creation_date": 1565793343, "post_id": 57496488, "comment_id": 101463406, "body": "The ranges I wanted to copy are actually in another workbook and are columns B copied to A, column D copied to B etc (all over the place basically, hence the ranges set to variables), I just edited the code so that it was much shorter and hopefully someone could change the line of code to what I wanted rather than reflecting what I actually wanted the overall outcome to be.Thanks anyway"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1565792123, "creation_date": 1565792123, "answer_id": 57496488, "question_id": 57496264, "link": "https://stackoverflow.com/questions/57496264/is-there-a-way-to-reference-a-range-variable-using-strings/57496488#57496488", "title": "Is there a way to reference a range variable using strings?", "body": "<p>What you actually want to do (I think)  is copy the contents of the columns B,C D etc, into Column A underneath each other.</p>\n\n<pre><code>Sub CopyStuff\nDim i as integer\ndim r as range\nfor i = 1 to 6\n    set r = range(cells(1,i),cells(1,i).end(xldown))\n    r.copy \n    range(\"a1\").end(xldown).offset(1,0).pastespecial xlpastevalues\nnext i\n\nEnd sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1565792818, "creation_date": 1565792818, "answer_id": 57496666, "question_id": 57496264, "link": "https://stackoverflow.com/questions/57496264/is-there-a-way-to-reference-a-range-variable-using-strings/57496666#57496666", "title": "Is there a way to reference a range variable using strings?", "body": "<p>You can have array of ranges :</p>\n\n<pre><code>Set rng1a = Range(\"B2\", Range(\"B2\").End(xlDown))\nSet rng2a = Range(\"D2\", Range(\"E2\").End(xlDown))\n\nFor Each rng in Array(rng1a, rng2a)\n    rng.Copy\n    Range(\"A2\").End(xlDown).Offset(1,0).PasteSpecial xlPasteValues\nNext\n</code></pre>\n"}], "owner": {"reputation": 18, "user_id": 11926690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75d49ed702049ad13c98f81252a8cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/11926690/emily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57496446, "answer_count": 4, "score": 0, "last_activity_date": 1565792818, "creation_date": 1565791292, "last_edit_date": 1565791999, "question_id": 57496264, "link": "https://stackoverflow.com/questions/57496264/is-there-a-way-to-reference-a-range-variable-using-strings", "title": "Is there a way to reference a range variable using strings?", "body": "<p>I've already used <code>Set</code> to create ranges with names in the format <code>rng1a</code>. I then use a loop to go through <code>i</code> (integer) values, and want to set the final range to use to be the one that has the name in the form <code>'rng' &amp; i &amp; \"a\"</code></p>\n\n<p>My initial thought was something along the lines of <code>Range(\"rng\" &amp; i &amp; \"a\")</code>, however this results in an error.</p>\n\n<pre><code>Set rng1a = Range(\"B2\", Range(\"B2\").End(xlDown))\nSet rng2a = Range(\"D2\", Range(\"E2\").End(xlDown))\ni = 1\nDo\n    (\"rng\" &amp; i &amp; \"a\").Copy                      'this is the problem\n    Range(\"A2\").End(xlDown).Offset(1,0).PasteSpecial xlPasteValues\n    i = i + 1\nLoop Until i = 3\n</code></pre>\n\n<p>I keep getting an error message with </p>\n\n<blockquote>\n  <p>run-time error '1004':<br>\n  Method 'Range' of object '_Global' failed</p>\n</blockquote>\n\n<p>My thought is that I need to format the name of the range as a string so that it can be recognised as the name of a range. Is there a way to do this?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1565806522, "post_id": 57496122, "comment_id": 101469474, "body": "Did you try to debug the code? I.e. run it under the debugger attached and go through each line of code?"}, {"owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1565850492, "post_id": 57496122, "comment_id": 101479359, "body": "@EugeneAstafiev - I hadn&#39;t, but have now... at the end of the event handler part (1 above) <code>Item.GetAssociatedAppointment(False).Duration</code> and <code>Application.ActiveInspector.CurrentItem.Duration</code> both gave the shorter duration... but the invite was still sent with the longer :-("}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1566219848, "post_id": 57496122, "comment_id": 101576487, "body": "In similar situations the solution was to save."}, {"owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1567582083, "post_id": 57496122, "comment_id": 102000632, "body": "@niton - thanks for the suggestion. I tried a save in both the <code>i.Save</code> and <code>Item.Save</code> to no avail :-("}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1569076430, "creation_date": 1569076430, "answer_id": 58041267, "question_id": 57496122, "link": "https://stackoverflow.com/questions/57496122/outlook-vba-updating-appointment-duration/58041267#58041267", "title": "Outlook VBA - updating Appointment duration", "body": "<p>The meeting request went unchanged. The conclusion then is to cancel the original and send a new request.</p>\n\n<p>The <code>.Send</code> does not trigger <code>Application_ItemSend</code>.</p>\n\n<p>In ThisOutlookSession</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    Cancel = Module1.AUTOchangeMeetingDuration(Item)\n    Debug.Print \"Original meeting request cancelled? \" &amp; Cancel\n\nEnd Sub\n</code></pre>\n\n<p>In a regular module, Module1 following the convention in the question.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic Function AUTOchangeMeetingDuration(ByVal Item As Object) As Boolean\n\n    Dim i As AppointmentItem\n    Dim x As VbMsgBoxResult\n\n    If Item.Class &lt;&gt; olMeetingRequest Then\n        ' exit if not sending a meeting request\n         Exit Function\n    End If\n\n    Set i = Item.GetAssociatedAppointment(False)\n\n    If i.Organizer &lt;&gt; \"\" And i.Organizer &lt;&gt; Application.Session.CurrentUser Then\n        'user is not organiser\n        Exit Function\n    End If\n\n    If i.Duration Mod 30 &lt;&gt; 0 Then\n        'duration is not round 30\n        Exit Function\n    End If\n\n    x = MsgBox(\"Do you wish to adjust meeting length in accordance with meeting guidelines?\" &amp; Chr(10) &amp; _\n      \"Duration will be adjusted to \" &amp; (i.Duration - 5) &amp; \"mins (from \" &amp; i.Duration &amp; \"mins)\", _\n      vbYesNoCancel, \"Adjust duration before Send?\")\n\n    If x = vbYes Then\n        i.Duration = i.Duration - 5\n        'Cancel the original request which is \"Item\"\n        AUTOchangeMeetingDuration = True\n\n        ' Send updated request which is \"i\"\n        ' Does not call Application_ItemSend a second time\n        i.Send\n\n    ElseIf x = vbCancel Then\n        AUTOchangeMeetingDuration = True\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587876249, "creation_date": 1565790794, "last_edit_date": 1587876249, "question_id": 57496122, "link": "https://stackoverflow.com/questions/57496122/outlook-vba-updating-appointment-duration", "title": "Outlook VBA - updating Appointment duration", "body": "<p>I wrote/hacked some VBA code that prompted the user to adjust the appointment that they were about to send and reduce the duration a little to allow for a buffer between meetings. It worked fine until some time this year... now it is not adjusting the item being sent, only the one in my calendar.</p>\n\n<ol>\n<li>A event handler in <code>ThisOutlookSession</code></li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n  Cancel = Not (Module1.AUTOchangeMeetingDuration(Item))\nEnd Sub\n</code></pre>\n\n<ol start=\"2\">\n<li>Adjustment function in the module <code>Module1</code> to\n\n<ul>\n<li>get the <code>Item</code></li>\n<li>check it is a <code>olMeetingRequest</code> being sent</li>\n<li>get the corresponding <code>AppointmentItem</code> for the meeting</li>\n<li>adjust <code>Duration</code></li>\n</ul></li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function AUTOchangeMeetingDuration(ByVal Item As Object) As Boolean\n  AUTOchangeMeetingDuration = True\n  If Item.Class &lt;&gt; olMeetingRequest Then Exit Function ' exit if not sending a meeting request\n  Dim i As AppointmentItem\n  Set i = Item.GetAssociatedAppointment(False)\n  If i.Organizer &lt;&gt; \"\" And i.Organizer &lt;&gt; Application.Session.CurrentUser Then GoTo cleanup 'user is not organiser\n  If i.Duration Mod 30 &lt;&gt; 0 Then GoTo cleanup 'duration is not round 30\n  Dim x As VbMsgBoxResult\n  x = MsgBox(\"Do you wish to adjust meeting length in accordance with meeting guidelines?\" &amp; Chr(10) &amp; _\n             \"Duration will be adjusted to \" &amp; (i.Duration - 5) &amp; \"mins (from \" &amp; i.Duration &amp; \"mins)\" _\n            , vbYesNoCancel, \"Adjust duration before Send?\")\n  If x = vbYes Then\n    i.Duration = i.Duration - 5\n  ElseIf x = vbCancel Then\n    AUTOchangeMeetingDuration = False\n  End If\ncleanup:\n  Set i = Nothing\n  Exit Function\nEnd Function\n</code></pre>\n\n<p>As mentioned previously, this code used to work fine but not any more. There have been updates to our Outlook - e.g. upgrade to 2016 client and to off-premise Outlook365, but I don't recall timelines. By guess is some slight change in the <code>GetAssociatedAppointment</code> handling - but I haven't found anything in my search...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1565790345, "post_id": 57495939, "comment_id": 101461733, "body": "Do you want to combine the values in column 25 AND 123 or from 25 TO 123?"}, {"owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1565791059, "post_id": 57495939, "comment_id": 101462148, "body": "I want to combine the values in 25 and 123 and place them in 25. Thanks! @M.Getrost"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1565790522, "creation_date": 1565790522, "answer_id": 57496045, "question_id": 57495939, "link": "https://stackoverflow.com/questions/57495939/combing-two-columns-contents-in-vba/57496045#57496045", "title": "Combing two columns contents in VBA", "body": "<p>Try to make the code as simple as possible. E.g., write the left concatenated part to a string and pass the string to a value. Then it looks maintainable and eas to understand:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim poleRow  As Long\n    poleRow = 1\n\n    With Worksheets(1)\n        Dim union As String\n        union = .Cells(poleRow, 25) &amp; \" / \" &amp; .Cells(poleRow, 123)\n        .Cells(poleRow, 25) = union\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 9697042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGWgnsyRTCA/AAAAAAAAAAI/AAAAAAAAA34/GHXncS51m4o/photo.jpg?sz=128", "display_name": "p77u77n77k", "link": "https://stackoverflow.com/users/9697042/p77u77n77k"}, "is_accepted": false, "score": 0, "last_activity_date": 1565790988, "creation_date": 1565790988, "answer_id": 57496182, "question_id": 57495939, "link": "https://stackoverflow.com/questions/57495939/combing-two-columns-contents-in-vba/57496182#57496182", "title": "Combing two columns contents in VBA", "body": "<p>You just can't do it in one lane :)</p>\n\n<p>Earlier you should declare starting row and last row for which you want to iterate.</p>\n\n<pre><code>For PoleRow=1 to 125 '  decalring start row = 1 and last row, you can also declare last row by VBA code\nWith Cells(PoleRow, 25) \nCells(PoleRow,25) = Cells(PoleRow, 25).Value2 &amp; \" / \" &amp; Cells(PoleRow, 123).Value2\nEnd With\nNext PoleRow\n\n</code></pre>\n\n<p>How to declare last row/coll: <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8630012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e64fd33b0a6b16ef290502203bd4e?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nilges", "link": "https://stackoverflow.com/users/8630012/dave-nilges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565790988, "creation_date": 1565790088, "last_edit_date": 1565790452, "question_id": 57495939, "link": "https://stackoverflow.com/questions/57495939/combing-two-columns-contents-in-vba", "title": "Combing two columns contents in VBA", "body": "<p>I have two columns that need to have their contents combine. I want the combining to occur on every row of form. </p>\n\n<pre><code>With Cells(PoleRow, 25) = Cells(PoleRow, 25).Value &amp; \" / \" &amp; Cells(PoleRow, 123).Value\nEnd With\n</code></pre>\n\n<p>With this code, it does not error out but it also does not do anything. I want to combine everything in column 123 into column 25.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1565789323, "creation_date": 1565789323, "answer_id": 57495734, "question_id": 57495596, "link": "https://stackoverflow.com/questions/57495596/is-there-a-general-code-for-the-worksheet-which-i-am-current-using/57495734#57495734", "title": "Is there a general code for the worksheet which I am current using?", "body": "<ul>\n<li>You can use a Variable instead of <code>AAA</code>, and assign a Value to that variable at the Beginning of the code. </li>\n</ul>\n\n<p><strong>Like:</strong></p>\n\n<pre><code>nm = \"AAA\"\n\nActiveChart.FullSeriesCollection(1).Name = \"=\"\"Desk\"\"\"\nActiveChart.FullSeriesCollection(1).XValues = \"='\" &amp; nm &amp; \"'!$A$7:$A$20\"\nActiveChart.FullSeriesCollection(1).Values = \"='\" &amp; nm &amp; \"'!$C$7:$C$20\"\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(2).Name = \"=\"\"Chair\"\"\"\nActiveChart.FullSeriesCollection(2).XValues = \"='\" &amp; nm &amp; \"'!$A$629:$A$669\"\nActiveChart.FullSeriesCollection(2).Values = \"='\" &amp; nm &amp; \"'!$C$629:$C$669\"\n</code></pre>\n\n<p>So you will have to change the Name once in line <code>nm = \"AAA\"</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11927496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7a10d0c30a54a0f88f41731e6e3734?s=128&d=identicon&r=PG&f=1", "display_name": "user11927496", "link": "https://stackoverflow.com/users/11927496/user11927496"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565789346, "creation_date": 1565788815, "last_edit_date": 1565789346, "question_id": 57495596, "link": "https://stackoverflow.com/questions/57495596/is-there-a-general-code-for-the-worksheet-which-i-am-current-using", "title": "Is there a general code for the worksheet which I am current using?", "body": "<p>I am setting up a macro for analyzing a datalog. The datalog is generated from a hardware with a .txt file named AAA (while this might be changed automatically).\nI have finished the macro and tested with this AAA file.\nIs there any general code for AAA that I can alternate with?</p>\n\n<pre><code>ActiveChart.FullSeriesCollection(1).Name = \"=\"\"Desk\"\"\"\nActiveChart.FullSeriesCollection(1).XValues = \"='AAA'!$A$7:$A$20\"\nActiveChart.FullSeriesCollection(1).Values = \"='AAA'!$C$7:$C$20\"\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(2).Name = \"=\"\"Chair\"\"\"\nActiveChart.FullSeriesCollection(2).XValues = \"='AAA'!$A$629:$A$669\"\nActiveChart.FullSeriesCollection(2).Values = \"='AAA'!$C$629:$C$669\"\n</code></pre>\n\n<p>I would like to change AAA with the general code so I can penetrate this macro to every datalog instead of AAA only.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "date", "validation"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1565789507, "post_id": 57495532, "comment_id": 101461249, "body": "Where is this code located? And by not working, do you mean: A) that you&#39;ve placed a breakpoint, but the breakpoint was never reached, or B) the breakpoint was reached, but the code didn&#39;t cause the desired result? (Could also be tested with <code>Debug.Print</code> instead of a breakpoint.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1565790065, "post_id": 57495532, "comment_id": 101461556, "body": "@Mistella its located in a command button in my sheet1. There was no error but if my value in the cell are texts it doesnt throw up an error like its supposed to"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "edited": false, "score": 0, "creation_date": 1566143957, "post_id": 57495898, "comment_id": 101555580, "body": "Mikku, I tried your code but it doesnt work so I tried the updated code that i posted above^ but it doesnt work either cause no errors were passed if the conditions were not met"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1565789872, "creation_date": 1565789872, "answer_id": 57495898, "question_id": 57495532, "link": "https://stackoverflow.com/questions/57495532/how-to-fix-cell-format-as-a-date-with-yyyymmdd-format-and-texts-are-not-allowe/57495898#57495898", "title": "How to fix cell format as a date (with YYYYMMDD format) and texts are not allowed", "body": "<p><strong>I think for this particular purpose you should make use of <code>Worksheet_SelectionChange</code></strong></p>\n\n<p>Like put this code on in the Sheet where you are working</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nFor Each cel In Target\nIf cel.Column = 7 Then\n\n      With cel\n           If Not IsNumeric(.Value) And Not cel.NumberFormat = \"yyyymmdd\" Then\n                MsgBox \"Date format must be in YYYYMMDD\"\n                cel.Value = \"\"\n                Exit Sub\n           Else: cel.NumberFormat = \"yyyymmdd\"\n           End If\n      End With\n\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>This should make every cell in the G column with your required Format. You can include more checks if you want.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "edited": false, "score": 0, "creation_date": 1565792540, "post_id": 57496351, "comment_id": 101462965, "body": "I tried that with date validation (by using data validation in Excel) but they asked for a range of dates to be inputed but I dont want to restrict my range of dates for users"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1565793158, "post_id": 57496351, "comment_id": 101463314, "body": "then set the range as 1/1/1900 to 31/12/2099"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "edited": false, "score": 0, "creation_date": 1566143223, "post_id": 57496351, "comment_id": 101555410, "body": "I need the format to be specifically YYYYMMDD but data validation doesnt seem to accept such an input for validation. I tried typing 19000101 and 30001231. The error says &quot;The date you entered for the Start Date is invalid&quot;."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1566914760, "post_id": 57496351, "comment_id": 101799988, "body": "The date in data validation needs to be entered in a conventional fashion. The number format will then change the display of that date to yyyyMMDD - bear in mind that in excel a date is simply a number - how humans see that date is a function of display."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1565791638, "creation_date": 1565791638, "answer_id": 57496351, "question_id": 57495532, "link": "https://stackoverflow.com/questions/57495532/how-to-fix-cell-format-as-a-date-with-yyyymmdd-format-and-texts-are-not-allowe/57496351#57496351", "title": "How to fix cell format as a date (with YYYYMMDD format) and texts are not allowed", "body": "<p>Use Data Validation to require that the column holds a date, and set the numberformat of the column to \"YYYYMMDD\". Any row inserted will inherit those rules in teh target column.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566143901, "creation_date": 1565788606, "last_edit_date": 1566143901, "question_id": 57495532, "link": "https://stackoverflow.com/questions/57495532/how-to-fix-cell-format-as-a-date-with-yyyymmdd-format-and-texts-are-not-allowe", "title": "How to fix cell format as a date (with YYYYMMDD format) and texts are not allowed", "body": "<p>I want to fix the format of a range of cells as date with this formatting: \"YYYYMMDD\" and no texts are supposed to be allowed. \nI also want this formatting to hold true if a user inserts a new row below \"G12\". Any help would be greatly appreciated. \nThe code is located in a command button in my sheet1. There was no error at all. But if my value in the cell are texts then it doesnt throw up an error like its supposed to.</p>\n\n<p>This is the code I tried to run but its not working</p>\n\n<pre><code>  With Range(\"G12\") \n       if Len(.value) &lt;&gt; 8 Then\n       MsgBox \"Date format must be in YYYYMMDD\"\n\n       If not IsDate(.value) then\n        Msgbox \"Date of Birth is a Mandotory field\"\n\n       End If\n       End If\n\n  End With\n</code></pre>\n\n<p><strong>Updated</strong></p>\n\n<pre><code>If Not Intersect(Target, Range(\"F4:F13\")) Is Nothing Then\n\n   If Not IsNumeric(.Value) And Not cel.NumberFormat = \"yyyymmdd\" Then\n            MsgBox \"Date format must be in YYYYMMDD\"\n            cel.Value = \"\"\n            Exit Sub\n       Else: cel.NumberFormat = \"yyyymmdd\"\n       End If\n   End With\n\n End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1565787683, "post_id": 57495175, "comment_id": 101460103, "body": "Hard to fully diagnose but I see too things that could cause problems. One is unqualified range objects <code>Range(&quot;A&quot; &amp; j).Value</code>. Explicitly set that to a specific parent object (worksheet). The other is that your loop may be infinite, well, not infinite most likely in this case, but it may be looping more than you expect. Step through the code line-by-line (debug) and see if the actions taken are the actions expected and then adjust as needed."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1565787874, "post_id": 57495175, "comment_id": 101460196, "body": "You may not have changed the script, but you might have changed the data the script was designed for... see if you can find a copy of your data as it was when the script was working, and compare to what you have now... and what&#39;s different. Other than that, stepping through is always a good idea, not sure what you mean by &quot;none of the macro is working, although it is running&quot;, it either works or throws an error. Add an <code>Option Explicit</code> at the top, might highlight your issue faster."}, {"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1565789945, "post_id": 57495175, "comment_id": 101461493, "body": "The code seems to be working fine, it runs just one loop but  it just doesn&#39;t get any matches. Try revising your regexes."}, {"owner": {"reputation": 1, "user_id": 11927335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93cbaf669533ea26e26a46fd8d616607?s=128&d=identicon&r=PG&f=1", "display_name": "drizzlebop", "link": "https://stackoverflow.com/users/11927335/drizzlebop"}, "reply_to_user": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1565881269, "post_id": 57495175, "comment_id": 101491560, "body": "FAB, I added option explicit and there weren&#39;t any undefined variables . --   ScottHoltzman, wouldn&#39;t an unqualified range just refer to the sheet attached to the macro by default? There are no other sheets or workbooks open  --  @Yane You get it and I think you are correct, although I am baffled that it can&#39;t get any matches, even when using the exact same data I was using 6 months ago."}], "owner": {"reputation": 1, "user_id": 11927335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93cbaf669533ea26e26a46fd8d616607?s=128&d=identicon&r=PG&f=1", "display_name": "drizzlebop", "link": "https://stackoverflow.com/users/11927335/drizzlebop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565787407, "creation_date": 1565787407, "question_id": 57495175, "link": "https://stackoverflow.com/questions/57495175/excel-macro-script-stopped-working-shows-a-busy-mouse-icon-while-running-but-do", "title": "Excel macro script stopped working, shows a busy mouse icon while running but does nothing to spreadsheet", "body": "<p>I was using this macro to clean up show titles and sort season and episode numbers into their own columns. It was working great! </p>\n\n<p>I haven't run it for about 6 months and now when I open the spreadsheet and try to run it, it just spins with a busy circle.</p>\n\n<p>I'm at a total loss as to what would cause this macro to just not work. I haven't made any changes to the code since the last time I ran it and it did work.</p>\n\n<p>Excel 2016</p>\n\n<p>I've checked the References and fairly sure I've included all the necessary ones.</p>\n\n<p>References: <a href=\"https://i.imgur.com/m4YCGAP.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/m4YCGAP.png</a></p>\n\n<p>I've tried stepping through (F8) the Macro to figure out where the problem is happening but it seems none of the macro is working, although it is running.</p>\n\n<pre><code>Sub cleanTitles()\n\nDim strTitle As String, regEx As New RegExp, strPattern As String\nDim strSeason As String, strEpisode As String, strYear As String\n\nWith regEx\n.Global = True\n\nDim j As Integer: j = 2\nWhile Not Range(\"A\" &amp; j).Value = vbNullString\n\nIf Range(\"F\" &amp; j).Value = vbNullString Then\n\nstrTitle = Range(\"A\" &amp; j).Value\n\n.Pattern = \"[Ss]\\s?(\\d{1,2})[xX\\s]?[Ee]\\s?(\\d{1,2}).*\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count = 0 Then\n.Pattern = \"[\\W_ ](\\d{1,2})\\s?[xX]\\s?(\\d{1,2}).*\"\nSet Matches = .Execute(strTitle)\nEnd If\nIf Matches.Count = 0 Then\n    Range(\"F\" &amp; j) = vbNullString\n    Range(\"G\" &amp; j) = vbNullString\nElse\n    strSeason = Matches(0).SubMatches(0)\n    strEpisode = Matches(0).SubMatches(1)\n    Range(\"F\" &amp; j) = strSeason\n    Range(\"G\" &amp; j) = strEpisode\n    strTitle = .Replace(strTitle, vbNullString)\nEnd If\n\n.Global = True\n.Pattern = \"\\{[^\\}]*\\}[\\W_]?\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count &lt;&gt; 0 Then\n    strTitle = .Replace(strTitle, vbNullString)\nEnd If\n.Pattern = \"\\[[^\\]]*\\][\\W_]?\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count &lt;&gt; 0 Then\n    strTitle = .Replace(strTitle, vbNullString)\nEnd If\n.Pattern = \"\\([^\\)]*\\)[\\W_]?\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count &lt;&gt; 0 Then\n    strTitle = .Replace(strTitle, vbNullString)\nEnd If\n.Global = False\n\n.Pattern = \"[\\W_](\\d{4}).*\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count &lt;&gt; 0 Then\n    strYear = Matches(0).SubMatches(0)\n    If strYear &lt;= \"1920\" Then\n        Range(\"F\" &amp; j) = Left(strYear, 2)\n        Range(\"G\" &amp; j) = Right(strYear, 2)\n    End If\n    strTitle = .Replace(strTitle, vbNullString)\nEnd If\n\n.Pattern = \"(\\d{4})$\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count &lt;&gt; 0 Then\n    strTitle = .Replace(strTitle, vbNullString)\nEnd If\n\n.Pattern = \"^\\d+-?([a-zA-Z])\"\nSet Matches = .Execute(strTitle)\nIf Matches.Count &lt;&gt; 0 Then\n    strTitle = .Replace(strTitle, Matches(0).SubMatches(0))\nEnd If\n\n.Global = True\n.Pattern = \"([a-z0-9])([A-Z])\"\nSet Matches = .Execute(strTitle)\nstrTitle = .Replace(strTitle, \"$1\" &amp; \" \" &amp; \"$2\")\n.Pattern = \"([a-zA-Z])([0-9])\"\nSet Matches = .Execute(strTitle)\nstrTitle = .Replace(strTitle, \"$1\" &amp; \" \" &amp; \"$2\")\n.Global = False\n\n\nRange(\"A\" &amp; j) = IIf(strTitle &lt;&gt; vbNullString, strTitle, \".\")\n\nEnd If\n\nj = j + 1\nWend\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>--- Example show titles to be cleaned ---<br>\n The Big Bang Theory Season 10 Episode 15: The Locomotion Reverberation<br>\nThe Big Bang Theory Season 10 Episode 16: The Allowance Evaporation<br>\n The 100 Season 3 Episode 2:  Wanheda: Part Two<br>\nThe Big Bang Theory Season 10 Episode 19: The Collaboration Fluctuation<br>\nThe 100 Season 3 Episode 3:  Ye Who Enter Here<br>\n The Good Doctor Season 1 Episode 12: Islands Part Two  </p>\n\n<p>The macro is supposed to delete text such as \"Season\" or \"Episode\" from column A and then take the corresponding numbers and add them to column F and G.<br>\nIt is also supposed to delete punctuation such as \":\"   </p>\n\n<p>Example result, ignore non-highlighted columns <a href=\"https://i.imgur.com/deTNHBs.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/deTNHBs.png</a></p>\n"}, {"tags": ["excel", "vba", "salesforce", "connector", "sfdc"], "comments": [{"owner": {"reputation": 11, "user_id": 11927391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c252dd76ecac1afec9e26d07f9c1d5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/11927391/sanjay"}, "edited": false, "score": 0, "creation_date": 1565787126, "post_id": 57495100, "comment_id": 101459803, "body": "$app = New-Object -comobject Excel.Application $app.Visible = $True $wb = $app.Workbooks.Open(&quot;C:\\Sanjay Kumar\\Reports\\CaseAge30 - Raw Data.xlsx&quot;) $wb.Name $wb.Refresh $wb.Save()"}], "owner": {"reputation": 11, "user_id": 11927391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c252dd76ecac1afec9e26d07f9c1d5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjay", "link": "https://stackoverflow.com/users/11927391/sanjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565791738, "creation_date": 1565787093, "last_edit_date": 1565791738, "question_id": 57495100, "link": "https://stackoverflow.com/questions/57495100/unable-to-auto-refresh-the-excel-sfdc-connector-for-hpe", "title": "Unable to auto refresh the excel SFDC connector for HPE", "body": "<p>I am trying to run a VBA or PS1 file that refreshes the excel connections. But the SFDC connector for HPE salesforce is not connecting.</p>\n\n<pre><code>$app = New-Object -comobject Excel.Application\n$app.Visible = $True\n$wb = $app.Workbooks.Open(\"C:\\Sanjay Kumar\\Reports\\CaseAge30 - Raw Data.xlsx\")\n$wb.Name\n$wb.Refresh\n$wb.Save()\n</code></pre>\n\n<p>I ran this command but no luck.</p>\n"}, {"tags": ["sql-server", "vba", "database", "ms-access"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1565811730, "post_id": 57494737, "comment_id": 101471433, "body": "DAO works fine in Access 2019/365. It is just a different reference."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1565787759, "creation_date": 1565787759, "answer_id": 57495285, "question_id": 57494737, "link": "https://stackoverflow.com/questions/57494737/migrating-an-access-2002-application-to-access-2019-or-sql-server/57495285#57495285", "title": "Migrating an Access 2002 Application to Access 2019 or SQL Server?", "body": "<p>There may be none. Open the database in Access 2019/365 and save it in the 2007 (accdb) format, and check it out.</p>\n\n<p>As for the distribution, you can make this fully automatic using a script and a shortcut. It is explained in full in my article:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/33417/Deploy-and-update-a-Microsoft-Access-application-with-one-click.html\" rel=\"nofollow noreferrer\">Deploy and update a Microsoft Access application with one click</a></p>\n\n<p>If you don't have an account, browse to the link: Read the full article.</p>\n\n<p>Push hard to get a confirmation on the move of <em>all</em> the shared tables to an SQL Server backend.</p>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 0, "last_activity_date": 1565840965, "creation_date": 1565840965, "answer_id": 57504644, "question_id": 57494737, "link": "https://stackoverflow.com/questions/57494737/migrating-an-access-2002-application-to-access-2019-or-sql-server/57504644#57504644", "title": "Migrating an Access 2002 Application to Access 2019 or SQL Server?", "body": "<p>A few things:</p>\n\n<p>To update your mde or accDE front end? That is a simple copy to each workstation. You don\u2019t need to re-install the runtime each time. There is no \u201cspecial\u201d connection between one particular application (mde/accde) that you deploy to each workstation. </p>\n\n<p>In other words:</p>\n\n<p>If you writing software in VB6, then you need to install the VB6 run time (but only one time). After that you can simply copy + deploy your application to each workstation.</p>\n\n<p>If you writing software in say .net then again, you have to ensure the correct .net framework is installed on each computer. Once done, then again you can update your software by a simple copy to each workstation.</p>\n\n<p>And the same goes for using the access run time. Once installed, then you can simply copy any mde/accDE to that workstation, double click on it and it will run. So  the run time is not connected to any particular database you copy to the workstation. Once you have  the runtime installed, then you can rather easy cook up some automatic update code for the front end to \"check\" some version number, and then copy down the new updated front end. There are quite a few ways to do this - even a simple batch file can often suffice here. </p>\n\n<p>So in near all cases these days, you will have to do  \u201cone time\u201d install of the required run-time and support libraries. This is the case for .net, older VB6 programs, or Access.</p>\n\n<p>As for migration of the access table data to SQL server?</p>\n\n<p>You should be able to simply migrate the table data to SQL server. Now link the application tables from the older access back end to SQL server.</p>\n\n<p>At this point, 99% of your VBA and even DAO recordset code should work just fine.</p>\n\n<p>There is no need (or even a good reason) to dump using DAO code you have \u2013 it should work as before with VERY few modifications.</p>\n\n<p>About the only change is for code that does this:</p>\n\n<pre><code>Dim strSQL     As String\nDim rst        As DAO.Recordset\n\nstrSQL = \"select * from tblCustomers where City = 'Edmonton'\"\n\nSet rst = CurrentDb.OpenRecordset(strSQL)\n\n' above for SQL server becomes:\n\nSet rst = CurrentDb.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)\n</code></pre>\n\n<p>And you can even migrate the tables with indexes, and table relationships intact by  using the Sql Server Migration Assistant for Access (SSMA). You can find this fantastic tool here:</p>\n\n<p><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=54255\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-us/download/details.aspx?id=54255</a></p>\n\n<p>So, about 99% of existing forms  and VBA code will work as before after you migrate the data to SQL server.</p>\n"}], "owner": {"reputation": 13, "user_id": 9420519, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wPfP0O5nQEg/AAAAAAAAAAI/AAAAAAAAAFI/5V1bgscIH64/photo.jpg?sz=128", "display_name": "JF Landry", "link": "https://stackoverflow.com/users/9420519/jf-landry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 57504644, "answer_count": 2, "score": 1, "last_activity_date": 1594549781, "creation_date": 1565785780, "last_edit_date": 1594549781, "question_id": 57494737, "link": "https://stackoverflow.com/questions/57494737/migrating-an-access-2002-application-to-access-2019-or-sql-server", "title": "Migrating an Access 2002 Application to Access 2019 or SQL Server?", "body": "<p>I have a series of Access 2002 \"Front-end/Back-end\" applications all related to each other. For example, application A has linked tables with application B and vice versa.</p>\n\n<p>The applications are at a stage where daily compaction and repair is required due to the volume and high level of corruption. Moreover, to be able to make the applications work properly, I must make the changes in a virtual environment with Access 2002. I also need to reinstall \"Access runtime 2010 - 32bits\" and copy the Access files (.mde) on every workstation (Windows 10) every time I am making a change in the applications.</p>\n\n<p>@Gustav This is a temporary option (6 months to 18 months) because the customer would like to go to a complete solution with SQL database. The studied solution is configurable and already has a SQL database schema.</p>\n\n<p>I have already done the test to transfer forms, tables, queries and modules to Access 365 but I have errors in the VBA code. All business rules are coded in the VBA code. I also did the transfer of the tables to SQL Server 2017 but I'm afraid I will have to change a lot of VBA code because of the disuse of the DAO engine in the Access 365 front-end.</p>\n\n<p>In fact, to be clearer, I wonder about the need to change the front end to Access knowing that it is a temporary solution.</p>\n\n<p>Maybe, I should keep the software under respirator by eliminating data history in large tables. The time the client takes their decision. Find the \"sweet spot\" that would allow me to erase and continue to maintain it without having to worry about corruptions because I have a hard time seeing a substantial gain in the migration to the Access 365 front-end. What do you think?</p>\n\n<p>I have already proposed to migrate applications and tables in the new version of to Access 2019 and even moving on SQL Server. However, for now, I must put the application on the respirator and continue the daily compaction until a decision is made.</p>\n\n<p>I would like to know if there is a gain to migrate from Access 2002 to the Access 2019 version knowing the total limit of 2 GB Access. What are the major constraints he would have to migrate to a SQL database knowing that the VBA application and code uses the DAO method?</p>\n\n<p>@Albert D. Kallal\nI really like your answer. I should come to a decision soon.\nHowever, I have 2 additional questions. Perhaps, could you guide me on the subject.</p>\n\n<p>There are two things that have recently came to haunt the tranquility that reigned over these applications.</p>\n\n<p>1- For a unknown reason, one of the applications that was part of the swarm of Access applications was blocked for some time with these errors 'Runtime 3027: Cannot update: Database or object is read only'. The problem is that some users have ignored this error and continue their tasks which caused a data shift. \nI had to go back with backup copy because some tables were not updated.</p>\n\n<p>Looking more closely at the error in the VBA code I noticed that it all came from the DAO Recordset.Edit method containing queries with multiples joins.</p>\n\n<p>I managed to work around this problem by modifying the Edit method with DoCmd.RunSQL and by changing the query from a Select to an Update query.\nHowever, the whole method worked perfectly well before.\nCan you explain to me the cause of this error?</p>\n\n<p>2- The original developer did not necessarily use best practices for the design of the application (no autonumber, some tables without primary key, no foreign keys) so I'm afraid that a new design will need to be done if I migrate to a SQL Server database. Or maybe to save time, as this solution is going to disappear in 18 months, I should only replicate the bad practices in SQL Server and pray that it does not cause any more glitches. What would be your professional approach? </p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "mvp"], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565791677, "creation_date": 1565785095, "last_edit_date": 1565791677, "question_id": 57494550, "link": "https://stackoverflow.com/questions/57494550/what-are-the-disadvantages-if-you-use-thisworkbook-object-as-a-intermediary-stor", "title": "What are the disadvantages if you use ThisWorkBook-Object as a intermediary storage for objects?", "body": "<p>I use the following system to intermediarily store a model-object in the ThisWorkBook-Object in VBA Excel. </p>\n\n<p><strong>In ThisWorkBook-Object</strong></p>\n\n<pre><code>Private Type TView\n    Model As UIModel\n    'UserInterface As UIFrm\nEnd Type\n\nPrivate this As TView\n\nFriend Property Get Model() As UIModel\n    Set Model = this.Model\nEnd Property\n\nFriend Property Set Model(ByVal value As UIModel)\n    Set this.Model = value\n    'Validate\nEnd Property\n</code></pre>\n\n<p><strong>When called from a module</strong></p>\n\n<pre><code>if ThisWorkBook.Model is nothing then \n  'Do Stuff\nEnd If\n</code></pre>\n\n<p>ThisWorkBook has to be translated into your Excel language (e.g in german DieseArbeitsMappe.Model)</p>\n\n<p>This works and the model can be stored an recalled later, even if the code has run to the end and usually all objects would be destroyed. If there is an error even the model in the ThisWorkBook-objects are destroyed and reinitialized. But now to the question: </p>\n\n<p><strong>1. Has this method significant disadvantages?</strong></p>\n\n<p><strong>2. Is there a safer way of intermediary storing objects in Excel-VBA?</strong></p>\n"}, {"tags": ["excel", "vba", "clipboard", "paste", "listobject"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1565785119, "post_id": 57494435, "comment_id": 101458717, "body": "what is the content of the clipboard: show an example, please."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1565804781, "last_edit_date": 1565804781, "creation_date": 1565792073, "answer_id": 57496473, "question_id": 57494435, "link": "https://stackoverflow.com/questions/57494435/vba-excel-populate-listobject-with-clipboard-content/57496473#57496473", "title": "VBA excel populate Listobject with clipboard content", "body": "<p>The problems pasting into a table (<code>ListObject</code>) are always going to be very specific to your own situation. For example, if I have the following lines in my clipboard:</p>\n\n<pre><code>row one for listobject\nrow two for listobject\n</code></pre>\n\n<p>I probably want each line to paste into its own row in the table, but do I want the entire line in the first cell or each word in the clipboard line separated into different columns in the table? What happens if you have an empty (blank) line in the clipboard? Different problems will require modifying your solution to match your user's expectations. So while a <code>Paste</code> may work for you (and certainly may work as a manual operation), if you are performing the action with VBA you can be much more specific.</p>\n\n<p>For my example below, I'm clearing and deleting all the rows in the table -- except for one row. I've found in working with tables that Excel seems much happier if there is at least one row in the <code>DataBodyRange</code>.</p>\n\n<pre><code>'--- clear the table data and delete all the rows, because\n'    the incoming data may have a different number of rows\nWith myTbl\n    .DataBodyRange.ClearContents\n    Do While .DataBodyRange.Rows.Count &gt; 1\n        .DataBodyRange.Rows(.DataBodyRange.Rows.Count).Delete\n    Loop\n</code></pre>\n\n<p>Next, set up an object that gives me access to one of the rows in the table. In this case, it's the only row in the table.</p>\n\n<pre><code>    Dim i As Long\n    Dim thisRow As ListRow\n    Set thisRow = .ListRows(1)\n</code></pre>\n\n<p>Then, I'll create an array of lines from the text in the clipboard, splitting along the EOL character:</p>\n\n<pre><code>    Dim lines() As String\n    lines = Split(clipBoardText, vbCrLf)\n</code></pre>\n\n<p>Now it's a simple matter of looping over the lines and copying the clipboard text into (new) rows in the table. </p>\n\n<p>Here is the whole example routine:</p>\n\n<pre><code>Option Explicit\n\nSub ClipboardToTable()\n    Dim myTbl As ListObject\n    Set myTbl = ThisWorkbook.Sheets(\"applianswer\").ListObjects(1)\n\n    Dim obj As DataObject\n    Dim clipBoardText As String\n    Set obj = New DataObject\n    obj.GetFromClipboard\n    clipBoardText = obj.GetText\n\n    '--- clear the table data and delete all the rows, because\n    '    the incoming data may have a different number of rows\n    With myTbl\n        .DataBodyRange.ClearContents\n        Do While .DataBodyRange.Rows.Count &gt; 1\n            .DataBodyRange.Rows(.DataBodyRange.Rows.Count).Delete\n        Loop\n\n        Dim i As Long\n        Dim thisRow As ListRow\n        Set thisRow = .ListRows(1)\n\n        Dim lines() As String\n        lines = Split(clipBoardText, vbCrLf)\n        For i = LBound(lines) To UBound(lines)\n            If Len(lines(i)) &gt; 0 Then\n                '--- use this next statement if you want the entire\n                '    line from the clipboard into the first cell on\n                '    this table row\n                thisRow.Range.Cells(1, 1).Value = lines(i)\n\n                '--- use this next section if you want to split the\n                '    clipboard line and distribute to the table columns\\\n                '    (example splits on the spaces)\n                Dim j As Long\n                Dim columnOffset As Long\n                Dim parts() As String\n                Dim numberOfParts As Long\n                parts = Split(lines(i), \" \")\n                columnOffset = IIf(LBound(parts) = 0, 1, 0)\n                numberOfParts = UBound(parts) + columnOffset\n                '--- we might have to add new columns to fit the data\n                Do While numberOfParts &gt; .ListColumns.Count\n                    .ListColumns.Add Position:=(.ListColumns.Count + 1)\n                Loop\n                For j = LBound(parts) To UBound(parts)\n                    thisRow.Range.Cells(1, j + columnOffset).Value = parts(j)\n                Next j\n\n                Set thisRow = .ListRows.Add(AlwaysInsert:=True)\n            End If\n        Next i\n\n        '--- delete the last listrow because it's empty from\n        '    the loop above\n        .ListRows(i).Delete\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 57496473, "answer_count": 1, "score": 2, "last_activity_date": 1565804781, "creation_date": 1565784667, "last_edit_date": 1565785023, "question_id": 57494435, "link": "https://stackoverflow.com/questions/57494435/vba-excel-populate-listobject-with-clipboard-content", "title": "VBA excel populate Listobject with clipboard content", "body": "<p>I am trying to insert the content of the clipboard (text) into a <em>listobject</em>.</p>\n\n<p><strong>CODE</strong>:</p>\n\n<pre><code>   Dim myTbl As ListObject\n   Set myTbl = ThisWorkbook.Sheets(\"applianswer\").ListObjects(1)\n\n    Dim obj As New DataObject\n    obj.GetFromClipboard\n\n    ' this is to be sure that the text is actually there\n    MsgBox obj.GetText\n\n\n    'this is to be sure that the databodyrange is actually existing. 2 as result\n    MsgBox \"nr of rows \" &amp; myTbl.ListRows.Count\n\n    myTbl.DataBodyRange.ClearContents\n    'this line gives error:\n    myTbl.Paste Destination:=myTbl.ListColumns(1).DataBodyRange.iTem(1)\n</code></pre>\n\n<p><strong>error</strong> I get:</p>\n\n<blockquote>\n  <p>Run-time error 438\n  Object does not support this property or method</p>\n</blockquote>\n\n<p>The following solution is not optimal for me:</p>\n\n<pre><code>myTbl.ListColumns(\"text\").DataBodyRange.iTem(1).value = obj.GetText\n</code></pre>\n\n<p>because then everything is inserted in the first cell\nI want the text to be distributed along the cells where there are line breaks etc.</p>\n\n<p>Some ideas why the paste is not done correctly?\nthanks.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1565786112, "post_id": 57494432, "comment_id": 101459216, "body": "Given that very odd schema, I think 14 seconds + (5+) minutes isn&#39;t so bad for 1 million cells. How on earth did you end up with such a strange structure? I can&#39;t imagine there is anyway to do this in bulk... or rather they way you are doing it now is &quot;doing it in bulk&quot;."}, {"owner": {"reputation": 11, "user_id": 11927160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb20c24364e7227b42c08b3823dc0c1?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnty", "link": "https://stackoverflow.com/users/11927160/shawnty"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1565788397, "post_id": 57494432, "comment_id": 101460532, "body": "Data can be extracted as either xlsx or  CSV. The positions to where the values need to be implemented (ROW-COL-SHEET) is determined in another software where it can be done more efficiently.   But the XLSX template thats populated cant be changed.  Surely there must be some efficiencies to improve in this code?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1565792969, "post_id": 57494432, "comment_id": 101463219, "body": "You can paste a two dimensional array directly into cells as long as you  specify the range correctly. Given a(3,4) then Range(&quot;a1:d3&quot;) = a() is valid. Does this help?"}, {"owner": {"reputation": 11, "user_id": 11927160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb20c24364e7227b42c08b3823dc0c1?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnty", "link": "https://stackoverflow.com/users/11927160/shawnty"}, "edited": false, "score": 0, "creation_date": 1565793396, "post_id": 57494432, "comment_id": 101463426, "body": "Hi Haraassed dad, no sadly it does not.  There is a logic behind the cells that needs to be populated. But hard-coding all of the input cell ranges between formula cells would be a painstaking task.  I was hoping for some inefficiencies in my syntax"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1565796781, "post_id": 57494432, "comment_id": 101465366, "body": "@Shawnty Welcome to SO for a bright entry.Congratulation for a clean &amp;  efficient code &amp; fully agree with @JNevill. However the brilliantly structured code attracted me to test it. It took me 8 secs to  convert to array and finishes writing to cells at around 60 secs to process 1000 K rows of random data distributed to 5 sheets randomly With keeping calculation etc on takes around 100 secs (using empty workbook). However I had to made 2 changes only <code>Dim I as long</code> to prevent overflow error &amp; changed <code>Cells(Valarr(i, CSVROW)+0, Valarr(i, CSVCOL)+0)</code> as string value of the array caused error."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1565799894, "post_id": 57494432, "comment_id": 101466855, "body": "I think the biggest bottleneck here is just going to be that it must be single threaded. You have no choice but to iterate that file (whether as an array or reading line by line) and then interpret the sheet and range to write the value. That&#39;s just going to be slow no matter how you go about it. You <i>could</i> take this over to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> and see if those folks want to step through this line by line looking for changes that <i>may</i> help. I wouldn&#39;t hold my breath on squeezing more speed out of this though."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1565799969, "post_id": 57494432, "comment_id": 101466889, "body": "The only other option would be to run this through some other language that can produce excel spreadsheets where you might be able to get a little lower level then a vba script. But, again, it&#39;s still going to iterate, write, iterate, write, iterate, write 1M times."}, {"owner": {"reputation": 11, "user_id": 11927160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb20c24364e7227b42c08b3823dc0c1?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnty", "link": "https://stackoverflow.com/users/11927160/shawnty"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1565854789, "post_id": 57494432, "comment_id": 101480648, "body": "@Ahmed AU Oh thanks, glad to hear as a beginner in VBA. I agree on the changes, will implement asap :)  JNevill Okay. Thank you for the comments, was hoping there was some kind of options to eliminate the need for 1-by-1."}], "owner": {"reputation": 11, "user_id": 11927160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fb20c24364e7227b42c08b3823dc0c1?s=128&d=identicon&r=PG&f=1", "display_name": "Shawnty", "link": "https://stackoverflow.com/users/11927160/shawnty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565785101, "creation_date": 1565784636, "last_edit_date": 1565785101, "question_id": 57494432, "link": "https://stackoverflow.com/questions/57494432/efficiency-problems-moving-data-from-csv-excel-cells", "title": "Efficiency problems moving data from CSV -&gt; excel cells", "body": "<p>I started VBA - programming 2 days ago and I'm having efficiency problems given my limited knowledge of VBA and EXCEL. </p>\n\n<p>I'm moving data from <em>.CSV to .xlsm files</em>. The .CSV file i receive is structured as\n<code>SHEET;COL;ROW;VALUE</code>.</p>\n\n<p>This .CSV is then read to a multidimension array and populates an excel file with<code>wb.Worksheets(ARRAY(i, SHEET)).Cells(R,C) = ARRAY(i, VALUE)</code></p>\n\n<p>To my understanding, applying the array to a range of cells does not work, as there is no continuous surface to which i'm sending each individual .csv row.</p>\n\n<p>What i've tried most of it can be seen below. I believe a big issue i'm having is the pass-through between VBA -> EXCEL for each .CSV row. Is there any way this can be done by bulk instead? </p>\n\n<p>All types of comments about efficiency and general how-to in VBA is greatly appreciated!</p>\n\n<pre><code>Option Explicit\nPrivate Sub imp_Data()\n    '----------------------------File Dialog for data input-----------------\n    Dim Valarr As Variant\n    Dim fullpath As String\n    Dim CSVSHEET As Integer, CSVCOL As Integer, CSVROW As Integer, CSVVALUE As Integer\n\n    fullpath = [YOUR TEST FILE.CSV]\n    '----------------------------Read rawdata----------------------------\n    Dim RawData As String\n    Open fullpath For Binary As #1\n    RawData = Space$(LOF(1))\n    Get #1, , RawData\n    Close #1\n\n    '----------------------------Split rawdata into array-------------------\n    Dim r As Long, Nrow As Long, Ncol As Long\n    Dim c As Integer\n    Dim lineArr As Variant, cellArr As Variant\n    If Len(RawData) &gt; 0 Then\n        'Split each row in CSV to str array\n        lineArr = Split(Trim$(RawData), vbCrLf)\n        'Dim final array\n        Nrow = UBound(lineArr) + 1\n        Ncol = UBound(Split(lineArr(0), \";\")) + 1\n        ReDim Valarr(1 To Nrow, 1 To Ncol)\n        'Split each col on delimiter \";\"\n        For r = 1 To Nrow\n            If Len(lineArr(r - 1)) &gt; 0 Then\n                cellArr = Split(lineArr(r - 1), \";\")\n                For c = 1 To Ncol\n                    Valarr(r, c) = cellArr(c - 1)\n                Next c\n            End If\n        Next r\n    Else\n        Debug.Print \"No data read\"\n        ' do more stuff\n    End If\n\n    '----------------------------Read Table positions-----------------------\n    Dim i As Integer\n\n    For i = 1 To Ncol\n        If UCase(Valarr(1, i)) = \"SHEET\" Then\n            CSVSHEET = i\n        ElseIf UCase(Valarr(1, i)) = \"COL\" Then\n            CSVCOL = i\n        ElseIf UCase(Valarr(1, i)) = \"ROW\" Then\n            CSVROW = i\n        ElseIf UCase(Valarr(1, i)) = \"VALUE\" Then\n            CSVVALUE = i\n        End If\n    Next i\n    'Turn off calculation and screen update for efficiency\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n\n    '--------------------------------------------Send data to Cells----------\n    Dim L As Long\n    Dim wb As Workbook\n    Set wb = ThisWorkbook \n    L = UBound(Valarr, 1) - LBound(Valarr, 1) + 1\n    For i = 2 To L\n        If IsEmpty(Valarr(i, 1)) = 0 Then\n            wb.Worksheets(Valarr(i, CSVSHEET)).Cells(Valarr(i, CSVROW), Valarr(i, CSVCOL)) = Valarr(i, CSVVALUE)\n        End If\n    Next i\n\n    'Release ValArr memory\n    ReDim Valarr(0)\n    Erase Valarr\n\n    'Reapply calculation/screen update\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n\n</code></pre>\n\n<p>From tests with 1 million rows it takes 14 seconds to read data to array and 5+ minutes to move the data to their designated cell. So the issue in the code below is (what i believe) </p>\n\n<pre><code>For i = 2 To L\n  If IsEmpty(Valarr(i, 1)) = 0 Then\n      wb.Worksheets(Valarr(i, CSVSHEET)).Cells(Valarr(i, CSVROW), Valarr(i, CSVCOL)) = Valarr(i, CSVVALUE)\n   End If\nNext i\n</code></pre>\n"}, {"tags": ["sql", "vba", "dbf"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1565784820, "post_id": 57494390, "comment_id": 101458581, "body": "I recommend you contact the manufacturer (&quot;MainSystems&quot;) and ask them what changed."}], "answers": [{"tags": [], "owner": {"reputation": 43082, "user_id": 74195, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/2Il1P.jpg?s=128&g=1", "display_name": "DRapp", "link": "https://stackoverflow.com/users/74195/drapp"}, "is_accepted": false, "score": 0, "last_activity_date": 1570588187, "creation_date": 1570588187, "answer_id": 58296258, "question_id": 57494390, "link": "https://stackoverflow.com/questions/57494390/opening-a-dbf-file-of-262-columns-increased-from-256-columns-returns-file/58296258#58296258", "title": "Opening a DBF file of 262 columns, increased from 256 columns, returns &quot;...file.dbf is not a table&quot;", "body": "<p>Although I have and use for supporting a system requiring database querying but can not be via a \"Server\" product, there is a product from SAP called Advantage Database.  There is an Advantage LOCAL Server and Advantage Database Server.  The local version runs based on a set of libraries and is more file-sharing over network capabilities.  Works similar with OleDb connections, querying, parameterize queries.  It works with VFP tables, but also has its own support to recognize more than the 255 columns.  I don't know if this is the answer you need, but MIGHT work.  It also apparently supports reading DBase IV files as well.</p>\n\n<p>As for finding the library download, that might be a bit tricky.  I don't remember the last time I had to look for the \"LOCAL\" database version vs server (where they make their sales)</p>\n\n<p>Hope this guides you in a direction of possible resolution.</p>\n"}], "owner": {"reputation": 1, "user_id": 9836741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce1cc6fbd4cabdb3b024cca50deb005?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/9836741/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581910914, "creation_date": 1565784461, "last_edit_date": 1581910914, "question_id": 57494390, "link": "https://stackoverflow.com/questions/57494390/opening-a-dbf-file-of-262-columns-increased-from-256-columns-returns-file", "title": "Opening a DBF file of 262 columns, increased from 256 columns, returns &quot;...file.dbf is not a table&quot;", "body": "<p>A software management system let's call it \"MainSystems\" takes orders, creates invoices, etc. MainSystems uses multiple .DBF files as a database. </p>\n\n<p>There are several third party applications that retrieve certain info (all written in VBA). For example, I created an Excel VBA macro which pulls debt and applied credits from the .dbfs and generates a batch file to upload to a merchant.</p>\n\n<p>I have the VFPOLEDBSetup driver installed to do this. It has run for the past year with no errors.</p>\n\n<p>MainSystems did a system update and now third party applications return errors.</p>\n\n<p>Excel returns </p>\n\n<blockquote>\n  <p>\"Run-time error '-2147467259(80004005)': DIRECTORY\\FILE.dbf is not a table.\"</p>\n</blockquote>\n\n<p>at line <code>rs.Open sql, con</code></p>\n\n<p>and Visual Fox applications solely returns </p>\n\n<blockquote>\n  <p>\"Not a table.\" </p>\n</blockquote>\n\n<p>These applications all worked before the update, only thing I noticed that might be different is within the folder with the .dbfs there are .cdx created the day of the updates and am wondering if this could have caused the error. If so, is there a solution to fix this?</p>\n\n<p>I'm not very knowledgeable with databases.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Changing directories\nDBFFolder = \"G:\\DIRECTORY\\\"\n\nFileName = \"File.DBF\"\n\nOn Error Resume Next\n'Create the ADODB connection object.\nSet con = CreateObject(\"ADODB.connection\")\n\n'Check if the object was created.\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Connection was not created!\", vbCritical, \"Connection error\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\n\n'Open the connection.\n con.Open \"Provider=vfpoledb;\" &amp; \"Data Source=\" &amp; DBFFolder &amp; FileName &amp; \";Collating Sequence=machine\"\n\n'Create the SQL statement to read the file. \n'Note that the filename is used instead of the table name.\nsql = \"SELECT * FROM \" &amp; Left(FileName, (InStrRev(FileName, \".\", -1, vbTextCompare) - 1)) \n\nOn Error Resume Next\n\nSet rs = CreateObject(\"ADODB.recordset\")\n\n'Check if the object was created.\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Connection was not created!\", vbCritical, \"Connection error\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\n\n'Open the recordset.\nrs.Open sql, con\n</code></pre>\n\n<p>Expected result: Access the DBF table and copy info.</p>\n\n<p><strong>UPDATE</strong><br>\nFound the cause of the error. MainSystems added columns to the table making it surpass 256 columns. (262) causing the Microsoft driver to not recognize it as a table. Is there a workaround? </p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 3, "creation_date": 1565784259, "post_id": 57494298, "comment_id": 101458309, "body": "Try <code>wdApp.Quit</code>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1565784262, "post_id": 57494298, "comment_id": 101458311, "body": "Add <code>wdApp.Quit</code> after <code>Call CloseWord2(wdDoc, Wks, False</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11889300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a719874beac6a74df92f89363c607af7?s=128&d=identicon&r=PG&f=1", "display_name": "N01Espada", "link": "https://stackoverflow.com/users/11889300/n01espada"}, "edited": false, "score": 0, "creation_date": 1565793261, "post_id": 57494380, "comment_id": 101463364, "body": "Thanks for the help!"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1565784429, "creation_date": 1565784429, "answer_id": 57494380, "question_id": 57494298, "link": "https://stackoverflow.com/questions/57494298/closing-word-application-using-excel-vba/57494380#57494380", "title": "Closing Word application using excel vba", "body": "<p>Add <code>wdApp.Quit</code> after <code>Call CloseWord2(wdDoc, Wks, False)</code></p>\n\n<p>Your sub <code>CloseWord2</code> just saves and closes the Word Document, but nothing in your code closes the Word Application itself.</p>\n\n<p>With <code>wdApp.Quit</code> you should be able to close the Word Application, but make sure you place it after you are done with Word!</p>\n"}], "owner": {"reputation": 1, "user_id": 11889300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a719874beac6a74df92f89363c607af7?s=128&d=identicon&r=PG&f=1", "display_name": "N01Espada", "link": "https://stackoverflow.com/users/11889300/n01espada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "closed_date": 1565785752, "answer_count": 1, "score": 0, "last_activity_date": 1565784860, "creation_date": 1565784055, "last_edit_date": 1565784860, "question_id": 57494298, "link": "https://stackoverflow.com/questions/57494298/closing-word-application-using-excel-vba", "closed_reason": "Duplicate", "title": "Closing Word application using excel vba", "body": "<p>I need help closing the Word app after its finished. Everything in the code runs fine except when it comes to closing the Word application. After running the code the edited document is saved and closed but the word application is still left open. This causes a problem as I need to run this code numerous times. </p>\n\n<pre><code>Sub ReplaceWordAndCopyPasteImage2()\n\n    Dim wdApp       As Word.Application\n    Dim Wks         As Excel.Worksheet\n    Dim wdDoc       As Word.Document\n\n    Set Wks = ActiveSheet\n\n    Set wdApp = CreateObject(\"Word.Application\")\n    wdApp.Visible = True\n\n    Set wdDoc = wdApp.Documents.Open(\"C:\\Users\\Admin\\Google Drive\\SMS TEMPLATES\\02 RISK ASSESSMENTS\\002 Manual handling RA.docx\")\n\n    Call ReplaceWords2(wdDoc, Wks, False)\n    Call CopyPasteImage2(wdDoc, Wks, False)      'switch back to true\n    Call CloseWord2(wdDoc, Wks, False)\n\n    Set wdDoc = Nothing\n    Set wdApp = Nothing\n\nEnd Sub\n\nSub ReplaceWords2(oDoc As Word.Document, Wks As Excel.Worksheet, Optional boolCloseAfterExec As Boolean = True)\n\n    Dim wdRng       As Word.Range\n    Dim varTxt      As Variant\n    Dim varRngAddress As Variant\n    Dim i           As Long\n\n    varTxt = Split(\"an1,id1,rd1\", \",\")\n    varRngAddress = Split(\"C8,C5,C6\", \",\")\n\n    For Each wdRng In oDoc.StoryRanges\n\n        With wdRng.Find\n            For i = 0 To UBound(varTxt)\n                .Text = varTxt(i)\n                .Replacement.Text = Wks.Range(varRngAddress(i)).Value\n                .Wrap = wdFindContinue\n                .Execute Replace:=wdReplaceAll\n            Next i\n        End With\n\n    Next wdRng\n\n    oDoc.SaveAs2 Environ(\"UserProfile\") &amp; \"\\desktop\\002 Manual handling RA \" &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\")\n\n    If boolCloseAfterExec Then\n        oDoc.Close\n        oDoc.Parent.Quit\n    End If\n\nEnd Sub\n\nSub CopyPasteImage2(oDoc As Word.Document, Wks As Excel.Worksheet, Optional boolCloseAfterExec As Boolean = True)\n\n    With oDoc\n        .Activate\n\n        .ActiveWindow.View = wdNormalView\n        Wks.Range(\"K2:L15\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n        .Bookmarks(\"CompanyLogo\").Select\n        .Parent.Selection.Paste\n        .Parent.Selection.TypeParagraph\n\n        Wks.Range(\"N10:O14\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n        .Bookmarks(\"ConsulSig\").Select\n        .Parent.Selection.Paste\n        .Parent.Selection.TypeParagraph\n\n        .Save\n\n        If boolCloseAfterExec Then\n            oDoc.Close\n            oDoc.Parent.Quit\n        End If\n\n    End With\nEnd Sub\n\nSub CloseWord2(oDoc As Word.Document, Wks As Excel.Worksheet, Optional boolCloseAfterExec As Boolean = True)\n\n    With oDoc\n        .Save\n        .Close\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "cell"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565783090, "post_id": 57493835, "comment_id": 101457749, "body": "do you mean that if target is empty then do not add a time stamp?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565783248, "post_id": 57493835, "comment_id": 101457806, "body": "Also since you are working with <code>Worksheet_Change</code>, I would recommend reading <a href=\"https://stackoverflow.com/questions/13860894/why-ms-excel-crashes-and-closes-during-worksheet-change-sub-procedure/13861640#13861640\">THIS</a>"}, {"owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565783557, "post_id": 57493835, "comment_id": 101457962, "body": "@SiddharthRout no, then display a message that cell cannot be empty and check again if it&#39;s empty until it is not."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1565783732, "post_id": 57493835, "comment_id": 101458046, "body": "Ok let me understand it... If it is empty then it prompts the user. Then when will it alert the user next? It can&#39;t be in a loop as It has to give the user time to enter data... Alternatively what you can do is use <code>Application.Undo</code> to restore the text i n the cell."}, {"owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565785312, "post_id": 57493835, "comment_id": 101458809, "body": "works good. but it still puts timestamp in the next cell. it&#39;s due to the change event i assume"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565785394, "post_id": 57493835, "comment_id": 101458846, "body": "it will not if you check <code>If Len(Trim(Target.Value))&lt;&gt; 0 Then</code> and then put the time stamp. Also check the link that I mentioned above... It is for your good (Trust me)"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1565784237, "last_edit_date": 1565784237, "creation_date": 1565783144, "answer_id": 57494049, "question_id": 57493835, "link": "https://stackoverflow.com/questions/57493835/dont-allow-empty-cell-with-intersect-method/57494049#57494049", "title": "Don&#39;t allow empty cell with Intersect method", "body": "<p>How about the following, it will check whether the target value is nothing and prompt a message, also you might have to review how you protect and unprotect the sheet, as I'm unsure how the user is entering data if it's protected.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Pass As String\nPass = \"somepassword\"\n\nIf Not Intersect(Target, Me.ListObjects(\"Table1\").ListColumns(6).DataBodyRange) Is Nothing Then\n ActiveSheet.Unprotect Password:=Pass\n    On Error GoTo ErrHandler\n    For Each acell In Target.Cells\n        With acell\n            If acell.Column = Me.ListObjects(\"Table1\").ListColumns(6).Range.Column Then acell.Offset(0, 1).Value = Format(Now, \"dd.mm.yyyy hh:mm\")\n        End With\n    Next\n\n    Set foundblank = Me.ListObjects(\"Table1\").ListColumns(6).DataBodyRange.Find(What:=\"\", LookIn:=xlValues, LookAt:=xlWhole)\n    If Not foundblank Is Nothing Then\n        MsgBox \"Blank cell found\", vbInformation, \"Blank Found!\"\n        ActiveSheet.Protect Password:=Pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFiltering:=True\n        Exit Sub\n    End If\n    ActiveSheet.Protect Password:=Pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFiltering:=True\nEnd If\n\nErrHandler:\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "edited": false, "score": 0, "creation_date": 1565785690, "post_id": 57494265, "comment_id": 101458987, "body": "Thank you! It does extactly what I want"}], "tags": [], "owner": {"reputation": 26, "user_id": 11569270, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219553147844584/picture?type=large", "display_name": "Edimar Alves da Silva", "link": "https://stackoverflow.com/users/11569270/edimar-alves-da-silva"}, "is_accepted": true, "score": 1, "last_activity_date": 1565783918, "creation_date": 1565783918, "answer_id": 57494265, "question_id": 57493835, "link": "https://stackoverflow.com/questions/57493835/dont-allow-empty-cell-with-intersect-method/57494265#57494265", "title": "Don&#39;t allow empty cell with Intersect method", "body": "<p>try this code:</p>\n\n<pre><code>Option Explicit\n\nDim OldTargetAddress As String\nDim OldTargetValue As Variant\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = OldTargetAddress And Target.Value = Empty Then\n    Application.EnableEvents = False\n    Target.Value = OldTargetValue\n    Application.EnableEvents = True\n    Exit Sub\nEnd If\n\n\nDim Pass As String\nPass = \"somepassword\"\n\nActiveSheet.Unprotect Password:=Pass\n\n If Not Intersect(Target, Me.ListObjects(\"Table1\").ListColumns(6).DataBodyRange) Is Nothing Then\n\n   On Error GoTo ErrHandler\n\n   ActiveSheet.Unprotect Password:=Pass\n   Target.Offset(0, 1).Value = Format(Now, \"dd.mm.yyyy hh:mm\")\n   ActiveSheet.Protect Password:=Pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFiltering:=True\n\n\nEnd If\n\nErrHandler:\nExit Sub\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    OldTargetAddress = Target.Address\n    OldTargetValue = Target.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57494265, "answer_count": 2, "score": 0, "last_activity_date": 1565791663, "creation_date": 1565782225, "last_edit_date": 1565791663, "question_id": 57493835, "link": "https://stackoverflow.com/questions/57493835/dont-allow-empty-cell-with-intersect-method", "title": "Don&#39;t allow empty cell with Intersect method", "body": "<p>I use data validation where user can select only two values in a list.</p>\n\n<p>I'm also using Intersect method to add timestamp in the next cell when the change in a cell occurs. </p>\n\n<p>The user, however, can still delete a value and leave the cell blank, and this is something I need to prevent. </p>\n\n<p>Is it possible to implement this in the code below?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim Pass As String\nPass = \"somepassword\"\n\nActiveSheet.Unprotect Password:=Pass\n\n If Not Intersect(Target, Me.ListObjects(\"Table1\").ListColumns(6).DataBodyRange) Is Nothing Then\n\n   On Error GoTo ErrHandler\n\n   ActiveSheet.Unprotect Password:=Pass\n   Target.Offset(0, 1).Value = Format(Now, \"dd.mm.yyyy hh:mm\")\n   ActiveSheet.Protect Password:=Pass, DrawingObjects:=True, Contents:=True, \n   Scenarios:=True, AllowFiltering:=True\n\n\nEnd If\n\nErrHandler:\nExit Sub\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 11889093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e5ff3dbfc0292658f115a09203580c?s=128&d=identicon&r=PG&f=1", "display_name": "Random Boo", "link": "https://stackoverflow.com/users/11889093/random-boo"}, "is_accepted": false, "score": 0, "last_activity_date": 1581695064, "creation_date": 1581695064, "answer_id": 60229440, "question_id": 57493611, "link": "https://stackoverflow.com/questions/57493611/how-to-designate-a-printer-using-vba/60229440#60229440", "title": "How to designate a printer using VBA?", "body": "<p>Did it in the end - VBA -</p>\n\n<pre><code>Worksheets(\"Print\").Activate\nWorksheets(\"Print\").Range(\"C2:C8\").Select\n\nApplication.ActivePrinter = \"ZDesigner ZM400 200 dpi (ZPL) on LAN_\"\nSelection.PrintOut Copies:=Worksheets(\"Print\").Range(\"A10\"), Collate:=True\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11889093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e5ff3dbfc0292658f115a09203580c?s=128&d=identicon&r=PG&f=1", "display_name": "Random Boo", "link": "https://stackoverflow.com/users/11889093/random-boo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1581695064, "creation_date": 1565781267, "last_edit_date": 1581468577, "question_id": 57493611, "link": "https://stackoverflow.com/questions/57493611/how-to-designate-a-printer-using-vba", "title": "How to designate a printer using VBA?", "body": "<p>I\u2019ve automated much of what I need using xlwings.</p>\n\n<p>The final stage of my Python is printing a label.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Print_Label()\n\n    Print_Label Macro\n\n    Prints Loan Label\n\n    Range(\"C2:C8\").Select\n\n    Application.Dialogs(xlDialogPrinterSetup).Show\n\n    Selection.PrintOut Copies:=Range(\"A10\"), Collate:=True\n\nEnd Sub\n</code></pre>\n\n<p>The label is created using VBA and Python then triggers the print using the xlwings code.</p>\n\n<pre><code>import xlwings as xw\n\nwb = xw.Book(file.xlsm')\n\nyour_macro = wb.macro('Print_Label')\n\nyour_macro() \n</code></pre>\n\n<p>This prompts a pop up in Excel requesting which printer to use with an OK button. I need it to be a particular printer and run automatically in the background.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1565783790, "post_id": 57493557, "comment_id": 101458075, "body": "<i>Sadly no object is marked that he relates to,</i> In any error, a line should be highlighted in yellow, where it fails. Where? Also, try to debug your code. Execute it step by step, using F8 instead of F5, that way you will see at what exact moment it fails."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 2, "creation_date": 1565784848, "post_id": 57493557, "comment_id": 101458601, "body": "Also, you should avoid using proper names as variables, i.e. <code>activeworkbook</code> as that may not be the actual <code>ActiveWorkbook</code>.  Secondly, this is going to cause problems <code>Cells.End(xlDown) &amp; Cells.End(xlRight)</code>,  You can look up how to find the last row and last column or <code>UsedRange</code>."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 2, "creation_date": 1565785248, "post_id": 57493557, "comment_id": 101458776, "body": "Let me start by saying, code is well formatted which makes it easy to read. Apart from what @DarrellH and FABAB suggested, have a look at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">why we should avoid using <code>Select</code></a> in VBA"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1565788536, "creation_date": 1565788536, "answer_id": 57495515, "question_id": 57493557, "link": "https://stackoverflow.com/questions/57493557/excel-vba-copy-content-from-one-sheet-into-other-workbook-sheet/57495515#57495515", "title": "Excel VBA copy content from one Sheet into other Workbook sheet", "body": "<p>I believe all of your problems originate here:</p>\n\n<pre><code>Private Sub GenerateValues()\n    'Application.ScreenUpdating = False\n    'Application.DisplayAlerts = False\n    Dim activeWorkbook As Workbook\n    Dim activeWorksheet As Worksheet\n\n    Set activeWorkbook = Application.activeWorkbook\n    Set activeWorksheet = GetTemplateData(activeWorkbook)\n\n    activeWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>ActiveWorkbook is a defined \"variable\" in VBA, so it is confused as to why you are trying to reassign it. Try using a different variable name instead. </p>\n\n<p>Note: although ActiveWorksheet is not a defined variable in VBA, it is close in name to ActiveSheet, so I would also change that variable name to something different just so to not confuse you when writing future code.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 11281707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bX1fi.png?s=128&g=1", "display_name": "claudius", "link": "https://stackoverflow.com/users/11281707/claudius"}, "is_accepted": false, "score": 0, "last_activity_date": 1566501301, "creation_date": 1566501301, "answer_id": 57615805, "question_id": 57493557, "link": "https://stackoverflow.com/questions/57493557/excel-vba-copy-content-from-one-sheet-into-other-workbook-sheet/57615805#57615805", "title": "Excel VBA copy content from one Sheet into other Workbook sheet", "body": "<p>You could try something similar to this:</p>\n\n<pre><code>Sub CopyContentsFromOtherWorkbook()\n\n    Dim wb As Workbook\n    Dim twb As Workbook\n\n    filePath = \"C:\\File.xlsx\"\n\n    Set wb = Workbooks.Open(filePath)\n    wb.Sheets(1).Range(\"A1:Z10000\").Copy\n\n    Set twb = ThisWorkbook\n    twb.Sheets(1).Range(\"C1\").PasteSpecial xlPasteValues\n\n    wb.Close\n    twb.Save\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 661, "user_id": 5524954, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d40a932ec6ff67cda8ba84be8807295d?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger", "link": "https://stackoverflow.com/users/5524954/r%c3%bcdiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566501301, "creation_date": 1565781038, "question_id": 57493557, "link": "https://stackoverflow.com/questions/57493557/excel-vba-copy-content-from-one-sheet-into-other-workbook-sheet", "title": "Excel VBA copy content from one Sheet into other Workbook sheet", "body": "<p>I want to be able to select a workbook and then copy the content from that workbook (sheet 1) into my current active workbook where I run the macro. I've been looking at some answers here on StackOverflow to similar questions and got the following code (see below). </p>\n\n<p>The selection of a file is currently working fine, but when I run the macro it throws an error </p>\n\n<blockquote>\n  <p>Runtime error \"438\": Object does not support that method or property` </p>\n</blockquote>\n\n<p><em>(please note, that the error comes in my native language and is just translated by me)</em></p>\n\n<p>Sadly no object is marked that he relates to, so I can't really make out what problem he has. Yet, I guess it is a problem with the <code>PasteSpecial</code> in the last line of function <code>GetTemplateData</code>, but that code should be alright (what is it supposed to do? Save the data into the first sheet of the give workbook <code>activeWorkbook</code>) and pass the reference back go <code>GeneratedValues</code>-routine.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub GenerateValues()\n    'Application.ScreenUpdating = False\n    'Application.DisplayAlerts = False\n    Dim activeWorkbook As Workbook\n    Dim activeWorksheet As Worksheet\n\n    Set activeWorkbook = Application.activeWorkbook\n    Set activeWorksheet = GetTemplateData(activeWorkbook)\n\n    activeWorkbook.Save\nEnd Sub\n\n\n'Get The Template Data\nPrivate Function GetTemplateData(activeWorkbook As Workbook) As Worksheet\n\n    Dim templateWorkbook As Workbook\n\n    'Grab the Template Worksheet\n    Set templateWorkbook = UseFileDialogOpen\n\n    'Select all Content\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Copy\n\n    'activeWorkbook.Sheets(activeWorkbook.Sheets.Count).Range(\"A1\", Cells.End(xlDown) &amp; Cells.End(xlRight)).PasteSpecial xlPasteValues\n    activeWorkbook.Sheets(1).Range(\"A1\", Cells.End(xlDown) &amp; Cells.End(xlRight)).PasteSpecial xlPasteValues\n\nEnd Function\n\n'From https://docs.microsoft.com/de-de/office/vba/api/excel.application.filedialog\n'Select the Workbook containing the Exported Template-Stories by User Selection\nFunction UseFileDialogOpen() As Workbook\n\n    Dim lngCount As Long\n    Dim filePath As String\n\n    Dim templateBook As Workbook\n\n    ' Open the file dialog\n    With Application.FileDialog(msoFileDialogOpen)\n        .AllowMultiSelect = False\n        .Show\n\n        Set templateBook = Workbooks.Open(.SelectedItems(1))\n\n        ' Display paths of each file selected\n        'For lngCount = 1 To .SelectedItems.Count\n        '    MsgBox .SelectedItems(lngCount)\n        'Next lngCount\n\n    End With\n\n    templateBook\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565781216, "post_id": 57493406, "comment_id": 101456839, "body": "You should be referencing <code>k</code> here <code>Debug.Print aWS(i, j)</code>."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565781514, "post_id": 57493406, "comment_id": 101456985, "body": "@SJR omg, thank you. Couldn&#39;t figure this out! Sometimes need a fresh pair of eyes. Feel free to add that as an answer so I can accept."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565781689, "post_id": 57493406, "comment_id": 101457077, "body": "Aye I know that feeling."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1565781632, "creation_date": 1565781632, "answer_id": 57493690, "question_id": 57493406, "link": "https://stackoverflow.com/questions/57493406/returning-values-from-sheet-in-an-array/57493690#57493690", "title": "Returning values from sheet in an array", "body": "<p>Your loop below wasn't referencing the variable <code>k</code> here so it was just reprinting the same array value.</p>\n\n<pre><code>For k = i To (i + 5)\n     Debug.Print aWS(k, j)\n     If aWS(k, j) &gt; 0 Then\n         'there is a spot, therefore start date\n         bSpotCheck = True\n         Exit For\n     End If\nNext k\n</code></pre>\n"}], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57493690, "answer_count": 1, "score": 0, "last_activity_date": 1612849480, "creation_date": 1565780465, "last_edit_date": 1612849480, "question_id": 57493406, "link": "https://stackoverflow.com/questions/57493406/returning-values-from-sheet-in-an-array", "title": "Returning values from sheet in an array", "body": "<p>I have a workbook of sheets I loop through to pull information from each table.</p>\n<p>Due to the number of sheets I decided to store each sheet in an array, which I loop through to get the information to output in another workbook. As far as I am aware this is the fastest read/ write method in VBA.</p>\n<p>I am looping through the Spots columns and checking if there is a value &gt; 0.<br />\nWhen I <code>Debug.Print</code> the values, they return 0, when they have numbers in them (Thursday, Friday, Saturday).<br />\n<a href=\"https://i.stack.imgur.com/obPGL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/obPGL.png\" alt=\"enter image description here\" /></a></p>\n<p>What is currently being returned from the array:<br />\n<a href=\"https://i.stack.imgur.com/p7Mwc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p7Mwc.png\" alt=\"enter image description here\" /></a></p>\n<p>Due to the length of my code, I posted my method of how I constructed the routine, with most of the code.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Main()\n\nDim ws Worksheet\n\n'//---Start and End Dates\n    For Each ws In wbSpotPlan.Worksheets\n        If ws.Name &lt;&gt; &quot;Schedule Info&quot; Then\n            'get dimensions from sheet\n            lRowWS = ws.UsedRange.Rows.Count\n            lColWS = ws.UsedRange.Columns.Count\n            'set the array\n            aWS = ws.Range(&quot;A1&quot;).Resize(lRowWS, lColWS).Value\n            \n            'loop through the rows\n            For i = 1 To lRowWS\n                'find the spots row for reference\n                'once per sheet\n                If aWS(i, 1) = &quot;Spot Plan&quot; Then\n                    lRowSpots = i + 1\n                End If\n                \n                'find the weeks...\n                If InStr(1, aWS(i, 1), &quot;Week&quot;) &gt; 0 Then\n                    'need to declare a date counting variable\n                    Dim lWeekDayCnt As Long\n                    Dim sWeekStartDate As String, dWeekStartDate As Date\n                    Dim bSpotCheck As Boolean\n                    Dim dStartDate As Date, dEndDate As Date\n                    \n                    \n                    sWeekStartDate = Trim(Right(aWS(i, 1), 6))\n                    dWeekStartDate = CDate(sWeekStartDate)\n                    \n                    'loop columns\n                    'start date\n                    For j = 1 To lColWS\n                        If aWS(lRowSpots, j) = &quot;Spots&quot; Then\n                            Debug.Print aWS(lRowSpots - 1, j)\n                            'now quick loop to check if true\n                            For k = i To (i + 5)\n                                Debug.Print aWS(i, j)\n                                If aWS(i, j) &gt; 0 Then\n                                    'there is a spot, therefore start date\n                                    bSpotCheck = True\n                                    Exit For\n                                End If\n                            Next k\n                            \n                            If bSpotCheck = True Then\n                                Exit For\n                            Else\n                                lWeekDayCnt = lWeekDayCnt + 1\n                            End If\n                        End If\n                    Next j\n                    \n                    'now calculate the start date for this week\n                    dStartDate = format(dWeekStartDate + lWeekDayCnt, &quot;dd/mm/yyyy&quot;)\n.\n.\n.\n'...continues\n\n\nEnd Sub\n</code></pre>\n<p>I used the function to return the start date for the week if there are spots on that day. For example, the Monday date is the 7th, and the first day with spots is Thursday, so <code>dStartDate</code> should return 10th, but because the values in the spots are all returning <code>0</code> in the array the counter is not correct.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1565793449, "post_id": 57493234, "comment_id": 101463453, "body": "The format of the site encourages one question per post so there can be an accepted answer. Delete the edit and ask a separate on-topic question. That way you may accept an answer there if you wish. You cannot accept two answers on the same question."}], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 1, "last_activity_date": 1565781712, "creation_date": 1565781712, "answer_id": 57493715, "question_id": 57493234, "link": "https://stackoverflow.com/questions/57493234/creating-multiple-outlook-appointments-from-one-line-of-data/57493715#57493715", "title": "Creating multiple Outlook appointments from one line of data", "body": "<p>Since you need to create 3 appointments, you need to move <code>Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)</code> inside the loop and do it 3 times.  The revised code illustrates this idea.</p>\n\n<pre><code>Sub ResolveName()\n    Dim OL As Outlook.Application, ES As Worksheet, r As Long, i As Long, wb As ThisWorkbook\n    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Licences\")\n    Set OL = New Outlook.Application\n    Dim myOlApp As Outlook.Application\n    Dim myNamespace As Outlook.Namespace\n    Dim myRecipient As Outlook.Recipient\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myNamespace = myOlApp.GetNamespace(\"MAPI\")\n    Dim SharedMailboxEmail As String\n\n    SharedMailboxEmail = \"xxx@xxx.com\"\n    Set outSharedName = myNamespace.CreateRecipient(SharedMailboxEmail)\n    Set outCalendarFolder = myNamespace.GetSharedDefaultFolder(outSharedName, olFolderCalendar)\n    Set myRecipient = myNamespace.CreateRecipient(\"DTS Streetworks\")\n    myRecipient.Resolve\n\n    r = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 5 To r\n        With Cells(i, 5)\n          If myRecipient.Resolved And .Value = \"TTRO\" And Cells(i, 6) &lt;&gt; \"\" Then\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send Notice of Intent - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 33) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = ES.Cells(i, 5).Value\n                             .Save\n             End With\n\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send Notice of Making - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 38) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = ES.Cells(i, 5).Value\n                             .Save\n             End With\n\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send Full Order - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 43) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = ES.Cells(i, 5).Value\n                             .Save\n             End With\n          End If\n        End With\n    Next i\n\n    Set OL = Nothing\n    Set wb = Nothing\n    Set ES = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565792221, "post_id": 57493721, "comment_id": 101462800, "body": "I&#39;m now trying to make it create appointments based on the cell value - if the value is <code>TTRO</code> as above it will create the 3 appointments which now works, however I then also want it to continue to check the values and make an appointment on a date in column BB (54). Tried the amended code in original post but no luck?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1565781731, "creation_date": 1565781731, "answer_id": 57493721, "question_id": 57493234, "link": "https://stackoverflow.com/questions/57493234/creating-multiple-outlook-appointments-from-one-line-of-data/57493721#57493721", "title": "Creating multiple Outlook appointments from one line of data", "body": "<p>For each time specified in the Excel row you just need to repeat the following call:</p>\n\n<pre><code>Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 57493715, "answer_count": 2, "score": 1, "last_activity_date": 1565792298, "creation_date": 1565779783, "last_edit_date": 1565792298, "question_id": 57493234, "link": "https://stackoverflow.com/questions/57493234/creating-multiple-outlook-appointments-from-one-line-of-data", "title": "Creating multiple Outlook appointments from one line of data", "body": "<p>The below creates an appointment in Outlook from my Excel data - is there any way to create multiple appointments, rather than what the below does which just updates a single appointment? I'd need 3 different appointments (dates for each in column number 33, 38 and 43), the code I have just makes a single appointment and updates until the last date.</p>\n\n<pre><code>Sub ResolveName()\n\nDim OL As Outlook.Application, ES As Worksheet, _\n    r As Long, i As Long, wb As ThisWorkbook\n\n    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Licences\")\n    Set OL = New Outlook.Application\n    Dim myOlApp As Outlook.Application\n    Dim myNamespace As Outlook.Namespace\n    Dim myRecipient As Outlook.Recipient\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myNamespace = myOlApp.GetNamespace(\"MAPI\")\n\n\n    Dim SharedMailboxEmail As String\n\n    SharedMailboxEmail = \"xxx@xxx.com\"  \n\n    Set outSharedName = myNamespace.CreateRecipient(SharedMailboxEmail)\n    Set outCalendarFolder = myNamespace.GetSharedDefaultFolder(outSharedName, olFolderCalendar)\n    Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n\n    Set myRecipient = myNamespace.CreateRecipient(\"DTS Streetworks\")\n    myRecipient.Resolve\n\n\n\n    r = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 5 To r\n        With Cells(i, 5)\n\n         If myRecipient.Resolved And .Value = \"TTRO\" And Cells(i, 6) &lt;&gt; \"\" Then\n    With outappointment\n                    .Subject = \"Send Notice of Intent - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                    .Start = ES.Cells(i, 33) + TimeValue(\"09:00:00\")\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = ES.Cells(i, 5).Value\n                    .Save\n    End With\n\n    With outappointment\n                    .Subject = \"Send Notice of Making - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                    .Start = ES.Cells(i, 38) + TimeValue(\"09:00:00\")\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = ES.Cells(i, 5).Value\n                    .Save\n    End With\n\nWith outappointment\n                    .Subject = \"Send Full Order - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                    .Start = ES.Cells(i, 43) + TimeValue(\"09:00:00\")\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = ES.Cells(i, 5).Value\n                    .Save\n    End With\n    End If\n    End With\n    Next i\n\n    Set OL = Nothing\n    Set wb = Nothing\n    Set ES = Nothing\n\nEnd Sub\n\nSub ShowCalendar(myNamespace, myRecipient)\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set CalendarFolder = myNamespace.GetSharedDefaultFolder(myRecipient, olFolderCalendar)\n    CalendarFolder.Display\nEnd Sub\n</code></pre>\n\n<p>UPDATE - </p>\n\n<p>As per comment stating new requirements, code below:</p>\n\n<pre><code>Sub ResolveNameTTRO()\n    Dim OL As Outlook.Application, ES As Worksheet, r As Long, i As Long, wb As ThisWorkbook\n    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Licences\")\n    Set OL = New Outlook.Application\n    Dim myOlApp As Outlook.Application\n    Dim myNamespace As Outlook.Namespace\n    Dim myRecipient As Outlook.Recipient\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myNamespace = myOlApp.GetNamespace(\"MAPI\")\n    Dim SharedMailboxEmail As String\n\n    SharedMailboxEmail = \"xxx@xxx.com\"\n    Set outSharedName = myNamespace.CreateRecipient(SharedMailboxEmail)\n    Set outCalendarFolder = myNamespace.GetSharedDefaultFolder(outSharedName, olFolderCalendar)\n    Set myRecipient = myNamespace.CreateRecipient(\"DTS Streetworks\")\n    myRecipient.Resolve\n\n    r = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 5 To r\n        With Cells(i, 5)\n          If myRecipient.Resolved And .Value = \"TTRO\" And Cells(i, 6) &lt;&gt; \"\" Then\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send Notice of Intent - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 33) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = ES.Cells(i, 5).Value\n                             .Save\n             End With\n\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send Notice of Making - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 38) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = ES.Cells(i, 5).Value\n                             .Save\n             End With\n\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send Full Order - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 43) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = ES.Cells(i, 5).Value\n                             .Save\n             End With\n\n             If myRecipient.Resolved And .Value = \"Section 50\" And Cells(i, 6) &lt;&gt; \"\" Then\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send licence - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 54) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = \"Send licence to \" + ES.Cells(i, 10).Value\n                             .Save\n             End With\n\n             If myRecipient.Resolved And .Value = \"Mobile Plant\" And Cells(i, 6) &lt;&gt; \"\" Then\n             Set outappointment = outCalendarFolder.Items.Add(olAppointmentItem)\n             With outappointment\n                             .Subject = \"Send licence - \" + ES.Cells(i, 4).Value + \" \" + ES.Cells(i, 12).Value\n                             .Start = ES.Cells(i, 54) + TimeValue(\"09:00:00\")\n                             .ReminderSet = True\n                             .ReminderMinutesBeforeStart = 60\n                             .Body = \"Send licence to \" + ES.Cells(i, 10).Value\n                             .Save\n             End With\n             End If\n             End With\n\n    Next i\n\n    Set OL = Nothing\n    Set wb = Nothing\n    Set ES = Nothing\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565805868, "post_id": 57493036, "comment_id": 101469220, "body": "I can&#39;t reproduce any such effect from your description. If it&#39;s only one presentation that has this problem, it could be some construction problem or file corruption."}, {"owner": {"reputation": 13, "user_id": 5375021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-N4ISfJbysnw/AAAAAAAAAAI/AAAAAAAAD38/6ntU5rvQ6qs/photo.jpg?sz=128", "display_name": "Bes Gh", "link": "https://stackoverflow.com/users/5375021/bes-gh"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565849960, "post_id": 57493036, "comment_id": 101479224, "body": "it&#39;s easy to replicate, just create a blank presentation, add shapes. than add any of the emphasis, exit and motion paths animations to that shapes and run the code <code>ActivePresentation.Slides(1).Shapes(1).AnimationSettings.Sou&zwnj;&#8203;ndEffect.ImportFromF&zwnj;&#8203;ile &quot;D:\\aTi.wav&quot;</code> animations will dissapear. it&#39;s acting like a bug, but there might be something that i&#39;m missing"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565881685, "post_id": 57493036, "comment_id": 101491770, "body": "Of course, I already tried that before I posted. As I said, I can&#39;t reproduce it. Please try with a fresh file to see if it happens again. If it does, try repairing your Office installation: <a href=\"https://support.office.com/en-us/article/repair-an-office-application-7821d4b6-7c1d-4205-aa0e-a6b40c5bb88b\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 5375021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-N4ISfJbysnw/AAAAAAAAAAI/AAAAAAAAD38/6ntU5rvQ6qs/photo.jpg?sz=128", "display_name": "Bes Gh", "link": "https://stackoverflow.com/users/5375021/bes-gh"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1565940336, "post_id": 57493036, "comment_id": 101508035, "body": "if you tried that and did not happend what i&#39;ve written, then your suggestion is correct, whole instalation has a problem... thanks a lot"}], "owner": {"reputation": 13, "user_id": 5375021, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-N4ISfJbysnw/AAAAAAAAAAI/AAAAAAAAD38/6ntU5rvQ6qs/photo.jpg?sz=128", "display_name": "Bes Gh", "link": "https://stackoverflow.com/users/5375021/bes-gh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593677187, "creation_date": 1565778977, "last_edit_date": 1593677187, "question_id": 57493036, "link": "https://stackoverflow.com/questions/57493036/adding-sound-effect-with-vba-in-powerpoint-vanishes-ather-animations", "title": "adding sound effect with VBA in PowerPoint vanishes ather animations", "body": "<p>I have a simple slideshow, with many slides. When I tried to add a sound effect with VBA to certain shapes for some reason animations are getting messed, some of them are disappeared at all.</p>\n\n<p>I have simplified the sub down to one line:</p>\n\n<pre><code>     Sub change_sound()\n         ActivePresentation.Slides(4).Shapes(3).AnimationSettings.SoundEffect.ImportFromFile \"C:\\Users\\besik.ghviniashvili\\Desktop\\MacroABC\\audio\\kalia.wav\"\n     End Sub\n</code></pre>\n\n<p>After I run this only line of code, the animations are transformed, durations are changed, motion paths and exit animations are cleared at all, and the animation on which i am trying to apply sound is changed from \"float in\" to \"appear\", but the sound effect is added to the animation.</p>\n\n<p>I noticed that, if i add the same sound manually and run the same code nothing bad happens and with other sound file the animations are messing as usual. I tried moving sound files to other folder but nothing changed.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": false, "score": 0, "last_activity_date": 1565780688, "creation_date": 1565780688, "answer_id": 57493462, "question_id": 57492974, "link": "https://stackoverflow.com/questions/57492974/excel-vba-after-filtering-column-to-replace-filtered-cells-value-dynamically/57493462#57493462", "title": "Excel VBA: After Filtering column, to replace filtered cells value dynamically", "body": "<p>You can use Replace or SpecialCells(xlCellTypeVisible), don't really understand everything You want, but i think these hints are everything You need to do this code :)</p>\n\n<pre><code>lLastR = .cells(rows.count,1).end(xlup).row\n.Range(\"J2:J\" &amp; lLastR).Replace \"\", \"TBA\"\n.Range(\"F2:F\" &amp; lLastR).SpecialCells(xlCellTypeVisible) = 1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11926792, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jqGjleDWowQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfznp2fvH12cxpIR8CCoTv-pbZ70Q/photo.jpg?sz=128", "display_name": "user11926792", "link": "https://stackoverflow.com/users/11926792/user11926792"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565780688, "creation_date": 1565778722, "question_id": 57492974, "link": "https://stackoverflow.com/questions/57492974/excel-vba-after-filtering-column-to-replace-filtered-cells-value-dynamically", "title": "Excel VBA: After Filtering column, to replace filtered cells value dynamically", "body": "<p>Like to input into Excel VBA:</p>\n\n<p>Have a Column (V), after filtered for \"#N/A\"\nTo replace with formula (=ColC -Col V)\nAnd FillDown rest of Filtered cells in ColV</p>\n\n<p>Have a Column (D), after filtered for \"TBA\"\nTo paste into Columns beside (ColE,F,G,H)\nAnd FillDown rest of Filtered cells</p>\n\n<p>Have a Column (J), after filtered for \"Blank\"\nTo replace with \"TBA\"\nAnd FillDown rest of filtered cells in ColJ</p>\n\n<p>For MS Windows Excel 2016</p>\n\n<pre><code>    'Record Macro'\n\n'First Case\nActiveSheet.Range(\"$AA$1:$AA$65303\").AutoFilter Field:=1, Criteria1:=\"=\"\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=RC[-5]+RC[-1]\"\n    Range(\"AA365\").Select\n    Range(\"AA365\").Select\n    Selection.FillDown\n\n'Second Case\nColumns(\"L:L\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$L$1:$L$65303\").AutoFilter Field:=1, Criteria1:=\"TBA\"\n    Range(\"L488\").Select\n    ActiveCell.FormulaR1C1 = \"TBA\"\n    Range(\"L479:L488\").Select\n    Selection.FillRight\n    Range(\"O65307\").Select\n\n</code></pre>\n\n<p>Thank You\nFeel free if need clarification</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565787335, "post_id": 57492900, "comment_id": 101459922, "body": "Does the text <b>&quot;Subject&quot;</b> appear within the subject of the email? (i.e. <b>&quot;Subject16/08/2019&quot;</b>). <b>NOTE</b>: there is no space between the date and the text.. is that how the text appear in <code>Subject</code>?"}, {"owner": {"reputation": 1, "user_id": 11926732, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156491826048481/picture?type=large", "display_name": "Laura Hill Cabrera", "link": "https://stackoverflow.com/users/11926732/laura-hill-cabrera"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565789437, "post_id": 57492900, "comment_id": 101461210, "body": "Hi Zac, yes that is how the text appears as subject in the e-mail &quot;Subject16/08/2019&quot; without a space."}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1565790962, "post_id": 57496074, "comment_id": 101462087, "body": "For performance reason, I would capture the values from column a in a dictionary then have a single loop to check all emails in 1 loop"}, {"owner": {"reputation": 1, "user_id": 11926732, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156491826048481/picture?type=large", "display_name": "Laura Hill Cabrera", "link": "https://stackoverflow.com/users/11926732/laura-hill-cabrera"}, "edited": false, "score": 0, "creation_date": 1566373496, "post_id": 57496074, "comment_id": 101631249, "body": "Unfortunately I now get syntax error for both the original code as the adapted one for the following  &#39;If InStr (1, olMail.Subject, &quot;Subject&quot; &amp; Range (&quot;A&quot; &amp; j) &gt; 0 Then&#39;. Does anyone know what could be causing this?"}], "tags": [], "owner": {"reputation": 156, "user_id": 11694208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a49d59b449fd668d3f08c7f5c1a9707?s=128&d=identicon&r=PG&f=1", "display_name": "abbsichel", "link": "https://stackoverflow.com/users/11694208/abbsichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1565790637, "creation_date": 1565790637, "answer_id": 57496074, "question_id": 57492900, "link": "https://stackoverflow.com/questions/57492900/retrieve-e-mail-body-content-depending-on-subject-title-and-cell-value-range-no/57496074#57496074", "title": "Retrieve e-mail body content depending on subject title and cell value. Range not working for cell value", "body": "<p>Create a for loop that will loop through all of the rows of column A.</p>\n\n<pre><code>LastRow = ThisWorkbook.Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row \n'Finding the last row in Column A    \nFor Each olMail In olItms\n    For j = 1 To LastRow\n      If InStr (1, olMail.Subject, \"Subject\" &amp; Range (\"A\" &amp; j) &gt; 0 Then \n         ThisWorkbook.Sheets(\"Sheet1\").Cells(i,2).Value = olMail.Body\n         i = i + 1\n      End If\n    Next j\nNext olMail\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11926732, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156491826048481/picture?type=large", "display_name": "Laura Hill Cabrera", "link": "https://stackoverflow.com/users/11926732/laura-hill-cabrera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565790637, "creation_date": 1565778482, "last_edit_date": 1565781618, "question_id": 57492900, "link": "https://stackoverflow.com/questions/57492900/retrieve-e-mail-body-content-depending-on-subject-title-and-cell-value-range-no", "title": "Retrieve e-mail body content depending on subject title and cell value. Range not working for cell value", "body": "<p>I want to retrieve the content of an email with a certain subject which is linked to a cell value in a different column.</p>\n\n<p>A similar thread was made but I'm not sure if I could ask additional questions in that thread or create a new one, my apologies.\nSimilar thread: <a href=\"https://stackoverflow.com/questions/51941798/if-outlook-subject-and-date-received\">If Outlook Subject and Date Received</a></p>\n\n<p>Code from this thread works perfect with the exception of range. \nInstead of 1 cell value (ex. A1) I want to retrieve it from the full column A. So that for each value in column A (which is in this case the date) the content of the e-mail which contains as subject \"always the same title\" &amp; \"date of cells in column A\".</p>\n\n<p>ex. A1 = 16/08/2019 ==> e-mail subject = 16/08Title ==> B2 = content of said e-mail\nA2 = 20/08/2019 ==> e-mail subject = 20/08Title ==> B2 = content of said e-mail</p>\n\n<pre><code>Sub GetFromInbox ()\n\nDim olApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim olFldr As Outlook.MAPIFolder\nDim olItms As Outlook.Items\nDim olMail As Variant \nDim i As Long\n\nSet olApp = New Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFldr = olNs.GetDefaultFolder(olFolderInbox)\nSet olItms = OlFldr.Items\n\nolItms.Sort \"Subject\"\ni =1\n\nFor Each olMail In olItms\n  If InStr (1, olMail.Subject, \"Subject\" &amp; Range (\"A1\") &gt; 0 Then \n     ThisWorkbook.Sheets(\"Sheet1\").Cells(i,2).Value = olMail.Body\n     i = i + 1\n\n  End If\n  Next olMail\n\n Set olFldr = Nothing\n Set olNs = Nothing\n Set olApp = Nothing\n\n End Sub\n</code></pre>\n\n<p>I have tried changing Range (\"A1\") to range (\"A:A\"). But this gives a runtime error 13: Type mismatch . I have also tried to use different ways to offset.\nI'm not very skilled yet in VBA and I haven't found the solution in my online search. Thank you in advance for helping!</p>\n\n<pre><code>Sub GetFromInbox ()\n\nDim olApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim olFldr As Outlook.MAPIFolder\nDim olItms As Outlook.Items\nDim olMail As Variant \nDim i As Long\n\nSet olApp = New Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFldr = olNs.GetDefaultFolder(olFolderInbox)\nSet olItms = OlFldr.Items\n\nolItms.Sort \"Subject\"\ni =1\n\nFor Each olMail In olItms\n  If InStr (1, olMail.Subject, \"Subject\" &amp; Range (\"A1\") &gt; 0 Then \n     ThisWorkbook.Sheets(\"Sheet1\").Cells(i,2).Value = olMail.Body\n     i = i + 1\n\n  End If\n  Next olMail\n\n Set olFldr = Nothing\n Set olNs = Nothing\n Set olApp = Nothing\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1565781810, "post_id": 57492695, "comment_id": 101457148, "body": "Have you considered a printer issue? Print preview needs to pull in printer information for the printer the report is going to print on. If there&#39;s a bad default printer that can cause Access to hang."}, {"owner": {"reputation": 66, "user_id": 10825975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sEvf4hfdCkM/AAAAAAAAAAI/AAAAAAAAbcU/6oui1GqxfHo/photo.jpg?sz=128", "display_name": "Turtles", "link": "https://stackoverflow.com/users/10825975/turtles"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1565869045, "post_id": 57492695, "comment_id": 101485726, "body": "Thank you for your answer  Erik !However, the both computers have the same printer installed."}, {"owner": {"reputation": 66, "user_id": 10825975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sEvf4hfdCkM/AAAAAAAAAAI/AAAAAAAAbcU/6oui1GqxfHo/photo.jpg?sz=128", "display_name": "Turtles", "link": "https://stackoverflow.com/users/10825975/turtles"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1565870395, "post_id": 57492695, "comment_id": 101486234, "body": "Hello everybody, I found the solution and I would like to post here. Maybe it can help someone. It was a bug in the report access object. I deleted this object and create another one with the same fields and linked data as the first one. It worked perfect now in any computer!!!"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 10825975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sEvf4hfdCkM/AAAAAAAAAAI/AAAAAAAAbcU/6oui1GqxfHo/photo.jpg?sz=128", "display_name": "Turtles", "link": "https://stackoverflow.com/users/10825975/turtles"}, "is_accepted": false, "score": 0, "last_activity_date": 1567356158, "creation_date": 1567356158, "answer_id": 57747794, "question_id": 57492695, "link": "https://stackoverflow.com/questions/57492695/docmd-openreport-work-well-in-some-pcs-and-do-not-work-freeze-access-in-other/57747794#57747794", "title": "DoCmd.OpenReport work well in some pcs and do not work (freeze access) in other pcs", "body": "<p>I found the solution and I would like to post here. Maybe it can help someone. It was a bug in the report access object. I deleted this object and create another one with the same fields and linked data as the first one. It worked perfect now in any computer!!! \u2013 </p>\n"}], "owner": {"reputation": 66, "user_id": 10825975, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sEvf4hfdCkM/AAAAAAAAAAI/AAAAAAAAbcU/6oui1GqxfHo/photo.jpg?sz=128", "display_name": "Turtles", "link": "https://stackoverflow.com/users/10825975/turtles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594549177, "creation_date": 1565777663, "last_edit_date": 1594549177, "question_id": 57492695, "link": "https://stackoverflow.com/questions/57492695/docmd-openreport-work-well-in-some-pcs-and-do-not-work-freeze-access-in-other", "title": "DoCmd.OpenReport work well in some pcs and do not work (freeze access) in other pcs", "body": "<p>I have a problem with my access program and I would be very glad if someone could help me! </p>\n\n<p>We have an application in Microsoft Access developed. It worked without errors in my PC (ex.: <strong>PC A</strong>). However, running the same application in another computer (ex.: <strong>PC B</strong>). The application works perfectly in <strong>PC B</strong> with the exception of this command <strong>DoCmd.OpenReport</strong>.</p>\n\n<p>When I run this command in the <strong>PC B</strong> the application freeze. It stops and I have to force closed it. The big problem is that we do not have any errors report from Access or Windows. Even if we debug the application, it freezes without returning any feedback. \nWe also checked in the <strong>window 10</strong> the event viewer application to check if there are any errors. However, we also did not get any feedback.</p>\n\n<p>What we also have tried:\n1) reinstall the <strong>office 2010</strong>\n2) checked also the dependencies libraries on both pcs (<strong>PC-A and PC-B</strong>). They are identical. \n3) checked both hardware and windows versions. They are also the same.</p>\n\n<p>This is a part of the code where it freezes only in PC B:</p>\n\n<pre><code>strSQL = \"((mid(Tb_History.strFormName,1,4)=\" &amp; \"'\" &amp; Mid(strFormName_IN, 1, 4) &amp; \"'\" &amp; \") \" \"AND (Tb_History.strDataPrimaryKey=\" &amp; \"'\" &amp; strKey_IN &amp; \"'\" &amp; \"))\"\n\n DoCmd.OpenReport \"History_Show\", acViewPreview, , strSQL\n</code></pre>\n\n<p>Can someone, please, help me?\nThanks!</p>\n\n<p>Cheers,\nMarcelo</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565776948, "post_id": 57492480, "comment_id": 101454701, "body": "What is in the <code>With</code> block that <code>.Offset(1, 0)</code> is referring to? Can you <a href=\"https://stackoverflow.com/posts/57492480/edit\">edit</a> your question with exactly how you&#39;re using the line <code>Range(&quot;C&quot; &amp; .Offset(1, 0).SpecialCells(xlCellTypeVisible)(1).Row).Value</code>, i.e. the code that it&#39;s in?"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565777577, "post_id": 57492480, "comment_id": 101455028, "body": "So that&#39;s the code I found online with people who have had a similar issue and wanting to refer to the first filtered result. But they were using an AutoFilter, so I don&#39;t know if that is what is causing the issue. I probably haven&#39;t implemented it into my code correctly. I tried putting it in without a With block like <code>ws.Range(&quot;C&quot; &amp; .Offset(1, 0).SpecialCells(xlCellTypeVisible)(1).Row).Value</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565777636, "post_id": 57492480, "comment_id": 101455056, "body": "Can you <a href=\"https://stackoverflow.com/posts/57492480/edit\">edit</a> your question with the <code>With</code> block? Thanks! And maybe remove a lot of the code that is not pertinent to this specific issue?"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565777788, "post_id": 57492480, "comment_id": 101455145, "body": "Just edited it now. So the error now is No Cells Were Found"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565778229, "post_id": 57492480, "comment_id": 101455392, "body": "I figured I&#39;d keep in the code in there for context so that once I am able to refer to the first result, I&#39;ll try to make the counter work and if there is any issues with the counter I can keep it within this question submission"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1565784154, "post_id": 57492480, "comment_id": 101458263, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51882555/vba-find-row-number-of-first-visible-row-after-filter\">VBA Find row number of first visible row after filter</a>"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1565784213, "post_id": 57492480, "comment_id": 101458285, "body": "Their example is using an AutoFilter, would it work the same for a AdvancedFilter?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1565787018, "post_id": 57492480, "comment_id": 101459746, "body": "Try it. If you can get the row number of first visible row after filtering, then assign a value to a specific cell in that row should be a piece of cake."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1565793160, "post_id": 57496236, "comment_id": 101463316, "body": "Ah I hadn&#39;t realised that. So I managed to resolve my initial issue of setting up a variable to be the value of the first result by using this <code>First_Row_Filtered = Range(&quot;C6:C&quot; &amp; Rows.Count).SpecialCells(xlVisible)(1).Value</code>"}], "tags": [], "owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "is_accepted": true, "score": 1, "last_activity_date": 1565791193, "creation_date": 1565791193, "answer_id": 57496236, "question_id": 57492480, "link": "https://stackoverflow.com/questions/57492480/excel-vba-assigning-a-variable-to-the-value-of-the-first-cell-from-results-of-a/57496236#57496236", "title": "Excel VBA: Assigning a variable to the value of the first cell from results of an AdvancedFilter", "body": "<p>In your second code, you did not <strong>CALL</strong> Filter Data. Your first 2 lines of code should be </p>\n\n<pre><code>Public Sub GetNextResult()    \n\n    Call FilterData\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 57496236, "answer_count": 1, "score": 0, "last_activity_date": 1565791193, "creation_date": 1565776834, "last_edit_date": 1565777770, "question_id": 57492480, "link": "https://stackoverflow.com/questions/57492480/excel-vba-assigning-a-variable-to-the-value-of-the-first-cell-from-results-of-a", "title": "Excel VBA: Assigning a variable to the value of the first cell from results of an AdvancedFilter", "body": "<p>I'm trying to get the value of the first filter result that is in column C. The headers are on A5 to J5 and then the results are below. Pointing to C6 gives me the value of the first row in the database when it isn't filtered. I've read online that using </p>\n\n<pre><code>Range(\"C\" &amp; .Offset(1, 0).SpecialCells(xlCellTypeVisible)(1).Row).Value\n</code></pre>\n\n<p>Would return the value as this takes into account that some of the rows are filtered out, but this doesn't work for me. I tried putting it in my GetNextResult subroutine below where I have Set the FilteredData Range variable, and it prompts Compile Error, Invalid or Unqualified Reference.</p>\n\n<p>Just to make it clear, the first subroutine, FilterData, is actually the one that filters the data. The second subroutine, GetNextResult, calls on FilterData() but the purpose of this subroutine is to insert the value of each result into a textbox, one by one upon each execution of this macro.</p>\n\n<p>Not that it's particularly relevant to the issue but in case it's important, the reason I want the value of the first result when filtered is for the purposes of a counter. I'm looking to make it so every time the GetNextResult macro sends the next result to the text boxes the counter goes up by one, so that the user can keep track of how many they've cycled through and not get to the point where they don't realise they're seeing the same results over and over. I figured, if I can get the value of the first filtered row then I can make an if statement say that if the textbox contains this value then make sure counter is 1, and that is the reset point.</p>\n\n<pre><code>Public Sub FilterData()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Database\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n\n    Dim CriteriaRange As Range\n    Set CriteriaRange = ws.Range(\"A2\", \"C3\")\n\n    If Range(\"C3\").Value = \"Any\" Then\n    Set CriteriaRange = ws.Range(\"A2\", \"B3\")\n    End If\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"J\" &amp; LastRow)\n\n\n\n    DataRange.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=CriteriaRange, Unique:=False\n\n    Call last_used_sort\n\n    If Not DataRange.Columns(1).Rows.SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n\n        Call ShowAll\n        MsgBox \"No Results\"        \n\n        Exit Sub\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<pre><code>Public Sub GetNextResult()\n\n\n    FilterData\n\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Database\")\n\n    Dim header As String\n    header = \"Cards\"\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n\n    Dim DataRange As Range\n    Set DataRange = ws.Range(\"A5\", \"J\" &amp; LastRow)\n\n    Dim FilteredData As Range\n    Set FilteredData = DataRange.Resize(ColumnSize:=1).SpecialCells(xlCellTypeVisible)\n\n\n    If CurrentRow + 1 &gt; FilteredData.Cells.Count Then\n        CurrentRow = 1\n    End If\n\n\n    CurrentRow = CurrentRow + 1\n\n    With FilteredData\n    first_row = Range(\"C\" &amp; .Offset(1, 0).SpecialCells(xlCellTypeVisible)(1).Row).Value\n    End With\n    Debug.Print first_row\n\n\n    Dim i As Long\n    Dim cell As Variant\n    Static counter As Long\n\n    counter = counter + 1\n\n    If counter = Quick_Insert_Range Then\n    counter = 1\n    End If\n\n    ActiveSheet.Shapes(\"Cardcounter\").TextFrame.Characters.Text = counter\n\n\n    For Each cell In FilteredData\n\n        i = i + 1\n        If i = CurrentRow Then\n            Call ShowAll\n\n\n            TextboxName = \"txt1\"\n            ActiveSheet.Shapes(TextboxName).DrawingObject.Text = cell.Offset(0, 2)\n\n            TextboxName2 = \"txt2\"\n            ActiveSheet.Shapes(TextboxName2).DrawingObject.Text = cell.Offset(0, 3)\n\n            TextboxName3 = \"txt3\"\n            ActiveSheet.Shapes(TextboxName3).DrawingObject.Text = cell.Offset(0, 4)\n\n\n            If ActiveSheet.Shapes(TextboxName).DrawingObject.Text = header Then\n\n                Call GetNextResult\n            End If\n\n            Call quick_artwork\n\n\n        Else\n            Call ShowAll\n\n        End If\n\n\n    Next cell\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1565776554, "post_id": 57492378, "comment_id": 101454510, "body": "Where do you actually assign a value to <code>txt</code>? Also - there is no <code>0</code> row in Excel, so <code>Cells(i, i+1)</code> will fail on the first iteration of <code>i</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1565778983, "creation_date": 1565778983, "answer_id": 57493037, "question_id": 57492378, "link": "https://stackoverflow.com/questions/57492378/split-text-on-new-line-using-excel-vba/57493037#57493037", "title": "Split Text on New Line using Excel &amp; VBA", "body": "<p>I think you can achieve what you're trying to do with <code>TextToColumns</code></p>\n\n<pre><code>Dim rng As Range\n\n' Sheet with your source values\nWith ActiveSheet\n    ' Range of all values\n    Set rng = .Range(.Cells(1, 1), .Cells(5, 1))\nEnd With\n\n' Split on spaces in place\nrng.TextToColumns\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11926475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HAsJ3Wj3e4g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJtesa1Uj5M-_3zd0QS7UFvy7Yrw/photo.jpg?sz=128", "display_name": "chun", "link": "https://stackoverflow.com/users/11926475/chun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57493037, "answer_count": 1, "score": 0, "last_activity_date": 1565778983, "creation_date": 1565776484, "last_edit_date": 1565778344, "question_id": 57492378, "link": "https://stackoverflow.com/questions/57492378/split-text-on-new-line-using-excel-vba", "title": "Split Text on New Line using Excel &amp; VBA", "body": "<p>I want to split the text one by one automatically? However, I tried split the text on the active cell only. It cannot do it automatically. </p>\n\n<pre><code>PID10 Lemon Tea \n\nPID11 Mango Tea\n\nPID12 Apple Tea\n</code></pre>\n\n<p>I am using the following for split text </p>\n\n<pre><code>Sub NameTest()\n    Dim txt As String\n    Dim i As Integer\n    Dim FullName As Variant\n\n    Range(\"txt\") = ActiveCell.Value\n    FullName = Split(txt, \"PID\")\n\n    For i = 0 To UBound(FullName)\n        Cells(i, i + 1).Value = FullName(i)\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1565776332, "post_id": 57492097, "comment_id": 101454404, "body": "Why do you need <code>wd</code>? You don&#39;t seem to use it anywhere. Perhaps you&#39;ve meant <code>mydoc = wd.Documents.Open(Filename:=path &amp; s, Format:=&quot;PDF Files&quot;, ConfirmConversions:=False)</code> ?"}, {"owner": {"reputation": 13, "user_id": 9415014, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sathish Kumar", "link": "https://stackoverflow.com/users/9415014/sathish-kumar"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1565778341, "post_id": 57492097, "comment_id": 101455450, "body": "Thank you so much. after removing those wd codes, it is working fine. Thanks again."}], "owner": {"reputation": 13, "user_id": 9415014, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sathish Kumar", "link": "https://stackoverflow.com/users/9415014/sathish-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565775730, "creation_date": 1565775497, "last_edit_date": 1565775730, "question_id": 57492097, "link": "https://stackoverflow.com/questions/57492097/how-to-resolve-error-remote-server-machine-does-not-exist-or-is-unavailable", "title": "How to resolve error remote server machine does not exist or is unavailable?", "body": "<p>I want to open many pdfs in specific folder using word document and copy the contents and paste in my excel sheet without format change. The code which i have written was able to perform the task for 2 pdf files only after that it is showing run time error 462 - The remote server machine does not exist or is unavailable. Kindly help me what is going wrong and how i can resolve it? Thanks in advance.</p>\n\n<pre><code>Sub test()\nDim s As String\nDim path As String\nDim col As Integer: col = 1\nDim t As Excel.Range\n    path = \"C:\\Users\\121919\\Desktop\\Direct Dispatch Report_PENS\\29 Jul\\PDF to Word Try\\\"\n    s = Dir(path &amp; \"*.pdf\")\n\n\nDo Until s = \"\"\n    Dim wd As New Word.Application\n    Dim mydoc As Word.document\n\n    Set mydoc = Word.Documents.Open(Filename:=path &amp; s, Format:=\"PDF Files\", ConfirmConversions:=False)\n    Dim wr As Word.Range\n    Set wr = mydoc.Paragraphs(1).Range\n\n    wr.WholeStory\n    Set t = ThisWorkbook.Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n    wr.Copy\n    t.PasteSpecial xlPasteValues\n\n    mydoc.Close False: s = Dir\n\n    wd.Quit '&lt;- This is where the code stops and throw error\n\nLoop\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1565775556, "creation_date": 1565775556, "answer_id": 57492115, "question_id": 57491878, "link": "https://stackoverflow.com/questions/57491878/is-there-a-way-to-auto-increment-ids-on-userforms/57492115#57492115", "title": "Is there a way to auto-increment ID&#39;s on UserForms", "body": "<p>you can try this by referring target sheet,</p>\n\n<pre><code>Private Sub UserForm_Activate()\n\n Dim LstRw As Long\n\n LstRw = ThisWorkbook.Sheets(\"Lead Data\").Cells(Rows.Count, \"I\").End(xlUp).Row\n\n' Col.A after adding 1 to it.\n Me.tbLeadID.Value = ThisWorkbook.Sheets(\"Lead Data\").Cells(LstRw, \"I\").Value + 1\n\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1565775677, "creation_date": 1565775677, "answer_id": 57492148, "question_id": 57491878, "link": "https://stackoverflow.com/questions/57491878/is-there-a-way-to-auto-increment-ids-on-userforms/57492148#57492148", "title": "Is there a way to auto-increment ID&#39;s on UserForms", "body": "<p>It should be on Initialise, otherwise it would increase if you switched away and back again.   Personally ! would use Max() to find the largest value in whichever column you're storing the ID in. If that's column A then I would write</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nMe.TxtLeadID = Application.WorksheetFunction.Max(ThisWorkbook.Worksheets(1).Range(\"A:A\")) + 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1565793910, "creation_date": 1565793910, "answer_id": 57497015, "question_id": 57491878, "link": "https://stackoverflow.com/questions/57491878/is-there-a-way-to-auto-increment-ids-on-userforms/57497015#57497015", "title": "Is there a way to auto-increment ID&#39;s on UserForms", "body": "<p>Thanks both for your suggestions, this moved my understanding forward. </p>\n\n<p>I actually went a slightly different direction, and have solved the problem for the time being. </p>\n\n<p>I have recorded a     NextID field on one of my reference worksheets. </p>\n\n<p>This is pulled back onto the     UserForm on initialize. </p>\n\n<pre><code>tbLeadID.Value = ThisWorkbook.Worksheets(\"OtherRefData\").Range(\"H2\").Value\n</code></pre>\n\n<p>Then when the userform is saved using the save button</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"OtherRefData\").Range(\"H2\").Value = \nThisWorkbook.Worksheets(\"OtherRefData\").Range(\"H2\").Value + 1\n</code></pre>\n\n<p>Open to feedback on this! </p>\n"}], "owner": {"reputation": 1, "user_id": 11926496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48aa57abf9e3def5cf2e64ed469418?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/11926496/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1565793910, "creation_date": 1565774792, "last_edit_date": 1565777369, "question_id": 57491878, "link": "https://stackoverflow.com/questions/57491878/is-there-a-way-to-auto-increment-ids-on-userforms", "title": "Is there a way to auto-increment ID&#39;s on UserForms", "body": "<p>I am creating a data entry <code>UserForm</code> for sales leads (very new to VBA). All of the data collected will be written out a \"Lead Data\" worksheet. </p>\n\n<p>Each lead requires a Unique <code>LeadID</code>. This needs to be populated in a textbox on the Userform and written out to <code>\"Lead Data\"</code> in an ID column alongside all other information. </p>\n\n<p>I am struggling to find a way of</p>\n\n<ol>\n<li><p>Finding the last ID used on \"Lead Data\", setting to 1 if nothing present already. </p></li>\n<li><p>Adding 1 to this and setting the value of the TextBox to this value </p></li>\n</ol>\n\n<p>I've done some digging on various forums and the below code has been suggested but this does not reference \"Lead Data\"</p>\n\n<p>I am also unclear as to whether this should be on the Form Activation event or Initialization. </p>\n\n<pre><code>Private Sub UserForm_Activate()\n\n Dim LstRw As Long\n\n LstRw = .Cells(Rows.Count, \"I\").End(xlUp).Row\n\n Col.A after adding 1 to it.\n Me.tbLeadID.Value = .Cells(LstRw, \"I\").Value + 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565774669, "post_id": 57491795, "comment_id": 101453569, "body": "Where is this code?"}, {"owner": {"reputation": 25, "user_id": 11926446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6103f75e606e5bee2b4c47e2905afd35?s=128&d=identicon&r=PG&f=1", "display_name": "Basics B", "link": "https://stackoverflow.com/users/11926446/basics-b"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565777587, "post_id": 57491795, "comment_id": 101455036, "body": "Just updated it :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565779227, "post_id": 57491795, "comment_id": 101455876, "body": "Think you&#39;ve diagnosed your own problem. The change event is not triggered by a formula change. You could use the Calculate event or use Mikku&#39;s approach."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1565779137, "creation_date": 1565779137, "answer_id": 57493071, "question_id": 57491795, "link": "https://stackoverflow.com/questions/57491795/need-to-unhide-a-row-if-5-cells-values-change-to-a-certain-value/57493071#57493071", "title": "Need to unhide a row if 5 cells values change to a certain value", "body": "<p><strong>Instead of Doing a Formula and checking that, You can change it to</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\nIf Range(\"K20\") = \"No\" And Range(\"K22\") = \"No\" And Range(\"K24\") = \"No\" And Range(\"K30\") = \"No\" And Range(\"K32\") = \"No\" Then\n\n      Call PQShowQ7\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11926446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6103f75e606e5bee2b4c47e2905afd35?s=128&d=identicon&r=PG&f=1", "display_name": "Basics B", "link": "https://stackoverflow.com/users/11926446/basics-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 57493071, "answer_count": 1, "score": 0, "last_activity_date": 1565779137, "creation_date": 1565774518, "last_edit_date": 1565777557, "question_id": 57491795, "link": "https://stackoverflow.com/questions/57491795/need-to-unhide-a-row-if-5-cells-values-change-to-a-certain-value", "title": "Need to unhide a row if 5 cells values change to a certain value", "body": "<p>I'm creating a questionnaire where certain questions hide or show depending on the responses.</p>\n\n<p>I've managed this for individual cell changes.</p>\n\n<p>The problem I am having is that if 5 questions are responded to with value \"No\" then a certain row un-hides.</p>\n\n<p>So if cells <code>K20</code>,<code>K22</code>,<code>K24</code>, <code>K30</code> and <code>K32</code> all change to <code>\"No\"</code> then unhide <code>row 34</code></p>\n\n<p>I've tried creating a formula cell that reads all the values and outputs \"Yes\" if the 5 questions are \"No\" but I think the cell value is not changing as its a formula not a value.</p>\n\n<p>Any help would be greatly appreciated as I'm new to VBA and against the clock.</p>\n\n<p>Kind regards, :)</p>\n\n<p>Here's the code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address(False, False) = \"S32\" And Target.Value = \"Yes\" Then\n      Call PQShowQ7\n       Else\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Which activates this Module</p>\n\n<pre><code>Sub PQShowQ7()\n\nWith Sheets(\"Initial Scoping - WIP\")\n\n    Sheets(\"Initial Scoping - WIP\").Unprotect (\"xxx\")\n\n        .Range(\"A34\", \"A35\").EntireRow.Hidden = False\n\n    Sheets(\"Initial Scoping - WIP\").Protect (\"xxx\")\n\n        .Range(\"J34\").Value = \"Please Select:\"\n\n    End With\n\n    Sheets(\"Initial Scoping - WIP\").Protect (\"xxx\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565778593, "post_id": 57491755, "comment_id": 101455563, "body": "Try changing the If condition line to <code>If WorksheetFunction.CountA(Range(&quot;F5:F1000&quot;)) = 0 And WorksheetFunction.CountA(Range(&quot;N5:N1000&quot;)) = 0 Then </code>"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565779078, "post_id": 57491755, "comment_id": 101455801, "body": "I&#39;ve tried that, but it still shows the wrong message - it only says the <code>Licences created etc</code> msgbox even if both cells are blank, or one cell is blank"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565779109, "post_id": 57491755, "comment_id": 101455818, "body": "And both the columns are empty ?"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565779444, "post_id": 57491755, "comment_id": 101455971, "body": "Column N will mostly contain data but it needs to check and display the msgbox for the conditions on the same row in the range"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565779506, "post_id": 57491755, "comment_id": 101456004, "body": "Your Msgbox is checking the complete range of <code>5:1000</code> not the individual Rows."}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565779573, "post_id": 57491755, "comment_id": 101456038, "body": "Would that not create a Msgbox for each row?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565779617, "post_id": 57491755, "comment_id": 101456059, "body": "No.. That&#39;s like a Msgbox for Complete Data Once. Do you need for every row ? wouldn&#39;t that be messy if you have 1000 rows ?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565781319, "post_id": 57493301, "comment_id": 101456895, "body": "That&#39;s similar to how I ended up approaching it, it only comes up with a Msgbox when it has the necessary now - updated code in original post."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1565780056, "creation_date": 1565780056, "answer_id": 57493301, "question_id": 57491755, "link": "https://stackoverflow.com/questions/57491755/msgbox-if-values-in-multiple-ranges-are-empty/57493301#57493301", "title": "Msgbox if values in multiple ranges are empty", "body": "<ul>\n<li><p>I think you should move the below code inside loop between the lines <code>End With</code> &amp; <code>Next i</code>\nif you want to get a msgbox at every row. </p></li>\n<li><p>It will be very messy though to get a Msgbox at each row. Means 1000 Msgbox Pop ups if you have 1000 rows of Data.</p></li>\n</ul>\n\n<hr>\n\n<pre><code>If Len(Range(\"F\" &amp; i)) = 0 And Len(Range(\"N\" &amp; i)) = 0 Then\n    MsgBox \"No licence(s) to create - please enter text in column F for the appropriate licence(s) you wish to create.\"\nElse\n    MsgBox \"Licence(s) and/ or folder(s) created, please delete text from column F.\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57493301, "answer_count": 1, "score": 0, "last_activity_date": 1565781416, "creation_date": 1565774381, "last_edit_date": 1565781416, "question_id": 57491755, "link": "https://stackoverflow.com/questions/57491755/msgbox-if-values-in-multiple-ranges-are-empty", "title": "Msgbox if values in multiple ranges are empty", "body": "<p>The below code (when there is data in column F) creates a folder, hyperlinks it and makes a Word document from Excel data, and a msgbox appears when done - <code>\"Licence(s) and/ or folder(s) created, please delete text from column F.\"</code>. </p>\n\n<p>When there is no data in column F none of this occurs and the msbox displays <code>\"No licence(s) to create - please enter text in column F for the appropriate licence(s) you wish to create.\"</code>. I would like to get it so that it appears when this is blank as well as the corresponding cell in column N, but no matter what I try I just can't quite get it to work.</p>\n\n<p>It should only show <code>\"Licence(s) and/ or folder(s) created, please delete text from column F.\"</code> when there is text in column N and F.</p>\n\n<pre><code>Sub CreateLicenceFull()\n\nDim objWord\nDim objDoc\nDim objRange\nDim dirName As String\n        On Error Resume Next\nDim Foldername As String\n\n   r = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 5 To r\n        With Cells(i, 5)\n\n         If .Value = \"Mobile Plant\" And Cells(i, 6) &lt;&gt; \"\" And Cells(i,14) &lt;&gt;\"\" Then\n            ActiveSheet.Hyperlinks.Add Anchor:=Cells(i, 4), Address:=\"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Applications 2019-20\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 12) &amp; \")\", TextToDisplay:=.Value\n         dirName = Cells(4, i).Values\n         MkDir (\"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Applications 2019-20\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 12) &amp; \")\")\n         Call Shell(\"explorer.exe\" &amp; \" \" &amp; \"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Applications 2019-20\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 12) &amp; \")\", vbNormalFocus)\n\n        Set objWord = CreateObject(\"Word.Application\")\n        objWord.Visible = True\n        Set objDoc = objWord.Documents.Add(Template:=\"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Mobile Plant Licence.docx\", NewTemplate:=False, DocumentType:=0)\n\n    Set objRange = objDoc.Bookmarks(\"LicenceNo\").Range\n    objRange.InsertAfter Cells(i, 4)\n\n    Set objRange = objDoc.Bookmarks(\"Date\").Range\n    objRange.InsertAfter Cells(i, 29)\n\n    Set objRange = objDoc.Bookmarks(\"Company\").Range\n    objRange.InsertAfter Cells(i, 7)\n\n    Set objRange = objDoc.Bookmarks(\"Address\").Range\n    objRange.InsertAfter Cells(i, 8)\n\n    Set objRange = objDoc.Bookmarks(\"Location\").Range\n    objRange.InsertAfter Cells(i, 13)\n\n    Set objRange = objDoc.Bookmarks(\"Location2\").Range\n    objRange.InsertAfter Cells(i, 12)\n\n    Set objRange = objDoc.Bookmarks(\"From\").Range\n    objRange.InsertAfter Cells(i, 18)\n\n    Set objRange = objDoc.Bookmarks(\"To\").Range\n    objRange.InsertAfter Cells(i, 19)\n\n    Set objRange = objDoc.Bookmarks(\"Date2\").Range\n    objRange.InsertAfter Cells(i, 29)\n\n    Set objRange = objDoc.Bookmarks(\"Name\").Range\n    objRange.InsertAfter Cells(i, 53)\n\n    objWord.Visible = True\n    objDoc.SaveAs (\"\\\\Wbcphfil01.wbc.lan\\dts\\Groups\\Operational_Services\\opserv_group\\Enforcement\\NRSWA\\Licences\\Mobile Plant\\Applications 2019-20\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 12) &amp; \")\\\" &amp; Cells(i, 4) &amp; \" (\" &amp; Cells(i, 12) &amp; \")\")\n\n\nMsgBox Cells(i, 4) &amp; \" - Licence(s) and/ or folder(s) created, please delete text from column F.\"\n        End If\n\n        If .Value = \"Mobile Plant\" And Cells(i, 6) &lt;&gt; \"\" And Cells(i, 14) = \"\" Then\n        MsgBox \"No licence(s) to create - please enter the application date in column N for the appropriate licence(s) you wish to create.\"\n\n        End If\nEnd With\n\nnext i\n\nIf WorksheetFunction.CountA(Range(\"F5:F1000\")) = 0 Then\n        MsgBox \"No licence(s) to create - please enter text in column F for the appropriate licence(s) you wish to create.\"\n\n    End If\n\n    End Sub\n\n</code></pre>\n"}, {"tags": ["database", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11791433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c163eb771252ea27ac545aff94b5acd0?s=128&d=identicon&r=PG&f=1", "display_name": "JvN88", "link": "https://stackoverflow.com/users/11791433/jvn88"}, "edited": false, "score": 0, "creation_date": 1565854994, "post_id": 57492498, "comment_id": 101480723, "body": "That works great... Would that work the same if i had Combo boxes instead?"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1565776898, "creation_date": 1565776898, "answer_id": 57492498, "question_id": 57491745, "link": "https://stackoverflow.com/questions/57491745/how-to-populate-text-boxes-in-vba/57492498#57492498", "title": "how to populate text boxes in vba", "body": "<p>When you open a recordset you are at the first row of the data. You need to move through the records using the .MoveNext method. So</p>\n\n<pre><code>'Getting Data from database\nRE.Open \"SELECT * FROM GetCrew Where CrewName ='\" &amp; Me.cmbCrewName &amp; \"'\",CE, adOpenStatic\n'RE.MoveFirst   'strictly not needed, you always open at the first record\n\nDim r as range\nset r = Sheets(\"sheet3\").Range(\"N9\")\n\nDo 'begin loop\n     r.Value = RE(\"EmpName\")\n     set r = r.offset(1,0) 'move pointer down one cell\n     RE.MoveNext  'move recordset pointer down one\nLoop Until RE.EOF  'keep goimng until End Of File in dataset\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11791433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c163eb771252ea27ac545aff94b5acd0?s=128&d=identicon&r=PG&f=1", "display_name": "JvN88", "link": "https://stackoverflow.com/users/11791433/jvn88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1565784617, "answer_count": 1, "score": 0, "last_activity_date": 1565797808, "creation_date": 1565774368, "last_edit_date": 1565797808, "question_id": 57491745, "link": "https://stackoverflow.com/questions/57491745/how-to-populate-text-boxes-in-vba", "closed_reason": "Duplicate", "title": "how to populate text boxes in vba", "body": "<p>I have a table with a teamName and in it i have names. I am trying to now get. all the names in Team1 to display in textbox1 to say 10. But its only returning the first name in the table.</p>\n\n<pre><code>dbPath = Sheets(\"Info\").Range(\"a3\").Value\n\nCE.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath\n\n'Getting Data from database\nRE.Open \"SELECT * FROM GetCrew Where CrewName ='\" &amp; Me.cmbCrewName &amp; \"'\",CE, adOpenStatic\n\nRE.MoveFirst\n\n'Populating text box with data\nSheets(\"sheet3\").Range(\"N9\").Value = RE(\"EmpName\")\n</code></pre>\n\n<p>so <code>Textbox1 = John Doe</code>\n<code>textbox2 = steve</code> and so on</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565774375, "post_id": 57491678, "comment_id": 101453402, "body": "Works for me. Do you have any other code?"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 2, "creation_date": 1565774452, "post_id": 57491678, "comment_id": 101453444, "body": "if the idea is to have a timestamp in column G, then &#180;cells(target.row,&quot;G&quot;)=now()&#180;, should do the job"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565777181, "post_id": 57491678, "comment_id": 101454833, "body": "What is <code>Count</code> supposed to be counting? Cells? Rows? Columns? Charts? You see the problem - VBA is having to guess and isn&#39;t guessing what you intend..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565778148, "post_id": 57491678, "comment_id": 101455337, "body": "@CindyMeister: Nothing worng with that line. It will never count rows or columns or charts. If you see the declarion it says <code>ByVal Target As Range</code> ;)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565778180, "post_id": 57491678, "comment_id": 101455354, "body": "mega, avoid using <code>.Count</code>. In excel 2007+, better to use <code>.CountLarge</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565778749, "post_id": 57491678, "comment_id": 101455644, "body": "@SiddharthRout Yes, but what is the <code>Range</code>? We can&#39;t know that. In the Help for <code>Range.Count</code> there&#39;s no initimation what the default might be, or under what circumstances what kind of object is counted. All the examples specify the object to be counted."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1565779454, "post_id": 57491678, "comment_id": 101455975, "body": "@CindyMeister: &quot;Target.Count&quot; refers to &quot;Target&#39;s&quot;, <code>Cells.Count</code>. That is default. To count Columns, you would say <code>Target.Columns.Count</code> For cells you do not need to mention it.."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1565790826, "post_id": 57491678, "comment_id": 101462011, "body": "Seconded, the code also works fine for me. I even recreated your scenario (removing 3 columns &amp; updating the code) and it still works fine. Could you please paste a screenshot of your Worksheet and also let us know if the error occurs only when updating some cells, or does it affect any cell in A1:F9999 range?"}], "owner": {"reputation": 1, "user_id": 11926435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3767c9dbd347cc721a8ec0c54167f62?s=128&d=identicon&r=PG&f=1", "display_name": "megapudding", "link": "https://stackoverflow.com/users/11926435/megapudding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565774272, "creation_date": 1565774099, "last_edit_date": 1565774272, "question_id": 57491678, "link": "https://stackoverflow.com/questions/57491678/argument-not-optional-vba-count", "title": "Argument not optional VBA Count", "body": "<p>I have an action tracker spreadsheet with some VBA, whose function is to timestamp whenever I update a row. </p>\n\n<p>I removed three columns from the spreadsheet. Of course, the timestamps were still appearing in column J as before, but I now want them to appear in column G. </p>\n\n<p>When I went to update the code to fix that, I got an \"argument not optional\" error, highlighting the Count.</p>\n\n<p>Below is the code that gets me the error. I updated it to change the range from A1:I9999 to A1:F9999; and I changed the offset from 0, 10 to 0, 7.</p>\n\n<p>Other than that I made no changes to the code, which was working fine before I removed the columns and edited the VBA. Can you help me?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Count = 1 Then\n    If Intersect(Target, Range(\"A1:F9999\")) Is Nothing Then Exit Sub\n    Target.Offset(0, 7 - Target.Column()) = Now()\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565776229, "post_id": 57491605, "comment_id": 101454344, "body": "Why do you have <code>B2</code> in your formula if you are using R1C1 notation?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1565776913, "post_id": 57491605, "comment_id": 101454679, "body": "Which line of code triggers the error? Also, <code>End With</code> needs to be in its own line, not &quot;tacked on&quot; at the end of ` oldbpm = .SelectedItems.Item(1)`."}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1565780921, "post_id": 57491605, "comment_id": 101456699, "body": "I got the error by:  ActiveCell.FormulaR1C1 = _         &quot;=IFERROR(VLOOKUP(B2,&#39;[&quot; &amp; oldbpm &amp; &quot;]&quot; &amp; Sheetstarybpm &amp; &quot;&#39;!R10C2:R7000C101,100,FALSE),0)&quot;  End with was just pasted wrongly. In my code it is ok."}], "owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565775683, "creation_date": 1565773824, "last_edit_date": 1565775683, "question_id": 57491605, "link": "https://stackoverflow.com/questions/57491605/vlookup-with-variables", "title": "Vlookup with variables", "body": "<p>I want to use Vlookup in my vba that searches in another file that is chosen.  The vlookup I copied from recorded macro. I changed the name of Workbook and Worksheets because it is different every time. The range is the same. I got the error 438 \u201cobject doesn't support this property or method\u201d.</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFilePicker)\n        'Makes sure the user can select only one file\n        .AllowMultiSelect = False\n        .Title = \"Select BPM Report for previous month\"\n        .ButtonName = \"OK\"\n        'Filter to just the following types of files to narrow down selection options\n        .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n        'Show the dialog box\n        .Show\n\n        oldbpm = .SelectedItems.Item(1) End With\n     Workbooks.Open oldbpm\n\nDim Sheetstarybpm As Worksheet \nSet Sheetstarybpm = ActiveSheet\n\nDim countrowsoldbpm1 As Long\n    countrowsoldbpm1 = Range(\"a10\", Range(\"a10\").End(xlDown)).Rows.Count\n\nWorkbooks(\"BPM-Tool.xlsm\").Activate Worksheets(\"OU\").Activate\n\nDim countrowsoldbpm As Long\n    countrowsoldbpm = Range(\"a1\", Range(\"a1\").End(xlDown)).Rows.Count\n\n    Range(\"D1:D1823\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP(B2,'[\" &amp; oldbpm &amp; \"]\" &amp; Sheetstarybpm &amp; \"'!R10C2:R7000C101,100,FALSE),0)\"\n    Range(\"D1\").Select\n    Selection.AutoFill Destination:=Range(\"D1:D\" &amp; countrowsoldbpm)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1565774791, "post_id": 57491560, "comment_id": 101453625, "body": "You should tell us which line errors."}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565775054, "post_id": 57491560, "comment_id": 101453760, "body": "Yes, sorry. When the code run the Set PCache...."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565775277, "post_id": 57491560, "comment_id": 101453839, "body": "Note - perhaps a different error, but from the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotcaches.create\" rel=\"nofollow noreferrer\">documentation</a>: When passing a Range object, we recommend that you either use a string to specify the workbook, worksheet, and cell range, or set up a named range and pass the name as a string. Passing a Range object may cause &quot;type mismatch&quot; errors unexpectedly. This is for <code>SourceData</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1565775319, "post_id": 57491560, "comment_id": 101453858, "body": "Have a look at the first section here <a href=\"https://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/9/27/&hellip;</a> I think you need to create the cache and then the table (though not sure as rarely do PTs in VBA)."}], "owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565775677, "creation_date": 1565773679, "last_edit_date": 1565775677, "question_id": 57491560, "link": "https://stackoverflow.com/questions/57491560/excel-pivot-table-error-1004-when-create-the-pivot", "title": "Excel Pivot table error 1004 when create the pivot", "body": "<p>I am trying to create a pivot table, I found some code and I try to change it for my need, I take the error \u201c1004\u201d  Application-defined or Object-defined error when I run the code, can anyone help? </p>\n\n<pre><code> Sub SalesNew()\n Application.ScreenUpdating = False\n Dim BACKORDER, Analysis As Workbook\n Set BACKORDER = Workbooks(\"BACKORDER2019.xlsx\")\n Set Analysis = Workbooks(\"Analysis.xlsx\")\n\n Dim wsBACK As Worksheet\n Set wsBACK = BACKORDER.Worksheets(\"Sheet1\")\n Dim RngBACKstart, RngBACKend, RngBACKnew  As Range\n Set RngBACKstart = wsBACK.Range(\"G4\")\n Set RngBACKend = wsBACK.Cells(wsBACK.Rows.Count, \"G\").End(xlUp)\n Set RngBACKnew = Range(RngBACKstart, RngBACKend)\n\n With RngBACKnew\n .NumberFormat = \"General\"\n .Value = .Value\n End With\n\n  With BACKORDER\n    Sheets.Add(Before:=Worksheets(Worksheets.Count)).Name = \"Pivot\"\n  End With\n\n  Dim PSheet As Worksheet\n  Set PSheet = BACKORDER.Worksheets(\"Pivot\")\n  Dim PCache As PivotCache\n  Dim PTable As PivotTable\n  Dim PRange As Range\n  Dim FirstRow As Range\n  Dim LastCol As Range\n\n  Set FirstCell = wsBACK.Range(\"A3\")\n  Set LastCell = wsBACK.Cells(wsBACK.Rows.Count, \"H\").End(xlUp)\n  Set PRange = Range(FirstCell, LastCell)\n\n   Set PCache = ActiveWorkbook.PivotCaches.Create _\n  (SourceType:=xlDatabase, SourceData:=PRange). _\n   CreatePivotTable(TableDestination:=PSheet.Cells(1, 1), _\n   TableName:=\"SalesPivotTable\")\n\n\n    Application.ScreenUpdating = False\n\n     End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1565774765, "post_id": 57491467, "comment_id": 101453613, "body": "Can you execute the Copy&amp;Paste manually? Is there anything special in those cells? Protection? We can only guess..."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1565774963, "post_id": 57491467, "comment_id": 101453715, "body": "One warning: If the  <code>Set TargetWorksheet</code>-command fails, <code>TargetWorksheet</code> will still point to the previous sheet (and your code will continue to Copy and Paste data)"}], "owner": {"reputation": 13, "user_id": 4453619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38dfff6d627535d968a55386bd3c952?s=128&d=identicon&r=PG&f=1", "display_name": "wrybel", "link": "https://stackoverflow.com/users/4453619/wrybel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580307537, "creation_date": 1565773369, "last_edit_date": 1580307537, "question_id": 57491467, "link": "https://stackoverflow.com/questions/57491467/run-time-error-1004-when-copy-pasting-for-defined-cells", "title": "\u201cRun-time error &#39;1004\u201d when copy-pasting for defined cells", "body": "<p>I have a macro for copy and pasting cells between workbooks. On the line <code>SouceWorksheet.Range(\"B72:B94\").Copy TargetWorksheet.Range(\"B72:B94\")</code>, I get Run-time error 1004. In this range cells are not merged. When I change a range on B95 and paste to B95 everything is OK.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For Each SouceWorksheet In oWB.Worksheets\n        On Error Resume Next\n        Set TargetWorksheet = ThisWorkbook.Worksheets(SouceWorksheet.Name)\n        On Error GoTo 0\n\n        If TargetWorksheet.Name &lt;&gt; \"aaa\" Or TargetWorksheet.Name &lt;&gt; \"x\" And TargetWorksheet.Name &lt;&gt; \"y\" And TargetWorksheet.Name &lt;&gt; \"z\" Then\n\n\n        SouceWorksheet.Range(\"C7\").Copy TargetWorksheet.Range(\"C7\")\n        SouceWorksheet.Range(\"H8\").Copy TargetWorksheet.Range(\"H8\")\n\n        TargetWorksheet.Range(\"C9\").UnMerge\n        SouceWorksheet.Range(\"C9\").Copy TargetWorksheet.Range(\"C9\")\n        TargetWorksheet.Range(\"C9:D9\").Merge\n        Application.DisplayAlerts = False\n\n        TargetWorksheet.Range(\"C10\").UnMerge\n        SouceWorksheet.Range(\"C10\").Copy TargetWorksheet.Range(\"C10\")\n        TargetWorksheet.Range(\"C10:D10\").Merge\n        Application.DisplayAlerts = False\n\n        SouceWorksheet.Range(\"L10:M10\").Copy TargetWorksheet.Range(\"L10:M10\")\n\n            If SouceWorksheet.Range(\"C12\") = \"V1\" Then\n                SouceWorksheet.Range(\"C12\").Copy TargetWorksheet.Range(\"C12\")\n                SouceWorksheet.Range(\"C14\").Copy TargetWorksheet.Range(\"C14\")\n                SouceWorksheet.Range(\"F14:F15\").Copy TargetWorksheet.Range(\"F14:F15\")\n            Else\n                SouceWorksheet.Range(\"C12\").Copy TargetWorksheet.Range(\"C12\")\n                SouceWorksheet.Range(\"F18:F20\").Copy TargetWorksheet.Range(\"F18:F20\")\n            End If\n\n        SouceWorksheet.Range(\"L14:L15\").Copy TargetWorksheet.Range(\"L14:L15\")\n\n        SouceWorksheet.Range(\"C24:C26\").Copy TargetWorksheet.Range(\"C24:C26\")\n\n        SouceWorksheet.Range(\"C28:D29\").Copy TargetWorksheet.Range(\"C28:D29\")\n\n        SouceWorksheet.Range(\"C34:E36\").Copy TargetWorksheet.Range(\"C34:E36\")\n\n        SouceWorksheet.Range(\"C40:E42\").Copy TargetWorksheet.Range(\"C40:E42\")\n\n        SouceWorksheet.Range(\"C45:C46\").Copy TargetWorksheet.Range(\"C45:C46\")\n\n        SouceWorksheet.Range(\"C49\").Copy TargetWorksheet.Range(\"C49\")\n\n        SouceWorksheet.Range(\"F45:G49\").Copy TargetWorksheet.Range(\"F45:G49\")\n\n        SouceWorksheet.Range(\"H45:I49\").Copy TargetWorksheet.Range(\"H45:I49\")\n\n        SouceWorksheet.Range(\"C53:C54\").Copy TargetWorksheet.Range(\"C53:C54\")\n\n        TargetWorksheet.Range(\"C65\").UnMerge\n        SouceWorksheet.Range(\"C65\").Copy TargetWorksheet.Range(\"C65\")\n        TargetWorksheet.Range(\"C65:D66\").Merge\n        Application.DisplayAlerts = False\n\n        SouceWorksheet.Range(\"B72:B94\").Copy TargetWorksheet.Range(\"B72:B94\")\n\n        SouceWorksheet.Range(\"J72:J94\").Copy TargetWorksheet.Range(\"J72:J94\")\n\n\n        End If\n    Next\n\n        For Each ws In ThisWorkbook.Worksheets\n        ws.Calculate\n        Next ws\n\n    oWB.Close False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565773640, "post_id": 57491187, "comment_id": 101453031, "body": "The event doesn&#39;t fire when in design mode. Does the sheet still have to be visible?"}, {"owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565782500, "post_id": 57491187, "comment_id": 101457471, "body": "Nope, but I prefer to have it visible"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565798554, "post_id": 57491187, "comment_id": 101466226, "body": "As a note, a user could also easily circumvent this by turning events off: <code>Application.EnableEvents = False</code> in the immediate window. Excel doesn&#39;t really have &quot;foolproof&quot; security. Just a thought."}], "owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565775645, "creation_date": 1565772318, "last_edit_date": 1565775645, "question_id": 57491187, "link": "https://stackoverflow.com/questions/57491187/when-i-turn-on-design-mode-i-do-not-need-to-type-the-password-for-the-specifi", "title": "When I turn on &quot;design mode&quot;, I do not need to type the password for the specific worksheet. How can I modify this code to solve this problem?", "body": "<p>I need to password protect a worksheet named \"Import\". It is important that the content is hidden. I have used the code below, and it works fine. The only problem is that when I stand in another sheet and turn on design mode, I am no longer required to type in the password (ex: Test123). </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nRange(\"A65536\").Select\n'change the password here (ABC)\nIf InputBox(\"What is the password?\", \"Password\") = \"Test123\" Then\nRange(\"A1\").Select\nElse\nMsgBox (\"Password incorrect\")\nSheets(\"Dashboard\").Select\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "edited": false, "score": 0, "creation_date": 1565799888, "post_id": 57490721, "comment_id": 101466853, "body": "Thanks for your answer. The problem with this is I need it to happen only if there is a change in the cell. I failed to mention that the cell is a dropdown list and if they select &quot;Multiple Choice - Multiple Answer&quot; in that cell, I want the code to run. The only problem with my code is if someone deletes a group of cells anywhere in the sheet it will throw the error. And I want them to be able to delete cells."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1565770322, "creation_date": 1565770322, "answer_id": 57490721, "question_id": 57490549, "link": "https://stackoverflow.com/questions/57490549/if-statement-to-check-if-user-is-deleting-cells/57490721#57490721", "title": "If statement to check if user is deleting cells", "body": "<p><strong>Try the <code>SelectionChange</code> Event like this:</strong></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim cel As Range\n\n    For Each cel In Target\n    If cel.Value = \"Multiple Choice - Multiple Answer\" Then\n        MsgBox \"You selected MC-MA\"\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<ul>\n<li>In <code>Change</code> event even if you try and check cells one by one, you won't spot the cell with that match because <strong><em>the code runs after the delete has been executed</em></strong>. So by the time it comes to the If statement, the cell is already blank.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "is_accepted": false, "score": 0, "last_activity_date": 1565800405, "creation_date": 1565800405, "answer_id": 57498721, "question_id": 57490549, "link": "https://stackoverflow.com/questions/57490549/if-statement-to-check-if-user-is-deleting-cells/57498721#57498721", "title": "If statement to check if user is deleting cells", "body": "<p>I figured out a way around it. If I just do an If statement that checks <code>if Target.Count = 1</code> then run the code it works! </p>\n"}], "owner": {"reputation": 99, "user_id": 10914715, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218496357669287/picture?type=large", "display_name": "Jake West", "link": "https://stackoverflow.com/users/10914715/jake-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565800405, "creation_date": 1565769682, "question_id": 57490549, "link": "https://stackoverflow.com/questions/57490549/if-statement-to-check-if-user-is-deleting-cells", "title": "If statement to check if user is deleting cells", "body": "<p>I am new to vba and I am running into a <code>Type mismatch</code> error when I delete multiple cells in my workbook, and it is failing at the <code>If</code> statement here:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Value = \"Multiple Choice - Multiple Answer\" Then\n        MsgBox \"You selected MC-MA\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><b>I am wondering if there's a way to check if a user is deleting contents of a cell and NOT run this if statement if that is the case?</b></p>\n\n<p>I have tried <code>If Trim(Target.Value) &lt;&gt; Empty</code> but it throws the error I'm guessing because Im trying to run an If statement on a value that doesn't exist.</p>\n\n<p>I expect <code>If Trim(Target.Value) &lt;&gt; Empty</code> to make it skip the above code but it throws the <code>Type mismatch</code> error.</p>\n"}, {"tags": ["vba", "ms-word", "savefiledialog"], "comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565771966, "post_id": 57490454, "comment_id": 101452228, "body": "Have you tried setting each &quot;child&quot; as an object variable in the &quot;parent&quot;?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565779097, "post_id": 57490454, "comment_id": 101455810, "body": "I don&#39;t understand what you mean by &quot;children&quot; and &quot;parent&quot; files. Do you mean the content of the &quot;parent&quot; file has been copied to and saved to two other (&quot;children&quot;) files and you want changes made to these two files to be reflected automatically in the &quot;parent&quot; file?"}, {"owner": {"reputation": 7, "user_id": 11900966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b301251fd8b0b9ff55359e0ffcc2b90?s=128&d=identicon&r=PG&f=1", "display_name": "J.Deno", "link": "https://stackoverflow.com/users/11900966/j-deno"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1565796173, "post_id": 57490454, "comment_id": 101465023, "body": "@Cindy Meister sorry, I didn&#39;t express my question well, but I accidentally solved my problem for some reason. I post my solving method in the Answer block."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 11900966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b301251fd8b0b9ff55359e0ffcc2b90?s=128&d=identicon&r=PG&f=1", "display_name": "J.Deno", "link": "https://stackoverflow.com/users/11900966/j-deno"}, "is_accepted": true, "score": 0, "last_activity_date": 1565796365, "creation_date": 1565796365, "answer_id": 57497726, "question_id": 57490454, "link": "https://stackoverflow.com/questions/57490454/is-it-possible-to-use-the-filename-generated-by-previous-code-as-the-variable-fo/57497726#57497726", "title": "Is it possible to use the filename generated by previous code as the variable for next line of code?", "body": "<p>I accidentally get the solution as follows. </p>\n\n<pre><code> Sub chinesenufi()\n    '\n    ' chinesenufi Macro\n    '\n    '\n        Selection.WholeStory\n        Selection.Copy\n\n        Dim oSection As Section\n        Dim r As Range\n        Dim TempDoc As Document\n        Dim FirstPara As String\n\n        For Each oSection In ActiveDocument.Sections\n        Set r = oSection.Range\n        r.End = r.End - 1\n        Set TempDoc = Documents.Add\n        With TempDoc\n        .Range = r\n        Selection.PasteAndFormat (wdFormatOriginalFormatting)\n        Selection.HomeKey Unit:=wdStory\n        Selection.EndKey Unit:=wdLine\n        Selection.EndKey Unit:=wdStory, Extend:=wdExtend\n        Selection.Delete Unit:=wdCharacter, Count:=1\n        FirstPara = r.Paragraphs(1).Range.text\n        FirstPara = Left(FirstPara, Len(FirstPara) - 1)\n        .SaveAs FileName:=FirstPara &amp; \"\u4e2d\u6587\u6a94\" &amp; \".doc\"\n        End With\n        Set r = Nothing\n        Set TempDoc = Nothing\n        Next\n\n        Dim objDoc1 As Word.Document\n        Dim objDoc2 As Word.Document\n\n        Set objDoc1 = Documents(FirstPara &amp; \".doc\")\n        Set objDoc2 = Documents(FirstPara &amp; \"\u4e2d\u6587\u6a94\" &amp; \".doc\")\n        objDoc1.Activate\n        objDoc1.Windows.CompareSideBySideWith objDoc2\n        Windows.ResetPositionsSideBySide\n\n\n    End Sub\n</code></pre>\n\n<p>It seems that @ProfoundlyOblivious 's opinion that \"setting each \"child\" as an object variable in the \"parent\" \" works.</p>\n"}], "owner": {"reputation": 7, "user_id": 11900966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b301251fd8b0b9ff55359e0ffcc2b90?s=128&d=identicon&r=PG&f=1", "display_name": "J.Deno", "link": "https://stackoverflow.com/users/11900966/j-deno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57497726, "answer_count": 1, "score": 0, "last_activity_date": 1565796365, "creation_date": 1565769383, "last_edit_date": 1565769805, "question_id": 57490454, "link": "https://stackoverflow.com/questions/57490454/is-it-possible-to-use-the-filename-generated-by-previous-code-as-the-variable-fo", "title": "Is it possible to use the filename generated by previous code as the variable for next line of code?", "body": "<p>I have used vb to create two files that their names are based on the first line of each of their content. Now,  I want the two windows to be arranged vertically and thus use the \"Windows.CompareSideBySideWith\". But here is the problem---because of the two new files are \"children\" files of a \"parent\" file, and I want whenever the \"parent\" file change, the \"Children\" filename that \"Windows.CompareSideBySideWith\" call can change too.</p>\n\n<p>Here are VBs code of Windows.CompareSideBySideWith</p>\n\n<pre><code>Sub Macro5()\n'\n' Macro5 Macro\n'\n'\n    Windows.CompareSideBySideWith _\n        \"Asbestos Exposures during Reprocessing of Automobile Brakes and Clutches\"\nEnd Sub\n</code></pre>\n\n<p>and the vb of two children file:\nfirst</p>\n\n<pre><code>Sub savedoc()\n'\n' savedoc Macro\n'\n'\n\nDim oSection As Section\nDim r As Range\nDim TempDoc As Document\nDim FirstPara As String\n\nFor Each oSection In ActiveDocument.Sections\n    Set r = oSection.Range\n    r.End = r.End - 1\n    Set TempDoc = ActiveDocument\n    With TempDoc\n        .Range = r\n        FirstPara = r.Paragraphs(1).Range.text\n        FirstPara = Left(FirstPara, Len(FirstPara) - 1)\n        .SaveAs FileName:=FirstPara &amp; \".doc\"\n    End With\n    Set r = Nothing\n    Set TempDoc = Nothing\nNext\n\nEnd Sub\n</code></pre>\n\n<p>the second one</p>\n\n<pre><code>Sub chinesenufi()\n'\n' chinesenufi Macro\n'\n'\nSelection.WholeStory\nSelection.Copy\n\nDim oSection As Section\nDim r As Range\nDim TempDoc As Document\nDim FirstPara As String\n\nFor Each oSection In ActiveDocument.Sections\n    Set r = oSection.Range\n    r.End = r.End - 1\n    Set TempDoc = Documents.Add\n    With TempDoc\n        .Range = r\n        Selection.PasteAndFormat (wdFormatOriginalFormatting)\n        Selection.HomeKey Unit:=wdStory\n        Selection.EndKey Unit:=wdLine\n        Selection.EndKey Unit:=wdStory, Extend:=wdExtend\n        Selection.Delete Unit:=wdCharacter, Count:=1\n        FirstPara = r.Paragraphs(1).Range.text\n        FirstPara = Left(FirstPara, Len(FirstPara) - 1)\n        .SaveAs FileName:=FirstPara &amp; \"chinese\" &amp; \".doc\"\n    End With\n    Set r = Nothing\n    Set TempDoc = Nothing\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I would like the \" Asbestos Exposures during Reprocessing of Automobile Brakes and Clutches\" be able to change as any of the two \"children\" filename change\nThanks in advance :)</p>\n"}, {"tags": ["vba", "colors", "powerpoint"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565769124, "post_id": 57490317, "comment_id": 101450861, "body": "<code>wdWhite</code> will only work if you include a reference to the Microsoft Word Object Library. I think you&#39;re looking in the wrong place as far as documentation goes. Also, all your <code>DataLabels</code> are spelled wrong."}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565769320, "post_id": 57490317, "comment_id": 101450947, "body": "Ah okay, I will check that out. As for the spelling mistake I just retyped the code so that is where that comes from. But I edited my question, thanks for the quick answer :)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565769459, "post_id": 57490317, "comment_id": 101451006, "body": "Do you copy charts from Excel into PowerPoint, or create the charts directly in PowerPoint?"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565769608, "post_id": 57490317, "comment_id": 101451072, "body": "Neither, I have an existing Chart in a PowerPoint which I modify (I change some values and according to the values other properties)."}], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1565770856, "post_id": 57490757, "comment_id": 101451708, "body": "Fun Fact I only tried <code>objChart.SeriesCollection(1).DataLabels(2).Font.Color.RGB = RGB(0,0,0)</code> before which did not work, but without the <code>.RGB</code> it works.... ugh.. any idea why here <code>.Color</code> does not have the method <code>.RGB</code>?"}, {"owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 0, "creation_date": 1565771014, "post_id": 57490757, "comment_id": 101451774, "body": "Thanks for the help, sometimes you just don&#39;t see the trees in a forest hahaha. Ugh that just cost me two hours D:"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "edited": false, "score": 1, "creation_date": 1565771224, "post_id": 57490757, "comment_id": 101451882, "body": "No problem, glad to help out. I think <code>Color</code> takes a <code>Long</code> value, which is what <code>RGB</code> returns. If you put <code>? vbRed</code> or <code>? vbBlack</code> in the Immediate Window, you&#39;ll see the return result is equal to their RGB value - 255 and 0 respectively."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1565770456, "creation_date": 1565770456, "answer_id": 57490757, "question_id": 57490317, "link": "https://stackoverflow.com/questions/57490317/changing-the-colorindex-of-a-datalabel-is-not-behaving-as-stated-by-the-document/57490757#57490757", "title": "Changing the ColorIndex of a DataLabel is not behaving as stated by the documentation", "body": "<p>1) I think you want <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.font.color\" rel=\"nofollow noreferrer\"><code>Font.Color</code></a> instead of <code>ColorIndex</code>.</p>\n\n<p>2) You can use the named <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/color-constants\" rel=\"nofollow noreferrer\">color constants</a>, e.g. <code>vbRed</code>, <code>vbBlack</code>, etc.</p>\n\n<pre><code>objChart.SeriesCollection(1).DataLabels(2).Font.Color = vbWhite\n</code></pre>\n\n<p>Or you can use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/rgb-function\" rel=\"nofollow noreferrer\"><code>RGB</code></a> for other colors as needed:</p>\n\n<pre><code>objChart.SeriesCollection(1).DataLabels(2).Font.Color = RGB(100, 50, 0)\n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 8084805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbabd4de54e1d4fec4babb756da48817?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/8084805/nils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 57490757, "answer_count": 1, "score": 0, "last_activity_date": 1565770456, "creation_date": 1565768898, "last_edit_date": 1565769194, "question_id": 57490317, "link": "https://stackoverflow.com/questions/57490317/changing-the-colorindex-of-a-datalabel-is-not-behaving-as-stated-by-the-document", "title": "Changing the ColorIndex of a DataLabel is not behaving as stated by the documentation", "body": "<p>I am trying to change the color of a DataLabel, however so far I was only able to change the color to red or black.</p>\n\n<p>I've tried to set the ColorIndex to the \"Values\" as well as \"Names\" according to the documentation:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdcolorindex\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/word.wdcolorindex</a></p>\n\n<pre><code>dim objChart as PowerPoint.Chart\n\nobjChart.SeriesCollection(1).DataLabels(2).Font.ColorIndex = 0\n</code></pre>\n\n<p>This code will change my DataLabel to Black, so far so good. Hoewever:</p>\n\n<pre><code>objChart.SeriesCollection(1).DataLabels(2).Font.ColorIndex = 8\n</code></pre>\n\n<p>will change the color to red, just as most of the other numbers (I have not tried all of them). Even better:</p>\n\n<pre><code>objChart.SeriesCollection(1).DataLabels(2).Font.ColorIndex = wdWhite\n</code></pre>\n\n<p>will throw an Error that <code>wdWhite</code> is not defined, while it is executed in debugging mode. If printing in the immediate window <code>? wdWhite</code> it is Empty, which explains the Error as I use <code>Option Explicit</code>. However I am quite confused that it is not defined.</p>\n\n<p>Also if I let </p>\n\n<pre><code>objChart.SeriesCollection(1).DataLabels(2).Font.ColorIndex = 0\n</code></pre>\n\n<p>and then print it in the immediate window it will return -1.\nSo I am kind of confused what is going on. So far I have not worked with <code>ColorIndex</code> but only with <code>Color.RGB</code> so I am not sure if or what I am doing wrong. </p>\n\n<p>Do I maybe have to include a specifiy library? \nAlso maybe as additional information I am coding a macro in Excel that populates charts in a PowerPoint.</p>\n\n<p>Any help is appreciated. Thanks in advance :)</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565774938, "post_id": 57491518, "comment_id": 101453706, "body": "I&#39;ve got it to open the right calendar but still can&#39;t get it to make the appointment in it, it just goes into my default calendar?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565775065, "post_id": 57491518, "comment_id": 101453768, "body": "What code do you have now? Did you try to use the sample code?"}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565775251, "post_id": 57491518, "comment_id": 101453829, "body": "Updated in original post"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565775957, "post_id": 57491518, "comment_id": 101454183, "body": "I don&#39;t see where you create a new appointment in the shared folder."}, {"owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "edited": false, "score": 0, "creation_date": 1565776800, "post_id": 57491518, "comment_id": 101454638, "body": "I can&#39;t work out how to do so, I can only seem to get it in the default calendar"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1565777492, "last_edit_date": 1565777492, "creation_date": 1565773546, "answer_id": 57491518, "question_id": 57490188, "link": "https://stackoverflow.com/questions/57490188/create-outlook-appointment-in-shared-calendar/57491518#57491518", "title": "Create Outlook appointment in shared calendar", "body": "<p>You can get the shared calendar by using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.namespace.getshareddefaultfolder\" rel=\"nofollow noreferrer\">NameSpace.GetSharedDefaultFolder</a> method which returns a <code>Folder</code> object that represents the specified default folder for the specified user. For example:</p>\n\n<pre><code>Sub ResolveName()\n    Dim myOlApp As Outlook.Application\n    Dim myNamespace As Outlook.NameSpace\n    Dim myRecipient As Outlook.Recipient\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myNamespace = myOlApp.GetNamespace(\"MAPI\")\n    Set myRecipient = myNamespace.CreateRecipient(\"Eugene Astafiev\")\n    myRecipient.Resolve\n    If myRecipient.Resolved Then\n        Call ShowCalendar(myNamespace, myRecipient)\n    End If\nEnd Sub\n\nSub ShowCalendar(myNamespace, myRecipient)\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set CalendarFolder = myNamespace.GetSharedDefaultFolder(myRecipient, olFolderCalendar)\n    CalendarFolder.Display\nEnd Sub\n</code></pre>\n\n<p>When you get a shared calendar folder you may use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.add\" rel=\"nofollow noreferrer\">Items.Add</a> method which creates a new Outlook item in the <code>Items</code> collection for the folder. You just need to pass an item type you need to create, for example, <code>olAppointmentItem</code>. </p>\n\n<pre><code>Set myItem = mySharedCalendarFolder.Items.Add olAppointmentItem\n</code></pre>\n\n<p>So, your code should look like this:</p>\n\n<pre><code>    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Licences\")\n\n    Dim myOlApp As Outlook.Application\n    Dim myNamespace As Outlook.Namespace\n    Dim myRecipient As Outlook.Recipient\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Dim olAppItem as Outlook.AppointmentItem\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myNamespace = myOlApp.GetNamespace(\"MAPI\")\n    Set myRecipient = myNamespace.CreateRecipient(\"DTS Streetworks\")\n    myRecipient.Resolve\n\n    If myRecipient.Resolved Then\n        Set CalendarFolder = myNamespace.GetSharedDefaultFolder(myRecipient, olFolderCalendar)\n        r = Cells(Rows.Count, 1).End(xlUp).Row\n        For i = 5 To r\n           With Cells(i, 5)\n             If .Value = \"Mobile Plant\" And Cells(i, 6) &lt;&gt; \"\" Then\n                Set olAppItem = CalendarFolder.Items.Add olAppointmentItem\n                With olAppItem \n                    .Subject = \"Test \" + ES.Cells(i, 4).Value\n                    .Start = ES.Cells(i, 14) + ES.Cells(i, 15).Value\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = ES.Cells(i, 5).Value\n                    .Save\n                End With\n             End If\n         End With\n       Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565777492, "creation_date": 1565768455, "last_edit_date": 1565775231, "question_id": 57490188, "link": "https://stackoverflow.com/questions/57490188/create-outlook-appointment-in-shared-calendar", "title": "Create Outlook appointment in shared calendar", "body": "<p>I have the following code set up to create appointments in Outlook from data on my Excel spreadsheet. What I would like to do id make the appointment in a shared calendar rather than my own default one.</p>\n\n<p>The calendar I want to add it to is the DTS Streetworks one as shown here - <a href=\"https://ibb.co/tKXKSPX\" rel=\"nofollow noreferrer\">https://ibb.co/tKXKSPX</a>, but I have no idea how to go about it.</p>\n\n<pre><code>Sub CoringAdd()\n\n    Dim OL As Outlook.Application, ES As Worksheet, _\n    r As Long, i As Long, wb As ThisWorkbook\n\n    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Coring\")\n    Set OL = New Outlook.Application\n\n    r = ES.Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 2 To r\n        With ES.Cells(i, 10)\n            If .Value = \"No\" And ES.Cells(i, 7) &lt;&gt; \"Yes\" Then\n                ES.Cells(i, 7) = \"Yes\"\n                With OL.CreateItem(olAppointmentItem)\n                    .Subject = \"Send reminder email - LBRuT \" + ES.Cells(i, 2).Value\n                    .Start = ES.Cells(i, 6) + 1 + ES.Cells(i, 8).Value\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = \"\u00a3\" &amp; ES.Cells(i, 5).Value\n                    .Save\n                End With\n            End If\n        End With\n    Next i\n\n    Set OL = Nothing\n    Set wb = Nothing\n    Set ES = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Latest code below, still goes to default calendar.</p>\n\n<pre><code>Sub ResolveName()\n\nDim OL As Outlook.Application, ES As Worksheet, _\n    r As Long, i As Long, wb As ThisWorkbook\n\n    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Licences\")\n    Set OL = New Outlook.Application\n    Dim myOlApp As Outlook.Application\n    Dim myNamespace As Outlook.Namespace\n    Dim myRecipient As Outlook.Recipient\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myNamespace = myOlApp.GetNamespace(\"MAPI\")\n    Set myRecipient = myNamespace.CreateRecipient(\"DTS Streetworks\")\n    myRecipient.Resolve\n\n\n    r = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 5 To r\n        With Cells(i, 5)\n\n         If myRecipient.Resolved And .Value = \"Mobile Plant\" And Cells(i, 6) &lt;&gt; \"\" Then\n    With OL.CreateItem(olAppointmentItem)\n                    .Subject = \"Test \" + ES.Cells(i, 4).Value\n                    .Start = ES.Cells(i, 14) + ES.Cells(i, 15).Value\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = ES.Cells(i, 5).Value\n                    .Save\n    End With\n    End If\n    End With\n    Next i\nEnd Sub\n\nSub ShowCalendar(myNamespace, myRecipient)\n    Dim CalendarFolder As Outlook.MAPIFolder\n    Set CalendarFolder = myNamespace.GetSharedDefaultFolder(myRecipient, olFolderCalendar)\n    CalendarFolder.Display\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1565768633, "post_id": 57490163, "comment_id": 101450622, "body": "the issue is that your formula is not a valid formula - specifically the OR bit"}, {"owner": {"reputation": 91, "user_id": 11926049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c056c39609e7e9cfaf974158a77d07?s=128&d=identicon&r=PG&f=1", "display_name": "isaaacs", "link": "https://stackoverflow.com/users/11926049/isaaacs"}, "reply_to_user": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1565769041, "post_id": 57490163, "comment_id": 101450815, "body": "Thank you perfect, it was the bracket after the OR that was the problem"}], "answers": [{"comments": [{"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1565769329, "post_id": 57490347, "comment_id": 101450953, "body": "BZ2=&quot;&quot;0&quot;&quot; maybe that needs to be BZ2=0 as it will be an integer not a string"}, {"owner": {"reputation": 91, "user_id": 11926049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c056c39609e7e9cfaf974158a77d07?s=128&d=identicon&r=PG&f=1", "display_name": "isaaacs", "link": "https://stackoverflow.com/users/11926049/isaaacs"}, "edited": false, "score": 0, "creation_date": 1565769560, "post_id": 57490347, "comment_id": 101451050, "body": "Thank you, I moved the bracket after the OR to before the OR and corrected the BZ2=0 and it works perfectly now"}], "tags": [], "owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "is_accepted": true, "score": 0, "last_activity_date": 1565769408, "last_edit_date": 1565769408, "creation_date": 1565769013, "answer_id": 57490347, "question_id": 57490163, "link": "https://stackoverflow.com/questions/57490163/application-defined-error-when-adding-a-formula-to-a-cell-in-vba/57490347#57490347", "title": "Application-defined error when adding a formula to a cell in VBA", "body": "<p>I think the issue is that the formula you supplied is not valid. There are too many brackets in the OR part.</p>\n\n<p>try this instead</p>\n\n<pre><code>Sub AddFormula()\nDim Formula As Variant\n With ThisWorkbook.Worksheets(\"Form Responses 1\")\n.Range(\"CE2\").Formula = \"=IFERROR(IF(OR(BZ2=\"\"No\"\", BZ2=\"\"0\"\"), BZ2, AN2), AN2)\"\n\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 11926049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c056c39609e7e9cfaf974158a77d07?s=128&d=identicon&r=PG&f=1", "display_name": "isaaacs", "link": "https://stackoverflow.com/users/11926049/isaaacs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57490347, "answer_count": 1, "score": 0, "last_activity_date": 1565769408, "creation_date": 1565768334, "last_edit_date": 1565768672, "question_id": 57490163, "link": "https://stackoverflow.com/questions/57490163/application-defined-error-when-adding-a-formula-to-a-cell-in-vba", "title": "Application-defined error when adding a formula to a cell in VBA", "body": "<p>I am trying to add an IF formula to a cell in excel using a macro and it is displaying a 1004 application-defined or object-defined error for the .Range line. How can I prevent this error?</p>\n\n<pre><code>Sub AddFormula()\nDim Formula As Variant\n With ThisWorkbook.Worksheets(\"Form Responses 1\")\n    .Range(\"CE2\").Formula = \"=IFERROR(IF(OR((BZ2=\"\"No\"\", BZ2=\"\"0\"\")), BZ2, AN2), AN2)\"\n\n End With\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "zip"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565949648, "post_id": 57490063, "comment_id": 101511801, "body": "Do you wan to remove the folder &quot;first&quot; or the &quot;Second&quot;?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565951560, "post_id": 57490063, "comment_id": 101512636, "body": "I want to remove Folder <code>Second</code> from First.  <a href=\"https://drive.google.com/open?id=11Mjs3uCjvAzrbiBHNaBSAm5pI7BQFSJA\" rel=\"nofollow noreferrer\">Sample Zip File</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565954850, "post_id": 57490063, "comment_id": 101514067, "body": "<a href=\"https://stackoverflow.com/questions/42627865/vbs-delete-folder-from-zipped-folder\" title=\"vbs delete folder from zipped folder\">stackoverflow.com/questions/42627865/&hellip;</a>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1565956992, "post_id": 57490063, "comment_id": 101515019, "body": "@SiddharthRout .. It says it can&#39;t be done without 3rd Party App. Unfortunately that&#39;s not an option."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1566005644, "post_id": 57490063, "comment_id": 101531018, "body": "@SMeaden ...How to delete the folder ? Files can be deleted and the way to do that is in the Link In the Question."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1566049052, "post_id": 57490063, "comment_id": 101538066, "body": "@mikku stop removing the Excel VBA tag. It bumps all the questions to the top."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1566049247, "post_id": 57490063, "comment_id": 101538090, "body": "Ohh .. Okay @Andreas .. i though anyway they have to be removed."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1566049316, "post_id": 57490063, "comment_id": 101538105, "body": "That will be done automatic when/if it happens. The heta thread says it&#39;s a two month thing, a year ago...."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1566049364, "post_id": 57490063, "comment_id": 101538113, "body": "Yeah .. I thought I can so some of them.. Anyways, i will stop it it&#39;s creating a Problem. :) @Andreas"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1566161203, "post_id": 57490063, "comment_id": 101559573, "body": "@Mikku It can be done without 3rd party tools. Just not without unpacking and rebuilding the archive."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1566204318, "post_id": 57490063, "comment_id": 101568602, "body": "@AnsgarWiechers ... But as you can see in the Below answer by TinMan, and it is able to delete the Folder with one command line, only thing to figure out is how to suppress the Windows Warning that pops up when you try and delete the folder."}], "answers": [{"comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566097043, "post_id": 57537793, "comment_id": 101546739, "body": "Impressive @TinMan, I added a bit of explanation on what <code>.Self.Verbs.Item(4)</code> means."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566097097, "post_id": 57537793, "comment_id": 101546745, "body": "Still looking how to suppress that warning. :(. Or maybe pass on a Yes."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566097151, "post_id": 57537793, "comment_id": 101546754, "body": "@SiddharthRout ... Your answer was Informative. Shouldn&#39;t have deleted it :)"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566098855, "post_id": 57537793, "comment_id": 101546912, "body": "@SiddharthRout I was rushing to finish on break.  I&#39;ll try to put together a better post soon.  Thanks"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566118689, "post_id": 57537793, "comment_id": 101549550, "body": "@SiddharthRout I ended up using your suggestion to solve the problem.  Thanks"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566182996, "post_id": 57537793, "comment_id": 101562581, "body": "@TinMan .... Would you like to ask a new question on how to surpass the warning ? Or should i do it ?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566183433, "post_id": 57537793, "comment_id": 101562652, "body": "@Mikku <code>DeleteZipSubDirectory</code> does not show a warning.  I&#39;m guessing that you would have to modify the registry to suppress it using the verb high may require admin rights on certain systems with tight security."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1566204186, "post_id": 57537793, "comment_id": 101568530, "body": "@TinMan .. Yes I understand that. But honestly I wasn&#39;t looking for this Method. I was looking for something direct like <code>.Self.Verbs.Item(4)</code>. So i think it&#39;s worth trying to find an answer on how to suppress Windows Warning."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566377935, "post_id": 57537793, "comment_id": 101633385, "body": "I am not convinced that the Delete verb will always be the fifth item in the collection."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566381863, "post_id": 57537793, "comment_id": 101635810, "body": "@GSerg I edited my post adding <code>InVokeVerb(&quot;Delete&quot;)</code> as the better method to delete the folder."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566384938, "post_id": 57537793, "comment_id": 101637443, "body": "@TinMan Interestingly, <code>InvokeVerb</code> <a href=\"https://docs.microsoft.com/en-us/windows/win32/shell/folderitem-invokeverb#parameters\" rel=\"nofollow noreferrer\">is documented to accept the verb&#39;s <code>Name</code></a> as returned by <a href=\"https://docs.microsoft.com/en-us/windows/win32/shell/folderitemverb-name\" rel=\"nofollow noreferrer\"><code>FolderItemVerb.Name</code></a>. <code>FolderItemVerb.Name</code> is localized. In reality, <code>InvokeVerb</code> responds to the non-localized name, and does not respond to the localized name."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566384942, "post_id": 57537793, "comment_id": 101637446, "body": "@GSerg Then there is no convincing you...lol.   The localization is a great point.  It leads me to believe that using the index would be better."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 8, "last_activity_date": 1566381679, "last_edit_date": 1566381679, "creation_date": 1566057308, "answer_id": 57537793, "question_id": 57490063, "link": "https://stackoverflow.com/questions/57490063/deleting-a-folder-from-a-zip-file/57537793#57537793", "title": "Deleting a Folder from a Zip file", "body": "<p>I was able to delete the folder.</p>\n\n<blockquote>\n<pre><code>CreateObject(\"Shell.Application\").Namespace(\"C:\\Users\\mohit.bansal\\Desktop\\Test\\test\\first.zip\\first\\second\").Self.Verbs.Item(4).DoIt\n</code></pre>\n</blockquote>\n\n<p>As GSerb pointed out it may be better to use <code>InvokeVerb)\"Delete\"</code> to delete the folder.</p>\n\n<blockquote>\n<pre><code> CreateObject(\"Shell.Application\").Namespace(\"C:\\Users\\mohit.bansal\\Desktop\\Test\\test\\first.zip\\first\\second\").Self.InvokeVerb (\"Delete\")\n</code></pre>\n</blockquote>\n\n<p>I have not been able to suppress the file deletion conformation dialog.\n<a href=\"https://i.stack.imgur.com/uYWtf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uYWtf.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>So using <code>.Self.Verbs.Item(4)</code> we can access the Right Click Options starting with 0.</p>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/gszl9.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gszl9.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>Addendum</h2>\n\n<p>My final working solution was to copy the contents of the Xip file to a temp folder, delete the sub folder, delete the original zip file, create a new zip file, and copy the remaining items to the new zip file.</p>\n\n<p><strong>Usage:</strong> </p>\n\n<blockquote>\n<pre><code>  DeleteZipSubDirectory \"E:\\first.zip\",\"\\first\\second\"   \n</code></pre>\n</blockquote>\n\n<pre><code>Sub DeleteZipSubDirectory(ZipFile As Variant, SubFolderRelativePath As Variant)\n    Dim tempPath As Variant\n\n    'Make Temporary Folder\n    tempPath = Environ(\"Temp\") &amp; \"\\\"\n    Do While Len(Dir(tempPath, vbDirectory)) &gt; 0\n        tempPath = tempPath &amp; \"0\"\n    Loop\n    MkDir tempPath\n\n    Dim control As Object\n    Set control = CreateObject(\"Shell.Application\")\n    'Copy Zip Contents to Temporary Folder\n    control.Namespace(tempPath).CopyHere control.Namespace(ZipFile).Items\n\n    'Debug.Print tempPath\n\n    With CreateObject(\"Scripting.FileSystemObject\")\n        'Delete Target Folder\n        .DeleteFolder tempPath &amp; SubFolderRelativePath\n        'Delete Original FIle\n        Kill ZipFile\n\n        'First we create an empty zip file: https://www.exceltrainingvideos.com/zip-files-using-vba/\n        Open ZipFile For Output As #1\n        Print #1, Chr$(80) &amp; Chr$(75) &amp; Chr$(5) &amp; Chr$(6) &amp; String(18, 0)\n        Close #1\n\n        'Copy the Remaining Items into the new Zip File\n        control.Namespace(ZipFile).CopyHere control.Namespace(tempPath).Items\n        Application.Wait Now + TimeValue(\"0:00:02\")\n        'Delete Temporary Folder\n        .DeleteFolder tempPath\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks for the Mikku and SiddharthRout for there help.  </p>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1605035977, "creation_date": 1605035977, "answer_id": 64775404, "question_id": 57490063, "link": "https://stackoverflow.com/questions/57490063/deleting-a-folder-from-a-zip-file/64775404#64775404", "title": "Deleting a Folder from a Zip file", "body": "<p>I managed to get <a href=\"https://stackoverflow.com/users/9912714/tinman\">TinMan</a>'s original idea to work by setting a WinAPI Timer to click yes in the confirmation dialog. API and TimerProc declarations are for VBA7 onwards.</p>\n<pre><code>Private Declare PtrSafe Function KillTimer Lib &quot;user32&quot; (ByVal hwnd As LongPtr, _\n                                                         ByVal nIDEvent As LongPtr) As Long\n\nPrivate Declare PtrSafe Function SetTimer Lib &quot;user32&quot; (ByVal hwnd As LongPtr, _\n                                                        ByVal nIDEvent As LongPtr, _\n                                                        ByVal uElapse As Long, _\n                                                        ByVal lpTimerFunc As LongPtr) As LongPtr\n\nPrivate Declare PtrSafe Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long)\n\n' Delete the specified sub folder from a Zip file.\n' Example:\n' Call DeleteZipSubFolder(&quot;E:\\first.zip\\first\\second&quot;)\nSub DeleteZipSubFolder(PathToZipFolder)\n  Dim oShell As Object ' Reference: Microsoft Shell Controls And Automation\n  \n  On Error Resume Next\n  \n  Set oShell = CreateObject(&quot;Shell.Application&quot;)\n  \n  TimerID = SetTimer(0, 0, 100, AddressOf TimerProc)\n  \n  oShell.NameSpace(PathToZipFolder).Self.InvokeVerb &quot;Delete&quot;\n  \n  KillTimer 0, TimerID\n  \n  Set oShell = Nothing\n  \n  On Error Goto 0\nEnd Sub\n\nPublic Sub TimerProc(ByVal hwnd As LongPtr, _\n                     ByVal wMsg As Long, _\n                     ByVal idEvent As LongPtr, _\n                     ByVal dwTime As Long)\n                         \n  ' Wait for the Shell confirmation dialog to appear\n  Sleep 100\n  ' Use the Alt+Y shortcut to click the Yes button\n  SendKeys &quot;%Y&quot;\n  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 6, "accepted_answer_id": 57537793, "answer_count": 2, "score": 8, "last_activity_date": 1605035977, "creation_date": 1565767921, "last_edit_date": 1565944391, "question_id": 57490063, "link": "https://stackoverflow.com/questions/57490063/deleting-a-folder-from-a-zip-file", "title": "Deleting a Folder from a Zip file", "body": "<p><strong>I am trying to Delete a Folder from the Zip file.</strong></p>\n\n<p><strong>So My file structure is like:</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/TBLdH.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/TBLdH.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Inside First:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/WN2rt.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/WN2rt.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried to use the code here <a href=\"https://stackoverflow.com/a/56804279/5720144\">Deleting Files from A Zip</a> By Siddharth Rout, But it only Moves the files, apparently the folder becomes empty, <strong><em>but isn't deleted from the Zip</em></strong>. </p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub del()\n\n\nDim oApp As Object\nDim fl As Object\nSet oApp = CreateObject(\"Shell.Application\")\n\n    For Each fl In oApp.Namespace(\"C:\\Users\\mohit.bansal\\Desktop\\Test\\test\\first.zip\\first\").Items\n    'Path to a folder inside the Zip\n        oApp.Namespace(\"C:\\Users\\mohit.bansal\\Desktop\\Test\\test\\Dump\").MoveHere (fl.path)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Apparently it moves all the files to the folder Dump, but the folder named <code>Second</code> stays intact in the Zip. Though all the files from second are also moved.</p>\n\n<p>I can use the command <code>Kill</code> &amp; <code>RmDir</code> afterwards to delete the moved files and Folder. But how to make the Second Folder Vanish from Zip. </p>\n\n<p><strong>Note:</strong> </p>\n\n<ul>\n<li>I don't mean to Move all the files from Zip, It's just the testing condition to keep the code short.</li>\n<li><em>I am not looking for a Workaround to Unzip the file, delete the folder and Re-zip everything.</em></li>\n<li>Let me know if any other information is Required.</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565766784, "post_id": 57489774, "comment_id": 101449832, "body": "Get rid of the <code>.Range</code>."}, {"owner": {"reputation": 23, "user_id": 11724656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bfcaf4920fd0bb2dda01aa3a632d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/11724656/alexey"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565766856, "post_id": 57489774, "comment_id": 101449860, "body": "Okay, So when I copy without .Range(.Cells(n,1)) and just use Cells(n,1) it works, but still. Why doesn&#39;t it work with range?"}, {"owner": {"reputation": 23, "user_id": 11724656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bfcaf4920fd0bb2dda01aa3a632d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/11724656/alexey"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565766920, "post_id": 57489774, "comment_id": 101449887, "body": "BigBen, Yeah, just got it, maybe you can explain a little, why .Range doesn&#39;t work here? Because it works with Range(&quot;A1&quot;), but doesn&#39;t work with Range(.Cells(n,1))"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565767083, "post_id": 57489774, "comment_id": 101449958, "body": "Because <code>.Range(.Cells(n, 1))</code> is equivalent to <code>.Range(.Cells(n, 1).Value)</code>. And that is not what you are looking for. Note that I don&#39;t think you need a loop here, you should be able to transpose that entire range in one go."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1565767192, "post_id": 57489774, "comment_id": 101450008, "body": "When Range has only one argument <code>Range(arg)</code>, it expect the name of the range to be given. In your case, it look for the Value of the cell Cells(n,1) and try to get a range named as this value. You can use Cells in Range when you have two arguments <code>Range(Cells(...), Cells(...)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 11724656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bfcaf4920fd0bb2dda01aa3a632d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/11724656/alexey"}, "is_accepted": false, "score": 0, "last_activity_date": 1565767824, "creation_date": 1565767824, "answer_id": 57490035, "question_id": 57489774, "link": "https://stackoverflow.com/questions/57489774/how-to-correct-the-error-in-rangecells/57490035#57490035", "title": "How to correct the error in range(cells)?", "body": "<p>Thanks to the guys above, the answer was simple: </p>\n\n<pre><code>For n = 1 To k\n\n    Sheets(\"Sheet1\").Range(Sheets(\"Sheet1\").Cells(12, n), (Sheets(\"Sheet1\").Cells(52, n)).Copy\n\n\n        With Worksheets(\"Sheet2\")  \n\n\n        .Cells(n, 1)).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n\n\n        End With\n</code></pre>\n\n<blockquote>\n  <p>Because .Range(.Cells(n, 1)) is equivalent to .Range(.Cells(n, 1).Value). And that is not what you are looking for. Note that I don't think you need a loop here, you should be able to transpose that entire range in one go. \u2013 BigBen</p>\n</blockquote>\n"}], "owner": {"reputation": 23, "user_id": 11724656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bfcaf4920fd0bb2dda01aa3a632d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/11724656/alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565767824, "creation_date": 1565766716, "question_id": 57489774, "link": "https://stackoverflow.com/questions/57489774/how-to-correct-the-error-in-rangecells", "title": "How to correct the error in range(cells)?", "body": "<p>Writing pretty simple script and occured the following problem, the bot stops running when I put in the code: </p>\n\n<pre><code> .Range(.Cells(n, 1)).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n</code></pre>\n\n<p>The problem is that when I am making <code>Range(\"A1\")</code> there is no error, but when I try to insert some iteration mechanism here, something fails. </p>\n\n<p>First of all, I supposed it was undefined cells, so I went with <code>With</code> function.</p>\n\n<pre><code>For n = 1 To k\n\n    Sheets(\"Sheet1\").Range(Sheets(\"Sheet1\").Cells(12, n), (Sheets(\"Sheet1\").Cells(52, n)).Copy\n\n\n        With Worksheets(\"Sheet2\")  \n\n\n        .Range(.Cells(n, 1)).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n\n\n        End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1565765932, "post_id": 57489505, "comment_id": 101449476, "body": "I&#39;m not too sure what you&#39;re after, but based on your title do you not want to use something like <code>If Target.Column = 5</code> (column E), and <code>Target.Row &gt;=12</code> (from row 12)?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565766394, "post_id": 57489505, "comment_id": 101449673, "body": "I think I understand what you&#39;re asking.  If you want each new row to look and act like the original row, then that can be done.  I don&#39;t see how you are adding rows though.  Do you rely on the user to insert the row themselves?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565766682, "post_id": 57489505, "comment_id": 101449780, "body": "@ProfoundlyOblivious firstly, thank you for understanding what I&#39;m saying cause I&#39;m bad at putting my thoughts down into words. And yes, exactly as what you said, i want the new row to act like the original row if users insert a new row below <code>Cell E12</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1565766741, "post_id": 57489505, "comment_id": 101449811, "body": "@Dean hey dean, sort of but I only want this to happen for the new rows inserted by the users"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565771165, "post_id": 57489505, "comment_id": 101451859, "body": "How are the users creating the row?  If they can choose any method then you are in a very difficult position. It is probably easier to prompt the user and add rows for them instead of trying to handle all the possible scenarios. For example, if they create a row before populating E5 then you can modify your existing code to work when E5 it is selected for entry; but that won&#39;t work if they populate E5 before adding a row.  What if they add more than one row? What if they don&#39;t add a row, instead they cut from row 6 to the bottom of the form and paste the section 3 rows further down?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "edited": false, "score": 0, "creation_date": 1565771936, "post_id": 57489505, "comment_id": 101452222, "body": "hmmm I will put an instruction that asks them to insert their rows by clicking on Cell A13 for example. So it would have something to do with if <code>Range(&quot;A13&quot;).insert shift := xlshiftdown then</code> ........ but that code doesnt work for me.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565775694, "post_id": 57489505, "comment_id": 101454060, "body": "@ProfoundlyOblivious after much consideration to what you said, what if I want to copy the whole code format of <code>Cell E12</code> to <code>Cell E13</code> if the user fills in <code>Cell B2</code>? Instead of allowing them to insert new rows, I am putting in a fixed table for users where there can only be a max of 10 records. So if they fill in Col B12:B21 then that counts as new user records. Hope what I&#39;m saying is making sense.."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1565794888, "post_id": 57489505, "comment_id": 101464277, "body": "<i>&quot;copy the whole code format of Cell E12 to Cell E13 if the user fills in Cell B2?&quot;</i> Certainly doable and easy.  You would use the worksheet change event as the trigger - you&#39;re using selection change right now. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">ms documentation</a>  It would be  helpful if you can post a picture of your template, it seems odd to only be concerned with one cell after inserting a row.  Have to head to work so it will be a while for me to update."}], "owner": {"user_type": "does_not_exist", "display_name": "user11850057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565770603, "creation_date": 1565765564, "last_edit_date": 1565770603, "question_id": 57489505, "link": "https://stackoverflow.com/questions/57489505/using-worksheet-selectionchange-byval-target-as-range-for-a-specific-column-st", "title": "Using Worksheet_SelectionChange (ByVal Target As Range) for a specific column starting from E12", "body": "<p>I have a form that users are required to fill up. </p>\n\n<p><code>Cell E5</code> contains a drop-down list for users to select an option. However, users may insert new rows below <code>Cell E5</code> if they have more than one users to add to their submission (i.e. one row, one user). </p>\n\n<p>I was wondering if it is possible to so-called add-on to my target range under Worksheet_SelectionChange(ByVal Target As Range). So if user inserts a new row, the drop-down list and formatting I did for <code>Cell E5</code> will also be the same for the next row which the user has inserted. Any help is truly appreciated..this is the code I have thus far:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'''I have tried If not intersect(Target, Range(\"E\")) is Nothing then .....but it has not been working out\n'''I think I saw one with r + 1 etc.... but I'm not too sure how to go about that\n\nIf Not Intersect(Target, Range(\"E5\")) Is Nothing Then\n\nDim col As New Collection\nDim rng As Range\nDim i As Long\nDim DVList As String\n\nFor Each rng In Sheet2.Range(\"A1:A5,C1:C7\")\n   If Len(Trim(rng.Value)) &lt;&gt; 0 Then\n        On Error Resume Next\n        col.Add rng.Value, CStr(rng.Value)\n        On Error GoTo 0\n    End If\nNext rng\n\nFor i = 1 To col.Count\n    DVList = DVList &amp; col.Item(i) &amp; \",\"\nNext i\n\nWith Sheet1.Range(\"E5\").Validation\n    .Delete\n    .Add Type:=xlValidateList, _\n    AlertStyle:=xlValidAlertStop, _\n    Formula1:=DVList\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "fuzzy-search", "fuzzy-comparison"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1565766107, "post_id": 57489309, "comment_id": 101449542, "body": "Have you tried the <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow noreferrer\">Levenshtein-Distanz</a>? There is an implementation for VBA <a href=\"https://en.wikibooks.org/wiki/Algorithm_Implementation/Strings/Levenshtein_distance#Visual_Basic_for_Applications_(no_Damerau_extension)\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9892448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ff55304411ebd27a1c62e1cddf351e?s=128&d=identicon&r=PG&f=1", "display_name": "Renier Wessels", "link": "https://stackoverflow.com/users/9892448/renier-wessels"}, "edited": false, "score": 0, "creation_date": 1565950460, "post_id": 57489974, "comment_id": 101512155, "body": "Thank you. This worked perfectly. Any thoughts on making it faster / more efficient?"}, {"owner": {"reputation": 91, "user_id": 9892448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ff55304411ebd27a1c62e1cddf351e?s=128&d=identicon&r=PG&f=1", "display_name": "Renier Wessels", "link": "https://stackoverflow.com/users/9892448/renier-wessels"}, "edited": false, "score": 0, "creation_date": 1566027150, "post_id": 57489974, "comment_id": 101533655, "body": "Thank you. I&#39;ll test and revert back to you."}], "tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": true, "score": 0, "last_activity_date": 1575967980, "last_edit_date": 1575967980, "creation_date": 1565767617, "answer_id": 57489974, "question_id": 57489309, "link": "https://stackoverflow.com/questions/57489309/a-more-accurate-and-more-efficient-fuzzy-searching-algorithm/57489974#57489974", "title": "A more accurate and more efficient fuzzy searching algorithm", "body": "<p>When comparing Strings I usually use the <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow noreferrer\">Levenshtein-Distance</a>. You can find an implementation of the algorithm <a href=\"https://en.wikibooks.org/wiki/Algorithm_Implementation/Strings/Levenshtein_distance#Visual_Basic_for_Applications_(no_Damerau_extension)\" rel=\"nofollow noreferrer\">here</a>. You can extend the function by the Ratio, which is a pretty good indicator for measuring how \"close\" two strings are.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function levenshtein(a As String, b As String, Optional ratio As Boolean) As Double\n\n    Dim i As Long, j As Long, cost As Long\n    Dim d() As Long\n    Dim min1 As Long, min2 As Long, min3 As Long\n\n    If Len(a) = 0 Then\n        levenshtein = Len(b)\n        Exit Function\n    End If\n\n    If Len(b) = 0 Then\n        levenshtein = Len(a)\n        Exit Function\n    End If\n\n    ReDim d(Len(a), Len(b))\n\n    For i = 0 To Len(a)\n        d(i, 0) = i\n    Next\n\n    For j = 0 To Len(b)\n        d(0, j) = j\n    Next\n\n    For i = 1 To Len(a)\n        For j = 1 To Len(b)\n            If Mid(a, i, 1) = Mid(b, j, 1) Then\n                cost = 0\n            Else\n                cost = 1\n            End If\n\n            min1 = (d(i - 1, j) + 1)\n            min2 = (d(i, j - 1) + 1)\n            min3 = (d(i - 1, j - 1) + cost)\n\n            d(i, j) = Application.WorksheetFunction.Min(min1, min2, min3)\n        Next\n    Next\n\n    If ratio Then\n        levenshtein = (Len(a) + Len(b) - d(Len(a), Len(b))) / (Len(a) + Len(b))\n    Else\n        levenshtein = d(Len(a), Len(b))\n    End If\n\nEnd Function\n</code></pre>\n\n<p>For your examples:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print levenshtein(\"Cash and Cash Equivalents\", \"Bank and Cash\", True)\nDebug.Print levenshtein(\"Cash and Cash Equivalents\", \"Cash and Bank\", True)\nDebug.Print levenshtein(\"Cash and Cash Equivalents\", \"Shack sequential\", True)\nDebug.Print levenshtein(\"Cash and Cash Equivalents\", \"Sequential shack\", True)\n</code></pre>\n\n<p>Returns:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> 0.605263157894737 \n 0.631578947368421 \n 0.560975609756098 \n 0.48780487804878\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I guess the String-Comparisons are slowing things down a lot. One way to speed this up, is to convert the String into a Byte-Array and compare numeric values. This could be done like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function levenshtein(a As String, b As String, Optional ratio As Boolean) As Double\n\n    Dim i As Long, j As Long\n    Dim k As Long, l As Long\n    Dim cost As Long\n    Dim d() As Long\n    Dim min1 As Long, min2 As Long, min3 As Long\n    Dim aByte1() As Byte, aByte2() As Byte\n\n    If Len(a) = 0 Then\n        levenshtein = Len(b)\n        Exit Function\n    End If\n\n    If Len(b) = 0 Then\n        levenshtein = Len(a)\n        Exit Function\n    End If\n\n    ReDim d(Len(a), Len(b))\n\n    For i = 0 To Len(a)\n        d(i, 0) = i\n    Next\n\n    For j = 0 To Len(b)\n        d(0, j) = j\n    Next\n\n    aByte1 = a\n    aByte2 = b\n    For i = 0 To UBound(aByte1, 1) Step 2\n        k = Int(i / 2) + 1\n        For j = 0 To UBound(aByte2, 1) Step 2\n            If aByte1(i) = aByte2(j) Then\n                cost = 0\n            Else\n                cost = 1\n            End If\n            l = Int(j / 2) + 1\n            min1 = (d(k - 1, l) + 1)\n            min2 = (d(k, l - 1) + 1)\n            min3 = (d(k - 1, l - 1) + cost)\n\n            d(k, l) = Application.WorksheetFunction.Min(min1, min2, min3)\n        Next\n    Next\n\n    If ratio Then\n        levenshtein = (Len(a) + Len(b) - d(Len(a), Len(b))) / (Len(a) + Len(b))\n    Else\n        levenshtein = d(Len(a), Len(b))\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9892448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ff55304411ebd27a1c62e1cddf351e?s=128&d=identicon&r=PG&f=1", "display_name": "Renier Wessels", "link": "https://stackoverflow.com/users/9892448/renier-wessels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 57489974, "answer_count": 1, "score": 3, "last_activity_date": 1581612131, "creation_date": 1565764644, "last_edit_date": 1581612131, "question_id": 57489309, "link": "https://stackoverflow.com/questions/57489309/a-more-accurate-and-more-efficient-fuzzy-searching-algorithm", "title": "A more accurate and more efficient fuzzy searching algorithm", "body": "<p>I have been researching fuzzy match / search algorithms across the internet. I have tried a couple of solutions.</p>\n\n<p>The only that gave somewhat accurate results was from Mr. Excel (<a href=\"http://www.mrexcel.com/pc07.shtml\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/pc07.shtml</a>). The problem with this method is the order or relative position of characters in the words and the order of the words themselves had no effect on the results.</p>\n\n<p>I would like to get better results based on the relative word position as well as the order of the letters per word.</p>\n\n<pre><code>Function FuzzyMatchByWord(ByVal lsPhrase1 As String, ByVal lsPhrase2 As String, Optional lbStripVowels As Boolean = False, Optional lbDiscardExtra As Boolean = False) As Double\n\n'\n' Compare two phrases and return a similarity value (between 0 and 100).\n'\n' Arguments:\n'\n' 1. Phrase1        String; any text string\n' 2. Phrase2        String; any text string\n' 3. StripVowels    Optional to strip all vowels from the phrases\n' 4. DiscardExtra   Optional to discard any unmatched words\n'\n\n\n'local variables\nDim lsWord1() As String\nDim lsWord2() As String\nDim ldMatch() As Double\nDim ldCur As Double\nDim ldMax As Double\nDim liCnt1 As Integer\nDim liCnt2 As Integer\nDim liCnt3 As Integer\nDim lbMatched() As Boolean\nDim lsNew As String\nDim lsChr As String\nDim lsKeep As String\n\n'set default value as failure\nFuzzyMatchByWord = 0\n\n'create list of characters to keep\nlsKeep = \"BCDFGHJKLMNPQRSTVWXYZ0123456789 \"\nIf Not lbStripVowels Then\n    lsKeep = lsKeep &amp; \"AEIOU\"\nEnd If\n\n'clean up phrases by stripping undesired characters\n'phrase1\nlsPhrase1 = Trim$(UCase$(lsPhrase1))\nlsNew = \"\"\nFor liCnt1 = 1 To Len(lsPhrase1)\n    lsChr = Mid$(lsPhrase1, liCnt1, 1)\n    If InStr(lsKeep, lsChr) &lt;&gt; 0 Then\n        lsNew = lsNew &amp; lsChr\n    End If\nNext\nlsPhrase1 = lsNew\nlsPhrase1 = Replace(lsPhrase1, \"  \", \" \")\nlsWord1 = Split(lsPhrase1, \" \")\nIf UBound(lsWord1) = -1 Then\n    Exit Function\nEnd If\nReDim ldMatch(UBound(lsWord1))\n'phrase2\nlsPhrase2 = Trim$(UCase$(lsPhrase2))\nlsNew = \"\"\nFor liCnt1 = 1 To Len(lsPhrase2)\n    lsChr = Mid$(lsPhrase2, liCnt1, 1)\n    If InStr(lsKeep, lsChr) &lt;&gt; 0 Then\n        lsNew = lsNew &amp; lsChr\n    End If\nNext\nlsPhrase2 = lsNew\nlsPhrase2 = Replace(lsPhrase2, \"  \", \" \")\nlsWord2 = Split(lsPhrase2, \" \")\nIf UBound(lsWord2) = -1 Then\n    Exit Function\nEnd If\nReDim lbMatched(UBound(lsWord2))\n\n'exit if empty\nIf Trim$(lsPhrase1) = \"\" Or Trim$(lsPhrase2) = \"\" Then\n    Exit Function\nEnd If\n\n'compare words in each phrase\nFor liCnt1 = 0 To UBound(lsWord1)\n    ldMax = 0\n    For liCnt2 = 0 To UBound(lsWord2)\n        If Not lbMatched(liCnt2) Then\n            ldCur = FuzzyMatch(lsWord1(liCnt1), lsWord2(liCnt2))\n            If ldCur &gt; ldMax Then\n                liCnt3 = liCnt2\n                ldMax = ldCur\n            End If\n        End If\n    Next\n    lbMatched(liCnt3) = True\n    ldMatch(liCnt1) = ldMax\nNext\n\n'discard extra words\nldMax = 0\nFor liCnt1 = 0 To UBound(ldMatch)\n    ldMax = ldMax + ldMatch(liCnt1)\nNext\nIf lbDiscardExtra Then\n    liCnt2 = 0\n    For liCnt1 = 0 To UBound(lbMatched)\n        If lbMatched(liCnt1) Then\n            liCnt2 = liCnt2 + 1\n        End If\n    Next\nElse\n    liCnt2 = UBound(lsWord2) + 1\nEnd If\n\n'return overall similarity\nFuzzyMatchByWord = 100 * (ldMax / liCnt2)\n\n\nEnd Function\n\nFunction FuzzyMatch(Fstr As String, Sstr As String) As Double\n\n'\n' Code sourced from: http://www.mrexcel.com/pc07.shtml\n' Credited to: Ed Acosta\n' Modified: Joe Stanton\n'\n\nDim L, L1, L2, M, SC, T, R As Integer\n\nL = 0\nM = 0\nSC = 1\n\nL1 = Len(Fstr)\nL2 = Len(Sstr)\n\nDo While L &lt; L1\n    L = L + 1\n    For T = SC To L1\n        If Mid$(Sstr, L, 1) = Mid$(Fstr, T, 1) Then\n            M = M + 1\n            SC = T\n            T = L1 + 1\n        End If\n    Next T\nLoop\n\nIf L1 = 0 Then\n    FuzzyMatch = 0\nElse\n    FuzzyMatch = M / L1\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>I am trying to compare account descriptions from a trial balance to a list of 30,000 past account descriptions and I want to find the 5 top results per account.</p>\n\n<p>To give you an example:</p>\n\n<pre><code>Debug.Print FuzzyMatchByWord(\"Cash and Cash Equivalents\", \"Bank and Cash\")\nDebug.Print FuzzyMatchByWord(\"Cash and Cash Equivalents\", \"Cash and Bank\")\nDebug.Print FuzzyMatchByWord(\"Cash and Cash Equivalents\", \"Shack sequential\")\nDebug.Print FuzzyMatchByWord(\"Cash and Cash Equivalents\", \"Sequential shack\")\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>75 \n75 \n37.5 \n37.5\n</code></pre>\n\n<p>I would want the relative placement of a word in a phrase to count more towards the score and I would also prefer the order of the letters have a bigger impact. Sequential shack should not have scored that high compared to Cash and Cash Equivalents.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565763013, "post_id": 57488965, "comment_id": 101448364, "body": "Are you trying to delete column <code>L</code> from every sheet ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1565763069, "post_id": 57488965, "comment_id": 101448389, "body": "Works for me.  Though you may want to qualify which workbook the sheets are in, assuming it&#39;s <code>ThisWorkbook</code>."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565763174, "post_id": 57488965, "comment_id": 101448418, "body": "Try <code>Activeworkbook.Sheets(&quot;Sheet (&quot; &amp; i &amp; &quot;)&quot;).Columns(&quot;L&quot;).Delete Shift:=xlShiftToLeft</code>"}, {"owner": {"reputation": 27, "user_id": 5191652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de13d27c7b8253c713b8f24e9aebd62?s=128&d=identicon&r=PG&f=1", "display_name": "Jane90", "link": "https://stackoverflow.com/users/5191652/jane90"}, "edited": false, "score": 0, "creation_date": 1565763590, "post_id": 57488965, "comment_id": 101448576, "body": "Thanks all, defining the Activeworkbook helped."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 2, "creation_date": 1565764215, "post_id": 57488965, "comment_id": 101448789, "body": "@Mikku why use ActiveWorkbook? That&#39;s asking for trouble.."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565766594, "post_id": 57488965, "comment_id": 101449752, "body": "I know it&#39;s not Ideal, But we don&#39;t know where the Macro is Saved, maybe in Personal Workbook or an Addin. Most probable scenario for anyone to run a Macro is after being on that WorkBook."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1565768553, "post_id": 57488965, "comment_id": 101450580, "body": "Have a look at defining workbook names, I use wbtarget &amp; wbmaster... : <a href=\"https://stackoverflow.com/q/50776026/4961700\">stackoverflow.com/q/50776026/4961700</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 13815436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GiLpZvQWAid9ppp5owx01ZdsHSMuKPpF1uJccrP=k-s128", "display_name": "Valentin MAGNIN", "link": "https://stackoverflow.com/users/13815436/valentin-magnin"}, "is_accepted": false, "score": 0, "last_activity_date": 1593123468, "creation_date": 1593123468, "answer_id": 62585175, "question_id": 57488965, "link": "https://stackoverflow.com/questions/57488965/vba-sheet-names-with-loops/62585175#62585175", "title": "VBA Sheet Names with Loops", "body": "<p>You can loop through sheets like below :</p>\n<pre><code>Sub LoopSheets()\n \n    Dim Sh As Worksheet\n\n    For Each Sh In ActiveWorkbook.Sheets\n        Sh.Columns(&quot;L&quot;).Delete Shift:=xlShiftToLeft\n    Next Sh\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5191652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de13d27c7b8253c713b8f24e9aebd62?s=128&d=identicon&r=PG&f=1", "display_name": "Jane90", "link": "https://stackoverflow.com/users/5191652/jane90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593123468, "creation_date": 1565762889, "last_edit_date": 1565762953, "question_id": 57488965, "link": "https://stackoverflow.com/questions/57488965/vba-sheet-names-with-loops", "title": "VBA Sheet Names with Loops", "body": "<p>I have a few sheets in a workbook. They are each called Sheet (1), Sheet (2) etc.</p>\n\n<p>I want to run a loop to go through each sheet and highlight a particular cell. </p>\n\n<p>I have tried setting this up in vba, but can't seem to work out how to loop through the sheets.</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 1 To 13\n\nSheets(\"Sheet (\" &amp; i &amp; \")\").Columns(\"L\").Delete Shift:=xlShiftToLeft\n\nNext i\n</code></pre>\n\n<p>However, this doesn't seem to loop through each of the sheets.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565765047, "post_id": 57488930, "comment_id": 101449121, "body": "A problem with your function is that only a <code>Range</code> has <code>Rows</code> and <code>Columns</code> properties, yet you are trying to get those from a variant array."}, {"owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565765269, "post_id": 57488930, "comment_id": 101449223, "body": "So what should I edit here to make this works? I am not very clear here.Thank you"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565765424, "post_id": 57488930, "comment_id": 101449279, "body": "If you read a range into an array <code>arr</code>, the number of rows is <code>UBound(arr, 1)</code> and the number of columns is <code>UBound(arr, 2)</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565765792, "post_id": 57488930, "comment_id": 101449420, "body": "Also you&#39;ll want <code>ReDim y(1 to nr, 1 to nc)</code>."}, {"owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565765919, "post_id": 57488930, "comment_id": 101449470, "body": "@BigBen: Thank you. I also want to know when can we use sth.rows.count and sth.columns.count If possible please help me explain more cuz I still cannot figure out what is wrong here. Thank you"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565765945, "post_id": 57488930, "comment_id": 101449483, "body": "When the argument is a <code>Range</code>. Then you would have <code>Set x = Range(&quot;A1:A10&quot;)</code>."}], "owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565770616, "creation_date": 1565762613, "last_edit_date": 1565770616, "question_id": 57488930, "link": "https://stackoverflow.com/questions/57488930/replace-evaluate-for-arrays", "title": "Replace &amp; Evaluate for arrays", "body": "<p><strong>Question 01: - Evaluate &amp; Replace for array</strong></p>\n\n<p>There is a code line:</p>\n\n<pre><code>x1 = Evaluate(Replace(fxn1, \"x\", x))\n</code></pre>\n\n<p>In which: fxn1 is string, says \"x^2\". The code line works fine for scalar value of x. However, when I go for x as matrix of (mxn) or even (nx1). It doesn't work.</p>\n\n<p>Is there any way to make that code work?</p>\n\n<p>My solution is using a loop to perform for every element in x. However, I don;t think this way is efficient.</p>\n\n<p><strong>Question 02: Loop for above problem</strong>\nThis is my temporary solution for my question above. It is not efficient.\nThe function works fine. However, when I use a sub to call that function. It does not works.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub sample()\nDim fxn As String\nDim x() As Variant\nDim y() As Variant\nfxn = \"x^2\"\nx = Range(\"A1:A10\")\ny = fnarray(\"x^2\", x)\nRange(\"L1:L10\") = y\nEnd Sub\n\nFunction fnarray(fn As String, x As Variant)\nDim nr As Integer, nc As Integer\nDim i As Integer, j As Integer\nDim y\nnr = x.Rows.Count\nnc = x.Columns.Count\nReDim y(nr, nc) As Variant\nFor i = 1 To nr\n    For j = 1 To nc\n        y(i, j) = Evaluate(Replace(fn, \"x\", x(i, j)))\n    Next j\nNext i\nfnarray = y\nEnd Function\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565782737, "post_id": 57488958, "comment_id": 101457582, "body": "Hi Thank you for your quick reply, i tried your code and for the first time i was getting something displayed in immediate window! -- but only the source code was returned in immediate window, could you please suggest what mistake would i be doing?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565787969, "post_id": 57488958, "comment_id": 101460271, "body": "@Banwari That is what the code does. What are you expecting?"}, {"owner": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565831404, "post_id": 57488958, "comment_id": 101476167, "body": "Hi Andreas, Am expecting the code to navigate to the url and type in username and password into the webpage and login automatically. Please advise!"}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1565762828, "creation_date": 1565762828, "answer_id": 57488958, "question_id": 57488758, "link": "https://stackoverflow.com/questions/57488758/how-to-type-into-webpage-form-using-excel-vba-if-the-page-source-does-not-contai/57488958#57488958", "title": "How to type into webpage form using Excel VBA if the page source does not contain &quot;id&quot; attribute", "body": "<p>Since it's POST data you need to pass the variables along with the page request.<br>\nThis is one method.  </p>\n\n<pre><code>Set objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"URL TO WEBPAGE\" ' change this\nobjHTTP.Open \"POST\", URL, False, \"USERNAME\", \"PASSWORD\" ' Change Username and password\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nobjHTTP.setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\"\nobjHTTP.send (\"\")\nhtml = objHTTP.responseText\n\nDebug.Print html\n</code></pre>\n\n<p>If that don't work you may need to use the send parameters.</p>\n\n<pre><code>Set objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"URL TO WEBPAGE\" ' change this\nobjHTTP.Open \"POST\", URL, False ' notice no username and password\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nobjHTTP.setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\"\nobjHTTP.send(\"PHP_AUTH_USER=username,PHP_AUTH_PW=password\") ' we put it here instead. \n' But I have never done username and password this way, it could be that you should use \n' objHTTP.send(\"PHP_AUTH_USER=username&amp;PHP_AUTH_PW=password\")\nhtml = objHTTP.responseText\n\nDebug.Print html\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565782251, "post_id": 57489685, "comment_id": 101457362, "body": "Hi Thanks much for your quick reply i tried the above but still did not get the values typed automatically in the fields. should i make any other changes?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565785357, "post_id": 57489685, "comment_id": 101458829, "body": "try to .focus on the fields first. Otherwise try .document.parentWindow.execScript &quot;document.querySelector(&#39;[name=PHP_AUTH_USER]&#39;).setAttribute&zwnj;&#8203;(&#39;value&#39;,&#39;username&#39;)&zwnj;&#8203;;&quot;       also try with &#39;value&#39; replaced with &#39;textContent&#39;"}, {"owner": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565831108, "post_id": 57489685, "comment_id": 101476112, "body": "Hi Qharr, FYI only -once the url loads the username input field will be highlighted automatically we dont have to click on it to highlight. i tried you above method and got the error -- &quot;Run-time error &#39;-21477023179(800706b5)&#39;: Automation error The interface is unknown&quot; on line While .busy Or .readystate &lt;&gt; 4: DoEvents: Wend. i feel we are not able to access the type in fields yet. please advise!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1565785406, "last_edit_date": 1565785406, "creation_date": 1565766373, "answer_id": 57489685, "question_id": 57488758, "link": "https://stackoverflow.com/questions/57488758/how-to-type-into-webpage-form-using-excel-vba-if-the-page-source-does-not-contai/57489685#57489685", "title": "How to type into webpage form using Excel VBA if the page source does not contain &quot;id&quot; attribute", "body": "<p>You can try using the <code>name</code> attributes</p>\n\n<pre><code>MyBrowser.document.querySelector(\"[name='PHP_AUTH_USER']\").value = \"username\"\n\nMyBrowser.document.querySelector(\"[name='PHP_AUTH_PW']\").value = \"password\"\n</code></pre>\n\n<p>I tested with your html in an html file on disk</p>\n\n<pre><code>Public Sub test()\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate2 \"url\"  'or file to test html file containing html sample\n        While .busy Or .readystate &lt;&gt; 4: DoEvents: Wend\n        With .document.querySelector(\"[name='PHP_AUTH_USER']\")\n            .Focus\n            .Value = \"username\"\n        End With\n        With .document.querySelector(\"[name='PHP_AUTH_PW']\")\n            .Focus\n            .Value = \"password\"\n        End With\n        Stop '&lt;== delete me later\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Reading:</strong></p>\n\n<ol>\n<li>Css <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors\" rel=\"nofollow noreferrer\">attribute selectors</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector\" rel=\"nofollow noreferrer\">querySelector</a></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "edited": false, "score": 0, "creation_date": 1565831676, "post_id": 57497246, "comment_id": 101476207, "body": "Hi, Thank you for sharing your answer. however am still unable to login into the page, above code navigates to the url but does not type in username and password to login. i got the error message &quot; Run-time error &#39;-2147467259(80004005)&#39;: Method &#39;Busy&#39; of object &#39;IWebBrowser2&#39; failed&quot;  Are we just assigning the values and not typing in them into the fields, please advise!"}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1565794681, "creation_date": 1565794681, "answer_id": 57497246, "question_id": 57488758, "link": "https://stackoverflow.com/questions/57488758/how-to-type-into-webpage-form-using-excel-vba-if-the-page-source-does-not-contai/57497246#57497246", "title": "How to type into webpage form using Excel VBA if the page source does not contain &quot;id&quot; attribute", "body": "<p>You could use the getElementsByName method to get the elements, code as below:</p>\n\n<pre><code>Sub login()\n\n    Const Url$ = \"&lt;login page url&gt;\"\n\n    Dim UserName As String, Password As String\n\n    UserName = \"Dillion\"\n    Password = \"password\"\n\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n\n        .navigate Url\n        ieBusy ie\n        .Visible = True\n\n        Dim oLogin As Object, oPassword As Object\n        Set oLogin = .document.getElementsByName(\"PHP_AUTH_USER\")(0)\n        Set oPassword = .document.getElementsByName(\"PHP_AUTH_PW\")(0)\n\n        oLogin.Value = UserName\n        oPassword.Value = Password\n\n        Dim submitbtn As Object\n        Set submitbtn = .document.getElementsByName(\"action\")(0)\n        submitbtn.Click\n\n        'You could also use the following code to submite the form.\n        '.document.forms(0).submit\n\n    End With\n\nEnd Sub\n\nSub ieBusy(ie As Object)\n    Do While ie.Busy Or ie.readyState &lt; 4\n        DoEvents\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11925566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4628fcc1dc058ade9bb01636e76a1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Banwari", "link": "https://stackoverflow.com/users/11925566/banwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1581483108, "creation_date": 1565761552, "last_edit_date": 1581483108, "question_id": 57488758, "link": "https://stackoverflow.com/questions/57488758/how-to-type-into-webpage-form-using-excel-vba-if-the-page-source-does-not-contai", "title": "How to type into webpage form using Excel VBA if the page source does not contain &quot;id&quot; attribute", "body": "<p>I am trying to use Excel VBA to open an URL and login to the webpage.</p>\n\n<p>I am not able to type in the user name and password fields. </p>\n\n<p>I tried using getelementsbytagname. I am not sure about the right syntax.</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\n\nSub MyGmail()\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\nOn Error GoTo Err_Clear\nMyURL = \"https://xxxxxxxxxxx\"\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.navigate MyURL\nMyBrowser.Visible = True\nDo\nLoop Until MyBrowser.readyState = READYSTATE_COMPLETE\nSet HTMLDoc = MyBrowser.document`enter code here`\nDebug.Print HTMLDoc.getElementsByClassName(\"hwiDialogTable\").getElementsByTagName(\"form\").Item(0) ' trying to see if am bale to access elements\nHTMLDoc.all.Email.Value = \"abcd\" 'Enter your email id here\nHTMLDoc.all.passwd.Value = \"xxxxx\" 'Enter your password here\nFor Each MyHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\n    If MyHTML_Element.Type = \"submit\" Then MyHTML_Element.Click: Exit For\nNext\nErr_Clear:\nIf Err &lt;&gt; 0 Then\n    Err.Clear\n    Resume Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is the source code for the page:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n   &lt;meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\" /&gt;\n   &lt;title&gt;Login to TWS/WebAdmin&lt;/title&gt;\n   &lt;script type=\"text/javascript\"&gt;if (window.top != window.self) { window.top.location.href = window.self.location.href; } &lt;/script&gt;\n   &lt;style type=\"text/css\"&gt;\n      html, body { margin: 0; padding: 0; width: 100%; height: 100% }\n      * { font-family: Verdana; font-size: 10pt }\n      h1 { font-size: 14pt }\n      table.hwiDialogTable { position: absolute; width: 100%; height:100%; top: 0; left: 0; right: 0; bottom: 0 }\n      td.hwiDialogTd { text-align: center; vertical-align: middle; background: #dddddd }\n      div.hwiDialogDiv { position: relative; margin: 0 auto; width: 500px; background: white; text-align: left; padding: 20px }\n      div.hwiDialogDivCorner { height: 2px; width: 2px; border: 1px solid #E0E0E0; position: absolute }\n      a.menuitem { text-decoration:none }\n      a:hover { background-color:blue; color:white; }\n   &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;table class=\"hwiDialogTable\"&gt;\n&lt;tr&gt;&lt;td class=\"hwiDialogTd\"&gt;\n&lt;div class=\"hwiDialogDiv\"&gt;\n&lt;div class=\"hwiDialogDivCorner\" style=\"top: 0; left: 0; border-right-color: white; border-bottom-color: white\"&gt;&lt;/div&gt;\n&lt;div class=\"hwiDialogDivCorner\" style=\"top: 0; right: 0; border-left-color: white; border-bottom-color: white\"&gt;&lt;/div&gt;\n&lt;div class=\"hwiDialogDivCorner\" style=\"bottom: 0; right: 0; border-left-color: white; border-top-color: white\"&gt;&lt;/div&gt;\n&lt;div class=\"hwiDialogDivCorner\" style=\"bottom: 0; left: 0; border-right-color: white; border-top-color: white\"&gt;&lt;/div&gt;\n&lt;h1&gt;Login to TWS/WebAdmin&lt;/h1&gt;\n&lt;br/&gt;&lt;br/&gt;\n&lt;form action=\"/\" method=\"post\"&gt;\n   &lt;table&gt;\n      &lt;tr&gt;&lt;td&gt;User&amp;nbsp;name:&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"PHP_AUTH_USER\" value=\"\" /&gt;&lt;/td&gt;&lt;/tr&gt;\n      &lt;tr&gt;&lt;td&gt;Password:&lt;/td&gt;&lt;td&gt;&lt;input type=\"password\" name=\"PHP_AUTH_PW\" value=\"\" autocomplete=\"off\"/&gt;&lt;/td&gt;&lt;/tr&gt;\n   &lt;/table&gt;\n   &lt;script type=\"text/javascript\"&gt;\n      var hwiNameInput = window.document.getElementsByName('PHP_AUTH_USER');\n      if (hwiNameInput.length &gt; 0) {\n         hwiNameInput[0].focus();\n      }\n   &lt;/script&gt;\n   &lt;input type=\"submit\" name=\"action\" value=\"Login\" /&gt;\n   &lt;input type=\"hidden\" name=\"redirect\" value=\"\" /&gt;\n&lt;/form&gt;\n&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The web page opens but nothing happens after that.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565759215, "post_id": 57488420, "comment_id": 101447338, "body": "Are you using this with a filter? Can you show us the code you&#39;ve tried?"}, {"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565759901, "post_id": 57488420, "comment_id": 101447491, "body": "@BigBen apologies, have attempted to structure my question better. I&#39;ve been able to obtain the data I want using the filters. Unfortunately, I can&#39;t seem to get all the dates in that date range to populate on a worksheet"}], "answers": [{"tags": [], "owner": {"reputation": 2323, "user_id": 579123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5681309a3b72965a9e5e4651fd38416b?s=128&d=identicon&r=PG&f=1", "display_name": "ItsPete", "link": "https://stackoverflow.com/users/579123/itspete"}, "is_accepted": true, "score": 2, "last_activity_date": 1565760120, "creation_date": 1565760120, "answer_id": 57488549, "question_id": 57488420, "link": "https://stackoverflow.com/questions/57488420/get-all-months-years-between-date-range-vba/57488549#57488549", "title": "Get All Months &amp; Years between Date Range VBA", "body": "<p>A simple way would be to loop through each month between the 2 dates:</p>\n\n<pre><code>Dim tempDate As Date: tempDate = Sheet1.Cells(1, 1).Value\nDim endDate As Date: endDate = Sheet1.Cells(1, 2).Value\n\nDim i As Integer: i = 3\n\nDo While tempDate &lt; endDate\n    Sheet1.Cells(i, 1).Value = MonthName(DatePart(\"m\", tempDate)) &amp; \" \" &amp; DatePart(\"yyyy\", tempDate)\n    tempDate = DateAdd(\"m\", 1, tempDate)    \n    i = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 57488549, "answer_count": 1, "score": 0, "last_activity_date": 1565760120, "creation_date": 1565759052, "last_edit_date": 1565759808, "question_id": 57488420, "link": "https://stackoverflow.com/questions/57488420/get-all-months-years-between-date-range-vba", "title": "Get All Months &amp; Years between Date Range VBA", "body": "<p>Example user input \u2018startdate\u2019 = July 2017, \u2018enddate\u2019 = March 2019. I\u2019ve been able to input it into filters by using <code>&gt;startdate</code> &amp; <code>&lt;enddate</code> but need the numbers to populate this way.</p>\n\n<p>How do I list all months and years between the 2 on a worksheet? </p>\n\n<pre><code>July 2017\nAugust 2017\nSeptember 2017\n...\nMarch 2019\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1565753595, "post_id": 57487835, "comment_id": 101446292, "body": "Is there any pattern to the differing dimensions? Otherwise your normal declarations are the most &quot;efficient&quot; way. Note that this may be an X-Y problem - what are you actually going to do with these arrays and why do you need 99?"}, {"owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565759024, "post_id": 57487835, "comment_id": 101447293, "body": "A part of my work require VBA now. Previously I worked with Matlab this is not a problem. However, it seems like in VBA everything need to be declare and it is causing frustration for me :( There is a hacking-alternative way is combine string on Excel then copy &amp; paste into VBA as a Dim in normal way. But that way to declare variables is kind of strange :/ when looking at the code"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565759257, "post_id": 57487835, "comment_id": 101447349, "body": "Can you explain why you need so many arrays though? What is the actual problem you are trying to solve?"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1565759494, "post_id": 57487835, "comment_id": 101447403, "body": "You can freely declare arrays in runtime. Google for the <code>Redim</code> command."}, {"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1565760197, "post_id": 57487835, "comment_id": 101447563, "body": "@BigBen&#39;s comments/questions are relevant. The &#39;why&#39; is important as just trying to recreate what Matlab does might not be the best way to implement in VBA. Fundamentally you&#39;re try to create an unevenly populated 3 key (assuming 99 may not be the limit) dataset ... I&#39;ve put some options down below."}], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": true, "score": 0, "last_activity_date": 1565760207, "creation_date": 1565760207, "answer_id": 57488565, "question_id": 57487835, "link": "https://stackoverflow.com/questions/57487835/declare-a-set-of-arrays-with-dynamic-dimension/57488565#57488565", "title": "Declare a set of arrays with dynamic dimension", "body": "<p>Maybe ...</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ArraysOfArrays()\n\n    ' Option #1 ... individual, explicit definitions\n    Dim X01(5, 6)\n    Dim X02(6, 3)\n    ' etc\n\n    ' Option 2 ... a three dimension array\n    Dim Y(99, 10, 10)\n    Y(0, 0, 0) = \"A\"\n    Y(1, 5, 6) = \"B\"\n    ' etc\n\n    ' Option 3 ... an array of different arrays\n    Dim Tmp\n    Dim Z(99)\n    ReDim Tmp(5, 6): Z(0) = Tmp\n    ReDim Tmp(6, 3): Z(1) = Tmp\n    ' etc\n\n    ' Option 4\n    ' ... create a table with three keys in some form of database\n\n    ' Option 5\n    ' ... use a worksheet, a dictionary or one of the myriad of other options  :)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11850322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf8ed7d5926c60e6eadd8c215aeb244?s=128&d=identicon&r=PG&f=1", "display_name": "PTQuoc", "link": "https://stackoverflow.com/users/11850322/ptquoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57488565, "answer_count": 1, "score": 0, "last_activity_date": 1565760207, "creation_date": 1565753512, "last_edit_date": 1565754858, "question_id": 57487835, "link": "https://stackoverflow.com/questions/57487835/declare-a-set-of-arrays-with-dynamic-dimension", "title": "Declare a set of arrays with dynamic dimension", "body": "<p>In VBA I would like to declare a set of arrays. Says X01, X02, .., X99\nEach with different dimensions</p>\n\n<p>I tried with Dim X(1 to 99). However, it seems difficult to set dimension for each later.</p>\n\n<p>Is there any efficiency way to declare arrays in this situation?\nExample:</p>\n\n<pre><code>X01: size (5,6)\nX02: size (2,3)\nX03: size (1,9)\netc\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": -1, "last_activity_date": 1565785063, "last_edit_date": 1565785063, "creation_date": 1565751787, "answer_id": 57487667, "question_id": 57487228, "link": "https://stackoverflow.com/questions/57487228/how-to-transpose-single-column-into-multiple-uneven-columns-rows-in-excel-using/57487667#57487667", "title": "How to transpose single column into multiple uneven columns/rows in Excel using VBA", "body": "<p>May try something like this. Original code was modified and organized to complete the task intended. It takes cares if the other parameters of the test result are not organised in sequence as shown, blank row in between the parameters, no blank row between test results and or missing parameters. It only considers parameters found between rows of two test titles (date time). Takes only 0.5 seconds to process 200 test results from more than 1 K rows. </p>\n\n<pre><code>Option Explicit\nSub Transpose()\nDim dDate As Date\nDim NumberofTasks As Long\nDim x As Long, LastRow As Long, Xval As Variant\nDim srcWs As Worksheet, trgWs As Worksheet\nDim tm As Double\ntm = Timer\nSet srcWs = ThisWorkbook.ActiveSheet\nSet trgWs = ThisWorkbook.Worksheets.Add\ntrgWs.Cells(1, 1).Value = \"Title\"\ntrgWs.Cells(2, 1).Value = \"Ounces:\"\ntrgWs.Cells(3, 1).Value = \"Concentration:\"\ntrgWs.Cells(4, 1).Value = \"Expiration Date:\"\ntrgWs.Cells(5, 1).Value = \"Other:\"\n\nWith srcWs\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    NumberofTasks = 0\n    x = 1\n    Do While x &lt;= LastRow\n    Xval = .Cells(x, 1).Value\n        If IsDate(Xval) Then\n        NumberofTasks = NumberofTasks + 1\n        trgWs.Cells(1, NumberofTasks + 1).Value = .Range(\"A\" &amp; x).Value\n        ElseIf VarType(Xval) = vbString And NumberofTasks &gt; 0 Then\n        Xval = Trim(LCase(Xval))\n           If InStr(1, Xval, \"ounces:\") &gt; 0 Then\n           trgWs.Cells(2, NumberofTasks + 1).Value = Trim(Replace(Xval, \"ounces:\", \"\"))\n           ElseIf InStr(1, Xval, \"concentration:\") &gt; 0 Then\n           trgWs.Cells(3, NumberofTasks + 1).Value = Trim(Replace(Xval, \"concentration:\", \"\"))\n           ElseIf InStr(1, Xval, \"expiration date:\")  &gt; 0 Then\n           trgWs.Cells(4, NumberofTasks + 1).Value = Trim(Replace(Xval, \"expiration date:\", \"\"))\n           ElseIf InStr(1, Xval, \"other:\")  &gt; 0 Then\n           trgWs.Cells(5, NumberofTasks + 1).Value = Trim(Replace(Xval, \"other:\", \"\"))\n           End If\n        End If\n    x = x + 1\n    Loop\nEnd With\n'Debug.Print \"Seconds \"; Timer - tm\nEnd Sub\n</code></pre>\n\n<p>Tested to produce the result like \n<a href=\"https://i.stack.imgur.com/VWbjY.png\" rel=\"nofollow noreferrer\">this</a></p>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": -1, "last_activity_date": 1565752206, "creation_date": 1565752206, "answer_id": 57487709, "question_id": 57487228, "link": "https://stackoverflow.com/questions/57487228/how-to-transpose-single-column-into-multiple-uneven-columns-rows-in-excel-using/57487709#57487709", "title": "How to transpose single column into multiple uneven columns/rows in Excel using VBA", "body": "<p><strong>I think here is better way to do it using <code>Range.Find</code></strong></p>\n\n<ul>\n<li>Assuming the Data is in 1st Column of <code>Sheet1</code> ie. Column <code>A</code></li>\n<li>In Demo the Expiration Date is not right, I have corrected that in the Code.</li>\n</ul>\n\n<p><strong>Try this  code:</strong></p>\n\n<pre><code>Sub TP()\n\nDim wk As Worksheet: Set wk = ThisWorkbook.Worksheets(\"Sheet1\")\nDim lr As Long: lr = wk.Cells(wk.Rows.Count, \"A\").End(xlUp).row\n\nDim rng As Range\nDim i As Long\nDim j As Long\nj = 4\nFor i = 3 To lr\n\n    Set rng = wk.Range(Cells(i, 1), Cells(i, 1).End(xlDown))\n        wk.Cells(2, j).Value = rng.Cells(1, 1).Value\n\n    Set fnd = rng.Find(\"Ounces\")\n        If Not fnd Is Nothing Then wk.Cells(3, j).Value = Split(fnd.Value, \":\")(1)\n        Set fnd = Nothing\n    Set fnd = rng.Find(\"Concentration\")\n        If Not fnd Is Nothing Then wk.Cells(4, j).Value = Split(fnd.Value, \":\")(1)\n        Set fnd = Nothing\n    Set fnd = rng.Find(\"Expiration\")\n        If Not fnd Is Nothing Then wk.Cells(5, j).Value = Right(fnd.Value, Len(fnd.Value) - Len(Split(fnd.Value, \":\")(0)) - 2)\n        Set fnd = Nothing\n    Set fnd = rng.Find(\"Other\")\n        If Not fnd Is Nothing Then wk.Cells(6, j).Value = Split(fnd.Value, \":\")(1)\n        Set fnd = Nothing\n\n    i = Cells(i, 1).End(xlDown).row + 1\n    j = j + 1\nNext\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/WbDyZ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WbDyZ.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1565755181, "creation_date": 1565755181, "answer_id": 57487996, "question_id": 57487228, "link": "https://stackoverflow.com/questions/57487228/how-to-transpose-single-column-into-multiple-uneven-columns-rows-in-excel-using/57487996#57487996", "title": "How to transpose single column into multiple uneven columns/rows in Excel using VBA", "body": "<p>There are many ways to skin a cat. Here is one way using arrays which is much much faster than looping through the range</p>\n\n<p><strong>Worksheet:</strong></p>\n\n<p>I am for the sake of coding, assuming that the data is in <code>Sheet1</code> and looks like below</p>\n\n<p><a href=\"https://i.stack.imgur.com/NoOSd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NoOSd.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Logic:</strong></p>\n\n<ol>\n<li>Store the data from the worksheet in an array; Let's call it <code>InputArray</code></li>\n<li>Create an output array for storing data; Let's call it <code>OutputArray</code></li>\n<li>Loop through <code>InputArray</code> and find the date and then find the rest of the records. store in <code>OutputArray</code></li>\n<li>direct the output from <code>OutputArray</code> to the relevant worksheet.</li>\n</ol>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim InputArray As Variant\n    Dim ws As Worksheet\n    Dim i As Long\n    Dim recCount As Long\n    Dim lRow As Long\n    Dim OutputArray() As String\n\n    '~~&gt; Set relevant input sheet\n    Set ws = Sheet1\n\n    With ws\n        '~~&gt; Find Last Row in Col A\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Store col A in array\n        InputArray = .Range(\"A1:A\" &amp; lRow).Value\n\n        '~~&gt; Find Total number of records\n        For i = LBound(InputArray) To UBound(InputArray)\n            If IsDate(InputArray(i, 1)) Then recCount = recCount + 1\n        Next i\n\n        '~~&gt; Create an array for output\n        ReDim OutputArray(1 To 5, 1 To recCount + 1)\n\n        recCount = 2\n\n        '~~&gt; Fill Col A of output array\n        OutputArray(1, 1) = \"Title\"\n        OutputArray(2, 1) = \"Ounces\"\n        OutputArray(3, 1) = \"Concentration\"\n        OutputArray(4, 1) = \"Expiration Date\"\n        OutputArray(5, 1) = \"Other\"\n\n        '~~&gt; Loop through input array\n        For i = UBound(InputArray) To LBound(InputArray) Step -1\n            If IsDate(InputArray(i, 1)) Then '&lt; Check if date\n                OutputArray(1, recCount) = InputArray(i, 1)\n\n                '~~&gt; Check for Ounces and store in array\n                If i + 1 &lt; UBound(InputArray) + 1 Then _\n                If UCase(Left(Trim(InputArray(i + 1, 1)), 2)) = \"OU\" _\n                Then OutputArray(2, recCount) = Trim(Replace(InputArray(i + 1, 1), \"Ounces:\", \"\"))\n\n                '~~&gt; Check for Concentration and store in array\n                If i + 2 &lt; UBound(InputArray) + 1 Then _\n                If UCase(Left(Trim(InputArray(i + 2, 1)), 2)) = \"CO\" _\n                Then OutputArray(3, recCount) = Trim(Replace(InputArray(i + 2, 1), \"Concentration:\", \"\"))\n\n                '~~&gt; Check for Expiration Date and store in array\n                If i + 3 &lt; UBound(InputArray) + 1 Then _\n                If UCase(Left(Trim(InputArray(i + 3, 1)), 2)) = \"EX\" _\n                Then OutputArray(4, recCount) = Trim(Replace(InputArray(i + 3, 1), \"Expiration Date:\", \"\"))\n\n                '~~&gt; Check for Other and store in array\n                If i + 4 &lt; UBound(InputArray) + 1 Then _\n                If UCase(Left(Trim(InputArray(i + 4, 1)), 2)) = \"OT\" _\n                Then OutputArray(5, recCount) = Trim(Replace(InputArray(i + 4, 1), \"Other:\", \"\"))\n\n                recCount = recCount + 1\n            End If\n        Next i\n    End With\n\n    '~~&gt; Output it to relevant sheet\n    Sheet2.Range(\"A1\").Resize(5, recCount - 1).Value = OutputArray\nEnd Sub\n</code></pre>\n\n<p><strong>Output:</strong>\n<a href=\"https://i.stack.imgur.com/CsH7H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CsH7H.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11924931, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UlQ4e9Z5nYg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re8cNDoM7CXnATlA35QnSUjGmqoqw/photo.jpg?sz=128", "display_name": "Lauren Paulson", "link": "https://stackoverflow.com/users/11924931/lauren-paulson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1565785063, "creation_date": 1565747403, "last_edit_date": 1565750441, "question_id": 57487228, "link": "https://stackoverflow.com/questions/57487228/how-to-transpose-single-column-into-multiple-uneven-columns-rows-in-excel-using", "title": "How to transpose single column into multiple uneven columns/rows in Excel using VBA", "body": "<p>I have different test dates and times that can be up to about 100 tests each time point. I received the data that was only a single column that consists of thousands of rows, which should have been delivered in a matrix type grid. </p>\n\n<p>I have only copied a sample, which has 6 time points and up to 4 tests each. I need Excel to \"recognize\" when there is only a date/time in a cell, then copy that cell to the next date/time to paste in a new sheet and column. </p>\n\n<p>Eventually, I was hoping to also have the Title of the test separated from the results. However, if this is not plausible without knowing the name of every test, I can skip it. This is the data I start with:</p>\n\n<pre><code>Title\n\n01/02/2010 0:03\nOunces: 10.87\nConcentration: 6.89 (L)\nExpiration Date: 11/2/2019  5:47:00\n\n01/06/2011 2:06\nOunces: 18.09\nConcentration: 10.7 (H)\nExpiration Date: 11/2/2019  5:47:00\nOther: Resampled\n\n01/06/2011 2:06\nOunces: 12.87\nConcentration: 10.9 (H)\nExpiration Date: 11/2/2019  5:47:00\nOther: 2nd Sample\n\n09/15/2012 7:07\nOunces: 8.53\nConcentration: 9.72\nExpiration Date: 12/5/2019  4:45:00\n\n05/02/2013 15:52\nOunces: 11.62\nConcentration: 8.42\n\n05/09/2017 1:45\nOunces: 9.34\nConcentration: 8.98\n</code></pre>\n\n<p>I created the following Excel VBA, but am still new at programming, especially loops within loops, so I could not figure out how to create the offset that is dynamic enough to both select the right cells, but to copy them over to a new column. I also have redundancy within the code. </p>\n\n<pre><code>Sub Transpose()\n\n    Dim dDate As Date\n    Dim NumberofTasks As Long\n    Dim x As Long\n\n    sSheet = ActiveSheet.Name\n    Sheets.Add\n    dSheet = ActiveSheet.Name\n\n    With Worksheets(\"Sheet1\")\n        ' All Data is in Column A\n        NumberofTasks = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For x = 1 To NumberofTasks\n            Sheets(sSheet).Activate\n            If IsDate(.Range(\"A\" &amp; x).Value) Then '&lt;-- check if current cell at Column A is Date\n                Range(Cells(x, 1), Cells(x, 1).Offset(4, 0)).Select\n                Selection.Copy\n                Sheets(dSheet).Activate\n                Selection.PasteSpecial Paste:=xlAll, Operation:=xlNone, SkipBlanks:=False _\n                , Transpose:=True\n                ActiveCell.Offset(1, 0).Select\n            End If\n        Next x\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This is what I hoped would happen (but on a much larger scale):\n<a href=\"https://i.stack.imgur.com/NACvQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NACvQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, the offset places another date in another cell with the current code. Thank you for any help you can provide me. </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1565743918, "post_id": 57486863, "comment_id": 101444639, "body": "Have you tried a format string like <code>mm&#47;dd&#47;yyyy</code> instead of <code>mm\\&#47;dd\\&#47;yyyy</code>? Also, assuming <code>Username</code> is a <code>String</code> - include single quotes like this: <code>[User] = &#39;&quot; &amp; Me.username_textbox.Value &amp; &quot;&#39;&quot;</code> - Also, it is a bad idea to use a field name like <code>Date</code> since it is also a reserved word. (but it will work)"}, {"owner": {"reputation": 51, "user_id": 11612083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/533d1b073fa63ddb75cf23e1e490b363?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Duarte", "link": "https://stackoverflow.com/users/11612083/diego-duarte"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1565745670, "post_id": 57486863, "comment_id": 101444930, "body": "Hi braX, thanks a lot for your answer, indeed, the single quotes were missing, have a great day !"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1565746370, "creation_date": 1565746370, "answer_id": 57487118, "question_id": 57486863, "link": "https://stackoverflow.com/questions/57486863/filter-subform-based-on-multiple-criteria/57487118#57487118", "title": "Filter SubForm based on multiple criteria", "body": "<p>Assuming the field [User] is a String - include single quotes like this: </p>\n\n<pre><code>[User] = '\" &amp; Me.username_textbox.Value &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11612083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/533d1b073fa63ddb75cf23e1e490b363?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Duarte", "link": "https://stackoverflow.com/users/11612083/diego-duarte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57487118, "answer_count": 1, "score": 0, "last_activity_date": 1565746370, "creation_date": 1565743249, "question_id": 57486863, "link": "https://stackoverflow.com/questions/57486863/filter-subform-based-on-multiple-criteria", "title": "Filter SubForm based on multiple criteria", "body": "<p>I have a Form with a SubForm, i'm trying to filter based on a range of two dates and an Username (i take the criteria from 3 textboxes), the part of the dates works fine but when i press the button to start the filter, a pop-up shows saying \"Enter parameter value\" (even if i type the username in the textbox), i enter an username and filters correctly, but the parameter its kept and the filter won't work anymore, until i close the Form and open again, any ideas?</p>\n\n<p>I don't know why ask me to enter a parameter if i have already the username in the textbox.</p>\n\n<p>Here my code:</p>\n\n<pre><code>Private Sub Filter_Click()\n\n    Dim QIL As Form\n    Set QIL = Forms(\"QIL\")\n\nIf IsNull(Me.username_textbox) Or IsNull(Me.date_from_textbox) Or IsNull(Me.date_to_textbox) Then\n    MsgBox \"Insert date or username\"\nElse\n    With Me.Superlinks_subform.Form\n        .Filter = \"[Date] = #\" &amp; Format(Me.date_from_textbox, \"mm\\/dd\\/yyyy\") &amp; _\n     \"# AND #\" &amp; Format(Me.date_to_textbox, \"mm\\/dd\\/yyyy\") &amp; \"# AND [User] = \" &amp; Me.username_textbox.Value &amp; \"\"\n        .FilterOn = True\n    End With\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>Regards</p>\n\n<p>Diego.</p>\n"}]