[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 1, "creation_date": 1423699068, "post_id": 28466836, "comment_id": 45259362, "body": "Is the error generated on the line you&#39;ve given? Have you tried using a simple formula first (such as <code>&quot;=2+2&quot;</code>, then building it up?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1423699312, "post_id": 28466836, "comment_id": 45259447, "body": "I think you&#39;ve kinda mixed things up between <code>R1C1</code> and <code>A1</code> notation when you construct your formula. If you use <code>R1C1</code> notation, it should be consistent throughout the formula."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4557061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21601d8a1115d4f909961346c20dbac9?s=128&d=identicon&r=PG&f=1", "display_name": "Inderbitzen", "link": "https://stackoverflow.com/users/4557061/inderbitzen"}, "edited": false, "score": 0, "creation_date": 1423766834, "post_id": 28467066, "comment_id": 45292538, "body": "Thanks for the response.  This code didn&#39;t throw an error but what happened was the vlookup range was applied to &quot;A1:D&quot; &amp; tlrow of the active worksheet instead of being applied to the equivalent range in the workbook &quot;temp.xlsx&quot;.  Do you know how I would get around this?  Thanks!"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 11, "user_id": 4557061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21601d8a1115d4f909961346c20dbac9?s=128&d=identicon&r=PG&f=1", "display_name": "Inderbitzen", "link": "https://stackoverflow.com/users/4557061/inderbitzen"}, "edited": false, "score": 0, "creation_date": 1423778524, "post_id": 28467066, "comment_id": 45298927, "body": "@Inderbitzen Ah I assumed you have correctly referenced the sheet you are working on, in this case <code>Worksheets(i)</code>. What you did in your posted answer is the right thing to do. Good job for sorting it out."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1423700750, "last_edit_date": 1423700750, "creation_date": 1423699794, "answer_id": 28467066, "question_id": 28466836, "link": "https://stackoverflow.com/questions/28466836/run-time-error-1004-when-applying-formula-to-range-formular1c1-in-vba/28467066#28467066", "title": "Run-time error &#39;1004&#39; when applying formula to Range.FormulaR1C1 in VBA", "body": "<p>Try using this:</p>\n\n<pre><code>Range(\"B15:B\" &amp; lrow).FormulaR1C1 = _\n    \"=IF(OR(RC1=\"\"\"\",RC5=\"\"\"\"),\"\"\"\",IF(ISERROR(VLOOKUP(RC1,\" &amp; _\n    Worksheets(i).Range(\"A1:D\" &amp; lrow).Address(ReferenceStyle:=xlR1C1, External:=True) &amp; _\n    \",3,FALSE)),\"\"0\"\",VLOOKUP(RC1,\" &amp; _\n    Worksheets(i)..Range(\"A1:D\" &amp; tlrow).Address(ReferenceStyle:=xlR1C1, External:=True) &amp; _\n    \",3,FALSE)))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1423701097, "creation_date": 1423701097, "answer_id": 28467236, "question_id": 28466836, "link": "https://stackoverflow.com/questions/28466836/run-time-error-1004-when-applying-formula-to-range-formular1c1-in-vba/28467236#28467236", "title": "Run-time error &#39;1004&#39; when applying formula to Range.FormulaR1C1 in VBA", "body": "<p>What version of Excel are you running? In more recent versions you can use the Iferror function in this formula to really chop down the size.</p>\n\n<p>It would be something like this:</p>\n\n<pre><code>Range(\"B15:B\" &amp; lrow).FormulaR1C1 = _\n\"=IF(OR(RC1=\"\"\"\",RC5=\"\"\"\"),\"\"\"\",IFERROR(VLOOKUP(RC1,\" &amp; \" &amp; Worksheets(i).Range(\"A1:D\" &amp; _\ntlrow).Address(ReferenceStyle:=xlR1C1, External:=True) &amp; \",3,0),\"\"0\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4557061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21601d8a1115d4f909961346c20dbac9?s=128&d=identicon&r=PG&f=1", "display_name": "Inderbitzen", "link": "https://stackoverflow.com/users/4557061/inderbitzen"}, "is_accepted": false, "score": 0, "last_activity_date": 1423771600, "creation_date": 1423771600, "answer_id": 28486798, "question_id": 28466836, "link": "https://stackoverflow.com/questions/28466836/run-time-error-1004-when-applying-formula-to-range-formular1c1-in-vba/28486798#28486798", "title": "Run-time error &#39;1004&#39; when applying formula to Range.FormulaR1C1 in VBA", "body": "<p>Thanks for your help.  I was able to resolve the problem by defining my vlookup range in a Range variable and then inputting the variable name in L42's equation in place of </p>\n\n<pre><code> worksheets(i).Range(\"A1:D\" &amp; lrow)\n</code></pre>\n\n<p>Really apprecaite the responses! Thanks again.</p>\n"}], "owner": {"reputation": 11, "user_id": 4557061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21601d8a1115d4f909961346c20dbac9?s=128&d=identicon&r=PG&f=1", "display_name": "Inderbitzen", "link": "https://stackoverflow.com/users/4557061/inderbitzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3134, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1423771600, "creation_date": 1423698555, "last_edit_date": 1423699226, "question_id": 28466836, "link": "https://stackoverflow.com/questions/28466836/run-time-error-1004-when-applying-formula-to-range-formular1c1-in-vba", "title": "Run-time error &#39;1004&#39; when applying formula to Range.FormulaR1C1 in VBA", "body": "<p>I'm trying to apply a big nested formula to a range using the code below.  Basically, if the value in cell A of the active row exists in the column A of another workbook and if the cell in column E of the active row is not empty, I want the active cell to display the cells to display the value of the equivalent cell in a separate workbook.  </p>\n\n<p>This needs to be applied to several worksheets so I'm using the variables <code>lrow</code> (which is an <code>int</code> with the last row of the active worksheet in workbook#1) and <code>tlrow</code> (which is an <code>int</code> equal to the last row of the active worksheet in workbook#2). When I step through the sub, these variables both return the numbers I would expect them to.</p>\n\n<p>Likewise, this is inside of a for loop so I also use <code>Worksheets(i).Name</code> where <code>I</code> is an <code>int</code>.</p>\n\n<p>When I run the code, I get the run-time error \"'1004': Application-defined or object-defined error\".  </p>\n\n<p>I'm assuming it's a syntax issue.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Range(\"B15:B\" &amp; lrow).FormulaR1C1 = _\n    \"=IF(OR(RC1=\"\"\"\",RC5=\"\"\"\"),\"\"\"\",IF(ISERROR(VLOOKUP(RC1,'[temp.xlsx]\" &amp; _\n    Worksheets(i).Name &amp; _\n    \"'!A15:D\" &amp; tlrow &amp; \",3,FALSE)),\"\"0\"\",VLOOKUP(RC1,'[temp.xlsx]\" &amp; _\n    Worksheets(i).Name &amp; \"'!A15:D\" &amp; tlrow &amp; \",3,FALSE))))\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "is_accepted": false, "score": 3, "last_activity_date": 1423781095, "last_edit_date": 1423781095, "creation_date": 1423718841, "answer_id": 28469969, "question_id": 28466595, "link": "https://stackoverflow.com/questions/28466595/excel-vba-pull-data-from-external-books-and-paste-into-the-next-blank-row-in-m/28469969#28469969", "title": "Excel VBA - Pull data from external books and paste into the next blank row in multiple tabs", "body": "<p>Where are you getting stuck? Briefly:</p>\n\n<blockquote>\n  <p>Open Active Book</p>\n</blockquote>\n\n<p>If its active, it's already open? Reference with object 'ThisWorkbook'</p>\n\n<blockquote>\n  <p>Open hidden tab 'Sheet1'</p>\n</blockquote>\n\n<p>You don't need to unhide sheets to \"VBA\" them... If you're going to be creating new sheets for each datafile I'd recommend creating new via:</p>\n\n<pre><code>Set wsDestination = thisworkbook.sheets.add\nwsDestination.visible = xlSheetHidden ' Might as well hide it now\n</code></pre>\n\n<p>If you're wanting to match specific raw data files with specific worksheets, maybe use a \"select\"</p>\n\n<blockquote>\n  <p>Open raw data book 1(e.g. c:\\Raw Data.xls)</p>\n</blockquote>\n\n<pre><code>Set wbSource = Application.Workbooks.Open(\"c:\\Raw Data.xls\")\nSet wsSource = wbSource.sheets(1)\n\n'If need Select (see above):\nSelect case wbSource.name\n    Case \"Raw Data A.xls\" ' If line above changes to .Open(Workbooks[i]) or something\n        set wsDestination = sheet1\n    Case \"Raw Data B.xls\"\n        set wsDestination = sheet2\n    '...\nEnd Select\n</code></pre>\n\n<blockquote>\n  <p>Copy data from specified location (e.g. [Raw\n  Data.xls]Sheet1!$A$3:$AE$64) in the raw data book 1 Paste copied data\n  into Active Book, into specific worksheet, into first empty row (e.g.\n  [Active Book.xls]Sheet1!first empty row)</p>\n</blockquote>\n\n<pre><code>intBlankRow = Application.WorksheetFunction.Counta(wsDestination.columns(1)) + 1 ' Note this only works if there are no blanks in column 1 otherwise you'll need another method: there are some good tricks if you google \"find last cell vba\"\nwsSource.cells.copy wsDestination.cells(intBlankRow,1) ' No need to copy and paste in seperate lines: you can just pass destination to the copy function\n</code></pre>\n\n<blockquote>\n  <p>Hide tab 'Sheet1' in Active Book</p>\n</blockquote>\n\n<p>You don't need to</p>\n\n<blockquote>\n  <p>Close raw data book 1</p>\n</blockquote>\n\n<p>wbSource.close</p>\n\n<blockquote>\n  <p>Repeat process using raw data book 2 and sheet2 of Active Book Repeat\n  process using raw data book 3 and sheet3 of Active Book Only after\n  data is populated into the destination tabs (Sheet1, Sheet2, Sheet3 in\n  the Active Book), can the user interact (click into cells, change\n  tabs, etc) with the workbook</p>\n</blockquote>\n\n<p>Wrap the whole thing in a big loop... If you wanna do it the easy way, create an array with your workbook names and iterate through it. Otherwise present the user with a FileDialogue so they can select the workbooks they want to import... this ofcourse depends on what I was saying above: do you want to create new worksheets each time or import specific raw data in to specific sheets...</p>\n"}], "owner": {"reputation": 1, "user_id": 4556982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301d261875d01997d30d92f617d24087?s=128&d=identicon&r=PG&f=1", "display_name": "exiteverything", "link": "https://stackoverflow.com/users/4556982/exiteverything"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1423781095, "creation_date": 1423697265, "question_id": 28466595, "link": "https://stackoverflow.com/questions/28466595/excel-vba-pull-data-from-external-books-and-paste-into-the-next-blank-row-in-m", "title": "Excel VBA - Pull data from external books and paste into the next blank row in multiple tabs", "body": "<p>I'm working on automating a workbook in Excel, and I'm running into a few issues with my VBA code. I'd paste it here, but I've been through so many iterations, it's pretty unusable. </p>\n\n<p>The goal is to have the active book 'grab' the data out of several workbooks containing raw data when it is opened, and put the copied data into a few tabs that can be used to populate various charts on a dashboard tab. Each workbook containing raw data should go into its own separate tab within the active workbook. Broken into steps, I am thinking I need the below process to occur:</p>\n\n<ul>\n<li>Open Active Book</li>\n<li>Open hidden tab 'Sheet1'</li>\n<li>Open raw data book 1(e.g. c:\\Raw Data.xls)</li>\n<li>Copy data from specified location (e.g. [Raw Data.xls]Sheet1!$A$3:$AE$64) in the raw data book 1</li>\n<li>Paste copied data into Active Book, into specific worksheet, into first empty row (e.g. [Active Book.xls]Sheet1!<strong>first empty row</strong>)</li>\n<li>Hide tab 'Sheet1' in Active Book</li>\n<li>Close raw data book 1</li>\n<li>Repeat process using raw data book 2 and sheet2 of Active Book</li>\n<li>Repeat process using raw data book 3 and sheet3 of Active Book</li>\n<li>Only after data is populated into the destination tabs (Sheet1, Sheet2, Sheet3 in the Active Book), can the user interact (click into cells, change tabs, etc) with the workbook</li>\n</ul>\n\n<p>I know this is simple - I'm getting frustrated, as I'm a newbie and the syntax (and multiple variations of syntax) is really throwing me for a loop. Any help would be greatly appreciated. Many thanks in advance!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 5, "creation_date": 1423697465, "post_id": 28466561, "comment_id": 45258796, "body": "It should be<code>Worksheets</code>, not <code>worksheet</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1423702747, "last_edit_date": 1423702747, "creation_date": 1423698958, "answer_id": 28466930, "question_id": 28466561, "link": "https://stackoverflow.com/questions/28466561/sub-or-function-not-defined-vba/28466930#28466930", "title": "&quot;Sub or Function not defined&quot; vba", "body": "<p><code>With Worksheet(SheetName)</code> should be <code>With Worksheets(SheetName)</code></p>\n\n<p>Also change <code>Row As Integer</code> to <code>Row as Long</code>, <code>Integer</code> is actually marginally slower in <code>VBA</code> as the compiler converts it to a Long for processing. </p>\n"}], "owner": {"reputation": 1, "user_id": 4556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f86f692e7de246aca1f76ed37bae98?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4556960/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423702747, "creation_date": 1423697133, "last_edit_date": 1423698079, "question_id": 28466561, "link": "https://stackoverflow.com/questions/28466561/sub-or-function-not-defined-vba", "title": "&quot;Sub or Function not defined&quot; vba", "body": "<p>VBA novice here</p>\n\n<p>When I run my code I receive the error \"Sub or Function not defined\". This occurs in one of my subroutines. The first line is highlighted in yellow by the debugger. </p>\n\n<pre><code>Sub Description(Row As Integer, SheetName As String)\n\nWith Worksheet(SheetName)\n\n.Cells(Row, 1) = ActiveCell.Offset(0, -3)   \n.Cells(Row, 2) = ActiveCell.Offset(0, -2)   \n.Cells(Row, 3) = ActiveCell.Offset(0, -1)\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This subroutine takes in a number and a string. I want to copy specific descriptions into into another worksheet \"SheetName\". Here is a piece of the code prior to the subroutine call. The value of \"x\" is declared outside the loops scope.</p>\n\n<pre><code>string_temp = \"Sheet2\"\nActiveSheet.Cells(i, 5).Select\nCall Description(x, string_temp)\nx= x + 1\n</code></pre>\n\n<p>Appreciate the help!</p>\n"}, {"tags": ["excel", "drop-down-menu", "keyboard-shortcuts", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423694736, "post_id": 28465853, "comment_id": 45257699, "body": "What kind of drop-down? Data validation, forms or ActiveX ?"}, {"owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423696890, "post_id": 28465853, "comment_id": 45258588, "body": "@TimWilliams, Data Validation"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423856917, "post_id": 28465853, "comment_id": 45334167, "body": "<a href=\"http://www.contextures.com/xlDataVal10.html\" rel=\"nofollow noreferrer\">contextures.com/xlDataVal10.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "edited": false, "score": 0, "creation_date": 1423754338, "post_id": 28468273, "comment_id": 45284544, "body": "Thanks for the input @teylyn but what I really want is to start typing the employees name and have the list jump to matching entries. The employee list is extensive so I don&#39;t want to have to manually navigate it."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1433452188, "last_edit_date": 1433452188, "creation_date": 1423708255, "answer_id": 28468273, "question_id": 28465853, "link": "https://stackoverflow.com/questions/28465853/navigate-excel-drop-down-list-via-keyboard/28468273#28468273", "title": "Navigate Excel Drop-Down List via Keyboard", "body": "<p>Alt + down_arrow to open the data validation drop down.</p>\n\n<p>Then down-arrow / up_arrow or page_down / page_up to navigate the drop down choices.</p>\n\n<p>Enter to select the highlighted option.</p>\n\n<p>That's how it works for me with Excel 2010 and 2013. Have not tested other versions.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "is_accepted": true, "score": 0, "last_activity_date": 1423954804, "creation_date": 1423954804, "answer_id": 28521258, "question_id": 28465853, "link": "https://stackoverflow.com/questions/28465853/navigate-excel-drop-down-list-via-keyboard/28521258#28521258", "title": "Navigate Excel Drop-Down List via Keyboard", "body": "<p>From @TimWilliams:  <a href=\"http://www.contextures.com/xlDataVal10.html\" rel=\"nofollow\">http://www.contextures.com/xlDataVal10.html</a></p>\n\n<p>Turns out Data Validation doesn't have an AutoComplete feature.</p>\n\n<p>See <a href=\"http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/Excel/A_12362-The-magical-floating-ActiveX-control.html\" rel=\"nofollow\">The magical floating ActiveX control</a> for a workaround.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9482732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/989b51ee28e508164e3454de926fec0d?s=128&d=identicon&r=PG&f=1", "display_name": "user9482732", "link": "https://stackoverflow.com/users/9482732/user9482732"}, "is_accepted": false, "score": 1, "last_activity_date": 1526080947, "creation_date": 1526080947, "answer_id": 50301433, "question_id": 28465853, "link": "https://stackoverflow.com/questions/28465853/navigate-excel-drop-down-list-via-keyboard/50301433#50301433", "title": "Navigate Excel Drop-Down List via Keyboard", "body": "<p><em>Someone suggested this simple workaround on another thread, which I put to use and it's great.  Depending on where you're placing your drop-downs, it may be too messy for your worksheet, but worth a try.</em> </p>\n\n<p>You know how Excel will auto-complete if you've already typed the word in a cell above?   You can put that feature to use by doing this:  Pretend you have 100 employees and you'll be drawing from those names in drop-down boxes in columns C and D.    At line 1, insert 100 lines.  Drop your employee names into columns C and D.   Then hide those lines.   (Your top row under the header will now be line 101.)   Now when you start typing a name in Column C or D, auto-complete will go to work. :) </p>\n\n<p><strong>If you have the header row \"frozen\":</strong>  I found this to create a problem, so I had to unfreeze the top row first.   Don't forget to freeze your top row after hiding your lines.    </p>\n\n<p><strong>Hiding Lines</strong>  Path is:   Home-> <strong>Format</strong>-> Hide and Unhide -> Hide Rows.</p>\n\n<p><strong>Do not use:</strong>   Home-> View-> Hide, as this hides the entire window. </p>\n"}], "owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5691, "favorite_count": 0, "accepted_answer_id": 28521258, "answer_count": 3, "score": 1, "last_activity_date": 1526080947, "creation_date": 1423694003, "last_edit_date": 1531164843, "question_id": 28465853, "link": "https://stackoverflow.com/questions/28465853/navigate-excel-drop-down-list-via-keyboard", "title": "Navigate Excel Drop-Down List via Keyboard", "body": "<p>I've created a List of employees and applied a drop-down menu to a number of cells.</p>\n\n<p>I've already found the helpful <kbd>Alt</kbd>+<kbd>Down</kbd> arrow tip to allow me to enter the drop-down via the keyboard.</p>\n\n<p>However, I don't seem to be able to select an entry from the list via the keyboard.</p>\n\n<p>i.e. I'd like to be able to start typing an employee's name to select from the list, as opposed to navigating the list with the mouse and select the appropriate employee.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 432, "user_id": 661617, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b690c0b1fda5b942bec6e97906e406?s=128&d=identicon&r=PG", "display_name": "jamesC", "link": "https://stackoverflow.com/users/661617/jamesc"}, "edited": false, "score": 0, "creation_date": 1423689775, "post_id": 28464376, "comment_id": 45255173, "body": "have you tried ActiveSheet.EnableCalculation = True or are you thinking more like or Pivot.RefreshTable?"}, {"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 1, "creation_date": 1423690302, "post_id": 28464376, "comment_id": 45255447, "body": "Can you just write the sort to a macro and then call the macro whenever you add data from the userform? Is everything you are doing contained within one workbook?"}, {"owner": {"reputation": 11, "user_id": 4556535, "user_type": "registered", "profile_image": "https://graph.facebook.com/608229209308850/picture?type=large", "display_name": "Tayloryouno", "link": "https://stackoverflow.com/users/4556535/tayloryouno"}, "edited": false, "score": 0, "creation_date": 1423690390, "post_id": 28464376, "comment_id": 45255494, "body": "I&#39;m not sure what either of those mean, but the first one looks like it requires the sheet to be active for it to update instead of just a automated response. I found this, it only updates one row in the sheet for a single table, but it does it without any extra interaction: <code>Sub Worksheet_Change(ByVal Target As Range)     On Error Resume Next     If Not Intersect(Target, Range(&quot;A:A&quot;)) Is Nothing Then         Range(&quot;A8&quot;).Sort Key1:=Range(&quot;A9&quot;), _           Order1:=xlAscending, Header:=xlYes,            OrderCustom:=1, MatchCase:=False,            Orientation:=xlTopToBottom     End If End Sub</code>"}, {"owner": {"reputation": 11, "user_id": 4556535, "user_type": "registered", "profile_image": "https://graph.facebook.com/608229209308850/picture?type=large", "display_name": "Tayloryouno", "link": "https://stackoverflow.com/users/4556535/tayloryouno"}, "edited": false, "score": 0, "creation_date": 1423690481, "post_id": 28464376, "comment_id": 45255538, "body": "everything is in one workbook so far, yes. the problem is i don&#39;t exactly know how to write said macro yet."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1423693905, "last_edit_date": 1423693905, "creation_date": 1423693516, "answer_id": 28465738, "question_id": 28464376, "link": "https://stackoverflow.com/questions/28464376/automatically-sort-multiple-tables-in-a-sheet-upon-change/28465738#28465738", "title": "Automatically sort multiple tables in a sheet upon change", "body": "<p>You can either take on D_Zab's advise or try below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo halt\n    Application.EnableEvents = False\n    Dim tbl As ListObject\n    For Each tbl In Me.ListObjects\n        If Not Intersect(Target, Me.Range(tbl.Name)) Is Nothing Then\n            MsgBox \"Table Updated\"\n            SortTables Me 'call the sort table routine\n        End If\n    Next\nmoveon:\n    Application.EnableEvents = True\n    Exit Sub\nhalt:\n    MsgBox Err.Description\n    Resume moveon\nEnd Sub\n</code></pre>\n\n<p>So above detects any changes made in any table in the sheet you put the event.<br> Now, all you have to do is to create a sub that sorts all the tables and call it.<br> A sample code (which is actually what you have) is below.</p>\n\n<pre><code>Private Sub SortTables(sh As Worksheet)\n    Dim tbl As ListObject\n    Dim SortCol As Long\n\n    Application.ScreenUpdating = False\n    For Each tbl In sh.ListObjects\n        If tbl.Name = \"TableSORT2\" Then\n            SortCol = 2\n        Else\n            SortCol = 1\n        End If\n        With tbl.Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=tbl.DataBodyRange.Columns(SortCol), _\n                SortOn:=xlSortOnValues, Order:=xlAscending\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    Next tbl\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Is this what you're trying? Btw, for some reason, this also detects changes made from <code>UserForms</code>. Even a simple line like <code>Range(\"A2\").Value = \"something\"</code> is detected so long as the target range is within the <code>Table Range</code>. Moreover, this also detects the addition of data to tables when it auto-resize. HTH.</p>\n"}], "owner": {"reputation": 11, "user_id": 4556535, "user_type": "registered", "profile_image": "https://graph.facebook.com/608229209308850/picture?type=large", "display_name": "Tayloryouno", "link": "https://stackoverflow.com/users/4556535/tayloryouno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423696479, "creation_date": 1423688311, "last_edit_date": 1423696479, "question_id": 28464376, "link": "https://stackoverflow.com/questions/28464376/automatically-sort-multiple-tables-in-a-sheet-upon-change", "title": "Automatically sort multiple tables in a sheet upon change", "body": "<p>I'm only about three weeks into learning how to use Excel, and I have it so that all of the tables on my worksheet will sort, but not when there's a change, only when I actually visit the worksheet. </p>\n\n<p>So if I input data from another source like a <code>UserForm</code>, it won't sort the tables again until I go back to the worksheet. Is there a way to automatically sort them so the extra visit isn't needed?</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n  Dim tbl As ListObject\n  Dim SortCol As Long\n\n  Application.ScreenUpdating = False\n  For Each tbl In ActiveSheet.ListObjects\n    If tbl.Name = \"TableSORT2\" Then\n      SortCol = 2\n    Else\n      SortCol = 1\n    End If\n    With tbl.Sort\n      .SortFields.Clear\n      .SortFields.Add Key:=tbl.DataBodyRange.Columns(SortCol), _\n        SortOn:=xlSortOnValues, Order:=xlAscending\n      .Header = xlYes\n      .MatchCase = False\n      .Orientation = xlTopToBottom\n      .SortMethod = xlPinYin\n      .Apply\n    End With\n  Next tbl\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I tried changing <code>Private Sub Worksheet_Activate()</code> to <code>Private Sub Worksheet_Change()</code> but to no avail, I'm assuming because there's more references or integration needed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 2, "creation_date": 1423688549, "post_id": 28464362, "comment_id": 45254546, "body": "Do you mean to loop over every odd row in <code>RngList</code> or to use <code>RngList</code> to create a new range containing every odd row in <code>RngList</code>?"}, {"owner": {"reputation": 37, "user_id": 4437300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/574f3c7a870cadbe13ba64da25f568ce?s=128&d=identicon&r=PG&f=1", "display_name": "Xi Wang", "link": "https://stackoverflow.com/users/4437300/xi-wang"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1423688841, "post_id": 28464362, "comment_id": 45254672, "body": "Sorry for my unclear comment, I need every odd row in range &quot;RngList&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4437300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/574f3c7a870cadbe13ba64da25f568ce?s=128&d=identicon&r=PG&f=1", "display_name": "Xi Wang", "link": "https://stackoverflow.com/users/4437300/xi-wang"}, "edited": false, "score": 0, "creation_date": 1423749076, "post_id": 28466390, "comment_id": 45280823, "body": "I have error in line :         Set ch = .Shapes.AddChart2(, xlLine).Chart"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 37, "user_id": 4437300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/574f3c7a870cadbe13ba64da25f568ce?s=128&d=identicon&r=PG&f=1", "display_name": "Xi Wang", "link": "https://stackoverflow.com/users/4437300/xi-wang"}, "edited": false, "score": 0, "creation_date": 1423778375, "post_id": 28466390, "comment_id": 45298847, "body": "@XiWang I think it has something to do with the version of Excel. I did it using XL2013. So <code>AddChart2</code> property might not be available in lower versions. Try <code>AddChart</code> only. But you need to check the arguments if they are the same."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1423696371, "creation_date": 1423696371, "answer_id": 28466390, "question_id": 28464362, "link": "https://stackoverflow.com/questions/28464362/get-odd-rows-in-a-range-using-vba/28466390#28466390", "title": "Get odd rows in a range using VBA", "body": "<p>Try this out which worked for me.</p>\n\n<pre><code>Sub marine()\n    Dim sh As Worksheet: Set sh = ActiveSheet\n    Dim lr As Long, RngList As Range, rng As Range\n    With sh\n        lr = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row - 2\n        Set RngList = .Range(\"C2:C\" &amp; lr)\n        Set rng = RngList(1).Resize(, 19) 'resize until Column U\n\n        Dim c As Range\n        For Each c In RngList\n            If c.Row Mod 2 = 1 Then\n                Set rng = Union(rng, c.Resize(, 19))\n            End If\n        Next\n\n        Dim ch As Chart\n        Set ch = .Shapes.AddChart2(, xlLine).Chart\n        With ch\n            .SetSourceData rng\n            .HasTitle = True\n            .ChartTitle.Characters.Text = \"PVC MIXER\"\n            .Axes(xlCategory, xlPrimary).HasTitle = True\n            .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"BATCH NUMBER\"\n            .Axes(xlValue, xlPrimary).HasTitle = True\n            .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"WEIGHT\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1423697854, "creation_date": 1423697854, "answer_id": 28466697, "question_id": 28464362, "link": "https://stackoverflow.com/questions/28464362/get-odd-rows-in-a-range-using-vba/28466697#28466697", "title": "Get odd rows in a range using VBA", "body": "<p>I think you need to allow for a null range to begin with:</p>\n\n<pre><code>With ActiveSheet\n    LastRow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row - 2\n    Set RngList = .Range(\"D1:U\" &amp; LastRow &amp; \", C2:C\" &amp; LastRow)\n    Set rng = RngList(1)\n    For CurRow = 3 To LastRow - 1 Step 2\n       If Not rng Is Nothing Then\n           Set rng = Union(rng, RngList(CurRow))\n       Else\n           Set rng = RngList(CurRow)\n       End If\n    Next CurRow\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4437300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/574f3c7a870cadbe13ba64da25f568ce?s=128&d=identicon&r=PG&f=1", "display_name": "Xi Wang", "link": "https://stackoverflow.com/users/4437300/xi-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 987, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423697854, "creation_date": 1423688248, "last_edit_date": 1423694293, "question_id": 28464362, "link": "https://stackoverflow.com/questions/28464362/get-odd-rows-in-a-range-using-vba", "title": "Get odd rows in a range using VBA", "body": "<p>I need to get every odd row in a range (in my case, the range is RngList) using VBA in Excel. \nHere is my code, it comes out a blank chart:</p>\n\n<pre><code>Sub Chart()\nDim myData As String, sh As String\nDim LastRow As Long\nDim Rng As Range\nDim RngList As Range\n\nWith ActiveSheet\n     LastRow = .Range(\"C\" &amp; .Rows.count).End(xlUp).Row - 2\n     Set RngList = .Range(\"D1:U\" &amp; LastRow &amp; \", C2:C\" &amp; LastRow)\n     Set Rng = RngList(1)\n     For CurRow = 3 To LastRow - 1 Step 2\n        Set Rng = Union(Rng, RngList(CurRow))\n     Next CurRow\nEnd With\n\nsh = ActiveSheet.Name\nCharts.Add\nActiveChart.ChartType = xlLine\n\nActiveChart.SetSourceData Source:=Rng, PlotBy:=xlColumns\nActiveChart.Location Where:=xlLocationAsObject, Name:=sh\nActiveChart.SeriesCollection(1).XValues = Range(\"C2:C\" &amp; LastRow)\n\nWith ActiveChart\n.HasTitle = True\n.ChartTitle.Characters.Text = \"PVC MIXER\"\n.Axes(xlCategory, xlPrimary).HasTitle = True\n.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"BATCH NUMBER\"\n.Axes(xlValue, xlPrimary).HasTitle = True\n.Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"WEIGHT\"\nEnd With\n\nActiveChart.ChartArea.Select\n\nSet Rng = Nothing\nSet RngList = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "excel"], "comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1423689255, "post_id": 28464117, "comment_id": 45254882, "body": "Just to clarify, do you want it to check each cell and fill in formulas if it doesn&#39;t contain &quot;Grand Totals&quot; or do you actually want to the loop to end when you find &quot;Grand Totals&quot;?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1423708551, "post_id": 28464117, "comment_id": 45261982, "body": "Your goal sounds simple. You should use <code>Const</code> for R1C1 formulas to make code more readable. You are looping from Row 4 to bottom of <code>UsedRange</code>? You can use <code>Do Until ActiveCell.Value = GrTot</code> but you may end up infinite loop! You need to be more clear."}, {"owner": {"reputation": 478, "user_id": 2232595, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/mP0gz.jpg?s=128&g=1", "display_name": "Mike L", "link": "https://stackoverflow.com/users/2232595/mike-l"}, "edited": false, "score": 0, "creation_date": 1423750726, "post_id": 28464117, "comment_id": 45281902, "body": "D_Zab, I need both.... I need to check each cell, if it does not contain &quot;Grand Totals&quot; then it should fill in the formula, but the loop should end as soon as &quot;Grand Totals&quot; are found. I just don&#39;t really know how to loop through 3 ranges at once to execute these steps. So if D4 =/= &quot;Grand Totals&quot;, then put a formula in L4 and L5, then if E4 =/= &quot;Grand Totals&quot;, put the same formula in M4 and M5, and so on until &quot;Grand Totals&quot; are found, then exit the loop."}], "answers": [{"tags": [], "owner": {"reputation": 454, "user_id": 4552288, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ce7e986bb51499855b41f5cde90f6d7?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4552288/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1423760885, "last_edit_date": 1423760885, "creation_date": 1423687676, "answer_id": 28464184, "question_id": 28464117, "link": "https://stackoverflow.com/questions/28464117/vba-do-until-string-found-then-exit-step/28464184#28464184", "title": "VBA Do Until string found, then exit step", "body": "<p>Loop through each cell in the range; if the cell does not have a value you can write whatever to the cell and then something to the offset. As soon as a grand total is found in your range the loop can exit and move to the next range.</p>\n\n<pre><code>For Each item In Range\n\n    If item.Value = GrTot Then\n    Exit For\n    'Perform action on cell \n    item.Value = formula\n    item.offset(0,1).Value = formula \n    item.offset(0,2).Value = formula\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 478, "user_id": 2232595, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/mP0gz.jpg?s=128&g=1", "display_name": "Mike L", "link": "https://stackoverflow.com/users/2232595/mike-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3561, "favorite_count": 0, "accepted_answer_id": 28464184, "answer_count": 1, "score": 0, "last_activity_date": 1423760885, "creation_date": 1423687424, "last_edit_date": 1495540171, "question_id": 28464117, "link": "https://stackoverflow.com/questions/28464117/vba-do-until-string-found-then-exit-step", "title": "VBA Do Until string found, then exit step", "body": "<p>I have a file that has date values as column headers, and the last column will always be labeled \"Grand Total\". I want a way to look through the column headers, (which are in cells D4:I4) and input formulas to be filled down later.</p>\n\n<p>For example, if we check D4, and it does not contain \"Grand Totals\", then I need the below formulas input in Cells L4 and L5:</p>\n\n<pre><code>Range(\"L4\").Select\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = _\n    \"=\"\"Weekending \"\"&amp;TEXT(RC[-8],\"\"mm/dd/yyy\"\")&amp;\"\" Compliant?\"\"\"\nRange(\"L5\").Select\nActiveCell.FormulaR1C1 = _\n\"=IF((IF(RC17=\"\"Duplicate\"\",SUMIF(C2,RC2,C[-8]),RC[-8]))&lt;27,\"\"Compliant\"\",\n  IF((IF(RC17=\"\"Duplicate\"\",SUMIF(C1,RC1,C[-8]),RC[-8]))&lt;30,\"\"Approaching Limit\"\",\n  \"\"Over\"\"))\"\n</code></pre>\n\n<p>Then it would go to cell E4, and if it does not contain \"Grand Totals\", then the formulas need to be input in cells M4 and M5... Once \"Grand Totals\" are found [at the top of the loop], I need to exit the loop (but not the sub).</p>\n\n<p>I tried to piece together bits from code I found:</p>\n\n<pre><code>Dim GrTot As String\nDim rng1 As Range\nSet rng1 = Range(\"D4:I4\")\nGrTot = \"Grand Total\"\n\nRange(\"D4\").Select\nDo While ActiveCell.Value &lt;&gt; GrTot\n</code></pre>\n\n<p>But I didnt know where to go. Any help is appreciated.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I have since tried another method based on an example found <a href=\"https://stackoverflow.com/questions/1128841/how-to-loop-through-rows-columns-in-excel-vba-macro\">here</a>. This is what I have currently:</p>\n\n<pre><code>Dim x As Integer\nDim y As Integer\nWith Worksheets(\"Pivot\")\nx = 4\nDo Until .Cells(4, x).Value = \"Grand Total\"\n    For y = 12 To 16\n        .Cells(4, y).Formula = \"=\"\"Weekending \"\"&amp;TEXT(RC[-8],\"\"mm/dd/yyy\"\")&amp;\"\" \n          Compliant?\"\"\"\n        .Cells(5, y).Formula = \"=IF((IF(RC17=\"\"Duplicate\"\",SUMIF(C2,RC2,C[-8]),\n          RC[-8]))&lt;27,\"\"Compliant\"\",IF((IF(RC17=\"\"Duplicate\"\",\n          SUMIF(C1,RC1,C[-8]),RC[-8]))\n          &lt;30,\"\"Approaching Limit\"\",\"\"Over\"\"))\"\n    Next y\n    x = x + 1\nLoop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But this one doesn't exit correctly. It will loop through fine, writing the formulas as I requested, but it doesn't exit the loop when it reaches the \"Grand Total\" column. What am I doing wrong here?</p>\n"}, {"tags": ["vba", "excel", "replace"], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 1, "creation_date": 1423688079, "post_id": 28464155, "comment_id": 45254307, "body": "If you are looping through and deleting rows you want to step backwards through the loop with <code>For j = Range(&quot;A1&quot;).End(xlDown).Row To 1 Step -1</code> and cut out the <code>j = j - 1</code> line."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "edited": false, "score": 0, "creation_date": 1423688242, "post_id": 28464155, "comment_id": 45254384, "body": "@D_Zab thank you, it makes actually more sense. I edited my answer."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 1, "creation_date": 1423688353, "post_id": 28464155, "comment_id": 45254444, "body": "You could simplify your conditional statement by using <code>InStr</code> instead"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1423689370, "post_id": 28464155, "comment_id": 45254957, "body": "@Jeanno thanks to you as well, I&#39;ve written the code too fast. It&#39;s actually simplified with InStr, I&#39;ve made your suggested edit."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 1, "creation_date": 1423690423, "post_id": 28464155, "comment_id": 45255511, "body": "Il n&#39;y a pas de quoi!"}, {"owner": {"reputation": 45, "user_id": 4413450, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100000531012519/picture?type=large", "display_name": "Paul Leavitt", "link": "https://stackoverflow.com/users/4413450/paul-leavitt"}, "edited": false, "score": 0, "creation_date": 1423692036, "post_id": 28464155, "comment_id": 45256362, "body": "Thanks for your help guys! I can&#39;t get either answer to work, it&#39;s saying that the &quot;If Instr&quot; line &quot;expected a list separator.&quot;"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 45, "user_id": 4413450, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100000531012519/picture?type=large", "display_name": "Paul Leavitt", "link": "https://stackoverflow.com/users/4413450/paul-leavitt"}, "edited": false, "score": 0, "creation_date": 1423692459, "post_id": 28464155, "comment_id": 45256588, "body": "@PaulLeavitt try it now, I made another mistake (too tired today :)"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1423692442, "last_edit_date": 1423692442, "creation_date": 1423687565, "answer_id": 28464155, "question_id": 28464039, "link": "https://stackoverflow.com/questions/28464039/delete-row-based-on-partial-contents-of-cell/28464155#28464155", "title": "Delete Row Based on Partial Contents of Cell", "body": "<p>You could loop through the cells of the column A and, after having checked if the cell Ax starts by \"Div Code\", delete the entire row:</p>\n\n<pre><code>For j = Range(\"A1\").End(xlDown).Row To 1 Step -1\n    If InStr(Range(\"A\" &amp; j).Value,\"Div Code\") = 1 Then\n        Rows(j).Delete\n    End If\nNext j\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4413450, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100000531012519/picture?type=large", "display_name": "Paul Leavitt", "link": "https://stackoverflow.com/users/4413450/paul-leavitt"}, "edited": false, "score": 0, "creation_date": 1423693837, "post_id": 28464332, "comment_id": 45257306, "body": "Thanks again Jeanno, This looks closer to working, but I&#39;m still getting &quot;Run-Time Error &#39;13&#39;: Type Mismatch&quot; on line three. Any idea what&#39;s causing this?"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1423696540, "last_edit_date": 1423696540, "creation_date": 1423688161, "answer_id": 28464332, "question_id": 28464039, "link": "https://stackoverflow.com/questions/28464039/delete-row-based-on-partial-contents-of-cell/28464332#28464332", "title": "Delete Row Based on Partial Contents of Cell", "body": "<p>This is an extension to the solution given by Matteo. Credit should go to him</p>\n\n<pre><code>    Sub FindDivCode2()\n        For j = Range(\"A1\").End(xlDown).Row To 1 Step -1\n            If InStr(Range(\"A\" &amp; j).Value,\"Div Code\") = 1 Or  InStr(Range(\"A\" &amp; j).Value,\"Date\") = 1Then\n                Rows(j).Delete\n            End If\n        Next j\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4413450, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100000531012519/picture?type=large", "display_name": "Paul Leavitt", "link": "https://stackoverflow.com/users/4413450/paul-leavitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 864, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423696540, "creation_date": 1423687103, "question_id": 28464039, "link": "https://stackoverflow.com/questions/28464039/delete-row-based-on-partial-contents-of-cell", "title": "Delete Row Based on Partial Contents of Cell", "body": "<p>I am trying to create a VBA script that will go through column \"A\" in my spreadsheet and delete any Row that starts with a cell that contains the words \"Div Code:\"\nThe problem is, that the cells contain a lot more text after \"Div Code\" and I can't figure out how to make the .replace function work on partials.\nHere's what I have thus far:</p>\n\n<pre><code>Sub FindDivCode()\n\n\n  With Intersect(Columns(\"A\"), ActiveSheet.UsedRange)\n    .Replace \"Div Code\", \"#N/A\", xlPart\n    .Replace \"Date\", \"#N/A\", xlPart\n    .SpecialCells(xlConstants, xlErrors).EntireRow.Delete\n  End With\nEnd Sub\n</code></pre>\n\n<p>This script works for the \"Date\" cells, but not the \"Div Code\" Cell's.\nAny help will be greatly appreciated!</p>\n\n<p>Paul</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423686589, "post_id": 28463558, "comment_id": 45253462, "body": "<code>Rvariable = Application.WorksheetFunction.Ceiling(variable, 500)</code>. Your way does not work because of <a href=\"http://stackoverflow.com/q/21895756/11683\">floating point precision</a>."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1423686692, "post_id": 28463558, "comment_id": 45253522, "body": "In addition to GSerg&#39;s comment, when you Round(2250/ 500, 0), it gives 4 instead of 4.5, thus 4 * 500 = 2000. Round(2251/500) gives 5, where 5*500 = 2500."}, {"owner": {"reputation": 13, "user_id": 4556334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f3ae79a25fe238635bac077582fe93?s=128&d=identicon&r=PG&f=1", "display_name": "zigmus64", "link": "https://stackoverflow.com/users/4556334/zigmus64"}, "edited": false, "score": 0, "creation_date": 1423690395, "post_id": 28463558, "comment_id": 45255496, "body": "[Rvariable = Application.WorksheetFunction.Ceiling(variable, 500)]  will not work in my situation since anything above each set of [500] goes to the next [500] (i.e. [8001] goes to [8500] when it should go to [8000])"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423687878, "post_id": 28464144, "comment_id": 45254204, "body": "So now 500 will round to 1000. Also VBA <a href=\"http://support.microsoft.com/kb/194983/en-us\" rel=\"nofollow noreferrer\">does round in the traditional sense</a>, it&#39;s just there is more than one traditional sense."}, {"owner": {"reputation": 432, "user_id": 661617, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b690c0b1fda5b942bec6e97906e406?s=128&d=identicon&r=PG", "display_name": "jamesC", "link": "https://stackoverflow.com/users/661617/jamesc"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423688959, "post_id": 28464144, "comment_id": 45254727, "body": "no 500 will stil be 500 but Yes @GSerg great link I do need to broaden my traditions. but yeah this version leaves the issue in place for negatives so kind of getting away from my idea of not changing zigs code much. sadface"}], "tags": [], "owner": {"reputation": 432, "user_id": 661617, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b690c0b1fda5b942bec6e97906e406?s=128&d=identicon&r=PG", "display_name": "jamesC", "link": "https://stackoverflow.com/users/661617/jamesc"}, "is_accepted": true, "score": 1, "last_activity_date": 1423687525, "creation_date": 1423687525, "answer_id": 28464144, "question_id": 28463558, "link": "https://stackoverflow.com/questions/28463558/vba-for-excel-trying-to-round-to-nearest-500-cannot-get-code-to-round-correct/28464144#28464144", "title": "VBA for Excel - Trying to round to nearest 500, cannot get code to round correctly at 250", "body": "<p>vba doesn't round in the traditional sense I learned(a bit of a hack) to add 0.000001. so you're not changing your code much by doing the below</p>\n\n<pre><code>Rvariable = Round((variable + 0.000001) / 500, 0) * 500\n</code></pre>\n\n<p>it isn't a significant amount and you shouldn't experience any calculation errors. although you'd probaly have to add in some logic for doing negatives -0.000001 instead for negative numbers</p>\n"}], "owner": {"reputation": 13, "user_id": 4556334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f3ae79a25fe238635bac077582fe93?s=128&d=identicon&r=PG&f=1", "display_name": "zigmus64", "link": "https://stackoverflow.com/users/4556334/zigmus64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 28464144, "answer_count": 1, "score": 1, "last_activity_date": 1423687525, "creation_date": 1423685413, "last_edit_date": 1423685868, "question_id": 28463558, "link": "https://stackoverflow.com/questions/28463558/vba-for-excel-trying-to-round-to-nearest-500-cannot-get-code-to-round-correct", "title": "VBA for Excel - Trying to round to nearest 500, cannot get code to round correctly at 250", "body": "<p>Please accept my sincerest apologies if the title or question is confusing.</p>\n\n<p>I am using VBA in Excel 2007.  I need to round a number to the nearest 500.</p>\n\n<p>I am using the code:</p>\n\n<pre><code>Rvariable = Round(variable / 500, 0) * 500\n</code></pre>\n\n<p>My available numbers that I am trying to round go from <code>-500</code> to <code>10000</code>. \nIf the value to be rounded is from <code>501</code> to <code>749</code>, it will round down appropriately (i.e. <code>2501</code> to <code>2749</code> rounds to <code>500</code>). <code>750's</code> appropriately round up (<code>2750</code> rounds to <code>3000</code>).  Values from <code>001</code> to <code>249</code> also round down correctly, and <code>251</code> to <code>499</code> round up correctly.</p>\n\n<p>For some reason, a <code>250</code> value still rounds down (<code>2250</code> rounds to <code>2000</code> not <code>2500</code>).  It will not round up until <code>251</code>.  When I use this function in the actual excel worksheet, the <code>Round</code> function works properly and will round up at <code>250</code>.  </p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1423707014, "post_id": 28464665, "comment_id": 45261584, "body": "Excellent.  If it was a snake, it would&#39;ve bit me.  Thanks!"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1423689420, "creation_date": 1423689420, "answer_id": 28464665, "question_id": 28462838, "link": "https://stackoverflow.com/questions/28462838/how-can-i-programmatically-redefine-a-pivot-table-datasource-in-vba/28464665#28464665", "title": "How can I programmatically redefine a Pivot Table datasource in VBA", "body": "<p>Your <code>rngWorkingRange</code> variable is a Range and you're using it like a String.  You need</p>\n\n<pre><code>xlSheet.ListObjects.Add(xlSrcRange, rngWorkingRange, , xlYes).Name _\n    = \"tbl_MOSI\"\n</code></pre>\n\n<p>You could have also said <code>xlSheet.Range(rngWorkingRange.Address)</code>, but that would just be silly.</p>\n\n<p>What you did say, is <code>xlSheet.Range(rngWorkingRange.Value)</code> because Value is the default property of a Range object. If rngWorkingRange was a single cell whose value could be interpreted as a range address, you would not have got an error. But rngWorkingRange.Value returns an array and xlSheet.Range(...) doesn't know what to do with an array.</p>\n"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 1, "accepted_answer_id": 28464665, "answer_count": 1, "score": 0, "last_activity_date": 1594645415, "creation_date": 1423682828, "last_edit_date": 1594645415, "question_id": 28462838, "link": "https://stackoverflow.com/questions/28462838/how-can-i-programmatically-redefine-a-pivot-table-datasource-in-vba", "title": "How can I programmatically redefine a Pivot Table datasource in VBA", "body": "<p>Using 'CopyFromRecordset' has been an effective way to keep a data source from MS Access to a pivot table- 'unlinked'.   </p>\n\n<p>The Access database produces the report which is independent and can be e-mailed with no macros.</p>\n\n<p>I'm trying to write a routine that will automatically redefine the  datasource for the pivot table.  I know enough to clean up a recorded macro, so that it doesn't have stray Excel objects left open, but sometimes I miss something that either leaves an object open - OR doesn't set the object right.</p>\n\n<p>In this particular case, it is on this line:</p>\n\n<pre><code>xlSheet.ListObjects.Add(xlSrcRange, xlSheet.Range(rngWorkingRange), , xlYes).Name _\n        = \"tbl_MOSI\"\n</code></pre>\n\n<p>I get Run-time error '1004'\nObject defined error</p>\n\n<p>Here is my complete routine for reference:</p>\n\n<pre><code>Public Sub GetMOSIData(strSheetToPlaceData As String, strPathToWorkbook As String)\n\n'Puts a recordset into a specific cell of an Excel workbook \n\n\n'''\n'8 objects created\nDim xlApp As Object\nDim WB As Object\nDim xlSheet As Object\nDim xlMain As Object\nDim xlOther As Object\nDim fld As Variant\nDim rs As DAO.Recordset\nDim rngWorkingRange As Range\n\n\nDim x As Integer\n\n\n'''\n'6 objects set\nSet xlApp = CreateObject(\"Excel.Application\")\nSet WB = xlApp.Workbooks.Open(strPathToWorkbook)\n\nSet xlSheet = WB.Sheets(strSheetToPlaceData) 'or you can manually type the sheet name in place of strSheetToPlaceData\nSet xlMain = WB.Sheets(\"MOSI\")\nSet xlOther = WB.Sheets(\"SKL-LV-View\")\n\nSet rs = CurrentDb.OpenRecordset(\"Select * from \" &amp; strSheetToPlaceData)\n\n'Assumes you will use A1 as the anchor cell - but it can be changed\n\n'FIRST CLEAR THE RANGE OF CELLS\nxlSheet.Range(\"A1\").CurrentRegion.ClearContents\n\n'PLACE THE FIELD NAMES\nx = 1\nFor Each fld In rs.Fields\n    xlSheet.Cells(1, x).Value = fld.Name\n    x = x + 1\nNext\n\n'PLACE\nxlSheet.Range(\"A2\").CopyFromRecordset rs\n\n'determine the data range for the PivotTable\n\n\n'RECORDING FOR REFERENCE - I DON'T USE THIS CODE\n'\n'    Sheets(\"tbl_MOSI_Detail\").Select\n'    Range(\"C4\").Select\n'    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$1:$AB$23411\"), , xlYes).Name _\n'        = \"Table1\"\n'    Range(\"Table1[#All]\").Select\n'    ActiveSheet.ListObjects(\"Table1\").TableStyle = \"TableStyleLight9\"\n'    ActiveSheet.ListObjects(\"Table1\").Name = \"tbl_MOSI\"\n'    Sheets(\"MOSI\").Select\n'    Range(\"G4\").Select\n'    ActiveSheet.PivotTables(\"pvMOSI\").ChangePivotCache ActiveWorkbook.PivotCaches. _\n'        Create(SourceType:=xlDatabase, SourceData:=\"tbl_MOSI_Detail!tbl_MOSI\", _\n'        Version:=xlPivotTableVersion12)\n'END RECORDING FOR REFERENCE\n\n'ATTEMPT to clean up recording...\n'7th object set\nSet rngWorkingRange = xlSheet.Range(\"A1\").CurrentRegion\n\n'convert tbl_MOSI_Detail Range into a Table\n\n    xlSheet.ListObjects.Add(xlSrcRange, xlSheet.Range(rngWorkingRange), , xlYes).Name _\n        = \"tbl_MOSI\"\n    xlSheet.ListObjects(\"tbl_MOSI\").TableStyle = \"TableStyleLight9\"\n\n'set pvMOSI to point to this table\n    xlMain.PivotTables(\"pvMOSI\").ChangePivotCache WB.PivotCaches. _\n        Create(SourceType:=xlDatabase, SourceData:=\"tbl_MOSI_Detail!tbl_MOSI\", _\n        Version:=xlPivotTableVersion12)\n\nxlMain.RefreshAll\nxlMain.Select\n\nWB.Save\nWB.Close\n\nxlApp.Quit\n\n'8 objects destroyed\nSet rs = Nothing\nSet rngWorkingRange = Nothing\nSet fld = Nothing\nSet xlSheet = Nothing\nSet xlMain = Nothing\nSet xlOther = Nothing\nSet WB = Nothing\nSet xlApp = Nothing\n\n\nPresentExcel (strPathToWorkbook)\nMsgBox \"MOSI report is complete\", vbOKOnly, \"MOSI\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "attachment"], "comments": [{"owner": {"reputation": 2964, "user_id": 2246380, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/piBvo.png?s=128&g=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2246380/ram"}, "edited": false, "score": 1, "creation_date": 1423682828, "post_id": 28462738, "comment_id": 45251372, "body": "You have add what you have tried so far. See the <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> for help clarifying this question."}, {"owner": {"reputation": 432, "user_id": 661617, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b690c0b1fda5b942bec6e97906e406?s=128&d=identicon&r=PG", "display_name": "jamesC", "link": "https://stackoverflow.com/users/661617/jamesc"}, "edited": false, "score": 1, "creation_date": 1423683452, "post_id": 28462738, "comment_id": 45251767, "body": "You should start with reading through this example of how to download an attachment from outlook and Open in Excel <a href=\"http://stackoverflow.com/questions/11781320/download-attachment-from-outlook-and-open-in-excel\" title=\"download attachment from outlook and open in excel\">stackoverflow.com/questions/11781320/&hellip;</a> then see how far you get and then we can help you from there"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1423686346, "creation_date": 1423686346, "answer_id": 28463821, "question_id": 28462738, "link": "https://stackoverflow.com/questions/28462738/opening-an-excel-attachment-in-outlook/28463821#28463821", "title": "Opening an Excel attachment in Outlook", "body": "<p>The Outlook object model doesn't provide anything for opening excel files on the fly. You need to save the attached file on the disk and then open it. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869359(v=office.15).aspx\" rel=\"nofollow\">SaveAs</a> method of the Attachment class saves the attachment to the specified path.</p>\n\n<p>Most probably you need to be aware when the new item arrives in Outlook. The Application class provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686(v=office.15).aspx\" rel=\"nofollow\">NewMailEx</a> event which is fired when a new item is received in the Inbox. </p>\n\n<p>Finally, I'd suggest starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article in MSDN.</p>\n"}], "owner": {"reputation": 1, "user_id": 4556203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f404fe28b6d00781f1d0137c76d3537?s=128&d=identicon&r=PG&f=1", "display_name": "Zarina Hussain", "link": "https://stackoverflow.com/users/4556203/zarina-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1423686346, "creation_date": 1423682557, "last_edit_date": 1423684982, "question_id": 28462738, "link": "https://stackoverflow.com/questions/28462738/opening-an-excel-attachment-in-outlook", "title": "Opening an Excel attachment in Outlook", "body": "<p>I need to open an Excel attachment in Outlook that comes in every hour with fresh data. I then need to copy and replace this fresh data in another Excel application, refresh the PivotTable and send to a bunch of people via Outlook.  </p>\n\n<p>Please help me with VBA code that will automate this process.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1423679394, "post_id": 28461614, "comment_id": 45249295, "body": "All of the files in that directory are excel?"}, {"owner": {"reputation": 394, "user_id": 3837942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGpZT.jpg?s=128&g=1", "display_name": "bp_", "link": "https://stackoverflow.com/users/3837942/bp"}, "edited": false, "score": 0, "creation_date": 1423679610, "post_id": 28461614, "comment_id": 45249412, "body": "Not sure why the <code>Dir</code> is returning what it is... but, why not just throw a <code>Replace(Dir(),&quot;\\\\&quot;,&quot;\\&quot;)</code> in the line of code?"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1423682672, "post_id": 28461614, "comment_id": 45251267, "body": "Everything is excel files. I&#39;m just working with test data at the moment. I could throw in a Replace, but I&#39;m concerned that when it acts all wonky again I&#39;m just going to have to remove that. My concern is that what the Dir() is returning is changing and I need to figure out why that&#39;s happening to find a permanent solution rather than continuing to work around the wonky-ness every time it happens."}], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1423682797, "post_id": 28461829, "comment_id": 45251351, "body": "Dir() returns a file object which has a full path on it already. If I tell Application.Workbooks.Open to open (FileLocation &amp; File Object) it will have 2 file locations in it&#39;s attempted open path. From what I can tell, I can&#39;t use Dir() results as a name, only as a file object. What I could do is Dim FileName and set Filename = SourceCurrentFile.Name, but that doesn&#39;t make it more bullet proof from what I&#39;ve tried."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1423683018, "post_id": 28461829, "comment_id": 45251491, "body": "Don&#39;t you want to open excel files from a directory?"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 1, "creation_date": 1423854318, "post_id": 28461829, "comment_id": 45332838, "body": "I need to apologize. I had not noticed that in your example the SourceCurrentFile is a string which makes all the difference. Thanks."}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 2, "last_activity_date": 1423680327, "last_edit_date": 1423680327, "creation_date": 1423679667, "answer_id": 28461829, "question_id": 28461614, "link": "https://stackoverflow.com/questions/28461614/excel-vba-using-workbook-open-with-results-of-dirdirectory/28461829#28461829", "title": "Excel VBA using Workbook.Open with results of Dir(Directory)", "body": "<p>This would open all .xlxs files in that directory son.</p>\n\n<pre><code>    Sub OpenFiles()\n    Dim SourceCurrentFile As String\n    Dim FileExtension as String: FileExtension = \"*.xlxs\"\n    SourceLoc = \"C:\\ExcelWIP\\TestSource\\\"\n    SourceCurrentFile = Dir(SourceLoc)\n    SourceCurrentFile = Dir()\n    'Start looping through directory\n    Do While (SourceCurrentFile &lt;&gt; \"\")\n    Application.Workbooks.Open (SourceLoc &amp;\"\\\"&amp; SourceCurrentFile)\n    SourceCurrentFile = Dir(FileExtension)\n    Loop\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1423692930, "creation_date": 1423692930, "answer_id": 28465593, "question_id": 28461614, "link": "https://stackoverflow.com/questions/28461614/excel-vba-using-workbook-open-with-results-of-dirdirectory/28465593#28465593", "title": "Excel VBA using Workbook.Open with results of Dir(Directory)", "body": "<p>Consider using VBA's <a href=\"https://msdn.microsoft.com/en-us/library/aa711216%28v=vs.71%29.aspx\" rel=\"nofollow\">FileSystemObject</a> which includes the folder and file property:</p>\n\n<pre><code>Sub xlFilesOpen()\n    Dim strPath As String\n    Dim objFSO As Object, objFolder As Object, xlFile As Object\n\n    strPath = \"C:\\ExcelWIP\\TestSource\"\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(strPath)\n\n    For Each xlFile In objFolder.Files\n        If Right(xlFile, 4) = \"xlsx\" Or Right(xlFile, 3) = \"xls\" Then\n            Application.Workbooks.Open (xlFile)\n        End If\n    Next xlFile\n\n    Set objFSO = Nothing\n    Set objFolder = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "is_accepted": false, "score": 1, "last_activity_date": 1423854696, "creation_date": 1423854696, "answer_id": 28506989, "question_id": 28461614, "link": "https://stackoverflow.com/questions/28461614/excel-vba-using-workbook-open-with-results-of-dirdirectory/28506989#28506989", "title": "Excel VBA using Workbook.Open with results of Dir(Directory)", "body": "<p>JLILI Aman hit on the answer which was to take the results of Dir() as a string. Using that combined with the path on Application.Open allows for stable behaviors from the code. </p>\n\n<p>New Code: </p>\n\n<pre><code>Dim SourceLoc as String\nDim SourceCurrentFile as String\nSourceLoc = \"C:\\ExcelWIP\\TestSource\\\"\nSourceCurrentFile = Dir(SourceLoc)\n\n'Start looping through directory\nWhile (SourceCurrentFile &lt;&gt; \"\")\nApplication.Workbooks.Open (SourceLoc &amp; \"/\" &amp; SourceCurrentFile)\n</code></pre>\n\n<p>I didn't include the recommended file extension because I'm dealing with xls, xlsx, and xlsm files all in one directory. This code opens all of them. </p>\n\n<p>Warning - this code will set current file to each file in the directory including non-excel files. In my case, I'm only dealing with excel files so that's not a problem. </p>\n\n<p>As to why this happens, it does not appear that Application.Open will accept the full object results of Dir(), so the return of Dir() needs to be a String. I didn't dig deeper into the why of it beyond that. </p>\n"}], "owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2086, "favorite_count": 0, "accepted_answer_id": 28461829, "answer_count": 3, "score": 2, "last_activity_date": 1423854696, "creation_date": 1423679041, "question_id": 28461614, "link": "https://stackoverflow.com/questions/28461614/excel-vba-using-workbook-open-with-results-of-dirdirectory", "title": "Excel VBA using Workbook.Open with results of Dir(Directory)", "body": "<p>This seems so simple and I've had it working multiple times, but something keeps breaking between my Dir call (to iterate through a directory) and opening the current file. Here's the pertinent code: </p>\n\n<pre><code>SourceLoc = \"C:\\ExcelWIP\\TestSource\\\"\nSourceCurrentFile = Dir(SourceLoc)\n\n'Start looping through directory\nWhile (SourceCurrentFile &lt;&gt; \"\")\nApplication.Workbooks.Open (SourceCurrentFile)\n</code></pre>\n\n<p>What I get with this is a file access error as the Application.Workbooks.Open is trying to open \"C:\\ExcelWIP\\TestSource\\\\FILENAME\" (note extra slash)</p>\n\n<p>However when I take the final slash out of SourceLoc, the results of Dir(SourceLoc) are \"\" (it doesn't search the directory). </p>\n\n<p>The frustrating thing is that as I've edited the sub in other ways, the functionality of this code has come and gone. I've had it work as-is, and I've had taking the '/' out of the directory path make it work, and at the moment, I just can't get these to work right together. </p>\n\n<p>I've scoured online help and ms articles but nothing seems to point to a reason why this would keep going up and down (without being edited except for when it stops working) and why the format of the directory path will sometimes work with the final '/' and sometimes without. </p>\n\n<p>any ideas? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 4047598, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/be7fd20ee0013e84a519c61e64810f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine Pacheco", "link": "https://stackoverflow.com/users/4047598/katherine-pacheco"}, "edited": false, "score": 0, "creation_date": 1423678788, "post_id": 28461360, "comment_id": 45248953, "body": "where should i add on here to save the workbook before closing so i dont have to do it in the macro?"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1423678979, "last_edit_date": 1423678979, "creation_date": 1423678205, "answer_id": 28461360, "question_id": 28461261, "link": "https://stackoverflow.com/questions/28461261/open-workbook-in-read-write-and-save-when-closing/28461360#28461360", "title": "Open workbook in read-write and save when closing", "body": "<p>The <code>ReadOnly</code> property is flagged to <code>True</code> at the third position.\nIt should rather be <code>False</code> in order to open in read-write:</p>\n\n<pre><code>oExcel.Workbooks.Open(oFile, 0, False, , , , True, , , , False, , False)\n</code></pre>\n\n<p>Find more about the <code>Workbooks.Open()</code> method on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow\">official documentation</a>.</p>\n\n<p>To save your workbook, you can use the <code>Save</code> and the <code>Close</code> methods separately; instead of: </p>\n\n<pre><code>.Close False, , False\n</code></pre>\n\n<p>to make it clearer I would use:</p>\n\n<pre><code>Application.DisplayAlerts = False '&lt;-- if you don't want the alert\nwb2.Save \nApplication.DisplayAlerts = True '&lt;-- set it back\nwb2.Close\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 4047598, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/be7fd20ee0013e84a519c61e64810f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine Pacheco", "link": "https://stackoverflow.com/users/4047598/katherine-pacheco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 28461360, "answer_count": 1, "score": -1, "last_activity_date": 1423681647, "creation_date": 1423677884, "last_edit_date": 1423681647, "question_id": 28461261, "link": "https://stackoverflow.com/questions/28461261/open-workbook-in-read-write-and-save-when-closing", "title": "Open workbook in read-write and save when closing", "body": "<p>so i have this code i got but it is opening all my workbooks in the directory as read only. I need to save it after it has runt the macro then close it... I believe this is the line I am suppose to change but I dont know which part of it</p>\n\n<pre><code>oExcel.Workbooks.Open(oFile, 0, True, , , , True, , , , False, , False)\n</code></pre>\n\n<p>Below is all the code</p>\n\n<pre><code>Dim oFSO\nDim oShell, oExcel, oFile, oSheet\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oShell = CreateObject(\"WScript.Shell\")\nSet oExcel = CreateObject(\"Excel.Application\")\nSet wb2 = oExcel.Workbooks.Open (\"C:\\Users\\kp.AD\\AppData\\Roaming      \\Microsoft\\Excel\\XLSTART\\CoventryStoplossMacroBook.xlsb\") 'Specify foldername     here\n\n\noExcel.DisplayAlerts = True\n\n\nFor Each oFile In oFSO.GetFolder(\"C:\\Users\\kpacheco.AD\\Desktop\\MSO_PR    \\macro_test\").Files\n  If LCase(oFSO.GetExtensionName(oFile)) = \"xls\" Then\nWith oExcel.Workbooks.Open(oFile, 0, True, , , , True, , , , False, , False)\n\n\n  'calling macro for MSO Eligibility reports\n     oExcel.Run wb2.Name &amp; \"!MSOElig2\"\n\n 'I think im suppose to change the below to true but since it is read only    'it asks me to save a copy\n     .Close False, , False\n    End With\n  End If\n\n\n\nNext\n\n\nwb2.Save\n\nwb2.Close\n\n\noExcel.Quit\noShell.Popup \"Conversion complete\", 10\n</code></pre>\n"}, {"tags": ["vba", "excel", "directory"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423677865, "post_id": 28461139, "comment_id": 45248467, "body": "Is not running at all or is running and raising an error? My first impression is that <code>Workbooks.Open(sPathSpec &amp; sFoundFile)</code> should be <code>Workbooks.Open(sPathSpec &amp; &quot;\\&quot; &amp; sFoundFile)</code>"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1423681739, "post_id": 28461139, "comment_id": 45250708, "body": "Yep, or just have <code>sPathSpec = &quot;C:\\Users\\Name\\Desktop\\Folder\\&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 4524954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1978e491f713d88d4f4ef34112dd4327?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Oneal", "link": "https://stackoverflow.com/users/4524954/ryan-oneal"}, "edited": false, "score": 0, "creation_date": 1423686883, "post_id": 28461139, "comment_id": 45253624, "body": "When I try this method it gives me error 1004 &quot;We couldn&#39;t find C:\\Users\\Name\\Desktop\\Folder\\.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1423707931, "creation_date": 1423707931, "answer_id": 28468224, "question_id": 28461139, "link": "https://stackoverflow.com/questions/28461139/protect-all-worksheets-in-a-folder-with-parameters/28468224#28468224", "title": "Protect all worksheets in a folder with parameters", "body": "<p>Looks like you are copying code from somewhere. A few issues you have:</p>\n\n<ol>\n<li>With your use of <code>sPathSpec</code>, you need to have <code>\\</code> at the end</li>\n<li>Make sure the folder on Desktop does exist, if different change the code</li>\n<li>Use Environment variables when possible <code>Environ(\"USERPROFILE\")</code> gives you the Profile path of the user who runs this macro</li>\n<li>Your <code>Do-Loop</code> is wrong! You should <strong>stop until no files found</strong> instead of <strong>loop when nothing is found</strong></li>\n<li>You should ensure the file is opened successfully before changing it</li>\n<li>The reason of using <code>With wBk</code>...</li>\n</ol>\n\n<p>I have altered some lines to improve performance and a <code>Debug</code> line to list all the files that are saved.</p>\n\n<p>So you should try this:</p>\n\n<pre><code>Sub ProtectAllSheets()\n    Const myPassword = \"random\"\n    Dim sh As Worksheet\n    Dim wBk As Workbook\n    Dim sFileSpec As String\n    Dim sPathSpec As String\n    Dim sFoundFile As String\n\n    sPathSpec = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\Folder\\\"\n    sFileSpec = \"*.xlsx\"\n    sFoundFile = Dir(sPathSpec &amp; sFileSpec)\n    Application.DisplayAlerts = False\n    Do Until sFoundFile = \"\"\n        Set wBk = Workbooks.Open(sPathSpec &amp; sFoundFile)\n        If Not wBk Is Nothing Then\n            With wBk\n                For Each sh In .Worksheets\n                    sh.Protect Password:=myPassword, AllowInsertingRows:=True, AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True\n                Next sh\n                .Save\n                Debug.Print \"Saved: \" &amp; .FullName\n                .Close\n            End With\n            Set wBk = Nothing\n        End If\n        sFoundFile = Dir\n    Loop\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4524954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1978e491f713d88d4f4ef34112dd4327?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Oneal", "link": "https://stackoverflow.com/users/4524954/ryan-oneal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 816, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453837838, "creation_date": 1423677414, "last_edit_date": 1453837838, "question_id": 28461139, "link": "https://stackoverflow.com/questions/28461139/protect-all-worksheets-in-a-folder-with-parameters", "title": "Protect all worksheets in a folder with parameters", "body": "<p>I have the following code which is designed to protect each sheet in a particular folder on my desktop with certain parameters such as allowing the sorting of rows, sorting, and filtering.</p>\n\n<p>My problem is that the code doesn't run at all. I gathered bits and pieces of code from this website and Exceltips to customize it for what I want to accomplish.</p>\n\n<pre><code>Sub ProtectAllSheets()\n    Dim sh As Worksheet\n    Dim myPassword As String\n    Dim wBk As Workbook\n    Dim sFileSpec As String\n    Dim sPathSpec As String\n    Dim sFoundFile As String\n    myPassword = \"random\"\n    sPathSpec = \"C:\\Users\\Name\\Desktop\\Folder\"\n    sFileSpec = \"*.xlsx\"\n    sFoundFile = Dir(sPathSpec &amp; sFileSpec)\n    Do While sFoundFile = \"\"\n        Set wBk = Workbooks.Open(sPathSpec &amp; sFoundFile)\n        With wBk\n            For Each sh In wBk.Worksheets\n                sh.Protect Password:=myPassword, AllowInsertingRows:=True, AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True\n            Next sh\n            Application.DisplayAlerts = False\n            wBk.SaveAs Filename:=.FullName\n            Application.DisplayAlerts = True\n        End With\n        Set wBk = Nothing\n        Workbooks(sFoundFile).Close \n        sFoundFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong to prevent this code from running?</p>\n"}, {"tags": ["sql-server", "vba", "excel", "ssis"], "comments": [{"owner": {"reputation": 1621, "user_id": 974077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d68ac1c144c5c11137c64809817c43d2?s=128&d=identicon&r=PG", "display_name": "sorrell", "link": "https://stackoverflow.com/users/974077/sorrell"}, "edited": false, "score": 0, "creation_date": 1423725969, "post_id": 28460767, "comment_id": 45267423, "body": "Does the column range change between files in a predictable way? As in, one type of file always has 3 columns and the other has 6. I ask because this could make for a simpler solution."}, {"owner": {"reputation": 25, "user_id": 4482824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9acaa39091b1cec7855a92128e364d91?s=128&d=identicon&r=PG&f=1", "display_name": "luz_andre", "link": "https://stackoverflow.com/users/4482824/luz-andre"}, "reply_to_user": {"reputation": 1621, "user_id": 974077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d68ac1c144c5c11137c64809817c43d2?s=128&d=identicon&r=PG", "display_name": "sorrell", "link": "https://stackoverflow.com/users/974077/sorrell"}, "edited": false, "score": 0, "creation_date": 1423733314, "post_id": 28460767, "comment_id": 45271216, "body": "No, the files keep changing the number of columns because they are automatic files generated with data about Years and Months. All of that data is on columns instead of lines. And this year they have a set number of columns but next year they will defnitely grow (add to the current number of columns)"}, {"owner": {"reputation": 1621, "user_id": 974077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d68ac1c144c5c11137c64809817c43d2?s=128&d=identicon&r=PG", "display_name": "sorrell", "link": "https://stackoverflow.com/users/974077/sorrell"}, "edited": false, "score": 0, "creation_date": 1423746491, "post_id": 28460767, "comment_id": 45279093, "body": "Maybe try a script task to <a href=\"http://stackoverflow.com/questions/12838403/c-sharp-transpose-method-to-transpose-rows-and-columns-in-excel-sheet\">transpose the data.</a>  then save and import?"}, {"owner": {"reputation": 25, "user_id": 4482824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9acaa39091b1cec7855a92128e364d91?s=128&d=identicon&r=PG&f=1", "display_name": "luz_andre", "link": "https://stackoverflow.com/users/4482824/luz-andre"}, "reply_to_user": {"reputation": 1621, "user_id": 974077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d68ac1c144c5c11137c64809817c43d2?s=128&d=identicon&r=PG", "display_name": "sorrell", "link": "https://stackoverflow.com/users/974077/sorrell"}, "edited": false, "score": 0, "creation_date": 1423757572, "post_id": 28460767, "comment_id": 45286711, "body": "It was one of the ideas, but how can I start the script from SSIS? It must be executed when the package runs."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4482824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9acaa39091b1cec7855a92128e364d91?s=128&d=identicon&r=PG&f=1", "display_name": "luz_andre", "link": "https://stackoverflow.com/users/4482824/luz-andre"}, "edited": false, "score": 0, "creation_date": 1423919672, "post_id": 28484260, "comment_id": 45349224, "body": "That&#39;s exactly what I needed. Thank you very much, I&#39;ll be able to read from the new range (A8:B12 range in the e.g) with the data in the correct form and with fixed columns. Thank you! I really need to sharp my C# (no pun intended) skills, it really opens a wide range of options, didn&#39;t know that C# could work directly with XLS files."}], "tags": [], "owner": {"reputation": 1621, "user_id": 974077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d68ac1c144c5c11137c64809817c43d2?s=128&d=identicon&r=PG", "display_name": "sorrell", "link": "https://stackoverflow.com/users/974077/sorrell"}, "is_accepted": true, "score": 2, "last_activity_date": 1423763056, "last_edit_date": 1495539835, "creation_date": 1423763056, "answer_id": 28484260, "question_id": 28460767, "link": "https://stackoverflow.com/questions/28460767/apply-vba-code-to-excel-file-from-ssis/28484260#28484260", "title": "Apply VBA code to Excel file from SSIS", "body": "<ol>\n<li><p>Create a Script Task that is piped into a Data Flow task</p>\n\n<p><img src=\"https://i.stack.imgur.com/AW28j.png\" alt=\"STask to DFtask\"></p></li>\n<li><p>Edit the Script Task by double clicking the Script Task and clicking the Edit Script button.</p></li>\n<li><p>Add references to Excel and CSharp as seen in <a href=\"https://stackoverflow.com/questions/28160282/unable-to-set-active-excel-sheet-c-sharp/28172175#28172175\">this answer</a></p></li>\n<li><p>Add some code similar to the following:</p>\n\n<pre><code>public void Main()\n{\n  string filepath = @\"c:\\temp\\transpose.xlsx\";\n  Excel.Application xlApp;\n  Excel._Workbook oWB;\n\n  try\n  {\n    xlApp = new Excel.Application();\n    xlApp.Visible = false;\n    oWB = (Excel.Workbook)xlApp.Workbooks.Open(filepath);\n    Excel.Range fromrng = xlApp.get_Range(\"B4\", \"F5\");\n    Object[,] transposedRange = (Object[,])xlApp.WorksheetFunction.Transpose(fromrng);\n    Excel.Range to_rng = xlApp.get_Range(\"A8\", \"A8\");\n    to_rng = to_rng.Resize[transposedRange.GetUpperBound(0), transposedRange.GetUpperBound(1)];\n    to_rng.Value = transposedRange;\n    xlApp.ActiveWorkbook.Save();\n    oWB.Close(filepath);\n\n  }\n  catch (Exception ex)\n  {\n    //do something\n  }\n\nDts.TaskResult = (int)ScriptResults.Success;\n}\n</code></pre></li>\n<li><p>This gives the following result in the sample transpose.xlsx I created.\n<img src=\"https://i.stack.imgur.com/0yTgK.png\" alt=\"Transpose\"></p></li>\n</ol>\n"}], "owner": {"reputation": 25, "user_id": 4482824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9acaa39091b1cec7855a92128e364d91?s=128&d=identicon&r=PG&f=1", "display_name": "luz_andre", "link": "https://stackoverflow.com/users/4482824/luz-andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2870, "favorite_count": 0, "accepted_answer_id": 28484260, "answer_count": 1, "score": 1, "last_activity_date": 1423763056, "creation_date": 1423676136, "question_id": 28460767, "link": "https://stackoverflow.com/questions/28460767/apply-vba-code-to-excel-file-from-ssis", "title": "Apply VBA code to Excel file from SSIS", "body": "<p>Good evening everyone.\nI have to build a SSIS package that does as follows:</p>\n\n<p>1) Execute a VBA code to a XLS file (Transpose a range into another range)\n2) Save the XLS (In the same file or as a new file)\n3) Import the modified XLS from the Transposed range.</p>\n\n<p>Basically I have to transpose the data inside a XLS that I must import, and I didn't find a good way to do that in SSIS (Since the column range can change between files)</p>\n\n<p>With this simple VBA script I can do that and make SSIS read the data in a very straightforward way. However I'm not finding a way to apply this code without modifying the Excel previously manually to add the script and run the VBA script. I want to automate this so the package prepares the xls, extracts the new data, and save it to a table.</p>\n\n<p>Can anyone shed some ideas on how to apply this code or other ways to do this? The most important point I think is that it's a very specific range that I want to transpose.</p>\n\n<pre><code>Sub myTranspose()\n    With Range(\"a18:ZZ27\", Range(\"a18:ZZ27\").End(xlDown))\n        .Copy\n        Range(\"a30\").PasteSpecial Transpose:=True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1423680582, "post_id": 28461054, "comment_id": 45250029, "body": "For some reason I didn&#39;t get it to work when I tried it before. But it works well"}, {"owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1423680882, "post_id": 28461054, "comment_id": 45250200, "body": "Happy to be of service."}], "tags": [], "owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "is_accepted": true, "score": 1, "last_activity_date": 1423677188, "creation_date": 1423677188, "answer_id": 28461054, "question_id": 28460765, "link": "https://stackoverflow.com/questions/28460765/ignore-items-in-a-formatconditions-collection-that-are-not-formatcondition/28461054#28461054", "title": "Ignore items in a formatconditions collection that are not formatcondition?", "body": "<p>Did you try the Typename function, \nfor example:</p>\n\n<pre><code>Dim str as string.\nMsgbox Typename(str)  ' -&gt;&gt;&gt; \"String\"\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 28461054, "answer_count": 1, "score": 1, "last_activity_date": 1423677188, "creation_date": 1423676121, "last_edit_date": 1495541559, "question_id": 28460765, "link": "https://stackoverflow.com/questions/28460765/ignore-items-in-a-formatconditions-collection-that-are-not-formatcondition", "title": "Ignore items in a formatconditions collection that are not formatcondition?", "body": "<p>The following code works for most sheets in my workbook:</p>\n\n<pre><code>Function IsHighlighted() As Boolean\n\n    Dim wks As Worksheet\n    For Each wks In ThisWorkbook.Worksheets\n        Dim rUsedRange As Range\n        Set rUsedRange = wks.UsedRange\n\n        With rUsedRange\n            Dim bHighlighted As Boolean\n\n            Dim fc As Object\n            For Each fc In .FormatConditions\n                If fc.Interior.Color = RGB(255, 0, 0) And fc.Font.Color = RGB(255, 255, 0) Then\n                    bHighlighted = True\n                    Exit For\n                End If\n            Next fc\n\n            If bHighlighted = True Then\n                Exit For\n            End If\n        End With\n        Debug.Print (wks.Name &amp; \",\" &amp; rUsedRange.FormatConditions.count)\n    Next wks\n\n    IsHighlighted = bHighlighted\nEnd Function\n</code></pre>\n\n<p>But some of my sheets contain icon sets.</p>\n\n<p>Apparently:\nThe <code>FormatConditions</code> collection includes <code>FormatCondition</code>, <code>DataBar</code>, <code>AboveAverage</code>, <code>ColorScale</code>, <code>UniqueValues</code>, <code>Top10</code> and <code>IconSetCondition</code> objects, not just <code>FormatCondition</code> objects.\nFor more context, see: <a href=\"https://stackoverflow.com/questions/28456730/for-each-fc-in-range-formatconditions-fails-why/28457706#28457706\">For each fc in range.formatconditions fails. Why?</a></p>\n\n<p>Some of these don't have <code>.Interior.Color</code> so the if statement throws an error.</p>\n\n<p>What is a nice way I can skip all of these objects in the formatconditions collection that are not of the type formatcondition?</p>\n\n<p>I tried using <code>VarType(fc)</code> to determine the obejct type, but it only retuns a 9 which says that <code>fc</code> is some kind of object.</p>\n"}, {"tags": ["vba", "ms-word", "bookmarks"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423676256, "post_id": 28460749, "comment_id": 45247537, "body": "Are you sure you&#39;re correctly including <code>&amp;</code> into a string? Could you show us the line of code where you try to define the bookmark?"}, {"owner": {"reputation": 23, "user_id": 3084170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5991cd15d7b0a0a9f19b4fd7fd63df7?s=128&d=identicon&r=PG&f=1", "display_name": "user3084170", "link": "https://stackoverflow.com/users/3084170/user3084170"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423694640, "post_id": 28460749, "comment_id": 45257656, "body": "Apologies for the above. Even a straightforward instruction throws the runtime error - such as: r.Bookmarks.Add &quot;This &amp; That&quot;.  This is as expected though. I&#39;ve verified that my strings contain &quot;&amp;&quot; explicitly - this is actually what I want. ie: my headings must use &amp; instead of &quot;and&quot;."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423695020, "post_id": 28460749, "comment_id": 45257804, "body": "Reading the official <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197253.aspx\" rel=\"nofollow noreferrer\">documentation</a>, I can read bookmark names should be <i>one word only</i>; I fear that&#39;s the reason."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423695084, "post_id": 28460749, "comment_id": 45257837, "body": "P.s. my knowledge of VBA for Word is very poor, you might want to wait the answer of someone else; but I clearly read &quot;The name of the bookmark. The name cannot be more than one word.&quot; in the doc."}, {"owner": {"reputation": 23, "user_id": 3084170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5991cd15d7b0a0a9f19b4fd7fd63df7?s=128&d=identicon&r=PG&f=1", "display_name": "user3084170", "link": "https://stackoverflow.com/users/3084170/user3084170"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423695535, "post_id": 28460749, "comment_id": 45258054, "body": "I believe this is overcome using underscores instead of spaces, which is how Word achieves multi-word bookmarks, much like the example above. Thanks all the same though."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3084170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5991cd15d7b0a0a9f19b4fd7fd63df7?s=128&d=identicon&r=PG&f=1", "display_name": "user3084170", "link": "https://stackoverflow.com/users/3084170/user3084170"}, "edited": false, "score": 0, "creation_date": 1423794017, "post_id": 28481695, "comment_id": 45303809, "body": "Thanks very much Bibadia. That looks like a can of worms to me, but puts the matter to rest in my mind."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "is_accepted": true, "score": 2, "last_activity_date": 1423755855, "creation_date": 1423755855, "answer_id": 28481695, "question_id": 28460749, "link": "https://stackoverflow.com/questions/28460749/vba-word-why-can-word-use-special-chars-in-bookmark-creation-and-i-cant/28481695#28481695", "title": "vba Word: Why can Word use special chars in bookmark creation, and I cant?", "body": "<p>IMO Word is \"cheating\", either by breaking its own rules for bookmark names, or by denying you the full range of names that it allowed by the Specification.</p>\n\n<p>If you go back to the early ECMA standard for .docx, a bookmark's name is defined as an ST_String, which is a restriction of xsd:string with a maximum length of 255 characters. I do not think this has changed since in any of the ECMA or ISO versions of the standards.</p>\n\n<p>However, Microsoft's implementation notes [MS-OE376].pdf, which pertain to the ECMA version of the specs, and [MS-OI29500].pdf, which pertain to the 2012 ISO version, specify that the name can be no longer than 40 characters, but do not describe any other limitations.</p>\n\n<p>My (previous) understanding was that bookmark names were limited to 40 characters, had to consist of \"letters\", \"digits\" and \"underscores\" and had to start with an underscore (for hidden bookmarks) or a letter. (Not sure about, e.g. \"_1\"). And I believe that VBA still imposes those rules, although I have never checked what its understanding of a \"letter\" or a \"digit\" is - are non-Latin letters/digits allowed?</p>\n\n<p>However, if you save a document as a .xml or edit the document.xml within a .docx, you can modify the bookmark name so that it contains, e.g. \"&amp;\". Further, Word will re-save such characters. But it will truncate names to 40 characters when you open, and it doesn't retain the original name when you re-save. I don't think the  use of initial \"_\" to denote \"hidden\" is in the standard, either.</p>\n\n<p>So, given the specifications, I would say that Word is \"cheating\" by not allowing you to use the full range of possible names, rather than \"cheating\" by allowing hyperlink destinations to contain \"&amp;\".</p>\n\n<p>You could insert bookmarks with \"&amp;\" in Windows versions of Word in VBA by using InsertXML to insert a chunk of XML with a preconfigured bookmark name (see some simple sample code below) but I suspect you would have to work rather harder to move a bookmark. You would probably have to extract the exiting XML of the thing you wanted to \"cover\", then surround it with the bookmarkStart and bookmarkEnd tags, and that sounds like a pretty nasty exercise to me.</p>\n\n<p>As a final observation, AFAICR the bookmark names that you can specify for legacy form fields have a 20-character length restriction.</p>\n\n<p>That code:</p>\n\n<pre><code>Sub insertbm()\nDim x As String\nx = \"\"\nx = x &amp; \"&lt;?xml version='1.0' encoding='utf-8' standalone='yes'?&gt;\"\nx = x &amp; \"&lt;pkg:package xmlns:pkg='http://schemas.microsoft.com/office/2006/xmlPackage'&gt;\"\nx = x &amp; \"  &lt;pkg:part pkg:name='/_rels/.rels' pkg:contentType='application/vnd.openxmlformats-package.relationships+xml'&gt;\"\nx = x &amp; \"    &lt;pkg:xmlData&gt;\"\nx = x &amp; \"      &lt;Relationships xmlns='http://schemas.openxmlformats.org/package/2006/relationships'&gt;\"\nx = x &amp; \"        &lt;Relationship Id='rId1' Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument' Target='word/document.xml' /&gt;\"\nx = x &amp; \"      &lt;/Relationships&gt;\"\nx = x &amp; \"    &lt;/pkg:xmlData&gt;\"\nx = x &amp; \"  &lt;/pkg:part&gt;\"\nx = x &amp; \"  &lt;pkg:part pkg:name='/word/document.xml' pkg:contentType='application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml'&gt;\"\nx = x &amp; \"    &lt;pkg:xmlData&gt;\"\nx = x &amp; \"      &lt;w:document xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main'&gt;\"\nx = x &amp; \"        &lt;w:body&gt;\"\nx = x &amp; \"          &lt;w:p&gt;\"\nx = x &amp; \"            &lt;w:bookmarkStart w:id='0' w:name='bookmark&amp;amp;name' /&gt;\"\nx = x &amp; \"            &lt;w:r&gt;\"\nx = x &amp; \"              &lt;w:t&gt;\"\nx = x &amp; \"bookmarkedtext&lt;/w:t&gt;\"\nx = x &amp; \"            &lt;/w:r&gt;\"\nx = x &amp; \"            &lt;w:bookmarkEnd w:id='0' /&gt;\"\nx = x &amp; \"          &lt;/w:p&gt;\"\nx = x &amp; \"        &lt;/w:body&gt;\"\nx = x &amp; \"      &lt;/w:document&gt;\"\nx = x &amp; \"    &lt;/pkg:xmlData&gt;\"\nx = x &amp; \"  &lt;/pkg:part&gt;\"\nx = x &amp; \"&lt;/pkg:package&gt;\"\nSelection.InsertXML x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3084170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5991cd15d7b0a0a9f19b4fd7fd63df7?s=128&d=identicon&r=PG&f=1", "display_name": "user3084170", "link": "https://stackoverflow.com/users/3084170/user3084170"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 0, "accepted_answer_id": 28481695, "answer_count": 1, "score": 0, "last_activity_date": 1423755855, "creation_date": 1423676060, "last_edit_date": 1423696288, "question_id": 28460749, "link": "https://stackoverflow.com/questions/28460749/vba-word-why-can-word-use-special-chars-in-bookmark-creation-and-i-cant", "title": "vba Word: Why can Word use special chars in bookmark creation, and I cant?", "body": "<p>Here's a head-splitter: \nI'm trying to programmatically create hidden bookmarks for existing headings in a doc, so that I can create hyperlinks elsewhere in the doc that point to these bookmarks. (I want to use hyperlinks instead of cross-references so I can specify my own 'Display Text' for the links, which isnt possible using cross-refs). </p>\n\n<p>I want my bookmarks to be named after the headings they relate to, with a custom prefix. \nExample: </p>\n\n<ol>\n<li>style: Heading1</li>\n<li>heading text: Entrance &amp; Hallway</li>\n<li>bookmark name: _Hd1_Entrance_&amp;_Hallway</li>\n</ol>\n\n<p>I'm specifying a custom prefix to make each bookmark unique to it's style, so I can then have 2 matching headings in the doc, so long as they are in different heading styles. (example: <em>_Hd1_Entrance_&amp;_Hallway</em> and <em>_Hd3_Entrance_&amp;_Hallway</em>)</p>\n\n<p>The catch is: if my heading contains special chars like '&amp;', I get a 'Bad Bookmark Name' error, which I understand, and this is documented on the web. I'm only allowed to use a limited character set. </p>\n\n<p>So how come if I manually create a hyperlink using Word's own dialog, selecting a 'Place In This Document' such as a heading like \"Entrance &amp; Hallway\", Word manages this no problem? Once the Hlink is created, I can now see the hidden bookmark associated with this Hlink in Word's 'Bookmarks' dialog - and it's quite happily named \"_Entrance _&amp;_Hallway\". This confounds me! </p>\n\n<p>Anyone have an explanation? I'd really like to be able to leverage this same functionality, but cannot fathom how. Any help is greatly valued! \nThanks, </p>\n\n<pre><code>Sub ScratchPad_Bookmarks()\nDim doc As Document\nDim rng As Range\nDim sHdName As String\nDim sBmName As String\n    Set doc = ActiveDocument\n    'Insert a heading at start of document\n    sHdName = \"Entrance &amp; Hallway\"\n    doc.Range.InsertBefore sHdName &amp; vbCr\n    doc.Paragraphs(1).Range.Style = doc.Styles(\"Heading 1\")\n\n    'Find the above heading in the active document\n    Set rng = doc.Range\n    With rng.Find\n        .ClearFormatting\n        .Text = sHdName\n        .Style = \"Heading 1\"\n        If Not .Execute Then\n            'Heading not found, so quit\n            Exit Sub\n        End If\n    End With\n\n    'rng has collapsed to the found heading, so create a bookmark\n    'rng.Select 'debug\n    sBmName = Replace(rng.Text, \" \", \"_\")\n    rng.Collapse wdCollapseStart\n    rng.Bookmarks.Add sBmName\n    'sBmName contains '&amp;' so this throws a Runtime error:\n    '5828: Bad Bookmark Name  (as expected)\nEnd Sub\n</code></pre>\n\n<p>The above doesnt work. However to test the manual operation yourself is easy. Just create a heading that includes a '&amp;' character, style it as <em>Heading 1</em>. \nIn the next paragraph, insert a hyperlink using Word's own dialog. Select <em>Place In This Doc</em> and select the heading you just created. Shouldn't be a problem. \nNow open Word's Bookmark dialog, enable the <em>Hidden Bookmarks</em> view, and voila: a hidden bookmark with a '&amp;' character. (Wd 2010) Say what?!</p>\n"}, {"tags": ["excel", "find", "runtime-error", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "edited": false, "score": 0, "creation_date": 1423678371, "post_id": 28461396, "comment_id": 45248731, "body": "Thanks El Scripto, I&#39;ve confirmed that tRng is set, and I also know that &quot;Program Description&quot; will necessarily be present in any spreadsheet searched."}], "tags": [], "owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "is_accepted": false, "score": 0, "last_activity_date": 1423678294, "creation_date": 1423678294, "answer_id": 28461396, "question_id": 28460641, "link": "https://stackoverflow.com/questions/28460641/type-mismatch-error-with-find-method-in-vba/28461396#28461396", "title": "&#39;Type Mismatch&#39; Error with .Find() method in VBA", "body": "<p>It is possible that tRng is set to nothing, so the problem is not with the returned value of find, but rather with the parameter you give it.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "edited": false, "score": 0, "creation_date": 1423679895, "post_id": 28461594, "comment_id": 45249591, "body": "Thank you so much @genespos! I think the problem was that tRng is in column A and I&#39;m searching for fCode in column C. I ended up updating tRng after the find to be the Range column C, row tRng.row"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": true, "score": 4, "last_activity_date": 1423679630, "last_edit_date": 1423679630, "creation_date": 1423678952, "answer_id": 28461594, "question_id": 28460641, "link": "https://stackoverflow.com/questions/28460641/type-mismatch-error-with-find-method-in-vba/28461594#28461594", "title": "&#39;Type Mismatch&#39; Error with .Find() method in VBA", "body": "<p>I think the problem is in \"After:=tRng\": it may be out of the range of the \"find\"</p>\n\n<pre><code>Dim rng As Range:   Set rng = proj.Range(\"C:C\").Find(What:=fCode, After:=tRng)\n</code></pre>\n\n<p>Try removing \"After:=tRng\" and, if it works after removing, then try to insert a correct range.</p>\n\n<pre><code>Dim rng As Range:   Set rng = proj.Range(\"C:C\").Find(What:=fCode)\n</code></pre>\n\n<p>I'm not sure that's what you need, but you can try:</p>\n\n<pre><code>Dim rng:    Set rng = proj.Range(\"C:C\").Find(What:=fCode, After:=proj.Range(\"C\" &amp; tRng.Row))\n</code></pre>\n\n<p>It finds the first 'fCode' starting by the row where was found \"Program Description\"</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 5636495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHxsV.jpg?s=128&g=1", "display_name": "MicrosoftShouldBeKickedInNuts", "link": "https://stackoverflow.com/users/5636495/microsoftshouldbekickedinnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1534593070, "creation_date": 1534593070, "answer_id": 51908342, "question_id": 28460641, "link": "https://stackoverflow.com/questions/28460641/type-mismatch-error-with-find-method-in-vba/51908342#51908342", "title": "&#39;Type Mismatch&#39; Error with .Find() method in VBA", "body": "<p>If you are scratching your head because all logical explanations (such as those above) do not fit, it may be CORRUPTION. I have a live workbook example where, as absurd as it looks, a sheet (with nothing on it; hitting control end lands on A1) reproducibly shows ?activesheet.usedrange.address giving \"$B$1:$A$1\" and ?activesheet.usedrange.count gives 0.</p>\n\n<p>Thus a most rigorous coding defense should test, BEFORE doing the find,</p>\n\n<pre><code>If Not Intersect(tRng, proj.Range(\"A:A\")) Is Nothing\n</code></pre>\n\n<p>for the example above, and before any general range expression for {expression}.find,</p>\n\n<pre><code>If Not Intersect(tRng, {expression}) Is Nothing\n</code></pre>\n\n<p>Your \"Else\" could drill into the issue, e.g.</p>\n\n<pre><code>msgbox tRng.address &amp; \"/\" &amp; {expression}.address\n</code></pre>\n\n<p>The If statement would prevent the Type Mismatch error, not only if you \"illegally\" or improperly set an \"After:\" that is not in the search range, but also for at least some cases of corrupt workbooks such as I have encountered IRL. Corrupt workbooks are scary, brutally dangerous, but Microsoft won't address the problem, so corruption is going to happen; testing such as above would at least serve to sound a potential corruption alarm (if applicable), as well as serve the basic function of simply identifying if you had an (After and {expression}) combination that is not permitted.</p>\n"}], "owner": {"reputation": 33, "user_id": 3735566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ff646b040f3cb7eb6cef80b06fdd86?s=128&d=identicon&r=PG&f=1", "display_name": "AllyB", "link": "https://stackoverflow.com/users/3735566/allyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10208, "favorite_count": 0, "accepted_answer_id": 28461594, "answer_count": 3, "score": 1, "last_activity_date": 1534593070, "creation_date": 1423675695, "last_edit_date": 1531164843, "question_id": 28460641, "link": "https://stackoverflow.com/questions/28460641/type-mismatch-error-with-find-method-in-vba", "title": "&#39;Type Mismatch&#39; Error with .Find() method in VBA", "body": "<p>I'm writing a sub in Excel VBA, and it keeps giving me a 'Type Mismatch' error message when trying to assign the result of a .Find() to a Range variable. I feel pretty confident that my types are appropriate, so perhaps there's a syntax error somewhere?</p>\n\n<p>Help would be GREATLY appreciated:\n(Line preceded by asterisks is where error is thrown)</p>\n\n<pre><code>Sub totalTiger(fCode As String, project As String, ttls() As Double)\n\n    'Set shorcuts to Worksheets\n    Dim this As Workbook:   Set this = ThisWorkbook\n    Dim proj As Worksheet:  Set proj = this.Worksheets(project)\n\n    'Dim req variables\n    Dim tRng As Range:  Set tRng = proj.Range(\"A:A\").Find(What:=\"Program Description\")   'Establish where Staff data ends and Tiger data begins\n    ***Dim rng As Range:   Set rng = proj.Range(\"C:C\").Find(What:=fCode, After:=tRng)   'First fCode entry***\n\n    'For each fCode entry BEFORE the Tiger data, sum the assignments by month\n    Do While Not rng Is Nothing And rng.row &gt; tRng.row\n\n        'For each month\n        For col = 4 To 15\n\n            'Add this month's assignment to our running total\n            ttls(col - 4) = ttls(col - 4) + CDbl(proj.Cells(rng.row, col).Value)\n\n        Next\n\n        'Update the rng reference\n        Set rng = proj.Range(\"C:C\").Find(What:=fCode, After:=rng)\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1423680297, "post_id": 28461596, "comment_id": 45249848, "body": "I added that, but it&#39;s not really doing anything. I don&#39;t know if maybe I&#39;m missing something. In the comments you have stuff written, but I&#39;m not sure if I&#39;m suppose to add stuff there."}, {"owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "reply_to_user": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1423681220, "post_id": 28461596, "comment_id": 45250423, "body": "The code above loops over the existing files of the C:\\Users\\Sam\\Desktop\\Workbooks   folder.     This is something to help to get started. If you want to work of the file, then you need to add relevant code inside the loop."}, {"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1423681697, "post_id": 28461596, "comment_id": 45250681, "body": "That make sense. I don&#39;t have any coding though. I&#39;m not really  good at coding. This code is something I got over the internet. So essentially I would add the code to extract the data from the workbooks and paste it onto my master workbook?"}, {"owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "reply_to_user": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "edited": false, "score": 0, "creation_date": 1423681908, "post_id": 28461596, "comment_id": 45250806, "body": "It is a bit a hard for me to understand the entire process, but it seems that that is the right direction (BTW- I did an edit and correct the loop condition)."}], "tags": [], "owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "is_accepted": false, "score": 0, "last_activity_date": 1423681704, "last_edit_date": 1423681704, "creation_date": 1423678958, "answer_id": 28461596, "question_id": 28459533, "link": "https://stackoverflow.com/questions/28459533/vba-code-to-loop-data-from-multiple-workbooks/28461596#28461596", "title": "vba code to loop data from multiple workbooks", "body": "<p>Here is something to get you going (I am not sure I can help you with all your mission):</p>\n\n<pre><code>Sub Test1()\nmyFolder$ = \"C:\\Users\\Sam\\Desktop\\Workbooks\" &amp; \"\\\"\ncurrFile$ = Dir(myFolder)\n\n' EDIT -While Not currFile = vbNullStringWorkbooks\nWhile Not currFile = vbNullString\n    ' !!! I DO NO KNOW WHAT THIS IS :\n    ' ---------------------------------\n    'Open(myFolder &amp; \"\\\" &amp; currFile)\n    ' \u2018// Copy data code hereWorkbooks(currFile).Close\n    'False\n    ' ---------------------------------\n    currFile = Dir()\nWend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423681704, "creation_date": 1423672522, "last_edit_date": 1531164843, "question_id": 28459533, "link": "https://stackoverflow.com/questions/28459533/vba-code-to-loop-data-from-multiple-workbooks", "title": "vba code to loop data from multiple workbooks", "body": "<p>I am in need of a little help getting this code going. I have a master workbook that has 20+ sheets in it. Each employee has their own sheet title Employee-(Worker's name). I created a temp file (All workbooks are saved here) and each workbook is a duplicate of the sheets titled Employee-(worker's name) and the workbook's file name is (worker's name).xlsm</p>\n\n<p>Each worker can then update their workbooks and those updates are sent to the (worker's name).xlsm workbook which in turn will be looped to the Master workbook at the end of the day to update those sheets that are name exactly the same in each workerbook. </p>\n\n<p>Here's a code that someone had given me but I'm not really sure where to put it or how to go about doing my goal above.</p>\n\n<pre><code>myFolder$ = \n\u201cC:\\Users\\Sam\\Desktop\\Workbooks\u201dcurrFile$ = Dir(myFolder)While Not currFile = \nvbNullStringWorkbooks.Open(myFolder &amp; \n\u201c\\\u201d &amp; currFile)\u2018// Copy data code hereWorkbooks(currFile).Close \nFalsecurrFile = \nDir()Wend \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4442520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c32b5f3560e7bedd77c5eec6a0c591?s=128&d=identicon&r=PG&f=1", "display_name": "zois miaoulis", "link": "https://stackoverflow.com/users/4442520/zois-miaoulis"}, "edited": false, "score": 0, "creation_date": 1423680088, "post_id": 28460074, "comment_id": 45249719, "body": "this code work but when a value deleted from a cell in column A deleted also from the cell in B.is like B1=A1.is possible if i delete the values in A don&#39;t deleted in B?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3, "user_id": 4442520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c32b5f3560e7bedd77c5eec6a0c591?s=128&d=identicon&r=PG&f=1", "display_name": "zois miaoulis", "link": "https://stackoverflow.com/users/4442520/zois-miaoulis"}, "edited": false, "score": 0, "creation_date": 1423680453, "post_id": 28460074, "comment_id": 45249938, "body": "@zoismiaoulis  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1423680429, "last_edit_date": 1423680429, "creation_date": 1423674029, "answer_id": 28460074, "question_id": 28459324, "link": "https://stackoverflow.com/questions/28459324/if-cell-has-value-copy-to-the-next-column-same-row-vba-code/28460074#28460074", "title": "If cell has value copy to the next column same row vba code", "body": "<p>Whatever you enter in column <strong>A</strong> will be copied to column <strong>B</strong> <em>(even blanks!!)</em></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range, intr As Range, r As Range\n    Set A = Range(\"A:A\")\n    Set intr = Intersect(A, Target)\n    If intr Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False\n        For Each r In intr\n            r.Copy r.Offset(0, 1)\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This version will <strong>not</strong> clear the value in column <strong>B</strong> if the value in <strong>A</strong> is cleared:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range, intr As Range, r As Range\n    Set A = Range(\"A:A\")\n    Set intr = Intersect(A, Target)\n    If intr Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False\n        For Each r In intr\n            If r.Value &lt;&gt; \"\" Then\n                r.Copy r.Offset(0, 1)\n            End If\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><em>BE SURE TO DELETE THE OLD VERSION BEFORE INSTALLING THE NEW VERSION.</em></p>\n"}], "owner": {"reputation": 3, "user_id": 4442520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c32b5f3560e7bedd77c5eec6a0c591?s=128&d=identicon&r=PG&f=1", "display_name": "zois miaoulis", "link": "https://stackoverflow.com/users/4442520/zois-miaoulis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1374, "favorite_count": 0, "accepted_answer_id": 28460074, "answer_count": 1, "score": 0, "last_activity_date": 1425703223, "creation_date": 1423671921, "last_edit_date": 1531164843, "question_id": 28459324, "link": "https://stackoverflow.com/questions/28459324/if-cell-has-value-copy-to-the-next-column-same-row-vba-code", "title": "If cell has value copy to the next column same row vba code", "body": "<p>I'm looking for a macro which will copy any cell in column <code>A</code> if that has value in column <code>B</code> in the same row, e.g if <code>A14</code>=<code>\"zois\"</code> copy <code>\"zois\"</code> to <code>B14</code>.</p>\n\n<p>I have this code but most of the times when a blank cell in <code>A</code> take a value  not copied in <code>B</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Not Intersect(Target, [A1]) Is Nothing Then  \n    [b1:B100] = [a1:a100].Value \n  End If  \nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423672310, "post_id": 28458983, "comment_id": 45245094, "body": "tldr but, is your navigation pane set to &quot;Custom&quot; view?"}, {"owner": {"reputation": 339, "user_id": 2415417, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f2e036c508237258dd6cce6b87977ee?s=128&d=identicon&r=PG", "display_name": "theHamburglar", "link": "https://stackoverflow.com/users/2415417/thehamburglar"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423673921, "post_id": 28458983, "comment_id": 45246157, "body": "Jens, my navigation pane was set to Custom - changing it resolves the &quot;Shortcut&quot; issue!"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": true, "score": 1, "last_activity_date": 1423674057, "creation_date": 1423674057, "answer_id": 28460085, "question_id": 28458983, "link": "https://stackoverflow.com/questions/28458983/where-are-the-ms-access-tables-i-have-shortcuts-to/28460085#28460085", "title": "Where are the MS Access tables I have shortcuts to?", "body": "<p>Well, it seems it was as simple as changing the view in your navigation pane to something else than <a href=\"https://support.office.com/en-us/article/Create-and-manage-custom-categories-and-groups-in-the-Navigation-Pane-ccfb0ee7-d72f-4923-b4fb-ed6c15484244?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow\">custom!</a></p>\n"}], "owner": {"reputation": 339, "user_id": 2415417, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3f2e036c508237258dd6cce6b87977ee?s=128&d=identicon&r=PG", "display_name": "theHamburglar", "link": "https://stackoverflow.com/users/2415417/thehamburglar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 28460085, "answer_count": 1, "score": 0, "last_activity_date": 1423674057, "creation_date": 1423670950, "last_edit_date": 1423671006, "question_id": 28458983, "link": "https://stackoverflow.com/questions/28458983/where-are-the-ms-access-tables-i-have-shortcuts-to", "title": "Where are the MS Access tables I have shortcuts to?", "body": "<p>I have a MS Access 2013 file that I am using.  There are two possibly related concerns.  For some context, this is an MS Access 2013 file with some forms and some tables and a bit of VBA for the logic of how those two interact.  For versioning, the file has been copied and pasted with a datestamp on it for the newer version.</p>\n\n<p>The first concern is that all the file sizes for the various files is exactly the same, even though data has been added and some changes to the forms were made.</p>\n\n<p>The second concern is that when I right click on a table and go to table properties, it says \"Shortcut to Table (Local): table_name\"  where table_name is the name of the table.  It appears that this is a shortcut to a table somewhere, but I'm not sure where.  The forms are also shortcuts to forms, but I don't see the destination form in my file anywhere, even after unhiding system objects.  My questions regarding this are: how did this happen (I was assuming it had something to do with the fact that I copied and pasted the file) and where is the file that these are a shortcut to?</p>\n\n<p>Everything seems to work fine, but I'm concerned that if one of the legacy files gets removed that I might lose some data.  Is my data being stored within this file, or did it get split somehow and the data is being stored in a different file somewhere?  I just want to have a better grasp of what exactly is going on.</p>\n\n<p>I feel like I have a good handle on the SQL and a pretty good grasp of the VBA, but the MS Access specific nuances are something I'm still gaining familiarity with.</p>\n"}, {"tags": ["vba", "if-statement", "printing"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "edited": false, "score": 0, "creation_date": 1423674846, "post_id": 28459665, "comment_id": 45246693, "body": "Ok, I&#39;ve used this before I added the print titles, but whenever parow is equal to a multiple of 14 it adds an extra empty page, instead of keeping it as is. I guess I can add one if loop to check for this."}, {"owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "edited": false, "score": 0, "creation_date": 1423680939, "post_id": 28459665, "comment_id": 45250232, "body": "Figured it out! <code>parow = wsp.Range(&quot;a&quot; &amp; Rows.Count).End(xlUp).row  If Not (parow-1) Mod 14 = 0 then parow = parow+ (parow mod 14) Else End If</code>"}], "tags": [], "owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "is_accepted": true, "score": 0, "last_activity_date": 1423672861, "creation_date": 1423672861, "answer_id": 28459665, "question_id": 28458681, "link": "https://stackoverflow.com/questions/28458681/setting-print-area-for-a-whole-page/28459665#28459665", "title": "Setting print area for a whole page", "body": "<p>Instead of the big mess of ifs, try this:</p>\n\n<pre><code>Dim parow As Long\nDim dif As Long\nparow = wsp.Range(\"A\" &amp; Rows.Count).End(xlUp).row\ndif = 14 - (parow mod 14)\nparow = parow + dif + 1\n</code></pre>\n\n<p>From your question it looks like you want to round parow up to the nearest multiple of 14, then print that many rows + 1.</p>\n\n<p>With that in mind this code first gets parow as you do originally, then works out what would need to be added to round it up to the next multiple of 14. Finally it adds that value + 1 to parow. For a shorter (but less readable option) simply use </p>\n\n<pre><code>parow = wsp.Range(\"A\" &amp; Rows.Count).End(xlUp).row\nparow = parow + (14 - (parow mod 14)) + 1\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 28459665, "answer_count": 1, "score": 0, "last_activity_date": 1423672861, "creation_date": 1423670074, "question_id": 28458681, "link": "https://stackoverflow.com/questions/28458681/setting-print-area-for-a-whole-page", "title": "Setting print area for a whole page", "body": "<p>So this is my problem:\nI have a template sheet into which data is pasted. The amount of rows of data will always differ (I dont think it will ever be higher than 30, but I coded capacity of 103)\nAfter the data is pasted, the sub should set the print area and borders accordingly, but not to the last row of data, but to the last page that contains data. I wrote this ugliness and it seems to work. I do wonder if there is a way to do this without nesting IF statements (I will have to do this all over again for a much larger data set)</p>\n\n<pre><code>parow = wsp.Range(\"A\" &amp; Rows.Count).End(xlUp).row\n    If parow &lt;= 15 Then\n        parow = 15\n    Else:\n        If parow &lt;= 29 Then\n            parow = 29\n        Else\n        If parow &lt;= 43 Then\n            parow = 43\n        Else\n            If parow &lt;= 58 Then\n                parow = 58\n            Else\n                If parow &lt;= 73 Then\n                    parow = 73\n                Else\n                    If parow &lt;= 88 Then\n                        parow = 88\n                    Else\n                        If parow &lt;= 103 Then\n                            parow = 103\n                        Else\n                        End If\n                    End If\n                End If\n            End If\n        End If\n        End If\n    End If\n\nWith wsp.PageSetup\n    .PrintArea = \"$A$1:$G\" &amp; parow\n    .PrintTitleRows = \"$1:$1\"\n    .Orientation = xlLandscape\n    .FitToPagesWide = 1\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 548, "user_id": 2337102, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0de35615ee17427a06525d2062483c97?s=128&d=identicon&r=PG&f=1", "display_name": "MrsAdmin", "link": "https://stackoverflow.com/users/2337102/mrsadmin"}, "edited": false, "score": 0, "creation_date": 1423670622, "post_id": 28458364, "comment_id": 45243991, "body": "Most of the transpose answers resolve both columns to single lines.  I need to take it from the pivot (ie Order1) then moving just the results to their new columns. As I pointed out, I do have a formula that does it, however I would like it in VBA.  I&#39;ve been looking at this for days."}, {"owner": {"reputation": 4918, "user_id": 1148071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc052cf4dfde1601135daca08895ecef?s=128&d=identicon&r=PG", "display_name": "cello", "link": "https://stackoverflow.com/users/1148071/cello"}, "edited": false, "score": 0, "creation_date": 1423670638, "post_id": 28458364, "comment_id": 45244003, "body": "Excel can transpose the table using &quot;copy&quot; and &quot;paste special\u2026&quot;. These two commands should also be available in VBA"}], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 2337102, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0de35615ee17427a06525d2062483c97?s=128&d=identicon&r=PG&f=1", "display_name": "MrsAdmin", "link": "https://stackoverflow.com/users/2337102/mrsadmin"}, "edited": false, "score": 0, "creation_date": 1423671902, "post_id": 28459137, "comment_id": 45244804, "body": "I&#39;m an idiot :)  (exhausted) I copied the wrong column data over - your code worked, but I needed to put in <code>v = s1.Cells(i, 2).Value</code> not <code>1</code>.  Your answer is perfect, thank you.  :)"}, {"owner": {"reputation": 548, "user_id": 2337102, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0de35615ee17427a06525d2062483c97?s=128&d=identicon&r=PG&f=1", "display_name": "MrsAdmin", "link": "https://stackoverflow.com/users/2337102/mrsadmin"}, "edited": false, "score": 0, "creation_date": 1423672166, "post_id": 28459137, "comment_id": 45244982, "body": "Thank you.  I plan to pair this with a VBA snippet that moves columns around so I can slide it in to match other data already in the book.  This has saved me a lot of time, thank you."}, {"owner": {"reputation": 548, "user_id": 2337102, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0de35615ee17427a06525d2062483c97?s=128&d=identicon&r=PG&f=1", "display_name": "MrsAdmin", "link": "https://stackoverflow.com/users/2337102/mrsadmin"}, "edited": false, "score": 0, "creation_date": 1423728330, "post_id": 28459137, "comment_id": 45268576, "body": "Sorry to be a pain. Is there a way to start the process on A10 and paste it to A10 on the next sheet?  I&#39;ve tried using A10 in <code>N = s1.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> (&amp; associated others) and I keep getting debugging errors.  My data starts on row 10 &amp; it&#39;s picking all my headers :D"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 548, "user_id": 2337102, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0de35615ee17427a06525d2062483c97?s=128&d=identicon&r=PG&f=1", "display_name": "MrsAdmin", "link": "https://stackoverflow.com/users/2337102/mrsadmin"}, "edited": false, "score": 1, "creation_date": 1423743747, "post_id": 28459137, "comment_id": 45277522, "body": "@MrsAdmin  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1423743718, "last_edit_date": 1423743718, "creation_date": 1423671390, "answer_id": 28459137, "question_id": 28458364, "link": "https://stackoverflow.com/questions/28458364/excel-2010-move-cells-from-vertical-data-to-horizontal-with-vba/28459137#28459137", "title": "Excel 2010: Move cells from vertical data to horizontal with VBA", "body": "<p>If we start with:</p>\n\n<p><img src=\"https://i.stack.imgur.com/gLeKV.png\" alt=\"enter image description here\"></p>\n\n<p>with a blank between orders in <em>Sheet1</em>, then this macro:</p>\n\n<pre><code>Sub reorg()\n    Dim s1 As Worksheet, s2 As Worksheet, N As Long, i As Long, j As Long, k As Long\n    Dim v As Variant\n    Set s1 = Sheets(\"Sheet1\")\n    Set s2 = Sheets(\"Sheet2\")\n    N = s1.Cells(Rows.Count, \"A\").End(xlUp).Row\n    j = 1\n    k = 1\n\n    For i = 1 To N\n        v = s1.Cells(i, 1).Value\n        If v = \"\" Then\n            j = j + 1\n            k = 1\n        Else\n            s2.Cells(j, k) = v\n            k = k + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>will produce this in <em>Sheet2</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/iwr6i.png\" alt=\"enter image description here\"></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To use <strong>A10</strong> as both the start and destination, use:</p>\n\n<pre><code>Sub reorg()\n    Dim s1 As Worksheet, s2 As Worksheet, N As Long, i As Long, j As Long, k As Long\n    Dim v As Variant\n    Set s1 = Sheets(\"Sheet1\")\n    Set s2 = Sheets(\"Sheet2\")\n    N = s1.Cells(Rows.Count, \"A\").End(xlUp).Row\n    j = 10\n    k = 1\n\n    For i = 10 To N\n        v = s1.Cells(i, 1).Value\n        If v = \"\" Then\n            j = j + 1\n            k = 1\n        Else\n            s2.Cells(j, k) = v\n            k = k + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 2337102, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0de35615ee17427a06525d2062483c97?s=128&d=identicon&r=PG&f=1", "display_name": "MrsAdmin", "link": "https://stackoverflow.com/users/2337102/mrsadmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2405, "favorite_count": 0, "accepted_answer_id": 28459137, "answer_count": 1, "score": 0, "last_activity_date": 1423743718, "creation_date": 1423669173, "last_edit_date": 1531164843, "question_id": 28458364, "link": "https://stackoverflow.com/questions/28458364/excel-2010-move-cells-from-vertical-data-to-horizontal-with-vba", "title": "Excel 2010: Move cells from vertical data to horizontal with VBA", "body": "<p><strong>Excel 2010</strong>  </p>\n\n<p>I want to move the following data from it's vertical state to horizontal data.  I would like a solution in VBA please.  (I already have a formula).</p>\n\n<p>Order = (A10)    Result = (B10)  runs over 1000 rows</p>\n\n<pre><code>| Order1         | result                                                                       \n| line1          | result 1\n| line2          | result 1\n| line3          | result 1\n| line4          | result 1\n| line5          | result 1\n| line6          | result 1\n| line7          | result 1\n| line8          | result 1\n|      br        |                                                                           \n| Order2         | result                                                                   \n| line1          | result 1\n| line2          | result 1\n| line3          | result 1\n| line4          | result 1\n| line5          | result 1\n| line6          | result 1\n| line7          | result 1\n| line8          | result 1\n</code></pre>\n\n<p>I want it to resolve as:</p>\n\n<pre><code>Order 1  |  result1  |  result2  |  result3  |  result4  |  result5  |  result6  |  result7  |  result8  |  \nOrder 2  |  result1  |  result2  |  result3  |  result4  |  result5  |  result6  |  result7  |  result8  |  \n</code></pre>\n\n<p>Thanks in advance</p>\n\n<p><strong>EDIT</strong><br>\nMy current formula is this:\n(C10)  <code>=IF(A3=\"Order1 \",1,0)</code>  (result:  1)<br>\n(D10)  <code>=IF($C3=1,B3,0)</code>        (result:  result from line1)<br>\n(E10)  <code>=IF($C3=1,B10,0)</code>       (result:  result from line2)<br>\nand so on.</p>\n\n<p>I then copy and autofill the entire sheet of data and it fills it all in.\nAnd I build the new table this way.</p>\n\n<p>When I macro record it doesn't record the actual formulas that I have in the cells.      </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vlookup", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4555365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54477bce700921b29c4bc954032f93ee?s=128&d=identicon&r=PG&f=1", "display_name": "waxrgnt", "link": "https://stackoverflow.com/users/4555365/waxrgnt"}, "edited": false, "score": 0, "creation_date": 1424090659, "post_id": 28461773, "comment_id": 45396753, "body": "That is the direction I need to go, however I need Sheeet1!B1 to be compared to the entire column of Sheet2!D"}, {"owner": {"reputation": 5, "user_id": 4555365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54477bce700921b29c4bc954032f93ee?s=128&d=identicon&r=PG&f=1", "display_name": "waxrgnt", "link": "https://stackoverflow.com/users/4555365/waxrgnt"}, "edited": false, "score": 0, "creation_date": 1424094436, "post_id": 28461773, "comment_id": 45399094, "body": "This is what I am currently trying, I moved all of the data to one sheet.  =IF(A2=(K2:K1000),IF(B2=(L2:L1000),(D20,P10),&quot;no match&quot;))"}], "tags": [], "owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "is_accepted": true, "score": 0, "last_activity_date": 1423679522, "creation_date": 1423679522, "answer_id": 28461773, "question_id": 28458134, "link": "https://stackoverflow.com/questions/28458134/comparing-cells-in-one-worksheet-to-columns-in-another-and-printing-the-rows-tha/28461773#28461773", "title": "Comparing cells in one worksheet to columns in another and printing the rows that match in a third worksheet", "body": "<p>Does this help ? \n(a formula to put in cells in sheet3)</p>\n\n<pre><code>=IF(Sheet1!B1=Sheet1!D1,Sheet1!B1,\"\")\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4555365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54477bce700921b29c4bc954032f93ee?s=128&d=identicon&r=PG&f=1", "display_name": "waxrgnt", "link": "https://stackoverflow.com/users/4555365/waxrgnt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "accepted_answer_id": 28461773, "answer_count": 1, "score": 0, "last_activity_date": 1424226945, "creation_date": 1423668615, "last_edit_date": 1531161705, "question_id": 28458134, "link": "https://stackoverflow.com/questions/28458134/comparing-cells-in-one-worksheet-to-columns-in-another-and-printing-the-rows-tha", "title": "Comparing cells in one worksheet to columns in another and printing the rows that match in a third worksheet", "body": "<p>The data I am working with are strings, not integers.</p>\n\n<p>I want to take two columns in worksheet1, say column B and D and compare them to two columns in worksheet2, say C and E.</p>\n\n<p>If a cell in column B == a cell in column C and  a cell in column D on the same row as the cell in column B == a cell in column E on the same row as column C print the row that B and D are in next to the row C and E are in in worksheet3, if not, they don't need to be pasted into worksheet3.</p>\n\n<p>How do I approach this? I have tried Vlookups, match, If statements and even some macro, however I have little experience with macro and am struggling terribly. Any assistance is greatly appreciated, thank you!</p>\n\n<p>It won't let me post a picture that describes this easier so I apologize for the convoluted description.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1423669022, "creation_date": 1423669022, "answer_id": 28458294, "question_id": 28457875, "link": "https://stackoverflow.com/questions/28457875/copy-the-contents-of-a-documents-through-filedialogbox-picker-to-a-new-one/28458294#28458294", "title": "Copy the contents of a document(s) through FileDialogbox picker, to a new one", "body": "<p>I would try creating a new Word doc then using this line to \"insert the text from the protected Word doc.\" It's the same as going to the Insert Ribbon tab -> Object -> Text from File.</p>\n\n<pre><code>Selection.InsertFile FileName:=\"protected.docx\", Range:=\"\", _\n    ConfirmConversions:=False, Link:=False, Attachment:=False\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 28458294, "answer_count": 1, "score": 0, "last_activity_date": 1423685792, "creation_date": 1423667882, "last_edit_date": 1423685792, "question_id": 28457875, "link": "https://stackoverflow.com/questions/28457875/copy-the-contents-of-a-documents-through-filedialogbox-picker-to-a-new-one", "title": "Copy the contents of a document(s) through FileDialogbox picker, to a new one", "body": "<p>With MS_Word 2010 I have been trying to achieve the way to copy the contents(whole) of one file to a new one retrieving the file name of the original and adding it to the new one with the suffix \"Copy\".</p>\n\n<p>All this process has a reason, since the Original document has only a few editable section and have protection enable (And I cant disable it) but I need to review it with other macro, so with a Copy of the contents in a new document I have been able to apply my whole macro. I also know of the <strong><em>method CopyFile</em></strong> but since this method copy also the characteristic of the original doc (the constrains in edit) I decide not to use it.</p>\n\n<p>Searching around and using the recorder(for the copy actions) i have been able to come with this:</p>\n\n<pre><code>Sub Backup()\nDim DocName As String\nDim DocPath As String\n\n'Declare a variable as a FileDialog object.\nDim fd As FileDialog\n\n'Create a FileDialog object as a File Picker dialog box.\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\n\n'Declare a variable to contain the path of each selected item. Even though the path is aString, the variable must be a Variant because For Each...Next,  routines only work with Variants and Objects.\nDim vrtSelectedItem As Variant\n\n'Use a With...End With block to reference the FileDialog object.\nWith fd\n\n    'Allow the user to select multiple files.\n    .AllowMultiSelect = True\n\n    'Use the Show method to display the File Picker dialog box and return the user's action.\n    'If the user presses the button...\n    If .Show = -1 Then\n        'Step through each string in the FileDialogSelectedItems collection.\n        For Each vrtSelectedItem In .SelectedItems\n        On Error Resume Next\n\n            'vrtSelectedItem is aString that contains the path of each selected item. You can use any file I/O functions that you want to work with this path.\n            'MsgBox \"Selected item's path: \" &amp; vrtSelectedItem\n\n            'Retrieve the name of the current doc (later I found out about .Name, .Path, .FullName ...)\n            Dim fso\n            Set fso = CreateObject(\"Scripting.FileSystemObject\")\n            DocName = fso.GetBaseName(vrtSelectedItem)\n            'MsgBox \"Selected item's : \" &amp; DocName\n\n            'Retrieve the path without the filename/extention\n            Documents.Open(vrtSelectedItem).Active\n            DocPath = ActiveDocument.Path\n            'MsgBox \"Selected item's path: \" &amp; DocPath\n\n            'Copy the content of the current document\n            'With Documents(DocName)\n            With ActiveDocument\n                .WholeStory\n                .Copy\n            End With\n\n            'Create Backup File with ability to modify it, since the original is protected by password and only few segments are enable to edit\n            Documents.Add Template:=DocName &amp; \"Copy\", NewTemplate:=False, DocumentType:=0\n\n            'Since Document.Add its suppose to promp as the Active document\n            'Paste the contents and save\n            'With Documents(DocName &amp; \"Copy\")\n            With ActiveDocument\n                .PasteAndFormat (wdUseDestinationStylesRecovery)\n                .SaveAs DocPath\n            End With\n            'Documents(DocName &amp; \"Copy\").Close SaveChanges:=True\n\n        Next\n    'If the user presses Cancel...\n    Else\n    End If\nEnd With\n'Set the object variable to Nothing.\nSet fd = Nothing\nEnd Sub\n</code></pre>\n\n<p>But as you guess, it doesn't work as desire and don't create the copy neither the new document with the name. So any scope in the right direction will be appreciate.\nThanks in advance for all the answers.</p>\n\n<hr>\n\n<p>For future reference here is the code improved, based in the Response of <em>@Charlie</em></p>\n\n<pre><code>Sub Backup()\nDim DocName As String\nDim NewDoc As Document\n\n'Declare a variable as a FileDialog object.\nDim fd As FileDialog\n\n'Create a FileDialog object as a File Picker dialog box.\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\n\n'Declare a variable to contain the path of each selected item. Even though the path is aString, the variable must be a Variant because For Each...Next,  routines only work with Variants and Objects.\nDim vrtSelectedItem As Variant\n\n'Use a With...End With block to reference the FileDialog object.\nWith fd\n\n    'Allow the user to select multiple files.\n    .AllowMultiSelect = True\n\n    'Use the Show method to display the File Picker dialog box and return the user's action.\n    'If the user presses the button...\n    If .Show = -1 Then\n        'Step through each string in the FileDialogSelectedItems collection.\n        For Each vrtSelectedItem In .SelectedItems\n        On Error Resume Next\n\n            'vrtSelectedItem is aString that contains the path of each selected item. You can use any file I/O functions that you want to work with this path.\n            'MsgBox \"Selected item's path: \" &amp; vrtSelectedItem\n\n            'Retrieve the name of the current doc (later I found out about .Name, .Path, .FullName ...)\n            Dim fso\n            Set fso = CreateObject(\"Scripting.FileSystemObject\")\n            DocName = fso.GetBaseName(vrtSelectedItem)\n            'MsgBox \"Selected item's : \" &amp; DocName\n\n            'Create Backup File with ability to modify it, since the original is protected by password and only few segments are enable to edit\n            Set NewDoc = Documents.Add\n\n            'Since Document.Add its suppose to promp as the Active document\n            'Paste the contents and save\n            With NewDoc\n                Selection.InsertFile FileName:=vrtSelectedItem, Range:=vbNullString, _\n                ConfirmConversions:=False, Link:=False, Attachment:=False\n                .SaveAs FileName:=vrtSelectedItem &amp; \"_BACKUP.docx\"\n                .Close\n            End With\n\n        Next\n    'If the user presses Cancel...\n    Else\n    End If\nEnd With\n'Set the object variable to Nothing.\nSet fd = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3, "user_id": 4555306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ng6MaOVI6VY/AAAAAAAAAAI/AAAAAAAAAeQ/tM5b_h6puKA/photo.jpg?sz=128", "display_name": "Chieri Thompson", "link": "https://stackoverflow.com/users/4555306/chieri-thompson"}, "edited": false, "score": 0, "creation_date": 1423668454, "post_id": 28457728, "comment_id": 45242518, "body": "I guess Im wanting the Prompt Message to detect that I have and Item selected in another account&#39;s inbox/folders aside DesignProofsTAC and have message ask me if i want to proceed."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4555306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ng6MaOVI6VY/AAAAAAAAAAI/AAAAAAAAAeQ/tM5b_h6puKA/photo.jpg?sz=128", "display_name": "Chieri Thompson", "link": "https://stackoverflow.com/users/4555306/chieri-thompson"}, "edited": false, "score": 0, "creation_date": 1423690065, "post_id": 28463964, "comment_id": 45255326, "body": "I probably should have mentioned that I am not a Programmer and that the code I am using is shared. I did not create it (I cannot write code - but can mix and match fairly well). I guess I was looking for help to modify it to accommodate the goal I was trying to achieve."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 3, "user_id": 4555306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ng6MaOVI6VY/AAAAAAAAAAI/AAAAAAAAAeQ/tM5b_h6puKA/photo.jpg?sz=128", "display_name": "Chieri Thompson", "link": "https://stackoverflow.com/users/4555306/chieri-thompson"}, "edited": false, "score": 0, "creation_date": 1423728870, "post_id": 28463964, "comment_id": 45268824, "body": "The web site is for developers. In that case I&#39;d suggest lkearning the basics or hire a freelancer to get the job done. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a>."}, {"owner": {"reputation": 3, "user_id": 4555306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ng6MaOVI6VY/AAAAAAAAAAI/AAAAAAAAAeQ/tM5b_h6puKA/photo.jpg?sz=128", "display_name": "Chieri Thompson", "link": "https://stackoverflow.com/users/4555306/chieri-thompson"}, "edited": false, "score": 0, "creation_date": 1423754220, "post_id": 28463964, "comment_id": 45284469, "body": "I see you have given me an option. Its appreciated!   Though, im not a &quot;certified&quot; programmer - I have written macros. But Only for CorelDraw (for work). So Basics are covered. Im a graphic designer. I got a &quot;brilliant&quot; idea to make one for Outlook to fix this work flow of ours... So I researched it. Found a code that I could work with. Realized everything about outlook is different and decided to seek help after failing over and over. I think i would have been ok with an example.. I do believe even that could have sufficed while I figured this out.  but in any repsect - all is appreciated."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 3, "user_id": 4555306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ng6MaOVI6VY/AAAAAAAAAAI/AAAAAAAAAeQ/tM5b_h6puKA/photo.jpg?sz=128", "display_name": "Chieri Thompson", "link": "https://stackoverflow.com/users/4555306/chieri-thompson"}, "edited": false, "score": 0, "creation_date": 1423754514, "post_id": 28463964, "comment_id": 45284655, "body": "There is no need to be a certified developer, start with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a>."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1423686863, "creation_date": 1423686863, "answer_id": 28463964, "question_id": 28457728, "link": "https://stackoverflow.com/questions/28457728/need-error-message-move-to-code/28463964#28463964", "title": "Need Error Message: Move To code", "body": "<p>The Namespace class provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff867142(v=office.15).aspx\" rel=\"nofollow\">Accounts</a> property which eturns an Accounts collection object that represents all the Account objects in the current profile. The Account class provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861633(v=office.15).aspx\" rel=\"nofollow\">DeliveryStore</a> property which returns a Store object that represents the default delivery store for the account. So, you can compare the Store where you chose the item and the default store for the account you need to move the item.</p>\n\n<p>Also you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869924(v=office.15).aspx\" rel=\"nofollow\">GetDefaultFolder</a> method of the Store class helpful, it returns a Folder object that represents the default folder in the store and that is of the type specified by the FolderType argument. This method is similar to the GetDefaultFolder method of the NameSpace object. The difference is that this method gets the default folder on the delivery store that is associated with the account, whereas NameSpace.GetDefaultFolder returns the default folder on the default store for the current profile.</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1423692670, "creation_date": 1423692670, "answer_id": 28465531, "question_id": 28457728, "link": "https://stackoverflow.com/questions/28457728/need-error-message-move-to-code/28465531#28465531", "title": "Need Error Message: Move To code", "body": "<p>You may find this simpler than checking accounts.</p>\n\n<p><strong>Untested Code:</strong></p>\n\n<pre><code>Option Explicit\n\nSub MoveOpenMail 'COMPLETED\n\n' Place a button on the Quick Access Toolbar for an item opened for reading.\n\n    Dim ns As NameSpace\n    Dim MoveToFolder As Folder\n    Dim objItem As object ' &lt;--- May not be a mailitem\n\n    Set ns = Application.GetNamespace(\"MAPI\")\n\n\n    ' Do not use On Error Resume Next \n    '  unless there is a specific purpose\n    '  and it is quickly followed by On Error GoTo 0\n    On Error Resume Next\n    Set MoveToFolder =  ns.Folders(\"designproofstac\").Folders(\"Inbox\").Folders(\"3_COMPLETED\") \n    On Error GoTo 0\n    If MoveToFolder Is Nothing Then\n        MsgBox \"Target folder not found!\", vbOKOnly + vbExclamation, \"MoveOpenMail VBA Error\"\n        GoTo ExitRoutine\n    End If\n\n    On Error Resume Next\n    Set objItem = ActiveInspector.CurrentItem\n    On Error GoTo 0\n    If objItem Is Nothing Then\n        MsgBox \"Use this code when there is an open mailitem!\", vbOKOnly + vbExclamation, \"MoveOpenMail VBA Error\"\n        GoTo ExitRoutine\n    End If\n\n    If MoveToFolder.DefaultItemType = olMailItem Then\n\n        If objItem.Class = olMail Then\n             objItem.Move MoveToFolder\n        End If\n\n    Else\n        MsgBox \"Target folder is wrong type!\", vbOKOnly + vbExclamation, \"MoveOpenMail VBA Error\"\n\n    End If\n\nExitRoutine:\n    Set ns = Nothing\n    Set MoveToFolder = Nothing\n    Set objItem = Nothing\n\nEnd Sub\n\n\n\nSub MoveSelectedMail 'COMPLETED\n\n' Place a button on the Quick Access Toolbar for an open folder\n\n    Dim ns As NameSpace\n    Dim MoveToFolder As Folder\n    Dim objItem as Object\n\n    Dim objExplorer As Explorer\n    Dim objSelection As Object\n    Dim x as Long\n\n    Set ns = Application.GetNamespace(\"MAPI\")\n\n    On Error Resume Next\n    Set MoveToFolder = ns.Folders(\"designproofstac\").Folders(\"Inbox\").Folders(\"3_COMPLETED\")\n    On Error GoTo 0\n    If MoveToFolder Is Nothing Then\n        MsgBox \"Target folder not found!\", vbOKOnly + vbExclamation, \"MoveSelectedMail VBA Error\"\n        GoTo ExitRoutine\n    End If\n\n    Set objExplorer = ActiveExplorer\n    Set objSelection = objExplorer.Selection\n\n    If objSelection.Count = 0 Then\n\n        MsgBox \"Select one or more mailitems\"\n        GoTo ExitRoutine\n\n    Else\n\n        If MoveToFolder.DefaultItemType = olMailItem Then\n\n            ' Do not use For Each\n            ' Count backwards when moving or deleting\n            For x = objSelection.Count to 1 step -1\n                Set objItem = objSelection.Item(x)\n                If objItem.Class = olMail Then\n                    objItem.Move MoveToFolder\n                End If\n            Next x\n\n        Else\n            MsgBox \"Target folder is wrong type!\", vbOKOnly + vbExclamation, \"MoveSelectedMail VBA Error\"\n\n        End If\n\n    End If    \n\nExitRoutine:\n    Set ns = Nothing\n    Set MoveToFolder = Nothing\n    Set objItem = Nothing\n\n    Set objExplorer = Nothing\n    Set objSelection = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4555306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ng6MaOVI6VY/AAAAAAAAAAI/AAAAAAAAAeQ/tM5b_h6puKA/photo.jpg?sz=128", "display_name": "Chieri Thompson", "link": "https://stackoverflow.com/users/4555306/chieri-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 28465531, "answer_count": 2, "score": 0, "last_activity_date": 1593475100, "creation_date": 1423667498, "last_edit_date": 1593475100, "question_id": 28457728, "link": "https://stackoverflow.com/questions/28457728/need-error-message-move-to-code", "title": "Need Error Message: Move To code", "body": "<p>I have a Move to Code. The issue I am having is a result of multiple accounts. I have 3 to be exact.</p>\n\n<p>Let's say - My boss emailed me, so I jump from my work account to my personal account. I read her email, jump back to my work account and run macro. It moves her (last read/selected) to location. I don't know how many personal emails I've moved by mistake because I forgot to reselect the correct email I meant to move.</p>\n\n<p>How can I produce a prompt message stating I'm in the wrong account and if I should proceed? Note: there may be times I may need to proceed.</p>\n\n<p><strong>Additional Information:</strong></p>\n\n<p><strong>Account One:</strong> Chieri Thompson (Personal)</p>\n\n<p><strong>Account Two:</strong> Artwork Emails</p>\n\n<p><strong>Account Three:</strong> DesignProofsTAC (work email - the one utilizing move to macro)</p>\n\n<p><em>Under Design Proofs TAC is :</em>\n<strong>Inbox</strong> (folder)\n<strong>Completed</strong> (subfolder)\n<strong>Outsourced</strong> (subfolder)\n.....</p>\n\n<pre><code>Private Sub CommandButton7_Click() 'COMPLETED\n\nOn Error Resume Next\nDim ns As Outlook.NameSpace\nDim MoveToFolder As Outlook.MAPIFolder\nDim objItem As Outlook.MailItem\n\nSet objItem = objApp.ActiveInspector.CurrentItem\nSet ns = Application.GetNamespace(\"MAPI\")\nSet MoveToFolder =  ns.Folders(\"designproofstac\").Folders(\"Inbox\").Folders(\"3_COMPLETED\")\n\nIf Application.ActiveExplorer.Selection.Count = 0 Then\n    MsgBox (\"Not in Correct Folder\")\n    Exit Sub\nEnd If    \n' this is the error code I want to produce the \"you are in wrong account - proceed anyway?\" DesignProofsTAC should be \"default\" i guess.\n\nIf MoveToFolder Is Nothing Then\n    MsgBox \"Target folder not found!\", vbOKOnly + vbExclamation, \"Move   Macro Error\"\nEnd If\n\nFor Each objItem In Application.ActiveExplorer.Selection\n    If MoveToFolder.DefaultItemType = olMailItem Then\n        If objItem.Class = olMail Then\n            objItem.Move MoveToFolder\n        End If\n    End If\nNext\n\nSet objItem = Nothing\nSet MoveToFolder = Nothing\nSet ns = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 1, "creation_date": 1423667532, "post_id": 28457665, "comment_id": 45241884, "body": "Please <a href=\"https://stackoverflow.com/posts/28457665/edit\">edit</a> this question to include as much information as you can, preferably including code, about what you&#39;ve tried already and what didn&#39;t work."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423668142, "post_id": 28457665, "comment_id": 45242303, "body": "This sounds like the type of layout that could be summarized using PivotTables. Is there any reason you&#39;d rather not use a PivotTable?"}, {"owner": {"reputation": 37, "user_id": 3638182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/193903398/picture?type=large", "display_name": "Justin6587", "link": "https://stackoverflow.com/users/3638182/justin6587"}, "edited": false, "score": 0, "creation_date": 1423668468, "post_id": 28457665, "comment_id": 45242527, "body": "This must be done in VBA because it will be part of a much longer string of code. All the data is being imported from Access via VBA. This is a process that will be run daily, and I would prefer to keep as much of it automated as possible. I intend to attach this code to the end of the code that is importing the data, so that it appears in the correct format."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1423669418, "post_id": 28457665, "comment_id": 45243182, "body": "If it is coming from Access, why not run a query on your table that already does this? Something like <code>SELECT table.Date, SUM(table.MinWorked), table.JobNumber FROM table GROUP BY table.Date, table.JobNumber;</code> should result in what you&#39;re looking for.  Then you could import that query data into Excel and it&#39;s already deduped and summed."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1425344044, "post_id": 28457665, "comment_id": 45916031, "body": "Create a pivot table from the base data (on a hidden sheet if necessary) and use that aggregated data as the base for future calculations."}], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1425389088, "last_edit_date": 1425389088, "creation_date": 1425343697, "answer_id": 28822151, "question_id": 28457665, "link": "https://stackoverflow.com/questions/28457665/combine-duplicate-entries-by-summing-and-deleting/28822151#28822151", "title": "Combine duplicate entries by summing and deleting", "body": "<p>tigeravatar is correct that doing that with an Access query would be the best way (easier to maintain). If you really need/want to do this in VBA though you would need to do something like:</p>\n\n<pre><code>Sub Condense()\n    Dim i as long\n    Dim ref as string\n    Dim total as long 'switch to double if Min can have fractional values\n    Dim o as long\n\n    Application.ScreenUpdating = False 'Just always a good practice to use this\n    i = 2 'assumes you have headers in row 1, if not use 1\n    Do while Range(\"A\" &amp; i).value &lt;&gt; \"\" 'Assumes Dates are in column A\n        If ref = Range(\"A\" &amp; i).value &amp; \"-\" &amp; Range(\"C\" &amp; i).value then\n            'Match, update total\n            total = total + Range(\"B\" &amp; i).Value\n\n            'Remove the duplicate row. Note in this case we don't update i as what is currently the i+1 -th row becomes row i after the delete\n            Range(i &amp; \":\" &amp; i).EntireRow.Delete\n        Else\n            'Check for macro just starting\n            If o &lt;&gt; 0 then\n                'new Date-Job combo. Output current total\n                Range(\"B\" &amp; o).value = total\n            End If 'else we're on the first time through the loop and just need to update o &amp; ref\n            'Update o &amp; ref\n            o = i\n            ref = Range(\"A\" &amp; i).value &amp; \"-\" &amp; Range(\"C\" &amp; i).value\n        End If\n        'Update i\n        i = i + 1\n        End If\n    Loop\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3638182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/193903398/picture?type=large", "display_name": "Justin6587", "link": "https://stackoverflow.com/users/3638182/justin6587"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1425389088, "creation_date": 1423667324, "last_edit_date": 1423668496, "question_id": 28457665, "link": "https://stackoverflow.com/questions/28457665/combine-duplicate-entries-by-summing-and-deleting", "title": "Combine duplicate entries by summing and deleting", "body": "<p>I have a worksheet with the following information</p>\n\n<pre><code>Date      |      Min Worked      |      Job Number\n2/4/2015           500                     123\n2/4/2015           100                     123\n2/4/2015           200                     321\n2/5/2015           300                     321\n2/5/2015           100                     123\n2/5/2015           100                     123\n</code></pre>\n\n<p>I would like to combine minutes worked on any entries with the same date and job number, and delete the extras. So after running the VBA it will look like this</p>\n\n<pre><code>Date      |      Min Worked      |      Job Number\n2/4/2015           600                     123\n2/4/2015           200                     321\n2/5/2015           300                     321\n2/5/2015           200                     123\n</code></pre>\n\n<p>I have not had any success with code that I have tried. Any help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1423665934, "post_id": 28457077, "comment_id": 45240774, "body": "<a href=\"http://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">Please show us what you&#39;ve attempted so far.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1423668285, "post_id": 28457509, "comment_id": 45242400, "body": "Your code looks solid but the answer as a whole would be massively improved by explaining how your code answers the question and providing a brief overview on how it works."}, {"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "edited": false, "score": 0, "creation_date": 1423679935, "post_id": 28457509, "comment_id": 45249613, "body": "Did you make sure to set the reference to the Microsoft Scripting Runtime? (From the VBA Editor, go to Tools, then References and check &quot;Microsoft Scripting Runtime.)"}], "tags": [], "owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "is_accepted": false, "score": 0, "last_activity_date": 1423679852, "last_edit_date": 1423679852, "creation_date": 1423666895, "answer_id": 28457509, "question_id": 28457077, "link": "https://stackoverflow.com/questions/28457077/delete-files-if-value-does-not-exist/28457509#28457509", "title": "Delete Files If value does Not exist", "body": "<p>To provide more context, this code loops through each cell in column A (save the top cell which it presumes is the header) and the feeds the Value of that cell to the function to be examined.<br/>\nThe function loops through every file in the provided folder (make sure you update the folder to match your own) and checks to see if file name is Like the criteria provided. (For more information about the Like Operator visit: <a href=\"https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx</a>)</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Example()\n    Dim ws As Excel.Worksheet\n    Dim rng As Excel.Range\n    Dim cll As Excel.Range\n    Dim deletedCount As Long\n    Set ws = Excel.ActiveSheet\n    Set rng = Excel.Intersect(ws.UsedRange.Offset(1&amp;, 0&amp;), ws.Columns(1), ws.UsedRange)\n    For Each cll In rng.Cells\n        deletedCount = deletedCount + DeleteFilesByCriteria(\"C:\\_Test\", cll.value &amp; \".pdf\", False)\n    Next\n    MsgBox \"Deleted \" &amp; deletedCount, vbInformation\nEnd Sub\n\nPrivate Function DeleteFilesByCriteria(ByVal folderPath As String, ByVal criteria As String, Optional ByVal deleteReadOnly As Boolean = False) As Long\n    'Create a reference to Microsoft Scripting Runtime\n    Dim fso As Scripting.FileSystemObject\n    Dim fldr As Scripting.Folder\n    Dim fl As Scripting.File\n    Dim deletedCount As Long\n    Set fso = New Scripting.FileSystemObject\n    Set fldr = fso.GetFolder(folderPath)\n    For Each fl In fldr.Files\n        If fl.name Like criteria Then\n            fl.Delete deleteReadOnly\n            deletedCount = deletedCount + 1&amp;\n        End If\n    Next\n    DeleteFilesByCriteria = deletedCount\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 1285435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KqMEU.jpg?s=128&g=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/1285435/gerry"}, "edited": false, "score": 0, "creation_date": 1423823363, "post_id": 28463311, "comment_id": 45314411, "body": "This works perfectly, I will use this one. Thanks for the clarification, makes it a lot easier for a noob like me ;)&#224;"}], "tags": [], "owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "is_accepted": true, "score": 0, "last_activity_date": 1423684925, "last_edit_date": 1423684925, "creation_date": 1423684616, "answer_id": 28463311, "question_id": 28457077, "link": "https://stackoverflow.com/questions/28457077/delete-files-if-value-does-not-exist/28463311#28463311", "title": "Delete Files If value does Not exist", "body": "<p>see if this helps you:</p>\n\n<pre><code>Sub RemoveFiles()\nDim sht As Worksheet\nDim range As range\nDim found As range\nDim myFolder As String\nDim currFile As String\nDim currFileNoSuffix As String\n\nSet sht = ActiveSheet\n ' Set the range to the A column-\n '   - only visible cells (xlCellTypeVisible)\n '   - and only constants, meaning skip over empty cells \n '     and cells containing formulas or errors (7).\nSet range = sht.range(\"A:A\").SpecialCells(xlCellTypeVisible, 7)\n\n' the files folder\nmyFolder = \"C:\\temp\\111\\\"\n\n' give me the first file in the folder\ncurrFile = Dir(myFolder)\n\n' while the code has not gone throug all of the files in the folder\nWhile Not currFile = vbNullString\n    ' put in the variable the name of the file without its suffix,\n    ' for example 11111.pdf --&gt;  will put 11111  into the variable.\n    ' ! This does not change the the actual file in the directory!\n    currFileNoSuffix$ = Mid(currFile, 1, InStrRev(currFile, \".\") - 1)\n\n    ' look for the name of the file in the \"A\" column.\n    ' xlWhole means to search for an exact match, for example\n    ' if you have a file named 111.pdf, it will only watch with a \"111\" sheet entry,\n    ' but not with a \"1111111\" entry.\n    Set found = range.Find(currFileNoSuffix$, , , xlWhole, , , False)\n\n    ' if the filename does not appear in the sheet\n    If found Is Nothing Then\n        ' then delete the file\n        Kill myFolder &amp; currFile\n    End If\n\n    ' give me the next file in the folder\n    currFile = Dir()\nWend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 1285435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KqMEU.jpg?s=128&g=1", "display_name": "Gerry", "link": "https://stackoverflow.com/users/1285435/gerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 28463311, "answer_count": 2, "score": 0, "last_activity_date": 1423684925, "creation_date": 1423665741, "last_edit_date": 1531164843, "question_id": 28457077, "link": "https://stackoverflow.com/questions/28457077/delete-files-if-value-does-not-exist", "title": "Delete Files If value does Not exist", "body": "<p>I'm searching for a clean way in VBA to solve this:</p>\n\n<p>I have an Excel sheet containing value's in 1 row.\nIf the value's are found in a specified directory then they should be kept and all the others deleted.</p>\n\n<p>A short example:</p>\n\n<p>table:</p>\n\n<pre><code>     A\n1   1000\n2   1500\n3   2000\n4   1800\n5   0009\n</code></pre>\n\n<p>Directory content on C:\\Temp\\1000.pdf ; 1200.pdf ; 1800.pdf ; 0001.pdf</p>\n\n<p>So the action should keep 1000.pdf  and 1800.pdf and delete all other *.pdf 's</p>\n\n<p>This is what I attempted yet, but this is just with one cell.</p>\n\n<pre><code>Dim cName As String\n\ncName = Sheets(\"Blad2\").Range(\"A2\").Text\n\nIf Len(Dir(\"C:\\Temp\\\" &amp; cName, vbDirectory)) = 0 Then\nKill \"C:\\Temp\\\" &amp; cName &amp; \".pdf\"\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1423666381, "post_id": 28457071, "comment_id": 45241093, "body": "Please specify which dates should be <b>visible.</b>"}, {"owner": {"reputation": 37, "user_id": 3802701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d101df16c4c851a436451fe207c95994?s=128&d=identicon&r=PG&f=1", "display_name": "mccreaVBA", "link": "https://stackoverflow.com/users/3802701/mccreavba"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1423666587, "post_id": 28457071, "comment_id": 45241229, "body": "Thanks for taking a look. So any date that falls before the first of the current month, within the current year. If the filter was applied now, it would only show dates with the month of January 2015. If applied In August, only resulting visible dates should be anything within January-July 2015."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3802701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d101df16c4c851a436451fe207c95994?s=128&d=identicon&r=PG&f=1", "display_name": "mccreaVBA", "link": "https://stackoverflow.com/users/3802701/mccreavba"}, "edited": false, "score": 0, "creation_date": 1423669024, "post_id": 28457987, "comment_id": 45242936, "body": "Thanks very much for having a look, that worked a treat. Much appreciated."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 4, "last_activity_date": 1423668181, "creation_date": 1423668181, "answer_id": 28457987, "question_id": 28457071, "link": "https://stackoverflow.com/questions/28457071/vba-excel-autofilter-for-any-date-before-the-current-month/28457987#28457987", "title": "VBA Excel autofilter for any date before the current month", "body": "<p>This should work for you:</p>\n\n<pre><code>Dim dtStart As Date\nDim dtFinal As Date\n\ndtStart = CDate(Evaluate(\"DATE(YEAR(NOW()),1,1)\"))\ndtFinal = CDate(Evaluate(\"EOMONTH(TODAY(),-1)\"))\n\nActiveSheet.Range(\"A:BF\").AutoFilter 12, \"&gt;=\" &amp; dtStart, xlAnd, \"&lt;=\" &amp; dtFinal\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3802701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d101df16c4c851a436451fe207c95994?s=128&d=identicon&r=PG&f=1", "display_name": "mccreaVBA", "link": "https://stackoverflow.com/users/3802701/mccreavba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2884, "favorite_count": 1, "accepted_answer_id": 28457987, "answer_count": 1, "score": 1, "last_activity_date": 1510407819, "creation_date": 1423665726, "last_edit_date": 1423666890, "question_id": 28457071, "link": "https://stackoverflow.com/questions/28457071/vba-excel-autofilter-for-any-date-before-the-current-month", "title": "VBA Excel autofilter for any date before the current month", "body": "<p>I'm trying to filter a date column for any date that falls before the 1st of the current month.\nSo something similar to below:</p>\n\n<pre><code>ActiveSheet.Range(\"$A:$BF\").AutoFilter Field:=12, Criteria1:= _\n    xlFilterYearToDate, Operator:=xlFilterDynamic\n</code></pre>\n\n<p>But doesnt include any dates in the current month it runs on.</p>\n\n<p>Edit:\nSo any date that falls before the first of the current month, within the current year. If the filter was applied now, it would only show dates with the month of January 2015. If applied In August, only resulting visible dates should be anything within January-July 2015.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1417, "user_id": 1885727, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cbo8Q.jpg?s=128&g=1", "display_name": "Shoaibkhanz", "link": "https://stackoverflow.com/users/1885727/shoaibkhanz"}, "edited": false, "score": 0, "creation_date": 1423665600, "post_id": 28456975, "comment_id": 45240563, "body": "Can I not do it without looping? Something similar to what I have stated above"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 1417, "user_id": 1885727, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cbo8Q.jpg?s=128&g=1", "display_name": "Shoaibkhanz", "link": "https://stackoverflow.com/users/1885727/shoaibkhanz"}, "edited": false, "score": 2, "creation_date": 1423665642, "post_id": 28456975, "comment_id": 45240592, "body": "That functionality is not supported by the Collection that contains the WorkSheets"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 1417, "user_id": 1885727, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cbo8Q.jpg?s=128&g=1", "display_name": "Shoaibkhanz", "link": "https://stackoverflow.com/users/1885727/shoaibkhanz"}, "edited": false, "score": 0, "creation_date": 1423665973, "post_id": 28456975, "comment_id": 45240801, "body": "If you do this a lot, put it inside a function"}, {"owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "edited": false, "score": 1, "creation_date": 1423666301, "post_id": 28456975, "comment_id": 45241024, "body": "The only way to avoid a loop would be if you know it always had the same position in the workbook--that it is always the first or second, etc. worksheet. Then you would refer to it by Worksheets(index). Even then, I&#39;d be reluctant to trust it in a production environment"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1423665478, "creation_date": 1423665478, "answer_id": 28456975, "question_id": 28456886, "link": "https://stackoverflow.com/questions/28456886/select-worksheet-using-the-prefix/28456975#28456975", "title": "Select Worksheet using the prefix", "body": "<p>Loop and find:</p>\n\n<pre><code>Dim sheet As Worksheet\nFor Each sheet In ActiveWorkbook.Sheets\n    If (sheet.Name Like \"EXP*\") Then\n        sheet.Select\n        Exit For\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 1417, "user_id": 1885727, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/cbo8Q.jpg?s=128&g=1", "display_name": "Shoaibkhanz", "link": "https://stackoverflow.com/users/1885727/shoaibkhanz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 28456975, "answer_count": 1, "score": 0, "last_activity_date": 1482247119, "creation_date": 1423665198, "question_id": 28456886, "link": "https://stackoverflow.com/questions/28456886/select-worksheet-using-the-prefix", "title": "Select Worksheet using the prefix", "body": "<p>I would like to select a worksheet in my activeworkbook and there is only one and   it starts with EXP, how do i do that, I am trying something like below.</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"EXP*\").Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1423664929, "post_id": 28456730, "comment_id": 45240133, "body": "Can you post your workbook for us to look at?"}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1423667307, "post_id": 28456730, "comment_id": 45241726, "body": "Sorry, no, it&#39;s a huge workbook with sensitive data"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1423711363, "post_id": 28456730, "comment_id": 45262667, "body": "Redundant request given Rory&#39;s answer - good question btw."}], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1423667763, "post_id": 28457706, "comment_id": 45242040, "body": "Ahha, great. The following if statement also seems to produce errors, I guess for formatconditions that do not have .interior.color and .font.color. Can you think of a nice way of handling these errors? Can/should I test that the fc is really a formatcondition before executing the if statement?"}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1423667885, "post_id": 28457706, "comment_id": 45242132, "body": "@user1283776 That should probably be a new question."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1423668469, "post_id": 28457706, "comment_id": 45242529, "body": "@user1283776 Yes, test it with <code>TypeName</code>."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 6, "last_activity_date": 1423667444, "creation_date": 1423667444, "answer_id": 28457706, "question_id": 28456730, "link": "https://stackoverflow.com/questions/28456730/for-each-fc-in-range-formatconditions-fails-why/28457706#28457706", "title": "For each fc in range.formatconditions fails. Why?", "body": "<p>The <code>FormatConditions</code> collection includes <code>FormatCondition</code>, <code>DataBar</code>, <code>AboveAverage</code>, <code>ColorScale</code>, <code>UniqueValues</code>, <code>Top10</code> and <code>IconSetCondition</code> objects, not just <code>FormatCondition</code> objects, so you need to declare your <code>fc</code> variable as <code>Object</code>.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 28457706, "answer_count": 1, "score": 3, "last_activity_date": 1423667444, "creation_date": 1423664730, "question_id": 28456730, "link": "https://stackoverflow.com/questions/28456730/for-each-fc-in-range-formatconditions-fails-why", "title": "For each fc in range.formatconditions fails. Why?", "body": "<p>The following code works for most sheets in my workbook:</p>\n\n<pre><code>Function IsHighlighted() As Boolean\n\n    Dim wks As Worksheet\n    For Each wks In ThisWorkbook.Worksheets\n        Dim rUsedRange As Range\n        Set rUsedRange = wks.UsedRange\n\n        With rUsedRange\n            Dim bHighlighted As Boolean\n\n            Dim fc As FormatCondition\n            For Each fc In .FormatConditions\n                If fc.Interior.Color = RGB(255, 0, 0) And fc.Font.Color = RGB(255, 255, 0) Then\n                    bHighlighted = True\n                    Exit For\n                End If\n            Next fc\n\n            If bHighlighted = True Then\n                Exit For\n            End If\n        End With\n        Debug.Print (wks.Name &amp; \",\" &amp; rUsedRange.FormatConditions.count)\n    Next wks\n\n    IsHighlighted = bHighlighted\nEnd Function\n</code></pre>\n\n<p>But it fails on the line <code>For Each fc In .FormatConditions</code> with the error message type mismatch on a worksheet that has <code>rUsedRange.FormatConditions.Count = 34</code> out of which many are icon sets.</p>\n\n<p>Why does the code fail on this sheet? How can I fix it?</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423669463, "post_id": 28457558, "comment_id": 45243223, "body": "this didn&#39;t gave the following output, here is the link to the original file and the output <a href=\"https://www.dropbox.com/s/um0mio3jwlk3bd3/Test.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/um0mio3jwlk3bd3/Test.xlsx?dl=0</a>"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423669925, "post_id": 28457558, "comment_id": 45243531, "body": "I thought you really had ones and twos in your data :). I have updated my answer. Please mark as answered if you are satisfied with it"}, {"owner": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423670173, "post_id": 28457558, "comment_id": 45243695, "body": "This works great, I have 190,000 lines, can you add a line of code that says what line it is on?"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423670226, "post_id": 28457558, "comment_id": 45243730, "body": "I am not sure I understand what you are asking for"}, {"owner": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423670502, "post_id": 28457558, "comment_id": 45243905, "body": "with 190,000 row I imagine this will run awhile, is there a line of code that can tell me where in the process it is.  I thought this would do it if I put it at the beginning and end of the procedure   Application.ScreenUpdating = False Application.Calculation = xlCalculationManual  Application.Calculation = xlCalculationAutomatic Application.ScreenUpdating = True"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1423671896, "last_edit_date": 1423671896, "creation_date": 1423667011, "answer_id": 28457558, "question_id": 28456483, "link": "https://stackoverflow.com/questions/28456483/convert-multiple-columns-to-a-single-row-based-on-column-1-2-values-excel/28457558#28457558", "title": "Convert multiple columns to a single row based on Column 1 &amp; 2 Values Excel", "body": "<p>This will work for you. It is a bit of a mind twist :)</p>\n\n<pre><code>Sub CustomTranspose()\n    Dim i As Long, j As Long\n    Dim num As Long\n    Dim m As Long: m = 1\n    For i = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        ''The next line of code will show what line you are on \n        ''in the status bar at the bottom of the excel window\n        Application.StatusBar = \"Processing row \" &amp; i &amp; \" of \" &amp; Rows.Count\n\n        num = 0\n        For j = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            If Range(\"A\" &amp; i).Value = Range(\"A\" &amp; j).Value And Range(\"B\" &amp; i).Value = Range(\"B\" &amp; j).Value Then\n                If i &lt;&gt; j Then\n                    Range(\"D\" &amp; j).Value = \"duplicate\"\n                End If\n                num = num + 1\n            End If\n        Next j\n        If Range(\"D\" &amp; i).Value &lt;&gt; \"duplicate\" Then\n            Range(\"A\" &amp; i &amp; \":B\" &amp; i).Copy Destination:=Sheet2.Range(\"A\" &amp; m)\n            For k = 1 To num\n                Sheet2.Cells(m, 3 + k - 1).Value = Range(\"C\" &amp; i + k - 1).Value\n            Next k\n            m = m + 1\n        End If\n    Next i\n\n    ''This line clears the StatusBar\n    Application.StatusBar = False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423671643, "post_id": 28459056, "comment_id": 45244617, "body": "I ran it on a small group and it worked great, is there a line of code to say what line it is on?  Before I run it on the whole 190k?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423671745, "post_id": 28459056, "comment_id": 45244689, "body": "I updated the code to accomodate for a small bug, then I tested it using over 325,000 rows of data and the code completed in less than five seconds."}, {"owner": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "edited": false, "score": 0, "creation_date": 1423671851, "post_id": 28459056, "comment_id": 45244766, "body": "HOLY **** that was fast, Thanks!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1423671684, "last_edit_date": 1423671684, "creation_date": 1423671138, "answer_id": 28459056, "question_id": 28456483, "link": "https://stackoverflow.com/questions/28456483/convert-multiple-columns-to-a-single-row-based-on-column-1-2-values-excel/28459056#28459056", "title": "Convert multiple columns to a single row based on Column 1 &amp; 2 Values Excel", "body": "<p>This code will avoid writing to cells one at a time and uses an array to greatly speed up processing time:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wsInput As Worksheet\n    Dim wsOutput As Worksheet\n    Dim ACell As Range\n    Dim arrResults() As Variant\n    Dim ResultIndex As Long\n    Dim sCurrent As String\n    Dim sLine As String\n\n    Set wsInput = ActiveWorkbook.Sheets(\"Input\")\n    Set wsOutput = ActiveWorkbook.Sheets(\"Output\")\n\n    With wsInput.Range(\"A1\").CurrentRegion\n        .Sort .Resize(, 1), xlAscending, .Offset(, 1).Resize(, 1), , xlAscending, Header:=xlGuess\n        ReDim arrResults(1 To .Cells.Count, 1 To 1)\n        For Each ACell In .Resize(, 1).Cells\n            If ACell.Value &amp; \"|\" &amp; ACell.Offset(, 1).Value &lt;&gt; sCurrent Then\n                sCurrent = ACell.Value &amp; \"|\" &amp; ACell.Offset(, 1).Value\n                ResultIndex = ResultIndex + 1\n                arrResults(ResultIndex, 1) = sCurrent\n            End If\n            arrResults(ResultIndex, 1) = arrResults(ResultIndex, 1) &amp; \"|\" &amp; ACell.Offset(, 2).Value\n        Next ACell\n    End With\n\n    With wsOutput.Range(\"A1\").Resize(ResultIndex)\n        .Parent.UsedRange.Clear\n        .Value = arrResults\n        .TextToColumns .Cells, xlDelimited, Other:=True, OtherChar:=\"|\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I tested it using over 325,000 rows of data and the code completed in less than five seconds.</p>\n"}], "owner": {"reputation": 5, "user_id": 4403151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I1FsN9BRkAM/AAAAAAAAAAI/AAAAAAAAAAA/G1iloZLLZeY/photo.jpg?sz=128", "display_name": "Scott Dieterle", "link": "https://stackoverflow.com/users/4403151/scott-dieterle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 28459056, "answer_count": 2, "score": 0, "last_activity_date": 1424226986, "creation_date": 1423663965, "last_edit_date": 1531164843, "question_id": 28456483, "link": "https://stackoverflow.com/questions/28456483/convert-multiple-columns-to-a-single-row-based-on-column-1-2-values-excel", "title": "Convert multiple columns to a single row based on Column 1 &amp; 2 Values Excel", "body": "<p>I have an excel sheet</p>\n\n<pre><code>A AAA 1\nA AAA 2\nA AAA 3\nA ABC 1\nA ABC 2\nB AAA 1\nB AAA 2\nB AAA 3\nB ABC 1\nB ABC 2\n</code></pre>\n\n<p>I need it to look like</p>\n\n<pre><code>A AAA 1 2 3\nA ABC 1 2\nB AAA 1 2 3\nB ABC 1 2\n</code></pre>\n\n<p>I have this code to convert</p>\n\n<pre><code>A 1 2 3\nA 1\nA 2\nA 3\n</code></pre>\n\n<p>But can't find the reverse</p>\n\n<pre><code>Sub MakeOutput()\n\n    Dim iInputRow As Long\n    Dim iInputColumn As Long\n    Dim iOutputRow As Long\n\n    iOutputRow = 1 '- counter for which row to paste to\n    '- loop through each row on the input sheet\n    For iInputRow = 1 To Sheets(\"Input\").Range(\"A\" &amp; Sheets(\"Input\").Rows.Count).End(xlUp).Row\n        '- loop through each column inside of each row\n        For iInputColumn = 2 To Sheets(\"Input\").Cells(iInputRow, 1).End(xlToRight).Column\n            Sheets(\"Output\").Range(\"A\" &amp; iOutputRow).Value = Sheets(\"Input\").Range(\"A\" &amp; iInputRow).Value\n            Sheets(\"Output\").Range(\"B\" &amp; iOutputRow).Value = Sheets(\"Input\").Cells(iInputRow, iInputColumn).Value\n            iOutputRow = iOutputRow + 1\n        Next iInputColumn\n    Next iInputRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "oracle", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 0, "creation_date": 1423661504, "post_id": 28455597, "comment_id": 45237848, "body": "Hi many thanks. All three dropdowns will always have different values. I want to find someone who has one, two or all three. Not 1 or 2 or 3, but 1 and 2, or 1 and 2 and 3, so I&#39;m not sure about the &#39;OR&#39; statement here. I am getting an  error &quot;SQL Command not properly formed&quot; in excel, but the SQL program (Golden) is showing it as fine. There is only one column for Service_ID by the way, but multiple rows for each person in it, and their services. If I remove the two lines for service 2 and 3 it works fine..."}, {"owner": {"reputation": 6705, "user_id": 2162212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29317094ee28cae6e61311c8f7192633?s=128&d=identicon&r=PG", "display_name": "mucio", "link": "https://stackoverflow.com/users/2162212/mucio"}, "reply_to_user": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 0, "creation_date": 1423661842, "post_id": 28455597, "comment_id": 45238063, "body": "how do you decide if you want to check only 1 and 2 or all three drop down  values?"}, {"owner": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 0, "creation_date": 1423661957, "post_id": 28455597, "comment_id": 45238146, "body": "The user will select 1, or 1 and 2, or 1 and 2 and 3 basically. There wont&#39; be any variance beyond that. For any value not selected I pass a &#39;%&#39; character and look up all of those. If only Service1 is selected anything with 1 is to be returned, if 1 and 2, then any 1 and 2 will be returned."}, {"owner": {"reputation": 6705, "user_id": 2162212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29317094ee28cae6e61311c8f7192633?s=128&d=identicon&r=PG", "display_name": "mucio", "link": "https://stackoverflow.com/users/2162212/mucio"}, "reply_to_user": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 1, "creation_date": 1423662617, "post_id": 28455597, "comment_id": 45238547, "body": "then I will leave it with <code>OR</code> and I will add at the end something like <code>HAVING COUNT(DISTINCT C.SERVICE_ID) = 3 -(COALESCE(:cmbSelectServiceType, 1)  + COALESCE(:cmbSelectServiceType2, 1) + COALESCE(:cmbSelectServiceType3 ,1))</code> this will check that the number of different <code>SERVICE_ID</code> is exactly what you where expecting: if you pass values in 1 and 2, then the formula will return 2 and the query has to return 2 different <code>SERVICE_ID</code>"}, {"owner": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 0, "creation_date": 1423667472, "post_id": 28455597, "comment_id": 45241847, "body": "I&#39;m sorry about this, I get &quot;Inconsistent Data Type expected CHAR got NUMBER&quot; in Golden, highlighting the 1 in <code>COALESCE(:cbmSelectServiceType, 1)</code>  and a &quot;Missing Expression&quot; error via the VBA. I have added the lines from the answer, and added the <code>HAVING</code> to the end."}, {"owner": {"reputation": 6705, "user_id": 2162212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29317094ee28cae6e61311c8f7192633?s=128&d=identicon&r=PG", "display_name": "mucio", "link": "https://stackoverflow.com/users/2162212/mucio"}, "reply_to_user": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 0, "creation_date": 1423733933, "post_id": 28455597, "comment_id": 45271582, "body": "this is because probably :cbmSelectServiceType is a varchar or a non numeric type. If it&#39;s a char type you can use COALESCE(:cbmSelectServiceType, &#39;1&#39;) then Oracle should do the implicit conversion to numeric or otherwise you have to cast it explicitly"}, {"owner": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "edited": false, "score": 0, "creation_date": 1423737288, "post_id": 28455597, "comment_id": 45273708, "body": "Thanks so much again for all your help. I can run with this from here, there&#39;s a few more changes around it that need to be made. Much appreciated!"}], "tags": [], "owner": {"reputation": 6705, "user_id": 2162212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29317094ee28cae6e61311c8f7192633?s=128&d=identicon&r=PG", "display_name": "mucio", "link": "https://stackoverflow.com/users/2162212/mucio"}, "is_accepted": true, "score": 1, "last_activity_date": 1423661307, "creation_date": 1423661307, "answer_id": 28455597, "question_id": 28455541, "link": "https://stackoverflow.com/questions/28455541/vba-to-oracle-multiple-variables-in-one-column/28455597#28455597", "title": "VBA to Oracle Multiple Variables in one Column", "body": "<p>Try this</p>\n\n<pre><code>C.SERVICE_ID LIKE :cmbSelectServiceType\nOR C.SERVICE_ID LIKE :cmbSelectServiceType2\nOR C.SERVICE_ID LIKE :cmbSelectServiceType3\n</code></pre>\n\n<p>With your <code>AND</code> you where querying for a row where <code>C.SERVICE_ID = :cmbSelectServiceType = :cmbSelectServiceType2 = :cmbSelectServiceType3</code> and I do suspect that in your three dropdown you select three different values.</p>\n"}], "owner": {"reputation": 1150, "user_id": 1152715, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1HfJE.jpg?s=128&g=1", "display_name": "RossC", "link": "https://stackoverflow.com/users/1152715/rossc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 28455597, "answer_count": 1, "score": 0, "last_activity_date": 1423661307, "creation_date": 1423661136, "question_id": 28455541, "link": "https://stackoverflow.com/questions/28455541/vba-to-oracle-multiple-variables-in-one-column", "title": "VBA to Oracle Multiple Variables in one Column", "body": "<p>I have code that connects from MS Excel to an Oracle Database, queries the DB and returns the results. </p>\n\n<p>Everything barring this one issue is working correctly. There is one column called <strong>Service_ID</strong>. There are 3 drop down boxes in excel for this, as you may want to query multiple services. E.g. Service1 AND Service2 AND Service3. </p>\n\n<p>I have defined Service_ID as </p>\n\n<pre><code>C.SERVICE_ID  || '-' || G.TYPE_ID AS SERVICE_ID\n</code></pre>\n\n<p>And when I query </p>\n\n<pre><code>C.SERVICE_ID LIKE :cmbSelectServiceType\n</code></pre>\n\n<p>It finds the service and works as expected. However, trying to look up Service2 and 3 is where I have the issue. </p>\n\n<p>I have tried: </p>\n\n<pre><code>C.SERVICE_ID  || '-' || G.TYPE_ID AS SERVICE_ID2\nC.SERVICE_ID  || '-' || G.TYPE_ID AS SERVICE_ID3\n</code></pre>\n\n<p>Which doesn't work. </p>\n\n<p>I have tried also in the WHERE (with and without the lines above) cmbSelectService is the name of the dropdown in the Excel GUI: </p>\n\n<pre><code>C.SERVICE_ID LIKE :cmbSelectServiceType\nAND C.SERVICE_ID LIKE :cmbSelectServiceType2\nAND C.SERVICE_ID LIKE :cmbSelectServiceType3\n</code></pre>\n\n<p>Obviously, I don't normally work in this field, I'm just helping out and could do with some input. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1423661749, "post_id": 28455492, "comment_id": 45237997, "body": "why not just an IF test?"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 3288916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hizK8.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3288916/peter"}, "is_accepted": true, "score": 0, "last_activity_date": 1423661297, "creation_date": 1423661297, "answer_id": 28455593, "question_id": 28455492, "link": "https://stackoverflow.com/questions/28455492/how-to-make-a-custom-function-that-returns-cell-contents/28455593#28455593", "title": "How to make a custom function that returns cell contents?", "body": "<p>Try this</p>\n\n<pre><code>Function rd(rng As Range)\n\nDim blank As String\n\nblank = \"-\"\n\nIf rng.Value &gt; 0 Then\n        rd = rng.Value\n    Else\n        rd = blank\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1423662011, "creation_date": 1423662011, "answer_id": 28455821, "question_id": 28455492, "link": "https://stackoverflow.com/questions/28455492/how-to-make-a-custom-function-that-returns-cell-contents/28455821#28455821", "title": "How to make a custom function that returns cell contents?", "body": "<p>I presume you are doing this out of interest rather than efficiency, so something like this as</p>\n\n<ul>\n<li>range could be more than once cell</li>\n<li><p>your formula would return \"-\" for any text entries</p>\n\n<pre><code>Function rd(rng As Range) As String\n\nDim blank As String\nblank = \"-\"\n\nIf Len(rng.Cells(1).Value) &gt; 0 Then\n       rd = rng.Cells(1).Value\n   Else\n       rd = blank\nEnd If\n\nEnd Function\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 4552518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a2e6c1364810178d8bb835193e181c?s=128&d=identicon&r=PG&f=1", "display_name": "mia25", "link": "https://stackoverflow.com/users/4552518/mia25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 28455593, "answer_count": 2, "score": -1, "last_activity_date": 1423662011, "creation_date": 1423660986, "last_edit_date": 1531161705, "question_id": 28455492, "link": "https://stackoverflow.com/questions/28455492/how-to-make-a-custom-function-that-returns-cell-contents", "title": "How to make a custom function that returns cell contents?", "body": "<p>I would like to use this function to reference a cell.  if the cell has anything in it then return the contents.  If the cell is blank, then return \"-\".  Here is the code I am using and receiving an \"invalid use of property\" error.  here is the code:</p>\n\n<pre><code>Function rd(rng As Range)    \nDim blank As String\n\nblank = \"-\"\nIf rng.Value &gt; 0 Then\n    rng.Value\nElse\n    blank\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1423660365, "post_id": 28455188, "comment_id": 45237110, "body": "Use an <b>OnKey</b> macro to trap the entry of the <b>Esc</b> key."}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1423664010, "post_id": 28455188, "comment_id": 45239510, "body": "<code>Application.OnKey &quot;{ESC}&quot;, &quot;yourmacro&quot;</code> where <code>yourmacro</code> does what you want when escape is pressed"}], "answers": [{"tags": [], "owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "is_accepted": true, "score": 1, "last_activity_date": 1423680500, "creation_date": 1423680500, "answer_id": 28462096, "question_id": 28455188, "link": "https://stackoverflow.com/questions/28455188/keeping-excel-always-in-full-screen-mode/28462096#28462096", "title": "Keeping Excel always in full screen mode", "body": "<p>Does this help :</p>\n\n<pre><code>' Disable the Esc key.\nPrivate Sub Workbook_Open()\n   Application.OnKey \"{ESC}\", \"\"\nEnd Sub\n\n' Return the Esc key to normal.\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n   Application.OnKey \"{ESC}\"\nEnd Sub\n</code></pre>\n\n<p>Put the above in the \"ThisWorkbook\" section in the VBA editor.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6161613, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/05fff2967b5d98265d6786a958fa8dcd?s=128&d=identicon&r=PG", "display_name": "BRIAN MILANDILE", "link": "https://stackoverflow.com/users/6161613/brian-milandile"}, "is_accepted": false, "score": 0, "last_activity_date": 1459864481, "last_edit_date": 1459864481, "creation_date": 1459862895, "answer_id": 36427767, "question_id": 28455188, "link": "https://stackoverflow.com/questions/28455188/keeping-excel-always-in-full-screen-mode/36427767#36427767", "title": "Keeping Excel always in full screen mode", "body": "<p>Disable the Esc key.</p>\n\n<pre><code>Private Sub Workbook_Open()\n   Application.OnKey \"{ESC}\", \"\"\nEnd Sub\n</code></pre>\n\n<p>Return the Esc key to normal.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n   Application.OnKey \"{ESC}\"\nEnd Sub\n</code></pre>\n\n<p>When you minimize the window the icons reappear. you need to also disable minimize of the window.</p>\n"}], "owner": {"reputation": 159, "user_id": 4042816, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/575ba0fc635267c6c54d093709c34b94?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Lopes", "link": "https://stackoverflow.com/users/4042816/bruno-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3879, "favorite_count": 0, "accepted_answer_id": 28462096, "answer_count": 2, "score": 0, "last_activity_date": 1459864481, "creation_date": 1423660088, "last_edit_date": 1531164843, "question_id": 28455188, "link": "https://stackoverflow.com/questions/28455188/keeping-excel-always-in-full-screen-mode", "title": "Keeping Excel always in full screen mode", "body": "<p>I use the following code to make excel look like an \"application\" or web page when it starts, to make it full screen:  </p>\n\n<pre><code>With ActiveWindow\n.DisplayHorizontalScrollBar = False\n.DisplayVerticalScrollBar = False\n.DisplayHeadings = False\nEnd With\n\nApplication.CommandBars.ActiveMenuBar.Enabled = False\nApplication.DisplayFullScreen = True\nApplication.CommandBars(\"Full Screen\").Enabled = False\n</code></pre>\n\n<p>There is a way to prevent excel to return to \"normal\" mode? Since pressing the \"esc\" key does it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 33, "user_id": 4520706, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7e9da3149db8826e0095b2cacb47a612?s=128&d=identicon&r=PG&f=1", "display_name": "Lupi", "link": "https://stackoverflow.com/users/4520706/lupi"}, "edited": false, "score": 0, "creation_date": 1423664463, "post_id": 28454409, "comment_id": 45239832, "body": "Thanks all! Looking through these for some options I was able to get what I needed."}], "answers": [{"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 0, "last_activity_date": 1423659974, "last_edit_date": 1423659974, "creation_date": 1423659327, "answer_id": 28454930, "question_id": 28454409, "link": "https://stackoverflow.com/questions/28454409/macro-to-go-to-a-worksheet/28454930#28454930", "title": "Macro to go to a worksheet", "body": "<p>This will do it for you and handles all error without the need to use <code>On Error</code> statement.</p>\n\n<pre><code>Function Validate(SheetName As String) As Boolean\nFor i = 1 To ThisWorkbook.Worksheets.Count\nIf SheetName = ThisWorkbook.Worksheets(i).Name Then\nValidate = True\nExit Function\nElse\nValidate = False\nEnd If\nNext\nEnd Function\n\nSub GotoSheet()\nDim sSheet As String\n\nsSheet = InputBox( _\n  Prompt:=\"Sheet name or number?\", _\n  Title:=\"Input Sheet\")\nDo While Validate(sSheet) = False\n'This if statement is true when the user click cancel or x button\nIf sSheet = \"\" Then\nExit Do\nEnd If\nMsgBox (sSheet &amp; \" does not exist. Please enter a valid sheet name.\")\nsSheet = InputBox( _\n  Prompt:=\"Sheet name or number?\", _\n  Title:=\"Input Sheet\")\nLoop\nIf sSheet &lt;&gt; \"\" Then\n    Worksheets(sSheet).Activate\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "is_accepted": false, "score": 0, "last_activity_date": 1423659918, "creation_date": 1423659918, "answer_id": 28455129, "question_id": 28454409, "link": "https://stackoverflow.com/questions/28454409/macro-to-go-to-a-worksheet/28455129#28455129", "title": "Macro to go to a worksheet", "body": "<p>I believe the root of your problem at the moment is <code>On Error Resume Next</code>. This is causing the sub to simply exit when your else statement encounters an error, such as the sheet does not exist. Instead you need to handle that error through the use of something like <code>On Error GoTo</code>. As in:</p>\n\n<pre><code>Sub GotoSheet()\nDim sSheet As String\n\nsSheet = InputBox( _\n  Prompt:=\"Sheet name or number?\", _\n  Title:=\"Input Sheet\")\nOn Error GoTo noSheet\nIf Val(sSheet) &gt; 0 Then\n    Worksheets(Val(sSheet)).Activate\n    Exit Sub\nElse\n    Worksheets(sSheet).Activate\n    Exit Sub\nEnd If \n\nnoSheet:\n'Enter your code to display a warning that the sheet does not exist\n'and/or bring up a selection box of all sheets\n\nEnd Sub\n</code></pre>\n\n<p>Here is some more information on the <code>On Error</code> statement, which may be of use: <a href=\"https://msdn.microsoft.com/en-us/library/aa266173%28v=vs.60%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa266173%28v=vs.60%29.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 1890742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a6e4dd1927f88fa2d6589eec2c7c96c?s=128&d=identicon&r=PG", "display_name": "Mark Walsh", "link": "https://stackoverflow.com/users/1890742/mark-walsh"}, "edited": false, "score": 0, "creation_date": 1582046474, "post_id": 28455215, "comment_id": 106638588, "body": "Agree, cut out the option to search via user string.  Let the user simply select the sheets available."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 1, "last_activity_date": 1423660182, "creation_date": 1423660182, "answer_id": 28455215, "question_id": 28454409, "link": "https://stackoverflow.com/questions/28454409/macro-to-go-to-a-worksheet/28455215#28455215", "title": "Macro to go to a worksheet", "body": "<p>If you would like a list of available sheets to pop up so you can choose one just make a quick UserForm, insert a ListBox (a ComboBox would work as well, I prefer a ListBox visually), and have it populate on userform_initialize:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim WS As Worksheet\n    For Each WS In Worksheets\n        ListBox1.AddItem WS.Name\n    Next WS\nEnd Sub\n</code></pre>\n\n<p>Make sure the MultiSelect property is set to 0 for single select then create an ok button that goes to the selected sheet:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Sheets(ListBox1.Value).Activate\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Then create a button or whatever to show the form.</p>\n"}], "owner": {"reputation": 33, "user_id": 4520706, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7e9da3149db8826e0095b2cacb47a612?s=128&d=identicon&r=PG&f=1", "display_name": "Lupi", "link": "https://stackoverflow.com/users/4520706/lupi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2152, "favorite_count": 0, "closed_date": 1423660137, "answer_count": 3, "score": 0, "last_activity_date": 1423660182, "creation_date": 1423657843, "last_edit_date": 1531161705, "question_id": 28454409, "link": "https://stackoverflow.com/questions/28454409/macro-to-go-to-a-worksheet", "closed_reason": "Duplicate", "title": "Macro to go to a worksheet", "body": "<p>I have an excel workbook with a lot of sheet tabs, and to make navigating it easier for user's I've added a macro to bring up an input box so that they can type in the sheet they want to go to. </p>\n\n<p>It works but the problem is that if they type in a sheet name incorrectly it does nothing, the input box goes away, and the user is left on the same sheet they were already on. What I would like it to do is if a user types in a sheet name that doesn't exist for it to bring up a box with a list of all the tabs and allow them to choose from the list. Barring that, at least a message box informing them they entered a non-existent sheet name and to try again, and to then go back to the input box rather than it disappearing.  Here's the code I've been working with so far-</p>\n\n<p>If that's not possible, I'd rather have it just bring up a list of available sheets in the first place and forget the input box altogether. My thought was that it would be nice to type in the needed sheet rather than having to sort through the list every time, but it'd be preferable to nothing happening. </p>\n\n<pre><code>Sub GotoSheet()\nDim sSheet As String\n\nsSheet = InputBox( _\n  Prompt:=\"Sheet name or number?\", _\n  Title:=\"Input Sheet\")\nOn Error Resume Next\nIf Val(sSheet) &gt; 0 Then\n    Worksheets(Val(sSheet)).Activate\nElse\n    Worksheets(sSheet).Activate\nEnd If \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 113, "user_id": 4554674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c590fa1ff3fce9a032b8fe6b67527cbe?s=128&d=identicon&r=PG&f=1", "display_name": "3689", "link": "https://stackoverflow.com/users/4554674/3689"}, "edited": false, "score": 0, "creation_date": 1424694452, "post_id": 28454003, "comment_id": 45640864, "body": "Hi, I need to lock each cell after data entry in given range. Like once I enter Y or N in it. cant edit it again. below is my code"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4554674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c590fa1ff3fce9a032b8fe6b67527cbe?s=128&d=identicon&r=PG&f=1", "display_name": "3689", "link": "https://stackoverflow.com/users/4554674/3689"}, "edited": false, "score": 0, "creation_date": 1423727557, "post_id": 28455192, "comment_id": 45268201, "body": "Thanks! It worked. I have made some changes on selection of data as per required. Really appreciate your support on it."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 113, "user_id": 4554674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c590fa1ff3fce9a032b8fe6b67527cbe?s=128&d=identicon&r=PG&f=1", "display_name": "3689", "link": "https://stackoverflow.com/users/4554674/3689"}, "edited": false, "score": 0, "creation_date": 1423742199, "post_id": 28455192, "comment_id": 45276626, "body": "Thanks for the feedback"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1423660107, "creation_date": 1423660107, "answer_id": 28455192, "question_id": 28454003, "link": "https://stackoverflow.com/questions/28454003/secure-timestamp-vba/28455192#28455192", "title": "Secure Timestamp - VBA", "body": "<p>Assume that we start with all the cells on the worksheet <strong>unlocked</strong> and the sheet password-protected with the password:</p>\n\n<p><strong>6LgSdHjc2uOssv0e1LDI</strong></p>\n\n<p>The following <em>Event Macro</em> will: <br></p>\n\n<ol>\n<li>unprotect the workbook</li>\n<li>detect entries in column <strong>A</strong></li>\n<li>place the username in column <strong>B</strong> and the date/timestamp in column <strong>C</strong></li>\n<li>lock the entries in columns <strong>A,B,C</strong></li>\n<li>re-protect the worksheet.</li>\n</ol>\n\n<p>This goes in the Worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range, MyPass As String, sh As Worksheet\n    Dim unit As Range\n    Set A = Range(\"A:A\")\n    MyPass = \"6LgSdHjc2uOssv0e1LDI\"\n    Set sh = ActiveSheet\n    If Intersect(Target, A) Is Nothing Then Exit Sub\n\n    Set unit = Union(Target, Target.Offset(0, 1), Target.Offset(0, 2))\n\n    Application.EnableEvents = False\n    sh.Unprotect (MyPass)\n    unit.Locked = False\n        Target.Offset(0, 1) = Environ(\"Username\")\n        Target.Offset(0, 2) = Now()\n    unit.Locked = True\n    sh.Protect (MyPass)\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Because it is worksheet code, it is very easy to install and automatic to use:</p>\n\n<ol>\n<li>right-click the tab name near the bottom of the Excel window</li>\n<li>select View Code - this brings up a VBE window</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you have any concerns, first try it on a trial worksheet.</p>\n\n<p>If you save the workbook, the macro will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the macro:</p>\n\n<ol>\n<li>bring up the VBE windows as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>To learn more about Event Macros (worksheet code), see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/event.htm\" rel=\"nofollow\">http://www.mvps.org/dmcritchie/excel/event.htm</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n"}], "owner": {"reputation": 113, "user_id": 4554674, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c590fa1ff3fce9a032b8fe6b67527cbe?s=128&d=identicon&r=PG&f=1", "display_name": "3689", "link": "https://stackoverflow.com/users/4554674/3689"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1567, "favorite_count": 0, "accepted_answer_id": 28455192, "answer_count": 1, "score": 2, "last_activity_date": 1473306152, "creation_date": 1423656533, "last_edit_date": 1531164843, "question_id": 28454003, "link": "https://stackoverflow.com/questions/28454003/secure-timestamp-vba", "title": "Secure Timestamp - VBA", "body": "<p>I want to create a secure timestamp on my Excel sheet. The VBA I am using will automatically add the current users user name, the time, and the date when a user puts information into column A. So if the users puts something into cell A1 then B1 automatically gets filled with their username and C1 gets filled with the time and date. The only problem is that this method isn\u2019t secure because the user could alter the information after it is automatically populated. I would like to add code to this VBA so it will lock all three cells after the information is populated.</p>\n\n<p>I was planning on using the Protect Sheet feature and only allowing users to \u201cSelect unlocked cells\u201d So if the VBA could auto lock the cells then the users would not be able to alter the information.</p>\n\n<p>Moreover I have used Me.Unprotect before changing cells and Me.Protect after that still it is not working </p>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 1, "creation_date": 1423656467, "post_id": 28453675, "comment_id": 45234870, "body": "hi paul. I just copied and pasted your code and worked fine for me. maybe you can set the worksheet, just in case."}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1423656746, "post_id": 28453675, "comment_id": 45235040, "body": "another option is to use    <code>vbNewLine</code> instead of     <code>Chr(10)</code>. can you try that?"}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": true, "score": 0, "last_activity_date": 1423657098, "creation_date": 1423657098, "answer_id": 28454191, "question_id": 28453675, "link": "https://stackoverflow.com/questions/28453675/excel-replacing-html-tags-with-line-break/28454191#28454191", "title": "Excel: Replacing html tags with line break", "body": "<p>As I mentioned in the comment, your code worked fine for me however you have other options to create a nextline:</p>\n\n<pre><code>(Chr10)\nvbNewLine \nvbLf\nvbCrLf\n</code></pre>\n\n<p>all these constants can be used as new line. I do not know what are the differences but all of them works fine for me :)</p>\n\n<p>You can try these and see if they work.</p>\n"}], "owner": {"reputation": 3, "user_id": 4299960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gh7kMXt8Wl4/AAAAAAAAAAI/AAAAAAAABgo/x5q-r2oaNms/photo.jpg?sz=128", "display_name": "Paul Jinks", "link": "https://stackoverflow.com/users/4299960/paul-jinks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 28454191, "answer_count": 1, "score": 0, "last_activity_date": 1423657098, "creation_date": 1423655492, "last_edit_date": 1531161705, "question_id": 28453675, "link": "https://stackoverflow.com/questions/28453675/excel-replacing-html-tags-with-line-break", "title": "Excel: Replacing html tags with line break", "body": "<p>I have spreadsheets that contain html. It's ugly. I can strip out the html using VB:</p>\n\n<pre><code>Replace What:=\"&lt;*&gt;\", Replacement:=\"\",\n</code></pre>\n\n<p>This is tidier, but I lose line breaks that make the text more readable. What I'd like to do is insert a line break before e.g. <code>&lt;li&gt;</code>. <code>Chr(10)</code> is VB for insert line break, but this doesn't insert the line break:</p>\n\n<pre><code>Sub listItem()\nCells.Replace What:=\"&lt;li&gt;\", Replacement:=Chr(10) &amp; \" - \", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False\nEnd Sub\n</code></pre>\n\n<p>It replaces <code>&lt;li&gt;</code> with the hyphen, but no line break. It doesn't throw an error. I'm assuming I'm using Chr(10) incorrectly but I could use some help. </p>\n"}, {"tags": ["vba", "excel", "hmac", "sha256"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 1, "creation_date": 1423655257, "post_id": 28453409, "comment_id": 45234136, "body": "You can ! However, you have to create an algorithm first. MD5, SHA1, SHA256? What you wish to implement? Did you Google with the words <code>VBA SHA1 algorithm</code>there are several hits available"}, {"owner": {"reputation": 21, "user_id": 4554539, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qSEnF2qZMU/AAAAAAAAAAI/AAAAAAAADqE/WqI8-r75-1s/photo.jpg?sz=128", "display_name": "Andrea Castro", "link": "https://stackoverflow.com/users/4554539/andrea-castro"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423781805, "post_id": 28453409, "comment_id": 45300306, "body": "HAve you tried make it work? i tried for few days without success changing the vba amd so on...did you make it?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1561657341, "post_id": 28453409, "comment_id": 100146941, "body": "FWIW I posted an Excel no-vba version of SHA256 to answer this question: <a href=\"https://stackoverflow.com/questions/46509572/excel-formula-based-function-for-sha256-sha512-hashing-without-vba-or-macros/56767828#56767828\" title=\"excel formula based function for sha256 sha512 hashing without vba or macros\">stackoverflow.com/questions/46509572/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4554539, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qSEnF2qZMU/AAAAAAAAAAI/AAAAAAAADqE/WqI8-r75-1s/photo.jpg?sz=128", "display_name": "Andrea Castro", "link": "https://stackoverflow.com/users/4554539/andrea-castro"}, "edited": false, "score": 0, "creation_date": 1423781827, "post_id": 28453704, "comment_id": 45300322, "body": "HAve you tried make it work? i tried for few days without success changing the vba amd so on...did you make it?"}, {"owner": {"reputation": 3388, "user_id": 388606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd0666522a86a936c08d5a176cd39125?s=128&d=identicon&r=PG&f=1", "display_name": "i_saw_drones", "link": "https://stackoverflow.com/users/388606/i-saw-drones"}, "reply_to_user": {"reputation": 21, "user_id": 4554539, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qSEnF2qZMU/AAAAAAAAAAI/AAAAAAAADqE/WqI8-r75-1s/photo.jpg?sz=128", "display_name": "Andrea Castro", "link": "https://stackoverflow.com/users/4554539/andrea-castro"}, "edited": false, "score": 0, "creation_date": 1423823167, "post_id": 28453704, "comment_id": 45314278, "body": "Sorry, which part do you mean - the VB6, or the .NET solution? In either case, please update your question with details of the issues you are experiencing including sample code so that we can help you..."}], "tags": [], "owner": {"reputation": 3388, "user_id": 388606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd0666522a86a936c08d5a176cd39125?s=128&d=identicon&r=PG&f=1", "display_name": "i_saw_drones", "link": "https://stackoverflow.com/users/388606/i-saw-drones"}, "is_accepted": false, "score": 3, "last_activity_date": 1423655604, "creation_date": 1423655604, "answer_id": 28453704, "question_id": 28453409, "link": "https://stackoverflow.com/questions/28453409/hmac-sha256-macro-in-excel/28453704#28453704", "title": "HMAC SHA256 macro in Excel", "body": "<p>A quick search on Google revealed a HMAC-SHA256 class written in VB6, located here: <a href=\"http://www.vbforums.com/showthread.php?635398-VB6-HMAC-SHA-256-HMAC-SHA-1-Using-Crypto-API\" rel=\"nofollow\">http://www.vbforums.com/showthread.php?635398-VB6-HMAC-SHA-256-HMAC-SHA-1-Using-Crypto-API</a></p>\n\n<p>Whilst this is for VB6 (and is native code), it should be straightforward to adapt for use with VBA. As it sounds that you need a worksheet function (i.e. UDF) then you will also need to write this, using the above class.</p>\n\n<p>If you're happy to call .NET assemblies from VBA, then you can simplify your code as most of the calculation work is already done for you (see        System.Security.Cryptography, more specifically HMACSHA256). An example (for HMACSHA1, but the principle is the same) is given here: <a href=\"https://stackoverflow.com/questions/8246340/does-vba-have-a-hash-hmac\">Does VBA have a Hash_HMAC</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4554539, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7qSEnF2qZMU/AAAAAAAAAAI/AAAAAAAADqE/WqI8-r75-1s/photo.jpg?sz=128", "display_name": "Andrea Castro", "link": "https://stackoverflow.com/users/4554539/andrea-castro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4642, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1423655604, "creation_date": 1423654700, "question_id": 28453409, "link": "https://stackoverflow.com/questions/28453409/hmac-sha256-macro-in-excel", "title": "HMAC SHA256 macro in Excel", "body": "<p>I search ed through google, tech forums, etc.... but I couldn't find a good tutorial/guide that answer my question:</p>\n\n<p>I have a Cell in Excel with Text, and a Cell with a Key(both text), is there a way to have an HMAC for EXCEL function that get both cell as input and return the hmac text ?</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["r", "excel", "vba", "text-mining", "tm"], "comments": [{"owner": {"reputation": 48227, "user_id": 1327739, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4d8209bc0fd155f340561cbf5bb9158?s=128&d=identicon&r=PG", "display_name": "lukeA", "link": "https://stackoverflow.com/users/1327739/lukea"}, "edited": false, "score": 1, "creation_date": 1423653659, "post_id": 28452955, "comment_id": 45233144, "body": "Hm what would be the use case for such a dictionary? Maybe stemming the words to a common root is an alternative. If not, you should perhaps look at a database like <a href=\"http://en.wikipedia.org/wiki/WordNet\" rel=\"nofollow noreferrer\">WordNet</a>. The question is probably too broad anyway."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1423654036, "post_id": 28452955, "comment_id": 45233390, "body": "I dont know about R bindings but see <a href=\"https://www.nodebox.net/code/index.php/Linguistics\" rel=\"nofollow noreferrer\">nodebox.net/code/index.php/Linguistics</a> - verb.infinitive()/present_participle() - the approach they take is documented"}, {"owner": {"reputation": 6754, "user_id": 2583119, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qdzU7.png?s=128&g=1", "display_name": "lawyeR", "link": "https://stackoverflow.com/users/2583119/lawyer"}, "edited": false, "score": 0, "creation_date": 1423661324, "post_id": 28452955, "comment_id": 45237727, "body": "@Roland: can an OP accept an answer to a question put on hold?"}], "answers": [{"comments": [{"owner": {"reputation": 6754, "user_id": 2583119, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qdzU7.png?s=128&g=1", "display_name": "lawyeR", "link": "https://stackoverflow.com/users/2583119/lawyer"}, "edited": false, "score": 1, "creation_date": 1423708376, "post_id": 28453945, "comment_id": 45261945, "body": "Did this answer work for you?  Would you consider accepting it?"}, {"owner": {"reputation": 11, "user_id": 4554455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b35d40ec26a74d0abd68f5bff9d72b?s=128&d=identicon&r=PG&f=1", "display_name": "Dharam", "link": "https://stackoverflow.com/users/4554455/dharam"}, "edited": false, "score": 0, "creation_date": 1423831958, "post_id": 28453945, "comment_id": 45319340, "body": "Thanks for the response...I think you assumed I have all the words but I do not..That&#39;s what I want.all the words!!! I have 1000&#39;s of words for which I have to find relevant words..I know some sort of dictionary will give me that but it&#39;s not one word there are 1000&#39;s of them...so how to do?"}], "tags": [], "owner": {"reputation": 6754, "user_id": 2583119, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qdzU7.png?s=128&g=1", "display_name": "lawyeR", "link": "https://stackoverflow.com/users/2583119/lawyer"}, "is_accepted": false, "score": 4, "last_activity_date": 1423661237, "last_edit_date": 1423661237, "creation_date": 1423656363, "answer_id": 28453945, "question_id": 28452955, "link": "https://stackoverflow.com/questions/28452955/create-other-formsnoun-adjective-plural-verb-everything-of-a-word/28453945#28453945", "title": "Create other forms[noun,adjective,plural,verb..everything] of a word", "body": "<p>You can use the package <code>tm</code> and its stemming capabilities.</p>\n\n<p>If your text file is</p>\n\n<pre><code>text &lt;- c(\"taste\", \"tastes\", \"tasting\")\n</code></pre>\n\n<p>you can create a corpus</p>\n\n<pre><code>corpus &lt;- Corpus(VectorSource(text)\n</code></pre>\n\n<p>and then have the stem function strip the words to their roots.  (The helper function avoids some problems.)</p>\n\n<pre><code>stemDocumentfix &lt;- function(x){ # put in business code\n  PlainTextDocument(paste(stemDocument(unlist(strsplit(as.character(x), \" \"))), collapse=' '))\n}\n\ncorpus &lt;- tm_map(corpus, stemDocumentfix)\n\ninspect(corpus)\n&lt;&lt;VCorpus (documents: 3, metadata (corpus/indexed): 0/0)&gt;&gt;\n\n[[1]]\n&lt;&lt;PlainTextDocument (metadata: 7)&gt;&gt;\ntast\n\n[[2]]\n&lt;&lt;PlainTextDocument (metadata: 7)&gt;&gt;\ntast\n\n[[3]]\n&lt;&lt;PlainTextDocument (metadata: 7)&gt;&gt;\ntast\n</code></pre>\n\n<p>You might also look at the <code>qdap</code> package, which offers a range of capabilities for text mining.</p>\n"}], "owner": {"reputation": 11, "user_id": 4554455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b35d40ec26a74d0abd68f5bff9d72b?s=128&d=identicon&r=PG&f=1", "display_name": "Dharam", "link": "https://stackoverflow.com/users/4554455/dharam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "closed_date": 1423660954, "answer_count": 1, "score": -2, "last_activity_date": 1423831056, "creation_date": 1423653351, "last_edit_date": 1423831056, "question_id": 28452955, "link": "https://stackoverflow.com/questions/28452955/create-other-formsnoun-adjective-plural-verb-everything-of-a-word", "closed_reason": "Needs more focus", "title": "Create other forms[noun,adjective,plural,verb..everything] of a word", "body": "<p>Actually I am doing review analytics  for a cruise company. I can not tell you the whole procedure  as it is very lengthy but at least a snapshot of it. I took all the reviews, divided them into sentences then extracted some phrases out of that review...e.g. 'Wonderful cabin', 'Excellent service'. Now for sentiment analysis I have to map all the nouns of that phrase to a particular theme. Now in that mapping I need all the synonyms of the nouns and all the words[As I asked] related to that word. so final result of my text mining will be more efficient. I think you get the little idea of what I am doing. \n I will repeat my question..in excel I have one row of words or say nouns..when I run a code[R,VBA or any] it should give me all the words related to those words..[I extracted synonyms with vba code].\n Hope you got it..?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1423653324, "post_id": 28452694, "comment_id": 45232945, "body": "please add your code"}], "answers": [{"tags": [], "owner": {"reputation": 180, "user_id": 4236677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EMte0.jpg?s=128&g=1", "display_name": "Zegad", "link": "https://stackoverflow.com/users/4236677/zegad"}, "is_accepted": false, "score": 0, "last_activity_date": 1423773988, "last_edit_date": 1423773988, "creation_date": 1423772706, "answer_id": 28487096, "question_id": 28452694, "link": "https://stackoverflow.com/questions/28452694/how-to-change-only-one-column-of-all-excel-files-in-the-folder/28487096#28487096", "title": "How to change only one column of all excel files in the folder", "body": "<p>In response to the question you could use something like this:</p>\n\n<pre><code>Sub sbOneColumnReplace()\nApplication.ScreenUpdating = False 'Disable flicker on screen\nDim lLastCol As Long, lNumCol As Long, lLastRow As Long\nDim sTitleCol As String\nDim wsThis As Worksheet\n\n'Here add/define the workbook\n\nSet wsThis = Worksheets(1) 'Select first sheet\nlLastCol = wsThis.Cells(1, Columns.Count).End(xlToLeft).Column 'Last column in a specific row\n\nFor lNumCol = 1 To lLastCol 'Loop from the first column to the last one found\n    sTitleCol = wsThis.Cells(1, lNumCol).Value 'I suppose the Title is in the first row, if not change the number value\n\n    If sTitleCol = \"PlantNo\" Then 'This search the title vlaue.If you want it, you could use also vLookup with the defined range\n\n\n        wsThis.Columns(lNumCol).Replace _\n        What:=\"35\", Replacement:=\"1\", _\n        SearchOrder:=xlByColumns, MatchCase:=True\n\n    End If\n\nNext lNumCol\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Untested</strong>\nBut its important to note that may be better/different ways to achive it, and as @Katz mention is important to add code or reference to show you have already search an approach to your problem and reflex that you investigate about it, and the reinforce/correction of that knowledge may come, and if you only post the question without any of these, sometimes (if not always) it'll be skipped by everyone (Belive me, Im a newbie here too). Hope it helps you in the right direction</p>\n"}], "owner": {"reputation": 1, "user_id": 3401339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e1424f0057f2ac487bad90e2bf12a0?s=128&d=identicon&r=PG&f=1", "display_name": "user3401339", "link": "https://stackoverflow.com/users/3401339/user3401339"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423773988, "creation_date": 1423652528, "last_edit_date": 1531164843, "question_id": 28452694, "link": "https://stackoverflow.com/questions/28452694/how-to-change-only-one-column-of-all-excel-files-in-the-folder", "title": "How to change only one column of all excel files in the folder", "body": "<p>I have 50 .xlsx or .csv files in a folder. I want to change the data specific to a header \"PlantNo\" with new data.</p>\n\n<p>Suppose old data was \"35\" and now I want to replace that with \"1\" for all the excel workbooks in the folder for the specific column and not for whole data.</p>\n\n<p>I have already written code which will change all This to That but I want this to be restricted to only one column</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1423651964, "post_id": 28452315, "comment_id": 45232161, "body": "See if <a href=\"http://stackoverflow.com/a/19908375/2144390\">this answer</a> helps."}, {"owner": {"reputation": 9197, "user_id": 467859, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a5840a36814a756ed14c35c813ea82a6?s=128&d=identicon&r=PG", "display_name": "punkrockbuddyholly", "link": "https://stackoverflow.com/users/467859/punkrockbuddyholly"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1423652324, "post_id": 28452315, "comment_id": 45232358, "body": "That was the first answer I found when I began researching this problem. Unfortunately when I do it this way I get the error <code>Object module needs to implement &#39;~&#39; for the interface &#39;~&#39;</code> and when I google for that it seems no one else in the world has seen this error."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423653557, "post_id": 28452315, "comment_id": 45233078, "body": "@MrMisterMan That is probably because the code you showed is not exactly the code you have. The code you show will not compile because the interface has both a field named <code>Name</code> and a property named <code>Name</code>, so that is <code>Ambiguous name detected: Name</code>. If you rename the field, the error will be <code>Object module needs to implement &#39;Name1&#39; for interface &#39;IFeed&#39;</code>. That is because you need to implement the field in <code>CFeed</code> as well (will actually be implemented as a property). The correct thing to do is to remove the field from the interface altogether, or to convert it to a property."}, {"owner": {"reputation": 9197, "user_id": 467859, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a5840a36814a756ed14c35c813ea82a6?s=128&d=identicon&r=PG", "display_name": "punkrockbuddyholly", "link": "https://stackoverflow.com/users/467859/punkrockbuddyholly"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1423655460, "post_id": 28452315, "comment_id": 45234242, "body": "@GordThompson if I do it exactly as shown in that answer I get the compile error <code>Object module needs to implement &#39;Name&#39; for interface &#39;IFeed&#39;</code>. But I have the property setter and getter for Name in both my interface <i>and</i> CFeed class."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423656227, "post_id": 28452315, "comment_id": 45234720, "body": "@MrMisterMan What you actually have is probably not what you think you have. If in the <code>CFeed</code> code module you select <code>IFeed</code> from the left dropdown, do you have any unimplemented (non-bold) properties in the right dropdown?"}], "answers": [{"comments": [{"owner": {"reputation": 9197, "user_id": 467859, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a5840a36814a756ed14c35c813ea82a6?s=128&d=identicon&r=PG", "display_name": "punkrockbuddyholly", "link": "https://stackoverflow.com/users/467859/punkrockbuddyholly"}, "edited": false, "score": 0, "creation_date": 1423654893, "post_id": 28452386, "comment_id": 45233938, "body": "Thank you, this is working. However I have seen examples where this isn&#39;t the case so it looks like I should be able to do <code>Dim test As CFeed</code>. For example the answer which @Gord linked to in his comment on my answer does not Dim the variable as the interface. So I still don&#39;t quite understand it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 9197, "user_id": 467859, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a5840a36814a756ed14c35c813ea82a6?s=128&d=identicon&r=PG", "display_name": "punkrockbuddyholly", "link": "https://stackoverflow.com/users/467859/punkrockbuddyholly"}, "edited": false, "score": 1, "creation_date": 1423655911, "post_id": 28452386, "comment_id": 45234525, "body": "@MrMisterMan In that answer the object is declared as itself because in the object&#39;s code they duplicate all properties of the implemented interface, mapping them to the actual implemented properties. So you&#39;d have to have <code>Private Property Let IFeed_Name</code>, <code>Private Property Get IFeed_Name</code>, <code>Public Property Let Name</code> and <code>Public Property Get Name</code> in <code>CFeed</code>, where the latter two return the values of the former two. As the number of properties grow, maintaining this manual mapping becomes annoying."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 3, "last_activity_date": 1423651725, "last_edit_date": 1495541659, "creation_date": 1423651725, "answer_id": 28452386, "question_id": 28452315, "link": "https://stackoverflow.com/questions/28452315/cant-seem-to-use-interfaces-with-properties-in-vba-and-i-cant-work-out-why/28452386#28452386", "title": "Can&#39;t seem to use Interfaces with properties in VBA and I can&#39;t work out why", "body": "<p>In VBA members of implemented interfaces do not make it into the class object itself, like e.g. they do in C#'s <a href=\"https://stackoverflow.com/q/143405/11683\">implicit interface implementation</a>.</p>\n\n<p>To use the implemented interface, you need to cast the object to that interface:</p>\n\n<pre><code>Dim test As IFeed\nSet test = New CFeed\ntest.Name = \"New Feed\"\n</code></pre>\n"}], "owner": {"reputation": 9197, "user_id": 467859, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a5840a36814a756ed14c35c813ea82a6?s=128&d=identicon&r=PG", "display_name": "punkrockbuddyholly", "link": "https://stackoverflow.com/users/467859/punkrockbuddyholly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "accepted_answer_id": 28452386, "answer_count": 1, "score": 2, "last_activity_date": 1423651725, "creation_date": 1423651529, "question_id": 28452315, "link": "https://stackoverflow.com/questions/28452315/cant-seem-to-use-interfaces-with-properties-in-vba-and-i-cant-work-out-why", "title": "Can&#39;t seem to use Interfaces with properties in VBA and I can&#39;t work out why", "body": "<p>Disclaimer: I have a bit of experience with PHP, Java and VBA but I am mainly a front end developer so Javascript is more my thing.</p>\n\n<p>I am trying to create some classes which implement an Interface in an MS Access Database and I can't even get the concept to work.</p>\n\n<p>What I have:</p>\n\n<h2>IFeed Class (the interface)</h2>\n\n<pre><code>Option Explicit\nPublic Name As String\n\nPublic Property Get Name() As String\nEnd Property\n\nPublic Property Let Name(ByVal vNewValue As String)\nEnd Property\n</code></pre>\n\n<h2>CFeed Class</h2>\n\n<pre><code>Option Explicit\n\nImplements IFeed\n\nPrivate Name As String\n\nPrivate Property Let IFeed_Name(ByVal newName As String)\n    Name = newName\nEnd Property\n\nPrivate Property Get IFeed_Name() As String\n    IFeed_Name = Name\nEnd Property\n</code></pre>\n\n<h2>Test module</h2>\n\n<pre><code>Public Sub testFeedClass()\n    Dim test As CFeed\n    Set test = New CFeed\n    test.Name = \"New Feed\" ' Doesn't work\n    Debug.Print test.Name\nEnd Sub\n</code></pre>\n\n<p>I have spend almost a day changing private to public, public to private and loads of other things but I just can't get it to work. Can someone please point out where I am going wrong? I am sure it is something simple.</p>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 20290, "user_id": 57475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yC6us.png?s=128&g=1", "display_name": "Tanner", "link": "https://stackoverflow.com/users/57475/tanner"}, "edited": false, "score": 0, "creation_date": 1423651765, "post_id": 28452293, "comment_id": 45232046, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/5674187/data-fetching-from-sql-server-in-vba\">Data fetching from SQL Server in VBA</a>"}, {"owner": {"reputation": 15568, "user_id": 815073, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/225d5b8f09b70d69569b10be9860c546?s=128&d=identicon&r=PG", "display_name": "von v.", "link": "https://stackoverflow.com/users/815073/von-v"}, "edited": false, "score": 0, "creation_date": 1423651790, "post_id": 28452293, "comment_id": 45232058, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/25846954/excel-vba-loop-through-recordset\">Excel VBA - Loop through recordset</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 1, "creation_date": 1423652701, "post_id": 28452576, "comment_id": 45232583, "body": "The OP needs a VBA solution, not C/C++"}], "tags": [], "owner": {"reputation": 19, "user_id": 1969545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5921b0bc874e1bb73ceb844377c922f8?s=128&d=identicon&r=PG", "display_name": "jpenaab", "link": "https://stackoverflow.com/users/1969545/jpenaab"}, "is_accepted": false, "score": -1, "last_activity_date": 1423652196, "creation_date": 1423652196, "answer_id": 28452576, "question_id": 28452293, "link": "https://stackoverflow.com/questions/28452293/retrieve-sql-query-containing-more-than-one-result/28452576#28452576", "title": "retrieve SQL query containing more than one result", "body": "<p>I think that is better if you use JPA or Hibernate like persistence mechanism. But if you don't like it, I think that the best option for do that is creating an instance of an object and in that object override toString method. Ex:</p>\n\n<pre><code>String selectTableSQL = \"SELECT USER_ID, USERNAME from DBUSER\";\nStatement statement = dbConnection.createStatement();\n\nList&lt;User&gt; l = new ArrayList&lt;User&gt;(); //users retrieve from BBDD\n\nResultSet rs = statement.executeQuery(selectTableSQL);\n    while (rs.next()) {\n    String userid = rs.getString(\"USER_ID\");\n    String username = rs.getString(\"USERNAME\");\n    User u = new User(userid,username); // new USER created\n    l.add(u); //add user to list users object\n}\n\nfor(User u : l){\n//Get list of users.\nSystem.out.println(u);\n}\n</code></pre>\n\n<p>I hope that I help you</p>\n"}], "owner": {"reputation": 159, "user_id": 4042816, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/575ba0fc635267c6c54d093709c34b94?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Lopes", "link": "https://stackoverflow.com/users/4042816/bruno-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423652196, "creation_date": 1423651482, "question_id": 28452293, "link": "https://stackoverflow.com/questions/28452293/retrieve-sql-query-containing-more-than-one-result", "title": "retrieve SQL query containing more than one result", "body": "<p>To retrieve a value from a SQL query I usually use the following code:</p>\n\n<pre><code>Set rs = conn.Execute(\"SELECT...\")\nstrResult = rs.Fields(0)\nmsgbox(strResult)\n</code></pre>\n\n<p>wich works fine for queries returning one value. For example, if the query result was:</p>\n\n<pre><code>LONDON\nNEW YORK\nBERLIN\n</code></pre>\n\n<p>this will only retrieve \"LONDON\"</p>\n\n<p>But if I want to obtain all the values from this query, and for example show them on a message box, how can this be done? I am using SQL Server 2005.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423655899, "post_id": 28452153, "comment_id": 45234517, "body": "What happens when you debug the code? (Go through it, step for step). Do you get any errors? I think <code>dict(Sheet2.Cells(i, 1).Value) = 1</code> might be a culprit. Also, try to avoid selecting things, it is prone to errors."}, {"owner": {"reputation": 137, "user_id": 4027092, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/paKEG.jpg?s=128&g=1", "display_name": "SriLaks", "link": "https://stackoverflow.com/users/4027092/srilaks"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423656305, "post_id": 28452153, "comment_id": 45234782, "body": "It gives an run time error 1004. at sheet1.Range(&quot;B2:D2&quot;).Select             Selection.Copy"}, {"owner": {"reputation": 137, "user_id": 4027092, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/paKEG.jpg?s=128&g=1", "display_name": "SriLaks", "link": "https://stackoverflow.com/users/4027092/srilaks"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423661850, "post_id": 28452153, "comment_id": 45238069, "body": "Anybody... please!! guide me through"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4027092, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/paKEG.jpg?s=128&g=1", "display_name": "SriLaks", "link": "https://stackoverflow.com/users/4027092/srilaks"}, "edited": false, "score": 0, "creation_date": 1423666657, "post_id": 28457320, "comment_id": 45241277, "body": "Type mismatch error at   If ws1.Range(&quot;B2&quot;, &quot;B&quot; &amp; lastRow1).Value = ws2.Range(&quot;A2&quot;, &quot;A&quot; &amp; lastRow2).Value Then"}], "tags": [], "owner": {"reputation": 137, "user_id": 4027092, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/paKEG.jpg?s=128&g=1", "display_name": "SriLaks", "link": "https://stackoverflow.com/users/4027092/srilaks"}, "is_accepted": false, "score": 0, "last_activity_date": 1423666377, "creation_date": 1423666377, "answer_id": 28457320, "question_id": 28452153, "link": "https://stackoverflow.com/questions/28452153/compare-between-sheets-in-excel-vba/28457320#28457320", "title": "Compare between sheets in excel vba", "body": "<p>This code is almost working good. For the first run it loads the data from sheet1 to sheet2.\nDuring second run I get an type mismatch error!</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim x As Long\r\nDim y As Long\r\nDim ws1 As Worksheet\r\nDim ws2 As Worksheet\r\nDim lastRow1, lastRow2, lastrow3 As Long\r\nDim proc As Range\r\nDim del As Range\r\n\r\nSet ws1 = Worksheets(\"Metadatasheet\")\r\nSet ws2 = Worksheets(\"PlanningData\")\r\n\r\ny = 2 'this is the first row where your data will output\r\nx = 2 'this is the first row where you want to check for data\r\nlastRow1 = ws1.Range(\"B:B\").Find(\"*\", SearchDirection:=xlPrevious).Row\r\nlastRow2 = ws2.Range(\"A:A\").Find(\"*\", SearchDirection:=xlPrevious).Row\r\n\r\nIf Not IsEmpty(ws2.Range(\"B2\").Value) Then\r\n\r\n    Do Until ws1.Range(\"B2\") = \"\"\r\n        \r\n        For x = 2 To lastRow2\r\n            If ws1.Range(\"B2\", \"B\" &amp; lastRow1).Value = ws2.Range(\"A2\", \"A\" &amp; lastRow2).Value Then\r\n                ws2.Range(\"A\" &amp; y).Value = ws1.Range(\"B\" &amp; x).Value\r\n                ws2.Range(\"B\" &amp; y).Value = ws1.Range(\"C\" &amp; x).Value\r\n                ws2.Range(\"C\" &amp; y).Value = ws1.Range(\"D\" &amp; x).Value\r\n                            \r\n                Set proc = ws1.Range(\"E\" &amp; y)\r\n                proc.Value = \"X\"\r\n            y = y + 1\r\n            Else\r\n            Set del = ws2.Range(\"D\" &amp; y)\r\n            del.Value = \"X\"\r\n            End If\r\n        Next x\r\n    Loop\r\n\r\nElse\r\n'lastrow3 = ws1.Range(\"E:E\").Find(\"*\", SearchDirection:=xlPrevious).Row\r\n    For x = 2 To lastRow1\r\n        If Not ws1.Range(\"E\" &amp; y).Value = \"X\" Then\r\n                ws2.Range(\"A\" &amp; y).Value = ws1.Range(\"B\" &amp; x).Value\r\n                ws2.Range(\"B\" &amp; y).Value = ws1.Range(\"C\" &amp; x).Value\r\n                ws2.Range(\"C\" &amp; y).Value = ws1.Range(\"D\" &amp; x).Value\r\n            y = y + 1\r\n        End If\r\n    Next x\r\nEnd If\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 137, "user_id": 4027092, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/paKEG.jpg?s=128&g=1", "display_name": "SriLaks", "link": "https://stackoverflow.com/users/4027092/srilaks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423666377, "creation_date": 1423651092, "last_edit_date": 1531164843, "question_id": 28452153, "link": "https://stackoverflow.com/questions/28452153/compare-between-sheets-in-excel-vba", "title": "Compare between sheets in excel vba", "body": "<p>I'm new to VBA and currently busting my head to maintain item list in excel which is connected to database.</p>\n\n<ul>\n<li><p>sheet1 columns (starts from column B)</p>\n\n<p>UID   |  itemno.  |  itemweight  |  processed</p></li>\n<li><p>sheet2 same headers(starts from column A)</p>\n\n<p>UID   |  itemno.  |  itemweight  |  deleted</p></li>\n</ul>\n\n<p>I framed this theoretical target and coded it, tried several times.</p>\n\n<p>It is not looping :( and not achieving my target.</p>\n\n<p>Any suggestions will be helpful! Thanks in advance </p>\n\n<p>Following are my steps framed with the code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Private Sub CommandButton3_Click()\r\n\r\n\r\n' Loop until no new UID found\r\n' 1. GoTo Sheet2 to First/Next Cell with UID\r\n' 2. Read UID value\r\n' 3. GoTo Sheet1\r\n' 4. Search in UID column for read UID\r\n' 5. if UID found\r\n    ' 5.1 get data from Sheet1\r\n    ' 5.2 GoTo Sheet 2\r\n    ' 5.3 Past data in right cells\r\n    ' 5.4 GoTo Sheet 1\r\n    ' 5.5 Put check flag in proccessed field\r\n' 6. if UID NOT found\r\n    ' 6.1 GoTo Sheet 2\r\n    ' 6.2 Put delete flag in delete field\r\n' Loop End\r\n'\r\n' GoTo Sheet1\r\n' Search for all parts with no checked process flag\r\n' Copy datasets\r\n' GoTo Sheet2\r\n' Add data to the end of table\r\n---------------------------------------------------\r\nDim dict As Object\r\nDim proc As Range\r\nDim del As Range\r\nDim chk, myrange As Range\r\n    \r\n    Set dict = CreateObject(\"Scripting.dictionary\")\r\n\r\n    Dim sheet1 As Worksheet, Sheet2 As Worksheet\r\n    Set sheet1 = ThisWorkbook.Worksheets(\"MetadataSheet\")\r\n    \r\n    Set Sheet2 = ThisWorkbook.Worksheets(\"PlanningData\")\r\n\r\n    ' Read values from sheet2 to dictionary\r\n    Dim lastRow As Long\r\n    lastRow = Sheet2.Cells(Sheet2.Rows.Count, 1).End(xlUp).Row\r\n    Dim i As Long\r\n    For i = 1 To lastRow\r\n        ' Store value to dictionary\r\n        dict(Sheet2.Cells(i, 1).Value) = 1\r\n    Next\r\n\r\n    ' Read from sheet1 and check if each value exists\r\n    lastRow = sheet1.Cells(sheet1.Rows.Count, 2).End(xlUp).Row\r\n    For i = 1 To lastRow\r\n        ' Check if value exists in dictionary\r\n        If dict.exists(sheet1.Cells(i, 2).Value) Then\r\n            ' found\r\n            sheet1.Range(\"B2:D2\").Select\r\n            Selection.Copy\r\n            Sheet2.Select\r\n            Sheet2.Range(\"A2:C2\").Select\r\n            ActiveSheet.Paste\r\n            sheet1.Select\r\n            sheet1.Range(\"E2\").Select\r\n            Set proc = sheet1.Range(\"E2\")\r\n            proc.Value = \"X\"\r\n        Else\r\n            ' not found\r\n            Sheet2.Select\r\n            Set del = Sheet2.Range(\"D2\")\r\n            del.Value = \"X\"\r\n        End If\r\n    Next\r\n'for initial load\r\nsheet1.Select\r\nSet chk = sheet1.Range(\"E2\", \"E\" &amp; lastRow)\r\nFor Each chk In myrange\r\n        If chk.Value = \"\" Then\r\n            chk.Range(\"B2:D2\").Select\r\n            Selection.Copy Destination:= _\r\n    Sheets(2).Range(\"A65536\").End(xlUp)(2, 1)\r\n              \r\n        End If\r\n    Next chk\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": true, "score": 0, "last_activity_date": 1423657761, "creation_date": 1423657761, "answer_id": 28454382, "question_id": 28451733, "link": "https://stackoverflow.com/questions/28451733/word-vba-programmatically-check-for-certain-style-in-range/28454382#28454382", "title": "Word, VBA: Programmatically check for certain style in range", "body": "<p>This is possible with the <code>Selection.Find</code> method</p>\n\n<pre><code>mySelection.Find.ClearFormatting\nmySelection.Find.Style = ActiveDocument.Styles(\"Heading 1\")\nWith mySelection.Find\n        .Text = \"\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchByte = False\n        .CorrectHangulEndings = False\n        .HanjaPhoneticHangul = False\n        .MatchAllWordForms = False\n        .MatchSoundsLike = False\n        .MatchWildcards = False\n        .MatchFuzzy = False\nEnd With\nmySelection.Find.Execute\n</code></pre>\n"}], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 28454382, "answer_count": 1, "score": 0, "last_activity_date": 1574564962, "creation_date": 1423649866, "last_edit_date": 1574564962, "question_id": 28451733, "link": "https://stackoverflow.com/questions/28451733/word-vba-programmatically-check-for-certain-style-in-range", "title": "Word, VBA: Programmatically check for certain style in range", "body": "<p>I have a range. In this range is some text. Can I now detect with vba whether a certain stlye - let's say Heading1 - is used in this range?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": true, "score": 1, "last_activity_date": 1423651475, "creation_date": 1423651475, "answer_id": 28452290, "question_id": 28451491, "link": "https://stackoverflow.com/questions/28451491/replace-automatic-text-color-to-some-explicit-color-in-selection/28452290#28452290", "title": "Replace automatic text color to some explicit color in selection", "body": "<p>try this:</p>\n\n<pre><code>Sub Test()\n      With ActiveDocument.Range.Find\n      .Text = \"wdColorAutomatic\"\n      .Replacement.Text = \"wdColorWhite\"\n      .Forward = True\n      .Wrap = wdFindContinue\n      .Format = False\n      .MatchCase = False\n      .MatchWholeWord = False\n      .MatchWildcards = False\n      .MatchSoundsLike = False\n      .MatchAllWordForms = False\n      .Execute Replace:=wdReplaceAll\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3398, "user_id": 447503, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0d7ec5ed7c7fa28d5b6b2a51d5803c9a?s=128&d=identicon&r=PG", "display_name": "basin", "link": "https://stackoverflow.com/users/447503/basin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 28452290, "answer_count": 1, "score": 0, "last_activity_date": 1423651475, "creation_date": 1423649113, "question_id": 28451491, "link": "https://stackoverflow.com/questions/28451491/replace-automatic-text-color-to-some-explicit-color-in-selection", "title": "Replace automatic text color to some explicit color in selection", "body": "<p>How to write a macro, which finds all blocks of text with <code>Font.ColorIndex = wdColorAutomatic</code> and changes it to wdColorWhite?</p>\n\n<p>I need it to paste rich text to a panel with black background in Confluence wiki. Default colour for this background is grey.</p>\n"}, {"tags": ["vba", "excel", "syntax-error", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 3527561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b07467aacf5c7253029a292f67d7f45?s=128&d=identicon&r=PG&f=1", "display_name": "Gotte", "link": "https://stackoverflow.com/users/3527561/gotte"}, "edited": false, "score": 0, "creation_date": 1423648982, "post_id": 28451431, "comment_id": 45230433, "body": "Tks so much for prompt answer"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1423648926, "creation_date": 1423648926, "answer_id": 28451431, "question_id": 28451358, "link": "https://stackoverflow.com/questions/28451358/syntax-error-in-from-clause-excel-vba/28451431#28451431", "title": "Syntax error in FROM clause Excel VBA", "body": "<p>Your options are wrong. This:</p>\n\n<pre><code>Options:=adCmdTable\n</code></pre>\n\n<p>should be this:</p>\n\n<pre><code>Options:=adCmdText\n</code></pre>\n\n<p>Since you are not passing a table name but a SQL string. (when you pass a table name it is effectively converted into a <code>SELECT * FROM table_name</code> statement).</p>\n"}], "owner": {"reputation": 117, "user_id": 3527561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b07467aacf5c7253029a292f67d7f45?s=128&d=identicon&r=PG&f=1", "display_name": "Gotte", "link": "https://stackoverflow.com/users/3527561/gotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4112, "favorite_count": 0, "accepted_answer_id": 28451431, "answer_count": 1, "score": 0, "last_activity_date": 1423648926, "creation_date": 1423648742, "question_id": 28451358, "link": "https://stackoverflow.com/questions/28451358/syntax-error-in-from-clause-excel-vba", "title": "Syntax error in FROM clause Excel VBA", "body": "<p>Here is my code to retrieve data from access but I always encounter \"Run-time error '-2147217900 (80040e14)' Syntax error in FROM clause\"</p>\n\n<pre><code>Sub UPDATE_REGION()\nDim cnn As New ADODB.Connection\nDim rst As New ADODB.Recordset\nDim AW As Workbook\nSet AW = ActiveWorkbook\nPath = AW.Path\ncnn_pth = Path &amp; \"\\Master File.accdb\"\nSet cnn = New ADODB.Connection\nWith cnn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .Open cnn_pth\nEnd With\nSet rst = New ADODB.Recordset\nsSQL = \"select Package_Nb from [package_db] where [Hubs] is null\"\nrst.Open Source:=sSQL, ActiveConnection:=cnn, CursorType:=adOpenForwardOnly, LockType:=adLockOptimistic, Options:=adCmdTable\nend subs\n</code></pre>\n\n<p>When i stop script to debug, I found Source value in Local Window like this: <code>\"select * from select Package_Nb from package_db where Hubs is null\"</code></p>\n\n<p>I don't know why vba auto add <code>select * from</code> to source like this, anyone know how to fix this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3567780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9206d93505175d9b61478f31064bb4ab?s=128&d=identicon&r=PG&f=1", "display_name": "Nagendra", "link": "https://stackoverflow.com/users/3567780/nagendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1423648014, "creation_date": 1423648014, "answer_id": 28451110, "question_id": 28450451, "link": "https://stackoverflow.com/questions/28450451/follow-hyperlink-and-scroll-to-make-hyperlink-appear-at-top-of-worksheet/28451110#28451110", "title": "Follow hyperlink and scroll to make hyperlink appear at top of worksheet", "body": "<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Address = Range(\"e11\").Address Then\nRange(\"e11\").Select\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Assuming hyperlink is in the cell E11.</p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423648014, "creation_date": 1423646110, "question_id": 28450451, "link": "https://stackoverflow.com/questions/28450451/follow-hyperlink-and-scroll-to-make-hyperlink-appear-at-top-of-worksheet", "title": "Follow hyperlink and scroll to make hyperlink appear at top of worksheet", "body": "<p>I've written the following hyperlink:</p>\n\n<pre><code>=HYPERLINK(\"#\" &amp; ADDRESS(ROW($F$8); COLUMN($F$8));LEFT($F$8;2))\n</code></pre>\n\n<p>The hyperlink is written in a cell with word wrap.</p>\n\n<p>I want Excel to scroll after a user has clicked the hyperlink to make the hyperlink appear on the top visible row. I was hoping Excel had functionality for this, but the best I could find was a suggested VBA solution in another stackoverflow question:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    ActiveWindow.ScrollRow = ActiveCell.Row\nEnd Sub\n</code></pre>\n\n<p>However, that event is not triggered by my hyperlinks, so it has no effect.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1423647779, "post_id": 28450414, "comment_id": 45229717, "body": "You need to iterate the cells in rng using a foreach construction. Using the <code>.Item</code> method as you are is not restricted to the actual cells in the range - it&#39;s just relative to the first cell of the range."}, {"owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1423650998, "post_id": 28450414, "comment_id": 45231631, "body": "Thanks mate! This solved it!"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "edited": false, "score": 0, "creation_date": 1423647609, "post_id": 28450670, "comment_id": 45229624, "body": "Thank you but it didn&#39;t help. I still get a null value stored in my rng. I don&#39;t get it. It clearly highlights all non-empty cells in the sheet it also says it only contains 5 non-empty cells butt still, the third position in rng stores a null."}], "tags": [], "owner": {"reputation": 1443, "user_id": 1064175, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9aa6bf0a5fd5211885a39a8965191fa8?s=128&d=identicon&r=PG", "display_name": "Francesco De Lisi", "link": "https://stackoverflow.com/users/1064175/francesco-de-lisi"}, "is_accepted": false, "score": 0, "last_activity_date": 1423646743, "creation_date": 1423646743, "answer_id": 28450670, "question_id": 28450414, "link": "https://stackoverflow.com/questions/28450414/excel-range-in-c-using-interop-excel-range-both-empty-and-not-empty/28450670#28450670", "title": "Excel Range in C# using interop.Excel. Range both empty and not empty?", "body": "<p>Try using:</p>\n\n<pre><code>ws.Columns.ClearFormats();\nws.Rows.ClearFormats();\n</code></pre>\n\n<p>to be sure your Range excludes formatted but empty cells.</p>\n\n<p>Another try could be to get :</p>\n\n<pre><code>Excel.Range rng = row.SpecialCells(Excel.XlCellType.xlCellTypeConstants,Type.Missing);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "is_accepted": true, "score": 0, "last_activity_date": 1423651134, "creation_date": 1423651134, "answer_id": 28452164, "question_id": 28450414, "link": "https://stackoverflow.com/questions/28450414/excel-range-in-c-using-interop-excel-range-both-empty-and-not-empty/28452164#28452164", "title": "Excel Range in C# using interop.Excel. Range both empty and not empty?", "body": "<p>This solved it! However I didn't use the  .Item method to store the values as Rory suggested suggested. Thnx Rory!    </p>\n\n<pre><code>        string[] str = new String[rng.Count];\n        int i = 0;\n\n        foreach (Excel.Range cell in rng.Cells)\n        {\n            str[i] = cell.Value.ToString();\n            i++;\n        }\n\n        for (int j = 0; j &lt; str.Length; j++)\n            Console.WriteLine(str[j]);\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2295, "favorite_count": 0, "accepted_answer_id": 28452164, "answer_count": 2, "score": 2, "last_activity_date": 1423651134, "creation_date": 1423645977, "last_edit_date": 1531164843, "question_id": 28450414, "link": "https://stackoverflow.com/questions/28450414/excel-range-in-c-using-interop-excel-range-both-empty-and-not-empty", "title": "Excel Range in C# using interop.Excel. Range both empty and not empty?", "body": "<p>I have a Excel sheet that looks like this.\n|A1|B1| \"BLANK\" |D1|E1|F1|\nI.e. only the first row is populated and the third column is blank. I parse this in C# using interop.excel in the following way:</p>\n\n<pre><code>        Excel.Application exApp = OpenExcel();\n        String mySheet = @\"C:\\c#\\rapport.xlsx\";\n        Excel.Workbook wb = exApp.Workbooks.Open(mySheet);\n        Excel.Worksheet ws = wb.Sheets[1];\n        Excel.Range row = ws.Rows[1];\n</code></pre>\n\n<p>I create a new range only containing the non-empty cells in row 1 by</p>\n\n<pre><code>        Excel.Range rng = row.SpecialCells(Excel.XlCellType.xlCellTypeConstants);\n</code></pre>\n\n<p>Now: if I use <code>rng.Select</code> all the non-empty cells in my sheet is selected. And if I use <code>rng.Count</code> it will return 5, which is the number of non-empty cells in my sheet. But still when I print cell by cell using:</p>\n\n<pre><code>Console.WriteLine(rng[1,i].Value.ToString());\n</code></pre>\n\n<p>It shows that rng[1, 1-2] contains \"A1 and B1\", this is nice. But\nrng[1, 3] is empty or null. And rng[1, 4-7] contains D1-F1. </p>\n\n<p>How is this possible?  </p>\n\n<p>My main goal is to store all non-empty values in a string array. But I can't select the right values because my range rng is both empty and non-empty is some weird way.</p>\n"}, {"tags": ["vba", "excel", "web-scraping", "frames"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423654932, "post_id": 28449981, "comment_id": 45233962, "body": "Without the HTML source is almost impossible to answer this question, please add it."}, {"owner": {"reputation": 169, "user_id": 1890559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e9b4ea015e002db645a407d1a4484dc?s=128&d=identicon&r=PG", "display_name": "Marcus C", "link": "https://stackoverflow.com/users/1890559/marcus-c"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423742979, "post_id": 28449981, "comment_id": 45277066, "body": "I have added the source code of the page that is being scraped. This code doesnt contain the data that i wish to scrap though. &quot;Option B&quot; seems to be option I need....I can see data on screen, but just not in that source code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540496348, "post_id": 28449981, "comment_id": 92898686, "body": "There are no frames in the above HTML."}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1499263061, "post_id": 28609603, "comment_id": 76832106, "body": "can you explain this further please? i have posted a question about this and have had no success"}], "tags": [], "owner": {"reputation": 169, "user_id": 1890559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e9b4ea015e002db645a407d1a4484dc?s=128&d=identicon&r=PG", "display_name": "Marcus C", "link": "https://stackoverflow.com/users/1890559/marcus-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1424358166, "creation_date": 1424358166, "answer_id": 28609603, "question_id": 28449981, "link": "https://stackoverflow.com/questions/28449981/excel-vba-web-scraping-target-a-different-frame/28609603#28609603", "title": "Excel VBA web scraping - Target a different Frame", "body": "<p>This simple solution did the trick. (By trial and error, I figured out the frame I wanted to manipulate for Frame 1).</p>\n\n<pre><code>Set ieDoc = doc.frames(1).document\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 1890559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e9b4ea015e002db645a407d1a4484dc?s=128&d=identicon&r=PG", "display_name": "Marcus C", "link": "https://stackoverflow.com/users/1890559/marcus-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506980113, "creation_date": 1423644480, "last_edit_date": 1423742633, "question_id": 28449981, "link": "https://stackoverflow.com/questions/28449981/excel-vba-web-scraping-target-a-different-frame", "title": "Excel VBA web scraping - Target a different Frame", "body": "<p>I want to pull some data off a website and put it into excel.  I have done this before &amp; have the code written that logs me in and browses to the page I want. </p>\n\n<p>At this point though, the website is in a different format. The page I want has frames. The top frame has a banner and some text, and then there is a form in the bottom frame. When i browse to this point in my VBA code, it seems to find the top frame only - no forms etc. How do I specifically target the frame with the form?? </p>\n\n<p>The HTML Source Code:</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"../custom/LeftSideSquareTabs.css\"&gt;\n&lt;script type=\"text/javascript\" language=\"javascript\" src=\"../include/JSCommon.js\"&gt;&lt;/script&gt;\n\n&lt;Script language=\"JavaScript\"&gt;\nfunction Dummmy()\n{\nparent.location.replace('../login.asp?Locale=EN&amp;Lo=1')\n}\n&lt;/script&gt;\n&lt;/head&gt;\n\n\n&lt;body bgcolor=\"#FFFFFF\" text=\"#000000\" topmargin=\"0\" leftmargin=\"10\"&gt; \n\n    &lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"786\"&gt;\n\n        &lt;tr&gt;\n            &lt;td width=\"50%\" align=\"left\" height=\"62\"&gt;&lt;/td&gt;\n            &lt;td width=\"50%\" align=\"right\" height=\"62\"&gt;\n\n\n                &lt;a href=\"http://www.website.com\" target=\"_blank\"&gt;\n                &lt;img name=\"ToolbarRightLogo\" src=\"../custom/ToolbarlogoRight.gif\"  border=\"0\" alt=\"MMIA version 5.1.0\"&gt;\n                &lt;/a&gt;\n            &lt;/td&gt;\n\n        &lt;/tr&gt;\n\n    &lt;/table&gt;\n\n&lt;table width=\"786\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n  &lt;tr&gt;\n    &lt;td class=\"TabsOff\" onclick=\"dispayMen();\"&gt;Option A&lt;/td&gt;\n    &lt;td class=\"TabsImage\"&gt;&lt;img src=\"../images/TabOff.gif\" width=\"4\" height=\"17\"&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n    &lt;td class=\"TabsOn\"&gt;Option B&lt;&lt;/td&gt;\n    &lt;td class=\"TabsImage\"&gt;&lt;img src=\"../images/TabOn.gif\" width=\"4\" height=\"17\"&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;img src=\"../images/spacer.gif\" width=\"466\" height=\"1\" WIDTH=\"1\" HEIGHT=\"1\"&gt;&lt;/td&gt;\n    &lt;td class=\"SupportOff\" onMouseOver=\"this.className='SupportOver'\" onMouseOut=\"this.className='SupportOff'\" onclick=\"LogOutSession()\"&gt;Log out&lt;/td&gt;\n    &lt;a href=\"mailto:support@xxxxx.com\"&gt;&lt;td class=\"Support\" onMouseOver=\"this.className='SupportO'\" onMouseOut=\"this.className='Support'\"&gt;Contact&lt;/td&gt;&lt;/a&gt;\n    &lt;td&gt;&lt;img src=\"../images/spacer.gif\" width=\"10\" height=\"1\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt; \n    &lt;td class=\"TabsOffBottom\" colspan=\"2\"&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n    &lt;td class=\"TabsOnBottom\" colspan=\"3\"&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n    &lt;td class=\"TabsOffBottom\" colspan=\"7\"&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n\n&lt;table class=\"TabsOnBottom\" width=\"786\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n  &lt;tr&gt; \n    &lt;td class=\"TabsOffBottom\"&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;img src=\"../images/spacer.gif\" width=\"9\" height=\"8\"&gt;&lt;/td&gt;\n    &lt;td class=\"MiddleToolbarText\" width=\"526\"&gt;Option B&lt;/td&gt;\n    &lt;td class=\"MiddleToolbarRightText\" width=\"185\"&gt;Updated to:&amp;nbsp;&lt;/td&gt;\n    &lt;td class=\"MiddleToolbarText\" width=\"55\"&gt;11-02-2015&lt;/td&gt;\n    &lt;td&gt;&lt;img src=\"../images/spacer.gif\" width=\"9\" height=\"1\"&gt;&lt;/td&gt;\n    &lt;td class=\"TabsOffBottom\"&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n\n&lt;table class=\"TabsOnBottom\" width=\"786\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n  &lt;tr&gt; \n    &lt;td class=\"TabsOffBottom\"&gt;&lt;img src=\"../images/spacer.gif\" width=\"1\" height=\"1\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;'\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423645194, "post_id": 28449856, "comment_id": 45228244, "body": "Have you tried removing your <code>On Error Resume Next</code> (shudder) statement to see if there&#39;s actually an error?"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1423645797, "post_id": 28450292, "comment_id": 45228591, "body": "What version of Excel are you using?"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1423645885, "post_id": 28450292, "comment_id": 45228640, "body": "2010 ... more words bla"}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1423645930, "post_id": 28450292, "comment_id": 45228659, "body": "OP is using Excel 2013. xlCellTypeBlanks returns the &quot;correct&quot; address and count when I perform it on Selection. But incorrect when I use it as an UDF and perform it on r as range"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423646301, "post_id": 28450292, "comment_id": 45228871, "body": "I can only assume something with your data, I&#39;ve tested this with <code>selection</code> and a UDF and it works fine for me in Excel 2010..."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423646875, "post_id": 28450292, "comment_id": 45229194, "body": "See my edit above and try using that code. This works fine for me I did the same thing."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423647094, "post_id": 28450292, "comment_id": 45229330, "body": "Are you using the code in an actual code module - not a worksheet module or a workbook module?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423647301, "post_id": 28450292, "comment_id": 45229455, "body": "Sorry - I&#39;m overlooking the fact it&#39;s being used in a cell. This will work in a sub routine, but not in a cell because of the limitations of worksheet functions in Excel."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1423648584, "post_id": 28450292, "comment_id": 45230197, "body": "@Rory thought that too after reading on it <a href=\"http://support.microsoft.com/kb/170787/en-us\" rel=\"nofollow noreferrer\">here</a>. but I was wondering how it could work for S O. Deleting my earlier comments"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1423648726, "post_id": 28450292, "comment_id": 45230283, "body": "@EngJon - it didn&#39;t work for me, I was overlooking the fact it was being used in a cell - which wouldn&#39;t work due to UDF limitations (from the MS article) &quot;<i>For correct calculation, all ranges that are used in the calculation should be passed to the function as arguments.</i>&quot; - The range being used cannot be changed (i.e. using SpecialCells) inside the UDF, it has to be passed to it in the first instance."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1423646394, "last_edit_date": 1423646394, "creation_date": 1423645513, "answer_id": 28450292, "question_id": 28449856, "link": "https://stackoverflow.com/questions/28449856/count-visible-blank-cells-using-vba/28450292#28450292", "title": "Count visible blank cells using VBA?", "body": "<p>Get rid of the <code>On Error Resume Next</code> for a start - you should always assume that your code will fail and account for it accordingly, simply ignoring errors will just complicate matters.</p>\n\n<p>Secondly ,there is no need to use <code>Intersect</code> - just identify the visible cells directly, and then use a further <code>SpecialCells()</code> method to identify the blank child cells.</p>\n\n<pre><code>Function VisibleBlankCells(r As Range) As Long\n    VisibleBlankCells = r.SpecialCells(xlCellTypeVisible).SpecialCells(xlCellTypeBlanks).Count\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>tested with this:</p>\n\n<pre><code>Sub test_code()\n    Dim r As Range: Set r = Selection\n    Debug.Print CountBlanks(r)\nEnd Sub\n\nFunction CountBlanks(r As Range) As Long\n    CountBlanks = r.SpecialCells(xlCellTypeVisible).SpecialCells(xlCellTypeBlanks).Count\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": false, "score": 0, "last_activity_date": 1423648406, "creation_date": 1423648406, "answer_id": 28451234, "question_id": 28449856, "link": "https://stackoverflow.com/questions/28449856/count-visible-blank-cells-using-vba/28451234#28451234", "title": "Count visible blank cells using VBA?", "body": "<p>This kind of filter mechanism won't work in an UDF (see <a href=\"http://support.microsoft.com/kb/170787/en-us\" rel=\"nofollow\">this</a> for information on that). I suggest a looping inside your UDF:</p>\n\n<pre><code>Public Function VisibleBlankCells(rng As Range) As Long\n    Dim i As Integer\n    Dim cell As Range\n    i = 0\n    For Each cell In rng\n        If cell.Rows.Hidden = False And _\n        cell.Columns.Hidden = False And _\n        cell.Value = \"\" Then\n            i = i + 1\n        End If\n    Next\n    VisibleBlankCells = i\nEnd Function \n</code></pre>\n\n<p>However, there may be some problems regarding the updating and functionality: </p>\n\n<ol>\n<li>The value of the UDF only updates after editing the referenced range or calling other UDFs. So if you hide a column or row in that range, it won't have an instant effect</li>\n<li>In the (working) execution of your code in a Sub, the visible cells (also) refer to yet unused cells in your worksheet to be \"not visible\". In my solution however, all cells that are not contained in a hidden row/column are considered visible. </li>\n</ol>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1573, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423648406, "creation_date": 1423644014, "last_edit_date": 1531164843, "question_id": 28449856, "link": "https://stackoverflow.com/questions/28449856/count-visible-blank-cells-using-vba", "title": "Count visible blank cells using VBA?", "body": "<p>When I enter the following function as a UDF in a cell:</p>\n\n<pre><code>Function VisibleBlankCells(r As Range) As Long\n    On Error Resume Next\n    VisibleBlankCells = Intersect(r.SpecialCells(xlCellTypeVisible), r.SpecialCells(xlCellTypeBlanks)).Count\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p><code>r.SpecialCells(xlCellTypeBlanks)</code> evaluates ALL cells in <code>r</code> as empty regardless of whether they contain text or not. What might be the cause of this and an alternative solution?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1423642070, "post_id": 28449308, "comment_id": 45226768, "body": "&quot;not working&quot; could be a bit more explicit - what happens when you run it?"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1423642383, "post_id": 28449308, "comment_id": 45226918, "body": "If you get rid of the <code>On Error GoTo</code>s, there may be higher chance to locate the error"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4531796, "user_type": "registered", "accept_rate": 9, "profile_image": "https://lh6.googleusercontent.com/-1yefhqOMYL0/AAAAAAAAAAI/AAAAAAAAAnQ/7c3fYEuDUsU/photo.jpg?sz=128", "display_name": "Manya Mohan", "link": "https://stackoverflow.com/users/4531796/manya-mohan"}, "edited": false, "score": 0, "creation_date": 1423644790, "post_id": 28449476, "comment_id": 45228038, "body": "thank you Tim and EngJon for the response. Really appreciate your help here. I will try the code given by you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1423642443, "creation_date": 1423642443, "answer_id": 28449476, "question_id": 28449308, "link": "https://stackoverflow.com/questions/28449308/check-if-workbook-exists-if-yes-then-check-if-its-open-if-open-then-activate/28449476#28449476", "title": "Check if workbook exists, if yes then check if its open. if open then activate, if closed then open it", "body": "<pre><code>Sub test()\n\n    Dim WbookCheck As Workbook\n\n    On Error Resume Next\n    Set WbookCheck = Workbooks(\"Weekly Report.xls\")\n    On Error GoTo 0\n\n    If WbookCheck Is Nothing then 'not open....\n\n        filepaths = \"c:\\clients\\work\\Weekly Report.xls\"\n\n        If Dir(filepaths) = \"\" Then\n            MsgBox \"Please save the latest file under the name\" &amp; _\n              \" 'US Sector Flow Weekly Report' and run the macro again\"\n            Exit Sub\n        Else\n            'file exists - open it\n            Set WbookCheck = Workbooks.Open(filepaths)\n        End If\n    End If\n\n    with WbookCheck\n        .Activate\n        .Sheets(\"This week\").Copy _\n                Before:=Workbooks(\"Consolidated.xls\").Sheets(1)\n    end with\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4531796, "user_type": "registered", "accept_rate": 9, "profile_image": "https://lh6.googleusercontent.com/-1yefhqOMYL0/AAAAAAAAAAI/AAAAAAAAAnQ/7c3fYEuDUsU/photo.jpg?sz=128", "display_name": "Manya Mohan", "link": "https://stackoverflow.com/users/4531796/manya-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21536, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1423887087, "creation_date": 1423641820, "last_edit_date": 1423887087, "question_id": 28449308, "link": "https://stackoverflow.com/questions/28449308/check-if-workbook-exists-if-yes-then-check-if-its-open-if-open-then-activate", "title": "Check if workbook exists, if yes then check if its open. if open then activate, if closed then open it", "body": "<p>I am working on a VBA program where I need to do following:</p>\n\n<p>When the button is clicked (the macro is run):</p>\n\n<ol>\n<li><p>Check if the MS EXCEL workbook exists in the folder. If not, then give a message that 'workbook does not exist' and VBA program should end.</p></li>\n<li><p>If workbook exists, then check if workbook closed or open. If its closed, then open the workbook and VBA program should move with fruther steps.</p></li>\n<li><p>If the sheet is open then activate the workbook and VBA program should move with fruther steps.</p></li>\n</ol>\n\n<p>I have written this so far but its not working:</p>\n\n<pre><code>Sub test()\n    Dim WbookCheck As Workbook\n\n    On Error Resume Next\n    Set WbookCheck = Workbooks(\"Weekly Report.xls\")\n    On Error GoTo 0\n     filepaths = \"c:\\clients\\work\\Weekly Report.xls\"\n    If Dir(\"filepaths\") = False Then\n        MsgBox \"Please save the latest file under the name 'US Sector Flow Weekly Report' and run the macro again\"\n        Exit Sub\n    ElseIf WbookCheck Is Nothing Then\n        Workbooks.Open \"c:\\clients\\work\\Weekly Report.xls\"\n    Else\n        WbookCheck.Activate\n    End If\nWorkbooks(\"Weekly Report.xls\").Activate\n\nSheets(\"This week\").Select\n    Sheets(\"This week\").Copy Before:=Workbooks( _\n        \"Consolidated.xls\").Sheets(1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "sharepoint", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": true, "score": 1, "last_activity_date": 1423642897, "creation_date": 1423642897, "answer_id": 28449569, "question_id": 28449233, "link": "https://stackoverflow.com/questions/28449233/check-in-document-from-sharepoint-after-edit/28449569#28449569", "title": "check in document from sharepoint after edit", "body": "<p>Okay, this wasn't very difficult. I just replaced <code>oDoc.Close</code> with <code>oDoc.CheckIn</code></p>\n\n<pre><code>oDoc.Save\noDoc.CheckIn\noWord.Quit\n</code></pre>\n"}], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 28449569, "answer_count": 1, "score": 0, "last_activity_date": 1423642897, "creation_date": 1423641483, "question_id": 28449233, "link": "https://stackoverflow.com/questions/28449233/check-in-document-from-sharepoint-after-edit", "title": "check in document from sharepoint after edit", "body": "<p>In my word vba I open a file from sharepoint with this code</p>\n\n<pre><code>Set oWord = CreateObject(\"Word.Application\")\nSet oDoc = oWord.Documents.Open(path)\n</code></pre>\n\n<p>Then I start editing the file.</p>\n\n<p>After all I save it back to sharepoint with this code</p>\n\n<pre><code>oDoc.Save\noDoc.Close\noWord.Quit\n</code></pre>\n\n<p>The problem now is that the document is still \"checked out\". How can i programatically check it in?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423642910, "post_id": 28449432, "comment_id": 45227166, "body": "Hey! Thanks so much. It works like a charm. However, what if i want it to be as &quot;Feb-15&quot; instead of 02/15/2015?"}, {"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "reply_to_user": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423651096, "post_id": 28449432, "comment_id": 45231682, "body": "Either format the entire column using <code>Format Cells &gt; Custom &gt; mmm-yy</code> or use the <code>Format</code> function in the VBA."}, {"owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423706239, "post_id": 28449432, "comment_id": 45261385, "body": "Thank you so much. Works perfectly!!"}], "tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1423660941, "last_edit_date": 1423660941, "creation_date": 1423642278, "answer_id": 28449432, "question_id": 28448832, "link": "https://stackoverflow.com/questions/28448832/new-column-values-based-on-another-column-date/28449432#28449432", "title": "New column values based on another column date", "body": "<p>Suppose your dates are in <code>A1:A3</code> this might work for you:</p>\n\n<pre><code>Sub GetMonth()\n    Dim dates As Range, dt As Range\n\n    Set dates = Range(\"A1:A3\")\n\n    For Each dt In dates\n\n        If VBA.DatePart(\"d\", dt) &lt; 16 Then\n            dt.Offset(0, 1) = dt\n        Else\n            dt.Offset(0, 1) = VBA.DateAdd(\"m\", 1, dt)\n        End If\n\n        dt.Offset(0, 1).NumberFormat = \"mmm-yy\"\n\n    Next dt\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "accepted_answer_id": 28449432, "answer_count": 1, "score": 0, "last_activity_date": 1423660941, "creation_date": 1423639958, "last_edit_date": 1423641184, "question_id": 28448832, "link": "https://stackoverflow.com/questions/28448832/new-column-values-based-on-another-column-date", "title": "New column values based on another column date", "body": "<p>I need some guidance for this. I have a set of data. In column A there are dates from 01/01/2015 to 12/31/2015 filled down the row. What I am trying to achieve is to create a new column and fill it with values based on the date.</p>\n\n<p>For example if column A row 1 has date 01/16/2015, the new column will have the value \"Jan-15\" . Basically if the date falls between 01/16/2015 and 02/15/2015, it will have the value \"Jan-15\". If it falls between 02/16/2015 and 03/15/2015, it will have the value \"Feb-15\".</p>\n\n<p>This is what I have right now. The problem is; there is no value input into the new column. Just a blank column with a header. </p>\n\n<pre><code>Sub Month() \n    Dim Found As Range \n    Dim LR As Long \n    Dim ws As Worksheet \n    Dim cell As Range \n    Dim a As Variant, v As Variant, num \n    Set ws = Sheets(\"PAYABLES - OUTFLOWS\") \n    Set Found = ws.Rows(1).Find(What:=\"Due Date\", _ \n    LookIn:=xlValues, lookat:=xlWhole) \n    If Found Is Nothing Then Exit Sub \n    a = [{\"#01/18/2015\", Jan; \"#01/19/2015\", Jan; \"#01/20/2015\", Jan}] \n    LR = ws.Cells(ws.Rows.Count, Found.Column).End(xlUp).Row \n    Found.Offset(0, 2).EntireColumn.Insert \n    ws.Cells(1, Found.Column + 2).Value = \"Month\" \n\n\n    For Each cell In ws.Range(ws.Range(\"A2\"), ws.Cells(LR, 3)) \n\n        v = Application.VLookup(cell.Value, a, 2, False) \n        cell.EntireRow.Cells(Found.Column + 2).Value = IIf(IsError(v), \"\", v) \n    Next cell \n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "adodb", "vba"], "answers": [{"tags": [], "owner": {"reputation": 295, "user_id": 1431717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2558381bc5274d82bfe9eb2a93a0ac57?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1431717/ryan"}, "is_accepted": false, "score": 1, "last_activity_date": 1423640724, "creation_date": 1423640724, "answer_id": 28449048, "question_id": 28448214, "link": "https://stackoverflow.com/questions/28448214/unspecified-error-when-opening-the-65th-adodb-recordset-in-a-loop/28449048#28449048", "title": "Unspecified error when opening the 65th ADODB Recordset in a loop", "body": "<p>Well, after tinkering with it, I discovered the problem lay in the connection.  Instead of constructing the connection string as a string, I created a connection object and then closed it after opening the recordset.  Must be some kind of limitation on the number of connections that can exist in a given session.  Here is the revised function:</p>\n\n<pre><code>Public Function GetRecords(ByVal dataSrc as String) as ADODB.Recordset\n\nDim dir as String\nDim file as String\nDim recordData as ADODB.Recordset\nDim sql as String\nDim cn as ADODB.Connection\n\ndir = \"C:\\MyDirectory\"\nfile = dataSrc &amp; \".csv\"\n\nIf DoesFileExist(dir &amp; file) Then\n    sql = \"select * from \" &amp; file &amp; \";\"\n\n    Set recordData = New ADODB.Recordset\n    Set cn = New ADODB.Connection\n\n    With cn\n        .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n        .ConnectionString = \"Data Source=\" &amp; dir &amp; \";\" &amp; \"Extended    Properties=\"\"text; HDR=Yes; FMT=Delimited; IMEX=1;\"\"\"\n        .CursorLocation = adUseClient\n        .Open\n    End With\n\n    recordData.CursorLocation = adUseClient\n    recordData.Open sql, conn, adOpenForwardOnly, adLockReadOnly, adCmdText\n\n    cn.Close\nElse\n    Set recordData = Nothing\nEnd If\n\nSet GetRecords = recordData\n\nrecordData.Close\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 295, "user_id": 1431717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2558381bc5274d82bfe9eb2a93a0ac57?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1431717/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423640724, "creation_date": 1423637473, "last_edit_date": 1531164843, "question_id": 28448214, "link": "https://stackoverflow.com/questions/28448214/unspecified-error-when-opening-the-65th-adodb-recordset-in-a-loop", "title": "Unspecified error when opening the 65th ADODB Recordset in a loop", "body": "<p>I have a bit of code that loops through a bunch of files in a folder and loads the data into recordsets, storing the filenames and recordsets in a dictionary (as a key/value pair) for later use.  The loop works fine for the first 64 files, but then it gives me an \"Unspecified Error\" dialog on the 65th try.  The code breaks at the recordData.Open line (the loop calls the below function, so the For Each loop is not shown):</p>\n\n<pre><code>Public Function GetRecords(ByVal dataSrc as String) as ADODB.Recordset\n\nDim dir as String\nDim file as String\nDim recordData as ADODB.Recordset\nDim sql as String\nDim conn as String\n\ndir = \"C:\\MyDirectory\"\nfile = dataSrc &amp; \".csv\"\n\nconn = \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n               \"Data Source=\" &amp; dir &amp; \";\" &amp; _\n               \"Extended Properties=\"\"text; HDR=Yes; FMT=Delimited; IMEX=1;\"\"\"\n\nIf DoesFileExist(dir &amp; file) Then\n    sql = \"select * from \" &amp; file &amp; \";\"\n\n    Set recordData = New ADODB.Recordset\n\n    recordData.CursorLocation = adUseClient\n    recordData.Open sql, conn, adOpenForwardOnly, adLockReadOnly, adCmdText\nElse\n    Set recordData = Nothing\nEnd If\n\nSet GetRecords = recordData\n\nrecordData.Close\n\nEnd Function\n</code></pre>\n\n<p>If I rename or delete the file it currently stops on, it errors out on the new 65th file, so I know the actual file itself is not to blame.  Is there a limitation on the number of recordsets that I can open in one session, or am I opening them in an inefficient way?  </p>\n"}, {"tags": ["vba", "excel", "sql-server-2012"], "answers": [{"tags": [], "owner": {"reputation": 1600, "user_id": 497458, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/731d911620ede276d8dd1b15e7740e8a?s=128&d=identicon&r=PG", "display_name": "President Camacho", "link": "https://stackoverflow.com/users/497458/president-camacho"}, "is_accepted": true, "score": 0, "last_activity_date": 1423639258, "creation_date": 1423639258, "answer_id": 28448646, "question_id": 28448136, "link": "https://stackoverflow.com/questions/28448136/error-3420-object-invalid-or-no-longer-set/28448646#28448646", "title": "Error 3420: Object invalid or no longer set", "body": "<p>I forgot this instantiate wrkODBC1, working now.</p>\n"}], "owner": {"reputation": 1600, "user_id": 497458, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/731d911620ede276d8dd1b15e7740e8a?s=128&d=identicon&r=PG", "display_name": "President Camacho", "link": "https://stackoverflow.com/users/497458/president-camacho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 28448646, "answer_count": 1, "score": 0, "last_activity_date": 1423639258, "creation_date": 1423637190, "last_edit_date": 1423637884, "question_id": 28448136, "link": "https://stackoverflow.com/questions/28448136/error-3420-object-invalid-or-no-longer-set", "title": "Error 3420: Object invalid or no longer set", "body": "<p>I'm having trouble with a odbc connection in excel-vba tool.</p>\n\n<pre><code>Public connString As Connection\n\n    Sub login()\n        logout\n        Set wrkODBC1 = CreateWorkspace(\"NewODBC\", \"admin\", \"\", dbUseODBC)\n        Set connString= wrkODBC1.OpenConnection(\"odbc-database\", dbDriverNoPrompt, , \"ODBC;uid=user;pwd=passwrd;DSN=odbc-database\")\n    End Sub\n\n    Sub logout()\n        On Error Resume Next\n        connString.Close\n        wrkODBC1.Close\n        On Error GoTo 0\n    End Sub\n</code></pre>\n\n<p>When running this code:</p>\n\n<pre><code>login\ntxt = \"SELECT [col1],[col1] FROM database.[dbo].[table]\"\nsqlToWorksheet sheet, connString, txt\n\n\nSub sqlToWorksheet(sheet, conn, sqlString)\n    Set temp = conn.OpenRecordset(sqlString, dbOpenSnapshot)\n</code></pre>\n\n<p>When conn.OpenRecordset is executed I get the error: Error 3420: Object invalid or no longer set. Anyone knows what wrong? Works with my other odbc connections. The database is a mssqlserver2012.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 2, "creation_date": 1423635392, "post_id": 28447598, "comment_id": 45224074, "body": "You can write macro for inserting formula to newly added rows. You can use Worksheet_Change event for this. Refer this link: <a href=\"http://stackoverflow.com/questions/7479721/excel-vba-determine-whether-user-are-adding-rows-or-deleting-rows\" title=\"excel vba determine whether user are adding rows or deleting rows\">stackoverflow.com/questions/7479721/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4208, "user_id": 1589188, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/cdecfbddde74f80213b245bef0df1b23?s=128&d=identicon&r=PG", "display_name": "user1589188", "link": "https://stackoverflow.com/users/1589188/user1589188"}, "edited": false, "score": 0, "creation_date": 1423723471, "post_id": 28447866, "comment_id": 45266353, "body": "Using tables works! But just have to type right below the last row, not really defaulting the formula to the whole column. But I guess this is the easiest solution, I will pick yours."}], "tags": [], "owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "is_accepted": true, "score": 3, "last_activity_date": 1423636032, "creation_date": 1423636032, "answer_id": 28447866, "question_id": 28447598, "link": "https://stackoverflow.com/questions/28447598/on-row-insertion-autopopulate-a-formula-in-a-cell/28447866#28447866", "title": "On row insertion autopopulate a formula in a cell", "body": "<p>My suggestion would be to change your used range on your worksheet to a table. When you insert a row into a sheet with a table (either within or directly below the table) the formulas within the table drag down. Although, you will have to change your formulas slightly as you must reference the cells within the table slightly differently when they are within a table.</p>\n\n<p>Here's a couple links to some resources, although there are bound to be some far better resources:</p>\n\n<p><a href=\"http://www.databison.com/table-formulas-in-excel/\" rel=\"nofollow\">http://www.databison.com/table-formulas-in-excel/</a></p>\n\n<p><a href=\"http://excelsemipro.com/2011/04/formulas-and-structured-data-in-excel-tables/\" rel=\"nofollow\">http://excelsemipro.com/2011/04/formulas-and-structured-data-in-excel-tables/</a></p>\n\n<p><a href=\"http://www.jkp-ads.com/Articles/Excel2007Tables.asp\" rel=\"nofollow\">http://www.jkp-ads.com/Articles/Excel2007Tables.asp</a></p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": -1, "last_activity_date": 1423677673, "creation_date": 1423677673, "answer_id": 28461203, "question_id": 28447598, "link": "https://stackoverflow.com/questions/28447598/on-row-insertion-autopopulate-a-formula-in-a-cell/28461203#28461203", "title": "On row insertion autopopulate a formula in a cell", "body": "<p>Try checking <em>Extend data range formats and formulas</em> in Editing options under Advanced in Excel Options.</p>\n"}], "owner": {"reputation": 4208, "user_id": 1589188, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/cdecfbddde74f80213b245bef0df1b23?s=128&d=identicon&r=PG", "display_name": "user1589188", "link": "https://stackoverflow.com/users/1589188/user1589188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2848, "favorite_count": 0, "accepted_answer_id": 28447866, "answer_count": 2, "score": 1, "last_activity_date": 1439618606, "creation_date": 1423634728, "last_edit_date": 1531161705, "question_id": 28447598, "link": "https://stackoverflow.com/questions/28447598/on-row-insertion-autopopulate-a-formula-in-a-cell", "title": "On row insertion autopopulate a formula in a cell", "body": "<p>I have a formula column in my spreadsheet to calculate values based on another column. I want to know if there is a way to make the formula default so that when I insert a new row, the cell of that column automatically gets the formula pre-set, no need to copy and paste from above again.</p>\n\n<p>This is desirable because the spreadsheet will be filled in by non-technical users. The current workaround is to pre-copy-&amp;-paste the whole column with the formula but this is not ideal as the file becomes unnecessarily large and slow to open.</p>\n\n<p>Any method even with VBA is acceptable but a non-VBA solution is preferable.</p>\n"}, {"tags": ["mysql", "excel", "vba", "connection-string"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1423654677, "post_id": 28446736, "comment_id": 45233818, "body": "Don&#39;t mix DRIVER &amp; PROVIDER. <a href=\"http://www.connectionstrings.com\" rel=\"nofollow noreferrer\">connectionstrings.com</a> is a good reference."}], "owner": {"reputation": 89, "user_id": 3247015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OvhLh.png?s=128&g=1", "display_name": "Lee MC", "link": "https://stackoverflow.com/users/3247015/lee-mc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1128, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1423654362, "creation_date": 1423629786, "last_edit_date": 1423654362, "question_id": 28446736, "link": "https://stackoverflow.com/questions/28446736/connecting-to-remote-mysql-via-excel-vba", "title": "Connecting to remote mySQL via Excel VBA", "body": "<p>Likely a dumb question but brain isn't piecing this together---</p>\n\n<p><strong>tl;dr:</strong> My main question is how do I choose the right parameters for my connection string?  How do I determine what my driver should be?  Provider?  Option?  Where do I find a list of acceptable parameters?  How do I choose between ADO and OLE?</p>\n\n<p><strong>Objective:</strong> to connect to a hosted mySQL db of which I am admin.</p>\n\n<p><strong>Problem:</strong> creating a successful connection string / choosing the right parameters.</p>\n\n<p>I'm new to referencing remote databases.  Been looking all day today and yesterday; there are tons of articles and posts out there but nothing is working for me--I'm just trying to replicate what I see being done when I need to just design the string properly, but I don't know where to start.</p>\n\n<p>I've tried using ActiveX Data Objects 2.7, 2.8 and 6.1 libraries.  Also tried using OLE DB Simple Provider 1.5 Library.  Below tests are using ADO 6.1.</p>\n\n<p><strong>Tried these connection strings:</strong></p>\n\n<pre><code>DRIVER={MySQL ODBC 5.3 Unicode Driver};SERVER=ipaddress;PROVIDER=SQLOLEDB;DATABASE=xxx;UID=xxx;PWD=xxx;\n</code></pre>\n\n<p><strong>---Error:</strong> waits ~30 seconds, times out and says Invalid Connection String Attribute</p>\n\n<pre><code>DRIVER={MySQL ODBC 5.3 Unicode Driver};SERVER=ipaddress;PROVIDER=Microsoft.Jet.OLEDB.4.0;DATABASE=db_name;USER=xxx;PASSWORD=xxx;\n</code></pre>\n\n<p><strong>---Error:</strong> immediately errors and says cannot find installable ISAM</p>\n\n<pre><code>SERVER=ipaddress;PROVIDER=SQLOLEDB;DATABASE=xxx;UID=xxx;PWD=xxx;\n</code></pre>\n\n<p><strong>---Error:</strong> waits ~30 seconds, times out and says SQL Database does not exist or access denied</p>\n\n<p>I'm sure i've added the correct user with password and permissions.  I haven't done anything with DSN.</p>\n\n<p>I'm on win8.1 x64 using Excel 2013.  Any advice is much appreciated!!</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1423629675, "post_id": 28446630, "comment_id": 45222473, "body": "What is the full text of the error message you get when assigning that statement to the combo box&#39;s <code>RowSource</code>?"}, {"owner": {"reputation": 63, "user_id": 4072025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbd1ecca42b28e76d3d5b0494bfd4141?s=128&d=identicon&r=PG&f=1", "display_name": "bizco", "link": "https://stackoverflow.com/users/4072025/bizco"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423666475, "post_id": 28446630, "comment_id": 45241154, "body": "The full error message reads:  Syntax error in date in query expression &#39;[Schedule Data].[ApptDate] = #&#39;   ... Sorry for neglecting to include that in the original message."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1423677122, "post_id": 28446630, "comment_id": 45248057, "body": "Use a string variable <i>strRowSource</i> to hold your <code>SELECT</code> statement.  Then you can do <code>Debug.Print strRowSource</code> and <code>Me.ComboTimeList.RowSource = strRowSource</code>  You can view the output from <code>Debug.Print</code> in the Immediate window; Ctrl+g will take you there.  Copy the <code>SELECT</code> statement text and add it into your question.  Let us know if the error is different than the one you got before."}, {"owner": {"reputation": 63, "user_id": 4072025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbd1ecca42b28e76d3d5b0494bfd4141?s=128&d=identicon&r=PG&f=1", "display_name": "bizco", "link": "https://stackoverflow.com/users/4072025/bizco"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1423704951, "post_id": 28446630, "comment_id": 45261045, "body": "Thanks, HansUp. I ended up using Debug.Print and found that my [ApptDate] field was returning Null. I&#39;d move this snippet of code to a Change event so it was running the query when I clicked the field instead of when I chose the date (or at least that&#39;s what I&#39;m presuming.) Whoops..."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4072025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbd1ecca42b28e76d3d5b0494bfd4141?s=128&d=identicon&r=PG&f=1", "display_name": "bizco", "link": "https://stackoverflow.com/users/4072025/bizco"}, "is_accepted": true, "score": 1, "last_activity_date": 1423949435, "creation_date": 1423949435, "answer_id": 28520543, "question_id": 28446630, "link": "https://stackoverflow.com/questions/28446630/error-while-assigning-an-sql-query-to-rowsource-in-vba-in-microsoft-access/28520543#28520543", "title": "Error while assigning an SQL Query to RowSource in VBA in Microsoft Access", "body": "<p>My code should have been:</p>\n\n<pre><code>Me.ComboTimeList.RowSource =\n \"SELECT [Schedule Data].[ApptStart] &amp; _\n  FROM [Schedule Data] &amp; _ \n  WHERE [Schedule Data].[ApptDate] = #\" &amp; Me.[ApptDate] &amp; \"#;\"\n</code></pre>\n\n<p>Additionally, Me.[ApptDate] was returning \"Null\" because I had the code in the Change event instead of AfterUpdate event.</p>\n"}], "owner": {"reputation": 63, "user_id": 4072025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbd1ecca42b28e76d3d5b0494bfd4141?s=128&d=identicon&r=PG&f=1", "display_name": "bizco", "link": "https://stackoverflow.com/users/4072025/bizco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "accepted_answer_id": 28520543, "answer_count": 1, "score": 0, "last_activity_date": 1423949435, "creation_date": 1423628953, "last_edit_date": 1423666458, "question_id": 28446630, "link": "https://stackoverflow.com/questions/28446630/error-while-assigning-an-sql-query-to-rowsource-in-vba-in-microsoft-access", "title": "Error while assigning an SQL Query to RowSource in VBA in Microsoft Access", "body": "<p>I'm trying to run an SQL Query in VBA to populate a combobox. I'd like the combobox to display all Start Times ([Schedule Data].[ApptStart]) on a given date, chosen from a date picker ([ApptDate] on the form.) I've tried various iterations of the statement below but can't seem to get anything but errors and a blank combo box. </p>\n\n<pre><code>Me.ComboTimeList.RowSource =\n \"SELECT [Schedule Data].[ApptStart]\n  FROM [Schedule Data]\n  WHERE [Schedule Data].[ApptDate] = #\" &amp; Me.[ApptDate] &amp; \"#\"\n</code></pre>\n\n<p>I don't know if this is just a syntax issue or if I'm missing some bigger concept. Any help is appreciated. I'm happy to provide any additional needed info. Thanks!</p>\n\n<p>edit: The full error message reads:</p>\n\n<p>Syntax error in date in query expression '[Schedule Data].[ApptDate] = #'</p>\n\n<p>Sorry for neglecting to include that in the original message.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4220659, "user_type": "registered", "profile_image": "https://graph.facebook.com/275400242584057/picture?type=large", "display_name": "Jason Fairfield", "link": "https://stackoverflow.com/users/4220659/jason-fairfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1423760859, "last_edit_date": 1423760859, "creation_date": 1423680125, "answer_id": 28461969, "question_id": 28446137, "link": "https://stackoverflow.com/questions/28446137/using-access-vba-to-import-all-tables-from-unopenable-mdb-file/28461969#28461969", "title": "Using Access vba to Import all tables from unopenable mdb file", "body": "<p>Disregard, I gave up using TransferDatabase to get all the tables and used other means to do so.  It seems that opening the workbook via vba bypassed the security error I was getting trying to open it directly.</p>\n\n<p>This is the code: </p>\n\n<pre><code>Private Function importTables(theFile As Variant)\nDim db As Database\nDim td As TableDef\nSet db = DBEngine.Workspaces(0).OpenDatabase(theFile, True)\n\nFor Each td In db.TableDefs\n    If Left(td.Name, 4) &lt;&gt; \"MSys\" And Left(td.Name, 4) &lt;&gt; \"~TMP\" Then\n\n    DoCmd.TransferDatabase acImport, \"Microsoft Access\", theFile, acTable, _\n        td.Name, td.Name\n    End If\nNext\ndb.Close\n</code></pre>\n\n<p>End Function</p>\n"}], "owner": {"reputation": 1, "user_id": 4220659, "user_type": "registered", "profile_image": "https://graph.facebook.com/275400242584057/picture?type=large", "display_name": "Jason Fairfield", "link": "https://stackoverflow.com/users/4220659/jason-fairfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1005, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423760859, "creation_date": 1423625477, "question_id": 28446137, "link": "https://stackoverflow.com/questions/28446137/using-access-vba-to-import-all-tables-from-unopenable-mdb-file", "title": "Using Access vba to Import all tables from unopenable mdb file", "body": "<p>I have an issue.</p>\n\n<p>Pretty much, I have an mdb file that cannot be opened (user account does not have permission) , but it can be imported into Access 2010.  I need to automate this to open any number of files (assuming mdb files for now).</p>\n\n<p>Apparently, DoCmd.TransferDatabase does not allow me to ignore the source table name (despite being optional in api).  There is no way for me to know what these tables are before I try to import the file.</p>\n\n<p>I need a way to automatic this process while bypassing the user account error.</p>\n\n<p>Finally</p>\n\n<p>DoCmd.TransferDatabase acExport, \"Microsoft Access\", theFile, acTable</p>\n\n<p>That is my attempt, it gets a 3011 error</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1423622211, "post_id": 28445639, "comment_id": 45220615, "body": "I meant the error is at the line: transferRange = XYZ_data"}, {"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 1, "creation_date": 1423622304, "post_id": 28445639, "comment_id": 45220638, "body": "Welcome to Stack Overflow! As a start, <code>Range</code> variables must be assigned with the <code>Set</code> keyword like this: <code>Set transferRange = ABC_data</code> or <code>Set transferRange = XYZ_data</code>"}, {"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "reply_to_user": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1423624202, "post_id": 28445639, "comment_id": 45221110, "body": "Thanks. There is progress already. Adding Set removed the first error, and instead gave me an &quot;object required&quot; error. After this, I changed the line to:    Set transferRange = ThisWorkbook.Sheets(&quot;SheetB&quot;).Range(&quot;XYZ_data&quot;). The second error then went away. Now, I am left with an error on the last line where I attempt to copy over the named range. I see the following message: Method &quot;Range&quot; of object &quot;_Worksheet&quot; failed."}, {"owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1423624963, "post_id": 28445639, "comment_id": 45221329, "body": "Hmm... can&#39;t test this at the moment, but from the looks of it <code>transferRange</code> is already a <code>Range</code> object, so I don&#39;t think you need to wrap it with <code>Range()</code>. Do you get the same error with <code>transferRange.Copy ThisWorkbook.Sheets(&quot;SheetC&quot;).Range(&quot;A1&quot;)</code>?"}, {"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "reply_to_user": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "edited": false, "score": 0, "creation_date": 1423628486, "post_id": 28445639, "comment_id": 45222171, "body": "Yes, this works. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1423625142, "post_id": 28446001, "comment_id": 45221379, "body": "I tried this, but still got the &quot;Method Range...&quot; error. It seems after looking around that it is better to explicitly define the source worksheet, etc, so I changed the last line to:    ThisWorkbook.Sheets(&quot;SheetB&quot;).Range(transferRange).Copy Destination:=ThisWorkbook.Sheets(&quot;SheetC&quot;).Range(&quot;A1&quot;). Now, I have a &quot;application-defined or object-defined error&quot;!"}, {"owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "reply_to_user": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1423625781, "post_id": 28446001, "comment_id": 45221542, "body": "I presume you&#39;ve tested dan&#39;s last suggestion?"}, {"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1423628360, "post_id": 28446001, "comment_id": 45222142, "body": "No, I hadn&#39;t yet tried it, but I can now report that it does work. Thanks."}], "tags": [], "owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "is_accepted": false, "score": 0, "last_activity_date": 1423624681, "creation_date": 1423624681, "answer_id": 28446001, "question_id": 28445639, "link": "https://stackoverflow.com/questions/28445639/accessing-a-named-range-inside-a-worksheet-selectionchange-sub-routine/28446001#28446001", "title": "Accessing a named range inside a Worksheet_SelectionChange sub routine", "body": "<p>Try this (Note the I added the <b>Destination:=</b> bit to hopefully fix your final error:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim PD As String, transferRange As Range\nPD = Target.Value\nSelect Case PD\n    Case \"ABC\"\n        Set transferRange = ThisWorkbook.Sheets(\"SheetB\").Range(\"ABC_data\")\n    Case \"XYZ\"\n        Set transferRange = ThisWorkbook.Sheets(\"SheetB\").Range(\"XYZ_data\")\nEnd Select\nRange(transferRange).Copy Destination:=ThisWorkbook.Sheets(\"SheetC\").Range(\"A1\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423625073, "creation_date": 1423622101, "last_edit_date": 1423625073, "question_id": 28445639, "link": "https://stackoverflow.com/questions/28445639/accessing-a-named-range-inside-a-worksheet-selectionchange-sub-routine", "title": "Accessing a named range inside a Worksheet_SelectionChange sub routine", "body": "<p>I have practically no background in VBA and little understanding of its overall structure, but need to make additions/modifications to an existing spreadsheet to accomplish some objectives. This spreadsheet is huge with hundreds of named ranges, and dozens of VBA functions and calculations.</p>\n\n<p>For now, all I am trying to do is:</p>\n\n<ol>\n<li>Create a drop-down (data validation type) on sheet 1 - DONE</li>\n<li>Based on the selection, copy one of many named ranges stored in sheet 2, to a location (say A1) on sheet 3.</li>\n</ol>\n\n<p>To achieve step 2, I started a Worksheet_SelectionChange sub routine and the code is below. Assume two drop-down choices = ABC &amp; XYZ. Assume the two corresponding named ranges to be ABC_data &amp; XYZ_data. These two named ranges are of Workbook scope. They are to be copied to a sheet labeled SheetC.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim PD As String, transferRange As Range\nPD = Target.Value\nSelect Case PD\n    Case \"ABC\"\n        transferRange = ABC_data\n    Case \"XYZ\"\n        transferRange = XYZ_data '&lt;~ error here, assuming \"XYZ\" selection\nEnd Select\nRange(transferRange).Copy ThisWorkbook.Sheets(\"SheetC\").Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>Please help me understand what is wrong with this. When I make a selection and debug this sub routine, I get a \"Object variable or With block variable not set\" error at the <code>transferRange = XYZ_data</code> line assuming XYZ selection. It looks like I am not able to access the named ranges within this sub routine. What steps should I take?</p>\n\n<p>Please bear with my patchwork knowledge of what I am doing.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423616622, "post_id": 28444815, "comment_id": 45219125, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6331106/vba-adding-a-class-to-a-collection\">VBA Adding a class to a collection</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423617381, "post_id": 28444815, "comment_id": 45219353, "body": "Why not use a Collection?"}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 2818058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84827cc48b8095aa91c569953ec9e853?s=128&d=identicon&r=PG&f=1", "display_name": "Gopi Bandla", "link": "https://stackoverflow.com/users/2818058/gopi-bandla"}, "is_accepted": false, "score": 0, "last_activity_date": 1423616874, "creation_date": 1423616874, "answer_id": 28444890, "question_id": 28444815, "link": "https://stackoverflow.com/questions/28444815/cannot-use-class-object-as-argument-in-other-class-method/28444890#28444890", "title": "Cannot use class object as argument in other class&#39; method", "body": "<p>Try temp.add test\ninstead of temp.add(test)</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 3642854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0649148b4b1261f12962032bb5be346?s=128&d=identicon&r=PG&f=1", "display_name": "thingyman", "link": "https://stackoverflow.com/users/3642854/thingyman"}, "edited": false, "score": 0, "creation_date": 1423618801, "post_id": 28444989, "comment_id": 45219752, "body": "Removing the parentheses fixed my issue with the error message, but Add calls an &quot;updateSize&quot; subroutine that calls without issue with parentheses. Why do the parentheses not affect things there but they do elsewhere?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1423640059, "last_edit_date": 1423640059, "creation_date": 1423617611, "answer_id": 28444989, "question_id": 28444815, "link": "https://stackoverflow.com/questions/28444815/cannot-use-class-object-as-argument-in-other-class-method/28444989#28444989", "title": "Cannot use class object as argument in other class&#39; method", "body": "<p>You need to use Set when assigning objects:</p>\n\n<pre><code> Set storage(count + 1) = data\n</code></pre>\n\n<p>and (as noted by Gopi) you need to drop the <code>()</code> when calling your add method:</p>\n\n<pre><code>temp.add test\n</code></pre>\n\n<p>You don't use parentheses unless you're calling a function or using the <code>Call</code> keyword</p>\n\n<p><strong>EDIT:</strong> parentheses (without <code>Call</code>) don't <em>always</em> cause a problem - what they do is cause the argument you're passing to be first <em>evaluated as an expression</em>, and the result of that evaluation then get passed.  In the case of <code>updateSize (max + 5)</code> that's not a problem, because that's the behavior you want anyway - to add <code>5</code> to <code>max</code> and pass that value to <code>updateSize</code>.  In the case of <code>temp.add (test)</code> you <em>don't</em> want <code>test</code> to be evaluated as an expression.</p>\n"}], "owner": {"reputation": 55, "user_id": 3642854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0649148b4b1261f12962032bb5be346?s=128&d=identicon&r=PG&f=1", "display_name": "thingyman", "link": "https://stackoverflow.com/users/3642854/thingyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 28444989, "answer_count": 2, "score": 0, "last_activity_date": 1423640059, "creation_date": 1423616392, "last_edit_date": 1495542441, "question_id": 28444815, "link": "https://stackoverflow.com/questions/28444815/cannot-use-class-object-as-argument-in-other-class-method", "title": "Cannot use class object as argument in other class&#39; method", "body": "<p>I'm new to VBA and was surprised it didn't have an official dynamic array, so I tried to make a simple one that suits my needs: </p>\n\n<pre>\n    Public count As Integer\n    Private max As Integer\n    Private storage(1 To 5) As DVprogram\n\n    Private Sub class_initialize()\n        count = 0\n        max = 5\n    End Sub\n\n    Public Sub add(data As DVprogram)\n        If (count + 1) > max Then\n            updateSize (max + 5)\n        End If\n\n        storage(count + 1) = data\n        count = count + 1\n    End Sub\n\n    'more code...\n</pre>\n\n<p>When I try to call add, I get the error \"Object doesn't support this property or method.\" </p>\n\n<pre>\n    Dim test As New DVprogram\n    Dim temp As New progDynArray\n    temp.add (test)\n</pre>\n\n<p>When I change the array type to Integers, everything works fine, but when I try to use one of my own classes, it always throws this error. I've tried switching between ByVal and ByRef and neither had any affect. I also found this: <a href=\"https://stackoverflow.com/questions/5965593/passing-objects-to-procedures-in-vba\">Passing objects to procedures in VBA</a>, but the solution there doesn't appear to be my problem.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "edited": false, "score": 1, "creation_date": 1423610394, "post_id": 28443748, "comment_id": 45217088, "body": "How are you executing your SQL String? Is it using CurrentDb.Execute? Can you post the lines where you are executing the SQL?"}, {"owner": {"reputation": 13, "user_id": 4541653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac29c171c22803d8fe78da4b690932b?s=128&d=identicon&r=PG&f=1", "display_name": "rachelsimm", "link": "https://stackoverflow.com/users/4541653/rachelsimm"}, "edited": false, "score": 0, "creation_date": 1423611019, "post_id": 28443748, "comment_id": 45217352, "body": "I used the Named Macro builder/wizard thing that came built in with Access so it was basically just running straight off the table.  The problem is, after I split the database, I can&#39;t run data macros on the front end. I get a &quot;Data Macro&quot; cannot be found message."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1423611065, "last_edit_date": 1423611065, "creation_date": 1423610698, "answer_id": 28443831, "question_id": 28443748, "link": "https://stackoverflow.com/questions/28443748/access-2007-editing-all-records-in-a-linked-table-on-click-via-the-front-end/28443831#28443831", "title": "Access 2007: Editing all records in a linked table On Click via the front end", "body": "<p>It looks like your macro operation could translate to an Access SQL <code>UPDATE</code> easily, assuming <em>TblEvents</em> is now a link to the table in your backend database.  And you can execute that statement from a <code>DAO.Database</code> object reference.</p>\n\n<p>Include code similar to this in your command button's click event:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strUpdate As String\nDim db As DAO.Database\n\nstrUpdate = \"UPDATE TblEvents\" &amp; vbCrLf &amp; _\n    \"SET [Passed] = True\" &amp; vbCrLf &amp; _\n    \"WHERE [EndDate] &lt; Date();\"\nDebug.Print strUpdate  '&lt;- examine completed statement text in Immediate window\n                       ' Ctrl+g will take you there\nSet db = CurrentDb\ndb.Execute strUpdate, dbFailOnError\nMsgBox db.RecordsAffected &amp; \" row(s) updated.\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4541653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac29c171c22803d8fe78da4b690932b?s=128&d=identicon&r=PG&f=1", "display_name": "rachelsimm", "link": "https://stackoverflow.com/users/4541653/rachelsimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 28443831, "answer_count": 1, "score": 1, "last_activity_date": 1423611065, "creation_date": 1423610253, "last_edit_date": 1423611058, "question_id": 28443748, "link": "https://stackoverflow.com/questions/28443748/access-2007-editing-all-records-in-a-linked-table-on-click-via-the-front-end", "title": "Access 2007: Editing all records in a linked table On Click via the front end", "body": "<p>I had a button on a form that would run a data macro that would mark all records prior to today's date.  In other words:</p>\n\n<pre><code>For Each Record in TblEvents\n Where Condition = [TblEvents].[EndDate]&lt;Date()\n Edit Record\n   Set Field [TblEvents].[passed]=True\n</code></pre>\n\n<p>When I split the database, the button on the form stopped working (d'oh).</p>\n\n<p>I still need this functionality somehow. Is this possible?  I've only just started learning VBA, but I know setField and editRecord options are non-existent outside of data macros in the builder. </p>\n"}, {"tags": ["performance", "vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1423627917, "post_id": 28443502, "comment_id": 45222038, "body": "Have a look at this answer for an <a href=\"http://stackoverflow.com/a/14245591/445425\">alternative method</a>"}], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1423625899, "post_id": 28443702, "comment_id": 45221579, "body": "This will mIss rows. You have to step backwards."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1423632533, "post_id": 28443702, "comment_id": 45223251, "body": "@DougGlancy: Reversing the loop was easy enough - OP really was asking on the performance."}, {"owner": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "edited": false, "score": 0, "creation_date": 1423636631, "post_id": 28443702, "comment_id": 45224512, "body": "your response will help with troubleshooting performance, but doesn&#39;t address the OP&#39;s question of why performance is bad to begin with."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "edited": false, "score": 0, "creation_date": 1423637001, "post_id": 28443702, "comment_id": 45224650, "body": "@AnonymousType: Not disabling Screenpdating during lengthy operations is the most common cause of VBA performance problems."}, {"owner": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "edited": false, "score": 1, "creation_date": 1423713274, "post_id": 28443702, "comment_id": 45263114, "body": "@PieterGeerkens agreed that it is a common known issue of performance issues per-se. Disagree that in this instance it is the cause, since the OP has provided the VBA used, and analysis reveals the main performance issue lies within the loop. Combining both our answers would yield the largest performance increase."}], "tags": [], "owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "is_accepted": false, "score": -2, "last_activity_date": 1423632507, "last_edit_date": 1423632507, "creation_date": 1423609987, "answer_id": 28443702, "question_id": 28443502, "link": "https://stackoverflow.com/questions/28443502/vba-row-operations-take-too-long-to-execute/28443702#28443702", "title": "VBA row operations take too long to execute", "body": "<p>Amend your code to look like this:</p>\n\n<pre><code>Sub Main()\n    On Error Goto ErrHandler\n    Application.ScreenUpdating = False\n\n    RowsDeleted = 0\n    Keyword = \"COLA\"\n    For i = ActiveSheet.UsedRange.Rows.Count to 2\n        If InStr(Cells(i, 1).Value, Keyword) = 0 Then\n            Rows(i).Delete\n            RowsDeleted = RowsDeleted + 1\n            ' i = i - 1 ' -- manually changing the loop counter is a bad idea\n        End If\n    Next i\n    MsgBox(\"Rows Deleted: \" &amp; RowsDeleted)\n\nEndSub:\n    Application.ScreenUpdating = True\n    exit sub\nErrHandler:\n    ' Error handling here\n    resume EndSub\nEnd Sub\n</code></pre>\n\n<p>The error handler is required to ensure that the <em>ScreenUpdating</em> is restored, even in case of an error.</p>\n"}, {"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1423627282, "post_id": 28444882, "comment_id": 45221908, "body": "This doesn&#39;t run for me. I get a &quot;Type Mismatch&quot; error on <code>arr = ActiveSheet.UsedRange</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1423627587, "post_id": 28444882, "comment_id": 45221980, "body": "Right idea, but a few implementation issues: concatenation puts the <code>,</code> in the wrong place (use <code>str = str &amp; &quot;,&quot;</code>).  You need to delete entire rows, so use <code>rng.EntireRow.Delete</code>.  There are limits to the length of a range reference string, so for very large data sets may need to delete several time during the loop (test <code>Len(str)</code> to decide when to do a delete).  The two key ideas here (looping a variant array and doing the actual delete in one step) will make a <i>huge</i> performance difference."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1423628101, "post_id": 28444882, "comment_id": 45222077, "body": "@Doug just needs to be <code>arr = ActiveSheet.UsedRange.Value</code>"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1423630716, "post_id": 28444882, "comment_id": 45222775, "body": "@chrisneilsen, yes I made that change but then it errors later with an Object Required, if I remember right."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1423635937, "post_id": 28444882, "comment_id": 45224249, "body": "Brilliant approach by putting things on memory! Will it be even faster (use less memory) with <code>arr = ActiveSheet.UsedRange.Columns(&quot;A&quot;)</code>?"}, {"owner": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1423636532, "post_id": 28444882, "comment_id": 45224467, "body": "@chrisneilsen lol wrote it in about 5 minutes. only debugged it in my head thanks for the fixes."}, {"owner": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1423636664, "post_id": 28444882, "comment_id": 45224523, "body": "@PatricK doubt it, the performance benefit is once your outside of Excel&#39;s object model (typically exasperated via looping constructs)."}], "tags": [], "owner": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "is_accepted": false, "score": 1, "last_activity_date": 1423626831, "last_edit_date": 1423626831, "creation_date": 1423616842, "answer_id": 28444882, "question_id": 28443502, "link": "https://stackoverflow.com/questions/28443502/vba-row-operations-take-too-long-to-execute/28444882#28444882", "title": "VBA row operations take too long to execute", "body": "<p>no offense to other answer, but this will only help with troubleshooting.\nwhat you need to do is remove the the line of code </p>\n\n<pre><code>Rows(i).Delete\n</code></pre>\n\n<p>inside the (potentially) long running For loop is what is causing the slow down.</p>\n\n<p>you need to re-write it like this...</p>\n\n<pre><code>Sub Main()\n    RowsDeleted = 0\n    Keyword = \"COLA\"\n\n    Dim rng As Excel.Range\n    Dim arr() As Variant\n    Dim str As String\n    arr = ActiveSheet.UsedRange\n    Dim R As Long\n\n    For R = 1 To UBound(arr, 1) ' First array dimension is rows.\n        If InStr(arr(R, 1), Keyword) = 0 Then\n            If str &lt;&gt; \"\" Then\n                str = \",\" &amp; str\n            End If\n            str = str &amp; arr(R, 1).Address\n        End If\n    Next R\n\n    Set rng = ActiveSheet.Range(str)\n    RowsDeleted = rng.Rows.Count\n    rng.Delete\n\n    MsgBox (\"Rows Deleted: \" &amp; RowsDeleted)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2926, "user_id": 141720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d1c1cc59618ad2a4afda1ce103f605e?s=128&d=identicon&r=PG", "display_name": "Anonymous Type", "link": "https://stackoverflow.com/users/141720/anonymous-type"}, "edited": false, "score": 3, "creation_date": 1423621856, "post_id": 28444949, "comment_id": 45220507, "body": "some nice ideas, but the overall approach is not best practise. the tips you suggest will however offer a small performance improvement. reversing the loop for row by row deletions is definately best practise, however my point is that you shouldn&#39;t be doing row by row to begin with."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 2, "creation_date": 1423625755, "post_id": 28444949, "comment_id": 45221534, "body": "Also, you need <code>Step - 1</code> in the <code>For i</code> statement."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1423635150, "post_id": 28444949, "comment_id": 45223994, "body": "Thanks @DougGlancy, fixed loop counter, wasn&#39;t careful enough."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1423634998, "last_edit_date": 1423634998, "creation_date": 1423617366, "answer_id": 28444949, "question_id": 28443502, "link": "https://stackoverflow.com/questions/28443502/vba-row-operations-take-too-long-to-execute/28444949#28444949", "title": "VBA row operations take too long to execute", "body": "<p>It takes ages may due to formulas in your cells that are going to be deleted.</p>\n\n<p>What you should do is to turn off auto calculation and Clear the contents of that row before delete. Also you should start from bottom up!</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub Main()\n    Dim lMode As Long\n\n    ' Store initial state of Calculation mode\n    lMode = Application.Calculation\n    ' Change to Manual Calculation\n    Application.Calculation = xlCalculationManual\n    ' Disable screen update\n    Application.ScreenUpdating = False\n\n    RowsDeleted = 0\n    Keyword = \"COLA\"\n\n    ' Start from bottom up!\n    For i = ActiveSheet.UsedRange.Rows.Count To 2 Step -1\n        If InStr(Cells(i, 1).Value, Keyword) = 0 Then\n            Rows(i).ClearContents\n            Rows(i).Delete\n            RowsDeleted = RowsDeleted + 1\n        End If\n    Next i\n\n    ' Restore screenupdate and calculation mode\n    Application.ScreenUpdating = True\n    Application.Calculation = lMode\n\n    MsgBox (\"Rows Deleted: \" &amp; RowsDeleted)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1423656292, "last_edit_date": 1423656292, "creation_date": 1423653335, "answer_id": 28452951, "question_id": 28443502, "link": "https://stackoverflow.com/questions/28443502/vba-row-operations-take-too-long-to-execute/28452951#28452951", "title": "VBA row operations take too long to execute", "body": "<p>Here could be something to look at,\nIt filters Column A for cells &lt;>\"Cola\" and clears them\nIt then sorts column A so the blank cells in column A are now at the bottom\nIt then deletes the blank rows.\nNot knowing the setup of the OP's ws, there may have to be adjustments made.</p>\n\n<p>On my sample sheet I use 81,000 rows, when I run the code it takes about 5 seconds.</p>\n\n<pre><code>Sub SomeDeleteCode()\n    Dim Rws As Long, Rng As Range, nwRw As Long\n\n    Rws = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Application.ScreenUpdating = 0\n    Application.Calculation = xlCalculateManual\n\n    Columns(\"A:A\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*Cola*\"\n    Set Rng = Range(Cells(2, 1), Cells(Rws, 1)).SpecialCells(xlCellTypeVisible)\n    Rng.ClearContents\n    ActiveSheet.AutoFilterMode = 0\n\n    Columns(1).Sort Key1:=Range(\"A1\"), Header:=xlYes\n    nwRw = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Range(Range(\"B\" &amp; nwRw + 1), Range(\"B\" &amp; nwRw + 1).End(xlDown)).EntireRow.Delete\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1682, "user_id": 866631, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/c2ddfb01a0b47a633fcc94c30361e00c?s=128&d=identicon&r=PG", "display_name": "dsynkd", "link": "https://stackoverflow.com/users/866631/dsynkd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1423656292, "creation_date": 1423609054, "last_edit_date": 1423609711, "question_id": 28443502, "link": "https://stackoverflow.com/questions/28443502/vba-row-operations-take-too-long-to-execute", "title": "VBA row operations take too long to execute", "body": "<p>So I have the script below in Execl VB that goes through the rows and deletes the ones that don't contain a certain keyword.</p>\n\n<pre><code>Sub Main()\n    RowsDeleted = 0\n    Keyword = \"COLA\"\n    For i = 2 to ActiveSheet.UsedRange.Rows.Count\n        If InStr(Cells(i, 1).Value, Keyword) = 0 Then\n            Rows(i).Delete\n            RowsDeleted = RowsDeleted + 1\n            i = i - 1\n        End If\n    Next i\n    MsgBox(\"Rows Deleted: \" &amp; RowsDeleted)\nEnd Sub\n</code></pre>\n\n<p>The problem is that this script takes a very long time to execute (around 8 minutes for ~73000 entries). Why is that and how would I go about improving it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423618732, "post_id": 28443459, "comment_id": 45219733, "body": "Might help to mention what order of magnitude you&#39;re dealing with (how many i and j ?)  And what is Class3 Key?"}, {"owner": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423662883, "post_id": 28443459, "comment_id": 45238711, "body": "About 300 i&#39;s and 6000 js: but let me clarify my problem a bit more.  I have the key of the collection in class2, but in order to put it in the right &quot;place&quot;, I need to find the corresponding spot in the collection of Class2s...the real issue is the only way to find that key is to loop through every possible collection of class2s until I get match on the key that I do have...so I was able to eliminate one of the loops and instead do a key lookup, which improved performance, but it is still far below what is acceptable."}], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "edited": false, "score": 0, "creation_date": 1423663051, "post_id": 28446244, "comment_id": 45238826, "body": "I generally agree with the thinking here, but my performance is not related to the string comparison, it is more related to the number of times I have to run these nested loops.  I say this, because to test I actually changed my keys to integers which should be the most ideal, and while the performance improved, it was still pretty bad.  Also, the exit for comment is accurate, but I was able to remove one of the nested loops (by using a key lookup instead) so that is no longer an issue."}, {"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "reply_to_user": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "edited": false, "score": 0, "creation_date": 1423663795, "post_id": 28446244, "comment_id": 45239353, "body": "FYI longs are slightly more ideal than Integers and LongPtrs are optimum:) But that is unlikely to matter:) I hate to break an object model, so the next thing I&#39;d try is to load the keys and the values into a two-d array and wrap them with the class. Also arrays of UDTs are pretty fast and will somewhat preserve your data structure."}, {"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "reply_to_user": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "edited": false, "score": 0, "creation_date": 1423665935, "post_id": 28446244, "comment_id": 45240777, "body": "I included an example of a UDT hooked to a test harness. Once it is loaded with values, you can seek by key or by value for very quickly. It might be worth a try."}, {"owner": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "edited": false, "score": 0, "creation_date": 1423685722, "post_id": 28446244, "comment_id": 45253000, "body": "I&#39;d be interested in your thoughts on what the optimum object model would be...but that would probably be a bit more complex then a SO answer.  IMO, your answer on arrays is the correct one.  Such a shame that collections perform so slowly."}, {"owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "reply_to_user": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "edited": false, "score": 0, "creation_date": 1423745206, "post_id": 28446244, "comment_id": 45278319, "body": "It&#39;s important to remember VBA doesn&#39;t compile like C. It compiles down to PCode (think CIL) and is executed by DLLs. When you optimize using primitives there is less abstraction for it to unravel. (Current) VBA is derived from VB6. Most of what you find about optimizing VB6 and before will work for VBA. There is a ton of really good info here: <a href=\"http://www.aivosto.com/resources.html\" rel=\"nofollow noreferrer\">aivosto.com/resources.html</a>  Personally I tend to use the Classic OOP ways unless, like you I need to optimize, then I go to primitives behind the scenes and wrap them in classes for convenience. Only optimize when you need too."}], "tags": [], "owner": {"reputation": 714, "user_id": 4487534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c492024c03f7acac02476850ef9818?s=128&d=identicon&r=PG&f=1", "display_name": "Pillgram", "link": "https://stackoverflow.com/users/4487534/pillgram"}, "is_accepted": true, "score": 2, "last_activity_date": 1423665866, "last_edit_date": 1423665866, "creation_date": 1423626226, "answer_id": 28446244, "question_id": 28443459, "link": "https://stackoverflow.com/questions/28443459/nested-collections-in-vba-classes-causing-performance-issues/28446244#28446244", "title": "Nested collections in VBA classes causing performance issues", "body": "<p>I think the issue here is likely the comparison of</p>\n\n<pre><code>Class1Collection.Item(i).Item(j) = myComparisonValue\n</code></pre>\n\n<p>There are a couple of ways to optimize a string comparison. The least expensive way to do it without completely restructuring your Object Model is to do something like this:</p>\n\n<pre><code>Dim myComparisonValue As Long\nmyComparisonValue = Len(myComparisonValue)\nFor i = 1 To Class1Collection.Count\n    For j = 1 To Class1Collection(i).Count\n        If Len(Class1Collection.Item(i).Item(j)) = myComparisonValue Then\n            If (Class1Collection.Item(i).Item(j) = myComparisonValue) Then\n                Set myReturnValue = Class1Collection.Item(i).Item(j)\n                Exit For\n            End If\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>The reason this is (often) faster is because string comparisons are <em>slow</em>. Len is just a quick read of an already stored value, so it's fast.\nUnfortunately this approach will not help in the event you have many same-length keys.\nFor that I would consider adding a numeric key to your Collection and doing the comparison based on that. The ObjPtr function is a cheap way to get a unique key.</p>\n\n<p>I also notice that your Exit For is only breaking you out of the inside loop. This may be one of the rare occasions where a Goto is appropriate, as the language has no other construct for exiting multiple nested loops.<br/>\n<strong>Edit:</strong><br/>\n<strong>UDT Example Added</strong><br/></p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function GetTickCount Lib \"kernel32\" () As Long\n\nPrivate Type ThingAMaBob\n    Key As Long\n    Text As String\nEnd Type\n\nPrivate Type ThingAMaBobs\n    UpperBound As Long\n    Items() As ThingAMaBob\nEnd Type\n\nPrivate Type ThingAMaBobsCollection\n    UpperBound As Long\n    Items() As ThingAMaBobs\nEnd Type\n\n\nPrivate Sub Test()\n    Const xMax As Long = 1000&amp;\n    Const yMax As Long = 1000&amp;\n    Dim udtCol As ThingAMaBobsCollection\n    Dim stTime As Long\n    Dim endTime As Long\n    Dim seekValue As String\n    Dim seekKey As String\n    Dim x As Long\n    Dim y As Long\n    stTime = GetTickCount\n    udtCol = CreateUDT(xMax, yMax)\n    endTime = GetTickCount\n    Debug.Print \"Milliseconds to fill\", endTime - stTime\n\n    x = xMax \\ 2&amp;\n    y = yMax \\ 2&amp;\n    seekValue = udtCol.Items(x).Items(y).Text\n\n    stTime = GetTickCount\n    seekKey = SeekKeyByValue(udtCol, seekValue, True)\n    endTime = GetTickCount\n    Debug.Print \"Milliseconds to get key by value\", endTime - stTime\n\n    stTime = GetTickCount\n    seekValue = SeekValueByKey(udtCol, seekKey)\n    endTime = GetTickCount\n    Debug.Print \"Milliseconds to get value by key\", endTime - stTime\n\nEnd Sub\n\nPrivate Function CreateUDT(ByVal xMax As Long, ByVal yMax As Long) As ThingAMaBobsCollection\n    Dim rtnVal As ThingAMaBobsCollection\n    Dim x As Long, y As Long\n    xMax = xMax - 1&amp;\n    yMax = yMax - 1&amp;\n    With rtnVal\n        .UpperBound = xMax\n        ReDim .Items(.UpperBound)\n        For x = 0&amp; To xMax\n            With .Items(x)\n                .UpperBound = yMax\n                ReDim .Items(.UpperBound)\n                For y = 0&amp; To yMax\n                    .Items(y).Text = RandomString(RndBetween(8&amp;, 16&amp;))\n                    .Items(y).Key = StrPtr(.Items(y).Text)\n                Next\n            End With\n        Next\n    End With\n    CreateUDT = rtnVal\nEnd Function\n\nPrivate Function SeekKeyByValue(ByRef col As ThingAMaBobsCollection, ByVal seekValue As String, ByVal compareCase As Boolean)\n    Dim x As Long\n    Dim y As Long\n    Dim seekLen As Long\n    Dim rtnVal As Long\n    seekLen = Len(seekValue)\n    If compareCase Then\n        For x = 0&amp; To col.UpperBound\n            For y = 0&amp; To col.Items(x).UpperBound\n                If Len(col.Items(x).Items(y).Text) = seekLen Then\n                    If col.Items(x).Items(y).Text = seekValue Then\n                        rtnVal = col.Items(x).Items(y).Key\n                    End If\n                End If\n            Next\n        Next\n    Else\n        seekValue = LCase$(seekValue)\n        For x = 0&amp; To col.UpperBound\n            For y = 0&amp; To col.Items(x).UpperBound\n                If Len(col.Items(x).Items(y).Text) = seekLen Then\n                    If LCase$(col.Items(x).Items(y).Text) = seekValue Then\n                        rtnVal = col.Items(x).Items(y).Key\n                    End If\n                End If\n            Next\n        Next\n    End If\n    SeekKeyByValue = seekLen\nEnd Function\n\nPrivate Function SeekValueByKey(ByRef col As ThingAMaBobsCollection, ByVal seekKey As Long) As String\n    Dim x As Long\n    Dim y As Long\n    Dim rtnVal As String\n    For x = 0&amp; To col.UpperBound\n        For y = 0&amp; To col.Items(x).UpperBound\n            If col.Items(x).Items(y).Key = seekKey Then\n                rtnVal = col.Items(x).Items(y).Key\n            End If\n        Next\n    Next\n    SeekValueByKey = rtnVal\nEnd Function\n\nPrivate Function RandomString(ByVal Length As Long, Optional ByVal charset As String = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789~!@#$%^&amp;*()_+`-={}|:\"\"&lt;&gt;?[]\\;',./\") As String\n    Dim chars() As Byte, value() As Byte, chrUprBnd As Long, i As Long\n    If Length &gt; 0&amp; Then\n        Randomize\n        chars = charset\n        chrUprBnd = Len(charset) - 1&amp;\n        Length = (Length * 2&amp;) - 1&amp;\n        ReDim value(Length) As Byte\n        For i = 0&amp; To Length Step 2&amp;\n            value(i) = chars(CLng(chrUprBnd * Rnd) * 2&amp;)\n        Next\n    End If\n    RandomString = value\nEnd Function\n\nPrivate Function RndBetween(ByVal UpperBound As Long, ByVal lowerbound As Long) As Long\n    VBA.Math.Randomize\n    RndBetween = Int((UpperBound - lowerbound + 1) * Rnd + lowerbound)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 1790121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o0TfP.jpg?s=128&g=1", "display_name": "mrkb80", "link": "https://stackoverflow.com/users/1790121/mrkb80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 28446244, "answer_count": 1, "score": 0, "last_activity_date": 1423665866, "creation_date": 1423608843, "last_edit_date": 1531164843, "question_id": 28443459, "link": "https://stackoverflow.com/questions/28443459/nested-collections-in-vba-classes-causing-performance-issues", "title": "Nested collections in VBA classes causing performance issues", "body": "<p>I have run into a performance issue with VBA that may be related to how I built my OO model, but is manifested with slow performance using collections.</p>\n\n<pre><code>Class1:\n -Property1\n -Collection of Class2\n +GetClass2ByClass3Property1(Class3Property1)\n\nClass2:\n -Property1\n -Property2\n -Collection of Class3\n\nClass3:\n -Property1\n -Property2\n</code></pre>\n\n<p>First, I populate Class1,Class2, but I only populate Class3 Key - not the value.  Then I have to go back and populate the value, which results in a function in class1 like this:</p>\n\n<pre><code>For i=1 to Class1Collection.Count\n For j=1 to Class1Collection(i).Count\n   If (Class1Collection.Item(i).Item(j) = myComparisonValue) Then\n       Set myReturnValue = Class1Collection.Item(i).Item(j)\n       Exit For\n    End If\n  Next j\nNext i\n</code></pre>\n\n<p>The performance of this nested loop is awful.</p>\n\n<p>Do I need to replace all the collections with arrays?  If so, any advice on how to do that least invasively.</p>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1423608588, "creation_date": 1423608588, "answer_id": 28443404, "question_id": 28443210, "link": "https://stackoverflow.com/questions/28443210/filter-data-by-todays-date-and-after/28443404#28443404", "title": "Filter Data by Today&#39;s Date and After", "body": "<p>Try this:</p>\n\n<pre><code>Sheets(\"Consulta_Lastro\").Range(\"$B$4:$T$9047\").AutoFilter _\n    Field:=4, Criteria1:=\"&gt;=\" &amp; Date\n</code></pre>\n\n<p>This will only show dates greater than or equal to today's date. HTH.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6426, "favorite_count": 1, "accepted_answer_id": 28443404, "answer_count": 1, "score": 1, "last_activity_date": 1423609542, "creation_date": 1423607810, "last_edit_date": 1423609542, "question_id": 28443210, "link": "https://stackoverflow.com/questions/28443210/filter-data-by-todays-date-and-after", "title": "Filter Data by Today&#39;s Date and After", "body": "<p>I have data that goes back to the year 2010 and continues into the year 2029. I want to create a macro that filters the data only including today's date and forward. </p>\n\n<p>I recorded the macro below by excluding all dates until today's hoping that it would give me a good place to start, but I'm still very lost.</p>\n\n<p>To make it even more complicated, I don't have every single date available to me, so using a variable for today's date won't always work. So I guess I would need the macro to exclude everything before today's date.</p>\n\n<p>Thanks for the help, I'm really lost and in need of quite a bit.</p>\n\n<pre><code> Sub Macro1()\n\n    Sheets(\"Consulta_Lastro\").Range(\"$B$4:$T$9047\").AutoFilter Field:=4, Operator:= _\n    xlFilterValues, Criteria2:=Array(0, \"7/10/2029\", 0, \"12/20/2028\", 0, \"12/20/2027\", _\n    0, \"12/20/2026\", 0, \"12/20/2025\", 0, \"12/20/2024\", 0, \"12/20/2023\", 0, \"12/20/2022\", 0, _\n    \"12/20/2021\", 0, \"12/22/2020\", 0, \"12/22/2019\", 0, \"12/30/2018\", 0, \"12/30/2017\", 0, _\n    \"12/30/2016\", 1, \"2/28/2015\", 1, \"3/31/2015\", 1, \"4/30/2015\", 1, \"5/30/2015\", 1, _\n    \"6/30/2015\", 1, \"7/31/2015\", 1, \"8/31/2015\", 1, \"9/30/2015\", 1, \"10/30/2015\", 1, _\n    \"11/30/2015\", 1, \"12/30/2015\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1423606994, "post_id": 28443021, "comment_id": 45215599, "body": "Maybe there&#39;s as well a more elegant way to set the currency code into the NumberFormat?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423608868, "post_id": 28443021, "comment_id": 45216503, "body": "Since the format is just a string, it seems like you can&#39;t escape parsing that string, unless you also store that ISO code somewhere else (eg in a comment on the cell)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423609294, "post_id": 28443021, "comment_id": 45216677, "body": "@TimWilliams unfortunately no, the ISO code is input through the form and stored into the cell <i>as number format</i> and not as string into a separate cell. I hope the code will be stable then, I don&#39;t like trusting too much string parsing in this case."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423615234, "post_id": 28443021, "comment_id": 45218756, "body": "In that case, the best you could do would maybe be to implement a regexp-based parser to extract the ISO code (though that would limit you to Windows...)"}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1423701634, "last_edit_date": 1423701634, "creation_date": 1423695259, "answer_id": 28466147, "question_id": 28443021, "link": "https://stackoverflow.com/questions/28443021/return-the-iso-code-from-a-currency-formatted-cell/28466147#28466147", "title": "Return the ISO code from a currency formatted cell", "body": "<p>I'm pretty sure you will need to parse the string, but the ISO code can be extracted slightly more cleanly using:</p>\n\n<pre><code>If InStr(Range(\"A1\").NumberFormat, \"[$\") &lt;&gt; 0 Then _\nISOcode = Mid(Range(\"A1\").NumberFormat, InStr(Range(\"A1\").NumberFormat, \"[$\") + 2, 3)\n</code></pre>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423701634, "creation_date": 1423606923, "last_edit_date": 1531164843, "question_id": 28443021, "link": "https://stackoverflow.com/questions/28443021/return-the-iso-code-from-a-currency-formatted-cell", "title": "Return the ISO code from a currency formatted cell", "body": "<p>The user, through a userform, can insert a numeric value (say <code>1,000,000</code>) and an ISO code (say <code>USD</code>). When he will validate, the value will be printed in range A1 and will be formatted as currency through the use of the following macro-recorded line of code: </p>\n\n<pre><code>.Range(\"A1\").NumberFormat = _\n            \"_-[$\" &amp; Me.ISOTextBox.Value &amp; \"] * #,##0.00_-;-[$\" &amp; Me.ISOTextBox.Value &amp; \"] * #,##0.00_-;_-[$\" &amp; Me.ISOTextBox &amp; \"] * \"\"-\"\"??_-;_-@_-\"\n</code></pre>\n\n<p>Basically, the above is the string to assign the <code>.NumberFormat</code> property; in the case of \"USD\", for example, the string will look like:</p>\n\n<pre><code>\"_-[$USD] * #,##0.00_-;-[$USD] * #,##0.00_-;_-[$USD] * \"\"-\"\"??_-;_-@_-\"\n</code></pre>\n\n<p>My question is: if with the above string I <strong>set</strong> the number format, how could I <strong>get</strong> it?\nI could clearly make string parsing, and this is the currently \"horrible\" solution I'm adopting for extracting the 3-letters ISO code: </p>\n\n<pre><code>ISOcode = Left(Replace(Split(Range(\"A1\").NumberFormat, \"[\")(1), \"$\", \"\"), 3)\n</code></pre>\n\n<p><strong>Note:</strong> the above code is splitting the all <code>NumberFormat</code> by <code>[</code>, hence taking the second element (starting with <code>$USD</code>), replacing the <code>$</code> with <code>\"\"</code> and taking the first three letters, standing to the standard of ISO codes that are always 3-letters long).</p>\n\n<p>Documentations are very poor on this: does anyone know if there's a way of properly get the <em>ISO code</em> from the currency format (without turning into an unelegant string parsing)? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4552268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469b5dfeab24257229febbb781c3615d?s=128&d=identicon&r=PG&f=1", "display_name": "coreytrevor", "link": "https://stackoverflow.com/users/4552268/coreytrevor"}, "edited": false, "score": 0, "creation_date": 1423605960, "post_id": 28442654, "comment_id": 45215044, "body": "That&#39;s excellent, tospig, it works beautifully.  I&#39;ve been working on this for a couple of hours and you nailed it within a few minutes.  debugging and stepping through the code is definitely a good call.  I understand most of what you&#39;ve done, with a few exceptions. The string in the following: wksData.Range(&quot;XFD1&quot;), I assume this is something specific to Excel?  The same with the string in the next line?"}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "reply_to_user": {"reputation": 23, "user_id": 4552268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469b5dfeab24257229febbb781c3615d?s=128&d=identicon&r=PG&f=1", "display_name": "coreytrevor", "link": "https://stackoverflow.com/users/4552268/coreytrevor"}, "edited": false, "score": 0, "creation_date": 1423606605, "post_id": 28442654, "comment_id": 45215386, "body": "@coreytrevor <code>XFD</code> is the last column in an Excel sheet (version 2007). <code>1048576</code> is the last row.  The <code>End(xlup)</code> is saying, go to the last row (1048576), then go <code>up</code> the sheet until you find some data. The row with this data in is then the <code>lastRow</code>."}, {"owner": {"reputation": 23, "user_id": 4552268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469b5dfeab24257229febbb781c3615d?s=128&d=identicon&r=PG&f=1", "display_name": "coreytrevor", "link": "https://stackoverflow.com/users/4552268/coreytrevor"}, "edited": false, "score": 0, "creation_date": 1423607201, "post_id": 28442654, "comment_id": 45215722, "body": "Awesome, you&#39;ve been incredibly helpful.  Thank you again for taking the time."}], "tags": [], "owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "is_accepted": true, "score": 1, "last_activity_date": 1423605412, "creation_date": 1423605412, "answer_id": 28442654, "question_id": 28442121, "link": "https://stackoverflow.com/questions/28442121/excel-move-rows-containing-an-empty-cell-to-another-sheet/28442654#28442654", "title": "Excel - Move rows containing an empty cell to another sheet", "body": "<p>There are a few things wrong with your code so rather than go through them individually here is a basic looping version that does what you're after. </p>\n\n<pre><code>Sub moveData()\n\n    Dim wksData As Worksheet\n    Dim wksDestination As Worksheet\n\n    Dim lastColumn As Integer\n    Dim lastRow As Integer\n\n    Dim destinationRow As Integer\n\n    Set wksData = Worksheets(\"Sheet1\")\n    Set wksDestination = Worksheets(\"Sheet2\")\n\n    destinationRow = 1\n\n    lastColumn = wksData.Range(\"XFD1\").End(xlToLeft).Column\n    lastRow = wksData.Range(\"A1048576\").End(xlUp).Row\n\n    For i = lastRow To 1 Step -1    'go 'up' the worksheet to handle 'deletes'\n        For j = 1 To lastColumn\n            If wksData.Cells(i, j).Value = \"\" Then      'check for a blank cell in the current row\n                'if there is a blank, cut the row\n                wksData.Activate\n                wksData.Range(Cells(i, 1), Cells(i, lastColumn)).Cut\n\n                wksDestination.Activate\n                wksDestination.Range(Cells(destinationRow, 1), Cells(destinationRow, lastColumn)).Select\n                ActiveSheet.Paste\n\n                'If required this code will delete the 'cut' row\n                wksData.Rows(i).Delete shift:=xlUp\n\n                'increment the output row\n                destinationRow = destinationRow + 1\n\n                Exit For     'no need to carry on with this loop as a blank was already found\n            End If\n        Next j\n    Next i\n\n    set wksData = Nothing\n    set wksDestination = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>There are other ways that will achieve the same outcome but this should give you and idea of how to use <code>loops</code>, <code>sheets</code>, <code>ranges</code>, etc.</p>\n\n<p>The <code>lastColumn</code> and <code>lastRow</code> variables will find the the last column/row of data in the given columns/rows (i.e, in my code it finds the last column of data in row <code>1</code>, and the last row of data in column <code>A</code>).</p>\n\n<p>Also, you should get into the habit of debugging and stepping through code to identify errors and see exactly what each line is doing (this will also help you learn too). </p>\n"}, {"comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1423611080, "post_id": 28443719, "comment_id": 45217382, "body": "Arrays are my preferred way of doing this too, but I wanted to show the OP some basic loop notation / concepts. Also, there&#39;s an issue with the format of your post on the line <code>wksDestination.Range(...)</code>"}, {"owner": {"reputation": 23, "user_id": 4552268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469b5dfeab24257229febbb781c3615d?s=128&d=identicon&r=PG&f=1", "display_name": "coreytrevor", "link": "https://stackoverflow.com/users/4552268/coreytrevor"}, "edited": false, "score": 0, "creation_date": 1423671590, "post_id": 28443719, "comment_id": 45244586, "body": "Very nice way to do it.  I appreciate the additional information."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1423617165, "last_edit_date": 1423617165, "creation_date": 1423610091, "answer_id": 28443719, "question_id": 28442121, "link": "https://stackoverflow.com/questions/28442121/excel-move-rows-containing-an-empty-cell-to-another-sheet/28443719#28443719", "title": "Excel - Move rows containing an empty cell to another sheet", "body": "<p>You might find this of use.\nIt uses an array variable to store the values of the cells in the row to be moved.  It does not use cut and paste, so only transfer the data values, and the code does not require activation of the required sheets.\nThe destination rows are in the same order as the rows on the original sheet.\nThe method used to find the last cell used in the row and column is more elegant than other answers given.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test_moveData()\n\n    Dim wksData As Worksheet\n    Dim wksDestination As Worksheet\n\n    Set wksData = shtSheet1         ' Use the Codename \"shtSheet1\" for the worksheet. ie the value of the sheet property that is displayed as \"(Name)\"\n    Set wksDestination = shtSheet2\n\n    moveData wksData, wksDestination\n\nEnd Sub\nPublic Sub moveData(wksData As Worksheet, wksDestination As Worksheet)\n\n    Dim ilastColumn As Integer\n    Dim ilastRow As Integer\n    Dim iRow As Long\n    Dim iColumn As Long\n    Dim iDestinationRowNumber As Integer\n\n    Dim MyArray() As Variant\n    Dim rngRowsToDelete As Range\n\n\n    iDestinationRowNumber = 1\n\n    ilastColumn = wksData.Cells(1, wksData.Columns.Count).End(xlToLeft).Column\n    ilastRow = wksData.Cells(wksData.Rows.Count, 1).End(xlUp).Row\n\n    ReDim MyArray(1, ilastColumn)\n    Set rngRowsToDelete = Nothing\n\n    For iRow = 1 To ilastRow Step 1     'No need to go 'up' the worksheet to handle 'deletes'\n\n        For iColumn = 1 To ilastColumn\n\n            If wksData.Cells(iRow, iColumn).Value = \"\" Then        'check for a blank cell in the current row\n\n                MyArray = wksData.Range(wksData.Cells(iRow, 1), wksData.Cells(iRow, ilastColumn)).Value\n\n                    wksDestination.Range(wksDestination.Cells(iDestinationRowNumber, 1),\n                     wksDestination.Cells(iDestinationRowNumber, ilastColumn) _ \n                                        ).Value = MyArray\n\n                'Store the rows to be deleted\n                If rngRowsToDelete Is Nothing Then\n                    Set rngRowsToDelete = wksData.Rows(iRow)\n                Else\n                    Set rngRowsToDelete = Union(rngRowsToDelete, wksData.Rows(iRow))\n                End If\n\n                'increment the output row\n                iDestinationRowNumber = iDestinationRowNumber + 1\n\n                Exit For     'no need to carry on with this loop as a blank was already found\n            End If\n\n        Next iColumn\n\n    Next iRow\n\n    If Not rngRowsToDelete Is Nothing Then\n        rngRowsToDelete.EntireRow.Delete shift:=xlUp\n    End If\n    Set rngRowsToDelete = Nothing\n\n    Set wksData = Nothing\n    Set wksDestination = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>' enjoy</p>\n"}], "owner": {"reputation": 23, "user_id": 4552268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469b5dfeab24257229febbb781c3615d?s=128&d=identicon&r=PG&f=1", "display_name": "coreytrevor", "link": "https://stackoverflow.com/users/4552268/coreytrevor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1506, "favorite_count": 0, "accepted_answer_id": 28442654, "answer_count": 2, "score": 2, "last_activity_date": 1423617165, "creation_date": 1423603609, "question_id": 28442121, "link": "https://stackoverflow.com/questions/28442121/excel-move-rows-containing-an-empty-cell-to-another-sheet", "title": "Excel - Move rows containing an empty cell to another sheet", "body": "<p>This is my first attempt at VBA, so I apologize for my ignorance.  The situation is as follows:  I have a spreadsheet that consists of 4 columns and 629 rows.  When I am trying to do is iterate through the 4 cells in each row and check for a blank cell.  If there is a row that contains a blank cell, I want to cut it from Sheet1 and paste it into the first available row in Sheet2.  </p>\n\n<p>(Ideally the number of columns AND the number of rows is dynamic based on each spreadsheet, but I have no idea how to iterate through rows and columns dynamically)</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n' Move lines containing empty cells to sheet 2\n'\n' Keyboard Shortcut: Ctrl+r\n'\n\n\nDim Continue As Boolean\nDim FirstRow As Long\nDim CurrentRow As Long\nDim LastRow As Long\nDim EmptySheetCount As Long\n\n\nDim Counter As Integer\n\n\n'Initialize Variables\n\nLContinue = True\nFirstRow = 2\nCurrentRow = FirstRow\nLastRow = 629\nEmptySheetCount = 1\n\n'Sheets(Sheet1).Select\n\n'Iterate through cells in each row until an empty one is found\nWhile (CurrentRow &lt;= LastRow)\n\n    For Counter = 1 To 4\n\n        If Sheet1.Cells(CurrentRow, Counter).Value = \"\" Then\n\n            Sheet1.Cells(CurrentRow).EntireRow.Cut Sheet2.Cells(EmptySheetCount, \"A\")\n            EmptySheetCount = EmptySheetCount + 1\n            Counter = 1\n            CurrentRow = CurrentRow + 1\n            GoTo BREAK\n\n        Else\n\n            Counter = Counter + 1\n\n        End If\n\n        Counter = 1\nBREAK:\n    Next\n\nWend\nEnd Sub\n</code></pre>\n\n<p>When I run it, I typically get an error around the Sheet1.Cells(CurrentRow, Counter).Value = \"\" area, so I know I'm referencing sheets incorrectly.  I've tried Sheets(Sheet1), Worksheets(\"Sheet1\") and nothing seems to be working.  When I do change to Worksheets(\"Sheet1\"), however, it runs and just freezes Excel.  </p>\n\n<p>I know I'm doing multiple things wrong, I just know way too little to know what.  </p>\n\n<p>Thanks a lot in advance. And sorry for the crap formatting.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 676, "user_id": 4490779, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Julia Leder", "link": "https://stackoverflow.com/users/4490779/julia-leder"}, "edited": false, "score": 0, "creation_date": 1423601311, "post_id": 28441308, "comment_id": 45212584, "body": "What are you currently doing to get the data and what is the result?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3314924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FYzzb.png?s=128&g=1", "display_name": "On the path for perfection", "link": "https://stackoverflow.com/users/3314924/on-the-path-for-perfection"}, "edited": false, "score": 0, "creation_date": 1423659174, "post_id": 28441754, "comment_id": 45236481, "body": "Thanks Evans I have been chasing this for days."}], "tags": [], "owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1423602338, "creation_date": 1423602338, "answer_id": 28441754, "question_id": 28441308, "link": "https://stackoverflow.com/questions/28441308/need-sql-to-join-three-or-more-tables-and-display-all-the-rows-of-all-three-tabl/28441754#28441754", "title": "Need SQL to join three or more tables and display all the rows of all three tables even if they don&#39;t match", "body": "<p>What you wasnt is an sql full join. Unfirtunately Access doesnt do those... You are going to have to query for the 3 parts (left outer, right outer, inner) and Union them.</p>\n\n<p><a href=\"http://www.databasejournal.com/features/msaccess/article.php/3516561/Implementing-the-Equivalent-of-a-FULL-OUTER-JOIN-in-Microsoft-Access.htm\" rel=\"nofollow\">http://www.databasejournal.com/features/msaccess/article.php/3516561/Implementing-the-Equivalent-of-a-FULL-OUTER-JOIN-in-Microsoft-Access.htm</a></p>\n\n<p>This article explains it well.</p>\n"}], "owner": {"reputation": 13, "user_id": 3314924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FYzzb.png?s=128&g=1", "display_name": "On the path for perfection", "link": "https://stackoverflow.com/users/3314924/on-the-path-for-perfection"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594652485, "creation_date": 1423600799, "last_edit_date": 1594652485, "question_id": 28441308, "link": "https://stackoverflow.com/questions/28441308/need-sql-to-join-three-or-more-tables-and-display-all-the-rows-of-all-three-tabl", "title": "Need SQL to join three or more tables and display all the rows of all three tables even if they don&#39;t match", "body": "<p>I need information from three tables.  Each table has a field with a three letter month, four digit year key.  Sorry for the formatting issue.</p>\n\n<p>Table Name:------TBL1--------TBL2---------TBL3      </p>\n\n<p>Column Name:--WFMnth------PlanMnth-----PYMnth       </p>\n\n<p>Row1--------------Jan 2015      </p>\n\n<p>Row2-------------------------------Feb 2015 </p>\n\n<p>Row3--------------Mar 2015----Mar 2015-----Mar 2015 </p>\n\n<p>Row4--------------------------------------------------Apr 2015</p>\n\n<p>I tried a union and a join but I cannot get four rows of data from the three tables by matching.  TBL1.WFMnth = TBL2.PlanMnth OR TBL3.PYMnth. I\u2019m using Access any help is appreciated.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 3656992, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e7d9bc2f8a53f257036d726698e8bcf?s=128&d=identicon&r=PG&f=1", "display_name": "user3656992", "link": "https://stackoverflow.com/users/3656992/user3656992"}, "is_accepted": false, "score": 0, "last_activity_date": 1423687196, "creation_date": 1423687196, "answer_id": 28464060, "question_id": 28441224, "link": "https://stackoverflow.com/questions/28441224/get-current-query-record-field-in-access/28464060#28464060", "title": "Get current query record field in Access", "body": "<p>In the end, I made a query out of the multiple queries and used this new query as the control source for the form. I then set each text box's control source appropriately.</p>\n"}], "owner": {"reputation": 143, "user_id": 3656992, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e7d9bc2f8a53f257036d726698e8bcf?s=128&d=identicon&r=PG&f=1", "display_name": "user3656992", "link": "https://stackoverflow.com/users/3656992/user3656992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 923, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423687196, "creation_date": 1423600413, "question_id": 28441224, "link": "https://stackoverflow.com/questions/28441224/get-current-query-record-field-in-access", "title": "Get current query record field in Access", "body": "<p>I am trying to create a search results form that has text boxes that are populated by data from multiple queries. I do not want to use subforms, so form/control binding is (I believe) an impossibility. Instead, I'm trying to directly access the relevant query row field and increment the row field using</p>\n\n<pre><code>DoCmd.GoToRecord acDataQuery, \"My query name\", acNext, 1\n</code></pre>\n\n<p>whenever a button is pressed. However, this method seems to only let me access the first record in the query, as setting the text box value to </p>\n\n<pre><code>\"My Query name\".Fields(\"Desired Field\") \n</code></pre>\n\n<p>only gives me the first record's result. My next step was trying to use Recordset navigation using this code</p>\n\n<pre><code>Private Sub Command2_Click()\n\nDim rs As DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(\"Base_FH_Qry\")\n'DoCmd.GoToRecord acDataQuery, \"Base_FH_Qry\", acNext, 1\n[Forms]![Search_Results_Flat_Code_Frm]![CBT_FH].Value = rs.Fields(\"comm_amt_ati\")\nrs.MoveNext\n\nEnd Sub\n</code></pre>\n\n<p>This causes me to re-open the Recordset every time the button is clicked, so it doesn't help me either. </p>\n\n<p>My specific question is, which, if any, of these methods (Multiple bound queries to form, directly access query fields, or Recordset navigation) are viable and what do I need to change in my approach to get them to work? Thank you for your time.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "edited": false, "score": 0, "creation_date": 1423607243, "post_id": 28441356, "comment_id": 45215747, "body": "I really like the <code>Scripting.Dictionary</code> idea. However, I am still unable to store the desired color (via the dct(&quot;glngOrange&quot;) call) inside the table. I replaced &#39;glngOrange&#39; in <b>myTable.BackColor</b> and I still get the type mismatch. Is there a way to escape the <code>dct()</code> call so that I can use it on the right hand side (RHS) of an assignment to <code>Me.cboSelection.BackColor</code>?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "edited": false, "score": 0, "creation_date": 1423609409, "post_id": 28441356, "comment_id": 45216712, "body": "If your table is designed and loaded such that your <code>DLookup</code> always returns a string which corresponds to one of the dictionary keys, maybe this will suit: <code>Me.cboSelect.BackColor = dct(DLookup(&quot;[BackColor]&quot;, &quot;myTable&quot;, &quot;[myTableID] = &quot; &amp; Me.cboSelect.value))</code>"}, {"owner": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "edited": false, "score": 1, "creation_date": 1423612181, "post_id": 28441356, "comment_id": 45217790, "body": "It Worked! I setup <b>myTable</b> with unique dictionary keys and followed your assignment line above; it is so obvious now! BTW, I created my <code>Scripting.Dictionary</code> object in a global namespace and did the key&gt;value pairing inside my <code>initGlobals</code> subroutine."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1423600968, "creation_date": 1423600968, "answer_id": 28441356, "question_id": 28441054, "link": "https://stackoverflow.com/questions/28441054/type-mismatch-using-dlookup-to-return-evaluate-a-global-variable-namestring-to/28441356#28441356", "title": "Type mismatch using DLookup to return/evaluate a global variable name(string) to RHS of assignment to .BackColor(long) (Possible type casting issue?)", "body": "<p>It seems you are attempting something like <em>\"give me the value of the variable whose name matches this string\"</em>.  </p>\n\n<p>Having been down that road, I suggest you consider a different approach.</p>\n\n<p>Instead of a set of global variables, use a <code>Scripting.Dictionary</code> which has your names as its keys and the corresponding numbers as its values.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim dct As Object\nSet dct = CreateObject(\"Scripting.Dictionary\")\ndct.Add \"glngOrange\", 52479\n' and so forth ...\n\n' later you can retrieve the number associated with a given key ...\nDebug.Print dct(\"glngOrange\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "edited": false, "score": 0, "creation_date": 1423608662, "post_id": 28441643, "comment_id": 45216405, "body": "Are you recommending that I make a <b>colorDefinition</b> <code>table</code> that consists of the <code>ColorID</code> (autoNum), <code>colorName</code>(string), &amp; <code>colorNumCode</code> (long)? I added the <code>mainData</code> column to illustrate that, in my example, <b>myTable</b> is actually storing other data and the <code>BackColor</code> column is more of a property. I think a <b>colorDefinition</b> <code>table</code> might work if I set a <code>1-to-1</code> relationship with <b>myTable</b> (after adding a new column <code>ColorID</code>). Let me play with it; will I need to do nested DLookup values? the first would return <code>ColorID</code> and the second would return <code>colorNumCode</code>?"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "reply_to_user": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "edited": false, "score": 0, "creation_date": 1423644996, "post_id": 28441643, "comment_id": 45228135, "body": "@EnTrABl it depends on how you want to mange it. I prefer theme colours so i manage them in a table rather than hardcoded functions. This allows me add/edit/delete themes remotely (backend server)"}, {"owner": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "edited": false, "score": 1, "creation_date": 1423663735, "post_id": 28441643, "comment_id": 45239318, "body": "That makes sense; by adding the settings in a separate table you can modify the theme without having to update the back-end VBA code. In my case, this is a single-user (me) application that I am prototyping locally so I can afford to hard code functions for now. I will definitely keep your suggestions in my pocket for the future since your approach makes sense for production applications."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1423601977, "last_edit_date": 1525816098, "creation_date": 1423601977, "answer_id": 28441643, "question_id": 28441054, "link": "https://stackoverflow.com/questions/28441054/type-mismatch-using-dlookup-to-return-evaluate-a-global-variable-namestring-to/28441643#28441643", "title": "Type mismatch using DLookup to return/evaluate a global variable name(string) to RHS of assignment to .BackColor(long) (Possible type casting issue?)", "body": "<p>HansUp has already given a sleek solution to your problem. I personally would edit the <strong>myTable</strong> by adding another field for actual long number representing the colour name. This will give you an opportunity to remotely control your colour codes (in case if the tables are linked tables).</p>\n\n<p>Just to answer your last question how to turn string/text into vba code. One way would be to use the \"Microsoft Visual Basic For Applications Extensibility library\" to construct and execute(.Run) strings into vba code.</p>\n\n<p>read more here: <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a></p>\n"}], "owner": {"reputation": 13, "user_id": 3490821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d68098f81023f0e3747d4f897f7dc3?s=128&d=identicon&r=PG&f=1", "display_name": "EnTrABl", "link": "https://stackoverflow.com/users/3490821/entrabl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 1, "accepted_answer_id": 28441356, "answer_count": 2, "score": 1, "last_activity_date": 1423608825, "creation_date": 1423599784, "last_edit_date": 1423608825, "question_id": 28441054, "link": "https://stackoverflow.com/questions/28441054/type-mismatch-using-dlookup-to-return-evaluate-a-global-variable-namestring-to", "title": "Type mismatch using DLookup to return/evaluate a global variable name(string) to RHS of assignment to .BackColor(long) (Possible type casting issue?)", "body": "<h1>Problem:</h1>\n\n<p>I am getting a type mismatch error when using DLookup to return a global variable name(string) to the RHS of assignment to the .BackColor(long) property.</p>\n\n<p><strong>How do you pass a variable name(<code>string</code>/<code>text</code>) through a record look-up (<code>DLookup</code>) and evaluate its contents on the RHS of an expression.</strong></p>\n\n<p><em>\"give me the value of the variable whose name matches this string\"</em></p>\n\n<h2>Debug:</h2>\n\n<p>I have tried various versions of escaping (with <code>\"</code> or <code>'</code>), evaluating (with <code>Eval()</code>), type casting (with <code>Clng</code> and <code>Cstr</code>), and checking proper scope with no success. See \"<em>Debug Immediate Output</em>\" section</p>\n\n<p>From the code below, specifically this line: <code>Me.cboSelect.BackColor = DLookup(\"[BackColor]\", \"myTable\", \"[myTableID] = \" &amp; Me.cboSelect.value)</code></p>\n\n<p>If <code>Me.cboSelect.value=1</code> the code breaks with a type mismatch.</p>\n\n<p>If <code>Me.cboSelect.value=2</code> then the code works perfectly.</p>\n\n<h2>Situation:</h2>\n\n<p>I would like to define some common colors that I can store (as global variable names instead of the obscure number codes) in my tables along with the data that needs to be highlighted. I don't want to use conditional formatting because every form requires using the GUI to setup the conditionals and I prefer to have VBA to do the highlighting along with data entry in forms (this also leads to a more consistent user interface.</p>\n\n<p>Essentially I would like to be able to store a global variable name along with my data. Even if there is a better solution for doing conditional formatting in VBA I would still like to know how to pass a variable name through a record look-up and evaluate its contents.</p>\n\n<h2>Code:</h2>\n\n<h1>myTABLE</h1>\n\n<pre><code>myTableID(autoNum)  mainData     Backcolor(text)\n1                   \"str1\"       glngOrange\n2                   \"str2\"       52479\n</code></pre>\n\n<h1>Constants (VBA Module)</h1>\n\n<pre><code>Global glngOrange As Long\nPublic Sub initGlobals()\n    glngOrange = RGB(255, 204, 0) ' 52479\nEnd Sub\n</code></pre>\n\n<h1>Form (VBA Module)</h1>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n    Call initGlobals\nEnd Sub\n\nPrivate Sub cboSelect_LostFocus()\n    Debug.Print \"A) Check that global is in scope. glngOrange = \", glngOrange\n    Debug.Print \"B) Dlookup \", DLookup(\"[BackColor]\", \"myTable\", \"[myTableID] = \" &amp; Me.cboSelect.value)\n    Debug.Print \"C) Type \", TypeName(DLookup(\"[BackColor]\", \"myTable\", \"[myTableID] = \" &amp; Me.cboSelect.value))\n\n    'The following line works if .value=2, fails if .value=1\n    Me.cboSelect.BackColor = DLookup(\"[BackColor]\", \"myTable\", \"[myTableID] = \" &amp; Me.cboSelect.value)\nEnd Sub\n</code></pre>\n\n<h1>Debug Immediate Output</h1>\n\n<pre><code>A) Check that global is in scope. glngOrange = 52479 \nB) Dlookup       glngOrange\nC) Type          String\n</code></pre>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1423599127, "post_id": 28440824, "comment_id": 45211432, "body": "Why don&#39;t you use the logic that you apply to the CF for the count? CF does not set the Interior.Color, so that approach will never fly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1423599660, "post_id": 28440824, "comment_id": 45211734, "body": "FYI <code>Cells(xRow, xCol).Interior.Color</code> is the same here as <code>x.Interior.Color</code> so your code can be much shorter (even though it will not work for the reason outlined by @teylyn)"}, {"owner": {"reputation": 346, "user_id": 1733817, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/xJ0Nv.jpg?s=128&g=1", "display_name": "Aldo Sanchez", "link": "https://stackoverflow.com/users/1733817/aldo-sanchez"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1423600011, "post_id": 28440824, "comment_id": 45211919, "body": "Unfortunately I&#39;m not using any logic to my duplicates. I&#39;m using the excel built in Conditional Formatting. However, the link @pnuts sent may be useful.  Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 1959776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59af5dba5dadbdfc7b0cf992f150d4e4?s=128&d=identicon&r=PG", "display_name": "Casey Morter", "link": "https://stackoverflow.com/users/1959776/casey-morter"}, "is_accepted": false, "score": 0, "last_activity_date": 1423600527, "creation_date": 1423600527, "answer_id": 28441244, "question_id": 28440824, "link": "https://stackoverflow.com/questions/28440824/counting-cells-in-excel-with-with-same-interior-color-using-vba/28441244#28441244", "title": "Counting cells in Excel with with same interior color using VBA", "body": "<p>Turns out that conditional formatting doesn't actually color the cell in the same way that a 'traditional' format does.</p>\n\n<p>There are two ways to tackle this:</p>\n\n<ol>\n<li><p>Use VBA to detect your duplicates:</p>\n\n<pre><code>' dupe check requires cells to be highighted\nYourWB.Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Select\n\n' now check that row for dupes, and flag each dupe with some formatting\nDim d As Object, e\nSet d = CreateObject(\"scripting.dictionary\")\nFor Each e In Intersect(Columns(ActiveCell.Column), ActiveSheet.UsedRange)\n    If e.Value &lt;&gt; vbNullString Then\n        If Not d.exists(e.Value) Then d(e.Value) = 1 Else _\n            e.Font.ColorIndex = 4\n    End If\nNext\n</code></pre></li>\n<li><p>Detect the applied conditional color.</p></li>\n</ol>\n\n<p>This is a little more complex, I used the code <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=190\" rel=\"nofollow\">on this page</a></p>\n"}], "owner": {"reputation": 346, "user_id": 1733817, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/xJ0Nv.jpg?s=128&g=1", "display_name": "Aldo Sanchez", "link": "https://stackoverflow.com/users/1733817/aldo-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423600527, "creation_date": 1423598898, "question_id": 28440824, "link": "https://stackoverflow.com/questions/28440824/counting-cells-in-excel-with-with-same-interior-color-using-vba", "title": "Counting cells in Excel with with same interior color using VBA", "body": "<p>I'm trying to count cells that are duplicate.  In a column, I first find the duplicates using Conditional Formatting.  I highlight my cells yellow (RGB(255,255,255)).  However, when I try to count the highlighted cells, for some reason my vba does not detect them.  </p>\n\n<p>If I highlight the cells over the Conditional Formatting my function detects the color and counts correctly.  Any ideas on why I can't detect the conditional formatting?</p>\n\n<pre><code>Function colorCount(arr As Variant, r As Integer, G As Integer, B As Integer) As Integer\nDim x As Variant\nDim xRow As Integer\nDim xCol As Integer\n\ncolorCount = 0\nFor Each x In arr.Cells\n\nxRow = x.Row\nxCol = x.Column\n\nIf Cells(xRow, xCol).Interior.Color = RGB(r, G, B) Then\ncolorCount = colorCount + 1\nEnd If\nNext\n\nEnd Function\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["sql", "vba", "excel", "recordset"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1423597594, "post_id": 28440255, "comment_id": 45210505, "body": "There is a <code>MaxColumns</code> argument to <code>CopyFromRecordset</code>, but you&#39;d have to make sure your one column was positioned first in the select clause."}], "answers": [{"tags": [], "owner": {"reputation": 454, "user_id": 4552288, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ce7e986bb51499855b41f5cde90f6d7?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4552288/matt"}, "is_accepted": true, "score": 3, "last_activity_date": 1423598007, "last_edit_date": 1423598007, "creation_date": 1423597000, "answer_id": 28440337, "question_id": 28440255, "link": "https://stackoverflow.com/questions/28440255/can-i-copy-only-one-row-field-from-a-recordset-to-an-excel-column/28440337#28440337", "title": "Can I copy only one row/field from a recordset to an excel column", "body": "<p>EDIT: It looks a though you can copy just one column without a loop with the max column reference. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/aa223845%28v=office.11%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/aa223845%28v=office.11%29.aspx</a></p>\n\n<p>I don't think there is anyway to do it without looping.\nYou would have to loop through the record set and make each column a field from the record set.</p>\n\n<pre><code>With rs\n    Do Until .EOF\n        ActiveSheet.Range(\"A\" &amp; lastRow).CopyFromRecordset rsEDW.Fields(3)\n        ActiveSheet.Range(\"B\" &amp; lastRow).CopyFromRecordset rsEDW.Fields(4)\n.MoveNext\nlastRow = lastRow + 1\nLoop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 4547107, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/ef42f758ae6b02e6ba7c5371ff4d8738?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4547107/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5375, "favorite_count": 0, "accepted_answer_id": 28440337, "answer_count": 1, "score": 1, "last_activity_date": 1423598007, "creation_date": 1423596729, "last_edit_date": 1423597052, "question_id": 28440255, "link": "https://stackoverflow.com/questions/28440255/can-i-copy-only-one-row-field-from-a-recordset-to-an-excel-column", "title": "Can I copy only one row/field from a recordset to an excel column", "body": "<p>Is there a way to copy the values from a single column of a recordset to a column in Excel without have to use a loop? I tried the following to copy a single column:  </p>\n\n<pre><code>    Sheet4.Range(\"Complete\").CopyFromRecordset rsEDW.Fields(3)\n</code></pre>\n\n<p>But that did not work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1423596589, "post_id": 28440083, "comment_id": 45209903, "body": "What is A1 + 1 ?   Are you adding a row or column ? Should it be B1 ? or A2 ?"}], "answers": [{"tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": false, "score": 0, "last_activity_date": 1423597382, "last_edit_date": 1423597382, "creation_date": 1423596855, "answer_id": 28440297, "question_id": 28440083, "link": "https://stackoverflow.com/questions/28440083/alter-a-formula-in-vba-and-show-it-in-excel/28440297#28440297", "title": "Alter a formula in VBA and show it in Excel", "body": "<p>Try something like this ... combination of INDIRECT to translate a string \"A1\" to a cell reference. and OFFSET to adjust rows/cols from a given reference.</p>\n\n<pre><code>  Sub test()\n     Dim s1 As String\n     Dim add_row As Integer\n     Dim add_col As Integer\n\n     s1 = \"A1\"\n\n     add_row = 2\n     add_col = 1\n\n     Range(\"A1\").Value = \"=offset(indirect(\" + Chr(34) + s1 + Chr(34) + \"),\" + Str(add_row) + \",\" + Str(add_col) + \",1,1)\"\n\n  End Sub\n</code></pre>\n\n<p>[edit]\njust realized, don't even need the indirect function in there:</p>\n\n<p>this works just as well:</p>\n\n<pre><code>Range(\"A1\").Value = \"=offset(\" + s1 + \",\" + Str(add_row) + \",\" + Str(add_col) + \",1,1)\"\n</code></pre>\n\n<p>;)\n[/edit]</p>\n"}], "owner": {"reputation": 1763, "user_id": 551705, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7311c566c1f1a5fd2326da17fce4a50f?s=128&d=identicon&r=PG", "display_name": "Mariska", "link": "https://stackoverflow.com/users/551705/mariska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423599790, "creation_date": 1423596166, "last_edit_date": 1531164843, "question_id": 28440083, "link": "https://stackoverflow.com/questions/28440083/alter-a-formula-in-vba-and-show-it-in-excel", "title": "Alter a formula in VBA and show it in Excel", "body": "<p>I wanted to write in VBA to write a formula into a cell that depends on other dynamic cells.</p>\n\n<pre><code>Dim cell1, cell2 as Range\nset cell1 = Range(\"A1\")\nset cell2 = Range(\"A2\")\n</code></pre>\n\n<p>'I can't hardcode A1 and A2 because the cells will change later by incrementing the rows</p>\n\n<p>'I want to display in B1 <code>=(1+cell1)*(1+cell2)</code> using references, but when I see it on excel, it says <code>=(1+A1)*(1+A2)</code></p>\n\n<p>and for B2 it will be <code>=(1+A2)*(1+A3)</code></p>\n\n<p>How can I achieve this in VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 0, "creation_date": 1423596167, "post_id": 28439773, "comment_id": 45209647, "body": "Are you talking about a printed page?"}, {"owner": {"reputation": 89, "user_id": 3228380, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bbded5fb6d74d1e23da3ca3f515d828b?s=128&d=identicon&r=PG&f=1", "display_name": "JimC", "link": "https://stackoverflow.com/users/3228380/jimc"}, "edited": false, "score": 0, "creation_date": 1423598300, "post_id": 28439773, "comment_id": 45210941, "body": "Yes a Printed Page. The data set has only a few rows but a variable number of columns. I want it to all fit on a single printed page with column data across the entirety of the page."}], "answers": [{"tags": [], "owner": {"reputation": 25586, "user_id": 30447, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/LlF5u.jpg?s=128&g=1", "display_name": "PA.", "link": "https://stackoverflow.com/users/30447/pa"}, "is_accepted": true, "score": 1, "last_activity_date": 1423605050, "creation_date": 1423605050, "answer_id": 28442537, "question_id": 28439773, "link": "https://stackoverflow.com/questions/28439773/excel-vba-fit-columns-to-page/28442537#28442537", "title": "Excel VBA - Fit columns to page", "body": "<p>you need <strong>(1)</strong> to divide the window width <code>ActiveWindow.Width</code> by the number of columns you want to fit. And then <strong>(2)</strong> apply that resulting width to all the columns you want to fit. </p>\n\n<pre><code>w = ActiveWindow.Width / n\nColumns(1).Resize(, n).ColumnWidth = w\n</code></pre>\n\n<p>But, <strong>beware</strong>, this will <strong>not</strong> work, because the window width is in <em>points</em> and the column width is in <em>chars</em>, so you will have to calculate a conversion function.</p>\n\n<pre><code>Function pointsToChars(x) As Integer\n  p = Range(\"A1\").Width\n  c = Range(\"A1\").ColumnWidth\n  pointsToChars = x * c / p\nEnd Function\n</code></pre>\n\n<p>and invoke it finally in your code</p>\n\n<pre><code>Sub ResizeColumnWidths(n)\n  w = ActiveWindow.Width / n\n  Columns(1).Resize(, n).ColumnWidth = pointsToChars(w)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 3228380, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bbded5fb6d74d1e23da3ca3f515d828b?s=128&d=identicon&r=PG&f=1", "display_name": "JimC", "link": "https://stackoverflow.com/users/3228380/jimc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1487, "favorite_count": 0, "accepted_answer_id": 28442537, "answer_count": 1, "score": 0, "last_activity_date": 1423605287, "creation_date": 1423595145, "question_id": 28439773, "link": "https://stackoverflow.com/questions/28439773/excel-vba-fit-columns-to-page", "title": "Excel VBA - Fit columns to page", "body": "<p>I am writing a report macro to pull data from a database and output the data in Excel. Sometimes the data would span only a couple columns, other times it would have as many as 12 columns. Is there a way for VBA to AutoFit the columns so that it uses up the entire page width? </p>\n\n<p>So if the report had 5 columns, each would be say 1.5\" wide and if there were 10 columns, each would be .75\" wide. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1423594267, "post_id": 28439376, "comment_id": 45208592, "body": "It is Activeworkbook unless otherwise specify in preceding codes"}, {"owner": {"reputation": 4942, "user_id": 2446698, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a749847d5d087343a8ceed7f16969bf7?s=128&d=identicon&r=PG", "display_name": "CodeCamper", "link": "https://stackoverflow.com/users/2446698/codecamper"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1423846511, "post_id": 28439376, "comment_id": 45328401, "body": "@Alex is there a way to change the default behavior with preceding code so that it always references ThisWorkbook? Or would I have to simply declare ThisWorkbook for each time I grab something (this is how I do it currently) ."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1424186259, "post_id": 28439376, "comment_id": 45439805, "body": "As Tim&#39;s answer below, you could put your code in thisworkbook module and unqualified worksheets will be default to thisworkbook"}, {"owner": {"reputation": 4942, "user_id": 2446698, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a749847d5d087343a8ceed7f16969bf7?s=128&d=identicon&r=PG", "display_name": "CodeCamper", "link": "https://stackoverflow.com/users/2446698/codecamper"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1424290808, "post_id": 28439376, "comment_id": 45492787, "body": "@Alex what is an unqualified worksheet vs a qualified worksheet?"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1424291498, "post_id": 28439376, "comment_id": 45493177, "body": "sorry it was poorly explained.  I meant to say an unqualified worksheet() object."}, {"owner": {"reputation": 4942, "user_id": 2446698, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a749847d5d087343a8ceed7f16969bf7?s=128&d=identicon&r=PG", "display_name": "CodeCamper", "link": "https://stackoverflow.com/users/2446698/codecamper"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1424291817, "post_id": 28439376, "comment_id": 45493374, "body": "@Alex Just making sure there was no secret way to change this default behavior in certain objects. Thanks."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1424292115, "post_id": 28439376, "comment_id": 45493553, "body": "I am not sure if there are tricky ways, say for e.g. changing registry for the allocated object properities (this goes beyond normal vba coding).  Other than that it is pretty much straight forward as Tim&#39;s answer mentioned."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1555513773, "post_id": 28439984, "comment_id": 98140314, "body": "Side note, <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> has code inspections that can locate all implicit <code>ActiveSheet</code> and <code>ActiveWorkbook</code> references in a project (and a quick-fix to make them explicit)."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 18, "last_activity_date": 1555519298, "last_edit_date": 1555519298, "creation_date": 1423595861, "answer_id": 28439984, "question_id": 28439376, "link": "https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984", "title": "What is the default scope of worksheets and cells and range?", "body": "<p>In a standard module an unqualified <code>Worksheets()</code> will always reference the ActiveWorkbook. In the <code>ThisWorkbook</code> module, the implicit qualifier is <code>Me</code> and that will reference the containing workbook.</p>\n\n<p>Likewise, an unqualified <code>Range()</code> or <code>Cells()</code> (or <code>Rows()</code>/<code>Columns()</code>) in a standard module will reference the ActiveSheet, but in a sheet code module the implicit qualifier is <code>Me</code>, and will reference the corresponding worksheet.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Unqualified...       Where              Implicit Qualifier\n--------------       --------------     -------------------\nWorksheets(),        ThisWorkbook       Containing workbook (Me)\nSheets()             Any other module   Active workbook (via [_Global])\n\nRange(), Cells(),    Sheet module       Containing sheet (Me)\nRows(), Columns(),   Any other module   Active sheet (via [_Global])\nNames()\n</code></pre>\n\n<p>The easy way to avoid having to remember <em>any</em> of this is to <em>always fully qualify</em> any <code>Worksheets</code>, <code>Sheets</code>, <code>Range</code>, <code>Cells</code>, or <code>Names</code> reference.</p>\n\n<p>Qualify the member call with <code>Me</code> when referring to <code>ThisWorkbook</code> in that module's code-behind, or when referring to <code>Sheet1</code> in that module's code-behind.</p>\n"}], "owner": {"reputation": 4942, "user_id": 2446698, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a749847d5d087343a8ceed7f16969bf7?s=128&d=identicon&r=PG", "display_name": "CodeCamper", "link": "https://stackoverflow.com/users/2446698/codecamper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 5, "accepted_answer_id": 28439984, "answer_count": 1, "score": 3, "last_activity_date": 1555530845, "creation_date": 1423593957, "last_edit_date": 1555512656, "question_id": 28439376, "link": "https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range", "title": "What is the default scope of worksheets and cells and range?", "body": "<p>When you just type worksheets() what is the default scope ActiveWorkbook or ThisWorkbook? For those who do not know these distinctions they are extremely important especially in Excel 2013 when you want macros to run when you switch to different workbooks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 5, "creation_date": 1423590352, "post_id": 28438278, "comment_id": 45206411, "body": "Yes. Stop doing foolish things like accessing <code>Children.Item(0).Children.Item(1)</code>. One of those <code>Children</code> is null, or one of the children&#39;s <code>Item</code> isn&#39;t assigned. Use intermediate variables to hold values instead of chaining things like that, and you can figure out which one of them isn&#39;t assigned when you think it should be."}], "owner": {"reputation": 11, "user_id": 4551539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c736a50f68c3d4c5bdb4ab0ed71920?s=128&d=identicon&r=PG&f=1", "display_name": "Kimble1983", "link": "https://stackoverflow.com/users/4551539/kimble1983"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 838, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423590411, "creation_date": 1423590134, "last_edit_date": 1531161705, "question_id": 28438278, "link": "https://stackoverflow.com/questions/28438278/visual-basic-error-runtime-error-91", "title": "Visual Basic error runtime error &#39;91&#39;", "body": "<p>I am new to Microsoft Visual Basic and I'm trying to run an Excel macro built to parse an internet explorer htlml file. However I keep getting the following error \"Run-time error '91': Object variable or With block variable not set. When I run microsoft visual basic I see the following highlighted in yellow:</p>\n\n<pre><code>Set nameElement = anElement.Children.Item(0).Children.Item(1).Children.Item(1).Children.Item(1).Children.Item(0).Children.Item(1)\n</code></pre>\n\n<p>Any suggestions on how to correct this error and get the macro up and running? </p>\n"}, {"tags": ["excel", "filter", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1423588621, "post_id": 28437495, "comment_id": 45205382, "body": "First run the exercise manually with the <i>Macro Recorder</i> turned on.........then examine the resulting code."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1423589260, "post_id": 28437495, "comment_id": 45205793, "body": "Not sure why you are resizing before you filter, you should be filtering from the Header Row"}, {"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1423593348, "post_id": 28437495, "comment_id": 45208059, "body": "I tried using the Macro Recorder. I added that code into the message above. I am not sure how to make the ranges automatically select all filtered rows to cut/copy or to select the first empty row in the closed sheet."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1423593232, "post_id": 28438583, "comment_id": 45207998, "body": "This looks good, but I get an error that says this will not work on overlapping sections. Not sure what that means exactly."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "edited": false, "score": 0, "creation_date": 1423656471, "post_id": 28438583, "comment_id": 45234873, "body": "Either do I, what haven&#39;t you told us?"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1423591210, "creation_date": 1423591210, "answer_id": 28438583, "question_id": 28437495, "link": "https://stackoverflow.com/questions/28437495/excel-vba-filter-and-move-results/28438583#28438583", "title": "Excel- VBA filter and move results", "body": "<p>I believe it is the .cut operation giving you grief, try this one,</p>\n\n<pre><code>Sub MoveButton()\n    Dim ws As Worksheet, MyRng As Range, rws As Long, Frng As Range\n    Dim sh As Worksheet\n    Set ws = Worksheets(\"Proposals\")\n    With ws\n        rws = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        Set MyRng = .Range(.Cells(1, 1), .Cells(rws, \"Z\"))\n        MyRng.AutoFilter Field:=13, Criteria1:=\"Closed\"\n        Set Frng = .Range(.Cells(2, 1), .Cells(rws, \"Z\")).SpecialCells(xlCellTypeVisible)\n    End With\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Set sh = ActiveSheet\n    Frng.Copy sh.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n    Frng.EntireRow.Delete\n    ws.AutoFilterMode = 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4475338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbbf1e09c75842052315371b31fdd6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4475338/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3049, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423605466, "creation_date": 1423587762, "last_edit_date": 1531164843, "question_id": 28437495, "link": "https://stackoverflow.com/questions/28437495/excel-vba-filter-and-move-results", "title": "Excel- VBA filter and move results", "body": "<p>I am trying to set up a vba code to filter a sheet of data and cut rows containing specific values to other sheets. The snippet below is for one of these filters. So far I am struggling to debug this line. </p>\n\n<pre><code>myRange.Offset(1).Resize(myRange.Rows.Count - 1).SpecialCells(xlVisible).Cut \n</code></pre>\n\n<p>I keep getting an error that I cannot run this on multiple sections. Any help would be greatly appreciated.</p>\n\n<pre><code>Sub MoveButton()\nSheets(\"Sheet1\").Activate\nSet myRange = Range(Range(\"A1\"), Range(\"Z\" &amp; Cells.Rows.Count).End(xlUp))\nmyRange.Resize(1).AutoFilter\nmyRange.AutoFilter Field:=13, Criteria1:=\"Closed\"\nmyRange.Offset(1).Resize(myRange.Rows.Count - 1).SpecialCells(xlVisible).Cut\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(\"Closed\").Activate\nActiveSheet.Paste\nApplication.CutCopyMode = False\nmyRange.AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p>Ok I this is what I got using record macro. Now I'm just not sure how to change the ranges so that they autoselect all of the filtered rows and copy and paste them to the next wmpty row on the next sheet.</p>\n\n<pre><code>Sub MoveCancelled()\n\n    Sheets(\"Sheet1\").Select\n    Rows(\"2:2\").Select\n    Selection.AutoFilter\n    Selection.AutoFilter\n    Range(\"A2\").Select\n    ActiveWindow.ScrollColumn = 7\n    ActiveSheet.Range(\"$A$2:$Z$20\").AutoFilter Field:=13,Criteria1:=\"Closed\"\n    Rows(3).Select ' Selecting the row to copy, but it could be more than just one row.\n    Selection.Copy\n    Sheets(\"Closed\").Select\n    Rows(114).Select ' Selecting the paste location at the bottom of the next sheet.\n    ActiveSheet.Paste\n\n\nEnd Sub\n</code></pre>\n\n<p>I found this thread and ended up scrapping all my other efforts.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11903878/autofilter-macro-then-copy-visible-data-only-and-paste-to-next-available-row\">Autofilter Macro, then copy visible data ONLY and paste to next available row</a></p>\n\n<p>This solution worked perfectly.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2280, "user_id": 1458985, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/0fcfed451b42d89b70f5e7ee49ec62b3?s=128&d=identicon&r=PG", "display_name": "Dom Sinclair", "link": "https://stackoverflow.com/users/1458985/dom-sinclair"}, "edited": false, "score": 0, "creation_date": 1423587783, "post_id": 28437258, "comment_id": 45204858, "body": "It&#39;s been a while since I&#39;ve done anything with Bartender, but isn&#39;t there an api available to work with it unless I&#39;m very much mistaken, in which case you could use vb.net as opposed to vbscript, always a better option."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 1, "creation_date": 1423590841, "post_id": 28437258, "comment_id": 45206692, "body": "vb.net and vba is not the same language."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 4362809, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/pKQM0.jpg?s=128&g=1", "display_name": "Jamie Brace", "link": "https://stackoverflow.com/users/4362809/jamie-brace"}, "edited": false, "score": 0, "creation_date": 1423588462, "post_id": 28437624, "comment_id": 45205286, "body": "Sorry, I think I accidentally added the vb.net tag, it should be VBA! I want the resulting number to display in a text box and increment with each copy. I will try this in the morning, as it&#39;s not my PC who currently has access to Bartender annoyingly. Thanks for the speedy reply!"}], "tags": [], "owner": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "is_accepted": false, "score": 0, "last_activity_date": 1423588125, "creation_date": 1423588125, "answer_id": 28437624, "question_id": 28437258, "link": "https://stackoverflow.com/questions/28437258/box-number-of-number-vba-bartender/28437624#28437624", "title": "Box Number of Number VBA Bartender", "body": "<p>You didn't say what you want to do with the strings when you have created them; the following code displays them in a MsgBox (you will need to change that line to do what you want). It's also not clear if you want a vba or a vb.net solution; the following code is for vb.net and would need to be adjusted for vba (remove \"As Integer\" from the for statements and \".ToString\" from the MsgBox text). </p>\n\n<pre><code>For numMax As Integer = 1 To 4\n    For num As Integer = 1 To numMax\n        MsgBox(num.ToString &amp; \" of \" &amp; numMax.ToString)\n    Next\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 4362809, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/pKQM0.jpg?s=128&g=1", "display_name": "Jamie Brace", "link": "https://stackoverflow.com/users/4362809/jamie-brace"}, "is_accepted": false, "score": 0, "last_activity_date": 1423736823, "creation_date": 1423736823, "answer_id": 28475012, "question_id": 28437258, "link": "https://stackoverflow.com/questions/28437258/box-number-of-number-vba-bartender/28475012#28475012", "title": "Box Number of Number VBA Bartender", "body": "<p>I figured it out in the end;</p>\n\n<p>On the NewRecord event, I set the value of to 0, and on the IdenticalCopies event, I set Value to Value + 1.</p>\n"}], "owner": {"reputation": 185, "user_id": 4362809, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/pKQM0.jpg?s=128&g=1", "display_name": "Jamie Brace", "link": "https://stackoverflow.com/users/4362809/jamie-brace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1423736823, "creation_date": 1423587091, "last_edit_date": 1423591700, "question_id": 28437258, "link": "https://stackoverflow.com/questions/28437258/box-number-of-number-vba-bartender", "title": "Box Number of Number VBA Bartender", "body": "<p>I've just been asked to try and figure out some VB code to accomplish the following in Bartender;</p>\n\n<p>I essentially want to create a field that looks at a quantity, and then increments a number based on the number of copies of that label.</p>\n\n<p>So basically we'll have 1 of 2, 2 of 2, 1 of 3, 2 of 3, 3 of 3, etc, etc</p>\n\n<p>We have a workaround that involves selecting only certain lines of the data to print, and doing this for each individual line, as the first number (i.e the \"1 of\" number) just continually increases based on the number of copies, so regardless of the second number, it will keep increasing (i.e 1 of 2, 2 of 2, 3 of 3, 4 of 3, 5 of 3, etc).</p>\n\n<p>I imagine the code will look something like this;</p>\n\n<pre><code>FirstNumber.Value = 1\nFor Each Copy\nFirstNumber.Value = FirstNumber.Value + 1\nLoop Until\nFirstNumber = SecondNumber\nGoto Next Copy and repeat event\n</code></pre>\n\n<p>Has anyone got any ideas?</p>\n\n<p>Thanks guys!</p>\n"}, {"tags": ["vba", "replace", "header", "find", "format"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1423600767, "post_id": 28437214, "comment_id": 45212320, "body": "What does &quot;actual date&quot; with same format mean?  Isn&#39;t 22/02/2015 an actual date?  Or do you mean to replace it with current date"}, {"owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1423603928, "post_id": 28437214, "comment_id": 45213997, "body": "Replace it with current date"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1423608177, "post_id": 28437214, "comment_id": 45216215, "body": "see if the answer provide resolve the issue"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423643516, "post_id": 28443294, "comment_id": 45227437, "body": "Yes it works!  First of all thanks you for the interest. Now the problem is how I can apply this code to the header of various documents, I mean I have various documents in some carpet (In this case would be &quot;C:\\Nueva carpeta*.doc&quot;) and I want to modify the date in his headers (With the code that you wrote). Thanks."}, {"owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423648796, "post_id": 28443294, "comment_id": 45230335, "body": "Hi again, I&#39;ve been looking more information and I get this code to modify the header but with this code I can&#39;t move through the header, just modify the first header&#39;s cell: &lt;ActiveDocument.ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader&gt; Could I move through the header if I modify this code?"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "reply_to_user": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423666802, "post_id": 28443294, "comment_id": 45241376, "body": "@Solaire are you saying you&#39;ve multiple headers on the same documents, or you have mulitple documents?"}, {"owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423667004, "post_id": 28443294, "comment_id": 45241500, "body": "Multiple documents, and I want to apply the last vba code in all those documents. The documents are in C:\\Nueva carpeta"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "reply_to_user": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423667062, "post_id": 28443294, "comment_id": 45241543, "body": "@Solaire I just added a link to the answer above.  You can have a template .docm file, insert the answer into a module, and use it to open multiple documents. (I will let you figure it out but please let me know if you&#39;re stuck)"}, {"owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423668290, "post_id": 28443294, "comment_id": 45242402, "body": "I&#39;m stuck xD, How I can assamble this code with the other?  I tried several times but it gives me error"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "reply_to_user": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423668638, "post_id": 28443294, "comment_id": 45242659, "body": "@Solaire could you show me where you stuck?  You can edit your question"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "reply_to_user": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423678475, "post_id": 28443294, "comment_id": 45248790, "body": "@Solaire Please see the edit in answer.  Please accept answer so other helpers knows it has been resolved."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "reply_to_user": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "edited": false, "score": 0, "creation_date": 1423756569, "post_id": 28443294, "comment_id": 45286002, "body": "@Solaire Glad I could help.  Enjoy!"}], "tags": [], "owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "is_accepted": true, "score": 0, "last_activity_date": 1423678262, "last_edit_date": 1525816189, "creation_date": 1423608151, "answer_id": 28443294, "question_id": 28437214, "link": "https://stackoverflow.com/questions/28437214/replace-the-headers-date-in-various-doc-documents/28443294#28443294", "title": "Replace the header&#39;s date in various .doc documents", "body": "<p>You cannot use a regexp as a search text, you have to test against the searched result to the regexp, then perform a replacement.  Also I have changed the regexp:  </p>\n\n<pre><code>Sub FindAndReplaceFirstStoryOfEachType()\nSet objRegEx = CreateObject(\"vbscript.regexp\")\nobjRegEx.Global = True\nobjRegEx.IgnoreCase = True\nobjRegEx.MultiLine = True\nobjRegEx.Pattern = \"[0-9]{2}/[0-9]{2}/[0-9]{4}\"\n\n\nDim rngStory As Range\nFor Each rngStory In ActiveDocument.StoryRanges\nIf Not IsEmpty(rngStory) Then\nWith rngStory.Find\n    If objRegEx.test(rngStory) = True Then\n\n     .Text = CStr(rngStory)\n     .Replacement.Text = Now()\n     .Wrap = wdFindContinue\n     .Execute Replace:=wdReplaceAll\n    End If\nEnd With\n\nEnd If\nNext rngStory\nEnd Sub\n</code></pre>\n\n<p><code>Format(now(), \"mm/dd/yyyy\")</code> can be use if you wish to change the format of the current date.  Also I am not sure if your last part of the question is having issue opening documents.</p>\n\n<p>EDIT: <a href=\"https://stackoverflow.com/questions/21240457/excel-vba-to-open-multiple-word-2010-documents-and-determine-if-checkboxes-are-c\">Open multiple documents</a> might helps if you are looking to open multiple documents.</p>\n\n<p>You can place below code to a template document and use it to open your other files:  </p>\n\n<pre><code>Sub openf()\nDim FSO As Object\nDim fPath As String\nDim myFolder, myFile\nDim wdApp As Object\nDim wdDoc As Variant\n\nfPath = \"C:\\\" 'change to your directory\nSet wdApp = GetObject(, \"Word.Application\")\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet myFolder = FSO.GetFolder(fPath).Files\nFor Each myFile In myFolder\n  If LCase(myFile) Like \"*.docx\" Then 'change to you file type\n      Set wdDoc = wdApp.Documents.Open(CStr(myFile))\n      wdApp.Visible = True\n      FindAndReplaceFirstStoryOfEachType\n      wdDoc.Save\n      wdDoc.Close\n      Set wdDoc = Nothing\n  End If\nNext myFile\n\nEnd Sub\n</code></pre>\n\n<p>If you still having issue on how it works, I will suggest you to read some basic vba coding tutorial:  <a href=\"http://www.cpearson.com/Excel/MainPage.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/Excel/MainPage.aspx</a>  </p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "is_accepted": false, "score": 0, "last_activity_date": 1423663883, "creation_date": 1423663883, "answer_id": 28456465, "question_id": 28437214, "link": "https://stackoverflow.com/questions/28437214/replace-the-headers-date-in-various-doc-documents/28456465#28456465", "title": "Replace the header&#39;s date in various .doc documents", "body": "<p>Ok, this code changes the header's date and works great:</p>\n\n<pre><code>Sub ModificarFechaCabecera()\n\nIf ActiveWindow.View.SplitSpecial &lt;&gt; wdPaneNone Then\n    ActiveWindow.Panes(2).Close\nEnd If\nIf ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _\n    ActivePane.View.Type = wdOutlineView Then\n    ActiveWindow.ActivePane.View.Type = wdPrintView\nEnd If\nActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\nSelection.MoveRight Unit:=wdCharacter, Count:=14\nSelection.MoveDown Unit:=wdLine, Count:=1\nSelection.MoveRight Unit:=wdCharacter, Count:=3\nSelection.MoveLeft Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.TypeText Text:=Format(Now(), \"dd/mm/yyyy\")\nSelection.MoveLeft Unit:=wdCharacter, Count:=4\nSelection.TypeBackspace\nSelection.TypeText Text:=\"/\"\nEnd Sub\n</code></pre>\n\n<p>Now, how I can execute this code in all .doc files at directory C:\\Nueva carpeta ?\nGreetings</p>\n"}], "owner": {"reputation": 3, "user_id": 4551309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d2dbd6713c69acfc9edd76a699c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Solaire", "link": "https://stackoverflow.com/users/4551309/solaire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 28443294, "answer_count": 2, "score": 0, "last_activity_date": 1455102322, "creation_date": 1423586970, "last_edit_date": 1455102322, "question_id": 28437214, "link": "https://stackoverflow.com/questions/28437214/replace-the-headers-date-in-various-doc-documents", "title": "Replace the header&#39;s date in various .doc documents", "body": "<p>I'm trying to replace the date in the header in various documents.<br>\nI don't care if the date it's already in the script or if the program require arguments.<br>\nThe header date's format it's like this one: 22/02/2015 and I want to replace with the actual date with the same format.<br>\nThis is the code that I have done:</p>\n\n<pre><code>Sub FindAndReplaceFirstStoryOfEachType()\n    Set objRegEx = CreateObject(\"vbscript.regexp\")\n    objRegEx.Global = True\n    objRegEx.IgnoreCase = True\n    objRegEx.MultiLine = True\n  Dim rngStory As Range\n  For Each rngStory In ActiveDocument.StoryRanges\n    With rngStory.Find\n      .Text = \"([1-12]{1,3}/[1-09]{1,2}/[1-2014]{1,4})\"\n      .Replacement.Text = \"&lt;DATE&gt;\"\n      .Wrap = wdFindContinue\n      .Execute Replace:=wdReplaceAll\n    End With\n  Next rngStory\nEnd Sub\n</code></pre>\n\n<p>I have seen a code to apply to the documents in a carpet but when I use it doesn't work:</p>\n\n<pre><code>Set wdDoc = wdApp.Documents.Open(\"C:\\Nueva carpeta\\*.doc\")\n</code></pre>\n\n<p>EDIT: I don't know how to insert my last code in the other vba to open the files in the folder C:\\Nueva carpeta. Did you say to create a .doc word in C:\\Nueva carpeta and then create a module with the answer code right? But in this  new module I have to call or paste my code or what?</p>\n"}, {"tags": ["vba", "excel", "outlook", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4551160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed659ef5e097619644349e289563615d?s=128&d=identicon&r=PG&f=1", "display_name": "Keith Firstenberg", "link": "https://stackoverflow.com/users/4551160/keith-firstenberg"}, "edited": false, "score": 0, "creation_date": 1423589363, "post_id": 28437101, "comment_id": 45205853, "body": "i am not familiar with Redemption, but from the quick scan of the link you provided, it seems as though i would need to install this on machines of all potential users.  This is not feasible and i will likely encounter resistance from our IT department.  Is there a way to &quot;attach&quot; the code library to the workbook so that is it available to any user who accesses the workbook from a network directory?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 4551160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed659ef5e097619644349e289563615d?s=128&d=identicon&r=PG&f=1", "display_name": "Keith Firstenberg", "link": "https://stackoverflow.com/users/4551160/keith-firstenberg"}, "edited": false, "score": 0, "creation_date": 1423595501, "post_id": 28437101, "comment_id": 45209274, "body": "No, not in VBA unfortunately."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1456788007, "last_edit_date": 1456788007, "creation_date": 1423586736, "answer_id": 28437101, "question_id": 28436827, "link": "https://stackoverflow.com/questions/28436827/outlook-gal-fails-to-be-top-most-window-when-called-from-vba-userform/28437101#28437101", "title": "Outlook GAL fails to be top-most window when called from VBA UserForm", "body": "<p>Outlook Object Model does not let you specify the parent window of the address book dialog - it will always be Outlook.</p>\n\n<p>On the Extended MAPI level (C++ or Delphi), you can specify the window handle when calling <a href=\"https://msdn.microsoft.com/en-us/library/ms629532(v=vs.85).aspx\" rel=\"nofollow\">IAddbook::Address</a>, but you cannot do that from VBA.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow\">Redemption</a> is an option, you can set the <a href=\"http://www.dimastr.com/redemption/rdosession.htm\" rel=\"nofollow\">RDOSession</a>.ParentWindow property before using the <a href=\"http://www.dimastr.com/redemption/rdoselectnamesdialog.htm\" rel=\"nofollow\">RDOSelectNames</a> object. </p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nSession.ParentWindow = Excel.Application.hwnd\nset ABDialog = Session.GetSelectNamesDialog\nABDialog.Display true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5999642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4s0D.jpg?s=128&g=1", "display_name": "FRanck", "link": "https://stackoverflow.com/users/5999642/franck"}, "is_accepted": false, "score": 0, "last_activity_date": 1456779648, "creation_date": 1456779648, "answer_id": 35709549, "question_id": 28436827, "link": "https://stackoverflow.com/questions/28436827/outlook-gal-fails-to-be-top-most-window-when-called-from-vba-userform/35709549#35709549", "title": "Outlook GAL fails to be top-most window when called from VBA UserForm", "body": "<p>I just spent an evening on this, so even if this thread is one year old it should help.\nYou should just try using:</p>\n\n<p>\"olApp.ActiveWindow.Activate\"</p>\n\n<p>It sums up to this fully working function:</p>\n\n<pre><code>enter Public Function GetUsernameFromOutlook(sCap As String) As String\n'fancy code to call Outlook dialog box to select names.\n  'Badresult is the default, gives username of operator if they try to:\n'   select more than one recipient\n'   cancel out of the dialog box\n\nDim olApp As Outlook.Application    ' Outlook.Application\nDim olDialog As Outlook.SelectNamesDialog\nDim hwnd As Long\n\nSet olApp = New Outlook.Application\nSet olDialog = olApp.Session.GetSelectNamesDialog\n'Set olDialog = new Outlook.Application\nWith olDialog\n.Caption = sCap\n'.ForceResolution = True\n.AllowMultipleSelection = False\n.NumberOfRecipientSelectors = olShowTo\n.ToLabel = \"Select User\"\n\nolApp.ActiveWindow.Activate\n .display\nIf .Recipients.Count &lt;&gt; 1 Then GoTo BadResult\n'Debug.Print .Recipients(1).Name\n'Debug.Print .Recipients(1).Address\n'Debug.Print .Recipients(1).AddressEntry.GetExchangeUser.Alias\nGetUsernameFromOutlook = .Recipients.Item(1).AddressEntry\nEnd With\n\n\nSet olApp = Nothing\nSet olDialog = Nothing\n\nExit Function\n\nBadResult:\n\nGetUsernameFromOutlook = \"A voir ult\u00e9rieurement\"\n\nEnd Function here\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4551160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed659ef5e097619644349e289563615d?s=128&d=identicon&r=PG&f=1", "display_name": "Keith Firstenberg", "link": "https://stackoverflow.com/users/4551160/keith-firstenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456788007, "creation_date": 1423586038, "question_id": 28436827, "link": "https://stackoverflow.com/questions/28436827/outlook-gal-fails-to-be-top-most-window-when-called-from-vba-userform", "title": "Outlook GAL fails to be top-most window when called from VBA UserForm", "body": "<p>i have about ten responses from StackOverflow open but none of them quite answer my problem.  </p>\n\n<p>i have created several UserForms in Excel VBA for this particular project.  (Note: i have no formal training on VBA programming and everything i have done is self-taught or gleaned from copying other people's codes.)  While interfacing with more than one of these forms, i want the user to be able to access a command to select a user-name from the company's Global Address List.  With a command button on the form and the following function i am able to do this:  </p>\n\n<pre><code>Public Function GetUsernameFromOutlook(sCap As String) As String\n'fancy code to call Outlook dialog box to select names. \n'Badresult is the default, gives username of operator if they try to:\n'   select more than one recipient\n'   cancel out of the dialog box\n\nDim olApp As Object     ' Outlook.Application\nDim olDialog As Object  ' Outlook.SelectNamesDialog\nDim hwnd As Long\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olDialog = olApp.Session.GetSelectNamesDialog\n\nWith olDialog\n    .Caption = sCap\n    .ForceResolution = True\n    .AllowMultipleSelection = False\n    .NumberOfRecipientSelectors = olShowTo\n    .ToLabel = \"Select User\"\n    If .Display = False Then GoTo BadResult\n    SetForegroundWindow (Excel.Application.hwnd)\n    If .Recipients.Count &lt;&gt; 1 Then GoTo BadResult\n    'Debug.Print .Recipients(1).Name\n    'Debug.Print .Recipients(1).Address\n    'Debug.Print .Recipients(1).AddressEntry.GetExchangeUser.Alias\n    GetUsernameFromOutlook = .Recipients.Item(1).AddressEntry.GetExchangeUser.Alias\nEnd With\n\n '   hwnd = FindWindow(vbNullString, sCap &amp; \": Global Address List\")\n\n\nSet olApp = Nothing\nSet olDialog = Nothing\n\nExit Function\n\nBadResult:\n    SetForegroundWindow (Excel.Application.hwnd)\n    GetUsernameFromOutlook = Environ(\"UserName\")\n\nEnd Function\n</code></pre>\n\n<p>As you can see i attempted to use the <code>SetForegroundWindow</code> and <code>FindWindow</code> API calls as suggested in other answers.  But the code doesn't even reach these lines before causing the problem.  </p>\n\n<p>The line <code>If .Display = False</code> brings up the SelectNamesDialog box from Outlook, but because my UserForm is modal (i think), it stays as the visible window.  i am forced to use Alt-Tab to switch to Outlook.  Then, after either selecting a name or cancelling out of the Outlook dialog box, i need to Alt-Tab again to get back to Excel.<br>\nAlso, because the code is waiting for a response from the Outlook box, there is no further code execution, so  <code>SetForegroundWindow</code> doesn't even happen until i complete all of the Alt-Tab switching.  </p>\n\n<p>Other solutions posted have referred to using calls to MSWord, or looking up information from or saving to a spreadsheet.  i'm trying to use this call to modify the caption or text of a form control, such as a command button or text box or text label.  i only need to collect the Outlook alias, since i have another function which can collect other selected information from Outlook based on the alias, so the alias is saved in a tag (unseen) on the form and converted to full name, initials or e-mail address as needed using this other function.  </p>\n\n<p>So far everything works great and i'd really like to release this interface to my beta-testers, but i don't want to have to explain to everyone to use Alt-Tab after they click the \"select name\" button.  They will believe their computer has locked up and do a hard re-start.  (Or call IT who will start asking questions that they cannot answer.)  </p>\n\n<p>i'm sorry that this question is so long, but i wanted to include as much information as possible.  i'm sure there will be things i need to clarify, so please send me your questions in a response and i will do my best to explain better.  Thank you for your time.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423586551, "post_id": 28436795, "comment_id": 45203976, "body": "What did <code>Debug.Print</code> tell you?"}, {"owner": {"reputation": 313, "user_id": 3245460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9779ceec5983f7611d0c3c2c6c8d2435?s=128&d=identicon&r=PG&f=1", "display_name": "rajeev", "link": "https://stackoverflow.com/users/3245460/rajeev"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423586964, "post_id": 28436795, "comment_id": 45204305, "body": "@PaulFrancis Where do I add that statement? I stepped through the code and got the message box &quot;No employee id&quot;"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1423587094, "post_id": 28436795, "comment_id": 45204400, "body": "RecordCount  can be a little odd with ADO, step though and use the immediate window to get <code>rstEmp(0).Value</code>. Why are you using ADO with MS Access, rather than DAO? DAO is preferred."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1423587203, "post_id": 28436795, "comment_id": 45204493, "body": "BTW, from the above, <code>.CommandType = adCmdText</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1423589229, "post_id": 28437406, "comment_id": 45205773, "body": "It looks like the other thing you did but didn&#39;t mention (and I forget if this really matters but) you changed the parameter name from <code>[strEmpName]</code> to <code>strEmpName</code> when creating the parameter."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1423589601, "post_id": 28437406, "comment_id": 45205991, "body": "Yes, I did that, but it doesn&#39;t matter.  With ADO, the parameter name is completely ignored."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1423589688, "post_id": 28437406, "comment_id": 45206034, "body": "ah right right, only order matters. I just always name then but I guess I always put them in order so I forget, too. Thanks!"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1423588632, "last_edit_date": 1423588632, "creation_date": 1423587504, "answer_id": 28437406, "question_id": 28436795, "link": "https://stackoverflow.com/questions/28436795/not-getting-query-results-back/28437406#28437406", "title": "Not getting query results back", "body": "<p>Your sample had multiple issues.  I'm unsure whether this is exactly what you want, but it works without error on my system.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With cmd\n    '.ActiveConnection = CurrentProject.Connection\n    .ActiveConnection = cnn1\n    .CommandText = \"SELECT [EmployeeId] FROM [Employees] \" &amp; _\n                    \"WHERE [EmployeeName] = [strEmpName]\"\n    .CommandType = adCmdUnknown ' or adCmdText; either works\n    .Parameters.Append cmd.CreateParameter( _\n                \"strEmpName\", adVarChar, adParamInput, 255, strEmpName)\nEnd With\n\n' Execute the Query and return the employeeId\nSet rstEmp = cmd.Execute\n\n'If rstEmp.RecordCount &lt; 1 Then\nIf rstEmp.BOF And rstEmp.EOF Then\n    MsgBox \"No Employee Id\"\nElse\n    MsgBox rstEmp(0).value\nEnd If\n</code></pre>\n\n<p>Notes: </p>\n\n<ol>\n<li>I assumed you want to run your query from the <em>cnn1</em> connection to that other database instead of from <code>CurrentProject.Connection</code>.</li>\n<li>Supply a compatible data type for <code>CreateParameter</code>.  And for a text parameter, supply a value for its maximum length.  Finally include the value for the parameter.</li>\n<li><code>rstEmp.RecordCount</code> was returning -1, which is less than 1, so your code displayed <em>\"No Employee Id\"</em> even when the recordset was not empty. Instead of checking <code>RecordCount</code>, check whether the recordset is empty. </li>\n</ol>\n"}], "owner": {"reputation": 313, "user_id": 3245460, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9779ceec5983f7611d0c3c2c6c8d2435?s=128&d=identicon&r=PG&f=1", "display_name": "rajeev", "link": "https://stackoverflow.com/users/3245460/rajeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 28437406, "answer_count": 1, "score": 1, "last_activity_date": 1423588632, "creation_date": 1423585927, "last_edit_date": 1423588380, "question_id": 28436795, "link": "https://stackoverflow.com/questions/28436795/not-getting-query-results-back", "title": "Not getting query results back", "body": "<p>My query does not return any values even though the table has the records. I am trying to retrieve an employeed id based on the name entered. I keep getting the message \"No employee id\". I am a new learner as far as Access VBA is concerned. I have worked with Access tables and other tables without issues. I did validate that the form field has the correct value and is being captured in the variable <em>strEmpName</em></p>\n\n<pre><code>    Set cnn1 = New ADODB.Connection\n    mydb = \"C:\\accesssamp\\Documents\\Tasks.accdb\"\n    strCnn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; mydb\n    cnn1.Open strCnn\n\n    'This statement added here just to indicate that I am getting the value\n    strEmpName = cboEmployeeName.Text ' Getting employee name from form field\n\n    Set cmd = New ADODB.Command\n\n    With cmd\n        .ActiveConnection = CurrentProject.Connection\n        .CommandText = \"SELECT [EmployeeId] FROM [Employees] \" &amp; _\n                        \"WHERE [EmployeeName] = [strEmpName]\"\n        .CommandType = adCmdUnknown\n        .Parameters.Append cmd.CreateParameter( _\n                    \"[strEmpName]\", adChar, adParamInput, 50)\n        .Parameters(\"[strEmpName]\") = strEmpName\n    End With\n\n    ' Execute the Query and return the employeeId\n    Set rstEmp = cmd.Execute\n\n    If rstEmp.RecordCount &lt; 1 Then\n        MsgBox \"No Employee Id\"\n    Else\n        MsgBox rstEmp(0).Value\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4551275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3998270d193f58236dd9417408a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle AirPro", "link": "https://stackoverflow.com/users/4551275/kyle-airpro"}, "edited": false, "score": 0, "creation_date": 1423600308, "post_id": 28437222, "comment_id": 45212088, "body": "I&#39;m trying to set this up so I can use the same template for multiple jobs. The problem I&#39;m running into with the recorder is when I copy the visible rows over it locks me into copying over the specific rows that are on that workbook. If my motor goes from row 4 in one workbook to row 5 in the next workbook the Macro still wants to copy row 4 even though it was able to filter out the right results, So it isn&#39;t copying the right row. Not sure how to fix that"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1423586999, "creation_date": 1423586999, "answer_id": 28437222, "question_id": 28436662, "link": "https://stackoverflow.com/questions/28436662/vba-excel-search-sheet-for-partial-string-then-take-row-and-paste-into-another/28437222#28437222", "title": "VBA Excel: Search Sheet for partial string, then take row and paste into another sheet", "body": "<p>This is a perfect job for the <em>Macro Recorder</em></p>\n\n<ol>\n<li>switch on the <em>Recorder</em></li>\n<li>place an <em>AutoFilter</em> on the original data</li>\n<li>Using <em>AutoFilter</em> pick <strong>Text Filters > Contains...</strong></li>\n<li>copy the visible rows and paste to the other sheet</li>\n<li>switch off the <em>Recorder</em></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4551275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3998270d193f58236dd9417408a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle AirPro", "link": "https://stackoverflow.com/users/4551275/kyle-airpro"}, "edited": false, "score": 1, "creation_date": 1423598450, "post_id": 28437605, "comment_id": 45211010, "body": "The sheets are actually called &quot;Parts Tracking Sheet&quot; and &quot;Assy Kit Creation&quot; I&#39;m trying to take the Data from &quot;Parts Tracking Sheet&quot; to create the &quot;Assy Kit Creation&quot; Sheet. The Data on the &quot;PTS&quot; would end somewhere between row 50 and row 80. Yes I would want to keep the headings in row 1. I want to write the values to columns A-D in the 2nd sheet."}, {"owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "reply_to_user": {"reputation": 11, "user_id": 4551275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3998270d193f58236dd9417408a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle AirPro", "link": "https://stackoverflow.com/users/4551275/kyle-airpro"}, "edited": false, "score": 0, "creation_date": 1423661641, "post_id": 28437605, "comment_id": 45237941, "body": "that&#39;s not what your original question said...it said you wanted to copy the rows, not just 4 columns (a to d) and no mention of the sheet names was provided.  I still think you can work my code into your solution with some minor changes.  Please specify the question in the level of detail you require the answer to rather than letting people answer and then state your real requirement ;-)"}], "tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1423588083, "creation_date": 1423588083, "answer_id": 28437605, "question_id": 28436662, "link": "https://stackoverflow.com/questions/28436662/vba-excel-search-sheet-for-partial-string-then-take-row-and-paste-into-another/28437605#28437605", "title": "VBA Excel: Search Sheet for partial string, then take row and paste into another sheet", "body": "<p>You could try this if you are copying from Sheet1 to Sheet2.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TransferMotor()\n    Dim lngLastRow As Long\n    Dim lngRow As Long\n    Dim strValue As String\n    Dim lngRowOutput As Long\n\n    ' where does the data end in Sheet1\n    lngLastRow = Sheet1.UsedRange.Rows.Count\n\n    If lngLastRow = 1 Then Exit Sub ' no data\n\n    ' Clear down sheet2, assume we have column headings in row 1 we want to keep\n    Sheet2.Range(\"2:1048576\").Clear\n\n    lngRowOutput = 2 ' where are we going to write the values to in Sheet2 when we find a \"MOTOR\" phrase\n\n    For lngRow = 2 To lngLastRow\n        strValue = Sheet1.Cells(lngRow, 2).Value ' get value from column B\n\n        If InStr(1, strValue, \"MOTOR\", vbTextCompare) &gt; 0 Then ' can we find \"MOTOR\" in the text\n            Sheet1.Rows(lngRow).Copy\n            Sheet2.Rows(lngRowOutput).PasteSpecial\n            lngRowOutput = lngRowOutput + 1\n        End If\n\n    Next lngRow\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4551275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3998270d193f58236dd9417408a15a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle AirPro", "link": "https://stackoverflow.com/users/4551275/kyle-airpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2699, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1423593194, "creation_date": 1423585576, "last_edit_date": 1423593194, "question_id": 28436662, "link": "https://stackoverflow.com/questions/28436662/vba-excel-search-sheet-for-partial-string-then-take-row-and-paste-into-another", "title": "VBA Excel: Search Sheet for partial string, then take row and paste into another sheet", "body": "<p>I'm new at <code>VBA</code> and I need a little help writing a code to perform a specific function.</p>\n\n<p>I need to be able to search column \"<strong>B</strong>\" for a partial string, and output the row into another sheet.</p>\n\n<p>For example, \nI need to pull all the rows that have the word \"<strong>MOTOR</strong>\" as part of the string in column \"<strong>B</strong>\" and paste those rows in \"<strong>sheet 2</strong>\" The sting in column \"<strong>B</strong>\" could have a variety of strings such as \"<strong>TEFCMOTOR286B2</strong>\" or \"<strong>MOTORSLIDEBASE286B2</strong>\" and I need to copy both of the rows with the previous strings and make them into a list on \"<strong>sheet 2</strong>\" The number of Rows that need to be copied will vary and sometimes there wont be any with the partial string \"<strong>MOTOR</strong>\" at all.</p>\n\n<p>Let me know if you need more info.</p>\n"}, {"tags": ["vba", "excel", "excel-2003", "excel-2013"], "comments": [{"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1423587275, "post_id": 28435499, "comment_id": 45204539, "body": "When you toggle, you could write to a cell (or name, i.e. in name manager) what the state is supposed to be, then in the <code>Workbook_Open</code> event check to see what the state should be, then open accordingly."}, {"owner": {"reputation": 41, "user_id": 4551044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe55fc34e42d38d4aa4f2feaeeeedb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ronson Lamond", "link": "https://stackoverflow.com/users/4551044/ronson-lamond"}, "reply_to_user": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1423589244, "post_id": 28435499, "comment_id": 45205782, "body": "@guitarthrower: The workbook is unable to save the changes when in read-only mode.  When the mode is toggled from read-only to read-write I also loose all variables due to a complete reload of the workbook."}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1423600681, "post_id": 28435499, "comment_id": 45212266, "body": "[slaps forehead] of course you can&#39;t save in read-only mode :)  It sounds like when it toggles, it is reopening the file (I don&#39;t have 2013, so I can&#39;t test). If that is the case, you could try implementing a <code>Application.EnableEvents = False</code> at some point in your code. Another option could be to check the current status on open. It would help if you could post your <code>Workbook_Open</code> code."}, {"owner": {"reputation": 41, "user_id": 4551044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe55fc34e42d38d4aa4f2feaeeeedb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ronson Lamond", "link": "https://stackoverflow.com/users/4551044/ronson-lamond"}, "reply_to_user": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1423601414, "post_id": 28435499, "comment_id": 45212642, "body": "@guitarthrower: I&#39;ve created a new workbook with just this code (appended to the question) to test if there was something else causing the issues.  I was able to replicate the error.  I came across using window parameters to pass variables between workbooks whether or not they were open, this didn&#39;t even work.  It appears that the when the file is toggled read only the window its self is terminated.  Every time a new HWnd is assigned to the workbook."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4565553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d9486acacf7d84dd75d51b5738d40bc?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Swatsenberg", "link": "https://stackoverflow.com/users/4565553/larry-swatsenberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1423883347, "last_edit_date": 1423883347, "creation_date": 1423881954, "answer_id": 28511876, "question_id": 28435499, "link": "https://stackoverflow.com/questions/28435499/excel-2013-toggle-read-only/28511876#28511876", "title": "Excel 2013 toggle read only", "body": "<p>It is possible achieve the results you are after without changing the FileAccess to read only. You can use the Workbook_BeforeSave and Workbook_Beforeclose events to control one's ability to save the workbook.  I have provided a complete code example below that I believe would suit your needs.  You could use a toggle button or any method you choose to run the subMakeItSaveable and subMakeItUnSaveable, or you could implement that functionality in a single routine.\nThe funUpdateCustomDocumentProperty function writes a Boolean value to the workbooks custom properties to toggle the ability to save the sheet. Please note that this custom property doesn't do anything except provide a place to store a value that isn't in either code or in the sheet.  This provides a handy method of persisting data that our code needs when the code isn't running.</p>\n\n<p>The code I used follows:</p>\n\n<pre><code>    Private Sub Workbook_BeforeClose(Cancel As Boolean)\n      ThisWorkbook.Saved = True\n    End Sub\n\n    Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n      If ThisWorkbook.CustomDocumentProperties(\"SaveMyChanges\").Value Then\n        SaveAsUI = True\n        Cancel = False\n      Else\n        SaveAsUI = False\n        Cancel = True\n        myTestValue = MsgBox(\"Read Only Workbook. Save Not Allowed.\",         vbInformation, \"Operation Aborted\")\n      End If\n    End Sub\n\n    Private Sub Workbook_Open()\n      myTestValue = funUpdateCustomDocumentProperty(\"SaveMyChanges\", False, msoPropertyTypeBoolean)\n    End Sub\n\n    Public Function funUpdateCustomDocumentProperty(strPropertyName As String, _\n     varValue As Variant, docType As Office.MsoDocProperties) As Boolean\n    'Function returns true if custom property was added, false if it already exists\n    'Originally a sub built by Peter Albert\n    'http://stackoverflow.com/users/1867581/peter-albert\n\n      On Error Resume Next\n      funUpdateCustomDocumentProperty = False\n      ThisWorkbook.CustomDocumentProperties(strPropertyName).Value _\n    = varValue\n\n      If Err.Number &gt; 0 Then\n\n        ThisWorkbook.CustomDocumentProperties.Add _\n          Name:=strPropertyName, _\n          LinkToContent:=False, _\n          Type:=docType, _\n          Value:=varValue\n        funUpdateCustomDocumentProperty = True\n      End If\n    End Function\n\n\n    Public Sub subMakeItSaveable()\n      myTestValue = funUpdateCustomDocumentProperty(\"SaveMyChanges\", True, msoPropertyTypeBoolean)\n    End Sub\n\n\n    Public Sub subMakeItUnSaveable()\n      myTestValue = funUpdateCustomDocumentProperty(\"SaveMyChanges\", False, msoPropertyTypeBoolean)\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4551044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe55fc34e42d38d4aa4f2feaeeeedb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ronson Lamond", "link": "https://stackoverflow.com/users/4551044/ronson-lamond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1774, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1423885430, "creation_date": 1423582277, "last_edit_date": 1531164843, "question_id": 28435499, "link": "https://stackoverflow.com/questions/28435499/excel-2013-toggle-read-only", "title": "Excel 2013 toggle read only", "body": "<p>I have an application that I've written in Excel 2003 and I have recently upgraded to Excel 2013.  In the workbook_open event I set the workbook to read-only <code>ActiveWorkbook.ChangeFileAccess xlReadOnly</code> and have used the <code>Toggle Read Only</code> button to switch between read\\write and read only.  In Excel 2003 when switching file mode the workbook would toggle as expected.  When I run it in 2013 as an <strong>.xlsm</strong> the <code>Workbook_Open</code> Event is called after switching the file status and it becomes read only again.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    If ActiveWorkbook.ReadOnly = False Then\n        ActiveWorkbook.Saved = True\n        ActiveWorkbook.ChangeFileAccess xlReadOnly\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1423592864, "post_id": 28435328, "comment_id": 45207795, "body": "@user1274820 You can&#39;t convert <code>null</code> to a string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1423671562, "post_id": 28435328, "comment_id": 45244576, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2347276/in-vsto-excel-how-to-detect-data-in-cells\">In VSTO Excel, how to detect data in cells?</a>"}, {"owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "edited": false, "score": 0, "creation_date": 1423674447, "post_id": 28435328, "comment_id": 45246454, "body": "<a href=\"http://stackoverflow.com/a/28452164/4551007\">stackoverflow.com/a/28452164/4551007</a>    Please seee this for a solution!"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "edited": false, "score": 0, "creation_date": 1423642061, "post_id": 28439020, "comment_id": 45226761, "body": "This helped but does not solve my main problem which is that the blank cells are still there. &#39;Excel.Range row = ws.Rows[1];             Excel.Range rng = row.SpecialCells(Excel.XlCellType.xlCellTypeConstants);&#39; works perfectly to select the non-empty cells. I can use rng.Select and see them in my sheet. But when I transfer the cell values to an array, the blank cell is still there. Its really weird because rng.Count is the same as the non-empty cell count. Any ideas?"}, {"owner": {"reputation": 282, "user_id": 4514233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b357af21cb261689883aff8ffbad7a54?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe.H", "link": "https://stackoverflow.com/users/4514233/philippe-h"}, "reply_to_user": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "edited": false, "score": 0, "creation_date": 1423642930, "post_id": 28439020, "comment_id": 45227173, "body": "Maybe you could try to loop through rng and add each item to a list. Then copy list into array if you need an array."}, {"owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "edited": false, "score": 0, "creation_date": 1423644551, "post_id": 28439020, "comment_id": 45227917, "body": "I&#39;ve sort of tried that but the problem is that the range when I select it only highlight non-empty cells in the sheet. And its count is equal to non-empty cells but still if I print each range cell (rng[1, i].value.ToString()) one cell in the range is still blank. I don&#39;t see how it adds up."}], "tags": [], "owner": {"reputation": 282, "user_id": 4514233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b357af21cb261689883aff8ffbad7a54?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe.H", "link": "https://stackoverflow.com/users/4514233/philippe-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1423600993, "last_edit_date": 1423600993, "creation_date": 1423592705, "answer_id": 28439020, "question_id": 28435328, "link": "https://stackoverflow.com/questions/28435328/detect-blank-excel-cell-using-interop-excel-in-c/28439020#28439020", "title": "Detect blank Excel cell using interop.excel in C#", "body": "<p>You should probably use SpecialCells. E.g. the code below sets the value of all empty cells to zero (vba code).</p>\n\n<pre><code>Range(\"e11:g16\").SpecialCells(xlCellTypeBlanks).Value = 0\n</code></pre>\n\n<p>Or you can easily loop all empty cells like this:</p>\n\n<pre><code>For Each item In Range(\"e11:g16\").SpecialCells(xlCellTypeBlanks)\n   '...\nNext\n</code></pre>\n\n<p>In the same logic, if you want to loop through all cells which are not empty:</p>\n\n<pre><code> For Each item In Range(\"g10:h11\").SpecialCells(xlCellTypeConstants)\n        '...\n Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "is_accepted": false, "score": 0, "last_activity_date": 1423593874, "last_edit_date": 1495541199, "creation_date": 1423593524, "answer_id": 28439247, "question_id": 28435328, "link": "https://stackoverflow.com/questions/28435328/detect-blank-excel-cell-using-interop-excel-in-c/28439247#28439247", "title": "Detect blank Excel cell using interop.excel in C#", "body": "<p>Try this:</p>\n\n<pre><code>if (ws.IsEmpty(Cells[row, col]))\n</code></pre>\n\n<p>I don't exactly remember if I got the syntax right for porting to Excel from .NET, but this is the command I use in a VB macro from within Excel.</p>\n\n<p>you can also try IsNumeric(Cells[row,col].Value)</p>\n\n<p>The default value for Excel cells is Empty (but I can't find the MSN link to verify this!)</p>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/8522323/what-is-the-difference-between-empty-and-isempty-in-vba-excel\">What is the difference between =Empty and IsEmpty() in VBA (Excel)?</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5411024, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3fe7c231a6c7ac856644864c47c4eab1?s=128&d=identicon&r=PG", "display_name": "el_guazu", "link": "https://stackoverflow.com/users/5411024/el-guazu"}, "is_accepted": false, "score": 1, "last_activity_date": 1444067762, "creation_date": 1444067762, "answer_id": 32954872, "question_id": 28435328, "link": "https://stackoverflow.com/questions/28435328/detect-blank-excel-cell-using-interop-excel-in-c/32954872#32954872", "title": "Detect blank Excel cell using interop.excel in C#", "body": "<p>Try with the Text property of the Range object... </p>\n\n<pre><code>rng.Text == String.Empty\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4551007, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8f3a1399127393e9f27ec18343fde7b?s=128&d=identicon&r=PG&f=1", "display_name": "kPuck", "link": "https://stackoverflow.com/users/4551007/kpuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7485, "favorite_count": 0, "accepted_answer_id": 28439020, "answer_count": 3, "score": 3, "last_activity_date": 1597269207, "creation_date": 1423581680, "last_edit_date": 1597269207, "question_id": 28435328, "link": "https://stackoverflow.com/questions/28435328/detect-blank-excel-cell-using-interop-excel-in-c", "title": "Detect blank Excel cell using interop.excel in C#", "body": "<p>I'm trying to parse text from an Excel doc in C#. The problem is that I can't find a way to detect (and ignore) blank cells.</p>\n<p>I'm using Microsoft.Office.Interop.Excel in Visual Studio 2010 C#. I can't skip blank cells so my program will consequentially store blank values.</p>\n<hr />\n<p>I have defined my woorksheet the following way:</p>\n<p><code>Excel.Application exApp = OpenExcel(); String mySheet = @&quot;C:\\sheet.xlsx&quot;; Excel.Workbook wb = exApp.Workbooks.Open(mySheet); Excel.Worksheet ws = wb.Sheets[1];</code></p>\n<p>I access my cells by <code>ws.Cells[row, col]</code>. And I've tried different approaches. To name a few:</p>\n<pre><code>ws.Cells[row, col].Value2 == null\nws.Cells[row, col].Value == null\nws.Cells[row, col].Value == &quot;&quot;\n</code></pre>\n<p>And also using the Range object explicitely\n<code>Excel.Range rng = ws.Cells[row, col]</code>\nTo use <code>rng.Value2</code></p>\n<p>Depending on which approach I use I get different errors, Exception from HRESULT: 0x800A03EC is one of them.</p>\n"}, {"tags": ["excel", "vba", "sap", "business-objects", "excel-addins"], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 454195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30723c3ee6848108ef9bd01a46effda?s=128&d=identicon&r=PG", "display_name": "osullivj", "link": "https://stackoverflow.com/users/454195/osullivj"}, "is_accepted": false, "score": 1, "last_activity_date": 1423581674, "creation_date": 1423581674, "answer_id": 28435326, "question_id": 28434869, "link": "https://stackoverflow.com/questions/28434869/sap-business-objects-financial-consolidation-excel-add-in-automation/28435326#28435326", "title": "SAP Business Objects Financial Consolidation Excel Add-In Automation", "body": "<p>Are the DLLs on the PATH? It may be that Excel can't load the DLLs that the XLL is dependent upon. Dependency Walker (depends.exe) is a handy tool for troubleshooting this kind of issue. </p>\n\n<p>Also, have you tried using File/Options/Addins to register the XLL, as well as VBA code?</p>\n"}], "owner": {"reputation": 11, "user_id": 4550817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90de3d67211b79c89f46864746bdb0e?s=128&d=identicon&r=PG&f=1", "display_name": "lglynn", "link": "https://stackoverflow.com/users/4550817/lglynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2225, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531319068, "creation_date": 1423580467, "last_edit_date": 1531319068, "question_id": 28434869, "link": "https://stackoverflow.com/questions/28434869/sap-business-objects-financial-consolidation-excel-add-in-automation", "title": "SAP Business Objects Financial Consolidation Excel Add-In Automation", "body": "<p>I have a SAP Business Objects Web 7.5 Add-in in Excel 2007.</p>\n\n<p>The add in itself is made up of a compiled <code>.xll</code> file (<code>CtExcelLinksWeb.xll</code>) and a number of dll's. </p>\n\n<p>A bit of vba shows the xll is registered, and all of its registered functions.</p>\n\n<p>However, when I try to use one of these functions in VBA using <code>Application.Run()</code>, I get </p>\n\n<pre><code>Runtime 1004 - Macro may not be available or may be disabled.\n</code></pre>\n\n<p>I have tried registering the xll within the same <code>sub (Application.RegisterXLL ())</code> and upon registering a VBAProject called <code>CtEmpty.csv</code> is created</p>\n\n<p>I want to be able to automate the use of this add-in using VBA as it does long winded repetitive tasks, and then I can work on figuring out how to use the functions</p>\n\n<p>Any help will be appreciated</p>\n"}, {"tags": ["vba", "vbscript", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1423581517, "creation_date": 1423581517, "answer_id": 28435263, "question_id": 28434838, "link": "https://stackoverflow.com/questions/28434838/vb-script-for-outlook-to-automatically-copy-the-file-contents-to-a-designated-fo/28435263#28435263", "title": "VB Script for Outlook to automatically copy the file contents to a designated folder with a particular sender or based on Subject?", "body": "<p>Yes, it can be implemented using VBA macros or creating an Outlook add-in. You can handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686(v=office.15).aspx\" rel=\"nofollow\">NewMailEx</a> event of the Application class where you can check out the Subject property and do whatever you need. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> in MSDN for more information. </p>\n"}], "owner": {"reputation": 384, "user_id": 1273352, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b845d48ac9645253a82ca004b651ec1e?s=128&d=identicon&r=PG", "display_name": "g90uagk", "link": "https://stackoverflow.com/users/1273352/g90uagk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593156902, "creation_date": 1423580384, "last_edit_date": 1593156902, "question_id": 28434838, "link": "https://stackoverflow.com/questions/28434838/vb-script-for-outlook-to-automatically-copy-the-file-contents-to-a-designated-fo", "title": "VB Script for Outlook to automatically copy the file contents to a designated folder with a particular sender or based on Subject?", "body": "<p>I am a newbie to VB Scripting, what I have been trying to do is as soon as i receive a mail in Outlook from a particular sender or a particular message in the Subject line, I should copy the contents of the specified File location to other specified location \nIs this feasible?</p>\n"}, {"tags": [".net", "vba", "vsto", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": true, "score": 1, "last_activity_date": 1423580359, "creation_date": 1423580359, "answer_id": 28434832, "question_id": 28434804, "link": "https://stackoverflow.com/questions/28434804/how-to-action-an-event-in-word-from-another-net-application-using-vsto/28434832#28434832", "title": "How to action an event in Word from another .NET application using VSTO", "body": "<p>Sure, you would just call <code>MyDoc.Module1.SomeMethod</code> directly.</p>\n"}, {"tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1423584816, "last_edit_date": 1495535194, "creation_date": 1423584816, "answer_id": 28436390, "question_id": 28434804, "link": "https://stackoverflow.com/questions/28434804/how-to-action-an-event-in-word-from-another-net-application-using-vsto/28436390#28436390", "title": "How to action an event in Word from another .NET application using VSTO", "body": "<p>I don't have enough rep to comment, but this is a duplicate of:\n<a href=\"https://stackoverflow.com/questions/9261634/call-vba-addin-macro-from-vsto-powerpoint-ribbon\">Call VBA AddIn macro from VSTO PowerPoint Ribbon</a></p>\n\n<p>I can also confirm that I have used this exact code in my application successfully.</p>\n\n<pre><code>private void RunMacro(object oApp, object[] oRunArgs)\n{\n   oApp.GetType().InvokeMember(\"Run\",\n   System.Reflection.BindingFlags.Default |\n   System.Reflection.BindingFlags.InvokeMethod,\n   null, oApp, oRunArgs);\n}\n</code></pre>\n\n<p>Called like this:</p>\n\n<pre><code>Globals.ThisAddIn.RunMacro(Globals.ThisAddIn.Application , new object[] {\"VBA macro name\"});\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4437127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61586783d236dc9da21785aff35c55d?s=128&d=identicon&r=PG&f=1", "display_name": "nelb", "link": "https://stackoverflow.com/users/4437127/nelb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 28434832, "answer_count": 2, "score": 0, "last_activity_date": 1441564299, "creation_date": 1423580302, "last_edit_date": 1441564299, "question_id": 28434804, "link": "https://stackoverflow.com/questions/28434804/how-to-action-an-event-in-word-from-another-net-application-using-vsto", "title": "How to action an event in Word from another .NET application using VSTO", "body": "<p>I\u2019m working on a project that involves migrating a VBA macro-enabled Word document to a VSTO document-level customization. We have a .NET application which is currently able to action the Word VBA macros using Word Interop.</p>\n\n<p>Below is an example line of code in our .NET application which is used to call a macro, SomeMethod, within the macro-enabled document:</p>\n\n<pre><code>Word.Application.Application.Run(MacroName:=\"MyDoc.Module1.SomeMethod\")\n</code></pre>\n\n<p>Is there a way in which  we can replicate this with the VSTO document-level customization?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423580908, "post_id": 28434748, "comment_id": 45200031, "body": "Are you certain that the variables <code>sortStart</code> and <code>sortEnd</code> return the correct beginning and end rows?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1423581298, "post_id": 28434748, "comment_id": 45200367, "body": "In your <code>.Sort</code> line, preface every Range with a . so that it is <code>.Range(..</code> and inherits the proper workbook and worksheet from your <code>With</code> statement.  Otherwise it will try to use a range that is from a worksheet that doesn&#39;t exist in the <code>nfmBook</code> and that it what is causing the error."}], "answers": [{"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1423582456, "post_id": 28435368, "comment_id": 45201205, "body": "This code still has the same problem where the Key1 and Key2 ranges aren&#39;t qualified to the appropriate workbook and sheet.  As such the code will try to use the <code>ActiveSheet</code> which will likely cause the same error"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": true, "score": 1, "last_activity_date": 1423583926, "last_edit_date": 1423583926, "creation_date": 1423581814, "answer_id": 28435368, "question_id": 28434748, "link": "https://stackoverflow.com/questions/28434748/excel-vba-selecting-range-in-different-workbook-in-order-to-sort/28435368#28435368", "title": "Excel VBA Selecting Range in different workbook in order to sort", "body": "<p>Have you tryed this way? (UPDATED)</p>\n\n<pre><code>Set SortRange = nfmBook.Sheets(\"Reading NFM\").Range(\"B\" &amp; SortStart &amp; \":K\" &amp; SortEnd)\nSortRange.Sort Key1:=SortRange.Cells(1, 1), Order1:=xlAscending, _\nKey2:=SortRange.Cells(1, 10), Order2:=xlAscending, Header:=xlNo, _\nOrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\nDataOption1:=xlSortTextAsNumbers, DataOption2:=xlSortTextAsNumbers\n</code></pre>\n\n<p>SortRange.Cells(1, 1) is the first cell of the first row of the range = \"B\" &amp; SortStart</p>\n\n<p>SortRange.Cells(1, 10)  is the tenth cell of the first row of the range = \"K\" &amp; SortStart</p>\n\n<p>I hope this works (for me it worked)</p>\n"}], "owner": {"reputation": 3, "user_id": 4550862, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eHKwxMHqcHE/AAAAAAAAAAI/AAAAAAAAAHI/kYJ9DQ5Gbhw/photo.jpg?sz=128", "display_name": "Tom Paulk", "link": "https://stackoverflow.com/users/4550862/tom-paulk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1550, "favorite_count": 0, "accepted_answer_id": 28435368, "answer_count": 1, "score": 0, "last_activity_date": 1423583926, "creation_date": 1423580153, "question_id": 28434748, "link": "https://stackoverflow.com/questions/28434748/excel-vba-selecting-range-in-different-workbook-in-order-to-sort", "title": "Excel VBA Selecting Range in different workbook in order to sort", "body": "<p>and first let me thank everyone at stackoverflow.  Google has led me to this forum many times in my search for solutions to Excel VBA problems and I have usually found what I needed here.  That said,</p>\n\n<p>I am in the process of building a macro or set of macros that take selected data from one spreadheet and copies it to another worksheet in a newly created workbook.  I'm down to the last piece of the puzzle of sorting specific ranges and keep getting a Run Time Error '1004' when trying to select a specific range in the new workbook which I then want to sort.  I have tried multiple solutions both using code similar to the sample below as well as using Cells to define the range.  I have exausted Google at this point in my search for a solution.</p>\n\n<pre><code>With nfmBook.Worksheets(\"Reading NFM\")\nnfmBook.Sheets(\"Reading NFM\").Activate\nnfmBook.Sheets(\"Reading NFM\").Select\n\nnfmBook.Sheets(\"Reading NFM\").Range(\"B\" &amp; sortStart &amp; \":K\" &amp; sortEnd).Select\n\nSelection.Sort Key1:=Range(\"B\"), Order1:=xlAscending, Key2:=Range(\"K\") _\n    , Order2:=xlAscending, Header:=xlNo, OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortTextAsNumbers, DataOption2 _\n    :=xlSortTextAsNumbers\n\n    Cells(nfmRow, 11).Select\n    ActiveCell.FormulaR1C1 = \"=SUM(Cells(sortStart,11),Cells(sortEnd,11))\"\n\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "validation", "excel"], "comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1423580335, "post_id": 28434576, "comment_id": 45199595, "body": "I don&#39;t see the benefit of having duplicate values in the drop down list. You can delete duplicates. Problem is there is no direct way to get what you are trying to do. That property does not exist"}, {"owner": {"reputation": 3, "user_id": 2529206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a80add8b61cb8a16a5ce69b00a7eaf7a?s=128&d=identicon&r=PG", "display_name": "Dero", "link": "https://stackoverflow.com/users/2529206/dero"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1423580615, "post_id": 28434576, "comment_id": 45199818, "body": "Ok that was I though... I find a very benefit way of having duplicate values but it is not the main purpose of validation list so I understand why this property doesn&#39;t exist. Thank you Jeanno !"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1423580709, "post_id": 28434576, "comment_id": 45199890, "body": "I was just going to say that Excel has  a built-in capability to delete duplicates from very long lists"}, {"owner": {"reputation": 3, "user_id": 2529206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a80add8b61cb8a16a5ce69b00a7eaf7a?s=128&d=identicon&r=PG", "display_name": "Dero", "link": "https://stackoverflow.com/users/2529206/dero"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1423581120, "post_id": 28434576, "comment_id": 45200216, "body": "Actually, i might have the same value in a list because I build one list from multiple collumns (forming a tree of value). And deepness of tree is made with spaces."}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1423586570, "post_id": 28434576, "comment_id": 45203995, "body": "So the duplicates are children of different parents in the tree? If so, then Gary&#39;s Student&#39;s answer is right, you won&#39;t be able to tell. You would have to find a way to make the item unique. (i.e. include the parent in the child name - parent1:child, parent2:child)"}, {"owner": {"reputation": 3, "user_id": 2529206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a80add8b61cb8a16a5ce69b00a7eaf7a?s=128&d=identicon&r=PG", "display_name": "Dero", "link": "https://stackoverflow.com/users/2529206/dero"}, "edited": false, "score": 0, "creation_date": 1423645045, "post_id": 28434576, "comment_id": 45228161, "body": "Yep that what I though... Sadly my list would look terrible but it migh be the only solution. Thanks guys !"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1423583644, "last_edit_date": 1423583644, "creation_date": 1423583338, "answer_id": 28435892, "question_id": 28434576, "link": "https://stackoverflow.com/questions/28434576/get-the-id-of-the-selected-value-in-a-dropdown-validation-list-on-excel-in-vba/28435892#28435892", "title": "Get the id of the selected value in a dropdown validation list on Excel in VBA", "body": "<p>Sadly, once you have used <em>DV</em> to fill a cell with <strong>junk,</strong> there is no way to tell which piece of <strong>junk</strong> you picked:</p>\n\n<p><img src=\"https://i.stack.imgur.com/WhZ9d.png\" alt=\"enter image description here\"></p>\n\n<p>You would have to pad each piece of <strong>junk</strong> with a different number of blanks.</p>\n"}], "owner": {"reputation": 3, "user_id": 2529206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a80add8b61cb8a16a5ce69b00a7eaf7a?s=128&d=identicon&r=PG", "display_name": "Dero", "link": "https://stackoverflow.com/users/2529206/dero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 0, "accepted_answer_id": 28435892, "answer_count": 1, "score": 0, "last_activity_date": 1423645398, "creation_date": 1423579704, "last_edit_date": 1423645398, "question_id": 28434576, "link": "https://stackoverflow.com/questions/28434576/get-the-id-of-the-selected-value-in-a-dropdown-validation-list-on-excel-in-vba", "title": "Get the id of the selected value in a dropdown validation list on Excel in VBA", "body": "<p>Using Excel, lets say I have a validation list made of 5 values like this one :</p>\n\n<pre><code>Patate\nTomate\nCourgette\nConcombre\nPatate\n</code></pre>\n\n<p>In a cell containing a drop down list made of these 5 value, I select the fifth value : \"Patate\". \nI want to get in VBA that this cell contains the 5th value of my validation list. Something like :</p>\n\n<blockquote>\n  <p>x = Cell.Validation.GetIDValueSelected</p>\n  \n  <p>x = 5</p>\n</blockquote>\n\n<p>I can't use Vertical search because I might have 2 or even more time the same value in my list (too long to explain why). \nThis list is also dynamics (depending of another sheets) so it doesn't always contains 5 values.</p>\n\n<p>I hope I made it clear for everyone to understand my needs but I will be glad to add more information if needed. \nThank you for your time. </p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1423714202, "post_id": 28434341, "comment_id": 45263360, "body": "Stand alone charts are not worksheets, they are chart sheets, or simply charts. That is why @tendim&#39;s answer works."}], "answers": [{"comments": [{"owner": {"reputation": 292, "user_id": 4412568, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7295287cc77cbff681a4f4403d80c26?s=128&d=identicon&r=PG", "display_name": "tendim", "link": "https://stackoverflow.com/users/4412568/tendim"}, "reply_to_user": {"reputation": 157, "user_id": 4550878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969f87664f6bbd23850a9cbec8e92183?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/4550878/david"}, "edited": false, "score": 0, "creation_date": 1431121421, "post_id": 28434639, "comment_id": 48376541, "body": "Not a problem; always glad to help!"}], "tags": [], "owner": {"reputation": 292, "user_id": 4412568, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f7295287cc77cbff681a4f4403d80c26?s=128&d=identicon&r=PG", "display_name": "tendim", "link": "https://stackoverflow.com/users/4412568/tendim"}, "is_accepted": true, "score": 1, "last_activity_date": 1423579826, "creation_date": 1423579826, "answer_id": 28434639, "question_id": 28434341, "link": "https://stackoverflow.com/questions/28434341/loop-through-chart-objects-in-excel-workbook/28434639#28434639", "title": "Loop through Chart objects in Excel workbook", "body": "<p>I've just tried a quick test with this code, and it printed the <code>Chart</code> worksheets:</p>\n\n<pre><code>Public Sub test()\n    Dim oChart As Chart\n\n    For Each oChart In ActiveWorkbook.Charts\n        Debug.Print oChart.Name\n    Next\nEnd Sub\n</code></pre>\n\n<p>That should do what you need.  FYI a good place to start is with the VBA object browser, <code>View -&gt; Object Browser</code> or F11 in the Excel Visual Basic Editor.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 157, "user_id": 4550878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969f87664f6bbd23850a9cbec8e92183?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/4550878/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2532, "favorite_count": 0, "accepted_answer_id": 28434639, "answer_count": 1, "score": 0, "last_activity_date": 1423579826, "creation_date": 1423579031, "question_id": 28434341, "link": "https://stackoverflow.com/questions/28434341/loop-through-chart-objects-in-excel-workbook", "title": "Loop through Chart objects in Excel workbook", "body": "<p>I have seen plenty of code that loops through's in an individual worksheet, however I am trying to loop through charts that are individual sheets in the workbook.  My code is as follows (as you can see I am simply trying to save the charts as PDFs):</p>\n\n<pre><code>Sub ExportAllCharts()\nDim Current As Worksheet\n\n' Loop through all of the worksheets in the active workbook.\nFor Each Current In Worksheets\n\n   If TypeName(Current) = \"Chart\" Then\n       objCht.ExportAsFixedFormat xlTypePDF, Filename:= _\n               \"c:/\" &amp; Current.Name, Quality:=xlQualityStandard, _\n               IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n   End If\n\nNext\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, when the code loops through all the sheets in the workbook, for some reason it is skipping the charts. Is there an equivalent to <code>Worksheets</code> that applies to individual charts in Excel? Or is there perhaps another way of doing this that I haven't thought of?</p>\n\n<p>Thanks!\nDavid</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1, "user_id": 4550795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b467ef9865df928b186727f9e40cd8?s=128&d=identicon&r=PG&f=1", "display_name": "\u0415\u0430\u0433\u0435\u043d\u0438\u0439 \u041c\u0435\u043b\u0435\u043d\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/4550795/%d0%95%d0%b0%d0%b3%d0%b5%d0%bd%d0%b8%d0%b9-%d0%9c%d0%b5%d0%bb%d0%b5%d0%bd%d1%86%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1423584809, "post_id": 28434082, "comment_id": 45202783, "body": "Is the target workbook protected, or a different format (e.g. xls versus xlsx)?"}, {"owner": {"reputation": 1, "user_id": 4550795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b467ef9865df928b186727f9e40cd8?s=128&d=identicon&r=PG&f=1", "display_name": "\u0415\u0430\u0433\u0435\u043d\u0438\u0439 \u041c\u0435\u043b\u0435\u043d\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/4550795/%d0%95%d0%b0%d0%b3%d0%b5%d0%bd%d0%b8%d0%b9-%d0%9c%d0%b5%d0%bb%d0%b5%d0%bd%d1%86%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1423596329, "post_id": 28434082, "comment_id": 45209743, "body": "i think its different format...do you think its causing an issue?"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1423578352, "creation_date": 1423578352, "answer_id": 28434082, "question_id": 28433994, "link": "https://stackoverflow.com/questions/28433994/copy-sheet-from-one-workbook-to-another-workbook/28434082#28434082", "title": "Copy sheet from one workbook to another workbook", "body": "<p>You don't add a sheet and then try and copy your sheet to that sheet - you just copy the original sheet to the target workbook:</p>\n\n<pre><code>Sub test()\n    dim wbNew as workbook 'destination workbook\n    Set wbNew = Workbooks.Open(Me.fileDestPathTextBox.Value)\n\n\n    wb.Sheets(\"Souce Sheet\").Copy After:=wbNew.Sheets(wbNew.Sheets.Count)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4550795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b467ef9865df928b186727f9e40cd8?s=128&d=identicon&r=PG&f=1", "display_name": "\u0415\u0430\u0433\u0435\u043d\u0438\u0439 \u041c\u0435\u043b\u0435\u043d\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/4550795/%d0%95%d0%b0%d0%b3%d0%b5%d0%bd%d0%b8%d0%b9-%d0%9c%d0%b5%d0%bb%d0%b5%d0%bd%d1%86%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1423578352, "creation_date": 1423578140, "question_id": 28433994, "link": "https://stackoverflow.com/questions/28433994/copy-sheet-from-one-workbook-to-another-workbook", "title": "Copy sheet from one workbook to another workbook", "body": "<p>I need to take (copy) sheet from one workbook and append it to the end of existing excel document. I wrote this code but it doesnt work and gives an error. Please help =)</p>\n\n<pre><code>Public wb As Workbook 'workbook with the source sheet\nSub test()\n    dim wbNew as workbook 'destination workbook\n    Set wbNew = Workbooks.Open(Me.fileDestPathTextBox.Value)\n\n    wbNew.Sheets.Add After:=wbNew.Sheets(wbNew.Sheets.Count).Name = Me.sheetNameTextBox.Value\n    wb.Sheets(\"Souce Sheet\").Copy wbNew.Sheets(Me.sheetNameTextBox.Value)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423587023, "post_id": 28433728, "comment_id": 45204352, "body": "This is not an answer, but generally speaking, not good to rely on <code>Select</code>, see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">here</a> for a good explanation.  Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423586963, "post_id": 28434016, "comment_id": 45204304, "body": "Or <code>Sheet2.Select</code> to refer to the sheet by its <code>.CodeName</code> property."}], "tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 1, "last_activity_date": 1423578195, "creation_date": 1423578195, "answer_id": 28434016, "question_id": 28433728, "link": "https://stackoverflow.com/questions/28433728/runtime-error-13-type-mismatch-excel-2007/28434016#28434016", "title": "runtime error 13 type mismatch excel 2007", "body": "<p>Your sheet is not named correctly:</p>\n\n<p>Change <code>Sheets(Sheet2).Select</code> to <code>Sheets(\"Sheet2\").Select</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3936883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d84a2c39121d43077fb8502e87b2d18?s=128&d=identicon&r=PG&f=1", "display_name": "ele", "link": "https://stackoverflow.com/users/3936883/ele"}, "is_accepted": false, "score": 0, "last_activity_date": 1423578651, "creation_date": 1423578651, "answer_id": 28434202, "question_id": 28433728, "link": "https://stackoverflow.com/questions/28433728/runtime-error-13-type-mismatch-excel-2007/28434202#28434202", "title": "runtime error 13 type mismatch excel 2007", "body": "<p>The error is the argument of the property Sheet. The argument must be an index.</p>\n\n<p>To select the sheet number 2, you can write \n    <code>Sheets(2).Select</code>  or     <code>Sheets(\"Sheet2\").select</code></p>\n"}], "owner": {"reputation": 11, "user_id": 4550781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a465da6e984e12c61455985faa20e198?s=128&d=identicon&r=PG&f=1", "display_name": "Greatness Mness", "link": "https://stackoverflow.com/users/4550781/greatness-mness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423578974, "creation_date": 1423577382, "last_edit_date": 1423578974, "question_id": 28433728, "link": "https://stackoverflow.com/questions/28433728/runtime-error-13-type-mismatch-excel-2007", "title": "runtime error 13 type mismatch excel 2007", "body": "<p>I am currently learning to code in excel VBA and I wrote the following code but when I run it, I get a runtime error 13 type mismatch. Any Ideas</p>\n\n<pre><code>Sub dennis()\nSheets(Sheet2).Select\nRange(\"E1\").Select\n\nDo Until Selection.Offset(0, -4).Value = \"\"\n\nSelection.Value = Selection.Offset(0, -4).Value &amp; \" \" &amp; Selection.Offset(0, -3).Value\nSelection.Offset(1, 0).Select\nLoop\nRange(\"F1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423577357, "post_id": 28433580, "comment_id": 45197406, "body": "Related: <a href=\"http://stackoverflow.com/q/21585612/11683\">Argument type validation in the Function Wizard</a>"}, {"owner": {"reputation": 111, "user_id": 3704628, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c2abdc44ed76ccad6a345437fd8b3fd4?s=128&d=identicon&r=PG&f=1", "display_name": "user3704628", "link": "https://stackoverflow.com/users/3704628/user3704628"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423577540, "post_id": 28433580, "comment_id": 45197540, "body": "@GSerg Thanks I couldn&#39;t add the photo with my reputation"}], "owner": {"reputation": 111, "user_id": 3704628, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c2abdc44ed76ccad6a345437fd8b3fd4?s=128&d=identicon&r=PG&f=1", "display_name": "user3704628", "link": "https://stackoverflow.com/users/3704628/user3704628"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1423577135, "creation_date": 1423576960, "last_edit_date": 1531161705, "question_id": 28433580, "link": "https://stackoverflow.com/questions/28433580/how-to-give-a-list-of-choice-for-a-parameter-in-a-user-define-function-udf-in", "title": "How to give a list of choice for a parameter in a User Define Function (UDF) in Excel", "body": "<p>Here is somewhat what I wan't to do. I wan't to offer a list for user to chose for for many parameters. How is that done? This is in the formula wizard.</p>\n\n<p>An image is worth a 1000 words:\n<img src=\"https://i.stack.imgur.com/WZ5Bh.png\" alt=\"enter image description here\"></p>\n\n<p>A line of code would be much appreciated.</p>\n\n<p>Is there maybe a call-back function to be set when someone clicks a parameter in the formula wizard?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1423579098, "creation_date": 1423579098, "answer_id": 28434361, "question_id": 28433264, "link": "https://stackoverflow.com/questions/28433264/macro-to-open-new-workbook-and-close-current-if-higher-version-is-available-in-s/28434361#28434361", "title": "macro to open new workbook and close current if higher version is available in share drive", "body": "<p>This will work for you. However for future references you will need to show what you have tried. You are not always going to find people to write a code for you</p>\n\n<pre><code>   Sub CheckVersion() 'This will only work if we your file name format is exactly as you had decribed \"Helpdesk x.x\"\n        Dim sharedFolder As String, myFile As String\n        sharedFolder = \"\\\\mySharedDrivePath\\Documents\" 'Change to whatever is your case\n        myFile = Dir(sharedFolder &amp; \"\\*.xlsx\")\n        Dim rex As New RegExp\n        rex.Pattern = \"Helpdesk (\\d+\\.\\d+)\"\n        Do While myFile &lt;&gt; \"\"\n            If CDbl(rex.Execute(ThisWorkbook.Name)(0).SubMatches(0)) &lt; CDbl(rex.Execute(myFile)(0).SubMatches(0)) Then\n                msg1 = MsgBox(\"Newer Version found \" &amp; rex.Execute(myFile)(0).SubMatches(0), vbYesNo, \"Open newer version?\")\n                If msg1 = vbYes Then\n                    Workbooks.Open (myFile)\n                    ThisWorkbook.Close\n                End If\n            End If\n            myFile = Dir\n        Loop\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4154822, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KFXnobQ0WwE/AAAAAAAAAAI/AAAAAAAAA5M/kyR6fegs9vk/photo.jpg?sz=128", "display_name": "Arun Yadav", "link": "https://stackoverflow.com/users/4154822/arun-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423887098, "creation_date": 1423576056, "last_edit_date": 1423887098, "question_id": 28433264, "link": "https://stackoverflow.com/questions/28433264/macro-to-open-new-workbook-and-close-current-if-higher-version-is-available-in-s", "title": "macro to open new workbook and close current if higher version is available in share drive", "body": "<p>My team use a workbook from shared drive which is in read only mode for them for updtaes.\nworkbok name has last 3 digits as version of workbook i.e \" Helpdesk 1.1\"\nI am looking for a code whcih will find in share drive if any higher version is available in share drive from where this workbook was open and if macro finds any workbook with name Helpdesk 1.2 it should give a msg box saying \" A higher Version is Available, Do you want to open that\".\nIf we say yes it should close current workbook and open new version i.e Helpdesk 1.2.\nI tried a lot to write such code however nothing is working.\nCan anyone help me on this please.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 1, "last_activity_date": 1423584734, "creation_date": 1423584734, "answer_id": 28436364, "question_id": 28432598, "link": "https://stackoverflow.com/questions/28432598/zero-rows-are-returned-after-filter-is-applied-in-vba/28436364#28436364", "title": "Zero rows are returned after filter is applied in VBA", "body": "<p>Try this:    </p>\n\n<pre><code>numberOfRows = Range(Selection, Selection.End(xlUp)).SpecialCells(xlCellTypeVisible).Count - 1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2372131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ab3877f6b9b13dceba3f42b5a06420?s=128&d=identicon&r=PG", "display_name": "Zykros", "link": "https://stackoverflow.com/users/2372131/zykros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423584734, "creation_date": 1423574005, "question_id": 28432598, "link": "https://stackoverflow.com/questions/28432598/zero-rows-are-returned-after-filter-is-applied-in-vba", "title": "Zero rows are returned after filter is applied in VBA", "body": "<p>I have 5 columns and when i apply filter on the field 1 and 2, it return different number of rows depending on the criteria.\nI am using the following code</p>\n\n<pre><code>numberOfRows = Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Count - 1\n</code></pre>\n\n<p>But this doesnt work when 0 rows are returned. It gives 1 million odd as an answer.\nHow do I deal with this?</p>\n"}, {"tags": ["date", "excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423574121, "post_id": 28432561, "comment_id": 45195263, "body": "The actual <i>value</i> of the cell is probably correct, I imagine it&#39;s a regional formatting problem. Your code only checks if the cell&#39;s value is a valid date - it doesn&#39;t check the actual format of that date."}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423574496, "post_id": 28432561, "comment_id": 45195505, "body": "@SO How I can come out of those cells locked from editing?  I have validations for few other columns; there I am able to edit the erroneous entries."}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423641617, "post_id": 28432561, "comment_id": 45226571, "body": "@SO Sir, Can you please elaborate the term <code>regional formatting problem</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423644546, "post_id": 28432561, "comment_id": 45227913, "body": "Excel has a habit of forcing the American date format (mm/dd/yyyy) when the dates have been imported from another data source. So if the day in your date happens to be 1 - 12, then Excel will switch the date to mm/dd/yyyy. Where are your dates coming from? If they are imported from a text file, there is an option in the VBA code to apply regional format which corrects this problem."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1423644688, "post_id": 28432561, "comment_id": 45227985, "body": "Your code uses <code>IsDate()</code> but this only checks that the cell contains a date of any kind, regardless of format. Dates are stored as a <code>Long</code> or <code>Double</code> data type depending on the type of date you&#39;re working with, and so the actual <i>value</i> of the date could be correct, it may be that Excel is just formatting in incorrectly - so I doubt this is anything to do with cells being protected/locked."}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423664627, "post_id": 28432561, "comment_id": 45239935, "body": "I tried by changing format category to <code>&#39;text&#39;</code> from <code>&#39;date&#39;</code>. and code works fine. :)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1423670327, "post_id": 28432561, "comment_id": 45243791, "body": "Right click and use paste special &gt; formats or use the <code>Range.PasteSpecial()</code> method"}], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "is_accepted": true, "score": 1, "last_activity_date": 1423823484, "creation_date": 1423823484, "answer_id": 28497528, "question_id": 28432561, "link": "https://stackoverflow.com/questions/28432561/excel-vba-date-cells-automatically-change-back-to-regional-date-format/28497528#28497528", "title": "Excel VBA - Date Cells automatically change back to Regional Date Format", "body": "<p>This happened due to 'Regional formatting problem'</p>\n\n<p>I changed number format of dates from 'date' format category to 'text' and now am able to correct the erroneous date cells.</p>\n"}], "owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 28497528, "answer_count": 1, "score": 0, "last_activity_date": 1425479998, "creation_date": 1423573885, "last_edit_date": 1531164843, "question_id": 28432561, "link": "https://stackoverflow.com/questions/28432561/excel-vba-date-cells-automatically-change-back-to-regional-date-format", "title": "Excel VBA - Date Cells automatically change back to Regional Date Format", "body": "<p>I need to do validation in the active sheet. </p>\n\n<p>The columns - Q, AA, AI, AS, BH and BI should be in Date format mm/dd/yyyy.</p>\n\n<p>If those are not in mm/dd/yyyy format; then the cells are to be colored in Red Background and those entries to be sent to \"Observations\" Sheet in the same Excel Workbook as hyperlinks.</p>\n\n<p>(Apart from it I have few other requirements.)</p>\n\n<p>For all those I have the following code.</p>\n\n<pre><code>Dim celArray, arr, Key1, KeyCell, celadr, celval, cell6 As Variant\n\n\n    celArray = (\"Q,AA,AI,AS,BI,BH\")\n    arr = Split(celArray, \",\")\n    For Key1 = LBound(arr) To UBound(arr)\n    KeyCell = arr(Key1)\n    Range(KeyCell &amp; \"2:\" &amp; KeyCell &amp; \"\" &amp; LastRow).Select\n\n    ''Selection.Clearformats\n'    Selection.TextToColumns Destination:=Range(KeyCell &amp; \"2\"), DataType:=xlDelimited, _\n'        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n'        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n'        :=Array(1, 3), TrailingMinusNumbers:=True\n'    Columns(KeyCell &amp; \":\" &amp; KeyCell).NumberFormat = \"mm/dd/yyyy\"\n\n\n    For Each cell6 In Selection\n        celadr = cell6.Address\n        celval = cell6.Value '\n        If Len(celval) &gt; 1 Then\n\n    Dim fistby As Integer\n    Dim secby As Integer\n    Dim tmpdte As Integer\n    Dim tmpyr As Integer\n    Dim tmpmth As Integer\n\n   '       If KeyCell = \"Q\" Then\n   '        Debug.Print celadr\n   '       End If\n\n\n        If IsDate(celval) Then\n            If KeyCell &lt;&gt; \"BI\" And KeyCell &lt;&gt; \"BH\" Then\n                If Range(celadr).Offset(0, 1).Value &lt;&gt; \"\" Or Range(celadr).Offset(0, 2).Value &lt;&gt; \"\" Or _\n                Range(celadr).Offset(0, 3).Value &lt;&gt; \"\" Or Range(celadr).Offset(0, 4).Value &lt;&gt; \"\" Or _\n                Range(celadr).Offset(0, 5).Value &lt;&gt; \"\" Or Range(celadr).Offset(0, 6).Value &lt;&gt; \"\" Or _\n                Range(celadr).Offset(0, 7).Value &lt;&gt; \"\" Then\n                     Range(celadr &amp; \":\" &amp; Range(celadr).Offset(0, 7).Address).Interior.Color = vbRed\n                     shname = ActiveSheet.Name\n                     Sheets(\"Observations\").Range(\"A65536\").End(xlUp).Offset(1, 0).Value = celval\n                     strstr = \"'\" &amp; shname &amp; \"'!\" &amp; Range(celadr).Address(0, 0)\n                     Sheets(\"Observations\").Hyperlinks.Add Anchor:=Sheets(\"Observations\").Range(\"A65536\").End(xlUp), Address:=\"\", SubAddress:= _\n                     strstr\n                End If\n            End If\n        End If\n\n        fistby = InStr(celval, \"/\")\n        secby = InStr(fistby + 1, celval, \"/\")\n\n    If fistby &lt;&gt; 0 Then\n        tmpdte = Mid(celval, fistby + 1, ((secby - 1) - fistby))\n        tmpmth = Left(celval, fistby - 1)\n        'tmpyr = Right(celval, 4)\n    End If\n\n    If KeyCell = \"Q\" Then\n        If fistby = 0 Or tmpmth &gt; 12 Or tmpdte &gt; 31 Then\n             Range(celadr).Interior.Color = vbRed\n             shname = ActiveSheet.Name\n             Sheets(\"Observations\").Range(\"A65536\").End(xlUp).Offset(1, 0).Value = celval\n             strstr = \"'\" &amp; shname &amp; \"'!\" &amp; Range(celadr).Address(0, 0)\n             Sheets(\"Observations\").Hyperlinks.Add Anchor:=Sheets(\"Observations\").Range(\"A65536\").End(xlUp), Address:=\"\", SubAddress:= _\n             strstr\n        Else\n        If (Len(celval) &lt;&gt; 7 + fistby Or Mid(celval, fistby, 1) &lt;&gt; \"/\" Or Mid(celval, secby, 1) &lt;&gt; \"/\") Or Range(celadr).Offset(0, 8).Value &lt;&gt; \"\" Then\n             Range(celadr).Interior.Color = vbRed\n             shname = ActiveSheet.Name\n             Sheets(\"Observations\").Range(\"A65536\").End(xlUp).Offset(1, 0).Value = celval\n             strstr = \"'\" &amp; shname &amp; \"'!\" &amp; Range(celadr).Address(0, 0)\n             Sheets(\"Observations\").Hyperlinks.Add Anchor:=Sheets(\"Observations\").Range(\"A65536\").End(xlUp), Address:=\"\", SubAddress:= _\n             strstr\n        End If\n    End If\n    Else\n    If fistby = 0 Or tmpmth &gt; 12 Or tmpdte &gt; 31 Then\n        Range(celadr).Interior.Color = vbRed\n        shname = ActiveSheet.Name\n        Sheets(\"Observations\").Range(\"A65536\").End(xlUp).Offset(1, 0).Value = celval\n        strstr = \"'\" &amp; shname &amp; \"'!\" &amp; Range(celadr).Address(0, 0)\n        Sheets(\"Observations\").Hyperlinks.Add Anchor:=Sheets(\"Observations\").Range(\"A65536\").End(xlUp), Address:=\"\", SubAddress:= _\n        strstr\n    Else\n    If (Len(celval) &lt;&gt; 7 + fistby Or Mid(celval, fistby, 1) &lt;&gt; \"/\" Or Mid(celval, secby, 1) &lt;&gt; \"/\") Then\n        Range(celadr).Interior.Color = vbRed\n        shname = ActiveSheet.Name\n        Sheets(\"Observations\").Range(\"A65536\").End(xlUp).Offset(1, 0).Value = celval\n        strstr = \"'\" &amp; shname &amp; \"'!\" &amp; Range(celadr).Address(0, 0)\n\n        Dim adrr As Variant\n        adrr = Sheets(\"Observations\").Range(\"A65536\").End(xlUp).Address\n        End If\n        End If\n        End If\n        End If\n    Next cell6\n    'Columns(KeyCell &amp; \":\" &amp; KeyCell).NumberFormat = \"mm/dd/yyyy\"\n    Next Key1\n</code></pre>\n\n<p>The above codes work fine and colors cells whichever have entries such as <strong>dd-mm-yyyy OR dd/mm/yyyy OR mm-dd-yyyy in Red Background</strong> and sends those entries to \"Observations\" sheet as hyperlinks.</p>\n\n<p>But problem is when I try to correct such erroneous entries to correct format - \"<strong>mm/dd/yyyy</strong>\" and re-run my vba code; I find that those cells are not corrected and are back in the original erroneous format.</p>\n\n<p>i.e. <strong>Am not able to edit the erroneous cells, though I don't have any code to protect the cells from editing</strong>.</p>\n\n<p>Can anyone tell where I am wrong - Or any improvements in the above code?</p>\n"}, {"tags": ["vba", "excel", "replace"], "answers": [{"tags": [], "owner": {"reputation": 1136, "user_id": 4319862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2zb2U.png?s=128&g=1", "display_name": "Barry O&#39;Kane", "link": "https://stackoverflow.com/users/4319862/barry-okane"}, "is_accepted": false, "score": 0, "last_activity_date": 1423575655, "creation_date": 1423575655, "answer_id": 28433133, "question_id": 28432404, "link": "https://stackoverflow.com/questions/28432404/replace-part-of-formula/28433133#28433133", "title": "Replace part of formula", "body": "<p>When you delete the sheet you delete that entity. Although you then create a new sheet with the same name it is not the same entity.</p>\n\n<p>So when you delete the sheet, formulas in other sheets referencing it lose that reference. Creating a new sheet with same name will never fix the links.</p>\n\n<p>Would it not be simpler to overwrite the data in the Base sheet, therefore preserving all the links and eliminating the issue entirely?</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 4470726, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1cb835f617af2b824d53695ac5f1dbe2?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4470726/kyle"}, "is_accepted": true, "score": 0, "last_activity_date": 1423577163, "creation_date": 1423577163, "answer_id": 28433655, "question_id": 28432404, "link": "https://stackoverflow.com/questions/28432404/replace-part-of-formula/28433655#28433655", "title": "Replace part of formula", "body": "<p>=SUM(INDIRECT(\"Base!AA:AA\"))</p>\n\n<p>INDIRECT takes a string argument, so you will not lose the reference when the sheet is deleted.</p>\n"}], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 28433655, "answer_count": 2, "score": 0, "last_activity_date": 1423577163, "creation_date": 1423573433, "last_edit_date": 1531164843, "question_id": 28432404, "link": "https://stackoverflow.com/questions/28432404/replace-part-of-formula", "title": "Replace part of formula", "body": "<p>my macro is deleting some spreadsheet (let's call it \"Base\") and replacing it with similar, same name and format, but with different data. There are formulas in other sheets which are refering to \"Base\" spreadsheet. This formulas, after execution of the macro, return #ADR! error, and formulas are changed, for example:</p>\n\n<pre><code>=SUM(Base!AA:AA)\n</code></pre>\n\n<p>becames:</p>\n\n<pre><code>=SUM(#ADR!AA:AA)\n</code></pre>\n\n<p>I want to replace \"#ADR\" with \"Base\" in every formula, to get rid of this error. One of apporaches which I have been trying is: </p>\n\n<pre><code>Selection.Replace What:=\"#ADR\", Replacement:=\"Base\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>but it doesn't work, even though when I am trying to do it manualy, using Ctrl+h shortcut, everything is perfect.</p>\n\n<p>How can I replace \"#ADR!\" with \"Base\" in every selected formula using a macro?</p>\n"}, {"tags": ["mysql", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1423569672, "post_id": 28430786, "comment_id": 45192659, "body": "Thanks, I think is better using &quot;in&quot;, isn&#39;t it?"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1423570213, "post_id": 28430786, "comment_id": 45192960, "body": "It has its advantage of being easier to debug and read, minimizing the long lines of code if there are larger data to be used. It is similar to a complex/compound OR. Just neater and simpler. Execution wise, I would still think IN is better. However I am not <b><i>100%</i></b> sure about it."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1423571416, "post_id": 28430786, "comment_id": 45193672, "body": "I would <code>... &amp; replace$(myArr(i, 1), &quot;&#39;&quot;, &quot;&#39;&#39;&quot;) &amp; ...</code> just to be safe from injection"}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 1, "last_activity_date": 1423568483, "creation_date": 1423568483, "answer_id": 28430786, "question_id": 28430558, "link": "https://stackoverflow.com/questions/28430558/mysql-query-to-get-records-having-id-contained-into-vba-array/28430786#28430786", "title": "MySql query to get records having id contained into vba array", "body": "<p>You could change the code to include the <strong>IN</strong> Operator, it will still loop, but not have several OR's</p>\n\n<pre><code>Dim inVar As String\nmyArr = Cells(1, 1).CurrentRegion.Value\n\nSqlStr = \"SELECT * FROM mytable WHERE id IN (\"\n\nFor i = 1 To UBound(myArr)\n    inVar = inVar &amp; \",'\" &amp; myArr(i, 1) &amp; \"'\"\nNext i\n\nSqlStr = SqlStr &amp; Right(inVar, Len(inVar) - 2) &amp; \")\"\n</code></pre>\n\n<p>The sequence would be like,</p>\n\n<p><code>SELECT * FROM myTable WHERE id IN ('1', '2')</code></p>\n"}], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 28430786, "answer_count": 1, "score": 0, "last_activity_date": 1423568483, "creation_date": 1423567807, "question_id": 28430558, "link": "https://stackoverflow.com/questions/28430558/mysql-query-to-get-records-having-id-contained-into-vba-array", "title": "MySql query to get records having id contained into vba array", "body": "<p>I write a MySql query with the code below to get records with ids contained in an array. </p>\n\n<p>It works, but is there any better way to do it ? (instead of multiple \"OR\")</p>\n\n<pre><code>myArr = Cells(1, 1).CurrentRegion.Value\nSqlStr = \"SELECT * FROM mytable WHERE id ='\"\nFor i = 1 To UBound(myArr)\n    SqlStr = SqlStr &amp; myArr(i, 1) &amp; \"' OR id ='\"\nNext i\nSqlStr = Left(SqlStr, Len(SqlStr) - 7)\n</code></pre>\n\n<p>I hope that the question is not silly: I'm trying to improve myself.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423568741, "post_id": 28430326, "comment_id": 45192187, "body": "add <a href=\"https://msdn.microsoft.com/en-us/library/ff840060(v=office.14).aspx\" rel=\"nofollow noreferrer\"><code>offset property</code></a> where required."}, {"owner": {"reputation": 1, "user_id": 4550066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eccc18ea6805f1f3498ae76e2373813?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Farrand", "link": "https://stackoverflow.com/users/4550066/matthew-farrand"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423570474, "post_id": 28430326, "comment_id": 45193125, "body": "Thank you for your assistance"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1423571127, "creation_date": 1423571127, "answer_id": 28431657, "question_id": 28430326, "link": "https://stackoverflow.com/questions/28430326/select-and-copy-row-directly-above-matching-value/28431657#28431657", "title": "Select and copy row directly above matching value", "body": "<p>Here is one way to copy the row directly above the <em>ActiveCell</em> to the next open row of another worksheet:</p>\n\n<pre><code>Sub Dural()\n    Dim sh2 As Worksheet, N As Long\n    Set sh2 = Sheets(\"Destynation\")\n    N = sh2.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n    If ActiveCell.Row = 1 Then\n        MsgBox \"Nothing above\"\n        Exit Sub\n    End If\n\n    ActiveCell.Offset(-1, 0).EntireRow.Copy sh2.Cells(N, 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4550066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eccc18ea6805f1f3498ae76e2373813?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Farrand", "link": "https://stackoverflow.com/users/4550066/matthew-farrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423571127, "creation_date": 1423567077, "last_edit_date": 1531164843, "question_id": 28430326, "link": "https://stackoverflow.com/questions/28430326/select-and-copy-row-directly-above-matching-value", "title": "Select and copy row directly above matching value", "body": "<p>I have a working code that looks for a value and copies the entire row, pasting it to the relevant sheet.</p>\n\n<p>I would like to amend the code, so that it copies the entire row above the found value, rather than the row of the value.  </p>\n\n<p>Can anyone suggest a simple amendment to allow me to select the row above?</p>\n\n<pre><code>Sub Prod()\nSheets(\"BJ\").Cells.Clear\nSheets(\"Master\").Range(\"A1:A2\").EntireRow.Copy Destination:= _\nSheets(\"BJ\").Range(\"A1\")\nDim MyRange, MyRange1 As Range\nSheets(\"Master\").Select\nLastRow = Sheets(\"Master\").Range(\"K65536\").End(xlUp).Row\nSet MyRange = Sheets(\"Master\").Range(\"M1:Q325\" &amp; LastRow)\nFor Each c In MyRange\nIf c.Value = \"BJ\" Then\nIf MyRange1 Is Nothing Then\nSet MyRange1 = c.EntireRow\nElse\nSet MyRange1 = Union(MyRange1, c.EntireRow)\nEnd If\nEnd If\nNext\nIf Not MyRange1 Is Nothing Then MyRange1.Copy Sheets(\"BJ\").[a3]\nEnd Sub\n</code></pre>\n"}]