[{"tags": ["xml", "excel", "vba", "ribbon", "ribbonx"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456964114, "post_id": 35760478, "comment_id": 59194744, "body": "I don&#39;t think it is possible. You can do it with macros in the Personal.xlsb, but that feels dirty."}], "owner": {"reputation": 11, "user_id": 6010518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a966a0cac4d3a4b9985bc04bc1945bd?s=128&d=identicon&r=PG&f=1", "display_name": "J Montgomery", "link": "https://stackoverflow.com/users/6010518/j-montgomery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456969354, "creation_date": 1456962196, "last_edit_date": 1456969354, "question_id": 35760478, "link": "https://stackoverflow.com/questions/35760478/quick-access-toolbar-customize-shortcut-keys", "title": "Quick Access Toolbar - Customize Shortcut keys", "body": "<p>How can I customize the shortcut keys in the Quick Access Toolbar of Microsoft Excel?  For example, instead of the first icon in the Quick Access Toolbar being activated by <code>Alt 1</code>, I'd like it to be <code>Alt S</code>.  I understand that this may requires XML, and I'm looking for an example of code. </p>\n"}, {"tags": ["vba", "excel", "max"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1456961336, "post_id": 35760255, "comment_id": 59193738, "body": "SO is not a code for me or do my homework site."}, {"owner": {"reputation": 8174, "user_id": 2319844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886739627f42f94f4e05159428a265fa?s=128&d=identicon&r=PG", "display_name": "Sumner Evans", "link": "https://stackoverflow.com/users/2319844/sumner-evans"}, "edited": false, "score": 0, "creation_date": 1456961436, "post_id": 35760255, "comment_id": 59193773, "body": "I&#39;m voting to close this question as off-topic because SO is not a &quot;do my homework for me&quot; site and the OP seems to not have made an attempt to find a solution to the problem before asking on SO."}, {"owner": {"reputation": 5037, "user_id": 4231110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7525da44a40ab0d4e5e88a6e6d0b55de?s=128&d=identicon&r=PG", "display_name": "Justin Howard", "link": "https://stackoverflow.com/users/4231110/justin-howard"}, "edited": false, "score": 0, "creation_date": 1456961604, "post_id": 35760255, "comment_id": 59193850, "body": "For homework problems, SO prefers to give nudges in the right direction rather than posting whole solutions. Show what you&#39;ve done so far and we can help you with a specific problem you&#39;re having. See <a href=\"http://meta.stackexchange.com/a/18251/274986\">meta.stackexchange.com/a/18251/274986</a>."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1456962777, "creation_date": 1456962777, "answer_id": 35760586, "question_id": 35760255, "link": "https://stackoverflow.com/questions/35760255/get-the-max-number-without-using-the-worksheet-function/35760586#35760586", "title": "Get the max number without using the worksheet function", "body": "<p>With data in <strong>A1</strong> through <strong>B20</strong>, in <strong>C1</strong> enter:</p>\n\n<pre><code>=B1\n</code></pre>\n\n<p>and in <strong>C2</strong> enter:</p>\n\n<pre><code>=IF(B2&gt;C1,B2,C1)\n</code></pre>\n\n<p>and copy down.  Then in <strong>D20</strong> enter:</p>\n\n<pre><code>=INDEX(A1:A20,MATCH(C20,C1:C20,0))\n</code></pre>\n\n<p>Here is an example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/I4bId.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I4bId.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6010473, "user_type": "registered", "profile_image": "https://graph.facebook.com/1125199730831566/picture?type=large", "display_name": "Sebastian Olan", "link": "https://stackoverflow.com/users/6010473/sebastian-olan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1459508142, "creation_date": 1456961042, "last_edit_date": 1459508142, "question_id": 35760255, "link": "https://stackoverflow.com/questions/35760255/get-the-max-number-without-using-the-worksheet-function", "title": "Get the max number without using the worksheet function", "body": "<p>My teacher wants me to make a function or subroutine that returns the max value of a list in Excel. The list is only one column with different values and names on the left side of it. Then when my function returns the max value, it has to give you the name on the left side of that value.</p>\n\n<p>How can I do this without using <code>worksheet.functions.max</code>?</p>\n"}, {"tags": ["excel", "format", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1456958582, "post_id": 35759617, "comment_id": 59192635, "body": "<b>Are all ages greater than 9 ??</b>"}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 1, "creation_date": 1456958981, "post_id": 35759617, "comment_id": 59192816, "body": "<a href=\"https://support.office.com/en-us/article/Split-text-among-columns-by-using-functions-c2930414-9678-49d7-89bc-1bf66e219ea8\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> is exactly what you need, you should be able to programmatically use the search function to find and split your string by blank space"}, {"owner": {"reputation": 1073, "user_id": 4984061, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Gm8it.jpg?s=128&g=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/4984061/starbucks"}, "edited": false, "score": 0, "creation_date": 1457042366, "post_id": 35759617, "comment_id": 59239185, "body": "All ages are above 9"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1456959956, "last_edit_date": 1456959956, "creation_date": 1456959251, "answer_id": 35759845, "question_id": 35759617, "link": "https://stackoverflow.com/questions/35759617/excel-moving-specific-text-to-another-row-column/35759845#35759845", "title": "Excel: Moving Specific Text to Another Row / Column", "body": "<p>With data in <strong>A1</strong>, in <strong>B1</strong> enter:</p>\n\n<pre><code>=LEFT(TRIM(MID(SUBSTITUTE($A1,\" \",REPT(\" \",999)),COLUMNS($A:A)*999-998,999)),LEN(TRIM(MID(SUBSTITUTE($A1,\" \",REPT(\" \",999)),COLUMNS($A:A)*999-998,999)))-2)\n</code></pre>\n\n<p>in <strong>C1</strong> enter:</p>\n\n<pre><code>=RIGHT(TRIM(MID(SUBSTITUTE($A1,\" \",REPT(\" \",999)),COLUMNS($A:A)*999-998,999)),2)\n</code></pre>\n\n<p>In <strong>D1</strong> enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,\" \",REPT(\" \",999)),COLUMNS($A:B)*999-998,999))\n</code></pre>\n\n<p>and in <strong>E1</strong> enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,\" \",REPT(\" \",999)),COLUMNS($A:C)*999-998,999))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LIDIt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LIDIt.png\" alt=\"enter image description here\"></a></p>\n\n<p>This will work if the ages are <strong>2</strong> digits <em>(greater than 9 and less than 100)</em></p>\n\n<p>Also note that I have left the male/female field as a single <strong>2</strong> digit field.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1456959335, "creation_date": 1456959335, "answer_id": 35759862, "question_id": 35759617, "link": "https://stackoverflow.com/questions/35759617/excel-moving-specific-text-to-another-row-column/35759862#35759862", "title": "Excel: Moving Specific Text to Another Row / Column", "body": "<p>For the vba, and this is dependent on the age always being two digits.</p>\n\n<pre><code>Sub splitStr()\n    Dim rng As Range\n    Dim ws As Worksheet\n    Dim spltStr() As String\n\n    Set ws = Sheets(\"Sheet4\")\n    With ws\n        For Each rng In .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp))\n            spltStr = split(Trim(rng))\n            rng.Offset(, 1) = Left(spltStr(0), Len(spltStr(0)) - 2)\n            rng.Offset(, 2) = --Right(spltStr(0), 2)\n            rng.Offset(, 3) = --Left(spltStr(1), 1)\n            rng.Offset(, 4) = --Right(spltStr(1), 1)\n            rng.Offset(, 5) = spltStr(2)\n        Next rng\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kL7o0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kL7o0.png\" alt=\"enter image description here\"></a></p>\n\n<p>This will not do the headers.  Those were hand typed.</p>\n"}], "owner": {"reputation": 1073, "user_id": 4984061, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Gm8it.jpg?s=128&g=1", "display_name": "Starbucks", "link": "https://stackoverflow.com/users/4984061/starbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3097, "favorite_count": 0, "accepted_answer_id": 35759845, "answer_count": 2, "score": -1, "last_activity_date": 1456959956, "creation_date": 1456958306, "last_edit_date": 1531161705, "question_id": 35759617, "link": "https://stackoverflow.com/questions/35759617/excel-moving-specific-text-to-another-row-column", "title": "Excel: Moving Specific Text to Another Row / Column", "body": "<p>Good afternoon,</p>\n\n<p>I am having some difficulty separating data that is in one column. I have tons of rows, but the person that uploaded the data merged everything into one column. The entire column has education, age, male, female, and blood type. I want to take the patients attributes and put them into five columns. Is there a way I can move data into five columns without using \"text to columns\" in \"data\" in Excel? </p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thank you.</p>\n\n<pre><code> EducationAge MaleFemale Bloodtype \n MiddleAlabama21 10 ABpos\n WestGov22 01 Bneg\n VirginaTech25 01 ABpos\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1457022618, "post_id": 35759550, "comment_id": 59227093, "body": "Try adding rng.Collapse wdCollapseEnd before the &quot;Case 1&quot; line. Explanation: When you use Find, it executes on the given Range or Selection. If it&#39;s successful, that Range/Selection changes to include the &quot;found&quot; term. In this case, you in addition change the assignment again (expanding to include the paragraph). When your code loops the current assignment to &quot;Range&quot; is used. So you need to reset the Range. To be absolutely accurate, after Collapse you could also add: rng.End = ActiveDocument.Content.End (Note: it&#39;s more correct to use ActiveDocument.Content than ActiveDocument.Range.)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1457023002, "post_id": 35759550, "comment_id": 59227385, "body": "@CindyMeister - Thanks for that info and your help on my questions! I found that <code>ActiveDocument.Content</code> note elsewhere, so have changed that.  I&#39;ve added the <code>Collapse</code> and <code>.Content.End</code> as well and it seems to have worked!  After the <code>.Collapse</code> and <code>.Content.End</code>, I have also added <code>Set rng = Nothing</code>, is that okay or would that cause some issues too perhaps?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1457023159, "post_id": 35759550, "comment_id": 59227487, "body": "Setting the range to Nothing is correct, but not absolutely neccessary: VBA in its current incarnation is very forgiving in this regard. (In Word 97 it was not, but that got fixed in a hurry!)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1457023632, "post_id": 35759550, "comment_id": 59227826, "body": "I&#39;ve composed the comment as an Answer. One other tip for you: try to avoid using ActiveDocument throughout your code. Declare an object (Dim doc as Word.Document for example) then set ActiveDocument to that and use doc throughout. It could happen that the user clicks on or opens another document, or some other software uses &quot;GetObject&quot; and picks up the same instance of the Word application. Things like that could unexpectedly change which Document is the <i>active</i> one, with nasty results..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1457023930, "post_id": 35759550, "comment_id": 59228043, "body": "@CindyMeister - Oh for sure, I&#39;m doing that as we speak (I know from Excel to try and never use <code>ActiveSheet</code>, so assumed the same here.  Thanks for your help!!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1457024026, "post_id": 35759550, "comment_id": 59228110, "body": "Who would wnat to miss a chance to help Batman&#39;s rich alter ego &lt;g&gt;?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1457023480, "creation_date": 1457023480, "answer_id": 35778038, "question_id": 35759550, "link": "https://stackoverflow.com/questions/35759550/using-find-wont-continue-stays-on-same-paragraph/35778038#35778038", "title": "Using .Find won&#39;t continue, stays on same paragraph", "body": "<p>Try adding <code>rng.Collapse wdCollapseEnd</code> before the \"Case 1\" line. </p>\n\n<p>Explanation: When you use <code>Find</code>, it executes on the given Range or Selection. </p>\n\n<p>If it's successful, that Range/Selection changes to include the \"found\" term. In this case, you in addition change the assignment again (expanding to include the paragraph). </p>\n\n<p>When your code loops the current assignment to \"Range\" is used - in this case, Find looks only at the selected paragraph Range. So you need to reset the Range in order to have Find continue. </p>\n\n<p>To be absolutely accurate, after Collapse you could also add: </p>\n\n<pre><code>rng.End = ActiveDocument.Content.End\n</code></pre>\n\n<p>Note: it's more correct to use <code>ActiveDocument.Content</code> than <code>ActiveDocument.Range</code>. <code>ActiveDocument.Range</code> is actually a method for creating a new Range by specifying the Start and End points, while ActiveDocument.Content returns the entire main story (body) of the document as a Range object. VBA doesn't care, it defaults the method to return the main story. Other programming languages (.NET, especially C#) don't work as intuitively with Word's object model, however. So it's a good habit to use what \"always\" works :-)</p>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 35778038, "answer_count": 1, "score": 0, "last_activity_date": 1459255092, "creation_date": 1456958092, "last_edit_date": 1459255092, "question_id": 35759550, "link": "https://stackoverflow.com/questions/35759550/using-find-wont-continue-stays-on-same-paragraph", "title": "Using .Find won&#39;t continue, stays on same paragraph", "body": "<p>I have a script that looks for some text, inputted by the user.  The idea is to look through a document for this text, and when it's found, select the paragraph and ask the user if they want to add this paragraph to an Index.</p>\n\n<p>For some reason, I can't get the script to move past the first selected paragraph.  When I run it, and click \"Yes\" in the UserForm (equivalent of <code>myForm.Tag = 2</code>), it adds to the index, but then when the <code>.Find</code> looks for the next instance of the text, it selects the paragraph I just had highlighted. ...it doesn't continue.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub find_Definitions()\nDim defText As String, findText$\nDim oRng    As Word.Range, rng As Word.Range\nDim myForm As frmAddDefinition\nSet myForm = New frmAddDefinition\n\nDim addDefinition$, expandParagraph&amp;\n' expandParagraph = 1\n\nSet oRng = ActiveDocument.Range\nfindText = InputBox(\"What text would you like to search for?\")\n\nWith oRng.Find\n    .Text = findText\n    While .Execute\n\n    Set rng = oRng.Paragraphs(1).Range\n        rng.Select\n        defText = oRng.Paragraphs(1).Range\n        myForm.Show\n        Select Case myForm.Tag\n            Case 0 ' Expand the paragraph selection\n\n                Do While CLng(expandParagraph) &lt; 1\n                    expandParagraph = InputBox(\"How many paragraphs to extend selection?\")\n                    If expandParagraph = 0 Then Exit Do\n                Loop\n\n                    rng.MoveEnd unit:=wdParagraph, Count:=expandParagraph\n                    rng.Select\n                    defText = rng\n\n                ActiveDocument.Indexes.MarkEntry Range:=rng, entry:=defText, entryautotext:=defText\n            Case 1 ' No, do not add to the index\n                ' do nothing\n            Case 2 ' Yes, add to index\n                ActiveDocument.Indexes.MarkEntry Range:=rng, entry:=defText, entryautotext:=defText\n            Case 3 ' Cancel, exit the sub\n                MsgBox (\"Exiting macro\")\n                GoTo lbl_Exit\n        End Select\n    Wend\nEnd With\n\nlbl_Exit:\nUnload myForm\nSet myForm = Nothing\nEnd Sub\n</code></pre>\n\n<p>(FWIW, I'm pretty new to Word VBA, but very familiar with Excel VBA).  Thanks for any ideas.</p>\n\n<p>Note if I click \"No\" (equivalent of <code>myForm.Tag = 1</code>), then it <strong>does</strong> move on to the next instance.  Hmm.</p>\n"}, {"tags": ["excel", "vba", "trigonometry"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457003751, "post_id": 35759112, "comment_id": 59212742, "body": "What kind of &quot;complaints&quot;?  What are your data inputs to the function?  Using some random numbers, it seems to run OK here."}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457017633, "post_id": 35759112, "comment_id": 59222992, "body": "@RonRosenfeld, checking &quot;System&quot; didn&#39;t work.  There is no complaint. The function just returns 0. In the debug mode, I can hoover over or high-light individual variables or terms. It shows AC=empty. High-lighting &quot;abc<i>PI/180&quot; shows the right calc, but high-lighting &quot;Cos(abc</i>PI/180)&quot; doesn&#39;t show anything."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457018492, "post_id": 35759112, "comment_id": 59223701, "body": "Repeating:  <i>What are your data inputs to the function?</i>  Edit your question to show that."}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457020442, "post_id": 35759112, "comment_id": 59225357, "body": "@RonRosenfeld, I don&#39;t fully understand you question, but HR, HR_RL, and abc are just numbers.  If you are referring to the data type, I think they are variants since I didn&#39;t separately declare their types."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457020567, "post_id": 35759112, "comment_id": 59225453, "body": "And what are those numbers? Did they come from a cell or are you inputting them from another VBA macro?"}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457020820, "post_id": 35759112, "comment_id": 59225682, "body": "@RonRosenfeld, from cells."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457020912, "post_id": 35759112, "comment_id": 59225759, "body": "<b>And what are the actual numbers??</b>"}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457021088, "post_id": 35759112, "comment_id": 59225901, "body": "HR = 4.9, HR_RL = 2.4, abc = 171.0963"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457021235, "post_id": 35759112, "comment_id": 59226027, "body": "I get a result of <code>7.280562</code>.  You only posted a portion of your code.  Perhaps your error is in the unposted portion."}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457021564, "post_id": 35759112, "comment_id": 59226268, "body": "What I posted above is literally all I have except for End Function at the end.  Maybe I didn&#39;t set things up right at all.  Like I said, I am very new.  All I did was: Alt+F11, Insert Module, typed the above in the Editor, and from a cell, I typed &quot;=XXX(A1, A2, A3)&quot;.  I must be something global, then."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457021722, "post_id": 35759112, "comment_id": 59226394, "body": "What you posted is lacking both an <code>End Function</code> line and also <code>XXX = AC</code> line.  Without the first, you should be seeing a compile error; without the second, you will be getting a <code>0</code> result."}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457021888, "post_id": 35759112, "comment_id": 59226522, "body": "Thank you.  It worked.  How can I make your comment as an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457003691, "post_id": 35759311, "comment_id": 59212705, "body": "Interesting.  I&#39;ve never checked that reference, in either Excel 2007 or 2016, and I&#39;ve never had an issue with the VBA Trig functions."}, {"owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "edited": false, "score": 0, "creation_date": 1457017677, "post_id": 35759311, "comment_id": 59223028, "body": "@PeterT, checking &quot;System&quot; didn&#39;t work. There is no complaint. The function just returns 0. In the debug mode, I can hoover over or high-light individual variables or terms. It shows AC=empty. High-lighting &quot;abcPI/180&quot; shows the right calc, but high-lighting &quot;Cos(abcPI/180)&quot; doesn&#39;t show anything."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1457021063, "post_id": 35759311, "comment_id": 59225882, "body": "There is no &quot;return&quot; of the result from your function. Add <code>XXX = AC</code> at the end of the function and see if it works."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457021243, "post_id": 35759311, "comment_id": 59226033, "body": "@RonRosenfeld - interestingly, when I first tested this in my default VBA set up, the trig functions didn&#39;t work. So a quick google search and checking the <code>System</code> reference did the trick. Since I don&#39;t generally need <code>System</code>, I didn&#39;t save this configuration. Today, when I tested a bit of code based on your comment, I can get sin/cos/sqr to work just fine without checking <code>System</code>. Very strange indeed."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 0, "last_activity_date": 1456957157, "creation_date": 1456957157, "answer_id": 35759311, "question_id": 35759112, "link": "https://stackoverflow.com/questions/35759112/vba-excel-sine-cosine-functions/35759311#35759311", "title": "VBA Excel sine cosine functions", "body": "<p>Go into your VBA Editor menu and select <code>Tools -&gt; References...</code>, then check the <code>System</code> library. It will give you access to all the math functions.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5053L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5053L.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 389, "user_id": 5274458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3780b258066522b1fbcef1c09b9c536a?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/5274458/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 35759311, "answer_count": 1, "score": 0, "last_activity_date": 1456957157, "creation_date": 1456956433, "last_edit_date": 1456956805, "question_id": 35759112, "link": "https://stackoverflow.com/questions/35759112/vba-excel-sine-cosine-functions", "title": "VBA Excel sine cosine functions", "body": "<p>I am trying to write a short trig function wanting to use sine and cosine functions in VB and I am very new to this as it's my first time coding in VB.</p>\n\n<p>See what I'm trying to accomplish below:</p>\n\n<pre><code>Function XXX(HR, HR_RL, abc)\n\nConst PI As Double = \"3.141593\"\n\nAC = Sqr(HR ^ 2 + HR_RL ^ 2 - 2 * HR * HR_RL * Cos(abc * PI / 180))\n</code></pre>\n\n<p>VB is complaining about two things Cos and Sqr.</p>\n\n<p>It seems they are both built-in VBA functions, but somehow I can't get them evaluated and as a result, AC variable = empty.</p>\n\n<p>In fact, it doesn't seem that it even goes past \"Cos(abc * PI / 180)\". If I substitute \"Cos(abc * PI / 180)\" with a numeric value (just to see where else is another problem), surely enough, now VB complains about \"Sqr\".</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456959131, "post_id": 35758755, "comment_id": 59192876, "body": "Is the value in R6 changing as the result of a formula, or by direct user input?   <code>Worksheet_Change</code> doesn&#39;t capture the first of those."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5145612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b596d9cd6cdfba8b482d7fa6d56d5b?s=128&d=identicon&r=PG&f=1", "display_name": "zack73", "link": "https://stackoverflow.com/users/5145612/zack73"}, "edited": false, "score": 0, "creation_date": 1456957462, "post_id": 35758958, "comment_id": 59192105, "body": "I&#39;m a little confused. First, this combination is producing the same problem. But also, when I add the public macro above to a module, it does not show up in my macro list so I can&#39;t test it on its own to make sure it works. I don&#39;t need to change anything in there to fit my workbook right? Does the excel version matter? I am stuck in 2007"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 13, "user_id": 5145612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b596d9cd6cdfba8b482d7fa6d56d5b?s=128&d=identicon&r=PG&f=1", "display_name": "zack73", "link": "https://stackoverflow.com/users/5145612/zack73"}, "edited": false, "score": 0, "creation_date": 1456959325, "post_id": 35758958, "comment_id": 59192967, "body": "Both the <code>Worksheet_Change</code> event and the <code>Macro1</code> work perfectly fine for me. I added a quick test sub above for debugging as an illustration. In the VBA Editor, put your edit cursor in the <code>test()</code> sub, then press F5 to execute, or press F8 to step. You can check each statement along the way if necessary. Is your <code>Worksheet_Change</code> sub on the Sheet module (not your code module)?"}, {"owner": {"reputation": 13, "user_id": 5145612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b596d9cd6cdfba8b482d7fa6d56d5b?s=128&d=identicon&r=PG&f=1", "display_name": "zack73", "link": "https://stackoverflow.com/users/5145612/zack73"}, "edited": false, "score": 0, "creation_date": 1456960333, "post_id": 35758958, "comment_id": 59193346, "body": "yeah, same problem as originally still. when I run the macro1 on its own, it correctly formats everything. But as part of the worksheet_change, it appears to do nothing. I&#39;m totally baffled by this one. Maybe my workbook is just too messy. There are other things going on, but nothing that should interact. I will try to isolate a new workbook to just this section and try that. Thanks again."}, {"owner": {"reputation": 13, "user_id": 5145612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b596d9cd6cdfba8b482d7fa6d56d5b?s=128&d=identicon&r=PG&f=1", "display_name": "zack73", "link": "https://stackoverflow.com/users/5145612/zack73"}, "edited": false, "score": 0, "creation_date": 1456960765, "post_id": 35758958, "comment_id": 59193524, "body": "working in the recreation i did in another workbook. something must be up with the one I am working in. I will have to troubleshoot. thanks for your solution."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1456959142, "last_edit_date": 1456959142, "creation_date": 1456955902, "answer_id": 35758958, "question_id": 35758755, "link": "https://stackoverflow.com/questions/35758755/vba-to-format-cells-based-on-another-cell-not-working/35758958#35758958", "title": "VBA to format cells based on another cell not working", "body": "<p>Try passing the worksheet object to your macro. This fully qualifies the <code>Ranges</code> to make sure you're working on the right area.</p>\n\n<p>Also, you don't need to <code>Select</code> at all. Just use the range and directly change the settings.</p>\n\n\n\n<pre><code>Public Sub Macro1(ws as Worksheet)\n    If ws.Range(\"S9\").Value &lt; 1 Then\n        ws.Range(\"S9:S100,T9:T100\").NumberFormat = \"0.0%\"\n    Else\n        ws.Range(\"S9:S100,T9:T100\").NumberFormat = \"#,##0\"\n    End If\nend sub\n\nSub test()\n    Macro1 ActiveSheet\nEnd Sub\n</code></pre>\n\n<p>And in your <code>Worksheet_Change</code>...</p>\n\n\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$R$6\" Then\n        Macro1 Target.Worksheet\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5145612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b596d9cd6cdfba8b482d7fa6d56d5b?s=128&d=identicon&r=PG&f=1", "display_name": "zack73", "link": "https://stackoverflow.com/users/5145612/zack73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 35758958, "answer_count": 1, "score": 0, "last_activity_date": 1456963499, "creation_date": 1456955261, "last_edit_date": 1456963499, "question_id": 35758755, "link": "https://stackoverflow.com/questions/35758755/vba-to-format-cells-based-on-another-cell-not-working", "title": "VBA to format cells based on another cell not working", "body": "<p><strong>SOLVED: FOUND MY OWN WORKSHEET ERROR</strong>\nThe problem I was having was trying to use two worksheet_change events in the same workbook. Because I thought that was possible, I was just renaming the worksheet event in question when I received an error, thinking nothing of it. Both my original code and the answer provided work, when combined with my other worksheet_change event.\nThanks everyone.</p>\n\n<p>Original Request:</p>\n\n<p>I am trying to run a macro that does this:</p>\n\n<p>every time cell r6 changes, run a macro that looks to see if the value in cell s9 is > or &lt; 1, then format cells s9:t100 based on that. </p>\n\n<p>I have the macro on its own to do the second part:</p>\n\n<pre><code>sub macro1()\nIf Range(\"S9\").Value &lt; 1 Then\n      Range(\"S9:S100,T9:T100\").Select\n    Selection.NumberFormat = \"0.0%\"\nElse\n        Range(\"S9:S100,T9:T100\").Select\n      Selection.NumberFormat = \"#,##0\"\nEnd If\nend sub\n</code></pre>\n\n<p>This macro run on its own, works exactly as I want and formats the cells.</p>\n\n<p>Then I have the worksheet event to call up that macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$R$6\" Then\nCall Macro1\nEnd If\nEnd Sub\n</code></pre>\n\n<p>When it is run to call up the same macro, it does not format the cells. They just stay as a % regardless of when cell r6 changes.</p>\n\n<p>Any ideas why the worksheet event causes the macro to not work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456954640, "post_id": 35758422, "comment_id": 59190558, "body": "Where exactly is <code>testfunc</code> located: is it in a different workbook from the code you posted?"}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456954819, "post_id": 35758422, "comment_id": 59190661, "body": "I have 2 workbooks open. I have all the code in Book1 and trying to copy data from Book2.  &quot;testfunc&quot; is another function in same workbook."}, {"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "edited": false, "score": 0, "creation_date": 1456955020, "post_id": 35758422, "comment_id": 59190779, "body": "In your <code>VBAProject</code>, make sure you put your function (such as <code>testfunc</code>) into a module (under the folder <code>Modules</code> in the Project Explorer) and not as VBA code inside a worksheet or workbook (under the folder <code>Microsoft Excel Objects</code>)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456955181, "post_id": 35758422, "comment_id": 59190876, "body": "why not <code>ExtractData  = testfunc(s1,s2)</code>?"}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456955275, "post_id": 35758422, "comment_id": 59190926, "body": "Scott -- I need to dynamically call diff functions.  Private Function ABC     sFuncName = oMapWksht.Cells(sMapRowItr, 3).Value \t&#39;sFuncName = &quot;testfunc&quot;     ExtractData = Application.Run(&quot;Sheet.xls&quot; &amp; sFuncName, s1, s2) \t&#39;ExtractData = Application.Run(sFuncName, s1, s2) \t&#39;ExtractData = CallByName(&quot;Sheet.xls&quot;, sFuncName, VbMethod, s1, s2) End Function Public Function testfunc(ByVal s1 As String, ByVal s2 As String) As Boolean     -- \t--- \t---- End Function"}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456955687, "post_id": 35758422, "comment_id": 59191151, "body": "I&#39;ve just added some part of my script...where I&#39;m getting function name (sFuncName) from a cell in workbook"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456955638, "post_id": 35758781, "comment_id": 59191132, "body": "I&#39;ve just added some part of my script...where I&#39;m getting function name (sFuncName )from a cell in workbook."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1456956489, "last_edit_date": 1456956489, "creation_date": 1456955357, "answer_id": 35758781, "question_id": 35758422, "link": "https://stackoverflow.com/questions/35758422/calling-a-function-using-variable-name-in-vba/35758781#35758781", "title": "Calling a function using variable name in VBA", "body": "<p>You can use a <strong>String</strong> variable to hold the Sub's name.  Here is an example of a Sub in the same module as the caller:</p>\n\n<pre><code>Sub MAIN()\n    Dim st As String\n    st = \"whatever\"\n    Application.Run st\nEnd Sub\n\nPublic Sub whatever()\n    MsgBox \"whatever\"\nEnd Sub\n</code></pre>\n\n<p>If the caller and called subs are in different modules, the syntax may be slightly different.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If we want to call a Sub in a different module within the <em>same workbook</em>, the syntax would be the same.</p>\n\n<p>If we want to call a Sub within <em>another workbook</em>, and both workbooks are open then the caller would look like:</p>\n\n<pre><code>Sub MAIN()\n    Dim st As String\n    st = \"Book2.xlsm!whatever\"\n    Application.Run st\nEnd Sub\n</code></pre>\n\n<p>I usually declare the called Sub <code>Public</code>, but I don't know if this is necessary.</p>\n\n<p><strong>EDIT#2</strong></p>\n\n<p>To use another workbook's <em>UDF()</em> in a worksheet cell, then:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tU5MV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tU5MV.png\" alt=\"enter image description here\"></a></p>\n\n<p>where <code>qwerty()</code> is a <code>Public</code> <em>UDF()</em></p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456956035, "post_id": 35758908, "comment_id": 59191366, "body": "Invoked function is unique across the project. sFuncName  returns diff values as i read the value dynamically from sheet. sFuncName  returns diff values testfunc1, testfunc2 ...."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456956107, "post_id": 35758908, "comment_id": 59191403, "body": "Then the problem is elsewhere, possibly in the value you&#39;re reading in the cell - are you completely totally absolutely sure what you&#39;re reading matches the name of an existing procedure? No leading/trailing whitespace?"}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456956255, "post_id": 35758908, "comment_id": 59191481, "body": "I have checked that it clearly returns the function name in error without any leading/trailing spaces. I&#39;m using excel 2003 wonder if that wont cause any issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456956311, "post_id": 35758908, "comment_id": 59191505, "body": "Try the example code I gave you right here, does it work? (works here on Excel 2010)"}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456956725, "post_id": 35758908, "comment_id": 59191691, "body": "I replaced (&quot;Module2.Test&quot;, &quot;Test&quot;)  to  (&quot;sheet.xls!testfunc&quot;, &quot;Test&quot;)   and it returned same error...macro cannot be found"}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456957014, "post_id": 35758908, "comment_id": 59191855, "body": "yes its enabled...other functions are populating data (directly called instead of variable)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456957173, "post_id": 35758908, "comment_id": 59191952, "body": "Is <code>testFunc</code> located in a standard code module (.bas)? It won&#39;t work if it&#39;s in a class module (.cls) or a workbook/worksheet&#39;s code-behind."}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456957693, "post_id": 35758908, "comment_id": 59192212, "body": "sorry I&#39;m not that aware of .bas or .cls.... i just started working on VBA and i&#39;m trying to add some features to existing code....please excuse for my ignorance"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1456958066, "post_id": 35758908, "comment_id": 59192404, "body": "Ok that must be it then - Ctrl+R get to the project explorer, right-click and select &quot;add module&quot; and put your function in there."}, {"owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1457036802, "post_id": 35758908, "comment_id": 59235973, "body": "Thanks Mat...You&#39;re correct.. I created a module and placed the function in that module and I&#39;m able to access the function.."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "edited": false, "score": 0, "creation_date": 1457036898, "post_id": 35758908, "comment_id": 59236036, "body": "You should ask another question, that&#39;s a totally different issue."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1456955746, "creation_date": 1456955746, "answer_id": 35758908, "question_id": 35758422, "link": "https://stackoverflow.com/questions/35758422/calling-a-function-using-variable-name-in-vba/35758908#35758908", "title": "Calling a function using variable name in VBA", "body": "<p>If the function you're calling is in the same workbook as the caller, it doesn't matter how many workbooks are opened.</p>\n\n<p>If the invoked procedure doesn't have a unique name across the entire project, you need to qualify the function name with at least the name of the module though. This should get you going:</p>\n\n<p><strong>Module1</strong> (caller)</p>\n\n<pre><code>Sub DoSomething()\n    Debug.Print Application.Run(\"Module2.Test\", \"Test\")\nEnd Sub\n</code></pre>\n\n<p><strong>Module2</strong> (callee)</p>\n\n<pre><code>Public Function Test(ByVal title As String) As VbMsgBoxResult\n    Test = MsgBox(\"Works?\", vbQuestion + vbYesNo, title)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5774694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c448ebcc159b65a78b8ae58ee302feae?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/5774694/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2618, "favorite_count": 0, "accepted_answer_id": 35758908, "answer_count": 2, "score": 2, "last_activity_date": 1456956489, "creation_date": 1456954061, "last_edit_date": 1456955552, "question_id": 35758422, "link": "https://stackoverflow.com/questions/35758422/calling-a-function-using-variable-name-in-vba", "title": "Calling a function using variable name in VBA", "body": "<p>Thanks in advance.</p>\n\n<p>I'm trying to call a function using a variable name. It's throwing the error </p>\n\n<p><strong>The macro 'testfunc' cannot be found.\nResume without error</strong></p>\n\n<p><strong>My Code:</strong> I tried below 3 statements but all are throwing the same error.</p>\n\n<pre><code>sFuncName = \"testfunc\"\n\nExtractData = Application.Run(\"Sheet.xls\" &amp; sFuncName, s1, s2)\n\nExtractData = Application.Run(sFuncName, s1, s2)\n\nExtractData = CallByName(\"Sheet.xls\", sFuncName, VbMethod, s1, s2)\n</code></pre>\n\n<p>Note that the <code>sFuncName</code> returns a value &amp; I have 2 Excels opened at that moment, I'm trying to copy data from one Excel to other.</p>\n\n<p>Please help me in achieving this.</p>\n\n<pre><code>Private Function ABC\n  sFuncName = oMapWksht.Cells(sMapRowItr, 3).Value\n  'sFuncName = \"testfunc\"\n  ExtractData = Application.Run(\"Sheet.xls\" &amp; sFuncName, s1, s2)\n  'ExtractData = Application.Run(sFuncName, s1, s2)\n  'ExtractData = CallByName(\"Sheet.xls\", sFuncName, VbMethod, s1, s2)\nEnd Function\nPublic Function testfunc(ByVal s1 As String, ByVal s2 As String) As    Boolean\n--\n---\n----\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456955063, "post_id": 35758401, "comment_id": 59190815, "body": "if you can post some screenshots of your data and named ranges formula, that may help us. Or even the Access VBA code may help, too."}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1456956384, "post_id": 35758401, "comment_id": 59191539, "body": "How are these named ranges being created?  This feels like something to do with the &quot;scope&quot; of the named range.  If your named range is 1: Scoped to the worksheet and 2: On a different sheet than the data validation referencing it, you will get an error."}], "owner": {"reputation": 19, "user_id": 5778574, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aa850ff0a7ded95086ac7374c1ddb77d?s=128&d=identicon&r=PG&f=1", "display_name": "RyszardJ", "link": "https://stackoverflow.com/users/5778574/ryszardj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 601, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456956743, "creation_date": 1456953985, "last_edit_date": 1456956743, "question_id": 35758401, "link": "https://stackoverflow.com/questions/35758401/data-validation-and-named-ranges", "title": "Data validation and named Ranges", "body": "<p>I have a spreadsheet generated through Access VBA. I populate ranges of cells from Access to use for Data Validation. The ranges are there and named, and this is checked by using the box in the top left of the spreadsheet.\nWhen I try to validate I get the message \"A named Range you specified cannot be found\".  If I now use Ctrl F3 I can delete the range. Now I use exactly the same range and Type exactly the same Title into bow on top left and then everything works.  As far as I can see I am using exactly the same criteria throughout. Does anyone have any ideas ?</p>\n\n<p>'Write \"Constants\" for =Indirect functions in Sheet(5)\n            'Phone conversation with Paul.  These will now come from Tables\n            '_______________________________________________________________</p>\n\n<pre><code>        Dim CL(1 To 6) As Integer ' This is to count \"filled rows\" when spreadsheet is filled\n        Dim Header(1 To 6) As String\n        Dim AddNameFormula As String\n\n        Header(1) = \"CostType\"\n        Header(2) = \"SoftwareCosts\"\n        Header(3) = \"HardwareCosts\"\n        Header(4) = \"Expenses\"\n        Header(5) = \"Travel\"\n        Header(6) = \"Building\"\n\n        NRrows = RSNonResourceCosts.RecordCount ' Number of Rows in Non Resource Table\n        NRcols = RSNonResourceCosts.Fields.Count ' Number of Fields in NonResource Table\n\n        RSNonResourceCosts.MoveFirst\n\n        For R = 1 To NRrows\n\n        If (RSNonResourceCosts![CostType]) &lt;&gt; \"\" Then\n        CL(1) = CL(1) + 1\n        WKS.Cells(199 + R, 1) = (RSNonResourceCosts![CostType])\n        End If\n\n        If (RSNonResourceCosts![SoftwareCosts]) &lt;&gt; \"\" Then\n        CL(2) = CL(2) + 1\n        WKS.Cells(199 + R, 2) = (RSNonResourceCosts![SoftwareCosts])\n        End If\n\n        If (RSNonResourceCosts![HardwareCosts]) &lt;&gt; \"\" Then\n        CL(3) = CL(3) + 1\n        WKS.Cells(199 + R, 3) = (RSNonResourceCosts![HardwareCosts])\n        End If\n\n\n        If (RSNonResourceCosts![Expenses]) &lt;&gt; \"\" Then\n        CL(4) = CL(4) + 1\n        WKS.Cells(199 + R, 4) = (RSNonResourceCosts![Expenses])\n        End If\n\n        If (RSNonResourceCosts![Travel]) &lt;&gt; \"\" Then\n        CL(5) = CL(5) + 1\n        WKS.Cells(199 + R, 5) = (RSNonResourceCosts![Travel])\n        End If\n\n        If (RSNonResourceCosts![Building]) &lt;&gt; \"\" Then\n        CL(6) = CL(6) + 1\n        WKS.Cells(199 + R, 6) = (RSNonResourceCosts![Building])\n        End If\n\n        RSNonResourceCosts.MoveNext\n\n        Next R\n</code></pre>\n\n<p>1100\n            '______________________________________________________\n            Dim RCount As String\n            Dim strRange As String\n            Dim ColString As String</p>\n\n<pre><code>        For C = 1 To NRcols - 1\n        X = CL(C) - 1\n\n        X = X + 200\n        RCount = Str(X)\n        RCount = Right$(RCount, Len(RCount) - 1) '\n        'strRange = \"A201:A\" + RCount\n        strRange = Chr$(64 + C) &amp; \"200:\" &amp; Chr$(64 + C) &amp; RCount\n\n\n\n        MsgBox \"strRange   \" &amp; strRange &amp; \"   Rcount  \" &amp; RCount\n\n        WKS.Range(strRange).Select\n\n\n        If C = 1 Then\n        ColString = Str(C)\n        ColString = Right$(ColString, Len(ColString) - 1)\n\n        WKS.Names.Add Name:=Header(1), RefersToR1C1:=\"=ProjectDetails!R200C\" &amp; ColString &amp; \":R\" &amp; RCount &amp; \"C1\"\n        End If\n\n        If C = 2 Then\n        ColString = Str(C)\n        ColString = Right$(ColString, Len(ColString) - 1)\n         WKS.Names.Add Name:=Header(2), RefersToR1C1:=\"=ProjectDetails!R200C\" &amp; ColString &amp; \":R\" &amp; RCount &amp; \"C2\"\n        End If\n\n        If C = 3 Then\n        ColString = Str(C)\n        ColString = Right$(ColString, Len(ColString) - 1)\n         WKS.Names.Add Name:=Header(3), RefersToR1C1:=\"=ProjectDetails!R200C\" &amp; ColString &amp; \":R\" &amp; RCount &amp; \"C3\"\n        End If\n\n        If C = 4 Then\n        ColString = Str(C)\n        ColString = Right$(ColString, Len(ColString) - 1)\n         WKS.Names.Add Name:=Header(4), RefersToR1C1:=\"=ProjectDetails!R200C\" &amp; ColString &amp; \":R\" &amp; RCount &amp; \"C4\"\n        End If\n\n        If C = 5 Then\n        ColString = Str(C)\n        ColString = Right$(ColString, Len(ColString) - 1)\n        WKS.Names.Add Name:=Header(5), RefersToR1C1:=\"=ProjectDetails!R200C\" &amp; ColString &amp; \":R\" &amp; RCount &amp; \"C5\"\n        End If\n\n        If C = 6 Then\n        ColString = Str(C)\n        ColString = Right$(ColString, Len(ColString) - 1)\n         WKS.Names.Add Name:=Header(6), RefersToR1C1:=\"=ProjectDetails!R200C\" &amp; ColString &amp; \":R\" &amp; RCount &amp; \"C6\"\n        End If\n\n        Next C\n\n        I hope this might help.  Code is vast.\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1456953494, "post_id": 35757948, "comment_id": 59189890, "body": "I always forget SUMPRODUCT is such an elegant solution compared to COUNT array formulas and DCOUNT style formulas..."}, {"owner": {"reputation": 3, "user_id": 6009732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0021fdf729d4c4439a810aed42ae2?s=128&d=identicon&r=PG&f=1", "display_name": "arb", "link": "https://stackoverflow.com/users/6009732/arb"}, "edited": false, "score": 0, "creation_date": 1457634565, "post_id": 35757948, "comment_id": 59507194, "body": "above solution works on this particular example but I am not able to implement, as the search returns always returns false. Is there any other solution that I can try ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457635291, "post_id": 35757948, "comment_id": 59507630, "body": "Not with out seeing you actual data,  You may want to check you data and lookups for nonprintable character like spaces and returns.  Look at the Provider column in particular."}, {"owner": {"reputation": 3, "user_id": 6009732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0021fdf729d4c4439a810aed42ae2?s=128&d=identicon&r=PG&f=1", "display_name": "arb", "link": "https://stackoverflow.com/users/6009732/arb"}, "edited": false, "score": 0, "creation_date": 1457638207, "post_id": 35757948, "comment_id": 59509410, "body": "Please ignore my comment, I was making a dump mistake selecting the cell. It works perfect and I validate it too. Thanks the time"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1456952457, "creation_date": 1456952457, "answer_id": 35757948, "question_id": 35757857, "link": "https://stackoverflow.com/questions/35757857/in-excel-how-to-count-the-occurrence-of-each-value-in-one-column-and-group-it-by/35757948#35757948", "title": "In excel how to count the occurrence of each value in one column and group it by values in another column", "body": "<p>The following SUMPRODUCT will work:</p>\n\n<pre><code>=SUMPRODUCT(($A$2:$A$6=H$1)*(ISNUMBER(SEARCH($G2,$B$2:$B$6))))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ghsy6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ghsy6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 6009732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0021fdf729d4c4439a810aed42ae2?s=128&d=identicon&r=PG&f=1", "display_name": "arb", "link": "https://stackoverflow.com/users/6009732/arb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 35757948, "answer_count": 1, "score": 0, "last_activity_date": 1457638299, "creation_date": 1456952165, "last_edit_date": 1531161705, "question_id": 35757857, "link": "https://stackoverflow.com/questions/35757857/in-excel-how-to-count-the-occurrence-of-each-value-in-one-column-and-group-it-by", "title": "In excel how to count the occurrence of each value in one column and group it by values in another column", "body": "<p>I need to count the occurrence of each value in one column and group it by values in another.  How would I do this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/lhYk5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lhYk5.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1456951581, "post_id": 35757699, "comment_id": 59188760, "body": "See here for working with zip files using VBA <a href=\"http://www.rondebruin.nl/win/s7/win002.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s7/win002.htm</a>"}, {"owner": {"reputation": 3612, "user_id": 2422013, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/VwKps.jpg?s=128&g=1", "display_name": "AStopher", "link": "https://stackoverflow.com/users/2422013/astopher"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1456951984, "post_id": 35757699, "comment_id": 59188986, "body": "@TimWilliams That&#39;s not what we&#39;re here for. <i>Please</i> don&#39;t provide a complete solution for someone that hasn&#39;t made any effort. Please post  an answer to the question with the <b>main part of the code only</b> (i.e, the main function for reading txt from zip files)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1456952821, "post_id": 35757699, "comment_id": 59189515, "body": "I think we&#39;re allowed to decide individually what we&#39;re here for - at least I reserve that option...   The link I posted is by no means a complete solution, but if it helps the OP then I don&#39;t have a problem with that.  However a link is typically as much effort as I&#39;m prepared to put in for a question which shows no effort or doesn&#39;t include any existing code, unless it&#39;s something I&#39;ve not tried to do before and is interesting to me to solve."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456953039, "post_id": 35757699, "comment_id": 59189643, "body": "@timWilliams Thanks.  <i>I</i> appreciate the link!"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 3612, "user_id": 2422013, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/VwKps.jpg?s=128&g=1", "display_name": "AStopher", "link": "https://stackoverflow.com/users/2422013/astopher"}, "edited": false, "score": 1, "creation_date": 1456990415, "post_id": 35757699, "comment_id": 59203699, "body": "@cybermonkey Please don&#39;t suggest that we shouldn&#39;t help someone by posting a link because they &quot;haven&#39;t made any effort&quot; and then follow up with &quot;you should instead go out of your way to post a complete answer.&quot; That makes no sense."}, {"owner": {"reputation": 25, "user_id": 6009930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca7a71b871a7abc654a7765799b6286?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bacaro", "link": "https://stackoverflow.com/users/6009930/r-bacaro"}, "edited": false, "score": 1, "creation_date": 1457023617, "post_id": 35757699, "comment_id": 59227813, "body": "Hi guys, i&#39;ve already try to make this I&#39;ll post the code by editing my question thanks"}, {"owner": {"reputation": 25, "user_id": 6009930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca7a71b871a7abc654a7765799b6286?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bacaro", "link": "https://stackoverflow.com/users/6009930/r-bacaro"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457024138, "post_id": 35757699, "comment_id": 59228218, "body": "Sorry for not posting the code before, Cybermonkey. But I wouldn&#39;t post something without no effort. Thanks @TimWilliams, I&#39;ve already look in that link, part of my code belongs to the author heheheh, thank you"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457024383, "post_id": 35757699, "comment_id": 59228407, "body": "Error is on which line?"}, {"owner": {"reputation": 25, "user_id": 6009930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca7a71b871a7abc654a7765799b6286?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bacaro", "link": "https://stackoverflow.com/users/6009930/r-bacaro"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457025953, "post_id": 35757699, "comment_id": 59229468, "body": "@TimWilliams error in the lines commented( line 19 to  27), when I&#39;ve tried use the open .txt and write what is inside the .txt to an excel"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457028195, "post_id": 35757699, "comment_id": 59230854, "body": "You haven&#39;t set <code>oApp</code> to anything.  Also make sure to use Variants for paths when dealing with oApp.  Check Ron&#39;s page again."}, {"owner": {"reputation": 25, "user_id": 6009930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca7a71b871a7abc654a7765799b6286?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bacaro", "link": "https://stackoverflow.com/users/6009930/r-bacaro"}, "edited": false, "score": 0, "creation_date": 1457030499, "post_id": 35757699, "comment_id": 59232177, "body": "I have set oApp but and use Variants to pass the text inside the .txt, but I get the same error  some of the code I&#39;ve modified bellow:  Set oApp = CreateObject(&quot;Shell.Application&quot;)               For Each fileNameInZip In oApp.Namespace(Fname).items                              Open &quot;md5.txt&quot; For Input As #1                 Do Until EOF(1)                 Line Input #1, textline                     text = text &amp; textline                 Loop                 Close #1..."}], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 1, "creation_date": 1484899742, "post_id": 35781621, "comment_id": 70709164, "body": "I have auto generated zip files that I need to access and they sometime get corrupted or oversized.  I can check them for size, but is there a way to check if the zip file is accessible?"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 5, "last_activity_date": 1457040476, "last_edit_date": 1457040476, "creation_date": 1457034409, "answer_id": 35781621, "question_id": 35757699, "link": "https://stackoverflow.com/questions/35757699/read-txt-from-zip-files/35781621#35781621", "title": "Read .txt from .zip files", "body": "<p>Here is an example of looping through your cells and getting the zip file, extracting the contents, and reading the file.  You may need to adjust the path to the zip file or it will default to what ever file the excel document is started in.  If you put the whole path to the zip in column A then you would not need to make an adjustment.</p>\n\n<p>Edit was made to reflect the name of the file md5.txt and place contents in second column.  </p>\n\n<pre><code>Sub GetData()\nDim iRow As Integer 'row counter\nDim iCol As Integer 'column counter\nDim savePath As String 'place to save the extracted files\nDim fileContents As String 'contents of the file\nDim fso As FileSystemObject 'FileSystemObject to work with files\niRow = 1 'start at first row\niCol = 1 'start at frist column\n'set the save path to the temp folder\nsavePath = Environ(\"TEMP\")\n'create the filesystem object\nSet fso = New FileSystemObject\n\nDo While ActiveSheet.Cells(iRow, iCol).Value &lt;&gt; \"\"\n    fileContents = fso.OpenTextFile(UnzipFile(savePath, ActiveSheet.Cells(iRow, iCol).Value, \"md5.txt\"), ForReading).ReadAll\n    ActiveSheet.Cells(iRow, iCol + 1).Value = fileContents\n    iRow = iRow + 1\nLoop\n\n\n'free the memory\nSet fso = Nothing\nEnd Sub\n\n\n\nFunction UnzipFile(savePath As String, zipName As String, fileName As String) As String\nDim oApp As Shell\nDim strFile As String\n'get a shell object\nSet oApp = CreateObject(\"Shell.Application\")\n    'check to see if the zip contains items\n    If oApp.Namespace(zipName).Items.Count &gt; 0 Then\n        Dim i As Integer\n        'loop through all the items in the zip file\n        For i = 0 To oApp.Namespace(zipName).Items.Count - 1\n            'check to see if it is the txt file\n            If UCase(oApp.Namespace(zipName).Items.Item(i)) = UCase(filename) Then\n                'save the files to the new location\n                oApp.Namespace(savePath).CopyHere oApp.Namespace(zipName).Items.Item(i)\n                'set the location of the file\n                UnzipFile = savePath &amp; \"\\\" &amp; fileName\n                'exit the function\n                Exit Function\n            End If\n        Next i\n    End If\n'free memory\nSet oApp = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6009930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca7a71b871a7abc654a7765799b6286?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bacaro", "link": "https://stackoverflow.com/users/6009930/r-bacaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7598, "favorite_count": 2, "accepted_answer_id": 35781621, "answer_count": 1, "score": 1, "last_activity_date": 1554777376, "creation_date": 1456951519, "last_edit_date": 1554777376, "question_id": 35757699, "link": "https://stackoverflow.com/questions/35757699/read-txt-from-zip-files", "title": "Read .txt from .zip files", "body": "<p>I need to open a few .zip files, view a specific .txt and write what's inside of this .txt file to an Excel workbook, and the name of the <code>.zip</code> will be in the same row in Excel.</p>\n\n<p>Example:</p>\n\n<p>The first row is the name of the .zip file and in the first row and second column will be the content of the .txt file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6TsrW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6TsrW.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have part of the code. It says code error 91.</p>\n\n<pre><code>Sub Text()\n    Dim FSO As Object\n    Dim oApp As Object\n    Dim Fname As Variant\n    Dim FileNameFolder As Variant\n    Dim DefPath As String\n    Dim strDate As String\n    Dim I As Long\n    Dim num As Long\n\n    Fname = Application.GetOpenFilename(filefilter:=\"Zip Files (*.zip), *.zip\", _\n                                        MultiSelect:=True)\n    If IsArray(Fname) = False Then\n        'Do nothing\n    Else\n        'Root folder for the new folder.\n        'You can also use DefPath = \"C:\\Users\\Ron\\test\\\"\n        DefPath = Application.DefaultFilePath\n\n        If Right(DefPath, 1) &lt;&gt; \"\\\" Then\n            DefPath = DefPath &amp; \"\\\"\n        End If\n\n        For Each fileNameInZip In oApp.Namespace(Fname).Items\n            If LCase(fileNameInZip) Like LCase(\"md5.txt\") Then\n\n                'Open \"md5.txt\" For Input As #1\n                'Do Until EOF(1)\n                'Line Input #1, textline\n                 '   text = text &amp; textline\n               ' Loop\n               ' Close #1\n\n               ' Range(\"B1\").Value = Mid(text, 1, 32)\n               ' Range(\"A1\").Value = Dir(Fname)\n            End If\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>I tried to make a loop to open every file md5.txt in every zip that I have to open and take what's inside of the md5.txt</p>\n"}, {"tags": ["vba", "excel", "range", "autofill"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 4638010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zU9SMZUvpdI/AAAAAAAAAAI/AAAAAAAAAEU/QLl-vrx2-54/photo.jpg?sz=128", "display_name": "Michael Foster", "link": "https://stackoverflow.com/users/4638010/michael-foster"}, "is_accepted": false, "score": 1, "last_activity_date": 1456953236, "creation_date": 1456953236, "answer_id": 35758184, "question_id": 35757304, "link": "https://stackoverflow.com/questions/35757304/excel-vba-range-property-non-contiguous-ranges/35758184#35758184", "title": "Excel VBA range property non contiguous ranges", "body": "<p>If you're going to define the ranges somehow, either programatically or hardcoding, you could turn it into a subroutine, kind of like this:</p>\n\n<pre><code>Sub FillRange(Range rng)\n    Selection.AutoFill Destination:=Range(rng), Type:=xlFillDefault\nEnd Sub\n</code></pre>\n\n<p>Then you can call it:</p>\n\n<pre><code>FillRange(\"K1:K4\")\nFillRange(\"O1:O4\")\nFillRange(\"Q1:Q4\")\n</code></pre>\n\n<p>One issue with this is you can't tell for sure that the destination ranges will be the same size as the range you have selected. You will probably want to code things around that. Without knowing more specifics, I cannot guess how you would want to do it, though.</p>\n"}], "owner": {"reputation": 141, "user_id": 5994513, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73ed1e0125a8c7c4fdf64bed6bb3590a?s=128&d=identicon&r=PG", "display_name": "R.Omar", "link": "https://stackoverflow.com/users/5994513/r-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1598839765, "creation_date": 1456950055, "last_edit_date": 1598839765, "question_id": 35757304, "link": "https://stackoverflow.com/questions/35757304/excel-vba-range-property-non-contiguous-ranges", "title": "Excel VBA range property non contiguous ranges", "body": "<p>I just want to fill different non contiguous ranges from an original cell containing <code>Sum(E1:E4)</code>. Here's the code (which doesn't work, just to get the idea clearer):</p>\n<pre><code> Selection.AutoFill Destination:=Range(&quot;K1:K4&quot;, &quot;O1:O5&quot;, &quot;Q1:Q5&quot;), Type:=xlFillDefault\n</code></pre>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456949567, "post_id": 35757046, "comment_id": 59187601, "body": "What kind of variable is elem_count?"}, {"owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456950769, "post_id": 35757046, "comment_id": 59188307, "body": "It is an integer. As far as i know &#39;.Row&#39; returns an integer."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456951020, "post_id": 35757046, "comment_id": 59188452, "body": "Have you tried defining it as long?"}, {"owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456951092, "post_id": 35757046, "comment_id": 59188493, "body": "No I Haven&#39;t I&#39;ll try and let know."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456951201, "post_id": 35757046, "comment_id": 59188549, "body": "Do the same with public_i and ins_point..."}, {"owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456951294, "post_id": 35757046, "comment_id": 59188593, "body": "Okay ill give it a shot!"}, {"owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456951500, "post_id": 35757046, "comment_id": 59188714, "body": "Okay this worked. Thanks a Bunch  N. Pavon!"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456951651, "post_id": 35757046, "comment_id": 59188801, "body": "I added the answer so that you can accept it and the question is marked as answered"}], "answers": [{"tags": [], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "is_accepted": true, "score": 0, "last_activity_date": 1456951611, "creation_date": 1456951611, "answer_id": 35757715, "question_id": 35757046, "link": "https://stackoverflow.com/questions/35757046/error-6-overflow-while-creating-an-xml-domdocument-through-iteration/35757715#35757715", "title": "error 6 overflow, while creating an XML DOMdocument through iteration", "body": "<p>Define:</p>\n\n<pre><code>Dim elem_count As Long\nDim public_i As Long\nDim ins_point As Long\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 5871675, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NhTJa.png?s=128&g=1", "display_name": "Milos Grujic", "link": "https://stackoverflow.com/users/5871675/milos-grujic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 35757715, "answer_count": 1, "score": 0, "last_activity_date": 1594205492, "creation_date": 1456949155, "last_edit_date": 1594205492, "question_id": 35757046, "link": "https://stackoverflow.com/questions/35757046/error-6-overflow-while-creating-an-xml-domdocument-through-iteration", "title": "error 6 overflow, while creating an XML DOMdocument through iteration", "body": "<p>I use an <code>elem_count = Range(\"Nalog!b\" &amp; Rows.Count).End(xlUp).Row= Range(\"Nalog!b\" &amp; Rows.Count).End(xlUp).Row</code> to find out how many rows of elements I have in my sheet and then use this in <code>For</code> loop which in turn appends elements, row by row, to an XML file which is used to create some objects in AutoCAD.\nThe code I present works perfectly for my needs until <code>elem_count &gt; 100</code> then I get error 6 overflow.\nHow do I prevent this from happening?\nThe code:</p>\n\n<pre><code>For i = 1 To elem_count\n    public_i = i + 15\n    ins_point = ins_point + 300\n    m_xml_varstring.s_varstring\n\n    Set elem_root_Set = DOKUMENT.createElement(\"Set\")\n    elem_root_BuilderList.appendChild elem_root_Set\n\n    Set att_LineNo = DOKUMENT.createAttribute(\"LineNo\")\n    att_LineNo.NodeValue = i\n    elem_root_Set.setAttributeNode att_LineNo\n\n            Set elem_Set = DOKUMENT.createElement(\"Pname\")\n            elem_root_Set.appendChild elem_Set\n            elem_Set.Text = Range(\"Nalog!es\" &amp; i + 15).Value\n\n            Set elem_Set = DOKUMENT.createElement(\"Count\")\n            elem_Set.Text = Str(Range(\"Nalog!k\" &amp; i + 15))\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"PVarString\") 'VARSTRING\n            elem_Set.Text = m_xml_varstring.PVarString\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"ARTICLE_TEXT_INFO1\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"ARTICLE_TEXT_INFO2\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"ARTICLE_PRICE_INFO1\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"ARTICLE_PRICE_INFO2\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"ARTICLE_PRICE_INFO3\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"Pinsertion\")\n            elem_Set.Text = Str(ins_point) &amp; \".00,0.00,0.00\"\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"POrntation\") ' STA?\n            elem_Set.Text = \"0.00,0.00,0.00\"\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"DeliveryPeriod\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"LIEFERANT\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"Mengenrabatt\")\n            elem_root_Set.appendChild elem_Set\n\n            Set elem_Set = DOKUMENT.createElement(\"MengenrabattAbs\")\n            elem_root_Set.appendChild elem_Set\n\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "ftp"], "comments": [{"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "edited": false, "score": 2, "creation_date": 1456950796, "post_id": 35756740, "comment_id": 59188323, "body": "Have a look at <a href=\"http://stackoverflow.com/questions/13863449/vba-excel-and-ftp-with-msinet-ocx-and-inet-type\" title=\"vba excel and ftp with msinet ocx and inet type\">stackoverflow.com/questions/13863449/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 0, "creation_date": 1457010968, "post_id": 35759342, "comment_id": 59217693, "body": "Yes, many thanks. The comment to the OP by rskar led me to figure this out. Browsing for MSINET.OCX in the VBA editor found this reference and the code compiles now."}], "tags": [], "owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "is_accepted": true, "score": 3, "last_activity_date": 1456957267, "creation_date": 1456957267, "answer_id": 35759342, "question_id": 35756740, "link": "https://stackoverflow.com/questions/35756740/excel-vba-reference-for-inet-objects/35759342#35759342", "title": "Excel VBA reference for Inet objects", "body": "<p>The INet object is a member of the Microsoft Internet Transfer Control 6.0 (SP6), NOT Microsoft Internet Controls. <a href=\"http://officeone.mvps.org/vba/ftp_download_file.html\" rel=\"nofollow\">INet Reference</a>.  The correct control can be found in C:\\Windows\\SysWOW64\\msinet.ocx.  You will likely have to change the \"Files of type\" box to \"ActiveX Controls (*.oxc)\" in the references window.</p>\n"}], "owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4765, "favorite_count": 0, "accepted_answer_id": 35759342, "answer_count": 1, "score": 2, "last_activity_date": 1456957267, "creation_date": 1456948127, "question_id": 35756740, "link": "https://stackoverflow.com/questions/35756740/excel-vba-reference-for-inet-objects", "title": "Excel VBA reference for Inet objects", "body": "<p>Excel VBA code is failing to compile on this Dim statement:</p>\n\n<blockquote>\n  <p>Dim FTP as Inet</p>\n</blockquote>\n\n<p>Apparently, others have solved this problem by including a reference to Microsoft Internet Controls, which I have done.  This reference is pointing to:</p>\n\n<blockquote>\n  <p>C:\\Windows\\SysWOW64\\ieframe.dll</p>\n</blockquote>\n\n<p>Thinking that the dll might not be registered, I ran</p>\n\n<blockquote>\n  <p>regsvr32 ieframe.dll</p>\n</blockquote>\n\n<p>with administrative privileges but got an error message that the module was loaded but \"the call to DllRegisterServer failed\", which might be a separate issue.</p>\n\n<p>Is this the right reference to use for Inet objects?  If so, what should I do to compile this code?</p>\n\n<p>Advice is appreciated.</p>\n"}, {"tags": ["vb.net", "ms-access", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1456946200, "post_id": 35756114, "comment_id": 59185566, "body": "I&#39;d validate the data <i>before</i> sending it to access."}, {"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1456949244, "post_id": 35756114, "comment_id": 59187400, "body": "Is it possible to set the number of digits i want for a text box?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457464939, "post_id": 35822381, "comment_id": 59415729, "body": "Lovely idea but now i cannot close the program without putting the numbers in. Plus even when i input the numbers the message still pops up and i cant do anythig"}, {"owner": {"reputation": 25, "user_id": 5937076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qGLu.png?s=128&g=1", "display_name": "Talsiter", "link": "https://stackoverflow.com/users/5937076/talsiter"}, "reply_to_user": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457483222, "post_id": 35822381, "comment_id": 59424587, "body": "@KamilLazarowicz You can do additional validation as needed. This is just one example of one way that you can validate that one field. There are a lot of options that you can take. I am more that willing to help in anyway that I can however we have not collaborated on the software that you are writing, other than what is listed above. I am not sure of all the requirements are for the software. I am just trying to help stop the error occurring if 11 numbers are typed into a textbox. If you could provide a little bit of code on your end, maybe I could help better."}, {"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457647481, "post_id": 35822381, "comment_id": 59515040, "body": "sure but let me know which code in general do you need,"}, {"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457647536, "post_id": 35822381, "comment_id": 59515071, "body": "I need this validationg for a form where there are 8 different inputs. Once of them is a phone number which i want to limit to only 11 numbers. All the data is saved once a button is clicked and all coding is done under that button. I have generally connected my VB program to my access database using the built in wizard in VB"}, {"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457647861, "post_id": 35822381, "comment_id": 59515266, "body": "this is the code, it also vaildates the date format and that a specific textbox isnt empty"}, {"owner": {"reputation": 25, "user_id": 5937076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qGLu.png?s=128&g=1", "display_name": "Talsiter", "link": "https://stackoverflow.com/users/5937076/talsiter"}, "reply_to_user": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457707914, "post_id": 35822381, "comment_id": 59542716, "body": "@KamilLazarowicz I edited the original code and added a Validation Function. You can add whatever you like to ensure that all the required fields are valid prior to the form saving. I hope this helps."}, {"owner": {"reputation": 25, "user_id": 5937076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qGLu.png?s=128&g=1", "display_name": "Talsiter", "link": "https://stackoverflow.com/users/5937076/talsiter"}, "reply_to_user": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457742183, "post_id": 35822381, "comment_id": 59560663, "body": "@KamilLazarowicz I am unable to comment on the answer below, so... You wrote that you want to ensure that one of the textboxes was only 11 numbers only. I have edited my above code, that includes validation for that as well"}], "tags": [], "owner": {"reputation": 25, "user_id": 5937076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5qGLu.png?s=128&g=1", "display_name": "Talsiter", "link": "https://stackoverflow.com/users/5937076/talsiter"}, "is_accepted": false, "score": 1, "last_activity_date": 1457742628, "last_edit_date": 1457742628, "creation_date": 1457231212, "answer_id": 35822381, "question_id": 35756114, "link": "https://stackoverflow.com/questions/35756114/validation-set-in-access-breaks-the-program/35822381#35822381", "title": "Validation set in access breaks the program", "body": "<p>You can create a validation function</p>\n\n<pre><code>    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n\n    If IsValidForm() Then\n        ' Save the Record\n        ' This line takes all the input from the boxes from adding a New job form, And puts it into \n        ' corresponding boxes in the main menu = because only those boxes  \n        ' are connected to the database\n        ' It uses the data adapter from form1\n        Form1.T_JobsTableAdapter.Insert(Me.TextBox2.Text, M, e.TextBox3.Text, Me.TextBox4.Text,\n                                           Me.TextBox5.Text, Me.TextBox6.Text, Me.TextBox7.Text, Me.TextBox8.Text)\n\n        'This line updates the table Jobs dataset with the information in the boxes in main menu\n        'The DataSet passes on the collected data to the database\n        Form1.T_JobsTableAdapter.Fill(Form1.JobsDBDataSet.T_Jobs)\n        MsgBox(\"Record added successfully\")\n\n        ' These lines clear the textboxes so that next job can be added\n        TextBox2.Text = \"\"\n        TextBox3.Text = \"\"\n        TextBox4.Text = \"\"\n        TextBox5.Text = \"\"\n        TextBox6.Text = \"\"\n        TextBox7.Text = \"\"\n        TextBox8.Text = \"\"\n    End If\nEnd Sub\n\nPrivate Function IsValidForm() As Boolean\n    Dim msg As String = String.Empty\n\n    ' Ensure that a Valid Vehicle Model was entered\n    If TextBox3.Text = \"\" Then\n        '  MsgBox(\"Please fill in Car Model\", MsgBoxStyle.Information)\n        msg += \"Enter a Car Model\" &amp; vbCr\n    End If\n\n    ' Validate Date Received\n    If Not IsDate(TextBox2.Text) Then\n        msg += \"Enter a valid Date Received\" &amp; vbCr\n    End If\n\n    ' Validate Date Due\n    If Not IsDate(TextBox2.Text) Then\n        msg += \"Enter a valid  Date Due\" &amp; vbCr\n    End If\n\n    ' Validate Phone Number\n    If Trim(TextBox8.Text) = \"\" Then\n        ' NOTE I am not sure how you want to validate this phone number.\n        ' You can do it with RegEx\n        ' The Regular Expression tells VB to make sure that TextBox8 contains only\n        ' Numbers 1 - 9 and only a length of 11. If it does not match, then\n        ' display the validation message\n         If Not System.Text.RegularExpressions.Regex.IsMatch(TextBox8.Text, \"^[0-9]{11}$\") Then\n           msg += \"Enter a Phone Number\" &amp; vbCr\n         End If\nEnd If\n\n    If msg.Length &gt; 0 Then\n    MessageBox.Show(\"Please fix the following errors before continuing:\" &amp; Microsoft.VisualBasic.ControlChars.CrLf &amp; msg,\n                    Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Information)\n        Return False\n    Else\n        Return True\n    End If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457714663, "post_id": 35928370, "comment_id": 59547644, "body": "This is very helpful thankyou, works as it should. I want the number to be simply 11 numbers; ive restricted the textbox to only allow numbers on the key_press event, now i just need it to check if there are 11 numbers or no."}], "tags": [], "owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1457647915, "creation_date": 1457647915, "answer_id": 35928370, "question_id": 35756114, "link": "https://stackoverflow.com/questions/35756114/validation-set-in-access-breaks-the-program/35928370#35928370", "title": "Validation set in access breaks the program", "body": "<p>this is the code for adding data, it also validates if a textbox isnt empty and if the date is in date format</p>\n\n<pre><code>            If TextBox3.Text = \"\" Then\n        MsgBox(\"Please fill in Car Model\", MsgBoxStyle.Information)\n\n    Else\n\n        'This checks if the Date Recieved and Date Due is in the correct format\n        If IsDate(TextBox2.Text) And IsDate(TextBox6.Text) Then\n            'This line takes all the input from the boxes from adding a new job form, and puts it into \n            'corresponding boxes in the main menu = because only those boxes  \n            'are connected to the database\n            'It uses the data adapter from form1\n            Form1.T_JobsTableAdapter.Insert(Me.TextBox2.Text, Me.TextBox3.Text, Me.TextBox4.Text,\n                                            Me.TextBox5.Text, Me.TextBox6.Text, Me.TextBox7.Text, Me.TextBox8.Text)\n\n            'This line updates the table Jobs dataset with the information in the boxes in main menu\n            'The dataset passes on the collected data to the database\n            Form1.T_JobsTableAdapter.Fill(Form1.JobsDBDataSet.T_Jobs)\n            MsgBox(\"Record added sucessfully\")\n\n            'These lines clear the textboxes so that next job can be added\n            TextBox2.Text = \"\"\n            TextBox3.Text = \"\"\n            TextBox4.Text = \"\"\n            TextBox5.Text = \"\"\n            TextBox6.Text = \"\"\n            TextBox7.Text = \"\"\n            TextBox8.Text = \"\"\n\n        Else\n            MsgBox(\"Please ensure the Date Recieved and Date Due is in dd/mm/yyyy format\", MsgBoxStyle.Information)\n\n        End If\n\n    End If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594642570, "creation_date": 1456946017, "last_edit_date": 1594642570, "question_id": 35756114, "link": "https://stackoverflow.com/questions/35756114/validation-set-in-access-breaks-the-program", "title": "Validation set in access breaks the program", "body": "<p>The program breaks and displays this message once I input the wrong amount of numbers in a textbox and submited the form.</p>\n\n<blockquote>\n  <p>An unhandled exception of type 'System.Data.OleDb.OleDbException'\n  occurred in System.Data.dll</p>\n  \n  <p>Additional information: One or more values are prohibited by the\n  validation rule 'Is Null Or Like \"###########\"' set for\n  'T_Jobs.Customer_Phone'.  Enter a value that the expression for this\n  field can accept.\"</p>\n</blockquote>\n\n<p>I have connected visual basic to access using the data source connecting wizard. I want the program to display a message saying \"<strong>input 11 numbers</strong>\" instead of it breaking.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1456955145, "post_id": 35755846, "comment_id": 59190857, "body": "After you draw the length, you are erasing and redrawing when you call the sub drawing the width. Since the length is explicitly specified as 2 in your width drawing sub, you will draw your tank 2 units long. You should combine the subs into one that draws both length and width if either cell is changed, like Jonathan&#39;s answer below. Also, good work on formatting and structuring your question. You&#39;ve obviously put in some effort in developing your solution."}, {"owner": {"reputation": 99, "user_id": 4886591, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bad99d729e9f64f66d6ea9c22acab57e?s=128&d=identicon&r=PG&f=1", "display_name": "naheiwProg", "link": "https://stackoverflow.com/users/4886591/naheiwprog"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1457023189, "post_id": 35755846, "comment_id": 59227512, "body": "I see what you mean! Thanks! I will definitely look into this. Also, thanks for the compliment about the post."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4886591, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bad99d729e9f64f66d6ea9c22acab57e?s=128&d=identicon&r=PG&f=1", "display_name": "naheiwProg", "link": "https://stackoverflow.com/users/4886591/naheiwprog"}, "edited": false, "score": 0, "creation_date": 1456977741, "post_id": 35756626, "comment_id": 59198728, "body": "Thanks! I&#39;ll try this then."}], "tags": [], "owner": {"reputation": 633, "user_id": 5560651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d6e7d6b999194513ce84305296a655?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5560651/jonathan"}, "is_accepted": true, "score": 2, "last_activity_date": 1456955490, "last_edit_date": 1456955490, "creation_date": 1456947748, "answer_id": 35756626, "question_id": 35755846, "link": "https://stackoverflow.com/questions/35755846/draw-table-according-to-user-provided-width-and-height/35756626#35756626", "title": "Draw table according to user provided width and height", "body": "<p>It looks like in the Draw2DTankw you have Width declared above but in the rng you are using length</p>\n\n<blockquote>\n  <p>Dim Width As Integer  Width = CInt(Cells(2, 2).Value)</p>\n  \n  <p>Set Rng = Range(Cells(21, \"H\"), Cells(Col, 8 + Length - 1))</p>\n</blockquote>\n\n<p>I've modified your code to draw both height and width by extending the range to include the width.  This worked with I test it.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If (Target.Address = \"$A$2\") Or (Target.Address = \"$B$2\") Then\n  DrawTable\n  End If\nEnd Sub\n\nSub DrawTable()\n\n  On Error Resume Next\n  Cells(2, 4).Value = \"\"\n  Dim x As Range\n  Set x = ActiveSheet.Cells\n\n  x.Borders.LineStyle = xNone\n\n  Range(\"A1\") = \"Length\"\n\n\n  Dim Length As Integer\n   Length = CInt(Cells(2, 1).Value)\n   'Combined Width sections\n  Dim Width As Integer\n   Width = CInt(Cells(2, 2).Value)\n\n   If (Length &gt; 30) Then\n    MsgBox \"A length of a maximum 30 is allowed\"\n    Exit Sub\n    ElseIf (Width &gt; 30) Then\n    MsgBox \"A width of a maximum 30 is allowed\"\n    Exit Sub\n    ElseIf (Length &lt; 0) Then\n    MsgBox \"Invalid length value entered\"\n    Exit Sub\n    ElseIf (Width &lt; 0) Then\n    MsgBox \"Invalid Width value entered\"\n    Exit Sub\n  End If\n\n\n   Dim Rws As Long, Rng As Range, r As Range\n    If (Length &gt; 0) Then\n    Rws = 20\n    'Added width to cells(rws)\n    Set Rng = Range(Cells(20, \"H\"), Cells(Rws + Width - 1, 8 + Length - 1))\n\n    For Each r In Rng.Cells\n\n            With r.Borders\n\n                .LineStyle = xlContinuous\n                .Weight = xlMedium\n                .ColorIndex = 3\n\n            End With\n    Next r\n    End If\n\nIf (Err.Number &lt;&gt; 0) Then\n    MsgBox Err.Description\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4886591, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bad99d729e9f64f66d6ea9c22acab57e?s=128&d=identicon&r=PG&f=1", "display_name": "naheiwProg", "link": "https://stackoverflow.com/users/4886591/naheiwprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 35756626, "answer_count": 1, "score": 0, "last_activity_date": 1456955490, "creation_date": 1456945138, "last_edit_date": 1456946580, "question_id": 35755846, "link": "https://stackoverflow.com/questions/35755846/draw-table-according-to-user-provided-width-and-height", "title": "Draw table according to user provided width and height", "body": "<p>I am very new with VBA in Excel. What I want to accomplish is this. When a user enters a length of say 5, then 5 columns must be outlined red. Then also when a user enters a width of say 6, then 6 rows must be outlined red. Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8zmNc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8zmNc.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/eLDTe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eLDTe.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have this code thus far:</p>\n\n<p><strong>On worksheet change:</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If (Target.Address = \"$A$2\") Then\n    Call Draw2DTankl\n  ElseIf (Target.Address = \"$B$2\") Then\n    Call Draw2DTankw\n  End If\nEnd Sub\n</code></pre>\n\n<p><strong>Draw2DTankl:</strong></p>\n\n<pre><code>Sub Draw2DTankl()\n\n  On Error Resume Next\n  Cells(2, 4).Value = \"\"\n  Dim x As Range\n  Set x = Worksheets(\"Sheet1\").Cells\n\n  x.Borders.LineStyle = xNone\n\n  Range(\"A1\") = \"Length\"\n\n\n  Dim Length As Integer\n\n\n   Length = CInt(Cells(2, 1).Value)\n\n\n   If (Length &gt; 30) Then\n    MsgBox \"A length of a maximum 30 is allowed\"\n    Exit Sub\n  End If\n  If (Length &lt; 0) Then\n    MsgBox \"Invalid length value entered\"\n    Exit Sub\n  End If\n\n\n   Dim Rws As Long, Rng As Range, r As Range\n    If (Length &gt; 0) Then\n    Rws = 20\n    Set Rng = Range(Cells(20, \"H\"), Cells(Rws, 8 + Length - 1))\n\n    For Each r In Rng.Cells\n\n            With r.Borders\n\n                .LineStyle = xlContinuous\n                .Weight = xlMedium\n                .ColorIndex = 3\n\n            End With\n    Next r\n    End If\n\nIf (Err.Number &lt;&gt; 0) Then\n    MsgBox Err.Description\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Draw2DTankw:</strong></p>\n\n<pre><code>Sub Draw2DTankw()\n\n  On Error Resume Next\n  Cells(2, 4).Value = \"\"\n  Dim x As Range\n  Set x = Worksheets(\"Sheet1\").Cells\n\n  x.Borders.LineStyle = xNone\n\n\n  Range(\"B1\") = \"Width\"\n\n\n  Dim Width As Integer\n\n\n\n   Width = CInt(Cells(2, 2).Value)\n\n\n  If (Width &gt; 30) Then\n    MsgBox \"A width of a maximum 30 is allowed\"\n    Exit Sub\n  End If\n  If (Width &lt; 0) Then\n    MsgBox \"Invalid Width value entered\"\n    Exit Sub\n  End If\n\n\n     Dim Col As Long, Rng As Range, r As Range\n    If (Width &gt; 0) Then\n    Col = 21\n    Set Rng = Range(Cells(21, \"H\"), Cells(Col, 8 + Length - 1))\n\n    For Each r In Rng.Cells\n\n            With r.Borders\n\n                .LineStyle = xlContinuous\n                .Weight = xlMedium\n                .ColorIndex = 3\n\n            End With\n    Next r\n    End If\n\nIf (Err.Number &lt;&gt; 0) Then\n    MsgBox Err.Description\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Please help me. My code doesn't work. The length works, but that brakes when I change the width.</p>\n\n<p><strong>Entering my length draws:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/9ce0b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9ce0b.png\" alt=\"enter image description here\"></a></p>\n\n<p>Which is correct. But then if I enter the width of 6 this happens: (my length also dissapears)</p>\n\n<p><a href=\"https://i.stack.imgur.com/spdWW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/spdWW.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>I apologize for this long post!</strong></p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1457458859, "post_id": 35755744, "comment_id": 59412265, "body": "If via <code>link</code> you mean hyperlink and you would like to add it to shape object, check this: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff746252.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff746252.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 1197363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ca15e2b18c2941ca74e1334fb61a372?s=128&d=identicon&r=PG", "display_name": "jpsnow72", "link": "https://stackoverflow.com/users/1197363/jpsnow72"}, "edited": false, "score": 0, "creation_date": 1457711325, "post_id": 35877012, "comment_id": 59545327, "body": "Thanks!  This gave me a great start.  It didn&#39;t work directly out of the box for me, but with some minor modifications it worked perfect.  See my answer with revisions"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 1, "last_activity_date": 1457467543, "last_edit_date": 1495542228, "creation_date": 1457467543, "answer_id": 35877012, "question_id": 35755744, "link": "https://stackoverflow.com/questions/35755744/macro-for-ppt-move-textbox-contents-to-placeholder-maintain-links-and-lists/35877012#35877012", "title": "Macro for PPT - Move TextBox contents to Placeholder - Maintain links and lists", "body": "<p>This may have some formatting issues that need to be addressed, but this will insert the hyperlinks that you are looking for.  Code is likely not the cleanest, but it works.  You will also need to set the vba to break only on unhandled errors, or it will break in the middle of the code.  See <a href=\"https://stackoverflow.com/questions/3440735/vba-error-handling-not-working-in-excel/3440789#3440789\">here</a>.</p>\n\n<p>Class Module - Hyper</p>\n\n<pre><code> Private shp As Shape\n Private chrStart As Integer\n Private hypAddr As String\n Private hypText As String\n\n Private Sub Class_Initialize()\n\n End Sub\n\n Public Sub InitializeWithValues(newShp As Shape, newChrStart As Integer, newHypAddress As String, newHypText As String)\n\n     Set shp = newShp\n     chrStart = newChrStart\n     hypAddr = newHypAddress\n     hypText = newHypText\n\n End Sub\n Public Function getShape() As Shape\n\n     Set getShape = shp\n\n End Function\n Public Function getchrStart() As Integer\n\n\n     getchrStart = chrStart\n End Function\n\n Public Function getHypAddr() As String\n\n     getHypAddr = hypAddr\n\n End Function\n\n Public Function getHypText() As String\n\n     getHypText = hypText\n\n End Function\n</code></pre>\n\n<p>Class Module - hyperColl</p>\n\n<pre><code> Private myCollection As Collection\n\n Private Sub Class_Initialize()\n\n     Set myCollection = New Collection\n\n  End Sub\n\n  Public Sub Add_Item(newHyper As Hyper)\n\n       Dim newArray() As Hyper\n       If Me.Exists(newHyper.getShape().Name) Then\n            newArray = myCollection(newHyper.getShape().Name)\n            ReDim Preserve newArray(0 To UBound(newArray) + 1)\n            Set newArray(UBound(newArray)) = newHyper\n            myCollection.Remove (newHyper.getShape().Name)\n            myCollection.Add newArray, newHyper.getShape().Name\n       Else\n            ReDim newArray(0)\n            Set newArray(0) = newHyper\n            myCollection.Add newArray, newHyper.getShape().Name\n       End If\n\n\n\n  End Sub\n  Public Function GetArray(shapeName As String) As Hyper()\n\n       GetArray = myCollection(shapeName)\n\n  End Function\n\n Public Function Exists(shapeName As String) As Boolean\n      Dim myHyper() As Hyper\n      On Error Resume Next\n      myHyper = myCollection(shapeName)\n      On Error GoTo 0\n      If Err.Number = 5 Then 'Not found in collection\n          Exists = False\n      Else\n          Exists = True\n      End If\n\n      Err.Clear\n\n  End Function\n</code></pre>\n\n<p>Regular Module (Call it whatever you want)</p>\n\n<pre><code> Sub textBoxFix()\n\n Dim sld As Slide\n Dim shp As Shape\n Dim shp2 As Shape\n Dim oHl As Hyperlink\n Dim hypAddr As String\n Dim hypText As String\n Dim hypTextLen As Integer\n Dim hypTextStart As Integer\n Dim hypShape As Shape\n Dim hypCollection As hyperColl\n Dim newHyper As Hyper\n Dim hypArray() As Hyper\n Dim hypToAdd As Hyper\n Dim i As Long\n Dim j As Long\n Dim bolCopy As Boolean\n\n Set sld = ActivePresentation.Slides(1)\n sld.CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(2)\n\n Set hypCollection = New hyperColl 'Set the collection of arrays - 1 for each shape\n\n Set shp = sld.Shapes(1)\n\n For Each oHl In sld.Hyperlinks\n\n     If oHl.Type = msoHyperlinkRange Then 'Hyperlink is associated with part of a TextRange, not a whole shape\n         hypAddr = oHl.Address\n         hypText = oHl.TextToDisplay\n         hypTextLen = Len(hypText)\n         If TypeName(oHl.Parent.Parent) = \"TextRange\" Then\n             hypTextStart = oHl.Parent.Parent.start\n             Set hypShape = oHl.Parent.Parent.Parent.Parent\n         End If\n         Set newHyper = New Hyper\n         newHyper.InitializeWithValues hypShape, hypTextStart, hypAddr, hypText\n         hypCollection.Add_Item newHyper\n     End If\n\n Next oHl\nFor j = sld.Shapes.Count To 1 Step -1\n     Set shp = sld.Shapes(j)\n     bolCopy = False\n     If j = 3 Then\n         Set shp2 = sld.Shapes.Placeholders.Item(1)\n         bolCopy = True\n    ElseIf j &gt; 3 And shp.Type = msoTextBox Then\n         Set shp2 = sld.Shapes.Placeholders.Item(2)\n         bolCopy = True\n    End If\n    If bolCopy = True Then\n         shp2.TextFrame.TextRange.InsertBefore(shp.TextFrame.TextRange.TrimText).ParagraphFormat.Bullet.Type =  shp.TextFrame.TextRange.ParagraphFormat.Bullet.Type\n         If hypCollection.Exists(shp.Name) Then\n              hypArray = hypCollection.GetArray(shp.Name)\n              For i = LBound(hypArray) To UBound(hypArray)\n                  Set hypToAdd = hypArray(i)\n                  With shp2.TextFrame.TextRange.Characters(hypToAdd.getchrStart, Len(hypToAdd.getHypText)).ActionSettings.Item(1)\n                       .Action = ppActionHyperlink\n                       .Hyperlink.Address = hypToAdd.getHypAddr\n                  End With\n              Next i\n         End If\n      End If\n      shp.Delete\n Next j\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 873, "user_id": 1197363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ca15e2b18c2941ca74e1334fb61a372?s=128&d=identicon&r=PG", "display_name": "jpsnow72", "link": "https://stackoverflow.com/users/1197363/jpsnow72"}, "is_accepted": true, "score": 0, "last_activity_date": 1457711246, "creation_date": 1457711246, "answer_id": 35944450, "question_id": 35755744, "link": "https://stackoverflow.com/questions/35755744/macro-for-ppt-move-textbox-contents-to-placeholder-maintain-links-and-lists/35944450#35944450", "title": "Macro for PPT - Move TextBox contents to Placeholder - Maintain links and lists", "body": "<p>I used OpiesDad's code as a starting point, and made some minor modifications.  I was getting an error related to the GetArray function when textboxes didn't exist.  In addition, I modified the code to run on all slides of the PPT. I also had to make some modifications to the TextBoxFix Sub because the content was being deleted, but wasn't populating in my Placeholders.</p>\n\n<p>See my updates below:</p>\n\n<p>Reused Class Module - Hyper</p>\n\n<p>Removed \"On Error GoTo 0\" from the Exists Function in hyperColl</p>\n\n<p>Revised TextBoxFix below:</p>\n\n<pre><code> Sub TextBoxFix()\n Dim shp As Shape\n Dim shp2 As Shape\n Dim oHl As Hyperlink\n Dim hypAddr As String\n Dim hypText As String\n Dim hypTextLen As Integer\n Dim hypTextStart As Integer\n Dim hypShape As Shape\n Dim hypCollection As hyperColl\n Dim newHyper As Hyper\n Dim hypArray() As Hyper\n Dim hypToAdd As Hyper\n Dim i As Long\n Dim j As Long\n Dim bolCopy As Boolean\n\n For Each sld In ActivePresentation.Slides\n With ActivePresentation\n sld.CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(2)\n\n Set hypCollection = New hyperColl 'Set the collection of arrays - 1 for each shape\n\n Set shp = sld.Shapes(1)\n\n For Each oHl In sld.Hyperlinks\n\n     If oHl.Type = msoHyperlinkRange Then 'Hyperlink is associated with part of a TextRange, not a whole shape\n         hypAddr = oHl.Address\n         hypText = oHl.TextToDisplay\n         hypTextLen = Len(hypText)\n         If TypeName(oHl.Parent.Parent) = \"TextRange\" Then\n             hypTextStart = oHl.Parent.Parent.Start\n             Set hypShape = oHl.Parent.Parent.Parent.Parent\n         End If\n         Set newHyper = New Hyper\n         newHyper.InitializeWithValues hypShape, hypTextStart, hypAddr, hypText\n         hypCollection.Add_Item newHyper\n     End If\n\n Next oHl\n    For j = sld.Shapes.Count To 1 Step -1\n     Set shp = sld.Shapes(j)\n     bolCopy = False\n     If j = 3 Then\n         sld.Shapes.Placeholders.Item(1).TextFrame.TextRange = shp.TextFrame.TextRange.Characters\n         sld.Shapes.Placeholders.Item(1).Visible = msoTrue\n         shp.Delete\n\n    ElseIf j &gt; 3 And shp.Type = msoTextBox Then\n      sld.Shapes.Placeholders.Item(2).TextFrame.TextRange.InsertBefore(shp.TextFrame.TextRange.TrimText).ParagraphFormat.Bullet.Type = shp.TextFrame.TextRange.ParagraphFormat.Bullet.Type\n         If hypCollection.Exists(shp.Name) Then\n              hypArray = hypCollection.GetArray(shp.Name)\n              For i = LBound(hypArray) To UBound(hypArray)\n                  Set hypToAdd = hypArray(i)\n                 With sld.Shapes.Placeholders.Item(2).TextFrame.TextRange.Characters(hypToAdd.getchrStart, Len(hypToAdd.getHypText)).ActionSettings.Item(1)\n                       .Action = ppActionHyperlink\n                       .Hyperlink.Address = hypToAdd.getHypAddr\n                 End With\n              Next i\n         End If\n\n       shp.Delete\n    End If\n Next j\n End With\n Next sld\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 1197363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ca15e2b18c2941ca74e1334fb61a372?s=128&d=identicon&r=PG", "display_name": "jpsnow72", "link": "https://stackoverflow.com/users/1197363/jpsnow72"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 35944450, "answer_count": 2, "score": 4, "last_activity_date": 1457711246, "creation_date": 1456944845, "last_edit_date": 1457413272, "question_id": 35755744, "link": "https://stackoverflow.com/questions/35755744/macro-for-ppt-move-textbox-contents-to-placeholder-maintain-links-and-lists", "title": "Macro for PPT - Move TextBox contents to Placeholder - Maintain links and lists", "body": "<p>I have PPTs that are being generated via software that I have no control over.  Upon generation, the software puts all text into TextBoxes instead of my Placeholders. </p>\n\n<p>I created a script to move the text from the TextBoxes into the placeholders and this works great; however, I am unable to maintain the links and the lists are always showing as Bulleted despite some being numbers.  Basically, if there is a link in the textbox, it should still be a link in the Placeholder.  FYI, this script also changes shape 3 on each slide into the Title Placeholder</p>\n\n<p>How can I preserve the formatting when I am moving the text over?  I attempted to use pastespecial, but that still was only moving the text into the format of the placeholder.</p>\n\n<pre><code>Sub TextBoxFix()\n   Dim osld As Slide, oshp As Shape, oTxR As TextRange, SlideIndex As Long, myCount As Integer, numShapesOnSlide As Integer\nDim tempBulletFormat As PowerPoint.PpBulletType\nFor Each osld In ActivePresentation.Slides\n    myCount = 1\n\n    With ActivePresentation\n    'For Each oshp In osld.Shapes\n    osld.CustomLayout = ActivePresentation.Designs(1).SlideMaster.CustomLayouts(2)\n    For i = osld.Shapes.Count To 1 Step -1\n        Set oshp = osld.Shapes(i)\n        If i = 3 Then\n            osld.Shapes.Placeholders.Item(1).TextFrame.TextRange = oshp.TextFrame.TextRange.Characters\n            osld.Shapes.Placeholders.Item(1).Visible = msoTrue\n            oshp.Delete\n          ElseIf i &gt; 3 And oshp.Type = msoTextBox Then\n          oshp.TextFrame.TextRange.Copy\n          osld.Shapes.Placeholders.Item(2).TextFrame.TextRange.InsertBefore(oshp.TextFrame.TextRange.TrimText).ParagraphFormat.Bullet.Type = oshp.TextFrame.TextRange.ParagraphFormat.Bullet.Type\n                   oshp.Delete\n           End If\n    Next i\n    End With\n Next osld\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "text", "numbers", "extract"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456944041, "post_id": 35755395, "comment_id": 59184197, "body": "I assume there are other words after the number?  Can you show the entire string in a couple of cells?"}, {"owner": {"reputation": 1, "user_id": 5884991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050532871676611/picture?type=large", "display_name": "Sas", "link": "https://stackoverflow.com/users/5884991/sas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456944641, "post_id": 35755395, "comment_id": 59184589, "body": "Amount due for 02/29/2016 is Based on the invnum:-1234567 The calculation is based on 123.33*3.0"}, {"owner": {"reputation": 1, "user_id": 5884991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050532871676611/picture?type=large", "display_name": "Sas", "link": "https://stackoverflow.com/users/5884991/sas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456944650, "post_id": 35755395, "comment_id": 59184597, "body": "Amount due for 03/01/2016 is Based on the invnum:-178634 The calculation is based on 345.90*56.85 amended as per request"}, {"owner": {"reputation": 1, "user_id": 5884991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050532871676611/picture?type=large", "display_name": "Sas", "link": "https://stackoverflow.com/users/5884991/sas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456944658, "post_id": 35755395, "comment_id": 59184601, "body": "Partial amount due for 03/02/2016 is Based on the invnum:-178634 The calculation is based on 89.54*5.32"}, {"owner": {"reputation": 1, "user_id": 5884991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050532871676611/picture?type=large", "display_name": "Sas", "link": "https://stackoverflow.com/users/5884991/sas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456944700, "post_id": 35755395, "comment_id": 59184630, "body": "Hi Scott - I have the above in Cells A1, A2, A3 and so on.."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 5884991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050532871676611/picture?type=large", "display_name": "Sas", "link": "https://stackoverflow.com/users/5884991/sas"}, "edited": false, "score": 0, "creation_date": 1456946065, "post_id": 35755795, "comment_id": 59185465, "body": "@Sas Please mark as correct, by clicking on the grey/green check mark by the answer.  It will mark the question as answered.  It is something only you can do."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1456945421, "last_edit_date": 1456945421, "creation_date": 1456944976, "answer_id": 35755795, "question_id": 35755395, "link": "https://stackoverflow.com/questions/35755395/extract-numbers-within-text-vba-excel/35755795#35755795", "title": "Extract numbers within text VBA/Excel", "body": "<p>Try this Function:</p>\n\n<pre><code>Function findNumber(inPtStr As String) As Double\n    Dim strArr() As String\n    Dim i As Long\n    inPtStr = Replace(inPtStr, \":\", \" \")\n    strArr = Split(inPtStr)\n    For i = LBound(strArr) To UBound(strArr)\n        If IsNumeric(strArr(i)) Then\n            findNumber = --strArr(i)\n            Exit Function\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>Then you can call it from a regular sub.</p>\n\n<p>If you want a formula then:</p>\n\n<pre><code>=--TRIM(MID(SUBSTITUTE(A1,\" \",REPT(\" \",99)),FIND(\"invnum:\",SUBSTITUTE(A1,\" \",REPT(\" \",99)))+7,99))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1456946851, "creation_date": 1456946851, "answer_id": 35756356, "question_id": 35755395, "link": "https://stackoverflow.com/questions/35755395/extract-numbers-within-text-vba-excel/35756356#35756356", "title": "Extract numbers within text VBA/Excel", "body": "<p>Let's get crazy and step through this...</p>\n\n<p>Start with the intermediate indexes you need to find, such as the start, end, and length of the numeric string. Once you have those, just <strong>carefully</strong> reassemble your formula:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eWdzm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eWdzm.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5884991, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050532871676611/picture?type=large", "display_name": "Sas", "link": "https://stackoverflow.com/users/5884991/sas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456946851, "creation_date": 1456943718, "last_edit_date": 1456943817, "question_id": 35755395, "link": "https://stackoverflow.com/questions/35755395/extract-numbers-within-text-vba-excel", "title": "Extract numbers within text VBA/Excel", "body": "<p>Looking for some suggestions to tweak/enhance the formula I have created, to extract the number from a string.</p>\n\n<p>Have the below sample text in a Cell A1:</p>\n\n<p>Based on the invnum:-1234567 The calculation is based on 123.33*3.00</p>\n\n<p>Wrote the below formula in B1</p>\n\n<pre><code>=VALUE(LEFT(MID(A1,FIND(\"invnum:-\",A1)+7,LEN((A1))),7)\n</code></pre>\n\n<p>the Result given is -1234567</p>\n\n<p>However, the length of the reference number on my source file is variable, Looking to extract only the number following the word invnum:-</p>\n\n<p>Looking to include this formula in a macro, so trying to keep it simple any ideas/suggestions please?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "edited": false, "score": 0, "creation_date": 1456943587, "post_id": 35755124, "comment_id": 59183933, "body": "So I figured out how to add in paste special as CTRL Q but I am still having difficulty with adding it into my right click options and I have no idea how to set the font and size of the text to the current settings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456943754, "post_id": 35755124, "comment_id": 59184027, "body": "Have you considered adding it to the QAT?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1456943822, "post_id": 35755124, "comment_id": 59184061, "body": "If you&#39;re pasting as unformatted text then it should be picking up the font settings of the target range. As it should when you paste manually? As to the right-click menu: for that you need to define a Ribbon XML customization. You&#39;ll find a list of resources at <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/ba8c9d0b-7312-4503-8167-f2ef86f17435/information-on-the-office-fluent-ui-ribbon-for-developers?forum=officegeneral\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>. The basics are in &quot;Customize the 2007 Office Fluent Ribbon for developers (1 of 3)&quot; and specifics about right-click menus in &quot;Customize context menus in Office 2010&quot;"}], "owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1457496908, "creation_date": 1456942795, "last_edit_date": 1457496908, "question_id": 35755124, "link": "https://stackoverflow.com/questions/35755124/microsoft-word-paste-special-paste-link-shortcut", "title": "Microsoft Word Paste Special Paste Link Shortcut", "body": "<p>I had a quick question in regards to using the paste special option in Microsoft Word. </p>\n\n<p>I want to set a shortcut so that I can do something like CTRL Q or right click and have the option and it would do paste special paste link and unformatted text and I want this to work in any word file I open. </p>\n\n<p>Ideally I would like the unformatted text to be the same font style and size as is currently set, but I know that this would be more difficult and I don't know how to do this in Word VBA. </p>\n\n<p>I know that I need to do something like:</p>\n\n<pre><code>public sub \n  PasteSpecialUnformatted()\n  selection.pastespecial Link:=True, datatype:=wdpastetext,\n  Placement:=_wdInLine, DisplayAsIcon:=False\nend sub\n</code></pre>\n\n<p>However, I have never done VBA programming in Excel so I don't know if my code is correct and I don't know how to edit the hot keys <strong><code>(ctrl + whatever)</code></strong> or the right click menu. </p>\n\n<p>Does anyone have any suggestions? I also should note that I am using Microsoft Version 2013.</p>\n"}, {"tags": ["vba", "excel", "event-handling"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1456946534, "post_id": 35754794, "comment_id": 59185769, "body": "Is there a particular reason why you created your own worksheet change event and you don&#39;t use the one provided by Excel? When creating a new sheet you could easily copy the macro over from another sheet: <a href=\"http://stackoverflow.com/questions/2595079/is-it-possible-to-copy-a-macro-from-one-excel-workbook-to-another-using-vba\" title=\"is it possible to copy a macro from one excel workbook to another using vba\">stackoverflow.com/questions/2595079/&hellip;</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456949452, "post_id": 35754794, "comment_id": 59187536, "body": "I suspect unprotecting the sheet clears the undo stack."}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1456949988, "post_id": 35754794, "comment_id": 59187868, "body": "Unprotecting the sheet shouldn&#39;t clear the undo stack. Protecting the sheet will. I tested this with short macros and was able to use Application.Undo after unprotecting a previously protected sheet"}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1456950136, "post_id": 35754794, "comment_id": 59187950, "body": "This would be easier to try to answer if I had a better idea of what order this all happened in and what the process was. As it is, I have no idea when this event is happening and on what sheet and when that sheet is being created."}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1456955794, "post_id": 35754794, "comment_id": 59191216, "body": "Hello @Ralph Thank you for replying, in regards to your question. I created the workbook from the macro and wanted to add events. I found a tutorial that stated to create your own events function, i forget the link where I got it from. Thank you for the idea tho def copying over would of been great choice too"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1456955956, "post_id": 35754794, "comment_id": 59191313, "body": "Hello @asp8811, The macro first creates the workbook and add the workbook class I created. The event code is located inside this class. this create happens on a function called templatecreat() which also adds a button. The button calls on another function called get data and this is where we see the Set Newbook.Workbook = ActiveWorkbook Set Newbook.m_events = Application Set thisWB = Newbook.Workbook"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1456956484, "post_id": 35754794, "comment_id": 59191585, "body": "I dont think is the protecting and the unprotecting of the sheet. the reason is because when I create the workbook and close it right away without pressing the get data button and re open it it works perfect"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1456957743, "post_id": 35754794, "comment_id": 59192232, "body": "Hello sorry for the multiple messages, I found a work around when I close the original workbook where it creates from the events work perfectly. My suspicion was the Application is retaining the application from that first notebook, is there a way to clear the stack for it and look at the new workbook that is created after I finished running the first function? thank you again for all your help!"}], "owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456941767, "creation_date": 1456941767, "last_edit_date": 1531164843, "question_id": 35754794, "link": "https://stackoverflow.com/questions/35754794/excel-event-not-working-properly", "title": "Excel Event not working properly", "body": "<p>Hello I am working on a macro that creates a new workbook and copies some information. Everything is working fine however I added an event, to highlight the color of the value depending if it was bigger or smaller than what it was before. The even was working perfectly until I realize the events dont work if i close and re open the sheet. So i tweeked my code a little bit to make it work. Now it only works when I re open the newworkbook but when I ran the macro and the new sheet opens and try to change a value I get the following error: Method 'Undo' of object '_Application' failed.</p>\n\n<p>In order to make the events work I created a class of work book an added the application as follows:</p>\n\n<pre><code> Public WithEvents m_events As Application\n</code></pre>\n\n<p>here is my sub for the change which works fine when re opening:</p>\n\n<pre><code>Private Sub m_wb_SheetChange(ByVal Sh As Object, ByVal Target As Range)\nm_events.EnableEvents = False\nm_wb.Sheets(\"sheet1\").Unprotect\nDim oldval As Double\nDim newval As Double\n    If Sh.name = \"Sheet1\" And Not IsEmpty(Target.Value) Then\n    newval = Target.Value\n    m_events.Undo\n    oldval = Target.Value\n    Target.Value = newval\n    If Target.Value &gt; oldval Then Target.Interior.ColorIndex = 35\n    If Target.Value &lt; oldval Then Target.Interior.ColorIndex = 22\n    'MsgBox (oldval)\nEnd If\nm_wb.Sheets(\"sheet1\").Protect\nm_events.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>When I create my sheet I use the following on the workbook that created the new sheet, I created a function to create the sheet:</p>\n\n<pre><code>Set Newbook.Workbook = AddNew\nSet Newbook.m_events = Application\n</code></pre>\n\n<p>On the new sheet I have a button and when pressed I have the following line that only works when i close and re open the new sheet.</p>\n\n<pre><code>Set Newbook.Workbook = ActiveWorkbook\nSet Newbook.m_events = Application\nSet thisWB = Newbook.Workbook\n</code></pre>\n\n<p>Thank you for all your help!</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456941448, "post_id": 35754637, "comment_id": 59182592, "body": "Use <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">REGEX</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456941741, "post_id": 35754637, "comment_id": 59182762, "body": "Or if there are always spaces surrounding the numbers you can you the Split Function then cycle through the array till you find the number and return that."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3333331, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a766ecfc5aa4a5a6e701d1564011012?s=128&d=identicon&r=PG&f=1", "display_name": "GunnRos86", "link": "https://stackoverflow.com/users/3333331/gunnros86"}, "edited": false, "score": 0, "creation_date": 1456942340, "post_id": 35754822, "comment_id": 59183131, "body": "I already checked it as correct and voted as helpful, as I&#39;ve already run it for various input/cells and it works perfectly!! Well done Sorceri, many thanks!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456942518, "post_id": 35754822, "comment_id": 59183246, "body": "FWIW, If any of the numbers have decimal places then this will remove the decimal marker, as in 3.5 will become 35.  But I agree this is a great method."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1456942119, "last_edit_date": 1456942119, "creation_date": 1456941843, "answer_id": 35754822, "question_id": 35754637, "link": "https://stackoverflow.com/questions/35754637/read-a-cells-value-and-extract-the-number-that-it-is-contained/35754822#35754822", "title": "Read a cell&#39;s value and extract the number that it is contained", "body": "<p>You can loop through each character in the string and check to see if it is numeric.  this will work for values 0-9.  If there are values higher you would need to adjust this to look for multiple digits and not exit once the first one is found.</p>\n\n<pre><code>Public Function GetMyDigit(cell As Range) As Integer\nDim s As String\nDim i As Integer\n\n'get cell value\ns = cell.Value\n\n'loop through the entire string\nFor i = 1 To Len(s)\n    'check to see if the character is a numeric one\n    If IsNumeric(Mid(s, i, 1)) = True Then\n        'set the function to the value and exit\n        GetMyDigit = Mid(s, i, 1)\n        Exit Function\n    End If\nNext i\nEnd Function\n</code></pre>\n\n<p>and if you have multiple digits</p>\n\n<pre><code>Public Function GetMyDigit(cell As Range)\nDim s As String\nDim i As Integer\nDim answer\n'get cell value\ns = cell.Value\n\n'loop through the entire string\nFor i = 1 To Len(s)\n    'check to see if the character is a numeric one\n    If IsNumeric(Mid(s, i, 1)) = True Then\n        'set the function to the value and exit\n        answer = answer &amp; Mid(s, i, 1)\n    End If\nNext i\n GetMyDigit = answer\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 41, "user_id": 3333331, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a766ecfc5aa4a5a6e701d1564011012?s=128&d=identicon&r=PG&f=1", "display_name": "GunnRos86", "link": "https://stackoverflow.com/users/3333331/gunnros86"}, "edited": false, "score": 0, "creation_date": 1456948010, "post_id": 35754943, "comment_id": 59186638, "body": "@user3333331 Just so you know, you can only mark one as correct.  Mark the one you use.  If you used sorceri then keep his as the correct one, If you used mine then leave mine as marked.  It will not hurt our feelings if you choose the other."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1456942269, "creation_date": 1456942269, "answer_id": 35754943, "question_id": 35754637, "link": "https://stackoverflow.com/questions/35754637/read-a-cells-value-and-extract-the-number-that-it-is-contained/35754943#35754943", "title": "Read a cell&#39;s value and extract the number that it is contained", "body": "<p>Just to give another method:</p>\n\n<pre><code>Function findNumber(inPtStr As String) As Double\n    Dim strArr() As String\n    Dim i As Long\n    strArr = Split(inPtStr)\n    For i = LBound(strArr) To UBound(strArr)\n        If IsNumeric(strArr(i)) Then\n            findNumber = --strArr(i)\n            Exit Function\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3333331, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a766ecfc5aa4a5a6e701d1564011012?s=128&d=identicon&r=PG&f=1", "display_name": "GunnRos86", "link": "https://stackoverflow.com/users/3333331/gunnros86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456942269, "creation_date": 1456941241, "last_edit_date": 1531161705, "question_id": 35754637, "link": "https://stackoverflow.com/questions/35754637/read-a-cells-value-and-extract-the-number-that-it-is-contained", "title": "Read a cell&#39;s value and extract the number that it is contained", "body": "<p>The cells of a specific range contain information of the form <code>Check. 3 months</code> or <code>Dep. 2 months</code>. I need embed vba so to read these cells and every time extract, that is output, the number that it is contained. </p>\n\n<p><b>Edit:</B> I know that there are functions when you know what you're searching for but for what I describe I am not aware of anything</p>\n\n<p>Can you help please as I haven't encounter a similar task in the past. </p>\n"}, {"tags": ["vba", "parsing", "xpath", "nodes"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456941679, "post_id": 35754509, "comment_id": 59182728, "body": "&quot;the XML below causes much heartache&quot; - how so ? You should be able to check whether your Xpath query returns a hit or not.  Would help your question a to include the code you&#39;re using."}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456942946, "post_id": 35754509, "comment_id": 59183527, "body": "Ok, I&#39;ve added the code - hopefully it&#39;ll be clearer about me wanting to &#39;test&#39; to see if a path exists first."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456943478, "post_id": 35754509, "comment_id": 59183859, "body": "<code>SelectNodes</code> return an empty collection if no hits were found, so test that <code>objxmlASIN.Length</code> is not zero before trying to access any of the content"}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456944098, "post_id": 35754509, "comment_id": 59184235, "body": "Hi Tim, I found a few references to the .length suffix on the net, but (embarrassingly) I don&#39;t know how to test  objxmlASIN.Length ...can you give a quick example of generic VBA code to test it&#39;s is not zero?!! (still finding my feet &amp; parsing XML has been a head trip!)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456946189, "post_id": 35754509, "comment_id": 59185560, "body": "Your XML screenshot is hard to follow in that format - consider using something like <a href=\"https://www.samltool.com/prettyprint.php\" rel=\"nofollow noreferrer\">samltool.com/prettyprint.php</a> instead."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1457362702, "post_id": 35754509, "comment_id": 59359168, "body": "Don&#39;t forget to pick one of the answers as accepted when your problem is solved."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1458133948, "post_id": 35754509, "comment_id": 59722352, "body": "Please pick one of the answers as accepted already. Walking away from your question is rude"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456945555, "post_id": 35755601, "comment_id": 59185151, "body": "Hello Tomalak, thank you for your contribution...as you&#39;ve surely gathered, I&#39;m relatively new to coding.....I welcome the chance to enhance the code I use. That said, I&#39;m getting a Compile error (syntax error) with     <b>If Not ASIN Is Nothing And Not Price Is Nothing</b>       .....your  use of &quot;Not&quot; &amp; &quot;Nothing&quot; in the code....can you clarify what&#39;s going on there?!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456945797, "post_id": 35755601, "comment_id": 59185307, "body": "<code>SelectSingleNode</code> returns <code>Nothing</code> if it doesn&#39;t find a match, whereas <code>selectNodes</code> returns an <i>empty collection</i> (not <code>Nothing</code>)"}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 1, "creation_date": 1456946113, "post_id": 35755601, "comment_id": 59185502, "body": "Thank you...this looks interesting, I&#39;ve sorted the compile error (it was missing a &#39;then&#39; ....off to have a dabble :-)"}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456948301, "post_id": 35755601, "comment_id": 59186823, "body": "When I run the your suggested code, it&#39;s got a problem with this line... <b>Set PricingResults = objxlm.selectNodes(&quot;//ns1:GetCompetitivePricingForASINResult&zwnj;&#8203;&quot;)</b> ....if it helps, my original question now has the XML pasted within (&amp; more code pasted in at the top too...just to assist you seeing what I&#39;m up to)."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456948555, "post_id": 35755601, "comment_id": 59187001, "body": "@peskywinnets Yes, I&#39;ve renamed your variables. Don&#39;t just copy and paste my code. ;) Also, what&#39;s &quot;a problem&quot;?"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1456950418, "post_id": 35755601, "comment_id": 59188118, "body": "From your added XML, one XPath was not right. (<a href=\"http://stackoverflow.com/posts/35755601/revisions#rev-arrow-92af8977-d863-4b08-abc3-43abfc13fc51\">Compare</a>)."}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456952122, "post_id": 35755601, "comment_id": 59189087, "body": "works like a charm (so much more elegant than my initial code), one last question, how to I pull out an attribute with the following Xpath.../GetCompetitivePricingForASINResponse/GetCompetitive&zwnj;&#8203;PricingForASINResult&zwnj;&#8203;/Product/Competitive&zwnj;&#8203;Pricing/CompetitiveP&zwnj;&#8203;rices/CompetitivePri&zwnj;&#8203;ce@belongsToRequeste&zwnj;&#8203;r   (the result should be either true or false) ...what command do I need to use in the loop?"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1456956462, "post_id": 35755601, "comment_id": 59191571, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/ms761380%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>getAttribute()</code></a> on <code>Price</code>."}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456957882, "post_id": 35755601, "comment_id": 59192309, "body": "Thanks, I tried a few permutations, this one seems to do what I want... <b>belongsToRequester = objxmldoc.selectSingleNode(&quot;.//ns1:CompetitivePrice&quot;).Attrib&zwnj;&#8203;utes.getNamedItem(&quot;b&zwnj;&#8203;elongsToRequester&quot;).&zwnj;&#8203;text</b>"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1456985455, "post_id": 35755601, "comment_id": 59201298, "body": "No, that&#39;s incorrect. I think you misunderstood my previous comment. :)"}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1457012278, "post_id": 35755601, "comment_id": 59218676, "body": "because I&#39;m not familiar with any of this, I didn&#39;t fully understand how to implement your suggestion, so I took to Google (Alas, most of this stuff relating to parsing XML is not VBA, so then I have to try &amp; pick the bones out of what I&#39;m seeing). Anyway, all is good here, because for all I may have misnterpreted your comment, what i have here now works, which was to use  **belongsToRequester = result.selectSingleNode(&quot;.//ns1:CompetitivePrice&quot;).Attribute&zwnj;&#8203;s.getNamedItem(&quot;belo&zwnj;&#8203;ngsToRequester&quot;).tex&zwnj;&#8203;t **...though  if you have a different command more aligned with your suggestion, I&#39;m all ears :-)"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1457015322, "post_id": 35755601, "comment_id": 59221052, "body": "<i>&quot;<code>getAttribute()</code> on <code>Price</code>&quot;</i> means <code>Price.getAttribute(&quot;CompetitivePrice&quot;)</code>. I had hoped that I did not have to spell it out for you."}], "tags": [], "owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "is_accepted": false, "score": 0, "last_activity_date": 1456950282, "last_edit_date": 1456950282, "creation_date": 1456944390, "answer_id": 35755601, "question_id": 35754509, "link": "https://stackoverflow.com/questions/35754509/xml-how-to-establish-if-a-node-exists-in-vba-before-using-an-xpath-command-on-it/35755601#35755601", "title": "XML how to establish if a node exists in VBA before using an Xpath command on it", "body": "<ol>\n<li>You have a <code>For Each</code> loop, what's going on with this index counter? </li>\n<li>Use relative XPaths (starting with <code>./</code>).</li>\n<li>Use <code>SelectSingleNode</code> if you only expect one result.</li>\n<li>Don't use objects that might be set to <code>Nothing</code>.</li>\n</ol>\n\n<p>Better:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set PricingResults =  doc.SelectNodes(\"//ns1:GetCompetitivePricingForASINResult\")\n\nFor Each Result In PricingResults\n    Set ASIN = Result.SelectSingleNode(\".//ns1:ASIN\")\n    Set Price = Result.SelectSingleNode(\".//ns1:CompetitivePrice\") \n\n    If Not ASIN Is Nothing And Not Price Is Nothing Then\n        Debug.Print ASIN.text + \",\" + Price.text \n    End If\nNext\n</code></pre>\n\n<p>In an unrelated note, I'd recommend to drop the Hungarian notation. So much typing and no real benefit.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456947542, "post_id": 35756117, "comment_id": 59186384, "body": "I&#39;m getting a type mismatch...what should objxmlASIN be declared as when using the <b>.length</b> suffix  (I presently have it as <b>Dim objxmlASIN As MSXML2.IXMLDOMNodeList</b> )"}, {"owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "edited": false, "score": 0, "creation_date": 1456952332, "post_id": 35756117, "comment_id": 59189208, "body": "Thanks...i have done &amp; what he provided is working great :-) (thank you for your contribution too)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1456946026, "creation_date": 1456946026, "answer_id": 35756117, "question_id": 35754509, "link": "https://stackoverflow.com/questions/35754509/xml-how-to-establish-if-a-node-exists-in-vba-before-using-an-xpath-command-on-it/35756117#35756117", "title": "XML how to establish if a node exists in VBA before using an Xpath command on it", "body": "<p><code>SelectNodes</code> return an empty collection if no hits were found, so test that <code>objxmlASIN.Length</code> is not zero before trying to access any of the content</p>\n\n<pre><code>If objxmlASIN.Length &gt;0 Then\n    Debug.print \"OK\"\nElse\n    Debug.print \"No Match!\"\nEnd If   \n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5864609, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/c87e0b3fc3042250e8bef9d11818d369?s=128&d=identicon&r=PG&f=1", "display_name": "peskywinnets", "link": "https://stackoverflow.com/users/5864609/peskywinnets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 878, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456952274, "creation_date": 1456940862, "last_edit_date": 1456952274, "question_id": 35754509, "link": "https://stackoverflow.com/questions/35754509/xml-how-to-establish-if-a-node-exists-in-vba-before-using-an-xpath-command-on-it", "title": "XML how to establish if a node exists in VBA before using an Xpath command on it", "body": "<p>I've some XML that <em>sometimes</em> has specific content that's present and other times it's not present in the XML. When this data is not present it causes my VBA parsing routine to barf. I therefore need to test a specific path to see if it exists prior to trying to grab the data.</p>\n\n<pre><code>Dim objxmldoc As New MSXML2.DOMDocument60   \n\nXMLHttpRequest.Open \"GET\", SignedURL, False\n\nXMLHttpRequest.send (SignedURL)\n\nobjxmldoc.loadXML (XMLHttpRequest.responseXML.XML)\n\nxmlNamespaces = \"xmlns:ns2='http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd' \" _\n                      &amp; \"xmlns:ns1='http://mws.amazonservices.com/schema/Products/2011-10-01'\"\nobjxmldoc.SetProperty \"SelectionNamespaces\", xmlNamespaces\n\n\nSet NoOfASINs = objxmldoc.selectNodes(\"//ns1:GetCompetitivePricingForASINResult\")\n\ni = 0\nFor Each n In NoOfASINs\n    Set objxmlASIN = objxmldoc.selectNodes(\"/ns1:ASIN\")\n    Set objXMLPrice = objxmldoc.selectNodes(\"/ns1:Product/ns1:CompetitivePricing/ns1:CompetitivePrices/ns1:CompetitivePrice\") \n\n    Debug.Print objxmlASIN(i).text + \",\" + objXMLPrice(i).text \n    i = i + 1\nNext\n</code></pre>\n\n<p>Sometimes there's nothing underneath <code>/ns1:Product/ns1:CompetitivePricing/ns1:CompetitivePrices</code> ... so I need to test first.</p>\n\n<pre><code>&lt;GetCompetitivePricingForASINResponse xmlns=\"http://mws.amazonservices.com/schema/Products/2011-10-01\"&gt;\n       &lt;GetCompetitivePricingForASINResult ASIN=\"B002NJHGN6\" status=\"Success\"&gt;\n              &lt;Product xmlns=\"http://mws.amazonservices.com/schema/Products/2011-10-01\" xmlns:ns2=\"http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd\"&gt;\n                     &lt;Identifiers&gt;\n                            &lt;MarketplaceASIN&gt;\n                                   &lt;MarketplaceId&gt;A1F83G8C2ARO7P&lt;/MarketplaceId&gt;\n                                   &lt;ASIN&gt;B002NJHGN6&lt;/ASIN&gt;\n                               &lt;/MarketplaceASIN&gt;\n                        &lt;/Identifiers&gt;\n                     &lt;CompetitivePricing&gt;\n                            &lt;CompetitivePrices&gt;\n                                   &lt;CompetitivePrice belongsToRequester=\"true\" condition=\"New\" subcondition=\"New\"&gt;\n                                          &lt;CompetitivePriceId&gt;1&lt;/CompetitivePriceId&gt;\n                                          &lt;Price&gt;\n                                                 &lt;LandedPrice&gt;\n                                                        &lt;CurrencyCode&gt;GBP&lt;/CurrencyCode&gt;\n                                                        &lt;Amount&gt;17.69&lt;/Amount&gt;\n                                                    &lt;/LandedPrice&gt;\n                                                 &lt;ListingPrice&gt;\n                                                        &lt;CurrencyCode&gt;GBP&lt;/CurrencyCode&gt;\n                                                        &lt;Amount&gt;17.69&lt;/Amount&gt;\n                                                    &lt;/ListingPrice&gt;\n                                                 &lt;Shipping&gt;\n                                                        &lt;CurrencyCode&gt;GBP&lt;/CurrencyCode&gt;\n                                                        &lt;Amount&gt;0.00&lt;/Amount&gt;\n                                                    &lt;/Shipping&gt;\n                                             &lt;/Price&gt;\n                                      &lt;/CompetitivePrice&gt;\n                               &lt;/CompetitivePrices&gt;\n                            &lt;NumberOfOfferListings&gt;\n                                   &lt;OfferListingCount condition=\"New\"&gt;16&lt;/OfferListingCount&gt;\n                                   &lt;OfferListingCount condition=\"Any\"&gt;16&lt;/OfferListingCount&gt;\n                               &lt;/NumberOfOfferListings&gt;\n                        &lt;/CompetitivePricing&gt;\n                     &lt;SalesRankings&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;home_improvement_display_on_website&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;10299&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;home_and_garden_display_on_website&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;51823&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;1939047031&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;28&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                        &lt;/SalesRankings&gt;\n                 &lt;/Product&gt;\n          &lt;/GetCompetitivePricingForASINResult&gt;\n       &lt;GetCompetitivePricingForASINResult ASIN=\"B003F9MNF4\" status=\"Success\"&gt;\n              &lt;Product xmlns=\"http://mws.amazonservices.com/schema/Products/2011-10-01\" xmlns:ns2=\"http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd\"&gt;\n                     &lt;Identifiers&gt;\n                            &lt;MarketplaceASIN&gt;\n                                   &lt;MarketplaceId&gt;A1F83G8C2ARO7P&lt;/MarketplaceId&gt;\n                                   &lt;ASIN&gt;B003F9MNF4&lt;/ASIN&gt;\n                               &lt;/MarketplaceASIN&gt;\n                        &lt;/Identifiers&gt;\n                     &lt;CompetitivePricing&gt;\n                            &lt;CompetitivePrices&gt;&lt;/CompetitivePrices&gt;\n                            &lt;NumberOfOfferListings&gt;\n                                   &lt;OfferListingCount condition=\"New\"&gt;2&lt;/OfferListingCount&gt;\n                                   &lt;OfferListingCount condition=\"Any\"&gt;2&lt;/OfferListingCount&gt;\n                               &lt;/NumberOfOfferListings&gt;\n                        &lt;/CompetitivePricing&gt;\n                     &lt;SalesRankings&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;home_improvement_display_on_website&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;141917&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;home_and_garden_display_on_website&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;892073&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;1939038031&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;868&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                        &lt;/SalesRankings&gt;\n                 &lt;/Product&gt;\n          &lt;/GetCompetitivePricingForASINResult&gt;\n       &lt;GetCompetitivePricingForASINResult ASIN=\"B002F9nNFY\" status=\"Success\"&gt;\n              &lt;Product xmlns=\"http://mws.amazonservices.com/schema/Products/2011-10-01\" xmlns:ns2=\"http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd\"&gt;\n                     &lt;Identifiers&gt;\n                            &lt;MarketplaceASIN&gt;\n                                   &lt;MarketplaceId&gt;A1F83G8C2ARO7P&lt;/MarketplaceId&gt;\n                                   &lt;ASIN&gt;B002F9nNFY&lt;/ASIN&gt;\n                               &lt;/MarketplaceASIN&gt;\n                        &lt;/Identifiers&gt;\n                     &lt;CompetitivePricing&gt;\n                            &lt;CompetitivePrices&gt;\n                                   &lt;CompetitivePrice belongsToRequester=\"true\" condition=\"New\" subcondition=\"New\"&gt;\n                                          &lt;CompetitivePriceId&gt;1&lt;/CompetitivePriceId&gt;\n                                          &lt;Price&gt;\n                                                 &lt;LandedPrice&gt;\n                                                        &lt;CurrencyCode&gt;GBP&lt;/CurrencyCode&gt;\n                                                        &lt;Amount&gt;113.99&lt;/Amount&gt;\n                                                    &lt;/LandedPrice&gt;\n                                                 &lt;ListingPrice&gt;\n                                                        &lt;CurrencyCode&gt;GBP&lt;/CurrencyCode&gt;\n                                                        &lt;Amount&gt;113.99&lt;/Amount&gt;\n                                                    &lt;/ListingPrice&gt;\n                                                 &lt;Shipping&gt;\n                                                        &lt;CurrencyCode&gt;GBP&lt;/CurrencyCode&gt;\n                                                        &lt;Amount&gt;0.00&lt;/Amount&gt;\n                                                    &lt;/Shipping&gt;\n                                             &lt;/Price&gt;\n                                      &lt;/CompetitivePrice&gt;\n                               &lt;/CompetitivePrices&gt;\n                            &lt;NumberOfOfferListings&gt;\n                                   &lt;OfferListingCount condition=\"New\"&gt;2&lt;/OfferListingCount&gt;\n                                   &lt;OfferListingCount condition=\"Any\"&gt;2&lt;/OfferListingCount&gt;\n                               &lt;/NumberOfOfferListings&gt;\n                        &lt;/CompetitivePricing&gt;\n                     &lt;SalesRankings&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;home_improvement_display_on_website&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;170655&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;home_and_garden_display_on_website&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;1098520&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                            &lt;SalesRank&gt;\n                                   &lt;ProductCategoryId&gt;1939038031&lt;/ProductCategoryId&gt;\n                                   &lt;Rank&gt;1031&lt;/Rank&gt;\n                               &lt;/SalesRank&gt;\n                        &lt;/SalesRankings&gt;\n                 &lt;/Product&gt;\n          &lt;/GetCompetitivePricingForASINResult&gt;\n       &lt;ResponseMetadata&gt;\n              &lt;RequestId&gt;efa320b7-0162-49fc-a328-2f8d93f55f2f&lt;/RequestId&gt;\n          &lt;/ResponseMetadata&gt;\n   &lt;/GetCompetitivePricingForASINResponse&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting", "filtering"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456939987, "post_id": 35754148, "comment_id": 59181636, "body": "Have you considered sorting first and then filtering?"}, {"owner": {"reputation": 1, "user_id": 6009220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b7afb9011261d007b965ba0e0e09ae?s=128&d=identicon&r=PG&f=1", "display_name": "KSharp", "link": "https://stackoverflow.com/users/6009220/ksharp"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456942932, "post_id": 35754148, "comment_id": 59183520, "body": "I tried that and got the same error....in the same place"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6009220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b7afb9011261d007b965ba0e0e09ae?s=128&d=identicon&r=PG&f=1", "display_name": "KSharp", "link": "https://stackoverflow.com/users/6009220/ksharp"}, "edited": false, "score": 0, "creation_date": 1456951053, "post_id": 35756776, "comment_id": 59188469, "body": "I tried the code above...it highlighted &quot;Range&quot; in the third line and gave the same error message."}], "tags": [], "owner": {"reputation": 208, "user_id": 5615421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e5Rqn.png?s=128&g=1", "display_name": "Herry Markowitz", "link": "https://stackoverflow.com/users/5615421/herry-markowitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1456948231, "creation_date": 1456948231, "answer_id": 35756776, "question_id": 35754148, "link": "https://stackoverflow.com/questions/35754148/how-to-sort-filtered-data-in-vba/35756776#35756776", "title": "How to sort filtered data in vba?", "body": "<p>Following code will help you...</p>\n\n<pre><code>Sheets(\"Finnet\").Select\nSheets(\"Finnet\").AutoFilterMode = False\nSheets(\"Finnet\").Range(\"A1\", Range(\"XFD1\").End(xlToLeft)).Select\nSheets(\"Finnet\").Range(Selection, Range(\"A\" &amp; Rows.Count).End(xlUp)).AutoFilter\nSheets(\"Finnet\").AutoFilter.Sort.SortFields.Add Key:=Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row), SortOn:=xlSortOnValues, Order:=xlAscending\nSheets(\"Finnet\").AutoFilter.Sort.Header = xlYes\nSheets(\"Finnet\").AutoFilter.Sort.Apply\nSheets(\"Finnet\").AutoFilterMode = False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6009220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b7afb9011261d007b965ba0e0e09ae?s=128&d=identicon&r=PG&f=1", "display_name": "KSharp", "link": "https://stackoverflow.com/users/6009220/ksharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473274570, "creation_date": 1456939712, "last_edit_date": 1456968501, "question_id": 35754148, "link": "https://stackoverflow.com/questions/35754148/how-to-sort-filtered-data-in-vba", "title": "How to sort filtered data in vba?", "body": "<p>I have a worksheet populated with data.  I need to filter the data that could  only show the info <code>w/in 5 miles</code>.  Once the data is filtered to <code>w/in 5 miles</code>, I need to sort the variance column in ascending order.  I used a record macro and attempted to incorporate it.  The filtering works fine but I get an error saying: </p>\n\n<blockquote>\n  <p>Compile Error: Expected Array</p>\n</blockquote>\n\n<p>when I run it.  Here is a snippet of my code.  When the error pops up, the <code>Range</code> is highlighted on the 6th line of code.</p>\n\n<pre><code>.Worksheets(\"Market Work\").Cells.Select\nSelection.AutoFilter\n.Worksheets(\"Market Work\").Range(\"$A$1:$Q$\" &amp; RowLast2).AutoFilter Field:=5, Criteria1:= _\n    \"w/in 5 miles\"\n\n\nActiveWorkbook.Worksheets(\"Market Work\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Market Work\").Sort.SortFields.Add Key:=Range( _\n    \"G2:G112\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Market Work\").Sort\n    .SetRange Range(\"A1:Q112\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456939316, "post_id": 35753791, "comment_id": 59181204, "body": "It is supposed to take the first selection in the list. You can see above the functions <code>TopSelectedIndex</code> and <code>TopSelectedValue</code> which accomplish this."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1456940740, "post_id": 35753791, "comment_id": 59182103, "body": "<a href=\"http://stackoverflow.com/questions/27128088/vba-excel-activex-listbox-change-event-recursive-behaviour\" title=\"vba excel activex listbox change event recursive behaviour\">stackoverflow.com/questions/27128088/&hellip;</a> - it must be related to this. If you step through it, it works."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456941158, "post_id": 35753791, "comment_id": 59182392, "body": "@Raystafarian looks like _Change event works fine. Thanks for that! I wonder why _Click doesn&#39;t work?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1456941238, "post_id": 35753791, "comment_id": 59182443, "body": "I&#39;m not sure, it must a weird event handler thing - I wonder if it happens to non Active-x controls"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456940288, "creation_date": 1456938613, "last_edit_date": 1456939271, "question_id": 35753791, "link": "https://stackoverflow.com/questions/35753791/change-text-box-when-selection-is-made-in-list-box", "title": "Change text-box when selection is made in list-box", "body": "<p>I have a user-form with 2 List-boxes and two corresponding Text-boxes. When I make a selection in a list-box, I want its corresponding text-box to update to have that same value. I have arranged functions like this to accomplish it within my user-form:</p>\n\n<pre><code>Private Sub ListBox1_Click()\n    TextBox1.Value = TopSelectedValue(ListBox1)\nEnd Sub\n\nPrivate Sub ListBox2_Click()\n    TextBox2.Value = TopSelectedValue(ListBox2)\nEnd Sub\n\nFunction TopSelectedValue(myBox As MSForms.ListBox) As String\n    'Finds value of first selected item in ListBox\n    Select Case myBox.MultiSelect\n        Case fmMultiSelectSingle\n            TopSelectedValue = myBox.Value\n        Case fmMultiSelectMulti, fmMultiSelectExtended\n            TopSelectedValue = myBox.List(TopSelectedIndex(myBox))\n    End Select\nEnd Function\n\nFunction TopSelectedIndex(myBox As MSForms.ListBox) As Integer  \n    Dim k As Integer\n    Select Case myBox.MultiSelect                        \n        Case fmMultiSelectSingle                         \n            TopSelectedIndex = myBox.ListIndex           \n        Case fmMultiSelectMulti, fmMultiSelectExtended   \n            For k = 0 To myBox.ListCount - 1             \n                If myBox.Selected(k) = True Then         \n                    TopSelectedIndex = k                 \n                    Exit Function                        \n                End If\n            Next k\n            TopSelectedIndex = -1                        \n    End Select\nEnd Function\n</code></pre>\n\n<p>Note: <code>ListBox1</code> is single select, <code>ListBox2</code> is multi-select.</p>\n\n<p>The problem is, everything works perfectly fine for <code>ListBox1</code> (<code>TextBox1</code> updates on cue when <code>ListBox1</code> changes) but nothing happens to <code>TextBox2</code> when <code>ListBox2</code> is selected or changes.</p>\n\n<p>I tried to fix it by adding this type of code to somehow reset the selections, but this also failed to help:</p>\n\n<pre><code>Private Sub ListBox1_Click()\n    TextBox1.Value = TopSelectedValue(ListBox1)\n    Dim C As MSForms.Control\n    For Each C In Me.Controls\n        If TypeOf C Is MSForms.ListBox Then C.ListIndex = -1\n    Next C\nEnd Sub\n</code></pre>\n\n<p>Why aren't both list-box/text-box relationships behaving the same way, and what can I do to fix this?</p>\n"}, {"tags": ["excel", "ms-office", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456940939, "post_id": 35753754, "comment_id": 59182229, "body": "Typically here on SO you&#39;re expected to post some existing code (even if it doesn&#39;t quite work) when asking for help.  At the very least you need to ask a *specific&quot; question about some aspect of your project you&#39;re having a problem with. Questions which are a set of requirements followed by &quot;Someone please write this for me&quot;  typically get closed pretty quickly."}, {"owner": {"reputation": 3, "user_id": 5913867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dPjhqou4GO8/AAAAAAAAAAI/AAAAAAAABUU/azTdI7CTRf4/photo.jpg?sz=128", "display_name": "Daniele Casciaro", "link": "https://stackoverflow.com/users/5913867/daniele-casciaro"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456955452, "post_id": 35753754, "comment_id": 59191026, "body": "Thanks for the feedback. I will try and create a rough version myself then, and ask for help later."}, {"owner": {"reputation": 3, "user_id": 5913867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dPjhqou4GO8/AAAAAAAAAAI/AAAAAAAABUU/azTdI7CTRf4/photo.jpg?sz=128", "display_name": "Daniele Casciaro", "link": "https://stackoverflow.com/users/5913867/daniele-casciaro"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457384152, "post_id": 35753754, "comment_id": 59373377, "body": "@TimWilliams I tried to solve it myself, but I got stuck at the final point. The code is up in the text. Given that I didn&#39;t know what code was a week ago, I feel very happy about what I achieved, and even if it was extremely inefficient, I was happy to learn and work my way out of the problems I faced. Can you help me with the last bit of the project? I would really appreciate."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5913867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dPjhqou4GO8/AAAAAAAAAAI/AAAAAAAABUU/azTdI7CTRf4/photo.jpg?sz=128", "display_name": "Daniele Casciaro", "link": "https://stackoverflow.com/users/5913867/daniele-casciaro"}, "edited": false, "score": 0, "creation_date": 1457517694, "post_id": 35855210, "comment_id": 59437949, "body": "Thank you Tim. That formula works perfectly. Now I will try to automatise my flight plan process even more by trying to tell Excel to pull the data to do this very job from a data pool on another sheet instead of having to insert it into a Userform for every data row. In case I have a question to post on SO (after having looked for similar posts in order not to create duplications) should I create a new question or follow into this one? I think I should create a new one, as it&#39;s a different task I need Excel to do on top of this one.   Anyways, thanks again and wish me luck! :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 5913867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dPjhqou4GO8/AAAAAAAAAAI/AAAAAAAABUU/azTdI7CTRf4/photo.jpg?sz=128", "display_name": "Daniele Casciaro", "link": "https://stackoverflow.com/users/5913867/daniele-casciaro"}, "edited": false, "score": 0, "creation_date": 1457537445, "post_id": 35855210, "comment_id": 59452243, "body": "I would create a new question if you have a new requirement.  And good luck!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1457389030, "creation_date": 1457389030, "answer_id": 35855210, "question_id": 35753754, "link": "https://stackoverflow.com/questions/35753754/excel-vba-create-multiple-data-strings-on-a-weekly-basis-from-start-date-to-en/35855210#35855210", "title": "Excel VBA - Create multiple data strings on a weekly basis from start date to ending date", "body": "<p>Try this:</p>\n\n<pre><code>Sub AddFlight_Click()\n\n    Const RNG_END_DT As String = \"P2\"\n    Dim NextRow As Long, LastRow As Long, ws As Worksheet\n\n    Set ws = Sheets(\"JetAir Flight Plan\")\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    NextRow = LastRow + 1\n\n    'Data inserted in a userform are assigned to specific cells in a sheet.\n    ws.Range(\"A\" &amp; NextRow).Value = StartingFlightDateComboBox.Text\n    ws.Range(\"B\" &amp; NextRow).Value = DayOfWeekComboBox.Text\n    ws.Range(\"D\" &amp; NextRow).Value = ETATextBox.Text\n    ws.Range(\"E\" &amp; NextRow).Value = TourOperatorTextBox.Text\n    ws.Range(\"F\" &amp; NextRow).Value = FlightNumberTextBox.Text\n    ws.Range(\"G\" &amp; NextRow).Value = FromToTextBox.Text\n    ws.Range(\"H\" &amp; NextRow).Value = AllotmentTextBox.Text\n    ws.Range(RNG_END_DT).Value = EndingFlightDateComboBox.Text\n\n    'A series of dates is created from a starting date\n    '    to an ending date in column A.\n    ws.Range(\"A\" &amp; NextRow).DataSeries Rowcol:=xlColumns, _\n        Type:=xlChronological, Date:=xlDay, Step:=7, _\n        Stop:=ws.Range(RNG_END_DT).Value, Trend:=False\n\n    'The data filled in the last row with the userform data through\n    ' the first part of the macro will be copied and pasted in\n    ' the next row until there is a blank cell in column A.\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    ws.Range(ws.Range(\"B\" &amp; NextRow), ws.Cells(LastRow, \"H\")).FillDown\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5913867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dPjhqou4GO8/AAAAAAAAAAI/AAAAAAAABUU/azTdI7CTRf4/photo.jpg?sz=128", "display_name": "Daniele Casciaro", "link": "https://stackoverflow.com/users/5913867/daniele-casciaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 35855210, "answer_count": 1, "score": -1, "last_activity_date": 1457389030, "creation_date": 1456938501, "last_edit_date": 1531164843, "question_id": 35753754, "link": "https://stackoverflow.com/questions/35753754/excel-vba-create-multiple-data-strings-on-a-weekly-basis-from-start-date-to-en", "title": "Excel VBA - Create multiple data strings on a weekly basis from start date to ending date", "body": "<p>How can I have some code repeat a range of data in a row (from column B to G) into the following rows until there is an empty cell in row A?</p>\n\n<p>The code I pulled together is here below.</p>\n\n<pre><code>Sub AddFlight_Click()\n\nDim NextRow As Long, LastRow As Long, ws As Worksheet, ColumnA As Range\n\nSet ws = Sheets(\"JetAir Flight Plan\")\nNextRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nColumnA = ws.Range (\"A:A\")\n\n 'Data inserted in a userform are assigned to specific cells in a sheet. \n\n    ws.Range(\"A\" &amp; NextRow).Value = StartingFlightDateComboBox.Text\n    ws.Range(\"P\" &amp; \"2\").Value = EndingFlightDateComboBox.Text\n    ws.Range(\"B\" &amp; NextRow).Value = DayOfWeekComboBox.Text\n    ws.Range(\"D\" &amp; NextRow).Value = ETATextBox.Text\n    ws.Range(\"E\" &amp; NextRow).Value = TourOperatorTextBox.Text\n    ws.Range(\"F\" &amp; NextRow).Value = FlightNumberTextBox.Text\n    ws.Range(\"G\" &amp; NextRow).Value = FromToTextBox.Text\n    ws.Range(\"H\" &amp; NextRow).Value = AllotmentTextBox.Text\n\n     'A series of dates is created from a starting date \n     '    to an ending date in column A.\n\n   ws.Range(\"A\" &amp; NextRow).Select\n   Selection.DataSeries Rowcol:=xlColumns, Type:=xlChronological, Date:= _\n       xlDay, Step:=7, Stop:=ws.Range(\"P\" &amp; \"2\").Value, Trend:=False\n\n  'The data filled in the last row with the userform data through\n  ' the first part of the macro will be copied and pasted in \n  ' the next row until there is a blank cell in column A.\n\nDo While ColumnA(i) &lt;&gt; \"\"\nws.Range(\"B\" &amp; LastRow).Resize(, 6).Copy\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I can't make the last part work. One error I receive is the ColumnA error: Runtime error 91: Object variable or With block variable not set. </p>\n\n<p>But I set it as Range(\"A:A\"). Any better way to write that code?</p>\n\n<p>Any suggestions as to why?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1456941901, "post_id": 35753434, "comment_id": 59182869, "body": "Is the length of the value in B2 &lt;&gt; 12?"}, {"owner": {"reputation": 11, "user_id": 6008951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bf13c36353dfc90f82c67b4c779af5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6008951/eric"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1456942419, "post_id": 35753434, "comment_id": 59183173, "body": "Nope. In this particular example, B1-B130 should all have a length = 12. I did notice in single step that it is dropping out of the DO loop after just one go through, but I cant explain why."}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1456950744, "post_id": 35753434, "comment_id": 59188295, "body": "Have you done a simple test on B1 to make sure that Len(Cells(myRow + i, &quot;B&quot;)) really equals 12 and that you&#39;re not getting a space at the end?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6008951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bf13c36353dfc90f82c67b4c779af5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6008951/eric"}, "edited": false, "score": 0, "creation_date": 1456943211, "post_id": 35755106, "comment_id": 59183679, "body": "Thanks for your reply, but when I tried this out in my worksheet, I only ended up with B1 being copied and placed into &quot;Results&quot;."}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1456942750, "creation_date": 1456942750, "answer_id": 35755106, "question_id": 35753434, "link": "https://stackoverflow.com/questions/35753434/vba-macro-loop-only-copies-one-cell-of-data-instead-of-many/35755106#35755106", "title": "VBA Macro Loop only copies one cell of data instead of many", "body": "<p>This is a fairly simple code that seems to work.  Hopefully it meets your needs:</p>\n\n<pre><code>Sub test1()\n\nDim ws As Worksheet\nDim res As Worksheet\nDim val As String\n\nSet ws = ActiveSheet\nSheets.Add\nSet res = ActiveSheet\nres.Name = \"Results\"\nws.Select\nRange(\"B1\").Select\n\nWhile ActiveCell.Value &lt;&gt; \"\"\n\nIf Len(ActiveCell.Value) = 12 Then\n\nval = ActiveCell.Value\nres.Select\nActiveCell.Value = val\nActiveCell.Offset(1, 0).Select\nws.Select\nActiveCell.Offset(1, 0).Select\n\nElse\n\nActiveCell.Offset(1, 0).Select\n\nEnd If\n\nWend\n\nres.Select\nColumns(\"A:A\").EntireColumn.AutoFit\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1456955448, "creation_date": 1456955448, "answer_id": 35758807, "question_id": 35753434, "link": "https://stackoverflow.com/questions/35753434/vba-macro-loop-only-copies-one-cell-of-data-instead-of-many/35758807#35758807", "title": "VBA Macro Loop only copies one cell of data instead of many", "body": "<p>I am not sure to understand, but you can try this:</p>\n\n<pre><code>Option Explicit\n\nSub CopyNumber()\n\nDim ws1 As Worksheet: Set ws1 = ThisWorkbook.Sheets(\"Sheet1\") 'Change the name of the sheet\nDim Result As Worksheet\n\nDim ws1Lastrow As Long, LastrowResult As Long\nDim i As Long, Rng As Range\nDim TestLenght, Arr\n\nSheets.Add.Name = \"Results\" ' Add your new sheet\nSet Result = ThisWorkbook.Sheets(\"Results\")\n\nWith ws1\n\n    ws1Lastrow = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row 'Find the lastrow in the Source Data Sheet\n    Set Rng = .Range(\"B1:B\" &amp; ws1Lastrow) 'Set your range to put into your Array\n    Arr = Rng.Value\n\nFor i = LBound(Arr) To UBound(Arr)\n\n    TestLenght = Arr(i, 1)\n\n            If Len(Trim(TestLenght)) = 12 And IsNumeric(TestLenght) Then ' Test your data\n\n                    LastrowResult = Result.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n                    Result.Cells(LastrowResult, \"A\") = TestLenght ' Past your data from your array to the Result Sheet\n\n            End If\n\nNext ' next data of the Array\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6428695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4qd-TRNFj2g/AAAAAAAAAAI/AAAAAAAAAEs/7C1QLrqQrL0/photo.jpg?sz=128", "display_name": "Yianni Velkou", "link": "https://stackoverflow.com/users/6428695/yianni-velkou"}, "is_accepted": false, "score": 0, "last_activity_date": 1466487362, "creation_date": 1466487362, "answer_id": 37936338, "question_id": 35753434, "link": "https://stackoverflow.com/questions/35753434/vba-macro-loop-only-copies-one-cell-of-data-instead-of-many/37936338#37936338", "title": "VBA Macro Loop only copies one cell of data instead of many", "body": "<p>I think the problem may be that formatting the numbers to display 0 decimal places is not the same as truncating them. The Len() function will operate on the actual contents (or true value) of the cell, not the displayed value.  So if you do have decimals on those numbers, Len() will return a value greater than 12, as it'll count the decimal place and the decimals.</p>\n\n<p>If that is the issue, you'll need to round to 0 decimal places (or truncate to integer) in order to force the actual cell contents to a length of 12. </p>\n"}], "owner": {"reputation": 11, "user_id": 6008951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bf13c36353dfc90f82c67b4c779af5?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6008951/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 818, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1466487362, "creation_date": 1456937639, "question_id": 35753434, "link": "https://stackoverflow.com/questions/35753434/vba-macro-loop-only-copies-one-cell-of-data-instead-of-many", "title": "VBA Macro Loop only copies one cell of data instead of many", "body": "<p>all</p>\n\n<p>I'm a VBA novice here, and I'm being tasked with developing some macros in my new job. Currently, I am working on a macro that goes though a text file, applies some formatting, isolates required numerical data, copies it, and then outputs the copied information into a new Worksheet. </p>\n\n<p>Here's the code for the formatting, just to make sure I post it: </p>\n\n<pre><code>`Perform Text-To-Columns on Column A. Delimited by the character \"#\"\nColumns(\"A:A\").Select\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"#\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\n\n`Perform Text-To-Columns on Column B. Delimited by the character \")\"\nColumns(\"B:B\").Select\nSelection.TextToColumns Destination:=Range(\"B1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\")\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\n\n`Format Column B for Numbers to have zero decimal places\nSelection.NumberFormat = \"0\"\n\n`Filter Column B for all numbers greater than 500\nSelection.AutoFilter\nActiveSheet.Range(\"$B$1:$B$1720\").AutoFilter Field:=1, Criteria1:=\"&gt;500\", _\n    Operator:=xlAnd\n\n`Sort Filtered numbers from lowest to highest\nActiveWorkbook.Worksheets(1).Sort.SortFields.Clear\nActiveWorkbook.Worksheets(1).Sort.SortFields.Add Key:=Range( _\n    \"B1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(1).Sort\n    .SetRange Range(\"B1\").EntireColumn\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>At this point, I now have column B with an amount of 12 digit numbers that varies from file to file. This next part of the macro is a loop that should now look at this Column B, and begin to inspect the cells of Column B to see if they contain 12 digit numbers, and if they do, begin to copy them as a range. Once all the 12 digit numbers in B are found, it should copy them all, open a new tab, and paste the results:</p>\n\n<pre><code>' Declare loop variables\n    Dim myLastRow As Long\n    Dim myRow As Long\n    Dim i As Long\n    Dim myValue As String\n    Dim myStartRow As Long\n    Dim myEndRow As Long\n\n'   Find last row with data in column B\n    myLastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n'   Loop through all data in column B until you find a 12 order number Number\n    For myRow = 1 To myLastRow\n'       If 12 digit entry is found, capture the row number,\n'       then go down until you find the first entry not 12 digits long\n        If (Len(Cells(myRow, \"B\")) = 12) And (IsNumeric(Cells(myRow, \"B\"))) Then\n            myStartRow = myRow\n            i = 1\n            Do\n                If Len(Cells(myRow + i, \"B\")) &lt;&gt; 12 Then\n'               If found, capture row number of the last 13 digit cell\n                    myEndRow = myRow + i - 1\n'                   Copy the selected data\n                    Range(Cells(myStartRow, \"B\"), Cells(myEndRow, \"B\")).Copy\n'                   Add \"Results\" as a new sheet for the copied Card Numbers to be pasted into\n                    Sheets.Add.Name = \"Results\"\n                    Sheets(\"Results\").Activate\n'                   Paste clipboard to \"Results\" and format the results for viewing\n                    Range(\"A1\").Select\n                    ActiveSheet.Paste\n                    Columns(\"A:A\").EntireColumn.AutoFit\n                    Application.CutCopyMode = False\n                    Exit Do\n                Else\n'               Otherwise, move row counter down one and continue\n                    i = i + 1\n                End If\n            Loop\n            Exit For\n        End If\n    Next myRow\n</code></pre>\n\n<p>For whatever reason, when I go through the macro, all it does is capture the first value in B1 and then put that into the Results sheet. I cannot for the life of me figure out why. Could it be due to the filtering I've applied? If anyone could give me some insight, I'd be all ears. Thanks very much for any help you can offer. </p>\n"}, {"tags": ["sql-server", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 2, "creation_date": 1456937895, "post_id": 35753093, "comment_id": 59180208, "body": "Side note: you should <b>not</b> use the <code>sp_</code> prefix for your stored procedures. Microsoft has <a href=\"http://msdn.microsoft.com/en-us/library/ms190669%28v=sql.105%29.aspx\" rel=\"nofollow noreferrer\">reserved that prefix for its own use (see <i>Naming Stored Procedures</i>)</a>, and you do run the risk of a name clash sometime in the future. <a href=\"http://www.sqlperformance.com/2012/10/t-sql-queries/sp_prefix\" rel=\"nofollow noreferrer\">It&#39;s also bad for your stored procedure performance</a>. It&#39;s best to just simply avoid <code>sp_</code> and use something else as a prefix - or no prefix at all!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1456942893, "post_id": 35753093, "comment_id": 59183493, "body": "Create a pass-through query which fetches data from the stored procedure and use the query as the report&#39;s Record Source."}], "answers": [{"tags": [], "owner": {"reputation": 10544, "user_id": 6244, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1e037aa722c82abdf479a505a36bf1ed?s=128&d=identicon&r=PG", "display_name": "Toby Allen", "link": "https://stackoverflow.com/users/6244/toby-allen"}, "is_accepted": false, "score": 2, "last_activity_date": 1456948782, "last_edit_date": 1456948782, "creation_date": 1456937350, "answer_id": 35753332, "question_id": 35753093, "link": "https://stackoverflow.com/questions/35753093/filling-a-report-from-a-stored-procedure-to-an-access-front-end/35753332#35753332", "title": "Filling a report from a stored procedure to an Access front end", "body": "<p>You could Set the Record Source of the form to a pass-through query that calls the stored procedure (similar as to how you would set it to the name of a table or query/view).  </p>\n\n<p>Then you could simply use data aware controls.</p>\n"}], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642627, "creation_date": 1456936704, "last_edit_date": 1594642627, "question_id": 35753093, "link": "https://stackoverflow.com/questions/35753093/filling-a-report-from-a-stored-procedure-to-an-access-front-end", "title": "Filling a report from a stored procedure to an Access front end", "body": "<p>Assume this stored procedure in SQL Server:</p>\n\n<pre><code>CREATE PROCEDURE sp_MySP AS\n  BEGIN\n    SELECT a.Field1, a.Field2, v.Field3, p.Field4, a.Field5\n    INTO #Temp1\n    FROM tblMyTable1 AS a, tblMyTable2 AS p, tblMyTable3 AS v\n    WHERE a.Field1 = p.Field1 \n    AND a.Field1 = v.Field1 \n\n    SELECT a.Field1, a.Field2, v.Field3, p.Field4, a.Field5\n    INTO #Temp2\n    FROM tblMyTable1 AS a, tblMyTable2 AS p, tblMyTable3 AS v\n    WHERE a.Field1 = p.Field1 \n    AND a.Field1 = v.Field1 \n\n    SELECT *\n    FROM #Temp1\n\n    UNION ALL\n\n    SELECT *\n    FROM #Temp2\n\n  END\n</code></pre>\n\n<p>And this vba code (I put the vba code on the LOAD event of the report):</p>\n\n<pre><code>Private Sub Report_Load()\n    Dim rs As ADODB.Recordset\n    Dim cnComments As New ADODB.Connection\n    Dim strConn As String\n    strConn = \"PROVIDER=SQLOLEDB;DATA SOURCE=WML202;INITIAL CATALOG=TOOL_TRACKING;UID=\" &amp; CVHx(SSTR1) &amp; \";PWD=\" &amp; CVHx(SSTR2) &amp; \";\"\n    cnComments.Open strConn\n\n    Set rs = cnComments.Execute(\"EXEC sp_MySP\")\n\n    '** What do I do here?\n\nEnd Sub\n</code></pre>\n\n<p>The actual stored procedure is much more complicated (and unnecessary) but that's the layout of the dataset.  It's a UNION ALL of a couple #Temp files.</p>\n\n<p>How do I do the <code>'** What do I do here?</code> part so that the results of the stored procedure will fill the report?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1456942209, "creation_date": 1456942209, "answer_id": 35754923, "question_id": 35752962, "link": "https://stackoverflow.com/questions/35752962/how-to-write-a-loop-to-format-tables-differently-in-a-word-document/35754923#35754923", "title": "How to write a loop to format tables differently in a word document?", "body": "<p>Here's how I'd do it:</p>\n\n<pre><code>Sub Change_Tables_Formating()\n    Dim oTbl As Word.Table, i As Long\n    For Each oTbl In ActiveDocument.Tables\n        i = i + 1\n        If i = 1 Then\n            FormatFirst oTbl\n        Else\n            FormatRest oTbl\n        End If\n    Next oTbl\nEnd Sub\n\nSub FormatFirst(tbl As Table)\n    Dim oCell\n    For Each oCell In tbl.Range.Cells\n        oCell.Range.ParagraphFormat.Alignment = wdAlignParagraphLeft\n    Next oCell\n    tbl.Range.Shading.BackgroundPatternColorIndex = wdColorWhite\n\nEnd Sub\n\nSub FormatRest(tbl As Table)\n    Dim oCell\n    For Each oCell In tbl.Range.Cells\n        oCell.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter\n    Next oCell\n    tbl.Rows(1).Shading.BackgroundPatternColorIndex = wdGray25\n    tbl.Rows(1).Range.Bold = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6008776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5a299ce409bcec6162c9259aec02a3?s=128&d=identicon&r=PG&f=1", "display_name": "newbie123", "link": "https://stackoverflow.com/users/6008776/newbie123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456942209, "creation_date": 1456936304, "last_edit_date": 1456936370, "question_id": 35752962, "link": "https://stackoverflow.com/questions/35752962/how-to-write-a-loop-to-format-tables-differently-in-a-word-document", "title": "How to write a loop to format tables differently in a word document?", "body": "<p>I have been trying to find a code to format the first table of a word document a specific way and then loop through the rest of the tables formatting them another way.  I found a code that loops through all of the tables correctly, but haven't found a way to exclude the first table in order to format it differently.  This is the code that works for all of the tables</p>\n\n<pre><code>Sub Change_All_Tables_Formating()\nDim oTbl As Word.Table\nDim oCell As Word.Cell\n  For Each oTbl In ActiveDocument.Tables\n  For Each oCell In oTbl.Range.Cells\n  oCell.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter\n  Next oCell\n  oTbl.Rows(1).Shading.BackgroundPatternColorIndex = wdGray25\n  oTbl.Rows(1).Range.Bold = True\n  Next oTbl\nEnd Sub\n</code></pre>\n\n<p>This is the code that I am having trouble adapting to format the first table correctly.  It needs to remove the shading from the first table completely and shade the headings of the rest of the tables in the word document.  I feel that if I can learn how to do this, I will be able to adjust any of the tables that I would like and format them individually.  The number of tables vary with each document, but the first table is always the same.  I will appreciate any help that anyone can provide.</p>\n\n<pre><code>Sub Change_Tables_Formating()\n Dim oTbl As Word.Table\n Dim oCell As Word.Cell\n Set oTbl = ActiveDocument.Tables\n Set oTblcnt = wdDoc.Tables.Count\n    For oTbl = 0 To 1\n      For Each oCell In oTbl.Range.Cells\n       oCell.Range.ParagraphFormat.Alignment = wdAlignParagraphLeft\n      Next oCell\n       oTbl.Range.Shading.BackgroundPatternColorIndex = wdColorWhite\n      Next oTbl\n    For oTbl = 2 To oTblct\n      For Each oCell In oTbl.Range.Cells\n      oCell.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter\n      Next oCell\n      oTbl.Rows(1).Shading.BackgroundPatternColorIndex = wdGray25\n      oTbl.Rows(1).Range.Bold = True\n      Next oTbl\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1456936525, "creation_date": 1456936525, "answer_id": 35753023, "question_id": 35752779, "link": "https://stackoverflow.com/questions/35752779/dynamic-string-manipulation-vba-excel/35753023#35753023", "title": "Dynamic String Manipulation VBA Excel", "body": "<p>You can use <code>InStr</code> to locate the semicolon and the <code>Left</code> to extract the part to the left of it:</p>\n\n<pre><code>Sub test()\n    Dim s As String, i As Long\n    s = \"Doe, John;#44\"\n    i = InStr(1, s, \";\")\n    s = Left(s, i - 1)\n    Debug.Print s\nEnd Sub\n</code></pre>\n\n<p>This prints <code>Doe, John</code></p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 0, "last_activity_date": 1456941815, "last_edit_date": 1456941815, "creation_date": 1456936588, "answer_id": 35753045, "question_id": 35752779, "link": "https://stackoverflow.com/questions/35752779/dynamic-string-manipulation-vba-excel/35753045#35753045", "title": "Dynamic String Manipulation VBA Excel", "body": "<p>You can use the formula <code>REPLACE(LEFT(A1,FIND(\";\",A1)-1),1,1,)</code>, assuming data is in cell A1.</p>\n"}], "owner": {"reputation": 1, "user_id": 6008872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GskDq.jpg?s=128&g=1", "display_name": "Attila", "link": "https://stackoverflow.com/users/6008872/attila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456941853, "creation_date": 1456935808, "last_edit_date": 1531164843, "question_id": 35752779, "link": "https://stackoverflow.com/questions/35752779/dynamic-string-manipulation-vba-excel", "title": "Dynamic String Manipulation VBA Excel", "body": "<p>I have a string from a Sharepoint list that returns data like this:</p>\n\n<pre><code>\"Doe, John;#44\" or \"Doe, Jane;#150\". \n</code></pre>\n\n<p>I need to be able to remove the semicolon and any characters after that. Since they can be 4, 5 or even 6 characters I can't use the right function.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456936088, "post_id": 35752714, "comment_id": 59178891, "body": "Copy the cells to a new location with Paste Special, transpose. Remove Duplicates on each column. Copy them back with transpose."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456936346, "post_id": 35752714, "comment_id": 59179100, "body": "See <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a>."}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1456936092, "creation_date": 1456936092, "answer_id": 35752894, "question_id": 35752714, "link": "https://stackoverflow.com/questions/35752714/removing-duplicates-in-excel-with-or-without-vba/35752894#35752894", "title": "Removing Duplicates in Excel with or without VBA", "body": "<p>No need for VBA. Use <code>Data</code>, <code>Advanced filter</code>, choose <code>Copy to another location</code> and check <code>Unique records only</code></p>\n"}, {"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1456938730, "creation_date": 1456938730, "answer_id": 35753826, "question_id": 35752714, "link": "https://stackoverflow.com/questions/35752714/removing-duplicates-in-excel-with-or-without-vba/35753826#35753826", "title": "Removing Duplicates in Excel with or without VBA", "body": "<blockquote>\n  <p>first a formula to bring unique only. the formula display duplicates as <code>0</code>.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/AzmuM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AzmuM.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>then while still selecting the formula range, open the \"go to special\" dialog box</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/0eKb4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0eKb4.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>select Formulas > Numbers</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/TilSs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TilSs.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>all formula output zeros will be selected</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/06l5E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/06l5E.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>press `Ctrl + minus(-) to delete cells, select \"shift cells left\"</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/xKSvd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xKSvd.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>end result</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/6Ldwr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Ldwr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "is_accepted": false, "score": 1, "last_activity_date": 1456951099, "creation_date": 1456951099, "answer_id": 35757596, "question_id": 35752714, "link": "https://stackoverflow.com/questions/35752714/removing-duplicates-in-excel-with-or-without-vba/35757596#35757596", "title": "Removing Duplicates in Excel with or without VBA", "body": "<p>Select your range\nGo to the Data tab\nIn the Data Tools pane, select \"Remove Duplicates\"</p>\n"}], "owner": {"reputation": 21, "user_id": 6008874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8986ac49514a2d4da557ca7ae481aa?s=128&d=identicon&r=PG&f=1", "display_name": "fischouttawater", "link": "https://stackoverflow.com/users/6008874/fischouttawater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1456951099, "creation_date": 1456935662, "last_edit_date": 1456941889, "question_id": 35752714, "link": "https://stackoverflow.com/questions/35752714/removing-duplicates-in-excel-with-or-without-vba", "title": "Removing Duplicates in Excel with or without VBA", "body": "<p><a href=\"http://i.stack.imgur.com/i6mGh.png\" rel=\"nofollow\">Chart Example</a></p>\n\n<p>Hello All, </p>\n\n<p>I am looking for some help in cleaning up an organizational chart that I have in excel. Right now, there are many duplicates as the linked picture shows. I need to remove all the duplicates, and shift the unique values over into the blank spaces </p>\n\n<p>(i.e., Bill G, Bill G, Fred K, Fred K, Joe X ---> Bill G, Fred K, Joe X). </p>\n\n<p>I have been trying to get it done using Excel Formulas (<code>=IF(A1=B1, B1, A1)</code>), but it does not repeat correctly across the Sheet, especially because the different rows have varying numbers of occupied columns. </p>\n\n<p>I'd appreciate any help that I can get. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 2, "creation_date": 1456935712, "post_id": 35752629, "comment_id": 59178604, "body": "What if you replace the <code>;</code> for <code>,</code>?"}, {"owner": {"reputation": 13, "user_id": 6008896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1022622b6fdba1585b30082df635972?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/6008896/displayname"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456935865, "post_id": 35752629, "comment_id": 59178727, "body": "It works. Thanks for fast respond."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456935970, "post_id": 35752629, "comment_id": 59178797, "body": "I added the answer to the post."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 1, "creation_date": 1456936195, "post_id": 35752629, "comment_id": 59178981, "body": "Please remember to mark he answer as correct, so that the question gets marked as answered."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1456939269, "post_id": 35752835, "comment_id": 59181170, "body": "<i>Goes to regional settings, changes list separator character to a <code>|</code> pipe, breaks all VBA macros.</i>"}], "tags": [], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "is_accepted": true, "score": 1, "last_activity_date": 1456935942, "creation_date": 1456935942, "answer_id": 35752835, "question_id": 35752629, "link": "https://stackoverflow.com/questions/35752629/vba-full-formula-to-cell/35752835#35752835", "title": "VBA Full formula to cell", "body": "<p>Correct code:</p>\n\n<pre><code>Sheets(\"Output\").Range(\"T2\").Formula = _ \n     \"=CONCATENATE(TEXT(C2,\"\"MM/DD/JJJJ\"\"),\"\"-\"\",TEXT(S2,\"\"MM/DD/JJJJ\"\"))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1456939607, "last_edit_date": 1495535288, "creation_date": 1456939177, "answer_id": 35753974, "question_id": 35752629, "link": "https://stackoverflow.com/questions/35752629/vba-full-formula-to-cell/35753974#35753974", "title": "VBA Full formula to cell", "body": "<p>Excel uses the <em>list separator</em> character to delimit the parameters of a function.</p>\n\n<p>Hard-coding a semicolon, or a comma for that matter, into your formula, makes your code vulnerable to changes in regional settings, as a hard-coded list separator character will stop working as soon as the Windows settings are modified, or if your code runs on a computer with different settings.</p>\n\n<p>You can use some Win32 API to get the correct character from the regional settings, by adding this code in a standard module (.bas) that you can name <code>Win32</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function GetLocaleInfo Lib \"kernel32\" Alias \"GetLocaleInfoA\" _\n    (ByVal Locale As Long, ByVal LCType As Long, ByVal lpLCData As String, ByVal cchData As Long) As Long\n\nPrivate Declare Function GetUserDefaultLCID% Lib \"kernel32\" ()\nPrivate Const LOCALE_SLIST = &amp;HC\n\nPublic Function GetListSeparator() As String\n\n    Dim ListSeparator As String\n    Dim iRetVal1 As Long\n    Dim iRetVal2 As Long\n    Dim lpLCDataVar As String\n\n    Dim Position As Integer\n    Dim Locale As Long\n\n    Locale = GetUserDefaultLCID()\n\n    iRetVal1 = GetLocaleInfo(Locale, LOCALE_SLIST, lpLCDataVar, 0)\n\n    ListSeparator = String$(iRetVal1, 0)\n\n    iRetVal2 = GetLocaleInfo(Locale, LOCALE_SLIST, ListSeparator, iRetVal1)\n\n    Position = InStr(ListSeparator, Chr$(0))\n    If Position &gt; 0 Then\n        ListSeparator = Left$(ListSeparator, Position - 1)\n    End If\n\n    GetListSeparator = ListSeparator\n\nEnd Function\n</code></pre>\n\n<p>(adapted from <a href=\"http://www.pcreview.co.uk/threads/get-list-separator-character-with-vba.2218762/\" rel=\"nofollow noreferrer\">this PCReview post</a>)</p>\n\n<p>The correct code would then be:</p>\n\n<pre><code>Dim separator As String\nseparator = Win32.GetListSeparator\n\nSheets(\"Output\").Range(\"T2\").Formula = _ \n    \"=CONCATENATE(TEXT(C2\" + separator + \"\"\"MM/DD/JJJJ\"\")\" + separator + \"\"\"-\"\"\" + separator + \"TEXT(S2\" + separator + \"\"\"MM/DD/JJJJ\"\"))\"\n</code></pre>\n\n<p>...which is utterly annoying. VBA needs a proper <code>StringFormat</code> method (<a href=\"https://stackoverflow.com/a/14534361/1188513\">I made one</a>), so that you can do this:</p>\n\n<pre><code>Dim separator As String\nseparator = Win32.GetListSeparator\n\nDim formatString As String\nformatString = \"=CONCATENATE(TEXT(C2{0}\\qMM/DD/JJJJ\\q){0}\\q-\\q{0}TEXT(S2{0}\\qMM/DD/JJJJ\\q))\"\n\nSheets(\"Output\").Range(\"T2\").Formula = StringFormat(formatString, separator)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6008896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1022622b6fdba1585b30082df635972?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/6008896/displayname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 35752835, "answer_count": 2, "score": 1, "last_activity_date": 1462526095, "creation_date": 1456935443, "last_edit_date": 1531164843, "question_id": 35752629, "link": "https://stackoverflow.com/questions/35752629/vba-full-formula-to-cell", "title": "VBA Full formula to cell", "body": "<p>I've written this line of code to put this formula to cell T2:</p>\n\n<pre><code>Sheets(\"Output\").Range(\"T2\").Formula = _ \n     \"=CONCATENATE(TEXT(C2;\"\"MM/DD/JJJJ\"\");\"\"-\"\";TEXT(S2;\"\"MM/DD/JJJJ\"\"))\"\n</code></pre>\n\n<p>But I'm getting the following error:</p>\n\n<blockquote>\n  <p>Run-time error '1004':\n  Application-defined or object-definded error</p>\n</blockquote>\n\n<p>The formula is working if I copy-paste it, so I guess this is a syntax error.</p>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1456968518, "creation_date": 1456968518, "answer_id": 35761459, "question_id": 35752386, "link": "https://stackoverflow.com/questions/35752386/cleaning-up-code-in-recorded-excel-macro/35761459#35761459", "title": "Cleaning up code in recorded Excel Macro", "body": "<p>Your code is fairly straightforward although it isn't entirely clear what it is trying to accomplish. Here is a quick rewrite putting several <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> to use to narrow down the affected work areas.</p>\n\n<pre><code>Sub Activations()\n    ' Master_Button2_2_Click Macro\n    Dim lr As Long\n\n    appTGGL bTGGL:=False\n\n    With Worksheets(\"Index\")\n        lr = .Cells.SpecialCells(xlCellTypeLastCell).Row\n        With .Range(\"A1:C\" &amp; lr)\n        .Cells.Sort Key1:=.Columns(2), Order1:=xlAscending, _\n                    Orientation:=xlTopToBottom, Header:=xlYes\n        End With\n    End With\n\n    With Worksheets(\"Duplicates\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        lr = .Cells.SpecialCells(xlCellTypeLastCell).Row\n        With .Range(\"L4:N\" &amp; lr)\n            .AutoFilter Field:=1, Criteria1:=\"activate\"\n        End With\n    End With\n\n    With Worksheets(\"Master\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        lr = .Cells.SpecialCells(xlCellTypeLastCell).Row\n        With .Range(\"A2:BU\" &amp; lr)\n            .AutoFilter Field:=73, Criteria1:=\"A\"\n        End With\n        .Select\n    End With\n\n    appTGGL\nEnd Sub\n\nSub appTGGL(Optional bTGGL As Boolean = True)\n    With Application\n        .EnableEvents = bTGGL\n        .ScreenUpdating = bTGGL\n        .DisplayAlerts = bTGGL\n        .Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Sample data and a short narrative of explanation would have helped this question. We don't all speak english but we all speak code and data.</p>\n"}], "owner": {"reputation": 11, "user_id": 6008773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4cfc2ed785dec87246020e99a4c401?s=128&d=identicon&r=PG&f=1", "display_name": "jaydubs", "link": "https://stackoverflow.com/users/6008773/jaydubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456969930, "creation_date": 1456934865, "last_edit_date": 1456969930, "question_id": 35752386, "link": "https://stackoverflow.com/questions/35752386/cleaning-up-code-in-recorded-excel-macro", "title": "Cleaning up code in recorded Excel Macro", "body": "<p>I used the Record Macro function to create this, but it runs real slow and I want to see if anyone had any ideas on how to <strong>clean it up</strong>.  It looks as if I have two sorts here doing the same thing?  Thanks in advance.</p>\n\n<pre><code>Sub Activations()\n'\n' Master_Button2_2_Click Macro\n'\n\n'\nApplication.ScreenUpdating = False\nSheets(\"Index\").Select\nColumns(\"A:C\").Select\nActiveWorkbook.Worksheets(\"Index\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Index\").Sort.SortFields.Add Key:=Range(\"B2:B12000\" _\n    ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Index\").Sort\n    .SetRange Range(\"A1:C12000\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"Duplicates\").Select\nActiveSheet.Range(\"$L$4:$N$3476\").AutoFilter Field:=1, Criteria1:= _\n    \"Activate\"\nSheets(\"Master\").Select\nActiveSheet.Range(\"$A$2:$BU$11965\").AutoFilter Field:=73, Criteria1:= _\n    \"A\"\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "forms", "vba", "variables"], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1456936257, "creation_date": 1456936257, "answer_id": 35752946, "question_id": 35752271, "link": "https://stackoverflow.com/questions/35752271/vba-excel-returning-a-variable-between-forms/35752946#35752946", "title": "VBA Excel, Returning a Variable between Forms", "body": "<p>You need to declare the variable in a module, not the worksheet, and the declaration needs to be:</p>\n\n<pre><code>Global tempDate as Date\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Public tempDate as Date\n</code></pre>\n\n<p>The variables in the worksheet are not available in the forms.</p>\n\n<p>It would be possible to make a function in the worksheet and call this function, but this is a much simpler solution.</p>\n"}, {"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1456941097, "post_id": 35753617, "comment_id": 59182340, "body": "This is actually a better solution than I provided; I was just offering the easiest fix."}, {"owner": {"reputation": 3, "user_id": 6008294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe10ce1e04ba96f32caa962de896170?s=128&d=identicon&r=PG&f=1", "display_name": "Bennyono", "link": "https://stackoverflow.com/users/6008294/bennyono"}, "edited": false, "score": 0, "creation_date": 1456995739, "post_id": 35753617, "comment_id": 59206911, "body": "Thanks for the feedback, I used the public property method and it works great!"}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 1, "last_activity_date": 1456938116, "creation_date": 1456938116, "answer_id": 35753617, "question_id": 35752271, "link": "https://stackoverflow.com/questions/35752271/vba-excel-returning-a-variable-between-forms/35753617#35753617", "title": "VBA Excel, Returning a Variable between Forms", "body": "<p>I would use a property in the userform</p>\n\n<p>Your main form code would change to look like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub SetDueButton_Click()\n    Dim UF As UserForm1 'you can declare a user form as an independent object\n\n    UF.Show\n    DueDate.Value = UF.tempdate 'get the property \n    Unload UF 'now you can unload or set to Nothing\nEnd Sub\n</code></pre>\n\n<p>Your UserForm1 code would be this:</p>\n\n<pre><code>Option Explicit\n\nPublic Property Get tempdate() As String\n    tempdate = Me.TextBox1.Value 'Me refers to the form itself\nEnd Property\n\nPrivate Sub CommandButton53_Click()\n     Me.Hide 'hide don't unload yet or you can't get the data.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6008294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe10ce1e04ba96f32caa962de896170?s=128&d=identicon&r=PG&f=1", "display_name": "Bennyono", "link": "https://stackoverflow.com/users/6008294/bennyono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 35752946, "answer_count": 2, "score": 0, "last_activity_date": 1456970308, "creation_date": 1456934591, "last_edit_date": 1456970308, "question_id": 35752271, "link": "https://stackoverflow.com/questions/35752271/vba-excel-returning-a-variable-between-forms", "title": "VBA Excel, Returning a Variable between Forms", "body": "<p>I need some help. I am writing VBA script for an Excel macro. I have two forms, the first has a button calling the second. On the second I want it to return a variable (<code>tempdate</code>, this is declared as <code>public type Date</code> in the main Worksheet). </p>\n\n<p>Main form button code:</p>\n\n<pre><code>Private Sub SetDueButton_Click()\n    UserForm1.Show\n    DueDate.Value = tempdate 'display tempdate in the DueDate text box\nEnd Sub\n</code></pre>\n\n<p>UserForm1 'ok' button:</p>\n\n<pre><code>Private Sub CommandButton53_Click()\n     tempdate = TextBox1.Value\n     Unload Me \nEnd Sub\n</code></pre>\n\n<p>What am I missing to get this variable to load whatever is in <code>TextBox1.Value</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 464, "user_id": 4862471, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c72e3484c617bb4447c745cd2547698?s=128&d=identicon&r=PG&f=1", "display_name": "Claus", "link": "https://stackoverflow.com/users/4862471/claus"}, "edited": false, "score": 0, "creation_date": 1456933561, "post_id": 35751754, "comment_id": 59176915, "body": "I forgot to add that to reset the range, first you select &quot;UsedRange&quot; then delete the content &quot;Selection.Delete Shift:=xlUp&quot; before executing the save"}, {"owner": {"reputation": 403, "user_id": 2588587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c11c02a96cde4f8d5abff94d046f1e?s=128&d=identicon&r=PG", "display_name": "sirplus", "link": "https://stackoverflow.com/users/2588587/sirplus"}, "edited": false, "score": 0, "creation_date": 1538220911, "post_id": 35751754, "comment_id": 92072894, "body": "From Memory you just need to  select cell 1,1 in any relevant sheet you want to reset then save"}, {"owner": {"reputation": 412, "user_id": 6226158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecafe459d3eaec4134cf289a15a1d537?s=128&d=identicon&r=PG&f=1", "display_name": "rxex", "link": "https://stackoverflow.com/users/6226158/rxex"}, "edited": false, "score": 0, "creation_date": 1562849208, "post_id": 35751754, "comment_id": 100513676, "body": "You state that &quot;This means I cannot any longer just do a &quot;Ctrl-End&quot; to find the last row in the data set when a new query is performed.&quot; If this is indeed your problem then you can just find the last row of data by using a VBA command such as &quot;lastRow = ActiveSheet.Cells.Find(&quot;*&quot;, searchorder:=xlByRows, searchdirection:=xlPrevious).Row&quot;. This would not depend on the size of the UsedRange, which you may want to reset for other reasons (to reduce the size of the sheet, for example, but you do not indicate that as your goal)."}], "answers": [{"comments": [{"owner": {"reputation": 464, "user_id": 4862471, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c72e3484c617bb4447c745cd2547698?s=128&d=identicon&r=PG&f=1", "display_name": "Claus", "link": "https://stackoverflow.com/users/4862471/claus"}, "edited": false, "score": 0, "creation_date": 1456945090, "post_id": 35752353, "comment_id": 59184862, "body": "It did not seem to work.  I am posting an answer so I can show code and a couple of before and after screen shots."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 1, "creation_date": 1528729040, "post_id": 35752353, "comment_id": 88607181, "body": "I think if you use <code>UsedRange.Calculate</code> then it will reset the used range."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1456934798, "creation_date": 1456934798, "answer_id": 35752353, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/35752353#35752353", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>If you call the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow\">Worksheet.UsedRange property</a> by itself, it will reset.</p>\n\n<pre><code>    With Worksheets(\"Sheet1\")\n        Debug.Print .UsedRange.Address(0, 0)\n        .UsedRange.Clear\n        .UsedRange    '&lt;~~ called by itself will reset it\n        Debug.Print .UsedRange.Address(0, 0)\n    End With\n</code></pre>\n\n<p>This extra step is unnecessary in xl2010 and above with all appropriate service packs installed.</p>\n"}, {"tags": [], "owner": {"reputation": 464, "user_id": 4862471, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c72e3484c617bb4447c745cd2547698?s=128&d=identicon&r=PG&f=1", "display_name": "Claus", "link": "https://stackoverflow.com/users/4862471/claus"}, "is_accepted": false, "score": 0, "last_activity_date": 1456945636, "creation_date": 1456945636, "answer_id": 35755996, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/35755996#35755996", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>Here is how I inserted your code.</p>\n\n<pre><code>    Sheets(\"Edit Data\").Select\n'    Range(\"A6\").Select\n'    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n'    Selection.Delete Shift:=xlUp\n'    ActiveWorkbook.Save\n    With Worksheets(\"Edit Data\")\n        Debug.Print .UsedRange.Address(0, 0)\n        .UsedRange.Clear\n        .UsedRange    '&lt;~~ called by itself will reset it\n        Debug.Print .UsedRange.Address(0, 0)\n    End With\n</code></pre>\n\n<p>Here is the full used range with data\n<a href=\"https://i.stack.imgur.com/15byG.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/15byG.gif\" alt=\"Ctrl-End shows usedRange\"></a></p>\n\n<p>Here is the used range after your code executed\n<a href=\"https://i.stack.imgur.com/rMdUR.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rMdUR.gif\" alt=\"enter image description here\"></a></p>\n\n<p>The end of range should be i7 instead it is still i26</p>\n\n<p>However the code which I commented out does reset range to i7</p>\n\n<p>From what you are saying just to confirm.  My commented out code will only work for Excel 2010 and newer.  We have some 2007 versions hanging around. For those the workbook will actually have to be closed and reopened for the range to reset?</p>\n\n<p>Note- the code examples were executed on version 2016</p>\n"}, {"comments": [{"owner": {"reputation": 4117, "user_id": 2272326, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d77a05612d6a5cb020dccbdbcbd596ac?s=128&d=identicon&r=PG", "display_name": "Dave Pile", "link": "https://stackoverflow.com/users/2272326/dave-pile"}, "edited": false, "score": 7, "creation_date": 1536646879, "post_id": 35916315, "comment_id": 91486847, "body": "This does NOT reset the Used Range as per the original question but clears the contents of the worksheet. Given the inclusion of the Save command I would suggest this answer is deliberately malicious"}], "tags": [], "owner": {"reputation": 464, "user_id": 4862471, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c72e3484c617bb4447c745cd2547698?s=128&d=identicon&r=PG&f=1", "display_name": "Claus", "link": "https://stackoverflow.com/users/4862471/claus"}, "is_accepted": true, "score": -4, "last_activity_date": 1457612279, "creation_date": 1457612279, "answer_id": 35916315, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/35916315#35916315", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>I double checked to make sure all the latests patches and service packs have been installed and they were.</p>\n\n<p>I'm running\nWindows 10 and \nExcel 2016 version 16.0.6568.2034</p>\n\n<p>I found that the range would only reset with the </p>\n\n<pre><code>ActiveSheet.UsedRange.Clear\n</code></pre>\n\n<p>And most importantly </p>\n\n<pre><code>ActiveWorkbook.Save\n</code></pre>\n\n<p>without the save command the range is not reset</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 6895442, "user_type": "registered", "profile_image": "https://graph.facebook.com/10104918190718207/picture?type=large", "display_name": "Travis Dawson", "link": "https://stackoverflow.com/users/6895442/travis-dawson"}, "is_accepted": false, "score": 0, "last_activity_date": 1508506215, "creation_date": 1508506215, "answer_id": 46850181, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/46850181#46850181", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>This may or may not suit your data needs, but if your data is all in one contiguous block, you can use CurrentRegion instead of UsedRange, like this:</p>\n\n<pre><code>With Cells(1, 1).CurrentRegion\n MsgBox \"I have \" &amp; .Rows.Count &amp; \" rows and \" &amp; .Columns.Count &amp; \" columns of data.\"\nEnd With\n</code></pre>\n\n<p>Of course, if the region you care about does not start at cell A1, or if your sheet contains multiple contiguous regions that you care about, this option will not work. Depending on how predictable your data is, you can usually find at least one cell in each block of data, and once you have that, CurrentRegion will give you the range of the entire block.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9127093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e805817671f6170a93078db317861d0?s=128&d=identicon&r=PG&f=1", "display_name": "user9127093", "link": "https://stackoverflow.com/users/9127093/user9127093"}, "is_accepted": false, "score": 0, "last_activity_date": 1513860966, "creation_date": 1513860966, "answer_id": 47925506, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/47925506#47925506", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>I've used Jeeped solution and worked for me when i add .Activate, so:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n        Debug.Print .UsedRange.Address(0, 0)\n        .UsedRange.Clear\n        .UsedRange   \n        .Activate\n        Debug.Print .UsedRange.Address(0, 0)\n  End With\n</code></pre>\n\n<p>I'm using Excel2013</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 8722581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVrjd.jpg?s=128&g=1", "display_name": "BarLr", "link": "https://stackoverflow.com/users/8722581/barlr"}, "edited": false, "score": 0, "creation_date": 1539162977, "post_id": 48828282, "comment_id": 92398097, "body": "This worked for me after I tried other answers. However the merged cells error appears on some sheets even when there are no merged cells. I also added ActiveWorkbook.Save at the end of the function."}], "tags": [], "owner": {"reputation": 41, "user_id": 9369902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a924659870c423f76fd7ca6a1fa8122?s=128&d=identicon&r=PG&f=1", "display_name": "Monosabio", "link": "https://stackoverflow.com/users/9369902/monosabio"}, "is_accepted": false, "score": 4, "last_activity_date": 1518789134, "creation_date": 1518789134, "answer_id": 48828282, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/48828282#48828282", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>Best code that worked for me:</p>\n\n<pre><code>Sub DeleteUnused()\nDim myLastRow As Long\nDim myLastCol As Long\nDim dummyRng As Range\nDim AnyMerged As Variant\n'http://www.contextures.on.ca/xlfaqApp.html#Unused\n'Helps to reset the usedrange by deleting rows and columns AFTER your true used range\n\n    'Check for merged cells\n    AnyMerged = ActiveSheet.UsedRange.MergeCells\n    If AnyMerged = True Or IsNull(AnyMerged) Then\n        MsgBox \"There are merged cells on this sheet.\" &amp; vbCrLf &amp; _\n               \"The macro will not work with merged cells.\", vbOKOnly + vbCritical, \"Macro will be Stopped\"\n        Exit Sub\n    End If\n\n    With ActiveSheet\n        myLastRow = 0\n        myLastCol = 0\n        Set dummyRng = .UsedRange\n        On Error Resume Next\n        myLastRow = _\n        .Cells.Find(\"*\", after:=.Cells(1), _\n                    LookIn:=xlFormulas, lookat:=xlWhole, _\n                    searchdirection:=xlPrevious, _\n                    searchorder:=xlByRows).Row\n        myLastCol = _\n        .Cells.Find(\"*\", after:=.Cells(1), _\n                    LookIn:=xlFormulas, lookat:=xlWhole, _\n                    searchdirection:=xlPrevious, _\n                    searchorder:=xlByColumns).Column\n        On Error GoTo 0\n\n        If myLastRow * myLastCol = 0 Then\n            .Columns.Delete\n        Else\n            .Range(.Cells(myLastRow + 1, 1), _\n                   .Cells(.Rows.Count, 1)).EntireRow.Delete\n            .Range(.Cells(1, myLastCol + 1), _\n                   .Cells(1, .Columns.Count)).EntireColumn.Delete\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9550133, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6321443818461da8dac2abd6483eb3f0?s=128&d=identicon&r=PG", "display_name": "CyberNot", "link": "https://stackoverflow.com/users/9550133/cybernot"}, "is_accepted": false, "score": -2, "last_activity_date": 1522029705, "last_edit_date": 1522029705, "creation_date": 1522028676, "answer_id": 49482849, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/49482849#49482849", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>This works for me in Excel 2010:</p>\n\n<pre><code>Worksheets(\"Sheet1\").UsedRange.Clear  \nWorksheets(\"Sheet1\").UsedRange.Calculate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 7983092, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wBTnBjgRn4k/AAAAAAAAAAI/AAAAAAAAABo/P9Y5_y1iLwY/photo.jpg?sz=128", "display_name": "Joe Cross", "link": "https://stackoverflow.com/users/7983092/joe-cross"}, "is_accepted": false, "score": 0, "last_activity_date": 1536344244, "creation_date": 1536344244, "answer_id": 52227781, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/52227781#52227781", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>Thanks to Claus for having the correct answer, but it is incomplete, and he completed it with a comment on the main post. I'll answer here to combine the useful bits into a single working solution.</p>\n\n<p>Note: I have not tried variations to see which steps are necessary, but these steps work to clear unnecessary used range.</p>\n\n<pre><code>Sub ResetUsedRange()\ndim rngToDelete as range\n\nset rngToDelete = 'Whatever you want\n\nrngToDelete.EntireRow.Clear\nrngToDelete.EntireRow.Select\nSelection.Delete Shift:=xlUp\n\nActiveWorkbook.Save 'This step has been stated to be necessary for the range to reset.\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 5254739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iiZno.jpg?s=128&g=1", "display_name": "AzzaClazza", "link": "https://stackoverflow.com/users/5254739/azzaclazza"}, "is_accepted": false, "score": 0, "last_activity_date": 1550669701, "last_edit_date": 1550669701, "creation_date": 1536795130, "answer_id": 52304766, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/52304766#52304766", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>This is the solution I used.</p>\n\n<pre><code>Sub CorrectUsedRange()\n    Dim values\n    Dim usedRangeAddress As String\n    Dim r As Range\n    'Get UsedRange Address prior to deleting Range\n    usedRangeAddress = ActiveSheet.UsedRange.Address\n    'Store values of cells to array.\n    values = ActiveSheet.UsedRange\n    'Delete all cells in the sheet\n    ActiveSheet.Cells.Delete\n    'Restore values to their initial locations\n    Range(usedRangeAddress) = values\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 2588587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c11c02a96cde4f8d5abff94d046f1e?s=128&d=identicon&r=PG", "display_name": "sirplus", "link": "https://stackoverflow.com/users/2588587/sirplus"}, "is_accepted": false, "score": 1, "last_activity_date": 1538221862, "creation_date": 1538221862, "answer_id": 52568083, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/52568083#52568083", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<ol>\n<li>select cell 1,1 in any sheets you want to reset the UsedRange property</li>\n<li>Calculate all worksheets in all open workbooks, \n regardless of whether they changed since last calculation\n(To Calculate Fully Ctrl+Alt+F9)  </li>\n<li>Save the workbook</li>\n</ol>\n\n<p>Works for me on all versions of excel</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11096363, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a31b3e08fa3df6832e341e76a4a3ac73?s=128&d=identicon&r=PG", "display_name": "Harley", "link": "https://stackoverflow.com/users/11096363/harley"}, "is_accepted": false, "score": 3, "last_activity_date": 1550757760, "creation_date": 1550757760, "answer_id": 54808873, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/54808873#54808873", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>I only needed to use <strong>Worksheets(\"Sheet1\").UsedRange.Calculate</strong> \nafter deleting rows to reset the range.</p>\n"}, {"comments": [{"owner": {"reputation": 1122, "user_id": 538022, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/29cda72275d0909c4bd4804c50be4b39?s=128&d=identicon&r=PG", "display_name": "truthseeker", "link": "https://stackoverflow.com/users/538022/truthseeker"}, "edited": false, "score": 1, "creation_date": 1603349057, "post_id": 64339413, "comment_id": 114010026, "body": "This deletes all content which is not desirable in my case."}], "tags": [], "owner": {"reputation": 23, "user_id": 4279188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD2WM.png?s=128&g=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/4279188/josephd"}, "is_accepted": false, "score": 0, "last_activity_date": 1602606765, "creation_date": 1602606765, "answer_id": 64339413, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/64339413#64339413", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>This worked for me:</p>\n<pre><code>Worksheets(&quot;Sheet1&quot;).UsedRange.Clear\nWorksheets(&quot;Sheet1&quot;).UsedRange = &quot;&quot;\n</code></pre>\n<p>It appears that inserting a value into the UsedRange resets it. After this action I can go</p>\n<pre><code>MyCurrentRow = Worksheets(&quot;Sheet1&quot;).Range(&quot;A:A&quot;).SpecialCells(xlCellTypeLastCell).Row\n</code></pre>\n<p>MyCurrentRow comes now back as 1, and I can just count from there. When I did not assign a value into UsedRange, that LastCell value did not reset. No Save required.</p>\n"}, {"tags": [], "owner": {"reputation": 16595, "user_id": 234670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9659b2c900b006ebfc9483d0cfa9c654?s=128&d=identicon&r=PG", "display_name": "mcgrailm", "link": "https://stackoverflow.com/users/234670/mcgrailm"}, "is_accepted": false, "score": 0, "last_activity_date": 1613498305, "last_edit_date": 1613498305, "creation_date": 1613497968, "answer_id": 66229602, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange/66229602#66229602", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>This is what ended up working for me. I feel there has to be a better way but no others worked for me.</p>\n<pre><code>Sub ClearRangeData()\nDim S1 As Worksheet\n\nSet S1 = Sheets(&quot;Your Sheet Name&quot;)     'Define what sheets we are using\n\n'------- Remove all the old data -----\nS1.Activate\nWith ActiveSheet\n    S1_rows = S1.UsedRange.Rows.Count\n    For I = S1_rows To 1 Step -1\n        Cells(I, 1).EntireRow.Delete\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 464, "user_id": 4862471, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c72e3484c617bb4447c745cd2547698?s=128&d=identicon&r=PG&f=1", "display_name": "Claus", "link": "https://stackoverflow.com/users/4862471/claus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51231, "favorite_count": 3, "accepted_answer_id": 35916315, "answer_count": 13, "score": 6, "last_activity_date": 1613498305, "creation_date": 1456933261, "last_edit_date": 1531161705, "question_id": 35751754, "link": "https://stackoverflow.com/questions/35751754/excel-resetting-usedrange", "title": "Excel resetting &quot;UsedRange&quot;", "body": "<p>Don't know what I'm missing, but the examples I see posted do not appear to work.</p>\n\n<p>I import data from a web query.  I set the query to clear unused cells when it re-queries.\n<a href=\"https://i.stack.imgur.com/ZLLwl.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ZLLwl.gif\" alt=\"As shown here in the last radio button\"></a></p>\n\n<p>I used this imported data to generate a report of variable length.</p>\n\n<p>However if the user (as they need to do in my case) insert rows then the ActiveSheet.UsedRange is expanded.  This means I cannot any longer just do a \"Ctrl-End\" to find the last row in the data set when a new query is performed.</p>\n\n<p>I can easily clear any data with ActiveSheet.UsedRange.Clear.   However if the previous query generated a 2 or 3 page report any subsequent query will also be that long even when there is less data because the \"UsedRange\" still points to that last row way down there.</p>\n\n<p>The examples shown like</p>\n\n<pre><code>ActiveSheet.UsedRange\nActiveSheet.UsedRange.Clear\na = ActiveSheet.UsedRange.Rows.Count\n</code></pre>\n\n<p>do not reset the range.</p>\n\n<p>MS defines UsedRange as a readOnly property.</p>\n\n<p>It appears what needs to happen is a \"File Save\" in order to complete the action.</p>\n\n<pre><code>ActiveWorkbook.Save\n</code></pre>\n\n<p>One post noted that in older versions of Excel you also had to close the workbook and reopen it to complete the action.</p>\n\n<p>I would like to know\n1. What is the version cutoff where this behavior changed?\n2. Is there some other method using a VBA macro which will reset the range?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456933433, "post_id": 35751735, "comment_id": 59176784, "body": "try <code>ActiveSheet.Range(&quot;T&quot; &amp; i3)) .Value2</code>. Also, are you sure that the sheet you think is <i>Active</i>, really is? It&#39;s best to quaiify worksheets to variables and work with the variable directly to <b>ensure</b> you have the exact sheet you want. Like this: <code>Dim ws as Worksheet | Set ws = Worksheets(&quot;Sheet1&quot;) | ws.Range(&quot;AT&quot; &amp; i3)</code>"}, {"owner": {"reputation": 195, "user_id": 3338697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0eef039cd586d26305c5a91c576386ab?s=128&d=identicon&r=PG&f=1", "display_name": "zakariag", "link": "https://stackoverflow.com/users/3338697/zakariag"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456933959, "post_id": 35751735, "comment_id": 59177238, "body": "It doesn&#39;t work with .Value2. And yes, the active sheet is what I think it is, because <code>ActiveSheet.Range(&quot;N&quot; &amp; i3) = 1</code> really writes the value 1 in that sheet"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 3338697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0eef039cd586d26305c5a91c576386ab?s=128&d=identicon&r=PG&f=1", "display_name": "zakariag", "link": "https://stackoverflow.com/users/3338697/zakariag"}, "edited": false, "score": 0, "creation_date": 1456995690, "post_id": 35754560, "comment_id": 59206880, "body": "Your observation about getting 4 when changing +1 to +4 is the key of the solution. Thank you,"}], "tags": [], "owner": {"reputation": 126, "user_id": 5981025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EnD9n.png?s=128&g=1", "display_name": "RFKomos", "link": "https://stackoverflow.com/users/5981025/rfkomos"}, "is_accepted": true, "score": 1, "last_activity_date": 1456941695, "last_edit_date": 1456941695, "creation_date": 1456940992, "answer_id": 35754560, "question_id": 35751735, "link": "https://stackoverflow.com/questions/35751735/in-excel-if-test-passes-when-value-typed-manually-but-fail-from-a-cell/35754560#35754560", "title": "In excel If test passes when value typed manually but fail from a cell", "body": "<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nDim dicos As Dictionary\nSet dicos = new Dictionary\n\n'Populate dicos....\n\nFor i = 2 To n 'n is the the number of rows\n    If dicos.Exists(ws.Cells(i, 20).Value) Then\n        ws.Cells(i, 14) = dicos.Item(ws.Cells(i, 20).Value) + 1\n    Else\n        ws.Cells(i, 14) = 1\n    End If\nNext\n</code></pre>\n\n<p>I believe the problem was that you didn't use <code>.Value</code> on the additive line, thus it was just putting 1 in there. When I tested your code as-posted I changed the +1 to a +4 and got 4 in <code>cells(i,14)</code> instead of 1.</p>\n"}], "owner": {"reputation": 195, "user_id": 3338697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0eef039cd586d26305c5a91c576386ab?s=128&d=identicon&r=PG&f=1", "display_name": "zakariag", "link": "https://stackoverflow.com/users/3338697/zakariag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 35754560, "answer_count": 1, "score": 0, "last_activity_date": 1456941695, "creation_date": 1456933219, "question_id": 35751735, "link": "https://stackoverflow.com/questions/35751735/in-excel-if-test-passes-when-value-typed-manually-but-fail-from-a-cell", "title": "In excel If test passes when value typed manually but fail from a cell", "body": "<p>Using excel VBA, I have constructed a dictionary and populated it. I did my tests and it's well done.\nAfter that, in a loop I had to test if a key exists to do some operations:</p>\n\n<pre><code>For i3 = 2 To n 'n is the the number of rows\n    If dicos.Exists(ActiveSheet.Range(\"T\" &amp; i3)) Then\n        ActiveSheet.Range(\"N\" &amp; i3) = dicos(ActiveSheet.Range(\"T\" &amp; i3)) + 1\n    Else\n        ActiveSheet.Range(\"N\" &amp; i3) = 1\n    End If\nNext\n</code></pre>\n\n<p>It doesn't work and I have 1 in all the column N. I tried to test with some values from the column T manually and it finds it!\nCan anyone explain to me what I have done wrong and why the test is positive when I type the value manually and it is negative when the program has to take it from a cell (column T)?\nThank you very much.</p>\n"}, {"tags": ["vba", "excel", "paste"], "comments": [{"owner": {"reputation": 8756, "user_id": 3795036, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c01d5584e40e3d19507e9a5eaf0bae15?s=128&d=identicon&r=PG", "display_name": "K.Nicholas", "link": "https://stackoverflow.com/users/3795036/k-nicholas"}, "edited": false, "score": 1, "creation_date": 1456932720, "post_id": 35751393, "comment_id": 59176253, "body": "What is the error you get?"}, {"owner": {"reputation": 1, "user_id": 6008606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c80693a10a0e33103878085085376e9f?s=128&d=identicon&r=PG&f=1", "display_name": "Sner88", "link": "https://stackoverflow.com/users/6008606/sner88"}, "reply_to_user": {"reputation": 8756, "user_id": 3795036, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c01d5584e40e3d19507e9a5eaf0bae15?s=128&d=identicon&r=PG", "display_name": "K.Nicholas", "link": "https://stackoverflow.com/users/3795036/k-nicholas"}, "edited": false, "score": 0, "creation_date": 1456932960, "post_id": 35751393, "comment_id": 59176427, "body": "It doesn&#39;t work correctly, because it doesn&#39;t paste after the last row, but it just paste the 10th row from &quot;Koppeling data&quot; sheet 10 times at the &quot;All sessions&quot; sheet"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1456933324, "post_id": 35751393, "comment_id": 59176693, "body": "I provided an answer below, but so you understand why this code does not work the <code>ActiveSheet.Paste</code> is directly set after the worksheet is selected. The code never specifies <b>exactly</b> where to paste. You do call <code>FindingLastRow</code> but this just sets the last row of data to the variable <code>LastRow</code>. It does not select any cell, nor assign a range to work with."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6008606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c80693a10a0e33103878085085376e9f?s=128&d=identicon&r=PG&f=1", "display_name": "Sner88", "link": "https://stackoverflow.com/users/6008606/sner88"}, "edited": false, "score": 0, "creation_date": 1456934000, "post_id": 35751682, "comment_id": 59177264, "body": "How can I set the 10 in the for loop to the final Row of wsK?"}, {"owner": {"reputation": 1, "user_id": 6008606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c80693a10a0e33103878085085376e9f?s=128&d=identicon&r=PG&f=1", "display_name": "Sner88", "link": "https://stackoverflow.com/users/6008606/sner88"}, "edited": false, "score": 0, "creation_date": 1457965134, "post_id": 35751682, "comment_id": 59632422, "body": "Hi Scott, how can I paste the values instead of the formulas?"}, {"owner": {"reputation": 1, "user_id": 6008606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c80693a10a0e33103878085085376e9f?s=128&d=identicon&r=PG&f=1", "display_name": "Sner88", "link": "https://stackoverflow.com/users/6008606/sner88"}, "edited": false, "score": 0, "creation_date": 1457965508, "post_id": 35751682, "comment_id": 59632700, "body": "Hi Scott, how can I paste the values instead of the formulas? Seems like it takes the wrong row from the &#39;Koppeling data&#39; sheet"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1457965452, "last_edit_date": 1457965452, "creation_date": 1456933083, "answer_id": 35751682, "question_id": 35751393, "link": "https://stackoverflow.com/questions/35751393/paste-if-not-and-after-last-row-in-vba/35751682#35751682", "title": "Paste if not &quot;&quot; and after last row in VBA", "body": "<p>Give this a shot. I simplified the code a lot, removed the <code>.Select</code> statements <em>- which should be avoided at all costs-</em> , and assigned variables to objects and worked directly with them.</p>\n\n<pre><code>Public Sub CopyRows()\n\nDim wsK As Worksheet, wsA As Worksheet\nSet wsK = Sheets(\"Koppeling data\")\nSet wsA = Sheets(\"All sessions\")\n\nDim FinalRow as Long\nFinalRow = wsk.Cells(wsk.Rows.Count, 4).End(xlUp).Row\n\n' Loop through each row in Koppeling data\nFor x = 3 To FinalRow\n\n    ' Decide if to copy based on column D\n    If wsK.Cells(x, 4).Value &lt;&gt; \"NO MATCH\" Then\n        wsK.Rows(x).EntireRow.Copy _\n            Destination:=wsA.Range(\"A\" &amp; wsA.Rows.Count).End(xlUp).Offset(1) 'used `.Offset(1)` here so it will paste one row below last row with data.\n        'use this to paste values\n        'wsk.Rows(x).Copy\n        'wsA.Range(\"A\" &amp; wsA.Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n    End If\n\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "is_accepted": false, "score": 0, "last_activity_date": 1456933443, "creation_date": 1456933443, "answer_id": 35751837, "question_id": 35751393, "link": "https://stackoverflow.com/questions/35751393/paste-if-not-and-after-last-row-in-vba/35751837#35751837", "title": "Paste if not &quot;&quot; and after last row in VBA", "body": "<p>You have FindingLastRow as sub, which doesn't do anything. If you want to return the result (in your case the last row), you have to define it as a function:</p>\n\n<pre><code>Function FindingLastRow() as Long\n     'Your existing code\n     FindingLastRow = LastRow\nEnd Function\n</code></pre>\n\n<p>This will return the value of last row, and in the main sub you can just paste into the following row:</p>\n\n<pre><code>Dim lastRow as Long\nlastRow = FindingLastRow\nActiveSheet.Range(\"A\" &amp; lastRow + 1).Paste\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1456933653, "last_edit_date": 1495541757, "creation_date": 1456933653, "answer_id": 35751920, "question_id": 35751393, "link": "https://stackoverflow.com/questions/35751393/paste-if-not-and-after-last-row-in-vba/35751920#35751920", "title": "Paste if not &quot;&quot; and after last row in VBA", "body": "<p>Try to get away from using <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.select.aspx\" rel=\"nofollow noreferrer\">Worksheet.Select</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197597.aspx\" rel=\"nofollow noreferrer\">Range .Select</a> to accomplish your actions. </p>\n\n<pre><code>Public Sub CopyRows()\n    Dim x As Long, lastRow As Long, finalRow As Long\n\n    With Worksheets(\"Koppeling data\")\n    ' Find the last row of data\n        finalRow = .Cells(.Rows.Count, 4).End(xlUp).Row\n        ' Loop through each row\n        For x = 3 To 10 'For x = 3 To finalRow\n            ' Decide if to copy based on column D\n            If UCase(.Cells(x, 4).Value) &lt;&gt; \"NO MATCH\" Then\n                FindingLastRow Worksheets(\"All sessions\"), lastRow\n                .Rows(x).Copy Destination:=Worksheets(\"All sessions\").Range(\"A\" &amp; lastRow + 1)\n            End If\n        Next x\n    End With\nEnd Sub\n\nSub FindingLastRow(ws As Worksheet, ByRef lr As Long)\n    With ws\n        lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\nEnd Sub\n</code></pre>\n\n<p>The <strong>ByRef</strong> allows you to pass a previously declared variable into your helper sub and have that variable return with a changed value.</p>\n\n<hr>\n\n<p><sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 6008606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c80693a10a0e33103878085085376e9f?s=128&d=identicon&r=PG&f=1", "display_name": "Sner88", "link": "https://stackoverflow.com/users/6008606/sner88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1457965452, "creation_date": 1456932371, "last_edit_date": 1456932763, "question_id": 35751393, "link": "https://stackoverflow.com/questions/35751393/paste-if-not-and-after-last-row-in-vba", "title": "Paste if not &quot;&quot; and after last row in VBA", "body": "<p>I there I have the following problem: I would like to paste the results in a new sheet if the outcome is not \"NO MATCH\", how can I paste this in the new sheet and after the last used row? I get an error on the Active.Paste</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Public Sub CopyRows()\n    Sheets(\"Koppeling data\").Select\n    ' Find the last row of data\n    FinalRow = Cells(Rows.Count, 4).End(xlUp).Row\n    ' Loop through each row\n    For x = 3 To 10\n        ' Decide if to copy based on column D\n        ThisValue = Cells(x, 4).Value\n        If ThisValue = \"NO MATCH\" Then\n\n        Else\n            Rows(x).Copy\n            Sheets(\"All sessions\").Select\n            Call FindingLastRow\n            ActiveSheet.Paste\n            Sheets(\"Koppeling data\").Select\n        End If\n    Next x\nEnd Sub\n\n\nSub FindingLastRow()\n    Dim sht As Worksheet\n    Dim LastRow As Long\n\n    Set sht = ThisWorkbook.Worksheets(\"All sessions\")\n\n    LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 411, "user_id": 1483256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5ba31188411ab0fe87550e3b096d205?s=128&d=identicon&r=PG", "display_name": "Viktor Zafirovski", "link": "https://stackoverflow.com/users/1483256/viktor-zafirovski"}, "reply_to_user": {"reputation": 654, "user_id": 5037442, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/75199ed4754399c03e62267158d9445b?s=128&d=identicon&r=PG&f=1", "display_name": "click here", "link": "https://stackoverflow.com/users/5037442/click-here"}, "edited": false, "score": 0, "creation_date": 1456934055, "post_id": 35751067, "comment_id": 59177309, "body": "Please write that as an answer, I would like to give you best answer. :)"}, {"owner": {"reputation": 654, "user_id": 5037442, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/75199ed4754399c03e62267158d9445b?s=128&d=identicon&r=PG&f=1", "display_name": "click here", "link": "https://stackoverflow.com/users/5037442/click-here"}, "edited": false, "score": 1, "creation_date": 1456935299, "post_id": 35751067, "comment_id": 59178227, "body": "Deleted and added as answer"}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 1483256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5ba31188411ab0fe87550e3b096d205?s=128&d=identicon&r=PG", "display_name": "Viktor Zafirovski", "link": "https://stackoverflow.com/users/1483256/viktor-zafirovski"}, "edited": false, "score": 0, "creation_date": 1456935188, "post_id": 35752131, "comment_id": 59178145, "body": "That it did. Now I just have to figure out how to pass that information into PivotCaches.Create. Should be easy. :)"}], "tags": [], "owner": {"reputation": 654, "user_id": 5037442, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/75199ed4754399c03e62267158d9445b?s=128&d=identicon&r=PG&f=1", "display_name": "click here", "link": "https://stackoverflow.com/users/5037442/click-here"}, "is_accepted": true, "score": 1, "last_activity_date": 1456934269, "creation_date": 1456934269, "answer_id": 35752131, "question_id": 35751067, "link": "https://stackoverflow.com/questions/35751067/how-to-create-pivot-from-selection-in-vba-excel/35752131#35752131", "title": "How to create Pivot from selection, in VBA, Excel", "body": "<p>An understanding of <a href=\"https://excelmate.wordpress.com/2013/04/22/excel-r1c1-reference-style-vs-a1/\" rel=\"nofollow\">R1C1 notation</a> would help you answer this.</p>\n"}], "owner": {"reputation": 411, "user_id": 1483256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5ba31188411ab0fe87550e3b096d205?s=128&d=identicon&r=PG", "display_name": "Viktor Zafirovski", "link": "https://stackoverflow.com/users/1483256/viktor-zafirovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 35752131, "answer_count": 1, "score": 0, "last_activity_date": 1456934269, "creation_date": 1456931545, "question_id": 35751067, "link": "https://stackoverflow.com/questions/35751067/how-to-create-pivot-from-selection-in-vba-excel", "title": "How to create Pivot from selection, in VBA, Excel", "body": "<p>I tried analyzing how Excel creates a pivot from a selection. It seems pretty simple. I select the entire range in my document and hit Create Pivot with that range. That produces the following code:</p>\n\n<pre><code>Range(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToRight)).Select\nSheets.Add\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Keyword report!R2C1:R643841C25\", Version:=xlPivotTableVersion15). _\n    CreatePivotTable TableDestination:=\"Sheet38!R3C1\", TableName:=\"PivotTable2\" _\n    , DefaultVersion:=xlPivotTableVersion15\n</code></pre>\n\n<p>I want to use this code in the future, but instead of using a fixed reference to a particular range, I want Excel to draw that data from the Selection. For some reason, that's not included by the Macro Record. I have no idea what \"R2C1:R643841C25\" is or how it is derived. My selection is: A1:Y643841. </p>\n\n<p>The big question: How do I replace R2C1:R643841C25 in the code with the \"Selection\"?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1456931443, "post_id": 35750930, "comment_id": 59175277, "body": "I would say you&#39;re trying to do too much in a single cell. Perhaps have 6 columns, showing <i>bigassformula1</i>, <i>bigassformula2</i>.... and then a final 7th column which says &quot;=IF(C5=&quot;A&quot;,G5,if(C5=&quot;B&quot;,H5...&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456931679, "post_id": 35750930, "comment_id": 59175452, "body": "Formulas can often be made relative to a condition like C5 being either A, B, C, D, E, etc. However, since you&#39;ve decided to keep the actual <i>bigassformulas</i> a secret, it wouldn&#39;t make much sense in providing a fix for the made-up ones."}, {"owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "edited": false, "score": 0, "creation_date": 1456931983, "post_id": 35750930, "comment_id": 59175665, "body": "If the formulas are always the same with known parameters you can always reimplement the function in VBA. Saves you a lot of work, makes it possible to debugg the formula, and if you need to do changes to any formula in the future, you only need to do them in one place."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1456940561, "post_id": 35750930, "comment_id": 59181993, "body": "In VBA it sounds like a job for <code>Select Case</code>, but it is hard to be sure since you have provided so few details."}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 0, "last_activity_date": 1456937814, "creation_date": 1456937814, "answer_id": 35753506, "question_id": 35750930, "link": "https://stackoverflow.com/questions/35750930/whats-an-alternative-to-using-an-if-function-for-long-strings-of-formulas-in-ex/35753506#35753506", "title": "What&#39;s an alternative to using an IF function for long strings of formulas in Excel?", "body": "<p>One thing you can do is create a table of equations and look them up based on the value like so:</p>\n\n<pre><code>=VLOOKUP(G7,EquationLookups,2,FALSE)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MJErh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MJErh.png\" alt=\"Image1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dnuLW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dnuLW.png\" alt=\"Image2\"></a></p>\n\n<p>You would want to put the value you're searching for in the first column, and the formula you want to use in that case in the second column.</p>\n"}], "owner": {"reputation": 11, "user_id": 6008366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50a0513fe631d6aee0d513557baf5614?s=128&d=identicon&r=PG&f=1", "display_name": "Alin G", "link": "https://stackoverflow.com/users/6008366/alin-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456937814, "creation_date": 1456931200, "last_edit_date": 1456935854, "question_id": 35750930, "link": "https://stackoverflow.com/questions/35750930/whats-an-alternative-to-using-an-if-function-for-long-strings-of-formulas-in-ex", "title": "What&#39;s an alternative to using an IF function for long strings of formulas in Excel?", "body": "<p>The case I'm working on requires that I apply one of six different formulas on column W for a long list of rows depending on the corresponding row value on column C.</p>\n\n<p>For example, if cell C5 says \"A\", my formula on W5 must be </p>\n\n<pre><code>=(SUMIFS(K:K,A:A,A5,F:F,F5)*8). \n</code></pre>\n\n<p>Then, if C6 = \"B\", W5 </p>\n\n<pre><code>=SUMIFS(L:L,A:A,A6,F:F,F6), etc.\n</code></pre>\n\n<p>As I mentioned, I have 6 of these formulas which are way longer than the above as here I just stated them as an example, so it's cumbersome to write all the formulas in an IF format i.e. </p>\n\n<pre><code>=IF(C5=\"A\", *bigassformula1*,if(c5=B, *bigassformula2*...)))...\n</code></pre>\n\n<p>Is there any way to do this differently, either through Formulas or VBA?</p>\n"}, {"tags": ["vba", "outlook", "email-forwarding"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6008260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff013cdf9638d104df6a393f61ddcbf?s=128&d=identicon&r=PG&f=1", "display_name": "KenFabIT", "link": "https://stackoverflow.com/users/6008260/kenfabit"}, "edited": false, "score": 0, "creation_date": 1457112834, "post_id": 35753055, "comment_id": 59274309, "body": "Wow, this worked so well! Only one problem: the HTML probably has it&#39;s own definition of the table (as you mentioned) as this Macro only pulls the header. If it could pull the entire table, it would be working great!"}, {"owner": {"reputation": 21, "user_id": 6008260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff013cdf9638d104df6a393f61ddcbf?s=128&d=identicon&r=PG&f=1", "display_name": "KenFabIT", "link": "https://stackoverflow.com/users/6008260/kenfabit"}, "edited": false, "score": 0, "creation_date": 1457114026, "post_id": 35753055, "comment_id": 59275035, "body": "Sorry for the late reply!!! Also, this is so close! But, I took a closer look at the code source of the table. Apparently, it&#39;s 2 tables. The &quot;header&quot; is actually a table on top. Then, there is a second table that has the information that I am most interested in forwarding. This Macro got so close, but it did not delete the text before the table and included it up until then. Sorry to pester, but where can I find some good string manipulation for Macros? Thanks for all of your help!"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 21, "user_id": 6008260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff013cdf9638d104df6a393f61ddcbf?s=128&d=identicon&r=PG&f=1", "display_name": "KenFabIT", "link": "https://stackoverflow.com/users/6008260/kenfabit"}, "edited": false, "score": 0, "creation_date": 1457278893, "post_id": 35753055, "comment_id": 59324478, "body": "If you post the actual string (or a close example) I can give you more specifics. For string manipulation, search for <code>Mid</code>, <code>Instr</code>, and <code>Replace</code>. They&#39;ll get you most of the way. There&#39;s also a regex library if you&#39;re good at that."}, {"owner": {"reputation": 21, "user_id": 6008260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff013cdf9638d104df6a393f61ddcbf?s=128&d=identicon&r=PG&f=1", "display_name": "KenFabIT", "link": "https://stackoverflow.com/users/6008260/kenfabit"}, "edited": false, "score": 0, "creation_date": 1457446704, "post_id": 35753055, "comment_id": 59403365, "body": "I went ahead and added the snippet of what I am trying to manipulate and email forward. Hopefully, that&#39;s enough to work with and see if we can extract just the table. You&#39;re help has been great! Make sure to run the snippet so you can see what I&#39;m seeing."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 1, "last_activity_date": 1456936621, "creation_date": 1456936621, "answer_id": 35753055, "question_id": 35750659, "link": "https://stackoverflow.com/questions/35750659/remove-text-and-hyperlinks-then-forward/35753055#35753055", "title": "Remove text and hyperlinks then forward", "body": "<p>The <code>Body</code> property of a <code>MailItem</code> that you received is read only. That's probably why you're getting an error. You need to forward the message, get the forwarded message, then manipulate it's <code>Body</code>.</p>\n\n<p>If you received an email that had a bunch of stuff in it including one table and you wanted to forward just the table, you could use code like this</p>\n\n<pre><code>Public Sub ForwardTableOnly()\n\n    Dim olMail As MailItem\n    Dim lTblStart As Long, lTblEnd As Long\n\n    Set olMail = ActiveInspector.currentItem.Forward\n\n    lTblStart = InStr(1, olMail.HTMLBody, \"&lt;table\")\n    lTblEnd = InStr(lTblStart, olMail.HTMLBody, \"&lt;/table\")\n\n    olMail.HTMLBody = Mid$(olMail.HTMLBody, lTblStart, lTblEnd - lTblStart + 1)\n    olMail.Display\n\nEnd Sub\n</code></pre>\n\n<p>It finds where the table is in the <code>HTMLBody</code> property and gets rid of everything else. That works, but it's more complicated than that. If you want to keep the table plus some of the other stuff, you'll have more complicated string manipulation. And if the formatting is important to you, you'll have another problem. It's likely that the table is formatted with styles that are defined further up in the <code>HTMLBody</code> along with a bunch of other styles. That's even more string manipulation. But string manipulation is easy enough if not tedious and boring.</p>\n\n<p>The pertinent points are: call the Forward method and assign the resulting MailItem to an object variable. Then set that object's <code>HTMLBody</code> property to whatever you want. In this example, I use the <code>.Display</code> property to show the message. You'll want to use <code>.To</code> and <code>.Send</code> probably rather than <code>.Display</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6008260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff013cdf9638d104df6a393f61ddcbf?s=128&d=identicon&r=PG&f=1", "display_name": "KenFabIT", "link": "https://stackoverflow.com/users/6008260/kenfabit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1593329608, "creation_date": 1456930499, "last_edit_date": 1593329608, "question_id": 35750659, "link": "https://stackoverflow.com/questions/35750659/remove-text-and-hyperlinks-then-forward", "title": "Remove text and hyperlinks then forward", "body": "<p>EDIT: Added snippet of closer to actual string i'm trying to manipulate at the bottom of the post. It's not verbatim, removed key information, but i copied and pasted from the email that I'm trying to forward. Just trying to extract the table at in the middle and forward.</p>\n\n<p>I want to delete specific text on an email that I've received, remove the hyperlinks, keep the formatting, and then forward to a specific address.</p>\n\n<p>Basically, the email is structured as such:</p>\n\n<blockquote>\n  <p>\"Dear user,</p>\n  \n  <p>please find the relevant information below</p>\n  \n  <p>database: records\n  click here to view this online</p>\n  \n  <ul>\n  <li>Table header</li>\n  <li>Column Header</li>\n  <li>Record 1</li>\n  <li>Record 2</li>\n  <li>Record 3</li>\n  <li>...</li>\n  <li>Final Record</li>\n  </ul>\n  \n  <p>If you have trouble using the link above, paste this link in your address bar to go to the online database:</p>\n  \n  <p>somewebsite.database.net/tr/vuioahdf</p>\n  \n  <p>This is an automated email...\"</p>\n</blockquote>\n\n<p>I need to remove the text before the table, remove the hyperlinks, keep the formatting, and forward.</p>\n\n<p>I tried the following.</p>\n\n<pre><code>Sub RemoveExpression()\n\nDim Insp As Inspector\nDim obj As Object\n\n    Set Insp = Application.ActiveInspector\n    Set obj = Insp.CurrentItem\n\n    obj.Body = Replace(obj.Body, \"Dear user, please find the relevant information below database: records click here to view this online - Table header \" &amp; _\n                                    vbNewLine &amp; \"If you have trouble using the link above, paste this link in your address bar to go to the online database http://somewhere.database.net/tr/vuioahdf This is an automated email...\", \"\")\n\n    Set obj = Nothing\n    Set Insp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>It gives me an error about not defining an object, but this is something along the lines of what I'm looking to do. Remove some text before and after a table, remove the hyperlinks, and then forward to specific address. It might not be completely necessary to remove the hyperlinks, as it's mostly in the text before and after the table, but there is a hyperlink in the table header.</p>\n\n<p>Email I'm trying to manipulate:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dear User,&lt;br&gt;\r\n&lt;br&gt;\r\nPlease find below drawing received last week for project\r\n&lt;br&gt; &lt;br&gt;\r\n&lt;b&gt;&lt;u&gt;&lt;/u&gt;Document Control: Projects&lt;u&gt;&lt;/u&gt;&lt;/b&gt;&lt;br&gt;\r\nClick &lt;a href=\"somehwere.net\" target=\"_blank\"&gt;here&lt;/a&gt; to see this report on the database.\r\n&lt;br&gt; &lt;br&gt;\r\n&lt;div style=\"font-size:70%;font-family:Verdana,Helvetica,Geneva,sans-serif\"&gt;\r\n&lt;div&gt;\r\n&lt;table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n&lt;tr style=\"background-color:#c4defb\"&gt;\r\n&lt;td style=\"border-top:1px solid #55a0ef;border-bottom:1px solid #55a0ef\"&gt;\r\n&lt;table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n&lt;tr&gt;\r\n&lt;td style=\"width:200px;padding:4px 8px;font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;color:#505050;font-weight:normal;font-size:9pt\"&gt;\r\n&lt;a style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;color:#505050;font-weight:normal;font-size:9pt;text-decoration:none\" href=\"somewhere.net\" title=\"See this report\" target=\"_blank\"&gt;Full Report&lt;/a&gt;\r\n| &lt;a style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;color:#505050;font-weight:normal;font-size:9pt;text-decoration:none\" href=\"somewhere.net\" title=\"Edit all the Drawings shown below\" target=\"_blank\"&gt;Grid Edit&lt;/a&gt;\r\n&lt;/td&gt;\r\n&lt;td style=\"width:200px;padding:4px 8px;font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;color:#505050;font-weight:normal;font-size:9pt\" align=\"right\"&gt;\r\n&lt;span&gt;&lt;label&gt;Date Created&lt;/label&gt; is during &lt;label&gt; &amp;#39;last 2 wk&amp;#39; &lt;/label&gt; AND ...&lt;/span&gt;    &lt;span&gt;11 Drawings&lt;/span&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/table&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr&gt;\r\n&lt;td&gt;\r\n&lt;table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\"&gt;\r\n&lt;thead style=\"display:table-header-group\"&gt;\r\n&lt;tr&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt; &lt;/td&gt;\r\n&lt;td align=\"right\" style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;div&gt;&lt;/div&gt;&lt;span&gt;Date Created&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Project Name&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Sub Project&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Project Description&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Drawing Number&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Revision&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Title&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;background-color:#f6f9fd;padding:3px 4px;font-weight:bold;font-size:10pt;color:#111111\"&gt;&lt;span&gt;Transmittal&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/thead&gt;\r\n&lt;tbody style=\"display:table-row-group\"&gt;\r\n&lt;tr&gt;\r\n&lt;td nowrap style=\"border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt; &lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\" align=\"right\"&gt;02-18-2016&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;Rig xxx&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;120&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;Structure&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;00813-121-000-001WM&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;0&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;REAR FRAME&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;02182016&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr style=\"background-color:#f2f2f2\"&gt;\r\n&lt;td nowrap style=\"border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt; &lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\" align=\"right\"&gt;02-18-2016&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;Rig xxx&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;120&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;Structure&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;00813-121-000-000&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;0&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;REAR ASSEMBLY&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;01282016&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr&gt;\r\n&lt;td nowrap style=\"border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt; &lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\" align=\"right\"&gt;02-18-2016&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;Rig xxx&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;120&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;Structure&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;00813-121-000-001&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;0&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;REAR FRAME&lt;/td&gt;\r\n&lt;td style=\"font-family:Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;border-left:1px solid #ccc;border-bottom:1px solid #ccc;padding:3px 4px;font-size:10pt;color:#111111\"&gt;01282016&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/tbody&gt;\r\n&lt;/table&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/table&gt;\r\n&lt;/div&gt;\r\n&lt;/div&gt;\r\n&lt;br&gt;\r\nIf you have trouble using the link above, copy and paste the following Web address into the address bar of your browser:\r\n&lt;br&gt;   &lt;a href=\"somewhere.net\" target=\"_blank\"&gt;somewhere.net&lt;/a&gt;\r\n&lt;br&gt; &lt;br&gt;\r\nThis is an automated email from an online application. If you feel that you received this email in error, please contact the application's manager,\r\n&lt;a href=\"mailto:someone@projects.net\" target=\"_blank\"&gt;someone@projects.net&lt;/a&gt;\r\n&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\r\n&lt;/div&gt;\r\n&lt;/font&gt;&lt;/div&gt;&lt;/table&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1456932016, "post_id": 35750645, "comment_id": 59175700, "body": "It seems that your function Assets(TG,n,n,j) is expecting 5 arguments while you are passing only 4. Best regards,"}, {"owner": {"reputation": 23, "user_id": 6008217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2253863c4f74c72bff8422eaebb7bf?s=128&d=identicon&r=PG&f=1", "display_name": "V.Loeffert", "link": "https://stackoverflow.com/users/6008217/v-loeffert"}, "edited": false, "score": 0, "creation_date": 1456932510, "post_id": 35750645, "comment_id": 59176110, "body": "I get the following error: Error 3346: The number of query fields and destination fields are not the same. And I did give the function 5 arguments, just edited it wrong in the post, sorry., same error arises."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456933775, "post_id": 35750645, "comment_id": 59177088, "body": "What <b>exactly</b> does <code>Assets()</code> return?"}, {"owner": {"reputation": 23, "user_id": 6008217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2253863c4f74c72bff8422eaebb7bf?s=128&d=identicon&r=PG&f=1", "display_name": "V.Loeffert", "link": "https://stackoverflow.com/users/6008217/v-loeffert"}, "edited": false, "score": 0, "creation_date": 1456939943, "post_id": 35750645, "comment_id": 59181603, "body": "It returns a value like 1124,74. If I just let a msgbox return Assets() in the same macro it works just fine, just not in the sql string."}, {"owner": {"reputation": 23, "user_id": 6008217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2253863c4f74c72bff8422eaebb7bf?s=128&d=identicon&r=PG&f=1", "display_name": "V.Loeffert", "link": "https://stackoverflow.com/users/6008217/v-loeffert"}, "edited": false, "score": 0, "creation_date": 1456993853, "post_id": 35750645, "comment_id": 59205692, "body": "I found my mistake. It wasn&#39;t the SQL statement but the value. VBA thought 1124,74 were two values, so I just had to replace the comma with a dot. But thanks for your help anyway!"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1462109822, "creation_date": 1462109822, "answer_id": 36967283, "question_id": 35750645, "link": "https://stackoverflow.com/questions/35750645/insert-excel-vba-function-values-into-access/36967283#36967283", "title": "insert excel vba function values into access", "body": "<p>You shouldn't <em>replace</em> but <em>convert</em>. Although solved by now, in the future you may benefit from this function which does exactly that:</p>\n\n<pre><code>' Converts a value of any type to its string representation.\n' The function can be concatenated into an SQL expression as is\n' without any delimiters or leading/trailing white-space.\n'\n' Examples:\n'   SQL = \"Select * From TableTest Where [Amount]&gt;\" &amp; CSql(12.5) &amp; \"And [DueDate]&lt;\" &amp; CSql(Date) &amp; \"\"\n'   SQL -&gt; Select * From TableTest Where [Amount]&gt; 12.5 And [DueDate]&lt; #2016/01/30 00:00:00#\n'\n'   SQL = \"Insert Into TableTest ( [Street] ) Values (\" &amp; CSql(\" \") &amp; \")\"\n'   SQL -&gt; Insert Into TableTest ( [Street] ) Values ( Null )\n'\n' Trims text variables for leading/trailing Space and secures single quotes.\n' Replaces zero length strings with Null.\n' Formats date/time variables as safe string expressions.\n' Uses Str to format decimal values to string expressions.\n' Returns Null for values that cannot be expressed with a string expression.\n'\n' 2016-01-30. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function CSql( _\n    ByVal Value As Variant) _\n    As String\n\n    Const vbLongLong    As Integer = 20\n    Const SqlNull       As String = \" Null\"\n\n    Dim Sql             As String\n    Dim LongLong        As Integer\n\n    #If Win32 Then\n        LongLong = vbLongLong\n    #End If\n    #If Win64 Then\n        LongLong = VBA.vbLongLong\n    #End If\n\n    Select Case VarType(Value)\n        Case vbEmpty            '    0  Empty (uninitialized).\n            Sql = SqlNull\n        Case vbNull             '    1  Null (no valid data).\n            Sql = SqlNull\n        Case vbInteger          '    2  Integer.\n            Sql = Str(Value)\n        Case vbLong             '    3  Long integer.\n            Sql = Str(Value)\n        Case vbSingle           '    4  Single-precision floating-point number.\n            Sql = Str(Value)\n        Case vbDouble           '    5  Double-precision floating-point number.\n            Sql = Str(Value)\n        Case vbCurrency         '    6  Currency.\n            Sql = Str(Value)\n        Case vbDate             '    7  Date.\n            Sql = Format(Value, \" \\#yyyy\\/mm\\/dd hh\\:nn\\:ss\\#\")\n        Case vbString           '    8  String.\n            Sql = Replace(Trim(Value), \"'\", \"''\")\n            If Sql = \"\" Then\n                Sql = SqlNull\n            Else\n                Sql = \" '\" &amp; Sql &amp; \"'\"\n            End If\n        Case vbObject           '    9  Object.\n            Sql = SqlNull\n        Case vbError            '   10  Error.\n            Sql = SqlNull\n        Case vbBoolean          '   11  Boolean.\n            Sql = Str(Abs(Value))\n        Case vbVariant          '   12  Variant (used only with arrays of variants).\n            Sql = SqlNull\n        Case vbDataObject       '   13  A data access object.\n            Sql = SqlNull\n        Case vbDecimal          '   14  Decimal.\n            Sql = Str(Value)\n        Case vbByte             '   17  Byte.\n            Sql = Str(Value)\n        Case LongLong           '   20  LongLong integer (Valid on 64-bit platforms only).\n            Sql = Str(Value)\n        Case vbUserDefinedType  '   36  Variants that contain user-defined types.\n            Sql = SqlNull\n        Case vbArray            ' 8192  Array.\n            Sql = SqlNull\n        Case Else               '       Should not happen.\n            Sql = SqlNull\n    End Select\n\n    CSql = Sql &amp; \" \"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6008217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d2253863c4f74c72bff8422eaebb7bf?s=128&d=identicon&r=PG&f=1", "display_name": "V.Loeffert", "link": "https://stackoverflow.com/users/6008217/v-loeffert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594651439, "creation_date": 1456930463, "last_edit_date": 1594651439, "question_id": 35750645, "link": "https://stackoverflow.com/questions/35750645/insert-excel-vba-function-values-into-access", "title": "insert excel vba function values into access", "body": "<p>I have been puzzling over this problem and can't seem to work it out by myself. I wrote an Excel tool that will calculate a specific amount of money. I have to do this for 10,000 different cases and have to store the results in Access. I haven't been able to figure out how, though. The function I need to use looks something like this:</p>\n\n<pre><code>&gt; Public Function Assets(TG As Integer, t As Integer, n As Integer,\n&gt; Tarif As String, j As Integer)\n&gt; \n&gt; Assets = ...\n&gt; \n&gt; End Function\n</code></pre>\n\n<p>In the same module, I have a macro that combines a few procedures and should also insert the results into my Access database. I have two columns in this database: the case number and the value of the result.</p>\n\n<pre><code>&gt; Sub Results()\n&gt; \n&gt; Dim n As Integer Dim Tarif As String Dim TG As Integer Dim t As\n&gt; Integer Dim i As Integer Dim j As Integer Dim dbfile2 As String Dim\n&gt; dbe2 As Object    ' As DAO.DBEngine Dim db2  As Object    ' As\n&gt; DAO.Database Dim rs2 As Object     ' AS DAO.Recordset\n&gt; \n&gt; \n&gt; n = ... Tarif = ... TG = ...\n&gt; \n&gt; For j = 1 To 10000\n&gt; \n&gt;     'Opens the Access database\n&gt;     dbfile2 = \"\\\\r74efc11\\PR_GDV_TRA\\Transparenz_2016_2017\\20_TP_F\\02_Arbeitspakete\\CRK_Berechnung\\Beispiel-Hochrechnung\\Hochrechnung_Ablaufverm\u00f6gen_Test.accdb\"\n&gt;     Set dbe2 = CreateObject(\"DAO.DBEngine.120\")\n&gt;     Set db2 = dbe2.OpenDatabase(dbfile2)\n&gt;    \n&gt;     db2.Execute \"INSERT INTO Tabelle1 (Nr, [Value])VALUES(\" &amp; j &amp; \",\" &amp; Assets(TG,n,n,j) &amp; \")\"\n&gt;   \n&gt;     db2.Close\n&gt;     Set db2 = Nothing\n&gt;     Set dbe2 = Nothing\n&gt; \n&gt; Next j\n&gt; \n&gt; End Sub\n</code></pre>\n\n<p>This code works fine without the Assets-function and the Assets-function runs correctly in Excel as well. I just want to insert the result in my Access database. \nCan anyonle help me with this? All I could find online was how to insert worksheet functions but this doesn't apply in my case. I've tried to modify that but without any luck.</p>\n"}, {"tags": ["sql", "string", "vba", "variables", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 5919239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rWmyY.jpg?s=128&g=1", "display_name": "Richard Boyce", "link": "https://stackoverflow.com/users/5919239/richard-boyce"}, "is_accepted": true, "score": 0, "last_activity_date": 1456930563, "creation_date": 1456930563, "answer_id": 35750688, "question_id": 35750605, "link": "https://stackoverflow.com/questions/35750605/requery-using-a-variable-within-string/35750688#35750688", "title": "Requery using a variable within string", "body": "<p>You just need to add a couple of ampersands</p>\n\n<pre><code>&amp; \" WHERE [qry_Records].[Due] &lt; \" &amp; Day &amp; \";\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 5999935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153674301077261/picture?type=large", "display_name": "Jason Chan", "link": "https://stackoverflow.com/users/5999935/jason-chan"}, "edited": false, "score": 0, "creation_date": 1456931474, "post_id": 35750725, "comment_id": 59175299, "body": "This works too! but i think Richard&#39;s answer is the one im looking for. Thanks for your help anyways!"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 45, "user_id": 5999935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153674301077261/picture?type=large", "display_name": "Jason Chan", "link": "https://stackoverflow.com/users/5999935/jason-chan"}, "edited": false, "score": 0, "creation_date": 1456932896, "post_id": 35750725, "comment_id": 59176378, "body": "They are more or less equivalent. I have just added some extra formatting make sure it would work independently of the user&#39;s regional settings (French or German for instance)"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1456930642, "creation_date": 1456930642, "answer_id": 35750725, "question_id": 35750605, "link": "https://stackoverflow.com/questions/35750605/requery-using-a-variable-within-string/35750725#35750725", "title": "Requery using a variable within string", "body": "<p>I would try this:  </p>\n\n<pre><code>SQL = \"SELECT [Tool_ID], [Cal_Date],\" _\n    &amp; \"[Cal_By], [As_Received], \" _\n    &amp; \"[Result], [Next_Due], \" _\n    &amp; \"[Due] FROM [qry_Records]\" _\n    &amp; \" WHERE [Due] &lt; \" &amp; format$(txtDays, \"\\#dd\\/mm\\/yyyy\\#\")\n\nsubform_View_Search_Records.Form.RecordSource = SQL\n</code></pre>\n\n<p>The final \";\" is useless.</p>\n"}], "owner": {"reputation": 45, "user_id": 5999935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153674301077261/picture?type=large", "display_name": "Jason Chan", "link": "https://stackoverflow.com/users/5999935/jason-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 35750688, "answer_count": 2, "score": 0, "last_activity_date": 1456930642, "creation_date": 1456930368, "question_id": 35750605, "link": "https://stackoverflow.com/questions/35750605/requery-using-a-variable-within-string", "title": "Requery using a variable within string", "body": "<p>I am having trouble to requery my subform using a SQL string, here is my code:</p>\n\n<pre><code>Dim Day As Integer\nDay = txt_Days.Value         \nSQL = \"SELECT [qry_Records].[Tool_ID], [qry_Records].[Cal_Date],\" _\n    &amp; \"[qry_Records].[Cal_By], [qry_Records].[As_Received], \" _\n    &amp; \"[qry_Records].[Result], [qry_Records].[Next_Due], \" _\n    &amp; \"[qry_Records].[Due] FROM [qry_Records]\" _\n    &amp; \" WHERE [qry_Records].[Due] &lt; Day;\"\n\nsubform_View_Search_Records.Form.RecordSource = SQL\n</code></pre>\n\n<p>I tried to use different variations to quote the Day variable at the end of the SQL String such as below but nothing works: </p>\n\n<pre><code>&amp; \" WHERE [qry_Records].[Due] &lt; \"\"Day\"\";\"\n&amp; \" WHERE [qry_Records].[Due] &lt; '\"Day\"';\"\n</code></pre>\n\n<p>Your help is much appreciated!</p>\n"}, {"tags": ["vba", "types", "variant"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 4, "creation_date": 1456933529, "post_id": 35750449, "comment_id": 59176887, "body": "You could change <code>SomeMethod</code> to <code>sub SomeMethod(var as variant): set var = xxx ...</code> and assign to v byref style with <code>SomeMethod v</code>"}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1456955300, "post_id": 35750449, "comment_id": 59190940, "body": "@AlexK.: Coincidentally, that&#39;s exactly what I ended up using, although for other reasons (I needed something similar to .NET&#39;s TryParse/TryGet pattern, so I had SomeMethod return a Boolean and use ByRef for the Variant). I still need to make that ugly IsObject check inside SomeMethod, which bothers me a bit, but I guess there just is no <code>LetSet v = ...</code> statement in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 2, "creation_date": 1573579600, "post_id": 36898101, "comment_id": 103924304, "body": "Another syntax would be to treat <code>LetSet</code> as a (parametric) property, allowing you to do <code>LetSet(v) = SomeMethod()</code> - <a href=\"https://codereview.stackexchange.com/q/231790/146810\">see here</a> for the code"}], "tags": [], "owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "is_accepted": true, "score": 13, "last_activity_date": 1462104136, "last_edit_date": 1462104136, "creation_date": 1461781913, "answer_id": 36898101, "question_id": 35750449, "link": "https://stackoverflow.com/questions/35750449/how-can-i-assign-a-variant-to-a-variant-in-vba/36898101#36898101", "title": "How can I assign a Variant to a Variant in VBA?", "body": "<p>In VBA, the only way to assign a Variant to a variable where you don't know if it is an object or a primitive, is by passing it as a parameter.</p>\n\n<p>If you cannot refactor your code so that the <code>v</code> is passed as a parameter to a Sub, Function or Let Property (despite the <code>Let</code> this also works on objects), you could always declare <code>v</code> in module scope and have a dedicated Sub solely for the purpose of save-assigning that variable:</p>\n\n<pre><code>Private v As Variant\n\nPrivate Sub SetV(ByVal var As Variant)\n    If IsObject(var) Then\n        Set v = var\n    Else\n        v = var\n    End If\nEnd Sub\n</code></pre>\n\n<p>with somewhere else calling <code>SetV SomeMethod()</code>.</p>\n\n<p>Not pretty, but it's the only way without calling <code>SomeMethod()</code> twice or touching its inner workings.</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>Ok, I mulled over this and I think I found a better solution that comes closer to what you had in mind:</p>\n\n<pre><code>Public Sub LetSet(ByRef variable As Variant, ByVal value As Variant)\n    If IsObject(value) Then\n        Set variable = value\n    Else\n        variable = value\n    End If\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>[...] I guess there just is no LetSet v = ... statement in VBA</p>\n</blockquote>\n\n<p>Now there is: <code>LetSet v, SomeMethod()</code></p>\n\n<p>You don't have a return value that you need to <code>Let</code> or <code>Set</code> to a variable depending of its type, instead you pass the variable that should hold the return value as first parameter <em>by reference</em> so that the Sub can change its value.</p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1462106898, "last_edit_date": 1462106898, "creation_date": 1462105866, "answer_id": 36966662, "question_id": 35750449, "link": "https://stackoverflow.com/questions/35750449/how-can-i-assign-a-variant-to-a-variant-in-vba/36966662#36966662", "title": "How can I assign a Variant to a Variant in VBA?", "body": "<p>You could use error trapping to reduce the expected number of method calls. First try to set. If that succeeds -- no problem. Otherwise, just assign:</p>\n\n<pre><code>Public counter As Long\n\nFunction Ambiguous(b As Boolean) As Variant\n    counter = counter + 1\n    If b Then\n        Set Ambiguous = ActiveSheet\n    Else\n        Ambiguous = 1\n    End If\nEnd Function\n\nSub test()\n    Dim v As Variant\n    Dim i As Long, b As Boolean\n\n    Randomize\n    counter = 0\n    For i = 1 To 100\n        b = Rnd() &lt; 0.5\n        On Error Resume Next\n            Set v = Ambiguous(b)\n            If Err.Number &gt; 0 Then\n                Err.Clear\n                v = Ambiguous(b)\n            End If\n        On Error GoTo 0\n    Next i\n    Debug.Print counter / 100\n\nEnd Sub\n</code></pre>\n\n<p>When I ran the code, the first time I got 1.55, which is less than the 2.00 you would get if you repeated the experiment but with the error-handling approach replaced by the na\u00efve <code>if-then-else</code> approach you discussed in your question.</p>\n\n<p>Note that the more often the function returns an object, the less function calls on average. If it almost always returns an object (e.g. that is what it is supposed to return but returns a string describing an error condition in certain cases) then this way of doing things will approach 1 call per setting/ assigning the variable. On the other hand -- if it almost always returns a primitive value then you will approach 2 calls per assignment -- in which case perhaps you should refactor your code.</p>\n"}, {"comments": [{"owner": {"reputation": 1567, "user_id": 8488913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oF9AE.png?s=128&g=1", "display_name": "Cristian Buse", "link": "https://stackoverflow.com/users/8488913/cristian-buse"}, "edited": false, "score": 0, "creation_date": 1594562363, "post_id": 55838668, "comment_id": 111162988, "body": "The method could return a specific Object for example. You need to cast the method call to a Variant to avoid crashes: VariantCopy v, CVar(SomeMethod())"}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 1567, "user_id": 8488913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oF9AE.png?s=128&g=1", "display_name": "Cristian Buse", "link": "https://stackoverflow.com/users/8488913/cristian-buse"}, "edited": false, "score": 0, "creation_date": 1596277436, "post_id": 55838668, "comment_id": 111764770, "body": "@CristianBuse really? Can you give an example of such an object? I&#39;ve not experienced this previously but would like to learn what causes that crash to occurr :)"}, {"owner": {"reputation": 1567, "user_id": 8488913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oF9AE.png?s=128&g=1", "display_name": "Cristian Buse", "link": "https://stackoverflow.com/users/8488913/cristian-buse"}, "edited": false, "score": 0, "creation_date": 1596376411, "post_id": 55838668, "comment_id": 111786180, "body": "Apologies for not testing properly. I was using &#39;Function&#39; instead of &#39;Sub&#39; for the declaration of the VariantCopy API and I was also missing the return type (As Long) which compromises the API. Using your declaration works fine."}], "tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": false, "score": 2, "last_activity_date": 1556140561, "creation_date": 1556140561, "answer_id": 55838668, "question_id": 35750449, "link": "https://stackoverflow.com/questions/35750449/how-can-i-assign-a-variant-to-a-variant-in-vba/55838668#55838668", "title": "How can I assign a Variant to a Variant in VBA?", "body": "<p><a href=\"https://stackoverflow.com/questions/55810316/using-getmem-and-varptr-to-get-around-object-default-values?noredirect=1#comment98340983_55810316\">It appears that I wasn't the only one with this issue.</a></p>\n\n<p>The solution was given to me <a href=\"http://www.vbforums.com/showthread.php?873949-How-to-set-a-variant-without-VB6-default-value\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In short:</p>\n\n<pre><code>Public Declare Sub VariantCopy Lib \"oleaut32.dll\" (ByRef pvargDest As Variant, ByRef pvargSrc As Variant)\nSub Main()\n  Dim v as Variant\n  VariantCopy v, SomeMethod()\nend sub\n</code></pre>\n\n<p>It seems this is similar to the <code>LetSet()</code> function described in the answer, but I figured this'd be useful anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 1567, "user_id": 8488913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oF9AE.png?s=128&g=1", "display_name": "Cristian Buse", "link": "https://stackoverflow.com/users/8488913/cristian-buse"}, "is_accepted": false, "score": 3, "last_activity_date": 1592338643, "last_edit_date": 1592338643, "creation_date": 1592338218, "answer_id": 62416803, "question_id": 35750449, "link": "https://stackoverflow.com/questions/35750449/how-can-i-assign-a-variant-to-a-variant-in-vba/62416803#62416803", "title": "How can I assign a Variant to a Variant in VBA?", "body": "<pre><code>Dim v As Variant\nFor Each v In Array(SomeMethod())\n    Exit For 'Needed for v to retain it's value\nNext v\n'Use v here - v is now holding a value or a reference\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1603491475, "creation_date": 1603491475, "answer_id": 64507940, "question_id": 35750449, "link": "https://stackoverflow.com/questions/35750449/how-can-i-assign-a-variant-to-a-variant-in-vba/64507940#64507940", "title": "How can I assign a Variant to a Variant in VBA?", "body": "<pre><code>Dim v As Variant\nDim a As Variant\na = Array(SomeMethod())\nIf IsObject(a(0)) Then\n    Set v = a(0)\nElse\n    v = a(0)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4483, "favorite_count": 5, "accepted_answer_id": 36898101, "answer_count": 5, "score": 15, "last_activity_date": 1603491475, "creation_date": 1456929966, "last_edit_date": 1456930291, "question_id": 35750449, "link": "https://stackoverflow.com/questions/35750449/how-can-i-assign-a-variant-to-a-variant-in-vba", "title": "How can I assign a Variant to a Variant in VBA?", "body": "<p><em>(Warning: Although it might look like one at first glance, this is <strong>not</strong> a beginner-level question. If you are familiar with the phrase \"Let coercion\" or you have ever looked into the VBA spec, please keep on reading.)</em></p>\n\n<p>Let's say I have an expression of type <code>Variant</code>, and I want to assign it to a variable. Sounds easy, right?</p>\n\n<pre><code>Dim v As Variant\n\nv = SomeMethod()    ' SomeMethod has return type Variant\n</code></pre>\n\n<p>Unfortunately, if <code>SomeMethod</code> returns an Object (i.e., a Variant with a VarType of vbObject), <a href=\"https://msdn.microsoft.com/en-us/library/ee177257.aspx\">Let coercion</a> kicks in and <code>v</code> contains the \"Simple data value\" of the object. In other words, if SomeMethod returns a reference to a TextBox, <code>v</code> will contain a string.</p>\n\n<p>Obviously, the solution is to use <code>Set</code>:</p>\n\n<pre><code>Dim v As Variant\n\nSet v = SomeMethod()\n</code></pre>\n\n<p>This, unfortunately, fails if <code>SomeMethod</code> does <em>not</em> return an object, e.g. a string, yielding a <em>Type Mismatch</em> error.</p>\n\n<p>So far, the only solution I have found is:</p>\n\n<pre><code>Dim v As Variant\n\nIf IsObject(SomeMethod()) Then\n    Set v = SomeMethod()\nElse\n    v = SomeMethod()\nEnd If\n</code></pre>\n\n<p>which has the unfortunate side effect of calling <code>SomeMethod</code> twice.</p>\n\n<p>Is there a solution which does <em>not</em> require calling <code>SomeMethod</code> twice?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930354, "post_id": 35750416, "comment_id": 59174343, "body": "No they can&#39;t (unless you want to start messing around with Timers and/or events). UDFs called from cells can broadly speaking only return values to those same cells. You could however output the array to the immediate window."}, {"owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930422, "post_id": 35750416, "comment_id": 59174400, "body": "Thanks for the quick response. What do you mean by output the array to the &#39;immediate window&#39;?"}, {"owner": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456930791, "post_id": 35750416, "comment_id": 59174709, "body": "Hi there, I have done much VBA, and this should be possible. Based on your question I cannot tell if you are trying to use the VBA function in a cell, like this in a cell &quot; =CheckArray(TestArray)&quot;. If that is so then Rory is correct in that your result will only go to that cell where you put your function as a formula. But you should be able to, via VBA in code specify a range object that can specify which cell to send the result to on any sheet you require."}, {"owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "edited": false, "score": 0, "creation_date": 1456931018, "post_id": 35750416, "comment_id": 59174915, "body": "Hi Palu. I am indeed using a user-defined function in a cell. Do you mean that I can use the function to change a named range and then print that named range with my matrix in? I&#39;m also interested in how I could view my matrix in the immediate window."}, {"owner": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456931102, "post_id": 35750416, "comment_id": 59174986, "body": "Also, based on the last line of your code, seems like you are trying to output a 2-D array, that is Matrix into one cell. You can put a number or string into a cell but I doubt a Matrix. You need to loop thru the matrix putting each element of the Matrix into a cell here being &quot;A1&quot;, replicating the Matrix structure on the worksheet."}, {"owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "edited": false, "score": 0, "creation_date": 1456931503, "post_id": 35750416, "comment_id": 59175324, "body": "Hi Palu. That last line worked for a matrix I created outside of the function. It seems to be related to it being incompatible with user-defined functions. Regarding printing to the immediate window I found the following was useful: <a href=\"http://stackoverflow.com/questions/14274949/how-to-print-two-dimensional-array-in-immediate-window-in-vba\" title=\"how to print two dimensional array in immediate window in vba\">stackoverflow.com/questions/14274949/&hellip;</a>"}, {"owner": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456931792, "post_id": 35750416, "comment_id": 59175543, "body": "OK, I could not infer from your question that you were trying to use your function in a cell, I just went with what Rory said. Yes, printing the results to your window is another way to debug, I usually just use MsgBox for that when I want to check for particular value. But when you want to print an array, I would put it on the worksheet."}, {"owner": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456932043, "post_id": 35750416, "comment_id": 59175723, "body": "Yes, with range object, you can put your results be it values or arrays on to any range of cells you like. It does not have to be a named range. To write this is pseudocode you do this: range(C3:D9) which is 7rows by 2columns matrix. You can also specify named ranges in code. SO you have the cell addressing method and the named range method. So you cannot assign an array into a cell, only values."}, {"owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "edited": false, "score": 0, "creation_date": 1456933804, "post_id": 35750416, "comment_id": 59177112, "body": "That doesn&#39;t work for me - I think because of using a function rather than a macro. I&#39;ve looked into the immediate window thing a bit more and want to know if there is a way of exporting data FROM the immediate window. There is lots out there about printing TO the immediate window and other files. But I can&#39;t do that because of this user-defined function issue. So what I need to know is how to export data that is contained in the immediate window. Currently I&#39;ll have to do that manually."}], "answers": [{"comments": [{"owner": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456936344, "post_id": 35752467, "comment_id": 59179099, "body": "OK, you see the issue is, if you have to print a 2-D array, and want to put all of that into a cell, I doubt you would be able to do that with a function in a cell. Because a function by definition returns a value. You may be able to print a concatenated string of all the values of the Matrix into a cell. But you would have to create a function specifying the return type being a String. A user function used in a cell should be a Function and not a procedure(Sub)."}, {"owner": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456936410, "post_id": 35752467, "comment_id": 59179151, "body": "I just can&#39;t imagine why you would want to print so much data, like a Matrix into one cell in the spreadsheet."}, {"owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "reply_to_user": {"reputation": 538, "user_id": 3923629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfdd7989edaa03170a98b8032472cc0f?s=128&d=identicon&r=PG", "display_name": "Palu", "link": "https://stackoverflow.com/users/3923629/palu"}, "edited": false, "score": 0, "creation_date": 1456936616, "post_id": 35752467, "comment_id": 59179312, "body": "The function actually returns several different values depending on the column it is in. Producing an array for QA was obviously a step too far. Still the above seems to do what I needed. Thanks for your help."}], "tags": [], "owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "is_accepted": false, "score": 1, "last_activity_date": 1456937383, "last_edit_date": 1495541269, "creation_date": 1456935087, "answer_id": 35752467, "question_id": 35750416, "link": "https://stackoverflow.com/questions/35750416/vba-function-calls-vba-sub-to-print-array-to-worksheet/35752467#35752467", "title": "VBA function calls VBA sub to print array to worksheet", "body": "<p>To summarise:</p>\n\n<p>As I am using a user-defined function which is entered in a cell in a worksheet I cannot export data to anywhere but that cell. However, I can view the arrays in the Immediate Window.</p>\n\n<p>In MS Excel 2010 the Immediate Window can be found in the VBA editor (Alt+F11) and then click on View -> Immediate Window (Ctrl+G).</p>\n\n<p>To export my array to the Immediate Window I should enter this into my code after the array I want to view:</p>\n\n<pre><code>Call WriteArrayToImmediateWindow(MyArray)\n</code></pre>\n\n<p>Where 'MyArray' is the name of my array, whatever that is.</p>\n\n<p>This will then call the 'WriteArrayToImmediateWindow' sub, which is:</p>\n\n<pre><code>Sub WriteArrayToImmediateWindow(arrSubA As Variant)\n\nDim rowString As String\nDim iSubA As Long\nDim jSubA As Long\n\nrowString = \"\"\n\nDebug.Print\nDebug.Print \"The array is: \"\nFor iSubA = 1 To UBound(arrSubA, 1)\n    rowString = arrSubA(iSubA, 1)\n    For jSubA = 2 To UBound(arrSubA, 2)\n        rowString = rowString &amp; \",\" &amp; arrSubA(iSubA, jSubA)\n    Next jSubA\n    Debug.Print rowString\nNext iSubA\n\nEnd Sub\n</code></pre>\n\n<p>Credit for the above goes to User3706920: <a href=\"https://stackoverflow.com/questions/14274949/how-to-print-two-dimensional-array-in-immediate-window-in-vba?lq=1\">How to print two dimensional array in Immediate window in VBA?</a></p>\n\n<p>EDIT:</p>\n\n<p>I decided that viewing the arrays in the Immediate Window wasn't always useful and I needed to view the data comma-separated in Excel. If you want to do the same follow the below instructions:</p>\n\n<p>To export the array to a text file you should enter this into your code after the array you want to view:</p>\n\n<pre><code>Call WriteToFile(MyArray)\n</code></pre>\n\n<p>Where 'MyArray' is again the name of the array you want to review. The 'WriteToFile macro is as follows:</p>\n\n<pre><code>Sub WriteToFile(arrSubA As Variant)\n'To export array to a text file\n    'Setup\n    Dim FSO As Object\n    Dim ofs As Object\n    Dim Output As Variant\n    Dim rowString As String\n    Dim iSubA As Long\n    Dim jSubA As Long\n    rowString = \"\"\n\n    'Create file\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Dim oFile As Object\n    Set oFile = FSO.CreateTextFile(\"C:\\Users\\\" &amp; Environ$(\"username\") &amp; \"\\Desktop\\Array.txt\")\n    oFile.Close\n    For iSubA = 1 To UBound(arrSubA, 1)\n        rowString = arrSubA(iSubA, 1)\n        For jSubA = 2 To UBound(arrSubA, 2)\n            rowString = rowString &amp; \",\" &amp; arrSubA(iSubA, jSubA)\n        Next jSubA\n        If Len(Dir(\"C:\\Users\\\" &amp; Environ$(\"username\") &amp; \"\\Desktop\\Array.txt\")) &gt; 0 Then\n            Set ofs = FSO.OpenTextFile(\"C:\\Users\\\" &amp; Environ$(\"username\") &amp; \"\\Desktop\\Array.txt\", 8, True)\n        End If\n        ofs.WriteLine rowString\n        ofs.Close\n    Next iSubA\nEnd Sub\n</code></pre>\n\n<p>To quickly view the output array in Excel without any commas I would recommend assigning the below macro to a button:</p>\n\n<pre><code>Sub OpenArrayFile()\n'To open array text file in Excel\n    Workbooks.OpenText Filename:=\"C:\\Users\\\" &amp; Environ$(\"username\") &amp; \"\\Desktop\\Array.txt\", Origin:= _\n        xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote _\n        , ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=True _\n        , Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n        TrailingMinusNumbers:=True\nEnd Sub\n</code></pre>\n\n<p>Hopefully this is useful to others too!</p>\n"}], "owner": {"reputation": 51, "user_id": 2802428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38786896903f7e470b8ec8d3ab95cbf?s=128&d=identicon&r=PG&f=1", "display_name": "j128", "link": "https://stackoverflow.com/users/2802428/j128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1456937383, "creation_date": 1456929892, "last_edit_date": 1456937243, "question_id": 35750416, "link": "https://stackoverflow.com/questions/35750416/vba-function-calls-vba-sub-to-print-array-to-worksheet", "title": "VBA function calls VBA sub to print array to worksheet", "body": "<p>Currently I have a user-defined function which runs several routines involving the generation of matrices. To check these matrices have been produced correctly I want to put them on a worksheet. The user defined function works fine and I have added the below into it at the place where I want to find out what is in the array:</p>\n\n<pre><code>Call CheckArray(TestArray)\n</code></pre>\n\n<p>Where 'TestArray' in the above varies depending on the array I want to look at.</p>\n\n<p>The 'CheckArray' subroutine is as follows:</p>\n\n<pre><code>Sub CheckArray(MyArray As Variant)\nMatrixRows = UBound(MyArray, 1)\nMatrixCols = UBound(MyArray, 2)\n\nMsgBox MyArray(11, 2)\nMsgBox \"Matrix size = \" &amp; MatrixRows &amp; \" rows x \" &amp; MatrixCols &amp; \" columns\"\n\nActiveWorkbook.Worksheets(\"Check array\").[A1].Resize(MatrixRows, MatrixCols) = MyArray\nEnd Sub\n</code></pre>\n\n<p>Note that I placed the two MsgBox commands in there to check the sub was called correctly and that it was working, which it is. Moreover, it returned the value in the specific location I requested and it also stated the size of the particular matrix I was looking at, so the data does seem to be getting read correctly - the issue is with subsequently writing that from the new sub.</p>\n\n<p>When I include that final line it does not print my array to the worksheet and it also stops the user-defined function from working correctly. Does anyone know why this isn't working?</p>\n\n<p>Can user-defined functions call subs which print to a worksheet or not? Is there a way to fix this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "edited": false, "score": 2, "creation_date": 1456930556, "post_id": 35750372, "comment_id": 59174515, "body": "I might misunderstand your question, but why don&#39;t you just put the copy code into the If statement?"}, {"owner": {"reputation": 11, "user_id": 6007642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f85ecce5cba16b0c4622ff56f938bc?s=128&d=identicon&r=PG&f=1", "display_name": "bomo123", "link": "https://stackoverflow.com/users/6007642/bomo123"}, "reply_to_user": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "edited": false, "score": 0, "creation_date": 1456932805, "post_id": 35750372, "comment_id": 59176315, "body": "Well, the primary goal of the code is to synchronize the pivot tables based on D1`s value, secondarily I would also like this copy paste to happen, but in such a way that does not interfere with the pivot operation..  When I try to put this together, the code doesnt execute because there are multiple ranges in there ( I suspect )."}], "answers": [{"tags": [], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "is_accepted": false, "score": 0, "last_activity_date": 1457002710, "creation_date": 1457002710, "answer_id": 35770301, "question_id": 35750372, "link": "https://stackoverflow.com/questions/35750372/vba-combining-worksheet-changes/35770301#35770301", "title": "VBA - Combining worksheet changes", "body": "<p>If I understand your question correctly, this should simply do the trick (but I'm really not sure if I fully understand your question):</p>\n\n<pre><code>If Target.Address = Range(\"D1\").Address Then\n\nFor Each ws In ThisWorkbook.Worksheets\n    For Each pt In ws.PivotTables\n        With pt.PageFields(strField)\n            For Each pi In .PivotItems\n                If pi.Value = Target.Value Then\n                    .CurrentPage = Target.Value\n                    Exit For\n                Else\n                    .CurrentPage = \"(All)\"\n                End If\n            Next pi\n        End With\n    Next pt\nNext ws\n\nRange(\"AC22:AC60\").Copy Range(\"AF22:AF60\")\nRange(\"AL22:Al60\").Copy Range(\"AN22:AN60\")\nRange(\"AU22:AU60\").Copy Range(\"AW22:AW60\")\n\nEnd If\n</code></pre>\n\n<p>If this is not what you need, do you mean this?</p>\n\n<pre><code>If Target.Address = Range(\"D1\").Address Then\n\nFor Each ws In ThisWorkbook.Worksheets\n    For Each pt In ws.PivotTables\n        With pt.PageFields(strField)\n            For Each pi In .PivotItems\n                If pi.Value = Target.Value Then\n                    .CurrentPage = Target.Value\n                    Range(\"AC22:AC60\").Copy Range(\"AF22:AF60\")\n                    Range(\"AL22:Al60\").Copy Range(\"AN22:AN60\")\n                    Range(\"AU22:AU60\").Copy Range(\"AW22:AW60\")\n                    Exit For\n                Else\n                    .CurrentPage = \"(All)\"\n                End If\n            Next pi\n        End With\n    Next pt\nNext ws\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6007642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f85ecce5cba16b0c4622ff56f938bc?s=128&d=identicon&r=PG&f=1", "display_name": "bomo123", "link": "https://stackoverflow.com/users/6007642/bomo123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457002710, "creation_date": 1456929763, "question_id": 35750372, "link": "https://stackoverflow.com/questions/35750372/vba-combining-worksheet-changes", "title": "VBA - Combining worksheet changes", "body": "<p>I`m an absolute VBA noob but given the shifting demands of my job, lately I had to verge into coding territory because we are trying to automate quite a lot of tasks. What I already have is this code below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim ws As Worksheet\nDim pt As PivotTable\nDim pi As PivotItem\nDim strField As String\n\nstrField = \"Manager\"\n\nOn Error Resume Next\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n\nIf Target.Address = Range(\"D1\").Address Then\n\n    For Each ws In ThisWorkbook.Worksheets\n        For Each pt In ws.PivotTables\n            With pt.PageFields(strField)\n                For Each pi In .PivotItems\n                    If pi.Value = Target.Value Then\n                        .CurrentPage = Target.Value\n                        Exit For\n                    Else\n                        .CurrentPage = \"(All)\"\n                    End If\n                Next pi\n            End With\n        Next pt\n    Next ws\n\nEnd If\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to combine this with the following code:</p>\n\n<pre><code>Range(\"AC22:AC60\").Copy Range(\"AF22:AF60\")\nRange(\"AL22:Al60\").Copy Range(\"AN22:AN60\")\nRange(\"AU22:AU60\").Copy Range(\"AW22:AW60\")\n</code></pre>\n\n<p>but I only want the ranges to copy if the D1 range in the first code changes. Obviously I want to automate and not to code the copies to a macro, so I please help me how to kill two birds with the one stone here.</p>\n\n<p>How do I combine this ?</p>\n\n<p>Much appreciated,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456929811, "post_id": 35750302, "comment_id": 59173897, "body": "How exactly are you calling them?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456930824, "post_id": 35750302, "comment_id": 59174743, "body": "Setting <b>Require Variable Declaration</b> within the VBE&#39;s Tools \u25ba Options \u25ba Editor property page will put the <b><a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow noreferrer\">Option  Explicit</a></b> statement at the top of each newly created code sheet. This  will avoid silly coding mistakes like misspellings as well as influencing you to use the correct variable type in the variable  declaration. Variables created on-the-fly without declaration are all of the variant/object type. Using <b>Option Explicit</b> is  widely considered &#39;best practice&#39;."}, {"owner": {"reputation": 93, "user_id": 6007565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0ed0963177ead947c667379646218b?s=128&d=identicon&r=PG&f=1", "display_name": "Linh", "link": "https://stackoverflow.com/users/6007565/linh"}, "edited": false, "score": 0, "creation_date": 1456933593, "post_id": 35750302, "comment_id": 59176947, "body": "Thanks for this advice."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1456930619, "creation_date": 1456930619, "answer_id": 35750709, "question_id": 35750302, "link": "https://stackoverflow.com/questions/35750302/simple-user-defined-functions-from-vba-dont-work-in-excel-2010/35750709#35750709", "title": "Simple User defined functions from VBA dont work in Excel 2010", "body": "<p>Your return lines are incorrect - the parentheses and arguments should not be included:</p>\n\n<pre><code>Function Excer1(x)\n    Application.Volatile\n    Excer1 = x ^ 2 - 3\nEnd Function\n\nFunction Excer2(x)\n    Application.Volatile\n    Excer2 = Sqr(2 * x ^ 2) + 2 * x\nEnd Function\n\nFunction Excer3a(x1, x2)\n    Excer3a = Log(x2 / x1)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1456930794, "creation_date": 1456930794, "answer_id": 35750793, "question_id": 35750302, "link": "https://stackoverflow.com/questions/35750302/simple-user-defined-functions-from-vba-dont-work-in-excel-2010/35750793#35750793", "title": "Simple User defined functions from VBA dont work in Excel 2010", "body": "<p>You were <strong>very</strong> close:</p>\n\n<pre><code>Function Excer1(x)\n    Application.Volatile\n    Excer1 = x ^ 2 - 3\nEnd Function\n'2)\n\nFunction Excer2(x)\n    Application.Volatile\n    Excer2 = Sqr(2 * x ^ 2) + 2 * x\nEnd Function\n'3)\n\nFunction Excer3a(x1, x2)\n    Excer3a = Log(x2 / x1)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 6007565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0ed0963177ead947c667379646218b?s=128&d=identicon&r=PG&f=1", "display_name": "Linh", "link": "https://stackoverflow.com/users/6007565/linh"}, "is_accepted": false, "score": 0, "last_activity_date": 1456932989, "creation_date": 1456932989, "answer_id": 35751639, "question_id": 35750302, "link": "https://stackoverflow.com/questions/35750302/simple-user-defined-functions-from-vba-dont-work-in-excel-2010/35751639#35751639", "title": "Simple User defined functions from VBA dont work in Excel 2010", "body": "<p>Solved. I should have not included the variable (in this case \"x\") when defining the functions:</p>\n\n<p>Corrected versions:</p>\n\n<pre><code>Function Excer1(x)\nApplication.Volatile\nExcer1 = x ^ 2 - 3\nEnd Function\n\nFunction Excer2(x)\nApplication.Volatile\nExcer2 = Sqr(2 * x ^ 2) + 2 * x\nEnd Function\n\nFunction Excer3a(x1, x2)\nExcer3a = Log(x2 / x1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6007565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0ed0963177ead947c667379646218b?s=128&d=identicon&r=PG&f=1", "display_name": "Linh", "link": "https://stackoverflow.com/users/6007565/linh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 35750709, "answer_count": 3, "score": 1, "last_activity_date": 1456932989, "creation_date": 1456929638, "last_edit_date": 1531164843, "question_id": 35750302, "link": "https://stackoverflow.com/questions/35750302/simple-user-defined-functions-from-vba-dont-work-in-excel-2010", "title": "Simple User defined functions from VBA dont work in Excel 2010", "body": "<p>I am trying to create some User Defined Functions but they all result in #Value! Error.</p>\n\n<p>My Macro has been enabled. I even added the Application.Volatile (as suggested on some posts). Nothing works. </p>\n\n<p>These are some of my statements, they all result in the same error. \n1)</p>\n\n<pre><code>Function Excer1(x)\n    Application.Volatile\n    Excer1(x) = x ^ 2 - 3\nEnd Function\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>Function Excer2(x)\n    Application.Volatile\n    Excer2(x) = Sqr(2 * x ^ 2) + 2 * x\nEnd Function\n</code></pre>\n\n<p>3) </p>\n\n<pre><code>Function Excer3a(x1, x2)\n    Excer3a(x1, x2) = Log(x2 / x1)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1456931150, "post_id": 35750613, "comment_id": 59175018, "body": "have you tried that? As TextBox1 does not contain a date, the date formatting will produce an overflow error"}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1456943251, "post_id": 35750613, "comment_id": 59183706, "body": "Thanks to all for your help and suggestions. I plan to test and try all of them to better understand how this works."}], "tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 0, "last_activity_date": 1456930390, "creation_date": 1456930390, "answer_id": 35750613, "question_id": 35750194, "link": "https://stackoverflow.com/questions/35750194/excel-vba-verify-specific-formatting-in-textbox/35750613#35750613", "title": "Excel VBA verify specific formatting in textbox", "body": "<p>Try :\nIf textbox1 = Format(TextBox1, \"mm.dd.yyyy.hh.mm.ss\") Then</p>\n"}, {"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1456932767, "creation_date": 1456932767, "answer_id": 35751533, "question_id": 35750194, "link": "https://stackoverflow.com/questions/35750194/excel-vba-verify-specific-formatting-in-textbox/35751533#35751533", "title": "Excel VBA verify specific formatting in textbox", "body": "<p><code>TextBox1</code> does not contain a date format, so you can't apply a <code>Format()</code> function using date/time format codes.</p>\n\n<p>One solution would be to split your string into array elements and examine them one by one, e.g.</p>\n\n<pre><code>Sub Test()\nDim A() As String, Rslt As Boolean\n\nA = Split(Me.TextBox1.Value, \".\") ' load dot seperated elements into array\n\nIf UBound(A) &lt;&gt; 5 Then\n    MsgBox \"not 6 numbers seperated by (5) dots\"\n    Rslt = False\n\nElseIf Val(A(0)) &lt; 1 Or Val(A(0)) &gt; 12 Then\n    MsgBox \"1st part not a valid month (01-12)\"\n    Rslt = False\n\nElseIf Val(A(1)) &lt; 1 Or Val(A(1)) &gt; 31 Then\n    MsgBox \"2nd part not a valid day (01-31)\"\n    Rslt = False\n\nElseIf Val(A(2)) &lt; 0 Or Val(A(1)) &gt; 99 Then\n    MsgBox \"3rd part not a valid year (00-99)\"\n    Rslt = False\n\nElseIf Val(A(3)) &lt; 0 Or Val(A(3)) &gt; 23 Then\n    MsgBox \"4th part not a valid hour (00-23)\"\n    Rslt = False\n\nElseIf Val(A(4)) &lt; 0 Or Val(A(4)) &gt; 59 Then\n    MsgBox \"5th part not a valid minute (00-59)\"\n    Rslt = False\n\nElseIf Val(A(5)) &lt; 0 Or Val(A(5)) &gt; 59 Then\n    MsgBox \"6th part not a valid second (00-59)\"\n    Rslt = False\nEnd If\n\nIf Not Rslt Then\n    'beat the user\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This doesn't consider months with 28/29/30/31 days, but that's only 1 or 2 if's further away.</p>\n"}, {"comments": [{"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1456933771, "post_id": 35751649, "comment_id": 59177086, "body": "just beware, in a TextBox you have no control whatsoever what the user enters; just one blank in the front can give a totally unexpected result to your <code>Mid()</code> functions and spoil your <code>DateSerial()</code> further down."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1456935862, "post_id": 35751649, "comment_id": 59178724, "body": "Hey @MikeD I will take you advice. Thanks."}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1456937345, "post_id": 35751649, "comment_id": 59179873, "body": "@ElbertVillarreal  Thanks for the code, I am trying it but cannot seem to call the function on textbox exit. I get an error &quot;Argument Not Optional&quot;"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1456941737, "post_id": 35751649, "comment_id": 59182761, "body": "Hey, check my (last) <b>Edit #4</b>."}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 1, "creation_date": 1456943195, "post_id": 35751649, "comment_id": 59183666, "body": "@ElbertVillarreal   Thanks very much for the detailed information and your time. I have this working and its exactly what I need."}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 0, "last_activity_date": 1456941691, "last_edit_date": 1456941691, "creation_date": 1456933012, "answer_id": 35751649, "question_id": 35750194, "link": "https://stackoverflow.com/questions/35750194/excel-vba-verify-specific-formatting-in-textbox/35751649#35751649", "title": "Excel VBA verify specific formatting in textbox", "body": "<p>You can use this simple function to check if is a date</p>\n\n<pre><code>Function checkFormatDate(str As String) As Boolean\n    Dim Y\n    Dim M\n    Dim D\n    Dim H\n    Dim I\n    Dim S\n    Dim theDate As Date\n\n    M = Mid(str, 1, 2)\n    D = Mid(str, 4, 2)\n    Y = Mid(str, 7, 4)\n    H = Mid(str, 12, 2)\n    I = Mid(str, 15, 2)\n    S = Mid(str, 18, 2)\n\n    theDate = DateSerial(Y, M, D) + TimeSerial(H, I, S)\n\n    If IsDate(theDate) Then\n        checkFormatDate = True\n    Else\n        checkFormatDate = False\n    End If\nEnd Function\n</code></pre>\n\n<p>This returns <code>TRUE</code> (if is a date) or <code>FALSE</code> (if not)</p>\n\n<p>Just care about the dates like: <code>02.05.2016.01.10.05</code> (where <code>mm.dd.yyyy.hh.mm.ss</code>), because, you need to trust that <code>02</code> is the month and not the day, as <code>05</code> is the day and not the month, always appears somebody with a great idea, and change the values just because.</p>\n\n<p><strong>Edit #2</strong></p>\n\n<p>Heres a better version of the code: </p>\n\n<p>Tester:</p>\n\n<pre><code>Sub testDate()\nDim Check As Boolean\n    Check = checkFormatDate2(UserForm1.TextBox1.Text)\n    'the textbox is inside UserForm1\n    If Check Then\n        MsgBox \"Is a Date\"\n    Else\n        MsgBox \"Not a Date\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Function: </p>\n\n<pre><code>Function checkFormatDate2(str As String) As Boolean\n    Dim ArrayD\n    Dim i\n    Dim m\n    ArrayD = Split(str, \".\")\n\n    If UBound(ArrayD) &lt;&gt; 5 Then\n        checkFormatDate2 = False\n        Exit Function\n    End If\n\n    For i = 0 To 5\n        Select Case i\n            Case 0\n                If CInt(ArrayD(i)) &lt; 1 Or CInt(ArrayD(i)) &gt; 12 Then\n                    checkFormatDate2 = False\n                    Exit Function\n                End If\n            Case 1\n                If CInt(ArrayD(i + 1)) &lt; 1900 Or CInt(ArrayD(i + 1)) &gt; 2050 Then\n                    'set the botton and limit year as you need\n                    checkFormatDate2 = False\n                    Exit Function\n                End If\n            Case 2\n                 m = Day(DateSerial(CInt(ArrayD(2)), CInt(ArrayD(0)) + 1, 1) - 1)\n                 'm = the last (num) day of the month\n                If CInt(ArrayD(i - 1)) &lt; 1 Or CInt(ArrayD(i - 1)) &gt; m Then\n                    checkFormatDate2 = False\n                    Exit Function\n                End If\n            Case 3\n                If CInt(ArrayD(i)) &lt; 1 Or CInt(ArrayD(i)) &gt; 23 Then\n                    checkFormatDate2 = False\n                    Exit Function\n                End If\n            Case 4\n                If CInt(ArrayD(i)) &lt; 1 Or CInt(ArrayD(i)) &gt; 59 Then\n                    checkFormatDate2 = False\n                    Exit Function\n                End If\n            Case 5\n                If CInt(ArrayD(i)) &lt; 1 Or CInt(ArrayD(i)) &gt; 59 Then\n                    checkFormatDate2 = False\n                    Exit Function\n                End If\n            Case Else\n        End Select\n    Next i\n    checkFormatDate2 = True\nEnd Function\n</code></pre>\n\n<p>Use this function to validate if the text inside the TextBox is a date sending the <code>TextBox.Value</code> or <code>TextBox.Text</code>. Thanks MikeD for your advice. This way is better. </p>\n\n<p><strong>Edit #3</strong></p>\n\n<p>As you tell me in the comments you could use the <code>AfterUpdate</code> on the <code>Textbox</code>, like this: </p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\n    Dim a As Boolean\n    a = checkFormatDate2(Me.TextBox1.Value)\n    If a Then\n        MsgBox \"is date\"\n    Else\n        MsgBox \"no date\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Where the <code>UserForm1</code> has a <code>TextBox</code> named <code>TextBox1</code> inside, and the function <code>checkFormatDate2</code> is in a regular module. In my case I just send a <code>MsgBox</code> saying that is not a date. </p>\n\n<p><strong>Edit #4</strong></p>\n\n<p>The same way you can validate the text inside the TextBox when Exit the UserForm this way: </p>\n\n<p>1) Add a button and set the <code>Cancel</code> Property to <code>TRUE</code>: </p>\n\n<p><a href=\"https://i.stack.imgur.com/26asp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/26asp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>2)And inside the code you put this: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim a As Boolean\n    a = checkFormatDate2(Me.TextBox1.Value)\n    If a Then\n        MsgBox \"is date\"\n    Else\n        MsgBox \"no date\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>This way, when you press <code>ESC</code> in the keyboard or press the button <code>CommandButton1</code> you try to close the UserForm and fire the code inside, and test the text inside the <code>TextBox</code> and you could do whatever you want, as, don't let the user go away, go back to the TextBox after a message saying what is the right format, well whatever you want. </p>\n"}], "owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1469, "favorite_count": 0, "accepted_answer_id": 35751649, "answer_count": 3, "score": 0, "last_activity_date": 1456941691, "creation_date": 1456929397, "question_id": 35750194, "link": "https://stackoverflow.com/questions/35750194/excel-vba-verify-specific-formatting-in-textbox", "title": "Excel VBA verify specific formatting in textbox", "body": "<p>How can I verify a specific format in a textbox? I am scanning a label into a textbox that contains a date which is formatted like:</p>\n\n<pre><code>mm.dd.yyyy.hh.mm.ss\n</code></pre>\n\n<p>I have tried things that do not work...</p>\n\n<pre><code>If Not Format(TextBox1, \"mm.dd.yyyy.hh.mm.ss\") Then\nMsgBox \"Wrong Format\"\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456929929, "post_id": 35750117, "comment_id": 59174006, "body": "Generally you&#39;d get that error if the series name doesn&#39;t match."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930012, "post_id": 35750117, "comment_id": 59174072, "body": "Thanks but it definitely does, in debugging I got the exact names with cChart.ChartGroups(1).SeriesCollection(1).name etc"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930266, "post_id": 35750117, "comment_id": 59174271, "body": "So testing something like <code>aRootCats(x) = cChart.ChartGroups(1).SeriesCollection(1).name</code> returns True?"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930409, "post_id": 35750117, "comment_id": 59174392, "body": "Yes, I get a true / false as appropriate. I&#39;m thinking of doing this with another loop inside the first, this time on the series collection - is that your thought too?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930523, "post_id": 35750117, "comment_id": 59174489, "body": "Not really, since I can&#39;t replicate your error other than when the series name is incorrect. Can you put a file somewhere (OneDrive / Dropbox etc) showing the problem? If it&#39;s a bug, I&#39;ll report it. Which version of Excel are you using?"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456930691, "post_id": 35750117, "comment_id": 59174618, "body": "Thanks Rory but I can&#39;t, it&#39;s commercially sensitive. Stumped...I tried the loop and got the same error:          For c = 1 To cChart.ChartGroups(1).SeriesCollection.Count         If aRootCats(x) = cChart.ChartGroups(1).SeriesCollection(c).Name Then             Set cSeriesCol = cChart.ChartGroups(1).SeriesCollection(c)             cSeriesCol.PlotOrder = x + 1         End If     Next c"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456931707, "post_id": 35750117, "comment_id": 59175472, "body": "Ah - I didn&#39;t see that you were using a ChartGroup not a Chart. Use: <code>cChart.ChartGroups(1).SeriesCollection.Item(sSeriesName)</code> instead."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456932251, "post_id": 35750117, "comment_id": 59175890, "body": "Thank you - I get a type mismatch using sSeriesname but works OK using an index number so the inner loop idea will now work. Still puzzled as to why a string doesn&#39;t work but please post an answer if you&#39;d like"}], "answers": [{"comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1456933799, "post_id": 35751621, "comment_id": 59177109, "body": "Yes, declaring as variant works. Thanks for all your help."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1456932963, "creation_date": 1456932963, "answer_id": 35751621, "question_id": 35750117, "link": "https://stackoverflow.com/questions/35750117/excel-vba-refer-to-chart-seriescollection-by-string-name/35751621#35751621", "title": "Excel VBA refer to chart seriescollection by string name", "body": "<p>Because you are using a ChartGroup not a Chart, you have to use the <code>Item</code> property of the <code>SeriesCollection</code> and you have to pass a variant. Use either:</p>\n\n<pre><code>cChart.ChartGroups(1).SeriesCollection.Item(1)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>cChart.ChartGroups(1).SeriesCollection.Item(CVar(sSeriesName))\n</code></pre>\n\n<p>(or declare the variable as Variant rather than String)</p>\n"}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2005, "favorite_count": 0, "accepted_answer_id": 35751621, "answer_count": 1, "score": 0, "last_activity_date": 1456932963, "creation_date": 1456929191, "last_edit_date": 1456931561, "question_id": 35750117, "link": "https://stackoverflow.com/questions/35750117/excel-vba-refer-to-chart-seriescollection-by-string-name", "title": "Excel VBA refer to chart seriescollection by string name", "body": "<p>I have a need to refer to a seriescollection by name. The MSDN object model page for seriescollection states either an index or a name can be used. However when I try to use a string variable I get error 1004 'Invalid parameter':</p>\n\n<pre><code>Dim sSeriesName As String\ndim aRootCats() as string\nDim cSeriesCol As SeriesCollection\n\nFor x = 0 To UBound(aRootCats)\n    sSeriesName = aRootCats(x)\n    Set cSeriesCol = cChart.ChartGroups(1).SeriesCollection(sSeriesName)\nNext x\n</code></pre>\n\n<p>I've tried the following too:</p>\n\n<pre><code>    sSeriesName = CStr(aRootCats(x)) ' just in case, because I filled this array with variant data type earlier\n    Set cSeriesCol = cChart.ChartGroups(1).SeriesCollection(sSeriesName)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    Set cSeriesCol = cChart.ChartGroups(1).SeriesCollection(aRootCats(x))\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    Set cSeriesCol = cChart.ChartGroups(1).SeriesCollection(\"Product Support\")\n</code></pre>\n\n<p>UPDATE: I'm also experiencing the same error when looping on the seriescollection:</p>\n\n<pre><code>For c = 1 To cChart.ChartGroups(1).SeriesCollection.Count\n    Set cSeriesCol = cChart.ChartGroups(1).SeriesCollection(c)\nNext c\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "edited": false, "score": 0, "creation_date": 1456929575, "post_id": 35750087, "comment_id": 59173680, "body": "Thanks, I now have the data in another table in Access, I suppose that&#39;s half the battle!  So, now I just write an update query using Access, if this was SQL I could do that in a few seconds, now I need to find out how similar to SQL Access is."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "edited": false, "score": 1, "creation_date": 1456929775, "post_id": 35750087, "comment_id": 59173867, "body": "If you know SQL, you can create a query in Access, switch to SQL View and just write your UPDATE. However I would suggest you try the graphical interface (Design View). It&#39;s very easy and you will avoid the specific syntax  Access SQL may have here and there.."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 2, "last_activity_date": 1456929130, "creation_date": 1456929130, "answer_id": 35750087, "question_id": 35749974, "link": "https://stackoverflow.com/questions/35749974/update-access-database-using-excel-best-approach/35750087#35750087", "title": "Update Access Database using Excel - best approach", "body": "<p>If your spreadsheet is \"clean\" and structured, I would find it easier to link your spreadsheet into your Access database. You can then update your Access data with a simple update query, since the list in your spreadsheet will appear like any attached table in Access.<br>\nBy \"clean\", I mean:<br>\n - consistent data types within a given column,<br>\n - no blank row between the titles and the data<br>\n - a single line of title  </p>\n"}], "owner": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "accepted_answer_id": 35750087, "answer_count": 1, "score": 0, "last_activity_date": 1456929130, "creation_date": 1456928883, "question_id": 35749974, "link": "https://stackoverflow.com/questions/35749974/update-access-database-using-excel-best-approach", "title": "Update Access Database using Excel - best approach", "body": "<p>I have an Access Database and an Excel spreadsheet with a few hundred lines of data to update into the DB.  Some of the fields in the Access database are not in the Excel spreadsheet.</p>\n\n<p>Is it best to write an Excel VBA script to update the Access DB or is there a better approach?</p>\n\n<p>I am not very familiar with Access and my VBA skills are rusty so any examples are appreciated.</p>\n\n<p>Some sample data, this is from the Excel:</p>\n\n<pre><code>    MN      File Identifier\n587034901   PN000352\n3248029409  PN000352\n3066978806  PN000456\n574565507   PN000477\n</code></pre>\n\n<p>MN would be the \"unique key\" in Access (I'm used to SQL).</p>\n\n<p>These will be updates and not inserts.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 417219, "user_id": 187606, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/zzxoB.jpg?s=128&g=1", "display_name": "Pekka", "link": "https://stackoverflow.com/users/187606/pekka"}, "edited": false, "score": 0, "creation_date": 1456927497, "post_id": 35749406, "comment_id": 59171964, "body": "Can you clarify what your question is? What doesn&#39;t work?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 417219, "user_id": 187606, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/zzxoB.jpg?s=128&g=1", "display_name": "Pekka", "link": "https://stackoverflow.com/users/187606/pekka"}, "edited": false, "score": 0, "creation_date": 1456928785, "post_id": 35749406, "comment_id": 59173053, "body": "UBound expects array"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 2, "last_activity_date": 1456955084, "creation_date": 1456955084, "answer_id": 35758706, "question_id": 35749406, "link": "https://stackoverflow.com/questions/35749406/modify-the-current-email-body-outlook/35758706#35758706", "title": "Modify the current email body outlook", "body": "<p>It looks like you are trying to use an array when not needed.</p>\n\n<p>Replace works on multiple instances of the same word.</p>\n\n<pre><code>Option Explicit\n\nSub Custmod()\n\nDim olItem As mailItem\n\nSet olItem = CreateItem(olMailItem)\nolItem.body = \"TEXT1\" &amp; Chr(13) &amp; \"Here is some stuff.\" &amp; Chr(13) &amp; \"TEXT1 again.\"\nolItem.Display\nMsgBox olItem.body\n\nolItem.body = Replace(olItem.body, \"TEXT1\", \"TEXT2\")\nMsgBox olItem.body\n\nSet olItem = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2277, "favorite_count": 0, "accepted_answer_id": 35758706, "answer_count": 1, "score": 0, "last_activity_date": 1592693749, "creation_date": 1456927434, "last_edit_date": 1592693749, "question_id": 35749406, "link": "https://stackoverflow.com/questions/35749406/modify-the-current-email-body-outlook", "title": "Modify the current email body outlook", "body": "<p>I want to replace in the active email the \"text1\" with \"text2\" . Here is my code:</p>\n\n<pre><code>Sub Custmod()\nDim olItem As Outlook.MailItem\nDim objOL As Outlook.Application\nDim olOutMail As Outlook.MailItem\nDim sText As String\nDim vText As String\nDim strBody As String\nSet objOL = Application\nSet objItem = objOL.ActiveInspector.CurrentItem\nFor Each olItem In Application.ActiveExplorer.Selection\n    sText = olItem.body\n    vText = Split(sText, Chr(13))\n    For i = 1 To UBound(vText)\n        If InStr(1, vText(i), \"TEXT1\") Then\n            olItem.body = Replace(vText(i), \"TEXT2\", \"\")\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Any help is welcomed. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1456926771, "post_id": 35748919, "comment_id": 59171352, "body": "I don&#39;t understand what you need to count..."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1456926993, "post_id": 35748919, "comment_id": 59171537, "body": "problem is clear, what is not shown or clear is the <b>coding efforts</b> you have made to solve this. please show your attempts and where it&#39;s failing, otherwise, your question will most likely be closed, or at least downvoted and ignored."}], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1456930029, "last_edit_date": 1456930029, "creation_date": 1456927153, "answer_id": 35749291, "question_id": 35748919, "link": "https://stackoverflow.com/questions/35748919/using-the-count-funtion-in-vba/35749291#35749291", "title": "using the count funtion in vba", "body": "<p>You could issue an SQL statement on the cells using an ADO Recordset. The SQL statement would group by a formula that returns the appropriate color per row, and also would also return the count per grouping. Finally, you can use CopyFromRecordset to paste the results into a new worksheet.</p>\n\n<p>Alternatively, you could read the cells into an array, and process the contents of the array line by line. Declare three Integer variables, one for each color, and increment the value of the appropriate variable based on the right value of the line. Then you could write the values of these variables into a new or existing worksheet.</p>\n"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456930029, "creation_date": 1456926145, "last_edit_date": 1456927257, "question_id": 35748919, "link": "https://stackoverflow.com/questions/35748919/using-the-count-funtion-in-vba", "title": "using the count funtion in vba", "body": "<p>I have a formula I know works in excel:</p>\n\n<p><code>=IF(COUNTIF(P11:R11,\"=Red\")&gt;0,\"Red\",IF(COUNTIF(P11:R11,\"=Amber\")&gt;0,\"Amber\",\"Green\"))</code></p>\n\n<p>I need to use this somehow in VBA within a large script I am writing to manipulate a lot of data.  I have three columns and in each column is the traffic light's colors ('Green, Amber, Red'). I need to count how many greens, ambers and red etc, but within each row if I have for example green, amber, green then the cover all would be amber and this is what I am counting. I need to count the overall status of the three.</p>\n\n<p>The data would look something like this: -</p>\n\n<pre><code>Green       Green   Green\nGreen       Amber   Green\nAmber       Red     Red\nRed         Green   Green\n</code></pre>\n\n<p>This would be Green = 1, amber = 1, red = 2</p>\n\n<p>I then need to input these values in to another Worksheet within the same Workbook. Hope all that made sense and I explained the problem properly.</p>\n"}, {"tags": ["vba", "excel", "printing"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1456927832, "post_id": 35748612, "comment_id": 59172225, "body": "Can you provide the code you are currently using?"}, {"owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1456992992, "post_id": 35748612, "comment_id": 59205154, "body": "I aded the code ... the only thing that is actually important is that margins are set to 0 and that top margin is 0.767... tho i was thinking to increase that margin and it should fix my problem as on my PC it  prints label normally but on another the text is too high by just a bit and sometimes it prints an empty label (it thinks its too high and need 2 labels to print the full text ? ) oh and this is old code so the loop is a bit weird :)"}], "owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 621, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456992822, "creation_date": 1456925397, "last_edit_date": 1531164843, "question_id": 35748612, "link": "https://stackoverflow.com/questions/35748612/excel-printing-with-vba", "title": "Excel printing with VBA", "body": "<p>I have written a macro to print out some labels from data in Excel. I have fine tuned the settings to make the printer for the information on the label and it works fine, but when I use the same macro on another computer in the network using same printer, it gets a bit screwy... My prediction is that there are different defaults on different PC's. Is there a way to make them the same or maybe reset the printing defaults before my code for fine tuning kicks in? </p>\n\n<p>Edit:\nCode:</p>\n\n<pre><code>With ActiveSheet.PageSetup\n    .LeftHeader = \"\"\n    .CenterHeader = \"\"\n    .RightHeader = \"\"\n    .LeftFooter = \"\"\n    .CenterFooter = \"\"\n    .RightFooter = \"\"\n    .LeftMargin = Application.InchesToPoints(0)\n    .RightMargin = Application.InchesToPoints(0)\n    .TopMargin = Application.InchesToPoints(0.767716535433071)\n    .BottomMargin = Application.InchesToPoints(0)\n    .HeaderMargin = Application.InchesToPoints(0)\n    .FooterMargin = Application.InchesToPoints(0)\n    .PrintHeadings = False\n    .PrintGridlines = False\n    .PrintComments = xlPrintNoComments\n    .CenterHorizontally = True\n    .CenterVertically = True\n    .Orientation = xlPortrait\n    .Draft = False\n    .FirstPageNumber = xlAutomatic\n    .Order = xlDownThenOver\n    .BlackAndWhite = False\n    .Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = 1\n    .PrintErrors = xlPrintErrorsDisplayed\n    .OddAndEvenPagesHeaderFooter = False\n    .DifferentFirstPageHeaderFooter = False\n    .ScaleWithDocHeaderFooter = True\n    .AlignMarginsHeaderFooter = True\n    .EvenPage.LeftHeader.Text = \"\"\n    .EvenPage.CenterHeader.Text = \"\"\n    .EvenPage.RightHeader.Text = \"\"\n    .EvenPage.LeftFooter.Text = \"\"\n    .EvenPage.CenterFooter.Text = \"\"\n    .EvenPage.RightFooter.Text = \"\"\n    .FirstPage.LeftHeader.Text = \"\"\n    .FirstPage.CenterHeader.Text = \"\"\n    .FirstPage.RightHeader.Text = \"\"\n    .FirstPage.LeftFooter.Text = \"\"\n    .FirstPage.CenterFooter.Text = \"\"\n    .FirstPage.RightFooter.Text = \"\"\nEnd With\n\nDim rngPrint As Range\n\nDo While (delaj)\n    If IsEmpty(Cells(i, \"B\")) Then\n        delaj = False\n        Exit Do\n    End If\n\n    If Cells(i + 5, \"D\") = True Then\n        Range(Cells(i, \"B\"), Cells(i + 6, \"C\")).PrintOut\n    End If\n    i = i + 9\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 374, "user_id": 5835892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1328f9a0bdfa61be3924f841f46dd0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Milan Tome\u0161", "link": "https://stackoverflow.com/users/5835892/milan-tome%c5%a1"}, "is_accepted": true, "score": 3, "last_activity_date": 1456923669, "creation_date": 1456923669, "answer_id": 35747973, "question_id": 35747826, "link": "https://stackoverflow.com/questions/35747826/call-reg-file-from-excel-vba-script/35747973#35747973", "title": "Call .reg File from Excel-VBA script", "body": "<p>Instead of running <code>cmd</code> try to run <code>reg</code>. So in your case it should be <code>x = Shell(\"reg import C:\\TEMP\\DisableHyperlinkWarnings.reg\")</code></p>\n\n<p>More info <a href=\"https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/reg.mspx?mfr=true\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 544, "user_id": 3883370, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8e67d4f3388dd04db0928a467a4f9112?s=128&d=identicon&r=PG&f=1", "display_name": "Officer Bacon", "link": "https://stackoverflow.com/users/3883370/officer-bacon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 35747973, "answer_count": 1, "score": 3, "last_activity_date": 1456923669, "creation_date": 1456923267, "question_id": 35747826, "link": "https://stackoverflow.com/questions/35747826/call-reg-file-from-excel-vba-script", "title": "Call .reg File from Excel-VBA script", "body": "<p>I want to call a .reg File out of my VBA script. I'm using Office/Excel 2013. \nI know Excel can't run these files by itself, so i need to call the file via shell. The code i wrote doesn't work:</p>\n\n<pre><code>Sub deactivateHyperlinkWarnings()\n    Dim x\n    x = Shell(\"cmd /C C:\\TEMP\\DisableHyperlinkWarnings.reg\")\nEnd Sub\n</code></pre>\n\n<p>I found this piece of code somewhere on the web, but its not working. I don't even get an error message. The .reg File is located in C:\\TEMP</p>\n\n<p>What do i need to write to make it work?</p>\n\n<p><strong>Plus:</strong> Is it possible to suppress the MessageBoxes that are displayed when i run the .reg-File? When i start the file manually, i need to Hit \"OK\" like 3 Times. The people who are working with the Excelsheet later on shouldn't be seeing these things. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1456921414, "post_id": 35746905, "comment_id": 59167508, "body": "use <code>WorksheetFunction.Ceiling()</code>"}, {"owner": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "reply_to_user": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1456922995, "post_id": 35746905, "comment_id": 59168604, "body": "But that&#39;s a worksheetfunction as well - then I might as well just use Roundup. That said, having looked up Ceiling, I think it might be useful for another thing I&#39;ve been working on - thanks!"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 1, "creation_date": 1456923742, "post_id": 35746905, "comment_id": 59169101, "body": "<code>Ceiling</code> is a bit extended variant of <code>roundup</code>, you can specify the rounding step, that is why I have proposed it."}], "answers": [{"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": true, "score": 17, "last_activity_date": 1456921831, "last_edit_date": 1456921831, "creation_date": 1456921495, "answer_id": 35747190, "question_id": 35746905, "link": "https://stackoverflow.com/questions/35746905/rounding-up-to-nearest-higher-integer-in-vba/35747190#35747190", "title": "Rounding up to nearest higher integer in VBA", "body": "<p>I don't see any reason to avoid <code>WorksheetFunction</code>; I don't see any confusion here.</p>\n\n<pre><code>Number_of_layers = WorksheetFunction.RoundUp(iQty / iLayerQty, 0)\n</code></pre>\n\n<p>You could also roll your own function:</p>\n\n<pre><code>Function RoundUp(ByVal Value As Double)\n    If Int(Value) = Value Then\n        RoundUp = Value\n    Else\n        RoundUp = Int(Value) + 1\n    End If\nEnd Function\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>Number_of_layers = RoundUp(iQty / iLayerQty)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 7, "last_activity_date": 1456921996, "creation_date": 1456921996, "answer_id": 35747379, "question_id": 35746905, "link": "https://stackoverflow.com/questions/35746905/rounding-up-to-nearest-higher-integer-in-vba/35747379#35747379", "title": "Rounding up to nearest higher integer in VBA", "body": "<p>If using a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\">WorksheetFunction object</a> to access a <a href=\"https://support.office.com/en-us/article/ROUNDUP-function-F8BC9B23-E795-47DB-8703-DB171D0C42A7\">ROUNDUP</a> or <a href=\"https://support.office.com/en-us/article/CEILING-function-0A5CD7C8-0720-4F0A-BD2C-C943E510899F\">CEILING</a> function is off the table then the same can be accomplished with some maths.</p>\n\n<pre><code>Number of layers = Int(iQty / iLayerQty) - CBool(Int(iQty / iLayerQty) &lt;&gt; Round(iQty / iLayerQty, 14))\n</code></pre>\n\n<p>A VBA <strong>True</strong> is the equivalent of (-1) when used mathematically. The VBA Round is there to avoid 15 digit floating point errors.</p>\n"}, {"tags": [], "owner": {"reputation": 2193, "user_id": 1955013, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d92caebbbc79430505819dbd1db8e36f?s=128&d=identicon&r=PG", "display_name": "Marc Meketon", "link": "https://stackoverflow.com/users/1955013/marc-meketon"}, "is_accepted": false, "score": 2, "last_activity_date": 1597158177, "creation_date": 1597158177, "answer_id": 63360981, "question_id": 35746905, "link": "https://stackoverflow.com/questions/35746905/rounding-up-to-nearest-higher-integer-in-vba/63360981#63360981", "title": "Rounding up to nearest higher integer in VBA", "body": "<p>I use <code>-int(-x)</code> to get the ceiling.</p>\n<pre><code>?-int(-1.1)  ' get ceil(1.1)\n2\n\n?-int(1.1)   ' get ceil(-1.1)\n-1\n\n?-int(-5)    ' get ceil(5)\n5\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24688, "favorite_count": 1, "accepted_answer_id": 35747190, "answer_count": 3, "score": 10, "last_activity_date": 1597158177, "creation_date": 1456920746, "question_id": 35746905, "link": "https://stackoverflow.com/questions/35746905/rounding-up-to-nearest-higher-integer-in-vba", "title": "Rounding up to nearest higher integer in VBA", "body": "<p>I'm trying to calculate how many layers a commodity will be stacked in. I have a variable quantity (<code>iQty</code>), a given width for the loadbed (<code>dRTW</code>), a width per unit for the commodity (<code>dWidth</code>) and a quantity per layer (<code>iLayerQty</code>).</p>\n\n<p>The quantity per layer is calculated as <code>iLayerQty = Int(dRTW/dWidth)</code></p>\n\n<p>Now I need to divide the total quantity by the quantity per layer and round up. In an Excel formula it would be easy, but I'm trying to avoid WorksheetFunction calls to minimise A1/R1C1 confusion. At the moment I'm approximating it with this:</p>\n\n<pre><code>(Number of layers) = ((Int(iQty / iLayerQty) + 1)\n</code></pre>\n\n<p>And that works fine <em>most</em> of the time - except when the numbers give an integer (a cargo width of 0.5 m, for instance, fitting onto a 2.5 m rolltrailer). In those instances, of course, adding the one ruins the result.</p>\n\n<p>Is there any handy way of tweaking that formula to get a better upward rounding?</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456922204, "post_id": 35746925, "comment_id": 59168041, "body": "@Iturner I did try that, but got the same results - Nothing.  the cells stayed blanks.  this is what I had originally                                    LastRow = Cells(Rows.Count, 2).End(xlUp).Row                                With Range(&quot;AS22:AU&quot; &amp; LastRow)             .Replace what:=&quot;&quot;, Replacement:=&quot;On Track&quot; End With"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456922797, "post_id": 35746925, "comment_id": 59168455, "body": "Are there formulas within the cells which are causing the cells to show as blank? Have you debugged to ensure that the <code>LastRow</code> variable is returning the expected integer?"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456923346, "post_id": 35746925, "comment_id": 59168840, "body": "@Iturner I will just run LastRow and check that it is returning a value"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456924032, "post_id": 35746925, "comment_id": 59169314, "body": "@Iturner Thanks I checked this and wasn&#39;t getting the correct cell number, I changed the column I was running LastRow on and I now get the results I wanted. - Thanks"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 3, "last_activity_date": 1456920807, "creation_date": 1456920807, "answer_id": 35746925, "question_id": 35746759, "link": "https://stackoverflow.com/questions/35746759/replace-blank-empty-cell-with-a-string-value/35746925#35746925", "title": "Replace Blank/empty cell with a string value", "body": "<p>You could just use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194086.aspx\" rel=\"nofollow\"><code>.Replace</code> Method</a> with the range. It would be much quicker.</p>\n\n<pre><code>Range(\"AS22:AU\" &amp; LastRow).Replace \"\", \"Greens\", xlWhole\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 0, "last_activity_date": 1456920839, "creation_date": 1456920839, "answer_id": 35746938, "question_id": 35746759, "link": "https://stackoverflow.com/questions/35746759/replace-blank-empty-cell-with-a-string-value/35746938#35746938", "title": "Replace Blank/empty cell with a string value", "body": "<p>Use <code>IsEmpty()</code> to test for blanks. </p>\n\n<pre><code>    If IsEmpty(r.Value2) Or Trim(r.Value2) = \"\" Then\n        r.Value2 = \"Greens\"\n    End If\n</code></pre>\n\n<p>Also watch out for cells with a zero length string or a space. They appear empty but in fact are not.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456922393, "post_id": 35747041, "comment_id": 59168170, "body": "this does not work either, the cells stay blank - Any clues as to what this is"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456922964, "post_id": 35747041, "comment_id": 59168581, "body": "@user3088476  I suspect the <b>2</b> in the equation for <code>LastRow</code> ............are you sure you want column <b>B</b> to control the end of the loop ??"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456923304, "post_id": 35747041, "comment_id": 59168815, "body": "The column B is a column I know I will contain a value in the last row, the column AS - AU which I am copying in may not contain a value within the last row, this is why I am searching on column B."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456924466, "post_id": 35747041, "comment_id": 59169598, "body": "@user3088476  Perhaps the cells in <code>AS:AU</code> only <b>appear</b> empty.................. perhaps they contain a <b>single space</b> ??"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1456925643, "post_id": 35747041, "comment_id": 59170471, "body": "@ Gary&#39;s I have it working now - thanks for you help and input"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1456922115, "last_edit_date": 1456922115, "creation_date": 1456921091, "answer_id": 35747041, "question_id": 35746759, "link": "https://stackoverflow.com/questions/35746759/replace-blank-empty-cell-with-a-string-value/35747041#35747041", "title": "Replace Blank/empty cell with a string value", "body": "<p>How about:</p>\n\n<pre><code>Sub dural()\n    Dim r As Range, LastRow As Long\n\n    LastRow = Cells(Rows.Count, 2).End(xlUp).Row\n    For Each r In Range(\"AS22:AU\" &amp; LastRow)\n        If r.Text = \"\" Then r.Value = \"Greens\"\n    Next r\nEnd Sub\n</code></pre>\n\n<p>This will change:</p>\n\n<ul>\n<li>truly empty cells</li>\n<li>cells containing formulas returning <em>Null</em></li>\n<li>cells containing <em>Null</em> character as a constant</li>\n</ul>\n"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11117, "favorite_count": 1, "accepted_answer_id": 35746925, "answer_count": 3, "score": 5, "last_activity_date": 1456922115, "creation_date": 1456920363, "last_edit_date": 1456920891, "question_id": 35746759, "link": "https://stackoverflow.com/questions/35746759/replace-blank-empty-cell-with-a-string-value", "title": "Replace Blank/empty cell with a string value", "body": "<p>Hope someone can help.  I need to populate any blank/empty cells within a range of cells with a specific string.  I also don't know that the last row would be in that range so I am looking for that first, I know that line of code works as I have used it for another function within the script.  Below is the code I am using: -</p>\n\n<pre><code>    LastRow = Cells(Rows.Count, 2).End(xlUp).Row\n\n    For Each r In Range(\"AS22:AU\" &amp; LastRow)\n        If r.Value2 = vbNullString Then\n            r.Value2 = \"Greens\"\n        End If\n    Next\n</code></pre>\n\n<p>I don't seem to get any compile errors when I run the code, it just does not work, I still have the same blank/empty cells.  </p>\n\n<p>Can anyone shed any light onto what I am doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456925505, "post_id": 35746445, "comment_id": 59170370, "body": "Did you browse to the dll from the references dialog? Note: if you have 64 bit Office, you can&#39;t use it."}, {"owner": {"reputation": 4630, "user_id": 347904, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b00b80efa99573461285c13d30b0663b?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/347904/jakob"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456925762, "post_id": 35746445, "comment_id": 59170573, "body": "yeah, I attempted to remove it or change the path via download,but that didn&#39;t do anything."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456926467, "post_id": 35746445, "comment_id": 59171122, "body": "Have you tried deleting whichever OWC control(s) are in the workbook, then changing the reference, and adding the controls back?"}, {"owner": {"reputation": 4630, "user_id": 347904, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b00b80efa99573461285c13d30b0663b?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/347904/jakob"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456927254, "post_id": 35746445, "comment_id": 59171755, "body": "thanks for your reply Rory - I really appreciate it - I&#39;m sorry for asking this, but how do I identify the OWC controls, it&#39;s a project that I&#39;ve taken over from a colleague, so I have no idea how it&#39;s put together :)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456927759, "post_id": 35746445, "comment_id": 59172171, "body": "You&#39;d be looking for Spreadsheet, Chart, Pivot Table and Data Control objects on one or more userforms."}, {"owner": {"reputation": 4630, "user_id": 347904, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b00b80efa99573461285c13d30b0663b?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/347904/jakob"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456929561, "post_id": 35746445, "comment_id": 59173664, "body": "I&#39;m afraid it&#39;s more than userforms. It breaks in the code of the modules also, since there are explicit OWC11. object references"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456929767, "post_id": 35746445, "comment_id": 59173858, "body": "But removing the objects on the userforms should allow you to uncheck the reference and then reset it to your downloaded dll."}, {"owner": {"reputation": 4630, "user_id": 347904, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b00b80efa99573461285c13d30b0663b?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/347904/jakob"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1456932037, "post_id": 35746445, "comment_id": 59175720, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/105155/discussion-between-jakob-and-rory\">continue this discussion in chat</a>."}], "owner": {"reputation": 4630, "user_id": 347904, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b00b80efa99573461285c13d30b0663b?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/347904/jakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3110, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1456920823, "creation_date": 1456919528, "last_edit_date": 1531164843, "question_id": 35746445, "link": "https://stackoverflow.com/questions/35746445/missing-reference-to-microsoft-office-web-components-11", "title": "Missing reference to Microsoft Office Web Components 11", "body": "<p>Hey I have an old vba project that I'm trying to bring up to speed.</p>\n\n<p>I'm running windows 7 64 bit, with office 2010, so of course I'm missing some reference. </p>\n\n<p>In particular my issue is a reference to Microsoft Office Web Components 11.0</p>\n\n<p>I can't remove the reference since it is \"in use\"</p>\n\n<p>I've tried to manually download the file (owc11.dll) and copy it to system32 and register it using regsvr32 owc11.dll (it said it registerede, but it's still missing in the project).</p>\n\n<p>What do I do to resolve this?</p>\n"}, {"tags": ["excel", "vba", "pivot"], "comments": [{"owner": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1456920355, "post_id": 35746345, "comment_id": 59166702, "body": "Do you need someone to write the VBA code for you? Or have you already done something which is not working?"}, {"owner": {"reputation": 411, "user_id": 1483256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5ba31188411ab0fe87550e3b096d205?s=128&d=identicon&r=PG", "display_name": "Viktor Zafirovski", "link": "https://stackoverflow.com/users/1483256/viktor-zafirovski"}, "reply_to_user": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1456921963, "post_id": 35746345, "comment_id": 59167877, "body": "I do not have any VBA code for this purpose yet. I do however have      <code>With ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;Day&quot;)</code> <code>.PivotItems(&quot;1&#47;25&#47;2016&quot;).Visible = False</code>  This is the basic VBA code for specific pivot item inclusion/exclusion. However, it doesn&#39;t help much in this case."}], "answers": [{"tags": [], "owner": {"reputation": 411, "user_id": 1483256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5ba31188411ab0fe87550e3b096d205?s=128&d=identicon&r=PG", "display_name": "Viktor Zafirovski", "link": "https://stackoverflow.com/users/1483256/viktor-zafirovski"}, "is_accepted": true, "score": 1, "last_activity_date": 1456923727, "creation_date": 1456923727, "answer_id": 35747998, "question_id": 35746345, "link": "https://stackoverflow.com/questions/35746345/how-to-select-first-x-values-of-pivot-filter-in-excel/35747998#35747998", "title": "How to select first X values of Pivot Filter, in Excel", "body": "<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Day\").CurrentPage = \"(All)\"\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Day\")\n\n    c = 5\n\n    For i = .PivotItems.Count To 1 Step -1\n       If (c &gt; 0) Then\n       .PivotItems(i).Visible = True\n       Else\n       .PivotItems(i).Visible = False\n       End If\n       c = c - 1\n    Next\nEnd With\n</code></pre>\n\n<p>I solved it. Here it is. C is how many values from the bottom you want to make visible.</p>\n"}], "owner": {"reputation": 411, "user_id": 1483256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5ba31188411ab0fe87550e3b096d205?s=128&d=identicon&r=PG", "display_name": "Viktor Zafirovski", "link": "https://stackoverflow.com/users/1483256/viktor-zafirovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1891, "favorite_count": 0, "accepted_answer_id": 35747998, "answer_count": 1, "score": 0, "last_activity_date": 1456923727, "creation_date": 1456919268, "question_id": 35746345, "link": "https://stackoverflow.com/questions/35746345/how-to-select-first-x-values-of-pivot-filter-in-excel", "title": "How to select first X values of Pivot Filter, in Excel", "body": "<p>I've got a \"Day\" filter in a Pivot table with the past 6 months, in the following format: \"2/23/2016\". Those values will change every day as I add more days, but I need a VBA script to select the first 30 values starting from the bottom. I can hard code \"Filter \"2/23/2016\", but I want to dynamically select \"The first 30 from the bottom\" no matter what they are. Screenshot for some clarity:\n<a href=\"https://i.stack.imgur.com/hnLlI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hnLlI.png\" alt=\"Pivot Filter\"></a></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "edited": false, "score": 0, "creation_date": 1456918458, "post_id": 35745797, "comment_id": 59165375, "body": "You could try this, I&#39;m not sure if it works though. Add a worksheet variable (<code>Dim WS as WorkSheet</code>) and then loop through all the worksheets (<code>For Each WS in ThisWorkBook</code>) and the put an if statement inside of the loop (<code>If Not WS = ActiveWorkSheet Then</code>) and you put your code in there. If the active worksheet is always the same you could make the if statement like this: <code>If WS.name &lt;&gt; &quot;active worksheet name goes here&quot; Then</code>. Try this and give us a short update if it works."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5358382, "user_type": "registered", "profile_image": "https://graph.facebook.com/103732389962732/picture?type=large", "display_name": "Andrei Babkin", "link": "https://stackoverflow.com/users/5358382/andrei-babkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1456918797, "creation_date": 1456918797, "answer_id": 35746173, "question_id": 35745797, "link": "https://stackoverflow.com/questions/35745797/hiding-locked-rows-on-protected-sheet-other-than-active-sheet/35746173#35746173", "title": "Hiding locked rows on protected sheet other than active sheet", "body": "<p>I'm affraid, that you should use Unprotect/Protect commands. It will not work without that.</p>\n\n<p>But, you can try to use Application.ScreenUpdating flag to remove the \"flashes\".</p>\n\n<pre><code>Application.ScreenUpdating = False \n\nRows(\"1:2\").EntireRow.Hidden = True\n\nSheet2.Unprotect Password:=pwd\nSheet2.Rows(\"1:2\").EntireRow.Hidden = True\nSheet2.Protect Password:=pwd, AllowFormattingCells:=True, UserInterfaceOnly:=True\n\nSheet3.Unprotect Password:=pwd\nSheet3.Rows(\"1:2\").EntireRow.Hidden = True\nSheet3.Protect Password:=pwd, AllowFormattingCells:=True, UserInterfaceOnly:=True\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 2, "last_activity_date": 1456918812, "creation_date": 1456918812, "answer_id": 35746175, "question_id": 35745797, "link": "https://stackoverflow.com/questions/35745797/hiding-locked-rows-on-protected-sheet-other-than-active-sheet/35746175#35746175", "title": "Hiding locked rows on protected sheet other than active sheet", "body": "<p>To prevent the screen flashing, you can set <code>Application.ScreenUpdating = False</code> before running your macro, and return it to <code>True</code> afterwards.</p>\n\n<p>As for being able to hide rows without unprotecting the sheet they are on first, I don't think that is possible. Frankly I am surprised it worked on the <code>ActiveSheet</code> while that was protected in the first place.</p>\n\n<p>Finally, and this is just me nitpicking, I would qualify what sheet that first line of code works on as well - being explicit with what objects you work on is a good way to prevent unexpected behavior.</p>\n"}], "owner": {"reputation": 1, "user_id": 3045722, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97db45d9f25d3c38427ed1ff3047693b?s=128&d=identicon&r=PG&f=1", "display_name": "user3045722", "link": "https://stackoverflow.com/users/3045722/user3045722"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456918812, "creation_date": 1456917768, "question_id": 35745797, "link": "https://stackoverflow.com/questions/35745797/hiding-locked-rows-on-protected-sheet-other-than-active-sheet", "title": "Hiding locked rows on protected sheet other than active sheet", "body": "<p>I'm trying to figure out how to hide locked rows using VBA code.\nLet's say I have 3 password protected worksheets, with all cells locked and <strong>UserInterfaceOnly:=True</strong>.</p>\n\n<p>My ActiveX button is on Sheet1. I want to hide Rows(\"1:2\") in all of the Worksheets (Sheet1, Sheet2 and Sheet3). However, the code works fine just for the Sheet the button is on, Sheet1. When it comes to hiding rows on Sheet2/Sheet3, Excel says that I can't hide that range because it is locked. However, it's locked on Sheet1 too, but it simply works and hides/unhides rows 1:2.</p>\n\n<p>I've already made a solution, unprotecting those 2 other sheets right before hiding/unhiding the rows and then protecting them again. This, however, doesn't look OK to me and makes the Excel go between all those sheets which takes some (very little) time and \"flashes\" when doing so. This is unwanted for me. The code looks like this:</p>\n\n<pre><code>Rows(\"1:2\").EntireRow.Hidden = True\n\nSheet2.Unprotect Password:=pwd\nSheet2.Rows(\"1:2\").EntireRow.Hidden = True\nSheet2.Protect Password:=pwd, AllowFormattingCells:=True, UserInterfaceOnly:=True\n\nSheet3.Unprotect Password:=pwd\nSheet3.Rows(\"1:2\").EntireRow.Hidden = True\nSheet3.Protect Password:=pwd, AllowFormattingCells:=True, UserInterfaceOnly:=True\n</code></pre>\n\n<p>As you can see, I'm not unprotecting Sheet1 and it works.</p>\n\n<p>Is there any way to achieve this or would it always work only on the worksheet which the ActiveX button is on? Also, <strong>I don't want to use AllowFormatingRows:=True</strong>.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "vba", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1456917864, "creation_date": 1456917864, "answer_id": 35745835, "question_id": 35745585, "link": "https://stackoverflow.com/questions/35745585/i-have-a-listbox-and-i-would-like-to-store-all-the-values-in-an-array/35745835#35745835", "title": "I have a listbox and I would like to store all the values in an array", "body": "<p>You are putting <code>ItemData(i)</code> into the array, as you never assign to an items <code>ItemData</code> you presumably mean to load the items text, change to:</p>\n\n<pre><code>ListBoxContents(i) = Me.ListBox2.List(i)\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456917864, "creation_date": 1456917181, "question_id": 35745585, "link": "https://stackoverflow.com/questions/35745585/i-have-a-listbox-and-i-would-like-to-store-all-the-values-in-an-array", "title": "I have a listbox and I would like to store all the values in an array", "body": "<p>When I click on the generate Button, then it should save all values from the listbox2 to an array.\nThen I would like to generate new Excel Documents with the array values.</p>\n\n<p>This is my code:</p>\n\n<pre><code>   Dim i As Integer\n\n   Private Sub btn_CopyValue_Click()\n\n   For i = 0 To ListBox1.ListCount - 1\n\n     If ListBox1.Selected(i) = True Then ListBox2.AddItem ListBox1.List(i)\n\n     Next i\n\n     End Sub\n\n\nPrivate Sub GenerateExcelSheets_Click()\n    Dim Size As Integer\n\n    Size = Me.ListBox2.ListCount - 1\n\n    ReDim ListBoxContents(0 To Size) As String\n\n    Dim i As Integer\n\n   For i = 0 To Size\n      ListBoxContents(i) = Me.ListBox2.ItemData(i)\n\n    Next i\n\n    For i = 0 To Size\n      MsgBox ListBoxContents(i)\n    Next i\n   End Sub\n</code></pre>\n\n<p>I don't know why it is nor working...</p>\n"}, {"tags": ["vba", "outlook", "directory", "shared"], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 4831894, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-yi7SBboLW4Q/AAAAAAAAAAI/AAAAAAAAAAA/4EM3wTQfS-k/photo.jpg?sz=128", "display_name": "mreinsmith", "link": "https://stackoverflow.com/users/4831894/mreinsmith"}, "edited": false, "score": 0, "creation_date": 1457000120, "post_id": 35753512, "comment_id": 59210108, "body": "Outstanding let me give it a try"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1456937827, "creation_date": 1456937827, "answer_id": 35753512, "question_id": 35744652, "link": "https://stackoverflow.com/questions/35744652/how-to-identify-or-list-shared-mailbox/35753512#35753512", "title": "How to identify or list shared mailbox?", "body": "<p>Read the <code>PR_MDB_PROVIDER</code> MAPI property (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x34140102</code>) using <code>Store.PropertyAccessor.GetProperty</code> (you will get back a byte array). For the delegate mailboxes, it will be <code>pbExchangeProviderDelegateGuid</code> (<code>9EB4770074E411CE8C5E00AA004254E2</code>).</p>\n\n<p>Take a look at the stores with <a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow\">OutlookSpy</a> (click IMsgStore button).</p>\n\n<p>You can also look at the <code>Store.ExchangeStoreType</code> property - it will be 4 (<code>OlExchangeStoreType.olAdditionalExchangeMailbox</code>).</p>\n\n<p>The nice thing about PR_MDB_PROVIDER is that it is exposed by all objects in the store (MailItem, MAPIFolder, Store, etc.)</p>\n"}], "owner": {"reputation": 114, "user_id": 4831894, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-yi7SBboLW4Q/AAAAAAAAAAI/AAAAAAAAAAA/4EM3wTQfS-k/photo.jpg?sz=128", "display_name": "mreinsmith", "link": "https://stackoverflow.com/users/4831894/mreinsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1596241298, "creation_date": 1456914804, "last_edit_date": 1596241298, "question_id": 35744652, "link": "https://stackoverflow.com/questions/35744652/how-to-identify-or-list-shared-mailbox", "title": "How to identify or list shared mailbox?", "body": "<p>How can I identify an assigned shared mailbox?</p>\n<p>I'm trying to create a macro for multiple people that will parse the folders in Outlook.</p>\n<p>Many of these people have accounts assigned to their profiles through Exchange and I want to <strong>skip</strong> these folders when parsing.</p>\n<p>I found GetSharedDefaultFolder but that requires the name to target the specific mailbox.</p>\n<p>I need to look at a property or something that identifies it as shared, or at least a mailbox other than my own.</p>\n"}, {"tags": ["excel", "vba", "date", "locale", "region"], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1456927338, "post_id": 35744902, "comment_id": 59171820, "body": "Thank you for the input... sadly I can&#39;t get this to work, because again when changing OS region, setting checkDate to theCurrentDate results in a type mismatch... it still doesn&#39;t like the English month name, from Spanish OS. I&#39;ve managed to come up with a workaround... which is a bit long for a comment so I&#39;ll post it by editing the original question..."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1456915430, "creation_date": 1456915430, "answer_id": 35744902, "question_id": 35744579, "link": "https://stackoverflow.com/questions/35744579/excel-vba-parse-english-date-from-any-os-region-locale/35744902#35744902", "title": "Excel VBA: Parse English date from any OS region/locale", "body": "<p>You could turn off error handling and assign the created string date to a date variable.</p>\n\n<p>You can then check to see if this caused an error; if it did, we know that the date used is not a real date.</p>\n\n<p>This should work with all regions, as it is not relying on the OS language settings.</p>\n\n<pre><code>Sub getDate()\n\n    Dim checkDate As Date\n\n    'pick up date:\n    theDay = Cells(13, 9).Value\n    theMonth = Cells(13, 10).Value\n    theYear = Cells(13, 11).Value\n\n    theCurrentDate = theDay &amp; \" \" &amp; theMonth &amp; \" \" &amp; theYear\n\n    On Error Resume Next\n    checkDate = theCurrentDate\n\n    'highlight bad date:\n    If Err.Number &gt; 0 Then\n        Cells(13, 9).Interior.ColorIndex = 38\n        Exit Sub\n    End If\n\n    On Error GoTo 0\n\n    If CDate(theCurrentDate) &gt;= CDate(Cells(1, 1)) Then\n        'do some stuff\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 753, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456928716, "creation_date": 1456914589, "last_edit_date": 1456928716, "question_id": 35744579, "link": "https://stackoverflow.com/questions/35744579/excel-vba-parse-english-date-from-any-os-region-locale", "title": "Excel VBA: Parse English date from any OS region/locale", "body": "<p>I have a spreadsheet with a date selector. Day, month and year is selected in separate cells, like so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pcxFg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pcxFg.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then I have some code that picks up the selected date, then checks if it's a real date (e.g. not 31st February), then checks if it's \"greater or equal to\" a preset date in cell A1. The format of the preset date in A1 doesn't matter, so long as it's in date format.</p>\n\n<p>The function works absolutely fine until I change my OS region to, for example, Spain. Because very simply, CDate(blah) can parse \"1 January 2016\" when it's in UK/USA region, but in Spain region mode it is expecting to see Enero, febrero, marzo, abril, etc, instead of January, February, etc. This is the (Windows) setting I'm using to emulate other regions:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lacuq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lacuq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And this is a snippet of my code:</p>\n\n<pre><code>Sub getDate()\n    'pick up date:\n    theDay = Cells(13, 9).Value\n    theMonth = Cells(13, 10).Value\n    theYear = Cells(13, 11).Value\n\n    theCurrentDate = theDay &amp; \" \" &amp; theMonth &amp; \" \" &amp; theYear\n\n    'highlight bad date:\n    If Not IsDate(theCurrentDate) Then\n        Cells(13, 9).Interior.ColorIndex = 38\n        Exit Sub\n    End If\n\n    If CDate(theCurrentDate) &gt;= CDate(Cells(1, 1)) Then\n        'do some stuff\n    End If\nEnd Sub\n</code></pre>\n\n<p>The 'highlight bad date' step is where the code glitches in a non-English region/locale setting... it will highlight the day cell. I figured this is a good enough way to spot bad dates such as 30th February, bearing in mind all three cells are data validated with lists.</p>\n\n<p>It's important that the date is selected rather than typed in, and I'd like to maintain the visual format of DD-Month-YYYY, to transcend cultures (read: to force users to conform to a single format).</p>\n\n<p>I've been trying to work out how to tell it to pretend the program locale is UK, for the code... or to tell it that the date it's picking up is in UK locale... I can't figure it, any advice is appreciated. Thank you.</p>\n\n<hr>\n\n<p>EDIT1: I found a workaround for this problem. This works by converting the month name to a number and then using the DateSerial function to turn it into ... a serial date. The problem with this is, if you give it a date of 31st April (April has 30 days), then the date serial conversion will result in 1st May. So I had to make a routine that manually checks that it's a legitimate date (including leap years)... Here's the new code, again simplified although I've included error handling this time just to make it more complete):</p>\n\n<pre><code>Sub getDate()\n    theErr = 0\n    'pick up date:\n    theDay = Cells(13, 9).Value\n    theMonth = Cells(13, 10).Value\n    theYear = Cells(13, 11).Value\n\n    'Convert month name to number:\n    If theMonth = \"January\" Then\n        theMonth = 1\n    ElseIf theMonth = \"February\" Then\n        theMonth = 2\n    ElseIf theMonth = \"March\" Then\n        theMonth = 3\n    ElseIf theMonth = \"April\" Then\n        theMonth = 4\n    ElseIf theMonth = \"May\" Then\n        theMonth = 5\n    ElseIf theMonth = \"June\" Then\n        theMonth = 6\n    ElseIf theMonth = \"July\" Then\n        theMonth = 7\n    ElseIf theMonth = \"August\" Then\n        theMonth = 8\n    ElseIf theMonth = \"September\" Then\n        theMonth = 9\n    ElseIf theMonth = \"October\" Then\n        theMonth = 10\n    ElseIf theMonth = \"November\" Then\n        theMonth = 11\n    ElseIf theMonth = \"December\" Then\n        theMonth = 12\n    End If\n\n    'Check manually for bad dates:\n    If InStr(\"2/4/6/9/11\", CStr(theMonth)) Then 'a month with 30 or fewer days:\n        If theMonth &lt;&gt; 1 Then 'January (\"1\") is found in 11, but January is OK, it has 31 days...\n            If theDay = 31 Then\n                Cells(13, 9).Interior.ColorIndex = 38\n                theErr = theErr + 1\n            End If\n            If InStr(\"2\", CStr(theMonth)) Then 'February, with either 28 or 29 days:\n                If theDay = 30 Then\n                    Cells(13, 9).Interior.ColorIndex = 38\n                    theErr = theErr + 1\n                ElseIf theDay = 29 Then\n                    If theYear Mod 4 &lt;&gt; 0 Then 'not a leap year:\n                        Cells(13, 9).Interior.ColorIndex = 38\n                        theErr = theErr + 1\n                    End If\n                End If\n            End If\n        End If\n    End If\n\n    'Give error message if date error picked up:\n    If theErr &lt;&gt; 0 Then\n        MsgBox \"Please check your date\", vbOKOnly, \"getDate\"\n        Exit Sub\n    End If\n\n    theCurrentDate = DateSerial(theYear, theMonth, theDay)\n\n    If CDate(theCurrentDate) &gt;= CDate(Cells(1, 1)) Then\n        'do some stuff\n    End If\nEnd Sub\n</code></pre>\n\n<p>It's a little lengthy.... but it does work, and now OS region doesn't affect it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 77, "user_id": 6007134, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/aJ4N4.jpg?s=128&g=1", "display_name": "Dan Tracey", "link": "https://stackoverflow.com/users/6007134/dan-tracey"}, "edited": false, "score": 0, "creation_date": 1456914806, "post_id": 35744290, "comment_id": 59162620, "body": "Why has this been voted down - I would appreciate some feedback, so I don&#39;t make the same mistakes in future posts  Thanks Dan"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6007134, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/aJ4N4.jpg?s=128&g=1", "display_name": "Dan Tracey", "link": "https://stackoverflow.com/users/6007134/dan-tracey"}, "edited": false, "score": 0, "creation_date": 1456915897, "post_id": 35744872, "comment_id": 59163469, "body": "Thanks for the input, I will now give that a try   Regards Dan"}], "tags": [], "owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "is_accepted": true, "score": 0, "last_activity_date": 1456915352, "creation_date": 1456915352, "answer_id": 35744872, "question_id": 35744290, "link": "https://stackoverflow.com/questions/35744290/how-to-add-a-password-when-selecting-one-of-two-options-in-vba-excel/35744872#35744872", "title": "How to add a password when selecting one of two options in VBA Excel?", "body": "<p>You can use the protect function from excel :<br>\n<a href=\"https://support.office.com/en-us/article/Password-protect-worksheet-or-workbook-elements-dbf706e0-ba22-4a08-84d8-552db16eef11\" rel=\"nofollow\" title=\"Office website explanations on prtoect function\">Excel protect function</a><br>\n <a href=\"https://msdn.microsoft.com/fr-fr/library/office/ff840611.aspx\" rel=\"nofollow\">VBA protect function</a> </p>\n\n<p>It can be accessed with VBA like this :</p>\n\n<pre><code>    'Lock, see second link for a full list of availables options on what is locked or not\n    ActiveSheet.Protect \"yourPasswordHere\", DrawingObjects:=True, Contents:=True, Scenarios:=True\n\n    ' Unlock\n     ActiveSheet.Unprotect \"yourPasswordHere\"\n</code></pre>\n\n<p>Depending on how your worksheet and VBA is built, you may protect the sheet when the user select the budget, and unprotect when he changes to the other options.</p>\n\n<p>However, this solution make your budget table still visible for the user, he can look at it without password, but he can't modify the values.</p>\n"}], "owner": {"reputation": 77, "user_id": 6007134, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/aJ4N4.jpg?s=128&g=1", "display_name": "Dan Tracey", "link": "https://stackoverflow.com/users/6007134/dan-tracey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 35744872, "answer_count": 1, "score": -1, "last_activity_date": 1456915352, "creation_date": 1456913902, "last_edit_date": 1456914485, "question_id": 35744290, "link": "https://stackoverflow.com/questions/35744290/how-to-add-a-password-when-selecting-one-of-two-options-in-vba-excel", "title": "How to add a password when selecting one of two options in VBA Excel?", "body": "<p>This is my first post and I'm not particularly versed in code, so please be patient and bear with me as I try to explain my query as clear as possible.</p>\n\n<p>I have a spreadsheet which has a data validation tab where I can either choose \"Actual\" or \"Budget\" - depending on what I choose these figures will then be loaded into a SQL Table.</p>\n\n<p>What I want to do, is when I choose \"Budget\" as one of my two options, I would like it to ask me for a password in my VBA Code.</p>\n\n<p>So from the following drop down options, they can choose either and this is what I want to happen</p>\n\n<p>Actual - someone else can edit the figures </p>\n\n<p>Budget - they would need a password first before any editing.</p>\n\n<p>I hope that makes sense and that someone can assist me, thanks in advance!</p>\n\n<p>Dan </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1456916238, "post_id": 35744221, "comment_id": 59163726, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32090315/vba-change-date-language\">VBA - Change date language</a>"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1456916338, "post_id": 35744221, "comment_id": 59163797, "body": "To copy from the answer to the question linked above, you can use the following to force the language of the month: <code>WorksheetFunction.Text(Date - Day(Date), &quot;[$-409]mmmm&quot;)</code>"}, {"owner": {"reputation": 31, "user_id": 5883364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85376f2635526ed952e4cb5e984c48df?s=128&d=identicon&r=PG&f=1", "display_name": "Enrico Tavernaro", "link": "https://stackoverflow.com/users/5883364/enrico-tavernaro"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1456924881, "post_id": 35744221, "comment_id": 59169892, "body": "Many thanks!! But where do I have to copy that to exactly to make it work?"}], "owner": {"reputation": 31, "user_id": 5883364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85376f2635526ed952e4cb5e984c48df?s=128&d=identicon&r=PG&f=1", "display_name": "Enrico Tavernaro", "link": "https://stackoverflow.com/users/5883364/enrico-tavernaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1253, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1457021797, "creation_date": 1456913731, "last_edit_date": 1457021797, "question_id": 35744221, "link": "https://stackoverflow.com/questions/35744221/date-formatting-vba-with-english-abbreviation", "title": "Date formatting VBA with English abbreviation", "body": "<p>I'm using the following command to format a cell which contains a date.</p>\n\n<pre><code>.Range(\"C6\").Value = Format(Me.txtStart.Value, \"dd-MMM-yy\")\n</code></pre>\n\n<p>So I input for example 01.01.13 and for the cell it converts it to 01-Jan-13 . However, the text, i.e. the MMM part is always in German although I have set the Language of Office to English. For example for March Excel puts in MRZ instead of MAR. Is there an way to make sure it always enters the English abbreviation of the month?</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1456927868, "post_id": 35744094, "comment_id": 59172250, "body": "If there are just three strings in the list it would be feasible to do it by substitution, either using a nested formula or three successive formulae. If you have many more, it wouldn&#39;t and you might be looking at a VBA solution."}, {"owner": {"reputation": 13, "user_id": 6006972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecf673990eb96ebd25c0133fefc447b?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Kinsel", "link": "https://stackoverflow.com/users/6006972/jim-kinsel"}, "reply_to_user": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1456928474, "post_id": 35744094, "comment_id": 59172772, "body": "@TomSharpe Thanks, unfortunately theres one piece of content for each of ~4,000 strings, so VBA will probably be where I need to look next. Though, it&#39;s not something I&#39;ve ever used...."}, {"owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "edited": false, "score": 0, "creation_date": 1456968745, "post_id": 35744094, "comment_id": 59196102, "body": "On sheet2 is it always Mac, Windows and Microsoft?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1456987182, "creation_date": 1456987182, "answer_id": 35764899, "question_id": 35744094, "link": "https://stackoverflow.com/questions/35744094/find-replace-multiple-substrings-from-table-in-excel/35764899#35764899", "title": "Find / Replace Multiple Substrings from Table in Excel", "body": "<p>The biggest problem you face in a situation like this is false positives. When one word or phrase can be found within another word or phrase, you may end up 'double-processing' or wrongly processing a search term. To avoid this, process each term in a descending order of length and do it in two steps. First, replace the search term with an absolutely unique temporary string and once all of the terms have been reassigned, go back and replace the temporary strings with the actual HTML anchor elements.</p>\n\n<p>\u00a0\u00a0<strong>Module1 code sheet</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Const csANCHOR As String = \"&lt;a href=\"\"\u00d7LL\u00d7\"\"&gt;\u00d7FN\u00d7&lt;/a&gt;\"\n\nSub processBlurbs()\n    Dim m As Long, w As Long\n    Dim vWRDs As Variant, vBLRBs As Variant, vMSKs As Variant\n    Dim rw As Long, r As Long, rndm As Long, str As String\n\n    'appTGGL bTGGL:=False  'uncomment after testing\n\n    getReplacements vWRDs\n    'Debug.Print LBound(vWRDs, 1) &amp; \":\" &amp; UBound(vWRDs, 1)\n    'Debug.Print LBound(vWRDs, 2) &amp; \":\" &amp; UBound(vWRDs, 2)\n\n    With Worksheets(\"Blurbs\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n\n            'replace with associated GUID for unique-per-term\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 1)\n                'reset column B to column A values\n                .Cells = .Offset(0, -1).Value2\n                For w = LBound(vWRDs, 1) To UBound(vWRDs, 1)\n                    Debug.Print vWRDs(w, 1) &amp; \" - \" &amp; vWRDs(w, 4)\n                    .Replace what:=vWRDs(w, 1), lookat:=xlPart, MatchCase:=True, _\n                             replacement:=vWRDs(w, 4)\n                Next w\n            End With\n\n            'replace GUIDs with associated ANCHOR elements\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 1)\n                For w = LBound(vWRDs, 1) To UBound(vWRDs, 1)\n                    .Replace what:=vWRDs(w, 4), lookat:=xlPart, MatchCase:=True, _\n                             replacement:=Replace(Replace(csANCHOR, \"\u00d7LL\u00d7\", vWRDs(w, 2)), \"\u00d7FN\u00d7\", vWRDs(w, 1))\n                Next w\n            End With\n\n        End With\n    End With\n\n    appTGGL\nEnd Sub\n\nSub getReplacements(ByRef wrds As Variant)\n    With Worksheets(\"Replacements\")\n        With .Cells(1, 1).CurrentRegion\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 2)\n                .FormulaR1C1 = \"=LEN(RC1)\"\n                .Value = .Value2\n            End With\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 3)\n                .Formula = \"=getGuid()\"\n                .Value = .Value2\n            End With\n            .Cells.Sort key1:=.Columns(3), order1:=xlDescending, _\n                        key2:=.Columns(1), order2:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                wrds = .Cells.Value2\n            End With\n        End With\n    End With\nEnd Sub\n\nFunction getGuid() As String\n    Dim tl As Object\n    Set tl = CreateObject(\"Scriptlet.TypeLib\")\n    getGuid = tl.Guid\n    Set tl = Nothing\nEnd Function\n\nSub appTGGL(Optional bTGGL As Boolean = True)\n    With Application\n        .EnableEvents = bTGGL\n        .ScreenUpdating = bTGGL\n        .DisplayAlerts = bTGGL\n        .Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Step through this with repeated taps to the [F8] key to get an idea of the logic and process  flow.    </p>\n\n<p>\u00a0\u00a0<strong>Replacements worksheet</strong></p>\n\n<p>\u00a0\u00a0<a href=\"https://i.stack.imgur.com/qIlSg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qIlSg.png\" alt=\"replacement_values\"></a></p>\n\n<p>\u00a0\u00a0<strong>Blurbs worksheet</strong></p>\n\n<p>\u00a0\u00a0<a href=\"https://i.stack.imgur.com/s4iBO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s4iBO.png\" alt=\"blurbs_worksheet\"></a></p>\n\n<hr>\n\n<p><strong>Results</strong>\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Lorem &lt;a href=\"http://www.apple.com/uk/osx\"&gt;Mac OS X&lt;/a&gt; dolor sit amet, consectetur &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; elit.\r\n&lt;br/&gt;\r\nQuisque &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; dolor &lt;a href=\"http://www.apple.com/uk/mac\"&gt;Mac&lt;/a&gt; ante vestibulum, eget &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; sapien tempus.\r\n&lt;br/&gt;\r\nDuis tristique sapien non &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt; porta.\r\n&lt;br/&gt;\r\nPraesent &lt;a href=\"http://www.apple.com/uk/ios\"&gt;Mac iOS&lt;/a&gt; urna id metus fringilla, non mattis sem porttitor.\r\n&lt;br/&gt;\r\nNunc bibendum &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt; ligula varius vestibulum.\r\n&lt;br/&gt;\r\nNulla sollicitudin elit nec mauris &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt;\r\n&lt;br/&gt;\r\nDuis &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; &lt;a href=\"http://www.apple.com/uk/osx\"&gt;Mac OS X&lt;/a&gt; id &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt; volutpat.\r\n&lt;br/&gt;\r\nNullam &lt;a href=\"http://www.apple.com/uk/ios\"&gt;Mac iOS&lt;/a&gt; dolor sed &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; consequat &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows&lt;/a&gt; quis eu purus.\r\n&lt;br/&gt;\r\nNullam &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; dolor eget &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt; &lt;a href=\"http://www.apple.com/uk/osx\"&gt;Mac OS X&lt;/a&gt; &lt;a href=\"http://www.apple.com/uk/ios\"&gt;Mac iOS&lt;/a&gt;\r\n&lt;br/&gt;\r\nVivamus &lt;a href=\"http://www.apple.com/uk/mac\"&gt;Mac&lt;/a&gt; leo non &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows&lt;/a&gt; pharetra pretium a malesuada dolor.\r\n&lt;br/&gt;\r\nDonec condimentum leo &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows&lt;/a&gt; dictum &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt;\r\n&lt;br/&gt;\r\nNullam aliquam velit &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows&lt;/a&gt; ullamcorper &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt;\r\n&lt;br/&gt;\r\nCurabitur &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows&lt;/a&gt; leo eget magna eleifend, &lt;a href=\"http://www.apple.com/uk/osx\"&gt;Mac OS X&lt;/a&gt; posuere velit tincidunt.\r\n&lt;br/&gt;\r\nAenean pulvinar quam &lt;a href=\"http://www.apple.com/uk/mac\"&gt;Mac&lt;/a&gt; &lt;a href=\"http://www.apple.com/uk/ios\"&gt;Mac iOS&lt;/a&gt; &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt;\r\n&lt;br/&gt;\r\nAliquam &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; diam non ipsum egestas &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt;\r\n&lt;br/&gt;\r\nPhasellus in lorem &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; &lt;a href=\"http://www.apple.com/uk/ios\"&gt;Mac iOS&lt;/a&gt; mauris tempus, laoreet nunc.\r\n&lt;br/&gt;\r\nVestibulum accumsan justo eu &lt;a href=\"http://www.ibm.com/\"&gt;IBM&lt;/a&gt; tristique, &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Microsoft Windows&lt;/a&gt; massa ornare.\r\n&lt;br/&gt;\r\nProin lobortis quam &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows&lt;/a&gt; sem imperdiet, nec &lt;a href=\"http://www.apple.com/uk/ios\"&gt;Mac iOS&lt;/a&gt; enim aliquet.</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<hr>\n"}], "owner": {"reputation": 13, "user_id": 6006972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ecf673990eb96ebd25c0133fefc447b?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Kinsel", "link": "https://stackoverflow.com/users/6006972/jim-kinsel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 35764899, "answer_count": 1, "score": 1, "last_activity_date": 1456994594, "creation_date": 1456913406, "last_edit_date": 1456994594, "question_id": 35744094, "link": "https://stackoverflow.com/questions/35744094/find-replace-multiple-substrings-from-table-in-excel", "title": "Find / Replace Multiple Substrings from Table in Excel", "body": "<p>I'm copy/pasting text into a cell in Excel which has specific substrings that need replacing, from a list of ~4,000 rows. I have an equal number of pieces of text/content as the number of rows, which I'll need to manually copy/paste in.</p>\n\n<p>Essentially, specific substrings need to be replaced with the same substring, wrapped with a HTML link, but this needs to happen for all occurrences of any substring from my list.</p>\n\n<h1>Example:</h1>\n\n<h2>I have this text:</h2>\n\n<p><code>Microsoft Excel is a spreadsheet developed by Microsoft for Windows, Mac OS X, and iOS.</code></p>\n\n<h2>In sheet #2, I have the following;</h2>\n\n<p><a href=\"http://i.stack.imgur.com/paz6Y.png\" rel=\"nofollow\">Example</a></p>\n\n<h2>I then need excel to output the text above, with the strings specified replaced with links in the following format:</h2>\n\n<p><code>&lt;a href=\"http://www.apple.com/uk/mac/\"&gt;Mac&lt;/a&gt;</code></p>\n\n<h2>In this example, it would output the following:</h2>\n\n<p><code>&lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; Excel is a spreadsheet developed by &lt;a href=\"https://www.microsoft.com/\"&gt;Microsoft&lt;/a&gt; for &lt;a href=\"https://www.microsoft.com/en-gb/windows\"&gt;Windows\n&lt;/a&gt;, &lt;a href=\"http://www.apple.com/uk/mac/\"&gt;Mac&lt;/a&gt; OS X, and iOS.</code></p>\n\n<p>I'm no excel expert, so I've not been able to find a solution. One answer on SO suggested the following to a different question;\n<code>=SUBSTITUTE(A2,\"Author\",\"Authoring\")</code>\nBut I'm not sure how I could edit this to include all of the strings without needing to manually add every single one to the formula, as this will currently just replace each string one by one.</p>\n\n<p>Has anyone done anything similar to this before? If so, how did you do it?</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1456912699, "post_id": 35743717, "comment_id": 59161135, "body": "Add the code to your post and use proper formatting on it. Most people aren&#39;t going to go to a different page to have a look at your code. Neither are they going to type in whatever code is necessary to replicate the behavior, when it would have been much simpler copying it from your post."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456912816, "post_id": 35743717, "comment_id": 59161227, "body": "<a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a>"}, {"owner": {"reputation": 1427, "user_id": 5624602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca1e4cf5aa20f7f5b921f3d2eb95220b?s=128&d=identicon&r=PG&f=1", "display_name": "STF", "link": "https://stackoverflow.com/users/5624602/stf"}, "edited": false, "score": 0, "creation_date": 1456913168, "post_id": 35743717, "comment_id": 59161459, "body": "if you can check just the first number you can use this:  =IF(LEFT(C3,1)=&quot;2&quot;,&quot;V&quot;,&quot;x&quot;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1456913757, "post_id": 35743717, "comment_id": 59161863, "body": "Try <a href=\"http://i.stack.imgur.com/KWqdi.png\" rel=\"nofollow noreferrer\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1427, "user_id": 5624602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca1e4cf5aa20f7f5b921f3d2eb95220b?s=128&d=identicon&r=PG&f=1", "display_name": "STF", "link": "https://stackoverflow.com/users/5624602/stf"}, "is_accepted": false, "score": -1, "last_activity_date": 1456913449, "creation_date": 1456913449, "answer_id": 35744110, "question_id": 35743717, "link": "https://stackoverflow.com/questions/35743717/if-statement-in-excel-check-if-cell-start-with-a-variable-number/35744110#35744110", "title": "IF-statement in excel, check if cell start with a variable number", "body": "<p>Use this function:</p>\n\n<pre><code>=ISNUMBER(SEARCH(\"240\",C3))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6006982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e449b1a16282ae60a58a0f31bbc0748?s=128&d=identicon&r=PG&f=1", "display_name": "eklo", "link": "https://stackoverflow.com/users/6006982/eklo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1456913587, "creation_date": 1456912432, "last_edit_date": 1456913587, "question_id": 35743717, "link": "https://stackoverflow.com/questions/35743717/if-statement-in-excel-check-if-cell-start-with-a-variable-number", "title": "IF-statement in excel, check if cell start with a variable number", "body": "<p>The function that i'm trying to get to work is this:</p>\n\n<pre><code>Sub knapp()\nDim counter As Integer\ncounter = 200\nRows(\"7\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromBelow\nFor counter = 200 To 800\n    If Sheets(\"Ark1\").Range(\"C3\").Value = \"counter*\" Then\n        Sheets(\"Ark2\").Range(\"C\" &amp; counter).Copy\n        Sheets(\"Ark1\").Range(\"E7\").PasteSpecial Paste:=xlPasteValues,    Operation:=xlNone, SkipBlanks _\n         :=False, Transpose:=False\n        Sheets(\"Ark1\").Range(\"E7\").HorizontalAlignment = xlCenter\n        Sheets(\"Ark2\").Range(\"D\" &amp; counter).Copy\n        Sheets(\"Ark1\").Range(\"F7\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    End If\nNext counter\nEnd Sub\n</code></pre>\n\n<p>The cell C3 contains a number and a text, i.e \"240 - Test text text\". The value changes, but the format of it is always as above\nIf C3 starts with 240 then I want it to copy the corresponding cell from the other sheet. \nThe copying part works, but the IF-statement is the issue. \nI dont know how to check if C3 starts with the variable counter.</p>\n\n<p>Thank you in advance for your help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1, "user_id": 5950542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700741510202441/picture?type=large", "display_name": "Aashish Singh", "link": "https://stackoverflow.com/users/5950542/aashish-singh"}, "edited": false, "score": 0, "creation_date": 1456910912, "post_id": 35742824, "comment_id": 59159793, "body": "That&#39;s because you&#39;re using the <code>&lt;div&gt;</code> object, but you should be using the <code>&lt;img&gt;</code> object."}, {"owner": {"reputation": 1, "user_id": 5950542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700741510202441/picture?type=large", "display_name": "Aashish Singh", "link": "https://stackoverflow.com/users/5950542/aashish-singh"}, "edited": false, "score": 0, "creation_date": 1456911104, "post_id": 35742824, "comment_id": 59159932, "body": "I am new to VBA, so if you could tell me how to use &#39; &lt;img&gt;&#39; object"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1, "user_id": 5950542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700741510202441/picture?type=large", "display_name": "Aashish Singh", "link": "https://stackoverflow.com/users/5950542/aashish-singh"}, "edited": false, "score": 0, "creation_date": 1456911522, "post_id": 35742824, "comment_id": 59160247, "body": "It&#39;s html DOM you need to know, not really VBA - however you got the <code>&lt;div&gt;</code> element in your current code, you need to use that same method to grab the <code>&lt;img&gt;</code> element instead. That&#39;s not what the question is about though"}, {"owner": {"reputation": 22657, "user_id": 3372061, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2jSi6.png?s=128&g=1", "display_name": "Dev-iL", "link": "https://stackoverflow.com/users/3372061/dev-il"}, "edited": false, "score": 0, "creation_date": 1456936026, "post_id": 35742824, "comment_id": 59178841, "body": "@MacroMan - I came across your answer after it has been flagged as VLQ. I suggest you edit your answer and explain a bit more what&#39;s going on: why the problem happens, and why your suggestion should work (which is pretty much what you did in the comments anyway)."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 22657, "user_id": 3372061, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2jSi6.png?s=128&g=1", "display_name": "Dev-iL", "link": "https://stackoverflow.com/users/3372061/dev-il"}, "edited": false, "score": 1, "creation_date": 1456936190, "post_id": 35742824, "comment_id": 59178980, "body": "@Dev-iL appreciate the feedback, and completely agree - but as the OP hasn&#39;t provided further feedback I&#39;m probably just going to delete the answer."}, {"owner": {"reputation": 1, "user_id": 5950542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700741510202441/picture?type=large", "display_name": "Aashish Singh", "link": "https://stackoverflow.com/users/5950542/aashish-singh"}, "edited": false, "score": 0, "creation_date": 1456992214, "post_id": 35742824, "comment_id": 59204711, "body": "Couldn&#39;t able to understand the answers as i am very new to VBA  I tried researching more and encountered this question <a href=\"http://stackoverflow.com/questions/22008004/how-to-fetch-the-alt-value-from-an-img-using-vba?rq=1\" title=\"how to fetch the alt value from an img using vba\">stackoverflow.com/questions/22008004/&hellip;</a> but that too is not working Thanks appreciate your help @MacroMan"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1456910057, "creation_date": 1456910057, "answer_id": 35742824, "question_id": 35742642, "link": "https://stackoverflow.com/questions/35742642/how-to-extract-alt-value-from-an-image-using-vba/35742824#35742824", "title": "How to extract alt value from an image using vba", "body": "<p>Change</p>\n\n<pre><code>obj.innerHTML\n</code></pre>\n\n<p>to</p>\n\n<pre><code>obj.Alt\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5950542, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700741510202441/picture?type=large", "display_name": "Aashish Singh", "link": "https://stackoverflow.com/users/5950542/aashish-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456912643, "creation_date": 1456909515, "last_edit_date": 1456912643, "question_id": 35742642, "link": "https://stackoverflow.com/questions/35742642/how-to-extract-alt-value-from-an-image-using-vba", "title": "How to extract alt value from an image using vba", "body": "<p>I want to extract alt value from this code:</p>\n\n<pre><code>&lt;div class=\"item-right\"&gt;\n            &lt;div class=\"item-company-logo-wrapper\"&gt;\n                &lt;div class=\"item-company-logo\"&gt;\n                    &lt;img class=\"centered\" src=\"https://jrdportals.s3.amazonaws.com/6bd8ed9bdba5432c98b1c12a5fada6a8_logo\" alt=\"XYZ Company\"&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"item-buttons\"&gt;\n</code></pre>\n\n<p>I use below code but it is extracting full html code but I need only \"XYZ Company\" (or value in alt)</p>\n\n<pre><code>Case \"item-company-logo\" \nsht.Range(\"l\" &amp; RowCount + 1) = obj.innerHTML\n</code></pre>\n\n<p>I tried using <code>innerText</code> instead of <code>innerHTML</code> but no value has been extracted. Any help is appreciated!</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "edited": false, "score": 1, "creation_date": 1456908713, "post_id": 35742314, "comment_id": 59158228, "body": "Exactly, what is the value of <code>RowNum</code>?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1456909235, "post_id": 35742314, "comment_id": 59158570, "body": "Your quotation marks are suspect... re-write the code by hand and I imagine you will find it works. Guessing the code has been copy/pasted from another site"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1456909453, "creation_date": 1456909453, "answer_id": 35742622, "question_id": 35742314, "link": "https://stackoverflow.com/questions/35742314/run-time-error-1004-method-range-of-object-global-failed-simple-copy-an/35742622#35742622", "title": "Run-time error &#39;1004&#39; : Method &#39;Range&#39; of object&#39;_Global&#39; failed; SIMPLE COPY AND PASTE", "body": "<pre><code>Range(\u201cF\u201d &amp; RowNum &amp; \":G\" &amp; RowNum).Select\n      ^ ^            ^  ^\n      | |            |  |\n    Chr(147)        Chr(34)\n</code></pre>\n\n<p>The 'quotation marks' around <code>F</code> are character 147. To denote a string value you have to use character 34, like the ones around <code>:G</code></p>\n\n<p>This usually happens when copy/pasting code from a website. Delete the quotation marks and re-write them manually to solve the issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 6006654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27cb7a77338db8251c0dcaedabffcf7?s=128&d=identicon&r=PG&f=1", "display_name": "lanee", "link": "https://stackoverflow.com/users/6006654/lanee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456910500, "creation_date": 1456908485, "last_edit_date": 1456910500, "question_id": 35742314, "link": "https://stackoverflow.com/questions/35742314/run-time-error-1004-method-range-of-object-global-failed-simple-copy-an", "title": "Run-time error &#39;1004&#39; : Method &#39;Range&#39; of object&#39;_Global&#39; failed; SIMPLE COPY AND PASTE", "body": "<p>I'm just trying to do a simple cut and paste to shift ranges in F:G to an unoccupied cell in <code>D</code> but I keep getting that error message. My codes are in the Modules and I don't know what I'm doing wrong! Completely new to VBA. Highlighted portion: <code>Range(\"F\" &amp; RowNum &amp; \":G\" &amp; RowNum).Select</code></p>\n\n<pre><code>Sub MoveCells(RowNum as Integer)\n\n   Range(\u201cF\u201d &amp; RowNum &amp; \":G\" &amp; RowNum).Select\n\n   Selection.Cut\n\n   Range(\u201cD\u201d &amp; RowNum).Select\n\n   ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456909656, "post_id": 35741762, "comment_id": 59158864, "body": "What exactly is your question? Do you get an error or something?"}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1456911240, "post_id": 35741762, "comment_id": 59160043, "body": "&quot;but keeps the header&quot;, how to remove the header and change size to A3, sorry for the unclear question, will edit it now"}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 1, "last_activity_date": 1456912715, "creation_date": 1456912715, "answer_id": 35743818, "question_id": 35741762, "link": "https://stackoverflow.com/questions/35741762/insert-a-new-page-in-word-without-header/35743818#35743818", "title": "Insert a new page in word without header", "body": "<p>OK, first of all, you will need a section break, not a simple page break:</p>\n\n<pre><code>Selection.InsertBreak Type:=wdSectionBreakNextPage\n</code></pre>\n\n<p>To change to landscape orientation:</p>\n\n<pre><code>Selection.PageSetup.Orientation = wdOrientLandscape\n</code></pre>\n\n<p>Make sure you are in the section you want to change. Note that after inserting the section break, the cursor will be in the new section.</p>\n\n<p>To change the size to A3, you will need to set the size manually:</p>\n\n<pre><code>With Selection.PageSetup\n .PageWidth = CentimetersToPoints(42)\n .PageHeight = CentimetersToPoints(29.7)\nEnd With\n</code></pre>\n\n<p>To delete the header:</p>\n\n<pre><code>selection.Sections(1).Headers(wdHeaderFooterPrimary).Range.Delete\n</code></pre>\n\n<p>Your selection doesn't include multiple sections, so from the one section it touches, you need the first (duh) hence the Sections(1).</p>\n\n<p>Put it all together:</p>\n\n<pre><code>Selection.InsertBreak Type:=wdSectionBreakNextPage\nWith Selection.PageSetup\n .Orientation = wdOrientLandscape\n .PageWidth = CentimetersToPoints(42)\n .PageHeight = CentimetersToPoints(29.7)\nEnd With\nSelection.Sections(1).Headers(wdHeaderFooterPrimary).Range.Delete\n</code></pre>\n\n<p>This code will insert a new section+page break, set this new section to landscape A3, and remove the headers from it.</p>\n\n<p>Note: You might need to unlink the headers <em>before</em> deleting it:</p>\n\n<pre><code>selection.Sections(1).Headers(wdHeaderFooterPrimary).LinkToPrevious=False\n</code></pre>\n\n<p>Hope this helps. </p>\n"}, {"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 0, "last_activity_date": 1456923567, "creation_date": 1456923567, "answer_id": 35747940, "question_id": 35741762, "link": "https://stackoverflow.com/questions/35741762/insert-a-new-page-in-word-without-header/35747940#35747940", "title": "Insert a new page in word without header", "body": "<p>Here is the working code in case someone else also find it useful:</p>\n\n<pre><code>    'Add drawing\n    If wordDrawingExist Then\n        Set wb = Documents.Open(wFile)\n        Selection.WholeStory\n        Selection.Copy\n        Documents(docLogSkjema).Activate\n        Selection.EndKey Unit:=wdStory\n        Selection.InsertBreak Type:=wdSectionBreakNextPage\n        With Selection.PageSetup\n         .Orientation = wdOrientLandscape\n         .PageWidth = CentimetersToPoints(42)\n         .PageHeight = CentimetersToPoints(29.7)\n        End With\n        Selection.Sections(1).Headers(wdHeaderFooterPrimary).LinkToPrevious = False\n        Selection.Sections(1).Headers(wdHeaderFooterPrimary).Range.Delete\n        Selection.Sections(1).Footers(wdHeaderFooterPrimary).LinkToPrevious = False\n        Selection.Sections(1).Footers(wdHeaderFooterPrimary).Range.Delete\n        Selection.Paste\n        wb.Close False\n    End If\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "accepted_answer_id": 35743818, "answer_count": 2, "score": 0, "last_activity_date": 1456955213, "creation_date": 1456906668, "last_edit_date": 1456955213, "question_id": 35741762, "link": "https://stackoverflow.com/questions/35741762/insert-a-new-page-in-word-without-header", "title": "Insert a new page in word without header", "body": "<p>I am trying to insert a new page in word i.e insert a section break. The problem is that i want to change this page to A3 landscape and remove all headers, which my code currently does not do. How to modify my code below to achieve this?</p>\n\n<p>Below is my current code that insert new page, but keeps the header and a4 portrait:</p>\n\n<pre><code>If wordDrawingExist Then\n    Selection.EndKey Unit:=wdStory\n    Selection.InsertFile FileName:=wFile, link:=False\n\n    Set wb = Documents.Open(wFile)\n    Selection.WholeStory\n    Selection.Copy\n    Documents(docLogSkjema).Activate\n    Selection.EndKey Unit:=wdLine\n    Selection.InsertBreak Type:=wdPageBreak\n    Selection.Paste\n\n    wb.Close False\nEnd If\n</code></pre>\n\n<p><code>wFile</code> is fullpath to a wordfile, which is basically a pdf to word from freepdfsolutions.com (Tried inserting the pdf directly but then the quality of the pdf was so bad that numbers were hard to read) and <code>wordDrawingExist</code>  is the boolean saying if the wordfile exist or not</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "is_accepted": false, "score": 0, "last_activity_date": 1456908383, "creation_date": 1456908383, "answer_id": 35742281, "question_id": 35741664, "link": "https://stackoverflow.com/questions/35741664/vba-how-to-get-specific-value-from-a-column/35742281#35742281", "title": "VBA - How to get specific value from a column", "body": "<p>Welcome to stackoverflow. Now, I want to help you, but I would like to make you think yourself as well. So here's how I would start. Try to google the rest yourself, because that will make you a better programmer.</p>\n\n<p>I would create a <strong>range</strong> which I'd <strong>set</strong> at A2 (in this case at the value \"book\") and <strong>loop</strong> it all the way down until it reaches an empty cell (the <strong>value</strong> of this cell is nothing). In every loop it checks (look up <strong>if statement</strong>) whether the value of this range is \"book\" (you might want to do this with <strong>LCase</strong> to make it case insensitive) and <strong>copy</strong> the required values to another worksheet.</p>\n\n<p>All the relevant things you have to put in your code are in bold. You don't need loads of code for this, it should be doable for a beginning programmer. If you need more help, post the code you've written so far and we'll try to help you. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "is_accepted": false, "score": 0, "last_activity_date": 1456991445, "creation_date": 1456991445, "answer_id": 35766149, "question_id": 35741664, "link": "https://stackoverflow.com/questions/35741664/vba-how-to-get-specific-value-from-a-column/35766149#35766149", "title": "VBA - How to get specific value from a column", "body": "<p>lngLastRow = wksht1.Range(\"A\" &amp; wksht1.Rows.Count).End(xlUp).Row</p>\n\n<pre><code>rownum = 2\nFor Index = 2 To lngLastRow\n    'Column A - AO\n    'from wksht1 = \"kaizen\"\n    outputWksht.Range(\"A\" &amp; rownum).Value = wksht1.Range(\"C\" &amp; Index).Value\n    outputWksht.Range(\"B\" &amp; rownum).Value = wksht1.Range(\"D\" &amp; Index).Value\n    outputWksht.Range(\"C\" &amp; rownum).Value = wksht1.Range(\"E\" &amp; Index).Value\n    outputWksht.Range(\"D\" &amp; rownum).Value = wksht1.Range(\"G\" &amp; Index).Value\n    outputWksht.Range(\"E\" &amp; rownum).Value = wksht1.Range(\"H\" &amp; Index).Value\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456991445, "creation_date": 1456906288, "question_id": 35741664, "link": "https://stackoverflow.com/questions/35741664/vba-how-to-get-specific-value-from-a-column", "title": "VBA - How to get specific value from a column", "body": "<p><strong>VBA</strong>.  I want to get selected value from a column A.</p>\n\n<p>ex. I only want to get value from columnA which is \n\"book\"</p>\n\n<p><code>columnA  columnB  columnC\n book     yellow    2\n pen      black     3\n book     blue      4\n bag      blue      1</code></p>\n\n<p>now, the output that i want is like this</p>\n\n<pre><code>columnA  columnB   columnC\nbook     yellow    2\nbook     blue      4\n</code></pre>\n\n<p>i have the logic but I don't how to start</p>\n"}, {"tags": ["ms-access", "ftp", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1456915358, "post_id": 35741227, "comment_id": 59163056, "body": "Will it run manually? Are you sure that it shouldn&#39;t read: ` strUserName = &quot;user&quot;`?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1456918745, "post_id": 35741227, "comment_id": 59165551, "body": "Yeah, first step should be to create a working FTP_Run.bat + FTP_cmd.txt, second step to create those via VBA (this should be the easy part)."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1456932264, "post_id": 35741227, "comment_id": 59175904, "body": "@Andre I tried running it manually and found the same problem. Hence created another Question for the same - <a href=\"http://stackoverflow.com/questions/35743072\">stackoverflow.com/questions/35743072</a>"}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1456933395, "post_id": 35741227, "comment_id": 59176762, "body": "@Gustav The login is successful. See screenshot here - <a href=\"http://stackoverflow.com/questions/35743072\">stackoverflow.com/questions/35743072</a>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1457167138, "post_id": 35741227, "comment_id": 59292182, "body": "I can see you got is sorted out."}], "answers": [{"tags": [], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "is_accepted": true, "score": 1, "last_activity_date": 1457210803, "creation_date": 1457210803, "answer_id": 35819728, "question_id": 35741227, "link": "https://stackoverflow.com/questions/35741227/ftp-using-access-vba-creates-file-on-server-with-no-data/35819728#35819728", "title": "FTP using Access VBA creates file on server with no data", "body": "<p>I figured out that there was problem in my PC itself. Could not find the exact cause of the problem though. I check firewall, there is no firewall issue as I turned it off and the issue was still there.</p>\n\n<p>The above code works fine on other PC.</p>\n\n<p>I am not deleting this Question, as other users might find this question and simple solution to the problem will be to try running the code on Other PC.</p>\n\n<p>Another reason keeping this Q open is, This is ready made code for those who are searching for implementing FTP using Access VBA.</p>\n"}], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "accepted_answer_id": 35819728, "answer_count": 1, "score": 1, "last_activity_date": 1457210803, "creation_date": 1456904655, "last_edit_date": 1456915252, "question_id": 35741227, "link": "https://stackoverflow.com/questions/35741227/ftp-using-access-vba-creates-file-on-server-with-no-data", "title": "FTP using Access VBA creates file on server with no data", "body": "<p>I am using the below function to upload the files to server using FTP.</p>\n\n<p>But the file size is ZERO. The file contains no data. Can't figure out what error I made in implementing the function.</p>\n\n<pre><code>Function FTP_Data()\n'=========================================================================\n'FTP from Microsoft Access\n'by Matthew V Carmichael\n'Creates FTP Batch File, FTP command file (txt)\n'========================================================================='\nOn Error GoTo Err_Trap\n\n    Dim pFile As Long\n    Dim strPath As String\n    Dim strFileName As String\n    Dim ftpServer As String\n    Dim strUserName As String\n    Dim strPassword As String\n\n\n    'Path and Name of file to FTP\n    strPath = \"C:\\Temp\\\"\n    strFileName = \"C:\\Temp\\AccessDocumentation.pptx\" 'Name of file to upload\n    'FTP Server Settings\n    ftpServer = \"ftp.mydomain.com\"\n    strUserName = \"user@mydomain.com\"\n    strPassword = \"****\"\n\n    SetAttr strPath &amp; \"FTP_cmd.txt\", vbNormal\n\n\n    'Create text file containing FTP commands\n    pFile = FreeFile\n    Open strPath &amp; \"FTP_cmd.txt\" For Output As pFile\n    Print #pFile, \"user\"\n    Print #pFile, strUserName\n    Print #pFile, strPassword\n    Print #pFile, \"Put \" &amp; strFileName\n    'Use the Put command to upload, use the Get command to download.\n    'Print #pFile, \"Get \" &amp; \"Your File Name\"\n    Print #pFile, \"quit\"\n    Close pFile\n\n    'Create batch file to execute FTP\n    pFile = FreeFile\n    Open strPath &amp; \"FTP_Run.bat\" For Output As pFile\n    Print #pFile, \"ftp -n -s:\" &amp; strPath &amp; \"FTP_cmd.txt \" &amp; ftpServer\n    Print #pFile, \"Pause\"\n    Close pFile\n\n    SetAttr strPath &amp; \"FTP_cmd.txt\", vbHidden\n\n    'Execute FTP command\n    Shell strPath &amp; \"FTP_Run.bat\", 1\n\n\nErr_Trap_Exit:\n    Exit Function\n\nErr_Trap:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Resume Err_Trap_Exit\n\nEnd Function\n</code></pre>\n\n<p>PS : New in VBA programming.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1462110278, "creation_date": 1462110278, "answer_id": 36967370, "question_id": 35741153, "link": "https://stackoverflow.com/questions/35741153/lims-technical-standards-indexing/36967370#36967370", "title": "LIMS-technical standards indexing", "body": "<p>You can split by first:</p>\n\n<ul>\n<li>paragraph -> point, name, description</li>\n</ul>\n\n<p>then split these</p>\n\n<ul>\n<li>first space -> <strong>point</strong> + name, description</li>\n</ul>\n\n<p>then split the second part</p>\n\n<ul>\n<li>first dot -> <strong>name</strong> + <strong>description</strong></li>\n</ul>\n"}], "owner": {"reputation": 39, "user_id": 5160925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0a3978acac585703ce3d3b90cf3d191?s=128&d=identicon&r=PG&f=1", "display_name": "alessio cazzaniga", "link": "https://stackoverflow.com/users/5160925/alessio-cazzaniga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462110278, "creation_date": 1456904369, "last_edit_date": 1456907157, "question_id": 35741153, "link": "https://stackoverflow.com/questions/35741153/lims-technical-standards-indexing", "title": "LIMS-technical standards indexing", "body": "<p>I have technical standards that look like this <a href=\"https://i.stack.imgur.com/HgZbv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HgZbv.png\" alt=\"enter image description here\"></a></p>\n\n<p>How would you upload it in the database without losing the natural indexing of this procedure using these fields:</p>\n\n<ul>\n<li>point</li>\n<li>name</li>\n<li>description\n?</li>\n</ul>\n"}, {"tags": ["excel", "duplicates", "vba"], "comments": [{"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1456905465, "post_id": 35740466, "comment_id": 59156379, "body": "You are calling <code>Pvt_Account_Disablement</code> but your <code>sub</code> is named <code>Pvt_Account</code>??? Also, what does &quot;not getting the desired result&quot; mean? Please explain what is going wrong explicitly! Also in future make sure to indent your code"}, {"owner": {"reputation": 1, "user_id": 6006238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3270da8d6debe1693016d47c2c2b4c4?s=128&d=identicon&r=PG&f=1", "display_name": "Alfy", "link": "https://stackoverflow.com/users/6006238/alfy"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1456942786, "post_id": 35740466, "comment_id": 59183417, "body": "Dan, thanks for the quick response. sub name, i have  given mistakenly, now i have corrected it. But i am facing with the problem in which,  needed data are removed along with duplicate data. I am not getting any syntax error but i think some logical error."}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1456947400, "post_id": 35740466, "comment_id": 59186300, "body": "Your code is not so easy to follow, can I suggest that you add an explanation as to what it&#39;s doing (more detailed) and also that you use more expressive variable names. For example, <code>p</code> should be called something like <code>worksheetNumber</code>. If you also give similarly clear names for <code>m</code>, <code>k</code>, <code>j</code> and <code>r</code> your code will be a lot easier for us to read."}, {"owner": {"reputation": 1, "user_id": 6006238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3270da8d6debe1693016d47c2c2b4c4?s=128&d=identicon&r=PG&f=1", "display_name": "Alfy", "link": "https://stackoverflow.com/users/6006238/alfy"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1457029833, "post_id": 35740466, "comment_id": 59231811, "body": "Hi Dan, code have been changed for easy to follow. And this code is a part of my project.I have already mentioned , What problem I am facing on this code. Suggest a solution for this. Thank You"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1457072866, "post_id": 35740466, "comment_id": 59249166, "body": "I&#39;m sorry but if you&#39;re not going to explain what your code does (i.e. what you think each loop in there is trying to achieve etc, not just the overall goal) and you&#39;re not properly explaining what goes wrong with examples (I suggest before and after screenshots of short columns of data), then your question is simply incomplete."}, {"owner": {"reputation": 1, "user_id": 6006238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3270da8d6debe1693016d47c2c2b4c4?s=128&d=identicon&r=PG&f=1", "display_name": "Alfy", "link": "https://stackoverflow.com/users/6006238/alfy"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1457083270, "post_id": 35740466, "comment_id": 59254314, "body": "I got the solution for my problem. Thanks Dan for considering my problem."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6006238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3270da8d6debe1693016d47c2c2b4c4?s=128&d=identicon&r=PG&f=1", "display_name": "Alfy", "link": "https://stackoverflow.com/users/6006238/alfy"}, "edited": false, "score": 0, "creation_date": 1457063191, "post_id": 35780525, "comment_id": 59246115, "body": "Kim Ph&#250; Ng&#244;, thanks a lot for your solution. It works now and thank you Dan for your quick response."}], "tags": [], "owner": {"reputation": 656, "user_id": 1400623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f9a87e67ea7db19e63802f9c4c1964?s=128&d=identicon&r=PG&f=1", "display_name": "Phu Ngo", "link": "https://stackoverflow.com/users/1400623/phu-ngo"}, "is_accepted": false, "score": 1, "last_activity_date": 1457032401, "last_edit_date": 1457032401, "creation_date": 1457031041, "answer_id": 35780525, "question_id": 35740466, "link": "https://stackoverflow.com/questions/35740466/remove-duplicates-excel-vba/35780525#35780525", "title": "Remove duplicates excel vba", "body": "<p>In </p>\n\n<pre><code>Range(\"B\" &amp; m &amp; \" :C \" &amp; r).RemoveDuplicates Columns:=Array(2), Header:=xlYes  \n</code></pre>\n\n<p>, I think you will want <code>Columns:=Array(1)</code> instead, i.e. removing duplicates from the first column of the range <code>Bm:Cr</code>, which is <code>B</code>. The space after <code>:C</code> should also be removed.</p>\n"}], "owner": {"reputation": 1, "user_id": 6006238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3270da8d6debe1693016d47c2c2b4c4?s=128&d=identicon&r=PG&f=1", "display_name": "Alfy", "link": "https://stackoverflow.com/users/6006238/alfy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "closed_date": 1457072745, "answer_count": 1, "score": -2, "last_activity_date": 1457032401, "creation_date": 1456901929, "last_edit_date": 1531161705, "question_id": 35740466, "link": "https://stackoverflow.com/questions/35740466/remove-duplicates-excel-vba", "closed_reason": "Not suitable for this site", "title": "Remove duplicates excel vba", "body": "<p>I tried to remove duplicates using below code. But I am not getting desired output. Along with duplicate data other data are also get removed. </p>\n\n<pre><code>Sub account()\n    Dim d As String\n    Call Pvt_Account(192, 8)\nEnd Sub\n\nSub Pvt_Account(RowNumber As Integer,sheetnumber As Integer)\n    Worksheets(sheetnumber).Activate\n    NumRows = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n\n\n    m = RowNumber\n    CellNumber = 2\n    For i = 1 To NumRows - 1\n        Sheet2.Range(\"C\" &amp; RowNumber) = Application.WorksheetFunction.CountIf(Range(\"F2:F\" &amp; NumRows), Cells(CellNumber, 6)) \n\n        Sheet2.Range(\"b\" &amp; RowNumber) = Worksheets(sheetnumber).Range(\"f\" &amp; CellNumber)\n        RowNumber  = RowNumber + 1\n        CellNumber = CellNumber + 1\n    Next i\n\n    Worksheets(2).Activate\n\n    r = (m + NumRows) - 2\n\n    Range(\"B\" &amp; m &amp; \" :C \" &amp; r).RemoveDuplicates Columns:=Array(2), Header:=xlYes\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ie-automation"], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 6006032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpTKmlYokps/AAAAAAAAAAI/AAAAAAAAAD0/rrzpF25b8TY/photo.jpg?sz=128", "display_name": "Yun Jia Fei", "link": "https://stackoverflow.com/users/6006032/yun-jia-fei"}, "is_accepted": false, "score": 1, "last_activity_date": 1457077263, "last_edit_date": 1457077263, "creation_date": 1457066669, "answer_id": 35788143, "question_id": 35739771, "link": "https://stackoverflow.com/questions/35739771/vba-ie-onclick-function-call/35788143#35788143", "title": "VBA IE Onclick Function Call", "body": "<p>I finally figured it out!!!</p>\n\n<p>There is a hidden text input element there to capture the value I entered in the text filed. Every time the text filed loses focus, the value in the text filed will be sent to the hidden input element below.</p>\n\n<pre><code>&lt;input id=\"spsCtrlDefault_ctl02_gvQueryColumns_ctl02_txtItem_Code_ClientState\" name=\"spsCtrlDefault_ctl02_gvQueryColumns_ctl02_txtItem_Code_ClientState\" type=\"hidden\" autocomplete=\"off\" value=\"{&amp;quot;enabled&amp;quot;:true,&amp;quot;emptyMessage&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;validationText&amp;quot;:&amp;quot;TESTVALUE&amp;quot;,&amp;quot;valueAsString&amp;quot;:&amp;quot;TESTVALUE&amp;quot;}\"&gt;\n</code></pre>\n\n<p>VB Code for sending value to hidden input element:</p>\n\n<pre><code>queryID = \"spsCtrlDefault_ctl02_gvQueryColumns_ctl02_txtItem_Code\"\nIE.Document.getElementById(queryID).FireEvent (\"onblur\")\n</code></pre>\n"}], "owner": {"reputation": 94, "user_id": 6006032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpTKmlYokps/AAAAAAAAAAI/AAAAAAAAAD0/rrzpF25b8TY/photo.jpg?sz=128", "display_name": "Yun Jia Fei", "link": "https://stackoverflow.com/users/6006032/yun-jia-fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2955, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1457077263, "creation_date": 1456899041, "last_edit_date": 1457066176, "question_id": 35739771, "link": "https://stackoverflow.com/questions/35739771/vba-ie-onclick-function-call", "title": "VBA IE Onclick Function Call", "body": "<p>Fellows,</p>\n\n<p>I was trying to do IE automation with VBA. Everything worked as I wanted until I got to this problem.\n<a href=\"http://i.stack.imgur.com/UnvV7.png\" rel=\"nofollow\">Enter item no in a input text filed, and then click on link 'RUN Report' to get the report.</a></p>\n\n<p><strong>Problem:</strong> After clicked on 'RUN report', the report was not pulled for the Item No I entered in the text filed. But a report for all items in database.</p>\n\n<p><strong>Possible cause:</strong>\nThere is a onclick function in the link, I am not sure if this function is called when \"<strong>IE.Doucument.getElementById(runReportID).Click</strong>\" is executed. I also tried \"<strong>IE.Document.getElementById(runReportID).FireEvent(\"onclick\")</strong>\" and \"<strong>IE.Document.parentWindow.execScript(\"return ValidateDate();\", \"JavaScript\")</strong>\", unfortunately, they didn't work.</p>\n\n<p>And I don't know how to pass the value I entered in text field to the function when \"Run Report\" button is clicked. Is there an event in that text filed to do this job?</p>\n\n<p>HTML code for link 'RUN Report' and text field:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;A onclick=\"return ValidateDate();\" id=spsCtrlDefault_ctl02_lbtn_run_qry_rpt title=\"Click to run report\" style=\"CURSOR: hand; TEXT-DECORATION: none; HEIGHT: 14px; FONT-FAMILY: ariel; FONT-WEIGHT: bold; COLOR: #0033ff\" href=\"javascript:__doPostBack('spsCtrlDefault$ctl02$lbtn_run_qry_rpt','')\"&gt;[ Run Report ]&lt;/A&gt;\n&lt;input id=\"spsCtrlDefault_ctl02_gvQueryColumns_ctl02_txtItem_Code\" name=\"spsCtrlDefault$ctl02$gvQueryColumns$ctl02$txtItem_Code\" size=\"20\" class=\"riTextBox riEnabled\" type=\"text\" req_ind=\"N\" tbl_idn=\"2\" value=\"947519\" controltype=\"text\" datatype=\"varchar\" col_idn=\"1\" dbfld=\"item_revision.item_cde\" style=\"text-transform: uppercase;\"&gt;\n&lt;input id=\"spsCtrlDefault_ctl02_gvQueryColumns_ctl02_txtItem_Code_ClientState\" name=\"spsCtrlDefault_ctl02_gvQueryColumns_ctl02_txtItem_Code_ClientState\" type=\"hidden\" autocomplete=\"off\" value=\"{&amp;quot;enabled&amp;quot;:true,&amp;quot;emptyMessage&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;validationText&amp;quot;:&amp;quot;TESTVALUE&amp;quot;,&amp;quot;valueAsString&amp;quot;:&amp;quot;TESTVALUE&amp;quot;}\"&gt;\n</code></pre>\n\n<p>VBA code for link click:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>IE.Document.getElementById(runReportID).Click\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer", "radio-button"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1456898902, "post_id": 35739623, "comment_id": 59153148, "body": "Try <code>Doc.getElementById(&quot;button1&quot;).click &quot;100&quot;, &quot;2016-03-02&quot;</code>   What language were you using when it worked ?  Also would be helpful to post a URL or the relevant HTML."}, {"owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1456899820, "post_id": 35739623, "comment_id": 59153543, "body": "I can&#39;t provide the real URL since it requires me to login to a site (it&#39;s for clicking a button that books a session. However, I just used the console in Chrome. Also, your suggestion doesn&#39;t work in VBA, it still thinks nothing should be placed after the <code>.Click</code> (that error about invalid property assignments)."}], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "is_accepted": false, "score": 1, "last_activity_date": 1456900598, "last_edit_date": 1495542157, "creation_date": 1456900598, "answer_id": 35740149, "question_id": 35739623, "link": "https://stackoverflow.com/questions/35739623/vba-ie-click-button-that-requires-argument/35740149#35740149", "title": "VBA IE click button that requires argument?", "body": "<p>Answer found <a href=\"https://stackoverflow.com/questions/3247391/click-button-or-execute-javascript-function-with-vba\">here</a>.</p>\n\n<p>The click button ran a function. Instead of clicking the button I could instead just run the function like this:</p>\n\n<pre><code>Dim CurrentWindow As HTMLWindowProxy    \nSet CurrentWindow = IE.Document.parentWindow\nCall CurrentWindow.execScript(\"xajax_DoCalReservation('100', '2016-03-02')\")\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1456900598, "creation_date": 1456898477, "last_edit_date": 1456899700, "question_id": 35739623, "link": "https://stackoverflow.com/questions/35739623/vba-ie-click-button-that-requires-argument", "title": "VBA IE click button that requires argument?", "body": "<p><em>I'm using Excel and programming in VBA.</em> </p>\n\n<p>I've located a button that I want to click. However, it seems this button requires an argument.</p>\n\n<p>Using the Console in Chrome, I typed this:</p>\n\n<pre><code>document.getElementById(\"button1\").click\n</code></pre>\n\n<p>That line resolved <code>function click() { [native code] }</code>\nso instead I tried this:</p>\n\n<pre><code>document.getElementById(\"button1\").click ('100', '2016-03-02')\n</code></pre>\n\n<p>And it worked. So, how do I run the same thing from VBA? </p>\n\n<p>I have tried the following:</p>\n\n<pre><code>Sub ClickTheButton()\nDim IE As SHDocVw.InternetExplorer\nDim Doc As MSHTML.HTMLDocument\n\nSet IE = New SHDocVw.InternetExplorer\n\nWith IE\n    .Visible = True\n    .Navigate \"(webpage here)\"\n\n    Do Until Not .Busy And .ReadyState = 4\n        DoEvents\n    Loop\n\n    Set Doc = .Document\n\n    Doc.GetElementByID(\"button1\").Click ' nothing happens when running this\n    Doc.GetElementByID(\"button1\").Click \"('100', '2016-03-02')\" ' not working (can't even attempt to run this)\n    Doc.GetElementByID(\"button1\").Click (\"'100', '2016-03-02'\") ' not working (can't even attempt to run this)\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I can't run the procedure, because of the code after <code>.Click</code> returning <code>Wrong number of arguments or invalid property assignments</code>.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "powerpoint", "powerpoint-2010"], "comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1456912417, "post_id": 35739457, "comment_id": 59160915, "body": "I tweaked your code slightly to use the open ActivePresentation (instead of creating a new one from a template) and the rest of the code works as you intend, at least in my Office 2016 environment. Which version of Office are you using and is it fully up to date with patches?"}, {"owner": {"reputation": 11, "user_id": 6005970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20cfad2fc238135465556801025ab7a?s=128&d=identicon&r=PG&f=1", "display_name": "JJW", "link": "https://stackoverflow.com/users/6005970/jjw"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1457048658, "post_id": 35739457, "comment_id": 59241919, "body": "Thanks JamieG. I got it sorted.  Powerpoint has even more positions that hold headers and footers that aren&#39;t obviously displayed in the object browser (.CustumLayout and .NotePage...).  I also found that the Insert Header/Footer Ribbon selection on the Notes page actually inserts shapes into the .Slide.NotesPage - So have done the conventional .TextRange.Replace on these objects and now have it sorted."}], "owner": {"reputation": 11, "user_id": 6005970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20cfad2fc238135465556801025ab7a?s=128&d=identicon&r=PG&f=1", "display_name": "JJW", "link": "https://stackoverflow.com/users/6005970/jjw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1778, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1456897738, "creation_date": 1456897738, "question_id": 35739457, "link": "https://stackoverflow.com/questions/35739457/vba-powerpoint-2010-replacing-text-in-headers-and-footers", "title": "VBA Powerpoint 2010 replacing text in Headers and Footers", "body": "<p>Having a challenge replacing a [DOCID#] code in the header/footer of a PowerPoint template.  I notice within the PowerPoint object browser that headers and footers are found in a number of parts of a Presentation (SlideMaster, NotesMaster, HandoutMaster, TitleMaster, and then each individual Slide).  I'm running the code from in XL, and have Dim'ed with references to the PowerPoint Library.</p>\n\n<pre><code>   Set ppPres = ppApp.Presentations.Open(sTemplate)\n\n    Set ppMaster = ppPres.SlideMaster\n    With ppMaster.HeadersFooters\n        .Footer.Text = Replace(.Footer.Text, \"[DOCID#]\", sDocID)\n    End With\n    If ppPres.HasNotesMaster Then\n        Set ppMaster = ppPres.NotesMaster\n        With ppMaster.HeadersFooters\n            .Footer.Text = Replace(.Footer.Text, \"[DOCID#]\", sDocID)\n            .Header.Text = Replace(.Header.Text, \"[DOCID#]\", sDocID)\n        End With\n    End If\n    If ppPres.HasHandoutMaster Then\n        Set ppMaster = ppPres.HandoutMaster\n        With ppMaster.HeadersFooters\n            .Footer.Text = Replace(.Footer.Text, \"[DOCID#]\", sDocID)\n            .Header.Text = Replace(.Header.Text, \"[DOCID#]\", sDocID)\n        End With\n    End If\n    If ppPres.HasTitleMaster Then\n        Set ppMaster = ppPres.TitleMaster\n        With ppMaster.HeadersFooters\n            .Footer.Text = Replace(.Footer.Text, \"[DOCID#]\", sDocID)\n        End With\n    End If\n    For Each ppSlide In ppPres.Slides\n        With ppSlide.HeadersFooters\n            .Footer.Text = Replace(.Footer.Text, \"[DOCID#]\", sDocID)\n        End With\n    Next ppSlide\n</code></pre>\n\n<p>The code for the most part runs, however the Handout and Notes Master Headers don't change the text, even though the object in the watch window is correctly adjusted.  When stepping through the code and pausing at the end, I open the Insert Header/Footers from the PowerPoint ribbon, and find the dialogue box fields correctly adjusted, however the Notes still have the [DOCID#] code.</p>\n\n<p>I've also noticed, from a customer supplied template, that a presentation can have .HasTitleMaster return True, but when trying to access the .Footer.Text I get an error (invalid object...)</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5705430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J2jDe.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/5705430/johnd"}, "edited": false, "score": 0, "creation_date": 1457061741, "post_id": 35769436, "comment_id": 59245746, "body": "Dearest @user3598756, thank you kindly! Pardon the poor explanation- should have kept it simple- You have understood correctly!  Why would I get this error when running sub breakout2:  <i>&quot;Run-time error &#39;1004&#39;: We couldn&#39;t do this for the selected range of cells. Select a single cell within a range of data and then try again.&#39;</i>  When I click &#39;Debug&#39; in the VB pop-up, it highlights an issue with:  <code>rangeToScan.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=rngToCopyTo, Unique:=True</code>"}, {"owner": {"reputation": 3, "user_id": 5705430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J2jDe.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/5705430/johnd"}, "edited": false, "score": 0, "creation_date": 1457064564, "post_id": 35769436, "comment_id": 59246500, "body": "Further to my previous comment when I name my worksheet &quot;Sheet1&quot; it errors as per previous comment, but if I rename the sheet as anything else such as &quot;Main&quot; or &quot;Breakout&quot; it throws the error <i>Run-time error &#39;9&#39;: Subscript out of range</i> and stops at <code>Set BaseSht = ThisWorkbook.Sheets(&quot;Main&quot;)</code>. Your assistance is invaluable!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 5705430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J2jDe.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/5705430/johnd"}, "edited": false, "score": 0, "creation_date": 1457073293, "post_id": 35769436, "comment_id": 59249347, "body": "as for the 1004 error: give details about: &quot;rangeToScan&quot;  and &quot;CopyToRange&quot; address property values when you hit the error.   as for the &quot;Sheet1&quot; issue give details about workbook name that contains the Macro, workbook name that contains the &quot;base&quot; sheet, &quot;base&quot; sheet name.   the best would be you uploaded the workbooks involved"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1457000665, "creation_date": 1457000665, "answer_id": 35769436, "question_id": 35739169, "link": "https://stackoverflow.com/questions/35739169/create-dynamically-named-workseet-and-move-entire-rows-based-on-cell-value/35769436#35769436", "title": "Create Dynamically-named Workseet and Move entire rows based on cell value", "body": "<p>I didn't focus on your true goal which I couldn't grasp out of your description</p>\n\n<p>but here's a refactoring of your code that works for creating and/or populating sheets named after what found in unique values in \"base\" sheet (se code to set it properly) column \"A</p>\n\n<pre><code>Option Explicit\n\nSub breakout2()\n\nDim x As Long\nDim rng As Range\nDim SheetNameArray As Variant\nDim CalcSetting As Integer\nDim newsht As Worksheet, BaseSht As Worksheet\n\nWith Application\n    CalcSetting = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\n\nSet BaseSht = ThisWorkbook.Sheets(\"breakout\") '&lt;== choose \"base\" sheet\n'Set BaseSht= Workbooks(1).ActiveSheet '&lt;== this would activate the first workbook opend in current excel session. is it the one you actually want?\n\nWith BaseSht\n    Set rng = .UsedRange\n    SheetNameArray = GetSheetNames(rng, 1, 2)\n\n    For x = LBound(SheetNameArray) To UBound(SheetNameArray)\n        Set newsht = SetSheet(CStr(SheetNameArray(x)))\n\n        rng.AutoFilter Field:=1, Criteria1:=SheetNameArray(x)\n        Intersect(rng, .Cells.SpecialCells(xlCellTypeVisible)).Copy Parent.Sheets(CStr(SheetNameArray(x))).Range(\"A1\")\n        rng.AutoFilter\n    Next x\nEnd With\n\nRange(\"A1\").Select '&lt;=== what for? Selection is rarely a good programming habit. set and use 'range' type variables instead\n\nWith Application\n    .Calculation = CalcSetting\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n\n\nFunction SetSheet(shtName As String) As Worksheet\n\nOn Error Resume Next\nThisWorkbook.Sheets(shtName).Activate\nIf Err &lt;&gt; 0 Then\n    On Error GoTo 0\n    ThisWorkbook.Worksheets.Add\n    ActiveSheet.Name = shtName\nEnd If\nSet SetSheet = ActiveSheet\n\nEnd Function\n\n\nFunction GetSheetNames(usedRng As Range, colWithSheetNames As Long, colShift As Long) As Variant\nDim sht As Worksheet\nDim rangeToScan As Range, rangeWithNames As Range, rngToCopyTo As Range\n\nWith usedRng\n    Set sht = .Parent\n    Set rngToCopyTo = sht.Columns(.Columns(.Columns.Count).column + 2)\nEnd With\n\nWith sht\n    Set rangeToScan = Intersect(usedRng, .Columns(colWithSheetNames))\n    rangeToScan.AdvancedFilter Action:=xlFilterCopy, CopyToRange:=rngToCopyTo, Unique:=True\n    Set rangeWithNames = .Range(rngToCopyTo.Cells(1, 1).Offset(1), .Cells(.Rows.Count, rngToCopyTo.column).End(xlUp))\nEnd With\n\nGetSheetNames = Application.WorksheetFunction.Transpose(rangeWithNames)\nrngToCopyTo.Clear\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5705430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J2jDe.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/5705430/johnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457000665, "creation_date": 1456896424, "question_id": 35739169, "link": "https://stackoverflow.com/questions/35739169/create-dynamically-named-workseet-and-move-entire-rows-based-on-cell-value", "title": "Create Dynamically-named Workseet and Move entire rows based on cell value", "body": "<p>Long-time user of this forum, first request for VBA help. Still consider myself a very beginner in VBA.</p>\n\n<p>I need to make a daily batch file more meaningful by breaking up the rows in a single worksheet- \"Main\" (between 13,000 - 1,000,000 rows) into new worksheets. As this file gets processed daily, my requirement is that we can move rows based on the \"Record Type\" cell in column A.</p>\n\n<p>The \"Record Type\" e.g. \"25\" or \"41\" or \"ZA\" could each have 3 populated columns, whilst Record Type \"26\" could have 30 populated... hence important to have entire row moved.</p>\n\n<p>I am limited in my abilities and knowledge here, and have researched many examples on how to move rows (or a range of cells within a row) but these are limited to static options such as YES/NO, PAID/NOT PAID. </p>\n\n<p>So in summary I need to: \n 1. Create a new worksheet for each distinct record in column A (\"Record Type\" in \"Main\")\n 2. Move entire row from \"Main\" to subsequently created worksheet in row 2. </p>\n\n<p>Here is my attempt that somewhat creates the new worksheets (though I have to disable the error-handling and can't run as a script- have to step-through)</p>\n\n<pre><code>Sub breakout1()\n\nWorkbooks(1).Activate\n\nDim lastCol As Integer\nDim LastRow As Long\nDim x As Long\nDim rng As Range\nDim Rng1 As Range\nDim Rng2 As Range\nDim Rng3 As Range\nDim SheetNameArray\nDim fn As WorksheetFunction\nDim CalcSetting As Integer\nDim newsht As Worksheet\n\nSet fn = Application.WorksheetFunction\n\nWith Application\nCalcSetting = .Calculation\n.Calculation = xlCalculationManual\n.ScreenUpdating = False\nEnd With\n\nWith ActiveSheet\nSet rng = .UsedRange\nSet Rng1 = Intersect(rng, .Range(\"A:A\"))\nlastCol = rng.Column + rng.Columns.Count - 1\n\n.Range(\"A:A\").AdvancedFilter Action:=xlFilterCopy, _\nCopyToRange:=.Cells(1, lastCol + 2), Unique:=True\n\nSet Rng2 = Intersect(.Columns(lastCol + 2).CurrentRegion, _\n.Rows(\"2:\" &amp; Rows.Count))\n\nReDim SheetNameArray(1 To Rng2.Cells.Count)\nSheetNameArray = fn.Transpose(Rng2)\n.Columns(lastCol + 2).Clear\n\nFor x = LBound(SheetNameArray) To UBound(SheetNameArray)\n    On Error Resume Next\n    Set newsht = ThisWorkbook.Sheets(CStr(SheetNameArray(x)))\n        If Err &lt;&gt; 0 Then\n            Worksheets.Add\n            ActiveSheet.Name = CStr(SheetNameArray(x))\n            Err.Clear\n        End If\n    'On Error GoTo 0\n      'rng.AutoFilter Field:=1, Criteria1:=SheetNameArray(x)\n      'Set Rng3 = Intersect(rng, .Cells.SpecialCells(xlCellTypeVisible))\n      'Rng3.Copy Workbooks(1).Sheets(CStr(SheetNameArray(x))).Range(\"A1\")\n      'rng.AutoFilter\n Next x\nEnd With\nRange(\"A1\").Select\nApplication.Calculation = CalcSetting\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "rows", "hidden"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "edited": false, "score": 0, "creation_date": 1456898356, "post_id": 35739218, "comment_id": 59152913, "body": "as the range A: I remove spaces from all cells through VBA?"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "edited": false, "score": 0, "creation_date": 1456898968, "post_id": 35739218, "comment_id": 59153173, "body": "@Grz3siu did my answer solve your original question? If so, please mark the answer as accepted."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "edited": false, "score": 0, "creation_date": 1456899036, "post_id": 35739218, "comment_id": 59153217, "body": "@Grz3siu For the removal of spaces, look into using the .Replace method. I&#39;m on my phone so I can&#39;t post code now but I can look into it tomorrow."}, {"owner": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "edited": false, "score": 0, "creation_date": 1456899036, "post_id": 35739218, "comment_id": 59153218, "body": "Your answer solves the problem :) done"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "edited": false, "score": 0, "creation_date": 1456931677, "post_id": 35739218, "comment_id": 59175451, "body": "@Grz3siu For the space removal, try <code>Range(&quot;A:I&quot;).Replace(&quot; &quot;, vbNullString)</code>"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 0, "last_activity_date": 1456896701, "creation_date": 1456896701, "answer_id": 35739218, "question_id": 35739158, "link": "https://stackoverflow.com/questions/35739158/hidde-all-rows-with-value-n-d-vba-excel-microsoft/35739218#35739218", "title": "hidde all rows with value n/d vba excel microsoft", "body": "<p>I can't see column names in your screenshot, so the below example assumes Loc is column D.</p>\n\n<p>In your code that executes when clicking the green button, add this line to hide all cells with errors:</p>\n\n<pre><code>Range(\"D:D\").SpecialCells(xlCellTypeFormulas, xlErrors).EntireRow.Hidden = True\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1457699241, "accepted_answer_id": 35739218, "answer_count": 1, "score": -2, "last_activity_date": 1456899412, "creation_date": 1456896378, "last_edit_date": 1456899412, "question_id": 35739158, "link": "https://stackoverflow.com/questions/35739158/hidde-all-rows-with-value-n-d-vba-excel-microsoft", "closed_reason": "Needs details or clarity", "title": "hidde all rows with value n/d vba excel microsoft", "body": "<p>if you push the green button, All rows with a value in the column Loc #N/d will be hidden</p>\n\n<p><a href=\"https://i.stack.imgur.com/DIvfe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DIvfe.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456895506, "post_id": 35738872, "comment_id": 59151758, "body": "Go watch the video on the <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">VLOOKUP function</a>."}], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 4361060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe000a9cbdbcc0b89709f655c9aa947?s=128&d=identicon&r=PG&f=1", "display_name": "sjaak", "link": "https://stackoverflow.com/users/4361060/sjaak"}, "edited": false, "score": 0, "creation_date": 1456896236, "post_id": 35738971, "comment_id": 59152044, "body": "Thanks Nick,  This works but only on a per cell basis. I have over 10.000 entries in sheet1 that need to be compared against a list of about 600 entries in sheet2.  I tried changing the range from A1 to A:A but unfortunately its not that simply."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 415, "user_id": 4361060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe000a9cbdbcc0b89709f655c9aa947?s=128&d=identicon&r=PG&f=1", "display_name": "sjaak", "link": "https://stackoverflow.com/users/4361060/sjaak"}, "edited": false, "score": 0, "creation_date": 1456896362, "post_id": 35738971, "comment_id": 59152099, "body": "@sjaak could you not extend the formula from E1 to E1:E10000? If you are trying to minimize the load on Excel, you can also specify the exact ranges in the Index/Match formulas (i.e. <code>INDEX(Sheet2!B1:B600</code>)."}, {"owner": {"reputation": 415, "user_id": 4361060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe000a9cbdbcc0b89709f655c9aa947?s=128&d=identicon&r=PG&f=1", "display_name": "sjaak", "link": "https://stackoverflow.com/users/4361060/sjaak"}, "edited": false, "score": 0, "creation_date": 1456896895, "post_id": 35738971, "comment_id": 59152277, "body": "I think I messed up, tried again after changing A1 to A:A and properly selecting the whole E column and it appears to be working now.   Thanks a million :)"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 415, "user_id": 4361060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe000a9cbdbcc0b89709f655c9aa947?s=128&d=identicon&r=PG&f=1", "display_name": "sjaak", "link": "https://stackoverflow.com/users/4361060/sjaak"}, "edited": false, "score": 0, "creation_date": 1456896978, "post_id": 35738971, "comment_id": 59152311, "body": "@sjaak Ah, stellar! Glad to help :)"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 0, "last_activity_date": 1456895366, "creation_date": 1456895366, "answer_id": 35738971, "question_id": 35738872, "link": "https://stackoverflow.com/questions/35738872/excel-compare-value-of-columns-on-sheet-1-and-2-and-on-match-copy-data-from-diff/35738971#35738971", "title": "Excel compare value of columns on sheet 1 and 2 and on match copy data from different column", "body": "<p><strong>Assumptions</strong></p>\n\n<ul>\n<li>Your data begins in cell A1 of Sheet1</li>\n<li>Column E is the first column with blank data in Sheet1; that is, we will want the data from column B of Sheet2 to end up in column E of Sheet1.</li>\n</ul>\n\n<p><strong>Solution</strong></p>\n\n<p>Enter the following formula in cell E1 of Sheet1: <code>=IFERROR(INDEX(Sheet2!B:B,MATCH(A1,Sheet2!A:A,0)),\"No Match\")</code></p>\n\n<p>Enter the following formula in cell F1 of Sheet1: <code>=IFERROR(INDEX(Sheet2!C:C,MATCH(A1,Sheet2!A:A,0)),\"No Match\")</code></p>\n\n<p>These formulas will return the data from columns B and C of Sheet2 when column A of Sheet1 matches column A of Sheet2.</p>\n"}], "owner": {"reputation": 415, "user_id": 4361060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe000a9cbdbcc0b89709f655c9aa947?s=128&d=identicon&r=PG&f=1", "display_name": "sjaak", "link": "https://stackoverflow.com/users/4361060/sjaak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 35738971, "answer_count": 1, "score": 1, "last_activity_date": 1456895366, "creation_date": 1456894912, "question_id": 35738872, "link": "https://stackoverflow.com/questions/35738872/excel-compare-value-of-columns-on-sheet-1-and-2-and-on-match-copy-data-from-diff", "title": "Excel compare value of columns on sheet 1 and 2 and on match copy data from different column", "body": "<p>What I want to do sounds very simply but I'm having a hard time pulling it off.</p>\n\n<p>On sheet 1 I have a bunch of IP addresses in column A and some other data like ports, packets size etc in column B, C, D etc. A lot of IP addresses are duplicates but with different packet and port values.</p>\n\n<p>On sheet 2 I have the domain data for the IP addresses.</p>\n\n<p>Column A contains IP addresses, Column B and C the domain data.</p>\n\n<p>What I want to do is compare the IP addresses on Sheet 1 and 2 and if they match I want sheet 2 column B and C to be copied to a empty cell on sheet 1 matching that IP.</p>\n\n<p>In short I want all the domain data from sheet 2 copied to the row on sheet 1 with the matching IP.</p>\n\n<p>Save me! :D</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456890425, "post_id": 35738121, "comment_id": 59150232, "body": "check your column U for cells that have errors."}, {"owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1456890551, "post_id": 35738121, "comment_id": 59150264, "body": "Already checked, and checked format of cells aswel"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 2, "creation_date": 1456891127, "post_id": 35738121, "comment_id": 59150421, "body": "What is the value or r when the error is thrown? What is the value in that cell at the time?"}, {"owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "reply_to_user": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 0, "creation_date": 1456893836, "post_id": 35738121, "comment_id": 59151227, "body": "@NickPeranzi there was a value all the way down on row 376 this didn&#39;t match my vlookup. thanks"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 0, "creation_date": 1456893931, "post_id": 35738121, "comment_id": 59151248, "body": "Excellent, glad to help!"}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1456891026, "last_edit_date": 1456891026, "creation_date": 1456890701, "answer_id": 35738178, "question_id": 35738121, "link": "https://stackoverflow.com/questions/35738121/excel-vba-working-code-suddenly-has-type-mismatch-error-today/35738178#35738178", "title": "Excel VBA working code suddenly has &quot;type mismatch&quot; error today", "body": "<p>Is this missing an \"e\" on the end of the sheet name?</p>\n\n<pre><code>Set Sh1 = ThisWorkbook.Worksheets(\"Members to cut &amp; past\")\n</code></pre>\n\n<p>Seems so being that the first time you try and use the sheet is when it errors</p>\n\n<p>Edit: My bad, you are using it here without error:</p>\n\n<pre><code>lr = Sh1.Cells(Rows.Count, \"B\").End(xlUp).Row\n</code></pre>\n\n<p>Your code works for me, possible dead reference? check for \"missing\" in tools / references in the VBE.</p>\n"}, {"comments": [{"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1456892191, "post_id": 35738293, "comment_id": 59150740, "body": "Thanks @DanDonoghue - I was confused with an issue I experienced recently with other variable types throwing an error when attempting to load blank values. I removed the point about it being empty; regardless, I still believe OP&#39;s issue will be solved through my answer."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1456892390, "post_id": 35738293, "comment_id": 59150816, "body": "Be keen to find out what the issue actually is, at least your error logging will show the row for analysis :). Side note, awesome solution on MultipleRadarCharts ;)"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1456892516, "post_id": 35738293, "comment_id": 59150854, "body": "Agreed - I was unable to replicate OP&#39;s issue in my testing except by storing an error value in the cell, which OP believes is not the case. Thanks for the kudos :)"}, {"owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "edited": false, "score": 0, "creation_date": 1456894040, "post_id": 35738293, "comment_id": 59151281, "body": "SOLVED thanks @NickPeranzi my vlookup in column &quot;U&quot; row 376 didnt match the requirements and was returning NA. My original code is now working. Do you advise that I still amend my code with the changes you provided?"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "edited": false, "score": 0, "creation_date": 1456894171, "post_id": 35738293, "comment_id": 59151319, "body": "@BradleyJones Short answer: yes. Long answer: personally, I prefer to handle errors cleanly and display more informative error messages than the debug messages provided by VBA execution errors. Many other VBA devs feel the same, but if you are the only user and/or prefer to have the default error messages, you can leave it."}, {"owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "edited": false, "score": 0, "creation_date": 1456894660, "post_id": 35738293, "comment_id": 59151468, "body": "Will start using it then. Thank you"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 0, "last_activity_date": 1456892114, "last_edit_date": 1456892114, "creation_date": 1456891414, "answer_id": 35738293, "question_id": 35738121, "link": "https://stackoverflow.com/questions/35738121/excel-vba-working-code-suddenly-has-type-mismatch-error-today/35738293#35738293", "title": "Excel VBA working code suddenly has &quot;type mismatch&quot; error today", "body": "<p>My guess is that the cell has an error within its value or contains a non-string. The below code should eliminate your error:</p>\n\n<pre><code>Sub ADULTClearAndPaste()\n\nDim lr As Long, lr2 As Long, r As Long\nDim Sh1 as Worksheet, Sh2 as Worksheet\nDim StrVal as String\nDim Program as Integer, ATP as Integer, FIFO as Integer, LastName as Integer, FirstName as Integer\nSet Sh1 = ThisWorkbook.Worksheets(\"Members to cut &amp; past\")\nSet Sh2 = ThisWorkbook.Worksheets(\"ADULT Sign On Sheet\")\n\nProgram = 9\nATP = 10\nFIFO = 7\nLastName = 2\nFirstName = 3\n\nFor Each cell In Sh2.Range(\"B1:F756\")\n    If cell.Interior.Color = Excel.XlRgbColor.rgbWhite Then\n       cell.ClearContents\n    End If\nNext\n\n\nlr = Sh1.Cells(Rows.Count, \"B\").End(xlUp).Row\nW = 7\nFor r = 2 To lr\n\n    On Error Resume Next\n    StrVal = vbNullString\n    StrVal = Sh1.Range(\"U\" &amp; r).Value\n    On Error GoTo 0 'Or implement proper error handling\n    If StrVal = \"White\" Then \n        Sh2.Cells(W, 2).Value = Sh1.Cells(r, Program).Value\n        Sh2.Cells(W, 3).Value = Sh1.Cells(r, ATP).Value\n        Sh2.Cells(W, 4).Value = Sh1.Cells(r, FIFO).Value\n        Sh2.Cells(W, 5).Value = Sh1.Cells(r, LastName).Value\n        Sh2.Cells(W, 6).Value = Sh1.Cells(r, FirstName).Value\n        W = W + 1\n    End If\n\nNext r\n\nEnd Sub\n</code></pre>\n\n<p>The above code should eliminate your error but will not address the root cause of your issue. The below code will not only eliminate your error but will also display a message box with any error rows.</p>\n\n<pre><code>Sub ADULTClearAndPaste()\n\nDim lr As Long, lr2 As Long, r As Long\nDim Sh1 as Worksheet, Sh2 as Worksheet\nDim StrVal as String, StrOutput as String\nDim Program as Integer, ATP as Integer, FIFO as Integer, LastName as Integer, FirstName as Integer\nSet Sh1 = ThisWorkbook.Worksheets(\"Members to cut &amp; past\")\nSet Sh2 = ThisWorkbook.Worksheets(\"ADULT Sign On Sheet\")\n\nProgram = 9\nATP = 10\nFIFO = 7\nLastName = 2\nFirstName = 3\n\nFor Each cell In Sh2.Range(\"B1:F756\")\n    If cell.Interior.Color = Excel.XlRgbColor.rgbWhite Then\n       cell.ClearContents\n    End If\nNext\n\n\nlr = Sh1.Cells(Rows.Count, \"B\").End(xlUp).Row\nW = 7\nFor r = 2 To lr\n\n    On Error Resume Next\n    If IsError(Sh1.Range(\"U\" &amp; r).Value) Then\n        'There is an error with the value. Log it for output.\n        If StrOutput = vbNullString Then \n            StrOutput = \"Errors encountered with the following rows: \" &amp; r\n        Else\n            StrOutput = StrOutput &amp; \", \" &amp; r\n        End If\n    Else\n        'Execute your code\n        StrVal = vbNullString\n        StrVal = Sh1.Range(\"U\" &amp; r).Value\n        On Error GoTo 0 'Or implement proper error handling\n        If StrVal = \"White\" Then \n            Sh2.Cells(W, 2).Value = Sh1.Cells(r, Program).Value\n            Sh2.Cells(W, 3).Value = Sh1.Cells(r, ATP).Value\n            Sh2.Cells(W, 4).Value = Sh1.Cells(r, FIFO).Value\n            Sh2.Cells(W, 5).Value = Sh1.Cells(r, LastName).Value\n            Sh2.Cells(W, 6).Value = Sh1.Cells(r, FirstName).Value\n            W = W + 1\n        End If\n    End If\n\nNext r\n\n'Display success or error message\nIf StrOutput &lt;&gt; vbNullString Then\n    MsgBox StrOutput, vbCritical\nElse\n    MsgBox \"Done!\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 35738293, "answer_count": 2, "score": 1, "last_activity_date": 1459509625, "creation_date": 1456890332, "last_edit_date": 1459509625, "question_id": 35738121, "link": "https://stackoverflow.com/questions/35738121/excel-vba-working-code-suddenly-has-type-mismatch-error-today", "title": "Excel VBA working code suddenly has &quot;type mismatch&quot; error today", "body": "<p>The below code has been running perfectly for 6 months now and has not been altered (to my knowledge). Today i run the code and get Run-time error 13 Type Mismatch. The line of code which gets the error is pointed out by \n(TYPE MISMATCH --------> )\nPlease help.</p>\n\n<pre><code>Sub ADULTClearAndPaste()\n\nDim lr As Long, lr2 As Long, r As Long\nSet Sh1 = ThisWorkbook.Worksheets(\"Members to cut &amp; past\")\nSet Sh2 = ThisWorkbook.Worksheets(\"ADULT Sign On Sheet\")\n\nProgram = 9\nATP = 10\nFIFO = 7\nLastName = 2\nFirstName = 3\nSh2.Select\nFor Each cell In Sh2.Range(\"B1:F756\")\nIf cell.Interior.Color = Excel.XlRgbColor.rgbWhite Then\n   cell.ClearContents\nEnd If\n    Next\n\n\nlr = Sh1.Cells(Rows.Count, \"B\").End(xlUp).Row\nW = 7\nFor r = 2 To lr\n\nTYPE MISMATCH --------&gt;  If Sh1.Range(\"U\" &amp; r).Value = \"White\" Then \n    Sh2.Cells(W, 2).Value = Sh1.Cells(r, Program).Value\n    Sh2.Cells(W, 3).Value = Sh1.Cells(r, ATP).Value\n    Sh2.Cells(W, 4).Value = Sh1.Cells(r, FIFO).Value\n    Sh2.Cells(W, 5).Value = Sh1.Cells(r, LastName).Value\n    Sh2.Cells(W, 6).Value = Sh1.Cells(r, FirstName).Value\n    W = W + 1\nEnd If\n\nNext r\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "range"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6005661, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156552908775632/picture?type=large", "display_name": "Marco", "link": "https://stackoverflow.com/users/6005661/marco"}, "edited": false, "score": 0, "creation_date": 1456936899, "post_id": 35738216, "comment_id": 59179524, "body": "Thank you Nick! I have just used your code. However, so far I still have some problems with it. Originally, your code with the Rng.Offset takes big ranges of data to make the Radar Charts. For instance: From (A1:E1):(A2:E2) (this first is fine), but then it goes: (A1:E1):(A3:E3), (A1:E1):(A4:E4), (A1:E1):(A5:E5), and so on... Instead I am trying to select just one additional row each time, thus: (A1:E1)+(A3:E3), (A1:E1)+(A4:E4), (A1:E1)+(A5:E5)"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 19, "user_id": 6005661, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156552908775632/picture?type=large", "display_name": "Marco", "link": "https://stackoverflow.com/users/6005661/marco"}, "edited": false, "score": 0, "creation_date": 1456937189, "post_id": 35738216, "comment_id": 59179748, "body": "@Marco - just edited with an answer that should provide non-contiguous ranges."}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": false, "score": 1, "last_activity_date": 1456937124, "last_edit_date": 1456937124, "creation_date": 1456890935, "answer_id": 35738216, "question_id": 35737990, "link": "https://stackoverflow.com/questions/35737990/update-loop-through-several-ranges/35738216#35738216", "title": "Update: Loop through several ranges?", "body": "<p>Try the below code:</p>\n\n<pre><code>Sub MultipleRadarCharts()\n\nDim i As Integer\nDim Cht As Chart\nDim Rng As Range\n\nSet Rng = Sheets(\"Indices4Pilares (3)\").Range(\"A1:E1\")\n\nFor i = 2 To 36\n    Set Cht = ActiveSheet.Shapes.AddChart\n    Cht.ChartType = xlRadarMarkers\n    'Cht.SetSourceData Source:=Sheets(\"Indices4Pilares (3)\").Range(Rng, Rng.Offset(0, i - 1)) 'Old solution\n    Cht.SetSourceData Source:=Sheets(\"Indices4Pilares (3)\").Range(\"\"Rng.Address &amp; \",\" &amp; Rng.Offset(0, i - 1).Address\"\") 'New solution\n    Cht.Legend.Delete\n    Set Cht = Nothing\nNext i\n\nSet Rng = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6005661, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156552908775632/picture?type=large", "display_name": "Marco", "link": "https://stackoverflow.com/users/6005661/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456937329, "creation_date": 1456889517, "last_edit_date": 1456937329, "question_id": 35737990, "link": "https://stackoverflow.com/questions/35737990/update-loop-through-several-ranges", "title": "Update: Loop through several ranges?", "body": "<p>UPDATE: I slightly modified the code suggested by Nick. Originally, this code with the Rng.Offset took big ranges of data to make the Radar Charts. For instance: From (A1:E1):(A2:E2) (this first is fine), but then it went: (A1:E1):(A3:E3), (A1:E1):(A4:E4), (A1:E1):(A5:E5), and so on... Instead I am trying to select just one additional row each time, thus: (A1:E1)+(A3:E3), (A1:E1)+(A4:E4), (A1:E1)+(A5:E5).</p>\n\n<pre><code>Sub MultipleRadarCharts()\n\nDim i As Integer\nDim Rng As Range\n\nSet Rng = Sheets(\"Indices4Pilares (4)\").Range(\"A1:E1\")\n\nFor i = 2 To 36\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlRadarMarkers\n   'ActiveChart.SetSourceData Source:=Sheets(\"Indices4Pilares (4)\").Range(Rng, Rng.Offset(i - 1, 0))\n   'ActiveChart.SetSourceData Source:=Sheets(\"Indices4Pilares (4)\").Range(Rng, Range(Cells(i, 1), Cells(i, 5)))\n    ActiveChart.SetSourceData Source:=Sheets(\"Indices4Pilares (4)\").Union(Range(Cells(1, 1), Cells(1, 5)), Range(Cells(i, 1), Cells(i, 5))).Select\n    ActiveChart.Legend.Delete\nNext i\nSet Rng = Nothing\nEnd Sub\n</code></pre>\n\n<p>=====</p>\n\n<p>:) I've just created this code in order to get radar charts from an Excel table. </p>\n\n<p>The first row has the name of the variables, and then (from the 2nd to the 36th row) there are values. The issue is that I am stuck trying to simplify the code with a \"for loop\", but I cannot make it work :(</p>\n\n<p>This is the raw code I want to simplify...</p>\n\n<pre><code>Sub Macro2()\n\nRange(\"A1:E1,A2:E2\").Select\nRange(\"A2\").Activate\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlRadarMarkers\nActiveChart.SetSourceData Source:=Range( _\n    \"'Indices4Pilares (3)'!$A$1:$E$1,'Indices4Pilares (3)'!$A$2:$E$2\")\nActiveChart.Legend.Select\nSelection.Delete\n\nRange(\"A1:E1,A3:E3\").Select\nRange(\"A3\").Activate\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlRadarMarkers\nActiveChart.SetSourceData Source:=Range( _\n    \"'Indices4Pilares (3)'!$A$1:$E$1,'Indices4Pilares (3)'!$A$3:$E$3\")\nActiveChart.Legend.Select\nSelection.Delete\n\nRange(\"A1:E1,A4:E4\").Select\nRange(\"A4\").Activate\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlRadarMarkers\nActiveChart.SetSourceData Source:=Range( _\n    \"'Indices4Pilares (3)'!$A$1:$E$1,'Indices4Pilares (3)'!$A$4:$E$4\")\nActiveChart.Legend.Select\nSelection.Delete\n\nRange(\"A1:E1,A5:E5\").Select\nRange(\"A5\").Activate\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlRadarMarkers\nActiveChart.SetSourceData Source:=Range( _\n    \"'Indices4Pilares (3)'!$A$1:$E$1,'Indices4Pilares (3)'!$A$5:$E$5\")\nActiveChart.Legend.Select\nSelection.Delete\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2470, "user_id": 5832518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cKPiUtKxJvw/AAAAAAAAAAI/AAAAAAAAAmQ/egOpZRu_8Bk/photo.jpg?sz=128", "display_name": "Raju", "link": "https://stackoverflow.com/users/5832518/raju"}, "is_accepted": false, "score": 1, "last_activity_date": 1456888324, "last_edit_date": 1456888324, "creation_date": 1456887947, "answer_id": 35737735, "question_id": 35737282, "link": "https://stackoverflow.com/questions/35737282/vba-to-create-formula-based-on-another-variable/35737735#35737735", "title": "VBA to create formula based on another variable", "body": "<p><code>SUMIF</code> is wrong in this context.</p>\n\n<pre><code>Range(\"a8\").Formula = \"=SUMIF(countif(\" &amp; rCell.Address &amp; \",VAC\" &amp; \"))\"\n</code></pre>\n\n<p>you should use <code>SUMIF</code> like this</p>\n\n<pre><code>Range(\"a8\").Formula =SUMIF(B2:B25,\"&gt;5\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 1, "creation_date": 1456893570, "post_id": 35738613, "comment_id": 59151161, "body": "alternative for Chr(34) is double quote (&quot;&quot;). it&#39;d be like <code>&quot;=sum(countif(&quot; &amp; [a1].Address &amp; &quot;, &quot;&quot;VAC&quot;&quot;))&quot; </code>"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1456893869, "post_id": 35738613, "comment_id": 59151233, "body": "Ah, thank you! Much appreciated @KSSheon; I&#39;ve updated my answer with the more compact code."}, {"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1456946616, "post_id": 35738613, "comment_id": 59185826, "body": "Thank You so much Nick. It is working how it is supposed to be. Sorry for the late reply."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1456946764, "post_id": 35738613, "comment_id": 59185911, "body": "@user3323922 Awesome, glad it helped!"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 3, "last_activity_date": 1456893829, "last_edit_date": 1456893829, "creation_date": 1456893423, "answer_id": 35738613, "question_id": 35737282, "link": "https://stackoverflow.com/questions/35737282/vba-to-create-formula-based-on-another-variable/35738613#35738613", "title": "VBA to create formula based on another variable", "body": "<p>I am assuming that your error appears on this line of code: <code>Range(\"a8\").Formula = \"=SUMIF(countif(\" &amp; rCell.Address &amp; \",VAC\" &amp; \"))\"</code>. </p>\n\n<p>You should change that line to</p>\n\n<pre><code>Range(\"a8\").Formula = \"=SUM(COUNTIF(\" &amp; rCell.Address &amp; \",\" &amp; Chr(34) &amp; \"Vac\" &amp; Chr(34) &amp; \")+ COUNTIF(\" &amp; rCell.Address &amp; \",\" &amp; Chr(34) &amp; \"LWOP\" &amp; Chr(34) &amp; \")+COUNTIF(\" &amp; rCell.Offset(0, 13).Address &amp; \",\" &amp; Chr(34) &amp; \"Vac\" &amp; Chr(34) &amp; \")+ COUNTIF(\" &amp; rCell.Offset(0, 13).Address &amp; \",\" &amp; Chr(34) &amp; \"LWOP\" &amp; Chr(34) &amp; \"))\"\n</code></pre>\n\n<p><strong>Updated with better answer thanks to KS Sheon</strong></p>\n\n<pre><code>Range(\"a8\").Formula = \"=SUM(COUNTIF(\" &amp; rCell.Address &amp; \",\"\"Vac\"\")+ COUNTIF(\" &amp; rCell.Address &amp; \",\"\"LWOP\"\")+COUNTIF(\" &amp; rCell.Offset(0, 13).Address &amp; \",\"\"Vac\"\")+ COUNTIF(\" &amp; rCell.Offset(0, 13).Address &amp; \",\"\"LWOP\"\"))\"\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 35738613, "answer_count": 2, "score": 3, "last_activity_date": 1457018860, "creation_date": 1456885440, "last_edit_date": 1457018860, "question_id": 35737282, "link": "https://stackoverflow.com/questions/35737282/vba-to-create-formula-based-on-another-variable", "title": "VBA to create formula based on another variable", "body": "<p>I am trying to create the formula below using vba in excel</p>\n\n<pre><code>=SUM(COUNTIF(E7,\"Vac\")+ COUNTIF(E7,\"LWOP\")+COUNTIF(R7,\"Vac\")+ COUNTIF(R7,\"LWOP\"))\n</code></pre>\n\n<p>But E7 and R7 will change based on another variable called <code>rCell.address</code></p>\n\n<p>Below is the code that I have within the macro and it is giving an error: </p>\n\n<pre><code>Range(\"a8\").Formula = \"=SUMIF(countif(\" &amp; rCell.Address &amp; \", \"VAC\"\" &amp; \"))\"\n</code></pre>\n\n<p>The current macro is:</p>\n\n<pre><code>Sub Find()\n\nDim strdate As String\nDim rCell As Range\nDim lReply As Long\n\nWith Worksheets(\"Sheet1\")\nstrdate = .Range(\"a1\").Value\nEnd With\n\nIf strdate = \"False\" Then Exit Sub\nstrdate = Format(strdate, \"Short Date\")\n\nOn Error Resume Next\n\n    Set rCell = Cells.Find(What:=CDate(strdate), After:=Range(\"A1\"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n\nOn Error GoTo 0\n\nIf rCell Is Nothing Then\n    lReply = MsgBox(\"Date cannot be found. Try Again\", vbYesNo)\n    If lReply = vbYes Then Run \"FindDate\":\nEnd If\n\nRange(\"a8\").Formula = \"=SUMIF(countif(\" &amp; rCell.Address &amp; \",VAC\" &amp; \"))\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 15, "user_id": 5588088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f9871ec27dbfc7b47f48291dc82b875?s=128&d=identicon&r=PG&f=1", "display_name": "killrb13", "link": "https://stackoverflow.com/users/5588088/killrb13"}, "edited": false, "score": 0, "creation_date": 1456887751, "post_id": 35737548, "comment_id": 59149521, "body": "Excellent, glad to help!"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 0, "last_activity_date": 1456886913, "creation_date": 1456886913, "answer_id": 35737548, "question_id": 35737275, "link": "https://stackoverflow.com/questions/35737275/saving-excel-sheet-as-tab-delimited-text-file-without-automatic-double-quote-del/35737548#35737548", "title": "Saving Excel sheet as tab-delimited text file without automatic double quote delimiters", "body": "<p>Your best bet here will be to write the data to a text file using VBA instead of saving the workbook as a text file.</p>\n\n<p>Consider the below modified code:</p>\n\n<pre><code>Option Explicit\nPublic StopLoop As Boolean\nSub GetHtmlTable()\nStopLoop = False\nDo Until StopLoop = True\n    DoEvents\n    Dim objWeb As QueryTable\n\n    Sheets(1).Columns(1).ClearContents\n\n    With Sheets(\"Sheet1\")\n        Set objWeb = .QueryTables.Add( _\n        Connection:=\"URL;http://www.spotternetwork.org/feeds/gr.txt\", _\n        Destination:=.Range(\"A1\"))\n        With objWeb\n            .WebSelectionType = xlSpecifiedTables\n            .WebTables = \"1\" ' Identify your HTML Table here\n            .Refresh BackgroundQuery:=False\n            .SaveData = True\n        End With\n    End With\n    Set objWeb = Nothing\n\n\n    'End Import of Text From http://www.spotternetwork.org/feeds/gr.txt==================\n    'Start Filter Out Unused Data========================================================\n    Dim i As Long\n    Dim j As Long\n    Dim LRow As Long\n    Dim LListRow As Long\n    Dim BMatch As Boolean\n\n    'Find last instance of \"End:\" in\n    LRow = Sheets(1).Range(\"A:A\").Find(what:=\"End*\", searchdirection:=xlPrevious).Row\n    'Find last non-blank row in column A of second sheet\n    LListRow = Sheets(2).Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    If LRow &gt;= 11 Then\n        'Make sure there are at least 11 rows of data\n        i = LRow\n        'MsgBox \"First checkpoint: Last row of data is \" &amp; LRow 'Comment out this line\n        Do\n            BMatch = False\n            For j = 1 To LListRow\n                'Test this block to see if the value from j appears in the second row of data\n                If InStr(1, Sheets(1).Range(\"A\" &amp; i - 2).Value2, Sheets(2).Range(\"A\" &amp; j).Value2) &gt; 0 Then\n                    BMatch = True\n                    Exit For\n                End If\n            Next j\n            'Application.StatusBar = \"Match status for row \" &amp; i &amp; \": \" &amp; BMatch\n            If Not BMatch Then\n                'Loop backwards to find the starting row (no lower than 11)\n                For j = i To 11 Step -1\n                    If Sheets(1).Range(\"A\" &amp; j).Value2 Like \"Object:*\" Then Exit For\n                Next j\n                Sheets(1).Rows(j &amp; \":\" &amp; i).Delete\n                i = j - 1\n            Else\n                'Find next block\n                If i &gt; 11 Then\n                    For j = i - 1 To 11 Step -1\n                        If Sheets(1).Range(\"A\" &amp; j).Value2 Like \"End:*\" Then Exit For\n                    Next j\n                    i = j\n                Else\n                    i = 10 'Force the loop to exit\n                End If\n            End If\n            'Application.StatusBar = \"Moving to row \" &amp; i\n        Loop Until i &lt; 11\n\n        'Loop back through and delete any blank rows\n        LRow = Sheets(1).Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n        'MsgBox \"Second checkpoint: new last row of data is \" &amp; LRow\n        For i = LRow To 11 Step -1\n            If Sheets(1).Range(\"A\" &amp; i).Value2 = vbNullString Then Sheets(1).Rows(i).Delete\n        Next i\n    End If\n\n    'Application.StatusBar = False\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\n    'End Filter Out Unused Data========================================================\n    'Start Write To Local Txt File=====================================================\n    Dim sSaveAsFilePath As String\n    Application.DisplayAlerts = False\n\n\n    sSaveAsFilePath = \"C:\\Users\\Speedy\\Desktop\\Test\\test.txt\"\n\n    'Delete file if it exists\n    On Error Resume Next\n    Kill sSaveAsFilePath\n    On Error GoTo 0\n\n    'Open file for writing\n    LRow = Sheets(1).Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n    Dim iFile As Integer\n    iFile = FreeFile()\n    Open sSaveAsFilePath For Output As #iFile\n    For i = 1 To LRow\n        Print #iFile, Sheets(1).Range(\"A\" &amp; i).Value2\n    Next i\n\n    Close #iFile\n    Application.DisplayAlerts = True\n    Application.Wait (Now + TimeValue(\"0:00:05\")) 'Uncomment this line\nLoop\nEnd Sub\n\nSub KillMacro()\n  StopLoop = True ' stop that perpetual loop in Workbook_Open()\n  MsgBox \"Program Stopped\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5588088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f9871ec27dbfc7b47f48291dc82b875?s=128&d=identicon&r=PG&f=1", "display_name": "killrb13", "link": "https://stackoverflow.com/users/5588088/killrb13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 35737548, "answer_count": 1, "score": 1, "last_activity_date": 1456892270, "creation_date": 1456885409, "last_edit_date": 1456892270, "question_id": 35737275, "link": "https://stackoverflow.com/questions/35737275/saving-excel-sheet-as-tab-delimited-text-file-without-automatic-double-quote-del", "title": "Saving Excel sheet as tab-delimited text file without automatic double quote delimiters", "body": "<p>I am writing a macro to download a text file into Excel, filter out unnecessary data and save the modified text file locally. </p>\n\n<p>Everything works but the file that is written locally has quotes (\") around certain text. I assume this has something to do with the commas being seen as delimiters, possibly. Is this the case, and if so is there a work around with my code below? </p>\n\n<p>Note: I have a button that runs the GetHtmlTable and KillLoop procedures.</p>\n\n<pre><code>Option Explicit\nPublic StopLoop As Boolean\nSub GetHtmlTable()\nStopLoop = False\nDo Until StopLoop = True\nDoEvents\n    Dim objWeb As QueryTable\n\n    Sheets(1).Columns(1).ClearContents\n\n    With Sheets(\"Sheet1\")\n        Set objWeb = .QueryTables.Add( _\n        Connection:=\"URL;http://www.spotternetwork.org/feeds/gr.txt\", _\n        Destination:=.Range(\"A1\"))\n        With objWeb\n            .WebSelectionType = xlSpecifiedTables\n            .WebTables = \"1\" ' Identify your HTML Table here\n            .Refresh BackgroundQuery:=False\n            .SaveData = True\n        End With\n    End With\n    Set objWeb = Nothing\n\n\n'End Import of Text From http://www.spotternetwork.org/feeds/gr.txt==================\n'Start Filter Out Unused Data========================================================\nDim i As Long\nDim j As Long\nDim LRow As Long\nDim LListRow As Long\nDim BMatch As Boolean\n\n'Find last instance of \"End:\" in\nLRow = Sheets(1).Range(\"A:A\").Find(what:=\"End*\", searchdirection:=xlPrevious).Row\n'Find last non-blank row in column A of second sheet\nLListRow = Sheets(2).Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nIf LRow &gt;= 11 Then\n    'Make sure there are at least 11 rows of data\n    i = LRow\n    'MsgBox \"First checkpoint: Last row of data is \" &amp; LRow 'Comment out this line\n    Do\n        BMatch = False\n        For j = 1 To LListRow\n            'Test this block to see if the value from j appears in the second row of data\n            If InStr(1, Sheets(1).Range(\"A\" &amp; i - 2).Value2, Sheets(2).Range(\"A\" &amp; j).Value2) &gt; 0 Then\n                BMatch = True\n                Exit For\n            End If\n        Next j\n        'Application.StatusBar = \"Match status for row \" &amp; i &amp; \": \" &amp; BMatch\n        If Not BMatch Then\n            'Loop backwards to find the starting row (no lower than 11)\n            For j = i To 11 Step -1\n                If Sheets(1).Range(\"A\" &amp; j).Value2 Like \"Object:*\" Then Exit For\n            Next j\n            Sheets(1).Rows(j &amp; \":\" &amp; i).Delete\n            i = j - 1\n        Else\n            'Find next block\n            If i &gt; 11 Then\n                For j = i - 1 To 11 Step -1\n                    If Sheets(1).Range(\"A\" &amp; j).Value2 Like \"End:*\" Then Exit For\n                Next j\n                i = j\n            Else\n                i = 10 'Force the loop to exit\n            End If\n        End If\n        'Application.StatusBar = \"Moving to row \" &amp; i\n    Loop Until i &lt; 11\n\n    'Loop back through and delete any blank rows\n    LRow = Sheets(1).Range(\"A:A\").Find(what:=\"*\", searchdirection:=xlPrevious).Row\n    'MsgBox \"Second checkpoint: new last row of data is \" &amp; LRow\n    For i = LRow To 11 Step -1\n        If Sheets(1).Range(\"A\" &amp; i).Value2 = vbNullString Then Sheets(1).Rows(i).Delete\n    Next i\nEnd If\n\n'Application.StatusBar = False\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\n'End Filter Out Unused Data========================================================\n'Start Write To Local Txt File=====================================================\nDim sSaveAsFilePath As String\nApplication.DisplayAlerts = False\n\n\n    sSaveAsFilePath = \"C:\\Users\\Speedy\\Desktop\\Test\\test.txt\"\n\n    Sheets(1).Copy '//Copy sheet 1 to new workbook\n    ActiveWorkbook.SaveAs sSaveAsFilePath, xlTextWindows '//Save as text (tab delimited) file\n    If ActiveWorkbook.Name &lt;&gt; ThisWorkbook.Name Then '//Double sure we don't close this workbook\n        ActiveWorkbook.Close False\n    End If\nApplication.DisplayAlerts = True\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\nLoop\nEnd Sub\n\nSub KillMacro()\n  StopLoop = True ' stop that perpetual loop in Workbook_Open()\n  MsgBox \"Program Stopped\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "dynamic", "combobox", "ms-word", "ribbon"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456910005, "post_id": 35736849, "comment_id": 59159114, "body": "Just a hunch, but doesn&#39;t something like this work: <code>For i=0 to UBound(ListOfPlaylists) : cmbPlaylist.AddItem ListOfPlaylists(i) : Next</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1456940294, "post_id": 35736849, "comment_id": 59181817, "body": "Ahhh, were to start... Dynamic content of the RIbbon is controlled by the RIbbonXML. You need to use &quot;get&quot; attributes - and NO static elements. The &quot;get&quot; attributes point to <i>callbacks</i> (<code>Public Sub</code> with the correct arguments) in the document that contains the Ribbon. These get executed the first time when the Ribbon is loaded, automatically. IF you set things up correctly, at that first loading, a callback for the entire Ribbon can populate a variable for the Ribbon that can be used at any later point to force a certain control or the entire Ribbon to again execute the &quot;get&quot; callbacks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1456940761, "post_id": 35736849, "comment_id": 59182119, "body": "The fact that I need to start an additional comment to finish this &quot;intro&quot; is an indication that your question is &quot;too broad&quot; for this site. But the concepts are odd for people with VBA experience... I recommend you work through the MSDN article Customize the 2007 Office Fluent Ribbon for developers (1 of 3) <a href=\"http://msdn.microsoft.com/en-us/library/aa338202(v=office.12)\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa338202(v=office.12)</a> as your next step. Pay special attention to the topic &quot;Ribbon Customization Scenarios for other Applications&quot;. Here you&#39;ll find some examples for using dynamic callbacks, including for a dropdown list."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1456940870, "post_id": 35736849, "comment_id": 59182183, "body": "Use the above to get a start on the basic principle. Then you can come back with a more specific question if you run into roadblocks. Additonal resource: <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/ba8c9d0b-7312-4503-8167-f2ef86f17435/information-on-the-office-fluent-ui-ribbon-for-developers?forum=officegeneral\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a> has a list of articles on using the Ribbon."}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1457124684, "creation_date": 1457124684, "answer_id": 35805800, "question_id": 35736849, "link": "https://stackoverflow.com/questions/35736849/ms-word-ribbonx-how-can-i-dynamically-populate-a-combobox-when-a-dotm-file-opens/35805800#35805800", "title": "MS Word RibbonX How can I dynamically populate a combobox when a dotm file opens?", "body": "<p>I actually did some fiddling and almost stumbled on the answer. I put this in my code and it seems to work just fine now:</p>\n\n<pre><code>Sub drpPlaylists_getItemCount(Control As IRibbonControl, ByRef drpPlaylists_itemCount)\n    drpPlaylists_itemCount = UBound(ReadDirectoryContents(MusicDirectory, \"*.m3u\"))\nEnd Sub\n</code></pre>\n\n<p>I guess this gets launched every time the ribbon has to reload itself. But it's solved for now. Still have some things to study up on on when these callbacks get called, but I'll figure this out. Thanks for the help!</p>\n"}], "owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457124684, "creation_date": 1456882403, "question_id": 35736849, "link": "https://stackoverflow.com/questions/35736849/ms-word-ribbonx-how-can-i-dynamically-populate-a-combobox-when-a-dotm-file-opens", "title": "MS Word RibbonX How can I dynamically populate a combobox when a dotm file opens?", "body": "<p>I'm a little stumped here. I'm diving deeper into designing ribbons for MS Word 2010, and I came across something new: populating comboboxes on the fly. In the image below, you can see...</p>\n\n<p><a href=\"https://i.stack.imgur.com/pV7iK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pV7iK.png\" alt=\"MS Word 2010 custom ribbon with unpopulated combobox\"></a></p>\n\n<p>...that I'm a dude who likes music while he works, just like any other dude. Problem is my list of playlists changes from time to time, so I don't want to hard-code that list into my ribbon's combobox. I can easily hard-code it, but I want this thing to be dynamic. And so, in my ribbon code:</p>\n\n<pre><code>    &lt;comboBox id=\"cmbPLaylist\" label=\"Playlist\" getItemLabel=\"Document_Open\"&gt;\n        &lt;item id=\"none\" label=\"None\"/&gt;\n    &lt;/comboBox&gt;\n</code></pre>\n\n<p>I have left only one item, \"none,\" which is fine if I want the music player to launch with no playlist loaded. But what if I want a playlist to automatically load?</p>\n\n<p>First, from my Google and book research, I've determined that I need to have a getItemLabel callback to populate the control. Is this the right way to go? But how do I run that automatically when my Normal.dotm loads? I'm having problems running this thing in the Document_Open event, and I've been reading online that I'm not alone.</p>\n\n<p>My problem is a bit threefold: first, I'm really new at using these predefined callbacks like getEnabled, getItemLabel, etc. The callback territory is a very new territory for me. Second, I've never used a combobox in a ribbon before. Three, I've never dynamically populated a combobox in a ribbon before. I might be trying to bite off more than I can chew at once, but can anyone point me in the right direction?</p>\n\n<p>My code so far, inserted into my Normal.dotm Document_Open event, is such:</p>\n\n<pre><code>Private Sub Document_Open(control As IRibbonControl, ByRef label)\n    Dim ListOfPlaylists() As String\n\n    ListOfPlaylists = GetPlaylists()\n    ListOfPlaylists(UBound(ListOfPlaylists)) = \"Random\"\nEnd Sub\n</code></pre>\n\n<p>After this, I'm stumped. As you can see, I'm not sure how to tell MS Word, \"Hey, MS Word, insert this value into the combobox list!\"</p>\n\n<p>Maybe it's my newbness at this whole thing, but when I Google for an answer, I'm not seeing it in the code. So any help is appreciated. Thanks!</p>\n"}, {"tags": ["excel", "vba", "offset", "vlookup", "countif"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1456881136, "post_id": 35736477, "comment_id": 59147616, "body": "So your Level IDs are text masquerading as true numbers...? If not, how is that VLOOKUP with CONCATENATE working?"}, {"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1456881281, "post_id": 35736477, "comment_id": 59147658, "body": "@Jeeped Yes essentially, they have to be under text so I can use levels as 00 etc. Instead of just 0."}, {"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "edited": false, "score": 0, "creation_date": 1456884445, "post_id": 35736477, "comment_id": 59148523, "body": "I don&#39;t know if this can be done with normal formulas.  Are you at all familiar with VBA?"}, {"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "reply_to_user": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "edited": false, "score": 0, "creation_date": 1456884604, "post_id": 35736477, "comment_id": 59148567, "body": "@JamesFaix I&#39;ve worked with VBA a little, but I&#39;m still very new to it"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1456886344, "post_id": 35737289, "comment_id": 59149073, "body": "Works perfectly! Thanks for the help, it&#39;s much appreciated"}, {"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1456886646, "post_id": 35737289, "comment_id": 59149163, "body": "Just wondering if you know if it&#39;s possible to add a certain number (defined by a cell) of text boxes (or user forms or shapes etc) stacked underneath each other. Each shape/box/form could have the formula and other details in them. This would in a way remove the need for &quot;no more&quot;. Possibly a cleaner solution than having zero-length strings in a worksheet etc"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1456886844, "post_id": 35737289, "comment_id": 59149224, "body": "Formulas do not work that way; well actually, some [google-sheets] formulas do but not [excel]. With [excel] you need to fill the formula to the maximum number of possible matches. With VBA, you can dynamically change the number of returns but not with native worksheet formulas."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1456885477, "creation_date": 1456885477, "answer_id": 35737289, "question_id": 35736477, "link": "https://stackoverflow.com/questions/35736477/use-of-offset-vlookup-and-concatenate-to-return-a-list/35737289#35737289", "title": "Use of Offset, Vlookup, and Concatenate to return a list", "body": "<p>Use the <a href=\"https://support.office.com/en-us/article/AGGREGATE-function-43B9278E-6AA7-4F17-92B6-E19993FA26DF\" rel=\"nofollow noreferrer\">AGGREGATE\u00b9 function</a> to return the <em>first, second, third,</em> etc matching row numbers from the table to an <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX function</a>.</p>\n\n<pre><code>=IFERROR(INDEX(pieces[Tenant], AGGREGATE(15, 6, (ROW(pieces[Level ID])-ROW(pieces[#Headers]))/(LEFT(pieces[Level ID], LEN(I$30))=I$30), ROW(1:1))), \"no more\")\n</code></pre>\n\n<p>Fill down until you run out of matches. Change <em>\"no more\"</em> to a zero-length string (e.g. <code>\"\"</code>) if you want the non-matching cells to appear blank.</p>\n\n<p>\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/uMjuW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uMjuW.png\" alt=\"aggregate_next_tenants\"></a></p>\n\n<hr>\n\n<p>\u00b9 <sub>The <a href=\"https://support.office.com/en-us/article/AGGREGATE-function-43B9278E-6AA7-4F17-92B6-E19993FA26DF\" rel=\"nofollow noreferrer\">AGGREGATE function</a> was introduced with Excel 2010. It is not available in earlier versions.</sub></p>\n"}], "owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 0, "accepted_answer_id": 35737289, "answer_count": 1, "score": 2, "last_activity_date": 1456885477, "creation_date": 1456879743, "last_edit_date": 1456884633, "question_id": 35736477, "link": "https://stackoverflow.com/questions/35736477/use-of-offset-vlookup-and-concatenate-to-return-a-list", "title": "Use of Offset, Vlookup, and Concatenate to return a list", "body": "<p>On my \"Pieces\" sheet and table I have a bunch of IDs as follows:</p>\n\n<pre><code>Level ID    Tenant Type    Level SQM    Tenant\n1358001     Retail              1000    VACANT\n1358002     Retail              1000    Schoc\n1358003     Retail              1000    VACANT\n1358004     Retail              1000    Wishbone\n1358005     Retail              1000    Zebrano Ltd\n1358006     Retail              1000    Cranfields\n1358007     Retail              1000    Astoria\n1358008     Retail              1000    Mall Drycleaners\n1358009     Unaccounted Area    1000    Unaccounted Area\n</code></pre>\n\n<p>I have then got a \"front\" sheet where the data is sorted etc.\nI want to be able to list on the front sheet multiple tenants for a single level. In the example above all the Tenants are on the same level: \"00\".</p>\n\n<p>On the \"front\" sheet I then pull up the Level ID I'm looking at in cell I30 by using <code>=CONCATENATE(F5,B15)</code>:<code>F5= 1358</code> : <code>B15= 00</code>.</p>\n\n<p>Cell I32 contains: \n<code>=COUNTIF(pieces[Level ID],(CONCATENATE(I30,\"?\")))</code> which returns <code>9</code>.</p>\n\n<p>Below this I want to make a 'dynamic' list of all the Tenants in level 00. I'm not completely sure how to do this (and I might be heading in the wrong direction) but I believe I have parts of the puzzle I just don't know how to piece it together.</p>\n\n<p>I can return one Tenant with the following forumla:</p>\n\n<pre><code>=VLOOKUP(CONCATENATE(I30,\"1\"), pieces[[#All], [Level ID]:[Tenant]], 4, FALSE)\n</code></pre>\n\n<p>which returns the first tenant (\"VACANT\") correctly.</p>\n\n<p>I was then thinking I could pull down a 'list' (just into the cells below) by using something like:</p>\n\n<pre><code>=OFFSET(VLOOKUP(CONCATENATE(I30,\"1\"),pieces[[#All],[Level ID]:[Tenant]],4,FALSE),0,0,I32)\n</code></pre>\n\n<p>which would use my <code>COUNTIF</code> statement to make a height of 9. However, this formula doesn't work and I can't manage to get it right, even after looking up a</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31155, "user_id": 4744514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RQ2Np.jpg?s=128&g=1", "display_name": "MikeT", "link": "https://stackoverflow.com/users/4744514/miket"}, "edited": false, "score": 0, "creation_date": 1456880150, "post_id": 35736472, "comment_id": 59147326, "body": "What I do to ascertain how to do new things is to record a macro and then look to see what that is doing."}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 31155, "user_id": 4744514, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RQ2Np.jpg?s=128&g=1", "display_name": "MikeT", "link": "https://stackoverflow.com/users/4744514/miket"}, "edited": false, "score": 2, "creation_date": 1456882621, "post_id": 35736472, "comment_id": 59148015, "body": "Which would work if Macro recording extended outside of Excel. Maybe im missing a setting, but once I leave Excel, the macro stops recording. Anyhoo, I figured out a workaround. Just clever extended use of SendKeys."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1457025937, "post_id": 35736472, "comment_id": 59229459, "body": "Are you trying to Print the content of the external (non-Excel Workbook) file?"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1457124334, "post_id": 35736472, "comment_id": 59280855, "body": "I am trying to make a spreadsheet where I enter a craigslist URLs, job titles, and contact email addresses, and excel automatically prints a copy of the listing to a set directory and emails a customized coverletter with resume attached. This bit was trying to figure out how to get the print-to-file of the listing, so im trying to print the content of an IE browser."}], "answers": [{"tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1457028248, "last_edit_date": 1457028248, "creation_date": 1457027104, "answer_id": 35779304, "question_id": 35736472, "link": "https://stackoverflow.com/questions/35736472/vba-pass-cell-value-to-print-dialogue-box/35779304#35779304", "title": "VBA pass cell value to Print dialogue box", "body": "<p>In order to print the content of the external file (for example, C:\\Temp\\TestFile.txt) from Excel VBA macro you can use <code>ShellExecute()</code> function as shown below.</p>\n\n<p>First, insert the VBA <code>Module</code> (e.g. <code>Module1</code>) and place the following declarations and <code>Sub</code> into that <code>Module1</code>:</p>\n\n<pre><code>Public Declare Function ShellExecute Lib \"shell32.dll\" Alias _\n   \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation _\n   As String, ByVal lpFile As String, ByVal lpParameters _\n   As String, ByVal lpDirectory As String, ByVal nShowCmd _\n   As Long) As Long\nPublic Const SW_SHOWNORMAL = 1\n\nPublic Sub ShellExecuteSample()\n    'shown as example: it will open the text file C:\\Temp\\TestFile.txt\n    OpenFile = ShellExecute(hwnd, \"open\", \"C:\\Temp\\TestFile.txt\", \"\", \"C:\\\", SW_SHOWNORMAL)\n\n    'this will print the content of the text file C:\\Temp\\TestFile.txt\n    PrintFile = ShellExecute(hwnd, \"print\", \"C:\\Temp\\TestFile.txt\", \"\", \"C:\\\", SW_SHOWNORMAL)\nEnd Sub\n</code></pre>\n\n<p>When called, this <code>Sub ShellExecuteSample()</code> will print the content and (optionally) open the text file: <code>C:\\Temp\\TestFile.txt</code>. Pertinent to your case, it could be the file specified by your string:</p>\n\n<pre><code>\"C:\\users\\user1\\desktop\\\" &amp; Worksheets(\"Queue\").Range(\"A5\").Value\n</code></pre>\n\n<p>Apparently, you do not need a <code>PrintDialog</code> to complete this task.</p>\n\n<p>Hope this may help.</p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "is_accepted": true, "score": 0, "last_activity_date": 1457124596, "creation_date": 1457124596, "answer_id": 35805767, "question_id": 35736472, "link": "https://stackoverflow.com/questions/35736472/vba-pass-cell-value-to-print-dialogue-box/35805767#35805767", "title": "VBA pass cell value to Print dialogue box", "body": "<p>So, im sure this isn't nearly the most elegant way to achieve the task, but this is what I was able to write that does what I want it to do:</p>\n\n<pre><code>Sub Grab_Screencap()\n\nDim i As Integer\ni = 3\n\nDo Until IsEmpty(Cells(i, 2))\n\n    'Copy Screencap Name\n    Sheets(\"Queue\").Cells(i, 6).Copy\n\n    'Open URL\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    With IE\n\n        .Visible = True\n        .Navigate _\n            Worksheets(\"Queue\").Cells(i, 2).Value\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"^p\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"{UP}\", True\n        SendKeys \"{UP}\", True\n        SendKeys \"~\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"{TAB}\", True\n        SendKeys \"{TAB}\", True\n        SendKeys \"{TAB}\", True\n        SendKeys \"{TAB}\", True\n        SendKeys \"{TAB}\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"~\", True\n        SendKeys \"C:\\Users\\Johnny\\Desktop\\Job Listings\\\"\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"^v\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"%s\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        IE.Quit\n\n    End With\n\n    i = i + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>The 101 lesson was that SendKeys can send an entire string, not just a single key. I didnt need to merge the file name with the pathway. I just needed to drop the pathway, tab back to file name, and drop the file name, which I could copy before opening IE.</p>\n\n<p>I think there is a way to do this task just by opening the print dialogue and activating print to file, but I have not tried to figure that out yet.</p>\n"}], "owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 35805767, "answer_count": 2, "score": 1, "last_activity_date": 1457124596, "creation_date": 1456879716, "last_edit_date": 1457024638, "question_id": 35736472, "link": "https://stackoverflow.com/questions/35736472/vba-pass-cell-value-to-print-dialogue-box", "title": "VBA pass cell value to Print dialogue box", "body": "<p>This is the Sub that I have built so far:</p>\n\n<pre><code>Sub Grab_Screencap()\n\n    'Open URL\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .Navigate _\n            Worksheets(\"Queue\").Range(\"A3\").Value\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"^p\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"{UP}\", True\n        SendKeys \"{UP}\", True\n        SendKeys \"~\", True\n        Application.Wait (Now + #12:00:02 AM#)\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"+{TAB}\", True\n        SendKeys \"~\", True\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I am sure there are much better ways to do it, but I am still on the kiddie side of the pool.</p>\n\n<p>This takes a URL that I have in a spreadsheets, and then opens IE, navigates to that page, opens the Print dialogue box, selects XPS Document Writer, navigates to the pathway field, and then highlights the value.</p>\n\n<p>Now I want to pass a base directory, and a file name from a cell, something like </p>\n\n<pre><code>\"C:\\users\\user1\\desktop\\\" &amp; Worksheets(\"Queue\").Range(\"A5\").Value\n</code></pre>\n\n<p>Tinkering around but cant find any existing documentation that lines up with what I'm trying to do that I can comprehend.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456925834, "post_id": 35737617, "comment_id": 59170627, "body": "Behavior is the same. It&#39;s still picking row by row even if it&#39;s filtered out. That part is what picks each email address and uses it to filter another spreadsheet."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456931589, "post_id": 35737617, "comment_id": 59175392, "body": "@FabrizioMartinez I&#39;m having trouble replicating your issue. Can you post some sample data? I see that it&#39;s AR and likely confidential, but could you scramble the company names and amounts?"}, {"owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456932202, "post_id": 35737617, "comment_id": 59175843, "body": "Absolutely, any chance I can send you a sample workbook?"}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456933355, "post_id": 35737617, "comment_id": 59176737, "body": "Sure can. If possible, please post a link in the question (to Dropbox, Google Drive, or the like) so others can see. If you&#39;d prefer not to share it publicly, you can email it to me at nperanzi@gmail.com."}, {"owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456934701, "post_id": 35737617, "comment_id": 59177756, "body": "Just added a link to a sample workbook in the original question. Let me know if it suffices."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456941627, "post_id": 35737617, "comment_id": 59182697, "body": "@FabrizioMartinez edited my post - I was able to find the problem when looking at your sample workbook, thank you."}, {"owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "edited": false, "score": 0, "creation_date": 1456952269, "post_id": 35737617, "comment_id": 59189166, "body": "It worked beautifully. I really appreciate the time you took to review this monster. Can&#39;t thank you enough!"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 1, "last_activity_date": 1456941591, "last_edit_date": 1456941591, "creation_date": 1456887324, "answer_id": 35737617, "question_id": 35736336, "link": "https://stackoverflow.com/questions/35736336/vba-need-to-loop-only-through-visible-cells-in-excel/35737617#35737617", "title": "VBA: Need to loop only through visible cells in Excel", "body": "<p><strong>Edit</strong> - removed old answer as it did not address OP's issue.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>You are using the row of the email address from the Emails sheet (the <code>cell</code> variable) when attempting to pull the collector. In your example of email #2, <code>cell.Row</code> is 3 because CustomerEmail2@Customer2.com appears in cell A3 of the Emails sheet.</p>\n\n<p><strong>Solution</strong></p>\n\n<p>You need to retrieve the first visible row number from the Locations sheet and use that in your references. Note the addition of the CollectorRow variable.</p>\n\n<pre><code>Sub AutoEmailSend()\n\nDim rng As ListObject\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim TempFilePath As String\nDim TempFileName As String\nDim TempWB As Workbook\nDim LastRow As Long\nDim CollectorRow As Long\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = Sheets(\"Detail Aging\").ListObjects(\"Locations\")\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nDim strbody As String\nstrbody = Worksheets(\"Body\").Range(\"A1\")\n\nDim strbody2 As String\nstrbody2 = Worksheets(\"Body\").Range(\"A2\")\n\nDim strbody3 As String\nstrbody3 = Worksheets(\"Body\").Range(\"A3\")\n\nDim strbody4 As String\nstrbody4 = Worksheets(\"Body\").Range(\"A4\")\n\nDim strbody5 As String\nstrbody5 = Worksheets(\"Body\").Range(\"A5\")\n\nOn Error GoTo cleanup\n\nFor Each cell In Sheets(\"Emails\").Columns(\"A\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" Then\n        Sheets(\"Locations\").Range(\"A1:R1\").AutoFilter Field:=12, Criteria1:=cell.Value\n\n        Dim RngOne As Range, cell2 As Range\n        Dim LastCell As Long\n        Dim arrList() As String, lngCnt As Long\n\n        With Sheets(\"Locations\")\n            LastCell = .Range(\"D\" &amp; Sheets(\"Locations\").Rows.Count).End(xlUp).Row\n            Set RngOne = .Range(\"D2:D\" &amp; LastCell)\n        End With\n\n        'load values into an array and get first visible row while we are at it\n        CollectorRow = 0\n        lngCnt = 0\n        For Each cell2 In RngOne\n            If Not cell2.EntireRow.Hidden Then\n                If CollectorRow = 0 Then CollectorRow = cell2.Row\n                ReDim Preserve arrList(lngCnt)\n                arrList(lngCnt) = cell2.Text\n                lngCnt = lngCnt + 1\n            End If\n        Next cell2\n\n        Sheets(\"Detail Aging\").Range(\"A1:I1\").AutoFilter Field:=1, Criteria1:=arrList, Operator:=xlFilterValues\n\n        With Worksheets(\"Detail Aging\").ListObjects(\"Locations\").Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=Range(\"Locations[[#Headers],[#Data],[Days Late]]\"), _\n            SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n            xlSortTextAsNumbers\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n\n        Sheets(\"Body\").Range(\"B1\").Formula = \"=TEXT(Locations[[#Totals],[Total Balance]], \"\"$#,##0.00._);($#,##0.00).\"\")\"\n\n        Dim strbody6 As String\n        strbody6 = Worksheets(\"Body\").Range(\"B1\")\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n            With OutMail\n            .To = cell.Value\n            .CC = Cells(CollectorRow, \"M\").Value &amp; \"; \" &amp; Cells(CollectorRow, \"N\").Value &amp; \"; \" &amp; Cells(CollectorRow, \"O\").Value &amp; \"; \" &amp; Cells(CollectorRow, \"S\").Value\n            .Subject = \"Aging Report | \" &amp; Cells(CollectorRow, \"C\").Value &amp; \" | \" &amp; Cells(CollectorRow, \"F\").Value &amp; \" | \" &amp; Cells(CollectorRow, \"T\").Value\n\n            .HTMLBody = \"&lt;BODY style=font-size:11pt;font-family:Arial&gt;Dear Valued Customer,&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody2 &amp; \"&lt;B&gt;\" &amp; strbody6 &amp; \"&lt;/B&gt;\" &amp; \" \" &amp; strbody3 &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody4 &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody5 &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            \"&lt;i&gt;&lt;u&gt;Please use \"\"Reply All\"\" when replying to this email. AR@Company.com is not a monitored email address.&lt;/u&gt;&lt;/i&gt;&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            \"Thank you for your business!&lt;/BODY&gt;&lt;BR&gt;\" &amp; _\n            \"&lt;BODY style=font-size:12pt;font-family:Arial&gt;&lt;B&gt;\" &amp; Cells(CollectorRow, \"A\").Value &amp; \" | &lt;font color=\"\"#d52427\"\"&gt;Company&lt;/font&gt;&lt;/B&gt;&lt;BR&gt;\" &amp; _\n            \"&lt;span style=font-size:11pt;font-family:Arial&gt;\" &amp; Cells(CollectorRow, \"Q\").Value &amp; \"&lt;BR&gt;\" &amp; _\n            Cells(CollectorRow, \"R\").Value &amp; \"&lt;BR&gt;\" &amp; _\n            Cells(CollectorRow, \"S\").Value &amp; \"&lt;BR&gt;\" &amp; _\n            \"&lt;font color=\"\"#d52427\"\"&gt;www.Company.com&lt;/font&gt;&lt;/span&gt;&lt;/body&gt;&lt;BR&gt;\"\n\n            rng.Range.SpecialCells(xlCellTypeVisible).Copy\n            Workbooks.Add (1)\n            Set TempWB = ActiveWorkbook\n            With TempWB.Sheets(1)\n                .Cells(1).PasteSpecial Paste:=8\n                .Cells(1).PasteSpecial xlPasteValues, , False, False\n                .Cells(1).PasteSpecial xlPasteFormats, , False, False\n                .Cells(1).Select\n                Application.CutCopyMode = False\n                .Cells.EntireColumn.AutoFit\n                .Range(\"A1:J1\").AutoFilter\n                On Error Resume Next\n                .DrawingObjects.Visible = True\n                .DrawingObjects.Delete\n                On Error GoTo 0\n                .Name = \"Aging Report\"\n            End With\n\n            TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n            TempFileName = \"Aging Report \" &amp; Format(Now, \"dd-mm-yy hh-mm-ss\") &amp; \".xlsx\"\n            TempWB.SaveAs TempFilePath &amp; TempFileName\n            .Attachments.Add TempWB.FullName\n            TempWB.Close savechanges:=False\n            Kill TempFilePath &amp; TempFileName\n\n            .Send\n            End With\n\n        On Error GoTo 0\n        Set OutMail = Nothing\n\n    End If\n\nNext cell\n\ncleanup:\nSet OutApp = Nothing\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I ran this modified code on your test workbook, and the second email has Customer2's information as intended. </p>\n\n<p>Also, as a side note: since your code relies upon a list of emails in one sheet and filtering data in a different sheet, you would have unexpected behavior if an email in the Emails sheet had no lines in the Locations sheet. This may not be an issue for you - for instance, if another set of code builds the email list - but could be something to think about.</p>\n"}], "owner": {"reputation": 61, "user_id": 4279691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/28303f4a6cce496f8f75dfce59eff7f9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio Martinez", "link": "https://stackoverflow.com/users/4279691/fabrizio-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 35737617, "answer_count": 1, "score": 0, "last_activity_date": 1469711005, "creation_date": 1456878803, "last_edit_date": 1469711005, "question_id": 35736336, "link": "https://stackoverflow.com/questions/35736336/vba-need-to-loop-only-through-visible-cells-in-excel", "title": "VBA: Need to loop only through visible cells in Excel", "body": "<p>I'm working on a macro that creates Workbooks based on a filter and sends them out to a list of emails, one at a time, however, there may be more than one location per email and the loop is picking up each (next) cell, even if it's filtered out. Example table:</p>\n\n<pre><code>Location Email\n1         asd@asd.com\n2         asd@asd.com\n3         asd@asd.com\n4         qwe@qwe.com\n</code></pre>\n\n<p>I use another sheet to filter for each unique email and then load the locations into an array so it filters a table. Once that table is filtered I Copy and paste the contents into a new workbook, save it temporarily, attach it to the email and send it out. The problem is that when I reach the second unique email, the email contains values from previous rows (location 2 and 3) and so on. Here's the code:</p>\n\n<pre><code>Sub AutoEmailSend()\n\nDim rng As ListObject\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim TempFilePath As String\nDim TempFileName As String\nDim TempWB As Workbook\nDim LastRow As Long\n\nSet rng = Nothing\nOn Error Resume Next\nSet rng = Sheets(\"Detail Aging\").ListObjects(\"Locations\")\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nDim strbody As String\nstrbody = Worksheets(\"Body\").Range(\"A1\")\n\nDim strbody2 As String\nstrbody2 = Worksheets(\"Body\").Range(\"A2\")\n\nDim strbody3 As String\nstrbody3 = Worksheets(\"Body\").Range(\"A3\")\n\nDim strbody4 As String\nstrbody4 = Worksheets(\"Body\").Range(\"A4\")\n\nDim strbody5 As String\nstrbody5 = Worksheets(\"Body\").Range(\"A5\")\n\nOn Error GoTo cleanup\n\nFor Each cell In Sheets(\"Emails\").Columns(\"A\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" Then\n        Sheets(\"Locations\").Range(\"A1:R1\").AutoFilter Field:=12, Criteria1:=cell.Value\n\n        Dim RngOne As Range, cell2 As Range\n        Dim LastCell As Long\n        Dim arrList() As String, lngCnt As Long\n\n        With Sheets(\"Locations\")\n            LastCell = .Range(\"D\" &amp; Sheets(\"Locations\").Rows.Count).End(xlUp).Row\n            Set RngOne = .Range(\"D2:D\" &amp; LastCell)\n        End With\n\n        'load values into an array\n        lngCnt = 0\n        For Each cell2 In RngOne\n            If Not cell2.EntireRow.Hidden Then\n            ReDim Preserve arrList(lngCnt)\n            arrList(lngCnt) = cell2.Text\n            lngCnt = lngCnt + 1\n            End If\n        Next cell2\n\n        Sheets(\"Detail Aging\").Range(\"A1:I1\").AutoFilter Field:=1, Criteria1:=arrList, Operator:=xlFilterValues\n\n        With Worksheets(\"Detail Aging\").ListObjects(\"Locations\").Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=Range(\"Locations[[#Headers],[#Data],[Days Late]]\"), _\n            SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n            xlSortTextAsNumbers\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n\n        Sheets(\"Body\").Range(\"B1\").Formula = \"=TEXT(Locations[[#Totals],[Total Balance]], \"\"$#,##0.00._);($#,##0.00).\"\")\"\n\n        Dim strbody6 As String\n        strbody6 = Worksheets(\"Body\").Range(\"B1\")\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n            With OutMail\n            .To = cell.Value\n            .CC = Cells(cell.Row, \"M\").Value &amp; \"; \" &amp; Cells(cell.Row, \"N\").Value &amp; \"; \" &amp; Cells(cell.Row, \"O\").Value &amp; \"; \" &amp; Cells(cell.Row, \"S\").Value\n            .Subject = \"Aging Report | \" &amp; Cells(cell.Row, \"C\").Value &amp; \" | \" &amp; Cells(cell.Row, \"F\").Value &amp; \" | \" &amp; Cells(cell.Row, \"T\").Value\n\n            .HTMLBody = \"&lt;BODY style=font-size:11pt;font-family:Arial&gt;Dear Valued Customer,&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody2 &amp; \"&lt;B&gt;\" &amp; strbody6 &amp; \"&lt;/B&gt;\" &amp; \" \" &amp; strbody3 &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody4 &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            strbody5 &amp; \"&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            \"&lt;i&gt;&lt;u&gt;Please use \"\"Reply All\"\" when replying to this email. AR@Company.com is not a monitored email address.&lt;/u&gt;&lt;/i&gt;&lt;BR&gt;&lt;BR&gt;\" &amp; _\n            \"Thank you for your business!&lt;/BODY&gt;&lt;BR&gt;\" &amp; _\n            \"&lt;BODY style=font-size:12pt;font-family:Arial&gt;&lt;B&gt;\" &amp; Cells(cell.Row, \"A\").Value &amp; \" | &lt;font color=\"\"#d52427\"\"&gt;Company&lt;/font&gt;&lt;/B&gt;&lt;BR&gt;\" &amp; _\n            \"&lt;span style=font-size:11pt;font-family:Arial&gt;\" &amp; Cells(cell.Row, \"Q\").Value &amp; \"&lt;BR&gt;\" &amp; _\n            Cells(cell.Row, \"R\").Value &amp; \"&lt;BR&gt;\" &amp; _\n            Cells(cell.Row, \"S\").Value &amp; \"&lt;BR&gt;\" &amp; _\n            \"&lt;font color=\"\"#d52427\"\"&gt;www.Company.com&lt;/font&gt;&lt;/span&gt;&lt;/body&gt;&lt;BR&gt;\"\n\n            rng.Range.SpecialCells(xlCellTypeVisible).Copy\n            Workbooks.Add (1)\n            Set TempWB = ActiveWorkbook\n            With TempWB.Sheets(1)\n                .Cells(1).PasteSpecial Paste:=8\n                .Cells(1).PasteSpecial xlPasteValues, , False, False\n                .Cells(1).PasteSpecial xlPasteFormats, , False, False\n                .Cells(1).Select\n                Application.CutCopyMode = False\n                .Cells.EntireColumn.AutoFit\n                .Range(\"A1:J1\").AutoFilter\n                On Error Resume Next\n                .DrawingObjects.Visible = True\n                .DrawingObjects.Delete\n                On Error GoTo 0\n                .Name = \"Aging Report\"\n            End With\n\n            TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n            TempFileName = \"Aging Report \" &amp; Format(Now, \"dd-mm-yy hh-mm-ss\") &amp; \".xlsx\"\n            TempWB.SaveAs TempFilePath &amp; TempFileName\n            .Attachments.Add TempWB.FullName\n            TempWB.Close savechanges:=False\n            Kill TempFilePath &amp; TempFileName\n\n            .Send\n            End With\n\n        On Error GoTo 0\n        Set OutMail = Nothing\n\n    End If\n\nNext cell\n\ncleanup:\nSet OutApp = Nothing\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>First email is correct like:</p>\n\n<pre><code>To: asd@asd.com\nCc: Person1@email.com; Company1@company.com\nSubject: Aging Report | Cust1 | Custname1 | Col1\nAttachment: Table containing correct details\n\nBody Text Correct\n\nCol1 Name | Company\nPos1\nPhone1\nEmail1\nwww.Company.com\n</code></pre>\n\n<p>Second email however, is something like:</p>\n\n<pre><code>To: qwe@qwe.com\nCc: Person1@email.com; Company1@company.com (Should be Person2 and Company2)\nSubject: Aging Report | Cust1 | Custname1 | Col1 (Should be Cust2 and so on)\nAttachment: Table containing correct details\n\nBody Text Correct\n\nCol1 Name | Company (Should be Col2 and so on)\nPos1\nPhone1\nEmail1\nwww.Company.com\n</code></pre>\n\n<p>I'm trying to provide as many details as possible. Thank you in advance.</p>\n\n<p>Link with sample workbook: <a href=\"https://1drv.ms/x/s!At5Qdrytuugrlmt5NcJovACVdiNt\" rel=\"nofollow\">https://1drv.ms/x/s!At5Qdrytuugrlmt5NcJovACVdiNt</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "edited": false, "score": 0, "creation_date": 1456886081, "post_id": 35736062, "comment_id": 59148995, "body": "Are you trying copy sheet to another file?"}, {"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "reply_to_user": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "edited": false, "score": 0, "creation_date": 1456933652, "post_id": 35736062, "comment_id": 59176997, "body": "yes, selected sheets from one workbook to another in a directory"}], "answers": [{"comments": [{"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456936038, "post_id": 35737792, "comment_id": 59178849, "body": "this code saves down extra sheets that I don&#39;t need in the original workbook as well."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456937630, "post_id": 35737792, "comment_id": 59180047, "body": "@Sailormoon edited to provide an answer that will delete all other sheets."}, {"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456938486, "post_id": 35737792, "comment_id": 59180635, "body": "Hi Nick thanks very much, would you also know how to avoid the message says there&#39;s already a copy? I want to default it to be save as overwrite. I will accept the answer as soon as I knock this last piece out. Thank you!"}, {"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456938858, "post_id": 35737792, "comment_id": 59180907, "body": "also there&#39;s a delete message box show up said you can&#39;t undo deleteting sheets, are you sure you want to delete.."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456940669, "post_id": 35737792, "comment_id": 59182048, "body": "@Sailormoon - You can use <code>Application.DisplayAlerts = False</code> to prevent both dialog boxes (delete and save). See edit above."}, {"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456946549, "post_id": 35737792, "comment_id": 59185784, "body": "the file kept crashing on me when i put application.displayalerts =false at the end of the code."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "reply_to_user": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456946699, "post_id": 35737792, "comment_id": 59185868, "body": "@Sailormoon The line at the end of the code should be <code>Application.DisplayAlerts = True</code>; this reverts the display alert settings set to False at the beginning of the code. Does this solve your issue?"}, {"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1456953038, "post_id": 35737792, "comment_id": 59189640, "body": "maybe its just my computer. I will check with other computers. Would you please also take  a look at this post if you know vbs?<a href=\"http://stackoverflow.com/questions/35758090/vbs-not-running-at-all\" title=\"vbs not running at all\">stackoverflow.com/questions/35758090/vbs-not-running-at-&zwnj;&#8203;all</a>"}], "tags": [], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "is_accepted": true, "score": 2, "last_activity_date": 1456940711, "last_edit_date": 1456940711, "creation_date": 1456888283, "answer_id": 35737792, "question_id": 35736062, "link": "https://stackoverflow.com/questions/35736062/converting-formulas-in-multiple-worksheets-to-values/35737792#35737792", "title": "Converting Formulas in Multiple Worksheets to Values", "body": "<p>The below modified code will convert any formulas in the indicated worksheets to values, then save the workbook with the specified filename.</p>\n\n<pre><code>Sub CREATE4SHEETS()\nDim WS as Worksheet\nApplication.DisplayAlerts = False\n'For each WS in Sheets(Array(\"sheet1\", \"sheet3\", \"sheet6\", \"sheet7\", \"sheet8\", \"sheet10\"))\n'    WS.UsedRange.Value2 = WS.UsedRange.Value2\n'Next WS\n\nFor each WS in Worksheets\n    If (UBound(Filter(Array(\"sheet1\", \"sheet3\", \"sheet6\", \"sheet7\", \"sheet8\", \"sheet10\"), WS.Name)) &gt; -1) Then\n        'Keep this worksheet\n        WS.UsedRange.Value2 = WS.UsedRange.Value2\n    Else\n        WS.Delete\n    End If\nNext WS\n\nSet WS = Nothing\n\nActiveWorkbook.SaveAs Filename:= _\n    \"\\\\Mac\\Desktp\\newworkbook.xlsx\" _\n    , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False ' need to change the name of the folder\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "accepted_answer_id": 35737792, "answer_count": 1, "score": 2, "last_activity_date": 1456940711, "creation_date": 1456877106, "last_edit_date": 1531164843, "question_id": 35736062, "link": "https://stackoverflow.com/questions/35736062/converting-formulas-in-multiple-worksheets-to-values", "title": "Converting Formulas in Multiple Worksheets to Values", "body": "<p>The below VBA code is intended to convert formulas in multiple worksheets to values, then save a copy of the workbook in the specified directory.</p>\n\n<p>I'm trying to copy paste value only, but the workbook still saves with formulas in these sheets. I don't know what I did wrong,this code doesn't seem to work</p>\n\n<pre><code>Sub CREATE4SHEETS()\nSheets(Array(\"sheet1\", \"sheet3\", \"sheet6\", \"sheet7\", \"sheet8\", \"sheet10\")).Select\nSheets(\"sheet10\").Activate\nSheets(Array(\"sheet1\", \"sheet3\", \"sheet6\", \"sheet7\", \"sheet8\", \"sheet10\")).Copy\n\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues\nChDir \"\\\\mac\\desktop\\\" ' Name folder    \nActiveWorkbook.SaveAs Filename:= _\n    \"\\\\Mac\\Desktp\\newworkbook.xlsx\" _\n    , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False ' need to change the name of the folder\nActiveWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>It seems that</p>\n\n<pre><code>Selection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>is not working as supposed to. Does anyone know why? thanks!   </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1456876083, "post_id": 35735798, "comment_id": 59146127, "body": "Prompt for filename and path via input box then use <code>workbooks.saveas</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1456922490, "post_id": 35736770, "comment_id": 59168239, "body": "This seems like it\u2019s working but I can\u2019t find the file that was saved from your code in the location it says i saved it in."}, {"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1456958774, "post_id": 35736770, "comment_id": 59192714, "body": "I&#39;m not sure if i&#39;m doing something wrong but when it saves let&#39;s say to the desktop the file never shows up on the desktop, but when i right click on excel it&#39;s under recent workbooks but it says its unavailable and may have been deleted"}], "tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": false, "score": 3, "last_activity_date": 1456881803, "creation_date": 1456881803, "answer_id": 35736770, "question_id": 35735798, "link": "https://stackoverflow.com/questions/35735798/open-save-window-in-file-path-from-cell-and-populate-filename-from-cell/35736770#35736770", "title": "Open save window in file path from cell and populate filename from cell", "body": "<p>This will get filename from Cell <code>A1</code> and Path from Cell <code>A2</code> both on <code>Sheet(1)</code>. Ensure that the path is in the format <code>C:\\Users\\name\\</code> remembering to ensure there is a backslash <code>\\</code> after the path.</p>\n\n<pre><code>Sub SaveAs()\nDim fPth As Object\nDim Path As String\nPath = Sheets(1).Range(\"A2\").Text\nfileName = Sheets(1).Range(\"A1\").Text\nSet fPth = Application.FileDialog(msoFileDialogSaveAs)\n\n        With fPth\n            .InitialFileName = Path &amp; fileName &amp; \".xlsx\"\n            .Title = \"Save your File\"\n            .InitialView = msoFileDialogViewList\n            .Show\n        End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1456969944, "creation_date": 1456875511, "last_edit_date": 1456969944, "question_id": 35735798, "link": "https://stackoverflow.com/questions/35735798/open-save-window-in-file-path-from-cell-and-populate-filename-from-cell", "title": "Open save window in file path from cell and populate filename from cell", "body": "<p>I need a simple code that will open the save window in a file location from a cell and also populate the file name from a cell, leaving the save window open so you can edit the path or filename before you click save if need be</p>\n\n<p>I'm using this code but it only populates the filename</p>\n\n<pre><code>Application.Dialogs(xlDialogSaveAs).Show Range(\"A3\").Text &amp; \"- (Submittal)\" &amp; \".xlsx\"\n</code></pre>\n\n<p>I would like it to also open the save window in a file path from cell \"A2\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/R8pB8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R8pB8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also i don't know if it matters but this will be ran on a workbook that has never been saved before </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1456875952, "post_id": 35735792, "comment_id": 59146085, "body": "That&#39;s the <code>personal.xlsb</code> I think... surprised deletion didn&#39;t work. You could also just go in that workbook and just remove all code then nothing should fire."}, {"owner": {"reputation": 932, "user_id": 1618438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3310890e4c84a948b21635415c308bd?s=128&d=identicon&r=PG", "display_name": "QuickDanger", "link": "https://stackoverflow.com/users/1618438/quickdanger"}, "edited": false, "score": 0, "creation_date": 1456876608, "post_id": 35735792, "comment_id": 59146277, "body": "Use SysInternals&#39; <a href=\"https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx\" rel=\"nofollow noreferrer\">Process Monitor</a> tool to help you debug file access and where the modules are stored."}, {"owner": {"reputation": 51, "user_id": 6005112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7df9074319de31f4cb023f81a135a0a?s=128&d=identicon&r=PG&f=1", "display_name": "edrake07", "link": "https://stackoverflow.com/users/6005112/edrake07"}, "edited": false, "score": 0, "creation_date": 1456896368, "post_id": 35735792, "comment_id": 59152102, "body": "Hmm, ok. I actually already did go in and delete the code out. However, I am still getting two extra workbooks opened evertime I launch excel. I tried deleting sheets within the workbooks, but I am getting an error message about deleting hidden items."}, {"owner": {"reputation": 51, "user_id": 6005112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7df9074319de31f4cb023f81a135a0a?s=128&d=identicon&r=PG&f=1", "display_name": "edrake07", "link": "https://stackoverflow.com/users/6005112/edrake07"}, "edited": false, "score": 0, "creation_date": 1456949572, "post_id": 35735792, "comment_id": 59187604, "body": "I was able to track down the actual folder that contains these two files using a search in Process Explorer. <code>C:\\appsensevirtual\\S-1-5-21-1781428526-1902518210-316617838-&zwnj;&#8203;164488\\{B0970185-A62&zwnj;&#8203;4-496C-BE3B-08CE8AAA&zwnj;&#8203;200A}\\_Microsoft Office 2016\\Device\\HarddiskVolume1\\Users\\f370830\\AppData\\Roaming\\Mi&zwnj;&#8203;crosoft\\Excel\\XLSTAR&zwnj;&#8203;T</code>. However, after deleting the two .bas files, they just reappear in the folder when I launch excel. How do I kill the files all together?"}, {"owner": {"reputation": 51, "user_id": 6005112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7df9074319de31f4cb023f81a135a0a?s=128&d=identicon&r=PG&f=1", "display_name": "edrake07", "link": "https://stackoverflow.com/users/6005112/edrake07"}, "edited": false, "score": 0, "creation_date": 1456950357, "post_id": 35735792, "comment_id": 59188084, "body": "I also have a hunch that these files are being launched by this: <code>C:\\Program Files (x86)\\Microsoft Office\\root\\VFS\\ProgramFilesCommonX86\\Microsoft Shared\\VBA\\VBA7.1\\VBE7.DLL</code>. Does anyone know if I can just delete this file and see what happens?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1457022165, "post_id": 35735792, "comment_id": 59226737, "body": "That file sounds like the VBA interpreter, so I would hesitate to delete it."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6005112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7df9074319de31f4cb023f81a135a0a?s=128&d=identicon&r=PG&f=1", "display_name": "edrake07", "link": "https://stackoverflow.com/users/6005112/edrake07"}, "edited": false, "score": 0, "creation_date": 1457030741, "post_id": 35777557, "comment_id": 59232308, "body": "Thanks for the response. Trying to delete a module, then using the export module feature, is exactly what create my whole problem in the first place. I had already copied the module into a new VBA project so I wanted to delete it. Exporting the modules prior to deleting is what created these two pesky .bas files."}, {"owner": {"reputation": 61, "user_id": 6651301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/486bG.jpg?s=128&g=1", "display_name": "antonsachs", "link": "https://stackoverflow.com/users/6651301/antonsachs"}, "edited": false, "score": 0, "creation_date": 1601333351, "post_id": 35777557, "comment_id": 113369522, "body": "The question was how to temove a PROJECT, not a module. A Projest, which got stuck in you main project after you opened and closed a secondary wbk. At this point the only way I can do this is to close ALL excel, and reopen the main workbook."}, {"owner": {"reputation": 61, "user_id": 6651301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/486bG.jpg?s=128&g=1", "display_name": "antonsachs", "link": "https://stackoverflow.com/users/6651301/antonsachs"}, "edited": false, "score": 0, "creation_date": 1601333703, "post_id": 35777557, "comment_id": 113369620, "body": "Exporting modules is very easy - use something like (adjust vars) Stack does nnot allow me to insert code. Try asachs@anton-sachs.com"}], "tags": [], "owner": {"reputation": 75, "user_id": 3853752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0td5.jpg?s=128&g=1", "display_name": "CH3M", "link": "https://stackoverflow.com/users/3853752/ch3m"}, "is_accepted": false, "score": 0, "last_activity_date": 1457022168, "creation_date": 1457022168, "answer_id": 35777557, "question_id": 35735792, "link": "https://stackoverflow.com/questions/35735792/cannot-delete-vba-projects/35777557#35777557", "title": "Cannot Delete VBA Projects", "body": "<p>On windows, open the workbook in question. Once opened, press ALT+F11 to open up the VBA editor.  From there, right click on the module you want to delete in the left-hand navigation pane, and select DELETE (may be called REMOVE).  Excel will likely prompt you to export the module again before removing it; I would suggest saving a copy somewhere but this is entirely up to you.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6005112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7df9074319de31f4cb023f81a135a0a?s=128&d=identicon&r=PG&f=1", "display_name": "edrake07", "link": "https://stackoverflow.com/users/6005112/edrake07"}, "is_accepted": true, "score": 2, "last_activity_date": 1457030604, "creation_date": 1457030604, "answer_id": 35780371, "question_id": 35735792, "link": "https://stackoverflow.com/questions/35735792/cannot-delete-vba-projects/35780371#35780371", "title": "Cannot Delete VBA Projects", "body": "<p>I was able to solve the issue. Like I mentioned in my comment above, I was able to track down the directory storing the two rogue .bas files using the SysInternals program Process Explorer. The files were being saved here:</p>\n\n<p><code>C:\\appsensevirtual\\S-1-5-21-1781428526-1902518210-316617838-164488\\{B0970185-A6\u200c\u200b24-496C-BE3B-08CE8AAA200A}\\_Microsoft Office 2016\\Device\\HarddiskVolume1\\Users\\f370830\\AppData\\Roaming\\Microsoft\\Excel\\XLSTAR\u200c\u200bT</code></p>\n\n<p>as opposed to the normal 'users' directory. Just deleting the .bas files did not stop the two workbooks from launching when I open excel. For some reason opening excel would recreate the .bas files in the XLSTART folder.</p>\n\n<p>I just deleted the entire XLSTART folder, which solved the problem. A new XLSTART folder was created on my next excel launch. </p>\n\n<p>One small side effect is that excel now opens into a grey screen as opposed to a fresh worksheet. But that isn't a big deal to me, 9 times out of 10 I am opening existing workbooks.</p>\n"}, {"comments": [{"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1599121001, "post_id": 63710606, "comment_id": 112676837, "body": "Welcome to Stack Overflow. Before answering an old question having an accepted answer (look for the green \u2713) as well as other answers ensure your answer adds something new or is otherwise helpful in relation to them. Here is a guide on <a href=\"http://stackoverflow.com/help/how-to-answer\">How to Answer</a>."}, {"owner": {"reputation": 61, "user_id": 6651301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/486bG.jpg?s=128&g=1", "display_name": "antonsachs", "link": "https://stackoverflow.com/users/6651301/antonsachs"}, "edited": false, "score": 0, "creation_date": 1601333745, "post_id": 63710606, "comment_id": 113369640, "body": "Dont&#39;t use personal"}], "tags": [], "owner": {"reputation": 1, "user_id": 14210303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gju47Gnz1UfYJUHsjpW1-qtWkAKsQv2ywrCUkvn=k-s128", "display_name": "Elvy Manun&#39;Ebo", "link": "https://stackoverflow.com/users/14210303/elvy-manunebo"}, "is_accepted": false, "score": 0, "last_activity_date": 1599067316, "creation_date": 1599067316, "answer_id": 63710606, "question_id": 35735792, "link": "https://stackoverflow.com/questions/35735792/cannot-delete-vba-projects/63710606#63710606", "title": "Cannot Delete VBA Projects", "body": "<p>This worked for me:</p>\n<hr />\n<p>*************** How to remove the personal.xlsb vba project *******************</p>\n<hr />\n<p>Step 1:\nOn Windows Explorer\n*Click on view tab at the top, three options to the right of file\n* Click on options\n* On the drop down menu click on change folder and Search options\n* Go to view then click show hidden files, folders, and drives\n* Click apply\n* Note, the Personal.xlsb is a hidden file thats why the above is done first</p>\n<p>Step 2:\nOn windows explorer\n* Go to Windows-SSD(C:) i.e the C: folder\n* Double click Users\n* Double click the user in question, Username\n* Double click AppData\n* Double click Roaming\n* Double click Microsoft\n* Double click Excel\n* Double click XLSTART\n* you should find the &quot;Personal.xlsb&quot; Microsoft Excel binary worksheet\n* Select and delete</p>\n<p>Reference:\n<a href=\"https://www.youtube.com/watch?v=EXN-nKwfZ5o\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=EXN-nKwfZ5o</a></p>\n"}], "owner": {"reputation": 51, "user_id": 6005112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7df9074319de31f4cb023f81a135a0a?s=128&d=identicon&r=PG&f=1", "display_name": "edrake07", "link": "https://stackoverflow.com/users/6005112/edrake07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17188, "favorite_count": 0, "accepted_answer_id": 35780371, "answer_count": 3, "score": 3, "last_activity_date": 1599067316, "creation_date": 1456875483, "last_edit_date": 1457021830, "question_id": 35735792, "link": "https://stackoverflow.com/questions/35735792/cannot-delete-vba-projects", "title": "Cannot Delete VBA Projects", "body": "<p>I initially created two new modules in a fresh workbook. I accidentally used the \"Export File...\" feature in the Visual Basic project explorer. This created two new .bas files.</p>\n\n<p>The problem is that now that I have these two objects, they are opening up every time I attempt to launch excel. The files appear to be save in this directory: C:\\Users\\f370830\\AppData\\Roaming\\Microsoft\\excel\\XLSTART. Excel points to this directory when I try to save either the VBA object or the excel book that they launch in.</p>\n\n<p>I do not see the files in this directory. I even deleted the directory using both windows explorer and the command line. However these files still show up my VBA project explorer and launch in new windows when I start excel.</p>\n\n<p>Any suggestions for how to delete these files and prevent them from launching every time I start excel?</p>\n"}, {"tags": ["vba", "email-templates"], "answers": [{"comments": [{"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "edited": false, "score": 0, "creation_date": 1456878104, "post_id": 35735993, "comment_id": 59146760, "body": "Please ask a new question about it, as it is not related to this post. Also if my answer is correct, please mark as answer so other people find it useful. Thanks!"}, {"owner": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456936125, "post_id": 35735993, "comment_id": 59178927, "body": "i got the results Dear + &quot; &quot; +  back without the textbox value"}, {"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "reply_to_user": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456939847, "post_id": 35735993, "comment_id": 59181547, "body": "I tested and it works. The page needs to render (postback) to show the value."}, {"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "reply_to_user": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456940982, "post_id": 35735993, "comment_id": 59182269, "body": "No, I&#39;m using VB.NET."}, {"owner": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456946502, "post_id": 35735993, "comment_id": 59185747, "body": "i used .HTMLBody = strHTML, the strHTML holds the HTML from the SQL server. &lt;td width=&quot;500&quot; style=&quot;font-size: 14px; font-family: Arial, Helvetica, sans-serif;&quot;&gt;     &lt;br&gt;     &lt;p&gt;Dear + &quot; &quot; + &lt;%Response.Write(txtFirstName.Text)%&gt;&lt;/p&gt; &lt;/td&gt;"}, {"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "reply_to_user": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456949084, "post_id": 35735993, "comment_id": 59187297, "body": "Oh, So you are not rendering the html page. I update my answer."}, {"owner": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456954515, "post_id": 35735993, "comment_id": 59190483, "body": "I lie, it actually works ! thank you for the help, it was my textbox property name was incorrect. :)"}, {"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "reply_to_user": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "edited": false, "score": 0, "creation_date": 1456955225, "post_id": 35735993, "comment_id": 59190901, "body": "Cool! I&#39;m glad it helped"}], "tags": [], "owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "is_accepted": true, "score": 1, "last_activity_date": 1456949385, "last_edit_date": 1456949385, "creation_date": 1456876601, "answer_id": 35735993, "question_id": 35735627, "link": "https://stackoverflow.com/questions/35735627/retrieve-email-template-from-sql-and-embed-textbox-in-sql-server/35735993#35735993", "title": "Retrieve Email Template from SQL and embed textbox in sql server", "body": "<p>My suggestion is adding a placeholder like @firstname@ in your html content like below</p>\n\n<pre><code>&lt;td width=\"500\" style=\"font-size: 14px; font-family: Arial, Helvetica, sans-serif;\"&gt;\n    &lt;br&gt;\n    &lt;p&gt;Dear + \" \" + @firstname@&lt;/p&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>Then after reading the html from SQL, you replace @firatname@ with whatever you want.</p>\n\n<p>OR</p>\n\n<p>If you can't add the placeholder, after reading the html, replace the placeholder with with whatever you want</p>\n\n<pre><code>str = replace(htmlContent, \"&lt;p&gt;Dear + '' + txtFirstName.text&lt;/p&gt;\", \"&lt;p&gt;Dear John Smith&lt;/p&gt;\")\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2929248, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6ec9b128a4953d27ab0dced3fd4669a5?s=128&d=identicon&r=PG&f=1", "display_name": "aluminum_starch", "link": "https://stackoverflow.com/users/2929248/aluminum-starch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 35735993, "answer_count": 1, "score": 0, "last_activity_date": 1456949385, "creation_date": 1456874644, "last_edit_date": 1456876504, "question_id": 35735627, "link": "https://stackoverflow.com/questions/35735627/retrieve-email-template-from-sql-and-embed-textbox-in-sql-server", "title": "Retrieve Email Template from SQL and embed textbox in sql server", "body": "<p>I am using VB6,and I have an email template written in HTML.The greeting , \"Dear Customer\", the 'Customer' needs to equal a textbox that holds the customers name(txtFirstName.Text). I have a function that gets the HTML from the database(using sql server 2012).I was wondering within my html , is it possible to embed a VB control like a text box like below?</p>\n\n<pre><code>&lt;td width=\"500\" style=\"font-size: 14px; font-family: Arial, Helvetica, sans-serif;\"&gt;\n    &lt;br&gt;\n    &lt;p&gt;Dear + \"\" + txtFirstName.text&lt;/p&gt;\n&lt;/td&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456873467, "post_id": 35735180, "comment_id": 59145072, "body": "When you say &quot;without deleting the formula&quot;, do you want to say &quot;formatting&quot; (red/blue etc), or really formula (=A1+C5 etc.)?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6005003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff72db39579bf2714e1a75bf66554c?s=128&d=identicon&r=PG&f=1", "display_name": "Gussio", "link": "https://stackoverflow.com/users/6005003/gussio"}, "edited": false, "score": 0, "creation_date": 1456878991, "post_id": 35735351, "comment_id": 59147013, "body": "To clarify, the row being copied needs to remain in place, with all cell values and formatting/formula. Thanks"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 1, "user_id": 6005003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff72db39579bf2714e1a75bf66554c?s=128&d=identicon&r=PG&f=1", "display_name": "Gussio", "link": "https://stackoverflow.com/users/6005003/gussio"}, "edited": false, "score": 0, "creation_date": 1456909035, "post_id": 35735351, "comment_id": 59158446, "body": "OK, I don&#39;t get it then. In your question, you say &quot;clear the contents&quot;. Where do you want to clear the content from? So you don&#39;t want to insert a new row? You want the code to find the next blank row? Can you add  an example to your question?"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 0, "last_activity_date": 1456873348, "creation_date": 1456873348, "answer_id": 35735351, "question_id": 35735180, "link": "https://stackoverflow.com/questions/35735180/macro-to-copy-a-row-insert-it-into-next-blank-row-and-clear-contents/35735351#35735351", "title": "Macro to copy a row, insert it into next blank row and clear contents", "body": "<p>Two solutions, pick the one you like:</p>\n\n<p>Use Cut instead of Copy:</p>\n\n<pre><code>Sub InsertCopyRow()\n\n ActiveCell.Offset(1, 0).EntireRow.Insert\n ActiveCell.EntireRow.Cut ActiveCell.Offset(1, 0).EntireRow\n\nEnd Sub\n</code></pre>\n\n<p>Or clear the contents of the original row after copying:</p>\n\n<pre><code>Sub InsertCopyRow()\n\n ActiveCell.Offset(1, 0).EntireRow.Insert\n ActiveCell.EntireRow.Copy ActiveCell.Offset(1, 0).EntireRow\n ActiveCell.EntireRow.ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6005003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff72db39579bf2714e1a75bf66554c?s=128&d=identicon&r=PG&f=1", "display_name": "Gussio", "link": "https://stackoverflow.com/users/6005003/gussio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 997, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456890171, "creation_date": 1456872600, "last_edit_date": 1592644375, "question_id": 35735180, "link": "https://stackoverflow.com/questions/35735180/macro-to-copy-a-row-insert-it-into-next-blank-row-and-clear-contents", "title": "Macro to copy a row, insert it into next blank row and clear contents", "body": "<p>I need the VBA code to do this:</p>\n<blockquote>\n<p>Copy a row</p>\n<p>insert the copied row into the next blank row</p>\n<p>clear the contents (without deleting the formula or data validation that's in the cells).</p>\n</blockquote>\n<p>I'm currently using this, but it only inserts the row directly underneath the active cell and doesn't clear the contents.</p>\n<pre><code>Sub InsertCopyRow()\n\n   ActiveCell.Offset(1,0).EntireRow.Insert\n   ActiveCell.EntireRow.Copy ActiveCell.Offset(1,0).EntireRow\n\nEnd Sub\n</code></pre>\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456872943, "post_id": 35735011, "comment_id": 59144826, "body": "<code>Right(len(...))</code> makes no sense... Len gives a character count. Right gets the rightmost (last) part of a text. Are you sure you know what you are doing? Try <code>Left(...,1)</code>"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 1, "creation_date": 1456873008, "post_id": 35735011, "comment_id": 59144860, "body": "Shouldn&#39;t you be using Left(Selection.Paragraphs(1).Range, 1)?  Right() returns characters from Right to Left. Left() returns from Left to Right."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1456873083, "post_id": 35735011, "comment_id": 59144895, "body": "Also, you don&#39;t seem to be skipping through the paragraphs. You never use x1 variable, you always keep selecting the first paragraph. Or am I missing something?"}, {"owner": {"reputation": 19, "user_id": 3053462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea13f6bb9371abe56a8d1853e3c8525d?s=128&d=identicon&r=PG&f=1", "display_name": "user3053462", "link": "https://stackoverflow.com/users/3053462/user3053462"}, "edited": false, "score": 0, "creation_date": 1456873203, "post_id": 35735011, "comment_id": 59144941, "body": "whoops, yes, Left, but still no result"}, {"owner": {"reputation": 19, "user_id": 3053462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea13f6bb9371abe56a8d1853e3c8525d?s=128&d=identicon&r=PG&f=1", "display_name": "user3053462", "link": "https://stackoverflow.com/users/3053462/user3053462"}, "edited": false, "score": 0, "creation_date": 1456873507, "post_id": 35735011, "comment_id": 59145090, "body": "+Kris B - well, in the original code (I am trying to modify) in any document, no matter how long it is, the code checks for the len of each paragraph. if it less than so many characters, then it gets underlined - the idea is to find and underline headers in the doc, but instead of checking the len of the para, read the first character of the para, and if it is my var than underline. Same basic routine, just a different qualifying condition."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1456873526, "post_id": 35735011, "comment_id": 59145098, "body": "You need to use the code from Kris B, not just change Right to Left.  Also, you need to change &quot;Selection.Paragraphs(1).Range.Select&quot; To &quot;Selection.Paragraphs(x1).Range.Select&quot;  You are looping through and selecting the same paragraph every time."}, {"owner": {"reputation": 19, "user_id": 3053462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea13f6bb9371abe56a8d1853e3c8525d?s=128&d=identicon&r=PG&f=1", "display_name": "user3053462", "link": "https://stackoverflow.com/users/3053462/user3053462"}, "edited": false, "score": 0, "creation_date": 1456873733, "post_id": 35735011, "comment_id": 59145178, "body": "+OpiedDad and +Kris B -- got it, thanks, Left(Selection.Paragraphs(1).Range, 1) did it"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 3053462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea13f6bb9371abe56a8d1853e3c8525d?s=128&d=identicon&r=PG&f=1", "display_name": "user3053462", "link": "https://stackoverflow.com/users/3053462/user3053462"}, "is_accepted": false, "score": 0, "last_activity_date": 1456873868, "creation_date": 1456873868, "answer_id": 35735474, "question_id": 35735011, "link": "https://stackoverflow.com/questions/35735011/read-first-character-of-a-string-with-ms-word-vba-then-delete-it/35735474#35735474", "title": "Read first character of a string with MS Word VBA then delete it", "body": "<p>For Posterity, thanks to the posters Kris B and OpiesDad:</p>\n\n<pre><code>Sub Underline_Header()\n\nDim numOfParagraphs As Integer\nnumOfParagraphs = ActiveDocument.BuiltInDocumentProperties(\"NUMBER OF PARAGRAPHS\")\nSelection.HomeKey Unit:=wdStory\nFor x1 = 1 To numOfParagraphs\n\nSelection.Paragraphs(1).Range.Select\n\n\nchar1 = Left(Selection.Paragraphs(1).Range, 1)\n If char1 = \"-\" Then\n\nEnd If\n\nSelection.MoveDown Unit:=wdParagraph, Count:=1\n\nNext x1\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 3053462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea13f6bb9371abe56a8d1853e3c8525d?s=128&d=identicon&r=PG&f=1", "display_name": "user3053462", "link": "https://stackoverflow.com/users/3053462/user3053462"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456907976, "creation_date": 1456871850, "last_edit_date": 1456907976, "question_id": 35735011, "link": "https://stackoverflow.com/questions/35735011/read-first-character-of-a-string-with-ms-word-vba-then-delete-it", "title": "Read first character of a string with MS Word VBA then delete it", "body": "<p>I have this code that counts the number of characters in a paragraph, and if it is less than <code>x</code> word underlines:</p>\n\n<pre><code>Sub Underline_Header()\n\n  Dim numOfParagraphs As Integer\n  numOfParagraphs = ActiveDocument.BuiltInDocumentProperties(\"NUMBER OF PARAGRAPHS\")\n  Selection.HomeKey Unit:=wdStory\n\n  For x1 = 1 To numOfParagraphs\n    Selection.Paragraphs(1).Range.Select\n    char_count = Len(Selection.Paragraphs(1).Range)\n\n    If char_count &lt; 50 Then\n      Selection.Font.Underline = True\n      'Selection.TypeText Text:=\"this text\" &amp; Selection\n    End If\n\n  Selection.MoveDown Unit:=wdParagraph, Count:=1\n\n  Next x1\n\nEnd Sub\n</code></pre>\n\n<p>Instead, I am trying to have the macro read the first character of each paragraph, and if it is a <code>-</code> (minus sign), then that is the condition to trigger the underline. I have tried:</p>\n\n<pre><code> char1 = Left(Len(Selection.Paragraphs(1).Range), 1)\n If char1 = \"-\" Then\n</code></pre>\n\n<p>But nothing happens.\nThanks for any help!</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1456925851, "post_id": 35734916, "comment_id": 59170638, "body": "You never actually use the the looping variable &quot;i&quot;; how is the code supposed to know that you want to reference each successive sheet? The problem is that your code  doesn&#39;t specify a sheet at all - so it assumes you want to work on the active sheet."}], "answers": [{"tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 2, "last_activity_date": 1456871980, "creation_date": 1456871980, "answer_id": 35735042, "question_id": 35734916, "link": "https://stackoverflow.com/questions/35734916/loop-a-macro-through-all-worksheets-in-an-excel-workbook/35735042#35735042", "title": "Loop a macro through all worksheets in an Excel workbook", "body": "<p>You need to actually change to each worksheet through each loop. You are basically just referencing the same one. Your code should look like:</p>\n\n<pre><code>Sub WorksheetLoop()\n    Dim WS_Count As Integer\n    Dim I As Integer\n\n    ' Set WS_Count equal to the number of worksheets in the active\n    ' workbook.\n    WS_Count = ActiveWorkbook.Worksheets.Count\n\n    ' Begin the loop.\n    For I = 1 To WS_Count\n\n        ' Insert your code here.\n        Sheets(I).Select ' Added this command to loop through the sheets\n\n        'lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        Range(\"P4\").Select\n        ActiveCell.FormulaR1C1 = \"=RC[-10]&amp;\"\" \"\"&amp;RC[-5]\"\n        Range(\"P4\").Select\n        Selection.AutoFill Destination:=Range(\"P4:P65536\"), Type:=xlFillDefault\n        Range(\"P4:P500\").Select\n        ActiveWindow.SmallScroll Down:=-24\n        Selection.Copy\n        Range(\"R4\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n        Application.CutCopyMode = False\n        ActiveSheet.Range(\"$R4:$R500\").RemoveDuplicates Columns:=1, Header:=xlNo\n        Selection.TextToColumns Destination:=Range(\"R4\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n        Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n        Range(\"U4\").Select\n        ActiveCell.FormulaR1C1 = \"=INDEX(C[-16],MATCH(RC[-3],C[-15],0))\"\n        Range(\"V4\").Select\n        ActiveCell.FormulaR1C1 = \"=INDEX(C[-12],MATCH(RC[-3],C[-11],0))\"\n        Range(\"U4:V4\").Select\n        Selection.AutoFill Destination:=Range(\"U4:V41\"), Type:=xlFillDefault\n        Range(\"U4:V500\").Select\n\n        ' The following line shows how to reference a sheet within\n        ' the loop by displaying the worksheet name in a dialog box.\n\n        'MsgBox ActiveWorkbook.Worksheets(I).Name\n\n    Next I\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p>Have not checked validity of the rest of your code but the command I added will cycle through the sheets. Regards,</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1456875053, "creation_date": 1456875053, "answer_id": 35735713, "question_id": 35734916, "link": "https://stackoverflow.com/questions/35734916/loop-a-macro-through-all-worksheets-in-an-excel-workbook/35735713#35735713", "title": "Loop a macro through all worksheets in an Excel workbook", "body": "<p>Don't loop through the count of the sheets, loop through the sheets.</p>\n\n<p>Also get rid of all those activewindow.smallscroll lines you don't need them and remove the selects. Something like this:</p>\n\n<p><code>Range(\"A1\").Formula = \"Hello\"</code> instead of <code>Range(\"A1\").Select</code> <code>Selection.formula = \"Hello\"</code> Notice you can just delete Select and Selection</p>\n\n<p>Here is an example of how to loop through the sheets:</p>\n\n<pre><code>Sub WS_Stuff()\nDim WS As Worksheet\nFor Each WS In Worksheets\n    MsgBox WS.Name\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1456927943, "last_edit_date": 1495540230, "creation_date": 1456889171, "answer_id": 35737929, "question_id": 35734916, "link": "https://stackoverflow.com/questions/35734916/loop-a-macro-through-all-worksheets-in-an-excel-workbook/35737929#35737929", "title": "Loop a macro through all worksheets in an Excel workbook", "body": "<p>You do not need to <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.select.aspx\" rel=\"nofollow noreferrer\">.Select</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838003.aspx\" rel=\"nofollow noreferrer\">.Activate</a>\u00b9 a worksheet to process commands on it. Reference it with a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> and preface all <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range</a> objects and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells</a> properties with a period (e.g. <code>.</code>) to inherit the parent worksheet reference.</p>\n\n<pre><code>Sub WorksheetLoop()\n\n    Dim lRow As Long, w As Long\n\n    With ActiveWorkbook\n        For w = 1 To .Worksheets.Count\n            With .Worksheets(w)\n                'the last row should be either from column F or K\n                lRow = .Range(\"K\" &amp; .Rows.Count).End(xlUp).Row\n                .Range(\"P4:P\" &amp; lRow).FormulaR1C1 = \"=RC[-10]&amp;CHAR(32)&amp;RC[-5]\"\n                '.Range(\"P4:P\" &amp; lRow).Formula = \"=F4&amp;CHAR(32)&amp;K4\"\n                With .Range(\"R4:R\" &amp; lRow)\n                   .Value = .Range(\"P4:P\" &amp; lRow).Value  'direct value transfer is the preferred method for this\n                   .RemoveDuplicates Columns:=1, Header:=xlNo\n                   .TextToColumns Destination:=.Cells(1), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n                                  Semicolon:=False, Comma:=False, Space:=True, Other:=False, _\n                                  FieldInfo:=Array(Array(1, 1), Array(2, 1))\n                End With\n                'R had duplicates removed; get the new last row\n                lRow = .Range(\"R\" &amp; .Rows.Count).End(xlUp).Row\n                .Range(\"U4:U\" &amp; lRow).FormulaR1C1 = \"=INDEX(C[-16],MATCH(RC[-3],C[-15],0))\"\n                '.Range(\"U4:U\" &amp; lRow).Formula = \"=INDEX(E:E, MATCH(R4, F:F, 0))\"\n                .Range(\"V4:V\" &amp; lRow).FormulaR1C1 = \"=INDEX(C[-12],MATCH(RC[-3],C[-11],0))\"\n                '.Range(\"V4:V\" &amp; lRow).Formula = \"=INDEX(J:J, MATCH(S4, K:K, 0))\"\n\n                With .Range(\"U4:V\" &amp; lRow)\n                    'you left your code with columns U and V selected\n                    'maybe more processing here like:\n                    '.value = .value  '&lt;~~ remove formulas to their values\n                End With\n            End With\n        Next w\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Recorded macro code is very verbose. It is always a good idea to work through the code, remove useless code lines like <code>ActiveWindow.SmallScroll Down:=-24</code> and make general improvements where you can.</p>\n\n<hr>\n\n<p>\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 43, "user_id": 5636145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gOmfc.jpg?s=128&g=1", "display_name": "Merly", "link": "https://stackoverflow.com/users/5636145/merly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2673, "favorite_count": 0, "closed_date": 1456933695, "accepted_answer_id": 35735042, "answer_count": 3, "score": 0, "last_activity_date": 1456927943, "creation_date": 1456871449, "last_edit_date": 1456874702, "question_id": 35734916, "link": "https://stackoverflow.com/questions/35734916/loop-a-macro-through-all-worksheets-in-an-excel-workbook", "closed_reason": "Duplicate", "title": "Loop a macro through all worksheets in an Excel workbook", "body": "<p>I am trying to run a macro through all worksheets in an Excel workbook. I have the code below, but it loops through only the first worksheet. The macro runs in the first worksheet again and again, instead of going on to the next worksheet like it should. Could someone please help?  Below is my VBA code. </p>\n\n<pre><code>Sub WorksheetLoop()\n\n     Dim WS_Count As Integer\n     Dim I As Integer\n\n     ' Set WS_Count equal to the number of worksheets in the active\n     ' workbook.\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\n     ' Begin the loop.\n     For I = 1 To WS_Count\n\n        ' Insert your code here.\n\n 'lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n Range(\"P4\").Select\n ActiveCell.FormulaR1C1 = \"=RC[-10]&amp;\"\" \"\"&amp;RC[-5]\"\n Range(\"P4\").Select\n Selection.AutoFill Destination:=Range(\"P4:P65536\"), Type:=xlFillDefault\n Range(\"P4:P500\").Select\n ActiveWindow.SmallScroll Down:=-24\n Selection.Copy\n Range(\"R4\").Select\n Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n Application.CutCopyMode = False\n ActiveSheet.Range(\"$R4:$R500\").RemoveDuplicates Columns:=1, Header:=xlNo\n Selection.TextToColumns Destination:=Range(\"R4\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n Range(\"U4\").Select\n ActiveCell.FormulaR1C1 = \"=INDEX(C[-16],MATCH(RC[-3],C[-15],0))\"\n Range(\"V4\").Select\n ActiveCell.FormulaR1C1 = \"=INDEX(C[-12],MATCH(RC[-3],C[-11],0))\"\n Range(\"U4:V4\").Select\n Selection.AutoFill Destination:=Range(\"U4:V41\"), Type:=xlFillDefault\n Range(\"U4:V500\").Select\n\n        ' The following line shows how to reference a sheet within\n        ' the loop by displaying the worksheet name in a dialog box.\n\n        'MsgBox ActiveWorkbook.Worksheets(I).Name\n\n     Next I\n    Exit Sub\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1456870004, "post_id": 35734447, "comment_id": 59143469, "body": "Have you tried a loop to go through each row one at a time, copy the data, then Paste Special-&gt;Transpose into a new sheet with the same layout under Column 1?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1456870024, "post_id": 35734447, "comment_id": 59143481, "body": "It will be somewhat easier if you copy all the cells into a single column outside of the original range. (It can still be done the way you want, just maybe easier this way.) Looks like you want the results sorted in a specific manner, so in your initial loop, just copy the cells as you encounter them in the range, then sort the resulting column the way you want it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6004802"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1456872586, "post_id": 35734447, "comment_id": 59144646, "body": "@TheGuyThatDoesn&#39;tKnowMuch I am attempting a solution, at least, similar to what you&#39;ve suggested, but I am getting a runtime error on my code."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6004802"}, "is_accepted": true, "score": 0, "last_activity_date": 1456899482, "creation_date": 1456899482, "answer_id": 35739857, "question_id": 35734447, "link": "https://stackoverflow.com/questions/35734447/moving-columns-to-rows-in-user-selected-range-with-vba-script/35739857#35739857", "title": "Moving Columns To Rows In User-Selected Range With VBA Script", "body": "<p>This is the code that was finally concocted to achieve what I was trying to achieve: </p>\n\n<pre><code>Sub PhotoColumnsToRows()\n\nDim i As Long 'row counter\nDim j As Long 'URL counter - For counting amount of URLs to add\nDim LRow As Long 'last row\n\nApplication.ScreenUpdating = False 'turn screen updating off to stop flickering\n\nLRow = Cells(Rows.Count, \"A\").End(xlUp).Row 'determine current last row\n\ni = 2 'start at row 2\n\nDo While i &lt; LRow\n\n    If IsEmpty(Cells(i, 11)) = False Then 'checks column K for data\n\n        j = Application.WorksheetFunction.CountA(Range(Cells(i, 11), Cells(i, 13))) 'counts amount of Urls between K and M\n\n        Rows(i + 1 &amp; \":\" &amp; i + j).Insert 'insert amount of rows found from countA\n        Range(Cells(i, 11), Cells(i, 11 + j - 1)).Copy 'copies specific range based on CountA\n        Cells(i + 1, 10).PasteSpecial Transpose:=True 'pastespecial transpose below \"J\"\n        Range(Cells(i, 11), Cells(i, 11 + j - 1)).ClearContents 'clear previously copied data\n        LRow = LRow + j 'increments last row by the number of rows added\n\n\n    End If\n\n    i = i + 1 'increment loop\nLoop\n\nApplication.ScreenUpdating = True 'turn back on screen updating\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6004802"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 35739857, "answer_count": 1, "score": 1, "last_activity_date": 1528970330, "creation_date": 1456869658, "last_edit_date": 1592644375, "question_id": 35734447, "link": "https://stackoverflow.com/questions/35734447/moving-columns-to-rows-in-user-selected-range-with-vba-script", "title": "Moving Columns To Rows In User-Selected Range With VBA Script", "body": "<p>I am trying to create a VBA script that would allow me to select a range of data, and then, skipping the first column in the range, move the values the succeeding columns under the first column.</p>\n<h3>Screenshot of my Excel worksheet with annotations</h3>\n<p><img src=\"https://i.stack.imgur.com/ZIBmy.png\" alt=\"Screenshot of my Excel worksheet with annotations\" /></p>\n<p>I need my script to allow me to select a range. Based on that range, if the first column is not null, the values of the remaining columns on that row, if they are not null, need to be copied and pasted special (transposed) below the first column of the row.</p>\n<p>I am beating my brain over the best way to loop through the range, but here is my script code so far:</p>\n<pre><code>Sub ColsToRows()\n\nDim rng As Range\nSet rng = Application.InputBox(&quot;Select a range&quot;, &quot;Obtain Range Object&quot;, Type:=8)\n\nFor Each Row In rng\n    If Not IsNull(rng.Row) Then\n        ActiveCell.Resize(1, 4).Copy\n        ActiveCell.PasteSpecial xlPasteAll, xlPasteSpecialOperationNone, SkipBlanks:=False, Transpose:=True\n    End If\nNext\n\nEnd Sub\n</code></pre>\n<p>Why am I getting a selection error (&quot;This selection is not valid...&quot;)?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 0, "creation_date": 1456871074, "post_id": 35734616, "comment_id": 59143978, "body": "Thanks. This is very informative. I am confined to VBA at the moment and all I need to do is avoid these kinds of &quot;attachments&quot; and catch specific types/extensions; hopefully without resorting to using DisplayName."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 1, "creation_date": 1456893495, "post_id": 35734616, "comment_id": 59151133, "body": "Just check the Attachment.Type property - <a href=\"https://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.outlook.olattachmenttype\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 0, "creation_date": 1456926462, "post_id": 35734616, "comment_id": 59171118, "body": "Thanks. I did see that link but I wasn&#39;t sure it was exhaustive as the enum shown has only four values and the file type property contains at least the integers 1 and 6."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 2, "creation_date": 1456936886, "post_id": 35734616, "comment_id": 59179518, "body": "That&#39;s all there is: olByValue is 1, and olOLE is 6. 4 is olByReference and 5 is olEmbeddedItem. Other values are not used. olByValue is all you care about - you will need to skip attachments with all other types."}, {"owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "edited": false, "score": 0, "creation_date": 1456944265, "post_id": 35734616, "comment_id": 59184342, "body": "Many thanks. I think I must not have enough reputation yet to upvote your comments."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1588483566, "last_edit_date": 1588483566, "creation_date": 1456870234, "answer_id": 35734616, "question_id": 35734416, "link": "https://stackoverflow.com/questions/35734416/how-to-test-filename-property-of-outlook-attachment/35734616#35734616", "title": "How to test FileName property of Outlook attachment", "body": "<p><code>FileName</code> property is only applicable to the regular <code>olByValue</code> type attachments. In your case you are most likely dealing with an olOLE type attachment, which is really a serialized embedded OLE object - the stream stores the bitmap (or metafile) that Outlook uses to represent the image as well as the actual data that the original application that created the data (MSPaint?) can use to edit it.</p>\n\n<p>OLE attachment data is stored in the IStorage interface format. The actual format of the data depends on the application used to create it (MSPaint, Excel, etc.). Outlook Object Model does not let you save such attachments using <code>Attachment.SaveAsFile</code>.</p>\n\n<p>Depending on the language you are using (C++ or Delphi would be best), you will need to open the <code>PR_ATTACH_DATA_OBJ</code> property as <code>IStorage</code> and then extract the data (<code>IAttach::OpenProperty(PR_ATTACH_DATA_OBJ, IID_IStorage, ...)</code>) . Take a look at the message with <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a> - click IMessage button, go to the GetAttachmentTable tab, double click on the OLE attachment, select the <code>PR_ATTACH_DATA_OBJ</code>, right click, <code>IMAPIProp::OpenProperty</code>.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> is an option, it extracts the the attachment data for a dozen or so most popular formats (MSPaint, Excel, Word, PDF, etc.):</p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset OutlookMsg = Application.ActiveExplorer.Selection.Item(1)\nset Msg = Session.GetRDOObjectFromOUtlookObject(OutlookMsg)\nfor each attach in Msg.Attachments\n  attach.SaveAsFile \"c:\\temp\\\" &amp; attach.FileName\nnext\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5919226, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eed5f14adc24baee831415ac4efa7a91?s=128&d=identicon&r=PG&f=1", "display_name": "mmmbeer", "link": "https://stackoverflow.com/users/5919226/mmmbeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 1, "accepted_answer_id": 35734616, "answer_count": 1, "score": 1, "last_activity_date": 1588483566, "creation_date": 1456869540, "last_edit_date": 1456870320, "question_id": 35734416, "link": "https://stackoverflow.com/questions/35734416/how-to-test-filename-property-of-outlook-attachment", "title": "How to test FileName property of Outlook attachment", "body": "<p>Some Outlook VBA code that saves email attachments according to their file names failed on an embedded bitmap image when it tried to access the FileName property of that \"attachment.\"</p>\n\n<p>How can I detect this?  The FileName property is supposed to be a String but neither of these tests catches it:</p>\n\n<pre><code>If objAtt.FileName = \"\" Then ....\nIf objAtt.FileName = vbNullString Then ....\n</code></pre>\n\n<p>But every attempt to access this property throws a run-time error:</p>\n\n<blockquote>\n  <p>Outlook cannot perform this action on this type of attachment.</p>\n</blockquote>\n\n<p>I would prefer not to use the DisplayName property if possible.</p>\n\n<p>Also, it seems that I could filter the attachments according to the value of their FileType properties but I have not been able to find a list associating these Integer values with file types.</p>\n\n<p>Advice is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "edited": false, "score": 1, "creation_date": 1456869176, "post_id": 35734079, "comment_id": 59142976, "body": "reset ccellcount = 0  before starting the second do loop."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4879474, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lZiE5bUNGEc/AAAAAAAAAAI/AAAAAAAAADk/lyz6oAE5twA/photo.jpg?sz=128", "display_name": "yveskas", "link": "https://stackoverflow.com/users/4879474/yveskas"}, "edited": false, "score": 0, "creation_date": 1456870758, "post_id": 35734374, "comment_id": 59143832, "body": "thanks it didn&#39;t click in my mind and I like the F8 suggestion \ud83d\udc4d\ud83c\udffe"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 1, "last_activity_date": 1456869407, "creation_date": 1456869407, "answer_id": 35734374, "question_id": 35734079, "link": "https://stackoverflow.com/questions/35734079/vba-skippin-second-stacked-do-loop/35734374#35734374", "title": "VBA Skippin second stacked Do Loop", "body": "<p>Because you are checking cell E1 for value, and it is empty:</p>\n\n<pre><code>Do While Range(\"A1\").Offset(rcellcount, ccellcount).Value = msge\n</code></pre>\n\n<p>this, with your current variables, translates to:</p>\n\n<pre><code>Do While Range(\"A1\").Offset(0, 4).Value = \"il\"\n</code></pre>\n\n<p>Which is cell E1, which in your example, is empty. So the while loop, since the condition is not met, immediately exits.</p>\n\n<p>Setting ccellcount to 0 could solve your problem.</p>\n\n<p><strong>In future, to understand what a code does:</strong></p>\n\n<ul>\n<li>Use the F8 key to step through the code line-by-line. Then you can mouse-over a variable to see its current value.</li>\n<li>You can also use watches (right click on any highlighted element, and Add Watch) - then monitor its value in the Watches window.</li>\n<li>You can use the Locals window (View/Locals window) to display the values of local variables.</li>\n</ul>\n"}], "owner": {"reputation": 35, "user_id": 4879474, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lZiE5bUNGEc/AAAAAAAAAAI/AAAAAAAAADk/lyz6oAE5twA/photo.jpg?sz=128", "display_name": "yveskas", "link": "https://stackoverflow.com/users/4879474/yveskas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 35734374, "answer_count": 1, "score": 0, "last_activity_date": 1456869407, "creation_date": 1456868409, "question_id": 35734079, "link": "https://stackoverflow.com/questions/35734079/vba-skippin-second-stacked-do-loop", "title": "VBA Skippin second stacked Do Loop", "body": "<p>I am self-learning VBA and would like to figure out why the second do loop does not get executed when I run my code, pasted below:   </p>\n\n<pre><code>Sub Cellhasvalue()\n    Dim msge As String\n    Dim ccellcount, rcellcount As Integer\n    Dim end_count As Integer\n    ccellcount = 0\n    'end_count = 5\n    msge = \"il\"\n    rcellcount = 3\n\n    'For cellcount = 0 To endcount\n    Do While Range(\"A1\").Offset(rcellcount, ccellcount).Value = msge\n        Range(\"A1\").Offset(rcellcount, ccellcount).Select\n        MsgBox \"&gt;&gt; \" + CStr(ccellcount) + \" Has Value\"\n        ccellcount = ccellcount + 1\n    Loop\n    'Next cellcount\n    MsgBox \"FIN&gt;&gt; \" + CStr(ccellcount)\n    rcellcount = 0\n\n    Do While Range(\"A1\").Offset(rcellcount, ccellcount).Value = msge\n        Range(\"A1\").Offset(rcellcount, ccellcount).Select\n        MsgBox \"&gt;&gt; \" + CStr(rcellcount) + \" Has Value\"\n        rcellcount = rcellcount + 1\n    Loop\n    MsgBox \"FIN&gt;&gt; \" + CStr(rcellcount)\nEnd Sub\n</code></pre>\n\n<p>This is basically the excel table that I'm checking on and it starts at cell A1</p>\n\n<pre><code>il  il  il  il\nil  il  il  il\nil  il  il  il\nil  il  il  il\nil  il  il  il\nil  il  il  il\nil  il  il  il\nil  il  il  il\n\nil  il  il  il\n</code></pre>\n"}, {"tags": ["vba", "syntax", "parameter-passing", "powershell-4.0"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456869879, "post_id": 35733964, "comment_id": 59143411, "body": "Wouldn&#39;t you need quotation marks around your parameters? E.g. the path? Try it like this: &quot;&quot;C:\\Program Files (x86)\\mailsend\\send_reports.ps1&quot;&quot;"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456869896, "post_id": 35733964, "comment_id": 59143419, "body": "Also, if you just copy-paste your code to a normal cmd window, does it run properly?"}, {"owner": {"reputation": 57, "user_id": 2958244, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/738550612/picture?type=large", "display_name": "Seva", "link": "https://stackoverflow.com/users/2958244/seva"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456932880, "post_id": 35733964, "comment_id": 59176371, "body": "@vacip I did try to use double quotes, I get a syntax error.  And yes the code works in a cmd window. The issue really seems to be in the arguments passing"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1456934867, "post_id": 35733964, "comment_id": 59177894, "body": "wait, what? if you get syntax error, then there is something wrong with your double quotes. syntax error in VBA, you mean? can you post what you have tried? also, this works withouth quotation marks? but there is a space in Program files. how is that possible? I&#39;m baffled."}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 3661196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cYAyS.jpg?s=128&g=1", "display_name": "runcmd", "link": "https://stackoverflow.com/users/3661196/runcmd"}, "is_accepted": false, "score": 0, "last_activity_date": 1456870533, "creation_date": 1456870533, "answer_id": 35734693, "question_id": 35733964, "link": "https://stackoverflow.com/questions/35733964/how-to-pass-arguments-from-vba-to-powershell-script/35734693#35734693", "title": "How to pass arguments from VBA to Powershell script", "body": "<p>Not sure if this will be the correct answer but it's definitely something you can try. I would suggest providing the full path for PowerShell.exe. For example, </p>\n\n<pre><code> C:\\Windows\\System32\\WindowsPowershell\\v1.0\\powershell.exe\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 2958244, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/738550612/picture?type=large", "display_name": "Seva", "link": "https://stackoverflow.com/users/2958244/seva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1395, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1456870533, "creation_date": 1456867987, "question_id": 35733964, "link": "https://stackoverflow.com/questions/35733964/how-to-pass-arguments-from-vba-to-powershell-script", "title": "How to pass arguments from VBA to Powershell script", "body": "<p>I need to pass some arguments from VBA7 to Powershell script (version 4.0).  I was able to run the PS script by entering all the arguments manually in the Powershell Editor and run it to validate that the script works.  Here is the PS script:</p>\n\n<pre><code>param(\n    $pw,\n    $from =\"\",\n    $to =\"\",\n    $subject = \"\",\n    $body = \"\",\n    $file = \"\",\n    $server = \"imap.myserver.com\",\n    $port = 111\n)\n\n$pw = ConvertTo-SecureString $pw -AsPlainText -Force\n$cred = New-Object System.Management.Automation.PSCredential($from, $pw)\n\ntry{\n    Send-MailMessage -From $from -to $to -SmtpServer $server -Body $body -Subject $subject -Attachments $file -Port $port -Credential $cred -ErrorAction Stop\n    Exit 0;\n    }\ncatch\n    {\n    Write-Host $error[0]\n    Exit 1;\n    }\n</code></pre>\n\n<p>For some reason when I call this script from VBA it doesn't work, I don't have any error message, I can see that Powershell is being called from the macro but nothing happens. Maybe the synthax is not correct? I have tried adding quotes here and there but no sucess. Here is a simplied version of the code:</p>\n\n<pre><code>Sub CallPowerShellWithArguments()\n\n    Call Shell(\"powershell.exe -ExecutionPolicy Bypass C:\\Program Files (x86)\\mailsend\\send_reports.ps1 -pw Mypassword -from myemail1@mail.com -to myemail1@mail.com -subject MyEmail -body This is my test -file C:\\mysql\\test.tx\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 3867, "user_id": 515948, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1abe88862a65973704f7c9b028cf7afe?s=128&d=identicon&r=PG", "display_name": "Laur Ivan", "link": "https://stackoverflow.com/users/515948/laur-ivan"}, "edited": false, "score": 1, "creation_date": 1456867956, "post_id": 35733893, "comment_id": 59142283, "body": "I guess <code>MasterIDIn</code> should be a value, not passed in the string."}, {"owner": {"reputation": 3710, "user_id": 2085217, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/TLqXc.png?s=128&g=1", "display_name": "Fuzzy", "link": "https://stackoverflow.com/users/2085217/fuzzy"}, "edited": false, "score": 0, "creation_date": 1456867962, "post_id": 35733893, "comment_id": 59142291, "body": "does this seem correct? [Range Card Master Mailer].Master_ID  = MasterIDIn"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1456871416, "post_id": 35734151, "comment_id": 59144128, "body": "Got It,, Thanks so much"}], "tags": [], "owner": {"reputation": 2886, "user_id": 4733169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5yy1.jpg?s=128&g=1", "display_name": "JCollerton", "link": "https://stackoverflow.com/users/4733169/jcollerton"}, "is_accepted": false, "score": 0, "last_activity_date": 1456868679, "creation_date": 1456868679, "answer_id": 35734151, "question_id": 35733893, "link": "https://stackoverflow.com/questions/35733893/no-value-given-error-in-where-clause-of-sql/35734151#35734151", "title": "&quot;No value given&quot; error in where clause of sql", "body": "<p>You need to dynamically create the string to allow <code>MasterIDIn</code> to take it's value within the VBA code. At the moment you are actually looking for the <code>MasterID</code> 'MasterIDIn'.    </p>\n\n<pre><code>Dim RCMSql As String\n    RCMSql = \"SELECT [Range Card Master Mailer].Master_ID,\" &amp; _\n    \"[Range Card Master Mailer].MaxOfDate_of_Transaction,\" &amp; _\n    \"[Range Card Master Mailer].FirstName,\" &amp; _\n    \"[Range Card Master Mailer].LastName,\" &amp; _\n    \"[Range Card Master Mailer].Email_Address,\" &amp; _\n    \"[Range Card Master Mailer].Address_Line_1,\" &amp; _\n    \"[Range Card Master Mailer].Phone_Number_1,\" &amp; _\n    \"[Range Card Master Mailer].Phone_Number_2,\" &amp; _\n    \"[Range Card Master Mailer].Date_Sent,\" &amp; _\n    \"[Range Card Master Mailer].CouponValue,\" &amp; _\n    \"[Range Card Master Mailer].RedeemDate,\" &amp; _\n    \"[Range Card Master Mailer].RedeemFlag \" &amp; _\n    \"FROM [Range Card Master Mailer] \" &amp; _\n    \"WHERE ((([Range Card Master Mailer].Master_ID)= \" &amp; MasterIDIn &amp; \"))\"\n     RCMRs.Open RCMSql                       'Fill the recordset\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456874524, "creation_date": 1456867717, "last_edit_date": 1456874524, "question_id": 35733893, "link": "https://stackoverflow.com/questions/35733893/no-value-given-error-in-where-clause-of-sql", "title": "&quot;No value given&quot; error in where clause of sql", "body": "<p>Have the following code:</p>\n\n<pre><code>    Dim MasterIDIn As Double         'Use in where clause\n    MasterIDIn = CDbl(Me!scanTxtBox.Value)\n\n    Dim RCMSql As String\n    RCMSql = \"SELECT [Range Card Master Mailer].Master_ID,\" &amp; _\n    \"[Range Card Master Mailer].MaxOfDate_of_Transaction,\" &amp; _\n    \"[Range Card Master Mailer].FirstName,\" &amp; _\n    \"[Range Card Master Mailer].LastName,\" &amp; _\n    \"[Range Card Master Mailer].Email_Address,\" &amp; _\n    \"[Range Card Master Mailer].Address_Line_1,\" &amp; _\n    \"[Range Card Master Mailer].Phone_Number_1,\" &amp; _\n    \"[Range Card Master Mailer].Phone_Number_2,\" &amp; _\n    \"[Range Card Master Mailer].Date_Sent,\" &amp; _\n    \"[Range Card Master Mailer].CouponValue,\" &amp; _\n    \"[Range Card Master Mailer].RedeemDate,\" &amp; _\n    \"[Range Card Master Mailer].RedeemFlag \" &amp; _\n    \"FROM [Range Card Master Mailer] \" &amp; _\n    \"WHERE ((([Range Card Master Mailer].Master_ID)= MasterIDIn))\"\n     RCMRs.Open RCMSql                       'Fill the recordset\n</code></pre>\n\n<p>The open throws the error </p>\n\n<blockquote>\n  <p>\"No value given for one or more of the parameters\"</p>\n</blockquote>\n\n<p>If I remove the where clause it runs. The Master_ID field on the file is double so I convert the textbox value to double and seems that should work.  In the immediate window MasterIDin and CDbl(Me!scanTxtBox.Value) have the same values.\nI must be missing something.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "csv", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1456868094, "post_id": 35733878, "comment_id": 59142351, "body": "Are the rows always paired by Category ID (will all category IDs always have 2 rows?). If so you can do it doing 2 <code>VLOOKUPS</code> and then concatenate the results."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1456868184, "post_id": 35733878, "comment_id": 59142411, "body": "If the number of rows per Category is indeterminate then you can&#39;t resolve this elegantly with formulas and you would need at least a UDF that concatenates an array. With that you can use <code>IF</code>s and array formulas to pull all rows that match and then join them using the UDF. Regards"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5811454"}, "edited": false, "score": 0, "creation_date": 1456936685, "post_id": 35735467, "comment_id": 59179373, "body": "Thank you, this would work if I only had 2 numbers per each category. I should have used a larger data sample in my question... is there a way I can change this so that ALL of the &quot;HA-MASTER&quot; numbers are included even if there are more rows than 2?"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1456946434, "post_id": 35735467, "comment_id": 59185706, "body": "I updated the formula, it should work as intended now (with as many rows as you need). Since I did it freehand without double checking my work, I made a mistake. I changed &#39;A3&#39; to &#39;C3&#39;, so it accumulates now."}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1456945690, "last_edit_date": 1456945690, "creation_date": 1456873830, "answer_id": 35735467, "question_id": 35733878, "link": "https://stackoverflow.com/questions/35733878/vlookup-with-multiple-matches/35735467#35735467", "title": "Vlookup with multiple matches", "body": "<p>There is a crude way to do it via formula and a 3rd column.</p>\n\n<p>1) In your 3rd column use the follow formula and extend it down.\n    =IF(B2=B3,A2&amp;\", \"&amp;C3,A2)</p>\n\n<p>Note: This assumes your example starts on cell A1. Where A1 = \"HA-MASTER\"</p>\n\n<p>2) Now have your VLOOKUP run and it return the 3rd column on match (instead of the 1st column). VLOOKUP returns the first result it matches, which is now a concatenation of all rows that match it's ID number.</p>\n\n<p>Note: You'll need to make sure all rows are sorted based on Column B (CategoryID) for this to work.</p>\n\n<p>Note2: I am assuming you are looking for the concatenated list, without the CategoryID concatenated to your result.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5811454"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "closed_date": 1456880161, "accepted_answer_id": 35735467, "answer_count": 1, "score": 0, "last_activity_date": 1456945690, "creation_date": 1456867663, "last_edit_date": 1531161705, "question_id": 35733878, "link": "https://stackoverflow.com/questions/35733878/vlookup-with-multiple-matches", "closed_reason": "Duplicate", "title": "Vlookup with multiple matches", "body": "<p>I have an Excel sheet that looks like this.. </p>\n\n<pre><code>HA-MASTER   CategoryID\n38231-S04-A00   14\n39790-S10-A03   14\n38231-S04-A00   15\n39790-S10-A03   15\n38231-S04-A00   16\n39790-S10-A03   16\n38231-S04-A00   17\n39790-S10-A03   17\n38231-S04-A00   18\n39790-S10-A03   18\n38231-S04-A00   19\n39790-S10-A03   19\n38231-S04-A00   20\n39790-S10-A03   20\n38231-S04-A00   21\n39790-S10-A03   21\n38231-S04-A00   22\n39790-S10-A03   22\n38231-S04-A00   23\n</code></pre>\n\n<p>Is there any way to do a vlookup (or something similar) to return something like:</p>\n\n<pre><code>14    38231-S04-A00, 39790-S10-A03\n15    38231-S04-A00, 39790-S10-A03\n\netc...\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3795, "user_id": 4926817, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0lH0y.png?s=128&g=1", "display_name": "Noam Hacker", "link": "https://stackoverflow.com/users/4926817/noam-hacker"}, "edited": false, "score": 0, "creation_date": 1456867292, "post_id": 35733641, "comment_id": 59141931, "body": "why not try deleting the file first if it already exists? <a href=\"http://stackoverflow.com/questions/67835/deleting-a-file-in-vba\">see here for more info</a>"}, {"owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "reply_to_user": {"reputation": 3795, "user_id": 4926817, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0lH0y.png?s=128&g=1", "display_name": "Noam Hacker", "link": "https://stackoverflow.com/users/4926817/noam-hacker"}, "edited": false, "score": 0, "creation_date": 1456867705, "post_id": 35733641, "comment_id": 59142152, "body": "I will resort to that option if all else fails."}, {"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1456869775, "post_id": 35733641, "comment_id": 59143349, "body": "Anything special about the file that it stops at?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1456868273, "post_id": 35733786, "comment_id": 59142460, "body": "it gives me this message: &quot;runtime error 448 - named argument not found&quot;"}, {"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "reply_to_user": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1456868954, "post_id": 35733786, "comment_id": 59142827, "body": "Corrected argument name to OverWriteFiles. Try that."}, {"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "reply_to_user": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1456869410, "post_id": 35733786, "comment_id": 59143113, "body": "The problem is not that the file exists then. Still researching."}, {"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "reply_to_user": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1456869480, "post_id": 35733786, "comment_id": 59143160, "body": "really does sound like a permissions issue"}, {"owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "edited": false, "score": 0, "creation_date": 1456870944, "post_id": 35733786, "comment_id": 59143920, "body": "yes, you were right, I changed folder permissions - now it works like a charm! Do you know if there&#39;s a vba code to change folder&#39;s permissions?"}], "tags": [], "owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "is_accepted": true, "score": 2, "last_activity_date": 1456868933, "last_edit_date": 1456868933, "creation_date": 1456867335, "answer_id": 35733786, "question_id": 35733641, "link": "https://stackoverflow.com/questions/35733641/how-to-copy-a-file-to-a-folder-if-there-is-already-a-file-with-the-same-name/35733786#35733786", "title": "How to copy a file to a folder if there is already a file with the same name?", "body": "<p>The <code>CopyFolder</code> method has an optional <em>OverWriteFiles</em> argument...</p>\n\n<pre><code>FSO.CopyFolder Source:=FromPath, Destination:=topath, OverWriteFiles:=True\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 35733786, "answer_count": 1, "score": 0, "last_activity_date": 1459508568, "creation_date": 1456866864, "last_edit_date": 1459508568, "question_id": 35733641, "link": "https://stackoverflow.com/questions/35733641/how-to-copy-a-file-to-a-folder-if-there-is-already-a-file-with-the-same-name", "title": "How to copy a file to a folder if there is already a file with the same name?", "body": "<p>I am trying to write an Excel VBA macro that will loop through a list of folder paths, fetch all the files inside these folders and copy them to a single folder. Everything works fine until the macro reaches to a file that already exists in the destination folder, and then it returns the message: \"run time error 70 - permission denied\"</p>\n\n<p>here's the code I'm currently using: </p>\n\n<pre><code>FSO.CopyFolder Source:=FromPath, Destination:=topath\n</code></pre>\n\n<p>If possible, I would prefer to overwrite the duplicate files.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1456868542, "post_id": 35733538, "comment_id": 59142626, "body": "This is a wooly hunch but I&#39;ve had a poor experience using application.match with variables - the match would work fine as an Excel formula but not in VB. As a test try putting &quot;business_name&quot; in a cell and using that cell as the first argument. To get round it in the past I&#39;ve just used a for-loop to test for the value on the column in question, the performance difference is negligible."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1456882998, "post_id": 35733538, "comment_id": 59148113, "body": "Most likely, the string <code>&quot;business_name&quot;</code> is not found exactly like that in column 2.  If that is the case, and you use <code>Worksheetfunction.Match</code> instead, you should see 1004 error."}], "owner": {"reputation": 1, "user_id": 6004652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2141367ea85bb2e072bda764f44b51?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/6004652/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456868428, "creation_date": 1456866509, "question_id": 35733538, "link": "https://stackoverflow.com/questions/35733538/excel-vba-application-match-returns-error-13-type-mismatch-on-a-csv-file", "title": "Excel VBA application.match returns error 13 (type mismatch) on a .csv file", "body": "<p>I have the following Excel VBA code:</p>\n\n<pre><code>Dim xlApp As Excel.Application\nDim SearchRequest As Workbook\nDim SecondCols As Variant\nDim businessNameStartRow As Variant\n\nSet xlApp = New Excel.Application\nSet SearchRequest = xlApp.Workbooks.Open(\"test.csv\")\nSecondCols = SearchRequest.Worksheets(1).Range(\"B1\").EntireColumn\nbusinessNameStartRow = Application.Match(\"business_name\", SecondCols, 0)\n</code></pre>\n\n<p>When I run it, Application.match returned error 13 (type mismatch), but when I saved the .csv file as an .xls file and run the same code against the .xls file, it was fine.</p>\n\n<p>Hope somebody can explain why and give a solution without changing the file.</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1456866321, "post_id": 35733358, "comment_id": 59141358, "body": "If at all possible you should change the table. The (n)text datatype has been deprecated in favor of (n)varchar(max) since sql2005. You will have to convert/cast this datatype to a (var)char datatype before you do anything with it anyway. <a href=\"https://msdn.microsoft.com/en-us/library/ms187993.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms187993.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 5178260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86ec91d87deea40f44ddbe192f77b95?s=128&d=identicon&r=PG&f=1", "display_name": "paulbarbin", "link": "https://stackoverflow.com/users/5178260/paulbarbin"}, "is_accepted": false, "score": 1, "last_activity_date": 1456871317, "creation_date": 1456871317, "answer_id": 35734878, "question_id": 35733358, "link": "https://stackoverflow.com/questions/35733358/text-manipulation-in-sql/35734878#35734878", "title": "Text Manipulation in SQL", "body": "<p>You COULD try to get this out of Sql but I think most would agree that Sql is not designed for extensively formatting text.  </p>\n\n<p>As a DBA, I would steer you towards making those fields discrete if possible using normalization or at the very least having a key/value pair table rather than a blob of text that represents both fields and data.  </p>\n\n<p>You could also consider a datatype of XML if you find that you need to store different fields and different responses for each row. </p>\n"}], "owner": {"reputation": 31, "user_id": 5274008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f62a7ac6b4604b17cf4e02f3498d508f?s=128&d=identicon&r=PG&f=1", "display_name": "Linda", "link": "https://stackoverflow.com/users/5274008/linda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456871317, "creation_date": 1456865901, "last_edit_date": 1456866425, "question_id": 35733358, "link": "https://stackoverflow.com/questions/35733358/text-manipulation-in-sql", "title": "Text Manipulation in SQL", "body": "<p>I have a column named <code>body</code>(<code>ntext</code>,<code>null</code>).  Basically anything in the body of the message will come out as one string of text.  See example:</p>\n\n<pre><code>Report Count SITE Type ACCOUNT NUMBER STMT CD COLL SCHEME Previously Touched   Resi Aging 98 Cleveland - 609 Former 22449903 1 RQ-1 1160201\n</code></pre>\n\n<p>I want the result to look like this:</p>\n\n<pre><code>Report Count   SITE              Type   ACCOUNT NUMBER  STMT  CD            \n98            Cleveland - 609    Former  22449903        1     RQ-1 1160201\n</code></pre>\n\n<p>How can I get this output?   Would it be easier to do in EXCEL using VBA verses SQL?  </p>\n\n<p>I am not an expert in SQL.  I am still learning.</p>\n"}]