[{"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1453337791, "post_id": 34913371, "comment_id": 57562462, "body": "Thank you. That worked - there is still a minor flicker, but the dramatic flickering ceased.  I also wondered why a simple sum would cause dramatic flickering."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1453336653, "creation_date": 1453336653, "answer_id": 34913371, "question_id": 34912730, "link": "https://stackoverflow.com/questions/34912730/flickering-on-form-recalc-in-ms-access/34913371#34913371", "title": "Flickering on [Form].[Recalc] in MS Access", "body": "<p>You can use <code>Application.Echo False</code> to turn off screen updating while the Recalc runs. Though I'm a bit surprised that a simple sum would cause dramatic flickering.</p>\n\n<p>Create a function like this in the form module:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function MyRecalc()\n\n    Application.Echo False\n    Me.Recalc\n    Application.Echo True\n\nEnd Function\n</code></pre>\n\n<p>and change the control's AfterUpdate to</p>\n\n<pre><code>=MyRecalc()\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2224, "favorite_count": 0, "accepted_answer_id": 34913371, "answer_count": 1, "score": 1, "last_activity_date": 1453336653, "creation_date": 1453332896, "question_id": 34912730, "link": "https://stackoverflow.com/questions/34912730/flickering-on-form-recalc-in-ms-access", "title": "Flickering on [Form].[Recalc] in MS Access", "body": "<p>I'm working with MS Access 2013 and have a calculation that needs to be updated every time underlying values are changed.  The 'Record' per se doesn't need to be updated, just a 'monitoring' value prior to the record being saved.</p>\n\n<p>The form has 12 fiscal year months (October - September) and a \"currency\" value is entered into each textbox.  Each time the total value for all of the textboxes needs to appear at the bottom every time it is changed.  Currently it does, but it flickers dramatically. </p>\n\n<p>The structure is as follows:</p>\n\n<p>Each textbox has the following formula in the AfterUpdate: <code>=[Form].[Recalc]</code></p>\n\n<p>The \"Total\" textbox has the following formula: </p>\n\n<pre><code>=Nz([txtOCT_Nc],0)+Nz([txtNOV_NC],0)+Nz([txtDEC_NC],0)+Nz([txtJAN_NC],0)+Nz([txtFEB_NC],0)+Nz([txtMAR_NC],0)+Nz([txtAPR_NC],0)+Nz([txtMAY_NC],0)+Nz([txtJUN_NC],0)+Nz([txtJUL_NC],0)+Nz([txtAUG_NC],0)+Nz([txtSEP_NC],0)\n</code></pre>\n\n<p>Is there VBA or a setting that can prevent the flickering?</p>\n"}, {"tags": ["vba", "excel", "cell", "selected"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1453332993, "post_id": 34912717, "comment_id": 57560987, "body": "Change <code>ActiveCell</code> to <code>cell</code>"}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453333088, "post_id": 34912717, "comment_id": 57561020, "body": "Haha wow. Thanks a lot :) Such a small change that fixed everything!"}, {"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1453333255, "post_id": 34912717, "comment_id": 57561082, "body": "Is there a way to select your answer as the best, and my case as resolved?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453333299, "post_id": 34912717, "comment_id": 57561091, "body": "I will post it as an answer."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453333506, "post_id": 34912717, "comment_id": 57561147, "body": "Now just click on the green check mark by the answer and it will then be marked as answered."}], "answers": [{"comments": [{"owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "edited": false, "score": 0, "creation_date": 1453819286, "post_id": 34912826, "comment_id": 57759510, "body": "Thanks again for this :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1453333447, "creation_date": 1453333447, "answer_id": 34912826, "question_id": 34912717, "link": "https://stackoverflow.com/questions/34912717/run-a-macro-through-select-cells/34912826#34912826", "title": "Run a Macro through select cells", "body": "<p>When using a For Each loop.  The variable, in this case <code>cell</code> represents each cell as it iterates.  So changing the loop to this:</p>\n\n<pre><code>For Each cell In rngMyRange.Cells\n    cell = \"Pass\"\nNext cell\n</code></pre>\n\n<p>should do the trick.</p>\n\n<p>ActiveCell only refers to the actual active cell and the loop does not change which cell is active.  It is considered bad form to activate a cell in a loop, as it slows down the code.</p>\n"}], "owner": {"reputation": 216, "user_id": 5818579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153970060781812/picture?type=large", "display_name": "Francis Maltais", "link": "https://stackoverflow.com/users/5818579/francis-maltais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1271, "favorite_count": 0, "accepted_answer_id": 34912826, "answer_count": 1, "score": 1, "last_activity_date": 1453333447, "creation_date": 1453332841, "last_edit_date": 1531164843, "question_id": 34912717, "link": "https://stackoverflow.com/questions/34912717/run-a-macro-through-select-cells", "title": "Run a Macro through select cells", "body": "<p>I need this macro to apply \"Pass\" to every individual cell in my selection. At the moment, even if I select multiple Cells, it only writes Pass on the first one that I selected. </p>\n\n<p>I'm pretty new to this whole codding thing so I know I did something wrong.</p>\n\n<pre><code>Dim rngMyRange As Range\nDim cell As Range\n\nSet rngMyRange = Selection\nFor Each cell In rngMyRange.Cells\nActiveCell = \"Pass\"\nNext cell \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1453331072, "post_id": 34912296, "comment_id": 57560275, "body": "Turn on the macro recorder (bottom left usually), go through the steps you are describing.  Then you can look at the macro, use F8 to step through it and see how it affects your sheet.  Then I suggest reading up on <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">removing <code>.Select</code></a>.  That should get you pretty far. If you need help after this, post the code and whatever else you&#39;ve tried.  What have you searched for, anything? You should find myriad sources on VBA copy/paste."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5818496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-9ntOGGGNxfE/AAAAAAAAAAI/AAAAAAAAADU/FrH5SlMK3FQ/photo.jpg?sz=128", "display_name": "Jerremy Leedham", "link": "https://stackoverflow.com/users/5818496/jerremy-leedham"}, "edited": false, "score": 1, "creation_date": 1453354510, "post_id": 34913017, "comment_id": 57567057, "body": "Thank you so much @BruceWayne! This was exactly what I was looking for.  I ended up going with your code then for step three I used  <code>Sub StepThree() Range(&quot;A1:AC1&quot;).Copy Range(&quot;A4:AC4&quot;)</code>  Thanks again for your assistance it was more than generous :)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1453335001, "last_edit_date": 1453335001, "creation_date": 1453334455, "answer_id": 34913017, "question_id": 34912296, "link": "https://stackoverflow.com/questions/34912296/excel-vba-copy-paste-move/34913017#34913017", "title": "Excel VBA Copy-paste-move", "body": "<p>Normally I wouldn't do this without your showing some effort, but why not?  The below are about as simple as I can get.  Please still though, use the macro recorder to see how this all works. It's how a lot of us get started.</p>\n\n<pre><code>Sub StepOne()\nDim myRow As Long\nmyRow = 1 ' We will \"copy/paste\" on Row 1\n' To avoid using the clipboard, you can simply set two ranges' values equal. This will\n' clear out any formulas and leave the values.\nRows(myRow).Value = Rows(myRow).Value\nEnd Sub\n</code></pre>\n\n<p>And the second:</p>\n\n<pre><code>Sub StepTwo()\nDim rng As Range\n'Change this as required. Note the use of `Set` with a `Range` type.\nSet rng = Range(\"A1:A10\")\nrng.Cut rng.Offset(1, 0)\nEnd Sub\n</code></pre>\n\n<p>And the last one: </p>\n\n<pre><code>Sub StepThree()\n' Not tellin :P!  You should be able to get this. Hint: look at StepOne.  \nEnd Sub\n</code></pre>\n\n<p>Edit: Ah, I realize now that Step Three is a little more involved than setting two ranges equal since you want to maintain the formula. However, I'll leave this as a learning opportunity for you to investigate.  If you can't figure it out, let me know and I can guide you. :D</p>\n"}], "owner": {"reputation": 97, "user_id": 5818496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-9ntOGGGNxfE/AAAAAAAAAAI/AAAAAAAAADU/FrH5SlMK3FQ/photo.jpg?sz=128", "display_name": "Jerremy Leedham", "link": "https://stackoverflow.com/users/5818496/jerremy-leedham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 34913017, "answer_count": 1, "score": 0, "last_activity_date": 1453335001, "creation_date": 1453330818, "question_id": 34912296, "link": "https://stackoverflow.com/questions/34912296/excel-vba-copy-paste-move", "title": "Excel VBA Copy-paste-move", "body": "<p>I am only new to VBA coding so I don't have much of a clue of what I am doing unfortunately. I was hoping that I could get a hand here. </p>\n\n<p>What I want to do is.</p>\n\n<p><strong>Step One</strong>: Copy a line (which has formulas) and paste it in the same position but as values only.<br>\n<strong>Step Two</strong>: Move a selection of cells down one line.<br>\n<strong>Step Three</strong>: Copy a line (with formulas) and past it on another line with the formulas. </p>\n\n<p>This is all done on the same sheet.</p>\n\n<p>If I could get some help with this or some direction to some tutorials that would be really appreciated. </p>\n"}, {"tags": ["excel", "vba", "pdf", "export-to-pdf"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 2386823, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/XOTPF.jpg?s=128&g=1", "display_name": "Ludus H", "link": "https://stackoverflow.com/users/2386823/ludus-h"}, "edited": false, "score": 0, "creation_date": 1453366863, "post_id": 34911881, "comment_id": 57572611, "body": "Thanks, but I have implemented similar solution but doesn&#39;t work for me as I planned and described it in my question."}], "tags": [], "owner": {"reputation": 56, "user_id": 3896311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545399a36717639c80239a887a698e5d?s=128&d=identicon&r=PG&f=1", "display_name": "cdatwork", "link": "https://stackoverflow.com/users/3896311/cdatwork"}, "is_accepted": false, "score": 2, "last_activity_date": 1453329000, "creation_date": 1453329000, "answer_id": 34911881, "question_id": 34911758, "link": "https://stackoverflow.com/questions/34911758/how-to-print-multiply-sheets-with-selected-page-range-into-single-pdf-file-with/34911881#34911881", "title": "How to print multiply sheets with selected page range into single PDF file with VBA", "body": "<p>If you want to print the entire workbook and all pages within to a single pdf, try:</p>\n\n<pre><code>Sub Print_Workbook()\n    ActiveWorkbook.ExportAsFixedFormat xlTypePDF, \"[C:\\your_filename_here].pdf\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 239, "user_id": 2386823, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/XOTPF.jpg?s=128&g=1", "display_name": "Ludus H", "link": "https://stackoverflow.com/users/2386823/ludus-h"}, "edited": false, "score": 0, "creation_date": 1453367152, "post_id": 34913677, "comment_id": 57572795, "body": "Thanks but it doesn&#39;t match my needs; as I said, my workbook consist of 8 sheets, but I want to print particular pages of each sheets, not as much as there exist pages, for example I need to print: sheet1; 1 and 2 pages sheet2; 1,2 and 3 pages sheet3; 1 page ... sheet8; only 1 page Thanks to all for your effort to help"}], "tags": [], "owner": {"reputation": 99, "user_id": 3379611, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bcaad6272961d96c659efa3570af522d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelsons Development Solutions", "link": "https://stackoverflow.com/users/3379611/nelsons-development-solutions"}, "is_accepted": false, "score": 1, "last_activity_date": 1453338717, "creation_date": 1453338717, "answer_id": 34913677, "question_id": 34911758, "link": "https://stackoverflow.com/questions/34911758/how-to-print-multiply-sheets-with-selected-page-range-into-single-pdf-file-with/34913677#34913677", "title": "How to print multiply sheets with selected page range into single PDF file with VBA", "body": "<p>Here you go. Tested and working. </p>\n\n<pre><code>Sub SaveToPDF()\n\n'This is where we will save the file to a PDF\n   Sheets(Array(\"Sheet1\", \"Sheet2\")).Select\n   ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n   \"insert file path here\\insertfilename.pdf\", _\n   IgnorePrintAreas:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 239, "user_id": 2386823, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/XOTPF.jpg?s=128&g=1", "display_name": "Ludus H", "link": "https://stackoverflow.com/users/2386823/ludus-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1453385388, "creation_date": 1453385388, "answer_id": 34926034, "question_id": 34911758, "link": "https://stackoverflow.com/questions/34911758/how-to-print-multiply-sheets-with-selected-page-range-into-single-pdf-file-with/34926034#34926034", "title": "How to print multiply sheets with selected page range into single PDF file with VBA", "body": "<p>I have controlled each Sheet, from Sheet1...Sheet8 thru menu option View -> Page Break View, where I adjusted by mouse print margins on right and lower side. Then plain routine printed it well, without hassle:</p>\n\n<pre><code>ThisWorkbook.Sheets(Array(\"Sheet1\", \"Sheet2\",... \"Sheet8\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\my_workbook.pdf\", Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n     IgnorePrintAreas:=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>and it works, for now. I don't know is there some dependency of Excel version (2000 - 2013), because i can't check it. Thanks to all for visit and help.</p>\n"}], "owner": {"reputation": 239, "user_id": 2386823, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/XOTPF.jpg?s=128&g=1", "display_name": "Ludus H", "link": "https://stackoverflow.com/users/2386823/ludus-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 1, "accepted_answer_id": 34926034, "answer_count": 3, "score": 0, "last_activity_date": 1453385388, "creation_date": 1453328437, "question_id": 34911758, "link": "https://stackoverflow.com/questions/34911758/how-to-print-multiply-sheets-with-selected-page-range-into-single-pdf-file-with", "title": "How to print multiply sheets with selected page range into single PDF file with VBA", "body": "<p>I have a workbook with 8 sheets and I planned to export all of them into single PDF file, but some sheets consist of only one page, and some of them have 2 or 3 pages to print. How to write it by using VBA? I tried to figure out some idea but all examples explained situation where multiple sheets is printed without taking in account number of pages on each sheets, is it possible?\nThank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1453334284, "post_id": 34911413, "comment_id": 57561433, "body": "The line, &quot;ctl.SetFocus&quot; in the HookListBoxScroll procedure is what is activating the listbox.  It is likely that if you remove that portion and change it to &quot;Exit Sub&quot; then this will only work when the listbox is already activated.  There may need to be some more tweaking as I haven&#39;t actually put this code into an Excel workbook to test it."}, {"owner": {"reputation": 1129, "user_id": 5802882, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e87386662fd241c6b9695615e79d2573?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/5802882/luiz"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1453343551, "post_id": 34911413, "comment_id": 57563984, "body": "It was solved on that link above. But thank you all for the attention. =)"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1453928590, "post_id": 34911413, "comment_id": 57820055, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17660082/excel-2010-userform-form-does-not-scroll-with-mouse-wheel\">Excel 2010 UserForm - form does not scroll with Mouse Wheel</a>"}], "answers": [{"comments": [{"owner": {"reputation": 849, "user_id": 11643124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXhYR.jpg?s=128&g=1", "display_name": "Bandoleras", "link": "https://stackoverflow.com/users/11643124/bandoleras"}, "edited": false, "score": 0, "creation_date": 1594127584, "post_id": 37094080, "comment_id": 111012654, "body": "This can&#39;t be compiled on my Excel, someone knows the reason?"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "reply_to_user": {"reputation": 849, "user_id": 11643124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXhYR.jpg?s=128&g=1", "display_name": "Bandoleras", "link": "https://stackoverflow.com/users/11643124/bandoleras"}, "edited": false, "score": 0, "creation_date": 1616371205, "post_id": 37094080, "comment_id": 117973929, "body": "@Bandoleras you must be on a 64-bit machine (like me).  <a href=\"https://stackoverflow.com/a/5514745/5640342\">Check out this StackOverflow question/answer</a> on how to adapt declared functions to work in a 64-bit environment."}], "tags": [], "owner": {"reputation": 1129, "user_id": 5802882, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e87386662fd241c6b9695615e79d2573?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/5802882/luiz"}, "is_accepted": true, "score": 0, "last_activity_date": 1462657825, "creation_date": 1462657825, "answer_id": 37094080, "question_id": 34911413, "link": "https://stackoverflow.com/questions/34911413/mouse-scroll-on-a-listbox/37094080#37094080", "title": "Mouse scroll on a listbox", "body": "<p>This will work =)</p>\n\n<pre><code>Option Explicit\n\n'This will compile in 32 bit Excel only\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n                            (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function GetWindowLong Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hWnd As Long, ByVal nIndex As Long) As Long\n\nPrivate Declare Function GetForegroundWindow Lib \"user32\" () As Long\n\nPrivate Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" _\n                       (ByVal Destination As Long, ByVal Source As Long, ByVal Length As Long)\n\nPrivate Declare Function SetWindowsHookEx Lib _\n                                  \"user32\" Alias \"SetWindowsHookExA\" (ByVal idHook As Long, ByVal lpfn As Long, _\n                                                                      ByVal hmod As Long, ByVal dwThreadId As Long) As Long\n\nPrivate Declare Function CallNextHookEx Lib \"user32\" (ByVal hHook As Long, _\n                                              ByVal nCode As Long, ByVal wParam As Long, lParam As Any) As Long\n\nPrivate Declare Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As Long) As Long\n\nPrivate Type POINTAPI\n  x As Long\n  Y As Long\nEnd Type\n\nPrivate Type MSLLHOOKSTRUCT  'Will Hold the lParam struct Data\n  pt As POINTAPI\n  mouseData As Long  ' Holds Forward\\Backward flag\n  flags As Long\n  time As Long\n  dwExtraInfo As Long\nEnd Type\n\nPrivate Const HC_ACTION = 0\nPrivate Const WH_MOUSE_LL = 14\nPrivate Const WM_MOUSEWHEEL = &amp;H20A\nPrivate Const GWL_HINSTANCE = (-6)\n\nPublic Const nMyControlTypeNONE = 0\nPublic Const nMyControlTypeUSERFORM = 1\nPublic Const nMyControlTypeFRAME = 2\nPublic Const nMyControlTypeCOMBOBOX = 3\nPublic Const nMyControlTypeLISTBOX = 4\n\nPrivate hhkLowLevelMouse As Long\nPrivate udtlParamStuct As MSLLHOOKSTRUCT\n\nPublic myGblUserForm As UserForm\nPublic myGblControlObject As Object\nPublic iGblControlType As Integer\n\nPublic myGblUserFormControl As Object\n\nFunction GetHookStruct(ByVal lParam As Long) As MSLLHOOKSTRUCT\n' VarPtr returns address; LenB returns size in bytes.\n  CopyMemory VarPtr(udtlParamStuct), lParam, LenB(udtlParamStuct)\n  GetHookStruct = udtlParamStuct\nEnd Function\n\nFunction LowLevelMouseProc _\n         (ByVal nCode As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\n\n  'Avoid XL crashing if RunTime error occurs due to Mouse fast movement\n\n  Dim iDirection As Long\n\n  On Error Resume Next\n  '    \\\\ Unhook &amp; get out in case the application is deactivated\n  If GetForegroundWindow &lt;&gt; FindWindow(\"ThunderDFrame\", myGblUserForm.Caption) Then\n    UnHook_Mouse\n    Exit Function\n  End If\n  If (nCode = HC_ACTION) Then\n    If wParam = WM_MOUSEWHEEL Then\n\n      iDirection = GetHookStruct(lParam).mouseData\n      Call ProcessMouseWheelMovement(iDirection)\n\n      '\\\\ Don't process Default WM_MOUSEWHEEL Window message\n      LowLevelMouseProc = True\n    End If\n\n    Exit Function\n  End If\n  LowLevelMouseProc = CallNextHookEx(0, nCode, wParam, ByVal lParam)\nEnd Function\n\nSub Hook_Mouse()\n' Statement to maintain the handle of the hook if clicking outside of the control.\n' There isn't a Hinstance for Application, so used GetWindowLong to get handle.\n  If hhkLowLevelMouse &lt; 1 Then\n    hhkLowLevelMouse = SetWindowsHookEx(WH_MOUSE_LL, AddressOf LowLevelMouseProc, _\n      GetWindowLong(FindWindow(\"ThunderDFrame\", myGblUserForm.Caption), GWL_HINSTANCE), 0)\n  End If\nEnd Sub\n\nSub UnHook_Mouse()\n  If hhkLowLevelMouse &lt;&gt; 0 Then\n    UnhookWindowsHookEx hhkLowLevelMouse\n    hhkLowLevelMouse = 0\n  End If\nEnd Sub\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'UserForm MouseWheel Code\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nPublic Sub ProcessMouseWheelMovement(ByVal iDirection As Long)\n  'This processes MouseWheel Scrolls\n  '\n  'Thank You Mathieu Plante from July 2004\n\n  Dim i As Long\n  Dim iMultiplier As Long\n\n  'Debug.Print iDirection, iGblControlType, Now()\n\n\n  Select Case iGblControlType\n\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    'UserForm Mouse Scroll\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    Case nMyControlTypeUSERFORM\n\n      iMultiplier = 3\n\n      If iDirection &gt; 0 Then\n\n        For i = 1 To iMultiplier\n          myGblControlObject.Scroll fmScrollActionNoChange, fmScrollActionLineUp\n        Next i\n      Else\n        For i = 1 To iMultiplier\n          myGblControlObject.Scroll fmScrollActionNoChange, fmScrollActionLineDown\n        Next i\n      End If\n\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    'Frame Mouse Scroll\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    Case nMyControlTypeFRAME\n\n      iMultiplier = 5\n\n      If iDirection &gt; 0 Then\n\n        For i = 1 To iMultiplier\n          myGblControlObject.Scroll fmScrollActionNoChange, fmScrollActionLineUp\n        Next i\n      Else\n        For i = 1 To iMultiplier\n          myGblControlObject.Scroll fmScrollActionNoChange, fmScrollActionLineDown\n        Next i\n      End If\n\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    'ComboBox Mouse Scroll\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    Case nMyControlTypeCOMBOBOX\n\n      With myGblControlObject\n        '\\\\ if rolling forward increase Top index by 1 to cause an Up Scroll\n        If iDirection &gt; 0 Then\n          .TopIndex = .TopIndex - 1\n        Else  '\\\\ if rolling backward decrease Top index by 1 to cause a Down Scroll\n          .TopIndex = .TopIndex + 1\n        End If\n      End With\n      'Debug.Print \"Top Index = \" &amp; myGblControlObject.TopIndex\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    'Listbox Mouse Scroll\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    Case nMyControlTypeLISTBOX\n\n      With myGblControlObject\n        '\\\\ if rolling forward increase Top index by 1 to cause an Up Scroll\n        If iDirection &gt; 0 Then\n          .TopIndex = .TopIndex - 1\n        Else  '\\\\ if rolling backward decrease Top index by 1 to cause a Down Scroll\n          .TopIndex = .TopIndex + 1\n        End If\n      End With\n      'Debug.Print \"Top Index = \" &amp; myGblControlObject.TopIndex\n\n  End Select\n\nEnd Sub\n</code></pre>\n\n<p>Credit to LJMetzer from Excel Forum.</p>\n"}], "owner": {"reputation": 1129, "user_id": 5802882, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e87386662fd241c6b9695615e79d2573?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/5802882/luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11708, "favorite_count": 2, "accepted_answer_id": 37094080, "answer_count": 1, "score": 1, "last_activity_date": 1504584101, "creation_date": 1453327062, "last_edit_date": 1470966273, "question_id": 34911413, "link": "https://stackoverflow.com/questions/34911413/mouse-scroll-on-a-listbox", "title": "Mouse scroll on a listbox", "body": "<p>I'm using this code from Peter Thornton which enables me to scroll in a userform listbox, but every time my mouse goes through the listbox (just moving the cursor to another part of the userform, without even clicking) it \"activates\" the listbox. Is there any way I can \"block\" this from happening? I mean, any way that the mouse scroll can work only when I click on that down arrow to open the listbox?</p>\n\n<p>This is Peter Thronton's code:</p>\n\n<pre><code>'''''' normal module code\n\nOption Explicit\n\nPrivate Type POINTAPI\n        X As Long\n        Y As Long\nEnd Type\n\nPrivate Type MOUSEHOOKSTRUCT\n        pt As POINTAPI\n        hwnd As Long\n        wHitTestCode As Long\n        dwExtraInfo As Long\nEnd Type\n\nPrivate Declare Function FindWindow Lib \"user32\" _\n                                        Alias \"FindWindowA\" ( _\n                                                        ByVal lpClassName As String, _\n                                                        ByVal lpWindowName As String) As Long\n\nPrivate Declare Function GetWindowLong Lib \"user32.dll\" _\n                                        Alias \"GetWindowLongA\" ( _\n                                                        ByVal hwnd As Long, _\n                                                        ByVal nIndex As Long) As Long\n\nPrivate Declare Function SetWindowsHookEx Lib \"user32\" _\n                                        Alias \"SetWindowsHookExA\" ( _\n                                                        ByVal idHook As Long, _\n                                                        ByVal lpfn As Long, _\n                                                        ByVal hmod As Long, _\n                                                        ByVal dwThreadId As Long) As Long\n\nPrivate Declare Function CallNextHookEx Lib \"user32\" ( _\n                                                        ByVal hHook As Long, _\n                                                        ByVal nCode As Long, _\n                                                        ByVal wParam As Long, _\n                                                        lParam As Any) As Long\n\nPrivate Declare Function UnhookWindowsHookEx Lib \"user32\" ( _\n                                                        ByVal hHook As Long) As Long\n\n'Private Declare Function PostMessage Lib \"user32.dll\" _\n'                                         Alias \"PostMessageA\" ( _\n'                                                         ByVal hwnd As Long, _\n'                                                         ByVal wMsg As Long, _\n'                                                         ByVal wParam As Long, _\n'                                                         ByVal lParam As Long) As Long\n\nPrivate Declare Function WindowFromPoint Lib \"user32\" ( _\n                                                        ByVal xPoint As Long, _\n                                                        ByVal yPoint As Long) As Long\n\nPrivate Declare Function GetCursorPos Lib \"user32.dll\" ( _\n                                                        ByRef lpPoint As POINTAPI) As Long\n\nPrivate Const WH_MOUSE_LL As Long = 14\nPrivate Const WM_MOUSEWHEEL As Long = &amp;H20A\nPrivate Const HC_ACTION As Long = 0\nPrivate Const GWL_HINSTANCE As Long = (-6)\n\n'Private Const WM_KEYDOWN As Long = &amp;H100\n'Private Const WM_KEYUP As Long = &amp;H101\n'Private Const VK_UP As Long = &amp;H26\n'Private Const VK_DOWN As Long = &amp;H28\n'Private Const WM_LBUTTONDOWN As Long = &amp;H201\n\nPrivate mLngMouseHook As Long\nPrivate mListBoxHwnd As Long\nPrivate mbHook As Boolean\nPrivate mCtl As MSForms.Control\nDim n As Long\n\nSub HookListBoxScroll(frm As Object, ctl As MSForms.Control)\nDim lngAppInst As Long\nDim hwndUnderCursor As Long\nDim tPT As POINTAPI\n     GetCursorPos tPT\n     hwndUnderCursor = WindowFromPoint(tPT.X, tPT.Y)\n     If Not frm.ActiveControl Is ctl Then\n             ctl.SetFocus\n     End If\n     If mListBoxHwnd &lt;&gt; hwndUnderCursor Then\n             UnhookListBoxScroll\n             Set mCtl = ctl\n             mListBoxHwnd = hwndUnderCursor\n             lngAppInst = GetWindowLong(mListBoxHwnd, GWL_HINSTANCE)\n             ' PostMessage mListBoxHwnd, WM_LBUTTONDOWN, 0&amp;, 0&amp;\n             If Not mbHook Then\n                     mLngMouseHook = SetWindowsHookEx( _\n                                                     WH_MOUSE_LL, AddressOf MouseProc, lngAppInst, 0)\n                     mbHook = mLngMouseHook &lt;&gt; 0\n             End If\n     End If\nEnd Sub\n\nSub UnhookListBoxScroll()\n     If mbHook Then\n                Set mCtl = Nothing\n             UnhookWindowsHookEx mLngMouseHook\n             mLngMouseHook = 0\n             mListBoxHwnd = 0\n             mbHook = False\n        End If\nEnd Sub\n\nPrivate Function MouseProc( _\n             ByVal nCode As Long, ByVal wParam As Long, _\n             ByRef lParam As MOUSEHOOKSTRUCT) As Long\nDim idx As Long\n        On Error GoTo errH\n     If (nCode = HC_ACTION) Then\n             If WindowFromPoint(lParam.pt.X, lParam.pt.Y) = mListBoxHwnd Then\n                     If wParam = WM_MOUSEWHEEL Then\n                                MouseProc = True\n'                                If lParam.hwnd &gt; 0 Then\n'                                        PostMessage mListBoxHwnd, WM_KEYDOWN, VK_UP, 0\n'                                Else\n'                                        PostMessage mListBoxHwnd, WM_KEYDOWN, VK_DOWN, 0\n'                                End If\n'                                PostMessage mListBoxHwnd, WM_KEYUP, VK_UP, 0\n                                If lParam.hwnd &gt; 0 Then idx = -1 Else idx = 1\n'                             idx = idx + mCtl.ListIndex\n'                             If idx &gt;= 0 Then mCtl.ListIndex = idx\n                             idx = idx + mCtl.TopIndex\n                             If idx &gt;= 0 Then mCtl.TopIndex = idx\n                                Exit Function\n                     End If\n             Else\n                     UnhookListBoxScroll\n             End If\n     End If\n     MouseProc = CallNextHookEx( _\n                             mLngMouseHook, nCode, wParam, ByVal lParam)\n     Exit Function\nerrH:\n     UnhookListBoxScroll\nEnd Function\n'''''''' end normal module code\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1453326209, "post_id": 34911129, "comment_id": 57557920, "body": "For formulas, you have <a href=\"https://support.office.com/en-IE/article/Set-rounding-precision-e5d707e3-07a8-4df2-810c-218c531eb06a\" rel=\"nofollow noreferrer\">Precision as displayed</a>. For VBA, you must follow the general rules, which is to never compare floats for equality."}, {"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453326592, "post_id": 34911129, "comment_id": 57558149, "body": "@ScottCraner, I want to compare them at whatever level of precision they have when their value is output in the Immediate window.  In this case it&#39;s 2 places, but it could be any number of places."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1453326594, "post_id": 34911129, "comment_id": 57558150, "body": "You could try rounding to the desired level of precision; or do your comparison by checking that the absolute difference between the two values is small enough to assure your desired level of precision."}, {"owner": {"reputation": 1425, "user_id": 1742115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jIFz9.jpg?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/1742115/rlh"}, "edited": false, "score": 0, "creation_date": 1453326614, "post_id": 34911129, "comment_id": 57558167, "body": "This may be too specific of an answer but for the above you could <code>int(Cell1.value*100) &lt;&gt; int(Cell2.value*100)</code> if there isn&#39;t a more graceful way."}, {"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "reply_to_user": {"reputation": 1425, "user_id": 1742115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jIFz9.jpg?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/1742115/rlh"}, "edited": false, "score": 0, "creation_date": 1453326831, "post_id": 34911129, "comment_id": 57558271, "body": "@RLH, in many cases there will be more than 2 places of precision."}, {"owner": {"reputation": 1425, "user_id": 1742115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jIFz9.jpg?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/1742115/rlh"}, "edited": false, "score": 0, "creation_date": 1453328292, "post_id": 34911129, "comment_id": 57559058, "body": "@sigil, How will you determine what the precision is supposed to be and is it variable?"}, {"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "reply_to_user": {"reputation": 1425, "user_id": 1742115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jIFz9.jpg?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/1742115/rlh"}, "edited": false, "score": 0, "creation_date": 1453330007, "post_id": 34911129, "comment_id": 57559808, "body": "@RLH, it&#39;s whatever the precision is when I output the result of <code>?someRange.Value</code> to the Immediate window."}], "answers": [{"comments": [{"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "edited": false, "score": 1, "creation_date": 1453401388, "post_id": 34912627, "comment_id": 57596208, "body": "I ended up using something similar to this for my solution."}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 1, "last_activity_date": 1453333912, "last_edit_date": 1453333912, "creation_date": 1453332411, "answer_id": 34912627, "question_id": 34911129, "link": "https://stackoverflow.com/questions/34911129/how-to-check-for-hidden-number-precision-in-an-excel-range/34912627#34912627", "title": "How to check for hidden number precision in an Excel range?", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test()\n\n  Dim Rng1 As Range, Rng2 As Range\n\n    Set Rng1 = Range(\"A1\") ' just for test example\n    Set Rng2 = Range(\"A2\") ' just for test example\n    'Rng1.Value = 0.45 ' just for test example\n    'Rng2.Value = 0.45 - 5.55111512312578E-17 ' just for test example\n    cell1 = Rng1.Value\n    cell2 = Rng2.Value\n    If IsNumeric(cell1) Then cell1 = Val(cell1)\n    If IsNumeric(cell2) Then cell2 = Val(cell2)\n    Debug.Print cell1 = cell2\n    Debug.Print cell1 - cell2 ' if both are numbers\n\nExit Sub\n</code></pre>\n\n<p>also we can use <code>CDbl(CStr(cell1))</code> instead of <code>Val(cell1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1453335357, "creation_date": 1453335357, "answer_id": 34913166, "question_id": 34911129, "link": "https://stackoverflow.com/questions/34911129/how-to-check-for-hidden-number-precision-in-an-excel-range/34913166#34913166", "title": "How to check for hidden number precision in an Excel range?", "body": "<p>I'm not sure I can replicate this issue, which suggests to me that possibly your values are not the values you think they are, but I won't belabor that point.  You could consider casting to string and comparing those values for equivalence:</p>\n\n<pre><code>?Cstr(Cell1.Value) = Cstr(Cell2.Value)\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 34912627, "answer_count": 2, "score": 0, "last_activity_date": 1453335357, "creation_date": 1453325992, "last_edit_date": 1453326760, "question_id": 34911129, "link": "https://stackoverflow.com/questions/34911129/how-to-check-for-hidden-number-precision-in-an-excel-range", "title": "How to check for hidden number precision in an Excel range?", "body": "<p>I'm comparing two ranges like this:</p>\n\n<pre><code>Set cell1 = SampleFeature.Cells(row, column)\nSet cell2 = TestFeature.Cells(row, column)\nIf cell1.value &lt;&gt; cell2.value Then\n    DoSomething()\nEnd If\n</code></pre>\n\n<p>I have two ranges that, in the immediate window, show these values:</p>\n\n<pre><code>?cell1.Value\n0.45\n?cell2.Value\n0.45\n?cell1.Value=cell2.Value\nFalse\n?cell1-cell2\n-5.55111512312578E-17\n</code></pre>\n\n<p>So this is pretty clearly a floating point precision issue.  My question is, how can I change the <code>cell1.value &lt;&gt; cell2.value</code> comparison so that it uses the precision given when I output <code>cell1.value</code>, as opposed to the \"true\" floating point value?</p>\n\n<p>EDIT: sorry, forgot to mention that this check is also used to compare strings.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453325487, "post_id": 34910853, "comment_id": 57557526, "body": "That is because at that point it no longer is the activecell.  The best would be to <code>WB1.WS1.Range()</code>  but you will need to know the range address."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 3896311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545399a36717639c80239a887a698e5d?s=128&d=identicon&r=PG&f=1", "display_name": "cdatwork", "link": "https://stackoverflow.com/users/3896311/cdatwork"}, "is_accepted": false, "score": 0, "last_activity_date": 1453330734, "creation_date": 1453330734, "answer_id": 34912276, "question_id": 34910853, "link": "https://stackoverflow.com/questions/34910853/copying-data-from-one-workbook-to-another-using-relative-references/34912276#34912276", "title": "Copying data from one workbook to another using relative references", "body": "<p>try adding this in:</p>\n\n<pre><code>Dim rng As Range\nSet rng = ActiveCell\nApplication.GoTo rng\n</code></pre>\n\n<p>Here it is added into the code you provided:</p>\n\n<pre><code>Dim WB1 As Workbook\nDim WS1 As Worksheet\nDim rng as Range\nDim SelectWB As Variant\nDim FilePath As Variant\nDim WB2 As Workbook\nDim Quantity As Integer\nDim x As Integer\nDim ColumnRef As Integer\n\nApplication.ReferenceStyle = xlR1C1\n\nSet WB1 = ActiveWorkbook\nSet WS1 = ActiveSheet\nSet rng = ActiveCell\nQuantity = InputBox(\"Input the number of rows to be copied\")\nSet SelectWB = Application.FileDialog(msoFileDialogFilePicker)\n    With SelectWB\n        .ButtonName = \"Select\"\n        .AllowMultiSelect = False\n        .Title = \"Choose File\"\n        .InitialView = msoFileDialogViewDetails\n        If .Show Then FilePath = .SelectedItems(1)\n    End With\n\nSet WB2 = Workbooks.Open(FilePath)\n\nColumnRef = 2\n\nFor x = 1 To TagQuantity\n    If x &lt;= TagQuantity Then\n        Selection.Copy\n        WB2.Sheets(3).Cells(3, ColumnRef).Select\n        Sheets(3).Paste\n        Application.Goto rng.Offset(0, 10)\n        'WB1.WS1.ActiveCell.Offset(0, 10).Select\n        'Selection.Copy\n        'WB2.ActiveCell.Offset(-1, 0).Paste\n        'WB1.WS1.ActiveCell.Offset(0, -1).Copy\n        'WB2.ActiveCell.Offset(-1, 0).Paste\n        'WB1.WS1.ActiveCell.Offset(1, -9).Select\n        'ColumnRef = ColumnRef + 1\n    End If\nNext\n\nApplication.ReferenceStyle = xlA1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3246422, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/29103428/picture?type=large", "display_name": "nickalbe", "link": "https://stackoverflow.com/users/3246422/nickalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453330734, "creation_date": 1453325083, "question_id": 34910853, "link": "https://stackoverflow.com/questions/34910853/copying-data-from-one-workbook-to-another-using-relative-references", "title": "Copying data from one workbook to another using relative references", "body": "<p>I have a large workbook with data and I need to copy data from specific columns from a predetermined number of rows into another workbook. The data will always come from the same columns, but the relevant rows will be different each day. </p>\n\n<p>For example, my workbook has 1000 rows and 15 columns, and today I need to copy the content of the cells in columns A, K, &amp; J from row 100 into cells B3, B2, &amp; B1, respectively, then the data from columns A, K, &amp; J from row 101 into cells C3, C2, &amp; C1, in the new workbook. Here's what I have so far:</p>\n\n<pre><code>Dim WB1 As Workbook\nDim WS1 As Worksheet\nDim SelectWB As Variant\nDim FilePath As Variant\nDim WB2 As Workbook\nDim Quantity As Integer\nDim x As Integer\nDim ColumnRef As Integer\n\nApplication.ReferenceStyle = xlR1C1\n\nSet WB1 = ActiveWorkbook\nSet WS1 = ActiveSheet\nQuantity = InputBox(\"Input the number of rows to be copied\")\nSet SelectWB = Application.FileDialog(msoFileDialogFilePicker)\n    With SelectWB\n        .ButtonName = \"Select\"\n        .AllowMultiSelect = False\n        .Title = \"Choose File\"\n        .InitialView = msoFileDialogViewDetails\n        If .Show Then FilePath = .SelectedItems(1)\n    End With\n\nSet WB2 = Workbooks.Open(FilePath)\n\nColumnRef = 2\n\nFor x = 1 To TagQuantity\n    If x &lt;= TagQuantity Then\n        Selection.Copy\n        WB2.Sheets(3).Cells(3, ColumnRef).Select\n        Sheets(3).Paste\n        WB1.WS1.ActiveCell.Offset(0, 10).Select\n        'Selection.Copy\n        'WB2.ActiveCell.Offset(-1, 0).Paste\n        'WB1.WS1.ActiveCell.Offset(0, -1).Copy\n        'WB2.ActiveCell.Offset(-1, 0).Paste\n        'WB1.WS1.ActiveCell.Offset(1, -9).Select\n        'ColumnRef = ColumnRef + 1\n    End If\nNext\n\nApplication.ReferenceStyle = xlA1\n\nEnd Sub\n</code></pre>\n\n<p>My code error out at the line \"WB1.WS1.ActiveCell.Offset(0, 10).Select\" (Run-time error '438': Object doesn't support this property or method). If I comment out the error line and run just the first 3 lines in the if statement, it doesn't crash, but also doesn't copy the value into the new sheet. What am I doing wrong?</p>\n\n<p>I am very new to programming, so any help is appreciated!</p>\n"}, {"tags": ["sql", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 3401, "user_id": 1178267, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VvAW2.jpg?s=128&g=1", "display_name": "anhoppe", "link": "https://stackoverflow.com/users/1178267/anhoppe"}, "edited": false, "score": 0, "creation_date": 1453325222, "post_id": 34910706, "comment_id": 57557401, "body": "Maybe u should post the error message?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453344476, "post_id": 34910706, "comment_id": 57564218, "body": "Rethink your processing. You update from the very table you just imported? Also, <code>FROM</code> clause is not allowed in Access SQL update statements. Look into <code>UPDATE ... INNER JOIN</code>."}, {"owner": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1453997325, "post_id": 34910706, "comment_id": 57855865, "body": "Thanks for the feedback! I&#39;m using tbltemp in connection with a form that I have -- I don&#39;t want tblCalendar to be directly linked to the forml. The process is:  1. All Information is stored in tblCalendar 2. When a particular form is opened, I have code that tells access to copy data from the tblCalendar into tblTemp,  but it only grabs the data that is associated with a particular court date. 3. Anyone using the form can now view and edit only the information for the court date they indicated (and they can add additional data).  So far, everything works. My issue is going the other way."}], "answers": [{"tags": [], "owner": {"reputation": 450, "user_id": 5812022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2a08db97315d256c17e6d5eb24403b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Hadsell", "link": "https://stackoverflow.com/users/5812022/alan-hadsell"}, "is_accepted": false, "score": 0, "last_activity_date": 1453325149, "creation_date": 1453325149, "answer_id": 34910874, "question_id": 34910706, "link": "https://stackoverflow.com/questions/34910706/update-sql-in-access-vba-updating-table-values-from-another-table/34910874#34910874", "title": "Update SQL in Access VBA -- Updating Table Values From Another Table", "body": "<p>Remove the single quotes from <code>\"Where 'CourtDate = tblCalendar.CourtDate.Value'\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453383025, "post_id": 34910889, "comment_id": 57583654, "body": "@Parfait Good point! I confused with the SQLMove query. I will change that in my answer. Thanks"}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453386256, "post_id": 34910889, "comment_id": 57586022, "body": "oh my... @Parfait thank you for reviewing it with me! I put a space before it."}, {"owner": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1453996762, "post_id": 34910889, "comment_id": 57855475, "body": "Wow, thank you for all of that feedback. I&#39;ve actually been away from work for a few days, so I haven&#39;t had a chance to review any of the responses. I&#39;ll let you know what happens when I get back into my code. Thanks!"}, {"owner": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1454004440, "post_id": 34910889, "comment_id": 57860528, "body": "I&#39;ve made all the suggested changes and I&#39;m happy to say that there aren&#39;t any errors for the code. Thanks to all involved! Unfortunately, when I close the form no changes are reflected in tblCalendar. I&#39;m working on figuring out why, but any suggestions would be greatly appreciated. I&#39;m thinking it might relate to the Primary Key for both tables -- not sure though."}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1454005919, "post_id": 34910889, "comment_id": 57861450, "body": "@BrianH Try to put the code in the <code>UserForm_QueryClose()</code> procedure of your form instead of <code>UserForm_Close</code>"}, {"owner": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1454009160, "post_id": 34910889, "comment_id": 57863498, "body": "@OscarAnythony I figured out what the issue was. It turns out I needed to join the tables by CourtDate AND by CaseNumber in order for the update function to work as intended. Everything seems to be working great now. Thank you so much for your help!"}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1454009437, "post_id": 34910889, "comment_id": 57863658, "body": "No problem! I&#39;m glad I could help."}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1454009587, "post_id": 34910889, "comment_id": 57863759, "body": "@BrianH Just to know, did you put the code in the <code>Form_QueryClose</code> procedure for it to work? or you left it in the <code>Form_Close</code> procedure. Just tell me so that I can update my answer if need to."}, {"owner": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "edited": false, "score": 0, "creation_date": 1454014281, "post_id": 34910889, "comment_id": 57866482, "body": "I left it in the Form_Close procedure."}], "tags": [], "owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "is_accepted": true, "score": 1, "last_activity_date": 1453386148, "last_edit_date": 1453386148, "creation_date": 1453325209, "answer_id": 34910889, "question_id": 34910706, "link": "https://stackoverflow.com/questions/34910706/update-sql-in-access-vba-updating-table-values-from-another-table/34910889#34910889", "title": "Update SQL in Access VBA -- Updating Table Values From Another Table", "body": "<p>There are several potential errors in your code:</p>\n\n<ol>\n<li><p>You do not need to add <code>.Value</code> to the end of an attribute to get its actual value.</p></li>\n<li><p>As you are working directly in Access, you to not need the <code>Tables!</code> part either. That is the syntax used when dealing with recordsets. For example, write <code>tblTemp.CountyCaseType</code> instead of <code>Tables!tblTemp.CountyCaseType.Value</code></p></li>\n<li><p>The values of your variables are not in the SQL string. You have to concatenate them to the SQLReplace String using <em>[&amp;]</em>. For example, write</p>\n\n<pre><code>SQLReplace = \"UPDATE tblCalendar \" &amp; _\n                 \"SET tblCalendar.CountyCaseType = \" &amp; CountyCaseType &amp; \", \" &amp; _\n                 \"    tblCalendar.CaseNumber = \" &amp; CaseNumber &amp; \", \" &amp; _\n                 ....\n</code></pre></li>\n<li><p>As @AlanHadsell pointed out, remove the single quotes from the <code>WHERE</code> clause. </p>\n\n<pre><code>Where 'CourtDate = tblCalendar.CourtDate.Value'\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>WHERE CourtDate = tblCalendar.CourtDate\n</code></pre>\n\n<p>But as I said in <em>3)</em> <code>CourTDate</code> is a <code>String</code> variable, so it needs to be concatenated. Your final <code>WHERE</code> clause should be:</p>\n\n<pre><code>\"WHERE \" &amp; CourtDate &amp; \" = tblCalendar.CourtDate\"\n</code></pre></li>\n<li><p>You don't need the <code>FROM tblTemp</code> clause in the SQLReplace String.</p></li>\n<li><p><strong>EDIT</strong>: As @Parfait pointed out, tblTemp does not exist in scope of the SQLReplace statement. You should do an <code>INNER JOIN</code> to fix that:</p>\n\n<pre><code>UPDATE tblCalendar INNER JOIN tblTemp ON tblCalendar.CourtDate = tblTemp.CourtDate SET ...\n</code></pre></li>\n</ol>\n\n<p>After fixing everything, your final code should look like:</p>\n\n<pre><code>Private Sub Form_Close()\n\n    Dim SQLMove As String\n    Dim SQLReplace As String\n\n    Dim CountyCaseType As String\n    Dim CaseNumber As String\n    Dim County As String\n    Dim FirstName As String\n    Dim MiddleName As String\n    Dim LastName As String\n    Dim Facility As String\n    Dim VOL As String\n    Dim Diagnosis As String\n    Dim AppearanceWaived As String\n    Dim Dismissed As String\n    Dim HearingResults As String\n    Dim Disposition As String\n    Dim DOB As String\n    Dim Minor As String\n    Dim Sex As String\n    Dim ClerkName As String\n    Dim Judge As String\n    Dim CourtDate As String\n\n\n    CountyCaseType = \"tblTemp.CountyCaseType\"\n    CaseNumber = \"tblTemp.CaseNumber\"\n    County = \"tblTemp.County\"\n    FirstName = \"tblTemp.FirstName\"\n    MiddleName = \"tblTemp.MiddleName\"\n    LastName = \"tblTemp.LastName\"\n    Facility = \"tblTemp.Facility\"\n    VOL = \"tblTemp.VOL\"\n    Diagnosis = \"tblTemp.Diagnosis\"\n    AppearanceWaived = \"tblTemp.AppearanceWaived\"\n    Dismissed = \"tblTemp.Dismissed\"\n    HearingResults = \"tblTemp.HearingResults\"\n    Disposition = \"tblTemp.Disposition\"\n    DOB = \"tblTemp.DOB\"\n    Minor = \"tblTemp.Minor\"\n    Sex = \"tblTemp.Sex\"\n    ClerkName = \"tblTemp.Clerk\"\n    Judge = \"tblTemp.Judge\"\n    CourtDate = \"tblTemp.CourtDate\"\n\n    SQLMove = \"INSERT INTO tblCalendar SELECT * FROM tblTemp\"\n    SQLReplace = \"UPDATE tblCalendar \" &amp; _\n                 \"INNER JOIN tblTemp ON tblCalendar.CourtDate = tblTemp.CourtDate \" &amp; _\n                         \"SET tblCalendar.CountyCaseType = \" &amp; CountyCaseType &amp; \", \" &amp; _\n                         \"    tblCalendar.CaseNumber = \" &amp; CaseNumber &amp; \", \" &amp; _\n                         \"    tblCalendar.County = \" &amp; County &amp; \", \" &amp; _\n                         \"    tblCalendar.FirstName = \" &amp; FirstName &amp; \", \" &amp; _\n                         \"    tblCalendar.MiddleName = \" &amp; MiddleName &amp; \", \" &amp; _\n                         \"    tblCalendar.LastName = \" &amp; LastName &amp; \", \" &amp; _\n                         \"    tblCalendar.Facility = \" &amp; Facility &amp; \", \" &amp; _\n                         \"    tblCalendar.VOL = \" &amp; VOL &amp; \", \" &amp; _\n                         \"    tblCalendar.Diagnosis = \" &amp; Diagnosis &amp; \", \" &amp; _\n                         \"    tblCalendar.AppearanceWaived = \" &amp; AppearanceWaived &amp; \", \" &amp; _\n                         \"    tblCalendar.Dismissed = \" &amp; Dismissed &amp; \", \" &amp; _\n                         \"    tblCalendar.HearingResults = \" &amp; HearingResults &amp; \", \" &amp; _\n                         \"    tblCalendar.Disposition = \" &amp; Disposition &amp; \", \" &amp; _\n                         \"    tblCalendar.DOB = \" &amp; DOB &amp; \", \" &amp; _\n                         \"    tblCalendar.Minor = \" &amp; Minor &amp; \", \" &amp; _\n                         \"    tblCalendar.Sex = \" &amp; Sex &amp; \", \" &amp; _\n                         \"    tblCalendar.ClerkName = \" &amp; Clerk &amp; \", \" &amp; _\n                         \"    tblCalendar.Judge = \" &amp; Judge \n    DoCmd.SetWarnings False\n    DoCmd.RunSQL (SQLMove)\n    DoCmd.RunSQL (SQLReplace)\n    DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n\n<p>To finish, instead of declaring a <code>String</code> variable for each attributes in <code>tableTemp</code> that you want to copy, and then assigning some values to them, you can simply omit the declarations and put the attributes dicrectly in the SQL. That will geatly reduce the length of your code as follow:</p>\n\n<pre><code>Private Sub Form_Close()\n\n    Dim SQLMove As String\n    Dim SQLReplace As String\n\n    SQLMove = \"INSERT INTO tblCalendar SELECT * FROM tblTemp\"\n    SQLReplace = \"UPDATE tblCalendar \" &amp; _\n                 \"INNER JOIN tblTemp ON tblCalendar.CourtDate = tblTemp.CourtDate \" &amp; _\n                         \"SET tblCalendar.CountyCaseType = tblTemp.CountyCaseType, \" &amp; _\n                         \"    tblCalendar.CaseNumber = tblTemp.CaseNumber, \" &amp; _\n                         \"    tblCalendar.County = tblTemp.County, \" &amp; _\n                         \"    tblCalendar.FirstName = tblTemp.FirstName, \" &amp; _\n                         \"    tblCalendar.MiddleName = tblTemp.MiddleName, \" &amp; _\n                         \"    tblCalendar.LastName = tblTemp.LastName, \" &amp; _\n                         \"    tblCalendar.Facility = tblTemp.Facility, \" &amp; _\n                         \"    tblCalendar.VOL = tblTemp.VOL, \" &amp; _\n                         \"    tblCalendar.Diagnosis = tblTemp.Diagnosis, \" &amp; _\n                         \"    tblCalendar.AppearanceWaived = tblTemp.AppearanceWaived, \" &amp; _\n                         \"    tblCalendar.Dismissed = tblTemp.Dismissed, \" &amp; _\n                         \"    tblCalendar.HearingResults = tblTemp.HearingResults, \" &amp; _\n                         \"    tblCalendar.Disposition = tblTemp.Disposition, \" &amp; _\n                         \"    tblCalendar.DOB = tblTemp.DOB, \" &amp; _\n                         \"    tblCalendar.Minor = tblTemp.Minor, \" &amp; _\n                         \"    tblCalendar.Sex = tblTemp.Sex, \" &amp; _\n                         \"    tblCalendar.ClerkName = tblTemp.ClerkName, \" &amp; _\n                         \"    tblCalendar.Judge = tblTemp.Judge\"\n    DoCmd.SetWarnings False\n    DoCmd.RunSQL (SQLMove)\n    DoCmd.RunSQL (SQLReplace)\n    DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5818128, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4319b74aaeb76616f6bfd2a8dffd0781?s=128&d=identicon&r=PG&f=1", "display_name": "Brian H", "link": "https://stackoverflow.com/users/5818128/brian-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9588, "favorite_count": 0, "accepted_answer_id": 34910889, "answer_count": 2, "score": 1, "last_activity_date": 1453386148, "creation_date": 1453324611, "question_id": 34910706, "link": "https://stackoverflow.com/questions/34910706/update-sql-in-access-vba-updating-table-values-from-another-table", "title": "Update SQL in Access VBA -- Updating Table Values From Another Table", "body": "<p>I'm fairly new to Access VBA and SQL coding. So far, I've been able to find most of the answers to issues I've had by using the internet. I'm currently trying to write some code in MS Access (2013) VBA that updates the data in one table from another table in the same database when a particular form closes.</p>\n\n<p>I've worked out several errors so far, but I'm stuck on a syntax error in the \"UPDATE\" for SQLReplace. There could be other errors that I don't know about yet, but I'm not sure. Any help/Guidance would be greatly appreciated!</p>\n\n<p>Thanks!</p>\n\n<pre><code>Private Sub Form_Close()\n\nDim SQLMove As String\nDim SQLReplace As String\n\nDim CountyCaseType As String\nDim CaseNumber As String\nDim County As String\nDim FirstName As String\nDim MiddleName As String\nDim LastName As String\nDim Facility As String\nDim VOL As String\nDim Diagnosis As String\nDim AppearanceWaived As String\nDim Dismissed As String\nDim HearingResults As String\nDim Disposition As String\nDim DOB As String\nDim Minor As String\nDim Sex As String\nDim ClerkName As String\nDim Judge As String\nDim CourtDate As String\n\n\nCountyCaseType = \"Tables!tblTemp.CountyCaseType.Value\"\nCaseNumber = \"Tables!tblTemp.CaseNumber.Value\"\nCounty = \"Tables!tblTemp.County.Value\"\nFirstName = \"Tables!tblTemp.FirstName.Value\"\nMiddleName = \"Tables!tblTemp.MiddleName.Value\"\nLastName = \"Tables!tblTemp.LastName.Value\"\nFacility = \"Tables!tblTemp.Facility.Value\"\nVOL = \"Tables!tblTemp.VOL.Value\"\nDiagnosis = \"Tables!tblTemp.Diagnosis.Value\"\nAppearanceWaived = \"Tables!tblTemp.AppearanceWaived.Value\"\nDismissed = \"Tables!tblTemp.Dismissed.Value\"\nHearingResults = \"Tables!tblTemp.HearingResults.Value\"\nDisposition = \"Tables!tblTemp.Disposition.Value\"\nDOB = \"Tables!tblTemp.DOB.Value\"\nMinor = \"Tables!tblTemp.Minor.Value\"\nSex = \"Tables!tblTemp.Sex.Value\"\nClerkName = \"Tables!tblTemp.Clerk.Value\"\nJudge = \"Tables!tblTemp.Judge.Value\"\nCourtDate = \"Tables!tblTemp.CourtDate.Value\"\n\nSQLMove = \"INSERT INTO tblCalendar SELECT * FROM tblTemp\"\nSQLReplace = \"UPDATE tblCalendar \" &amp; _\n                     \"SET tblCalendar.CountyCaseType.Value = CountyCaseType, \" &amp; _\n                     \"    tblCalendar.CaseNumber.Value = CaseNumber, \" &amp; _\n                     \"    tblCalendar.County.Value = County, \" &amp; _\n                     \"    tblCalendar.FirstName.Value = FirstName, \" &amp; _\n                     \"    tblCalendar.MiddleName.Value = MiddleName, \" &amp; _\n                     \"    tblCalendar.LastName.Value = LastName, \" &amp; _\n                     \"    tblCalendar.Facility.Value = Facility, \" &amp; _\n                     \"    tblCalendar.VOL.Value = VOL, \" &amp; _\n                     \"    tblCalendar.Diagnosis.Value = Diagnosis, \" &amp; _\n                     \"    tblCalendar.AppearanceWaived.Value = AppearanceWaived, \" &amp; _\n                     \"    tblCalendar.Dismissed.Value = Dismissed, \" &amp; _\n                     \"    tblCalendar.HearingResults.Value = HearingResults, \" &amp; _\n                     \"    tblCalendar.Disposition.Value = Disposition, \" &amp; _\n                     \"    tblCalendar.DOB.Value = DOB, \" &amp; _\n                     \"    tblCalendar.Minor.Value = Minor, \" &amp; _\n                     \"    tblCalendar.Sex.Value = Sex, \" &amp; _\n                     \"    tblCalendar.ClerkName.Value = Clerk, \" &amp; _\n                     \"    tblCalendar.Judge.Value = Judge, \" &amp; _\n                     \"FROM tblTemp \" &amp; _\n                     \"Where 'CourtDate = tblCalendar.CourtDate.Value'\"\nDoCmd.SetWarnings False\nDoCmd.RunSQL (SQLMove)\nDoCmd.RunSQL (SQLReplace)\nDoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1190, "user_id": 1902181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1158bb9a54b2a8a9b02cb91a253ee5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/1902181/seb"}, "edited": false, "score": 0, "creation_date": 1453325259, "post_id": 34910550, "comment_id": 57557429, "body": "Make sure <code>Application.EnableEvents = true</code> when calling <code>Workbooks.Open</code>"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 1190, "user_id": 1902181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1158bb9a54b2a8a9b02cb91a253ee5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/1902181/seb"}, "edited": false, "score": 1, "creation_date": 1453326395, "post_id": 34910550, "comment_id": 57558027, "body": "sorry, the question wasn&#39;t written properly. this is what I need help with, please read it again."}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 0, "creation_date": 1453477292, "post_id": 34910550, "comment_id": 57632490, "body": "were you able to solve your issue? If yes, accept the answer that helped you or create your own answer. Keep us updated!"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 0, "creation_date": 1453483134, "post_id": 34910550, "comment_id": 57636446, "body": "please take a look at the chat... @OscarAnthony"}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1453490699, "post_id": 34910550, "comment_id": 57640379, "body": "@brettdj Those are two <b>different</b> problems, even if portion of the same code appear in both. One is about the issue of automatically <b>closing</b> a workbook <b>when opened from a macro of another workbook</b> and the second one is about <b>automatically doing something else after a certain time of inactivity</b>"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 1, "creation_date": 1453512387, "post_id": 34910550, "comment_id": 57648685, "body": "@OscarAnthony  Both questions by the same author are about running events after a period of activity."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453512582, "post_id": 34910550, "comment_id": 57648731, "body": "but it&#39;s a different question, because closing a WB only needs to be done once, triggering a procedure every time the user is inactive and resetting it after activity is a different matter"}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453330677, "post_id": 34912124, "comment_id": 57560112, "body": "should I change something else, besides the close_wb() procedure? what I mean is, where do I call the procedure myProcedure()?"}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453332094, "post_id": 34912124, "comment_id": 57560657, "body": "You do not actually need to manually call <code>my_procedure()</code>. Excel automatically runs the procedure specified in the string argument of the function <code>Application.OnTime</code>. If you want for example to run another procedure instead, you just need to replace the <code>&quot;my_procedure&quot;</code> part in the function calls of <code>Application.OnTime</code> with the name of the other procedure you want."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453332522, "post_id": 34912124, "comment_id": 57560807, "body": "and the code in This Workbook remains the same?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453333027, "post_id": 34912124, "comment_id": 57561001, "body": "I did it and I got this error after closing the workbook:"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453333050, "post_id": 34912124, "comment_id": 57561007, "body": "Runtime error &#39;1004&#39;"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453333101, "post_id": 34912124, "comment_id": 57561026, "body": "Method &#39;OnTime&#39; of object &#39;_Application&#39; failed"}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453334207, "post_id": 34912124, "comment_id": 57561399, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/101233/discussion-between-oscar-anthony-and-n-pavon\">continue this discussion in chat</a>."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453483038, "post_id": 34912124, "comment_id": 57636386, "body": "This question is different from the one marked as duplicate1"}, {"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453490314, "post_id": 34912124, "comment_id": 57640229, "body": "@N.Pavon I made the final changes (to the <code>Close_WB</code> and <code>stop_Countdown</code> procedures). It should be wokring now! please can you test with the new code in my answer?"}], "tags": [], "owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "is_accepted": true, "score": 2, "last_activity_date": 1453492922, "last_edit_date": 1495539917, "creation_date": 1453330063, "answer_id": 34912124, "question_id": 34910550, "link": "https://stackoverflow.com/questions/34910550/trigger-code-after-inactivity/34912124#34912124", "title": "Trigger code after inactivity", "body": "<p>You need to make changes in the <em>Regular module</em>.</p>\n\n<p>Instead of passing the String <code>close_wb()</code> in your <code>Application.OnTime</code> function call, you have to specify the name of the procedure containing whatever you want to perform.</p>\n\n<p>Here is the code to get you started:</p>\n\n<pre><code>Option Explicit\nPublic Inactivity_Time As Date\n\nSub start_Countdown()\n    Inactivity_Time = Now() + TimeValue(\"00:00:10\")\n    Application.OnTime Inactivity_Time, \"my_procedure\"    ' &lt;- Notice that I changed the name of the procedure here\nEnd Sub\n\nSub stop_Countdown()\n    On Error Resume Next\n    Application.OnTime Inactivity_Time, \"my_procedure\", , False     ' &lt;- And here too.\n    On Error GoTo 0\nEnd Sub\n\nSub my_procedure()\n    ' The code to perform you event goes here\nEnd Sub\n</code></pre>\n\n<p>Please check <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx\" rel=\"nofollow noreferrer\">here</a> for more details on the <code>Application.OnTime</code> method.</p>\n\n<p><strong>EDIT:</strong> After some test, it appears that you can't call <code>stop_Countdown()</code> in the <code>Workbook_BeforeClose</code> sub procedure: It throws an error. According to <a href=\"https://stackoverflow.com/questions/26649610/application-ontime-not-executed\">this post</a>, in your <strong><em>Workbook module</em></strong>, you have to replace the procedure <code>Workbook_BeforeClose</code> with the following one:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Close_WB\nEnd Sub\n</code></pre>\n\n<p>And add the following procedure:</p>\n\n<pre><code>Public Sub Close_WB()\n    stop_CountDown\n    ThisWorkbook.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "closed_date": 1453354775, "accepted_answer_id": 34912124, "answer_count": 1, "score": 4, "last_activity_date": 1453492922, "creation_date": 1453324081, "last_edit_date": 1453326351, "question_id": 34910550, "link": "https://stackoverflow.com/questions/34910550/trigger-code-after-inactivity", "closed_reason": "Duplicate", "title": "Trigger code after inactivity", "body": "<p>I want my WB to trigger some code after inactivity time (set by me, naturally). I could only find code to close the WB after inactivity time, but I want the code to do something else, different from closing the WB. I found this code for closing the WB:</p>\n\n<p>This Workbook module:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    stop_Countdown\nThisWorkbook.Save\nEnd Sub\nPrivate Sub Workbook_Open()\n    start_Countdown\n    End Sub\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    stop_Countdown\n    start_Countdown\n    End Sub\nPrivate Sub Workbook_SheetCalculate(ByVal Sh As Object)\n    stop_Countdown\n    start_Countdown\nEnd Sub\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, _\n  ByVal Target As Excel.Range)\n    stop_Countdown\n    start_Countdown\nEnd Sub\n</code></pre>\n\n<p>Regular module:</p>\n\n<pre><code>Option Explicit\nPublic Close_Time As Date\nSub start_Countdown()\n    Close_Time = Now() + TimeValue(\"00:00:10\")\n    Application.OnTime Close_Time, \"close_WB\"\n    End Sub\nSub stop_Countdown()\n    Application.OnTime Close_Time, \"close_WB\", , False\n    End Sub\nSub close_wb()\n    ThisWorkbook.Close True\n    End Sub\n</code></pre>\n\n<p>In what part of the code should I introduce the events I want the WB to do, after inactivity, instead of closing the WB?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 0, "creation_date": 1453332257, "post_id": 34910418, "comment_id": 57560711, "body": "What code have you tried?"}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "edited": false, "score": 0, "creation_date": 1453404017, "post_id": 34910418, "comment_id": 57597769, "body": "@bibadia: Current, there was no specific code that I used. I tried to use the examples from MSDN and TechNet but none worked as those examples all required me to add a new drop-down content control to the document. What I would like to is pre-make my form and load all items into a drop-down content control when a document opens."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 0, "creation_date": 1453406096, "post_id": 34910418, "comment_id": 57598949, "body": "With Word VBA you can often learn <i>something</i> by looking at the relevant objects in the View-&gt;Object browser pane in the VB Editor and in many cases (but by no means all) recording a macro will give you some clues (in this case, recording the action of inserting some list items manually will give you a pointer, but probably not the most appropriate code."}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "edited": false, "score": 0, "creation_date": 1453406352, "post_id": 34910418, "comment_id": 57599081, "body": "@bibadia: I have tried to record the macro into VBA but once I hit the record button I cannot click on a drop-down content control. I can add one and add items to it but not select a drop-down content control that is already on the document."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 0, "creation_date": 1453408770, "post_id": 34910418, "comment_id": 57600444, "body": "If you select one first, then record the macro, you get information. Butit won&#39;t tell you how to specify a particular control to work with in code - so for that, you would typically go and look at the object model to see for example which objects have a ContentControls collection property, and how to identify a control within that collection."}, {"owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453409616, "post_id": 34910418, "comment_id": 57600894, "body": "@TroyPilewski Did you try my solution?"}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "reply_to_user": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453409792, "post_id": 34910418, "comment_id": 57600990, "body": "@AlexButenko: I did. This is what I type in the Visual Basic for Applications ThisDocument module. &#39;Option Explicit  Sub Document_Open()  Dim item As ContentControl  For Each item In Selection.Document.ContentControls     If item.Title = &quot;Unit Selection&quot; Then         item.DropdownListEntries.Add Text:=&quot;Item1&quot;, Value:=&quot;Item1&quot;         item.DropdownListEntries.Add Text:=&quot;Item2&quot;, Value:=&quot;Item2&quot;         item.DropdownListEntries.Add Text:=&quot;Item3&quot;, Value:=&quot;Item3&quot;     End If Next  End Sub&#39; Although, it did not work. I can send you the document..."}, {"owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453411390, "post_id": 34910418, "comment_id": 57601903, "body": "I checked your code, works for me. I made a docm document with dropdownlist, set it&#39;s title &quot;Unit Selection&quot;, put your code into ThisDocument of the document and reopened - and found all the items on the place."}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "reply_to_user": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453411894, "post_id": 34910418, "comment_id": 57602172, "body": "@AlexButenko: Thank you. It may have worked. I may have another issue on my hands then. It seems as though I can&#39;t get macros enabled which may be causing it to not work on my end. I do have another question: Which I edited and added above earlier, can you add an XML document to the inside a docm file and have the item inserted from that XML file?"}, {"owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453412023, "post_id": 34910418, "comment_id": 57602229, "body": "I have an answer for your additional question, but it&#39;s not really related to the first one. So I would recommend you to made another question."}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "reply_to_user": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453412397, "post_id": 34910418, "comment_id": 57602401, "body": "@AlexButenko: I will mark this question as answered and start another. Thank you!"}, {"owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "reply_to_user": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453412645, "post_id": 34910418, "comment_id": 57602524, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/101346/discussion-between-troypilewski-and-alex-butenko\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1453412356, "last_edit_date": 1453412356, "creation_date": 1453330599, "answer_id": 34912246, "question_id": 34910418, "link": "https://stackoverflow.com/questions/34910418/add-items-to-drop-down-list-word-2010/34912246#34912246", "title": "Add items to drop-down list Word 2010", "body": "<p>Something like</p>\n\n<pre><code>For Each item In ActiveDocument.ContentControls\n    If item.Title = \"DropDown1\" Then\n        item.DropdownListEntries.Add Text:=\"Item1\", Value:=\"Item1\"\n        item.DropdownListEntries.Add Text:=\"Item2\", Value:=\"Item2\"\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>You can find it by title or tag. Or by type - if it is only one dropdown in the document.</p>\n"}], "owner": {"reputation": 193, "user_id": 1590375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7bb3d89163085d6248f851286f0d044?s=128&d=identicon&r=PG", "display_name": "TroyPilewski", "link": "https://stackoverflow.com/users/1590375/troypilewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1950, "favorite_count": 0, "accepted_answer_id": 34912246, "answer_count": 1, "score": 1, "last_activity_date": 1594050894, "creation_date": 1453323647, "last_edit_date": 1594050894, "question_id": 34910418, "link": "https://stackoverflow.com/questions/34910418/add-items-to-drop-down-list-word-2010", "title": "Add items to drop-down list Word 2010", "body": "<p>I created a document and added a drop-down list content control in Microsoft Word 2010. How would I select this object and add items to it via VBA? An exhaustive search has led to being able to add one and add items, but I want to know how to add items to a list already on the document.</p>\n\n<p>Also, is it possible to change the extension of a Microsoft Word 2010 document to (.zip) and add in an XML file. This XML file would house all the items to be added to the drop-down content control.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453323261, "post_id": 34910010, "comment_id": 57556289, "body": "Smart using the Me pointer (will have to remeber that), and I get somehow get a syntax error from the code now. Is there something I am missing? Also do I have to define x and y in the sub as they are already declared when be passed the reference?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 1, "creation_date": 1453323998, "post_id": 34910010, "comment_id": 57556680, "body": "@Phoenix1237 - what line does the syntax error occur on? And no need to define <code>x</code> or <code>y</code> in the <code>DoSort</code> sub. The argument reference does that already."}, {"owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453402842, "post_id": 34910010, "comment_id": 57597062, "body": "the error occurs on Sub Worksheet_Change(ByVal Target As Range), but the macro is stored within Sheet1."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453403098, "post_id": 34910010, "comment_id": 57597224, "body": "@Phoenix1237 - I think it was the unnecessary parenthesis in the <code>DoSort</code> call. Try now. You can check simply by compiling the code."}, {"owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 1, "creation_date": 1453406955, "post_id": 34910010, "comment_id": 57599417, "body": "Yes that was it! I guess my Java habits leaked through, thank  you so much for your help."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1453403063, "last_edit_date": 1453403063, "creation_date": 1453322215, "answer_id": 34910010, "question_id": 34909855, "link": "https://stackoverflow.com/questions/34909855/vba-passing-cells-range-of-cells-to-multiple-subs/34910010#34910010", "title": "VBA Passing cells/range of cells to multiple subs", "body": "<p>See my refactored code below. See my comments for explanation.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    'I used \"Me.\" in place of \"Worksheets(\"Sheet1\").\" assuming that the Worksheet_Change event is already on Sheet1    \n    If Not Intersect(Me.Range(\"A:E\"), Target) Is Nothing Then\n         DoSort \"A3:F100\", \"A4\"\n    End If\n\n    If Not Intersect(Me.Range(\"H:L\"), Target) Is Nothing Then\n        DoSort \"H3:M100\", \"H4\"  'you were missing a close \" here\n    End If\n\nEnd Sub\n\n'define x and y as String to pass the string address of the range reference\nSub DoSort(x As String, y As String)\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(x).Sort Key1:=.Range(y), Order1:=xlAscending, Header:=xlYes\n    End With\nEnd Sub\n</code></pre>\n\n<p>You could pass the range if you want as well. That would look like this:</p>\n\n<pre><code>   DoSort Me.Range(\"A3:F100\"), Me.Range(\"A4\")\n\n   Sub DoSort(x as Range, y as Range)\n      x.Sort Key1:=y, Order1:=xlAscending, Header:=xlYes\n   End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453323319, "post_id": 34910012, "comment_id": 57556327, "body": "Yes I tried this but I somehow get a syntax error when I attempt to test."}, {"owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453323688, "post_id": 34910012, "comment_id": 57556520, "body": "It points to Private Sub Worksheet_Change(ByVal Target As Range)"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453323866, "post_id": 34910012, "comment_id": 57556611, "body": "@Phoenix1237 Where is that macro stored?"}, {"owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "edited": false, "score": 0, "creation_date": 1453323971, "post_id": 34910012, "comment_id": 57556665, "body": "It is stored within Sheet1 which is why I am confused why it would be an issue."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1453322226, "creation_date": 1453322226, "answer_id": 34910012, "question_id": 34909855, "link": "https://stackoverflow.com/questions/34909855/vba-passing-cells-range-of-cells-to-multiple-subs/34910012#34910012", "title": "VBA Passing cells/range of cells to multiple subs", "body": "<p>You could pass the data as a String versus as a Range:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not (Application.Intersect(Worksheets(\"Sheet1\").Range(\"A:E\"), Target) Is Nothing) Then\n        DoSort(\"A3:F100\", \"A4\")\n    End If\n    If Not (Application.Intersect(Worksheets(\"Sheet1\").Range(\"H:L\"), Target) Is Nothing) Then\n        DoSort(\"H3:M100\", \"H4\")\n    End If\nEnd Sub\n\nSub DoSort(x As String, y As String)\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(x).Sort Key1:=.Range(y), Order1:=xlAscending, Header:=xlYes\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4683096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136a21b7fcb447356437bad1dd8a7fe3?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix1237", "link": "https://stackoverflow.com/users/4683096/phoenix1237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 34910010, "answer_count": 2, "score": 3, "last_activity_date": 1453403063, "creation_date": 1453321669, "question_id": 34909855, "link": "https://stackoverflow.com/questions/34909855/vba-passing-cells-range-of-cells-to-multiple-subs", "title": "VBA Passing cells/range of cells to multiple subs", "body": "<p>Hi i have a problem defining a range of cells as a variable depending on what group of cells have changed. So far I have this but it sends up multiple errors, I have tried passing them as string and creating temp variables to hold the values and pass that but no matter what it does not seem to work.</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not (Application.Intersect(Worksheets(\"Sheet1\").Range(\"A:E\"), Target) Is Nothing) Then\n    DoSort(\"A3:F100\", \"A4\")\nEnd If\nIf Not (Application.Intersect(Worksheets(\"Sheet1\").Range(\"H:L\"), Target) Is Nothing) Then\n    DoSort(\"H3:M100\", \"H4)\nEnd If\nEnd Sub\n\nSub DoSort(x As Range, y As Range)\nWith ThisWorkbook.Sheets(\"Sheet1\")\n.Range(x).Sort Key1:=.Range(y), Order1:=xlAscending, Header:=xlYes\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I had it working before when i hard coded the cells in like this: </p>\n\n<pre><code>Private Sub DoSort2()\nWith ThisWorkbook.Sheets(\"Sheet1\")\n.Range(\"H3:M100\").Sort Key1:=.Range(\"H4\"), Order1:=xlAscending, Header:=xlYes\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Never really worked in VBA with excel macros so am very new to this, so any help would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453321160, "post_id": 34909602, "comment_id": 57555078, "body": "He did not want a concatenation.  The OP wanted to put in column b the number of times column a should be repeated.  So &quot;Text 1&quot; would be repeated 3 times.  And &quot;Text 2&quot; 5 times."}, {"owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453321603, "post_id": 34909602, "comment_id": 57555332, "body": "Ok.  Clearly, I did not understand that.  Sorry...  Just trying to help."}], "tags": [], "owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "is_accepted": false, "score": 0, "last_activity_date": 1453320828, "creation_date": 1453320828, "answer_id": 34909602, "question_id": 34909557, "link": "https://stackoverflow.com/questions/34909557/excel-generate-text-based-on-adjacent-value/34909602#34909602", "title": "Excel Generate Text based on adjacent value", "body": "<p>You don't need VBA for this.  You can just put a formula in the adjacent cell:</p>\n\n<pre><code>=(A1 &amp; \" \" &amp; B1)\n</code></pre>\n\n<p>Unless you really want to use VBA.  In which case, this answer does not apply.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5817900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3d66c1a5d5db5060ff755b66dc9a0?s=128&d=identicon&r=PG&f=1", "display_name": "inversion_modz", "link": "https://stackoverflow.com/users/5817900/inversion-modz"}, "edited": false, "score": 0, "creation_date": 1453347729, "post_id": 34909727, "comment_id": 57565096, "body": "I really really thank you Gary for that.  This will be useful in my work.  And learned my first VBA for practical application. :D"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1453321264, "creation_date": 1453321264, "answer_id": 34909727, "question_id": 34909557, "link": "https://stackoverflow.com/questions/34909557/excel-generate-text-based-on-adjacent-value/34909727#34909727", "title": "Excel Generate Text based on adjacent value", "body": "<p>With data in columns <strong>A</strong> and <strong>B</strong>, this tiny macro:</p>\n\n<pre><code>Sub Repetition()\n   Dim N As Long, i As Long, K As Long\n   N = Cells(Rows.Count, \"A\").End(xlUp).Row\n   K = 1\n\n   For i = 1 To N\n      For j = 1 To Cells(i, 2).Value\n         Cells(K, 3).Value = Cells(i, 1).Value\n         K = K + 1\n      Next j\n   Next i\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZGPgE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZGPgE.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 5817900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3d66c1a5d5db5060ff755b66dc9a0?s=128&d=identicon&r=PG&f=1", "display_name": "inversion_modz", "link": "https://stackoverflow.com/users/5817900/inversion-modz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 34909727, "answer_count": 2, "score": 0, "last_activity_date": 1453321264, "creation_date": 1453320639, "question_id": 34909557, "link": "https://stackoverflow.com/questions/34909557/excel-generate-text-based-on-adjacent-value", "title": "Excel Generate Text based on adjacent value", "body": "<p>I was wondering if it was possible to generate text based on adjacent value like this table:</p>\n\n<pre><code>Column A    Column B(Count)\n  Text 1       3\n  Text 2       5\n</code></pre>\n\n<p>End result should be when a script runs:</p>\n\n<pre><code>Column A\n  Text 1\n  Text 1\n  Text 1\n  Text 2\n  Text 2\n  Text 2\n  Text 2\n  Text 2\n</code></pre>\n\n<p>Been searching on Google for this and I can't find the result I was looking for.  I assume VBA Macros will do the trick?  For loops would be my guess.  Think of this as reversing the process of pivot table to find unique values.</p>\n"}, {"tags": ["excel", "vba", "add-in"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1453321304, "post_id": 34909447, "comment_id": 57555156, "body": "I don&#39;t have time to test, but am sure the answer is yes. I think <code>Application.Addins</code> represents the collection of addins in the addins dialog. In fact, that&#39;s pretty much word-for-word how MSDN defines it."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1453433576, "post_id": 34909447, "comment_id": 57609313, "body": "<i>that was manually added</i> are you mean you add it <a href=\"https://support.office.com/en-us/article/Add-or-remove-add-ins-0af570c4-5cf3-4fa9-9b88-403625a0b460#bmexceladdin\" rel=\"nofollow noreferrer\">like this</a>. if so it should be a part of <code>AddIns</code> collection and your second sub should show it&#39;s name."}, {"owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "edited": false, "score": 1, "creation_date": 1453610049, "post_id": 34909447, "comment_id": 57674319, "body": "No I mean File &gt;&gt; Open &gt;&gt; (Browse and double click your addin)"}], "answers": [{"comments": [{"owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "edited": false, "score": 0, "creation_date": 1453382280, "post_id": 34913642, "comment_id": 57583142, "body": "That&#39;s just the thing. I want a macro that runs a function from the addin, but I want to make sure the addin is installed first. So all I need is an if statement that checks whether the addin is available. I want this to work whether the addin has been manually opened, or programmatically installed."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 2, "creation_date": 1453384877, "post_id": 34913642, "comment_id": 57584999, "body": "You can just check if it&#39;s open. An open addin is part of the <code>Workbooks</code> collection, just like any other workbook, whether it&#39;s installed or opened manually."}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1453395178, "last_edit_date": 1525816098, "creation_date": 1453338467, "answer_id": 34913642, "question_id": 34909447, "link": "https://stackoverflow.com/questions/34909447/excel-vba-doesnt-recognize-manually-opened-xlam-add-in/34913642#34913642", "title": "Excel VBA doesn&#39;t recognize manually opened .xlam add-in", "body": "<p>Maybe you need to install it: </p>\n\n<pre><code>Sub InstallAddIn()\n    Dim AI As Excel.AddIn\n    Set AI = Application.AddIns.Add(Filename:=\"d:\\addin.xlam\") 'change the addin fullname \n    AI.Installed = True\nEnd Sub\n</code></pre>\n\n<p>more information <a href=\"http://www.cpearson.com/excel/installinganxla.aspx\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>As Doug Glancy comment we can check whether the addin is available like any normal workbook. so we can use this function:</p>\n\n<pre><code>Function IsAddinLoaded(adName As String) As Boolean\n\n  Dim addinWB As Workbook\n\n  On Error Resume Next\n   Set addinWB = Workbooks(adName)\n   If Err = 0 Then IsAddinLoaded = True\n  On Error GoTo 0      \n\nEnd Function\n</code></pre>\n\n<p>To test:</p>\n\n<pre><code>Sub Test()\n\n   if IsAddinLoaded(\"addin.xlam\") = true Then ' change the name of addin\n    msgbox \"Addin is loaded\"\n   Else\n    msgbox \"Addin not loaded\"\n   End if\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453401924, "creation_date": 1453320265, "last_edit_date": 1453401924, "question_id": 34909447, "link": "https://stackoverflow.com/questions/34909447/excel-vba-doesnt-recognize-manually-opened-xlam-add-in", "title": "Excel VBA doesn&#39;t recognize manually opened .xlam add-in", "body": "<p>I have an excel add-in that can't be found in <code>Application.AddIns</code>. I'm manually opening the add-in by going to File -> Open -> browse to <code>addin.xlam</code>. Do add-ins need to be programmatically added in order to show up in <code>Application.AddIns</code>?</p>\n\n<p>EDIT</p>\n\n<p>@Fadi</p>\n\n<p>I do not see my addin in either of these print functions. In the first one, it just prints the name of my current workbook and that is all. The second one successfully prints out my other 10 add-ins that have been programmatically added, but not the one that was manually added.</p>\n\n<pre><code>Sub MsgWorkbooks()\n\n    Dim s As String\n    For Each wb In Workbooks\n        s = s + app.Name\n    Next wb\n    MsgBox s\n\nEnd Sub\n\nSub MsgAddIns()\n\n    Dim s As String\n    For Each app In Application.AddIns\n        s = s + app.Name\n    Next app\n    MsgBox s\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1453357104, "post_id": 34909100, "comment_id": 57567988, "body": "you could always copy and paste the data you want onto a new worksheet formatted appropriately for the PDF export, export to PDF, then delete the sheet."}, {"owner": {"reputation": 322, "user_id": 4726846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3902605047c7a1bd67bd01dc2df08e9c?s=128&d=identicon&r=PG&f=1", "display_name": "GarAust89", "link": "https://stackoverflow.com/users/4726846/garaust89"}, "reply_to_user": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1453388318, "post_id": 34909100, "comment_id": 57587581, "body": "Thanks CustodianOfCode... That&#39;s exactly what I ended up doing!"}], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 4726846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3902605047c7a1bd67bd01dc2df08e9c?s=128&d=identicon&r=PG&f=1", "display_name": "GarAust89", "link": "https://stackoverflow.com/users/4726846/garaust89"}, "is_accepted": false, "score": 0, "last_activity_date": 1453470895, "creation_date": 1453470895, "answer_id": 34948380, "question_id": 34909100, "link": "https://stackoverflow.com/questions/34909100/export-multiple-ranges-to-a-single-pdf-using-vba/34948380#34948380", "title": "Export multiple ranges to a single PDF using VBA", "body": "<p>So you can't collect them all into a single array, solution is to create multiple dummy sheets and delete them when done:</p>\n"}], "owner": {"reputation": 322, "user_id": 4726846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3902605047c7a1bd67bd01dc2df08e9c?s=128&d=identicon&r=PG&f=1", "display_name": "GarAust89", "link": "https://stackoverflow.com/users/4726846/garaust89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1461, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453470895, "creation_date": 1453319048, "question_id": 34909100, "link": "https://stackoverflow.com/questions/34909100/export-multiple-ranges-to-a-single-pdf-using-vba", "title": "Export multiple ranges to a single PDF using VBA", "body": "<p>I'm trying to write a macro to cycle through a dropdown menu. Everytime the value in the drop down changes it will change the values on the worksheet. I won't to capture a range of the worksheet for every value in the dropdown in a VBA array and then export all of these ranges to single PDF. I'm able to export them one at a time to multiple PDFs but this isn't the objective. The problem I seem to be having is storing the different ranges in an Array. </p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Sub bill_exporter()\n' Macro to export billing estimates to a single pdf\n\n'Define Filenames and ranges\nDim myfile As String\nDim billsheet As Worksheet\nDim print_area As Excel.Range\nDim site As Range\nDim arr() As Variant\nDim i As Integer\n\n\ni = 0\nmyfile = Range(\"filename\").Value\nSet billsheet = ActiveWorkbook.Sheets(\"Mock Bill\")\n\nFor Each site In Range(\"meters\")\n\n    billsheet.Calculate\n    billsheet.Range(\"$R$10\").Value = site\n\n    'Create Vertical Page Breaks\n    billsheet.VPageBreaks.Add Before:=Range(\"C3\")\n    billsheet.VPageBreaks.Add Before:=Range(\"R3\")\n\n    'Set Print Area\n    Set print_area = billsheet.Range(\"C3:R50\")\n\n    Set arr(i) = print_area.Value\n\n    i = i + 1\n\nNext site\n\nArray(arr).ExportAsFixedFormat Type:=xlTypePDF, Filename:=myfile\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in Advance for any assistance!</p>\n"}, {"tags": ["excel", "listview", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "edited": false, "score": 0, "creation_date": 1453318455, "post_id": 34908851, "comment_id": 57553590, "body": "So at the moment the only section I can set the value is here:"}, {"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "edited": false, "score": 0, "creation_date": 1453318467, "post_id": 34908851, "comment_id": 57553598, "body": "Me.ListView1.ColumnHeaders.Add Text:=rngCell.Value, Width:=53"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1453325425, "post_id": 34908851, "comment_id": 57557500, "body": "So what&#39;s the issue with <i>manually</i> setting widths?"}, {"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1453334208, "post_id": 34908851, "comment_id": 57561400, "body": "Hi, The problem is I don&#39;t know the right code to add add to my existing project to manually set the width of the columns. Ideally I want to keep my current code layout as it works fine - other than all of the columns are the same width."}], "owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453318189, "creation_date": 1453318189, "last_edit_date": 1531161705, "question_id": 34908851, "link": "https://stackoverflow.com/questions/34908851/listview-manually-size-columns-sizes-excel", "title": "ListView manually size columns sizes (Excel)", "body": "<p>Just to say thanks for all of your help in the past regards various VBA questions in Excel. After some research and trial and error I have been recommended to use a listview rather than a listbox. So far so good - got the data I want and it does look better...but...I can only set the width for all of the column widths to a certain size. Ideally want to manually set the widths of the 10 columns - or possibly an autosize based on the header. But I would prefer choosing the widths. I will attach my code shortly.</p>\n\n<p>==============================</p>\n\n<p>Private Sub LoadListView()</p>\n\n<pre><code>'Declare the variables\nDim wksSource As Worksheet\nDim rngData As Range\nDim rngCell As Range\nDim LstItem As ListItem\nDim RowCount As Long\nDim ColCount As Long\nDim i As Long\nDim j As Long\n\n'Set the source worksheet\nSet wksSource = Worksheets(\"Sheet1\")\n\n'Set the source range\nSet rngData = wksSource.Range(\"A1\").CurrentRegion\n\n'Add the column headers\nFor Each rngCell In rngData.Rows(1).Cells\n    Me.ListView1.ColumnHeaders.Add Text:=rngCell.Value, Width:=53\nNext rngCell\n\n'Count the number of rows in the source range\nRowCount = rngData.Rows.Count\n\n'Count the number of columns in the source range\nColCount = rngData.Columns.Count\n\n'Fill the ListView\nFor i = 2 To RowCount\n    Set LstItem = Me.ListView1.ListItems.Add(Text:=rngData(i, 1).Value)\n    For j = 2 To ColCount\n        LstItem.ListSubItems.Add Text:=rngData(i, j).Value\n    Next j\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453317111, "post_id": 34908387, "comment_id": 57552862, "body": "does the other macro disable events <code>(Application.EnableEvents = False)</code> before it opens this Workbook?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453318005, "post_id": 34908387, "comment_id": 57553326, "body": "no, it doesn&#39;t, unless that&#39;s the default setting..."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1453318151, "post_id": 34908387, "comment_id": 57553410, "body": "Please share the code from the other macro that opens this file."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453318787, "post_id": 34908387, "comment_id": 57553799, "body": "I just added it to the question"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1453318893, "post_id": 34908387, "comment_id": 57553856, "body": "Your other code doesn&#39;t appear to trigger any of the events in that workbook that would start the timer..."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453319143, "post_id": 34908387, "comment_id": 57553982, "body": "so, what should I add to the other code?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1453320832, "post_id": 34908387, "comment_id": 57554882, "body": "@MacroMan - <code>Workbook_Open</code> event get <i>at least</i> should be triggered and start the countdown."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453321773, "post_id": 34908387, "comment_id": 57555430, "body": "@N.Pavon - if you step through the code line-by-line, does the <code>Workbook_Open</code> event fire in the workbook with the timer code in it when opened from the other sub?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453323678, "post_id": 34908387, "comment_id": 57556512, "body": "@ScottHoltzman I didn&#39;t see the <code>Workbooks.Open()</code> method - didn&#39;t scroll down!"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453332035, "post_id": 34908387, "comment_id": 57560638, "body": "@ScottHoltzman yes, it does fire... but after some more lines of code, the stop_countdown() procedure throws this error:"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453332165, "post_id": 34908387, "comment_id": 57560678, "body": "Can&#39;t execute code in break mode"}, {"owner": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "edited": false, "score": 0, "creation_date": 1453370799, "post_id": 34908387, "comment_id": 57575196, "body": "Is your network path a <b>Trusted Location</b> in the Excel <b>Sercurity Settings</b>? Otherwise it won&#39;t run macros in those files."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "edited": false, "score": 0, "creation_date": 1453382910, "post_id": 34908387, "comment_id": 57583554, "body": "@SvenRojek where do I check the security settings?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "edited": false, "score": 0, "creation_date": 1453384221, "post_id": 34908387, "comment_id": 57584511, "body": "@SvenRojek - if the <code>Workbook_Open</code> event is firing, then it&#39;s not an issue with <code>Trusted Location</code>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453384510, "post_id": 34908387, "comment_id": 57584735, "body": "@N.Pavon - See the 2 links in the comments to <a href=\"http://stackoverflow.com/questions/19624411/excel-2010-vba-throws-cant-execute-code-in-break-mode-while-stepping\">this question</a>. Of particular interest, will be the 2nd link. You may be very well served here in cleaning up your code and removing all <code>ActiveSheet</code> and <code>Select</code> statements. These can be hazardous to a VBA developer&#39;s health :)"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453385939, "post_id": 34908387, "comment_id": 57585791, "body": "Thanks a lot, I know those statements are &quot;hazardous&quot;, but I didn&#39;t develop this code, I&#39;m only mending it. I was expecting that comment haha. By the way, why is it frowned upon?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1453389971, "post_id": 34908387, "comment_id": 57588719, "body": "I think I know what the problem was. When the WB opens the WB that should close after inactivity, macros are not enabled. How do I tell the first WB to enable the macros of the opening WB right after opening it?"}, {"owner": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453392851, "post_id": 34908387, "comment_id": 57590744, "body": "@ScottHoltzman I wasn&#39;t aware of that, are you sure? @N.Pavon You&#39;ll find it here: <code>File -&gt; Options -&gt; Trust Center -&gt; Trust Center Settings -&gt; Trusted Locations</code> and add your network location. Also check <code>Allow Trusted Locations on my network</code>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "edited": false, "score": 0, "creation_date": 1453393210, "post_id": 34908387, "comment_id": 57591013, "body": "@SvenRojek - It depends on the settings, but if Excel did not trust the document the code would not fire when the Workbook is opened. A prompt would appear to either <code>Enable Content</code> or <code>Enable Macros</code> or a warning that <code>Macros are Disabled</code> and <i>nothing</i> would happen in terms of code execution."}, {"owner": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453393291, "post_id": 34908387, "comment_id": 57591075, "body": "@ScottHoltzman That&#39;s totally true if he opens the file at the same location manually."}, {"owner": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "edited": false, "score": 0, "creation_date": 1457062158, "post_id": 34908387, "comment_id": 59245841, "body": "re: <i>but after some more lines of code, the stop_countdown() procedure throws this error</i>  .. What error?"}, {"owner": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "edited": false, "score": 1, "creation_date": 1457071990, "post_id": 34908387, "comment_id": 59248805, "body": "I have tried <i>auto-close</i> code and it works even workbook opened from VBA..so the issue must be something else.."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 1, "last_activity_date": 1458508855, "last_edit_date": 1458508855, "creation_date": 1458507157, "answer_id": 36119435, "question_id": 34908387, "link": "https://stackoverflow.com/questions/34908387/automatically-close-workbook-after-inactivity/36119435#36119435", "title": "Automatically close Workbook after inactivity", "body": "<p>As Susilo pointed out in the comments, the issue must be something else than the auto-close code itself, since it works. That \"something else\" then, is probably the <code>Answer_Quote()</code> code, which frankly is one big mess. I'd recommend the following:</p>\n\n<p><strong>USE DUMMY CODE</strong></p>\n\n<p>Try running a dummy macro (a macro that essentially does nothing but open the workbook that should auto-close after some inactivity) instead of <code>Answer_Quote()</code>to see if the problem persists. If it doesn't, then you know for sure that <code>Answer_Quote()</code> is causing the problem. Proceed then to code cleanup.</p>\n\n<p><strong>CODE CLEANUP</strong></p>\n\n<p>1) Set all objects, external file and sheet references to nothing upon exit.</p>\n\n<p>Optionally and thus less importantly, but to ease code maintenance and debugging, I'd also recommend:</p>\n\n<p>2) Use proper and consistent indentation</p>\n\n<p>3) Remove redundant lines of code</p>\n\n<p>For instance:</p>\n\n<pre><code>If wBook Is Nothing Then 'Not open\n        Set wBook = Nothing\n</code></pre>\n\n<p>It is obviously pointless to set a reference to nothing if it is already nothing.</p>\n\n<p>4) Dimension all variables at the top, rather than throughout the code.</p>\n\n<p>5) Use <code>Option explicit</code> (if you don't already)</p>\n\n<p><strong>TEST AUTO-CLOSE EXECUTION</strong></p>\n\n<p>After code cleanup, test again. If the problem persists, try commenting out some of the<code>Answer_Quote()</code> code and try again. Repeat this process until the auto-close execution works again and you can pinpoint the exact cause of the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 6267272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4bc0e5b452a9d0b3b76607496b00521?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/6267272/jay"}, "is_accepted": false, "score": 1, "last_activity_date": 1461947423, "creation_date": 1461947423, "answer_id": 36943367, "question_id": 34908387, "link": "https://stackoverflow.com/questions/34908387/automatically-close-workbook-after-inactivity/36943367#36943367", "title": "Automatically close Workbook after inactivity", "body": "<p>try adding  a stop statement to your workbook_open to test if the event is even being triggered </p>\n\n<pre><code>Private Sub Workbook_Open()\n  start_Countdown\n  Stop\nEnd Sub\n</code></pre>\n\n<p>this would be a brute force way the to run the open Event from the Calling Workbook.</p>\n\n<p><code>Application.Run(ActiveWorkbook.name &amp; \"!Workbook_Open\")</code></p>\n\n<p>add this just after you open the Workbook.</p>\n"}], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3171, "favorite_count": 1, "answer_count": 2, "score": 10, "last_activity_date": 1476925127, "creation_date": 1453316845, "last_edit_date": 1476925127, "question_id": 34908387, "link": "https://stackoverflow.com/questions/34908387/automatically-close-workbook-after-inactivity", "title": "Automatically close Workbook after inactivity", "body": "<p>I created a Macro that closes the WB after some time of inactivity. It works perfect if I manually open the file, but if I use another macro from a different WB to open the file, it won't close automatically after the set inactivity time. The code I used to automatically close it is:</p>\n\n<p>This Workbook module:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    stop_Countdown\nThisWorkbook.Save\nEnd Sub\nPrivate Sub Workbook_Open()\n    start_Countdown\n    End Sub\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    stop_Countdown\n    start_Countdown\n    End Sub\nPrivate Sub Workbook_SheetCalculate(ByVal Sh As Object)\n    stop_Countdown\n    start_Countdown\nEnd Sub\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, _\n  ByVal Target As Excel.Range)\n    stop_Countdown\n    start_Countdown\nEnd Sub\n</code></pre>\n\n<p>Regular Module:</p>\n\n<pre><code>Option Explicit\nPublic Close_Time As Date\nSub start_Countdown()\n    Close_Time = Now() + TimeValue(\"00:00:10\")\n    Application.OnTime Close_Time, \"close_WB\"\n    End Sub\nSub stop_Countdown()\n    Application.OnTime Close_Time, \"close_WB\", , False\n    End Sub\nSub close_wb()\n    ThisWorkbook.Close True\n    End Sub\n</code></pre>\n\n<p>The code of the other macro:</p>\n\n<pre><code>Sub Answer_Quote()\n\nWorksheets(\"UI RM\").Protect DrawingObjects:=False, Contents:=False, Scenarios:=False, Password:=\"045\"\n\n Dim wBook As Workbook\n    On Error Resume Next\n    Set wBook = Workbooks(\"Base de Datos Cotizaciones Shared.xlsb\")\n\n    If wBook Is Nothing Then 'Not open\n            Set wBook = Nothing\n            On Error GoTo 0\n    Else 'It is open\n            wBook.Close SaveChanges:=False\n            Set wBook = Nothing\n            On Error GoTo 0\n    End If\n\nSet wb4 = ActiveWorkbook\nRange(\"AM7\").Calculate\nRange(\"K26:K28\").Calculate\nDim arreglo(4) As Variant\narreglo(0) = Range(\"hour_sent\").Value\narreglo(1) = Range(\"day_sent\").Value\narreglo(2) = Range(\"respuesta\").Value\narreglo(3) = Range(\"UsernameRM\").Value\n\nDim Findwhat As String\nDim c, d, multirange As Range\nFindwhat = Range(\"F11\").Text\n\n    Dim contador As Integer\n    contador = 0\n    While (IsFileOpen(\"\\\\3kusmiafs02\\CARPETA COMERCIAL\\Cotizaciones\\Base de Datos Cotizaciones Shared.xlsb\") And contador &lt; 4)\n        contador = contador + 1\n        Application.Wait (Now + TimeValue(\"00:00:03\"))\n    Wend\n\n    If contador = 4 Then\n    MsgBox \"La base de datos esta siendo utilizada por otro usuario. Por favor vuelva a intentarlo\", vbExclamation, \"Proceso cancelado\"\n    Exit Sub\n    End If\n\nApplication.ScreenUpdating = False\nDim iStatus As Long\nErr.Clear\nOn Error Resume Next\nSet wb2 = Workbooks(\"Base de Datos Cotizaciones Shared.xlsb\")\niStatus = Err\nOn Error GoTo 0\nIf iStatus Then 'workbook isn't open\nWorkbooks.Open filename:=\"\\\\3kusmiafs02\\CARPETA COMERCIAL\\Cotizaciones\\Base de Datos Cotizaciones Shared.xlsb\"\nElse\n'workbook is open\nwb2.Activate\nEnd If\n\nOn Error GoTo errHandler:\n\n'Copy Hour Sent\nWorksheets(\"Data\").Activate\nSet c = Range(\"A:A\").Find(Findwhat, LookIn:=xlValues)\nFor j = 1 To 3\n    c.Offset(0, 17 + j) = arreglo(j - 1)\nNext j\nc.Offset(0, 29) = arreglo(3)\n\n\n'Save Database\nWorkbooks(\"Base de Datos Cotizaciones Shared.xlsb\").Save\nWorkbooks(\"Base de Datos Cotizaciones Shared.xlsb\").Close\n\n    'Step-Back into User Interface\n    wb4.Activate\n    Worksheets(\"UI RM\").Activate\n\n    'Send E-Mail\n\n    'Working in 2000-2010\n    Dim Source As Range\n    Dim Dest As Workbook\n    Dim wb As Workbook\n    Dim TempFilePath As String\n    Dim TempFileName As String\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim response As Variant\n\n\n    'Mail recipients\n\n     Dim mail_recipients(3) As String\n\n     'mail_recipients(1) = Range(\"email\").Value\n     'mail_recipients(2) = \"mail\"\n     mail_recipients(3) = \"mail2\"\n\n\n    'Source Set/Range selection\n\n     Set Source = Nothing\n     On Error Resume Next\n\n    Worksheets.Add(After:=Worksheets(\"Interline Costs\")).Name = \"Quote Snap\"\n\n    'copy temp info\n    Worksheets(\"UI RM\").Activate\n    Range(\"B7:G31\").SpecialCells(xlCellTypeVisible).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Worksheets(\"quote snap\").Activate\n    Range(\"b2\").Select\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    ActiveSheet.Paste\n\n    'copy temp dims\n    Worksheets(\"UI rm\").Activate\n    Range(\"I21:s33\").SpecialCells(xlCellTypeVisible).Select\n        Selection.Copy\n    Worksheets(\"Quote Snap\").Activate\n    Range(\"H3\").Select\n    ActiveSheet.Paste\n    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Columns(\"j:j\").Select\n    Selection.ColumnWidth = 12\n\n    'select temp sheet\n    Range(\"A1:V600\").Select\n\n\nSet Source = Selection.SpecialCells(xlCellTypeVisible)\n\n\n    Set wb = ActiveWorkbook\n    Set Dest = Workbooks.Add(xlWBATWorksheet)\n\n    Source.Copy\n    With Dest.Sheets(1)\n        .Cells.Interior.Pattern = xlSolid\n        .Cells.Interior.PatternColorIndex = xlAutomatic\n        .Cells.Interior.ThemeColor = xlThemeColorDark1\n        .Cells.Interior.TintAndShade = 0\n        .Cells.Interior.PatternTintAndShade = 0\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial Paste:=xlPasteValues\n        .Cells(1).PasteSpecial Paste:=xlPasteFormats\n        .Cells(1).Select\n        Application.CutCopyMode = False\n\n    End With\n\n    TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n    TempFileName = \"Response to Quote #\" &amp; wb4.Worksheets(\"UI RM\").Range(\"F11\")\n\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 2000-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2010\n        FileExtStr = \".xlsx\": FileFormatNum = 51\n    End If\n    With Dest\n        .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, _\n                FileFormat:=FileFormatNum\n        On Error Resume Next\n        For i = 1 To 3\n            .SendMail Recipients:=mail_recipients, _\n                     Subject:=\"Response to Quote #\" &amp; wb4.Worksheets(\"UI RM\").Range(\"quote_num\") &amp; \" \" &amp; wb4.Worksheets(\"UI RM\").Range(\"client\") &amp; \" \" &amp; wb4.Worksheets(\"UI RM\").Range(\"destination\") &amp; \" \" &amp; wb4.Worksheets(\"UI RM\").Range(\"total_KGS\") &amp; \" KGS\"\n\n            If Err.Number = 0 Then Exit For\n        Next i\n        On Error GoTo 0\n        .Close SaveChanges:=False\n    End With\n\n    'Delete the file you have send\n    Kill TempFilePath &amp; TempFileName &amp; FileExtStr\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n    Application.DisplayAlerts = False\n    wb4.Worksheets(\"quote snap\").Delete\n    Application.DisplayAlerts = True\n\n\nMsgBox \"Proceso Terminado\"\n\nwb4.Sheets(\"UI RM\").Range(\"limpiar\").ClearContents\nwb4.Sheets(\"UI RM\").Range(\"F29\").ClearContents\nwb4.Sheets(\"UI RM\").Range(\"E43:I80\").ClearContents\n\n    'Starting Point\n    wb4.Worksheets(\"UI RM\").Activate\n    Range(\"F11\").Select\n\nApplication.Calculation = xlCalculationManual\n\nWorksheets(\"UI RM\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, Password:=\"045\"\n\n\nExit Sub\n\nerrHandler:\n\nDim wBook1 As Workbook\n    On Error Resume Next\n    Set wBook1 = Workbooks(\"Base de Datos Cotizaciones Shared.xlsb\")\n\n    If wBook1 Is Nothing Then 'Not open\n            Set wBook1 = Nothing\n            On Error GoTo 0\n    Else 'It is open\n            wBook1.Close SaveChanges:=False\n            Set wBook1 = Nothing\n            On Error GoTo 0\n    End If\nMsgBox \"Hubo un error\", vbExclamation, \"Error\"\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1453314187, "post_id": 34907511, "comment_id": 57551235, "body": "Have you considered filtering on vbRed and adding the visible cells?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453314499, "post_id": 34907511, "comment_id": 57551432, "body": "you&#39;ll need to set the size of the array at the beginning or do a <code>ReDim Preserve</code> to add each element that meets the condition. Also, do you really want to add the <i>Entire Row</i> or just the cells in the row with data?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1453315474, "post_id": 34907511, "comment_id": 57551986, "body": "@ScottHoltzman - The <a href=\"https://msdn.microsoft.com/en-us/library/w8k3cys2.aspx\" rel=\"nofollow noreferrer\">ReDim statement</a> with Preserve is the way to go but the OP will have to watch which <b>Rank</b> he/she is expanding. Row-by-row typically means that the rows are in the first rank and columns in the second. You can only expand the second rank with Preserve; not the first (only expand the <i>last</i> rank). <code>Application.Transpose</code> may help but can also run into limitations (<a href=\"http://stackoverflow.com/questions/31400105/vba-excel-error-13-type-mismatch\">VBA Excel \u201cerror 13: type mismatch\u201d</a>) ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453315800, "post_id": 34907511, "comment_id": 57552160, "body": "You do NOT want to add <i>&#39;the entire row&#39;</i> to an array. I cannot determine the scope (number of valid columns) from your narrative or sample code."}], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1453314468, "post_id": 34907683, "comment_id": 57551412, "body": "This method only allows adding a row once - it would not allow multiple rows to be added in succession."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453314568, "post_id": 34907683, "comment_id": 57551475, "body": "Nor does it consider the OP requirement that only certain rows will be added based on criteria."}], "tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 1, "last_activity_date": 1453314350, "creation_date": 1453314350, "answer_id": 34907683, "question_id": 34907511, "link": "https://stackoverflow.com/questions/34907511/how-could-i-add-this-to-an-array/34907683#34907683", "title": "How could I add this to an array?", "body": "<p>You can add ranges to an array, such as: </p>\n\n<pre><code>Dim myArray() As Variant 'declare an unallocated array.\nmyArray = Range(\"E2:E\" &amp; LastRow) 'myArray is now an allocated array, range being your row\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1453319079, "creation_date": 1453319079, "answer_id": 34909104, "question_id": 34907511, "link": "https://stackoverflow.com/questions/34907511/how-could-i-add-this-to-an-array/34909104#34909104", "title": "How could I add this to an array?", "body": "<p>Using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a> to isolate the 'island' of data radiating out from A1 is an easy method to restrict the 'scope' of the operation. You do not want to be copying thousands of blank cells into an array.</p>\n\n<pre><code>Sub SWAPS101()\n        'red color\n   ' If \"Security Type\" = SW\n  '  If \"New Position Ind\" = N\n '   If \"Prior Price\" = 100\n'    If \"Current Price\" does not equal 100\n    Dim a As Long, r As Long, c As Long, vVALs As Variant\n\n    With Sheets(\"Output\")\n        'reset the environment\n        If .AutoFilterMode Then .AutoFilterMode = False\n        .Columns(5).Interior.Pattern = xlNone\n        With .Cells(1, 1).CurrentRegion\n            ReDim vVALs(1 To .Columns.Count, 1 To 1)\n            .AutoFilter field:=Application.Match(\"security type\", .Rows(1), 0), Criteria1:=\"SW\"\n            .AutoFilter field:=Application.Match(\"new position ind\", .Rows(1), 0), Criteria1:=\"N\"\n            .AutoFilter field:=Application.Match(\"prior price\", .Rows(1), 0), Criteria1:=100\n            .AutoFilter field:=Application.Match(\"current price\", .Rows(1), 0), Criteria1:=\"&lt;&gt;\" &amp; 100\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                'check to ensure that there is something to work with\n                If CBool(Application.Subtotal(103, .Cells)) Then\n                    With Intersect(.Columns(5), .SpecialCells(xlCellTypeVisible))\n                        .Cells.Interior.Color = vbRed\n                    End With\n                    Debug.Print .SpecialCells(xlCellTypeVisible).Areas.Count\n                    With .SpecialCells(xlCellTypeVisible)\n                        For a = 1 To .Areas.Count\n                            Debug.Print .Areas(a).Rows.Count\n                            For r = 1 To .Areas(a).Rows.Count\n                                Debug.Print .Areas(a).Rows(r).Address(0, 0)\n                                ReDim Preserve vVALs(1 To UBound(vVALs, 1), 1 To UBound(vVALs, 2) + 1)\n                                For c = 1 To .Columns.Count\n                                    vVALs(c, UBound(vVALs, 2)) = _\n                                        .Areas(a).Rows(r).Cells(1, c).Value\n                                Next c\n                            Next r\n                        Next a\n                        vVALs = Application.Transpose(vVALs)\n                    End With\n\n                    'array is populated - do something with it\n                    Debug.Print LBound(vVALs, 1) &amp; \":\" &amp; UBound(vVALs, 1)\n                    Debug.Print LBound(vVALs, 2) &amp; \":\" &amp; UBound(vVALs, 2)\n                    'this dumps the values starting a couple of rows down\n                    With .Cells(.Rows.Count, 1).Offset(3, 0)\n                        .Resize(UBound(vVALs, 1), UBound(vVALs, 2)) = vVALs\n                    End With\n                End If\n            End With\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've left a lot of the debug.print statements in so you can watch how the process loops through the rows of each <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196243.aspx\" rel=\"nofollow noreferrer\">Range.Areas property</a> within the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a>'s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow noreferrer\">xlCellTypeVisible</a> set. Use <kbd>F8</kbd> to step through the code while keeping an eye on the VBE's Immediate window ([Ctrl]+G).</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/C8S7g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C8S7g.png\" alt=\"autofilter_results_to_array\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Post-processing results</sup></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1453323958, "post_id": 34910302, "comment_id": 57556656, "body": "It probably makes more sense to simply dump the values into any blank area of a worksheet (or a temp worksheet) than trying to navigate the areas and rows within areas of a discontiguous range. Let Excel sort it out."}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1453323212, "last_edit_date": 1495541756, "creation_date": 1453323212, "answer_id": 34910302, "question_id": 34907511, "link": "https://stackoverflow.com/questions/34907511/how-could-i-add-this-to-an-array/34910302#34910302", "title": "How could I add this to an array?", "body": "<p>My idea is to create union range <code>uRng</code> but I couldn't fill it in array so create temp sheet and past this range in it then fill the selection (the copied range) in array then delete this temp sheet.</p>\n\n<p>this will work but I don't know if it is good way so this is just an idea because <a href=\"https://stackoverflow.com/a/34909104/4039286\">Jeeped answer</a> seems the full answer for this question</p>\n\n<pre><code>Sub SWAPS101()\n        'red color\n   ' If \"Security Type\" = SW\n  '  If \"New Position Ind\" = N\n '   If \"Prior Price\" = 100\n'    If \"Current Price\" does not equal 100\n\nDim rng As Range, lCount As Long, LastRow As Long\nDim cell As Range\nDim TempArray As Variant, uRng As Range, tempSH As Worksheet\n\n'Sheets(\"Output\").Activate\n\nWith ActiveSheet\n\n    LastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each cell In .Range(\"E2:E\" &amp; LastRow) 'new position\n        If cell = \"N\" And cell.Offset(, 16) = \"SW\" And cell.Offset(, 5) = 100 _\n            And cell.Offset(, 4) &lt;&gt; 100 Then\n            With cell.EntireRow.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = 6382079\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n\n                If uRng Is Nothing Then\n                 Set uRng = cell.EntireRow\n                Else\n                 Set uRng = Union(uRng, cell.EntireRow)\n                End If\n\n        End If\n    Next cell\n\n\nEnd With\n\n  If Not uRng Is Nothing Then\n         Application.ScreenUpdating = False\n         Set tempSH = Sheets.Add\n         uRng.Copy\n         tempSH.Paste\n         TempArray = Selection.Value\n         Application.DisplayAlerts = False\n         tempSH.Delete\n         Application.DisplayAlerts = True\n         Application.ScreenUpdating = True\n  End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 34909104, "answer_count": 3, "score": 3, "last_activity_date": 1453323212, "creation_date": 1453313751, "question_id": 34907511, "link": "https://stackoverflow.com/questions/34907511/how-could-i-add-this-to-an-array", "title": "How could I add this to an array?", "body": "<p>I've been trying to add the entire row that meets the highlight criteria to an array but I've been struggling getting it to work. </p>\n\n<p>The code loops through multiple identifiers and highlight them in red based off of the preconditions. I would like to add the entire row to an array for all rows meeting the precondition criteria.</p>\n\n<pre><code>Sub SWAPS101()\n        'red color\n   ' If \"Security Type\" = SW\n  '  If \"New Position Ind\" = N\n '   If \"Prior Price\" = 100\n'    If \"Current Price\" does not equal 100\n\nDim rng As Range, lCount As Long, LastRow As Long\nDim cell As Object\n\n'Sheets(\"Output\").Activate\n\nWith ActiveSheet\n\n    LastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each cell In .Range(\"E2:E\" &amp; LastRow) 'new position\n        If cell = \"N\" And cell.Offset(, 16) = \"SW\" And cell.Offset(, 5) = 100 _\n            And cell.Offset(, 4) &lt;&gt; 100 Then\n            With cell.EntireRow.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = 6382079\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n\n'            LastRow = Range(\"b65000\").End(xlUp).Row\n'                For r = 2 To LastRow\n                        Row = Row + 1\n                            TempArray(Row, 1) = Cells(r, cell)) \n\n\n            Next r\n\n        End If\n    Next cell\n\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "printing"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1453313373, "post_id": 34907171, "comment_id": 57550802, "body": "Could you simply use <code>Workbook_BeforePrint</code> with <code>ThisWorkbook.Worksheets.Select</code>? That way, when they go to print, whether or not they choose &quot;Entire workbook&quot; it will print all of the sheets."}, {"owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1453315213, "post_id": 34907171, "comment_id": 57551814, "body": "@TheEngineer - Two issues with that: 1) I&#39;d prefer not to &#39;force&#39; the user to always print everything if they do print. However, I&#39;d be willing to do it if I had to... however that wouldn&#39;t get me around issue... 2) there really isn&#39;t an elegant way to run <b>any</b> (not just AutoExec) macros in a generated .xls file. Only &#39;ok&#39; solution I could fine would be <a href=\"http://stackoverflow.com/questions/8635231/dynamically-insert-macro-into-a-new-excel-workbook\" title=\"dynamically insert macro into a new excel workbook\">stackoverflow.com/questions/8635231/&hellip;</a> which would break about 90% of my code and run much more inefficiently."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 1, "creation_date": 1453316201, "post_id": 34907171, "comment_id": 57552365, "body": "Oh my mistake. I missed your note that this a &quot;procedurally-generated .xls&quot;. Excel does not have a built-in way of setting the &quot;Print what&quot; to &quot;Entire workbook&quot;. Have you considered using an add-in with a printing ribbon? That would probably not be a very elegant solution either, though."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453317426, "post_id": 34907171, "comment_id": 57553032, "body": "do your users run the code in Access to create the workbook? If so, add an option or checkbox on the Access Form (I assume) to choose whether they want to print or not and then write the code to print in Access."}, {"owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453379419, "post_id": 34907171, "comment_id": 57581075, "body": "@ScottHoltzman - Good idea, but unfortunately no. The Access code is triggered by a batch which is called by TaskScheduler on a VM. Thus no human intervention until it reaches the end user."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453385053, "post_id": 34907171, "comment_id": 57585143, "body": "@TMY - Ok. So it&#39;s a &quot;procedurally-generated.xls&quot;. Since Access creates the &quot;.xls&quot; file, you can then add code that will add code the &quot;.xls&quot; file to set the print settings. I know in your question you said that solution would break your code, but would it really, if you wrote a separate small procedure and ran it after the rest of your code was run in the batch file? You have <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">this link</a> in the other question ou referenced, but providing it again, just in case it helps."}], "owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1123, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453312507, "creation_date": 1453312507, "question_id": 34907171, "link": "https://stackoverflow.com/questions/34907171/using-vba-to-setup-excel-to-print-workbook-as-default-print-setting", "title": "Using VBA to Setup Excel to &#39;Print Workbook&#39; As Default Print Setting", "body": "<h2>My Question</h2>\n\n<p><em>I'm looking for a way in VBA to set a workbook to 'Print Workbook' rather than worksheet.</em></p>\n\n<h2>My Roadblocks</h2>\n\n<p><em>Can't use an AutoExec macro in the workbook itself, as this is a procedurally-generated .xls</em></p>\n\n<p>I have ACCESS VBA code that exports query results into an Excel document. That same VBA code then opens the Excel document, formats the .xls file and adds a few extra things (Headers, Footers, Freezes header rows in specific worksheets, etc). Then closes the .xls until the end users opens it later.</p>\n\n<p><em>Can't use <code>ActiveWorkbook.PrintOut</code></em></p>\n\n<p>The end user typically needs to print NOTHING, or THE ENTIRE WORKBOOK (they almost never print a single worksheet). I know I can instantly print out all worksheets by adding to the end of my sub:</p>\n\n<pre><code>ActiveWorkbook.PrintOut Copies:=1, Collate:=True\n</code></pre>\n\n<p>however, this is NOT what I want. I have users at multiple locations, some of which need to print, some of which don't. So I'd like to leave the option to print up to the individual users.</p>\n\n<p>Thus what I'm looking to do is make it so when the end user does need to MANUALLY print the document, it is already set to print the entire workbook and not the selected worksheet. I know the user can manually do that extra click, but we've had some users just hit print and say \"we're missing information\" when in fact they just didn't print the entire workbook -- I'd like to eliminate this issue.</p>\n\n<p>So with all of that said...\n<strong><em>Is there a way in VBA to set 'Print Workbook' as the default print setting?</em></strong></p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 15081, "user_id": 978961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9562cbc3556ac68f081dfda387a9f4ab?s=128&d=identicon&r=PG", "display_name": "dirn", "link": "https://stackoverflow.com/users/978961/dirn"}, "edited": false, "score": 0, "creation_date": 1453319633, "post_id": 34907123, "comment_id": 57554248, "body": "Fixed the code formatting and added the Access tag."}, {"owner": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1453319676, "post_id": 34907123, "comment_id": 57554268, "body": "Can you check by removing the spaces from folder and file names? Also check this <a href=\"https://support.microsoft.com/en-us/kb/209805\" rel=\"nofollow noreferrer\">MS KB209805 article</a> related to this issue."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453328166, "post_id": 34907123, "comment_id": 57558988, "body": "Look at www.connection strings.com, I think you need more in your connection string"}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1453500636, "post_id": 34907123, "comment_id": 57645181, "body": "You have two <code>tdf.Connect = ...</code> statements in a row. The first one looks correct, but then the second one overwrites the first one and omits the <code>;DATABASE=</code> prefix. Try getting rid of the second one and see if that works any better."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1453502900, "post_id": 34907123, "comment_id": 57646084, "body": "Unrelated note: <code>Debug.Print</code> is usually much more practical than <code>MsgBox</code> to debug your code. Especially in loops."}], "owner": {"reputation": 1, "user_id": 5216784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a50235a92510937ca69feb200a4b52c?s=128&d=identicon&r=PG&f=1", "display_name": "ricardus maximus", "link": "https://stackoverflow.com/users/5216784/ricardus-maximus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453493827, "creation_date": 1453312357, "last_edit_date": 1453493827, "question_id": 34907123, "link": "https://stackoverflow.com/questions/34907123/relinking-tables-after-an-access-front-end-is-deployed", "title": "Relinking Tables after an Access Front End is deployed", "body": "<p>I just recently split my Database to a Front End and Backend.  I am deploying the Front End to the Users via E-mail.  they paste the Front End to their DeskTop.  I wanted to include code in the Load Function that will automatically Relink the Tables so that the Relative path to the tables reflects their mapping to the backend.  The code I am using generates the following error: </p>\n\n<pre><code>3170 Run Time Error.  Could not find installable ISAM. \n</code></pre>\n\n<p>And, here is the code:</p>\n\n<pre><code>Public Function RefreshLinks(strFilename As String) As Boolean\n  ' Refresh table links to a backend database - strFilename (full path)\n  ' Returns True if successful.\n  Dim dbs As Database\n  Dim tdf As TableDef\n\n  ' Loop through all tables in the database.\n  Set dbs = CurrentDb\n  For Each tdf In dbs.TableDefs\n    MsgBox \" The table is \" &amp; tdf.name\n    ' If the table has a connect string, it's a linked table.\n    If Len(tdf.Connect) &gt; 0 Then\n      MsgBox \"The table has a connect string.\"\n\n      tdf.Connect = \";DATABASE= \" &amp; strFilename\n      tdf.Connect = strFilename\n      tdf.RefreshLink ' Relink the table.\n      Err = 0\n      On Error Resume Next\n      tdf.RefreshLink ' Relink the table.\n      'MsgBox \"The Table is linked\"\n\n      If Err &lt;&gt; 0 Then\n        RefreshLinks = False\n        ' MsgBox \"The tables aren't refreshed\"\n        Exit Function\n      End If\n    End If\n  Next tdf\n\n  RefreshLinks = True ' Relinking complete.\n  'MsgBox \"The tables are refreshed\"\nEnd Function\n</code></pre>\n\n<p>The file name that is passed is <code>EASDBLocation = \"\\\\RSDATA\\RS2\\Data2\\ComplianceReviews\\BusinessReviews\\ReviewDatabase\\2014 Revised Database\\Archive\\RAS Database Split Test_be.mdb\"</code></p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453311986, "post_id": 34906975, "comment_id": 57549903, "body": "Does <a href=\"http://stackoverflow.com/questions/11805389/getting-data-from-html-source-in-vba-excel\">this thread</a> help? Or maybe <a href=\"http://stackoverflow.com/questions/12344559/how-to-use-getelementbyid-and-copy-inner-html-vba\">this one</a>?"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453313711, "post_id": 34906975, "comment_id": 57551004, "body": "I am dealing with modifying code for hundreds of Web pages and am trying to learn all of the various ways to get at those elements because it may be easier to create variables, ie, they will all require the same type of input so rather than looking for specific id or inner HTML text, I&#39;m trying to find a way to look at say each li in an unordered list, so I can minimize the code. It may not be possible, but someone may have some tips."}], "answers": [{"comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1453414574, "post_id": 34914578, "comment_id": 57603492, "body": "Whenever I try to do anything with this other than Debug.Print, it crashes my Web browser, IEv11. The nested elements tip was a great one though and I think will lead me in the direction I was hoping for. Thankyou!"}], "tags": [], "owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "is_accepted": false, "score": 2, "last_activity_date": 1453470692, "last_edit_date": 1453470692, "creation_date": 1453344769, "answer_id": 34914578, "question_id": 34906975, "link": "https://stackoverflow.com/questions/34906975/vba-use-getelementbyid-when-no-id-is-specified/34914578#34914578", "title": "VBA -- use getElementById when no ID is specified", "body": "<p>I am assuming you are using InternetExplorer.Application (version 8 and above), have managed to retrieve the page and the format is as per your question.</p>\n\n<pre><code>Set Data = IE.Document.querySelectorAll(\"li&gt;div&gt;a\") \n'looks for tag `a` inside tag `div` inside tag `li`\n\nFor Each oA In Data\n    If oA.InnerHTML = \"Eligibility Verification\" Then\n        Set oLI = oA.ParentNode.ParentNode\n        Debug.Print oLI.InnerHTML\n    End If\nNext oA\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530391572, "creation_date": 1530391572, "answer_id": 51118360, "question_id": 34906975, "link": "https://stackoverflow.com/questions/34906975/vba-use-getelementbyid-when-no-id-is-specified/51118360#51118360", "title": "VBA -- use getElementById when no ID is specified", "body": "<p><strong>CSS selector:</strong></p>\n\n<p>You can use a CSS selector of <code>.rtIn[href=/mhpviewer.aspx?FID=EVER]</code>. This says\nelement(s) with <code>rtin</code> class with attribute <code>href</code> having value of <code>'=/mhpviewer.aspx?FID=EVER'</code></p>\n\n<hr>\n\n<p><strong>CSS query:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/13iew.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/13iew.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>You can apply for the first matching element with </p>\n\n<pre><code>Debug.Print ie.document.querySelector(\".rtIn[href=/mhpviewer.aspx?FID=EVER]\").innerHTML\n</code></pre>\n"}], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530391572, "creation_date": 1453311933, "last_edit_date": 1453470601, "question_id": 34906975, "link": "https://stackoverflow.com/questions/34906975/vba-use-getelementbyid-when-no-id-is-specified", "title": "VBA -- use getElementById when no ID is specified", "body": "<p>I am working on modifying a fairly extensive VBA Web scraper and looking for some advice on how to get elements by id when there is no actual id specified. </p>\n\n<pre><code>&lt;ul class=\"rtUL\"&gt;\n    &lt;li class=\"rtLI\"&gt;&lt;div class=\"rtMid\"&gt;\n    &lt;span class=\"rtSp\"&gt;&lt;/span&gt;&lt;span class=\"rtPlus\"&gt;&lt;/span&gt;\n    &lt;a class=\"rtIn\" href=\"/mhpviewer.aspx?FID=CSTAT\"&gt;Claim Status&lt;/a&gt;\n    &lt;/div&gt;&lt;/li&gt;&lt;li class=\"rtLI\"&gt;&lt;div class=\"rtMid\"&gt;\n    &lt;span class=\"rtSp\"&gt;&lt;/span&gt;&lt;span class=\"rtPlus\"&gt;&lt;/span&gt;\n    &lt;a class=\"rtIn\" href=\"/mhpviewer.aspx?FID=EVER\"&gt;Eligibility Verification&lt;/a&gt;\n</code></pre>\n\n<p>The element I need to get is the <code>&lt;li&gt;</code> containing \"Eligibility Verification\". Is there a way to get children elements or just inner HTML?</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 1, "creation_date": 1453314023, "post_id": 34907173, "comment_id": 57551152, "body": "This helped a lot. However, I had to make a couple of small tweaks for it to work as needed. I removed &#39;r.Cells(1, &quot;AD&quot;).Value &lt;&gt; &quot;&quot; And&#39; from the first line and also changed the &quot;6&quot; to just 6. I did fail to mention in my OP what should take precedence, I apologize for that."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1453314088, "post_id": 34907173, "comment_id": 57551181, "body": "@IronMan - I suspected that just having the structure you need would take you home :) Glad you got it worked out."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1453313608, "last_edit_date": 1453313608, "creation_date": 1453312525, "answer_id": 34907173, "question_id": 34906959, "link": "https://stackoverflow.com/questions/34906959/combine-two-worksheet-change-subs/34907173#34907173", "title": "Combine two Worksheet_Change Subs", "body": "<p>Use an <code>And</code> in your first <code>If</code> statement, and add an <code>ElseIf</code> statements. </p>\n\n<p>I am not exactly sure what you want to take precedence if both a date and 6 exist or if there is one without the other, but you can easily adjust the <code>If Then ElseIf</code> block below to sort out your needs.</p>\n\n<pre><code>If r.Cells(1, \"AD\").Value &lt;&gt; \"\" And r.cells(1,\"E\").Value = \"6\" Then\n    r.Font.Color = RGB(255, 0, 0)\nElseIf r.Cells(1,\"AD\").Value &lt;&gt; \"\" Then \n    r.Font.Color = RGB(0, 176, 80)\nElse\n    r.Font.ColorIndex = 1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 34907173, "answer_count": 1, "score": 0, "last_activity_date": 1453313608, "creation_date": 1453311879, "last_edit_date": 1531164843, "question_id": 34906959, "link": "https://stackoverflow.com/questions/34906959/combine-two-worksheet-change-subs", "title": "Combine two Worksheet_Change Subs", "body": "<p>I need two actions to take place on one sheet in my workbook. Both are based on a change event, but do not know how to make them both work. Below is the codes that I have:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim r As Range\nSet r = Target.EntireRow\n\n    If Target.row = 1 Then Exit Sub ' Don't change header color\n\n    If r.Cells(1, \"AD\").Value &lt;&gt; \"\" Then\n        r.Font.Color = RGB(0, 176, 80)\n    Else\n        r.Font.ColorIndex = 1\n    End If\nEnd Sub\n</code></pre>\n\n<p>And this one:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim r As Range\nSet r = Target.EntireRow\n\n    If Target.row = 1 Then Exit Sub ' Don't change header color\n\n    If r.Cells(1, \"E\").Value = \"6\" Then\n        r.Font.Color = RGB(255, 0, 0)\n    Else\n        r.Font.ColorIndex = 1\n    End If\nEnd Sub\n</code></pre>\n\n<p>To help determine the best course of action, here is what the end results must be:</p>\n\n<p>For any row that has a date entered into cell AD, the text color for the entire row should change to green. However, if cell E of any row contains a 6 (this is a number formatted as text), then the text in that row should be red.</p>\n\n<p>I am sure that I am over thinking this. All suggestions are appreciated.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 1, "creation_date": 1453309395, "post_id": 34906042, "comment_id": 57548178, "body": "Please table your question with the database you are using."}, {"owner": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1453310186, "post_id": 34906042, "comment_id": 57548697, "body": "access db//     tmpquery.Sql = Sql     tmpquery.ODBCTimeout = 180      Set tmpquery = Nothing      strSQL = &quot;INSERT INTO tbl_Siphon_po &quot;     strSQL = strSQL &amp; &quot;SELECT *FROM tmp &quot;     CurrentDb.Execute (strSQL)        DoCmd.DeleteObject acQuery, &quot;tmp&quot; End Sub"}, {"owner": {"reputation": 2818, "user_id": 1245195, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VRqfB.jpg?s=128&g=1", "display_name": "Joseph Lee", "link": "https://stackoverflow.com/users/1245195/joseph-lee"}, "edited": false, "score": 0, "creation_date": 1453311757, "post_id": 34906042, "comment_id": 57549728, "body": "1. This looks like your homework. You should put more effort into it :P,  2. Your title says QUERY to delete data from TWO tables, but your sql statement don&#39;t look like it (more like deleted from the tbl_siphon_req_info with conditions from another table).  You may want to rephrase your intention."}, {"owner": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "edited": false, "score": 0, "creation_date": 1453312895, "post_id": 34906042, "comment_id": 57550511, "body": "sorry my bad, its like you said, looking from the complete sql is basic  delete  information from one table  with conditions from another table"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "edited": false, "score": 0, "creation_date": 1453309751, "post_id": 34906148, "comment_id": 57548421, "body": "tmpquery.Sql = Sql     tmpquery.ODBCTimeout = 180      Set tmpquery = Nothing      strSQL = &quot;INSERT INTO tbl_Siphon_po &quot;     strSQL = strSQL &amp; &quot;SELECT *FROM tmp &quot;     CurrentDb.Execute (strSQL)       DoCmd.DeleteObject acQuery, &quot;tmp&quot;"}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1453309521, "creation_date": 1453309521, "answer_id": 34906148, "question_id": 34906042, "link": "https://stackoverflow.com/questions/34906042/sql-query-to-delete-data-from-2-tables/34906148#34906148", "title": "SQL query to delete data from 2 tables", "body": "<p>Not all databases support joins with <code>delete</code>, so a typical way to write such as query is:</p>\n\n<pre><code>delete from tbl_siphon_req_info ri\n    where exists (select 1\n                  from tbl_siphon_PO sp\n                  where concat(ri.ross_PO_nbr, ri.ross_sku12) = Concat(sp.PO_ID, substr(bitem_id, 1, 12)\n                 );\n</code></pre>\n\n<p>Note:  Depending on the database, <code>substr()</code> could be spelled <code>substring()</code>.  Similarly, <code>concat()</code> is available in most databases, infix operators are also available.</p>\n\n<p>Also, a more typical way to write the <code>where</code> clause is:</p>\n\n<pre><code>                  where ri.ross_PO_nbr = sp.PO_ID and\n                        ri.ross_sku12) = substr(bitem_id, 1, 12)\n</code></pre>\n\n<p>The logic is not exactly the same, but this is probably your intention.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "edited": false, "score": 0, "creation_date": 1453310014, "post_id": 34906175, "comment_id": 57548581, "body": "here is what i current doing    in vba      tmpquery.Sql = Sql     tmpquery.ODBCTimeout = 180     Set tmpquery = Nothing      strSQL = &quot;INSERT INTO tbl_Siphon_po &quot;     strSQL = strSQL &amp; &quot;SELECT *FROM tmp &quot;     CurrentDb.Execute (strSQL)DoCmd.DeleteObject acQuery, &quot;tmp&quot;"}, {"owner": {"reputation": 2818, "user_id": 1245195, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VRqfB.jpg?s=128&g=1", "display_name": "Joseph Lee", "link": "https://stackoverflow.com/users/1245195/joseph-lee"}, "reply_to_user": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "edited": false, "score": 0, "creation_date": 1453310097, "post_id": 34906175, "comment_id": 57548641, "body": "The VB script in this case is not relevant. What is important is what DATABASE engine you are using."}, {"owner": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "edited": false, "score": 0, "creation_date": 1453310235, "post_id": 34906175, "comment_id": 57548734, "body": "vba and access  is what i using to  create the user interface"}], "tags": [], "owner": {"reputation": 2818, "user_id": 1245195, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VRqfB.jpg?s=128&g=1", "display_name": "Joseph Lee", "link": "https://stackoverflow.com/users/1245195/joseph-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1453309581, "creation_date": 1453309581, "answer_id": 34906175, "question_id": 34906042, "link": "https://stackoverflow.com/questions/34906042/sql-query-to-delete-data-from-2-tables/34906175#34906175", "title": "SQL query to delete data from 2 tables", "body": "<p>It really depends on the exact database you are using. But you can use:</p>\n\n<pre><code>DELETE tbl_siphon_req_info, tbl_siphon_PO\nFROM tbl_siphon_req_info AS a\nLEFT JOIN tbl_siphon_PO AS b ON concat(a.ross_PO_nbr, a.ross_sku12) = concat(b.PO_ID, sbstr(bitem_id, 1, 12)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5817113, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10207403563902987/picture?type=large", "display_name": "Fagua H Danel", "link": "https://stackoverflow.com/users/5817113/fagua-h-danel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1453321213, "creation_date": 1453309209, "last_edit_date": 1453321213, "question_id": 34906042, "link": "https://stackoverflow.com/questions/34906042/sql-query-to-delete-data-from-2-tables", "title": "SQL query to delete data from 2 tables", "body": "<p>I am currently trying to delete data from a table (<code>tbl_siphon_req_info</code>) with conditions from another table (<code>tbl_siphon_PO</code>). I am using the following SQL query to do it, but it's still not working:</p>\n\n<pre><code>DoCmd.RunSQL \" DELETE tbl_siphon_req_info.* FROM tbl_siphon_req_info a, tbl_siphon_PO b WHERE Concat(a.ross_PO_nbr, a.ross_sku12) = Concat(b.PO_ID, Sbstr(bitem_id,1,12))\"\n</code></pre>\n\n<p>How do I correct and complete my query?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 5, "creation_date": 1453309205, "post_id": 34905976, "comment_id": 57548050, "body": "<code>10.50 * 100 = 1050</code> ?"}, {"owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "edited": false, "score": 0, "creation_date": 1453309207, "post_id": 34905976, "comment_id": 57548051, "body": "Please fix the formatting of the code in your post, thanks :)"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1453309565, "post_id": 34905976, "comment_id": 57548287, "body": "Just went to do that and Scott did it.  Apologies it got thrown off when I copied it over."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1453309605, "post_id": 34905976, "comment_id": 57548313, "body": "I could use Alex K&#39;s solution, but is that a bit ghetto? Or is that the simplest most useful solution."}, {"owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "edited": false, "score": 2, "creation_date": 1453309685, "post_id": 34905976, "comment_id": 57548369, "body": "It depends. Is it guaranteed that values containing a decimal point will contain 2 decimal places? And if so, do you want every one of these values to be multiplied by 100?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 1, "creation_date": 1453309853, "post_id": 34905976, "comment_id": 57548481, "body": "Yes, in this circumstance I suppose it is. Though if it changes I could use a case statement to differentiate the differences for them if necessary.  Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "is_accepted": false, "score": 2, "last_activity_date": 1453309947, "creation_date": 1453309947, "answer_id": 34906295, "question_id": 34905976, "link": "https://stackoverflow.com/questions/34905976/finding-longs-across-different-formats/34906295#34906295", "title": "Finding longs across different formats", "body": "<p>Input each cell that you are processing into the following sub:</p>\n\n<pre><code>Sub Convert(cell As Range)\n    If cell.NumberFormat = \"0.00\" Then\n        cell.Value = cell.Value * 100\n        cell.NumberFormat = \"0\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you feed these cells in...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bm5gx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bm5gx.png\" alt=\"Original data\"></a></p>\n\n<p>...the result is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/l3Fe4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l3Fe4.png\" alt=\"Processed data\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1453310671, "last_edit_date": 1453310671, "creation_date": 1453310034, "answer_id": 34906321, "question_id": 34905976, "link": "https://stackoverflow.com/questions/34905976/finding-longs-across-different-formats/34906321#34906321", "title": "Finding longs across different formats", "body": "<p>To broaden the \"multiply by 100\" answers into something more general, the below code will look to see how many decimal places there are, then multiply by the correct factor of 10 to remove the decimals.</p>\n\n<pre><code>Dim iDec as Integer\nIf Instr(1,productSheet.Cells(counter,3),\".\") &gt; 0 Then\n    iDec = Len(productSheet.Cells(counter,3))-Application.WorksheetFunction.Find(\".\",productSheet.Cells(counter,3))\n    productSheet.Cells(counter,3) = productSheet.Cells(counter,3) * (10^iDec)\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 1, "creation_date": 1453310784, "post_id": 34906322, "comment_id": 57549115, "body": "For an input of &quot;30.00&quot;, this will give &quot;30&quot;, not &quot;3000&quot; as requested."}], "tags": [], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "is_accepted": false, "score": -3, "last_activity_date": 1453388238, "last_edit_date": 1453388238, "creation_date": 1453310042, "answer_id": 34906322, "question_id": 34905976, "link": "https://stackoverflow.com/questions/34905976/finding-longs-across-different-formats/34906322#34906322", "title": "Finding longs across different formats", "body": "<p>I'm not 100% certain and am not anywhere that I can test right now,  but would     </p>\n\n<blockquote>\n  <p>Range (\"F2\").Value2 * 100</p>\n</blockquote>\n\n<p>work here?   It should give the underlying value without formatting,  no? </p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1453363651, "creation_date": 1453363651, "answer_id": 34918377, "question_id": 34905976, "link": "https://stackoverflow.com/questions/34905976/finding-longs-across-different-formats/34918377#34918377", "title": "Finding longs across different formats", "body": "<p>You can run an efficient search with <code>Find</code> rather than look at each cell:</p>\n\n<pre><code>Dim rng1 As Range\nApplication.FindFormat.NumberFormat = \"0.00\"\n\nSet rng1 = Range(\"A1:A10\").Find(\"*\", , , , , , , , True)\nDo While Not rng1 Is Nothing\n    rng1.Value2 = rng1.Value2 * 100\n    rng1.NumberFormat = \"0\"\n    Set rng1 = Range(\"A1:A10\").Find(\"*\", , , , , , , , True)\nLoop\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1453388238, "creation_date": 1453309028, "last_edit_date": 1453309525, "question_id": 34905976, "link": "https://stackoverflow.com/questions/34905976/finding-longs-across-different-formats", "title": "Finding longs across different formats", "body": "<p>I have data that's in multiple formats and I am struggling to change them in an attempt to locate them.  The numbers in question are currently stored as numbers in the format <code>dataT.Range(\"F2:F\" &amp; lRow).NumberFormat = \"###.00\"</code> However they are stored elsewhere in another spreadsheet as #### with the decimal not being included.  Examples of this would be original format: \"30.00\"  New format \"3000\" or Original format: \"10.50\" New format \"1050\".  I attempted to remove the decimal through the <code>Replace()</code> Function, but I was fairly certain it would fail and it did.  Any thoughts or recommendations would be much appreciated.  This function is a very tiny piece of a larger routine.</p>\n\n<p><strong>Question put Simply: I need to change numbers stored in this format \"30.00\" to target format \"3000\"  Line with the starts to the right is where I attempted to fix the problem</strong></p>\n\n<pre><code>Function AnalyzeOiData(lRow As Integer, oiDataSheet As Worksheet, productSheet As Worksheet, rownum As Integer)\n\nDim counter As Integer\nDim monthExp As String\nDim oiLocationFinder As Range\nDim strikeLoc As Range\nDim optStrike As Long\n\nFor counter = rownum To lRow\n\n     'Returns formatted monthcode for finding the different months of expiry embedded in the OI data\n     monthExp = GetMonthCode(productSheet.Cells(counter, 1), productSheet.Cells(counter, 2))\n     optStrike = Replace(productSheet.Cells(counter, 3), \".\", \"\")  ***\n     oiLocationFinder = oiDataSheet.Columns(1).Find(monthExp)\n\n     oiLocationFinder.Select\n     strikeLoc = Range(Selection, Selection.End(xlDown)).Find(optStrike).Address\n\n     productSheet.Cells(counter, 11) = strikeLoc.Offset(0, 9)\n     productSheet.Cells(counter, 12) = strikeLoc.Offset(0, 10)\n\nNext\n\nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "excel", "vba", "automation"], "comments": [{"owner": {"reputation": 11828, "user_id": 4420967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6pYX.png?s=128&g=1", "display_name": "James Z", "link": "https://stackoverflow.com/users/4420967/james-z"}, "edited": false, "score": 0, "creation_date": 1453308715, "post_id": 34905585, "comment_id": 57547726, "body": "Load the data into the database using SSIS?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453308948, "post_id": 34905585, "comment_id": 57547876, "body": "VTC - <i>Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam.</i> .... You asked us not to flag as an opinion article because it is 100% not. Yet, all you ask is for how we would automate a report with many data sources. There are many ways to skin a cat and many, many opinions based on the languages you prefer to code in."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1453324321, "post_id": 34905585, "comment_id": 57556888, "body": "I have had really good success with storing the data in a unified database and using MS Query, built directly into Excel.  C# can be used to wake up and &quot;tickle&quot; the data (refresh everything), including pivot tables, charts, etc.  We have dozens of reports that run this way every morning without any human intervention.  MySQL, PostgreSQL and SQL Server Express are all fine choices for the harmonized DB.  My personal favorite is PostgreSQL."}], "answers": [{"tags": [], "owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "is_accepted": false, "score": 1, "last_activity_date": 1453309024, "creation_date": 1453309024, "answer_id": 34905973, "question_id": 34905585, "link": "https://stackoverflow.com/questions/34905585/ways-to-automate-excel-for-reporting-on-a-scheduled-basis-where-pivot-tables-won/34905973#34905973", "title": "Ways to Automate excel for reporting on a scheduled basis where pivot tables wont cut it and data is coming from many places?", "body": "<p>I understand the emphasis you gave on the many sources part, however my first approach to such a subject is always how to standardize the raw form of the data. I believe that standardization is the golden rule. Which brings the question on how to do it.</p>\n\n<p>On a recent example, I had to make a tool that produces a report based on data available on both an SQL server and online Excel spreadsheets. The solution was to convert all the data in the format I was most comfortable working with, which for me was Excel spreadsheets. Hence, for the data in the SQL Server I produced a script that fed from an online available spreadsheet e.g. on a SharePoint and in turn save the data in the same online location. At this stage the data was in pretty raw form (i.e. no processing, minimal filtering etc.).</p>\n\n<p>Thus having a common online location where my data (Excel spreadsheets and converted SQL data) are available, I produced an add in that fed of from that location. The benefit of this was that the add-in can be distributed to multiple users (which was my prerequisite) and everyone feed of data from the same location.</p>\n\n<p>To summarise:</p>\n\n<ul>\n<li>Standardize as much as possible raw data form.</li>\n<li>Common data source.</li>\n<li>Do processing of data in language you are most comfortable with.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "is_accepted": false, "score": 1, "last_activity_date": 1453309078, "creation_date": 1453309078, "answer_id": 34905997, "question_id": 34905585, "link": "https://stackoverflow.com/questions/34905585/ways-to-automate-excel-for-reporting-on-a-scheduled-basis-where-pivot-tables-won/34905997#34905997", "title": "Ways to Automate excel for reporting on a scheduled basis where pivot tables wont cut it and data is coming from many places?", "body": "<p>Personally, I would create a program in C# or Visual Basic (it's personal preference; both use the same .NET features) which imports data in whatever format you require.</p>\n\n<p>Firstly, you can extract data from XLS files by <a href=\"https://msdn.microsoft.com/en-us/library/dd264733.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\" title=\"referencing Excel Interop\">referencing Excel Interop in your .NET project</a>. Extracting CSV data is not particularly difficult if you use the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx\" rel=\"nofollow\" title=\"TextFieldParser class\">TextFieldParser class</a> (see <a href=\"https://msdn.microsoft.com/en-us/library/cakac7e6.aspx\" rel=\"nofollow\" title=\"Read From Comma-Delimited Text Files in Visual Basic\">here</a> for a Visual Basic tutorial). This same class will allow you to parse tab-delimited data. JSON-formatted data is more tricky, but <a href=\"http://www.newtonsoft.com/json\" rel=\"nofollow\" title=\"Json.NET\">this free, open-source .NET library</a> provides everything you would need in that department.</p>\n\n<p>As for SQL Server, this is apparently quite easy to use with a .NET application (see <a href=\"https://msdn.microsoft.com/en-us/library/s4yys16a%28v=vs.90%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\" title=\"Create Connections to SQL Server Databases\">here</a> or just Google it).</p>\n\n<p>The trick is to always extract this data into <strong>the same internal format</strong>, so that you can import it into Excel in the same way after retrieving it.</p>\n\n<p>Your requirements are complex ones, and as such I cannot give a particularly full answer, but hopefully my viewpoint is a useful one...</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 4941617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a32823cb875c0c7e81a8b5cc466cbac?s=128&d=identicon&r=PG&f=1", "display_name": "ALPHAB3TS00P", "link": "https://stackoverflow.com/users/4941617/alphab3ts00p"}, "edited": false, "score": 0, "creation_date": 1453325361, "post_id": 34906834, "comment_id": 57557470, "body": "Thanks This is a pretty good explanation of ETL. How would you Update your excel file and Freeze it/remove connections for export/email? <b>E</b>-grab from ftp/other site and Load to MSAccess (VBA) <b>T</b>-Query data and prep for tables through SQL <b>L</b>- link table in excel and present it in human readable way.   <b>Next</b> - get it to the End user without massive file or linked tables. I&#39;m guessing that is done through vba too?"}, {"owner": {"reputation": 61, "user_id": 5817163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWVVB.jpg?s=128&g=1", "display_name": "IITC", "link": "https://stackoverflow.com/users/5817163/iitc"}, "reply_to_user": {"reputation": 67, "user_id": 4941617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a32823cb875c0c7e81a8b5cc466cbac?s=128&d=identicon&r=PG&f=1", "display_name": "ALPHAB3TS00P", "link": "https://stackoverflow.com/users/4941617/alphab3ts00p"}, "edited": false, "score": 0, "creation_date": 1453560045, "post_id": 34906834, "comment_id": 57659953, "body": "@ALPHAB3TS00P ... &quot;How would you Update ..&quot; Pretty easy when the data connections are clearly defined. <a href=\"https://support.office.com/en-us/article/Create-edit-and-manage-connections-to-external-data-e11a7a0f-4cea-491c-b6ac-2f4197c6af82\" rel=\"nofollow noreferrer\">link</a> &quot;E-grab from ftp/other site ....guessing that is done through vba too?&quot; Only for smaller amounts of data usually up to 6 MB.  But for larger amounts of data and unstructrured information, it is always  &#39;ETL process to SQL server, run T-SQL queries, export to Text / Excel (no need for Access) then use VBA to generate format and present data.&#39;"}], "tags": [], "owner": {"reputation": 61, "user_id": 5817163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWVVB.jpg?s=128&g=1", "display_name": "IITC", "link": "https://stackoverflow.com/users/5817163/iitc"}, "is_accepted": true, "score": 1, "last_activity_date": 1453311848, "last_edit_date": 1453311848, "creation_date": 1453311505, "answer_id": 34906834, "question_id": 34905585, "link": "https://stackoverflow.com/questions/34905585/ways-to-automate-excel-for-reporting-on-a-scheduled-basis-where-pivot-tables-won/34906834#34906834", "title": "Ways to Automate excel for reporting on a scheduled basis where pivot tables wont cut it and data is coming from many places?", "body": "<p>Using the following methods for long and the most recent successful deployment is December 2015.</p>\n\n<p>Consider the following points for successful automation in scenarios with data from different sources and in different formats:</p>\n\n<ol>\n<li><p>Extraction of data from different sources through</p>\n\n<p>a. Windows powershell (job scheduling) - fast and useful, 'cause you use MS technologies (OR)</p>\n\n<p>b. Any other programming language you are comfortable in (OR)</p>\n\n<p>c. Through SQL agent T-SQL queries (well-defined and well-structured)\n&amp; place all the data in a single folder</p></li>\n<li><p>Transform the data into desired data sets using your preferred method -</p>\n\n<p>a. Powershell (job scheduling) - best (OR)</p>\n\n<p>b. Any other language you desire (OR)</p>\n\n<p>c. VBA for Excel / Access / CSV /Text format\n&amp; I suggest to convert the data sets into .txt format</p></li>\n<li><p>Load these data sets into SQL server / DBMS or wherever for further operations, operate on the data set with your queries and set the jobs as under:</p>\n\n<p>a. Through SQL agent via T-SQL queries (well-defined and well-structured) (job scheduling)- output to text / excel format (AND)</p>\n\n<p>b. Use VBA to import and create pivot table / analysis / reports in Excel and schedule through job scheduler</p></li>\n<li><p>Value Addition - \nUse Powershell extensively for scheduling the jobs, embedding the VBA code, data transactions with SQL server and sending the email (alerts / reports as attachments / notification about success or fails etc).  Please remember to provide sufficient access privileges on network drives / servers which is key to success.</p></li>\n</ol>\n\n<p>Cheers</p>\n"}], "owner": {"reputation": 67, "user_id": 4941617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a32823cb875c0c7e81a8b5cc466cbac?s=128&d=identicon&r=PG&f=1", "display_name": "ALPHAB3TS00P", "link": "https://stackoverflow.com/users/4941617/alphab3ts00p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 34906834, "answer_count": 3, "score": 2, "last_activity_date": 1453325754, "creation_date": 1453307943, "last_edit_date": 1453325754, "question_id": 34905585, "link": "https://stackoverflow.com/questions/34905585/ways-to-automate-excel-for-reporting-on-a-scheduled-basis-where-pivot-tables-won", "title": "Ways to Automate excel for reporting on a scheduled basis where pivot tables wont cut it and data is coming from many places?", "body": "<p>I have a problem that I keep on running into and I cant find the answers anywhere online. and please don't flag this as an opinion article because it 100% is not. </p>\n\n<p>I have a fairly complicated excel report that I need to create and then automate. I have data that is dropped on an ftp site in the form of <strong>CSV, tab delimited, json and .xls</strong>. I also have data on <strong>SQL Server</strong> that I need to bring in too. Once I get the data I have to get it organized, and perform metrics on it too (meaning that its not as simple as drag and drop into a single excel file).</p>\n\n<p>Currently I have been using VBA to import most of it into MS Access and then doing complicated queries to get the data mostly how I want it, then I would port it over to excel by linking the queries in excel and getting it automated by calling the file and specifying a macro to update and import in Access/Excel from a scheduled task.</p>\n\n<p>Not only is this sloppy, It also feels unprofessional and like it could blow up on me at any minute. </p>\n\n<p><strong>Are there any better/cleaner/more straightforward/clearer/safer ways to do this?</strong> </p>\n\n<p>I know the idea of a c# console app but I cant find any good tutorials to get far enough along to get anything accomplished.  </p>\n\n<p>Getting all of the Data localized into one server is out of the question unless I write scripts to do it from the ftp site</p>\n\n<p>I know many programmers are anti Access, and anti VBA. Some have good points, others are just trolls. Please post your experiences with automating excel reports for a good <strong>2016 solution</strong>. All of the documentation that is out there is from 2007 and previous and a Good <strong>Modern</strong> answer is nowhere to be found or else people are trying to claim that buying their library/addin is the only solution (those people make me sick that try to thrust crappy code down your throat). </p>\n\n<p>I know about interop, and I know about openxml, and IIS, but I'm not finding great examples online on how to do what I'm aiming for, and Im not even sure if that information is up to date. </p>\n\n<p>So all in all, How do you/would you automate an excel report that needs more finesse than a pivot table, and has data coming from <strong>MANY</strong>  sources on a scheduled basis? And does anyone have a good 2016 example that is not outdated or running on XP still (XP was a great os, but time has come to move on)</p>\n\n<p>preferably C#, VBA, SQL would be the tools used with as little external libraries and addins as possible</p>\n\n<p>Thanks</p>\n\n<p><strong>Note:</strong>  <em>Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam.</em> \n-I am asking about how Automation on excel is done by professionals, and how to do it in a procedural way. I am not asking for books, libraries, or 3rd party tools, or other resources. I am asking for an approach to solve a coding dilemma because I keep on spinning with 100's of lines of code and believe there has to be a more straightforward way.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453307856, "post_id": 34905524, "comment_id": 57547119, "body": "Just use something like <code>Activesheet.name</code> or <code>Sheets(1).Name</code>. Or am I not understanding something in your question?"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453308033, "post_id": 34905524, "comment_id": 57547232, "body": "If you want to run macro always in active workbook, use <code>ActiveWorkbook</code> instead of <code>Workbook(&quot;Data&quot;)</code>."}, {"owner": {"reputation": 7441, "user_id": 807325, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9bURh.jpg?s=128&g=1", "display_name": "EnexoOnoma", "link": "https://stackoverflow.com/users/807325/enexoonoma"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453308436, "post_id": 34905524, "comment_id": 57547529, "body": "@BruceWayne I run the macro from a  different workbook and I have those 2 workbooks, so I cant use activesheet.  I need to specify from which workbook because the calculations are different for each of them"}, {"owner": {"reputation": 7441, "user_id": 807325, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9bURh.jpg?s=128&g=1", "display_name": "EnexoOnoma", "link": "https://stackoverflow.com/users/807325/enexoonoma"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453308443, "post_id": 34905524, "comment_id": 57547531, "body": "@EganWolf I run the macro from a  different workbook and I have those 2 workbooks, so I cant use activesheet.  I need to specify from which workbook because the calculations are different for each of them"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 3, "last_activity_date": 1453307984, "creation_date": 1453307984, "answer_id": 34905601, "question_id": 34905524, "link": "https://stackoverflow.com/questions/34905524/how-can-i-run-a-macro-that-takes-the-names-of-the-workbook/34905601#34905601", "title": "How can I run a macro that takes the names of the workbook?", "body": "<p>Iterate through the workbooks collection:</p>\n\n<pre><code>Dim wb       As Excel.Workbook\nDim wbSalary As Excel.Workbook\nDim wbData   As Excel.Workbook\n\nFor Each wb In Workbooks\n    If wb.Name Like \"Data*\" Then\n        Set wbData = wb\n    Else If wb.Name Like \"Salary*\" Then\n        Set wbSalary = wb\n    End If\nNext\n\n'// For example...\nMsgBox wbData.Name &amp; \" contains \" &amp; wbData.Sheets.Count &amp; \" worksheets.\"\nMsgBox wbSalary.Name &amp; \" contains \" &amp; wbSalary.Sheets.Count &amp; \" worksheets.\"\n</code></pre>\n\n<p>Then use <code>wbData</code> and <code>wbSalary</code> in your code to refer to that workbook</p>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453310996, "post_id": 34906336, "comment_id": 57549261, "body": "just curious why you provided an <i>identical</i> answer to one that was already given (except that you placed the OP&#39;s pseudo-code inside the <code>IF block</code>?"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453311458, "post_id": 34906336, "comment_id": 57549552, "body": "@ScottHoltzman, the other answer only work with one workbook (the last one that loop find it). but it will not work with all workbooks as in this question: <code>Data (1), Data (2), Data (3)</code> and <code>Salary (1), Salary (2)\u2026</code>. my answer will work with all these workbooks."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453312211, "post_id": 34906336, "comment_id": 57550074, "body": "I see what you mean now. As written @Macro Man&#39;s code will set the workbook first, but not process it inside the <code>If</code> block. OP would have to put his code after the <code>Set</code> statements to process."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453312625, "post_id": 34906336, "comment_id": 57550331, "body": "@ScottHoltzman, You are right , both answers are the same if we put <code>MsgBox wbData.Name.....</code> inside the loop in the other answer."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1453319046, "post_id": 34906336, "comment_id": 57553934, "body": "If you look at my edit revisions - I did actually use this logic in my first post, but reading the question again I think the OP has just re-opened another temp version of the same workbook as opposed to having multiple workbooks open - of course it would help if the OP actually gave feedback on the answers to let us know! Either way +1 because great minds obviously think alike :)"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1453320690, "post_id": 34906336, "comment_id": 57554813, "body": "@MacroMan, thank you, and i&#39;m sorry about posting very very similar answer to your answer, but i saw the OP add 2 comments to the question and didn&#39;t gave feedback on the answer or accept it, so i understand from this that the answer not work as he want, and I understand things in this way even on my own comments and answers. <a href=\"http://stackoverflow.com/q/34313757/4039286\">like this question</a>, when I didn&#39;t saw any feedback on my first comment I thought it didn&#39;t work and spent a lot of time to post another way in new answer."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1453322516, "post_id": 34906336, "comment_id": 57555887, "body": "@Fadi no need to say sorry haha it might <i>look</i> similar but it does a different thing and the most important thing is that people learn something. That&#39;s what we&#39;re all here for!"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 2, "last_activity_date": 1453310080, "creation_date": 1453310080, "answer_id": 34906336, "question_id": 34905524, "link": "https://stackoverflow.com/questions/34905524/how-can-i-run-a-macro-that-takes-the-names-of-the-workbook/34906336#34906336", "title": "How can I run a macro that takes the names of the workbook?", "body": "<p>This Code will work with all opened workbooks that its name start with <code>Data</code> or <code>Salary</code>:</p>\n\n<pre><code>Sub Test()\n\n Dim Wb As Workbook\n Dim i As Long\n\n For Each Wb In Workbooks\n\n   If Wb.Name Like \"Data*\" Then\n        For i = 1 To 100\n          If Wb.Worksheets(\"Shee1\").Cells(i, 4).Value = 100 Then\n            '....\n            '....\n          End If\n        Next\n\n    ElseIf Wb.Name Like \"Salary*\" Then\n        For i = 1 To 100\n          If Wb.Worksheets(\"Shee1\").Cells(i, 4).Value &lt; 2000 Then\n            '....\n            '....\n          End If\n        Next\n    End If\n\n Next\nEnd Sub\n</code></pre>\n\n<p>if you want to work with all opened workbooks that its name contain <code>Data</code> or <code>Salary</code> then change <code>\"Data*\"</code> and <code>\"Salary*\"</code> to <code>\"*Data*\"</code> and <code>\"*Salary*\"</code>.</p>\n"}], "owner": {"reputation": 7441, "user_id": 807325, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9bURh.jpg?s=128&g=1", "display_name": "EnexoOnoma", "link": "https://stackoverflow.com/users/807325/enexoonoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456249581, "creation_date": 1453307795, "last_edit_date": 1531161705, "question_id": 34905524, "link": "https://stackoverflow.com/questions/34905524/how-can-i-run-a-macro-that-takes-the-names-of-the-workbook", "title": "How can I run a macro that takes the names of the workbook?", "body": "<p>I want to run a macro in which I specify the name of the workbook I want to use.</p>\n\n<p>The name of the workbook changes like <code>Data (1), Data (2), Data (3) \u2026</code> because I might open the same file more than 1 time.  The same happens for the workbook Salary, sometimes it appears as <code>Salary (1), Salary (2)\u2026</code> and is giving me an error of \u201dSubscript out of range\u201d.</p>\n\n<p>How can I run a macro that takes the name of the workbook </p>\n\n<blockquote>\n  <p>Data, Data (1), Data (2) \u2026 and Salary, Salary (1), Salary (2)\u2026</p>\n</blockquote>\n\n<pre><code>For i = 1 to 100\n\nIf Workbooks(\u201cData\u201d).Worksheets(\u201cShee1).Cells(i,4).Value = 100 Then\n.\n.\n.\n\nFor i = 1 to 100\n\nIf Workbooks(\u201cSalary). \u201d).Worksheets(\u201cShee1).Cells(i,4).Value &lt; 2000 Then\n.\n.\n.\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453308136, "post_id": 34905453, "comment_id": 57547306, "body": "Add <code>Debug.Print StrSql</code> to the line before <code>CurrentDb.Execute</code>, then run the code.  When you get error 3464 again, copy the <code>StrSql</code> text from the Immediate window and show it to us.  You can use Ctrl+g to go to the Immediate window.  Also what is the value of <code>var</code> when you get the error?"}, {"owner": {"reputation": 27, "user_id": 3203169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ab7dbe1fa720cf69eba7fed9c8f2279?s=128&d=identicon&r=PG&f=1", "display_name": "user3203169", "link": "https://stackoverflow.com/users/3203169/user3203169"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453308941, "post_id": 34905453, "comment_id": 57547870, "body": "Here is the printout: INSERT INTO [Testresult] (Year, Period, Entity, Region, [Product Recall], Account, AcctVal) SELECT Year, Period, Entity, Region, [Product Recall], &quot;Other_Gross_Premium_Written&quot;, getvar() FROM [MFTest] .  Var = &quot;Other_Gross_Premium_Written&quot;.  I&#39;m trying to pull the field Other_Gross_Premium_Written from the table and I think its the quotes that are the issue?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453309288, "post_id": 34905453, "comment_id": 57548109, "body": "Then do you get what you want if you change <code>&quot;&quot;&quot; &amp; AccountName &amp; &quot;&quot;&quot;</code> to <code>&quot; &amp; AccountName &amp; &quot;</code>?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453310434, "post_id": 34905453, "comment_id": 57548866, "body": "try .....,[&quot; &amp; accountname &amp; &quot;],..."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453311849, "post_id": 34905453, "comment_id": 57549801, "body": "Also change <code>Year</code> to <code>[Year]</code> both places in the statement to distinguish the field from the <code>Year()</code> function."}, {"owner": {"reputation": 27, "user_id": 3203169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ab7dbe1fa720cf69eba7fed9c8f2279?s=128&d=identicon&r=PG&f=1", "display_name": "user3203169", "link": "https://stackoverflow.com/users/3203169/user3203169"}, "edited": false, "score": 0, "creation_date": 1453313799, "post_id": 34905453, "comment_id": 57551043, "body": "Yes!  Thankyou!  Just to clarify, I replaced the getvar() with [&quot; &amp; accountname &amp; &quot;].  What I am trying to do is to show the Accountname first and then the Account value in the next column.  It was the syntax to bring in the field that I could get."}, {"owner": {"reputation": 27, "user_id": 3203169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ab7dbe1fa720cf69eba7fed9c8f2279?s=128&d=identicon&r=PG&f=1", "display_name": "user3203169", "link": "https://stackoverflow.com/users/3203169/user3203169"}, "edited": false, "score": 0, "creation_date": 1453313922, "post_id": 34905453, "comment_id": 57551105, "body": "Hmm, been awhile.  How do I mark this as solved?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3203169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ab7dbe1fa720cf69eba7fed9c8f2279?s=128&d=identicon&r=PG&f=1", "display_name": "user3203169", "link": "https://stackoverflow.com/users/3203169/user3203169"}, "edited": false, "score": 0, "creation_date": 1453425717, "post_id": 34909606, "comment_id": 57607266, "body": "Hambone, actually what I was trying to do was to reformat a multi-column data table to a single column table.  I was trying to use a variable to select the data column, but couldn&#39;t get the syntax right.  Nathan_Sav and HansUp answered my problem.  Thanks."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1453320838, "creation_date": 1453320838, "answer_id": 34909606, "question_id": 34905453, "link": "https://stackoverflow.com/questions/34905453/ms-access-error-3464-using-variable-for-field-in-insert-into-statement/34909606#34909606", "title": "MS Access Error 3464 - using variable for field in INSERT INTO statement", "body": "<p>It looks like you are taking every record from <code>MfTest</code> and adding each of these for account numbers 1-50 into your new table.  If that's the case, would something like this work:</p>\n\n<pre><code>INSERT INTO [Testresult]\n([Year], [Period], [Entity], [Region], [Product Recall], [Account], [AcctVal])\nSELECT\n  [MFTest].[Year], [MFTest].[Period], [MFTest].[Entity], [MFTest].[Region],\n  [MFTest].[Product Recall], [AcctTable].[AccountName], [AcctTable].[AccountName]\nFROM\n  [MFTest],\n  [AcctTable]\nWHERE\n  [AcctTable].[AcctNum] between 1 and 50\n</code></pre>\n\n<p>As a single statement rather than within a loop?</p>\n\n<p>The only caveat is that your code above should also include blanks where there is no such account number -- which perhaps you wanted but I would intuitively suspect not, as you would have repeat blanks for every non-account number.</p>\n\n<p>By the way, this is a cartesian join, which is usually done by accident, but in this case it seems to be what you wanted.</p>\n\n<p>If this doesn't work, I'd recommend adding parameters to your insert query.  Even if you can get it working, Parameters (bind variables) are a better practice and will save you headaches in the long run.</p>\n"}], "owner": {"reputation": 27, "user_id": 3203169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ab7dbe1fa720cf69eba7fed9c8f2279?s=128&d=identicon&r=PG&f=1", "display_name": "user3203169", "link": "https://stackoverflow.com/users/3203169/user3203169"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642865, "creation_date": 1453307617, "last_edit_date": 1594642865, "question_id": 34905453, "link": "https://stackoverflow.com/questions/34905453/ms-access-error-3464-using-variable-for-field-in-insert-into-statement", "title": "MS Access Error 3464 - using variable for field in INSERT INTO statement", "body": "<p>I'm trying to run a query using vba with a variable in my INSERT INTO statement to select the field to use.  I've done some research and found some similar problems where the solution was to create a function with a variable and to call the function in my sql statement, but I am still running into issues.  If I hard-code the field, it works.  Thanks in advance.  Here is my code so far:</p>\n\n<pre><code>Option Compare Database\nPublic var As Variant\n\nPublic Function GetVar() As String\n    GetVar = var\nEnd Function\n\nSub Build()\n\nDim varX As String\nDim count As Integer\nDim AccountName As String\n\nFor count = 1 To 50\n\n    varX = DLookup(\"[AcctName]\", \"AcctTable\", \"[AcctNum] =\" &amp; count)\n    AccountName = varX\n    var = varX\n\n\n    StrSql = \"INSERT INTO [Testresult] (Year, Period, Entity, Region, [Product Recall], Account, AcctVal)\" &amp; _\n    \" SELECT Year, Period, Entity, Region, [Product Recall], \"\"\" &amp; AccountName &amp; \"\"\", getvar() FROM [MFTest] \"\n\n    CurrentDb().Execute StrSql, dbFailOnError\n\n    Next count\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453307625, "post_id": 34905384, "comment_id": 57546966, "body": "And what did you try so far?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1453307796, "post_id": 34905384, "comment_id": 57547082, "body": "Take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195836.aspx\" rel=\"nofollow noreferrer\"><code>BeforePrint</code></a> worksheet event."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1453310512, "creation_date": 1453310512, "answer_id": 34906485, "question_id": 34905384, "link": "https://stackoverflow.com/questions/34905384/excel-activex-check-box-to-enable-or-disable-printing/34906485#34906485", "title": "Excel activex check box to enable or disable printing", "body": "<p>You need to actually test if the checkbox is checked or not. Also, you need to place this code inside the <a href=\"http://www.rondebruin.nl/win/code.htm\" rel=\"nofollow\">ThisWorkbook</a> module in the VBE.</p>\n\n<p>Change sheet and checkbox name as needed:</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n\n   If Sheets(\"Sheet1\").CheckBox1.Value = False Then\n     Cancel = True\n     MsgBox \"CANNOT PRINT, check box 1 is unchecked\", vbOKOnly, \"Error\"\n   End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4887598, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ArvmmLnHa4M/AAAAAAAAAAI/AAAAAAAABOI/bCvpytE0Ebo/photo.jpg?sz=128", "display_name": "donald kuda", "link": "https://stackoverflow.com/users/4887598/donald-kuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 34906485, "answer_count": 1, "score": -1, "last_activity_date": 1462523025, "creation_date": 1453307385, "last_edit_date": 1531161705, "question_id": 34905384, "link": "https://stackoverflow.com/questions/34905384/excel-activex-check-box-to-enable-or-disable-printing", "title": "Excel activex check box to enable or disable printing", "body": "<p>hie </p>\n\n<p>am looking for a vba code for controlling printing of excel sheet using activex check box in excel.</p>\n\n<p>The code should only print the excel sheet when the checkbox is checked\nand disable printing when unchecked.</p>\n\n<p>i have tried the event below but it still prints and the msgbox is not showing</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\nCancel = True\nMsgBox \"CANNOT PRINT, check box 1 is unchecked\", vbOKOnly, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1453306417, "post_id": 34905009, "comment_id": 57546076, "body": "That is not VB.Net code.  Please remove the tag"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453306775, "post_id": 34905009, "comment_id": 57546335, "body": "have you tried copying it as an image?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1453310777, "post_id": 34905009, "comment_id": 57549108, "body": "FYR... <a href=\"http://stackoverflow.com/questions/25558354/best-way-to-copy-excel-table-into-powerpoint-2010\" title=\"best way to copy excel table into powerpoint 2010\">stackoverflow.com/questions/25558354/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5815001, "user_type": "registered", "profile_image": "https://graph.facebook.com/749106358/picture?type=large", "display_name": "Simon JL", "link": "https://stackoverflow.com/users/5815001/simon-jl"}, "is_accepted": false, "score": 0, "last_activity_date": 1453382467, "creation_date": 1453382467, "answer_id": 34924997, "question_id": 34905009, "link": "https://stackoverflow.com/questions/34905009/how-can-i-paste-a-table-and-keep-formatting-from-excel-to-powerpoint/34924997#34924997", "title": "How can I paste a table and keep formatting from Excel to Powerpoint?", "body": "<p>I'm posting this because most of you will probably laugh:</p>\n\n<blockquote>\n  <p>It helps to save the workbook as a macro enabled one first before\n  doing fun stuff with VB.</p>\n</blockquote>\n\n<p>Yes, I did facepalm.</p>\n"}], "owner": {"reputation": 103, "user_id": 5815001, "user_type": "registered", "profile_image": "https://graph.facebook.com/749106358/picture?type=large", "display_name": "Simon JL", "link": "https://stackoverflow.com/users/5815001/simon-jl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2008, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453382467, "creation_date": 1453306374, "last_edit_date": 1531161705, "question_id": 34905009, "link": "https://stackoverflow.com/questions/34905009/how-can-i-paste-a-table-and-keep-formatting-from-excel-to-powerpoint", "title": "How can I paste a table and keep formatting from Excel to Powerpoint?", "body": "<p>I am trying to paste a table from Excel to Powerpoint and keep the source formatting (as a table).</p>\n\n<p>Currently using this to paste:</p>\n\n<pre><code>'Paste to PowerPoint and position\n mySlide.Shapes.PasteSpecial DataType:=ppPasteSourceFormatting,    DisplayAsIcon:=msoFalse\n Set myShapeRange = mySlide.Shapes(mySlide.Shapes.Count)\n</code></pre>\n\n<p>This was working before, but at that time I wasn't selecting a dynamic range and creating a table from it, the table already existed and this code worked fine. </p>\n\n<p>I've tried many different things today, but my knowledge of VB isn't good enough to figure the issue out. Hopefully someone can be my saviour!</p>\n\n<p>The entire code is below:</p>\n\n<pre><code>Sub ExcelRangeToPowerPoint()\n\n'PURPOSE: Copy/Paste An Excel Range Into a New PowerPoint Presentation\n\nDim rng As Excel.Range\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim mySlide As PowerPoint.Slide\nDim myShapeRange As PowerPoint.Shape\n\n'Refresh UsedRange (get rid of \"Ghost\" cells)\n  Worksheets(\"Task List1\").UsedRange\n\n'Select UsedRange\n  Worksheets(\"Task List1\").UsedRange.Select\n\n\n    ActiveSheet.ListObjects.Add(xlSrcRange, ActiveSheet.UsedRange, , xlYes).Name = \"Table1\"\n    Range(\"Table1[#All]\").Select\n\n    ActiveSheet.ListObjects(\"Table1\").TableStyle = \"TableStyleMedium9\"\n    Range(\"I10\").Select\n\n'Copy Range from Excel\n  Set rng = ActiveSheet.ListObjects(1).Range\n\n'Create an Instance of PowerPoint\n  On Error Resume Next\n\n    'Is PowerPoint already opened?\n      Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear the error between errors\n      Err.Clear\n\n    'If PowerPoint is not already open then open PowerPoint\n      If PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n    'Handle if the PowerPoint Application is not found\n      If Err.Number = 429 Then\n        MsgBox \"PowerPoint could not be found, aborting.\"\n        Exit Sub\n      End If\n\n  On Error GoTo 0\n\n'Make PowerPoint Visible and Active\n  PowerPointApp.Visible = True\n  PowerPointApp.Activate\n\n'Create a New Presentation\n  Set myPresentation = PowerPointApp.Presentations.Open(\"Y:\\Projects\\VBa\\2932 2 Milestones.pptx\")\n\n'Add a slide to the Presentation\n  Set mySlide = myPresentation.Slides.Item(1)\n\n'Delete Current table from Powerpoint\n  myPresentation.Slides(1).Shapes(2).Delete\n\n'Wait for a few seconds to catch up\n  Application.Wait (Now + TimeValue(\"0:00:3\"))\n\n'Copy Excel Range\n  rng.Copy\n  'ActiveSheet.ListObjects(1).Range.Copy\n\n'Paste to PowerPoint and position\n  mySlide.Shapes.PasteSpecial DataType:=ppPasteSourceFormatting, DisplayAsIcon:=msoFalse\n  'PowerPointApp.CommandBars.ExecuteMso (\"PasteSourceFormatting\")\n  Set myShapeRange = mySlide.Shapes(mySlide.Shapes.Count)\n\n    'Set position:\n      myShapeRange.Left = 20\n      myShapeRange.Top = 100\n      myShapeRange.Height = 400\n      myShapeRange.Width = 675\n\n'Clear The Clipboard\n  Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1453306277, "post_id": 34904915, "comment_id": 57545973, "body": "Can&#39;t you just access the &#39;first element&#39; of the matrix instead of attempting to carry the &#39;entire matrix&#39; [I understand this resolves to the same thing]?"}, {"owner": {"reputation": 23, "user_id": 5814695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b817dd7a44eb4790477d535c04979?s=128&d=identicon&r=PG&f=1", "display_name": "fabian", "link": "https://stackoverflow.com/users/5814695/fabian"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453306343, "post_id": 34904915, "comment_id": 57546025, "body": "How? Dim x as Integer; x = ???"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453306728, "post_id": 34904915, "comment_id": 57546303, "body": "Shouldn&#39;t it just be x = WorksheetFunction.MMult(WorksheetFunction.transpose(e), wtop)(0,0)? To denote the element of the array first in the list of both dimensions? I am assuming the matrix function automatically uses a 2-dimensional array starting at 0."}, {"owner": {"reputation": 23, "user_id": 5814695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b817dd7a44eb4790477d535c04979?s=128&d=identicon&r=PG&f=1", "display_name": "fabian", "link": "https://stackoverflow.com/users/5814695/fabian"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453306992, "post_id": 34904915, "comment_id": 57546491, "body": "Same error, subscript out of range."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1453307240, "post_id": 34904915, "comment_id": 57546684, "body": "what is the value of VarType(wbottom)?"}, {"owner": {"reputation": 23, "user_id": 5814695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b817dd7a44eb4790477d535c04979?s=128&d=identicon&r=PG&f=1", "display_name": "fabian", "link": "https://stackoverflow.com/users/5814695/fabian"}, "edited": false, "score": 0, "creation_date": 1453307971, "post_id": 34904915, "comment_id": 57547185, "body": "8204? I have no idea what that means."}], "answers": [{"tags": [], "owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "is_accepted": true, "score": 1, "last_activity_date": 1453308179, "creation_date": 1453308179, "answer_id": 34905677, "question_id": 34904915, "link": "https://stackoverflow.com/questions/34904915/vba-turning-a-1x1-matrix-into-an-integer/34905677#34905677", "title": "VBA: turning a 1x1 matrix into an integer", "body": "<p>If the resulting matrix is 1x1, the resulting array is 1-dimensional, with the only valid subscript being 1. See below, where <code>A1:E1</code> and <code>A3:A7</code> contain values for a 1x5 and 5x1 matrix respectively (so that the multiplication results in a 1x1 matrix):</p>\n\n<pre><code>Sub mmultTest()\n    Dim v As Variant\n    v = WorksheetFunction.MMult(Range(\"A1:E1\"), Range(\"A3:A7\"))\n    Debug.Print LBound(v)\n    Debug.Print UBound(v)\n    Debug.Print v(1)\nEnd Sub\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<pre><code>1\n1\n55\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1453314801, "creation_date": 1453314801, "answer_id": 34907817, "question_id": 34904915, "link": "https://stackoverflow.com/questions/34904915/vba-turning-a-1x1-matrix-into-an-integer/34907817#34907817", "title": "VBA: turning a 1x1 matrix into an integer", "body": "<p>You could try</p>\n\n<pre><code>wbottom = WorksheetFunction.SumProduct(e, wtop)\n</code></pre>\n\n<p>Transposing a column into a row and then multiplying it by a column to get a 1x1 matrix gives you a 1x1 matrix whose sole element is the dot-product of the two columns. The function <code>SumProduct</code> <em>is</em> the dot product already, and doesn't require transposing and then unpacking the value.</p>\n\n<p>To test this, I set up a worksheet to look like</p>\n\n<pre><code>    A  B\n   ------\n    1  4\n    2  5\n    3  6\n</code></pre>\n\n<p>then ran the following code:</p>\n\n<pre><code>Sub test()\n    Dim A As Range, B As Range, product As Variant\n\n    Set A = Range(\"A1:A3\")\n    Set B = Range(\"B1:B3\")\n\n    With Application.WorksheetFunction\n        product = .MMult(.Transpose(A), B) 'what you have\n        Debug.Print TypeName(product)\n        Debug.Print product(1)\n\n        product = .SumProduct(A, B)\n        Debug.Print TypeName(product)\n        Debug.Print product\n    End With\nEnd Sub\n</code></pre>\n\n<p>with the resulting output:</p>\n\n<pre><code>Variant()\n 32 \nDouble\n 32 \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5814695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b817dd7a44eb4790477d535c04979?s=128&d=identicon&r=PG&f=1", "display_name": "fabian", "link": "https://stackoverflow.com/users/5814695/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 34905677, "answer_count": 2, "score": 2, "last_activity_date": 1453314968, "creation_date": 1453306140, "last_edit_date": 1453314968, "question_id": 34904915, "link": "https://stackoverflow.com/questions/34904915/vba-turning-a-1x1-matrix-into-an-integer", "title": "VBA: turning a 1x1 matrix into an integer", "body": "<p>I have a 1x1 array from the following:</p>\n\n<pre><code>Dim wbottom As Variant\nwbottom = WorksheetFunction.MMult(WorksheetFunction.transpose(e), wtop)\n</code></pre>\n\n<p>I'm trying to get the number in the array. wbottom(0,0) and wbottom(1,1) give \"subscript out of range\". ReDim-ming gives nothing when I try to print out the number with MsgBox. How do I fix this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1453306238, "post_id": 34904898, "comment_id": 57545944, "body": "Change the true to false in your lookups. It will then find an exact match."}, {"owner": {"reputation": 11, "user_id": 5397348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6b49e453b463c558ca099642d6f59d2?s=128&d=identicon&r=PG&f=1", "display_name": "N.Wray", "link": "https://stackoverflow.com/users/5397348/n-wray"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453306802, "post_id": 34904898, "comment_id": 57546353, "body": "it still finds the same data over and over again. that&#39;s what I need to avoid.."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1453307173, "post_id": 34904898, "comment_id": 57546637, "body": "After you find <code>name</code> in <code>lookup</code>, find the position of this <code>name</code> in <code>lookup</code>&#39;s first column and offset <code>lookup</code> by this value (you can also resize <code>lookup</code> so it will always end at the same cell)."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453307436, "post_id": 34904898, "comment_id": 57546845, "body": "I hope I understood your intentions, but... Now I see that you loop over each cell in <code>lookup</code> and I don&#39;t understand why."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453308119, "post_id": 34904898, "comment_id": 57547293, "body": "perhaps an <code>.AutoFilter</code> on the employee would assist you here. If you filter on the employee, you will have a list of their classes / hours / etc. all set up in the <code>VisibleCells</code> and you can work with that much easier. Or perhaps even using a <code>SUMIF(S)</code> formula can get you what you may need as well. Your code seems a bit clunky for what (it seems) that you are trying to do."}, {"owner": {"reputation": 11, "user_id": 5397348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6b49e453b463c558ca099642d6f59d2?s=128&d=identicon&r=PG&f=1", "display_name": "N.Wray", "link": "https://stackoverflow.com/users/5397348/n-wray"}, "edited": false, "score": 0, "creation_date": 1453308223, "post_id": 34904898, "comment_id": 57547375, "body": "My code is definitely clunky, I am not a VBA wiz by any means. I think I should just change the loop away from a for each cell loop."}], "answers": [{"tags": [], "owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "is_accepted": false, "score": 0, "last_activity_date": 1453322501, "creation_date": 1453322501, "answer_id": 34910090, "question_id": 34904898, "link": "https://stackoverflow.com/questions/34904898/vba-for-loop-with-vlookups-avoiding-duplicates/34910090#34910090", "title": "VBA for loop with VLookups avoiding duplicates", "body": "<p>I assume your <em>lookup</em> variable represents the range containing you data.</p>\n\n<p>Your data duplication propably comes from your <code>for each</code> loop. Indeed, you are iterating trough <strong>each</strong> Cell of your range. That means that once the name is found, the code Inside the loop is executed as many times as there are cells in the range <em>lookup</em>.</p>\n\n<p>Try changing your loop to the following:</p>\n\n<pre><code>Dim row as Range\n\nfor each row In lookup.Row\n    'your code goes here\nNext\n</code></pre>\n\n<p>Whit this, the code will only run once  for each rows.</p>\n"}], "owner": {"reputation": 11, "user_id": 5397348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6b49e453b463c558ca099642d6f59d2?s=128&d=identicon&r=PG&f=1", "display_name": "N.Wray", "link": "https://stackoverflow.com/users/5397348/n-wray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453322501, "creation_date": 1453306109, "question_id": 34904898, "link": "https://stackoverflow.com/questions/34904898/vba-for-loop-with-vlookups-avoiding-duplicates", "title": "VBA for loop with VLookups avoiding duplicates", "body": "<p>I am compiling a list of employees CPD classes and the hours they are, producing a printout essentially for each one. I am pulling data from multiple worksheets and am having trouble with VLOOKUP continually finding the same data. My code currently is:</p>\n\n<pre><code>    result = lookup.Find(name) Is Nothing\n\n    If (result = False) Then\n        For Each cell In lookup\n            className = Application.VLookup(name, lookup, 7, True)\n            classHours = Application.VLookup(name, lookup, 9, True)\n            Sheets(\"employee output\").Range(\"B\" &amp; counter).Formula = className\n            Sheets(\"employee output\").Range(\"C\" &amp; counter).Formula = classHours\n            empHours = empHours + classHours\n            counter = counter + 1\n            numClasses = numClasses + 1\n            corporate = Range(\"B\" &amp; i)  *** vba precompliles the loop so this doesn't work *\n            Set lookup = Range(\"corporate:K\") ** doesn't work either***\n        Next\n        End If\n</code></pre>\n\n<p>So I need to limit the scope of the lookup range or somehow avoid finding the same data. Any help would be greatly appreciated...</p>\n"}, {"tags": ["vba", "outlook", "calendar"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1453336309, "last_edit_date": 1453336309, "creation_date": 1453309837, "answer_id": 34906252, "question_id": 34904722, "link": "https://stackoverflow.com/questions/34904722/auto-delete-all-outlook-calendar-items-in-deleted-folder/34906252#34906252", "title": "Auto Delete All Outlook Calendar Items in Deleted Folder", "body": "<p>Firstly, do not use multiple dot notation <code>(oDeletedItems.Items(i).Class)</code> - cache the Items collection before entering the loop. </p>\n\n<p>Secondly, confirmations, declines, etc. are meeting items, not appointments.</p>\n\n<p>Thirdly, Class property returns one of the <code>OlObjectClass</code> enum values. <code>AppointmentItem</code> is an item type (interface). </p>\n\n<p>You need to use 53 <code>(olMeetingRequest)</code> or 26 <code>(olAppointment)</code>.</p>\n\n<p>Fourthly, start the loop from <code>Items.Count</code>, not <code>Items.Count-1</code>.</p>\n\n<pre><code>set items = oDeletedItems.Items\nFor i = items.Count To 1 Step -1\n    ' Delete all appointment items\n     set item = items.Item(I) \n     itemClass = item.Class\n     If (itemClass= olAppointment) or (itemClass= olMeetingRequest) Then\n          'Debug.Print obj.Subject\n          item.Delete\n     End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593042352, "creation_date": 1453305580, "last_edit_date": 1593042352, "question_id": 34904722, "link": "https://stackoverflow.com/questions/34904722/auto-delete-all-outlook-calendar-items-in-deleted-folder", "title": "Auto Delete All Outlook Calendar Items in Deleted Folder", "body": "<p>I am writing a simply script to delete all calendar objects within the Deleted Items folder. such calendar objects include meeting confirmations, declines...etc.</p>\n\n<p>At present I have below, does not delete anything, even though checking the deleted items folder has many calendar confirmations, declines..etc:</p>\n\n<pre><code>    Dim oDeletedItems As Outlook.Folder\n    Dim obj As Outlook.MailItem\n\n    Dim i As Integer\n\n    'Obtain a reference to deleted items folder\n    Set oDeletedItems = Application.Session.GetDefaultFolder(olFolderDeletedItems)\n    For i = oDeletedItems.Items.Count - 1 To 1 Step -1\n    ' Delete all appointment items\n     If oDeletedItems.Items(i).Class = AppointmentItem Then\n\n         'Debug.Print obj.Subject\n          oDeletedItems.Items.Item(i).Delete\n\n     End If\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "variables"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1453306100, "post_id": 34904569, "comment_id": 57545851, "body": "Where exactly are you getting an error?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453306487, "post_id": 34904569, "comment_id": 57546137, "body": "Do I understand correctly that your problem is that you need mulitple values for the variable <b>hu</b>, but you&#39;re getting only one (the last one)? That is the way things work - a &quot;normal&quot; variable can store only one value. You need to either 1) extend the LOOP so that it runs for ALL the code; OR 2) <i>hu</i> needs to be an ARRAY so that it can store multiple values."}, {"owner": {"reputation": 51, "user_id": 4896353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a563a62ebd346735340fe9680d4b399?s=128&d=identicon&r=PG&f=1", "display_name": "bennes", "link": "https://stackoverflow.com/users/4896353/bennes"}, "edited": false, "score": 0, "creation_date": 1453385825, "post_id": 34904569, "comment_id": 57585711, "body": "I receive this error: &quot;Compile error: Expected Function or variable&quot; I am not able to move forward with development of macro, because I receive this error"}], "answers": [{"tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1453306472, "creation_date": 1453306472, "answer_id": 34905050, "question_id": 34904569, "link": "https://stackoverflow.com/questions/34904569/how-to-assign-variable-to-value-from-loop-vba/34905050#34905050", "title": "How to assign variable to value from loop VBA", "body": "<p>You need to include a subroutine call within your loop to use the variable.\nSomething like this ..</p>\n\n<pre><code>Option Explicit\nSub do_it()\n  Dim hu As String\n  Dim i As Integer\n    i = 2\n    Cells(i, 9).Select\n    Do Until IsEmpty(Cells(i, 9))\n       hu = Cells(i, 9).Value\n       get_worksheet (hu)\n       i = i + 1\n    Loop\nEnd Sub\n\nSub get_worksheet(name)\n    ActiveWorkbook.Worksheets.Add\n   ..etc\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4896353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a563a62ebd346735340fe9680d4b399?s=128&d=identicon&r=PG&f=1", "display_name": "bennes", "link": "https://stackoverflow.com/users/4896353/bennes"}, "edited": false, "score": 0, "creation_date": 1453385456, "post_id": 34905145, "comment_id": 57585430, "body": "Hi, to part &quot;hu = Cells(i, 9).Value&quot; I receive this error message: Compile error: Expected Function or variable :( Does the code work for you? If yes, do I need to change my settings of VBA somehow? Thanks"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1453306760, "creation_date": 1453306760, "answer_id": 34905145, "question_id": 34904569, "link": "https://stackoverflow.com/questions/34904569/how-to-assign-variable-to-value-from-loop-vba/34905145#34905145", "title": "How to assign variable to value from loop VBA", "body": "<p>With data like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jYzDX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jYzDX.png\" alt=\"enter image description here\"></a></p>\n\n<p>In column <strong>I</strong>, this is a way to get the last item before the empty:</p>\n\n<pre><code>Sub marine()\n   i = 2\n   Do Until Cells(i, 9).Value = \"\"\n      hu = Cells(i, 9).Value\n      i = i + 1\n   Loop\n\n   MsgBox hu\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4896353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a563a62ebd346735340fe9680d4b399?s=128&d=identicon&r=PG&f=1", "display_name": "bennes", "link": "https://stackoverflow.com/users/4896353/bennes"}, "is_accepted": false, "score": 0, "last_activity_date": 1453388982, "creation_date": 1453388982, "answer_id": 34927316, "question_id": 34904569, "link": "https://stackoverflow.com/questions/34904569/how-to-assign-variable-to-value-from-loop-vba/34927316#34927316", "title": "How to assign variable to value from loop VBA", "body": "<p>Ok I googled and found out the problem, error message was due to \"This error happens also when a Sub is called the same as variable (i.e. in one Sub you have for loop with iterator \"a\", whilst another Sub is called \"a\").\"</p>\n\n<p>I changed the name of variable and code works.</p>\n\n<p>Thanks to everyone</p>\n"}], "owner": {"reputation": 51, "user_id": 4896353, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a563a62ebd346735340fe9680d4b399?s=128&d=identicon&r=PG&f=1", "display_name": "bennes", "link": "https://stackoverflow.com/users/4896353/bennes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4751, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1453388982, "creation_date": 1453305169, "last_edit_date": 1453306260, "question_id": 34904569, "link": "https://stackoverflow.com/questions/34904569/how-to-assign-variable-to-value-from-loop-vba", "title": "How to assign variable to value from loop VBA", "body": "<p>my newbie question:</p>\n\n<p>I would need to define variable from values gathered by loop.\nI have column of datas, and I need to filter those data and copy to another new sheet named with variable.</p>\n\n<p>Problem is, I cannot get variable from loop. \nIs it possible?\nExample: variable is \"hu\"</p>\n\n<pre><code>i = 2\nDo Until IsEmpty(Cells(i, 9))\n\n **hu** = Cells(i, 9).Value  \n\n    i = i + 1\nLoop\n\nActiveWorkbook.Worksheets.Add\nActiveSheet.Name = **hu**\n\nWorksheets(\"Sheet1\").Range(\"A1:I1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$I$1\").AutoFilter Field:=9, Criteria1:=**hu**\n\n\nWith ActiveSheet.AutoFilter.Range\n On Error Resume Next\n   Set rng2 = .Offset(1, 0).Resize(.Rows.Count - 1, 1) _\n       .SpecialCells(xlCellTypeVisible)\n On Error GoTo 0\nEnd With\nIf rng2 Is Nothing Then\n   MsgBox \"No data to copy\"\nElse\n\n   Set rng = ActiveSheet.AutoFilter.Range\n   rng.Offset(1, 0).Resize(rng.Rows.Count - 1).Copy _\n     Destination:=Worksheets(\"Comparison2\").Range(\"A2\")\nEnd If\n   ActiveSheet.ShowAllData\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 1, "creation_date": 1453305191, "post_id": 34904379, "comment_id": 57545148, "body": "<a href=\"http://stackoverflow.com/questions/19519716/pass-userform-textbox-value-to-cell\" title=\"pass userform textbox value to cell\">stackoverflow.com/questions/19519716/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": false, "score": 0, "last_activity_date": 1453309048, "last_edit_date": 1453309048, "creation_date": 1453308649, "answer_id": 34905834, "question_id": 34904379, "link": "https://stackoverflow.com/questions/34904379/how-to-send-the-content-from-a-textbox-on-userform-to-a-cell/34905834#34905834", "title": "How to send the content from a Textbox on Userform to a Cell?", "body": "<p>You need write the code in that command button click event.. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>' ok button\r\nSub Button1_Click()\r\n' replace the sheet name and range A2 or B2 with yours\r\nSheets(\"Sheetname\").Range(\"A1\").Value = TextBox1.Value\r\nEnd Sub\r\n\r\n' cancel button\r\nSub Button2_Click()\r\nunloadme\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 85, "user_id": 5816736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/UhUjQ.png?s=128&g=1", "display_name": "ADrex", "link": "https://stackoverflow.com/users/5816736/adrex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3207, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453311413, "creation_date": 1453304574, "last_edit_date": 1531161705, "question_id": 34904379, "link": "https://stackoverflow.com/questions/34904379/how-to-send-the-content-from-a-textbox-on-userform-to-a-cell", "title": "How to send the content from a Textbox on Userform to a Cell?", "body": "<p>In an User form with the text box, a cancel button, and an Ok button. The ok button should send the text of the text box to the cell i want. The cancel is just to close.</p>\n\n<p>I researched for it and all i got was this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Private Sub TextBox1_Change()\r\nGetData\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Which didn't work. </p>\n\n<p>I'm not a good coder but I'm trying to build something to make my work easier, if someone could help i would really appreciate.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1453303600, "post_id": 34903819, "comment_id": 57543954, "body": "I&#39;m voting to close this question as off-topic because it&#39;s exactly suited for <a href=\"http://codereview.stackexchange.com/\">Code Review</a>"}, {"owner": {"reputation": 2051, "user_id": 3626537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1499840559/picture?type=large", "display_name": "Phrancis", "link": "https://stackoverflow.com/users/3626537/phrancis"}, "edited": false, "score": 1, "creation_date": 1453304061, "post_id": 34903819, "comment_id": 57544303, "body": "This may be a good question for <a href=\"https://codereview.stackexchange.com\">Code Review</a>, so long as: <b>(A)</b> <i>the code works</i>, <b>and (B)</b> <i>it&#39;s not hypothetical or incomplete in any way</i>. Please read the <a href=\"http://codereview.stackexchange.com/help/on-topic\">on-topic guide</a> before posting, if you choose to go to <a href=\"http://codereview.stackexchange.com/questions/ask\">Code Review</a>. If you have any questions or concerns, join us at our <a href=\"http://chat.stackexchange.com/rooms/34045\">CR Help Desk</a>."}, {"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453304239, "post_id": 34903819, "comment_id": 57544440, "body": "I&#39;ll do that. Sorry for the mess!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453324966, "post_id": 34903819, "comment_id": 57557245, "body": "Are the A:CN, A:CY, A:CT and A:AV the full ranges for each worksheet or are there columns of data to the right of these ranges?"}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1453388729, "post_id": 34903819, "comment_id": 57587844, "body": "Your code is finished, and working, and has comments. Next job!"}, {"owner": {"reputation": 328, "user_id": 5622596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe6b4f42fe97fa2d5272f90e1e8f67b?s=128&d=identicon&r=PG&f=1", "display_name": "jspek", "link": "https://stackoverflow.com/users/5622596/jspek"}, "edited": false, "score": 0, "creation_date": 1454098640, "post_id": 34903819, "comment_id": 57908313, "body": "One of the best methods of copying data from an most office files without opening them is using something called &quot;Open XML&quot; <a href=\"https://en.wikipedia.org/wiki/Office_Open_XML\" rel=\"nofollow noreferrer\">Wiki Article on Open XML</a>. However I would not recommend this if you are a beginner."}], "answers": [{"tags": [], "owner": {"reputation": 1009, "user_id": 2453661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a44afa0c663b486bff7891d92df52c?s=128&d=identicon&r=PG", "display_name": "Alberto M", "link": "https://stackoverflow.com/users/2453661/alberto-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1454173928, "creation_date": 1454173928, "answer_id": 35104581, "question_id": 34903819, "link": "https://stackoverflow.com/questions/34903819/vba-best-method-to-copy-data-from-a-closed-workbook/35104581#35104581", "title": "VBA - Best method to copy data from a closed workbook", "body": "<p>I am not sure how much time you will spare, but I would suggest disabling the screen refresh when the macro is running, by adding</p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>at the beginning of the sub (and obviously the same line with  <code>= True</code> at the end)</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 5850636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sba4X.png?s=128&g=1", "display_name": "Arina", "link": "https://stackoverflow.com/users/5850636/arina"}, "is_accepted": false, "score": 1, "last_activity_date": 1460620870, "creation_date": 1460620870, "answer_id": 36617054, "question_id": 34903819, "link": "https://stackoverflow.com/questions/34903819/vba-best-method-to-copy-data-from-a-closed-workbook/36617054#36617054", "title": "VBA - Best method to copy data from a closed workbook", "body": "<p>I usually turn screen update, Interactive and calculate off before doing anything to a workbook, then switch it back to their previous state at the end.</p>\n\n<pre><code>Dim oldInteractive As Boolean = Application.Interactive\nDim oldCalulation As XlCalculation = Application.Calculation\nDim oldScreenUpdating As Boolean = Application.ScreenUpdating\nApplication.Interactive = False\nApplication.Calculation = XlCalculation.xlCalculationManual\nApplication.ScreenUpdating = False\n\n'Your code here\n\nApplication.Interactive = oldInteractive \nApplication.Calculation = oldCalulation \nApplication.ScreenUpdating = oldScreenUpdating\n</code></pre>\n\n<p>This will prevent calculations from being made while your code is running which can slow things down a lot. It's important to change Application.Calculation back to it's old value as it will stay the way you set it even after your code has finished, which can cause confusion.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9217381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8adf3e44120320c033851cde66f30ab8?s=128&d=identicon&r=PG&f=1", "display_name": "J.Barnett", "link": "https://stackoverflow.com/users/9217381/j-barnett"}, "is_accepted": false, "score": 0, "last_activity_date": 1579146171, "creation_date": 1579146171, "answer_id": 59762722, "question_id": 34903819, "link": "https://stackoverflow.com/questions/34903819/vba-best-method-to-copy-data-from-a-closed-workbook/59762722#59762722", "title": "VBA - Best method to copy data from a closed workbook", "body": "<p>I know this is quite old but I think for others who see this it may help them out in understand how to make their own VBA programs performance faster. Also, the code below is as efficient as I believe I can currently make it.</p>\n\n<p>A few quick notes for improving performance in future development projects.</p>\n\n<ol>\n<li><p>Avoid concatenation. Strings in general - across many programming languages - if you get down to assembly are slow as they are mainly used for comparisons with other strings.</p></li>\n<li><p>Ranges are slow. try to use them as little as possible. They are used for gathering 2 dimensional arrays such as in the code below. Just debug to see whats happening on the lines with \"data =\".</p></li>\n<li><p>Try opening excel files in 'read only' and 'update links' not on. In the code below i've also provided an example of this. However, if you start working with .csv files there is an even faster method to read data, but is quick unsafe and you should check the data before hand. </p></li>\n<li><p>Apply ranges to sheets using the resize method in the cells and range methods. They are faster and more efficient when applying values.</p></li>\n<li><p>Change the application things that the other people have already said. I won't go into why because they have already done a good job of this.</p></li>\n</ol>\n\n<p>Hope this helps you out :)</p>\n\n<pre><code>    Public Const file As String = \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Malharia Base.xls\"\n    Public Const file_2 As String = \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Beneficiamento Base.xls\"\n    Public Const file_3 As String = \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Embalagem Base.xls\"\n    Public Const file_4 As String = \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Diklatex Base.xls\"\n    Sub CopiarBase() ' Const is faster for the compiler\n        ' Saving the Sheets Previous state.\n        Dim OldIntState As Boolean: OldIntState = Application.Interactive\n        Dim oldCalState As XlCalculation: oldCalState = Application.Calculation\n        Dim oldSUState As Boolean: oldSUState = Application.ScreenUpdating\n        Application.Interactive = False\n        Application.Calculation = XlCalculation.xlCalculationManual\n        Application.ScreenUpdating = False\n        Application.DisplayAlerts = False\n\n        'Setting Sheet Values\n        Dim MyCurrentWB As Workbook: Set MyCurrentWB = ThisWorkbook\n        Dim BMalharia As Worksheet: Set BMalharia = MyCurrentWB.Worksheets(\"B-Malharia\")\n        Dim BBeneficiamento As Worksheet: Set BBeneficiamento = MyCurrentWB.Worksheets(\"B-Beneficiamento\")\n        Dim BEmbalagem As Worksheet: Set BEmbalagem = MyCurrentWB.Worksheets(\"B-Embalagem\")\n        Dim BDikla As Worksheet: Set BDikla = MyCurrentWB.Worksheets(\"B-Dikla\")\n\n        'Clean all the cells - Workbook 1, Range clearing - faster to do Sheet.usedRange.clearContents,\n        ' if your clearing all sheet data\n        BMalharia.UsedRange.ClearContents\n        BBeneficiamento.Range(BBeneficiamento.Cells(2, 1), BBeneficiamento.Cells(BBeneficiamento.UsedRange.rows, \"CY\")).ClearContents\n        BEmbalagem.Range(BEmbalagem.Cells(2, 1), BEmbalagem.Cells(BEmbalagem.UsedRange.rows, \"CT\")).ClearContents\n        BDikla.Range(BDikla.Cells(2, 1), BDikla.Cells(BDikla.UsedRange.rows, \"AV\")).ClearContents\n\n        'Copy from Malharia Workbook\n        Dim WB As Workbook: Set WB = Workbooks.Open(file, 0, 1) ' opening the file with out updating it and in read\n        ' only. if you require either of the online documentation is useful. I Just assumed you don't require these\n        ' things, this does make the program run faster.\n        Dim WS As Worksheet: Set WS = WB.Worksheets(\"Malharia Base\")\n        data = WS.Range(WS.Cells(2, 1), WS.Cells(WS.UsedRange.rows.count, \"CN\")).value\n        BMalharia.Cells(2, 1).Resize(UBound(data), UBound(data, 2)).value = data\n        WB.Close False\n\n        'Copy from Beneficiamento Workbook\n        Set WB = Workbooks.Open(file_2, 0, 1)\n        Set WS = WB.Worksheets(\"Beneficiamento Base\")\n        data = WS.Range(WS.Cells(2, 1), WS.Cells(WS.UsedRange.rows.count, \"CY\")).value\n        BBeneficiamento.Cells(2, 1).Resize(UBound(data), UBound(data, 2)).value = data\n        WB.Close False\n\n        'Copy from Embalagem Workbook\n        Set WB = Workbooks.Open(file_3, 0, 1)\n        Set WS = WB.Worksheets(\"Embalagem Base\")\n        data = WS.Range(WS.Cells(2, 1), WS.Cells(WS.UsedRange.rows.count, \"CT\")).value\n        BEmbalagem.Cells(2, 1).Resize(UBound(data), UBound(data, 2)).value = data\n        WB.Close False\n\n        'Copy from Dikla Workbook\n        Set WB = Workbooks.Open(file_4, 0, 1)\n        Set WS = WB.Worksheets(\"Embalagem Base\")\n        data = WS.Range(WS.Cells(2, 1), WS.Cells(WS.UsedRange.rows.count, \"AV\")).value\n        BDikla.Cells(2, 1).Resize(UBound(data), UBound(data, 2)).value = data\n        WB.Close False\n\n        ' Restoring the Sheets State before execution\n        Application.DisplayAlerts = True\n        Application.Interactive = OldIntState\n        Application.Calculation = oldCalState\n        Application.ScreenUpdating = oldSUState\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1579146171, "creation_date": 1453303100, "last_edit_date": 1453303652, "question_id": 34903819, "link": "https://stackoverflow.com/questions/34903819/vba-best-method-to-copy-data-from-a-closed-workbook", "title": "VBA - Best method to copy data from a closed workbook", "body": "<p>I'm an intern in an industrial company in Brazil and it happens that I'm using excel a lot. I just started playing with VBA couple of days ago, and I'm amused of many things it can do for me!!</p>\n\n<p>I don't have a strong programming background, so I'm learning by doing basically. The code is working fine and it takes less than 15 seconds from start to end. I don't bother with the time, but if it could be improved that'd be great.</p>\n\n<p>My main goal is to keep the code simple and efficient. I'll be leaving the company in the next months and I'd like it to be easy to mantain and use. What I'm asking is a better way to write my code so others can understand easier, and if possible (of course it is!) to take less time.</p>\n\n<p>My code delete 4 sheets of content in my current workbook, and then copy the updated data from 4 others closed workbooks. Then close everything. :) The data is about the daily production and their names are in portuguese, sorry about that.</p>\n\n<pre><code>Sub CopiarBase()\n\n'\n' Atalho do teclado: Ctrl+q\n'\n\n\n    ' Variables\n    Dim MyCurrentWB As Workbook\n    Dim BMalharia As Worksheet\n    Dim BBeneficiamento As Worksheet\n    Dim BEmbalagem As Worksheet\n    Dim BDikla As Worksheet\n\n    Set MyCurrentWB = ThisWorkbook\n    Set BMalharia = MyCurrentWB.Worksheets(\"B-Malharia\")\n    Set BBeneficiamento = MyCurrentWB.Worksheets(\"B-Beneficiamento\")\n    Set BEmbalagem = MyCurrentWB.Worksheets(\"B-Embalagem\")\n    Set BDikla = MyCurrentWB.Worksheets(\"B-Dikla\")\n\n    'Clean all the cells - Workbook 1\n\n\n    Dim Malharia_rng As Range\n    Set Malharia_rng = BMalharia.Range(\"A2:CN\" &amp; BMalharia.Cells(Rows.Count, 1).End(xlUp).Row)\n    Malharia_rng.ClearContents\n\n    Dim Ben_rng As Range\n    Set Ben_rng = BBeneficiamento.Range(\"A2:CY\" &amp; BBeneficiamento.Cells(Rows.Count, 1).End(xlUp).Row)\n    Ben_rng.ClearContents\n\n    Dim Emb_rng As Range\n    Set Emb_rng = BEmbalagem.Range(\"A2:CT\" &amp; BEmbalagem.Cells(Rows.Count, 1).End(xlUp).Row)\n    Emb_rng.ClearContents\n\n    Dim Dikla_rng As Range\n    Set Dikla_rng = BDikla.Range(\"A2:AV\" &amp; BDikla.Cells(Rows.Count, 1).End(xlUp).Row)\n    Dikla_rng.ClearContents\n\n\n    'Copy from Malharia Workbook\n\n    Workbooks.Open \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Malharia Base.xls\"\n\n    LastRowMB = Workbooks(\"Malharia Base.xls\").Worksheets(\"Malharia Base\").Cells(Rows.Count, 1).End(xlUp).Row\n    Dim Malha_base As Range\n    Set Malha_base = Workbooks(\"Malharia Base.xls\").Worksheets(\"Malharia Base\").Range(\"A2:CN\" &amp; LastRowMB)\n\n    MyCurrentWB.Worksheets(\"B-Malharia\").Range(\"A2:CN\" &amp; LastRowMB).Value = Malha_base.Value\n    Workbooks(\"Malharia Base.xls\").Close\n\n    'Copy from Beneficiamento Workbook\n\n    Workbooks.Open \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Beneficiamento Base.xls\"\n\n    LastRowBB = Workbooks(\"Beneficiamento Base.xls\").Worksheets(\"Beneficiamento Base\").Cells(Rows.Count, 1).End(xlUp).Row\n    Dim Ben_base As Range\n    Set Ben_base = Workbooks(\"Beneficiamento Base.xls\").Worksheets(\"Beneficiamento Base\").Range(\"A2:CY\" &amp; LastRowBB)\n\n    MyCurrentWB.Worksheets(\"B-Beneficiamento\").Range(\"A2:CY\" &amp; LastRowBB).Value = Ben_base.Value\n    Workbooks(\"Beneficiamento Base.xls\").Close\n\n    'Copy from Embalagem Workbook\n\n    Workbooks.Open \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Embalagem Base.xls\"\n\n    LastRowEB = Workbooks(\"Embalagem Base.xls\").Worksheets(\"Embalagem Base\").Cells(Rows.Count, 1).End(xlUp).Row\n    Dim Emb_base As Range\n    Set Emb_base = Workbooks(\"Embalagem Base.xls\").Worksheets(\"Embalagem Base\").Range(\"A2:CT\" &amp; LastRowEB)\n\n    MyCurrentWB.Worksheets(\"B-Embalagem\").Range(\"A2:CT\" &amp; LastRowEB).Value = Emb_base.Value\n    Workbooks(\"Embalagem Base.xls\").Close\n\n    'Copy from Dikla Workbook\n\n    Workbooks.Open \"C:\\Users\\marco.henrique\\Desktop\\Bases\\Diklatex Base.xls\"\n\n    LastRowDB = Workbooks(\"Diklatex Base.xls\").Worksheets(\"Diklatex Base\").Cells(Rows.Count, 1).End(xlUp).Row\n    Dim Dikla_base As Range\n    Set Dikla_base = Workbooks(\"Diklatex Base.xls\").Worksheets(\"Diklatex Base\").Range(\"A2:AV\" &amp; LastRowDB)\n\n    MyCurrentWB.Worksheets(\"B-Dikla\").Range(\"A2:AV\" &amp; LastRowDB).Value = Dikla_base.Value\n    Workbooks(\"Diklatex Base.xls\").Close\n\nEnd Sub\n</code></pre>\n\n<p>I'm sorry if I was not clear enough, of course english is not my native language. Any doubts about my code or the whole idea feel free to ask questions.</p>\n\n<p>Thanks in advance for any help guys!</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1453303247, "post_id": 34903766, "comment_id": 57543694, "body": "Are you opposed to <code>CurrentDb.Execute &quot;qry1&quot;, dbFailOnError</code> instead of <code>OpenQuery</code> or <code>RunSQL</code>?"}, {"owner": {"reputation": 195, "user_id": 5773063, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d6aaa6c1ec47a161a7206bc7dc2440e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Carroll", "link": "https://stackoverflow.com/users/5773063/tom-carroll"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453303890, "post_id": 34903766, "comment_id": 57544177, "body": "Not particularly I am just looking for the most efficient method. I like being able to see the SQL within the module I am writing rather than having to switch between the access and vba windows which is why I like to use RunSQL"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453304062, "post_id": 34903766, "comment_id": 57544305, "body": "If you mean you want to use a SQL statement instead of a query name, <code>CurrentDb.Execute</code> will cooperate: <code>CurrentDb.Execute &quot;DELETE FROM tblFoo;&quot;, dbFailOnError</code>"}, {"owner": {"reputation": 195, "user_id": 5773063, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d6aaa6c1ec47a161a7206bc7dc2440e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Carroll", "link": "https://stackoverflow.com/users/5773063/tom-carroll"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453304168, "post_id": 34903766, "comment_id": 57544393, "body": "Is there an advantage to that over DoCmd.RunSQL?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453304668, "post_id": 34903766, "comment_id": 57544767, "body": "Yes, several.  For one, examine what the <i>Database.Execute Method</i> help topic says about <code>dbFailOnError</code>"}, {"owner": {"reputation": 195, "user_id": 5773063, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d6aaa6c1ec47a161a7206bc7dc2440e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Carroll", "link": "https://stackoverflow.com/users/5773063/tom-carroll"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453306075, "post_id": 34903766, "comment_id": 57545829, "body": "Very useful thank you very much"}], "answers": [{"tags": [], "owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "is_accepted": true, "score": 3, "last_activity_date": 1453303245, "creation_date": 1453303245, "answer_id": 34903871, "question_id": 34903766, "link": "https://stackoverflow.com/questions/34903766/docmd-openquery-or-docmd-runsql/34903871#34903871", "title": "DoCmd.OpenQuery or DoCmd.RunSQL", "body": "<p>If these are action queries (<code>UPDATE</code> or <code>DELETE</code> or <code>INSERT</code>, rather than just <code>SELECT</code>), it really doesn't matter. (There might be some minuscule overhead where Access is trying to collect output records to display in a grid.)</p>\n\n<p>If they are not action queries, then <code>DoCmd.RunSQL</code> wouldn't do anything anyhow.</p>\n\n<p>Also, consider using <code>DoCmd.Execute</code> rather than <code>DoCmd.RunSQL</code>, since Execute can take a saved query name instead of just raw SQL.</p>\n"}], "owner": {"reputation": 195, "user_id": 5773063, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d6aaa6c1ec47a161a7206bc7dc2440e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Carroll", "link": "https://stackoverflow.com/users/5773063/tom-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3180, "favorite_count": 0, "accepted_answer_id": 34903871, "answer_count": 1, "score": 2, "last_activity_date": 1453303607, "creation_date": 1453302953, "question_id": 34903766, "link": "https://stackoverflow.com/questions/34903766/docmd-openquery-or-docmd-runsql", "title": "DoCmd.OpenQuery or DoCmd.RunSQL", "body": "<p>Redesigning parts of my employers database I come across subroutines wrote by who ever created it originally that go something like this:</p>\n\n<pre><code>DoCmd.OpenQuery \"qry1\"\nDoCmd.OpenQuery \"qry2\"\nDoCmd.OpenQuery \"qry3\"\nDoCmd.OpenQuery \"qry4\"\nDoCmd.OpenQuery \"qry5\"\nDoCmd.OpenQuery \"qry6\"\nDoCmd.OpenQuery \"qry7\"\netc...\netc.....\netc.......\n</code></pre>\n\n<p>I have always used DoCmd.RunSQL for running queries behind events etc, mainly because the SQL is then all in front of me in one place within the VBA editor.</p>\n\n<p>Currently some procedures have up to 50 OpenQuery dealing with tables with 250000+ records. Having a brief look through the queries it seems that many of them can be combined as they do similar things with the same data sets, it appears to me whoever wrote them didn't have a good understanding of SQL.</p>\n\n<p>My question is which method is better in terms of performance etc. DoCmd.OpenQuery or DoCmd.RunSQL</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1453302651, "post_id": 34903593, "comment_id": 57543262, "body": "Why is there a space between <code>file</code> and <code>name</code>? And did you happen to see <a href=\"http://stackoverflow.com/a/25447941/2679750\">this answer</a>? It may help."}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1453302742, "post_id": 34903593, "comment_id": 57543318, "body": "@MarkC. That&#39;s how the field names are designed by someone else and unfortunately i cannot change the field name."}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 1, "creation_date": 1453302775, "post_id": 34903593, "comment_id": 57543345, "body": "When you type <code>Me.</code> what does intellisense give you as options for the field names? I highly doubt it&#39;s <code>file name</code>"}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1453302893, "post_id": 34903593, "comment_id": 57543434, "body": "Sorry you are right, let me update the question"}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1453303021, "post_id": 34903593, "comment_id": 57543541, "body": "@MarkC. I have updated the question"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1453303729, "post_id": 34903593, "comment_id": 57544045, "body": "How are you providing data to your report? Through the query in your question? Is it the record source for your report?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1453303731, "post_id": 34903593, "comment_id": 57544047, "body": "If you test this as a new query in the Access query designer, does it return the rows you would want displayed by your report? <code>SELECT * FROM [Screen] WHERE File_Number=Forms!frmScreen!File_Number</code>"}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1453303949, "post_id": 34903593, "comment_id": 57544221, "body": "@MarkC. For report data source is same Screen table"}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453304007, "post_id": 34903593, "comment_id": 57544250, "body": "@HansUp yes in query designer when i run Select * from Screen where File_Number=&#39;12&#39; it displays the records of that file number"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453304596, "post_id": 34903593, "comment_id": 57544712, "body": "Is <code>File Number</code> a text value? Or is it actually a Number data type? If it&#39;s a number, get rid of the leading / trailing <code>&#39;</code> and see if it works then."}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453305158, "post_id": 34903593, "comment_id": 57545128, "body": "@ScottHoltzman When i use a msgbox stLinkCriteria  it displays the value now, the problem is the report is showing all records, so what changes should i do in the report."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 3, "creation_date": 1453305209, "post_id": 34903593, "comment_id": 57545160, "body": "You said this query worked in the query designer: <code>Select * from Screen where File_Number=&#39;12&#39;</code>  That strongly suggests the name of the table field is <code>File_Number</code>, not <code>File Number</code> ... so your <code>stLinkCriteria</code> should use <code>&quot;[File_Number]&quot;</code> instead of <code>&quot;[File Number]&quot;</code> immediately following <code>stLinkCriteria = </code>"}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1453309951, "post_id": 34903593, "comment_id": 57548537, "body": "@HansUp Thanks that helps, what changes should i do in the report."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1453310935, "creation_date": 1453310935, "answer_id": 34906639, "question_id": 34903593, "link": "https://stackoverflow.com/questions/34903593/microsoft-access-vba-passing-parameters-to-a-report/34906639#34906639", "title": "Microsoft Access VBA Passing Parameters to a Report", "body": "<p>Change your report's <code>Row Source</code> to return all rows ...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM [Screen]\n</code></pre>\n\n<p>Then you can open the report with <code>DoCmd.OpenReport</code> and use its <em>WhereCondition</em> option to filter the report's data as you wish ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>stLinkCriteria = \"[File_Number]='\" &amp; Me![File Number].Value &amp; \"'\"\nDebug.Print stLinkCriteria '&lt;- check this in Immediate window; Ctrl+g will take you there\nDoCmd.OpenReport \"rptScreen\", acViewPreview, , stLinkCriteria\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li><code>Screen</code> is an <a href=\"http://allenbrowne.com/AppIssueBadWord.html#S\" rel=\"nofollow\">Access reserved word</a>.  Although it may not be causing trouble here, I bracketed that name in the <code>SELECT</code> statement just to be safe.  But it would be better to give that table a different name if possible.</li>\n<li>I presumed <code>Screen.File_Number</code> is a valid field and <code>Me![File Number]</code> refers to a control on the form.  But due to the earlier confusion surrounding space vs. underscore in those names, that presumption seems shaky.  </li>\n<li>If you open the report directly (like from the Navigation pane) instead of with <code>DoCmd.OpenReport</code> and a <em>WhereCondition</em>, it will include all rows from the table.  That may not be what you actually want, but for now let's try to get something basic working. </li>\n</ol>\n"}], "owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1761, "favorite_count": 0, "accepted_answer_id": 34906639, "answer_count": 1, "score": 1, "last_activity_date": 1453310935, "creation_date": 1453302462, "last_edit_date": 1453304250, "question_id": 34903593, "link": "https://stackoverflow.com/questions/34903593/microsoft-access-vba-passing-parameters-to-a-report", "title": "Microsoft Access VBA Passing Parameters to a Report", "body": "<p>I have form <code>frmScreen</code>, which has 3 fields <code>File_Number, id, country</code>. The data is fetched from <code>Screen</code> table as a data source.The <code>report</code> has the same data source</p>\n\n<p>I have a button on the form which calls report rptScreen. I want to pass file name as parameter to the report so that the report displays only</p>\n\n<pre><code>Select * from Screen where File_Number=&lt;parameter passed through the form?\n</code></pre>\n\n<p>I checked previous posts on StackOverflow but it doesn't help me out.</p>\n\n<p>So how do I pass parameters and what changes should I do in the report so that it takes the <code>File_Number</code> field as parameter and shows only the records that match the query</p>\n\n<p>My code looks like the following </p>\n\n<pre><code>stLinkCriteria = \"[File Number]=\" &amp; \"'\" &amp; Me![File Number] &amp; \"'\"\n   DoCmd.OpenReport \"rptScreen\", acViewPreview, , stLinkCriteria\n</code></pre>\n\n<p><strong>Error: The report shows all data instead of record only for that <code>file number</code></strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1453302713, "post_id": 34903516, "comment_id": 57543303, "body": "Maybe switch the order of  6 and 7. Do you have any volatile functions?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453327431, "post_id": 34903792, "comment_id": 57558615, "body": "Absolutely possible, but as you mentioned cahnges they dont want to keep is a issue. The workbook is also located on a server and some times run on a limited speed VPN connection. and im trying to only auto save when nessacarry when i already has som kind of progress form running. :) But yes, its a workaround..."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1453303033, "creation_date": 1453303033, "answer_id": 34903792, "question_id": 34903516, "link": "https://stackoverflow.com/questions/34903516/excel-vba-make-excel-believed-saved-until-real-change-has-happen/34903792#34903792", "title": "Excel vba make excel believed saved until real change has happen", "body": "<p>I've seen this sort of thing in my own code, which in my case is almost always due to volatile functions. You could have the following in the <code>ThisWorkbook</code> code module:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>This should work, though it could have undesired consequences if the user makes changes after the userform closes, changes that they don't want to keep.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453327198, "post_id": 34904019, "comment_id": 57558494, "body": "Hi, jepp. added it to the last line of code right after i have saved the workook. But still it ask me to save.."}, {"owner": {"reputation": 56, "user_id": 5816366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b52aaf74a5117eb484396ec50234b4?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnT", "link": "https://stackoverflow.com/users/5816366/eamonnt"}, "reply_to_user": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453452460, "post_id": 34904019, "comment_id": 57616473, "body": "OyvPet, it needs to be put after the code for step 7. It won&#39;t save the workbook, just make the application think it has been."}], "tags": [], "owner": {"reputation": 56, "user_id": 5816366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b52aaf74a5117eb484396ec50234b4?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnT", "link": "https://stackoverflow.com/users/5816366/eamonnt"}, "is_accepted": false, "score": 3, "last_activity_date": 1453303661, "creation_date": 1453303661, "answer_id": 34904019, "question_id": 34903516, "link": "https://stackoverflow.com/questions/34903516/excel-vba-make-excel-believed-saved-until-real-change-has-happen/34904019#34904019", "title": "Excel vba make excel believed saved until real change has happen", "body": "<p>Have you tried setting the workbook's Saved value to true? Something like:</p>\n\n<pre><code>ActiveWorkbook.Saved = True\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1453303661, "creation_date": 1453302220, "question_id": 34903516, "link": "https://stackoverflow.com/questions/34903516/excel-vba-make-excel-believed-saved-until-real-change-has-happen", "title": "Excel vba make excel believed saved until real change has happen", "body": "<p>Scenario:</p>\n\n<ol>\n<li>Workbook opened</li>\n<li>screenupdate, calculation(Manual) events are set to false</li>\n<li>Userform Show and user inputs some values.</li>\n<li>User push ok</li>\n<li>Populates values on sheet from userform</li>\n<li>workbook saved</li>\n<li>screenupdate, calculation(automatic) events are set to true</li>\n</ol>\n\n<p>When user then tries to close the application without doing anything in the workbook it prompts the save dialog.</p>\n\n<p>Not a big problem but irritating :) Any way to get around this?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1453333934, "post_id": 34903041, "comment_id": 57561291, "body": "Does the code run? <code>(ddate As Date)</code>"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1453385965, "post_id": 34903041, "comment_id": 57585805, "body": "@Om3r Thanks for pointing that out, I have edited the code and it runs perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1453471544, "post_id": 34936776, "comment_id": 57628465, "body": "I am able to download the files from the recent emails in my Inbox, it&#39;s just the emails which are old and using the enterprise value is where I get the attachments name as &#39;@&#39;."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1453421324, "creation_date": 1453421324, "answer_id": 34936776, "question_id": 34903041, "link": "https://stackoverflow.com/questions/34903041/downloaded-attachments-from-enterprise-vault-are-0kb-in-size-with-only-as-th/34936776#34936776", "title": "Downloaded attachments from Enterprise vault are 0kb in size with only &#39;@&#39; as their name", "body": "<p>You may wana remove <code>(ddate As Date)</code> from your sub and declared <code>AttachmentPath</code> to <code>Dim attachmentPath As String</code> also Setting Option Explicit to Off is generally not a good practice</p>\n\n<p>See MSDN on <a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow\">Option Explicit Statement</a></p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609185309, "creation_date": 1453300918, "last_edit_date": 1609185309, "question_id": 34903041, "link": "https://stackoverflow.com/questions/34903041/downloaded-attachments-from-enterprise-vault-are-0kb-in-size-with-only-as-th", "title": "Downloaded attachments from Enterprise vault are 0kb in size with only &#39;@&#39; as their name", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Sub Merge_daily_emails1()\n\n    Dim myOlApp As New Outlook.Application\n    Dim myNameSpace As Outlook.Namespace\n    Dim myInbox As Outlook.MAPIFolder\n    Dim Atch As Object\n    Set myNameSpace = myOlApp.GetNamespace(&quot;MAPI&quot;)\n    Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox)\n    Dim filteredItems As Outlook.Items\n    Dim itm As Object\n    Dim strFilter As String\n\n    strFilter = &quot;@SQL=&quot; &amp; Chr(34) &amp; &quot;urn:schemas:httpmail:subject&quot; &amp; Chr(34) &amp; &quot; like '%Daily Reports%'&quot;\n    Set filteredItems = myInbox.Items.Restrict(strFilter)\n    AttachmentPath = &quot;H:\\&quot;\n    If filteredItems.count &gt; 0 Then\n        For Each itm In filteredItems\n            If itm.Attachments.count &lt;&gt; 0 Then\n                For Each Atch In itm.Attachments\n                    Atch.SaveAsFile AttachmentPath &amp; Atch.Filename\n                    Exit For\n                Next\n            Else\n                MsgBox &quot;Does not Have an Attachment&quot;\n            End If\n        Next\n    End If\n    Set myOlApp = Nothing\n\nEnd Sub\n</code></pre>\n<p>I am trying to download all the attachments from my inbox email which contain the words &quot;daily Report&quot; in their subject line.</p>\n<p>Some Excel files that I download come out to be <strong>0kb in size</strong> and have their name as <strong>&quot;@&quot;</strong>.</p>\n<p>My best guess is that because these emails are old and opened using <strong>enterprise vault</strong> system, I am not able to download the files in a proper way.</p>\n<p>Edit (ddate as Date) argument was the start date I was using for search and I have removed the code to make it simpler, now it will be searching the entire inbox.</p>\n"}, {"tags": ["vba", "userform"], "comments": [{"owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "edited": false, "score": 1, "creation_date": 1453301378, "post_id": 34902739, "comment_id": 57542341, "body": "Your question and code are a little unclear... what exactly are you trying to accomplish? You want the user to enter a number, then insert that many new rows, but where do you want them inserted and how many times?"}, {"owner": {"reputation": 19, "user_id": 5394383, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44efca75b20496f41d096bbd51b25371?s=128&d=identicon&r=PG&f=1", "display_name": "matt rashty", "link": "https://stackoverflow.com/users/5394383/matt-rashty"}, "reply_to_user": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "edited": false, "score": 0, "creation_date": 1453302398, "post_id": 34902739, "comment_id": 57543071, "body": "if the user types in 5, I want to insert 5 rows. The location being under the selected cell. Thank you for your time"}, {"owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "edited": false, "score": 0, "creation_date": 1453303304, "post_id": 34902739, "comment_id": 57543747, "body": "Ok, do you mean for this to be a separate macro? Your code for <code>Insert()</code> is not going to do what you just described..."}], "answers": [{"tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 1, "last_activity_date": 1453301609, "creation_date": 1453301609, "answer_id": 34903279, "question_id": 34902739, "link": "https://stackoverflow.com/questions/34902739/referencing-a-userform/34903279#34903279", "title": "Referencing a Userform", "body": "<p>If You are Only Looking at taking the No of rows from user. I would suggest use InputBox. If you are Looking at Some thing else and want to Go only with UserForms. Try the below and see if it works.</p>\n\n<pre><code>'Procedure that triggers the user Form\nSub InitiateUserFor()\n UserForm1.Show\nEnd Sub\n 'On Click on Button on UserForm\n Private Sub CommandButton1_Click()\n Call Insert()\n End Sub\n</code></pre>\n\n<p>Add a variable in Your Insert() to read value from UserForm</p>\n\n<pre><code> Dim RowsToInster as Integer\n RowsToInster =UserForm.TextBox1.Value\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5394383, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44efca75b20496f41d096bbd51b25371?s=128&d=identicon&r=PG&f=1", "display_name": "matt rashty", "link": "https://stackoverflow.com/users/5394383/matt-rashty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 34903279, "answer_count": 1, "score": 0, "last_activity_date": 1453301609, "creation_date": 1453300107, "question_id": 34902739, "link": "https://stackoverflow.com/questions/34902739/referencing-a-userform", "title": "Referencing a Userform", "body": "<p>So I made a userform and ultimately I want to be able to add rows based off a number the user types into the userform. I have the code to insert rows, but I don't know how to combine it with the userform and what the person types in. the code I have now is: </p>\n\n<pre><code>Public Sub Insert()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual   'pre XL97 xlManual\n\n    lastrow = ActiveSheet.UsedRange.Rows.Count\n    ActiveSheet.Cells(lastrow, 1).Select\n\n    Set CurrentCell = ActiveSheet.Cells(lastrow, 1)\n\n    For n = lastrow To 0 Step -1\n        If n = lastrow Then GoTo CheckLastRow\n        If n = 1 Then GoTo CheckfirstRow\n            ActiveCell.Offset(-2, 0).Select\n\nCheckLastRow:\n\nSet NextCell = CurrentCell.Offset(-1, 0)\n\n            ActiveCell.Offset(1, 0).Select\n            For i = 1 To CurrentCell\n                ActiveCell.EntireRow.Insert\n            Next i\n\n        Set CurrentCell = NextCell\n    Next n\n\n    'To be performed on the firstrow in the column\nCheckfirstRow:\n            ActiveCell.Offset(-1, 0).Select\n            For i = 1 To CurrentCell\n                ActiveCell.EntireRow.Insert\n            Next i\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "outlook", "indexoutofboundsexception"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1456614382, "post_id": 34902481, "comment_id": 59031843, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10725068/for-each-loop-some-items-get-skipped-when-looping-through-outlook-mailbox-to-de\">For Each loop: Some items get skipped when looping through Outlook mailbox to delete items</a>"}], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1453299915, "creation_date": 1453299915, "answer_id": 34902670, "question_id": 34902481, "link": "https://stackoverflow.com/questions/34902481/vba-outlook-array-index-out-of-bounds/34902670#34902670", "title": "VBA Outlook Array Index out of bounds", "body": "<p>The act of deleting an item decrements <code>Items.Count</code> and takes it out of sync with the current value if <code>i</code>.</p>\n\n<p>Loop backwards so that <code>i</code> is always the last item (which is guaranteed to exist):</p>\n\n<pre><code>For i = oDeletedItems.Items.Count - 1 To 1 Step -1\n</code></pre>\n"}], "owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1753, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496971471, "creation_date": 1453299447, "question_id": 34902481, "link": "https://stackoverflow.com/questions/34902481/vba-outlook-array-index-out-of-bounds", "title": "VBA Outlook Array Index out of bounds", "body": "<p>I have the following code to automatically delete emails that are older than two months:</p>\n\n<pre><code>Sub RemoveAutomaticItemsInDeletedItems()\n\n    If MsgBox(\"Delete items from from Deleted Items folder ?\", vbYesNo, \"Confirm\") = vbYes Then\n\n        Dim oDeletedItems As Outlook.Folder\n        Dim obj As Outlook.MailItem\n        Dim i As Integer\n\n        'Obtain a reference to deleted items folder\n        Set oDeletedItems = Application.Session.GetDefaultFolder(olFolderDeletedItems)\n        For i = 1 To oDeletedItems.Items.Count - 1\n         If oDeletedItems.Items(i).Class = olMail Then\n          Set obj = oDeletedItems.Items.Item(i)\n           If obj.ReceivedTime &lt;= DateAdd(\"m\", -2, Now) Then\n\n             'Deleting them\n             Debug.Print obj.SenderEmailAddress\n             'Debug.Print obj.Subject\n\n              obj.Delete\n\n          End If\n         End If\n        Next\n        MsgBox \"Items have been deleted\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>However, the error: </p>\n\n<p><code>Array index out of bounds</code> </p>\n\n<p>is continually called on the line: </p>\n\n<p><code>If oDeletedItems.Items(i).Class = olMail Then</code></p>\n\n<p>using <code>Debug.Print</code> I have looked into the line of code just above that: <code>oDeletedItems.Items.Count - 1</code>, and the count is 1889 thus there are elements in the array.</p>\n\n<p>Why would this error persist if there are objects within the array?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "edited": false, "score": 0, "creation_date": 1453301771, "post_id": 34902444, "comment_id": 57542600, "body": "I suppose when you say sites you mean pages in your word document? or is that sections?"}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "reply_to_user": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "edited": false, "score": 0, "creation_date": 1453302411, "post_id": 34902444, "comment_id": 57543081, "body": "your right, i mean pages :) im sorry"}, {"owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "edited": false, "score": 0, "creation_date": 1453303258, "post_id": 34902444, "comment_id": 57543705, "body": "Is this a one time thing or do you want to integrate it in some other code e.g. to automate the creation of a regular report ?"}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "reply_to_user": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "edited": false, "score": 0, "creation_date": 1453303490, "post_id": 34902444, "comment_id": 57543879, "body": "i want to integrate it to automate a report. im exporting data from excel to word and on the first page i have a letter whats already formatted for 1 column."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 0, "creation_date": 1453362115, "post_id": 34904246, "comment_id": 57570097, "body": "that works, but now i have the problem that it adds a blank page and then all of my pages are with 2 columns :/"}, {"owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "reply_to_user": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 1, "creation_date": 1453363867, "post_id": 34904246, "comment_id": 57571012, "body": "I have added the <code>Start</code> argument in the <code>Sections.Add</code> method. The default value is producing a next page section break, where this should make it continuous. Let me know if this does the trick for you. I suspect you letter on the first page fill up the whole page, not allowing for the section break to coexist on the same page."}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 0, "creation_date": 1453365386, "post_id": 34904246, "comment_id": 57571745, "body": "Hey, yeah that fixed the problem with the blank page, but im still trying to get why the first page is also getting formatted :("}, {"owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "reply_to_user": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 0, "creation_date": 1453366197, "post_id": 34904246, "comment_id": 57572200, "body": "Unhide your non-printing characters (Ctrl + *) and check where the section break is inserted in relation to your letter. Otherwise you could also add <code>wordDoc.Sections(1).PageSetup.TextColumns.SetCount NumColumns:=1</code> to ensure the first section is always formatted to your needs"}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 0, "creation_date": 1453367963, "post_id": 34904246, "comment_id": 57573280, "body": "I looked at it, its inserted at the start of the document."}, {"owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "reply_to_user": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 0, "creation_date": 1453369516, "post_id": 34904246, "comment_id": 57574242, "body": "Apologies, I realised I made a slight error on the code. The break is added before the paragraph you select. e.g. if your letter is paragraph 1 you should set your range, before which the break is added as paragraph 2"}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "reply_to_user": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "edited": false, "score": 0, "creation_date": 1453371869, "post_id": 34904246, "comment_id": 57575968, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/101275/discussion-between-ndslr-and-genie\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "is_accepted": true, "score": 1, "last_activity_date": 1453363757, "last_edit_date": 1453363757, "creation_date": 1453304225, "answer_id": 34904246, "question_id": 34902444, "link": "https://stackoverflow.com/questions/34902444/word-vba-how-to-set-an-other-column-count-for-a-special-page/34904246#34904246", "title": "Word/VBA: How to set an other column count for a special page?", "body": "<p>Assuming you have a paragraph in your document or created by you code. e.g. you know that your first page ends after the 4th paragraph of your document.</p>\n\n<pre><code>Sub reportCreation()\nDim myRange As Range\n\n'Place where your report is generated - include wordApp activation etc. according to your needs.\n\n'Define the range after which you want to add your page break section - here paragraph 4\nSet myRange = ActiveDocument.Paragraphs(4).Range \n'Add the Next Page section Break\nActiveDocument.Sections.Add Range:=myRange, _ \n        Start:=wdSectionContinuous\n\n'Now your report is separated in two sections: 1st section-&gt; 1st page, 2nd section-&gt;rest of the report\nwordDoc.Sections(2).PageSetup.TextColumns.SetCount NumColumns:=2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 34904246, "answer_count": 1, "score": 0, "last_activity_date": 1453363757, "creation_date": 1453299366, "last_edit_date": 1453306018, "question_id": 34902444, "link": "https://stackoverflow.com/questions/34902444/word-vba-how-to-set-an-other-column-count-for-a-special-page", "title": "Word/VBA: How to set an other column count for a special page?", "body": "<p>I am trying something with Word and VBA, but i have a little problem:</p>\n\n<p>I currently have 3 pages, all of them with 2 columns but I would like to have the first page, and only the first page, with 1 column.</p>\n\n<p>Does someone knew how to solve this?</p>\n\n<p>my code:</p>\n\n<pre><code>Set appWord = CreateObject(\"Word.Application\")\nappWord.DisplayAlerts = False\n\nSet wordDoc = appWord.Documents.Open(Application.GetOpenFilename(\"Word-Dateien (*.doc;*.docx;),*.doc;*.docx\"))\nwordDoc.Activate\nwordDoc.Sections(1).PageSetup.TextColumns.SetCount NumColumns:=2\n</code></pre>\n\n<p>Here is where I currently stopped because I don't know how to make it right. \nWith best regards, and big thanks for answering</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1453306029, "post_id": 34903759, "comment_id": 57545799, "body": "Thank you! I have absolutely no idea how this worked this week, maybe because I didn&#39;t close my objExcel properly (had problems with this previously), but it now works. Thanks!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 2, "last_activity_date": 1453303267, "last_edit_date": 1453303267, "creation_date": 1453302940, "answer_id": 34903759, "question_id": 34902179, "link": "https://stackoverflow.com/questions/34902179/vba-excel-saveas-xlcsv-object-defined-error/34903759#34903759", "title": "Vba Excel .SaveAs xlCSV object defined error", "body": "<p>I'm assuming this code isn't actually running from Excel, in which case the <code>xlCSV</code> constant won't work unless you've set a reference to the <code>Microsoft Excel xx.x Objects</code> library (i.e. Early Binding). You've used late binding and so <code>xlCSV</code> will be treated as an undeclared variant type with a null value.</p>\n\n<hr>\n\n<p>Use the literal <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198017.aspx\" rel=\"nofollow\">value of the xlFileFormat</a> constant instead:</p>\n\n<pre><code>oXl.Activeworkbook.worksheets(sheetnum).SaveAs FileName:=spath &amp; oWorksheet.Name, FileFormat:=6\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 34903759, "answer_count": 1, "score": 0, "last_activity_date": 1453303267, "creation_date": 1453298634, "last_edit_date": 1531164843, "question_id": 34902179, "link": "https://stackoverflow.com/questions/34902179/vba-excel-saveas-xlcsv-object-defined-error", "title": "Vba Excel .SaveAs xlCSV object defined error", "body": "<p>When trying to .SaveAs a worksheet through VBA with ojbExcel, I get the object defined error (1004) that a lot of people have already had. What's annoying about this case is that it worked fine before, but started giving me this error yesterday. I've researched this error and I've tried most solutions but to no avail. \nThe code in question is: </p>\n\n<pre><code>fileLoc = Session.GetOpenFilename(\"Excel (*.xls*), *.xls*\")\nIf fileLoc = \"\" Then Exit Sub\nSet oXl = CreateObject(\"Excel.Application\")\nfpath = fileLoc\nspath = \"H:\\Download\\\" \nsheetnum = InputBox(\"Please insert the sheet number(Count from left to        right).\", \"Select Sheet!\")\nfdir = Dir(fpath)\nIf Trim(fdir) &lt;&gt; \"\" Then\nIf Right(fdir, 5) = \".xlsx\" Then\n\n    Set oWorkbook = oXl.workbooks.Open(fileLoc, False, True)\n    Set oWorksheet = oWorkbook.worksheets(sheetnum)\n    oXl.Activeworkbook.worksheets(sheetnum).SaveAs FileName:=spath &amp;    oWorksheet.Name, FileFormat:=xlCSV\n    'other options I have tried:\n    'oWorksheet.SaveAs spath &amp; oWorkbook.worksheets(sheetnum).Name, xlCSV\n    'oWorksheet.SaveAs spath &amp; oWorksheet.Name, xlCSV 'this last one worked previously\nEnd if \nEnd if \n\noWorkbook.Close\nSet oWorkbook = Nothing\noXl.Quit\nSet oXl = Nothing\n</code></pre>\n\n<p>What possibly changed that this doesn't work anymore?\nExcel 2010, script ran from a Reflection terminal on Citrix client. </p>\n\n<p>Thank you for your time. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453300105, "post_id": 34902152, "comment_id": 57541388, "body": "did you step through the code, line-by-line, and make sure the previous filter has indeed been removed?"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453300910, "post_id": 34902152, "comment_id": 57542005, "body": "And is there data with &quot;Pkt&quot;???"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1453301750, "post_id": 34902152, "comment_id": 57542586, "body": "why over complicate with an auto filter which you remove later. I think it&#39;d be easier to iterate through the cells of column D, and when the contents match your criteria, copy that row to the new worksheet? you could even combine the pps and pkt procedure if yo write the procedure as a sub with the criteria as input. <code>Private Sub CopyData(Criteria as String)</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1453307182, "last_edit_date": 1453307182, "creation_date": 1453303669, "answer_id": 34904022, "question_id": 34902152, "link": "https://stackoverflow.com/questions/34902152/vba-autofilter-and-copy-visible-data/34904022#34904022", "title": "VBA AutoFilter and copy visible data", "body": "<p>The second (PKT) paste process is pasting to the <strong>DestPpsWs</strong> worksheet, not the <strong>DestPktWs</strong> worksheet. Your results are ending up on the <strong>DestPpsWs</strong> worksheet at a position determined by the LastRow on the <strong>DestPktWs</strong> worksheet.</p>\n\n<p>Should be:</p>\n\n<pre><code>            With DestPktWs.Range(\"A\" &amp; LastRow(DestPktWs) + 1)\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n</code></pre>\n\n<p>It was on line 83 in my simulation. Might be slightly different on yours.</p>\n\n<p>To avoid copy &amp; paste mistakes like that, I will loop through an array which holds the individual parameters for repetitious processes. Here is a quick rewrite using a loop.</p>\n\n<pre><code>Public Sub Generate_cmb_Click_Loops()\n    Dim v As Long, vDestinations() As Variant\n    Dim SourceSQ01Wb As Workbook, DestWb As Workbook\n    Dim SourceSQ01Ws As Worksheet\n    Dim SourceSQ01FilterRng As Range, SourceSQ01CopyRng As Range\n\n    vDestinations = Array(\"Packet Plus\", \"Pps\", _\n                          \"Packet\", \"Pkt\")\n\n    'turn back on after debugging\n    'Application.ScreenUpdating = False\n\n    Set SourceSQ01Wb = Workbooks.Open(\"D:\\\\SQ01.xlsx\", ReadOnly:=True)\n    Set SourceSQ01Ws = SourceSQ01Wb.Worksheets(\"Sheet1\")\n    SourceSQ01Ws.Range(\"A:E,G:G,I:N,P:S,U:X,AD:AE,AH:AI\").EntireColumn.Delete\n    'currentRegion does not depend on visible cells like .Find does\n    Set SourceSQ01FilterRng = SourceSQ01Ws.Range(\"A1\").CurrentRegion\n\n    Set DestWb = ThisWorkbook\n\n    '---------------- FOR PPS/PKT ----------------\n    With SourceSQ01FilterRng\n        With .Resize(.Rows.Count, 11)  '&lt;~~ A:K\n            For v = LBound(vDestinations) To UBound(vDestinations) Step 2\n\n                'check for existing AutoFilter; turn off if found\n                If .Parent.AutoFilterMode Then .Parent.AutoFilterMode = False\n\n                'Filter and set the filter field &amp; criteria\n                .AutoFilter Field:=4, Criteria1:=vDestinations(v + 1)\n\n                ' Set SourceSQ01CopyRng to the visible cells in SourceSQ01FilterRng without the header row\n                On Error Resume Next\n                'note: resize before offset otherwise (very rarely) it can crash\n                Set SourceSQ01CopyRng = .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0) _\n                          .SpecialCells(xlCellTypeVisible)\n                On Error GoTo 0\n\n                If Not SourceSQ01CopyRng Is Nothing Then\n\n                    'Copy and paste the cells into DestPpsWs below the existing data\n                    SourceSQ01CopyRng.Interior.Color = xlNone\n                    SourceSQ01CopyRng.Copy\n\n                    With Worksheets(vDestinations(v)).Range(\"A\" &amp; _\n                      LastRow(Worksheets(vDestinations(v))) + 1)\n                        .PasteSpecial xlPasteValues\n                        .PasteSpecial xlPasteFormats\n                        Application.CutCopyMode = False\n                        Application.Goto .Parent.Range(\"A1\")\n                    End With\n\n                End If\n\n            Next v\n        End With\n        'check for leftover AutoFilter; turn it off\n        If .Parent.AutoFilterMode Then .Parent.AutoFilterMode = False\n    End With\n\n    '--------------------------------\n\n    'Close SourceSQ01Wb without saving changes\n    'SourceSQ01Wb.Close (False)\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I removed some redundant code and used the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow\">Range.CurrentRegion property</a> to set the filter range. .CurrentRegion does not depend upon visible rows like a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find method</a> so it doesn't matter if the procedure was started with a filter in place on the source worksheet.</p>\n"}], "owner": {"reputation": 11, "user_id": 5816263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4008134bd23eec8e3f79ba9a380bf2b?s=128&d=identicon&r=PG&f=1", "display_name": "chloe29", "link": "https://stackoverflow.com/users/5816263/chloe29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 519, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453307182, "creation_date": 1453298556, "question_id": 34902152, "link": "https://stackoverflow.com/questions/34902152/vba-autofilter-and-copy-visible-data", "title": "VBA AutoFilter and copy visible data", "body": "<p>I'm using the below macro to open a file, filter column D to \"Pps\" and copy visible data to destination worksheet, after which i clear the filter (the coding works so far) then filter column D again, to \"Pkt\". however, the filter result returns empty instead.. Any idea what went wrong? Thanks in advance!</p>\n\n<pre><code>Private Sub Generate_cmb_Click()    \nDim SourceSQ01Wb As Workbook, DestWb As Workbook\nDim SourceSQ01Ws As Worksheet, DestPpsWs As Worksheet, DestPktWs As Worksheet\nDim SourceSQ01FilterRng As Range, SourceSQ01CopyRng As Range\n\nApplication.ScreenUpdating = False\n\n\nSet SourceSQ01Wb = Workbooks.Open(\"D:\\\\SQ01.xlsx\", , True) 'Readonly = True\nSet SourceSQ01Ws = SourceSQ01Wb.Worksheets(\"Sheet1\")\nSourceSQ01Ws.Range(\"A:E,G:G,I:N,P:S,U:X,AD:AE,AH:AI\").EntireColumn.Delete\nSet SourceSQ01FilterRng = SourceSQ01Ws.Range(\"A1:K\" &amp; LastRow(SourceSQ01Ws))\n\nSet DestWb = ThisWorkbook\nSet DestPpsWs = DestWb.Worksheets(\"Packet Plus\")\nSet DestPktWs = DestWb.Worksheets(\"Packet\")\n\n'---------------- FOR PPS ----------------\n\n\n'Filter and set the filter field &amp; criteria\nSourceSQ01FilterRng.AutoFilter Field:=4, Criteria1:=\"=Pps\"\n\nWith SourceSQ01FilterRng.Parent.AutoFilter.Range\n    On Error Resume Next\n\n    ' Set SourceSQ01CopyRng to the visible cells in SourceSQ01FilterRng without the header row\n    Set SourceSQ01CopyRng = .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count) _\n              .SpecialCells(xlCellTypeVisible)\n\n    On Error GoTo 0\n\n    If Not SourceSQ01CopyRng Is Nothing Then\n\n        'Copy and paste the cells into DestPpsWs below the existing data\n        SourceSQ01CopyRng.Interior.Color = xlNone\n        SourceSQ01CopyRng.Copy\n\n\n            With DestPpsWs.Range(\"A\" &amp; LastRow(DestPpsWs) + 1)\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n    End If\n\n\nEnd With\n\nApplication.Goto DestPpsWs.Range(\"A1\")\n\n\n'---------------- FOR PKT ----------------  \n\n'Clear filer\n    SourceSQ01FilterRng.Parent.AutoFilterMode = False\n\n\n\n'Filter and set the filter field &amp; criteria\nSourceSQ01FilterRng.AutoFilter Field:=4, Criteria1:=\"=Pkt\"\n\nWith SourceSQ01FilterRng.Parent.AutoFilter.Range\n    On Error Resume Next\n\n    ' Set SourceSQ01CopyRng to the visible cells in SourceSQ01FilterRng without the header row\n    Set SourceSQ01CopyRng = .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count) _\n              .SpecialCells(xlCellTypeVisible)\n\n    On Error GoTo 0\n\n    If Not SourceSQ01CopyRng Is Nothing Then\n\n        'Copy and paste the cells into DestPktWs below the existing data\n        SourceSQ01CopyRng.Interior.Color = xlNone\n        SourceSQ01CopyRng.Copy\n\n\n            With DestPpsWs.Range(\"A\" &amp; LastRow(DestPktWs) + 1)\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n    End If\n\n\nEnd With\n\nApplication.Goto DestPktWs.Range(\"A1\")\n\n\n\n\n'--------------------------------\n\n\n'Close SourceSQ01Wb without saving changes\n'SourceSQ01Wb.Close (False)\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlValues, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\nOn Error GoTo 0\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453298181, "post_id": 34901950, "comment_id": 57539952, "body": "What were the values in your test? What is the output you expect? What was the output you received?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1453313878, "creation_date": 1453313878, "answer_id": 34907549, "question_id": 34901950, "link": "https://stackoverflow.com/questions/34901950/proper-if-condition-and-proper-use-of-loop-structure-in-excel-vba/34907549#34907549", "title": "Proper `If Condition` and proper use of `Loop Structure` in Excel-VBA", "body": "<p>Your lookup to the keys on the <strong>Answers</strong> worksheet could be eased with the introduction of a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251825.aspx\" rel=\"nofollow noreferrer\">Scripting.Dictionary</a> object.</p>\n\n<pre><code>Sub question_Check_by_Dictionary()\n    Dim questionType As Range\n    Dim v As Long, vAIDs As Variant, d As Long, dict As Object\n\n    'load the dictionary with the answer types\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    dict.CompareMode = vbTextCompare\n    With Worksheets(\"Answers\")\n        For d = 2 To .Cells(.Rows.Count, 1).End(xlUp).Row\n            dict.Item(CStr(.Cells(d, 1).Value2)) = .Cells(d, 2).Value2\n        Next d\n    End With\n\n    'reset the Questions worksheet\n    With Worksheets(\"Questions\")\n        .Range(.Cells(2, 1), .Cells(.Rows.Count, 3).End(xlUp)).Interior.Pattern = xlNone\n    End With\n\n    'reset the Incorrect Mappings worksheet\n    With Worksheets(\"Incorrect Mappings\")\n        .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp)).Clear\n    End With\n\n    With Worksheets(\"Questions\")\n        For Each questionType In .Range(.Cells(2, 2), .Cells(.Rows.Count, 2).End(xlUp))\n            If Not CBool(InStr(1, questionType.Value2, \"event\", vbTextCompare)) Then\n                vAIDs = Split(questionType.Offset(0, 1), Chr(59)) 'split on semi-colon\n                For v = LBound(vAIDs) To UBound(vAIDs)\n                    If dict.exists(vAIDs(v)) Then\n                        If CBool(InStr(1, dict.Item(CStr(vAIDs(v))), \"event\", vbTextCompare)) Then\n                            questionType.Resize(1, 3).Offset(0, -1).Interior.Color = vbRed\n                            With Sheets(\"Incorrect Mappings\")\n                                .Hyperlinks.Add Anchor:=.Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0), _\n                                                Address:=\"\", SubAddress:=questionType.Address(external:=True), _\n                                                ScreenTip:=\"click to go to rogue question\", _\n                                                TextToDisplay:=\"Question \" &amp; questionType.Offset(0, -1).Value2 &amp; _\n                                                               \" should not have Event based frequency (\" &amp; _\n                                                               vAIDs(v) &amp; \").\"\n                            End With\n                        End If\n                    Else\n                        questionType.Resize(1, 3).Offset(0, -1).Interior.Color = vbYellow\n                        With Sheets(\"Incorrect Mappings\")\n                            .Hyperlinks.Add Anchor:=.Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0), _\n                                            Address:=\"\", SubAddress:=questionType.Address(external:=True), _\n                                            ScreenTip:=\"click to go to rogue question\", _\n                                            TextToDisplay:=\"Question \" &amp; questionType.Offset(0, -1).Value2 &amp; _\n                                                           \" references an unknown Answer ID (\" &amp; _\n                                                           vAIDs(v) &amp; \").\"\n                        End With\n                    End If\n                Next v\n            End If\n        Next questionType\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've added a check to ensure that the answer ID found in the <strong>Questions</strong> worksheet actually exists in the <strong>Answers</strong> worksheet.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/mdM6S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mdM6S.png\" alt=\"dictionary_Questions_Answer_key\"></a></p>\n"}], "owner": {"reputation": 235, "user_id": 4865342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wGbby.jpg?s=128&g=1", "display_name": "Charvi", "link": "https://stackoverflow.com/users/4865342/charvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 34907549, "answer_count": 1, "score": 4, "last_activity_date": 1453357298, "creation_date": 1453298040, "last_edit_date": 1531164843, "question_id": 34901950, "link": "https://stackoverflow.com/questions/34901950/proper-if-condition-and-proper-use-of-loop-structure-in-excel-vba", "title": "Proper `If Condition` and proper use of `Loop Structure` in Excel-VBA", "body": "<p>My Workbook has three sheets, Namely; <code>Questions</code>, <code>Answers</code> and <code>Incorrect Mappings</code>.</p>\n\n<p>In <strong>Questions</strong> Sheet:\n<code>Column A</code> is <code>Question_Id</code>.</p>\n\n<p><code>Column B</code>: <code>Answer_Type</code> has value among : <strong>True/False</strong>, <strong>One another</strong>, <strong>Multi item</strong>, <strong>CheckBoxes</strong>, <strong>Event</strong>.</p>\n\n<p><code>Column C</code>: <code>Answer_Id</code> (One or More 'Numeric Values') separated with Semicolon. </p>\n\n<p>In <strong>Answers</strong> Sheet:</p>\n\n<p><code>Column A</code> is <code>Answer_Id</code>.\n(Few or all Answer IDs of <code>Questions</code> sheet will be listed here, each on a single row).</p>\n\n<p><code>Column B</code> is <code>Frequency</code>; which has values such as:</p>\n\n<p><strong>Event Based</strong>, <strong>Yearly</strong>, <strong>Half Yearly</strong>, <strong>Quarterly</strong>.</p>\n\n<p>The Questions and Answers sheet are linked on <code>Answer_Id</code> column. </p>\n\n<p><a href=\"https://i.stack.imgur.com/aPhH3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aPhH3.png\" alt=\"Questions, Answers and Observations Sheet\"></a></p>\n\n<p>Requirement:\nIf any Question Id has 'Answer Types' such as True/False, One another, Multi item, CheckBoxes; then Answer Id's against it in \n<code>Answers</code> sheet should not have frequency <code>Event Based</code> against such Answer_Id.\ni.e. If <code>Answer_Type</code> is 'Event' then only, frequency against it should be <strong>Event Based</strong></p>\n\n<p>The incorrect mappings in <code>Questions</code> sheet should be sent to <code>Incorrect Mappings</code> sheet as hyperlinks to 'Questions' Sheet.\nI've written the following code:</p>\n\n<pre><code>Dim shname, strstr, strErr, stString As String\nDim stArray() As String\n\nDim AnsIds1 As Range\nDim celadr, celval, AnsId1, AnsId2, questionType As Variant\n\nDim LastRow, LastRowSheet2 As Long\nLastRow = Sheets(\"Questions\").Cells(Rows.Count, 2).End(xlUp).Row\nLastRowSheet2 = Sheets(\"Answers\").Cells(Rows.Count, 2).End(xlUp).Row\n\n\nFor Each questionType In Worksheets(\"Questions\").Range(\"B2:B\" &amp; LastRow)\n    celadr = questionType.Address\n    celval = questionType.Value\n    If Len(celval) &gt;= 1 Then\n        If InStr(1, (\"TRUE/FALSE,ONE ANOTHER,MULTI ITEM,CHECKBOXES,\"), UCase(celval) &amp; \",\") &gt;= 1 Then\n        For Each AnsIds1 In Worksheets(\"Questions\").Range(\"C2:C\" &amp; LastRow)\n            stString = AnsIds1\n            stArray() = Split(stString, \";\")\n            For Each AnsId1 In stArray()\n                For Each AnsId2 In Worksheets(\"Answers\").Range(\"A2:A\" &amp; LastRowSheet2).Cells\n\n                    If Trim(AnsId1) = Trim(AnsId2) Then\n                         If Trim(UCase(AnsId2.Offset(0, 1).Value)) = \"EVENT BASED\" Then  'Is this If condition should be changed to something else?\n                         AnsIds1.Interior.Color = vbRed\n                            celadr = AnsIds1.Address\n                            Sheets(\"Questions\").Select\n                            shname = ActiveSheet.Name\n                            Sheets(\"Incorrect Mappings\").Range(\"A65536\").End(xlUp).Offset(1, 0).Value = AnsId2 &amp; \" Should not have Event based frequency\"\n                            strstr = \"'\" &amp; shname &amp; \"'!\" &amp; Range(celadr).Address(0, 0)\n                            Sheets(\"Incorrect Mappings\").Hyperlinks.Add Anchor:=Sheets(\"Incorrect Mappings\").Range(\"A65536\").End(xlUp), Address:=\"\", SubAddress:=strstr\n                        End If\n                    End If\n                Next\n            Next\n        Next\n        End If\n    End If\nNext\n</code></pre>\n\n<p>When I run the above code, I do get the mixed output (an incorrect output). </p>\n\n<p>After writing the code step by step and debugging it step by step, I feel the mistake is at line commented as\n    <code>Is this If condition should be changed to something else?</code> or at the line above it.</p>\n\n<p>Can someone tell me, to what condition I've to change it?. </p>\n\n<p>(Also, I need to change loop structure to get incorrect mappings only once in <code>Incorrect Mappings</code> sheet, but it's a second priority)</p>\n"}, {"tags": ["forms", "vba", "ms-access", "for-loop"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1453298067, "post_id": 34901810, "comment_id": 57539866, "body": "You are using me in an opened form in design mode.  You&#39;ll need to open it into a form object or reference it, me is the loaded form where the code resides."}, {"owner": {"reputation": 253, "user_id": 4344039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/acb49c2644939a41a31aed4b05791c0a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4344039/alex"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453299048, "post_id": 34901810, "comment_id": 57540596, "body": "@Nathan_Sav Perfect, that was exactly what was wrong with my code.. I&#39;ve changed it from Me.Controls to Form(obj.Name).Controls and it seems to be working now. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1453298649, "creation_date": 1453298649, "answer_id": 34902188, "question_id": 34901810, "link": "https://stackoverflow.com/questions/34901810/microsoft-access-loop-through-all-forms-and-controls-on-each-form/34902188#34902188", "title": "Microsoft Access - Loop through all forms and controls on each form", "body": "<p>Something like this</p>\n\n<pre><code>Public Function changelabel()\n\nDim f As Form\nDim i As Integer\nDim c As Control\n\nFor i = 0 To CurrentProject.AllForms.Count - 1\n    If Not CurrentProject.AllForms(i).IsLoaded Then\n        DoCmd.OpenForm CurrentProject.AllForms(i).Name, acDesign\n    End If\n    Set f = Forms(i)\n\n    For Each c In f.Controls\n        If c.Tag = \"TESTING\" Then\n            c.Caption = \"TESTING\"\n        End If\n    Next c\nNext i\n\n\nEnd Function\n</code></pre>\n\n<p>You'll need to add a bit of house-keeping to set the objects used to nothing etc..</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6340519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a356bc82b0f60dc05b5a43e4572cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Rosen Nikolov", "link": "https://stackoverflow.com/users/6340519/rosen-nikolov"}, "is_accepted": false, "score": 2, "last_activity_date": 1518173428, "creation_date": 1518173428, "answer_id": 48704203, "question_id": 34901810, "link": "https://stackoverflow.com/questions/34901810/microsoft-access-loop-through-all-forms-and-controls-on-each-form/48704203#48704203", "title": "Microsoft Access - Loop through all forms and controls on each form", "body": "<pre><code>    Public Sub GetForms()\n    Dim oForm As Form\n    Dim nItem As Long\n    Dim bIsLoaded As Boolean\n    For nItem = 0 To CurrentProject.AllForms.Count - 1\n        bIsLoaded = CurrentProject.AllForms(nItem).IsLoaded\n        If Not bIsLoaded Then\n            On Error Resume Next\n            DoCmd.OpenForm CurrentProject.AllForms(nItem).NAME, acDesign\n        End If\n        Set oForm = Forms(CurrentProject.AllForms(nItem).NAME)\n        GetControls oForm\n        If Not bIsLoaded Then\n            On Error Resume Next\n            DoCmd.Close acForm, oForm.NAME\n        End If\n    Next\nEnd Sub\n\nSub GetControls(ByVal oForm As Form)\n    Dim oCtrl As Control\n    Dim cCtrlType, cCtrlCaption As String\n    For Each oCtrl In oForm.Controls\n        If oCtrl.ControlType = acSubform Then Call GetControls(oCtrl.Form)\n        Select Case oCtrl.ControlType\n            Case acLabel: cCtrlType = \"label\": cCtrlCaption = oCtrl.Caption\n            Case acCommandButton: cCtrlType = \"button\": cCtrlCaption = oCtrl.Caption\n            Case acTextBox: cCtrlType = \"textbox\": cCtrlCaption = oCtrl.Properties(\"DataSheetCaption\")\n            Case Else: cCtrlType = \"\"\n        End Select\n        If cCtrlType &lt;&gt; \"\" Then\n            Debug.Print oForm.NAME\n            Debug.Print oCtrl.NAME\n            Debug.Print cCtrlType\n            Debug.Print cCtrlCaption\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 4344039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/acb49c2644939a41a31aed4b05791c0a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4344039/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13829, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518173428, "creation_date": 1453297648, "question_id": 34901810, "link": "https://stackoverflow.com/questions/34901810/microsoft-access-loop-through-all-forms-and-controls-on-each-form", "title": "Microsoft Access - Loop through all forms and controls on each form", "body": "<p>Okay so when I press a specific button I want to loop through all forms, then find every control in each form with the tag 'TESTING'. If the tag = 'TESTING' then I want to change the caption of the object to 'abc123'.</p>\n\n<p>The only objects with the tag 'TESTING' will be labels, so they will have the caption property.</p>\n\n<p>So far I have this as the function:</p>\n\n<pre><code>Public Function changelabel()\n\nOn Error Resume Next\nDim obj As AccessObject, dbs As Object\nDim ctrl as Control\n\nSet dbs = Application.CurrentProject\n\nFor Each obj In dbs.AllForms\nDoCmd.OpenForm obj.Name, acDesign\n    For Each ctrl In Me.Controls\n        If ctrl.Tag = \"TESTING\" Then\n        ctrl.Caption = \"abc123\"\n        End If\n\n        Next ctrl\n\nNext obj\n\nEnd Function\n</code></pre>\n\n<p>Then this as the button code:</p>\n\n<pre><code>Public Sub TestButton_Click()\nCall changelabel\nEnd Sub\n</code></pre>\n\n<p>So it executes the first for loop and opens all the forms in design view correctly. The problem lies with the second for loop. None of the label captions that have the tag property as 'TESTING' are changed to 'abc123'.</p>\n\n<p>So what do I need to change to get the second for loop to work?</p>\n"}, {"tags": ["vba", "excel", "csv"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "edited": false, "score": 1, "creation_date": 1453302908, "post_id": 34901939, "comment_id": 57543450, "body": "Ah, now it makes sense.  I knew it was something like that.  Thanks for the help Scott!!"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 1, "creation_date": 1453307879, "post_id": 34901939, "comment_id": 57547131, "body": "If Scott&#39;s anwser helped you please <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accept it</a>.  Accepting answers helps those that follow you, rewards Scott for his effort and increases the likelihood of your future questions receiving answers.  Currently you have 8 open questions."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1453302972, "last_edit_date": 1453302972, "creation_date": 1453298005, "answer_id": 34901939, "question_id": 34901704, "link": "https://stackoverflow.com/questions/34901704/how-to-create-a-csv-file-if-it-doesnt-exist/34901939#34901939", "title": "How to create a CSV file if it doesn&#39;t exist?", "body": "<p>You need to copy the sheet out of the workbook first.</p>\n\n<p>Change these lines:</p>\n\n<pre><code>ws.SaveAs \"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\", xlCSV\nWorkbooks.Open Filename:=\"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\"\n</code></pre>\n\n<p>To the following lines</p>\n\n<pre><code>   ws.Copy \n   ActiveWorkbook.SaveAs \"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\", xlCSV\n</code></pre>\n\n<p>When saving a <code>worksheet</code> as CSV it saves the entire active workbook to the file and leaves it open. So, in your code, you are trying to open a file that is already open. </p>\n\n<p>The code above will pull the worksheet into a new workbook and save it as a CSV (with only 1 sheet, which is required for a CSV).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453302972, "creation_date": 1453297368, "last_edit_date": 1453298161, "question_id": 34901704, "link": "https://stackoverflow.com/questions/34901704/how-to-create-a-csv-file-if-it-doesnt-exist", "title": "How to create a CSV file if it doesn&#39;t exist?", "body": "<p>I'm trying to get excel to check for the existence of a CSV file, and if it doesn't exist, create it.  I've tried doing this several ways, but I can't seem to get anything working.  Here's my code so far.</p>\n\n<pre><code>If Dir(\"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\\") = \"\" Then\n                MkDir \"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\\"\n                Dim ws As Worksheet\n                For Each ws In ActiveWorkbook.Worksheets\n                    If ws.Name = MyCell.Value Then\n                        ws.SaveAs \"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\", xlCSV\n                        Workbooks.Open Filename:=\"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\"\n                        Cells.Select\n                        Selection.Delete\n                        ActiveWorkbook.Close True\n\n                        LastRowCusip = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"BW\").End(xlUp).Row\n                        Set Rng = Range(\"BG5:BW\" &amp; LastRowCusip)\n                        Workbooks.Open Filename:=\"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\"\n                        LR = Cells(Rows.Count, \"A\").End(xlUp).Row + 3 'last used row\n                        Rng.Copy Range(\"A\" &amp; LR)\n                        ActiveWorkbook.Close True\n\n                    End If\n                Next\n            End If\n</code></pre>\n\n<p>As soon as I get to this line:</p>\n\n<p>Workbooks.Open Filename:=\"C:\\Users\\\" &amp; sUserName &amp; \"\\Desktop\\DataDump\\DataDump.csv\"</p>\n\n<p>Excel shuts down!!</p>\n\n<p>All I want to do is test for the existence of a CSV file and it it doesn't exist, create it on a user's desktop, based on each user's sUserName, which comes from here.</p>\n\n<pre><code>sUserName = Environ$(\"username\")\n</code></pre>\n\n<p>Can someone please help me get this working?\nThanks!!!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1453297245, "post_id": 34901424, "comment_id": 57539282, "body": "You can massively simplify your code by using the <code>DMax</code> function."}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1453298229, "post_id": 34901424, "comment_id": 57539992, "body": "@Andre, Thanks! You have no idea how much you helped me. But originally, my code gets the maximum value of a <b>date</b> field. Does it work on that type as well?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1453298519, "post_id": 34901424, "comment_id": 57540218, "body": "Yes, DMax works on date/time fields too."}], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1453297519, "last_edit_date": 1453297519, "creation_date": 1453296941, "answer_id": 34901530, "question_id": 34901424, "link": "https://stackoverflow.com/questions/34901424/i-am-getting-an-error-on-if-recordset-nothing/34901530#34901530", "title": "I am getting an error on if recordset = nothing", "body": "<p>Change this piece of code:</p>\n\n<pre><code>If Not rs Is Nothing Then\n    rs.Close\n    Set rs = Nothing\nEnd If\n</code></pre>\n\n<p>Also if it's clean-up procedure closing code, just use <code>On Error Resume Next</code> before invalidating open objects, no need to check if they are valid or not.</p>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1453297299, "post_id": 34901560, "comment_id": 57539310, "body": "Compile error too, it must be <code>If Not rs Is Nothing Then</code>"}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1453297443, "post_id": 34901560, "comment_id": 57539405, "body": "Your right that I made a  mistake in the If statement. Originally it was <code>if Not</code> in my code. I foergot to put it in the question, and I changed it now. But <code>if rs Nothing</code> gets the same error."}, {"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1453297875, "post_id": 34901560, "comment_id": 57539738, "body": "<code>rs = nothing</code> is wrong as well.  Since rs is an <b>object</b>, you should use <code>set</code> to change it&#39;s value. &#39;Set rs = Nothing`."}], "tags": [], "owner": {"reputation": 639, "user_id": 4598964, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10153689452664899/picture?type=large", "display_name": "Dave B", "link": "https://stackoverflow.com/users/4598964/dave-b"}, "is_accepted": false, "score": -1, "last_activity_date": 1453297013, "creation_date": 1453297013, "answer_id": 34901560, "question_id": 34901424, "link": "https://stackoverflow.com/questions/34901424/i-am-getting-an-error-on-if-recordset-nothing/34901560#34901560", "title": "I am getting an error on if recordset = nothing", "body": "<p>It looks as it you are trying to close the recordset when it is already closed.</p>\n\n<p>Perhaps this might work:</p>\n\n<pre><code>If rs &lt;&gt; Nothing Then\n    rs.Close\n    rs = Nothing\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "is_accepted": true, "score": 2, "last_activity_date": 1453297653, "creation_date": 1453297653, "answer_id": 34901812, "question_id": 34901424, "link": "https://stackoverflow.com/questions/34901424/i-am-getting-an-error-on-if-recordset-nothing/34901812#34901812", "title": "I am getting an error on if recordset = nothing", "body": "<p>The correct statement should be :</p>\n\n<pre><code>If Not rs is Nothing Then\n    rs.Close\n    set rs = Nothing\nEnd If\n</code></pre>\n\n<p>Since Nothing is an object that means <strong>unknown</strong>, it doesn't <strong>equal</strong> anything. Not even itself.</p>\n"}], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 34901812, "answer_count": 3, "score": 0, "last_activity_date": 1453608844, "creation_date": 1453296649, "last_edit_date": 1453608844, "question_id": 34901424, "link": "https://stackoverflow.com/questions/34901424/i-am-getting-an-error-on-if-recordset-nothing", "title": "I am getting an error on if recordset = nothing", "body": "<p>I wrote a function that opens a recordset. At the end of the function I want to close the recordset if it wasn't closed already, for error catching purposes.</p>\n\n<p>When I try running the function I get the following compile error: <strong>Invalid use of object.</strong> Since I'm not trying to change the value of the recordset object, there should be no reason for this error to appear.</p>\n\n<pre><code>Dim rs as Recordset\n...\n\nIf Not rs = Nothing Then\n    rs.Close\n    set rs = Nothing\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453296398, "post_id": 34901279, "comment_id": 57538668, "body": "manually checek the cell. It&#39;s possible that while it appears empty, there is an empty ` ` <code>(space)</code> character or a carriage return or something in the cell that is not visible to the eye af first glance."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "edited": false, "score": 0, "creation_date": 1453309264, "post_id": 34902368, "comment_id": 57548094, "body": "I did File&gt;Options&gt;Advanced&gt;Show a zero in cell that have zero value a lot of cells which were in blank turned into zero value (&quot;0&quot;), but some few do not turn. And my problem is that. I made a formula to sum a line when find a specific word, made it in vba, but i got error when my conter find this cells (cells in blank apparently). I run this code that you write above, and said to me that one of this cells blank had a value equal 32, but do not have anything!  How can i solve this?"}, {"owner": {"reputation": 1798, "user_id": 1212815, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IGkOW.png?s=128&g=1", "display_name": "Eduardo Po&#231;o", "link": "https://stackoverflow.com/users/1212815/eduardo-po%c3%a7o"}, "reply_to_user": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "edited": false, "score": 0, "creation_date": 1453312747, "post_id": 34902368, "comment_id": 57550401, "body": "32 is the ASCII value of the blank space. So, the external data is giving you blank spaces, not empty strings. I&#39;ll edit my answer to include a way to get rid of these."}], "tags": [], "owner": {"reputation": 1798, "user_id": 1212815, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IGkOW.png?s=128&g=1", "display_name": "Eduardo Po&#231;o", "link": "https://stackoverflow.com/users/1212815/eduardo-po%c3%a7o"}, "is_accepted": false, "score": 1, "last_activity_date": 1453313107, "last_edit_date": 1453313107, "creation_date": 1453299193, "answer_id": 34902368, "question_id": 34901279, "link": "https://stackoverflow.com/questions/34901279/blanks-cells-in-excel/34902368#34902368", "title": "Blanks Cells in Excel", "body": "<p>Maybe some unprintable char. Add a module with this sub:</p>\n\n<pre><code>Sub show_content()\n    cont = Selection.Value\n    If cont &lt;&gt; \"\" Then\n        MsgBox Asc(cont)\n    Else\n        MsgBox \"Cell really is a blank!\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Then, select the seemingly blank cell and run 'show_content' on the macro menu (alt+F8). It will show you the ASCII value of the strange char, if it is not a blank, or confirm it is really a blank (empty cell).</p>\n\n<p>This one will erase cells with blank spaces, so they will become really empty and be recognized as zero by the formulas:</p>\n\n<pre><code>Sub erase_spaces()\n    For Each elem In ActiveSheet.UsedRange\n        elem.Value = Trim(elem.Value)\n    Next elem\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "edited": false, "score": 1, "creation_date": 1453311896, "post_id": 34904951, "comment_id": 57549837, "body": "I did that too, but as I said, Excel does not recognize these blanks cells as empty cells, because of that I cannot replace. When I do what Eduardo Po&#231;o said, I got a return of &quot;32&quot;, but I cannot see this values, I do not know where this came from!"}, {"owner": {"reputation": 507, "user_id": 4792911, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZQx85B_BF-Q/AAAAAAAAAAI/AAAAAAAAHGg/lOFdVaqQ2LE/photo.jpg?sz=128", "display_name": "radiocontrolled", "link": "https://stackoverflow.com/users/4792911/radiocontrolled"}, "reply_to_user": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "edited": false, "score": 0, "creation_date": 1453312063, "post_id": 34904951, "comment_id": 57549971, "body": "This will likely provide some insight: <a href=\"http://stackoverflow.com/questions/15984580/excel-telling-me-my-blank-cells-arent-blank\" title=\"excel telling me my blank cells arent blank\">stackoverflow.com/questions/15984580/&hellip;</a>"}], "tags": [], "owner": {"reputation": 507, "user_id": 4792911, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZQx85B_BF-Q/AAAAAAAAAAI/AAAAAAAAHGg/lOFdVaqQ2LE/photo.jpg?sz=128", "display_name": "radiocontrolled", "link": "https://stackoverflow.com/users/4792911/radiocontrolled"}, "is_accepted": false, "score": 0, "last_activity_date": 1453306235, "creation_date": 1453306235, "answer_id": 34904951, "question_id": 34901279, "link": "https://stackoverflow.com/questions/34901279/blanks-cells-in-excel/34904951#34904951", "title": "Blanks Cells in Excel", "body": "<p>Upon finding the character(s) in the cell that appears blank, you can run a \"Find and Replace\" (<code>Ctrl+F</code>) to change all cells with the certain character(s) to \"0\".</p>\n\n<p>Enter the character(s) in the \"Find What\" input box and a \"0\" in the \"Replace With\" input box.  This will allow you to find and replace all cells that contain the character(s) with a \"0\" or whatever you would like. </p>\n"}], "owner": {"reputation": 27, "user_id": 5569741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13c79fefd1f5097163183001c3b2dfc5?s=128&d=identicon&r=PG&f=1", "display_name": "ygor jesus", "link": "https://stackoverflow.com/users/5569741/ygor-jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1453313107, "creation_date": 1453296188, "question_id": 34901279, "link": "https://stackoverflow.com/questions/34901279/blanks-cells-in-excel", "title": "Blanks Cells in Excel", "body": "<p>I got a sheet that came from a query (get external data), but this sheet have many \"empty\" cells. I put this way, \"empty\", because when I gave the command to put all empty cells equals zero, a lot of cells, aparentment empty, did not turn into zero. The Excel did not recognize these cells as empty cells, although do not have anything into.</p>\n\n<p>Can anyone knows what kind of magic is envolved in this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 4991636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206162866885933/picture?type=large", "display_name": "Tom37", "link": "https://stackoverflow.com/users/4991636/tom37"}, "is_accepted": false, "score": 0, "last_activity_date": 1453296808, "creation_date": 1453296808, "answer_id": 34901482, "question_id": 34901098, "link": "https://stackoverflow.com/questions/34901098/excel-vba-2013-insert-a-row-with-the-same-format-as-the-row-above/34901482#34901482", "title": "excel-vba 2013, insert a row with the same format as the Row above", "body": "<p>You need an end if statement before the line commencing 'next'.  It's also normal to indent after the 'then' to make the if more clearly defined</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1453298257, "post_id": 34901542, "comment_id": 57540019, "body": "your code is inserting the rows just fine but instead of copying and pasting the values from &quot;A:I&quot; in the &quot;x&quot; row into the new row, it is deleting the values from &quot;A:I&quot; in the &quot;x&quot; row. Thank you for taking the time to look at this."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1453298925, "post_id": 34901542, "comment_id": 57540513, "body": "@rstuart931 - are you sure you copied the code in <i>exactly</i> as I have it? Can you also debug, line-by-line, to see why it&#39;s happening? There is nothing in the code I wrote that should delete or remove any data."}, {"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 1, "creation_date": 1453299340, "post_id": 34901542, "comment_id": 57540815, "body": "delete was the wrong word, apparently it was copying &quot;A:I&quot; in the newly inserted row and pasting it into the existing row. I just moved your &quot;x+1&quot; from the paste row into the copy row and it works great. Thank you very much!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1453297377, "last_edit_date": 1453297377, "creation_date": 1453296972, "answer_id": 34901542, "question_id": 34901098, "link": "https://stackoverflow.com/questions/34901098/excel-vba-2013-insert-a-row-with-the-same-format-as-the-row-above/34901542#34901542", "title": "excel-vba 2013, insert a row with the same format as the Row above", "body": "<p>When inserting (or deleting) rows you'll need to step backwards through the row count (start at last row and move up). This is because once you insert a row, it will through the range off, if you go from first to last and you will miss rows.</p>\n\n<p>That is one issue. The other issue, is that you don't specifically refer to which cells and rows you want to insert. The best way to avoid errors is to qualify and work directly with your objects. And still a third issue is that you don't appear to end your <code>If</code> block, but I could be misunderstanding the code a bit. See my notes below.</p>\n\n<p>See this code, which should work more smoothly for you:</p>\n\n<pre><code>Dim LastRow As Long\nDim x as Long\nDim ws as Worksheet\n\nSet ws = Sheets(\"Sheeet1\") 'change as needed\n\nLastRow = xlLastRow \n\nFor x = LastRow to 3 Step -1\n\n    If ws.Range(\"M\" &amp; x).Value &gt;= 1 Then \n       ws.Rows(x).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    'this will copy data A:I from same row into newly inserted row\n      ws.Range(\"A\" &amp; x &amp; \":I\" &amp; x).Copy\n      ws.Range(\"A\" &amp; x +1 &amp; \":I\" &amp; x + 1).PasteSpecial Paste:=xlPasteAllUsingSourceTheme\n\n    End If\n\nNext Cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "is_accepted": false, "score": 0, "last_activity_date": 1453297078, "creation_date": 1453297078, "answer_id": 34901581, "question_id": 34901098, "link": "https://stackoverflow.com/questions/34901098/excel-vba-2013-insert-a-row-with-the-same-format-as-the-row-above/34901581#34901581", "title": "excel-vba 2013, insert a row with the same format as the Row above", "body": "<p>You must specify the row which you insert a new row relative to it.</p>\n\n<p>Rows(x).Insert </p>\n"}], "owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 0, "accepted_answer_id": 34901542, "answer_count": 3, "score": 0, "last_activity_date": 1453297377, "creation_date": 1453295744, "last_edit_date": 1453297342, "question_id": 34901098, "link": "https://stackoverflow.com/questions/34901098/excel-vba-2013-insert-a-row-with-the-same-format-as-the-row-above", "title": "excel-vba 2013, insert a row with the same format as the Row above", "body": "<p>I'm looping through column (M) and if the value is >= 1, I want to insert a row beneath. it should have the same formatting as the row above and Copy down the data from columns A:I</p>\n\n<pre><code>Sub insertRow()\n\nDim LastRow As Long\nDim rng As Range, Cell As Range, rng2 As Range, rng3 As Range\n\nLastRow = xlLastRow\nSet rng = Range(\"M3:M\" &amp; LastRow)  \n\nFor Each Cell In rng\nIf Cell.Value &gt;= 1 Then Rows.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nSet rng2 = Range(\"A3:I3\")\nrng2.Copy\nset rng3 = Range(\"A4\")\nrng3.PasteSpecial Paste:=xlPasteAllUsingSourceTheme\nNext Cell\n</code></pre>\n\n<p>The xlLastRow function is defined elsewhere. I am receiving an \"Application-defined or object-defined error\" on the \"Then\" statement. Thanks for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1453295357, "post_id": 34900626, "comment_id": 57538024, "body": "Perhaps you can use Workbooks.Open directly and open the file in Excel and then do a save-as?"}, {"owner": {"reputation": 3, "user_id": 3137471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd2e233ed7246b9ca259490d41f95?s=128&d=identicon&r=PG&f=1", "display_name": "user3137471", "link": "https://stackoverflow.com/users/3137471/user3137471"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1453295400, "post_id": 34900626, "comment_id": 57538052, "body": "That was the first thing I tried :)"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 3137471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd2e233ed7246b9ca259490d41f95?s=128&d=identicon&r=PG&f=1", "display_name": "user3137471", "link": "https://stackoverflow.com/users/3137471/user3137471"}, "is_accepted": true, "score": 0, "last_activity_date": 1453298906, "last_edit_date": 1453298906, "creation_date": 1453298204, "answer_id": 34902019, "question_id": 34900626, "link": "https://stackoverflow.com/questions/34900626/excel-vba-file-download-works-from-browser-but-program-based-method-fails/34902019#34902019", "title": "Excel VBA: File Download works from Browser but program based method fails", "body": "<p>Well I realized after reconciling HTTP request that although the link is http, it automatically redirects to https. So by just changing http to https in the link, it worked for me.</p>\n\n<p>Thanks everyone.</p>\n"}], "owner": {"reputation": 3, "user_id": 3137471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd2e233ed7246b9ca259490d41f95?s=128&d=identicon&r=PG&f=1", "display_name": "user3137471", "link": "https://stackoverflow.com/users/3137471/user3137471"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 34902019, "answer_count": 1, "score": 0, "last_activity_date": 1453298906, "creation_date": 1453294445, "last_edit_date": 1531164843, "question_id": 34900626, "link": "https://stackoverflow.com/questions/34900626/excel-vba-file-download-works-from-browser-but-program-based-method-fails", "title": "Excel VBA: File Download works from Browser but program based method fails", "body": "<p>I have tried all the solutions provided over here\n<a href=\"https://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\">How do i download a file using VBA (Without internet explorer)</a></p>\n\n<p>However I am not able to download following file:\n<a href=\"http://rbidocs.rbi.org.in/rdocs/ATM/DOCs/AT1015D7D4F2BE7E4E412BBF4AB05C8A5DB585.XLS\" rel=\"nofollow noreferrer\">http://rbidocs.rbi.org.in/rdocs/ATM/DOCs/AT1015D7D4F2BE7E4E412BBF4AB05C8A5DB585.XLS</a></p>\n\n<p>It is public document and it can be easily downloaded using browser but I am not able to get it work in Excel VBA.</p>\n\n<p>Here is the page containing the link\n<a href=\"https://m.rbi.org.in/Scripts/ATMView.aspx\" rel=\"nofollow noreferrer\">https://m.rbi.org.in/Scripts/ATMView.aspx</a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1453301063, "last_edit_date": 1453301063, "creation_date": 1453294609, "answer_id": 34900685, "question_id": 34900287, "link": "https://stackoverflow.com/questions/34900287/leading-and-trailing-spaces/34900685#34900685", "title": "Leading and Trailing Spaces", "body": "<p>Well, adjust your routine to not include the tab for new entries.</p>\n\n<p>The old entries you can adjust with <em>Replace</em>:</p>\n\n<pre><code>NewValue = Replace([OldValue], Chr(9), \"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1453296756, "post_id": 34901421, "comment_id": 57538940, "body": "The inbuilt VBA-<code>Trim()</code> only trims spaces, not TAB characters. You&#39;d have to build your own function to also remove TABs."}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1453296632, "creation_date": 1453296632, "answer_id": 34901421, "question_id": 34900287, "link": "https://stackoverflow.com/questions/34900287/leading-and-trailing-spaces/34901421#34901421", "title": "Leading and Trailing Spaces", "body": "<p>I'd use the <a href=\"http://www.techonthenet.com/excel/formulas/trim.php\" rel=\"nofollow\">Trim()</a> function here.  Although the link is for Excel, it's the same syntax in Access.</p>\n\n<p>Use this function when you write the value to the table, and you can use this function to clean up your current data as well.  This should remove phantom tabs, as well as spaces.</p>\n"}, {"tags": [], "owner": {"reputation": 639, "user_id": 4598964, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10153689452664899/picture?type=large", "display_name": "Dave B", "link": "https://stackoverflow.com/users/4598964/dave-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1453297315, "creation_date": 1453297315, "answer_id": 34901685, "question_id": 34900287, "link": "https://stackoverflow.com/questions/34900287/leading-and-trailing-spaces/34901685#34901685", "title": "Leading and Trailing Spaces", "body": "<p>Thanks for the tips. I found this function and added in a couple of items to suit my needs.</p>\n\n<pre><code>' Strip Illegal Characters\n' http://www.utteraccess.com/wiki/index.php/Strip_Illegal_Characters\n' Code courtesy of UtterAccess Wiki\n' Licensed under Creative Commons License\n' http://creativecommons.org/licenses/by-sa/3.0/\n'\n' You are free to use this code in any application,\n' provided this notice is left unchanged.\n'\n' rev  date                          brief descripton\n' 1.0  2010-10-23                    Writing files to disk that contain illegal file characters can cause sometimes obscure error message(s)\n'\nPublic Function fStripIllegal(strCheck As String, Optional strReplaceWith As String = \"\") As String\n\nOn Error GoTo StripIllErr\n'illegal file name characters included in default string are    ? [ ] / \\ = + &lt; &gt; :; * \" , '\n\nDim intI As Integer\nDim intPassedString As Integer\nDim intCheckString As Integer\nDim strChar As String\nDim strIllegalChars As String\nDim intReplaceLen As Integer\n\nIf IsNull(strCheck) Then Exit Function\n\nstrIllegalChars = \"?[]/\\=+&lt;&gt;:;,*\" &amp; Chr(34) &amp; Chr(39) &amp; Chr(32) &amp; Chr(9)  'add/remove characters you need removed to this string\n\nintPassedString = Len(strCheck)\nintCheckString = Len(strIllegalChars)\n\nintReplaceLen = Len(strReplaceWith)\n\nIf intReplaceLen &gt; 0 Then   'a character has been entered to use as the replacement character\n\n   If intReplaceLen = 1 Then   'check the character itself isn't an illegal character\n\n       If InStr(strIllegalChars, strReplaceWith) &gt; 0 Then\n           MsgBox \"You can't replace an illegal character with another illegal character\", _\n                  vbOKOnly + vbExclamation, \"Invalid Character\"\n           fStripIllegal = strCheck\n           Exit Function\n       End If\n\n   Else   'only one replacement character allowed\n\n       MsgBox \"Only one character is allowed as a replacement character\", _\n              vbOKOnly + vbExclamation, \"Invalid Replacement String\"\n       fStripIllegal = strCheck\n       Exit Function\n\n   End If\nEnd If\n\nIf intPassedString &lt; intCheckString Then\n\n   For intI = 1 To intCheckString\n       strChar = Mid(strIllegalChars, intI, 1)\n       If InStr(strCheck, strChar) &gt; 0 Then\n           strCheck = Replace(strCheck, strChar, strReplaceWith)\n       End If\n   Next intI\n\nElse\n\n   For intI = 1 To intPassedString\n       strChar = Mid(strIllegalChars, intI, 1)\n       If InStr(strCheck, strChar) &gt; 0 Then\n           strCheck = Replace(strCheck, strChar, strReplaceWith)\n       End If\n   Next intI\n\nEnd If\n\nfStripIllegal = Trim(strCheck)\n\nStripIllErrExit:\nExit Function\n\nStripIllErr:\nMsgBox \"The following error occured: \" &amp; err.Number &amp; vbCrLf _\n    &amp; err.Description, vbOKOnly + vbExclamation, \"Unexpected Error\"\n\nfStripIllegal = strCheck\n\nResume StripIllErrExit\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 639, "user_id": 4598964, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10153689452664899/picture?type=large", "display_name": "Dave B", "link": "https://stackoverflow.com/users/4598964/dave-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 34901685, "answer_count": 3, "score": 0, "last_activity_date": 1453301063, "creation_date": 1453293435, "last_edit_date": 1453296306, "question_id": 34900287, "link": "https://stackoverflow.com/questions/34900287/leading-and-trailing-spaces", "title": "Leading and Trailing Spaces", "body": "<p>I've come up with a bit of a weird situation. I have a string that was entered into a form from a webpage. I noticed that the string wasn't behaving as expected when I was trying to apply a filter.</p>\n\n<p>The crux of the matter is depending on how I view the string it appears differently.</p>\n\n<pre><code>Form View - \"523548\"\nDatasheet View - \"  523548\"\nRaw Sql - \" 523548\"\n</code></pre>\n\n<p>Actually, when I view the datasheet value it appears as <code>\"523548 \"</code> but copies as <code>\"    523548\"</code>.</p>\n\n<p>Asc(Left(string),1) tells me the first character is Chr9 (Tab Key)</p>\n\n<p>I am really stuck to find out why this is happening or more importantly, what I can do to correct it. </p>\n\n<p>Thanks!</p>\n\n<p>Dave. </p>\n"}, {"tags": ["vba", "excel", "pdf"], "owner": {"reputation": 11, "user_id": 5815662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6ccff36b3f296a70a7025d12d1a94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/5815662/chris-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453291823, "creation_date": 1453291823, "question_id": 34899722, "link": "https://stackoverflow.com/questions/34899722/google-search-to-pdf-using-excel-vba", "title": "Google search to PDF using Excel VBA", "body": "<p>I'm trying to write VBA code to automate the process of running Google searches against specific topics and saving the first two pages of results as a PDF. </p>\n\n<p>I'm new to coding and so any help would be massively appreciated. The steps I think I need to follow are:</p>\n\n<ol>\n<li>Set up a loop which iterates through a list of search items (likely listed down column A in excel)</li>\n<li>For each item in the list:\n\n<ul>\n<li>Open up Internet Explorer (in the background without opening on screen)</li>\n<li>Search for the item in Google</li>\n<li>Wait for the page to fully load</li>\n<li>Export the first page of results as a PDF (to a hard-coded location)</li>\n<li>Move to the second page of Google results</li>\n<li>Wait for the page to fully load</li>\n<li>Export the second page of results as a PDF</li>\n<li>Quit the Internet Explorer application</li>\n</ul></li>\n<li>Move to the next item in the list and repeat the above</li>\n</ol>\n\n<p>I've created the module which opens up Internet Explorer using the following, but I'm struggling with the loop and export to PDF components:</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\nIE.Navigate \"http://www.google.com.au/search?hl=en&amp;q=testing&amp;meta=\"\nIE.Visible = False\nDo Until IE.ReadyState = READYSTATE_COMPLETE\n</code></pre>\n\n<p>In terms of exporting to PDF I've got software called PDFCreator which is what I'll need to use for the PDF export.</p>\n\n<p>Any ideas on whether the above is possible? Many thanks.</p>\n"}, {"tags": ["vba", "libreoffice", "libreoffice-calc"], "answers": [{"tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1453293325, "creation_date": 1453293325, "answer_id": 34900257, "question_id": 34899692, "link": "https://stackoverflow.com/questions/34899692/libre-office-clearing-a-range/34900257#34900257", "title": "Libre Office, Clearing a Range", "body": "<p>The code you are looking for is in <a href=\"http://www.pitonyak.org/oo.php\" rel=\"nofollow\">Andrew Pitonyak's macro document</a>, section <code>6.4. Clear a cell</code>.  Notice that the code works for multiple cells as well:</p>\n\n<blockquote>\n  <p>REM You can use a range such as \"A1:B2\"</p>\n</blockquote>\n\n<p>Macro recordings are not a good way to learn how to write macros.  They generate dispatcher code, which is different from working with the UNO API.</p>\n"}], "owner": {"reputation": 138, "user_id": 4094557, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/1345833722/picture?type=large", "display_name": "Uro\u0161 Grum", "link": "https://stackoverflow.com/users/4094557/uro%c5%a1-grum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "accepted_answer_id": 34900257, "answer_count": 1, "score": 0, "last_activity_date": 1453293325, "creation_date": 1453291749, "question_id": 34899692, "link": "https://stackoverflow.com/questions/34899692/libre-office-clearing-a-range", "title": "Libre Office, Clearing a Range", "body": "<p>I have been looking online to get the idea how to acess a range and then \"clearing\" it. Sadly even though i have found several solutions, vba in libre office makes things really complicated to understand. I have tried to record a macro, and edit it... It works but not as i want it to. I need to execute the below code from a Form (Dialog) and it does what its meant to, but shows everything in the background and I can't have that .... is there a way, to do this ? for example in vba Exel I would just write :</p>\n\n<pre><code>Range(\"A1:DA25000\").ClearContents (or .Delete)\n</code></pre>\n\n<p>Here is what I got with macro recordings:</p>\n\n<pre><code>Function Brisanje()\n\ndim document   as object\ndim dispatcher as object\n\ndocument   = ThisComponent.CurrentController.Frame\ndispatcher = createUnoService(\"com.sun.star.frame.DispatchHelper\")\n\ndim args1(0) as new com.sun.star.beans.PropertyValue\nargs1(0).Name = \"Nr\"\nargs1(0).Value = 2\n\ndispatcher.executeDispatch(document, \".uno:JumpToTable\", \"\", 0, args1())\n\ndim args2(0) as new com.sun.star.beans.PropertyValue\nargs2(0).Name = \"ToPoint\"\nargs2(0).Value = \"$A$1:$DA$25000\"\n\ndispatcher.executeDispatch(document, \".uno:GoToCell\", \"\", 0, args2())\n\ndispatcher.executeDispatch(document, \".uno:ClearContents\", \"\", 0, Array())\n\nend Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 3604444, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3MNr7.jpg?s=128&g=1", "display_name": "Stefan Eike", "link": "https://stackoverflow.com/users/3604444/stefan-eike"}, "edited": false, "score": 0, "creation_date": 1453369794, "post_id": 34904622, "comment_id": 57574450, "body": "I still could not add a red layer, but <code>inShape.PictureFormat.ColorType = msoPictureWatermark</code> works for me."}], "tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": true, "score": 0, "last_activity_date": 1453307873, "last_edit_date": 1453307873, "creation_date": 1453305290, "answer_id": 34904622, "question_id": 34899488, "link": "https://stackoverflow.com/questions/34899488/how-to-colorize-an-image-with-a-macro-in-ms-word-2010/34904622#34904622", "title": "How to colorize an image with a macro in MS Word 2010", "body": "<p>This worked for me</p>\n\n<pre><code>Dim inShape As InlineShape\n    Set inShape = Selection.InlineShapes(1)\n    inShape.LockAspectRatio = msoCTrue\n       inShape.PictureFormat.ColorType = msoPictureGrayscale\n    'equals 16cm\n    inShape.Width = \"453,9\"\n</code></pre>\n\n<p>you can play with <code>ColorType</code>\nI think <code>inShape.PictureFormat.ColorType = msoPictureWatermark</code> will suit your need</p>\n"}], "owner": {"reputation": 1059, "user_id": 3604444, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3MNr7.jpg?s=128&g=1", "display_name": "Stefan Eike", "link": "https://stackoverflow.com/users/3604444/stefan-eike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 34904622, "answer_count": 1, "score": 0, "last_activity_date": 1453307873, "creation_date": 1453291264, "question_id": 34899488, "link": "https://stackoverflow.com/questions/34899488/how-to-colorize-an-image-with-a-macro-in-ms-word-2010", "title": "How to colorize an image with a macro in MS Word 2010", "body": "<p>I'd like to addionaly put a slightly red transparent layer on an image in Word to indicate, that it should be deleted, because the change bar (when using the change tracking) is mostely overlooked.</p>\n\n<p>So far so good, I can format the selected image:</p>\n\n<pre><code>Sub FormatPicture()\n\n    Dim inShape As InlineShape\n    Set inShape = Selection.InlineShapes(1)\n\n    inShape.LockAspectRatio = msoCTrue\n    'equals 16cm\n    inShape.Width = \"453,9\"\n\nEnd Sub\n</code></pre>\n\n<p>But how can I colorize the image?</p>\n"}, {"tags": ["excel", "vba", "format", "cells"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5497911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3514dce1efb5124f45407d6508099c95?s=128&d=identicon&r=PG&f=1", "display_name": "Homo Sapiens", "link": "https://stackoverflow.com/users/5497911/homo-sapiens"}, "edited": false, "score": 0, "creation_date": 1453300164, "post_id": 34902290, "comment_id": 57541436, "body": "Exactly what I was looking for, thanks a lot! Solved my problem."}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": true, "score": 0, "last_activity_date": 1453298957, "creation_date": 1453298957, "answer_id": 34902290, "question_id": 34899376, "link": "https://stackoverflow.com/questions/34899376/excel-creating-conditionally-format-cells-based-on-formatted-cells-in-another/34902290#34902290", "title": "EXCEL - Creating conditionally format cells based on formatted cells in another sheets", "body": "<p>Pragmatically it is possible. If you are trying to implement it using the Excel front end features, Here is what i have tried and it worked for me. Check if it is any ways useful. I have crated a rule on Link2. If the Sheet2-A1 value is greater than 10, Link2 will highlight in red.\n<a href=\"https://i.stack.imgur.com/urgln.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/urgln.png\" alt=\"Conditional format rule\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 5497911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3514dce1efb5124f45407d6508099c95?s=128&d=identicon&r=PG&f=1", "display_name": "Homo Sapiens", "link": "https://stackoverflow.com/users/5497911/homo-sapiens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 34902290, "answer_count": 1, "score": 0, "last_activity_date": 1453298957, "creation_date": 1453290972, "question_id": 34899376, "link": "https://stackoverflow.com/questions/34899376/excel-creating-conditionally-format-cells-based-on-formatted-cells-in-another", "title": "EXCEL - Creating conditionally format cells based on formatted cells in another sheets", "body": "<p>I have an Excel spreadsheet with 5 worksheets. The first worksheet is build like a mainmenu, which contains hyperlinks to the 4 other worksheets. The 4 other worksheets are containing conditionally formatted cells. Is it possible, to create conditionally formatted cells for each worksheet in the main menu / Sheet 1, which are getting red if something is formatted red in the specific worksheet? I've searched around the internet but no one has got a familiar problem, because I want to use more worksheets.</p>\n\n<p>You can imagine it like this:</p>\n\n<h2>Sheet 1 / Menu</h2>\n\n<pre><code>       A                                      B\n</code></pre>\n\n<p>Link to Sheet 2 ------------------- Cell Lights up, if something is wrong in Sheet 2</p>\n\n<p>Link to Sheet 3 ------------------- Cell Lights up, if something is wrong in Sheet 3</p>\n\n<h2>Sheet 2</h2>\n\n<pre><code>           A                           B\n</code></pre>\n\n<p>Cell Lights Up If Bigger Than B1 --------- Number</p>\n\n<p>Cell Lights Up If Same Value like B2 ------ Text</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1655, "user_id": 3493587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b29d44004eaedbc859bad8144bade93?s=128&d=identicon&r=PG&f=1", "display_name": "mikedu95", "link": "https://stackoverflow.com/users/3493587/mikedu95"}, "edited": false, "score": 0, "creation_date": 1453288985, "post_id": 34898629, "comment_id": 57533781, "body": "What&#39;s the relation to C++ and VB.NET ?"}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "reply_to_user": {"reputation": 1655, "user_id": 3493587, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b29d44004eaedbc859bad8144bade93?s=128&d=identicon&r=PG&f=1", "display_name": "mikedu95", "link": "https://stackoverflow.com/users/3493587/mikedu95"}, "edited": false, "score": 0, "creation_date": 1453289064, "post_id": 34898629, "comment_id": 57533840, "body": "my bad sorry, just autoclicked the tags :("}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1453289461, "post_id": 34898629, "comment_id": 57534127, "body": "What line is the error occurring on?"}, {"owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 0, "creation_date": 1453289597, "post_id": 34898629, "comment_id": 57534199, "body": "Line 63: Set wordDoc = appWord.Documents.Open(Application.GetOpenFilename(&quot;Word-Dat&zwnj;&#8203;eien (<i>.doc;</i>.docx;),<i>.doc;</i>.docx&quot;))    Thats where Debugging stops, but 456 is still printed into the console"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1453291069, "post_id": 34898629, "comment_id": 57535106, "body": "I think your trouble lies with <code>Application.GetOpenFilename</code> - what is Application? - It is unspecified, i.e. since this is Excel-VBA it refers to the parent Application that hosts the VBA..."}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 5816366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b52aaf74a5117eb484396ec50234b4?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnT", "link": "https://stackoverflow.com/users/5816366/eamonnt"}, "reply_to_user": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "edited": false, "score": 1, "creation_date": 1453302962, "post_id": 34903308, "comment_id": 57543495, "body": "No problem! I strongly recommend you use break points(left click on the grey strip next to your code) to find errors like these. Put one at the last line which you know works, then step along with F8 until you encounter the error."}], "tags": [], "owner": {"reputation": 56, "user_id": 5816366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b52aaf74a5117eb484396ec50234b4?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnT", "link": "https://stackoverflow.com/users/5816366/eamonnt"}, "is_accepted": true, "score": 1, "last_activity_date": 1453301691, "creation_date": 1453301691, "answer_id": 34903308, "question_id": 34898629, "link": "https://stackoverflow.com/questions/34898629/implement-excel-data-into-existing-word-document-with-vba/34903308#34903308", "title": "Implement Excel Data into existing Word Document with VBA", "body": "<p>Your problem is with the line:</p>\n\n<pre><code>objSheets.Range(Columns(2), Columns(4)).Delete\n</code></pre>\n\n<p>You need to specify where the columns are, e.g.</p>\n\n<pre><code>objSheets.Range(objSheets.Columns(2), objSheets.Columns(4)).Delete\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 47, "user_id": 5134523, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2fd79616da9baac5f559dd4535a52a10?s=128&d=identicon&r=PG&f=1", "display_name": "ndslr", "link": "https://stackoverflow.com/users/5134523/ndslr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 34903308, "answer_count": 1, "score": 1, "last_activity_date": 1453301691, "creation_date": 1453288838, "last_edit_date": 1453289072, "question_id": 34898629, "link": "https://stackoverflow.com/questions/34898629/implement-excel-data-into-existing-word-document-with-vba", "title": "Implement Excel Data into existing Word Document with VBA", "body": "<p>i currently have the problem that everytime im trying to open a word document via vba/excel im getting an Application/Object Error. My Idea is that im trying to compare data from two tables and deleting the bad results. After that i want to insert the whole table to the existing word document what im selecting from the selection/opening window.</p>\n\n<p>My Code</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n\nDim varDatei As Variant\nDim wordDatei As Variant\nDim objExcel As New Excel.Application\nDim objSheet As Object\nDim wordDoc As Object\nDim extBereich As Variant\nDim intBereich As Variant\n\nDim appWord As Object\n\nSet intBereich = ThisWorkbook.Sheets(1).Range(\"A4:A11\")\n\nDim loopStr As Variant\nDim loopStr2 As Variant\nDim found() As Variant\nDim loopInt As Integer\nDim endStr As Variant\n\nDim extBereich2 As Variant\n\nloopInt = 1\nvarDatei = Application.GetOpenFilename(\"Excel-Dateien (*.xlsx), *.xlsx\")\n\nIf varDatei &lt;&gt; False Then\n    objExcel.Workbooks.Open varDatei\n    Set objSheets = objExcel.Sheets(1)\n    objSheets.Activate\n    LetzteZeile = objSheets.Cells(objSheets.Rows.Count, 3).End(xlUp).Row\n    Set extBereich = objSheets.Range(\"B3:B\" &amp; LetzteZeile)\n\n    ReDim found(1 To LetzteZeile)\n    For Each loopStr In extBereich\n        objSheets.Range(\"F\" &amp; loopStr.Row) = \"Good\"\n        objSheets.Cells(loopStr.Row, 6).Interior.ColorIndex = 4\n        For Each loopStr2 In intBereich\n            If (StrComp(loopStr, loopStr2, vbBinaryCompare) = 0) = True Then\n                found(loopInt) = objSheets.Range(\"A\" &amp; loopStr.Row)\n                loopInt = loopInt + 1\n                objSheets.Cells(loopStr.Row, 6) = \"Bad\"\n                objSheets.Cells(loopStr.Row, 6).Interior.ColorIndex = 3\n                Exit For\n            End If\n        Next loopStr2\n    Next loopStr\n    loopStr = \"\"\n    If (loopInt &lt;&gt; 1) Then\n        endStr = \"This is bad:\" &amp; vbLf\n        For Each loopStr In found\n        If (Trim(loopStr &amp; vbNullString) &lt;&gt; vbNullString) Then\n            endStr = endStr &amp; loopStr &amp; vbLf\n        End If\n        Next loopStr\n        MsgBox (endStr)\n    Else\n        MsgBox (\"Everythings good\")\n    End If\n    Set appWord = CreateObject(\"Word.Application\")\n    appWord.DisplayAlerts = False\n    Debug.Print (\"123\")\n    Set wordDoc = appWord.Documents.Open(Application.GetOpenFilename(\"Word-Dateien (*.doc;*.docx;),*.doc;*.docx\"))\n    wordDoc.Activate\n    Debug.Print (\"456\")\n    loopStr = \"\"\n    For Each loopStr In extBereich\n        If (objSheets.Cells(loopStr.Row, 6).Interior.ColorIndex = 3) Then\n            objSheets.Range(\"A\" &amp; loopStr.Row &amp; \":\" &amp; \"E\" &amp; loopStr.Row).Delete\n        End If\n    Next loopStr\n    objSheets.Range(Columns(2), Columns(4)).Delete\n    objSheets.Range(\"A3:B\" &amp; LetzteZeile).Copy\n    appWord.Documents(1).Range.Paste\n    With appWord.Documents(1).Tables(1)\n        .Columns.AutoFit\n    End With\n    appWord.PrintOut\n    objExcel.Quit\n    appWord.Quit\n    Set appWord = Nothing\n    Set objExcel = Nothing\n    Debug.Print loopInt\n\n\nElse\n    MsgBox \"Error\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Maybe someone of you knew whats the problem?</p>\n\n<p>Error Code is 1004 - Application- or object Error</p>\n\n<p>With best regards and thanks for answering</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1453292407, "last_edit_date": 1453292407, "creation_date": 1453292099, "answer_id": 34899823, "question_id": 34898574, "link": "https://stackoverflow.com/questions/34898574/open-the-most-recent-folder-in-a-directory/34899823#34899823", "title": "Open the most recent folder in a directory", "body": "<p>You try to run <code>\"explorer.exeC:\\WHATEVER\"</code> i.e. your missing a space between the executable and its argument. \n<br>Quotes are a good idea to accommodate paths with spaces.</p>\n\n<pre><code>Shell \"explorer.exe\" &amp; \" \"\"\" &amp; strFullFldrPath &amp; \"\"\", vbNormalFocus\n</code></pre>\n\n<p>What you have does not <em>guarantee</em> the latest folder is always first, you should apply some logic based on the name or load all directories and sort.</p>\n"}], "owner": {"reputation": 21, "user_id": 5806351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3253bb67620dbd634b6c9a58797609?s=128&d=identicon&r=PG&f=1", "display_name": "Hannah", "link": "https://stackoverflow.com/users/5806351/hannah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1089, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453292407, "creation_date": 1453288684, "last_edit_date": 1531164843, "question_id": 34898574, "link": "https://stackoverflow.com/questions/34898574/open-the-most-recent-folder-in-a-directory", "title": "Open the most recent folder in a directory", "body": "<p>I'm trying to create a script that will open the latest folder in a directory. </p>\n\n<p>The name of the folder will be different each month (01-Jan, 02-Feb e.t.c). The below seems to find the latest folder, but I get error File not found when I add in Shell \"explorer.exe\" &amp; \"\" &amp; strFullFldrPath, vbNormalFocus to open the folder.</p>\n\n<p>This is what I have so far.</p>\n\n<pre><code>Sub GetLatestFolder()\n\nDim fso As FileSystemObject\nDim fldrRoot As Folder\nDim SubFld As Folder\n\nDim strFolderName As String\nDim strFullFldrPath As String\n\n\nSet fso = New FileSystemObject\nSet fldrRoot = fso.GetFolder(\"\\\\Hbeu.adroot.hsbc\\dfsroot\\GB002\\RRU\\DTCC EU Reports\\ETD\\\")\n\nFor Each SubFld In fldrRoot.SubFolders\nstrFolderName = SubFld.Name\nstrFullFldrPath = fldrRoot &amp; \"\\\" &amp; SubFld.Name\n\nShell \"explorer.exe\" &amp; \"\" &amp; strFullFldrPath, vbNormalFocus\n    Exit For\nNext SubFld\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1453288837, "post_id": 34898428, "comment_id": 57533662, "body": "can you not switch off protection, do the changes and apply protection back?"}, {"owner": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "reply_to_user": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1453361488, "post_id": 34898428, "comment_id": 57569791, "body": "no, I need the excel sheet to stand by itself, as it will be shared but I don&#39;t want to keep monitoring it."}, {"owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1453369675, "post_id": 34898428, "comment_id": 57574360, "body": "but you can do it in the code - unprotect, change values, protect again; there is a tiny chance that someone will Ctrl-Break during the execution, but the chances are small"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "edited": false, "score": 0, "creation_date": 1453361336, "post_id": 34899257, "comment_id": 57569713, "body": "try to protect something like from (A:C) and set column D as unlocked. After running the code it will not lock column D.    Please note that I also tried your code and got type mismatch error.  thank you."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1453290563, "creation_date": 1453290563, "answer_id": 34899257, "question_id": 34898428, "link": "https://stackoverflow.com/questions/34898428/lock-cell-in-excel-vba/34899257#34899257", "title": "Lock Cell in Excel VBA", "body": "<p>Appears to work when I tested it - could it be that it isn't protecting each sheet, just the first sheet that meets the test.  So, in February <code>If Date &gt;= DateSerial(2016, 1, 19)</code> will be TRUE, so it'll protect January again and exit the procedure - it'll never even look at the FEB sheet.</p>\n\n<p>I'm assuming the January date should be 31 rather than 19.</p>\n\n<p>Try:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Dim wrkSht As Worksheet\n    Dim dSheet As Date\n\n    'Look at each sheet.\n    For Each wrkSht In ThisWorkbook.Worksheets\n        'Create first of month date from sheet name.\n        dSheet = CDate(\"1-\" &amp; wrkSht.Name &amp; \"-\" &amp; Year(dSheet))\n        'Calculate last day of month (day zero of the following month).\n        dSheet = DateSerial(Year(dSheet), Month(dSheet) + 1, 0)\n\n        'Check the date against todays date and protect.\n        If Date &gt;= dSheet Then\n            wrkSht.Protect Password:=\"123\"\n        End If\n\n    Next wrkSht\n\nEnd Sub\n</code></pre>\n\n<p>To test change <code>dSheet = CDate(\"1-\" &amp; wrkSht.Name &amp; \"-\" &amp; Year(dSheet))</code> to <code>dSheet = CDate(\"1-\" &amp; wrkSht.Name &amp; \"-\" &amp; 2015)</code></p>\n"}], "owner": {"reputation": 115, "user_id": 1203121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40bb29f2d384dfd64e39a65e5d347644?s=128&d=identicon&r=PG", "display_name": "1990Mustafa", "link": "https://stackoverflow.com/users/1203121/1990mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 34899257, "answer_count": 1, "score": 1, "last_activity_date": 1453292080, "creation_date": 1453288223, "last_edit_date": 1453292080, "question_id": 34898428, "link": "https://stackoverflow.com/questions/34898428/lock-cell-in-excel-vba", "title": "Lock Cell in Excel VBA", "body": "<p>The code below doesn't work when I have my workbook protected (it does work when nothing is protected). What I am trying to do is having a workbook and sheets protected except for few cells and after a specific data I want all cells to be protected, please help.</p>\n\n<pre><code>Sub Workbook_Open()\n\n    If Date &gt;= DateSerial(2016, 1, 19) Then\n       Worksheets(\"Jan\").Protect Password:=\"123\"\n\n    ElseIf Date &gt;= DateSerial(2016, 2, 28) Then\n       Worksheets(\"FEB\").Protect Password:=\"123\"\n\n    ElseIf Date &gt;= DateSerial(2016, 3, 31) Then\n       Worksheets(\"MAR\").Protect Password:=\"123\"\n\n    ElseIf Date &gt;= DateSerial(2016, 4, 30) Then\n       Worksheets(\"Apr\").Protect Password:=\"123\"\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2779747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/118cb62a26e931808f6afe12e4a64a30?s=128&d=identicon&r=PG&f=1", "display_name": "Rom M", "link": "https://stackoverflow.com/users/2779747/rom-m"}, "edited": false, "score": 0, "creation_date": 1453292324, "post_id": 34898003, "comment_id": 57536008, "body": "Hi,  Thanks for your reply,  Basically this line is the function Goal Seek:  Range(Cells((i), &quot;P&quot;)).GoalSeek Goal:=0, ChangingCell:=Range(Cells((i), &quot;J&quot;))  For a simple cell it is like this: Range(&quot;P2&quot;).GoalSeek Goal:=0, ChangingCell:=Range(&quot;J2&quot;) And for a simple cell the code works.  I don&#39;t want to set the value to 1. I want to use the Goal Seek function that changes a cell (variable) until the target cell (a function) reach a certain value (here 0) by iterations."}], "tags": [], "owner": {"reputation": 4530, "user_id": 1167012, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/QDCsM.png?s=128&g=1", "display_name": "Sven Rojek", "link": "https://stackoverflow.com/users/1167012/sven-rojek"}, "is_accepted": true, "score": 1, "last_activity_date": 1453306939, "last_edit_date": 1453306939, "creation_date": 1453287177, "answer_id": 34898003, "question_id": 34897910, "link": "https://stackoverflow.com/questions/34897910/vba-goalseek-loop-issue/34898003#34898003", "title": "VBA GoalSeek Loop Issue", "body": "<p>You can use <em>Cells</em> without <em>Range</em>. Here is an working example. Make sure cell <code>N</code>contains an integer and P<em>i</em> to P<em>N</em> contains formulas.</p>\n\n<pre><code>Sub GoalSeekTest()\n\nDim N As Integer\nDim i As Integer\n\nN = ThisWorkbook.Sheets(\"Reverse DCF\").Range(\"D1\").Value\n\n    For i = 2 To N\n        If Cells(i, \"P\").HasFormula Then\n            'Messagebox for clarification\n            MsgBox (\"Formula cell: \" &amp; Cells(i, \"P\") _\n                .Address(RowAbsolute:=False, ColumnAbsolute:=False))\n\n            Cells((i), \"P\").GoalSeek Goal:=0, ChangingCell:=Cells((i), \"J\")\n        Else\n            MsgBox \"Cell \" &amp; Cells(i, 1) _\n                .Address(RowAbsolute:=False, ColumnAbsolute:=False) _\n                &amp; \" has no formula - skipping this cell!\", _\n                vbCritical, \"Formula required!\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 2779747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/118cb62a26e931808f6afe12e4a64a30?s=128&d=identicon&r=PG&f=1", "display_name": "Rom M", "link": "https://stackoverflow.com/users/2779747/rom-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 0, "accepted_answer_id": 34898003, "answer_count": 1, "score": 3, "last_activity_date": 1536111087, "creation_date": 1453286949, "last_edit_date": 1536111087, "question_id": 34897910, "link": "https://stackoverflow.com/questions/34897910/vba-goalseek-loop-issue", "title": "VBA GoalSeek Loop Issue", "body": "<p>I am a novice regarding VBA and in my first code I try to make a loop through 2 columns (P and J) for a GoalSeek function.</p>\n\n<p>The set cells are P2 then P3 then P4 etc.\nWhile the change cells are J2 then J3 etc.</p>\n\n<p>I want to iterate from row 2 till row N (the number N is stored in the cell D1)</p>\n\n<p>Here's what I wrote:</p>\n\n<pre><code>N = ThisWorkbook.Sheets(\"Reverse DCF\").Range(\"D1\").Value\n\nDim i As Integer\n\nFor i = 2 To N\n     Range(Cells((i), \"P\")).GoalSeek Goal:=0, ChangingCell:=Range(Cells((i), \"J\"))\nNext i\n</code></pre>\n\n<p>I get an error message:</p>\n\n<pre><code> \"Method 'Range' of object '_Global' failed.\n</code></pre>\n\n<p>I am sorry but I don't see the problem with my code.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1453287358, "creation_date": 1453287358, "answer_id": 34898081, "question_id": 34897832, "link": "https://stackoverflow.com/questions/34897832/filter-off-duplicates-in-vba/34898081#34898081", "title": "Filter off Duplicates in VBA", "body": "<p>Try this.</p>\n\n<pre><code> Columns(\"A:A\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\n    Columns(\"A:A\"), Unique:=True\n</code></pre>\n\n<p>If you want the Filtered values in separate column. Try</p>\n\n<pre><code>  Columns(\"A:A\").Select\n  Columns(\"A:A\").AdvancedFilter Action:=xlFilterCopy,    CriteriaRange:=Columns( _\n            \"A:A\"), CopyToRange:=Range(\"C1\"), Unique:=True\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453287358, "creation_date": 1453286697, "question_id": 34897832, "link": "https://stackoverflow.com/questions/34897832/filter-off-duplicates-in-vba", "title": "Filter off Duplicates in VBA", "body": "<p>I want to filter off the Duplicates in VBA. I know there is a method called RemoveDuplicates</p>\n\n<pre><code>Columns(ColumnNumber).RemoveDuplicates Columns:=Array(1) \n</code></pre>\n\n<p>This method deletes the duplicates whereas I want to filter off the duplicates only. How do I do it? </p>\n\n<p>Need some guidance on this.</p>\n"}, {"tags": ["excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1453286357, "post_id": 34897356, "comment_id": 57531819, "body": "It may be something to do with <code>ScreenUpdating</code> I&#39;ve had issues with objects in the past due to this being turned off. I wonder if the excel view needs to update for the pdf to print with the changes correctly. Can you try commenting out the <code>ScreenUpdating</code> lines and try again"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1453286441, "post_id": 34897356, "comment_id": 57531880, "body": "Yes. I will test removing ScreenUpdating and let you know. Thanks."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1453286545, "post_id": 34897356, "comment_id": 57531957, "body": "No. Removing ScreenUpdating had no impact."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1453286733, "post_id": 34897356, "comment_id": 57532108, "body": "ok. Try putting <code>DoEvents</code> after the <code>ActiveSheet.ExportAsFixedFormat</code>"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1453286919, "post_id": 34897356, "comment_id": 57532249, "body": "I tried DoEvents after ActiveSheet.ExportAsFixedFormat within the loop, but same problem."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453288672, "post_id": 34897356, "comment_id": 57533557, "body": "Does the error occurs when you debug macro slowly by F8? Maybe things happens really too fast and you have to wait let&#39;s say a second before printing pdf."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453290651, "post_id": 34897356, "comment_id": 57534818, "body": "I&#39;m not sure how to debug the macro slowly. I have tried walking through the logic and testing a few alternate scenarios without any luck. How would I go about slowing the macro down further - say a second?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453290739, "post_id": 34897356, "comment_id": 57534875, "body": "When I test without Pdf it displays the last value in the combobox, but I suppose I am not sure if it is displaying each value through each iteration."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453293434, "post_id": 34897356, "comment_id": 57536762, "body": "You can press F8 to execute code line by line. Slowly, I mean don&#39;t press key and keep it pressed down ;)"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453296527, "post_id": 34897356, "comment_id": 57538762, "body": "When I run each line of code with F8 there is no issue. I suppose this would mean I need to slow the code processing down by delaying a second..."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453296776, "post_id": 34897356, "comment_id": 57538954, "body": "Great, I added a 10 second delay and this did not work either. Perhaps, there is a property I need to change on the combobox...or something else..."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453298586, "post_id": 34897356, "comment_id": 57540272, "body": "My last suggestion: add delay and delete <code>ScreenUpdating</code>. It is always turned off by default when you debug. Try to add delay in few places in code."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453298669, "post_id": 34897356, "comment_id": 57540344, "body": "Ok, I will try that. Thank you."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453298954, "post_id": 34897356, "comment_id": 57540531, "body": "It didn&#39;t work, but I am stumped."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1453299942, "post_id": 34897356, "comment_id": 57541264, "body": "Ok, I think I found the issue. The combobox property Locked was set to True. Setting Locked = False appears to have corrected my problem. Thanks!"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453285373, "creation_date": 1453285373, "last_edit_date": 1531161705, "question_id": 34897356, "link": "https://stackoverflow.com/questions/34897356/populate-a-combobox-value-in-a-loop", "title": "Populate a ComboBox value in a loop?", "body": "<p>Hi I am trying to run some code that assigns a combobox a value from a single cell in a range of cells and then executes some formulas on my worksheet and then finally prints a pdf of the output sheet. Everything seems to be working ok, except that the final pdf does not display the value I am running in the combobox (although the sheet calculations have been applied). It may be that my loop executes faster than my combobox can display the value. I'm not really sure. Below is my code:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim i As Long\nDim ws As Worksheet\nDim FileName As String\n\nSet ws = Sheets(\"Multi\")\nSet wsEE = Sheets(\"Employee\")\n\nFileName = ws.Range(\"B2\")\n\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 7 To LastRow\n\n        wsEE.ComboBox4.Value = ws.Range(\"A\" &amp; i)\n\n        wsEE.Activate\n        Application.Calculate\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, FileName:=ws.Range(\"B2\") &amp; \"TCC Analysis - \" &amp; ws.Range(\"A\" &amp; i) &amp; \".pdf\", _\n        Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False\n\n    Next i\n\nws.Activate\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I also have some code that runs on combobox change. I'm not sure if this could also be part of my problem. Here is that code:</p>\n\n<pre><code>Private Sub ComboBox4_Change()\n\nSheets(\"Employee\").Range(\"AZ1\") = ComboBox4.Value\n\nApplication.Calculate\n\nApplication.DisplayAlerts = False\n\nDim ws As Worksheet\nSet ws = Worksheets(\"Employee\")\n\nIf Me.ComboBox4 &lt;&gt; -1 Then\n    ws.Range(\"C72\").Value = ws.Range(\"C16\").Value\n    ws.Range(\"C73\").Value = ws.Range(\"C19\").Value\nEnd If\n\nApplication.Calculate\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Has anyone experienced this problem before? Does anyone have a solution they can provide? Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 804, "user_id": 5815149, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205099861329198/picture?type=large", "display_name": "J Brazier", "link": "https://stackoverflow.com/users/5815149/j-brazier"}, "reply_to_user": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "edited": false, "score": 0, "creation_date": 1453287883, "post_id": 34897202, "comment_id": 57532955, "body": "Thanks @DonkeyKong but the ability to let users edit cells isn&#39;t the problem, it&#39;s the selection; I need them to only be able to select a handful of cells, and then only edit a subset of those."}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 5815149, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205099861329198/picture?type=large", "display_name": "J Brazier", "link": "https://stackoverflow.com/users/5815149/j-brazier"}, "edited": false, "score": 0, "creation_date": 1453288005, "post_id": 34897482, "comment_id": 57533046, "body": "@kuhiy Thanks, but I don&#39;t understand what you&#39;re telling me to do."}], "tags": [], "owner": {"reputation": 4188, "user_id": 5815086, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b85c98d7f5aef61b7a5d181e8140903e?s=128&d=identicon&r=PG", "display_name": "kujiy", "link": "https://stackoverflow.com/users/5815086/kujiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1453285709, "creation_date": 1453285709, "answer_id": 34897482, "question_id": 34897202, "link": "https://stackoverflow.com/questions/34897202/excel-multiple-levels-of-protection/34897482#34897482", "title": "Excel: Multiple Levels of Protection", "body": "<p>Perhaps this helps you a little.\nTry this;</p>\n\n<ol>\n<li>Open your .xls(x) file</li>\n<li>Open VBA editer with pressing Alt+F11  </li>\n<li>W-click a sheet name and paste below;  </li>\n</ol>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Sub unprotect()\n    ActiveWorkbook.ActiveSheet.unprotect\nEnd Sub\nSub protect()\n    ActiveWorkbook.ActiveSheet.protect\nEnd Sub \n</code></pre>\n\n<ol>\n<li>Back to your sheet window and press Alt+F8 and execute subs.</li>\n</ol>\n"}], "owner": {"reputation": 804, "user_id": 5815149, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205099861329198/picture?type=large", "display_name": "J Brazier", "link": "https://stackoverflow.com/users/5815149/j-brazier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453285709, "creation_date": 1453284934, "question_id": 34897202, "link": "https://stackoverflow.com/questions/34897202/excel-multiple-levels-of-protection", "title": "Excel: Multiple Levels of Protection", "body": "<p>When protecting a sheet in Excel, the attached dialogue box appears, demonstrating the various possible protections that can be applied.\n<br><a href=\"http://i.stack.imgur.com/WjRAz.png\" rel=\"nofollow\">Excel protection dialogue</a>\n<br><br>I have three types of cells in my workbook:\n<br>a) Cells that I don't want the user to be able to select (the vast majority).\n<br>b) Those that I want the user to be able to select, but not to edit (just one or two).\n<br>c) Those that I want the user to select and edit (a few).\n<br><br>However I don't seem to be able to protect cells differently; it seems that you pick the rules once, and they then apply to all protected cells. Is there a way around this? Perhaps using VBA?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1453284524, "post_id": 34896834, "comment_id": 57530645, "body": "to give you a start ... first you need to decide on strategy: should A) the user always have a display of current status (incomplete / complete+wrong sum / complete+correct) or B) should this info be shown upon leaving this sheet or C) should info be shown on closing sheet (with or without saving) ... from this it depends which event triggers you choose to implement that check"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1453285533, "post_id": 34896834, "comment_id": 57531307, "body": "A simple way, <code>A2=IF(COUNT(A3:A7)&lt;&gt;5,&quot;Incomplete&quot;,SUM(A3:A7))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1453286090, "creation_date": 1453286090, "answer_id": 34897612, "question_id": 34896834, "link": "https://stackoverflow.com/questions/34896834/trying-to-find-code-to-force-users-not-to-leave-cells-unpopulated/34897612#34897612", "title": "trying to find code to force users not to leave cells unpopulated", "body": "<p>Here are 2 small functions checking if \"a range\" contains any empty cells and if sum of \"one range\" is equal to sum of \"another range\". I say this a bit abstract because your ranges may be larger tomorrow or in a different position and you may not want to recode your app time &amp; again.</p>\n\n<pre><code>Function IsFilled(TestRange As Range) As Boolean\nDim C As Range\n\n    IsFilled = True\n    For Each C In TestRange.Cells\n        If C = \"\" Then\n            IsFilled = False\n            Exit For\n        End If\n    Next C\nEnd Function\n\nFunction IsSum(TestRange As Range, TestSum As Range) As Boolean\n\n    IsSum = (Application.WorksheetFunction.Sum(TestRange) = Application.WorksheetFunction.Sum(TestSum))\n\nEnd Function\n</code></pre>\n\n<p>In your context, both functions must evaluate to <code>True</code> for user entry to be valid.</p>\n\n<p>Now you can</p>\n\n<ul>\n<li>enter these functions into two cells of your worksheet (e.g. <code>=isfilled(A2:A7)</code>, <code>=issum(A3:A7;A2)</code>) and tell users they have to work hard to make both <code>True</code></li>\n<li>evaluate the two results from above in any appropriate event <code>Sub()</code>, e.g. in a <code>Worksheet_Deactivate()</code>, <code>Workbook_BeforeSave()</code> (I prefer BeforeSave over BeforeClose as the user may want to escape w/o saving in which case I wouldn't need to validate)</li>\n<li>directly call and evaluate these two functions from an appropriate event without using them in the worksheet</li>\n<li>in any case the validating <code>Sub()</code> must terminate its default action and display a <code>MsgBox()</code> in case validation fails.</li>\n</ul>\n"}], "owner": {"reputation": 43, "user_id": 5794561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff18e155166411ba3b2495b097ec3cf?s=128&d=identicon&r=PG&f=1", "display_name": "fingermouse", "link": "https://stackoverflow.com/users/5794561/fingermouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453309702, "creation_date": 1453283891, "last_edit_date": 1531164843, "question_id": 34896834, "link": "https://stackoverflow.com/questions/34896834/trying-to-find-code-to-force-users-not-to-leave-cells-unpopulated", "title": "trying to find code to force users not to leave cells unpopulated", "body": "<p>Thanks Guys. I used the following code to get an error message to pop up if I attempt to save the sheet with one or more of the specified cells left blank. However, when I then go back and populate all the specified blank cells, and then save, I still get the error message. where am I going wrong? </p>\n\n<pre><code>Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nDim Cell As Range\nDim flag As Boolean\nflag = False\nIf Cells(1, 1) = \"\" Then flag = True\nFor Each Cell In Range(\"C9:C14\")\nIf Cell = \"\" Then\nflag = True\nExit For\nEnd If\nNext Cell\nFor Each Cell In Range(\"C18:C25\")\nIf Cell = \"\" Then\nflag = True\nExit For\nEnd If\nNext Cell\nFor Each Cell In Range(\"C30:E35\")\nIf Cell = \"\" Then\nflag = True\n  Exit For\nEnd If\nNext Cell\nCancel = flag\nIf flag Then MsgBox \"error message\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5813763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eacd42574beeec2ae4ac1b0530e68ff?s=128&d=identicon&r=PG&f=1", "display_name": "Amira", "link": "https://stackoverflow.com/users/5813763/amira"}, "reply_to_user": {"reputation": 14313, "user_id": 5104596, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5876f452293163fba2790c9996e1f812?s=128&d=identicon&r=PG&f=1", "display_name": "Pmpr", "link": "https://stackoverflow.com/users/5104596/pmpr"}, "edited": false, "score": 0, "creation_date": 1453284122, "post_id": 34896610, "comment_id": 57530366, "body": "@Trix my question is how do i make when i hit button search, two sub-form come out the output that i want. For example, i want to search apple. two sub-form will give me apple. Of course in both table have apple."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1453284639, "post_id": 34896610, "comment_id": 57530707, "body": "Please edit your question with the full, actual code. The code you posted doesn&#39;t compile, it will give the <code>Duplicate declaration in current scope</code> error."}, {"owner": {"reputation": 1, "user_id": 5813763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eacd42574beeec2ae4ac1b0530e68ff?s=128&d=identicon&r=PG&f=1", "display_name": "Amira", "link": "https://stackoverflow.com/users/5813763/amira"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1453337882, "post_id": 34896610, "comment_id": 57562496, "body": "@Andre Thanks... and how do i get the code to compile? I think ive missing the code somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "is_accepted": false, "score": 0, "last_activity_date": 1453736223, "creation_date": 1453736223, "answer_id": 34996410, "question_id": 34896610, "link": "https://stackoverflow.com/questions/34896610/using-one-command-button-search-button-to-open-two-sub-form-in-one-form-via-vb/34996410#34996410", "title": "Using one command button (search button) to open two sub-form in one form via VBA", "body": "<p>Wild guess here based on your incomplete question, but I think what you're after is</p>\n\n<pre><code> Private Sub Command15_Click()\n Dim mySiteID As String\n mySiteID = \"Select * from Access_FullSite where([Site ID] = '\" &amp; Me.Text27 &amp; \"')\"\n Me.Access_FullSite_subform.Form.RecordSource = mySiteID\n Me.Access_FullSite_subform.Form.Requery\n Me.Metro_CP_subform.Form.RecordSource = mySiteID\n Me.Metro_CP_subform.Form.Requery\n End Sub  \n</code></pre>\n\n<p>You don't need to re-declare (which will fail the compile) or set the variable to the same value.</p>\n"}], "owner": {"reputation": 1, "user_id": 5813763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eacd42574beeec2ae4ac1b0530e68ff?s=128&d=identicon&r=PG&f=1", "display_name": "Amira", "link": "https://stackoverflow.com/users/5813763/amira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453736223, "creation_date": 1453283322, "last_edit_date": 1453286598, "question_id": 34896610, "link": "https://stackoverflow.com/questions/34896610/using-one-command-button-search-button-to-open-two-sub-form-in-one-form-via-vb", "title": "Using one command button (search button) to open two sub-form in one form via VBA", "body": "<p>I have two table, one form and two sub-form. In the form, I have search button and the output must come out in two sub-forms. Only success to open 1 sub-form. The other sub-form does't change anything. All happen in one form. The question is how do i make when i hit button search, two sub-form come out the output that i want. For example, i want to search apple. two sub-form will give me apple. Of course in both table have apple.</p>\n\n<pre><code>Private Sub Command15_Click()\nDim mySiteID As String\nmySiteID = \"Select * from Access_FullSite where([Site ID] = '\" &amp; Me.Text27 &amp; \"')\"\nMe.Access_FullSite_subform.Form.RecordSource = mySiteID\nMe.Access_FullSite_subform.Form.Requery\n\nDim mySiteID As String\nmySiteID = \"Select * from Access_FullSite where([Site ID] = '\" &amp; Me.Text27 &amp; \"')\"\nMe.Metro_CP_subform.Form.RecordSource = mySiteID\nMe.Metro_CP_subform.Form.Requery\nEnd Sub  \n</code></pre>\n\n<p>Thanks for your help in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1453284379, "post_id": 34896596, "comment_id": 57530541, "body": "The second part of <a href=\"http://stackoverflow.com/a/7423252/2923617\">this</a> answer can help"}, {"owner": {"reputation": 279, "user_id": 2579685, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/538cdfae4c83af57db8b96d8df524656?s=128&d=identicon&r=PG", "display_name": "user2579685", "link": "https://stackoverflow.com/users/2579685/user2579685"}, "edited": false, "score": 0, "creation_date": 1453285137, "post_id": 34896596, "comment_id": 57531063, "body": "This may help too.... Range(Range(&quot;A1&quot;), Range(&quot;A1&quot;).EntireColumn.Cells(Rows.Count, 1).End(xlUp)).Select"}, {"owner": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1453289167, "post_id": 34896596, "comment_id": 57533927, "body": "tried but not working"}], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1453293596, "post_id": 34897344, "comment_id": 57536883, "body": "What happens precisely? I tested this on a simple workbook and it worked just fine for me."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1453285340, "creation_date": 1453285340, "answer_id": 34897344, "question_id": 34896596, "link": "https://stackoverflow.com/questions/34896596/how-to-select-column-till-last-non-empty-cell/34897344#34897344", "title": "how to select column till last non empty cell", "body": "<p>To work with all cells from A1 up to the last non-empty cell in column A:</p>\n\n<pre><code>Dim oAllDataInA As Range\nWith Worksheets(\"Sheet1\")\n    Set oAllDataInA =.Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\nEnd With\n'Now work with oAllDataInA. For instance. let formula in column B be same as in A:\noAllDataInA.Copy\noAllDataInA.Offset(,1).PasteSpecial xlFormulas\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": true, "score": 0, "last_activity_date": 1453462344, "creation_date": 1453462344, "answer_id": 34945756, "question_id": 34896596, "link": "https://stackoverflow.com/questions/34896596/how-to-select-column-till-last-non-empty-cell/34945756#34945756", "title": "how to select column till last non empty cell", "body": "<p>Please try the below code..</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Sub test()\r\n'change the sheet name as yours\r\nSheets(\"Sheet1\").Activate\r\nRange(\"A1\", Cells(Rows.Count, 1).End(xlUp)).Copy\r\n'Change the destination range as yours\r\nRange(\"D1\").Select\r\nSelection.PasteSpecial Paste:=xlPasteFormulas\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 13, "user_id": 5706943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f81ace13ff4f53894685f877a455b4?s=128&d=identicon&r=PG&f=1", "display_name": "ZZZZZZZZZZZZZZZZZ", "link": "https://stackoverflow.com/users/5706943/zzzzzzzzzzzzzzzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8870, "favorite_count": 0, "accepted_answer_id": 34945756, "answer_count": 2, "score": 0, "last_activity_date": 1453462344, "creation_date": 1453283283, "last_edit_date": 1453458832, "question_id": 34896596, "link": "https://stackoverflow.com/questions/34896596/how-to-select-column-till-last-non-empty-cell", "title": "how to select column till last non empty cell", "body": "<p>I am creating vba macro to copy a column having set of values.\nbut in between some rows are blank in that column.how to  code it dynamically so that it will select till last non empty cell.</p>\n\n<p>for example in cell A\nif A1 to A20 have values \nA21 is blank\nA22 to A35  have values\nA36,A37,A38 is blank\nA39 to A45 hav values</p>\n\n<p>Now i need to dynamically select values from A1 to A45 and paste it in B.\nAlso values in A Come through formula.I want to carry that formula and paste it as formula</p>\n\n<p>how do i do it?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 1, "last_activity_date": 1453285789, "creation_date": 1453285789, "answer_id": 34897508, "question_id": 34896191, "link": "https://stackoverflow.com/questions/34896191/how-do-i-delete-a-table-in-powerpoint-using-vba/34897508#34897508", "title": "How do I delete a table in powerpoint using VBa?", "body": "<p>Try calling this function to delete all tables from the specified slide:</p>\n\n<pre><code>Option Explicit\n\n' Deletes all tables from the specified slide (table shapes and tables within placeholders)\n' Returns the number of tables deleted\n' Written by Jamie Garroch of YOUpresent Ltd. (http://youpresent.co.uk)\nPublic Function DeleteTablesFromSlide(mySlide As PowerPoint.Slide) As Long\n  Dim lCntr As Long\n  Dim lTables As Long\n  ' Count backwards when deleting items from a collection\n  For lCntr = mySlide.Shapes.Count To 1 Step -1\n    With mySlide.Shapes(lCntr)\n      Select Case .Type\n        Case msoTable: .Delete: lTables = lTables + 1 ' msoTable = 19\n        Case msoPlaceholder ' msoPlaceholder = 19\n          If .PlaceholderFormat.ContainedType = msoTable Then .Delete: lTables = lTables + 1\n      End Select\n    End With\n  Next\n  DeleteTablesFromSlide = lTables\nEnd Function\n</code></pre>\n\n<p>Call with:</p>\n\n<pre><code>DeleteTablesFromSlide mySlide\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 5815001, "user_type": "registered", "profile_image": "https://graph.facebook.com/749106358/picture?type=large", "display_name": "Simon JL", "link": "https://stackoverflow.com/users/5815001/simon-jl"}, "edited": false, "score": 1, "creation_date": 1453287371, "post_id": 34897689, "comment_id": 57532578, "body": "This worked, just made sure to set       Shapes(NUMBER)  To the correct value for the table. Thanks!"}], "tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1453286296, "creation_date": 1453286296, "answer_id": 34897689, "question_id": 34896191, "link": "https://stackoverflow.com/questions/34896191/how-do-i-delete-a-table-in-powerpoint-using-vba/34897689#34897689", "title": "How do I delete a table in powerpoint using VBa?", "body": "<pre><code>myPresentation.Slides(1).Shapes(1).Delete\n</code></pre>\n\n<p>Place code above just after</p>\n\n<pre><code>Set mySlide = myPresentation.Slides.Item(1)\n</code></pre>\n\n<p>When I used this it deleted my table from my powerpoint however it was only a table in the slide, you may need to change the number in shapes to get this to work for you. I also don't know how it will fair will continued use, you may need to keep changing the number.</p>\n\n<p>I used <a href=\"https://msdn.microsoft.com/en-us/library/office/ff746738.aspx/%22This22%\" rel=\"nofollow\">This link</a>\nto find out how to delete items from powerpoint</p>\n\n<pre><code>ActivePresentation.Slides(2).Shapes(5).Table.Rows(3).Delete\n</code></pre>\n\n<p>Is the origonal code from the site linked and was adapted using trial and error</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff744177.aspx\" rel=\"nofollow\">This link</a>\nExplains shapes a bit more, hope it helps. In a basic overview it basicly says that in powerpoint most items you can enter in it are called shapes</p>\n\n<p>If you want me to explain anything further just leave a comment and I shall try to do so</p>\n"}], "owner": {"reputation": 103, "user_id": 5815001, "user_type": "registered", "profile_image": "https://graph.facebook.com/749106358/picture?type=large", "display_name": "Simon JL", "link": "https://stackoverflow.com/users/5815001/simon-jl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "accepted_answer_id": 34897689, "answer_count": 2, "score": 0, "last_activity_date": 1453286296, "creation_date": 1453282189, "last_edit_date": 1531164843, "question_id": 34896191, "link": "https://stackoverflow.com/questions/34896191/how-do-i-delete-a-table-in-powerpoint-using-vba", "title": "How do I delete a table in powerpoint using VBa?", "body": "<p>So I'm trying to get a table deleted from a powerpoint that is opened using VBa, and I can't seem to get it to work. I've tried a few things but they never have any effect or usually just give me an error.</p>\n\n<p>So far I have gotten the following, which opens a specific powerpoint and copies in a specific table to the first slide. I really would like to be able to delete the table that is already there and replace it with the new one.</p>\n\n<p>How would I go about doing this? Code below:</p>\n\n<pre><code>Sub ExcelRangeToPowerPoint()\n\n'PURPOSE: Copy/Paste An Excel Range Into a New PowerPoint Presentation\n\nDim rng As Excel.Range\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim mySlide As PowerPoint.Slide\nDim myShapeRange As PowerPoint.Shape\n\n'Copy Range from Excel\nSet rng = ThisWorkbook.ActiveSheet.Range(\"Table1[#ALL]\")\n\n'Create an Instance of PowerPoint\nOn Error Resume Next\n\n'Is PowerPoint already opened?\n  Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n'Clear the error between errors\n  Err.Clear\n\n'If PowerPoint is not already open then open PowerPoint\n  If PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n'Handle if the PowerPoint Application is not found\n  If Err.Number = 429 Then\n    MsgBox \"PowerPoint could not be found, aborting.\"\n    Exit Sub\n  End If\n\nOn Error GoTo 0\n\n'Make PowerPoint Visible and Active\nPowerPointApp.Visible = True\nPowerPointApp.Activate\n\n'Create a New Presentation\nSet myPresentation =         PowerPointApp.Presentations.Open(\"Y:\\Projects\\VBa\\vbatest2.pptx\")\n\n'Add a slide to the Presentation\nSet mySlide = myPresentation.Slides.Item(1)\n\n'Delete current table in presentation\n'ActivePresentation.Slides(1).Shapes(1).Delete\n\n'Copy Excel Range\nrng.Copy\n\n'Paste to PowerPoint and position\n mySlide.Shapes.PasteSpecial DataType:=ppPasteSourceFormatting\n Set myShapeRange = mySlide.Shapes(mySlide.Shapes.Count)\n\n'Set position:\n  myShapeRange.Left = 20\n  myShapeRange.Top = 100\n  myShapeRange.Height = 400\n  myShapeRange.Width = 900\n\n'Clear The Clipboard\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "activex"], "answers": [{"comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1453286534, "post_id": 34896468, "comment_id": 57531944, "body": "Thanks, the ActiveSheet.OLEObjects(&quot;CheckBox1&quot;).Object.Value works perfect."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 3, "last_activity_date": 1453282972, "creation_date": 1453282972, "answer_id": 34896468, "question_id": 34896038, "link": "https://stackoverflow.com/questions/34896038/access-to-activex-checkbox-value-with-name-of-checkbox-as-string/34896468#34896468", "title": "Access to ActiveX checkbox value with name of checkbox as String", "body": "<p>I tried like so, defining the object as an OLEObject rather than a shape.  s works, s2 fails....  Put in here to allow formatting rather than in comment.</p>\n\n<pre><code>Sub test()\n\nDim s As OLEObject\nDim s2 As Shape\n\nSet s = ActiveSheet.OLEObjects(\"CheckBox1\")\nSet s2 = ActiveSheet.Shapes(\"CheckBox1\")\n\nDebug.Print s.Object.Value\nDebug.Print s2.OLEFormat.Object.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4286, "favorite_count": 0, "accepted_answer_id": 34896468, "answer_count": 1, "score": 0, "last_activity_date": 1568773008, "creation_date": 1453281792, "last_edit_date": 1453282372, "question_id": 34896038, "link": "https://stackoverflow.com/questions/34896038/access-to-activex-checkbox-value-with-name-of-checkbox-as-string", "title": "Access to ActiveX checkbox value with name of checkbox as String", "body": "<p>I have an Excel worksheet with multiple ActiveX checkboxes. Their names are \"CheckBox1\", \"CheckBox2\", \"CheckBox3\" etc. If I refer to them as variables, for example:</p>\n\n<pre><code>If CheckBox1 = True Then\nMsgBox \"OK\"\nEndIf\n</code></pre>\n\n<p>everything works fine.</p>\n\n<p>I want to load to array values of all my checkboxes with a <code>For</code> loop, so I have to reference to their names as String, to create consecutive names. I have tried several solutions, such as:</p>\n\n<pre><code>Dim CheckBox As Shape\nSet CheckBox = ActiveSheet.Shapes(\"CheckBox1\")\nIf CheckBox.OLEFormat.Object.Value = 1 Then\nMsgBox \"OK\"\nEnd If\n</code></pre>\n\n<p>Showing \"Run-time error '438': Object doesn't support this property or method\"</p>\n\n<pre><code>If ActiveSheet.CheckBoxes(\"CheckBox1\").Checked = False Then\nMsgBox \"OK\"\nEnd If\n</code></pre>\n\n<p>Showing \"Run-time error '1004': Taking properties of CheckBoxes class Worksheet is imossibble'</p>\n\n<pre><code>If ActiveSheet.Shapes(\"CheckBox1\").Value = xlOn Then\nMsgBox \"OK\"\nEnd If\n</code></pre>\n\n<p>Showing \"Run-time error '438': Object doesn't support this property or method\"</p>\n\n<p>As in subject, how can I refer to ActixeX checkbox value with String as name? Is it possible?</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 1, "creation_date": 1453282726, "post_id": 34895904, "comment_id": 57529414, "body": "You are asking vba to input the formula vlookup(B36:B36; N1:R104..;5;) right? Did you try replacing B36:B36 by just B36, or in your case &quot;B&quot; &amp; i &amp;&quot;...?"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1453282997, "post_id": 34895904, "comment_id": 57529596, "body": "Also, did you try avoiding using select but rather the coordinates of the cells you write in? such as cells(36,2) for B36, and thus have lastcell = cells(36,2).End(xlToRight) ; and lastcell.offset(0,1) ?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1453285380, "post_id": 34895904, "comment_id": 57531218, "body": "<code>ActiveCell.FormulaR1C1</code> is expecting the formula in R1C1 format rather than A1 format.  Try <code>ActiveCell.Formula</code>.  Also - not sure about this though - <code>inRange.Address</code> and <code>LookupRange.Address</code> within the formula."}, {"owner": {"reputation": 3, "user_id": 5814910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d861bc11e56f8dd54be66b29f15e35?s=128&d=identicon&r=PG&f=1", "display_name": "Logie143", "link": "https://stackoverflow.com/users/5814910/logie143"}, "edited": false, "score": 0, "creation_date": 1453305170, "post_id": 34895904, "comment_id": 57545133, "body": "All sorted guys, thanks! naming the range did the trick."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1453301818, "post_id": 34902924, "comment_id": 57542636, "body": "Good point - referencing the Pivot table.  Jon Peltier has a good page on how to reference the different parts:  <a href=\"http://peltiertech.com/referencing-pivot-table-ranges-in-vba/\" rel=\"nofollow noreferrer\">peltiertech.com/referencing-pivot-table-ranges-in-vba</a>"}], "tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": true, "score": 0, "last_activity_date": 1453301190, "last_edit_date": 1453301190, "creation_date": 1453300590, "answer_id": 34902924, "question_id": 34895904, "link": "https://stackoverflow.com/questions/34895904/vba-lookup-lookup-range-error/34902924#34902924", "title": "VBA Lookup- lookup range error", "body": "<p>Just a few things..</p>\n\n<ol>\n<li>As FAURILLOU Amandine mentioned, I think you can reference the inRange as Range(\"B\" &amp; i) - agreed.</li>\n<li>As Darren mentioned use formula - agreed.</li>\n<li><p>I would personally look at the pivot table, and try to reference the data range for the pivot, as opposed to reference it to. Just the way I would try to do it. That way if the location of the pivot changed you'll be fine. Had a very quick look at the object model and it would something like:</p>\n\n<p>Worksheets(\"MV Pivot\").PivotTables(\"The Name\").DataBodyRange</p></li>\n<li><p>Although you use a formula to lookup the pivot data column, you could actually call the Evaluate function. If you use your formula in the cell, if the pivot table data changes, it will also change the historical data since its a formula. You can get around this by simply hardcoding the result.</p></li>\n</ol>\n\n<p>All of that being said, please give this a go and see if it works/fixes your issue.</p>\n\n<pre><code>Sub Test()\n\nRange(\"B36\").Select\nSelection.End(xlToRight).Select\nActiveCell.Offset(0, 1).Select\n\nDim inRange As Range, LookupRange As Range\nDim row As Integer, i As Integer\n\nFor i = 36 To 40\n    Set inRange = Range(\"B\" &amp; i)\n    Set LookupRange = Range(\"$K$36:$P$41\")\n    MsgBox (inRange)\n    ActiveCell.Formula = Evaluate(\"=IFERROR(VLOOKUP(\" &amp; inRange.Address &amp; \",\" &amp; LookupRange.Address &amp; \",5,FALSE),0)\")\n    ActiveCell.Offset(1, 0).Select\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 5814910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d861bc11e56f8dd54be66b29f15e35?s=128&d=identicon&r=PG&f=1", "display_name": "Logie143", "link": "https://stackoverflow.com/users/5814910/logie143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 34902924, "answer_count": 1, "score": 0, "last_activity_date": 1453301190, "creation_date": 1453281446, "question_id": 34895904, "link": "https://stackoverflow.com/questions/34895904/vba-lookup-lookup-range-error", "title": "VBA Lookup- lookup range error", "body": "<p>I've exhausted every option so I'm left with throwing myself at your mercy. I'm trying to automate a report in excel but the lookup just isn't working. the idea is it does a lookup on a pivot table that is refreshed every day and moves along to the next empty day and gives the results. I've tried recording and the lookup works but each day it moves the look up range one column on and I can't get it to fix. My code is below, any help will be greatly appreciated.</p>\n\n<pre><code>   Range(\"B36\").Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(0, 1).Select\n\n\n  Dim row As Integer\n    For i = 36 To 40\n\n\nSet inRange = Range(\"B\" &amp; i &amp; \":B\" &amp; i)\nSet LookupRange = Sheets(\"MV Pivot\").Columns(\"N:R\")\n\n\nMsgBox (inRange)\n\n    ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP(\" &amp; inRange &amp; \",\" &amp; LookupRange &amp; \",5,FALSE),0)\"\n                      ActiveCell.Offset(1, 0).Select\n        Next I\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Logie143</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1453280119, "post_id": 34895024, "comment_id": 57527697, "body": "where do you get the type mismatch? I.o.w.: at what line does the program break?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5814695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b817dd7a44eb4790477d535c04979?s=128&d=identicon&r=PG&f=1", "display_name": "fabian", "link": "https://stackoverflow.com/users/5814695/fabian"}, "edited": false, "score": 0, "creation_date": 1453305776, "post_id": 34895450, "comment_id": 57545601, "body": "I&#39;m doing this for an assignment and the given function has to return a Double(). Is it possible? Which is the better practice between Variant and Double array?"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 3, "last_activity_date": 1453308368, "last_edit_date": 1453308368, "creation_date": 1453280122, "answer_id": 34895450, "question_id": 34895024, "link": "https://stackoverflow.com/questions/34895024/vba-matrix-inverse/34895450#34895450", "title": "VBA: matrix inverse", "body": "<p><code>WorksheetFunction.MInverse</code> is returning a <code>Variant</code> containing the matrix not a <code>Double</code> array. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841265.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff841265.aspx</a> So the <code>Double</code> arrays and also the <code>ReDim</code> is not necessary.</p>\n\n<p>But there is also another issue. Not all matrices are invertable. With an not invertable matrix <code>WorksheetFunction.MInverse</code> will throw an error. Better you use <code>Application.MInverse</code>. This will return <code>#NUM!</code> error as the <code>=MINV()</code> also would do.</p>\n\n<pre><code>Sub f()\n    Range(\"E1:G3\").Value = g(Range(\"A1:C3\"))\nEnd Sub\n\nFunction g(m As Range) As Variant\n    Dim minv As Variant\n    minv = Application.MInverse(m)\n    g = minv\nEnd Function\n</code></pre>\n\n<p>If the function must return a <code>Double()</code> array, then you must convert the <code>Variant</code> into that.</p>\n\n<pre><code>Function g(m As Range) As Double()\n Dim vMinv As Variant\n Dim dMinv() As Double\n\n vMinv = Application.MInverse(m)\n\n If IsError(vMinv) Then Exit Function 'what shall the Double() contain if m is not invertable?\n\n On Error Resume Next\n d1 = UBound(vMinv, 1)\n d2 = UBound(vMinv, 2)\n On Error GoTo 0\n\n 'vMinv is one-dimensional\n If IsEmpty(d2) Then\n  ReDim dMinv(1 To d1)\n  For i = 1 To d1\n   dMinv(i) = vMinv(i)\n  Next\n  g = dMinv\n  Exit Function\n End If\n\n 'vMinv is two-dimensional\n ReDim dMinv(1 To d1, 1 To d2)\n For i = 1 To d1\n  For j = 1 To d2\n   dMinv(i, j) = vMinv(i, j)\n  Next\n Next\n g = dMinv\n\nEnd Function\n</code></pre>\n\n<p>But the question is: what shall the Double() contain if m is not invertable? It can't contain error values.</p>\n"}, {"tags": [], "owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "is_accepted": false, "score": 0, "last_activity_date": 1613825098, "creation_date": 1613825098, "answer_id": 66291666, "question_id": 34895024, "link": "https://stackoverflow.com/questions/34895024/vba-matrix-inverse/66291666#66291666", "title": "VBA: matrix inverse", "body": "<p>VBA functions can only return a one dimensional array. if you want to have it in two dimensions you has to do it by reference. Here i use a sub, byReference is default in VBA.</p>\n<pre><code>sub ret(a())\n  redim A(2,2)\n  A(2,2)=2\nend sub\n\n\ndim A() \nret a\ndebug.print A(2,2)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5814695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86b817dd7a44eb4790477d535c04979?s=128&d=identicon&r=PG&f=1", "display_name": "fabian", "link": "https://stackoverflow.com/users/5814695/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2389, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1613825098, "creation_date": 1453278777, "question_id": 34895024, "link": "https://stackoverflow.com/questions/34895024/vba-matrix-inverse", "title": "VBA: matrix inverse", "body": "<p>I'm trying to do something simple: take a matrix in cells A1:C3 and write the inverse into cells E1:G3. This doesn't work and the error I get is \"type mismatch\". Why?</p>\n\n<pre><code>Sub f()\n    Range(\"E1:G3\").Value = g(Range(\"A1:C3\"))\nEnd Sub\n\nFunction g(m As Range) As Double()\n    Dim r As Integer, c As Integer\n    Dim minv() As Double\n    r = m.Rows.Count\n    c = m.Columns.Count\n    ReDim minv(1 To r, 1 To c)\n    minv = WorksheetFunction.MInverse(m)\n    g = minv\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 6078911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R8mbU.jpg?s=128&g=1", "display_name": "Hey Romey", "link": "https://stackoverflow.com/users/6078911/hey-romey"}, "is_accepted": false, "score": 0, "last_activity_date": 1459346926, "creation_date": 1459346926, "answer_id": 36311346, "question_id": 34894359, "link": "https://stackoverflow.com/questions/34894359/find-the-code-in-microsoft-project/36311346#36311346", "title": "Find the code in microsoft project", "body": "<p>Try opening the file in MS Project and press Alt + F11 to open the VBA editor.  You should see the Project Explorer on the left hand side.</p>\n\n<p>Expand forms.\nDouble-click one of the forms. \nSelect the visual form.\nPress F5.</p>\n\n<p>Also, search your VBA code (forms and modules) for the word Private. Change Private to Public so they appear in the organizer modules.</p>\n"}], "owner": {"reputation": 9, "user_id": 1557704, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e75ef2443cd2c80a44312bf7772e0f38?s=128&d=identicon&r=PG", "display_name": "excellove", "link": "https://stackoverflow.com/users/1557704/excellove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593559217, "creation_date": 1453276292, "last_edit_date": 1593559217, "question_id": 34894359, "link": "https://stackoverflow.com/questions/34894359/find-the-code-in-microsoft-project", "title": "Find the code in microsoft project", "body": "<p>I have a form in Microsoft project 2007 that is pinned into the ribbon. When I want to use it in Microsoft project 2010 the form is not showing and is not pinned, so the same project I have saved and can open in 2007 and see the pinned form is not shown when I open it on a another computer with 2010 version. </p>\n\n<p>I went to the organizer to see if I can find it, but I didnt find it. What can I do?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 5814380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc5247afa42014a646feaf185d52c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "jan", "link": "https://stackoverflow.com/users/5814380/jan"}, "edited": false, "score": 0, "creation_date": 1453280654, "post_id": 34894979, "comment_id": 57528036, "body": "Thank you Vityata for such a quick response.  Yes, that should work.   I guess the point is to declare filePermissionCandidates As Variant.  A poster on another forum suggested      filePermissionCandidates = Application.Transpose(Range(&quot;V6:v200&quot;).Value)   (after declaring as variant), which I used and it works.   I&#39;ll test yours on another set of files (since I now already got access to the critical ones).   Thanks, again!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 249, "user_id": 5814380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc5247afa42014a646feaf185d52c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "jan", "link": "https://stackoverflow.com/users/5814380/jan"}, "edited": false, "score": 0, "creation_date": 1453280951, "post_id": 34894979, "comment_id": 57528225, "body": "(: Yup, this is the reason. You may go further and make the range flexible."}, {"owner": {"reputation": 249, "user_id": 5814380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc5247afa42014a646feaf185d52c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "jan", "link": "https://stackoverflow.com/users/5814380/jan"}, "edited": false, "score": 0, "creation_date": 1453281458, "post_id": 34894979, "comment_id": 57528553, "body": "I just tested your suggestion but it gives me a runtime error.  I guess it does need  <code>Application.Transpose</code> for some reason."}, {"owner": {"reputation": 249, "user_id": 5814380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc5247afa42014a646feaf185d52c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "jan", "link": "https://stackoverflow.com/users/5814380/jan"}, "edited": false, "score": 0, "creation_date": 1453282052, "post_id": 34894979, "comment_id": 57528959, "body": "This works: <code>filePermissionCandidates = Application.Transpose(Worksheets(&quot;Sheet1&quot;).Range(&quot;AB7:AB10&quot;)&zwnj;&#8203;)</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 249, "user_id": 5814380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc5247afa42014a646feaf185d52c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "jan", "link": "https://stackoverflow.com/users/5814380/jan"}, "edited": false, "score": 0, "creation_date": 1453285975, "post_id": 34894979, "comment_id": 57531578, "body": "It probably depends on the code after and how you use it. Here is a good reference for arrays and ranges: <a href=\"http://www.cpearson.com/excel/ArraysAndRanges\" rel=\"nofollow noreferrer\">cpearson.com/excel/ArraysAndRanges</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1453278613, "creation_date": 1453278613, "answer_id": 34894979, "question_id": 34894030, "link": "https://stackoverflow.com/questions/34894030/turn-cell-range-into-array-for-grantaccesstomultiplefiles-excel-vba/34894979#34894979", "title": "Turn cell range into array for GrantAccessToMultipleFiles (Excel, VBA)", "body": "<p>I was able to generate array from range with the following code:</p>\n\n<pre><code>Option Explicit\n\nSub requestFileAccess()\n\nDim fileAccessGranted            As Boolean\nDim filePermissionCandidates     As Variant\n\nfilePermissionCandidates = Worksheets(\"Table1\").Range(\"A1:A5\")\n'fileAccessGranted = GrantAccessToMultipleFiles(filePermissionCandidates)\n\nEnd Sub\n</code></pre>\n\n<p>In stead of \"Table1\", write the name of your sheet, or an index.\nEnjoy! :)</p>\n"}], "owner": {"reputation": 249, "user_id": 5814380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc5247afa42014a646feaf185d52c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "jan", "link": "https://stackoverflow.com/users/5814380/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 34894979, "answer_count": 1, "score": 0, "last_activity_date": 1459157606, "creation_date": 1453275228, "last_edit_date": 1531164843, "question_id": 34894030, "link": "https://stackoverflow.com/questions/34894030/turn-cell-range-into-array-for-grantaccesstomultiplefiles-excel-vba", "title": "Turn cell range into array for GrantAccessToMultipleFiles (Excel, VBA)", "body": "<p>I am completely new to VBA (and to this forum), so my apologies if this is a rather basic question.  I need to get filepaths from a column in an Excel sheet and turn them into an Array to be used in a Macro to GrantAccessToMultipleFiles. </p>\n\n<p>I am creating a database in a workbook that checks for the existence of files on an external harddrive (about 10.000 files total) and I want to grant excel permission to access these files in advance in order to avoid to have to click thousands of times the annoying Grant Access dialog in Excel 2016.  </p>\n\n<p>I have dedicated an extra column in the Excel sheet to calculate the filepaths for the files and turn them into text before setting up the macro to check for file existence, and I want to first run the GrantAccessToMultipleFiles command in order to get the access before entering the formula. </p>\n\n<p>I created a Macro with this code from: <a href=\"https://dev.office.com/blogs/VBA-improvements-in-Office-2016\" rel=\"nofollow\">https://dev.office.com/blogs/VBA-improvements-in-Office-2016</a></p>\n\n<pre><code>Sub requestFileAccess()\n   Dim fileAccessGranted As Boolean\n   Dim filePermissionCandidates\n   filePermissionCandidates = Array(\"/Users/xyz/Desktop/test1.txt\", \"/Users/xyz/Desktop/test2.txt\")\n   fileAccessGranted = GrantAccessToMultipleFiles(filePermissionCandidates)\nEnd Sub\n</code></pre>\n\n<p>When I test it by substituting the example paths with the paths from the file it does work, but I have no idea how to automatically extract the paths from the column and turn them into an array to be used in the macro.  </p>\n\n<p>I tried with </p>\n\n<pre><code>filePermissionCandidates = Array(Range(\"V5:V100\"))\n</code></pre>\n\n<p>and some other combinations but to no avail.  </p>\n\n<p>If anyone could point me into the right direction that would be much appreciated.</p>\n\n<p><strong>EDIT (just for future reference):</strong></p>\n\n<p>This is the correct version:</p>\n\n<pre><code>Sub requestFileAccess()\n   Dim fileAccessGranted As Boolean\n   Dim filePermissionCandidates\n   filePermissionCandidates = Application.Transpose(Worksheets(\"Sheet1\").Range(\"AB7:AB10\"))\n   fileAccessGranted = GrantAccessToMultipleFiles(filePermissionCandidates)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5814456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a715cbe46c0686d23687c105392eafa?s=128&d=identicon&r=PG&f=1", "display_name": "Pragnya Vujjini", "link": "https://stackoverflow.com/users/5814456/pragnya-vujjini"}, "edited": false, "score": 0, "creation_date": 1453317535, "post_id": 34894523, "comment_id": 57553078, "body": "I cannot use link ... i need to add those using access vba"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 5814456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a715cbe46c0686d23687c105392eafa?s=128&d=identicon&r=PG&f=1", "display_name": "Pragnya Vujjini", "link": "https://stackoverflow.com/users/5814456/pragnya-vujjini"}, "edited": false, "score": 1, "creation_date": 1453329279, "post_id": 34894523, "comment_id": 57559499, "body": "Then do that: TransferText. Look up the on-line help."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1453276819, "creation_date": 1453276819, "answer_id": 34894523, "question_id": 34894010, "link": "https://stackoverflow.com/questions/34894010/how-to-insert-data-into-access-table-from-two-different-excel-files-using-access/34894523#34894523", "title": "How to insert data into access table from two different Excel files using access vba", "body": "<p>Link the two Excel files and create one or two queries to append the data to your table.</p>\n"}], "owner": {"reputation": 1, "user_id": 5814456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a715cbe46c0686d23687c105392eafa?s=128&d=identicon&r=PG&f=1", "display_name": "Pragnya Vujjini", "link": "https://stackoverflow.com/users/5814456/pragnya-vujjini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594642187, "creation_date": 1453275159, "last_edit_date": 1594642187, "question_id": 34894010, "link": "https://stackoverflow.com/questions/34894010/how-to-insert-data-into-access-table-from-two-different-excel-files-using-access", "title": "How to insert data into access table from two different Excel files using access vba", "body": "<p>I have two excel files with the following columns</p>\n\n<p>1st Excel file: Roll No, Student Name, age, gender \n2nd Excel file: Roll No, course, grades</p>\n\n<p>From these two tables i need to add Roll No, Student Name, Course and Grades into access table </p>\n\n<p>To import this data i need to load two files add particular column data using access vba.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "is_accepted": true, "score": 1, "last_activity_date": 1453276335, "creation_date": 1453276335, "answer_id": 34894375, "question_id": 34893944, "link": "https://stackoverflow.com/questions/34893944/ie-locationurl-only-returns-part-value/34894375#34894375", "title": "IE.LocationURL only returns part value", "body": "<p>Sorry for posting the question and then answering it 10 minutes later but I found the solution. It was my mistake i was not giving IE enough time to load the webpage. I put in a 5 second delay and it worked. Hope this helps anybody in the future </p>\n"}], "owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 34894375, "answer_count": 1, "score": 0, "last_activity_date": 1453276335, "creation_date": 1453274965, "question_id": 34893944, "link": "https://stackoverflow.com/questions/34893944/ie-locationurl-only-returns-part-value", "title": "IE.LocationURL only returns part value", "body": "<p>I'm hoping you can help as I have exhausted everything that I know to try. Basically I have a VBA macro that does some automation on internet explorer to get some reports off one of our internal sites using SendKeys and within this macro I am also trying to copy the URL of the website so that I can make a hyperlink in my spreadsheet. Now at first I was using SendKeys to navigate to the address bar and using <code>SendKeys \"^c\", True</code> to copy it and then paste it in my spreadsheet but I have decided that I want to run the automation in full screen mode so that I can ignore the address bar and the favourites bar when tabing through the website. However when running full screen mode I cant navigate to the address bar so I decided to use <code>IE.LocationURL</code> to get me the URL of the page, but when I assign this to a variable or put it into a cell it only returns part of the URL. The site im trying to access has a # in the URL (Sorry it is a confidential website so I cant put it here but it is in the format www.something.com/somethingelse/#thisBitWontDisplay.....). Everything after the # wont appear. I know that <code>IE.LocationURL</code> is working as when I look in the local variable bit in VBA editor it shows me that the value of <code>IE.LocationURL</code> is the correct URL but that's it, I can access the rest of the URL. I have tried to format the output of <code>IE.LocationURL</code> and also the variable but it wont work. Any suggestions? </p>\n\n<p>Thanks </p>\n"}, {"tags": ["ms-access", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1453276948, "post_id": 34893912, "comment_id": 57526052, "body": "The code should work. Check the data from table you use in parameters under debugger, quite sure that the problem is there. Or temporary replace parameters by string constants with file name, worksheet and cell reference."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5814401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a93375ef7e062ff02ab301b120de0c0?s=128&d=identicon&r=PG&f=1", "display_name": "kuroikenshi", "link": "https://stackoverflow.com/users/5814401/kuroikenshi"}, "edited": false, "score": 0, "creation_date": 1453293825, "post_id": 34899680, "comment_id": 57537019, "body": "Before I added &quot;ActiveCell.Activate&quot; The code would just open up the appropriate excel document and go to the proper sheet but it would not do anything with the cell and gave me a different error code. Once I used the ActiveCell syntax, it began to work (every other time).  When it debugs, it highlights the ActiveCell.Activate line.  When I get into work in the morning, i will give your code a try!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1453291724, "creation_date": 1453291724, "answer_id": 34899680, "question_id": 34893912, "link": "https://stackoverflow.com/questions/34893912/open-a-specific-excel-document-then-go-to-a-specific-cell/34899680#34899680", "title": "Open a specific Excel document, then go to a specific cell", "body": "<p>No idea why it isn't working all the time (not sure why you're activating the active cell - it's already active).</p>\n\n<p>I've never had problems with the code below (commented out code is optional):</p>\n\n<pre><code>Public Sub Main()\n\n    Dim oXL As Object\n    Dim oWrkBk As Object\n    Dim oWrkSht As Object\n    Dim oRng As Object\n\n    Set oXL = CreateXL\n    Set oWrkBk = oXL.workbooks.Open(\"&lt;path and workbook name&gt;.xlsx\")\n    Set oWrkSht = oWrkBk.Worksheets(\"&lt;sheet name&gt;\")\n    Set oRng = oWrkSht.range(\"A1\")\n\n    'Select the range.\n        'oWrkSht.select\n        'oRng.select\n\n    'Go to the range.\n        'oXL.Goto Reference:=oWrkSht.range(\"A1\"), Scroll:=True\n\n    'Do stuff with the range (no need to select it).\n    oRng.Value = \"10\"\n    MsgBox oRng.Address &amp; \" has the value of \" &amp; oRng.Value\n\nEnd Sub\n\nPublic Function CreateXL(Optional bVisible As Boolean = True) As Object\n\n    Dim oTmpXL As Object\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Defer error trapping in case Excel is not running. '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    On Error Resume Next\n    Set oTmpXL = GetObject(, \"Excel.Application\")\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'If an error occurs then create an instance of Excel. '\n    'Reinstate error handling.                            '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo ERROR_HANDLER\n        Set oTmpXL = CreateObject(\"Excel.Application\")\n    End If\n\n    oTmpXL.Visible = bVisible\n    Set CreateXL = oTmpXL\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure CreateXL.\"\n            Err.Clear\n    End Select\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5814401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a93375ef7e062ff02ab301b120de0c0?s=128&d=identicon&r=PG&f=1", "display_name": "kuroikenshi", "link": "https://stackoverflow.com/users/5814401/kuroikenshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1453336523, "creation_date": 1453336523, "answer_id": 34913352, "question_id": 34893912, "link": "https://stackoverflow.com/questions/34893912/open-a-specific-excel-document-then-go-to-a-specific-cell/34913352#34913352", "title": "Open a specific Excel document, then go to a specific cell", "body": "<p>Darren,</p>\n\n<p>Thank you for the suggestion. I actually ended up solving this with my own code. I found that, while in debugging mode, the script would work perfectly after I hit the stop button after each try. I then found the syntax of \"End\" which stops all macros. This ended up solving the issue since now I can run the script with no issues after putting \"End\" at the end of my script.</p>\n"}], "owner": {"reputation": 95, "user_id": 5814401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a93375ef7e062ff02ab301b120de0c0?s=128&d=identicon&r=PG&f=1", "display_name": "kuroikenshi", "link": "https://stackoverflow.com/users/5814401/kuroikenshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1365, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594642861, "creation_date": 1453274882, "last_edit_date": 1594642861, "question_id": 34893912, "link": "https://stackoverflow.com/questions/34893912/open-a-specific-excel-document-then-go-to-a-specific-cell", "title": "Open a specific Excel document, then go to a specific cell", "body": "<p>I am trying to create a simple VBA script that will open a specific Excel document, then go to a specific cell. The current code will work every other time. I have searched and found several topics and threads but nothing that has resolved the issue.</p>\n\n<p>Here is the code that I am using.</p>\n\n<pre><code>Dim oApp As Object    \nDim oSheet As Object  \n\nSet oApp = CreateObject(\"Excel.Application\")\noApp.Visible = True\noApp.Workbooks.Open \"path to excel documents\" &amp; [CopperMap]\n\nSet oSheet = oApp.Worksheets([SpreadSheet])\n\noSheet.Activate\n\nActiveCell.Activate\nRange([CellColumn]).Activate\n</code></pre>\n\n<p>CopperMap, SpreadSheet, and CellColumn are columns in my table that have the required information.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1453274925, "creation_date": 1453274925, "answer_id": 34893928, "question_id": 34893759, "link": "https://stackoverflow.com/questions/34893759/how-to-declare-a-variable-number-of-indexed-strings/34893928#34893928", "title": "How to declare a variable number of indexed strings?", "body": "<p>Should be Words(i) i think.  Not String.  Also, i dont think that you're dim will accept a variable that way.</p>\n"}, {"comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1453275129, "post_id": 34893939, "comment_id": 57525194, "body": "You have to re-size array length with <code>ReDim</code> like <code>ReDim Words(TotalNumber)</code>."}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1453274950, "creation_date": 1453274950, "answer_id": 34893939, "question_id": 34893759, "link": "https://stackoverflow.com/questions/34893759/how-to-declare-a-variable-number-of-indexed-strings/34893939#34893939", "title": "How to declare a variable number of indexed strings?", "body": "<p>Use the following sub:</p>\n\n<pre><code>    Sub Main()\n        Dim TotalNumber As Long\n            TotalNumber = Val(InputBox(\"Please enter total number of words\"))\n        Dim i As Long\n        Dim MsgDisp As String\n        Dim Words() As String\n        ReDim Words(TotalNumber)\n        For i = 1 To TotalNumber\n            Words(i) = InputBox(\"Please type the words for number \" &amp; i)\n            MsgDisp = MsgDisp &amp; Words(i) &amp; Chr(10)\n        Next i\n        MsgBox MsgDisp\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 574, "user_id": 5800164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153725911654017/picture?type=large", "display_name": "Matthew Hui", "link": "https://stackoverflow.com/users/5800164/matthew-hui"}, "edited": false, "score": 0, "creation_date": 1453439082, "post_id": 34893957, "comment_id": 57610914, "body": "Thank you! That does it. I did not know the size has to be separately defined."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 2, "last_activity_date": 1453467554, "last_edit_date": 1453467554, "creation_date": 1453275006, "answer_id": 34893957, "question_id": 34893759, "link": "https://stackoverflow.com/questions/34893759/how-to-declare-a-variable-number-of-indexed-strings/34893957#34893957", "title": "How to declare a variable number of indexed strings?", "body": "<p>The way to do this is by first declaring the array without bounds and then redimming it:</p>\n\n<pre><code>Dim Words() As String\n'Other code\nReDim Words(1 To TotalNumber)\n</code></pre>\n\n<p>During the further course of your code you can even expand the array. But to avoid the array being zapped, you add the Preserve keyword:</p>\n\n<pre><code>TotalNumber = TotalNumber + 1\nReDim Preserve Words(1 To TotalNumber)\n</code></pre>\n\n<p>Edited to remove \"As String\" after the redims. Edited again to add the Preserve keyword.</p>\n"}], "owner": {"reputation": 574, "user_id": 5800164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153725911654017/picture?type=large", "display_name": "Matthew Hui", "link": "https://stackoverflow.com/users/5800164/matthew-hui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 34893957, "answer_count": 3, "score": 0, "last_activity_date": 1453467554, "creation_date": 1453274310, "question_id": 34893759, "link": "https://stackoverflow.com/questions/34893759/how-to-declare-a-variable-number-of-indexed-strings", "title": "How to declare a variable number of indexed strings?", "body": "<p>I wish to declare multiple variables and the number of variables to declare depends on an input so it is something like:</p>\n\n<pre><code>Sub Main()\nDim TotalNumber As Long\n    TotalNumber = InputBox(\"Please enter total number of words\")\nDim i As Long\nDim MsgDisp As String\nDim Words(1 To TotalNumber) As String\nFor i = 1 To TotalNumber\n    String(i) = InputBox(\"Please type the words for number \" &amp; i)\n    MsgDisp = MsgDisp &amp; String(i) &amp; Chr(10)\nNext i\nMsgBox(MsgDisp)\nEnd Sub\n</code></pre>\n\n<p>I however got the \"Constant expression required\" Error at Line 6.\nAny help is appreciated...</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1453275149, "creation_date": 1453275149, "answer_id": 34894007, "question_id": 34893154, "link": "https://stackoverflow.com/questions/34893154/what-is-the-correct-syntax-for-referencing-a-field-with-a-hyphen/34894007#34894007", "title": "What is the correct syntax for referencing a field with a hyphen?", "body": "<p>Add single quotes around text field values:</p>\n\n<pre><code>rst.FindFirst \"[ShipmentNumber] &lt;&gt; \" &amp; Me.ShipmentNumber &amp; \" AND [BOL] = '\" &amp; Me.BOL &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5814065, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uBf_JOEhZ1M/AAAAAAAAAAI/AAAAAAAAAMQ/f8eW9XAsZqc/photo.jpg?sz=128", "display_name": "Can&#39;tSpeakTheLanguage", "link": "https://stackoverflow.com/users/5814065/cantspeakthelanguage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 34894007, "answer_count": 1, "score": 0, "last_activity_date": 1453275149, "creation_date": 1453272101, "last_edit_date": 1495542208, "question_id": 34893154, "link": "https://stackoverflow.com/questions/34893154/what-is-the-correct-syntax-for-referencing-a-field-with-a-hyphen", "title": "What is the correct syntax for referencing a field with a hyphen?", "body": "<p>I have an indexed field, and if a duplicate entry is attempted on a form, I want to give the user the option to navigate to the original record. I tried the following code, adapted from an answer to a similar problem I found <a href=\"https://stackoverflow.com/questions/14608052/prevent-duplicate-records-query-before-creating-new-records\">here</a>. </p>\n\n<p>In my case, the [BOL] field is a text field that may contain multiple hyphens. What syntax do I need to use for Me.BOL? As an example, when I tried to enter \"CT-J17-XUSH-T001\" into my BOL field, I got the error: Run-time error '3070': The Microsoft Access database engine does not recognize 'CT' as a valid field name or expression.</p>\n\n<pre><code>Private Sub BOL_BeforeUpdate(Cancel As Integer)\n\n\n'https://stackoverflow.com/questions/14608052/prevent-duplicate-records-query-before-creating-new-records\n\nSet rst = Me.RecordsetClone\nrst.FindFirst \"[ShipmentNumber] &lt;&gt; \" &amp; Me.ShipmentNumber &amp; \" AND [BOL] = \" &amp; Me.BOL\nIf Not rst.NoMatch Then\n    Cancel = True\n    If MsgBox(\"BOL already exists; goto existing record?\", vbYesNo) = vbYes Then\n        Me.Undo\n        DoCmd.SearchForRecord , , acFirst, \"[ShipmentNumber] = \" &amp; rst(\"ShipmentNumber\")\n    End If\nEnd If\nrst.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "c#-4.0", "ms-word"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1453291356, "post_id": 34892617, "comment_id": 57535295, "body": "Are your images linked or embedded? Is the document based on a template other than Normal.dotm? Please be more precise as to what exactly you have tried. Show some code so we know how you try to achieve this."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453309342, "post_id": 34892617, "comment_id": 57548143, "body": "Please try the following and, if it works, it can also be done using code. But first we need to know what works for you :-) This assumes the document uses Heading styles and that you want to split the document at a Heading style."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453309380, "post_id": 34892617, "comment_id": 57548167, "body": "1) Open the document in Word. 2) Switch to the OUTLINE view and click the &quot;Show Document&quot; button. 3) Select the text that should be split off into a new document - starting with a heading style. 4) Click &quot;Create&quot;. 5) Double-click the little &quot;page&quot; symbol next to the Heading style at the beginning of the sub-document you just created. This should open that content in a NEW document. 6) File/Save As to save this as an independent document. When you&#39;re done testing, close the original document WITHOUT SAVING. Does this give you the result you need?"}, {"owner": {"reputation": 87, "user_id": 4468738, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/1ff482279b2db1015918a4ff048c6528?s=128&d=identicon&r=PG&f=1", "display_name": "mukul nagpal", "link": "https://stackoverflow.com/users/4468738/mukul-nagpal"}, "edited": false, "score": 0, "creation_date": 1453355415, "post_id": 34892617, "comment_id": 57567381, "body": "Thanks, but that doesn&#39;t seem to be working."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1453368099, "post_id": 34892617, "comment_id": 57573353, "body": "Once more: Is the doc based on any other template than Normal.dotm? What does &quot;not working&quot; mean? What gets lost? What do you expect and what do you get?"}], "answers": [{"comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1453363739, "post_id": 34903616, "comment_id": 57570938, "body": "@mukul nagpal: Is this what you want?"}], "tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": false, "score": 0, "last_activity_date": 1453302541, "creation_date": 1453302541, "answer_id": 34903616, "question_id": 34892617, "link": "https://stackoverflow.com/questions/34892617/how-to-split-word-file-with-formatting-retained/34903616#34903616", "title": "How to split word file with formatting retained", "body": "<p>If everything else is worked out, you can use <code>Range.FormattedText</code> from range objecr for both source and target documents to preserve formatting.</p>\n\n<p>see <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range.formattedtext.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range.formattedtext.aspx</a></p>\n\n<p>It also lists code for C#</p>\n\n<pre><code>Range FormattedText { get; set; }\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4468738, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/1ff482279b2db1015918a4ff048c6528?s=128&d=identicon&r=PG&f=1", "display_name": "mukul nagpal", "link": "https://stackoverflow.com/users/4468738/mukul-nagpal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1010, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574248351, "creation_date": 1453269792, "last_edit_date": 1574248351, "question_id": 34892617, "link": "https://stackoverflow.com/questions/34892617/how-to-split-word-file-with-formatting-retained", "title": "How to split word file with formatting retained", "body": "<p>I am trying to split a word file, I have seen numerous links for it , but formatting is not getting preserved. only the string inside the file is there in the new splitted files, but I want to have all the images , bullets , etc. to be there in the new splitted files.\nI tried it using C# but , interop assembly has a limitation that it can't reserve formatting.\nAlso thinking of converting into zip and then extract from the xml files?</p>\n\n<p>The things I tried are:<br>\n <a href=\"http://www.extendoffice.com/documents/word/966-word-split-document-into-multiple-documents.html\" rel=\"nofollow noreferrer\">http://www.extendoffice.com/documents/word/966-word-split-document-into-multiple-documents.html</a>\n<a href=\"https://msdn.microsoft.com/en-us/library/ee872374(v=office.12).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ee872374(v=office.12).aspx</a></p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "document"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453267825, "post_id": 34891627, "comment_id": 57522357, "body": "What happens with <b>early binding</b> ? e.g. <code>Dim ie As New InternetExplorer</code> and remove the <code>Set ie = ...</code>"}, {"owner": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "edited": false, "score": 0, "creation_date": 1453287302, "post_id": 34891627, "comment_id": 57532537, "body": "Unfortunately I still get the same error - the ie object now becomes visible upon running the &quot; ie.Visible = True&quot; line and the errors are still there.  When navigating the url, the ie.Document is still blank even after passing the ie.busy and ie.readystate conditions."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "edited": false, "score": 0, "creation_date": 1453287164, "post_id": 34893890, "comment_id": 57532439, "body": "My apologies that should have read url1, in my haste to trim down the code I manually typed URL instead.  I&#39;ve changed it in the question above - many thanks for pointing this out"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1453274804, "creation_date": 1453274804, "answer_id": 34893890, "question_id": 34891627, "link": "https://stackoverflow.com/questions/34891627/vba-ie-document-empty-error/34893890#34893890", "title": "VBA IE.Document empty error", "body": "<p>Your URL is URL1, try changing that, or just putting the URL in there.</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 3652114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08c43d9ef41d77931129bfb27df72e75?s=128&d=identicon&r=PG", "display_name": "blablubbb", "link": "https://stackoverflow.com/users/3652114/blablubbb"}, "is_accepted": false, "score": 0, "last_activity_date": 1546645667, "last_edit_date": 1546645667, "creation_date": 1468332609, "answer_id": 38331294, "question_id": 34891627, "link": "https://stackoverflow.com/questions/34891627/vba-ie-document-empty-error/38331294#38331294", "title": "VBA IE.Document empty error", "body": "<p>In your code you have the object \"ie\" locally defined in the sub getCard and when this sub finishes,so goes the binding. Also changing from private to public internet zones can remove the binding to that object. What I rather do is use a global object appIE and then when it runs into such an error I catch the error (if TypeName(appIE) = \"Object\" Then FindIE) and find the object again with this sub:</p>\n\n<pre><code>Sub FindIE() 'Needs reference to \"Microsoft Shell Controls And Automation\" from VBA-&gt;Tools-&gt;References\n    Dim sh\n    Dim eachIE\n    Dim SearchUntil\n    SearchUntil = Now() + 20 / 24 / 60 / 60 'Allow to search for 20 seconds otherwise it interrupts search\n    Do\n      Set sh = New Shell32.Shell\n      For Each eachIE In sh.Windows\n        If InStr(1, eachIE.LocationURL, ServerAddress) Then\n          Set appIE = eachIE\n          'IE.Visible = False  'This is here because in some environments, the new process defaults to Visible.\n          'Exit Do\n          End If\n        Next eachIE\n        If TypeName(appIE) &lt;&gt; \"Object\" Then\n            If InStr(1, appIE.LocationURL, ServerAddress) &gt; 0 Or SearchUntil &lt; Now() Then Exit Do\n        End If\n    Loop\n    Set eachIE = Nothing\n    Set sh = Nothing\nEnd Sub\n</code></pre>\n\n<p>This code contains parts of other people here from stackoverflow, but I forgot who to credit for some essential parts of the code. Sorry.</p>\n"}], "owner": {"reputation": 3, "user_id": 5496299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cfc09aa920485556b2aca88420c1951?s=128&d=identicon&r=PG&f=1", "display_name": "brebbles", "link": "https://stackoverflow.com/users/5496299/brebbles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2272, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1546645667, "creation_date": 1453264050, "last_edit_date": 1453287101, "question_id": 34891627, "link": "https://stackoverflow.com/questions/34891627/vba-ie-document-empty-error", "title": "VBA IE.Document empty error", "body": "<p>I've been running a query for a while now getting data from a webpage.  After numerous runs it has decided to stop working, and I've traced the issue back to the ie.document object - it never returns anything.</p>\n\n<p>When compiling my project I see that the \"Document\" element of ie returns an error of \"Applicaiton-defined or Object-defined error\" - even before I navigate to a webpage.  Also some other elements return this error also - namely \"Status Text\" and \"Type\"</p>\n\n<p>The link contains a screenshot of my error:\n<a href=\"https://www.dropbox.com/s/wcxxep8my10nu8h/vba%20ie%20document.jpg?dl=0\" rel=\"nofollow\">https://www.dropbox.com/s/wcxxep8my10nu8h/vba%20ie%20document.jpg?dl=0</a></p>\n\n<p>In case that doesn't work here a scaled back version of the code I'm running </p>\n\n<pre><code>Sub getCard()\n\n    Dim ie As InternetExplorer\n    Dim url1 As String\n\n    url1 = \"google.com\"\n\n    Set ie = New InternetExplorer\n    ie.Visible = True\n    ie.Navigate url1\n    WaitBrowserQuiet ie\n\nEnd Sub\n\nSub WaitBrowserQuiet(objIE As InternetExplorer)\n\nDo While objIE.Busy Or objIE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>As soon as I get to the \"Set ie = New InternetExplorer\" part of the code is when the ie object is created and I see the errors.  If I do happen to navigate to webpage, then the ie.document object is empty.</p>\n\n<p>I've searched around and tried a few things to stop this happening - restarted my computer, run \"ie.quit\" and \"Set ie = Nothing\", reset my Internet Explorer, etc...  Nothing seems to work.</p>\n\n<p>It seems like it may be a deeper issue given I'm getting an error message even before navigating to a webpage.  Hope someone knows how to stop the error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453261292, "post_id": 34890910, "comment_id": 57520454, "body": "First, how you want to merge the files??? Adding all the sheets into a new workbook??? Into an already open workbook??? are all the sheets equals or not?? If the sheets has the same names what you want to do???"}, {"owner": {"reputation": 1, "user_id": 5788263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae83fc4f569ad316ecf5a478af4bd904?s=128&d=identicon&r=PG&f=1", "display_name": "Ze Louise", "link": "https://stackoverflow.com/users/5788263/ze-louise"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453262622, "post_id": 34890910, "comment_id": 57520833, "body": "All the excel files have only one worksheet and have different names. And I want to have a new workbook/sheet for the merged files. Btw, by excel files I mean workbooks. :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5788263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae83fc4f569ad316ecf5a478af4bd904?s=128&d=identicon&r=PG&f=1", "display_name": "Ze Louise", "link": "https://stackoverflow.com/users/5788263/ze-louise"}, "edited": false, "score": 0, "creation_date": 1453267959, "post_id": 34891630, "comment_id": 57522409, "body": "Thank you for the code. However, I got an error from the line  sht.Copy Before:=AllB.Sheets(Sheets.Count) &#39;send it to the end of the sheets It says that the subscript is out of range."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 1, "user_id": 5788263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae83fc4f569ad316ecf5a478af4bd904?s=128&d=identicon&r=PG&f=1", "display_name": "Ze Louise", "link": "https://stackoverflow.com/users/5788263/ze-louise"}, "edited": false, "score": 0, "creation_date": 1453268427, "post_id": 34891630, "comment_id": 57522541, "body": "How many books you import??? Which version of excel are you using??? Did you run the code using F8 (step by step) or any button (let the macro run)???"}, {"owner": {"reputation": 1, "user_id": 5788263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae83fc4f569ad316ecf5a478af4bd904?s=128&d=identicon&r=PG&f=1", "display_name": "Ze Louise", "link": "https://stackoverflow.com/users/5788263/ze-louise"}, "edited": false, "score": 0, "creation_date": 1453268581, "post_id": 34891630, "comment_id": 57522595, "body": "Currently, I have 5 workbooks but the program should be flexible, merging different numbers of workbooks. I&#39;m using Excel 2010. When running the code, I just press F5. I&#39;m using a userform."}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1453264053, "creation_date": 1453264053, "answer_id": 34891630, "question_id": 34890910, "link": "https://stackoverflow.com/questions/34890910/how-do-i-merge-multiple-selected-excel-files-in-vba/34891630#34891630", "title": "How do I merge multiple selected excel files in VBA?", "body": "<p>Well here is my code... hope this help you. </p>\n\n<pre><code>    Sub mergeAllFiles()\n\n    Dim This As Workbook 'Store the book with the macro\n    Dim TmpB As Workbook 'store the book that has the sheets (one per book)\n    Dim AllB As Workbook 'book to send all the books\n    Dim sht As Worksheet 'the only sheet every book\n\n    Dim FileNames As Variant\n    Dim Msg As String\n    Dim I As Integer\n\n    Set This = ThisWorkbook\n    FileNames = Application.GetOpenFilename(MultiSelect:=True)\n    If IsArray(FileNames) Then\n        Workbooks.Add 'add a new book to store all the sheets\n        Set AllB = ActiveWorkbook\n        AllB.SaveAs This.Path &amp; \"\\allSheetsInOne\" &amp; SetTimeName &amp; \".xlsx\", 51\n        'The function is to store a different name every time and avoid error\n        Msg = \"You selected:\" &amp; vbNewLine\n\n        For I = LBound(FileNames) To UBound(FileNames)\n            Workbooks.Open Filename:=FileNames(I)\n            Set TmpB = ActiveWorkbook\n            TmpB.Activate\n            Set sht = ActiveSheet 'because you say that the book has only one sheet\n            sht.Copy Before:=AllB.Sheets(Sheets.Count) 'send it to the end of the sheets\n            TmpB.Close 'we don't need the book anymore\n            Set TmpB = Nothing 'empty the var to use it again\n            Set sht = Nothing\n            Msg = Msg &amp; FileNames(I) &amp; vbNewLine\n        Next I\n        MsgBox Msg\n        tbPath.Value = Msg\n    Else\n        MsgBox \"No files were selected.\"\n    End If\nEnd Sub\n\n\nFunction SetTimeName()\nDim YY\nDim MM\nDim DD\nDim HH\nDim MI\nDim SS\nDim TT\n\nYY = Year(Date)\nMM = Month(Date)\nDD = Day(Date)\nHH = Hour(Now)\nMI = Minute(Now)\nSS = Second(Now)\n\nTT = Format(YY, \"0000\") &amp; Format(MM, \"00\") &amp; Format(DD, \"00\") &amp; Format(HH, \"00\") &amp; Format(MI, \"00\") &amp; Format(SS, \"00\")\n\nSetTimeName = TT\nEnd Function\n</code></pre>\n\n<p>Tell me if is need it any improvement. </p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1453274380, "creation_date": 1453274380, "answer_id": 34893776, "question_id": 34890910, "link": "https://stackoverflow.com/questions/34890910/how-do-i-merge-multiple-selected-excel-files-in-vba/34893776#34893776", "title": "How do I merge multiple selected excel files in VBA?", "body": "<h2>Use my code from here:</h2>\n\n<p><a href=\"http://www.xlorate.com/vba-examples.html#Open%20Multiple%20Files\" rel=\"nofollow\">Multi-Select Files and open</a></p>\n\n<p>Edit the code to suite your requirements.</p>\n\n<pre><code>Sub OPenMultipleWorkbooks()\n'Open Multiple .xlsx files\n    Application.DisplayAlerts = False\n    Dim wb As Workbook, bk As Workbook\n    Dim sh As Worksheet\n    Dim GetFile As Variant, Ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set sh = wb.ActiveSheet\n\n    For Each Sheet In Sheets\n        If Sheet.Name &lt;&gt; sh.Name Then Sheet.Delete\n    Next Sheet\n\n    ChDrive \"C:\"\n    Application.ScreenUpdating = False\n\n    GetFile = Application.GetOpenFilename(FileFilter:=\"XLSX(*.xlsx), *.xlsx\", Title:=\"Open XLSX- File\", MultiSelect:=True)\n\n    On Error Resume Next\n\n    If GetFile &lt;&gt; False Then\n\n        On Error GoTo 0\n\n        For i = 1 To UBound(GetFile)\n\n            Set bk = Workbooks.Open(GetFile(i))\n            Sheets(1).Move Before:=wb.Sheets(1)\n            bk.Close True\n        Next i\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5788263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ae83fc4f569ad316ecf5a478af4bd904?s=128&d=identicon&r=PG&f=1", "display_name": "Ze Louise", "link": "https://stackoverflow.com/users/5788263/ze-louise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2036, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453274380, "creation_date": 1453259559, "last_edit_date": 1453260982, "question_id": 34890910, "link": "https://stackoverflow.com/questions/34890910/how-do-i-merge-multiple-selected-excel-files-in-vba", "title": "How do I merge multiple selected excel files in VBA?", "body": "<p>I'm new with VBA and I'm wondering on how to merge multiple selected excel files using VBA. I tried coding the part of selecting files. I've researched and tried copying the codes on the internet and did some editing. I learned that you can add filters so I did that. But sometimes, the excel files won't show even if I added the correct filter (based on what I've researched). I really need to merge multiple selected excel files. I hope you can help me.</p>\n\n<p>I'm using a userform, btw. One button that would allow to select and merge the selected files. And if possible, I want the user to see the path of the selected files. I don't know yet on how to do that, or what tool should I use, like listbox or what. Thanks in advance!</p>\n\n<p><strong>Update!</strong></p>\n\n<p>I have a code for selecting multiple excel files. What I need now is how to merge the files that I selected.</p>\n\n<pre><code>Dim FileNames As Variant\n  Dim Msg As String\n  Dim I As Integer\n  FileNames = Application.GetOpenFilename(MultiSelect:=True)\n  If IsArray(FileNames) Then\n      Msg = \"You selected:\" &amp; vbNewLine\n      For I = LBound(FileNames) To UBound(FileNames)\n          Msg = Msg &amp; FileNames(I) &amp; vbNewLine\n      Next I\n      MsgBox Msg\n      tbPath.Value = Msg\n  Else\n      MsgBox \"No files were selected.\"\n  End If\n</code></pre>\n"}, {"tags": ["xml", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453262005, "post_id": 34890655, "comment_id": 57520660, "body": "You absolutely could use <code>%</code> in reading/writing file names. Be sure you use entire path name in <code>Load</code> statement."}, {"owner": {"reputation": 171, "user_id": 5813533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f02eab9c7c4253b57a3035d448f9ca98?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Paisner", "link": "https://stackoverflow.com/users/5813533/mike-paisner"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453306769, "post_id": 34890655, "comment_id": 57546333, "body": "However, it absolutely does not work.  Also tried escaping the % with another % and it still can&#39;t find the file:  HelloWorld%%2Ecom.xml gives the same error..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453306978, "post_id": 34890655, "comment_id": 57546482, "body": "How about using the Replace function within your code (so that you don&#39;t need to change the actual file names) to replace the % with a space: strFileName = Replace(filename, &quot;%&quot;, &quot; &quot;)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453310116, "post_id": 34890655, "comment_id": 57548656, "body": "@MikePaisner, I tested to be sure by adding a percent to an existing xml file and loaded without error. Windows file paths disallow the following <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">reserved characters</a>: &lt; &gt; : &quot; / \\ | ? *. Again, check <b>full</b> path. Does such a file exist in a CPU directory (not URL)?"}, {"owner": {"reputation": 171, "user_id": 5813533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f02eab9c7c4253b57a3035d448f9ca98?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Paisner", "link": "https://stackoverflow.com/users/5813533/mike-paisner"}, "edited": false, "score": 0, "creation_date": 1453319442, "post_id": 34890655, "comment_id": 57554153, "body": "My code works for all files in the folder except ones with % sign in filename, so the path is good.  When I manually remove % from filename, then it works fine.  I tried using filesystemobject to rename the file using the move command, but I get the same error.  I cannot programmatically rename a file with the % sign in the name because it cannot find that file."}, {"owner": {"reputation": 171, "user_id": 5813533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f02eab9c7c4253b57a3035d448f9ca98?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Paisner", "link": "https://stackoverflow.com/users/5813533/mike-paisner"}, "edited": false, "score": 0, "creation_date": 1453335643, "post_id": 34890655, "comment_id": 57561842, "body": "To clarify, it is not just the % sign in the filename that causes the problem.  It is only when a URL code is in the filename like %2E is in the filename."}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 5813533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f02eab9c7c4253b57a3035d448f9ca98?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Paisner", "link": "https://stackoverflow.com/users/5813533/mike-paisner"}, "is_accepted": false, "score": 2, "last_activity_date": 1453341998, "creation_date": 1453341998, "answer_id": 34914168, "question_id": 34890655, "link": "https://stackoverflow.com/questions/34890655/vba-xml-file-load-error-when-filename-has-url-encoding/34914168#34914168", "title": "VBA XML file load error when filename has URL encoding", "body": "<p>Finally figured it out.  Needed to urlencode the filename before loading.</p>\n\n<p>Instead of this line above:</p>\n\n<pre><code>objXML.Load filename\n</code></pre>\n\n<p>I changed it to the following:</p>\n\n<pre><code>dim encodedName as String\nencodedName = WorksheetFunction.EncodeURL(filename)\nobjXML.Load encodedName\n</code></pre>\n\n<p>Thanks,\nMike</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1453343722, "creation_date": 1453343722, "answer_id": 34914424, "question_id": 34890655, "link": "https://stackoverflow.com/questions/34890655/vba-xml-file-load-error-when-filename-has-url-encoding/34914424#34914424", "title": "VBA XML file load error when filename has URL encoding", "body": "<p>Additionally, escape the percent sign with <code>%25</code>:</p>\n\n<pre><code>filename = \"HelloWorld%252Ecom.xml\"\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5813533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f02eab9c7c4253b57a3035d448f9ca98?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Paisner", "link": "https://stackoverflow.com/users/5813533/mike-paisner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1453343722, "creation_date": 1453257838, "question_id": 34890655, "link": "https://stackoverflow.com/questions/34890655/vba-xml-file-load-error-when-filename-has-url-encoding", "title": "VBA XML file load error when filename has URL encoding", "body": "<p>I'm working in VBA and using Msxml2.DOMDocument.6.0 to read and parse XML files.  It is mostly working, except some filenames have URL style encoding in the filenames.  For example, a filename is like:</p>\n\n<p>HelloWorld%2Ecom.xml</p>\n\n<p>My code cannot find the file when I try to load this.  Here is a simplified version of my code:</p>\n\n<pre><code>Dim filename as String\nfilename = \"HelloWorld%2Ecom.xml\" ' This variable is actually populated dynamically\nDim objXML As Variant\nSet objXML = CreateObject(\"Msxml2.DOMDocument.6.0\")\nobjXML.async = True\nobjXML.Load filename\n</code></pre>\n\n<p>The specific error I get during the Load operation is:</p>\n\n<p>Error while loading XML file: The system cannot locate the object specified.</p>\n\n<p>If I manually remove the % sign from the filename, the file loads fine.  However, I really need to keep the original filenames.</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<p>Mike</p>\n"}, {"tags": ["c#", "vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 657, "user_id": 5551222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec7ed5c4152d7ad7cc9358d60d33d62?s=128&d=identicon&r=PG", "display_name": "Baronz", "link": "https://stackoverflow.com/users/5551222/baronz"}, "is_accepted": true, "score": 0, "last_activity_date": 1453260480, "last_edit_date": 1453260480, "creation_date": 1453259113, "answer_id": 34890839, "question_id": 34890101, "link": "https://stackoverflow.com/questions/34890101/convert-visio-vba-method-into-c/34890839#34890839", "title": "convert visio vba method into c#", "body": "<p>I created a visio doc and drew 3 simple shapes.  I then created a layer called \"cool\" and added those 3 shapes to it.</p>\n\n<p>I don't understand enough about the shape selection, you had <code>visSelModeOnlySuper</code> which may work for you, but did not work for the case I created.  The default is <code>visSelModeSkipSuper</code> (which worked for me)</p>\n\n<p>Here's the API page that describes how to use the <code>createSelection</code>:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff765565.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff765565.aspx</a></p>\n\n<p>Here is my sample code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Text;\nusing Visio = Microsoft.Office.Interop.Visio;\n\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        //create the object that will do the drawing\n        VisioDrawer Drawer = new VisioDrawer();\n        Drawer.selectShpLayer(\"cool\");\n\n    }\n}\n\nclass VisioDrawer\n{\n    public Visio.Application VisApp;\n    public static Visio.Page acPage;\n    public Visio.Selection LayerSelection;\n    public VisioDrawer()\n    {\n\n        //create the application\n        VisApp = new Visio.Application();\n        VisApp.Documents.Open(@\"c:\\temp\\trial.vsdm\");\n        acPage = VisApp.ActivePage;\n    }\n\n\n\n    public void selectShpLayer(string layerName)\n    {\n        int i = 0;\n        int[] lngRowIDs;\n        Array lngRowIDArray;\n        //this selects the shapes of the selected layer\n        LayerSelection = acPage.CreateSelection(Microsoft.Office.Interop.Visio.VisSelectionTypes.visSelTypeByLayer, Microsoft.Office.Interop.Visio.VisSelectMode.visSelModeSkipSuper, layerName);\n        LayerSelection.GetIDs(out lngRowIDArray);\n        lngRowIDs = (int[])lngRowIDArray;\n        for (i = 0; i &lt; lngRowIDs.Length; i++)\n        {\n            Debug.Write(\"Object ID: \" + lngRowIDs[i].ToString() + \"\\n\");\n        }\n    }\n}\n</code></pre>\n\n<p>And it produces this output:</p>\n\n<pre><code>Object ID: 1\nObject ID: 2\nObject ID: 3\n</code></pre>\n\n<p>If you change the debug line to this:</p>\n\n<pre><code>Debug.Write(\"Object ID: \" + lngRowIDs[i].ToString() + \" -- \" + acPage.Shapes.ItemFromID[i].Name + \"\\n\");\n</code></pre>\n\n<p>The output gets even more useful:</p>\n\n<pre><code>Object ID: 1 -- ThePage\nObject ID: 2 -- Circle\nObject ID: 3 -- Rectangle\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5075952, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a251d55c8fba2a278b9a605f9cc892f?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte Au", "link": "https://stackoverflow.com/users/5075952/charlotte-au"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 34890839, "answer_count": 1, "score": 1, "last_activity_date": 1593542368, "creation_date": 1453254129, "last_edit_date": 1593542368, "question_id": 34890101, "link": "https://stackoverflow.com/questions/34890101/convert-visio-vba-method-into-c", "title": "convert visio vba method into c#", "body": "<p>Hello I would like to convert this vba method into C#. I am trying to get the IDs of a selection and print them out. In particular I am having trouble converting the GetIDs() method(a built in method within visio vba) into C#. </p>\n\n<pre><code>Public Sub getCapabilityRectIDs()\n\n    Dim vsoSelection1 As Visio.Selection\n    Dim selectionIDs() As Long\n\n\n    Set vsoSelection1 = Application.ActiveWindow.Page.CreateSelection(visSelTypeByLayer, visSelModeSkipSuper, \"Capability\")\n    Application.ActiveWindow.Selection = vsoSelection1\n    Call vsoSelection1.GetIDs(selectionIDs)\n    For i = 0 To UBound(selectionIDs)\n        Debug.Print selectionIDs(i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This is what I have so far in C#</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Text;\nusing Visio = Microsoft.Office.Interop.Visio;\n\n\nclass Program\n    {\n        static void Main(string[] args)\n        {\n            //create the object that will do the drawing\n             VisioDrawer Drawer = new VisioDrawer();\n             Drawer.selectShpLayer(\"Capability\");\n\n        }\n    }\n\n    class VisioDrawer\n    {\n        public Visio.Application VisApp;\n        public static Visio.Page acPage;\n        public Visio.Selection LayerSelection;\n        public VisioDrawer()\n        {   \n\n            //create the application\n            VisApp = new Visio.Application();\n            VisApp.Documents.Open(@\"............. - abc.vsdm\");\n            ActiveDoc = VisApp.ActiveDocument;\n            acPage = VisApp.ActivePage;\n        }\n\n\n\n         public void selectShpLayer (string layerName){\n            Int i = 0;\n            long[] lngRowIDs;\n            //this selects the shapes of the selected layer\n            LayerSelection = acPage.CreateSelection(Microsoft.Office.Interop.Visio.VisSelectionTypes.visSelTypeByLayer, Microsoft.Office.Interop.Visio.VisSelectMode.visSelModeOnlySuper,layerName);\n            LayerSelection.GetIDs(lngRowIDs);\n            for (i = 0; i &lt; lngRowIDs.Length; i++)\n            {\n                Debug.Write(lngRowIDs[i]);\n            }\n        }\n    }\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1453253116, "post_id": 34889921, "comment_id": 57518291, "body": "VB.Net IsNot vba AndAlso VBNet.HasMacros() = False"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1453253528, "post_id": 34889921, "comment_id": 57518399, "body": "Try <code>searchDir thisWorkbook.Path</code>. but Why this loop <code>For lngRow = 1 To lngTMP</code>??"}, {"owner": {"reputation": 13, "user_id": 5813314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5310cb65044182abc8c9b935b8afa3f?s=128&d=identicon&r=PG&f=1", "display_name": "Qurillion", "link": "https://stackoverflow.com/users/5813314/qurillion"}, "edited": false, "score": 0, "creation_date": 1453254610, "post_id": 34889921, "comment_id": 57518650, "body": "Thanks that appears to work, I will continue to test it."}], "owner": {"reputation": 13, "user_id": 5813314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5310cb65044182abc8c9b935b8afa3f?s=128&d=identicon&r=PG&f=1", "display_name": "Qurillion", "link": "https://stackoverflow.com/users/5813314/qurillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1453257318, "creation_date": 1453252913, "last_edit_date": 1453257318, "question_id": 34889921, "link": "https://stackoverflow.com/questions/34889921/search-the-current-folder", "title": "Search the current folder", "body": "<p>This Excel VBA code creates hyperlinks to a list of items in Column A, to corresponding folder names from a FIXED location. For example:</p>\n\n<pre><code> Room101 is hyperlinked to C:\\Files\\Pictures\\Room101\n\n Room102 is hyperlinked to C:\\Files\\Pictures\\Room102\n\n Room103 is hyperlinked to C:\\Files\\Pictures\\Room103\n</code></pre>\n\n<p>I have been trying to redesign the folder destination to be more dynamic, specifically <strong>the search folder should be the Excel file's current folder.</strong> Please see the code below on line 7:</p>\n\n<pre><code>Option Explicit\nDim lngRow\n\nPublic Sub Aufruf()\n    Dim lngTMP As Long\n    lngTMP = ActiveSheet.Cells(Cells(Rows.Count, \"A\").End(xlUp).Row, 1).Row\n    For lngRow = 1 To lngTMP\n        searchDir \"M:\\Pictures\" 'fixed folder location\n    Next lngRow\nEnd Sub\n\nPrivate Sub searchDir(strDir)\n    Dim objSubDir As Object\n    Dim strName As String\n    Dim objFSO As Object\n    Dim objDir As Object\n    On Error Resume Next\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objDir = objFSO.getfolder(strDir)\n    For Each objSubDir In objDir.subfolders\n        strName = StrReverse(Split(StrReverse(objSubDir.Path), \"\\\")(0))\n        If strName = Cells(lngRow, 1).Text Then\n            ActiveSheet.Hyperlinks.Add Anchor:=Cells(lngRow, 1), Address:= _\n                objSubDir.Path &amp; \"\\\", TextToDisplay:=Cells(lngRow, 1).Text\n                Exit Sub\n        End If\n        searchDir objSubDir\n    Next\n    Set objFSO = Nothing\n    Set objDir = Nothing\nEnd Sub\n</code></pre>\n\n<p>You will notice that the file path is fixed to \"M:\\Pictures\". </p>\n\n<p>How do I search the folder the Excel document is saved in? I have attempted to use variations of:</p>\n\n<pre><code>path = ActiveWorkbook.Path\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1453250433, "post_id": 34889521, "comment_id": 57517481, "body": "Run a regular for loop backwards <code>for I = filelastrow to 6 step -1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "edited": false, "score": 0, "creation_date": 1453252501, "post_id": 34889634, "comment_id": 57518119, "body": "Thanks a lot Scott!  after some tinkering this worked perfectly!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1453259845, "last_edit_date": 1453259845, "creation_date": 1453251029, "answer_id": 34889634, "question_id": 34889521, "link": "https://stackoverflow.com/questions/34889521/for-loop-to-delete-rows/34889634#34889634", "title": "For loop to delete rows", "body": "<p>As per my comments, change the for loop to this:</p>\n\n<pre><code>For i = filelastrow to 6 step -1\n   If Sheet1.Cells(i,6) = \"Invoice.zip\" Or Sheet1.Cells(i,6)  = \"Thumbs.db\" Then\n        Sheet1.row(i).Delete\n   End If\nNext File\n</code></pre>\n\n<p>The issue is that when  a row gets deleted the one below becomes that row and the loop then skips it as it moves to the next.  It also will then move through empty rows on the end.</p>\n\n<p>By going backwards this problem is eliminated.</p>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "edited": false, "score": 0, "creation_date": 1453306214, "post_id": 34892113, "comment_id": 57545927, "body": "Thanks a lot!! i&#39;ll keep this in mind for future projects.  I laughed hard at the Message Box portion lol."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453502828, "post_id": 34892113, "comment_id": 57646060, "body": "I enjoyed the short screencast. Definitely worth watching."}], "tags": [], "owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1453267245, "creation_date": 1453267245, "answer_id": 34892113, "question_id": 34889521, "link": "https://stackoverflow.com/questions/34889521/for-loop-to-delete-rows/34892113#34892113", "title": "For loop to delete rows", "body": "<p>Great question! @Scott Craner's answer does the trick nicely (upvoted btw), and you wind up with a readable, effective slice of VBA. Good stuff!</p>\n\n<p>There is another way to delete rows quickly that I think deserves a shake: the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\"><code>Range.Autofilter</code></a> strategy! Check it out, with the Autofilter strategy starting with comments below:</p>\n\n<pre><code>Public Sub DeleteRowsWithAutofilter()\n\n    Dim ContractNum As String\n    Dim InvNum As String\n    Dim FileRng As Range\n    Dim FileLastRow As Long\n    Dim File As Range\n    Dim t As Single\n    t = Timer\n\n    FileLastRow = Sheet2.Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\n    'Identify the total range of filenames, including the header\n    Set FileRng = Sheet2.Range(\"F5:F\" &amp; FileLastRow)\n\n    'Use the .Autofilter method to crush those\n    'annoying 'Thumbs.db' or 'Invoice.zip' rows\n    Application.DisplayAlerts = False\n    With FileRng\n        .AutoFilter Field:=1, Criteria1:=\"Thumbs.db\", _\n                              Operator:=xlOr, _\n                              Criteria2:=\"Invoice.zip\"\n        .Offset(1, 0).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Rows.Delete\n    End With\n    Application.DisplayAlerts = True\n\n    'Turn off the autofilter safely\n    With Sheet2\n        .AutoFilterMode = False\n        If .FilterMode = True Then\n            .ShowAllData\n        End If\n    End With\n\n    MsgBox \"Damn son! 'Autofilter' strategy completed in \" &amp; Timer - t &amp; \" seconds.\"\n\nEnd Sub\n</code></pre>\n\n<p>I recorded a short screencast that demonstrates both techniques (the <code>For</code> loop and the <code>Range.Autofilter</code>) here:</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=1U7Ay5voVOE\" rel=\"nofollow\">https://www.youtube.com/watch?v=1U7Ay5voVOE</a></p>\n\n<p>Hope that helps as you continue to develop your script!</p>\n"}], "owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 34889634, "answer_count": 2, "score": 3, "last_activity_date": 1453267245, "creation_date": 1453250153, "last_edit_date": 1453252117, "question_id": 34889521, "link": "https://stackoverflow.com/questions/34889521/for-loop-to-delete-rows", "title": "For loop to delete rows", "body": "<p>I'm using a macro that lists all of the filenames in whatever directory I choose.  I'm writing code that will break apart the file name into chunks that I can use later.  The list of filenames starts at cell F6 and runs down the column.  Here is the code that I've written so far:</p>\n\n<pre><code>Dim ContractNum As String\nDim InvNum As String\nDim FileRng As Range\nDim FileLastRow As Long\nDim File As Range\n\nFileLastRow = Sheet1.Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\nSet FileRng = Sheet1.Range(\"F6:F\" &amp; FileLastRow).SpecialCells(xlCellTypeConstants, 23)\n\nFor Each File In FileRng\nIf File = \"Invoice.zip\" Or File = \"Thumbs.db\" Then\n    File.EntireRow.Delete\nEnd If\nNext File\n\n\nFor Each File In FileRng\n    ContractNum = Left(File, 4)\n    InvNum = Mid(File, 8, 6)\n    File.Offset(0, -5) = ContractNum\n    File.Offset(0, -4) = InvNum\nNext File\n</code></pre>\n\n<p>So far I've got that part working fine.  The problem I'm having is that in all of the directories ill use this macro with, there are unwanted files such as \"Thumbs.db\" or \"Invoice.zip\".  The code I'm having a problem with is below:</p>\n\n<pre><code>For Each File In FileRng\nIf File = \"Invoice.zip\" Or File = \"Thumbs.db\" Then\n    File.EntireRow.Delete\nEnd If\nNext File\n</code></pre>\n\n<p>What I'm wanting this to do is scan through the entire list of filenames and if it encounters a filename of \"Thumbs.db\" or \"Invoice.zip\", delete the entire row.  So far, this works...kinda.  For example, if there are two files in my list that are named \"Thumbs.db\" and \"Invoice.zip\", I have to run the macro twice to remove both. Obviously, I would like to wipe them all out in one swoop.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1453249646, "post_id": 34889392, "comment_id": 57517263, "body": "A quick google search turned <a href=\"https://technet.microsoft.com/en-us/library/ee692875.aspx\" rel=\"nofollow noreferrer\">this</a> up."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453308782, "post_id": 34889392, "comment_id": 57547765, "body": "Please post the code that you have so far. Your problem description isn&#39;t exact enough for us to repro what you have and what you want to do. Please also provide some examples of what you need to find."}], "answers": [{"tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": false, "score": 0, "last_activity_date": 1453348319, "last_edit_date": 1453348319, "creation_date": 1453303355, "answer_id": 34903903, "question_id": 34889392, "link": "https://stackoverflow.com/questions/34889392/delete-all-occurrences-of-string-in-selected-text/34903903#34903903", "title": "Delete all occurrences of string in selected text", "body": "<pre><code>Sub formattedtext()\nDim rng As Range\nWith ActiveDocument.Range\nSet rng = Selection.Range\nWith rng.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = False\n    .Text = \"()\"\n    .Replacement.Text = \"\"\n    .Execute Replace:=wdReplaceAll\n\nEnd With\nSet rng = Nothing\nEnd With\nEnd Sub\n</code></pre>\n\n<p>If you mean double bracket containing words like <code>in the ((end)) it doesn't even matter.</code> you can replace </p>\n\n<pre><code>.MatchWildcards = False\n.Text = \"()\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>.MatchWildcards = True\n.Text = \"\\(\\([A-Za-z 0-9\u03b1-\u03c9,^13*.;:'\"]{1,}\\)\\)\"\n</code></pre>\n\n<p>this will match any words between (()). You can replace the content in [] in .Text string to match your need.</p>\n"}], "owner": {"reputation": 31, "user_id": 4151126, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8731541ee1be68210908a7ae034cfe5a?s=128&d=identicon&r=PG&f=1", "display_name": "rkent", "link": "https://stackoverflow.com/users/4151126/rkent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453348319, "creation_date": 1453249314, "last_edit_date": 1453331167, "question_id": 34889392, "link": "https://stackoverflow.com/questions/34889392/delete-all-occurrences-of-string-in-selected-text", "title": "Delete all occurrences of string in selected text", "body": "<p>I want to delete all occurrences of double brackets containing words in a selected block of text only and not an entire document.  Within the same selected block of text, I want to find one of three specific strings, delete the string, and insert a tab where the string was formerly located.</p>\n\n<p>I worked with the Record Macro function to get the code for finding the double bracket occurrences and the specific strings, but as soon as I go to delete the found occurrence, the selection changes such that I can no longer search my original selected block of text only.</p>\n\n<p>My problem is how to string together essentially 4 searches - 3 being exact strings that get deleted/replaced by a tab and 1 being a wildcard search - with all 4 of the searches limited to a block of text that is selected when I begin execution of the macro.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4080643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edd16edeff9374543c26942d948b67d4?s=128&d=identicon&r=PG&f=1", "display_name": "tstruss912", "link": "https://stackoverflow.com/users/4080643/tstruss912"}, "edited": false, "score": 0, "creation_date": 1453253321, "post_id": 34889461, "comment_id": 57518344, "body": "Works perfect.  As you can see, I had some tiny thought in my head that it might need to be double, so I changed the return type, but forgot to change the internal variable.  Embarrassing and just pathetic thinking on my part.  Thanks so much for your succinct, accurate and prompt response!  May the programming gods have mercy on my soul...."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1453250528, "last_edit_date": 1453250528, "creation_date": 1453249710, "answer_id": 34889461, "question_id": 34889311, "link": "https://stackoverflow.com/questions/34889311/excel-public-function-returns-value-for-certain-numbers/34889461#34889461", "title": "Excel Public Function Returns &quot;VALUE#&quot; for Certain Numbers", "body": "<p>Change the variable <code>milesInt</code> from being type <code>Integer</code> to type <code>Double</code>. You are overflowing the integer variable.</p>\n\n<p>In VBA, <code>Integer</code> variables are 16-bit, with values split between positive and negative, so the largest positive number which can stored is 2^15-1 = 32767. This is why your function couldn't handle 40,000. Since your function returns a double, it makes sense to declare that variable as <code>Double</code>. The other <code>Integer</code> variables can be declared to be <code>Long</code> (even if overflow isn't a danger). With modern machines there really isn't much point in using 16-bit integer variables in VBA.</p>\n"}], "owner": {"reputation": 23, "user_id": 4080643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edd16edeff9374543c26942d948b67d4?s=128&d=identicon&r=PG&f=1", "display_name": "tstruss912", "link": "https://stackoverflow.com/users/4080643/tstruss912"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 34889461, "answer_count": 1, "score": 2, "last_activity_date": 1453370074, "creation_date": 1453248850, "last_edit_date": 1453370074, "question_id": 34889311, "link": "https://stackoverflow.com/questions/34889311/excel-public-function-returns-value-for-certain-numbers", "title": "Excel Public Function Returns &quot;VALUE#&quot; for Certain Numbers", "body": "<p>I'm making a simple Excel sheet for me and my dad, brothers, etc to keep track of car maintenance.  I have some programming background but not enough to figure out this issue.  The issue is that when certain number strings are pulled in to the function and then put into the equation, it gives a #VALUE! error.  See below for and example:</p>\n\n<p>Cell B9: Replace @ miles:185555</p>\n\n<p>Cell D9: 41446</p>\n\n<p>Cell E9: =IF($G$2-$D9>=getMiles(B9),\"SERVICE!\",\"OK\")</p>\n\n<p>Cell G2: 60000</p>\n\n<p>If I enter 18555 in E9, I get \"OK\" instead of the error.</p>\n\n<p>If I enter 40000, I get the error.  </p>\n\n<p>Also, this happens if I change the equation to nothing more than =getMiles(B9).  Same exact thing.  It's not the number of digits, obviously.  But, anything over a certain amount seems to trigger the error.  I don't know if it's a hex thing or bug, or my code.  Please help.  See below for the miles equation and feel free to download the excel sheet from my link.  Thanks in advance for your efforts.</p>\n\n<pre><code>Public Function getMiles(cellie As String) As Double\n\nDim pos As Integer\nDim milesStr As String\nDim milesTrimmedStr As String\nDim milesInt As Integer\nDim number As Integer\n\npos = InStr(cellie, \"miles:\")\nnumber = pos + 6\nmilesStr = Mid(cellie, number, 7)\nmilesTrimStr = Trim(milesStr)\nmilesInt = CDbl(Val(milesTrimStr))\n\ngetMiles = milesInt\n\n\nEnd Function\n</code></pre>\n\n<p>Link to my Excel file: <a href=\"https://filedropper.com/filemanager/public.php?service=files&amp;t=1c6edf91310c639743bfcd09b0fbb80c\" rel=\"nofollow\">https://filedropper.com/filemanager/public.php?service=files&amp;t=1c6edf91310c639743bfcd09b0fbb80c</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5812930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969de5c44279a1eb562cfa0880a106f0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/5812930/andrew"}, "edited": false, "score": 0, "creation_date": 1453246631, "post_id": 34888671, "comment_id": 57516289, "body": "That worked thanks! :-)  I am still puzzled as to why .Select worked when using F8 to step through but not normally"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "reply_to_user": {"reputation": 53, "user_id": 5812930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969de5c44279a1eb562cfa0880a106f0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/5812930/andrew"}, "edited": false, "score": 0, "creation_date": 1453247515, "post_id": 34888671, "comment_id": 57516608, "body": "When debugging the application makes modifications to the state of your machine, so it runs differently than it debugs."}], "tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1453244884, "creation_date": 1453244884, "answer_id": 34888671, "question_id": 34888545, "link": "https://stackoverflow.com/questions/34888545/run-time-error-1004-select-method-of-worksheet-class-failed-with-varcellconten/34888671#34888671", "title": "Run Time error 1004: Select Method of Worksheet class failed with (varCellContent.Parent.Name)", "body": "<pre><code>Worksheets(\"Sheet1\").Activate\nColumns(\"E:I\").Delete Shift:=xlToLeft\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5812930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969de5c44279a1eb562cfa0880a106f0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/5812930/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 884, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457328417, "creation_date": 1453244257, "last_edit_date": 1531164843, "question_id": 34888545, "link": "https://stackoverflow.com/questions/34888545/run-time-error-1004-select-method-of-worksheet-class-failed-with-varcellconten", "title": "Run Time error 1004: Select Method of Worksheet class failed with (varCellContent.Parent.Name)", "body": "<p>The code edits, then copies data from a temporary sheet to the current workbook.  I am using varCellContent to ask the user to choose the source sheet.  I had no trouble when testing the code as I was building it by using F8 to step through (and the code still works perfectly like this).</p>\n\n<p>But when I run the macro normally, I am getting </p>\n\n<blockquote>\n  <p>Run Time error 1004: Select Method of Worksheet class failed</p>\n</blockquote>\n\n<p>on the following line:</p>\n\n<pre><code>Workbooks(varCellContent.Parent.Name).Worksheets(\"Sheet1\").Select\n</code></pre>\n\n<p>The following may not be relevant to the cause of the problem but I have read a bit about it while searching for an answer.\nIt sounds like using .Select is not a good idea, but there are 2 reasons I thought it was useful in this situation.</p>\n\n<ol>\n<li>I don't have to name the sheet for each of the following rows of code that delete and move the columns.</li>\n<li>When building and debugging the code I wanted the sheet to be visible so that I could see what was happening as I stepped through each line of code.</li>\n</ol>\n\n<p>So taking those 2 reasons into account is there still a better way to avoid using .Select?</p>\n\n<pre><code>Sub ImportNewData()\n'\n'\n' Import data, save as new workbook\n\nDim LR As Long\n    LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    ' Clear data\n    Range(\"A3:I\" &amp; LR).ClearContents\n\n   ' User choose source sheet\n    Dim varCellContent As Worksheet\n    Set varCellContent = Application.InputBox _\n        (prompt:=\" \" &amp; vbNewLine &amp; \"Click any cell in the Aged AP Summary that has been exported from Systematic to Excel, then click OK\", Type:=8).Parent\n\n    Workbooks(varCellContent.Parent.Name).Worksheets(\"Sheet1\").Select\n\n   'Delete unrequired columns\n    Columns(\"E:I\").Select\n    Selection.Delete Shift:=xlToLeft\n</code></pre>\n"}, {"tags": ["arrays", "vba", "class"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453243948, "post_id": 34888409, "comment_id": 57515362, "body": "What are the cb1/2 objects?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1453247548, "post_id": 34888409, "comment_id": 57516615, "body": "Would be useful if you include the code you used to print the values"}, {"owner": {"reputation": 19, "user_id": 5741557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cfeac1d959a8659cd1184d8ddcf951?s=128&d=identicon&r=PG&f=1", "display_name": "m.T", "link": "https://stackoverflow.com/users/5741557/m-t"}, "edited": false, "score": 0, "creation_date": 1453247814, "post_id": 34888409, "comment_id": 57516705, "body": "Print code is now included"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1453248694, "post_id": 34888409, "comment_id": 57517004, "body": "I can see the value in the Locals window, but it prints a null string. <a href=\"http://i.imgur.com/6Fg5GBv.png\" rel=\"nofollow noreferrer\">i.imgur.com/6Fg5GBv.png</a>  Is this what you&#39;re experiencing?"}, {"owner": {"reputation": 19, "user_id": 5741557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cfeac1d959a8659cd1184d8ddcf951?s=128&d=identicon&r=PG&f=1", "display_name": "m.T", "link": "https://stackoverflow.com/users/5741557/m-t"}, "edited": false, "score": 0, "creation_date": 1453249559, "post_id": 34888409, "comment_id": 57517242, "body": "I get null strings printed to the immediate window and my locals window is empty. I just want to check that these arrays are storing the TextBox entries. I&#39;m able to store the entries in other variables and print to the immediate window, just struggling with the arrays"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453328426, "post_id": 34888409, "comment_id": 57559118, "body": "Put this line in Let EquipID before End Property.  Debug.Print &quot;Let.EquipID&quot;, Index, value, pEquipID(Index)"}, {"owner": {"reputation": 19, "user_id": 5741557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cfeac1d959a8659cd1184d8ddcf951?s=128&d=identicon&r=PG&f=1", "display_name": "m.T", "link": "https://stackoverflow.com/users/5741557/m-t"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453336753, "post_id": 34888409, "comment_id": 57562153, "body": "@Jules when I include that code it shows the values being stored. But when I print the array elements I get either 0&#39;s or null strings"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453336991, "post_id": 34888409, "comment_id": 57562222, "body": "Put this in the Get Debug.Print &quot;Get.EquipID&quot;, Index, pEquipID(Index)"}], "answers": [{"tags": [], "owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "is_accepted": false, "score": 1, "last_activity_date": 1453470367, "last_edit_date": 1453470367, "creation_date": 1453337769, "answer_id": 34913553, "question_id": 34888409, "link": "https://stackoverflow.com/questions/34888409/declaring-array-in-vba-class/34913553#34913553", "title": "Declaring Array in VBA class", "body": "<p>Your Property Get is incorrect.  Instead of:</p>\n\n<pre><code>Public Property Get EquipID(index As Integer) As String\n    EquipID(index) = pEquipID(index)\nEnd Property\n</code></pre>\n\n<p>... it should be:</p>\n\n<pre><code>Public Property Get EquipID(index As Integer) As String\n    EquipID = pEquipID(index)\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5741557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cfeac1d959a8659cd1184d8ddcf951?s=128&d=identicon&r=PG&f=1", "display_name": "m.T", "link": "https://stackoverflow.com/users/5741557/m-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1453470367, "creation_date": 1453243523, "last_edit_date": 1453247950, "question_id": 34888409, "link": "https://stackoverflow.com/questions/34888409/declaring-array-in-vba-class", "title": "Declaring Array in VBA class", "body": "<p>I have several classes containing details about an onsite switchboard. I am using a Userform to store data in the variables declared in each class. I am struggling to store the data in any of my arrays. Am I going the right way about declaring these variables? Here's an example of one of my classes:</p>\n\n<pre><code>Dim pEquipID(3) As String\nDim pIr(3) As Integer\nDim pIm(3) As Integer\nDim pTripCurrent(3) As Integer\nDim pTripTime(3) As Integer\nDim pIsc(3) As Integer\n\nPublic Property Let EquipID(index As Integer, value As String)\n    pEquipID(index) = value\nEnd Property\n\nPublic Property Let Ir(index As Integer, value As Integer)\n    pIr(index) = value\nEnd Property\n\nPublic Property Let Im(index As Integer, value As Integer)\n    pIm(index) = value\nEnd Property\n\nPublic Property Let TripCurrent(index As Integer, value As Integer)\n    pTripCurrent(index) = value\nEnd Property\n\nPublic Property Let TripTime(index As Integer, value As Integer)\n    pTripTime(index) = value\nEnd Property\n\nPublic Property Let Isc(index As Integer, value As Integer)\n    pIsc(index) = value\nEnd Property\n\nPublic Property Get EquipID(index As Integer) As String\n    EquipID(index) = pEquipID(index)\nEnd Property\n\nPublic Property Get Ir(index As Integer) As Integer\n    Ir(index) = pIr(index)\nEnd Property\n\nPublic Property Get Im(index As Integer) As Integer\n    Im(index) = pIm(index)\nEnd Property\n\nPublic Property Get TripCurrent(index As Integer) As Integer\n    TripCurrent(index) = pTripCurrent(index)\nEnd Property\n\nPublic Property Get TripTime(index As Integer) As Integer\n    TripTime(index) = pTripTime(index)\nEnd Property\n\nPublic Property Get Isc(index As Integer) As Integer\n    Isc(index) = pIsc(index)\nEnd Property\n</code></pre>\n\n<p>And this is how I am storing the data:</p>\n\n<pre><code>Private Sub Enter1_Click()\n    'create class variables\n    Dim Transformer1 As cTransformer\n    Set Transformer1 = New cTransformer\n    Dim Fuse1 As cFuse\n    Set Fuse1 = New cFuse\n    Dim CircuitBreaker1 As cCircuitBreaker\n    Set CircuitBreaker1 = New cCircuitBreaker\n    Dim Pump1 As cPump\n    Set Pump1 = New cPump\n    Dim Cable1 As cCable\n    Set Cable1 = New cCable\n'store circuit breaker entries\n    CircuitBreaker1.EquipID(0) = CB1ID1.value\n    CircuitBreaker1.EquipID(1) = CB2ID1.value\n    CircuitBreaker1.Ir(0) = Cb1Ir1.value\n    CircuitBreaker1.Ir(1) = CB2Ir1.value\n    CircuitBreaker1.Im(0) = CB1Im1.value\n    CircuitBreaker1.Im(1) = CB2Im1.value\n    CircuitBreaker1.Isc(0) = CB1Isc1.value\n    CircuitBreaker1.Isc(1) = CB2Isc1.value\n    CircuitBreaker1.TripCurrent(0) = CB1trip1.value\n    CircuitBreaker1.TripCurrent(1) = CB2trip1.value\n    CircuitBreaker1.TripTime(0) = CB1time1.value\n    CircuitBreaker1.TripTime(1) = CB2time1.value\n</code></pre>\n\n<p>When I debug.print the CircuitBreaker array the terminal prints blank values. I use a loop like this to print each array:</p>\n\n<pre><code>        Dim count As integer\n        For count = 0 To 1 Step 1\n        Debug.Print CircuitBreaker1.EquipID(count)\n        Next count\n</code></pre>\n\n<p>Note that this print statement is inside Enter1_click()</p>\n"}, {"tags": ["vba", "ms-access", "ms-project"], "comments": [{"owner": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "edited": false, "score": 1, "creation_date": 1453243667, "post_id": 34888279, "comment_id": 57515228, "body": "This might be a silly question but are you using the 32-bit or 64-bit versions of Access and Project? Is there a chance that you have the 64-bit version of Access and the 32-bit version of Project installed, or vice versa?"}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "reply_to_user": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "edited": false, "score": 0, "creation_date": 1453248769, "post_id": 34888279, "comment_id": 57517028, "body": "Stranger things have happened. I just confirmed everything is 64 bit. I have assumed the references would not be an issue (32 -v- 64), but, I think I&#39;ll do some research down that path as well. I s&#39;pose I could have some funky references or a 32 bit library hanging around?? Worth a shot."}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "reply_to_user": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "edited": false, "score": 0, "creation_date": 1453250342, "post_id": 34888279, "comment_id": 57517449, "body": "FWIW I checked out the reference. The file is MSPRJ.OLB and it&#39;s in C:\\Program Files\\Microsoft Office\\root\\Office16. My Office 16 install is 64 bit, so I believe the reference should be 64 bit as well. I can&#39;t find anything, yet, specific where I can identify the file as 64 bit like a file size, check sum, etc."}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "reply_to_user": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "edited": false, "score": 0, "creation_date": 1453251832, "post_id": 34888279, "comment_id": 57517917, "body": "@AlistairMcMillan - Thank you! Your idea put me on to a path I had not considered. I&#39;ve updated the question with what I found. Now I need to sort out how to implement a fix. Hopefully it works! It&#39;s a step in the right direction."}, {"owner": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "edited": false, "score": 0, "creation_date": 1453256320, "post_id": 34888279, "comment_id": 57519080, "body": "Just glancing through the article you linked above it doesn&#39;t look like this code is anywhere near complex enough to need to be updated. And given the error message you&#39;re getting I think it&#39;s just an install problem on your machine."}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "edited": false, "score": 0, "creation_date": 1453312250, "post_id": 34890405, "comment_id": 57550098, "body": "Thanks! I will give that a try now. BTW - I reinstalled Office 2016 about three weeks ago so I was not thinking that would be high on the priority list. But, if it&#39;s working for you then it&#39;s evidence to the contrary. BTW what version of Windows are you on?"}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "edited": false, "score": 0, "creation_date": 1453318545, "post_id": 34890405, "comment_id": 57553648, "body": "Update, well, I tried the repair, no joy. Also checked to see that .NET was up to date, it was. I agree the Office installation or my Windows environment could be at the root. I definitely want to rule that out. So, I am going to continue working that angle. I&#39;m going to clean out some old apps, reinstall Office. Thanks for testing that code on your machine! I&#39;ll post any success back here."}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "edited": false, "score": 0, "creation_date": 1453325081, "post_id": 34890405, "comment_id": 57557308, "body": "Alistair, if you have a chance to reply, could you confirm if you are running 32 bit or 64 bit? Thanks."}, {"owner": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "reply_to_user": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "edited": false, "score": 0, "creation_date": 1453325210, "post_id": 34890405, "comment_id": 57557392, "body": "Tested on Windows 7 64-bit and Windows 10 32-bit. Both with Office 32-bit. But like I mentioned above, based on the article you linked, I don&#39;t think this code is complex enough to raise any 32/64-bit issues."}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "edited": false, "score": 0, "creation_date": 1453329004, "post_id": 34890405, "comment_id": 57559376, "body": "Alistair, thanks again. Okay. I&#39;m going to continue working on the environment as I mentioned in my update to the post. I am very sure you are correct. As soon as I get it working I will mark this as the answer."}, {"owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "edited": false, "score": 1, "creation_date": 1454477375, "post_id": 34890405, "comment_id": 58056288, "body": "Done for now. I got it to work on a reinstall of Office 2013 and I resolved my other issues with 2016. For now I&#39;m going to hang with 2013. I did have to remove a registry entry per this post - <a href=\"http://kb.palisade.com/index.php?pg=kb.page&amp;id=456\" rel=\"nofollow noreferrer\">kb.palisade.com/index.php?pg=kb.page&amp;id=456</a>"}], "tags": [], "owner": {"reputation": 1120, "user_id": 35794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjvR7.jpg?s=128&g=1", "display_name": "Alistair McMillan", "link": "https://stackoverflow.com/users/35794/alistair-mcmillan"}, "is_accepted": true, "score": 0, "last_activity_date": 1453256203, "creation_date": 1453256203, "answer_id": 34890405, "question_id": 34888279, "link": "https://stackoverflow.com/questions/34888279/access-project-vba-automation-error-instantiating-ms-project-application-obj/34890405#34890405", "title": "Access / Project VBA - automation error instantiating MS Project Application object", "body": "<p>I think this is a problem with the install of Microsoft Project 2016 on your machine.</p>\n\n<p>I just tested your code here on a machine with Access 2016 and Project 2016 and it worked first time.</p>\n\n<p>I'd recommend doing a <a href=\"https://support.office.com/en-us/Article/Repair-an-Office-application-7821d4b6-7c1d-4205-aa0e-a6b40c5bb88b\" rel=\"nofollow\">repair install</a> on Project and possibly Access as well.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6155101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FqLv3.jpg?s=128&g=1", "display_name": "Rod Gill", "link": "https://stackoverflow.com/users/6155101/rod-gill"}, "is_accepted": false, "score": 0, "last_activity_date": 1459761512, "creation_date": 1459761512, "answer_id": 36398729, "question_id": 34888279, "link": "https://stackoverflow.com/questions/34888279/access-project-vba-automation-error-instantiating-ms-project-application-obj/36398729#36398729", "title": "Access / Project VBA - automation error instantiating MS Project Application object", "body": "<p>You might try installing KB3114538. Apparently some 2016 VBA objects properties were added but were not backwards compatible with older versions.</p>\n\n<p>Making sure Project and Office are fully updated might be good as well.</p>\n\n<p>Rod Gill\nProject MVP</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 2443969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1d0f3f1c16f994ad18e72d514b54115?s=128&d=identicon&r=PG", "display_name": "MarkF", "link": "https://stackoverflow.com/users/2443969/markf"}, "is_accepted": false, "score": 0, "last_activity_date": 1551300450, "creation_date": 1551300450, "answer_id": 54914220, "question_id": 34888279, "link": "https://stackoverflow.com/questions/34888279/access-project-vba-automation-error-instantiating-ms-project-application-obj/54914220#54914220", "title": "Access / Project VBA - automation error instantiating MS Project Application object", "body": "<p>I had the same problem today when upgrading Office 2016 32-bit to 64-bit. All of my Outlook objects in VBA failed, resulting in the message \"Automation Error: a Microsoft software installer error was encountered.\" I renamed the registry key associated with Outlook and on the next call it was apparently rebuilt, then everything started working again. More info at this link: <a href=\"https://support.microsoft.com/en-us/help/828550/you-receive-run-time-error-429-when-you-automate-office-applications\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/828550/you-receive-run-time-error-429-when-you-automate-office-applications</a>\nNo re-install of Office required in my case.</p>\n"}], "owner": {"reputation": 239, "user_id": 5483862, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-SUPtgUw_kGo/AAAAAAAAAAI/AAAAAAAAAkw/mmkjM0OjJiM/photo.jpg?sz=128", "display_name": "JackW327", "link": "https://stackoverflow.com/users/5483862/jackw327"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2001, "favorite_count": 0, "accepted_answer_id": 34890405, "answer_count": 3, "score": 0, "last_activity_date": 1593587796, "creation_date": 1453242991, "last_edit_date": 1593587796, "question_id": 34888279, "link": "https://stackoverflow.com/questions/34888279/access-project-vba-automation-error-instantiating-ms-project-application-obj", "title": "Access / Project VBA - automation error instantiating MS Project Application object", "body": "<p>Update - 1/20/2016 - I believe the answer posted by @Alistair is the correct one and I am working to verify.</p>\n\n<p>Since my last post I tried repairing the Office 16 64 bit environment. Did not work.</p>\n\n<p>To get this back to a solid starting point I have downgraded to Office 2013 (32 bit) on my regular Windows 10 machine. The code below works as expected. Next I am going to build another VM for the 2016 installs and see if the 32 bit version of Office 16 works.</p>\n\n<p>Update - 1/19/2016 1658 PT - I am going to explore making the code aware of the 64 bit -vs- 32 bit environments. See: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264421.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264421.aspx</a></p>\n\n<p>If that fixes the issue I'll update this question with the solution. Thank you!</p>\n\n<p>***** Original post below **************************</p>\n\n<p>This is while running a macro within MS Access that is to open an MS Project file and import data from the MS Project tasks to Access. The code below is a sample. The error we are getting is under Windows 10 &amp; MS Office 2016. This error does not occur on another machine running Windows 7 &amp; Office 2013; the MS Project versions are consistent to the Office versions. </p>\n\n<p>We are getting an automation error when I attempt to instantiate a MSProject.Application object. The error is:</p>\n\n<p>Run-time error '-2147467229 (80004023)':</p>\n\n<p>Automation error\nA Microsoft Software Installer error was encountered</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nSub test01()\n    Dim appMSProject As MSProject.Application\n    On Error GoTo ErrorHandler\n    '*** The next line is where we pop the error ***\n    Set appMSProject = New MSProject.Application\n    appMSProject.FileOpenEx Name:=\"C:\\IMS\\Project1.mpp\"\n    '*** next line is just so I can see if something odd is going on ***\n    MsgBox (appMSProject.About())\n    appMSProject.Quit SaveChanges:=pjDoNotSave\n    Exit Sub\nErrorHandler:\n    MsgBox (\"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; _\n            \"Error Desc.: \" &amp; vbCrLf &amp; _\n            Err.Description)\n    Exit Sub   \nEnd Sub\n</code></pre>\n\n<p>Interestingly while in debug mode if I delete \"New\" and step back into it, sometimes, it will run.</p>\n\n<p>We have tried turning off prompts for logging into project server, project to project links, and set the macro security to the lowest settings on Access and Project. We have also tried this with different .MPP files in case the file was corrupt or possibly not compliant with MS Project 2016, which was a long shot since the file opens after the object instantiation of course. </p>\n\n<p>I have also tried this technique:</p>\n\n<pre><code>Dim appMSProject As Object\n...\nSet appMSProject = CreateObject(\"MSProject.Application\")\n</code></pre>\n\n<p>This yields the same error. I have even copied &amp; pasted the code samples from here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865152.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff865152.aspx</a></p>\n\n<p>An open switch here is the references. I am using the Microsoft Project 16 Object Library. The MSDN article specifies the Microsoft Project 15 Object Library. I have tried to find a newer MSDN article, specification, object model, or anything else that applies to Project 16. No joy. </p>\n\n<p>While I find some very general automation error advice on-line almost all these examples are having problems after they spin up the Application object, not at the point I am having issues. There is also precious little help on MS Project VBA in general. It's a smaller community, of course. Just letting you know I looked.</p>\n\n<p>All I can think is that I am missing a way to get hold of the Office 2016 / Project 2016 VBA documentation and in there is a new technique for instantiating the MSProject.Application object. If it's that simple and anyone knows the magic URL, please pass it along. </p>\n\n<p>Thank you in advance! - jd</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 3, "creation_date": 1453242835, "post_id": 34888117, "comment_id": 57514865, "body": "If you are looking to leave the end user with an AutoFilter then you would have to use as headers the Cells in Row 3. You can&#39;t set AutoFilter or Sort for that matter with disjointed areas. You can just sort through macro to <code>A3:P250</code> without headers and then exit the function. I would rather suggest you place the additional information above the header row rather than below. It&#39;s never a good idea to break the logical structure of a table. Regards."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1453242891, "post_id": 34888117, "comment_id": 57514889, "body": "You could do a sort for ranges before and after the rows you don&#39;t want changed."}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1453242919, "post_id": 34888117, "comment_id": 57514900, "body": "You can apply filters in your macro with something along the lines of <code>ActiveSheet.ListObjects(&quot;TableName&quot;).Range.AutoFilter Field:=1, Criteria1:=&quot;something&quot;</code>. What does your vba code look like at the moment?"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1453246365, "post_id": 34888117, "comment_id": 57516219, "body": "The autofilter could work, but I think @nbayly had the best suggestion to move those rows above the headers."}], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453242431, "creation_date": 1453242251, "last_edit_date": 1453242431, "question_id": 34888117, "link": "https://stackoverflow.com/questions/34888117/excel-keep-sorting-range", "title": "Excel Keep Sorting Range", "body": "<p>I am trying to figure out if there is a way to keep a sorting range after the macro finishes running. I have data in A1:P250 and there are headers in the first row. Depending on the report, there may be additional information in rows 2 &amp; 3. We initially added a row in between 1 &amp; 2, then hid it and froze the top row. This works decent, but we are trying to get the sort to just work on the data we set in the macro. So if once we format it the way we want, the user can sort any column and only sort the information that should be sorted.</p>\n\n<p>See <a href=\"https://i.stack.imgur.com/FZB3x.png\" rel=\"nofollow noreferrer\">Formatted report</a> for an example of what it looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2RA5g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2RA5g.png\" alt=\"enter image description here\"></a></p>\n\n<p>Users will sort several columns to check information, but the rows 2 &amp; 3 in this example should stay.</p>\n\n<p>Is there a way to format the report and add a sort range or something at the end before giving control back to the user so that it will sort a predetermined area?</p>\n"}, {"tags": ["excel", "pivot", "pivot-table", "vba"], "owner": {"reputation": 11, "user_id": 5812682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f2db3fa00378e7b75246e625a96e65?s=128&d=identicon&r=PG&f=1", "display_name": "timberg0612", "link": "https://stackoverflow.com/users/5812682/timberg0612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1467401455, "creation_date": 1453241218, "last_edit_date": 1531164843, "question_id": 34887868, "link": "https://stackoverflow.com/questions/34887868/vba-excel-find-last-fully-drilled-down-pivotfield", "title": "VBA excel find last fully drilled down PivotField", "body": "<p>i need to reference the Pivot-RowField that is below the last fully drilled down of PivotField of a Pivot table.<br>\n<a href=\"https://i.stack.imgur.com/5Km8C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Km8C.png\" alt=\"Snapshot of example\"></a></p>\n\n<p>[External link to the image]\n(<a href=\"http://fs5.directupload.net/images/160119/urgaltwn.png\" rel=\"nofollow noreferrer\">http://fs5.directupload.net/images/160119/urgaltwn.png</a>)!</p>\n\n<p>In the Example it would be PivotField(\"Region\") because the next level \"Town\" is not fully consolidated.</p>\n\n<p>Sadly neither the property of the PivotField .ShowDetail nor .DrilledDown are helping me out, since they (I believe) are refering to the ranges in the .DataRange behind the field.</p>\n\n<p>So far I tried looping through all the pivot items and check their .Showdetail property but they are all set to <code>True</code> even though the streets in region East e.g. are not shown.</p>\n\n<p>Any help would be highly appreciated!</p>\n\n<p>regs\nTim</p>\n\n<p>Code attempt:</p>\n\n<pre><code>Private Function pivotRowField(pvt As PivotTable) As PivotField\nDim pI As PivotItem, ok, test As Boolean\n\n   'determine last fully consolidated pivotRowField\n\n    For i = pvt.PivotFields.Count To 1 Step -1\n    ok = false\n    test = False\n    'test = pvt.PivotFields(i).DataRange.Cells(1).ShowDetail &lt;- true for all\n'test = pvt.RowFields(i).ShowDetails &lt;- not possible\n\n    With pvt.RowFields(i)\n\n    For Each pvitem In .PivotItems\n        On Error Resume Next\n        test= pvitem.ShowDetail 'true for all despite not visible\n\n        If test= True Then    'If True for one means not fully consolidated\n            ok = False\n            Exit For\n        End If\n     Next pvitem\n     End With\n\n     If ok Then\n         Set pivotRowField = pvt.RowFields(i)\n     End If\n     Next i\nEnd Function\n</code></pre>\n"}, {"tags": ["vb.net", "excel", "vba", "vsto", "excel-addins"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453243591, "post_id": 34887786, "comment_id": 57515190, "body": "Not sure I see the point, but you&#39;d make a company visible class in the addin to say application.run(macro name,args) then call that so addin.com class.function to run macro in .net or do you mean migrate the function to .net or handle the click in addin not like _click() in VBA???"}, {"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453250880, "post_id": 34887786, "comment_id": 57517647, "body": "No migration intended, just want to use that particular button click event to trigger the Addin to do some additional task. The existing excel template is an approved form (with Macro), I am not allowed to change anything of it."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453274499, "post_id": 34887786, "comment_id": 57524856, "body": "Just noticed auto correct changed make a com visible to make a company.   My solution of Application.Run(x,y,z) from VB.NET should do it.   In the past i&#39;ve created the functions in a non exposed class, then created an exposed wrapper to call these, so the non exposed function would be clsFunctions.fnCLICK_BUTTON and the exposed would be clsVBAFunctions.fnCallVBAButton click, which would be called from VBA"}, {"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453277367, "post_id": 34887786, "comment_id": 57526242, "body": "Thanks Nathan, but the pre-requisite of this task is that nothing can be changed on the Excel Template (including its vba code). That&#39;s why I am trying from the event handling by VB.NET."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453278003, "post_id": 34887786, "comment_id": 57526538, "body": "I&#39;m lost :) You cant get AddIn to do the call to the existing function if you dont tell it to somehow?"}, {"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453294662, "post_id": 34887786, "comment_id": 57537536, "body": "The trigger point is that the button in the excel template is clicked, then it will surely raise certain event, and such event will certainly be handled by VBA macro, but I would like to add another listener (event handler) in VB.Net to the same event, so I can do some additional task."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453308487, "post_id": 34887786, "comment_id": 57547557, "body": "I think whether this is possible or not will depend on what KIND of button control is involved. If it&#39;s an ActiveX CommandButton then it&#39;s probably possible since these buttons become properties/objects of the worksheet, through which they can be accessed. Also, they expose events via that OLEFormat.Object interface. That&#39;s not the case with the &quot;form field&quot; buttons."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "edited": false, "score": 0, "creation_date": 1453344860, "post_id": 34907714, "comment_id": 57564328, "body": "Thanks Alex, I will try your approach in VB.NET, just have one concern, will the event handler in the Addin overwrite the event handler in its original VBA module? I need both handler works."}, {"owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "reply_to_user": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "edited": false, "score": 0, "creation_date": 1453381195, "post_id": 34907714, "comment_id": 57582398, "body": "I think it keeps the original event handler, but even if i&#39;m wrong - you can invoke this macro from your vb.net event handler"}, {"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "edited": false, "score": 0, "creation_date": 1453450682, "post_id": 34907714, "comment_id": 57615505, "body": "Alex, Sorry for not replying you soon, I have tested the method in VB.NET, get stuck in &quot;cmdBtn.Click +=cmdBtn_Click;&quot; Don&#39;t know how to convert this line to VB.NET.  Then I create a new Addin project in C#, your code works perfect. The click event are handled by both handlers."}, {"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "edited": false, "score": 0, "creation_date": 1453451255, "post_id": 34907714, "comment_id": 57615838, "body": "I would like to make this great approach to work in VB.NET also. Can you give some advice on &quot;cmdBtn.Click +=cmdBtn_Click;&quot;? How can I convert it to VB.NET. Thanks."}, {"owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "edited": false, "score": 0, "creation_date": 1453452078, "post_id": 34907714, "comment_id": 57616277, "body": "Now the event handling sequence is as follows: (1) VBA handler (2) C#.NET handler.  Is it possible to let the C#.NET handler run first?"}], "tags": [], "owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1453314476, "creation_date": 1453314476, "answer_id": 34907714, "question_id": 34887786, "link": "https://stackoverflow.com/questions/34887786/in-vsto-addin-for-excel-how-to-handle-a-button-click-event-from-active-worksheet/34907714#34907714", "title": "In VSTO Addin for Excel how to handle a button click event from active worksheet?", "body": "<p><a href=\"https://social.msdn.microsoft.com/Forums/en-US/be3ed2fd-f111-4a10-a306-0920b93cabe5/how-to-add-a-button-control-to-an-excel-worksheet-using-c?forum=exceldev\" rel=\"nofollow\">Here</a> was a similar question.</p>\n\n<pre><code>var cmdButton = (Excel.Shape)xlWorkSheet.Shapes.AddOLEObject(\"Forms.CommandButton.1\", Type.Missing, false, false, Type.Missing, Type.Missing, Type.Missing, 60, 60, 60, 60);\n\ncmdButton.Name = \"btnClick\";\n\n//var cmdBtn = (Microsoft.Vbe.Interop.Forms.CommandButton)Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateGet((Excel.Worksheet)xlApp.ActiveSheet, null, \"btnClick\", new object[0], null, null, null);\n\nvar cmdBtn = (Microsoft.Vbe.Interop.Forms.CommandButton)Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateGet((Excel.Worksheet)xlApp.ActiveSheet, null, \"btnClick\", new object[0], null, null, null);\n//\n//some button formatting codes\n//\ncmdBtn.Click +=cmdBtn_Click;\n\n\nvoid cmdBtn_Click()// Command button click event handler\n{\n  MessageBox.Show(\"Test\");\n}\n</code></pre>\n\n<p>In your case it is easier, you don't need to create a button, you can just use it's name.</p>\n"}], "owner": {"reputation": 45, "user_id": 5765620, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df4d01994dd941c12b979a3dc4b462c2?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/5765620/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2315, "favorite_count": 0, "accepted_answer_id": 34907714, "answer_count": 1, "score": 0, "last_activity_date": 1453314476, "creation_date": 1453240900, "last_edit_date": 1453299132, "question_id": 34887786, "link": "https://stackoverflow.com/questions/34887786/in-vsto-addin-for-excel-how-to-handle-a-button-click-event-from-active-worksheet", "title": "In VSTO Addin for Excel how to handle a button click event from active worksheet?", "body": "<p>Currently I am developing an Excel 2010 Addin using VB.NET 2010 with VSTO.</p>\n\n<p>The active worksheet has a button, its click event will be handled by its own VBA code.</p>\n\n<p>Now I would like to handle the same button click event in Addin without affecting its original VBA function. Is it possible? And how can I achieve this?</p>\n\n<p>The pre-requisite of this task is that nothing is allowed to be changed on the Excel Template (including its VBA code). That's why I am trying from the event handling by VB.NET.</p>\n\n<p>The trigger point is that the button in the Excel template is clicked, then it will surely raise certain event, and such event will certainly be handled by VBA macro, but I would like to add another listener (event handler) in VB.Net to the same event, so I can do some additional task.</p>\n\n<p>Is there anyone know how to add such event handler?</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1453243169, "post_id": 34887765, "comment_id": 57515000, "body": "Do you mean that the user doesn&#39; t have any records in the test table yet, but that they have an ID themselves?  What you want to do is something like &quot;If DMax(.....) Is Null Then lngNextID = Me.usernum*1000) + 1 Else lngNextID = Right(DMax(....), 3) + 1&quot;  However, if there are IDs that the user has entered that are bigger than the ones created by this process, you could run into some issues."}, {"owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "edited": false, "score": 0, "creation_date": 1453252083, "post_id": 34887765, "comment_id": 57518006, "body": "Basically each user (person entering data) is assigned a one digit number, which is usernum. Usernum is the first digit for the calculated ID, which is idnum. idnum will be blank for all users until the first time they press the button to indicate they need to generate one. I will try OpiesDad solution and see how it works"}, {"owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1453252685, "post_id": 34887765, "comment_id": 57518174, "body": "still giving me a null error @OpiesDad. with the code <code>If DMax([idnum], &quot;test&quot;, &quot;usernum=&quot; &amp; Me.usernum) Is Null Then lngNextID = (Me.usernum * 1000 + 1)     Else: lngNextID = Right(DMax([idnum], &quot;test&quot;, [&quot;usernum=&quot; &amp; Me.usernum]), 3) + 1</code> the if through then is highlighted"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1453306939, "post_id": 34887765, "comment_id": 57546458, "body": "Just as a comment, the line &quot;Cancel = True&quot; that you have won&#39;t do anything.  This line is used in specific events that have Cancel as a parameter such as the _Close event.  Setting it to True would prevent the object from closing.  In your code all you are doing is creating a new variable named Cancel and assigning it the value True as the Click event has no such parameter."}, {"owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "edited": false, "score": 0, "creation_date": 1453319764, "post_id": 34887765, "comment_id": 57554316, "body": "thanks! I&#39;ve cleared that part up already--for some reason I&#39;ve had a much harder time finding resources about msgbox syntax and examples than I have for other access vba stuff."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1453249177, "creation_date": 1453249177, "answer_id": 34889368, "question_id": 34887765, "link": "https://stackoverflow.com/questions/34887765/cant-figure-out-how-to-fix-null-error/34889368#34889368", "title": "Can&#39;t figure out how to fix null error", "body": "<p>This one is close:</p>\n\n<pre><code>lngNextID = (Me.usernum * 1000) + 1 + NZ(DMax([idnum], \"test\", \"usernum=\" &amp; Me.usernum), 0)\n</code></pre>\n\n<p>but the first parameter of <code>DMax</code> (the fieldname or expression) is a string too:</p>\n\n<pre><code>lngNextID = (Me.usernum * 1000) + 1 + NZ(DMax(\"idnum\", \"test\", \"usernum=\" &amp; Me.usernum), 0)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 34889368, "answer_count": 1, "score": 0, "last_activity_date": 1453256730, "creation_date": 1453240796, "last_edit_date": 1453256730, "question_id": 34887765, "link": "https://stackoverflow.com/questions/34887765/cant-figure-out-how-to-fix-null-error", "title": "Can&#39;t figure out how to fix null error", "body": "<p>For my form, almost all paper forms should come with an ID that you enter into one field. However, a few forms will come with no IDs, and I want to generate into a different field an ID number based on the user entering the information.</p>\n\n<p>What I want it to do is to create a 4-digit number, where the first digit is from the field usernum, and the last 3 digits are just sequentially counting. </p>\n\n<p>The first time they press the button, nothing is in the usernum field yet, and I think this may be the cause of my runtime 94 error?</p>\n\n<p>below is my code and the error line</p>\n\n<pre><code>Private Sub Command100_Click()\n'on click of button InsightId is generated\nMe.idnum = NewInsightID()\nEnd Sub\n\nPublic Function NewInsightID() As Long\n\n\nDim lngNextID As Long\n\n'Find highest  ID in the test table and add 1\nlngNextID = (Me.usernum * 1000) + DMax([idnum], \"test\", \"usernum=\" &amp; Me.usernum) + 1\n'ABOVE IS THE LINE WITH ERRORS\n\n'Assign function the value of the Next ID\nNewInsightID = lngNextID\n\nEnd Function\n</code></pre>\n\n<p>I have tried various workarounds but none have worked</p>\n\n<p>below is what i've tried and hasn't worked:</p>\n\n<pre><code>lngNextID = (Me.usernum * 1000) + 1 + NZ(DMax([idnum], \"test\", \"usernum=\" &amp; Me.usernum),0)\n\nlngNextID = (Me.usernum * 1000) + 1 + Nz(DMax([idnum], \"test\", \"usernum=\" &amp; Nz(Me.usernum, 0)), 0)\n\nlngNextID = (Me.usernum * 1000) + 1 + DMax([idnum], \"test\", \"usernum=\" &amp; Nz(Me.usernum, 0))\n</code></pre>\n\n<p>EDIT 2:\nOkay, have made process. Sort of have it working, except for two things--for some reason it won't start at 001, only 002. After that, it does move incrementally by one.\nThe main thing is an error if usernum is blank. Again, I don't anticipate this ever being the case, but when it comes to data entry I think it's best to assume the dumbest possible users, and since I'm going to be on vacation when this database is used I don't want to get any calls about errors. I'm trying to do it so that if usernum is blank, they get a message that tells them the error and cancels the sub, but for some reason it isn't working, and then later in the code i get the error message Run time error 3075 missing operator in query expression 'usernum='. I assumed doing a message box to fix that would solve the problem, but I can't get the message box to work.</p>\n\n<pre><code>   Private Sub Command100_Click()\n'on click of button InsightId is generated\nIf usernum = Null Then\n    Beep\n    MsgBox (\"you cannot leave usernum blank\")\n    Cancel = True\nElse: Me.idnum = NewInsightID()\nEnd If\nEnd Sub\n\nPublic Function NewInsightID() As Long\n\n\nDim lngNextID As Long\n\n\n'Find highest  ID in the test table and add 1\n\n   If DMax(\"idnum\", \"test\", \"usernum=\" &amp; Me.usernum) = Null Then\n        lngNextID = (Me.usernum * 1000 + 1)\n    Else:\n        lngNextID = 1 + Nz(DMax(\"idnum\", \"test\", \"usernum=\" &amp; Me.usernum), Me.usernum * 1000 + 1)\n    End If\n\n'Assign function the value of the Next ID\nNewInsightID = lngNextID\n\nEnd Function\n</code></pre>\n\n<p>EDIT3:\naaah I solved it incredible!!</p>\n\n<pre><code>Private Sub Command100_Click()\n'on click of button InsightId is generated\nIf IsNull(Me.usernum) Then\n    Beep\n    MsgBox (\"you cannot leave usernum blank\")\n    Cancel = True\nElse: Me.idnum = NewInsightID()\nEnd If\nEnd Sub\n\nPublic Function NewInsightID() As Long\n\n\nDim lngNextID As Long\n\n\n'Find highest  ID in the test table and add 1\n\n   If DMax(\"idnum\", \"test\", \"usernum=\" &amp; Me.usernum) = Null Then\n    lngNextID = (Me.usernum * 1000 + 1)\n    Else:\n    lngNextID = 1 + Nz(DMax(\"idnum\", \"test\", \"usernum=\" &amp; Me.usernum), Me.usernum * 1000)\n    End If\n\n    'Assign function the value of the Next ID\n    NewInsightID = lngNextID\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "elements"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1453242523, "post_id": 34887586, "comment_id": 57514728, "body": "Please explain your code. Please show us relevant parts only."}, {"owner": {"reputation": 1238, "user_id": 399576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea18878a4ed43b8200ca28b28a2461f4?s=128&d=identicon&r=PG", "display_name": "ardila", "link": "https://stackoverflow.com/users/399576/ardila"}, "edited": false, "score": 0, "creation_date": 1453245105, "post_id": 34887586, "comment_id": 57515792, "body": "I&#39;m not sure I understand what your question is."}, {"owner": {"reputation": 16775, "user_id": 442945, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/TovHM.png?s=128&g=1", "display_name": "Nathaniel Ford", "link": "https://stackoverflow.com/users/442945/nathaniel-ford"}, "edited": false, "score": 0, "creation_date": 1453246212, "post_id": 34887586, "comment_id": 57516170, "body": "You may wish to provide inputs, what outputs you expect those inputs to yield, and how the actual output differs. Refer to <a href=\"http://www.stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453282295, "post_id": 34887586, "comment_id": 57529133, "body": "Thanks, guys, please advise if the revised description makes more sense"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453390919, "post_id": 34890198, "comment_id": 57589349, "body": "After testing a few scenarios where only 3 or 2 variables (SOP_key_b6) are fulfilled, I&#39;m getting an error &quot;This key is already associated with an element in this collection&quot;..."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453391832, "post_id": 34890198, "comment_id": 57590050, "body": "If the keys are the same -- are the values the same? For example, can you have <code>SOP_key_B6 = SOP_key_C6</code> but <code>cell_B6</code> different from <code>cell_C6</code>? If so -- what value(s) should go in cells <code>L30</code> and <code>M30</code>?"}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453392084, "post_id": 34890198, "comment_id": 57590214, "body": "No, I eliminated this by nesting another &quot;If&quot;, so now every SOP_key is unique so as the value in cell_c6. I&#39;m thinking about clearing the collection completely in beforehand adding new items to the collection. You think that&#39;s possible?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453392778, "post_id": 34890198, "comment_id": 57590697, "body": "The line <code>Set C = New Collection</code> will create a new collection and assign it to <code>C</code>. The old collection will be garbage-collected. From the programmer&#39;s point of view this is equivalent to clearing <code>C</code>. Also -- you might want to look into <code>Dictionaries</code> which are like collections but a bit more flexible."}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453398108, "post_id": 34890198, "comment_id": 57594234, "body": "thanks, John, once again! Just tried your suggested method, but the error still appears :("}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453398679, "post_id": 34890198, "comment_id": 57594611, "body": "the error appears at this line <code>C.Add cell_E6, CStr(SOP_key_E6)</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453403543, "post_id": 34890198, "comment_id": 57597488, "body": "When you encounter a key which has been used before (such as <code>SOP_key_6</code> what value do you want to store? You can&#39;t really (easily) store both <code>cell_E6</code> and the previous value corresponding to <code>SOP_key_E6</code> so the main options are either leave the old value in place (and forget about storing <code>cell_E6</code>) or replace the old value by <code>cell_E6</code>."}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453404382, "post_id": 34890198, "comment_id": 57597971, "body": "John, initially I thought to completely abandon the value of <code>SOP_key_E6</code> after sorting and input corresponding value of <code>cell_E6</code> in the range L31:O31. The reason I used <code>SOP_key_E6</code> because it allowed me to store integer &amp; sort accordingly."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453410658, "post_id": 34890198, "comment_id": 57601460, "body": "Le me see if I understand this -- the keys are 0 for &quot;Actual Sales&quot; and &quot;XXYYY&quot; for values of the form &quot;SOPXX(YYYY)&quot;, these values are in B6-E6, you want to sort these according to these keys -- and put them in L30-O30? If so -- you can vastly simplify the code."}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453454424, "post_id": 34890198, "comment_id": 57617619, "body": "yes, absolutely correct. i much appreciate your dedication! but how would simplify it then?"}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453468535, "post_id": 34890198, "comment_id": 57626426, "body": "thanks!! You&#39;re right about the unique capabilities of each key, I noticed that as well and hence created another nested <code>If</code> that could distinguish:  <code>If Mid(cell_D6, 8, 4) = &quot;2015&quot; Then                 SOP_key_D6 = CInt(Mid(cell_D6, 4, 2)) + CInt(Mid(cell_D6, 8, 4))             ElseIf Mid(cell_D6, 8, 4) = &quot;2014&quot; Then                 SOP_key_D6 = CInt(Mid(cell_D6, 4, 2))</code>. &lt;-- where 2014 assume it&#39;s 2016. Anyway, I&#39;m gonna try the code you provided and then feedback"}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453471571, "post_id": 34890198, "comment_id": 57628485, "body": "After few testing getting <code>Type mismatch error</code> on this line <code>ExtractKey = CLng(v)</code>. Will try to investigate"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1453475695, "last_edit_date": 1453475695, "creation_date": 1453254722, "answer_id": 34890198, "question_id": 34887586, "link": "https://stackoverflow.com/questions/34887586/vba-replacing-array-elements/34890198#34890198", "title": "VBA: replacing array elements", "body": "<p>Your code is bloated in places, for example:</p>\n\n<pre><code>Dim ArrayToSort(0 To 4) As Variant\n\nArrayToSort(0) = SOP_key_B6\nArrayToSort(1) = SOP_key_C6\nArrayToSort(2) = SOP_key_D6\nArrayToSort(3) = SOP_key_E6\n</code></pre>\n\n<p>can be replaced by</p>\n\n<pre><code>Dim ArrayToSort As Variant 'note lack of ()\nArrayToSort = Array(SOP_key_B6, SOP_key_C6, SOP_key_D6, SOP_key_E6)\n</code></pre>\n\n<p>As far as your question goes, it seems that you need to use a collection. Assuming that there is a one-to-one correspondence between the <code>SOP-key_</code> values and the <code>cell_</code> values (otherwise, calling them \"keys\" is misleading), you could do the following:</p>\n\n<pre><code>Dim C As New Collection\nC.Add cell_B6, CStr(SOP_key_B6)\nC.Add cell_C6, CStr(SOP_key_C6)\nC.Add cell_D6, CStr(SOP_key_D6)\nC.Add cell_E6, CStr(SOP_key_E6)\n</code></pre>\n\n<p>then, after sorting <code>ArrayToSort</code>, have a loop like:</p>\n\n<pre><code>For i = 0 to 3\n    Range(\"L30\").Offset(0,i).Value = C(CStr(ArrayToSort(i)))\nNext i\n</code></pre>\n\n<p>I <em>think</em> this is what you are looking for -- but the code seems on the convoluted side so it might not be a bad idea to streamline it a bit.</p>\n\n<p>On Edit:</p>\n\n<p>You are getting duplicate keys due to the way you are constructing the keys by <em>adding</em> note that <code>SOP11(2015)</code> differs from <code>SOP10(2016)</code> but 11+2015 = 10 + 2016 (both equal to 2026). Instead -- <em>juxtapose</em>: 112015 isn't 102016. </p>\n\n<p>Furthermore, it makes sense to split the key creation into its own function (so you don't repeat essentially the same code 4 times:</p>\n\n<pre><code>Function ExtractKey(s As Variant) As Long\n    Dim v As Variant, n As Long\n    v = Trim(s)\n    If v Like \"*(*)\" Then\n        n = Len(v)\n        v = Mid(v, n - 7, 7)\n        v = Replace(v, \"(\", \"\")\n        ExtractKey = CLng(v)\n    Else\n        ExtractKey = 0\n    End If\nEnd Function\n</code></pre>\n\n<p>Note that the return type is <code>Long</code> -- <code>Integer</code> variables overflow too easily to be useful in VBA.</p>\n\n<p>Then -- something like this should work:</p>\n\n<pre><code>Sub Worksheet_Delta_Update()\n    Dim SourceRange As Range, TargetRange As Range\n    Dim i As Long, j As Long, minKey As Long, minAt As Long\n    Dim v As Variant\n    Dim C As New Collection\n\n    Set SourceRange = Worksheets(\"t\").Range(\"B6:E6\")\n    Set TargetRange = Worksheets(\"t\").Range(\"L30:O30\")\n\n    For i = 1 To 4\n        v = SourceRange.Cells(1, i).Value\n        C.Add Array(ExtractKey(v), v)\n    Next i\n\n    'transfer data\n    For i = 1 To 4\n        minAt = -1\n        For j = 1 To C.Count\n            If minAt = -1 Or C(j)(0) &lt; minKey Then\n                minKey = C(j)(0)\n                minAt = j\n            End If\n        Next j\n        TargetRange.Cells(1, i).Value = C(minAt)(1)\n        C.Remove minAt\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "edited": false, "score": 0, "creation_date": 1453475083, "post_id": 34949225, "comment_id": 57630918, "body": "@John the only thing now is that it places the values in the cells but skips blank (e.g. L30 = blank, M30 = blank, N30 = SOP2(2015), O30 = SOP11 (2015). Will try to fix myself but maybe you can advise?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1453475871, "post_id": 34949225, "comment_id": 57631445, "body": "Usually something like this belongs as an edit to the question (or perhaps an entirely new question) rather than as an answer. In any event, I don&#39;t think it would make a difference but you could replace the line <code>v = SourceRange.Cells(1, i)</code> by <code>v = SourceRange.Cells(1, i).Value</code>. Also -- <code>SOP2(2015)</code> seems to not fit the pattern of having 2 digits before the year -- it only has one."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1453476080, "post_id": 34949225, "comment_id": 57631592, "body": "Also -- note that <code>Trim</code> doesn&#39;t remove spaces inside the string -- just leading and trailing white space. I threw that in as a precaution since sometimes stray white spaces happen when users enter data"}, {"owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1453478607, "post_id": 34949225, "comment_id": 57633382, "body": "thanks for the forum rules! concenring the SOP2(2015) mistyped - it&#39;s SOP2 (2015). And yes, you were right, replacing the line didn&#39;t make the difference. I wonder why it skips blanks and the inputs the sorted values..."}], "tags": [], "owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "is_accepted": false, "score": 0, "last_activity_date": 1453482652, "last_edit_date": 1453482652, "creation_date": 1453473486, "answer_id": 34949225, "question_id": 34887586, "link": "https://stackoverflow.com/questions/34887586/vba-replacing-array-elements/34949225#34949225", "title": "VBA: replacing array elements", "body": "<p>On fixed the <code>Type mismatch error</code> with the following modificaton: </p>\n\n<pre><code>Function ExtractKey(s As Variant) As Long\n   Dim v As Variant, n As Long\n   v = Trim(s) 'remove spaces leave only spaces between words\n     If v Like \"*(*)\" Then 'if it's SOPXX (YYYY) then\n       n = Len(v) 'find number of the characters\n         If n = 11 Then\n           v = Mid(v, n - 7, 7) 'find the number of SOP + year in bracket\n         ElseIf n = 12 Then\n           v = Mid(v, n - 8, 8)\n         End If\n        v = Replace(v, \"(\", \"\") 'replace the brackets with nothing\n        v = Replace(v, \" \", \"\")\n        ExtractKey = CLng(v) 'error WAS here\n      Else\n        ExtractKey = 0\n      End If\nEnd Function\n</code></pre>\n\n<p><strong>Edit:</strong>\nAdded another few lines </p>\n\n<pre><code> If n = 11 Then\n         v = Right(v, 4) + Left(v, 1)\n    ElseIf n = 12 Then\n        v = Right(v, 4) + Left(v, 2)\n    End If\n</code></pre>\n\n<p>The above switch year and number (e.g. SOP12 (2015) = 122015 and after switch 201512). This is because SOP12 (2014) was placed <strong>after</strong> SOP10 (2015) despite the fact it should go before as its dated year 2014. Now working like charm :)</p>\n"}], "owner": {"reputation": 37, "user_id": 5622481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76b6ad903887c913dec6c1b6fdf50d8c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Vas", "link": "https://stackoverflow.com/users/5622481/d-vas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 34890198, "answer_count": 2, "score": 0, "last_activity_date": 1453482652, "creation_date": 1453240122, "last_edit_date": 1453282214, "question_id": 34887586, "link": "https://stackoverflow.com/questions/34887586/vba-replacing-array-elements", "title": "VBA: replacing array elements", "body": "<p>Edit: based on the comments, I'm providing more details on the code.</p>\n\n<p>The idea of the code is:</p>\n\n<p>There are strings stored in a range B6:E6 (e.g. B6 = \"Actual Sales\", C6 = \"SOP11 (2015)\", D6 = \"SOP12 (2015)\", E6 = \"SOP10 (2015)\"). </p>\n\n<p>I calculate the integer by using \"Mid\" function if the string is not \"Actual Sales\". </p>\n\n<p>When that's done, the calculated integers are sorted using BubbleSort in array.</p>\n\n<p>Afterwards, I would like to link the <strong>sorted integers</strong> (SOP_key_B6, SOP_key_C6, SOP_key_D6, SOP_key_E6) with the original string (cell_b6, cell_c6, cell_d6, cell_e6). In other words, there's a one-to-one correspondence between SOP_key_B6 and cell_b6, etc.)</p>\n\n<p>I want to do the above, because I need to input to the range L30:O30 <strong>the sorted array with strings</strong> based on the sorted integers.</p>\n\n<p>I hope this makes the idea clear as it's not very complicated, but the approach itself &amp; code makes it a bit frustrating (probably because I'm still learning the VB coding).</p>\n\n<p>Here's the code: </p>\n\n<pre><code>Sub Worksheet_Delta_Update()\n\n'Variables\nDim wb As Workbook, ws_wk_dlt As Worksheet, ws_dash As Worksheet, cell_B6 As  Variant, _\ncell_C6 As Variant, cell_D6  As Variant, cell_E6 As Variant, SOP_key_B6 As Variant, _\nSOP_key_C6 As Variant, SOP_key_D6 As Variant, SOP_key_E6 As Variant\n\n'Referencing\nSet wb = ThisWorkbook\nSet ws_wk_dlt = wb.Worksheets(\"t\")\nSet ws_dash = wb.Worksheets(\"x\")\n\n'Values from pivot stored\ncell_B6 = ws_wk_dlt.Range(\"B6\").Value\ncell_C6 = ws_wk_dlt.Range(\"C6\").Value\ncell_D6 = ws_wk_dlt.Range(\"D6\").Value\ncell_E6 = ws_wk_dlt.Range(\"E6\").Value\n\n'If len certain amount of characters then do option 1, or option 2\nIf cell_B6 &lt;&gt; \"\" Then\n    If Len(cell_B6) = 12 And cell_B6 &lt;&gt; \"Actual Sales\" Then\n            SOP_key_B6 = CInt(Mid(cell_B6, 4, 2)) + CInt(Mid(cell_B6, 8, 4))\n    ElseIf Len(cell_B6) = 11 And cell_B6 &lt;&gt; \"Actual Sales\" Then\n        SOP_key_B6 = CInt(Mid(cell_B6, 4, 2)) + CInt(Mid(cell_B6, 7, 4))\n    End If\nEnd If\n\nIf cell_C6 &lt;&gt; \"\" Then\n    If Len(cell_C6) = 12 And cell_C6 &lt;&gt; \"Actual Sales\" Then\n            SOP_key_C6 = CInt(Mid(cell_C6, 4, 2)) + CInt(Mid(cell_C6, 8, 4))\n    ElseIf Len(cell_C6) = 11 And cell_C6 &lt;&gt; \"Actual Sales\" Then\n        SOP_key_C6 = CInt(Mid(cell_C6, 4, 2)) + CInt(Mid(cell_C6, 7, 4))\n    End If\nEnd If\n\nIf cell_D6 &lt;&gt; \"\" Then\n    If Len(cell_D6) = 12 And cell_D6 &lt;&gt; \"Actual Sales\" Then\n            SOP_key_D6 = CInt(Mid(cell_D6, 4, 2)) + CInt(Mid(cell_D6, 8, 4))\n    ElseIf Len(cell_D6) = 11 And cell_D6 &lt;&gt; \"Actual Sales\" Then\n        SOP_key_D6 = CInt(Mid(cell_D6, 4, 2)) + CInt(Mid(cell_D6, 7, 4))\n    End If\nEnd If\n\nIf cell_E6 &lt;&gt; \"\" Then\n    If Len(cell_E6) = 12 And cell_E6 &lt;&gt; \"Actual Sales\" Then\n            SOP_key_E6 = CInt(Mid(cell_E6, 4, 2)) + CInt(Mid(cell_E6, 8, 4))\n    ElseIf Len(cell_E6) = 11 And cell_E6 &lt;&gt; \"Actual Sales\" Then\n        SOP_key_E6 = CInt(Mid(cell_E6, 4, 2)) + CInt(Mid(cell_E6, 7, 4))\n    End If\nEnd If\n\n'Finding the Actual Sales and putting into L30\nIf cell_B6 = \"Actual Sales\" Then\n    ws_dash.Range(\"L31\").Value = cell_B6\nElseIf cell_C6 = \"Actual Sales\" Then\n    ws_dash.Range(\"L31\").Value = cell_C6\nElseIf cell_D6 = \"Actual Sales\" Then\n    ws_dash.Range(\"L31\").Value = cell_D6\nElseIf cell_E6 = \"Actual Sales\" Then\n    ws_dash.Range(\"L31\").Value = cell_E6\nEnd If\n\n'BubbleSort in Descending order\nDim ArrayToSort(0 To 4) As Variant\n\nArrayToSort(0) = SOP_key_B6\nArrayToSort(1) = SOP_key_C6\nArrayToSort(2) = SOP_key_D6\nArrayToSort(3) = SOP_key_E6\n\n'Moving upwards because of -1\nFor j = UBound(ArrayToSort) - 1 To LBound(ArrayToSort) Step -1\n\n  'Starting at lowest\n    For i = LBound(ArrayToSort) To j\n      If ArrayToSort(i) &gt; ArrayToSort(i + 1) Then\n      vTemp = ArrayToSort(i)\n      ArrayToSort(i) = ArrayToSort(i + 1)\n      ArrayToSort(i + 1) = vTemp\n      End If\n    Next i\nNext j\n\n'Put sorted array into the range\n'But how to put the values linked to integers?\n'E.g. SOP_key_B6 = cell_B6 \n ws_dash.Range(\"L30:O30\").Value = ArrayToSort\n\n End Sub\n</code></pre>\n\n<p>Most probably the solution is with replacing the array elements with the correct ones (i.e. <code>SOP_key_B6 = cell_B6</code>, etc.)?</p>\n"}, {"tags": ["vb.net", "vba", "ms-word", "automation", "interop"], "comments": [{"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "edited": false, "score": 0, "creation_date": 1453238209, "post_id": 34886944, "comment_id": 57512400, "body": "I&#39;d love for whom ever gave this question a -1 to please give some explanation... There has been close to a day and half spent on research for this topic."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453239753, "post_id": 34886944, "comment_id": 57513310, "body": "has WordApplication been initialised and opened?"}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453239872, "post_id": 34886944, "comment_id": 57513384, "body": "@Jules Yes, I&#39;m already using it in other areas at this stage."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453241348, "post_id": 34886944, "comment_id": 57514187, "body": "Is ActiveDocument still open at this stage?  Try Console.WriteLine(WordApplication.Documents.Count) before the problem line."}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453241991, "post_id": 34886944, "comment_id": 57514495, "body": "@Jules Yes the ActiveDocument is open at this stage. The result from your <code>Console.WriteLine</code> = 1"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1453242488, "post_id": 34886944, "comment_id": 57514716, "body": "Strange, I can&#39;t replicate the issue here is the code I used <a href=\"https://codeshare.io/Y4g31\" rel=\"nofollow noreferrer\">codeshare.io/Y4g31</a>"}, {"owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1453246314, "post_id": 34886944, "comment_id": 57516206, "body": "@Jules Yup, tested your code - works perfectly fine. Using my existing WordApplication object, I still get the same error... Very weird. PS - Thanks for the help so far."}], "answers": [{"tags": [], "owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "is_accepted": true, "score": 0, "last_activity_date": 1453247814, "creation_date": 1453247814, "answer_id": 34889176, "question_id": 34886944, "link": "https://stackoverflow.com/questions/34886944/vb-net-equivalent-for-customizationcontext-in-vba/34889176#34889176", "title": "VB.Net equivalent for (CustomizationContext) in VBA", "body": "<p>Jules pointed me in the right direction with his sample code.\nAfter lots of playing around I noticed that somewhere in the solution, the <code>[TYPE]</code> of WordApplication was getting changed to a dynamic type of sorts, hence, it couldn't use <code>CustomizationContext</code>.</p>\n\n<p>My solution was this:</p>\n\n<p>I changed this line;</p>\n\n<pre><code>WordApplication.CustomizationContext = WordApplication.ActiveDocument\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>CType(WordApplication, Microsoft.Office.Interop.Word.Application).CustomizationContext = WordApplication.ActiveDocument\n</code></pre>\n\n<p>Forcing the types to be correct.</p>\n\n<p>Simple solution but took some time.</p>\n\n<p>Thanks to Jules for pointing me in the right direction. \n(Points should go to you).</p>\n"}], "owner": {"reputation": 3142, "user_id": 1847710, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NNIaD.jpg?s=128&g=1", "display_name": "Hexie", "link": "https://stackoverflow.com/users/1847710/hexie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 34889176, "answer_count": 1, "score": -1, "last_activity_date": 1453247814, "creation_date": 1453237674, "last_edit_date": 1453239944, "question_id": 34886944, "link": "https://stackoverflow.com/questions/34886944/vb-net-equivalent-for-customizationcontext-in-vba", "title": "VB.Net equivalent for (CustomizationContext) in VBA", "body": "<p>I'm busy with some word automation and have run into an issue whereby a context menu within a document has items in, that I wish to remove.</p>\n\n<p>Once the document is open, through vba I can remove these items by running the following code;</p>\n\n<p>[VBA]</p>\n\n<pre><code>Dim oContextMenu As CommandBar\nDim oContextMenuItem As CommandBarControl\n\n'Make changes to the ActiceDocument only (this is needed to make any changes to this document).\nCustomizationContext = ActiveDocument\n\nFor Each oContextMenu In ActiveDocument.CommandBars\n\n    If oContextMenu.Type = MsoBarType.msoBarTypePopup Then 'Loop through all the context menus of type (msoBarTypePopup)\n\n        For Each oContextMenuItem In oContextMenu.Controls\n\n            If (InStr(oContextMenuItem.Caption, \"Smokeball\")) Then\n                oContextMenuItem.Delete\n            End If\n\n        Next\n\n    End If\n\nNext\n</code></pre>\n\n<p>If I execute this code and check the document, all contextMenu sub items that contain the text \"smokeball\" are removed. </p>\n\n<p>When I try move this code to my VB.NET solution (I have no choice of language, so VB it is), I get errors on the <code>CustomizationContext = ActiveDocument</code> line (this line has to be there for it to affect the current document).</p>\n\n<p>The error I get is <code>CustomizationContext' is not a by reference property.</code></p>\n\n<p>Does anyone know how to get just that ONE line equivalent for vb.net? </p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>EDIT: In case you need to see the vb.net sub:</strong></p>\n\n<pre><code>        Private Sub RemoveUnwantedContextMenuItems()\n\n            Dim oContextMenu As CommandBar\n            Dim oContextMenuItem As CommandBarControl\n\n            'Make changes to the ActiceDocument only (this is needed to make any changes to this document).\n            WordApplication.CustomizationContext = WordApplication.ActiveDocument 'This is the error.\n\n            For Each oContextMenu In WordApplication.CommandBars\n\n                If oContextMenu.Type = MsoBarType.msoBarTypePopup Then 'Loop through all the context menus of type (msoBarTypePopup)\n\n                    For Each oContextMenuItem In oContextMenu.Controls\n\n                        If (InStr(oContextMenuItem.Caption, \"Smokeball\")) Then\n                            oContextMenuItem.Delete()\n                        End If\n\n                    Next\n\n                End If\n\n            Next\n\n        End Sub\n</code></pre>\n\n<p>PS - I have also already tried using the  <code>.AttachedTemplate</code> as well as <code>.Normal / .NormalTemplate</code> </p>\n"}, {"tags": ["vba", "excel", "record"], "comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1453238490, "post_id": 34886843, "comment_id": 57512543, "body": "Is it giving an error on the line currentRecord.associateId = CStr(rs!assocId) or is it giving it elsewhere?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453238814, "post_id": 34886843, "comment_id": 57512740, "body": "What is the field data type is associd?"}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "reply_to_user": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1453238935, "post_id": 34886843, "comment_id": 57512813, "body": "@PKatona - yes you are correct it is giving it on currentRecord.associateId = CStr(rs!assocId).  But I think its the original set of the recordset that makes my rs!assocId field equal to the error I mentioned in the original post because when I step through on the record previous to the offending one it works fine and then steps into the next record and the RS is already set to the error.  It has to be that but I dont know why."}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453238971, "post_id": 34886843, "comment_id": 57512838, "body": "@Nathan_Sav the field type in access is text, in the underlying sql table (these are linked) its varchar(6)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453239472, "post_id": 34886843, "comment_id": 57513128, "body": "It may be the length"}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1453239602, "post_id": 34886843, "comment_id": 57513204, "body": "2200 rows?  That&#39;s strange also when I remove all the string values its only 186 it runs fine about 2004 rows.  So I&#39;m not sure if it is the length."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1453239732, "post_id": 34886843, "comment_id": 57513290, "body": "Can you show the definition of &quot;CurrentImportRecord&quot;?"}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1453239869, "post_id": 34886843, "comment_id": 57513382, "body": "<code>Private Type CurrentImportRecord     associateId As String     transactionType As Integer     transactionAmount As Double     transactionNotes As String End Type</code>"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1453259910, "post_id": 34886843, "comment_id": 57520046, "body": "Try changing <code>&quot;Excel 12.0;HDR=Yes&quot;</code> to <code>&quot;Excel 12.0;IMEX=1;HDR=Yes&quot;</code> - the IMEX part signifies mixed data types"}], "owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453237238, "creation_date": 1453237238, "question_id": 34886843, "link": "https://stackoverflow.com/questions/34886843/access-database-import-from-excel-file-fails-when-associd-first-field-is-mixed", "title": "Access database import from excel file fails when AssocID (first field) is mixed with integers and strings", "body": "<p>I have an access database with vba code that is attempting to access an excel sheet and copy the data to a recordset using DAO.recordset.  If all of the column (assocId) is integer the import works wonderfully if all are strings it works but if you have a mixed back (eg 111111 | Vinny | etc and then on row two you have JOE-1 | Joe | etc) the import will fail.  It says \"You cannot record your changes because a value you entered violates the settings defined for this table\"</p>\n\n<p>Here is the offending sub:</p>\n\n<pre><code>    Public Sub LoadFileInfo()\n    'Load information from selected file\n    On Error GoTo ErrorHappened\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\nDim i As Integer\nDim lastTransType As String\nDim transactionCounter As Integer\nDim currentRecord As CurrentImportRecord\nDim wtf As Variant\n\nSet db = CurrentDb()\nSet rs = db.OpenRecordset(selectTransTypesSql &amp;   GetSetting(\"PayrollManualImportExportTransactionTypes\") &amp; \")\")\nReDim transTypes(DCount(\"TransType\", \"MasterTransactionTypes\", \"IsActive &lt;&gt; 0\")) As MasterTransactionTypes\n\nrs.MoveFirst\nDo While Not rs.EOF\n\n\n    'Add each transaction type and desc to the Private Type and increment the appropriate counter\n    GetMasterTransactionTypes rs!TransType, rs!TransDesc, i\n    rs.MoveNext\n    i = i + 1\nLoop\nrs.Close\n\nSet db = OpenDatabase(importFileName, False, True, \"Excel 12.0;HDR=Yes\")\nSet rs = db.OpenRecordset(\"SELECT * FROM \" &amp; \"[\" &amp; GetSheetName(importFileName) &amp; \"$]\" &amp; \" ORDER BY TransType\")\n\nrs.MoveLast\nimportFields = vbNullString\nFor i = 0 To rs.Fields.count - 1\n    importFields = importFields &amp; rs.Fields(i).Name &amp; \",\"\nNext\n\nfullImport = (rs.Fields.count &gt; 4)\n\ni = 0\ntransactionCounter = 1\n\nlblFile.Caption = \"File name: \" &amp; importFileName\nDim rowNum As Variant\nrowNum = rs.RecordCount\nwtf = rs.GetRows(rowNum)\n\nReDim ledgerEntries(rs.RecordCount) As PayrollLedgerImport\n'Check to see if the recordset actually contains rows; if so push transaction objects to private type array\nrs.MoveFirst\nDo While Not rs.EOF\n    currentRecord.associateId = CStr(rs!assocId)\n    currentRecord.transactionType = rs!TransType\n    currentRecord.transactionNotes = CStr(rs!TransNotes)\n\n    If lastTransType = CStr(currentRecord.transactionType) Then\n        transactionCounter = transactionCounter + 1\n    Else\n        transactionCounter = 1\n    End If\n    If IsValidTransType(currentRecord.transactionType) Then\n        If Not fullImport Then\n            currentRecord.transactionAmount = rs!TransAmount\n            GetPayrollTransactions currentRecord.associateId, currentRecord.transactionType, currentRecord.transactionAmount, currentRecord.transactionNotes, i, transactionCounter\n        Else\n            currentRecord.transactionAmount = rs!TransAmt\n            GetPayrollTransactions currentRecord.associateId, currentRecord.transactionType, currentRecord.transactionAmount, currentRecord.transactionNotes, i, transactionCounter\n        End If\n    Else\n        MsgBox (currentRecord.transactionType &amp; \": Not A Valid Transaction Type\")\n    End If\n    lastTransType = rs!TransType\n    rs.MoveNext\n    i = i + 1\nLoop\n\nFormatFileInformationWindow\ncmdImportFile.Enabled = True\n\n\nEnd Sub\n</code></pre>\n\n<p>I've been at this for hours.  I've tried casting all the columns when I take them in and I get the same issue.  Works fine for all ints or all strings but in reality some of our employees have string and some have int for employee ID.  I tried taking them all in as string converting where necessary but that didn't work either.  Only thing that works is two sheets - one containing strings one containing ints.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 1, "creation_date": 1453238743, "post_id": 34886817, "comment_id": 57512699, "body": "This would be a better answer if you explained why this is the correct formula."}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1453239081, "post_id": 34886817, "comment_id": 57512910, "body": "@Scott Craner it is not doing anything"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1453239087, "post_id": 34886817, "comment_id": 57512916, "body": "@JohnHascall You are correct.  I had someone come into my office and had to post."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1453239272, "post_id": 34886817, "comment_id": 57513015, "body": "@MuhammadKhurrumButt I misread the location of the data.  See edit"}, {"owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "edited": false, "score": 0, "creation_date": 1453239597, "post_id": 34886817, "comment_id": 57513202, "body": "@Scott Craner i think it should check Same row D60 cuz value in cell A60 is Showing up in cell as per date"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453239855, "post_id": 34886817, "comment_id": 57513371, "body": "Did you try the new formula I edited?  The Event is the value in the calendar, and you are testing on the location, so the new formula works."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1453239923, "last_edit_date": 1453239923, "creation_date": 1453237145, "answer_id": 34886817, "question_id": 34886752, "link": "https://stackoverflow.com/questions/34886752/highlight-formula-excel-vba/34886817#34886817", "title": "Highlight Formula Excel VBA", "body": "<p>Use this formula instead:</p>\n\n<pre><code>=VLOOKUP(B3,$A$60:$D$150,4,FALSE) = \"ABC\"\n</code></pre>\n\n<p>This will take the value in the cell and try to find it in the Range A60:A150.  If it finds the value it will return the Station/Place.  Then it tests if that equals \"ABC\" and returns True if it does.  </p>\n\n<p>If VLOOKUP Fails to find a match or that match does not equal \"ABC\", it will return False.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3mfbP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3mfbP.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 137, "user_id": 5806470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gMESMeUvDnk/AAAAAAAAAAI/AAAAAAAAAEA/rItuBL0L-tM/photo.jpg?sz=128", "display_name": "Muhammad Khurrum Butt", "link": "https://stackoverflow.com/users/5806470/muhammad-khurrum-butt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 34886817, "answer_count": 1, "score": 4, "last_activity_date": 1453239923, "creation_date": 1453236879, "last_edit_date": 1531161705, "question_id": 34886752, "link": "https://stackoverflow.com/questions/34886752/highlight-formula-excel-vba", "title": "Highlight Formula Excel VBA", "body": "<p>I am making an Event Manager with data in Column A60:A150 (Event Name) B60:b150(Start Date) and C60 to c150(End Date) D60 to D150(Place)\nwhen i am entering data in cells it appears event name in calendar</p>\n\n<p>i want if value in Column D60:D150 ABC the dates should higlight green or any color</p>\n\n<p><a href=\"https://i.stack.imgur.com/Qj4T3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qj4T3.jpg\" alt=\"Event\"></a></p>\n\n<p>As per image Red Bull should highlight Green and AAA should be other color if that Event Station/Place is different.</p>\n\n<p><a href=\"https://i.stack.imgur.com/iAx4o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iAx4o.jpg\" alt=\"Event2\"></a></p>\n\n<p>i use this formula </p>\n\n<blockquote>\n  <p>=D60:d150=\"ABC\" </p>\n</blockquote>\n\n<p>color green and select range B3:AF50 but it is only changing color of cell b3 not as per dates</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 1, "creation_date": 1453236860, "post_id": 34886693, "comment_id": 57511641, "body": "Please check out <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453238073, "post_id": 34886693, "comment_id": 57512311, "body": "Are you sure you need VBA and not a formula that can pull this info?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5812458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4986c3656db72eb15568c537e19eb526?s=128&d=identicon&r=PG&f=1", "display_name": "BeefyDan", "link": "https://stackoverflow.com/users/5812458/beefydan"}, "edited": false, "score": 0, "creation_date": 1453340561, "post_id": 34888450, "comment_id": 57563264, "body": "thanks a lot, i&#39;ll give it a try tomorrow! sorry for the noob formatting or lack there of, first poster here, long time lurker."}], "tags": [], "owner": {"reputation": 328, "user_id": 5622596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fe6b4f42fe97fa2d5272f90e1e8f67b?s=128&d=identicon&r=PG&f=1", "display_name": "jspek", "link": "https://stackoverflow.com/users/5622596/jspek"}, "is_accepted": false, "score": 1, "last_activity_date": 1453255329, "last_edit_date": 1453255329, "creation_date": 1453243798, "answer_id": 34888450, "question_id": 34886693, "link": "https://stackoverflow.com/questions/34886693/simple-excel-vba-loop-needed/34888450#34888450", "title": "Simple Excel VBA Loop needed", "body": "<p>I'm assuming that the source column is column A (1), and the output row is column B (2). </p>\n\n<p>One possible solution to problem is using a regular expression and a while loop. </p>\n\n<p>To enable regular expression in VBA go into the editor (VBE).</p>\n\n<ol>\n<li>Click on Tools Tab.</li>\n<li>Click on References</li>\n<li>Check Microsoft VBScript Regular Expressions 5.5 </li>\n</ol>\n\n<p>To run the code create a separate module and insert this:</p>\n\n<pre><code>Sub splitCol()\n\n    'Variables used in the regular expression\n    Dim re As New RegExp\n    Dim mc As MatchCollection\n\n    'Variables used for row looping\n    Dim sourceRow As Integer\n    Dim targetRow As Integer\n\n    'Variables used for output string\n    Dim numberOfLevels As Integer\n    Dim currentLevel As Integer\n    Dim houseName As String\n\n    'Regular expression patter\n    re.Pattern = \"(.+)?\\,+\\s+?(\\d+)+\\s+?levels\"\n\n    'With the asumption that Row 1 are headers I'm starting at row 2\n    sourceRow = 2\n    targetRow = 2\n    numberOfLevels = 0\n\n    'Loop through input row until blank is found\n    While (Cells(sourceRow, 1).Value &lt;&gt; \"\")\n        'Execute the regular expression\n        Set mc = re.Execute(Cells(sourceRow, 1).Value)\n\n        'Only create output string if regular expression was able to\n        'executed without a problem\n        If mc.Count &gt; 0 Then\n            houseName = mc(0).SubMatches(0)\n            numberOfLevels = mc(0).SubMatches(1)\n\n            currentLevel = 1\n            While currentLevel &lt;= numberOfLevels\n                Cells(targetRow, 2).Value = houseName &amp; \" , Level \" &amp; CStr(currentLevel)\n                targetRow = targetRow + 1\n                currentLevel = currentLevel + 1\n            Wend\n        End If\n        sourceRow = sourceRow + 1\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5812458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4986c3656db72eb15568c537e19eb526?s=128&d=identicon&r=PG&f=1", "display_name": "BeefyDan", "link": "https://stackoverflow.com/users/5812458/beefydan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573030804, "creation_date": 1453236641, "last_edit_date": 1573030804, "question_id": 34886693, "link": "https://stackoverflow.com/questions/34886693/simple-excel-vba-loop-needed", "title": "Simple Excel VBA Loop needed", "body": "<p>I'm trying to make a simple loop in Excel VBA that grabs info from a row and copies that same info into the next following row (or insert a new one) depending on the value on a specific cell. </p>\n\n<p>For example, row 1 has these values (house 1a, 3 levels)</p>\n\n<p>then create the result on cell H5 like this</p>\n\n<pre><code>(house 1a, bottom level)\n(house 1a, mid level)\n(house 1a, top level)\n</code></pre>\n\n<p>meaning each level of house 1a was split into 3 rows. then imagine I would have a list of ten more houses with different levels up to 3, randomly. </p>\n\n<p>sorry about the parenthesis but this editor keeps thinking i'm writing code.</p>\n\n<p>any help would be greatly appreciated. </p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 0, "creation_date": 1453905839, "post_id": 34886652, "comment_id": 57805095, "body": "did any of the answers below resolved your question? if yes accept an answer to mark the post as Answered... If not, give more details on what you want to achieve."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1453237168, "creation_date": 1453237168, "answer_id": 34886822, "question_id": 34886652, "link": "https://stackoverflow.com/questions/34886652/combining-different-tables-in-excel-by-looking-up-values/34886822#34886822", "title": "Combining different tables in excel by looking up values", "body": "<p>Assuming that the three tables are in Sheet1, Sheet2, Sheet3, this is the formula you need in Sheet3, cell A2</p>\n\n<pre><code>=vlookup(Sheet2!A2,Sheet1!$A2$b$6,2,false)\n</code></pre>\n\n<p>Copy down as many rows as there are rows in Sheet2</p>\n\n<p>If you need the client info from Sheet2, use this in Sheet3, cell B2 and copy down</p>\n\n<pre><code>=sheet2!B2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "is_accepted": true, "score": 1, "last_activity_date": 1453308658, "last_edit_date": 1453308658, "creation_date": 1453238069, "answer_id": 34887031, "question_id": 34886652, "link": "https://stackoverflow.com/questions/34886652/combining-different-tables-in-excel-by-looking-up-values/34887031#34887031", "title": "Combining different tables in excel by looking up values", "body": "<p>As you put an \"SQL\" tag, I assume that you are also looking for an SQL based answer. So in addition to @teylyn suggestion, you can use the following SQL query if you are working with SQL databases:</p>\n\n<pre><code>SELECT table1.Client_Name, table2.Client_Info\nFROM table1\nRIGHT JOIN table2 ON table1.ID_Number = table2.ID_Number\n</code></pre>\n\n<p>Here is what this query does:</p>\n\n<p>The <code>RIGHT JOIN</code> will return all rows from the right table (here table2), with the matching rows in the left table (here table1) according to the condition specified by the <code>ON</code> clause (here, if the <em>ID</em> <em>Number</em> is the same). Then, the <code>SELECT</code> clause will return a table with ONLY the columns specified after the keyword <code>SELECT</code>.</p>\n"}], "owner": {"reputation": 1201, "user_id": 2642226, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e9d5fa09e256c4f848594193348bd502?s=128&d=identicon&r=PG", "display_name": "Andrio", "link": "https://stackoverflow.com/users/2642226/andrio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 34887031, "answer_count": 2, "score": 0, "last_activity_date": 1453308658, "creation_date": 1453236500, "question_id": 34886652, "link": "https://stackoverflow.com/questions/34886652/combining-different-tables-in-excel-by-looking-up-values", "title": "Combining different tables in excel by looking up values", "body": "<p>Okay, so let's say I have two tables in Excel. I want to create a third table that looks up data from the other two and combines them. I'll explain what I mean</p>\n\n<p>Here is my first table:</p>\n\n<p><a href=\"https://i.imgur.com/Bk5P6KJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/Bk5P6KJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>It has a number, which is like a primary key, and a corresponding name for each entry.</p>\n\n<p>I also have a second table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LDw5M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LDw5M.png\" alt=\"enter image description here\"></a></p>\n\n<p>This one just contains some random info, and there's numerous entries. The <code>Client Name</code> is not listed here, but it does have the key for the client that each entry corresponds to.</p>\n\n<p>I want to create a third table that shows me all the Client Info data, but replaces the key with the actual client name. So basically, wherever it sees a key of \"1\", it'll look that up from the first table and find \"Comet\" instead.</p>\n\n<p>The desired table would look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7uUfq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7uUfq.png\" alt=\"enter image description here\"></a></p>\n\n<p>What kind of formula would I need to pull data from one table based on a value? Note that all my tables are in different worksheets.</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1453239791, "creation_date": 1453239791, "answer_id": 34887496, "question_id": 34886453, "link": "https://stackoverflow.com/questions/34886453/outlook-vba-code-to-export-parts-of-body-to-excel-not-working/34887496#34887496", "title": "Outlook VBA code to export parts of body to Excel not working", "body": "<p>Try</p>\n\n<pre><code>Sub ExportToExcel(oMail As mailItem)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Set olMail = myMail\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5812356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25cafa922124138ae76000165120b7eb?s=128&d=identicon&r=PG&f=1", "display_name": "ordak", "link": "https://stackoverflow.com/users/5812356/ordak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 34887496, "answer_count": 1, "score": 1, "last_activity_date": 1453239791, "creation_date": 1453235689, "last_edit_date": 1495540322, "question_id": 34886453, "link": "https://stackoverflow.com/questions/34886453/outlook-vba-code-to-export-parts-of-body-to-excel-not-working", "title": "Outlook VBA code to export parts of body to Excel not working", "body": "<p>I've used a variety of resources from stackoverflow  and a few other places to get some code in VBA. This is the third iteration I've tried and still haven't gotten it to work. The first iteration was written mostly from scratch, but didn't work. The second iteration was based on <a href=\"https://stackoverflow.com/questions/8697493/update-excel-sheet-based-on-outlook-mail\">this stackoverflow post</a>. I had the code in the ThisOutlookSession Outlook Object to run at startup. The current iteration is based on <a href=\"https://stackoverflow.com/questions/11876549/how-to-copy-outlook-mail-message-into-excel-using-vba-or-macros\">this stackoveflow post</a> and is in it's own Module. It's run using a rule in Outlook.</p>\n\n<p>The part that gets the data from the email body has seemed to work fine in the previous iterations of the code. But the part that writes to Excel doesn't seem to be working, and hasn't worked in any of the previous iterations and I don't know why.</p>\n\n<p>I have a rule set in Outlook to run the macro on emails with a specific subject line. These emails are structured in a specific way that makes it easy to get the data. The rule also sets these emails to read, which it does, so I can see the rule works. </p>\n\n<p>I have an Excel sheet in My Documents with the first row being dedicated to labeling the columns. Though I've tried this with an empty Excel sheet as well and it still didn't work.</p>\n\n<p>The email body looks something like this:</p>\n\n<hr>\n\n<p>ID: 608</p>\n\n<p>FirstName:  test</p>\n\n<p>MiddleInitial:  t</p>\n\n<p>LastName:   testet</p>\n\n<p>BirthDate:  01/01/1900</p>\n\n<p>Gender: Male</p>\n\n<p>StreetAddress:  </p>\n\n<p>City:   </p>\n\n<p>State:  </p>\n\n<p>Zip:    </p>\n\n<p>Ethnicity:  </p>\n\n<p>dtAdded:    01/19/2016</p>\n\n<p>Area:   Hair Loss</p>\n\n<p>Area:   Skin Cancer</p>\n\n<hr>\n\n<p>There could be anywhere from 0 to 12 Areas, each simply labeled as Area. Below is some of the code I have. I've trimmed some of the repetitive parts so it isn't as long (still kind of long, sorry):</p>\n\n<pre><code>Option Explicit\n\nConst xlUp As Long = -4162\n\nSub ExportToExcel(MyMail As MailItem)\n    Dim strID As String, olNS As Outlook.NameSpace\n    Dim olMail As Outlook.MailItem\n    Dim strFileName As String\n\n    '~~&gt; Outlook Variables\n    Dim idNum As String\n    Dim firstName As String\n    Dim middleInitial As String\n    Dim lastName As String\n    Dim birthDate As String\n    Dim gender As String\n    Dim streetAddress As String\n    Dim city As String\n    Dim state As String\n    Dim zipcode As String\n    Dim ethnicity As String\n    Dim dateAdded As String\n    Dim area1 As String\n    Dim area2 As String\n    Dim area11 As String\n    Dim area12 As String\n    Dim areaOther As String\n    Dim areas As String\n\n\n'~~&gt; Process Outlook Stuff\nidNum = ParseTextLinePair(olMail.Body, \"ID:\")\nfirstName = ParseTextLinePair(olMail.Body, \"FirstName:\")\nmiddleInitial = ParseTextLinePair(olMail.Body, \"MiddleInitial:\")\nlastName = ParseTextLinePair(olMail.Body, \"LastName:\")\nbirthDate = ParseTextLinePair(olMail.Body, \"BirthDate:\")\ngender = ParseTextLinePair(olMail.Body, \"Gender:\")\nstreetAddress = ParseTextLinePair(olMail.Body, \"StreetAddress:\")\ncity = ParseTextLinePair(olMail.Body, \"City:\")\nstate = ParseTextLinePair(olMail.Body, \"State:\")\nzipcode = ParseTextLinePair(olMail.Body, \"Zipcode:\")\nethnicity = ParseTextLinePair(olMail.Body, \"Ethnicity:\")\n\nDim intLocLabel As Integer\nDim intLocCRLF As Integer\nDim intLenLabel As Integer\n\n'area1\nintLocLabel = InStr(olMail.Body, \"Area:\")\nintLenLabel = Len(\"Area:\")\n    If intLocLabel &gt; 0 Then\n        'vbCrLf = new line\n        intLocCRLF = InStr(intLocLabel, olMail.Body, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            area1 = Mid(olMail.Body, _\n                        intLocLabel, _\n                        intLocCRLF - intLocLabel)\n        Else\n                       ' this was Mid(..\n            area1 = Mid(olMail.Body, intLocLabel + intLenLabel)\n        End If\n    End If\n\n    'area2:\n    If intLocCRLF &gt; 0 Then\n\n    intLocLabel = InStr(intLocCRLF, olMail.Body, \"Area:\")\n    If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, olMail.Body, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            area2 = Mid(olMail.Body, _\n                    intLocLabel, _\n                    intLocCRLF - intLocLabel)\n        Else\n                                ' this was Mid(..\n            area2 = Mid(olMail.Body, intLocLabel + intLenLabel)\n        End If\n    End If\n\n    End If\n\n    'area11:\n    If intLocCRLF &gt; 0 Then\n\n    intLocLabel = InStr(intLocCRLF, olMail.Body, \"Area:\")\n    If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, olMail.Body, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            area11 = Mid(olMail.Body, _\n                    intLocLabel, _\n                    intLocCRLF - intLocLabel)\n        Else\n                                ' this was Mid(..\n            area11 = Mid(olMail.Body, intLocLabel + intLenLabel)\n        End If\n    End If\n\n    End If\n\n    'area12\n    If intLocCRLF &gt; 0 Then\n\n    intLocLabel = InStr(intLocCRLF, olMail.Body, \"Area:\")\n    If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, olMail.Body, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            area12 = Mid(olMail.Body, _\n                    intLocLabel, _\n                    intLocCRLF - intLocLabel)\n        Else\n                                ' this was Mid(..\n            area12 = Mid(olMail.Body, intLocLabel + intLenLabel)\n        End If\n    End If\n\n    End If\n\n    'areaOther is easy because it has the Other Skin Problems label\n    areaOther = ParseTextLinePair(olMail.Body, \"Other Skin Problems,\")\n\n\nIf InStr(area1, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area1\nEnd If\nIf InStr(area2, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area2\nEnd If\nIf InStr(area3, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area3\nEnd If\nIf InStr(area4, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area4\nEnd If\nIf InStr(area5, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area5\nEnd If\nIf InStr(area6, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area6\nEnd If\nIf InStr(area7, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area7\nEnd If\nIf InStr(area8, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area8\nEnd If\nIf InStr(area9, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area9\nEnd If\nIf InStr(area10, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area10\nEnd If\nIf InStr(area11, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area11\nEnd If\nIf InStr(area12, \"Other Skin Problems,\") = 0 Then\n    areas = areas &amp; area12\nEnd If\n\n'~~&gt; Excel Variables\nDim oXLApp As Object, oXLwb As Object, oXLws As Object\nDim lRow As Long\n\nstrID = MyMail.EntryID\nSet olNS = Application.GetNamespace(\"MAPI\")\nSet olMail = olNS.GetItemFromID(strID)\n\n'~~&gt; Establish an EXCEL application object\nOn Error Resume Next\nSet oXLApp = GetObject(, \"Excel.Application\")\n\n'~~&gt; If not found then create new instance\nIf Err.Number &lt;&gt; 0 Then\n    Set oXLApp = CreateObject(\"Excel.Application\")\nEnd If\nErr.Clear\nOn Error GoTo 0\n\n'~~&gt; Show Excel\noXLApp.Visible = True\n\n'~~&gt; Open the relevant file\nSet oXLwb = oXLApp.Workbooks.Open(\"C:\\Users\\$$MYUSER$$\\Documents\\$$MYFILENAME$$.xlsx\")\n\n'~~&gt; Set the relevant output sheet. Change as applicable\nSet oXLws = oXLwb.Sheets(\"Sheet1\")\n\nlRow = oXLws.Range(\"A\" &amp; oXLApp.Rows.Count).End(xlUp).Row + 1\n\n'~~&gt; Write to outlook\nWith oXLws\n    '\n    '\n    .Range(\"A\" &amp; lRow).Value = idNum\n    .Range(\"B\" &amp; lRow).Value = dateAdded\n    .Range(\"O\" &amp; lRow).Value = firstName\n    .Range(\"P\" &amp; lRow).Value = middleInitial\n    .Range(\"Q\" &amp; lRow).Value = lastName\n    .Range(\"R\" &amp; lRow).Value = birthDate\n    .Range(\"S\" &amp; lRow).Value = gender\n    .Range(\"T\" &amp; lRow).Value = streetAddress\n    .Range(\"U\" &amp; lRow).Value = city\n    .Range(\"V\" &amp; lRow).Value = state\n    .Range(\"W\" &amp; lRow).Value = zipcode\n    .Range(\"AE\" &amp; lRow).Value = ethnicity\n\n        With .Range(\"C\" &amp; lRow)\n            If InStr(areas, \"Acne\") &gt; 0 Then\n                .Value = \"Yes\"\n            End If\n        End With\n\n        With .Range(\"H\" &amp; lRow)\n            If InStr(areas, \"Hair Loss\") &gt; 0 Then\n                .Value = \"Yes\"\n            End If\n        End With\n\n        With .Range(\"J\" &amp; lRow)\n            If InStr(areas, \"Skin Cancer\") &gt; 0 Then\n                .Value = \"Yes\"\n            End If\n        End With\n\n        With .Range(\"L\" &amp; lRow)\n            If InStr(areas, \"Wrinkles\") &gt; 0 Then\n                .Value = \"Yes\"\n            End If\n        End With   \n\n\n    End With\n\n    Debug.Print idNum\n    Debug.Print firstName\n\n    '~~&gt; Close and Clean up Excel\n    oXLwb.Close (True)\n    oXLApp.Quit\n    Set oXLws = Nothing\n    Set oXLwb = Nothing\n    Set oXLApp = Nothing\n\n    Set olMail = Nothing\n    Set olNS = Nothing\nEnd Sub\nFunction ParseTextLinePair(strSource As String, strLabel As String)\n    'This function extracts the data from any label-data pair that appears\n    'in a block of text, where all the label-data pairs are on separate\n    'lines. A typical application would be parsing the text sent as email\n    'by a form on a web site, where the incoming message has multiple lines\n    'each with a different Label: Data pair\n\n    Dim intLocLabel As Integer\n    Dim intLocCRLF As Integer\n    Dim intLenLabel As Integer\n    Dim strText As String\n\n    ' locate the label in the source text\n    '   InStr returns 0 if srtLabel is not found in strSource\n    '   InStr returns the position of the first occurance of strLabel in strSource\n    intLocLabel = InStr(strSource, strLabel)\n    intLenLabel = Len(strLabel)\n    If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, strSource, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            strText = Mid(strSource, _\n                            intLocLabel, _\n                            intLocCRLF - intLocLabel)\n        Else\n            strText = Mid(strSource, intLocLabel + intLenLabel)\n        End If\n    End If\n    ' the Trim function can be useful to remove non-printing and\n    '     leading or ending spaces from text\n    ParseTextLinePair = Trim(strText)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1453235926, "post_id": 34886334, "comment_id": 57511023, "body": "Since you only have three groups, I would just do the same thing for the other two ranges in the recorder."}], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 4068548, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e6f18fc0c881025402ce611b84f2b160?s=128&d=identicon&r=PG&f=1", "display_name": "Egodym", "link": "https://stackoverflow.com/users/4068548/egodym"}, "edited": false, "score": 0, "creation_date": 1453237225, "post_id": 34886504, "comment_id": 57511854, "body": "Thanks, it works using the Relative References. However, I get blank spaces between the transposed elements (which is obvious since the macro does the same job for each group)."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 4, "last_activity_date": 1453235906, "creation_date": 1453235906, "answer_id": 34886504, "question_id": 34886334, "link": "https://stackoverflow.com/questions/34886334/excels-macro-recorder-usage/34886504#34886504", "title": "Excel&#39;s Macro-Recorder usage", "body": "<p>The macro recorder isn't the most useful tool. Most experienced VBA programmers use it only for quick experiments to discover some detail about how the Excel object model works and then throw away the actual code.</p>\n\n<p>Having said that, it can still be useful, especially if you have neither the time nor the inclination to learn VBA.</p>\n\n<p>To do the sort of thing that you want to do</p>\n\n<p>1) On the developer tab select the option <code>Use Relative References</code></p>\n\n<p>2) Select the cell or range whose modification you are trying to record. Recorded macros which <em>begin</em> by selecting a cell are typically not as useful as recorded macros in which you have carefully thought of what you want selected before recording.</p>\n\n<p>3) Turn on the macro and record your actions. See if it works.</p>\n\n<p>4) If it doesn't work -- see if you can edit the code.</p>\n\n<p>5) Ask a focused question on Stack Overflow if worse comes to worse.</p>\n\n<p>The way you use such a recorded macro is to first select the cells that you want to change and then invoke the macro. It will perform on the selected cells the same action that you did on the other selected cells -- but with all offsets, etc. relative to your current selection.</p>\n"}], "owner": {"reputation": 431, "user_id": 4068548, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e6f18fc0c881025402ce611b84f2b160?s=128&d=identicon&r=PG&f=1", "display_name": "Egodym", "link": "https://stackoverflow.com/users/4068548/egodym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 34886504, "answer_count": 1, "score": 2, "last_activity_date": 1470683597, "creation_date": 1453235260, "last_edit_date": 1470683597, "question_id": 34886334, "link": "https://stackoverflow.com/questions/34886334/excels-macro-recorder-usage", "title": "Excel&#39;s Macro-Recorder usage", "body": "<p>I would like to build a macro (using the Macro-Recorder) for a paste-special task: I have 3 groups of 3 elements in column A, and I would like to copy the transponse of each group starting from the second row (in columns C,D,E) as showed in the picture below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Lg3Df.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lg3Df.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I tried to do this by turning on the macro recorder while performing the paste-special operation once, but then the macro works only for the data I have on the cells where I record the macro (e.g., if I record the macro using the range A2:A4, that's the only place where input data can be transposed). Is there a proper way to use the macro-recorder for such task?</p>\n"}]