[{"tags": ["vba", "excel", "sap"], "answers": [{"tags": [], "owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "is_accepted": true, "score": 0, "last_activity_date": 1469226875, "creation_date": 1469226875, "answer_id": 38536159, "question_id": 38492348, "link": "https://stackoverflow.com/questions/38492348/using-sapgui-in-excel-vba-why-does-changing-the-verticalscrollbar-position-of/38536159#38536159", "title": "Using SAPGUI in excel/VBA, Why does changing the .VerticalScrollbar.Position of a GuiTableControl breaks the object &quot;connection&quot;?", "body": "<p>I found the answer in the SAP GUI scripting API pdf at\n<a href=\"http://www.synactive.com/download/sap%20gui%20scripting/sap%20gui%20scripting%20api.pdf\" rel=\"nofollow\">http://www.synactive.com/download/sap%20gui%20scripting/sap%20gui%20scripting%20api.pdf</a></p>\n\n<p>The important passage was in the description of the GuiButton control.</p>\n\n<blockquote>\n  <p>Function press </p>\n  \n  <p>This emulates manually pressing a button. Pressing a button will always cause server communication to occur, rendering all references to elements below the window level invalid. The following code will therefore fail:</p>\n</blockquote>\n\n<pre><code>Set TextField = session.findById(\".../txtF1\") \nsession.findById(\".../btnPB5\").press \nTextField.text = \"Hello\"\n</code></pre>\n\n<p>This is because when you execute commands, some will only affect the client state but other commands will cause communication with server and apparently when that happens, all previous object references are broken.</p>\n\n<p>Changing the .VerticalScrollbar.Position of a GuiTableControl also causes communication with the server.</p>\n"}], "owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 38536159, "answer_count": 1, "score": 0, "last_activity_date": 1469226875, "creation_date": 1469056369, "question_id": 38492348, "link": "https://stackoverflow.com/questions/38492348/using-sapgui-in-excel-vba-why-does-changing-the-verticalscrollbar-position-of", "title": "Using SAPGUI in excel/VBA, Why does changing the .VerticalScrollbar.Position of a GuiTableControl breaks the object &quot;connection&quot;?", "body": "<p>First my test code</p>\n\n<pre><code>Sub mytest2()\nIf Not IsObject(MyApplication) Then\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\n   Set MyApplication = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n   Set Connection = MyApplication.Children(0)\nEnd If\nIf Not IsObject(session) Then\n   Set session = Connection.Children(0)\nEnd If\nIf IsObject(Wscript) Then\n   Wscript.ConnectObject session, \"on\"\n   Wscript.ConnectObject MyApplication, \"on\"\nEnd If\n\n\nDim MyTableStr As String\nDim MyTable As Variant\n\nMyTableStr = \"wnd[0]/usr/subSUB_ALL:SAPLCOIH:3001/ssubSUB_LEVEL:SAPLCOIH:1107/tabsTS_1100/tabpVGUE/ssubSUB_AUFTRAG:SAPLCOVG:3010/tblSAPLCOVGTCTRL_3010\"\nSet MyTable = session.findById(MyTableStr)\nMyTable.VerticalScrollbar.Position = MyTable.VerticalScrollbar.Position + 1\nDebug.Print MyTable.VerticalScrollbar.Position &amp; \" position\"\n</code></pre>\n\n<p>This code will increase the table's vertical position and then fail on the debug.print line with error \"Object doesn't support this action\" Run-time error 445</p>\n\n<p>If I add again the line</p>\n\n<pre><code>Set MyTable = session.findById(MyTableStr)\n</code></pre>\n\n<p>Between the .position line and the debug.print line, it works and the position gets printed.</p>\n\n<p>Why does this happen ?</p>\n"}, {"tags": ["arrays", "vba", "excel", "collections", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1469056713, "post_id": 38492188, "comment_id": 64386060, "body": "Pick up the whole input range into an array and just ignore the parts you don&#39;t need."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469062213, "post_id": 38492188, "comment_id": 64387318, "body": "this seems like it will be easier with PivotTable/PowerPivot or Power Query"}], "answers": [{"comments": [{"owner": {"reputation": 242, "user_id": 2530218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a87f6b654504caae6a0ccc7d183a88ed?s=128&d=identicon&r=PG", "display_name": "MJA", "link": "https://stackoverflow.com/users/2530218/mja"}, "edited": false, "score": 0, "creation_date": 1469651806, "post_id": 38492453, "comment_id": 64631037, "body": "I didn&#39;t think a dictionary would work well for this problem because of the inability to sort by key, but I found a script to do that, making a dictionary the perfect fit. I did some more tweaking which I plan to post later when time permits."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 242, "user_id": 2530218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a87f6b654504caae6a0ccc7d183a88ed?s=128&d=identicon&r=PG", "display_name": "MJA", "link": "https://stackoverflow.com/users/2530218/mja"}, "edited": false, "score": 1, "creation_date": 1469675605, "post_id": 38492453, "comment_id": 64637728, "body": "You could use a SortedList instead of a dictionary.   Like a Dictionary, SortedList store data in key value pairs. The SortedList automatically sorts the keys as you add them.  This article <a href=\"http://www.robvanderwoude.com/vbstech_data_sortedlist.php\" rel=\"nofollow noreferrer\">SortedList</a> , demonstrates how to use them."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1469057247, "creation_date": 1469057247, "answer_id": 38492453, "question_id": 38492188, "link": "https://stackoverflow.com/questions/38492188/copy-non-contiguous-columns-into-into-a-multi-dimension-array/38492453#38492453", "title": "Copy non-contiguous columns into into a multi-dimension array?", "body": "<p>A collection would work but I prefer to use a Scripting Dictionary.  Scripting Dictionaries have an Exists method that you can use to see if a Key exists already, collections don't.  When adding Keys to a collection you'll have to escape any errors caused by trying to add a duplicate key.</p>\n\n<pre><code>Sub UpdateTargetTable()\n    Dim k As String\n    Dim lastRow As Long, x As Long\n    Dim dict As Object\n    Dim arr\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With Worksheets(\"Source\")\n        lastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For x = 2 To lastRow\n            k = .Cells(x, 1) &amp; .Cells(x, 2)\n\n            If Not dict.Exists(k) Then\n                dict.Add k, .Range(.Cells(x, 3), .Cells(x, 5)).Value\n            End If\n\n        Next\n\n    End With\n\n    With Worksheets(\"Target\")\n        lastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        For x = 2 To lastRow\n            k = .Cells(x, 1) &amp; .Cells(x, 2)\n\n            If dict.Exists(k) Then\n                arr = dict(k)\n\n               .Cells(x, 3) = arr(1, 1)\n               .Cells(x, 4) = arr(1, 2)\n               .Cells(x, 6) = arr(1, 3)\n\n            End If\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 242, "user_id": 2530218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a87f6b654504caae6a0ccc7d183a88ed?s=128&d=identicon&r=PG", "display_name": "MJA", "link": "https://stackoverflow.com/users/2530218/mja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 38492453, "answer_count": 1, "score": 1, "last_activity_date": 1469057247, "creation_date": 1469055314, "question_id": 38492188, "link": "https://stackoverflow.com/questions/38492188/copy-non-contiguous-columns-into-into-a-multi-dimension-array", "title": "Copy non-contiguous columns into into a multi-dimension array?", "body": "<p>I'm trying to copy values from one sheet to another, comparing the Key values (columns A &amp; C) and either pasting a value (column E) into the target sheet or adding a row and pasting all three values into A, C, F.</p>\n\n<p>Here's a sample of the data:</p>\n\n<pre><code>SOURCE TABLE\nA       B       C       D       E   \nName    Ext     Dept    Days    w22Hrs\n------- ------- ------- ------- -------\nAlan    x101    Level1  MTWTF   8\nBrian   x102    Level1  MTWTF   30\nClaire  x103    Level1  MTWTF   40\nDenise  x104    Level2  MTWTF   16\nDenise  x105    Level1  MTWTF   24\n\nTARGET TABLE\nA       B       C       D       E       F\nName    Ext     Dept    Days    w21Hrs  w22Hrs\n------- ------- ------- ------- ------- -------\nBrian   x102    Level1  MTWTF   32      \nDenise  x104    Level2  MTWTF   16      \nDenise  x105    Level1  MTWTF   8       \nEric    x106    Level1  MTWTF   36      \n\nDESIRED RESULT\nA       B       C       D       E       F\nName    Ext     Dept    Days    w21Hrs  w22Hrs\n------- ------- ------- ------- ------- -------\nAlan            Level1          0       8\nBrian   x102    Level1  MTWTF   32      30\nClaire          Level1          0       40\nDenise  x104    Level2  MTWTF   16      16\nDenise  x105    Level1  MTWTF   8       24\nEric    x106    Level1  MTWTF   36      0\n</code></pre>\n\n<p>I tried to copy the source data into an array using this code:</p>\n\n<pre><code>set rng = union(range(\"A2:A6\"), range(\"C2:C6\"), range(\"E2:E6\"))\narrTemp = rng.value2\narr = application.transpose(arrTemp)\n</code></pre>\n\n<p>But all I get is are values from A2:A6. However this works:</p>\n\n<pre><code>set rng = range(\"A2:E6\")\narrTemp = rng.value2\narr = application.transpose(arrTemp)\n</code></pre>\n\n<p>1 - Is there no easy way to put only the columns I want into the array? (Iterating through cell areas seems inelegant to me.)</p>\n\n<p>2 - Is there an easier way to accomplish the overall goal of updating the target sheet? (Keep in mind I want to update w##Hrs for existing rows AND add new rows when needed.) Or are arrays my best bet? (Would a Collection be better?)</p>\n\n<p>If it makes things easier, I can paste A:D into the target, but source.E still needs to go into target.F.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6615882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aHe6C.png?s=128&g=1", "display_name": "Nick F", "link": "https://stackoverflow.com/users/6615882/nick-f"}, "edited": false, "score": 0, "creation_date": 1469114590, "post_id": 38492973, "comment_id": 64414431, "body": "Thanks. But I&#39;m trying to get the process to automate so that I don&#39;t have to filter each time."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 6615882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aHe6C.png?s=128&g=1", "display_name": "Nick F", "link": "https://stackoverflow.com/users/6615882/nick-f"}, "edited": false, "score": 0, "creation_date": 1469115025, "post_id": 38492973, "comment_id": 64414729, "body": "if you are trying to get automation (VBA), you&#39;ll need to post the coding attempts you&#39;ve tried and where it&#39;s gone wrong, then someone will help you fix it"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1469061239, "creation_date": 1469061239, "answer_id": 38492973, "question_id": 38491663, "link": "https://stackoverflow.com/questions/38491663/excel-sum-instances-of-an-item-in-a-column-until-a-different-column-variable-is/38492973#38492973", "title": "Excel Sum instances of an item in a column until a different column variable is met", "body": "<p>Place this formula in <code>B2</code>:</p>\n\n<pre><code>=IFERROR(SUM(OFFSET(B3,0,0,MATCH($A2,$A3:$A1000,0)-1,1)),SUM(B3:B1000))\n</code></pre>\n\n<p>Then filter on all rows with <code>Type A</code> and copy from B2 for all the visible cells.</p>\n\n<p>The <code>IFERROR</code> is only for the last <code>Type A</code> (with no <code>Type A</code> underneath it. Then it will just sum the remaining rows underneath. Also, adjust the <code>1000</code> if needed.</p>\n"}], "owner": {"reputation": 1, "user_id": 6615882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aHe6C.png?s=128&g=1", "display_name": "Nick F", "link": "https://stackoverflow.com/users/6615882/nick-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469061239, "creation_date": 1469052416, "last_edit_date": 1531161705, "question_id": 38491663, "link": "https://stackoverflow.com/questions/38491663/excel-sum-instances-of-an-item-in-a-column-until-a-different-column-variable-is", "title": "Excel Sum instances of an item in a column until a different column variable is met", "body": "<p>What I'm trying to accomplish is a little complicated to explain:</p>\n\n<p>There is a formula that inserts an integer into Columns <code>B</code> or <code>C</code> depending on the values of other columns (not shown here).</p>\n\n<p>What I want to do it place a sum of the items in column <code>B</code> where the criteria are:</p>\n\n<ol>\n<li>Items in column <code>B</code> have a value of 1</li>\n</ol>\n\n<p>and</p>\n\n<ol start=\"2\">\n<li>The range that is counted are all items between <code>Type A</code> and <code>Type A</code> (in the image below <code>B2:B13</code>)</li>\n</ol>\n\n<p>The sum should be placed in the cell in line with the instance of <code>Type A</code> being used for the range.</p>\n\n<p>So Below I want the sum of items in column <code>B</code> that are occur in rows <code>B3:B13</code> and have that number placed in <code>B2</code>.\nThen the same for <code>B15:B24</code> and the result placed in <code>B14</code>, and so on...\nThe test in column <code>A</code> that will be the trigger will remain consistent as it is auto-generated. </p>\n\n<p>Then the same would happen in column <code>C</code> (which I'm assuming I can just use the same formula just change the column references)</p>\n\n<p><a href=\"https://i.stack.imgur.com/V0DG7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V0DG7.jpg\" alt=\"Image to use as a sample\"></a></p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5569985"}, "edited": false, "score": 0, "creation_date": 1469052467, "post_id": 38491623, "comment_id": 64384791, "body": "Thanks for the explanation. However, this is giving me the error &quot;Unable to get the Mach property of the WorksheetFunction class&quot;"}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "edited": false, "score": 0, "creation_date": 1469052753, "post_id": 38491623, "comment_id": 64384895, "body": "My apologies, it should be <code>Application.WorksheetFunction.Match()</code>. It also looks like you used <code>&gt;4</code> in a <code>.Cells()</code> reference, which isn&#39;t valid. That may have just been a side effect of the formatting of the post, though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5569985"}, "edited": false, "score": 0, "creation_date": 1469052836, "post_id": 38491623, "comment_id": 64384929, "body": "It was indeed a formatting issue. Also, changing it to Application.Works... doesn&#39;t change or remove the error."}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "edited": false, "score": 0, "creation_date": 1469053296, "post_id": 38491623, "comment_id": 64385086, "body": "Is <code>.Range(&quot;MIRCellColumn&quot;)</code> contiguous? What is the value of <code>CurrentStartRow</code>?"}], "tags": [], "owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "is_accepted": true, "score": 3, "last_activity_date": 1469052592, "last_edit_date": 1469052592, "creation_date": 1469052239, "answer_id": 38491623, "question_id": 38491519, "link": "https://stackoverflow.com/questions/38491519/object-does-not-support-property-or-method-error-when-counting-rows/38491623#38491623", "title": "&#39;Object does not support property or method&#39; error when counting rows", "body": "<p>It is failing because of <code>.match</code>.\n<code>.match</code> is a workbook function, but you are using it as if it is a method of the worksheet. Instead use:</p>\n\n<pre><code>With CellsTab\n    NumOfProdCells = _\n        .Range(.Cells(Application.WorksheetFunction.Match(CurrentStartRow, _\n        .Range(\"MIRCellColumn\"), 0), 4), _\n        .Cells(Application.WorksheetFunction.Match(CurrentStartRow, _\n        .Range(\"MIRCellColumn\"), 0), 4).End(xlDown)).Rows.Count\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5569985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 38491623, "answer_count": 1, "score": 1, "last_activity_date": 1469052902, "creation_date": 1469051792, "last_edit_date": 1531164843, "question_id": 38491519, "link": "https://stackoverflow.com/questions/38491519/object-does-not-support-property-or-method-error-when-counting-rows", "title": "&#39;Object does not support property or method&#39; error when counting rows", "body": "<p>The following code produces the <code>Object does not support this property or method</code> error:</p>\n\n<pre><code>With CellsTab\n    NumOfProdCells = .Range(.Cells(.Match(CurrentStartRow,.Range(\"MIRCellColumn\"), 0), 4), \n    .Cells(.Match(CurrentStartRow,.Range(\"MIRCellColumn\"), 0), 4).End(xlDown)).Rows.Count \nEnd With\n</code></pre>\n\n<p><code>CellsTab</code> is a Worksheet, <code>NumOfProdCell</code>s is of type long, <code>CurrentStartRow</code> is also an integer, and <code>MIRCellColumn</code> is a named range in the worksheet <code>CellsTab</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469051159, "post_id": 38491374, "comment_id": 64384313, "body": "<code>.Worksheets(&quot;Price Estimator&quot;).Range(&quot;v5&quot;).Value =0</code>. <code>&quot;0&quot;</code> is a string <code>0</code> is a number."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469051229, "post_id": 38491374, "comment_id": 64384344, "body": "remove the <code>.</code> in front of <code>Worsheet(&quot;P...</code>"}, {"owner": {"reputation": 11, "user_id": 6615780, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153661443141437/picture?type=large", "display_name": "Johnny Gustafson", "link": "https://stackoverflow.com/users/6615780/johnny-gustafson"}, "edited": false, "score": 0, "creation_date": 1469051323, "post_id": 38491374, "comment_id": 64384389, "body": "The new first line is <code>If Worksheets(&quot;Price Estimator&quot;).Range(&quot;v5&quot;).Value = 0 Then</code>  Still nothing"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469051916, "post_id": 38491374, "comment_id": 64384597, "body": "if <code>Worksheets(&quot;Price Estimator&quot;).Range(&quot;v5&quot;)</code> this cell is empty ?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1469052637, "post_id": 38491374, "comment_id": 64384853, "body": "I think you need to reconsider your method here.  If you hide row 5, then you can&#39;t update <code>V5</code> to ever trigger the code again... You might want to consider using the <code>Target</code> range object which represents the cell that changed and use <code>If Target.Column = &quot;V&quot; And Target.Value = 0 Then</code> instead of what you already have?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1469052804, "post_id": 38491374, "comment_id": 64384916, "body": "@Dave: Read the first paragraph again. The value is being input on a different sheet than the one where the rows are being hidden."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1469052854, "post_id": 38491374, "comment_id": 64384937, "body": "My bad - it&#39;s late here :)"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1469052994, "post_id": 38491374, "comment_id": 64384980, "body": "Just to clarify - again, it IS late here so I might have missed something (else) but this code will be fired when a cell is changed on the worksheet the code is attached to.  If you make a change on another worksheet (to change <code>V5</code> on <code>Price Estimator</code>) it&#39;s certainly not going to fire this worksheet_change event..."}, {"owner": {"reputation": 11, "user_id": 6615780, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153661443141437/picture?type=large", "display_name": "Johnny Gustafson", "link": "https://stackoverflow.com/users/6615780/johnny-gustafson"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469053165, "post_id": 38491374, "comment_id": 64385034, "body": "@cyboashu, not its not, I could make it true or false, yes or no, or anything, I just thought typing in 0 or a number ie 1, would be simpler to code."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1469054196, "post_id": 38491374, "comment_id": 64385363, "body": "@Dave is right. You should clarify what sheet change should trigger what sheet row hiding"}], "answers": [{"tags": [], "owner": {"reputation": 265, "user_id": 6578531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431ec9c553ec5f84f5b41a1cb33c930f?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/6578531/doug"}, "is_accepted": false, "score": 1, "last_activity_date": 1469069276, "creation_date": 1469069276, "answer_id": 38494054, "question_id": 38491374, "link": "https://stackoverflow.com/questions/38491374/i-wish-to-hide-either-one-row-or-another-row-in-excel-depending-on-a-value/38494054#38494054", "title": "I wish to hide either one Row or another row in excel Depending on a value", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nApplication.EnableEvents = False\nWith Worksheets(\"Price Estimator\")\nIf .Range(\"V5\").Value = 0 Then\n    .Rows(\"5\").EntireRow.Hidden = True\nElse\n    .Rows(\"6\").EntireRow.Hidden = True\nEnd If\nend with\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6615780, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153661443141437/picture?type=large", "display_name": "Johnny Gustafson", "link": "https://stackoverflow.com/users/6615780/johnny-gustafson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469069276, "creation_date": 1469051080, "question_id": 38491374, "link": "https://stackoverflow.com/questions/38491374/i-wish-to-hide-either-one-row-or-another-row-in-excel-depending-on-a-value", "title": "I wish to hide either one Row or another row in excel Depending on a value", "body": "<p>I am currently using vba to automate a proposal, and if its overseas, there will be a different price than if it is domestic. So I created a code to automate hiding a row that has the overseas price or the domestic price, depending on if you input 0 or any other number in an input box on a different sheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf .Worksheets(\"Price Estimator\").Range(\"v5\").Value = \"0\" Then\n    Rows(\"5\").EntireRow.Hidden = True\nElse\n    Rows(\"6\").EntireRow.Hidden = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>It currently is doing nothing. Where should I go from here?</p>\n"}, {"tags": ["excel", "listbox", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1469051920, "post_id": 38491115, "comment_id": 64384598, "body": "How do you set your dynamic range? It works as expected on my end."}, {"owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1469110087, "post_id": 38491115, "comment_id": 64411269, "body": "hmmm... =OFFSET(&#39;Property Data&#39;!$A$5,2,,COUNTA(&#39;Property Data&#39;!$A$5:$N$5),14)"}, {"owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1469110116, "post_id": 38491115, "comment_id": 64411293, "body": "I now notice that that is picking up more than just used cells."}, {"owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1469110535, "post_id": 38491115, "comment_id": 64411602, "body": "I have found the issue. The correct dynamic named range should be : =OFFSET(&#39;Property Data&#39;!$A$5,2,,COUNTA(&#39;Property Data&#39;!$A$5),14)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1469060379, "creation_date": 1469060379, "answer_id": 38492857, "question_id": 38491115, "link": "https://stackoverflow.com/questions/38491115/empty-listbox-values/38492857#38492857", "title": "Empty ListBox Values", "body": "<p>An easier why to do this would be to create an array from your range and assign the array to the <code>Listbox.List</code> property.  This will allow you to use <code>SpecialCells</code> to filter the data.  </p>\n\n<pre><code>Private Sub Userform_Initialize()\n\n    Me.lstProperties.List = getArrayFromRange(Range(\"FilterData\").SpecialCells(xlCellTypeVisible))\n\n    Me.lstStmts.List = getArrayFromRange(Range(\"ListofProps\").SpecialCells(xlCellTypeConstants))\n\n    Me.lstLoans.RowSource = getArrayFromRange(Range(\"FilterLoans\").SpecialCells(xlCellTypeConstants))\n\nEnd Sub\n\nFunction getArrayFromRange(rng As Range)\n    Dim arr\n    Dim a As Range\n    Dim count As Long, x As Long, y As Integer\n\n    ReDim arr(1 To rng.CountLarge, 1 To rng.Columns.count)\n\n    For Each a In rng.Areas\n\n        For x = 1 To a.Rows.count\n\n            count = count + 1\n\n            For y = 1 To rng.Columns.count\n                arr(count, y) = a.Cells(x, y).Value\n            Next\n\n        Next\n    Next\n\n    getArrayFromRange = arr\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "is_accepted": false, "score": 0, "last_activity_date": 1469110749, "creation_date": 1469110749, "answer_id": 38506770, "question_id": 38491115, "link": "https://stackoverflow.com/questions/38491115/empty-listbox-values/38506770#38506770", "title": "Empty ListBox Values", "body": "<p>The issue was that my dynamic named range was not properly set up. The formula for the named range should have been: </p>\n\n<pre><code>=OFFSET('Property Data'!$A$5,2,,COUNTA('Property Data'!$A$5),14)\n</code></pre>\n\n<p>and not:</p>\n\n<pre><code>=OFFSET('Property Data'!$A$5,2,,COUNTA('Property Data'!$A$5:N$5),14).\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469110749, "creation_date": 1469049891, "last_edit_date": 1531161705, "question_id": 38491115, "link": "https://stackoverflow.com/questions/38491115/empty-listbox-values", "title": "Empty ListBox Values", "body": "<p>I have 3 Listboxes. In the properties I have selected the ListStyle as fmListStyleOption and the MultiSelect as fmMultiSelectMulti. Here is the current code:</p>\n\n<pre><code>Private Sub Userform_Initialize()\n\nMe.lstProperties.RowSource = \"FilterData\"\n\nMe.lstStmts.RowSource = \"ListofProps\"\n\nMe.lstLoans.RowSource = \"FilterLoans\"\n\nEnd Sub\n</code></pre>\n\n<p>I am using dynamic named ranges in hope that it will only show data in the Listbox for cells that actually have values. Unfortunately it shows a long list of blank lines with checkboxes anyways. </p>\n\n<p>Does anyone know how to make sure that the Listbox only shows data with values i.e. if there are 2 cells in my named range with data then there are only two checkboxes in my listbox.</p>\n\n<p><a href=\"http://i.stack.imgur.com/POyaQ.jpg\" rel=\"nofollow\">Visual</a></p>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469049717, "post_id": 38490673, "comment_id": 64383693, "body": "Function/method pointers aren&#39;t really a thing in VBA.  You could try passing it as two separate parameters: the object itself and the method name as a string, then using <code>CallByName</code> on the callee side (assuming you want to invoke the method there)."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1469049935, "post_id": 38490673, "comment_id": 64383784, "body": "Please show the entire code, where you are trying to pass it to another function. What is the <code>obj</code> variable?"}, {"owner": {"reputation": 127, "user_id": 2723377, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MbGwj.png?s=128&g=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/2723377/hao-zhang"}, "edited": false, "score": 0, "creation_date": 1469051383, "post_id": 38490673, "comment_id": 64384415, "body": "Please see the edit."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "is_accepted": false, "score": 0, "last_activity_date": 1469054293, "creation_date": 1469054293, "answer_id": 38492023, "question_id": 38490673, "link": "https://stackoverflow.com/questions/38490673/how-can-i-pass-a-callable-object-to-another-function-subroutine-without-calling/38492023#38492023", "title": "How can I pass a callable object to another function/subroutine without calling/invoking it?", "body": "<p>To answer your question is you pass the name of the object.</p>\n\n<p>Objects are CODE. There is an object factory that makes your object.</p>\n\n<p>The data structures for an object is 4x32 bit integers (Longs in VB talk). One is the reference count (and if 0 the object terminates), one is the address of the VTable (the address of each property get/set and method calls), two are reserved and are unused and always will be.</p>\n\n<p>Due to the magic of COM your object appears as a data structure and a loaded function library in your program (even if it's an executable rather than a dll).</p>\n\n<p>To pass objects that don't yet exist pass the name. JScript/VBScript can write code at runtime. In VBScript see <code>execute</code>, <code>executeglobal</code>, and <code>eval</code>. All take a string of VBScript code that becomes part of your program in various ways.</p>\n"}], "owner": {"reputation": 127, "user_id": 2723377, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MbGwj.png?s=128&g=1", "display_name": "Hao Zhang", "link": "https://stackoverflow.com/users/2723377/hao-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1469054293, "creation_date": 1469048071, "last_edit_date": 1469051372, "question_id": 38490673, "link": "https://stackoverflow.com/questions/38490673/how-can-i-pass-a-callable-object-to-another-function-subroutine-without-calling", "title": "How can I pass a callable object to another function/subroutine without calling/invoking it?", "body": "<p>I'm using VBA 7.1 in MS Office 2013. I'm trying to interact with a function in JavaScript (or an interface of it created using as close as possible in shortened code <code>CreateObject(\"HtmlFile\").ParentWindow.close</code> - similar to <code>window.close</code> in JavaScript). The problem is, I'm trying to pass it to another function, but it keeps calling the actual <code>window.close</code> function in JavaScript <em>as I pass it</em>. This is where it gets weird: it doesn't get invoked in a few specific built-in functions.</p>\n\n<pre><code>CStr(obj) ' Invokes the interface; window close dialog appears\nVarType(obj) ' Invokes the interface; window close dialog appears\nIsEmpty(obj) ' Invokes the interface; window close dialog appears\nTypeName(obj) ' Doesn't invoke the interface; returns \"Object\"\nIsObject(obj) ' Doesn't invoke the interface; returns True\n</code></pre>\n\n<p>Is there a way to pass it around <em>without</em> invoking it?</p>\n\n<p><strong>EDIT:</strong> You can replicate the setup using this:</p>\n\n<pre><code>With CreateObject(\"HtmlFile\")\n    .ParentWindow.ExecScript \"obj = window.close\"\n    Set obj = .ParentWindow.obj\nEnd With\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1469049424, "post_id": 38490524, "comment_id": 64383567, "body": "that is because you only get the first order, you need to loop through the returned record set and get each order number."}], "answers": [{"comments": [{"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1469073578, "post_id": 38494547, "comment_id": 64389893, "body": "Excel VBA code has almost no security at all so SQL injection attacks can&#39;t be avoided, VBA even password protected can be easily accessed/hacked. So one shouldn&#39;t use it if there are concerns about security."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 2, "creation_date": 1469073870, "post_id": 38494547, "comment_id": 64389962, "body": "On the contrary, it doesn&#39;t matter whether the code is VBA or whether the VBA project is locked, if you&#39;re executing custom-built SQL against a database, but you allow a user to enter a malicious SQL-snippet in a cell or InputBox, and that snippet ends up being inserted into a SQL string, then you have major issues."}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1469074073, "post_id": 38494547, "comment_id": 64390021, "body": "I know, but in excel VBA it is almost impossible to avoid a malicious user to hack SQL string as (s)he can easily modify the code. The only solution to that is to login into database with limited permissions. Then you don&#39;t need to care about SQL injection either, because injecting will just return an error."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1469074196, "post_id": 38494547, "comment_id": 64390053, "body": "Or force client-access to use Stored Procedures"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 1, "creation_date": 1469074619, "post_id": 38494547, "comment_id": 64390173, "body": "@caiohamamura in Excel VBA you would be using the ADODB API/library, which completely supports parameterized queries, as does DAO which Access uses. Also with Windows Authentication to the database server there&#39;s no need to store credentials anywhere, be it in code or in some connection file. Bad code is on the programmer, not the language."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1469075037, "post_id": 38494547, "comment_id": 64390266, "body": "That said if you&#39;re worried about users (...colleagues??) modifying the code to malicious intent, you have worse problems than SQL injection."}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 1, "creation_date": 1469075428, "post_id": 38494547, "comment_id": 64390388, "body": "That&#39;s my point. The problem of SQL injection is for user to input something like <code>1 GO DROP TABLE AnyTable GO</code>. If you trust the users which will have access to the workbook you probably should not care about them inserting such things in the filter cell or input box."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 1, "last_activity_date": 1469072940, "creation_date": 1469072940, "answer_id": 38494547, "question_id": 38490524, "link": "https://stackoverflow.com/questions/38490524/ms-access-vba-query-where/38494547#38494547", "title": "MS Access vba query where", "body": "<p>You can just execute a single query for all orders:</p>\n\n<pre><code>x = CustomerNum\nQuery = \"  SELECT CustomerOrderT.CustomerNum, \" &amp; _\n                  CustomerOrderT.OrderNum, \" &amp; _\n        \"         OrderProducts.Product \" &amp; _\n        \"    FROM CustomerOrderT INNER JOIN OrderProducts \" &amp; _\n               ON CustomerOrderT.OrderNum = OrderProducts.OrderNum \" &amp; _\n        \"   WHERE (((CustomerOrderT.CustomerNum)=\" &amp; x &amp; \")) \" &amp; _\n        \"ORDER BY CustomerOrderT.OrderNum, \" &amp; _\n        \"         OrderProducts.Product;\"\n</code></pre>\n\n<p>And then loop over all the records, noting each change in <code>OrderNum</code></p>\n\n<p>But beware of building SQL like this if you don't control how variable <code>CustomerNum</code> is assigned, as you open yourself to SQL injection attacks. </p>\n"}], "owner": {"reputation": 25, "user_id": 6438911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c425c55d03a89095f3ee895abfaae111?s=128&d=identicon&r=PG&f=1", "display_name": "idanVaza", "link": "https://stackoverflow.com/users/6438911/idanvaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 38494547, "answer_count": 1, "score": 1, "last_activity_date": 1469072940, "creation_date": 1469047562, "question_id": 38490524, "link": "https://stackoverflow.com/questions/38490524/ms-access-vba-query-where", "title": "MS Access vba query where", "body": "<p>Simple Question.\nFor example, i have a Customer that have 10 Orders and each order include 6-10 Items.</p>\n\n<p>i want to create a vba query that will desplay all the items of a specific customer.</p>\n\n<p>My query is:</p>\n\n<pre><code>x = CustomerNum\nQuery = \"Select OrderNum from CustomerOrderT Where CustomerNum = \" &amp; x\nSet result = CurrentDb.OpenRecordset(Query)\n\ny = result!OrderNum\n'(there is a lot of orders on y)\n\nQuery = \"Select Product From OrderProducts Where OrderNum = \" &amp; y\nSet result = CurrentDb.OpenRecordset(Query)\n</code></pre>\n\n<p>The problem is that i only see the Products of the first order and i cannot see the products of all the orders that i select on the first query.\nNeed some help to handke this situation.\n<strong>Thank you very much.</strong></p>\n"}, {"tags": ["excel", "str-replace", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469047556, "post_id": 38489851, "comment_id": 64382702, "body": "Why aren&#39;t you replacing &quot;Griffith RV8&quot; with &quot;RV-8&quot; ?  This doesn&#39;t seem like a simple replace - there is some other rule you need to apply?"}, {"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469049295, "post_id": 38489851, "comment_id": 64383510, "body": "Because RV8 will show up with dozens of different words in front of it and all I need from that string is RV-8 and whatever is after"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1469047374, "creation_date": 1469047374, "answer_id": 38490487, "question_id": 38489851, "link": "https://stackoverflow.com/questions/38489851/vba-excel-replacing-string-based-on-table-values/38490487#38490487", "title": "Vba excel replacing string based on table values", "body": "<p>You can use wildcards to replace parts of a string.</p>\n\n<pre><code>Sub Example()\n\n    Range(\"A1\") = \"Where in the World is Carmen Sandiego?\"\n\n    Range(\"A1\").Replace \"*Carmen\", \"Who is Micheal\"\n\n    Range(\"A3\") = \"Hello World! How are You?\"\n\n    Range(\"A3\").Replace \"!*\", \"? Can you hear me!?\"\n\n    Range(\"A5\") = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\n    Range(\"A5\").Replace \"??H??\", \"fgHij\"\n\n    ' You can escape the wildcards using \"\\\"\n    Range(\"A7\") = \"? not escaped\"\n\n    Range(\"A8\") = \"WHO? WHO!\"\n\n    Range(\"A8\").Replace \"WHO?\", \"WHO ARE YOU?\"\n\n    Range(\"A10\") = \"? was escaped using a backslash \\?\"\n\n    Range(\"A11\") = \"WHO? WHO!\"\n\n    Range(\"A11\").Replace \"WHO\\?\", \"WHO ARE YOU?\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1469049515, "creation_date": 1469049515, "answer_id": 38491020, "question_id": 38489851, "link": "https://stackoverflow.com/questions/38489851/vba-excel-replacing-string-based-on-table-values/38491020#38491020", "title": "Vba excel replacing string based on table values", "body": "<pre><code>rngData.Replace What:= \"* \" &amp; Lookup.Value, _\n                Replacement:=Lookup.Offset(0, 1).Value, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    MatchCase:=False\n</code></pre>\n\n<p>will replace <code>[some text here][space]Lookup.Value</code> with <code>Lookup.Offset(0, 1).Value</code></p>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 38490487, "answer_count": 2, "score": 1, "last_activity_date": 1469049515, "creation_date": 1469045050, "last_edit_date": 1531164843, "question_id": 38489851, "link": "https://stackoverflow.com/questions/38489851/vba-excel-replacing-string-based-on-table-values", "title": "Vba excel replacing string based on table values", "body": "<p>I have code which replaces part of string in column A in sheet \"Data\" with new value written in Column B of sheet \"Filter\".</p>\n\n<p>Column A of sheet \"Filter\" has old values, and Column B has values after replacement, see picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SbjJi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SbjJi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I know how to replace for example \"Griffith RV8\" into \"Griffith RV-8\" but how can I do that replacement plus remove all characters in front of that replaced string?</p>\n\n<p>Griffith RV8 = RV-8</p>\n\n<pre><code>Sub Substitutions()\n\nDim rngData     As Range\nDim rngLookup   As Range\nDim Lookup      As Range\n\nWith Sheets(\"Data\")\n    Set rngData = .Range(\"A1\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\nEnd With\n\nWith Sheets(\"Filter\")\n    Set rngLookup = .Range(\"A1\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\nEnd With\n\nFor Each Lookup In rngLookup\n    If Lookup.Value &lt;&gt; \"\" Then\n        rngData.Replace What:=Lookup.Value, _\n                        Replacement:=Lookup.Offset(0, 1).Value, _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False\n    End If\nNext Lookup\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "edited": false, "score": 0, "creation_date": 1469045315, "post_id": 38489834, "comment_id": 64381491, "body": "You can try to loop trough your Sheet Array <code>Sheets(Array(0))... And Sheets(Array(1))</code> If you have more than two Sheets use a Loop, like <code>For i = 0 To NumberOfWorksheets</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469046077, "post_id": 38489834, "comment_id": 64381911, "body": "This is a <i>perfect</i> example of why you should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a>. I <b><i>highly</i></b> recommend reading through that, and applying it to your macro.  If after that, you are stuck/getting errors, let me know."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1469046356, "creation_date": 1469046356, "answer_id": 38490226, "question_id": 38489834, "link": "https://stackoverflow.com/questions/38489834/excel-vba-add-new-columns-with-text-and-formatting-to-multiple-worksheets/38490226#38490226", "title": "Excel VBA - Add new columns with text and formatting to multiple worksheets", "body": "<p>Just loop through <code>Array(\"Sheet1\", \"Sheet2\")</code>.  Adding the <code>Type:=2</code> parameter to the InputBox will ensure that <code>myValue</code> will always be a string.  If the user cancels the InputBox then <code>myValue = \"\"</code>.</p>\n\n<pre><code>Sub CommandButton2_Click()\n    Dim ws\n    Dim myValue As Variant\n\n    myValue = Application.InputBox(Prompt:=\"Enter Thought Leadership Title\", Title:=\"New Thought    Leadership\", Default:=\"XXXXX\", Type:=2)\n\n    If myValue &lt;&gt; \"\" Then\n        For Each ws In Array(\"Sheet1\", \"Sheet2\")\n            With ws\n                .Columns(\"F:F\").Insert Shift:=xlToRight\n                .Range(\"F5\").Value = myValue\n            End With\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469047643, "post_id": 38490270, "comment_id": 64382744, "body": "(a) I think the OP wants the same headings on every sheet, so you should move the setting of myValue outside the loop.  (b) Until we have quantum computing where a Sheet name can be both &quot;Sheet1&quot; and &quot;Sheet2&quot; at the same time, <b>every</b> worksheet name will fail one of the two tests in your suggested If statement.  I think it needs to be <code>If worksheet.name = &quot;Sheet1&quot; or worksheet.name = &quot;Sheet2&quot;</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469048978, "post_id": 38490270, "comment_id": 64383364, "body": "@YowE3K - Good points! Thanks for those, I&#39;ll edit in. (I fixed that off the top of my head, and can&#39;t ever recall the best way to do the <code>if sheet name is ...</code>, so thanks!)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469050911, "post_id": 38490270, "comment_id": 64384225, "body": "You have moved the wrong thing out of the loop.  You moved the setting of the heading out, but it should be done in the loop, and you left the InputBox in the loop, but it should only be done once.  I&#39;ll edit your answer."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1469049075, "last_edit_date": 1469049075, "creation_date": 1469046538, "answer_id": 38490270, "question_id": 38489834, "link": "https://stackoverflow.com/questions/38489834/excel-vba-add-new-columns-with-text-and-formatting-to-multiple-worksheets/38490270#38490270", "title": "Excel VBA - Add new columns with text and formatting to multiple worksheets", "body": "<p>An alternative to @ThomasInzina is this:</p>\n\n<pre><code>Sub commandButton2_Click_Test()\nDim myValue As Variant\n\nFor Each Worksheet In ActiveWorkbook.Worksheets\n    With Worksheet\n        .Range(\"F:F\").EntireColumn.Insert shift:=xlToRight, copyOrigin:=xlFormatFromRightOrBelow\n        myValue = InputBox(\"Enter Thought Leadership Title\", \"New Thought    Leadership\", \"XXXXX\")\n\n    End With\nNext Worksheet\nWorksheets(\"Sheet1\").Range(\"F5\").Value = myValue ' I'm not sure where you wanted this,\nWorksheets(\"Sheet2\").Range(\"F5\").Value = myvalue ' or what it does, so tweak as necessary.\nEnd Sub\n</code></pre>\n\n<p>I tried to keep it as similar to your code as possible, while avoiding <code>.Select</code> (as mentioned in my comment below OP).</p>\n\n<p>Note: This will loop through <em>all</em> worksheets in your workbook.  You can add a line <code>If worksheet.name = \"Sheet1\" or worksheet.name = \"Sheet2\"</code> to only run it on those.</p>\n"}], "owner": {"reputation": 11, "user_id": 6615499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e7ab3971e6af6b4e4520de1e776b99?s=128&d=identicon&r=PG&f=1", "display_name": "tjohnson4", "link": "https://stackoverflow.com/users/6615499/tjohnson4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2128, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1469049075, "creation_date": 1469044967, "last_edit_date": 1469048948, "question_id": 38489834, "link": "https://stackoverflow.com/questions/38489834/excel-vba-add-new-columns-with-text-and-formatting-to-multiple-worksheets", "title": "Excel VBA - Add new columns with text and formatting to multiple worksheets", "body": "<p>I am working on an Excel macro (button) that will add a column into the same spot in multiple worksheets.  Also, this column must have a column header that is input through a dialog box.  </p>\n\n<p>Each worksheet contains a table formatted the exact same way - the only difference is the worksheet names.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub CommandButton2_Click()\n\nSheets(Array(\"Sheet1\", \"Sheet2\")).Select\nSheets(\"Sheet2\").Activate\nColumns(\"F:F\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromRightOrBelow\n\nDim myValue As Variant\n\nmyValue = InputBox(\"Enter Thought Leadership Title\", \"New Thought    Leadership\", \"XXXXX\")\n\nSheets(Array(\"Sheet1\", \"Sheet2\u201d)).Select\nRange(\"F5\").Value = myValue\n\nEnd Sub\n</code></pre>\n\n<p>This has gotten me exactly what I want for 'Sheet1' - adds a column (F) and inputs a header name specified through the dialog box into cell F5 while copying the formatting from the column immediately to the right.  However, all it does for Sheet2 (and all others, but removed them for brevity) is add in a column without copying formatting from the right or adding the text specified through the dialog box.</p>\n\n<p>Beginner VBA \"programmer\" and have gotten this far through using the forums here.  </p>\n\n<p>Hopefully I was clear - thanks for any input.</p>\n"}, {"tags": ["vba", "ms-word", "find-replace", "msstyles"], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 773328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3da9ef8ab3ac39afde0a56e8a662b393?s=128&d=identicon&r=PG", "display_name": "user773328", "link": "https://stackoverflow.com/users/773328/user773328"}, "edited": false, "score": 0, "creation_date": 1469118936, "post_id": 38490926, "comment_id": 64417260, "body": "Thanks! That&#39;s a big help."}], "tags": [], "owner": {"reputation": 2324, "user_id": 1036274, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/p07PE.jpg?s=128&g=1", "display_name": "nunzabar", "link": "https://stackoverflow.com/users/1036274/nunzabar"}, "is_accepted": true, "score": 1, "last_activity_date": 1469049144, "creation_date": 1469049144, "answer_id": 38490926, "question_id": 38489751, "link": "https://stackoverflow.com/questions/38489751/microsoft-word-vba-macro-one-paragraph-find-replace-styles/38490926#38490926", "title": "Microsoft Word VBA Macro - One Paragraph Find-Replace Styles", "body": "<p>I don't understand why <code>ActiveDocument.Content</code> is not working, but replacing it with <code>ActiveDocument.Range(0,0)</code> appears to resolve the issue (tested in Word 2016).</p>\n\n<p><code>With ActiveDocument.Range(0, 0).Find</code></p>\n"}], "owner": {"reputation": 295, "user_id": 773328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3da9ef8ab3ac39afde0a56e8a662b393?s=128&d=identicon&r=PG", "display_name": "user773328", "link": "https://stackoverflow.com/users/773328/user773328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "accepted_answer_id": 38490926, "answer_count": 1, "score": 1, "last_activity_date": 1469049144, "creation_date": 1469044701, "question_id": 38489751, "link": "https://stackoverflow.com/questions/38489751/microsoft-word-vba-macro-one-paragraph-find-replace-styles", "title": "Microsoft Word VBA Macro - One Paragraph Find-Replace Styles", "body": "<p>I am executing a style search in Microsoft Word using a VBA Macro.\nMy goal is to perform certain actions once for every style found in the document.</p>\n\n<p>The macro works correctly on documents that have at least two paragraphs, but the macro does not alert the style correctly in a document that has exactly one paragraph in it. It seems strange that when I enter a new paragraph mark, the styles are found, even though I did not add any new text or styles to the document, just an extra blank paragraph mark. Does anyone know what is wrong with my macro and how I can fix this? Thanks for taking a look.</p>\n\n<pre><code>Sub AlertAllStylesInDoc()\n    Dim Ind As Integer\n    Dim numberOfDocumentStyles As Integer\n    Dim styl As String\n    Dim StyleFound As Boolean\n\n    numberOfDocumentStyles = ActiveDocument.styles.count\n\n    For Ind = 1 To numberOfDocumentStyles\n        styl = ActiveDocument.styles(Ind).NameLocal\n        With ActiveDocument.Content.Find\n            .ClearFormatting\n            .text = \"\"\n            .Forward = True\n            .Format = True\n            .Style = styl\n            Do\n                StyleFound = .Execute\n                If StyleFound = True Then\n                    ' actual code does more than alert, but keeping it simple here'\n                    MsgBox styl\n                    GoTo NextStyle\n                Else\n                    Exit Do\n                End If\n            Loop\n        End With\n\n    NextStyle:\n        Next\n\nEnd Sub   \n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access-2007", "pass-through"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469044541, "post_id": 38489604, "comment_id": 64381091, "body": "Are you sure it&#39;s the execution of the query that is long and not just loading it into the form?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469044634, "post_id": 38489604, "comment_id": 64381149, "body": "If I understand your setup, Access is just a frontend to SQLServer. Which means that all the data is in sqlserver and not in access."}, {"owner": {"reputation": 584, "user_id": 5203406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c774ad90796d818ccf1f05947c317929?s=128&d=identicon&r=PG&f=1", "display_name": "Fritz", "link": "https://stackoverflow.com/users/5203406/fritz"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469044655, "post_id": 38489604, "comment_id": 64381160, "body": "Running just as a normal pass through query takes a similar amount of time, and you are correct about the front-end / back-end relationship."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469044794, "post_id": 38489604, "comment_id": 64381220, "body": "So it is loading into the form that takes a while. What order of magnitude is the result of the query? ten&#39;s hundred&#39;s thousand&#39;s or even more maybe?"}, {"owner": {"reputation": 584, "user_id": 5203406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c774ad90796d818ccf1f05947c317929?s=128&d=identicon&r=PG&f=1", "display_name": "Fritz", "link": "https://stackoverflow.com/users/5203406/fritz"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469044987, "post_id": 38489604, "comment_id": 64381308, "body": "No, the form takes almost no time to load. The query alone and the form (which loads the query on opening) both take a similar amount of time. The number of records returned is somewhere between 1 and 400 records. Many of the <code>SELECT</code> options are aggregate functions."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469046055, "post_id": 38489604, "comment_id": 64381892, "body": "This might be interresting for you <a href=\"https://support.microsoft.com/en-us/kb/286222\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/286222</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1469050763, "post_id": 38489604, "comment_id": 64384161, "body": "It&#39;s still unclear. The Pass-Through query when opened in Access takes the same time as in SSMS? Or is that already slow? Or is it only the form with that Pass-Through query as recordsource that is slow? -- If you say <i>&quot;a similar amount of time&quot;</i> you should specify <i>similar to what</i>... :)"}, {"owner": {"reputation": 584, "user_id": 5203406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c774ad90796d818ccf1f05947c317929?s=128&d=identicon&r=PG&f=1", "display_name": "Fritz", "link": "https://stackoverflow.com/users/5203406/fritz"}, "edited": false, "score": 0, "creation_date": 1469104532, "post_id": 38489604, "comment_id": 64407326, "body": "Running the pass-through query in Access and opening the form that contains the query result both take the same amount of time. If I disable the query result on the form, the form opens instantly. I have clarified the original post and apologize for the lack of clarity."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1469105517, "post_id": 38489604, "comment_id": 64408007, "body": "Very strange, there should not be a noticeable difference, since the Pass-Through query is executed on the server. If you take the generated SQL, and create a view on the server with this SQL, and change your Pass-Through query to simply <code>SELECT * FROM GeneratedView</code>, is that still slow? If no, it might be a workaround to always generate this view on the fly."}], "owner": {"reputation": 584, "user_id": 5203406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c774ad90796d818ccf1f05947c317929?s=128&d=identicon&r=PG&f=1", "display_name": "Fritz", "link": "https://stackoverflow.com/users/5203406/fritz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1480590732, "creation_date": 1469044159, "last_edit_date": 1469104422, "question_id": 38489604, "link": "https://stackoverflow.com/questions/38489604/minimizing-performance-lost-in-access-based-pass-through-query-that-is-notably-s", "title": "Minimizing performance lost in Access based pass through query that is notably slower than SSMS", "body": "<p>I have a front end application which allows others to create elaborate SQL queries based on options selected. This SQL code is then used as a pass through query, and is displayed as part of a form. </p>\n\n<p>The pass through queries created are exceptionally slow however. When ran in Access, they range from 3 minutes to 20 minutes. SQL Server Management Studio 2012 manages to complete identical queries in 45 seconds to 3 minutes. <strong>How can this time difference be minimized or eliminated?</strong></p>\n\n<p>tldr:</p>\n\n<ul>\n<li><p>Time to run query in SSMS: 45 seconds</p></li>\n<li><p>Time to run query in Access: 3 minutes</p></li>\n<li><p>Time to open Access form containing query: 3 minutes</p></li>\n</ul>\n\n<h2>Structure behind the question</h2>\n\n<p>The queries are structured in the following manner</p>\n\n<pre><code>SELECT ...\nFROM\n    (\n    SELECT ...\n    FROM\n        (\n        SELECT ... FROM Archive.YearXX\n        UNION\n        SELECT ... FROM Archive.YearXX\n        UNION\n        SELECT ... FROM Current.Year16\n        )\n        LEFT JOIN ReferenceData.Table ON...\n    )\nWHERE ...\nGROUP BY ...\nORDER BY ...\n</code></pre>\n\n<p>where the various options are able to change almost anything in the code, from which tables are pulled in the <code>UNION</code> segment, which fields are returned in the <code>SELECT</code> statement, what is included in the <code>WHERE</code>, <code>GROUP BY</code>, and <code>ORDER BY</code> clauses.</p>\n\n<p>All SQL Servers are in the same local location, and the tables referenced range from 20 fields by 100,000 rows to 30 fields by 13,000,000 rows</p>\n\n<p>Current connection string (actual data redacted):</p>\n\n<p><code>ODBC;Driver=SQL Server;Server=[server name];DATABASE=[database];UID=[username];PWD=[password];</code></p>\n\n<p>VBA code which creates QueryDef:</p>\n\n<pre><code>Set qdf = CurrentDb.CreateQueryDef(\"GeneratedReportData\", GenSQL(False))\n    qdf.Connect = \"ODBC;Driver=SQL Server;Server=[server name];DATABASE=[database];UID=[username];PWD=[password];\"\n    qdf.ReturnsRecords = True\n    qdf.ODBCTimeout = 0\n</code></pre>\n\n<h2>Constraints</h2>\n\n<ul>\n<li><p>I am unable to change the languages or software I am using.</p></li>\n<li><p>There is little that can be done about the structure and use of subqueries.</p></li>\n</ul>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 2, "creation_date": 1469043199, "post_id": 38489229, "comment_id": 64380309, "body": "You should search for &quot;how to loop through closed workbooks and change formatting&quot; or something similar (I&#39;m just guessing at that search query). Then try that and if you have issues, ask us to help with the issues. This isn&#39;t a coding service so much as a teaching and troubleshooting one. :-)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 1, "creation_date": 1469043584, "post_id": 38489229, "comment_id": 64380516, "body": "@Rodger&#39;s on it - simply, look how to loop through all sheets in a workbook (it&#39;s pretty much three lines), and also <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code>/<code>.Activate</code></a> (specifically, look for the answer showing how to set a Worksheet variable).  Thankfully, you don&#39;t have to tweak your code too much, AFAICT."}, {"owner": {"reputation": 7455, "user_id": 5432501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MGE3.png?s=128&g=1", "display_name": "Alex Knauth", "link": "https://stackoverflow.com/users/5432501/alex-knauth"}, "edited": false, "score": 0, "creation_date": 1469145715, "post_id": 38489229, "comment_id": 64429007, "body": "Please don&#39;t use the [macros] tag for Excel/VBA questions. The tag info for it says, <code>*Not for MS-OFFICE &#47; VBA &#47; macro languages. Use the respective tags instead.*</code>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6484789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4413dc3411139bd1c2b114834698b643?s=128&d=identicon&r=PG&f=1", "display_name": "Karan", "link": "https://stackoverflow.com/users/6484789/karan"}, "edited": false, "score": 0, "creation_date": 1469106560, "post_id": 38489860, "comment_id": 64408714, "body": "where should I enter the path of my folder in the above code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 75, "user_id": 6484789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4413dc3411139bd1c2b114834698b643?s=128&d=identicon&r=PG&f=1", "display_name": "Karan", "link": "https://stackoverflow.com/users/6484789/karan"}, "edited": false, "score": 0, "creation_date": 1469131799, "post_id": 38489860, "comment_id": 64424002, "body": "I updated my answer to make it clear as to where to put your folder path."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1469131734, "last_edit_date": 1469131734, "creation_date": 1469045084, "answer_id": 38489860, "question_id": 38489229, "link": "https://stackoverflow.com/questions/38489229/loop-through-files-in-a-folder/38489860#38489860", "title": "Loop through files in a folder", "body": "<pre><code>Sub ProcessFiles()\n    Dim FolderPath As String\n    FolderPath = \"Your Folder Path Goes Here\"\n    ToggleEvents False\n\n    Dim FileName As String, xlFilename As String\n    Dim xlWB As Excel.Workbook, xlWS As Excel.Worksheet\n\n    If Not Right(FolderPath, 1) Then FolderPath = FolderPath &amp; \"\\\"\n\n    FileName = Dir(FolderPath, vbDirectory)\n\n    Do While FileName &lt;&gt; \"\"\n        xlFilename = FolderPath &amp; FileName\n        Set xlWB = Workbooks.Open(xlFilename)\n        For Each xlWS In xlWB.Worksheets\n            ModifyPageSetup xlWS\n        Next\n\n        xlWB.Close True\n\n    Loop\n\n    Application.PrintCommunication = True\n    ToggleEvents True\nEnd Sub\n\nSub ToggleEvents(EnableEvents As Boolean)\n\n    With Application\n        .EnableEvents = EnableEvents\n        .Calculation = IIf(EnableEvents, xlCalculationAutomatic, xlCalculationManual)\n        .ScreenUpdating = EnableEvents\n    End With\n\nEnd Sub\n\nSub ModifyPageSetup(xlWS As Excel.Worksheet)\n\n    With xlWS.PageSetup\n        .PrintTitleRows = \"\"\n        .PrintTitleColumns = \"\"\n        Application.PrintCommunication = True\n        .PageSetup.PrintArea = \"\"\n        Application.PrintCommunication = False\n    End With\n\n\n    With xlWS.PageSetup\n        .LeftHeader = \"\"\n        .CenterHeader = \"\"\n        .RightHeader = \"\"\n        .LeftMargin = Application.InchesToPoints(0.08)\n        .RightMargin = Application.InchesToPoints(0.08)\n        .TopMargin = Application.InchesToPoints(1)\n        .BottomMargin = Application.InchesToPoints(1)\n        .HeaderMargin = Application.InchesToPoints(0.5)\n        .FooterMargin = Application.InchesToPoints(0.5)\n        .PrintHeadings = False\n        .PrintGridlines = False\n        .PrintComments = xlPrintNoComments\n        .CenterHorizontally = False\n        .CenterVertically = False\n        .Orientation = xlLandscape\n        .Draft = False\n        .PaperSize = xlPaperLetter\n        .FirstPageNumber = xlAutomatic\n        .Order = xlDownThenOver\n        .BlackAndWhite = False\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n        .PrintErrors = xlPrintErrorsDisplayed\n        .OddAndEvenPagesHeaderFooter = False\n        .DifferentFirstPageHeaderFooter = False\n        .ScaleWithDocHeaderFooter = True\n        .AlignMarginsHeaderFooter = True\n        .FirstPage.RightHeader.Text = \"\"\n        .FirstPage.LeftFooter.Text = \"\"\n        .FirstPage.CenterFooter.Text = \"\"\n        .FirstPage.RightFooter.Text = \"\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6484789, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4413dc3411139bd1c2b114834698b643?s=128&d=identicon&r=PG&f=1", "display_name": "Karan", "link": "https://stackoverflow.com/users/6484789/karan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1630, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1617553960, "creation_date": 1469042839, "last_edit_date": 1617553960, "question_id": 38489229, "link": "https://stackoverflow.com/questions/38489229/loop-through-files-in-a-folder", "title": "Loop through files in a folder", "body": "<p>I want to format each Excel file containing different worksheets in my current folder.</p>\n<p>This code will set the page setup for each worksheet in each file to a scale of 1 page wide by 1 page tall, set page orientation to landscape and then save it.</p>\n<p>I recorded the code for the first worksheet of the first excel file:</p>\n<pre><code>Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n        .PrintTitleRows = &quot;&quot;\n        .PrintTitleColumns = &quot;&quot;\n    End With\n    Application.PrintCommunication = True\n    ActiveSheet.PageSetup.PrintArea = &quot;&quot;\n    Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n        .LeftHeader = &quot;&quot;\n        .CenterHeader = &quot;&quot;\n        .RightHeader = &quot;&quot;\n        .LeftMargin = Application.InchesToPoints(0.08)\n        .RightMargin = Application.InchesToPoints(0.08)\n        .TopMargin = Application.InchesToPoints(1)\n        .BottomMargin = Application.InchesToPoints(1)\n        .HeaderMargin = Application.InchesToPoints(0.5)\n        .FooterMargin = Application.InchesToPoints(0.5)\n        .PrintHeadings = False\n        .PrintGridlines = False\n        .PrintComments = xlPrintNoComments\n        .CenterHorizontally = False\n        .CenterVertically = False\n        .Orientation = xlLandscape\n        .Draft = False\n        .PaperSize = xlPaperLetter\n        .FirstPageNumber = xlAutomatic\n        .Order = xlDownThenOver\n        .BlackAndWhite = False\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n        .PrintErrors = xlPrintErrorsDisplayed\n        .OddAndEvenPagesHeaderFooter = False\n        .DifferentFirstPageHeaderFooter = False\n        .ScaleWithDocHeaderFooter = True\n        .AlignMarginsHeaderFooter = True\n        .FirstPage.RightHeader.Text = &quot;&quot;\n        .FirstPage.LeftFooter.Text = &quot;&quot;\n        .FirstPage.CenterFooter.Text = &quot;&quot;\n        .FirstPage.RightFooter.Text = &quot;&quot;\n    End With\n    Application.PrintCommunication = True\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n<p>How do I edit this code so that it works on all the worksheets of each Excel workbook in my folder?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "edited": false, "score": 1, "creation_date": 1469046482, "post_id": 38490243, "comment_id": 64382113, "body": "What do you mean by &quot;base your form on that query&quot;? Can you give specifics?"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "reply_to_user": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "edited": false, "score": 0, "creation_date": 1469058935, "post_id": 38490243, "comment_id": 64386587, "body": "Just as I said. You create a query, calculate the age within that query and save the query. Next, you use that query as the record source for your form rather than a table. Quite common practice ;)"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "reply_to_user": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "edited": false, "score": 0, "creation_date": 1469069014, "post_id": 38490243, "comment_id": 64388779, "body": "Just read Andre&#39;s reply. Indeed you shouldn&#39;t store calculated values in a table. If you persist you to do, remind that people tend to age, meaning your ages would be out of date tomorrow ;) You can simply continue using your current form and base it on a table. If you&#39;d want to calculate someone&#39;s age, you&#39;d need a separate query though (and/or VBA)."}], "tags": [], "owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "is_accepted": false, "score": 1, "last_activity_date": 1469046406, "creation_date": 1469046406, "answer_id": 38490243, "question_id": 38489170, "link": "https://stackoverflow.com/questions/38489170/how-to-send-a-value-which-does-not-have-a-form-field-along-with-the-rest-of-the/38490243#38490243", "title": "How to send a value which does not have a form field, along with the rest of the form fields to a table as a new record ms-access 2013?", "body": "<p>Calculate the age in a query and base your form on that query.</p>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1469052132, "creation_date": 1469052132, "answer_id": 38491600, "question_id": 38489170, "link": "https://stackoverflow.com/questions/38489170/how-to-send-a-value-which-does-not-have-a-form-field-along-with-the-rest-of-the/38491600#38491600", "title": "How to send a value which does not have a form field, along with the rest of the form fields to a table as a new record ms-access 2013?", "body": "<p>First: think very hard if you really have a good reason to store a value in the table that can easily be calculated.</p>\n\n<p><a href=\"http://allenbrowne.com/casu-14.html\" rel=\"nofollow\">Calculated fields belong in queries, not tables.</a></p>\n\n<p>If there is a good reason: even if the <code>age</code> control <strong>is</strong> on the form, it cannot be calculated and bound to a table field with its <code>ControlSource</code> at the same time.</p>\n\n<p>So: put the control on the form, bound to the table field, but set it to <code>Visible = False</code>.</p>\n\n<p>Then in <code>AfterUpdate</code> of <code>Birthdate</code>, do the calculation and set the invisible control value so it will be saved with the record.</p>\n\n<p>While debugging, it helps to have the control visible. </p>\n"}], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 38491600, "answer_count": 2, "score": 0, "last_activity_date": 1469052132, "creation_date": 1469042652, "question_id": 38489170, "link": "https://stackoverflow.com/questions/38489170/how-to-send-a-value-which-does-not-have-a-form-field-along-with-the-rest-of-the", "title": "How to send a value which does not have a form field, along with the rest of the form fields to a table as a new record ms-access 2013?", "body": "<p>I have a table called table1 with 4 fields: Age, name, birthdate, and haircolour. On the data entry form for that table, I only have 3 of the fields present with the age field being left out. These are all example fields. From the birthdate, I can calculate the age of the person in the background, but since the age field is not a part of the form, it doesn't automatically send the age data with the rest of the fields as a new record to table1. </p>\n\n<p>How can I not include the age field in the form but still have it as input data to the new record? </p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 3, "creation_date": 1469042671, "post_id": 38489037, "comment_id": 64380019, "body": "There&#39;s no code that puts data anywhere except into the variable F.  I would assume you have a loop to keep appending I so instead of just adding it to F just increment your row number and store it into the cell."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1517666380, "post_id": 38489037, "comment_id": 84192778, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24814107/vba-split-string-into-individual-cells\">VBA - Split string into individual cells</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469115063, "post_id": 38489298, "comment_id": 64414751, "body": "When I try to run this, it is giving me a 1004 run-time error for the following section of code  &gt;Range(&quot;A4&quot;).Resize(1, UBound(a)) = a"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469132143, "post_id": 38489298, "comment_id": 64424187, "body": "I update my answer.  The proper syntax is &gt;Range(&quot;A1&quot;).Resize(1, UBound(a) + 1) = a"}, {"owner": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469132680, "post_id": 38489298, "comment_id": 64424474, "body": "Ahh ok thanks! So now is there a way I can set F = to the cell containing the array so that if/when the numbers get changed the array the cells change with it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469133019, "post_id": 38489298, "comment_id": 64424636, "body": "I&#39;m really not sure what you want to do.  You need to post more code."}, {"owner": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469133738, "post_id": 38489298, "comment_id": 64425014, "body": "Here is the full code for my function     Function InBetween(First As Integer, Last As Integer)     Dim i As Long, F As String, a() As String     F = First     For i = First + 30 To Last Step 30     F = F &amp; &quot;|&quot; &amp; i     Next i     InBetween = F     End Function  I am using this for scheduling parttime employees and using there availability as the first and last time to create a data validation that only contains times within their availability."}, {"owner": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469134041, "post_id": 38489298, "comment_id": 64425175, "body": "Knowing availability will change I don&#39;t want to have to go through and manually change is in the code each time that occurs. So I am looking for a way to reference the cell that contains the times and split those. I was thinking maybe there is way to set F equal to a particular cell rather than have to set it equal to all the times manually."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "edited": false, "score": 0, "creation_date": 1469134463, "post_id": 38489298, "comment_id": 64425387, "body": "You can use a worksheet function to split the values of a cell. &gt; =IF(ISERROR(FIND(&quot; &quot;,TRIM(A2),1)),TRIM(A2),MID(TRIM(A2),FIND(&quot; &quot;,TRIM(A2),1),LEN(A2)))  <a href=\"http://stackoverflow.com/questions/1031305/simulate-string-split-function-in-excel-formula\">THis Post</a> might help"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1469043088, "creation_date": 1469043088, "answer_id": 38489298, "question_id": 38489037, "link": "https://stackoverflow.com/questions/38489037/separating-data-in-one-cell-into-multiple-cells/38489298#38489298", "title": "separating data in one cell into multiple cells", "body": "<p>You use <code>Split(F, \",\")</code> to create an array.  Then use <code>Range.Resize</code> to make your destination range the same size as the array. Finally, make the new range = the array.</p>\n\n<pre><code>Sub Example()\n\n    Dim F As String\n    Dim a() As String\n\n    F = \"1130,1160,1190,1220,1250,1280,1310,1340,1370,1400,1430,1460,1490\"\n    a = Split(F, \",\")\n\n    Range(\"A1\").Resize(1, UBound(a)) = a\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6615345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOWM2.jpg?s=128&g=1", "display_name": "kmja2500", "link": "https://stackoverflow.com/users/6615345/kmja2500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1517666946, "answer_count": 1, "score": 0, "last_activity_date": 1499485529, "creation_date": 1469042170, "last_edit_date": 1531161705, "question_id": 38489037, "link": "https://stackoverflow.com/questions/38489037/separating-data-in-one-cell-into-multiple-cells", "closed_reason": "Needs details or clarity", "title": "separating data in one cell into multiple cells", "body": "<p>I am currently using the following in my code:</p>\n\n<blockquote>\n  <p>F = F &amp; \",\" &amp; I</p>\n</blockquote>\n\n<p>This portion of code outputs my results in the following format in one single cell:\n1130,1160,1190,1220,1250,1280,1310,1340,1370,1400,1430,1460,1490</p>\n\n<p>I am wondering if there is a similar code that I could use that will enter each number in its own cell within a single column.</p>\n"}, {"tags": ["excel", "vba", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6539546, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/06b2ced1e487b4ca89e6f58f2df969bd?s=128&d=identicon&r=PG&f=1", "display_name": "RWA4ARC", "link": "https://stackoverflow.com/users/6539546/rwa4arc"}, "edited": false, "score": 0, "creation_date": 1469112193, "post_id": 38490994, "comment_id": 64412779, "body": "I really appreciate the answer, the only issue is I get an error &quot;User-defined type not defined&quot; for <code>Dim oEventH As EventH</code>. Do you know why this would be?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 109, "user_id": 6539546, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/06b2ced1e487b4ca89e6f58f2df969bd?s=128&d=identicon&r=PG&f=1", "display_name": "RWA4ARC", "link": "https://stackoverflow.com/users/6539546/rwa4arc"}, "edited": false, "score": 1, "creation_date": 1469112303, "post_id": 38490994, "comment_id": 64412876, "body": "You need to rename your event handler class <code>EventH</code>"}, {"owner": {"reputation": 109, "user_id": 6539546, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/06b2ced1e487b4ca89e6f58f2df969bd?s=128&d=identicon&r=PG&f=1", "display_name": "RWA4ARC", "link": "https://stackoverflow.com/users/6539546/rwa4arc"}, "edited": false, "score": 0, "creation_date": 1469112529, "post_id": 38490994, "comment_id": 64413023, "body": "OK, I thought that may be it, but I&#39;ve never handled classes before in VBA. Is there an initialization function I need to include with the class? Or, is there a simple way of renaming it?"}, {"owner": {"reputation": 109, "user_id": 6539546, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/06b2ced1e487b4ca89e6f58f2df969bd?s=128&d=identicon&r=PG&f=1", "display_name": "RWA4ARC", "link": "https://stackoverflow.com/users/6539546/rwa4arc"}, "edited": false, "score": 0, "creation_date": 1469112933, "post_id": 38490994, "comment_id": 64413297, "body": "I tried View -&gt; Properties Window -&gt; Name -&gt; EventH, but I get an error &quot;can&#39;t perform the requested operation&quot;. Edit: &quot;Events&quot; works. Didn&#39;t realize that was the name. Thank you very much for your help @cyboashu."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1469050125, "last_edit_date": 1469050125, "creation_date": 1469049420, "answer_id": 38490994, "question_id": 38489036, "link": "https://stackoverflow.com/questions/38489036/add-entry-from-listbox-to-most-recent-textbox-by-double-clicking-in-vba-userform/38490994#38490994", "title": "Add Entry from Listbox to Most Recent Textbox By Double Clicking in VBA Userform", "body": "<p>You can create a custom event handler class, mimic the Enter event by capturing MouseDown and KeyDown events. When the UserForm loads, hook all the Textboxes to custom event. Whenever a TextBox is accessed by User, store that in a global variable (in  a standard module). On ListBox DblClick, Just set the selected item text to the TextBox. Simple!!! :)</p>\n\n<p>See the full VBA code below:</p>\n\n<p>VBA Class (EventH) for the custom event handling.</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents txtBox As MSForms.TextBox\n\n'/ To Mimic Enter event .\nPrivate Sub txtBox_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    '/ Assign to global variable\n   Set g_ActiveTextBox = txtBox\nEnd Sub\n\n'/ To Mimic Enter event .\nPrivate Sub txtBox_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n     '/ Assign to global variable\n    Set g_ActiveTextBox = txtBox\nEnd Sub\n</code></pre>\n\n<p>VBA UserForm, with TextBoxes and ListBox</p>\n\n<pre><code>Option Explicit\n\nDim oCol                    As New Collection '/ Holds the custom events and keeps them alive\n\nPrivate Sub UserForm_Initialize()\n    '/ Start EventHandler hooking.\n    Call addEventhandlers\nEnd Sub\n\nSub addEventhandlers()\n    '/ Adds custom event handler to all TextBoxes of this UserForm\n    Dim oEventH     As EventH\n    Dim ctrl        As Control\n\n    For Each ctrl In Me.Controls\n        If TypeName(ctrl) = \"TextBox\" Then\n            Set oEventH = New EventH\n            Set oEventH.txtBox = ctrl\n            oCol.Add oEventH\n        End If\n    Next\n\nEnd Sub\n\nPrivate Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    '/ Copy Text from ListBox to Last active TextBox\n    Dim i As Long\n\n    If Not g_ActiveTextBox Is Nothing Then\n       For i = 0 To Me.ListBox1.ListCount - 1\n          If Me.ListBox1.Selected(i) Then\n              g_ActiveTextBox = Me.ListBox1.List(i)\n          End If\n      Next i\n    End If\nEnd Sub\n</code></pre>\n\n<p>A standard module to declare the global variable. </p>\n\n<p>Option Explicit</p>\n\n<pre><code>Global g_ActiveTextBox      As MSForms.TextBox '/ Global variable to hold the last active textbox\n                                               '/  Don't act smart and move it to UserForm as public.\n                                               '/ That will fail.\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6539546, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/06b2ced1e487b4ca89e6f58f2df969bd?s=128&d=identicon&r=PG&f=1", "display_name": "RWA4ARC", "link": "https://stackoverflow.com/users/6539546/rwa4arc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 38490994, "answer_count": 1, "score": 0, "last_activity_date": 1469112646, "creation_date": 1469042170, "last_edit_date": 1469112646, "question_id": 38489036, "link": "https://stackoverflow.com/questions/38489036/add-entry-from-listbox-to-most-recent-textbox-by-double-clicking-in-vba-userform", "title": "Add Entry from Listbox to Most Recent Textbox By Double Clicking in VBA Userform", "body": "<p>I am trying to find a way to have a user doubleclick an entry within a listbox, and paste it into the textbox they most recently had focus on. So, with a list box like </p>\n\n<pre><code>With ListBox1\n    .AddItem \"&lt;PARENT&gt; Customer's PARENT Company \"\n    .AddItem \"&lt;SALESEXEC&gt; The sales executive responsible for the account\"\n    .AddItem \"&lt;FIRSTNAME&gt; Customer's First Name\"\nEnd With\n</code></pre>\n\n<p>I would like to be able to past these values into a textbox, but because the form has multiple textboxes, I want it to be the last one they have focus on. I was thinking of doing something like following. The issue is I can't seem to get <code>GotFocus</code> event  to do anything. It does work with <code>Enter</code> event, but that only works once. </p>\n\n<pre><code>Public hasFoc As String\nPrivate Sub TextBox4_GotFocus()\n    Debug.Print (\"TextBox4 Clicked\")\n    hasFoc = \"TextBox4\"\nEnd Sub\n\nPrivate Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n\n'Get index of clicked element, and paste the \"&lt;&gt;\" \n'value into the most recently used textbox\n\nEnd Sub\n</code></pre>\n\n<p>Edit: I haven't handled classes before in VBA, but my class module looks like this:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents txtBox As MSForms.TextBox\n\n'/ To Mimic Enter event .\nPrivate Sub txtBox_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    '/ Assign to global variable\n   Set g_ActiveTextBox = txtBox\nEnd Sub\n\n'/ To Mimic Enter event .\nPrivate Sub txtBox_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n     '/ Assign to global variable\n    Set g_ActiveTextBox = txtBox\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1469047016, "post_id": 38488658, "comment_id": 64382397, "body": "Maybe this topic helps you along your way: <a href=\"http://stackoverflow.com/questions/20245053/running-microsoft-access-as-a-scheduled-task\" title=\"running microsoft access as a scheduled task\">stackoverflow.com/questions/20245053/&hellip;</a>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1469059296, "post_id": 38488658, "comment_id": 64386669, "body": "Forget looping through a folder, just loop through <code>TblImportMenu</code>. How is this table populated? Which of these files in table do you need imported? Right now it takes just the first."}, {"owner": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469133043, "post_id": 38488658, "comment_id": 64424650, "body": "As for files, anytime a file is added to the Windows Explorer folder, that file is to be imported. Whether that&#39;s 2 or 50 files simultaneously.  I will take a look at how the TblImportMenu works. Where would I add this, before the DoCmd or after?"}, {"owner": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469133240, "post_id": 38488658, "comment_id": 64424754, "body": "Thanks Rene, I will review that link and see how that fits!"}, {"owner": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469133280, "post_id": 38488658, "comment_id": 64424773, "body": "Thanks Parfait, I did see that command in one area, but just wasn&#39;t sure where to actually place it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469133198, "post_id": 38504169, "comment_id": 64424732, "body": "Wow marlan, this looks great! From the look of this, I would replace pretty much all of mine less the Remove and Append pieces where you have those commented out. Am I correct in this assumption?"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469346513, "post_id": 38504169, "comment_id": 64490844, "body": "Yup, that&#39;s the way I do it. If a file is not in the correct format, that is: not csv, or is csv if a different format, an error will occur. Just resume with the next file... <b>Please note:</b> <i>remove old data</i> should correlate with the data you are importing, make sure you don&#39;t remove data just imported in the previous iteration... ;)"}, {"owner": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469451406, "post_id": 38504169, "comment_id": 64526435, "body": "Hi marlan, I looked at the bit of code and how it worked in my situation. Ran it, but it didn&#39;t like the On Current Event Procedure as a button - Procedure declaration does not match description of event. I believe it is due to OnOpen because an event name is expected to run when the event occurs. Any suggestions? And probably a dumb question for this, will this prompt to open a folder or am I to place the source of the folder within here such as in &quot;TempImportFolder&quot;?  Thanks so much,"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "edited": false, "score": 0, "creation_date": 1469521998, "post_id": 38504169, "comment_id": 64558005, "body": "<b>As for the event</b>: you chose the event to run the code according to your system plan. In my case, I had it in a Button <code>OnClick</code> event, when the user had the need to import new data. <b>As for the the folder</b>:  this procedure receives  a folder as a parameter, the calling procedure must supply one when calling. The calling procedure can receive a folder name from Form field, dialog box (<a href=\"http://www.ammara.com/access_image_faq/browse_for_folder_dialog.html\" rel=\"nofollow noreferrer\">link to API function I use</a>), DB field, hard code etc... I have the dialog box save to a textbox, linked to a db field..."}], "tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": false, "score": 0, "last_activity_date": 1469113028, "last_edit_date": 1469113028, "creation_date": 1469103707, "answer_id": 38504169, "question_id": 38488658, "link": "https://stackoverflow.com/questions/38488658/automated-import-of-csv-files-from-windows-explorer-into-access-db/38504169#38504169", "title": "Automated Import of csv files from Windows Explorer into Access DB", "body": "<p>Use <code>Scripting.FileSystemObject</code> to iterate through file system folders and files. Here is a sample of code I use for importing files from a specific folder:</p>\n\n<pre><code>Private sub ImportCSVs(TempImportFolder as String)\n\n    On Error Goto ImportCSVs_Err\n    Dim objFS As Object, objFolder As Object, objFiles As Object\n\n    Set objFS = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFS.GetFolder((TempImportFolder)) \n    Set objFiles = objFolder.Files\n    For Each file In objFiles\n        DoCmd.TransferText acImportDelim, \"[import_spec]\", \"Wkly_Rprt\",  TempImportFolder &amp; \"\\\" &amp; file.Name, False \n        'Remove old data ....   \n        'Append new data ....\n        'Delete file:\n        objFs.DeleteFile TempImportFolder &amp; \"\\\" &amp; file.Name\nNextFile:\n    Next\nImportCSVs_Exit:\n    Exit Sub\nImportCSVs_Err:\n    'Handle Errors occurred do to file structure, and Resume NextFile\n\nEnd Sub\n</code></pre>\n\n<p>You can scan a folder for sub folders, and run this code on each sub-folder too, <a href=\"https://msdn.microsoft.com/en-us/library/aa242714(v=vs.60).aspx\" rel=\"nofollow\">sample code at this reference</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6615225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce6f04157843c3f9163c4c638b913ee?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Acula", "link": "https://stackoverflow.com/users/6615225/dr-acula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1469560052, "creation_date": 1469040897, "last_edit_date": 1469560052, "question_id": 38488658, "link": "https://stackoverflow.com/questions/38488658/automated-import-of-csv-files-from-windows-explorer-into-access-db", "title": "Automated Import of csv files from Windows Explorer into Access DB", "body": "<p>I have an ADB that I am looking to automatically loop through Windows Explorer, import the file to a weekly report table (Wkly_Rprt), perform formatting, and append it to a weekly summary table (Wkly_S_Rprt), and then delete each file from Windows Explorer? File names are in the same format with the date changed at the end. If so, what would that look like as I have looked through numerous other examples without much luck.</p>\n\n<p>Thanks so much for your help!</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469040018, "post_id": 38488273, "comment_id": 64378501, "body": "Maybe, just maybe, Excel keeps some kind of cache when <code>Autofilter</code> is on and then <code>AdvancedFilter</code> use that cache."}], "answers": [{"tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": true, "score": 0, "last_activity_date": 1469045250, "creation_date": 1469045250, "answer_id": 38489907, "question_id": 38488273, "link": "https://stackoverflow.com/questions/38488273/advancedfilter-macro-runs-slower-with-autofilter-off/38489907#38489907", "title": "AdvancedFilter macro runs slower with AutoFilter off", "body": "<p>First, I assume that you have this at the top of your code? If not, add it and see if that fixes it. Don't forget to have the reset options at the bottom.</p>\n\n<pre><code>With Application\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n'your code goes here\nWith Application\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>As I said, I assume that was there and didn't resolve it, so that being said... Usually, with autofilter and advancedfilter weirdness it is something with the data. So there are a number of things I go through when I need to tweak a sheet. Have you tried all these?</p>\n\n<p>First, create a new workbook, copy all your data in the old workbook and paste values only into the new workbook. Keep as minimal as you can get away with in order for you to still use that macro. IE: if there are buttons and such that you don't need to transfer, dont. If there are extra sheets that aren't needed, don't transfer them either. If you can do values instead of formulas, do values only. But do transfer the entire relevant data set and not just some sample lines so that it is as apples to apples as possible.</p>\n\n<p>If it still runs slow like that then we are definitely looking at some weird situation with the code and it might be the cache thing like litelite proposed. If it works more like you would expect then we know it is either a formatting thing or some other thing messing with it.</p>\n\n<p>Assuming the second to start with as that is usually the issue.\nTry each of these on the original data and rerun it. Any order works so whichever is easiest to start with. I usually rerun macros after each change and don't go through doing all of these before running it again so I can know which thing fixed it. Also, not all of these will necessarily apply as I don't know your data. Ignore them if they don't apply.\nFirst make a copy and do these to the copy. If you go through multiples and find a fix, make a copy of the original again and then apply only the last change to the copy and see if it still fixes it.</p>\n\n<p>If you have multiple sheets, make a copy and delete all the extra sheets. Test it on just the minimal amount of sheets you can use. Likewise if you have multiple sheets left, each of the following needs to be done to all of them:</p>\n\n<ul>\n<li>Copy all non-formula data and paste special/values to get rid of any\nweird formatting/etc. </li>\n<li>Unhide all rows. </li>\n<li>Delete all comments. </li>\n<li>Delete all conditional formatting. </li>\n<li>Select all, turn on wrap text, then turn off wrap text. (I call this the Microsoft Hokey-Pokey. You put the check-mark in, you take the check-mark out...)</li>\n<li>If you have any forms buttons/objects delete them and see if it is faster.</li>\n</ul>\n\n<p>Finally, how many rows of data are you working with in the data set?</p>\n"}], "owner": {"reputation": 33, "user_id": 6615170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac9b867a04e368f351c04483d955af86?s=128&d=identicon&r=PG&f=1", "display_name": "JEK", "link": "https://stackoverflow.com/users/6615170/jek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 38489907, "answer_count": 1, "score": 2, "last_activity_date": 1469045596, "creation_date": 1469039593, "last_edit_date": 1469045596, "question_id": 38488273, "link": "https://stackoverflow.com/questions/38488273/advancedfilter-macro-runs-slower-with-autofilter-off", "title": "AdvancedFilter macro runs slower with AutoFilter off", "body": "<p>I've been trying to understand a Macro that a coworker found somewhere online for filtering a set of data based on selected criteria. Part of the code is an IF statement checking to see if AutoFilterMode is off, then toggling it on if it is found to be off, as so</p>\n\n<pre><code>'Turn on filter if not already turned on\nIf Sheets(\"ORDER DATA\").AutoFilterMode = False Then rng.AutoFilter\n</code></pre>\n\n<p>The very next line uses .AdvancedFilter to filter the data based on the selected criteria (a range referred to as filter)   </p>\n\n<pre><code>rng.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=filter, Unique:=True\n</code></pre>\n\n<p>I'm relatively OCD about wanting to keep things cleaned up in my code so I was thinking that I'd get rid of the first statement as it didn't seem necessary. What I've found since eliminating it is that the filtering process takes significantly longer to run if the first statement is eliminated.</p>\n\n<p>I've searched high and low online but haven't been able to find what the relationship between AutoFilter and AdvancedFilter is. </p>\n\n<p>So my question is this: why does the AdvancedFilter take so much longer to run when the AutoFilter isn't first turned on?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12973, "user_id": 894067, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7503014a9e8a710b63b3f76d64d6d3e3?s=128&d=identicon&r=PG", "display_name": "Charlie Fish", "link": "https://stackoverflow.com/users/894067/charlie-fish"}, "edited": false, "score": 0, "creation_date": 1469039569, "post_id": 38488240, "comment_id": 64378236, "body": "Why don&#39;t you want to use a for loop?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469039710, "post_id": 38488240, "comment_id": 64378307, "body": "The loop by itself doesn&#39;t add that much overhead. Your code will run in just about the same time with or without loop."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469039744, "post_id": 38488240, "comment_id": 64378326, "body": "Also, posting your code would help."}, {"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469041718, "post_id": 38488240, "comment_id": 64379474, "body": "i came up with the same idea as Slai, to hide sheets all at once and it helped me, i saved like 10 seconds. I project this file to be user friendly and if possible, I want it to work as fast as possible. Could you please explain, why did you mark my questions as not useful? :)"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469041862, "post_id": 38488327, "comment_id": 64379559, "body": "thanks for the help, I got similar outcome with registering macro and selecting all 200 sheets :) Unfortunately, as you said, i can&#39;t unhide more than one sheet at a time :( Therefore, everytime I open the file i lose 10 seconds :(  Maybe you have an idea how can I make clients to enable macros in other way than hiding and unhiding all sheets? :) (sorry for my bad english)"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469043014, "post_id": 38488327, "comment_id": 64380204, "body": "You can do it with custom view <a href=\"http://www.accountingweb.com/technology/excel/hide-and-unhide-multiple-excel-worksheets\" rel=\"nofollow noreferrer\">accountingweb.com/technology/excel/&hellip;</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469043520, "post_id": 38488327, "comment_id": 64380481, "body": "Hiding sheets will not make your file open faster. You can try saving the file as .xlsb"}, {"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469043540, "post_id": 38488327, "comment_id": 64380488, "body": "thanks, do you think it is possible to save somehow with vba all unhidden sheets as a custom view, and then, after opening the workbook again, come back to last view? Unfortunately I have problems with registering on this website, so I cant read the rest of this article.. :("}, {"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469043633, "post_id": 38488327, "comment_id": 64380541, "body": "I dont want my sheet to open faster because my sheets are hidden, i just want the macro, which unhides the sheets to work faster (i have 200 sheets, unhiding all with a for loop takes 10 seconds, which is long in this situation)"}, {"owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "edited": false, "score": 0, "creation_date": 1469046106, "post_id": 38488327, "comment_id": 64381920, "body": "Thanks for all your help:) I came up with an idea to write a code like this:     ActiveWorkbook.Windows(1).Visible = False     ActiveWorkbook.Windows(1).Visible = True But when i hide a workbook i cant target it with ActiveWorkbook.Windows(1). Maybe you know how can i do it?"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 4, "last_activity_date": 1469045281, "last_edit_date": 1469045281, "creation_date": 1469039774, "answer_id": 38488327, "question_id": 38488240, "link": "https://stackoverflow.com/questions/38488240/hiding-selected-worksheets-without-for-loop/38488327#38488327", "title": "hiding selected worksheets without for loop", "body": "<p>You can just record a macro of selecting the first sheet, and then select the last sheet with Shift. Then you right-click and Hide.</p>\n\n<pre><code>Sheets(Array(\"Sheet2\", \"Sheet3\", \"Sheet4\")).Visible = False\n</code></pre>\n\n<p>Or by index </p>\n\n<pre><code>Sheets([{2, 3, 4}]).Visible = False\n</code></pre>\n\n<p>Note that you can not <strong>un</strong>hide more than one sheet at a time.</p>\n\n<p><hr>\nTo add a custom view with all sheets visible:</p>\n\n<pre><code>For Each ws In Sheets\n    ws.Visible = True\nNext\nActiveWorkbook.CustomViews.Add \"All\"  ' you can change the name \n</code></pre>\n\n<p>Then, to un-hide all sheets:</p>\n\n<pre><code>ActiveWorkbook.CustomViews(\"All\").Show\n</code></pre>\n\n<p><hr>\nTo un-hide the sheets faster, you can try disabling some of the events and calculation:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nFor Each ws In Sheets: ws.Visible = True: Next\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1469092107, "post_id": 38488351, "comment_id": 64399270, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/13071197\">From Review</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1469107896, "post_id": 38488351, "comment_id": 64409677, "body": "@CryptoGuy - why did you place this comment here? I am not seeing the relation?"}, {"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1469109418, "post_id": 38488351, "comment_id": 64410772, "body": "It was set from template (through review). You are more experienced user on SO and should know that link-only and code-only (without explanation or description) aren&#39;t appreciated here."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1469110254, "post_id": 38488351, "comment_id": 64411404, "body": "Fair enough for the lack of explanation @CryptoGuy"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1469039873, "creation_date": 1469039873, "answer_id": 38488351, "question_id": 38488240, "link": "https://stackoverflow.com/questions/38488240/hiding-selected-worksheets-without-for-loop/38488351#38488351", "title": "hiding selected worksheets without for loop", "body": "<pre><code>Sub HideSheets()\n\n    Dim sSheets() As String\n\n    sSheets = Split(\"Sheet1,Sheet2,Sheet3\", \",\")\n\n    Worksheets(sSheets).Visible = xlHidden\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 5004656, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100000514819041/picture?type=large", "display_name": "Kuba", "link": "https://stackoverflow.com/users/5004656/kuba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1469045281, "creation_date": 1469039483, "question_id": 38488240, "link": "https://stackoverflow.com/questions/38488240/hiding-selected-worksheets-without-for-loop", "title": "hiding selected worksheets without for loop", "body": "<p>I would like to hide some worksheets, all at once, without using for loop. The reason for this is a big number of worksheets, so my macro works a while.</p>\n\n<p>Do you have any ideas how can I improve the running time of this macro?</p>\n"}, {"tags": ["html", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1469041286, "post_id": 38488252, "comment_id": 64379211, "body": "Also consider using getElementsbyClassName."}], "tags": [], "owner": {"reputation": 21, "user_id": 6423247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a891af633905e5ac27e57327fc97fff?s=128&d=identicon&r=PG&f=1", "display_name": "Patrickll", "link": "https://stackoverflow.com/users/6423247/patrickll"}, "is_accepted": false, "score": 0, "last_activity_date": 1469039501, "creation_date": 1469039501, "answer_id": 38488252, "question_id": 38487947, "link": "https://stackoverflow.com/questions/38487947/vba-html-login-and-password-via-intranet-internetexplorermedium/38488252#38488252", "title": "VBA HTML Login and Password via Intranet InternetExplorerMedium", "body": "<p>Ok solved it. The code required this instead:</p>\n\n<pre><code> Set doc = ie.Document\n Set LoginForm = doc.forms(0)\n Set PasswordInputBox = LoginForm.elements(\"j_username\")\n PasswordInputBox.Value = \"123\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6423247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a891af633905e5ac27e57327fc97fff?s=128&d=identicon&r=PG&f=1", "display_name": "Patrickll", "link": "https://stackoverflow.com/users/6423247/patrickll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469039501, "creation_date": 1469038523, "question_id": 38487947, "link": "https://stackoverflow.com/questions/38487947/vba-html-login-and-password-via-intranet-internetexplorermedium", "title": "VBA HTML Login and Password via Intranet InternetExplorerMedium", "body": "<p>here is a piece of the source code I cannot seem to break in order to input my username and password:</p>\n\n<pre><code>&lt;div style=\"width: 30%;\"&gt;\n    &lt;table&gt;\n        &lt;tr&gt;\n            &lt;td style=\"width: 10%\"&gt;Username:&lt;/td&gt;\n            &lt;td class=\"required\"&gt;&lt;input type=\"text\" name=\"j_username\"&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;Password:&lt;/td&gt;\n            &lt;td class=\"required\"&gt;&lt;input type=\"password\" name=\"j_password\"&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&amp;nbsp;&lt;/td&gt;\n            &lt;td class=\"input\"&gt;&lt;input type=\"submit\" value=\"Log in\"&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is my Code. I am simply looking to add the username, passsword and then click submit to log in to my site. I have tried many different approaches, but I cannot seem to get the right object tree.</p>\n\n<pre><code> Sub ImportIntra()\n\n 'to refer to the running copy of Internet Explorer\n Dim ie As InternetExplorer\n\n 'to refer to the HTML document returned\n Dim html As HTMLDocument\n\n 'open Internet Explorer in memory, and go to website\n Set ie = New InternetExplorerMedium\n\n ie.Visible = True\n ie.Navigate \"https://www.placeholder.com\"\n\n 'Wait until IE is done loading page\n Do While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n Application.StatusBar = \"Trying to go to StackOverflow ...\"\n DoEvents\n Loop\n\n 'show text of HTML document returned\n Set html = ie.Document\n\n\n Dim doc As New HTMLDocument, els, el\n\n doc.body.innerHTML = html.DocumentElement.innerHTML\n\n Set Var = doc.getElementsByTagName(\"input\")(0).Value = \"123\"\n Set Var = doc.getElementsByTagName(\"input\")(1).Value = \"123\"\n Set Var = doc.getElementsByTagName(\"input\")(2).Value = \"123\"\n\n 'close down IE and reset status bar\n Set ie = Nothing\n\n Application.StatusBar = \"\"\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 1, "creation_date": 1469113839, "post_id": 38487556, "comment_id": 64413925, "body": "I am able to repro the said problem in PowerPoint 2016."}, {"owner": {"reputation": 738, "user_id": 2056988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7ea2d50bbcc6f8812c34dab65a1923a?s=128&d=identicon&r=PG", "display_name": "FtLie", "link": "https://stackoverflow.com/users/2056988/ftlie"}, "edited": false, "score": 0, "creation_date": 1474026845, "post_id": 38487556, "comment_id": 66376029, "body": "Just for reference, currently no answers from vendor at <a href=\"http://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-msoffice_custom/excel-vba-error-cannot-saveas-an-embedded/4adf17d5-8b2f-4328-b94a-8238c2effbda\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a>"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1481578287, "post_id": 38487556, "comment_id": 69424265, "body": "I also get this error when I am trying to save to a folder or drive that I do not have permission to save in."}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 2, "last_activity_date": 1474087284, "creation_date": 1474087284, "answer_id": 39542919, "question_id": 38487556, "link": "https://stackoverflow.com/questions/38487556/excel-vba-cant-saveas-embedded-powerpoint-presentation-in-office-2016/39542919#39542919", "title": "Excel VBA Can&#39;t SaveAs Embedded PowerPoint Presentation in Office 2016", "body": "<p>PowerPoint 2016 appears to fail when using <code>SaveAs</code> or <code>SaveCopyAs</code> against an embedded presentation.</p>\n\n<p>The workaround is to open the presentation, create a new presentation, and then copy the content from the embedded presentation to the new presentation. You can then close the embedded presentation, and save the new presentation as you wish.</p>\n\n<p>I've demonstrated copying the slides, but you may need to programmatically copy <code>BuiltInDocumentProperties</code> and other non-slide content.</p>\n\n<pre><code>Option Explicit\n\nSub OpenCopyOfEmbeddedPPTFile() 'works with Office 2010 and 2013, but not on Office 2016\n    Dim oOleObj As OLEObject\n    Dim PPTApp As Object\n    Dim PPTPres As Object\n    Dim PPTNewPres As Object\n    Dim sFileName As String\n    Set oOleObj = ActiveSheet.Shapes(\"PPTObj\").OLEFormat.Object 'name of the embedded pptx object\n\n    oOleObj.Verb 3\n    Set PPTPres = oOleObj.Object\n\n    Set PPTApp = PPTPres.Application\n    PPTApp.Visible = True\n\n    'We can't save the embedded presentation in 2016, so let's copy the clides to a new presentation\n    Set PPTNewPres = PPTApp.Presentations.Add\n    PPTPres.Slides.Range.Copy\n    PPTNewPres.Slides.Paste\n\n    'We may need to copy other things, like BuiltInDocumentProperties\n    'TODO\n\n    'Close the original\n    PPTPres.Close\n\n    sFileName = \"C:\\Users\\Me\\Documents\\testPPT121.pptx\"\n    sFileName = \"C:\\users\\andrew\\desktop\\testPPT12111-FOOJANE.pptx\"\n    PPTNewPres.SaveAs sFileName\n\n    'code to modify the Presentation (copy of the embedded pptx) based on Excel calculations\n\n    'Quit PPT\n    'PPTNewPres.Close\n    'PPTApp.Quit\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 539, "user_id": 1546931, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2ac90e04bd4d088a4d0e74833f3ad0ae?s=128&d=identicon&r=PG", "display_name": "Andrew Hall", "link": "https://stackoverflow.com/users/1546931/andrew-hall"}, "edited": false, "score": 0, "creation_date": 1481837698, "post_id": 41046828, "comment_id": 69547901, "body": "This does not fix my issue.  The issue/bug only occurs (can&#39;t save) when the PPTX is embedded in Excel.  For a stand-alone PPTM, any of the above work."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1481223342, "creation_date": 1481223342, "answer_id": 41046828, "question_id": 38487556, "link": "https://stackoverflow.com/questions/38487556/excel-vba-cant-saveas-embedded-powerpoint-presentation-in-office-2016/41046828#41046828", "title": "Excel VBA Can&#39;t SaveAs Embedded PowerPoint Presentation in Office 2016", "body": "<p>I found this possible answer in another forum and it worked for me saving a PPTM file as a PPTX file as a copy</p>\n\n<p>Change </p>\n\n<pre><code>PPTPres.SaveAs Filename:=sFileName \n</code></pre>\n\n<p>to </p>\n\n<pre><code>PPTPres.SaveAs sFileName\n</code></pre>\n\n<p>Mine was :</p>\n\n<pre><code>PPTPres.SaveCopyAs sFileName\n</code></pre>\n\n<p>I then open the new file and close the PPTM file </p>\n"}], "owner": {"reputation": 539, "user_id": 1546931, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2ac90e04bd4d088a4d0e74833f3ad0ae?s=128&d=identicon&r=PG", "display_name": "Andrew Hall", "link": "https://stackoverflow.com/users/1546931/andrew-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2637, "favorite_count": 0, "accepted_answer_id": 39542919, "answer_count": 2, "score": 4, "last_activity_date": 1481223342, "creation_date": 1469037306, "question_id": 38487556, "link": "https://stackoverflow.com/questions/38487556/excel-vba-cant-saveas-embedded-powerpoint-presentation-in-office-2016", "title": "Excel VBA Can&#39;t SaveAs Embedded PowerPoint Presentation in Office 2016", "body": "<p>We embed pptx files in Excel, then use Excel VBA code (like below) to open, then SaveAs the pptx file to the user's drive, then programmatically modify the pptx content based on Excel calculations.<br>\nThe Excel VBA code below works fine to control PowerPoint 2010 and 2013, but no longer works for PowerPoint 2016.<br>\nNote:  I have similar code for Word and it works fine for Word 2016 (and prior versions).</p>\n\n<pre><code>Sub OpenCopyOfEmbeddedPPTFile() 'works with Office 2010 and 2013, but not on Office 2016\n    Dim oOleObj As OLEObject\n    Dim PPTApp As Object\n    Dim PPTPres As Object\n    Dim sFileName As String\n    Set oOleObj = ActiveSheet.Shapes(\"PPTObj\").OLEFormat.Object 'name of the embedded pptx object\n    Set PPTApp = CreateObject(\"Powerpoint.Application\")\n    PPTApp.Visible = True\n    sFileName = \"C:\\Users\\Me\\Documents\\testPPT.pptx\"\n    OleObj.Verb Verb:=xlVerbOpen 'it opens successfully\n    Set PPTPres = oOleObj.Object\n    PPTPres.SaveAs Filename:=sFileName 'fails here (in Office 2016)\n    PPTPres.Close\n    GetObject(, \"PowerPoint.Application\").Presentations.Open sFileName\n    'code to modify the Presentation (copy of the embedded pptx) based on Excel calculations\nEnd Sub\n</code></pre>\n\n<p>Error:<br>\nRun-time error '-2147467259 (80004005)': \nPresentation.SaveAs : An error occurred while PowerPoint was saving the file.</p>\n\n<p>Also, the following PowerPoint VBA (not Excel VBA) works fine for normal documents (not embedded in Excel), but fails when I run it in an opened embedded pptm.  Works fine in 2013 and 2010 embedded pptm's. </p>\n\n<pre><code>ActivePresentation.SaveAs FileName:=\"C:\\Users\\Me\\Documents\\testPPT.pptm\"\n</code></pre>\n\n<p>Error: \nRun-time error '-2147467259 (80004005)':  Presentation (unknown member) : An error occurred while PowerPoint was saving the file.</p>\n\n<p>Windows OS version does not seem to matter.  Does not work on Office for Mac.</p>\n\n<p>Any way to resolve or workaround this error?  Or is there another way to do the same thing (modify a copy of the embedded pptx so the embedded pptx is not modified)?  Or does this error only occur on our Office 2016 PCs?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1469037730, "post_id": 38487534, "comment_id": 64377140, "body": "Great!! Thanks a lot. I&#39;ve just tried that. It Works perfectly. Thanks for answering so quickly"}, {"owner": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1469039103, "post_id": 38487534, "comment_id": 64377983, "body": "Hi, I have another question. Is it posible to copy just the visible cells? Because I have some columns hidden that I don&#39;t want to copy. How could I do that??"}, {"owner": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1469039301, "post_id": 38487534, "comment_id": 64378101, "body": "I am new here, I am still trying to figure out how to marked as answered jeje"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1469039437, "post_id": 38487534, "comment_id": 64378179, "body": "How dare you ask another question before accepting answer, upvote???? Just kidding.....  for only visible cells use: <code>wsSht.UsedRange.SpecialCells (xlCellTypeVisible).Copy</code>"}, {"owner": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1469039633, "post_id": 38487534, "comment_id": 64378269, "body": "Sorry for that jeje is the answer accepted? and does that mean that my question is answered?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1469040048, "post_id": 38487534, "comment_id": 64378517, "body": "NP... I was just kidding. But its accepted now.<a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>.... cheers!! If you have more questions always start a new question."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 0, "last_activity_date": 1469037222, "creation_date": 1469037222, "answer_id": 38487534, "question_id": 38487403, "link": "https://stackoverflow.com/questions/38487403/how-to-paste-a-worksheet-copied-from-another-workbook-into-an-existing-worksheet/38487534#38487534", "title": "How to paste a worksheet copied from another workbook into an existing worksheet?", "body": "<p>In this line you copy a full sheet with data \n<code>wsSht.Copy before:=sThisBk.Sheets(\"Bimbo12\")</code></p>\n\n<p>Change it to </p>\n\n<pre><code>wsSht.Cells.Copy sThisBk.Sheets(\"Bimbo12\").Cells(1,1)\nApplication.CutCopyMode=False\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6615015, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CJ2SDmF5Suw/AAAAAAAAAAI/AAAAAAAAABE/rcWSq0Ffas0/photo.jpg?sz=128", "display_name": "Alejandro Palacios Garc&#237;a", "link": "https://stackoverflow.com/users/6615015/alejandro-palacios-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 38487534, "answer_count": 1, "score": 0, "last_activity_date": 1469037825, "creation_date": 1469036878, "last_edit_date": 1469037825, "question_id": 38487403, "link": "https://stackoverflow.com/questions/38487403/how-to-paste-a-worksheet-copied-from-another-workbook-into-an-existing-worksheet", "title": "How to paste a worksheet copied from another workbook into an existing worksheet?", "body": "<p>I have found a little difficult to achieve copying an existing worksheet from a workbook, let's called it, \"WB_RAW\" and pasting it into an existing worksheet in another workbook. So far I have the next code, which I get from another post's answer. This code copies succesfully the worksheet but it creates a new worksheet in the workbook, let's called it, \"Final_WB\" instead of pasting the info into an existing workbook.</p>\n\n<pre><code>    Sub ImportSheet()\n    Dim sImportFile As String, sFile As String\n    Dim sThisBk As Workbook\n    Dim vfilename As Variant\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Set sThisBk = ActiveWorkbook\n    sImportFile = Application.GetOpenFilename( _\n    FileFilter:=\"Microsoft Excel Workbooks, *.xls; *.xlsx\", Title:=\"Open Workbook\")\n    If sImportFile = \"False\" Then\n        MsgBox \"No File Selected!\"\n        Exit Sub\n\n    Else\n        vfilename = Split(sImportFile, \"\\\")\n        sFile = vfilename(UBound(vfilename))\n        Application.Workbooks.Open Filename:=sImportFile\n\n        Set wbBk = Workbooks(sFile)\n        With wbBk\n            If SheetExists(\"MTM Datos\") Then\n                Set wsSht = .Sheets(\"MTM Datos\")\n                wsSht.Copy before:=sThisBk.Sheets(\"B012\")\n                ActiveSheet.UsedRange.Value = ActiveSheet.UsedRange.Value\n            Else\n                MsgBox \"There is no sheet with name :MTM Datos in:\" &amp; vbCr &amp; .Name\n            End If\n            wbBk.Close SaveChanges:=False\n        End With\n    End If\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\nPrivate Function SheetExists(sWSName As String) As Boolean\n    Dim ws As Worksheet\n    On Error Resume Next\n    Set ws = Worksheets(sWSName)\n    If Not ws Is Nothing Then SheetExists = True\nEnd Function\n</code></pre>\n\n<p>Please help me, it's been a while since I used VBA for the last time so I do not remembe well how to use it</p>\n"}, {"tags": ["vba", "excel", "autofill"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1469036734, "post_id": 38487265, "comment_id": 64376499, "body": "why  ` ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count` ??<a href=\"http://stackoverflow.com/questions/71180/how-can-i-find-last-row-that-contains-data-in-the-excel-sheet-with-a-macro\" title=\"how can i find last row that contains data in the excel sheet with a macro\">stackoverflow.com/questions/71180/&hellip;</a>"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1469037207, "post_id": 38487265, "comment_id": 64376798, "body": "Your code is working as per your requirement on my pc. <a href=\"https://www.dropbox.com/s/kg380esjoyxb0o9/autofill_sample.xlsm?dl=0\" rel=\"nofollow noreferrer\">Check</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1469037428, "post_id": 38487265, "comment_id": 64376942, "body": "For lastRow, I&#39;d instead compare your three columns, and get the last row from there. <code>UsedRange</code>, in my experience, doesn&#39;t always use the range I&#39;d expect. <code>lastRow = Max(cells(rows.count,2).End(xlUp).Row,cells(rows.count,3).En&zwnj;&#8203;d(xlUp).Row,cells(ro&zwnj;&#8203;ws.count,5).End(xlUp&zwnj;&#8203;).Row</code>  <i>or</i> <code>LastRow = Cells.Find(&quot;*&quot;, searchorder:=xlByRows, searchdirection:=xlPrevious).Row</code>"}, {"owner": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "edited": false, "score": 0, "creation_date": 1469038722, "post_id": 38487265, "comment_id": 64377771, "body": "yes, I have changed it to  LastRow = Cells.Find(&quot;*&quot;, searchorder:=xlByRows, searchdirection:=xlPrevious).Row  still there are some problems, in column E there are some parts are not filled in with the macro"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "edited": false, "score": 0, "creation_date": 1469067763, "post_id": 38489540, "comment_id": 64388485, "body": "Awesome! Glad that I  could help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1469043908, "creation_date": 1469043908, "answer_id": 38489540, "question_id": 38487265, "link": "https://stackoverflow.com/questions/38487265/auto-fill-down-cell-in-excel-vba-macro/38489540#38489540", "title": "Auto fill down cell in Excel VBA Macro", "body": "<p><a href=\"http://powerspreadsheets.com/excel-vba-last-row/#vba-code-to-find-last-row-example-8rangefind-method\" rel=\"nofollow\">Excel VBA Last Row: The Complete Tutorial To Finding The Last Row In Excel With VBA (And Code Examples)</a> recommends using <code>LookIn:=xlFormulas</code> when determining the last with using <code>Cells.Find</code>.</p>\n\n<pre><code>lastrow = Find(What:=\u201d * \u201d, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n</code></pre>\n\n<p>Because you stated that column D is already filled in I use:</p>\n\n<pre><code>lastrow = Range(\"D\" &amp;  Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>If column E isn't filled in then <code>Cells(x, 2).Value</code> must be <code>&lt;&gt; \"\"</code>.  </p>\n\n<pre><code>Sub AutoFill()\n    Dim x As Long\n    Dim y As Long\n    Dim lastrow As Long\n    Dim lastcolumn As Long\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    lastcolumn = ActiveSheet.UsedRange.Column - 1 + ActiveSheet.UsedRange.Columns.Count\n    lastrow = Range(\"D\" &amp;  Rows.Count).End(xlUp).Row\n\n    For x = 2 To lastrow\n\n        If Cells(x, 2).Value = \"\" Then Cells(x, 2).Value = Cells(x - 1, 2).Value\n        If Cells(x, 3).Value = \"\" Then Cells(x, 3).Value = Cells(x - 1, 3).Value\n        If Cells(x, 5).Value = \"\" Then Cells(x, 5).Value = Cells(x - 1, 4).Value\n\n    Next x\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 38489540, "answer_count": 1, "score": 0, "last_activity_date": 1469043908, "creation_date": 1469036412, "last_edit_date": 1469043881, "question_id": 38487265, "link": "https://stackoverflow.com/questions/38487265/auto-fill-down-cell-in-excel-vba-macro", "title": "Auto fill down cell in Excel VBA Macro", "body": "<pre><code>Sub AutoFill()\n\n    Dim x As Long\n    Dim y As Long\n    Dim lastrow As Long\n    Dim lastcolumn As Long\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    lastcolumn = ActiveSheet.UsedRange.Column - 1 + ActiveSheet.UsedRange.Columns.Count\n    lastrow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n\n    For x = 2 To lastrow\n        If Cells(x, 2).Value = \"\" Then\n            Cells(x, 2).Value = Cells(x - 1, 2).Value\n            Cells(x, 3).Value = Cells(x - 1, 3).Value\n            Cells(x, 5).Value = Cells(x - 1, 5).Value\n        End If\n    Next x\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>With the above code My cells are being filled up, but the last row fills till the end of excel sheet. In the Excel sheet column <code>D</code> is already filled in Column <code>B</code> <code>C</code> &amp; <code>E</code> should be auto fill to down. What should be the changes in the code?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469037663, "post_id": 38487094, "comment_id": 64377101, "body": "Explain your grouping logic in more detail - not &quot;and so on..&quot; Does a go with b, c go with d, e go with f (and so on) - or does the grouping depend on the first non-match in Name2"}, {"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469038048, "post_id": 38487094, "comment_id": 64377348, "body": "the tow names to together as soon as they are in one record. As soon as a Name aaa is the same record as bbb they belong together. If later on a name yyy is in the same record as bbb then is also belongs to aaa&#39;s group"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1469038316, "post_id": 38487094, "comment_id": 64377518, "body": "What happens when it belongs to two groups.  For example if you had a bbb ccc?  would this be 1 or 2?  Is there a precedence? or would this link make them all group 1?"}, {"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "edited": false, "score": 0, "creation_date": 1469044199, "post_id": 38487094, "comment_id": 64380874, "body": "This would make them all 1"}, {"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "edited": false, "score": 0, "creation_date": 1469447475, "post_id": 38487094, "comment_id": 64523652, "body": "Has anyone an idea."}], "owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594641720, "creation_date": 1469035818, "last_edit_date": 1594641720, "question_id": 38487094, "link": "https://stackoverflow.com/questions/38487094/ms-access-group-id-with-parent-and-children", "title": "MS Access Group ID with parent and children", "body": "<p>I have a question regarding MS ACCESS. \nI have a table with multiple columns and about 1600 records.\nThe first two columns are sort of the names of the record.\nThey can be exactly the same or they can be different. However I need to group them with a GroupID. \nThe grouping should give the same GroupID to the same family. a goes with b then all the names which goes with b are also in the same group as a and so on...\nI try to illustrate it in the below table</p>\n\n<pre><code>GroupID      NAme1    Name2    Varia \n               aaa     aaa      lkj\n              aaa      aaa      kjkjl\n               aaa     bbb      lkjlkj\n              ccc      ccc      kljlkjl\n              ddd      ccc      kajlsjf\n              bbb      eee      ljlkjlj\n              eee      eee      lkjlkj\n              fff      fff       kljl\n              fff      ggg      jlkjlj\n              iii      ccc      jlkjlkj\n              jjj      jjj       alsjlfj\n</code></pre>\n\n<p>This would have the following ids</p>\n\n<pre><code>GroupID      NAme1    Name2    Varia\n1             aaa      aaa      lkj\n1             aaa      aaa      kjkjl\n1             aaa      bbb      lkjlkj\n2             ccc      ccc      kljlkjl\n2             ddd      ccc      kajlsjf\n1             bbb      eee      ljlkjlj\n1             eee      eee      lkjlkj\n3             fff      fff       kljl\n3             fff      ggg      jlkjlj\n2             iii      ccc      jlkjlkj\n4             jjj      jjj       alsjlfj\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1469059459, "post_id": 38486824, "comment_id": 64386703, "body": "<i>forty sub routines with similar names</i>...something tells me one sub can be used with passed in parameters. Keep your code DRY -Don&#39;t Repeat Yourself."}], "answers": [{"tags": [], "owner": {"reputation": 639, "user_id": 4598964, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10153689452664899/picture?type=large", "display_name": "Dave B", "link": "https://stackoverflow.com/users/4598964/dave-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1469047632, "creation_date": 1469047632, "answer_id": 38490542, "question_id": 38486824, "link": "https://stackoverflow.com/questions/38486824/calling-similar-sub-routine-names-using-a-for-next-or-do-loops/38490542#38490542", "title": "Calling similar sub routine names using a For Next or Do Loops", "body": "<p>Are you trying to call a sub/function or a control event? </p>\n\n<p>Inside your loop you can use:</p>\n\n<p><code>Call command1_click</code></p>\n\n<p>Or to call a sub/function just use the sub/function name and pass any variables required.</p>\n\n<p>You should be careful not to have two subs/functions with the same name as you will run into trouble.</p>\n\n<p>Edit: if calling a sub/function from outside the form, you should make sure it's public. </p>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1469051303, "creation_date": 1469051303, "answer_id": 38491425, "question_id": 38486824, "link": "https://stackoverflow.com/questions/38486824/calling-similar-sub-routine-names-using-a-for-next-or-do-loops/38491425#38491425", "title": "Calling similar sub routine names using a For Next or Do Loops", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193559.aspx\" rel=\"nofollow\"><code>Application.Run</code></a>.</p>\n\n<p>The called subs need to be in a standard module.</p>\n\n<pre><code>Sub Test1()\n    Debug.Print \"Test1\"\nEnd Sub\n\nSub Test2()\n    Debug.Print \"Test2\"\nEnd Sub\n\nSub TestIt()\n\n    Dim S As String\n    Dim i As Long\n\n    For i = 1 To 2\n        S = \"Test\" &amp; i\n        Application.Run S\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Output of <code>TestIt</code>:</p>\n\n<pre><code>Test1\nTest2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1469930986, "last_edit_date": 1469930986, "creation_date": 1469930681, "answer_id": 38680125, "question_id": 38486824, "link": "https://stackoverflow.com/questions/38486824/calling-similar-sub-routine-names-using-a-for-next-or-do-loops/38680125#38680125", "title": "Calling similar sub routine names using a For Next or Do Loops", "body": "<p>you are right there you just need to change a couple things.  I just had to do this this morning I had controls day1 to day14 and for each dayi I was inputing values into excel.   What I did...</p>\n\n<pre><code>dim c as control\ndim i as integer\nfor i = 1 to 40\nset c = me.controls(\"sub name\" &amp; i)\n'do whatever with the control here you use set to establish which control c is  \n'then to set the value or use the value  \nc = someexpression 'etc.\n\nnext\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6596423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa929c6fc85bfb76092248af43995f3?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bibicoff", "link": "https://stackoverflow.com/users/6596423/j-bibicoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1594641633, "creation_date": 1469034861, "last_edit_date": 1594641633, "question_id": 38486824, "link": "https://stackoverflow.com/questions/38486824/calling-similar-sub-routine-names-using-a-for-next-or-do-loops", "title": "Calling similar sub routine names using a For Next or Do Loops", "body": "<p>Is it possible to call similar sub routine names using a FOR NEXT or DO LOOPS.\nI have forty sub routines with similar names. Each routine has minor variations.</p>\n\n<p>I have tried using a CONTROL, example: <code>me.control(\"Sub Name\", &amp; I)</code>. Doesn't work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1469035289, "post_id": 38486727, "comment_id": 64375678, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823.aspx\" rel=\"nofollow noreferrer\">Range.RemoveDuplicates()</a> may be of use."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1469122998, "post_id": 38486949, "comment_id": 64419400, "body": "I tried your code but it just continues what it did before and doesn&#39;t remove the duplicates."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1469123223, "post_id": 38486949, "comment_id": 64419529, "body": "I made an edit that I think will help. Is the code as it stands currently different than what you tried that I posted before?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1469131771, "post_id": 38486949, "comment_id": 64423990, "body": "Seems like it should work. You can try <code>If Len(v) &gt; 0 and duplicate=false</code> instead to see if it makes a difference."}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1469140320, "post_id": 38486949, "comment_id": 64427679, "body": "Thanks for the help nonetheless. I&#39;ll let you know if I can get it to work."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 1, "last_activity_date": 1469035685, "last_edit_date": 1469035685, "creation_date": 1469035298, "answer_id": 38486949, "question_id": 38486727, "link": "https://stackoverflow.com/questions/38486727/vba-removing-duplicates-from-new-set/38486949#38486949", "title": "vba removing duplicates from new set", "body": "<p>You could add a check to see if the result has already been copied over. First set a range of the results</p>\n\n<pre><code>finalRow = Worksheets(\"Sheet3\").Cells(1000000, 4).end(xlup).row\nSet resultRange = Worksheets(\"Sheet3\").Range(\"D1:D\" &amp; finalRow)\n</code></pre>\n\n<p>Now see if the value you are currently examining is in that range</p>\n\n<pre><code>duplicate = false\nfor each result in resultRange\n    if v = result.Value then\n        duplicate = true\n        Exit For\n    end if\nnext\n</code></pre>\n\n<p>Now also check for duplicate before proceeding</p>\n\n<pre><code>If Len(v) &gt; 0 and not duplicate then\n</code></pre>\n\n<p>All together    </p>\n\n<pre><code>Set d = Worksheets(\"Sheet3\").Range(\"D1\")\n\nFor Each c In ActiveSheet.Range(\"D25:D105\")\n    finalRow = Worksheets(\"Sheet3\").Cells(1000000, 4).end(xlup).row\n    Set resultRange = Worksheets(\"Sheet3\").Range(\"D1:D\" &amp; finalRow)\n    v = Trim(c.Value)\n    duplicate = false\n    for each result in resultRange\n        if v = result.Value then\n            duplicate = true\n            Exit For\n        end if\n    next\n\n    If Len(v) &gt; 0 and not duplicate then\n\n    ...\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 38486949, "answer_count": 1, "score": 0, "last_activity_date": 1469035685, "creation_date": 1469034571, "question_id": 38486727, "link": "https://stackoverflow.com/questions/38486727/vba-removing-duplicates-from-new-set", "title": "vba removing duplicates from new set", "body": "<p>The code below creates a new set of data on a new sheet but it takes everything that matches the requirements even if it is a duplicate. How can I change the code to eliminate duplicates in the new data set?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Sub Testerss()\r\n    Dim c As Range, v As String, arr, x As Long, e\r\n    Dim d As Range\r\n    Dim ws As Worksheet\r\n\r\n  \r\n    Set d = Worksheets(\"Sheet3\").Range(\"D1\")\r\n\r\n    For Each c In ActiveSheet.Range(\"D25:D105\")\r\n        v = Trim(c.Value)\r\n        If Len(v) &gt; 0 Then\r\n\r\n            v = Replace(v, vbLf, \" \")\r\n            \r\n            Do While InStr(v, \"  \") &gt; 0\r\n                v = Replace(v, \"  \", \" \")\r\n            Loop\r\n\r\n            \r\n            arr = Split(v, \" \")\r\n            For x = LBound(arr) To UBound(arr)\r\n                e = arr(x)\r\n                \r\n                If Not IsError(Application.Match(LCase(e), Array(\"(bye)\", \"(hello)\"), 0)) Then\r\n                    If x &gt; LBound(arr) Then\r\n                        d.Value = arr(x - 1) &amp; \" \" &amp; e\r\n                    Else\r\n                        d.Value = \"??? \" &amp; e\r\n                    End If\r\n                    Set d = d.Offset(1, 0)\r\n                End If\r\n            Next x\r\n        End If\r\n   Next c\r\nEnd Sub\u200b</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "collections"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469035940, "post_id": 38486638, "comment_id": 64376037, "body": "is your Class Name Module TimeRec ? is the first <code>Set RecSet1 = New TimeRec</code> working ?"}, {"owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469038037, "post_id": 38486638, "comment_id": 64377338, "body": "Yes - I have all the objects in the watch. RecSet1 and Record all have the correct types and Data in them."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "edited": false, "score": 0, "creation_date": 1469037765, "post_id": 38487104, "comment_id": 64377166, "body": "You are correct! I did Copy paste that example, so without the import I wouldn&#39;t have gotten the hidden settings. It is still giving me the same error though after Importing and changing the names accordingly."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "edited": false, "score": 0, "creation_date": 1469037934, "post_id": 38487104, "comment_id": 64377273, "body": "changing the names? Avoid making changes to this class in  VBE. make all the change in the notepad."}, {"owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "edited": false, "score": 0, "creation_date": 1469038257, "post_id": 38487104, "comment_id": 64377486, "body": "Correct - I changed the class2 refs you had back to TimeDet. I also set the VB_name to TimeRec, then imported the file."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1469042106, "post_id": 38487104, "comment_id": 64379698, "body": "FYI, I think this is the solution. Keep trying. It&#39;s also explained in Professional Excel Development."}, {"owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "edited": false, "score": 0, "creation_date": 1469044263, "post_id": 38487104, "comment_id": 64380920, "body": "Yes still getting error 438. Continuing to research. What is really getting to me is the error telling me that the object doesn&#39;t support the method or property. My instance of the TimeRec object supports the add method I have in there - so  the generic errors are confusing sometimes. As I said before the object I am attempting to add is of the same type as the add method is expecting."}, {"owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "edited": false, "score": 0, "creation_date": 1469044965, "post_id": 38487104, "comment_id": 64381300, "body": "I knew it would be something simple! uhg.... it was the parenthesis around the add!!!! I removed them and it works now."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1469035866, "creation_date": 1469035866, "answer_id": 38487104, "question_id": 38486638, "link": "https://stackoverflow.com/questions/38486638/adding-a-custom-class-collection-to-another-custom-class-collection/38487104#38487104", "title": "Adding a custom class collection to another custom class collection", "body": "<p>Your error is not at <code>Add</code> but at <code>For Each</code></p>\n\n<p>Most likely you copied your TimeRec Class. In VBA, you can't create enumerable classes inside the VBE (VBA IDE).  There's a different way of creating Enumerable classes.</p>\n\n<p>Open a notepad, copy all your class code and then add this attribute to <code>NewEnum</code> property <code>Attribute NewEnum.VB_UserMemId = -4</code></p>\n\n<p>Then import the class.</p>\n\n<p>This is always hidden in VBA code, but can be seen in text editors. \nAlso add this attribute to <code>Item</code> property, it will make it default and allows syntax like ClassName(1)</p>\n\n<p><code>Attribute Item.VB_UserMemId = 0</code></p>\n\n<p>So , your code in text editor/ notepad should be:</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"Class1\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\nPrivate objTimeRec As Collection\n\nPrivate Sub Class_Initialize()\n    Set objTimeRec = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set objTimeRec = Nothing\nEnd Sub\n\nPublic Property Get NewEnum() As IUnknown\nAttribute NewEnum.VB_UserMemId = -4\n    Set NewEnum = objTimeRec.[_NewEnum]\nEnd Property\n\nPublic Sub Add(obj As Class2)\n    objTimeRec.Add obj\nEnd Sub\n\nPublic Sub Remove(Index As Variant)\n    objTimeRec.Remove Index\nEnd Sub\n\nPublic Property Get Item(Index As Variant) As Class2\nAttribute Item.VB_UserMemId = 0\n    Set Item = objTimeRec.Item(Index)\nEnd Property\n\nProperty Get Count() As Long\n    Count = objTimeRec.Count\nEnd Property\n\nPublic Sub Clear()\n    Set objTimeRec = New Collection\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1469045238, "creation_date": 1469045238, "answer_id": 38489903, "question_id": 38486638, "link": "https://stackoverflow.com/questions/38486638/adding-a-custom-class-collection-to-another-custom-class-collection/38489903#38489903", "title": "Adding a custom class collection to another custom class collection", "body": "<p>The answer to this particular problem was to remove the parenthesis form my Add method. That being said, the attribute info being hidden was really good info and  would have probably contributed to the problem after I figured out that removing the parenthesis fixed it. </p>\n"}], "owner": {"reputation": 13, "user_id": 2849547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b10ce1bf26f37d4d12846971e0d1e0f?s=128&d=identicon&r=PG&f=1", "display_name": "Nyghtprowler", "link": "https://stackoverflow.com/users/2849547/nyghtprowler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 38487104, "answer_count": 2, "score": 1, "last_activity_date": 1469045238, "creation_date": 1469034261, "last_edit_date": 1531164843, "question_id": 38486638, "link": "https://stackoverflow.com/questions/38486638/adding-a-custom-class-collection-to-another-custom-class-collection", "title": "Adding a custom class collection to another custom class collection", "body": "<p>Ok to start off, I read through <a href=\"https://stackoverflow.com/questions/5116460/vba-how-to-add-a-collection-to-a-collection-of-collections\">this</a>.\nIt is close although it doesn't answer my specific question. This talks about taking smaller collections and adding items to a larger main collection. Then destroying the smaller collection. </p>\n\n<p>I have two definitions under Class Modules. </p>\n\n<p>TimeDet</p>\n\n<pre><code>Option Explicit\nPublic recDate As String\nPublic recQty As String\nPublic recDieNo As String\nPublic recCatID As String\nPublic recCatName As String\nPublic recGroupID As String\nPublic recGroupName As String    \n</code></pre>\n\n<p>TimeRec</p>\n\n<pre><code>Option Explicit\nPrivate objTimeRec As Collection\n\nPrivate Sub Class_Initialize()\n    Set objTimeRec = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set objTimeRec = Nothing\nEnd Sub\n\nPublic Property Get NewEnum() As IUnknown\n    Set NewEnum = objTimeRec.[_NewEnum]\nEnd Property\n\nPublic Sub Add(obj As TimeDet)\n    objTimeRec.Add obj\nEnd Sub\n\nPublic Sub Remove(Index As Variant)\n    objTimeRec.Remove Index\nEnd Sub\n\nPublic Property Get Item(Index As Variant) As TimeDet\n    Set Item = objTimeRec.Item(Index)\nEnd Property\n\nProperty Get Count() As Long\n    Count = objTimeRec.Count\nEnd Property\n\nPublic Sub Clear()\n    Set objTimeRec = New Collection\nEnd Sub\n\nPublic Sub FillFromArray(Arr As Variant)\n    Dim i As Long, obj As TimeDet\n    For i = 1 To UBound(Arr)\n        Set obj = New TimeDet\n        obj.recDate = Arr(i, 1)\n        obj.recQty = Arr(i, 2)\n        obj.recDieNo = Arr(i, 3)\n        obj.recCatID = Arr(i, 4)\n        obj.recCatName = Arr(i, 5)\n        obj.recGroupID = Arr(i, 6)\n        obj.recGroupName = Arr(i, 7)\n        Me.Add obj\n    Next\n\nEnd Sub    \n</code></pre>\n\n<p>Then in the code I am using it this way: </p>\n\n<pre><code>Sub Test()\nDim RecSet1 As TimeRec, Record As TimeDet\nDim fSet1 As TimeRec, fRecord As TimeDet\nDim repArray() As Variant\nDim startDT As Date, endDT As Date, dieNo As String\n\nrepArray() = Sheet4.Range(\"A2:G\" &amp; Sheet4.Range(\"A2\").End(xlDown).Row)\n\nSet RecSet1 = New TimeRec\nSet fSet1 = New TimeRec\n\nRecSet1.FillFromArray (repArray())\n\nstartDT = \"1-1-2015\"\nendDT = \"1-1-2016\"\ndieNo = \"16185\"\n\nFor Each Record In RecSet1\n    If Record.recDate &lt;= endDT And Record.recDate &gt;= startDT And Record.recDieNo = dieNo Then\n        fSet1.Add (Record)\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>I am getting an error when I try to add the Record object to the fSet1 object.\n\"Object doesn't support this method or property\"</p>\n\n<p>The Record object is Type TimeDet which as you can see up in the class module my Add method is expecting type TimeDet. </p>\n\n<p>Either I am  missing something very simple and have blinders on, or this is a bigger issue. </p>\n\n<p>The array has 200,000 records roughly. I am attempting to create a smaller subset of filtered data. Maybe I am approaching this from the wrong way.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1469382647, "last_edit_date": 1469382647, "creation_date": 1469353262, "answer_id": 38550652, "question_id": 38486629, "link": "https://stackoverflow.com/questions/38486629/outlook-macro-to-move-pdf-attachments-to-hard-drive/38550652#38550652", "title": "Outlook Macro to move PDF attachments to hard drive", "body": "<p>You don't need rule, try adding this to OutlookSession then restart your Outlook</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox  As Outlook.MAPIFolder\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    If TypeOf Item Is Outlook.MailItem Then\n        Save_PDF Item\n    End If\nEnd Sub\n\nPrivate Sub Save_PDF(ByVal Item As Object)\n    Dim Atmts As Outlook.Attachments\n    Dim intCount As Long\n    Dim sFileName As String\n    Dim i As Long\n    Dim sDate As String\n    Dim Frmt_Date As String\n    Dim FolderPath As String\n\n    If Item.Attachments.Count &gt; 0 Then\n        Set Atmts = Item.Attachments\n        intCount = Atmts.Count\n\n        For i = intCount To 1 Step -1\n\n            If intCount &gt; 0 Then\n                sDate = Item.SentOn\n                Frmt_Date = Format(sDate, \"yyyymmdd\", vbUseSystemDayOfWeek, vbUseSystem)\n\n                ' Get the file name.\n                sFileName = Atmts.Item(i).FileName\n\n                If LCase(Right(sFileName, 4)) = \".pdf\" Then\n\n                    ' Get the path to your My Documents folder\n                    FolderPath = Environ(\"USERPROFILE\") &amp; \"\\Documents\\1 Inbox\\\"\n\n                    ' Combine with the FolderPath and FileName_DateSentOn\n                    sFileName = FolderPath &amp; Frmt_Date &amp; \"_\" &amp; sFileName\n\n                    ' Save the attachment as a file.\n                    Atmts.Item(i).SaveAsFile sFileName\n\n                End If\n            End If\n        Next i\n    End If\n\n    Set Items = Nothing\n    Set Atmts = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6614812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89c6c00e14ad01bdd35431b11180585?s=128&d=identicon&r=PG&f=1", "display_name": "Jeanette C", "link": "https://stackoverflow.com/users/6614812/jeanette-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593217349, "creation_date": 1469034238, "last_edit_date": 1593217349, "question_id": 38486629, "link": "https://stackoverflow.com/questions/38486629/outlook-macro-to-move-pdf-attachments-to-hard-drive", "title": "Outlook Macro to move PDF attachments to hard drive", "body": "<p>My goal is: on incoming email, move any PDF attachments to a hard drive folder with the date appended to the end of it.  </p>\n\n<p>I had a macro running with a rule, but the rule constantly errors and turns off,  So I am going to put it in This Outlook Session.  </p>\n\n<p>I modified this macro that I found to do what I need, however it is giving me the compile error: Next without For.  </p>\n\n<p>Thank you for your assistance on this.</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents olInboxItems As Items\n\nPrivate Sub Application_Startup()\nDim objNS As NameSpace\nSet objNS = Application.Session\n' instantiate objects declared WithEvents\nSet olInboxItems = objNS.GetDefaultFolder(olFolderInbox).Items\nSet objNS = Nothing\nEnd Sub\n\nPrivate Sub olInboxItems_ItemAdd(ByVal Item As Object)\nOn Error Resume Next\nIf Item.Attachments.Count &gt; 0 Then\n\nDim objAttachments As Outlook.Attachments\nDim lngCount As Long\nDim strFile As String\nDim sFileType As String\nDim i As Long\nDim dtDate As Date\nDim sName As String\nDim objMsg As Outlook.MailItem\nDim lcount As Integer\nDim pre As String\nDim ext As String\nDim strFolderpath As String\n\nSet objAttachments = Item.Attachments\nlngCount = objAttachments.Count\nFor i = lngCount To 1 Step -1\n\nIf lngCount &gt; 0 Then\n\ndtDate = objMsg.SentOn\n\nsName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, vbUseSystem)\n\n' Get the file name.\nstrFile = sName &amp; objAttachments.Item(i).FileName\n\nIf LCase(Right(strFile, 4)) = \".pdf\" Then\n\nlcount = InStrRev(strFile, \".\") - 1\npre = Left(strFile, lcount)\next = Right(strFile, Len(strFile) - lcount)\n\n' Combine with the path to make the final path\nstrFile = strFolderpath &amp; pre &amp; \"_\" &amp; sName &amp; ext\n\n' Get the path to your My Documents folder\nstrFolderpath = CreateObject(\"WScript.Shell\").ExpandEnvironmentStrings(\"%USERPROFILE%\")\nstrFolderpath = strFolderpath &amp; \"\\1 Inbox\\\"\n\n' Combine with the path to the folder.\nstrFile = strFolderpath &amp; strFile\n\n' Save the attachment as a file.\nobjAttachments.Item(i).SaveAsFile strFile\n\nNext i\nEnd If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1469088832, "post_id": 38486318, "comment_id": 64397011, "body": "Have you tried running this from key presses rather than the change event of the combo box?"}], "answers": [{"tags": [], "owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "is_accepted": false, "score": 1, "last_activity_date": 1469162314, "creation_date": 1469162314, "answer_id": 38518265, "question_id": 38486318, "link": "https://stackoverflow.com/questions/38486318/prevent-combo-box-selection-to-change-text/38518265#38518265", "title": "Prevent combo box selection to change text", "body": "<p>You could probably overcome this problem by testing whether the listindex is greater than -1 at the start of your event handler, and exiting if it is, eg:</p>\n\n<pre><code>Private Sub ItemName_Change()\n    If ItemName.ListIndex &gt; -1 Then\n        Exit sub\n    End if\n\n    ...\nEnd Sub\n</code></pre>\n\n<p>I think though that there is a good chance that you would be better off not using a combobox at all, but mimicking it's functionality with (a) a textbox (into which the text is entered, and which fires the change event you've written) &amp; (b) a listbox, which displays the results of the search - then when the user selects an item, this action is disassociated from the entry control.</p>\n"}], "owner": {"reputation": 631, "user_id": 2335882, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/efaefa7c78ed4256e418e14c03e7dd41?s=128&d=identicon&r=PG", "display_name": "Jap", "link": "https://stackoverflow.com/users/2335882/jap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594641704, "creation_date": 1469033207, "last_edit_date": 1594641704, "question_id": 38486318, "link": "https://stackoverflow.com/questions/38486318/prevent-combo-box-selection-to-change-text", "title": "Prevent combo box selection to change text", "body": "<p>I am building a search as you type combo box. The search and update uses the change event. </p>\n\n<pre><code>Private Sub ItemName_Change()\n\nDim strText, strFind, strSQL, strSelect, strWhere, strOrderBy As String\nstrText = Me.ItemName.Text\n\nstrSelect = \"SELECT DISTINCT [ItemName] FROM ItemsMaster \"\nstrWhere = \"WHERE type = 'Sold Goods' \"\nstrOrderBy = \" ORDER BY [ItemName];\"\nIf (Len(Trim(strText)) &gt; 0) Then\n    'Show the list with only those items containing the types letters\n    strFind = \"ItemsMaster.ItemName Like '\"\n    For i = 1 To Len(Trim(strText))\n        If (Right(strFind, 1) = \"*\") Then\n            strFind = Left(strFind, Len(strFind) - 1)\n        End If\n        strFind = strFind &amp; \"*\" &amp; Mid(strText, i, 1) &amp; \"*\"\n    Next\n\n    strFind = strFind &amp; \"'\"\n    strSQL = strSelect &amp; strWhere &amp; \"AND \" &amp; strFind &amp; strOrderBy\n\n    Me.ItemName.RowSource = strSQL\n\nElse\n    strSQL = strSelect &amp; strWhere &amp; strOrderBy\n    Me.ItemName.RowSource = strSQL\nEnd If\n\nMe.ItemName.Dropdown\n\n\nEnd Sub\n</code></pre>\n\n<p>But When I try to select the items from the drop-down list, it updates the text and fires the change event. \nIs there any way the user can scroll through the list without combo box changing the text in the text box?</p>\n"}, {"tags": ["vba", "excel", "user-defined"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1469032780, "post_id": 38486146, "comment_id": 64374228, "body": "All your Dim statements are in error.  The As part needs to be <code>As Workbook</code>"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1469032940, "post_id": 38486146, "comment_id": 64374326, "body": "What is a <code>workbook_both</code>?  Have you not defined that anywhere?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469032944, "post_id": 38486146, "comment_id": 64374331, "body": "Also I believe you are going to need to add the full file path and name to the Open lines."}, {"owner": {"reputation": 1, "user_id": 6614719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39215ddd4b0eaa0b264ef155e2f837fb?s=128&d=identicon&r=PG&f=1", "display_name": "EJO", "link": "https://stackoverflow.com/users/6614719/ejo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1469033555, "post_id": 38486146, "comment_id": 64374668, "body": "@ScottCraner I see what you mean. I was mistaken and misread the naming syntax. The files open now but they do not paste into the file. I get &quot;Run-time error &#39;91&#39;: Object variable or With block variable not set."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469036215, "post_id": 38486146, "comment_id": 64376207, "body": "@EJO you need to add your workbook path, like <code>Dim wb_path as String</code> , and then for example use <code>wb_path = &quot;\\\\C:\\&quot;</code>"}], "owner": {"reputation": 1, "user_id": 6614719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39215ddd4b0eaa0b264ef155e2f837fb?s=128&d=identicon&r=PG&f=1", "display_name": "EJO", "link": "https://stackoverflow.com/users/6614719/ejo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469032683, "creation_date": 1469032683, "question_id": 38486146, "link": "https://stackoverflow.com/questions/38486146/first-line-of-code-user-defined-type-not-defined", "title": "First Line of Code: User-defined type not defined", "body": "<p>I am a very new user and am trying to open up three workbooks and copy the same cell range of the three books to three different ranges in a fourth book. </p>\n\n<p>I have done a good amount of troubleshooting but I cannot find anything to help fix this. </p>\n\n<p>The problem points to Sub WeeklyLeagues()</p>\n\n<pre><code>Option Explicit\n\n    Sub WeeklyLeagues()\n\n    Dim x_both As workbook_both\n    Dim x_sf As workbook_sf\n    Dim x_mf As workbook_mf\n    Dim y As workbook_final\n\n    Set x_both = Workbooks.Open(\"Sheet1 Path\")\n    Set x_sf = Workbooks.Open(\"Sheet2 Path\")\n    Set x_sf = Workbooks.Open(\"Sheet3 Path\")\n    Set y = Workbooks.Open(\"Sheet4 Path\")\n\n    x_both.Sheets(\"Request 4 Rank 1\").Range(\"A2:E18\").Copy\n    y.Sheets(\"Source\").Range(\"M2:Q18\").PasteSpecial\n\n    x_sf.Sheets(\"Request 4 Rank 1\").Range(\"A2:E18\").Copy\n    y.Sheets(\"Source\").Range(\"A2:E18\").PasteSpecial\n\n    x_mf.Sheets(\"Request 4 Rank 1\").Range(\"A2:E18\").Copy\n    y.Sheets(\"Source\").Range(\"G2:k18\").PasteSpecial\n\n    'Close x:\n    x_both.Close\n    x_sf.Close\n    x_mf.Close\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 0, "last_activity_date": 1469032844, "creation_date": 1469032844, "answer_id": 38486202, "question_id": 38486089, "link": "https://stackoverflow.com/questions/38486089/vba-to-insert-into-macro-to-choose-the-save-path-for-exporting-files/38486202#38486202", "title": "VBA to insert into macro to choose the save path for exporting files", "body": "<p>See the example code to launch path selection UI.</p>\n\n<pre><code>Sub test()\n    Dim strFolder As String\n\n    strFolder = GetFolder(\"C:\\temp\\\")\n\n    '/ Opens in that folder\n    'strFolder = GetFolder(\"C:\\temp\\\")\n\n    If strFolder &lt;&gt; \"\" Then\n\n        MsgBox strFolder\n\n    End If\n\nEnd Sub\n\n\nFunction GetFolder(Optional strPath As String = \"\") As String\n\n    Dim fldr As FileDialog\n    Dim sItem As String\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With fldr\n        .Title = \"Select Output Report Location\"\n        .AllowMultiSelect = False\n        If strPath &lt;&gt; \"\" Then\n            .InitialFileName = strPath\n        End If\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\n\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1469097539, "post_id": 38486210, "comment_id": 64402816, "body": "Sorry I should have been more specific, I was actually after the dialog box to pop up where you navigate to the filepath. But your input box has helped me with something else i was struggling with so thank you!"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1469107931, "post_id": 38486210, "comment_id": 64409702, "body": "No prob :D you did write select, I guess I just didn&#39;t read enough into it ;)"}], "tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": false, "score": 0, "last_activity_date": 1469032865, "creation_date": 1469032865, "answer_id": 38486210, "question_id": 38486089, "link": "https://stackoverflow.com/questions/38486089/vba-to-insert-into-macro-to-choose-the-save-path-for-exporting-files/38486210#38486210", "title": "VBA to insert into macro to choose the save path for exporting files", "body": "<p>you can use an inputbox to accomplish this:</p>\n\n<pre><code>Sub Exporttotext()\nDim c As Range, r As Range\nDim output As String\nDim lngcount As Long\nDim WS As Worksheet\nDim Name As String\nDim sSharedPath As String\n    sSharedPath = InputBox(\"What is the path\", \"Destination\", \"\\\\MyPath\\\")\n    For Each sh In ThisWorkbook.Worksheets\n        output = \"\"\n        For Each r In sh.Range(\"O2:O500\").Rows\n            For Each c In r.Cells\n                output = output &amp; c.Value\n            Next c\n            output = output &amp; vbNewLine\n        Next r\n        Name = sh.Name\n        Open sSharedPath &amp; Name &amp; \".txt\" For Output As #1\n        Print #1, output\n        Close\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "accepted_answer_id": 38486202, "answer_count": 2, "score": 0, "last_activity_date": 1469032865, "creation_date": 1469032504, "question_id": 38486089, "link": "https://stackoverflow.com/questions/38486089/vba-to-insert-into-macro-to-choose-the-save-path-for-exporting-files", "title": "VBA to insert into macro to choose the save path for exporting files", "body": "<p>I have a workbook without about 30 or so sheets and i've got a macro to save a selection from each sheet as a text file. My code is below and currently just has C:\\data as the path. What i want to do is have a bit before the 'for each' loop that prompts the user to select the save path (a team drive) and then the loop carries through and exports all the files to that path. Can anyone help me?</p>\n\n<p>Thanks, Rich</p>\n\n<pre><code>Sub Exporttotext()\nDim c As Range, r As Range\nDim output As String\nDim lngcount As Long\nDim WS As Worksheet\nDim Name As String\nFor Each sh In ThisWorkbook.Worksheets\n    output = \"\"\n    For Each r In sh.Range(\"O2:O500\").Rows\n        For Each c In r.Cells\n         output = output &amp; c.Value\n        Next c\n        output = output &amp; vbNewLine\n    Next r\n    Name = sh.Name\n    Open \"C:\\data\\\" &amp; Name &amp; \".txt\" For Output As #1\n    Print #1, output\n    Close\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "ms-access"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469032484, "post_id": 38485958, "comment_id": 64374076, "body": "is  it <code>ComVisible</code>?"}, {"owner": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469032758, "post_id": 38485958, "comment_id": 64374218, "body": "@cyboashu where would I put that line ( [ComVisibleAttribute(true)] )?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469032936, "post_id": 38485958, "comment_id": 64374323, "body": "before dll&#39;s entry point (the main/root class of dll) see this : <a href=\"http://stackoverflow.com/questions/7092553/turn-a-simple-c-sharp-dll-into-a-com-interop-component\" title=\"turn a simple c sharp dll into a com interop component\">stackoverflow.com/questions/7092553/&hellip;</a>"}, {"owner": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469037420, "post_id": 38485958, "comment_id": 64376940, "body": "@cyboashu , yes i have &quot;Make assembly COM-Visible&quot; enabled"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469037492, "post_id": 38485958, "comment_id": 64376990, "body": "what is the regasm syntax that you are using to register?"}, {"owner": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1469038455, "post_id": 38485958, "comment_id": 64377608, "body": "@cyboashu I did that part yesterday, but if I remember correctly it was: &quot; &quot;regasm.exe Login_Test.dll /tlb:Login_Test.tlb&quot; I copied the dll and tlb to Syswow64 folder. Then it says ...something successful. I used tutorial: <a href=\"http://www.geeksengine.com/article/register-dll.html\" rel=\"nofollow noreferrer\">geeksengine.com/article/register-dll.html</a>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "edited": false, "score": 0, "creation_date": 1469039480, "post_id": 38485958, "comment_id": 64378197, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/117842/discussion-between-cyboashu-and-nate\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1469038899, "creation_date": 1469038899, "answer_id": 38488050, "question_id": 38485958, "link": "https://stackoverflow.com/questions/38485958/open-a-c-form-dll-with-vba-access-2010/38488050#38488050", "title": "Open a C# form (.dll) with VBA (Access 2010)", "body": "<p>Launch developer command prompt in Admin mode, run this synatx:</p>\n\n<p><code>regasm.exe Login_Test.dll /tlb /CodeBase</code></p>\n\n<p>You can keep Login_test.dll anywhere, just provide the full path in command. </p>\n"}], "owner": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 38488050, "answer_count": 1, "score": 0, "last_activity_date": 1593958232, "creation_date": 1469032063, "last_edit_date": 1593958232, "question_id": 38485958, "link": "https://stackoverflow.com/questions/38485958/open-a-c-form-dll-with-vba-access-2010", "title": "Open a C# form (.dll) with VBA (Access 2010)", "body": "<p>I have a simple \"login\" screen in C# where the user will press Login and another window pops up saying welcome and is working when I build/run on Visual Studio.</p>\n\n<p>Here is the code</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace Login_Test\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            MessageBox.Show(\"Welcome\");\n            this.Close();\n        }\n    }\n}\n</code></pre>\n\n<p>I also have a VBA form (Access 2010) where a user will click a button, then the C# form should pop up and in the future, instead of saying \"welcome\" it will redirect to a different form in Access.</p>\n\n<p>Here is the code for the VBA button:</p>\n\n<pre><code>Private Sub Command284_Click()\n    Dim objLog As Login_Test.Form1\n    Set objLog = New Login_Test.Form1\nEnd Sub\n</code></pre>\n\n<p>I have made the .dll, .tlb, used regasm on it, and referenced it on Access. </p>\n\n<p>I get: \"runtime error 429 activex component can't create object\" when pressing the button.</p>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469032153, "post_id": 38485818, "comment_id": 64373907, "body": "Would <a href=\"https://www.deskbright.com/excel/index-match-multiple-criteria/\" rel=\"nofollow noreferrer\"><code>Index&#47;Match</code> with multiple criteria</a> work?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1469032253, "post_id": 38485818, "comment_id": 64373963, "body": "Create disconnected recordset, populate it with values from the range, apply filter, and get resulting records from recordset. Here is the <a href=\"http://stackoverflow.com/a/36189658/2165759\">example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 6494858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAxGo.jpg?s=128&g=1", "display_name": "BigElittles", "link": "https://stackoverflow.com/users/6494858/bigelittles"}, "is_accepted": false, "score": 0, "last_activity_date": 1469041528, "creation_date": 1469041528, "answer_id": 38488871, "question_id": 38485818, "link": "https://stackoverflow.com/questions/38485818/matching-information-in-worksheet/38488871#38488871", "title": "Matching information in worksheet", "body": "<pre><code>Sub FINDSAL()\n'looking for the specific word'\nDim E_name As String\nE_name = Worksheets(\"Sheet1\").Range(\"C5\").Value\nif instr(ename,Sheet3.Range(\"c4:h41\")) &gt; 0 then\n  msgbox Ename &amp; \" was found in the range. All range text is \" &amp;     Sheet3.Range(\"c4:h41\") \nmsgbox \"Set sal as whatever you're trying to get out of this...\"\nend if\nMsgBox sal\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 27, "user_id": 6451989, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/1194554033890217/picture?type=large", "display_name": "Nick Norwood", "link": "https://stackoverflow.com/users/6451989/nick-norwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499450307, "creation_date": 1469031637, "last_edit_date": 1499450307, "question_id": 38485818, "link": "https://stackoverflow.com/questions/38485818/matching-information-in-worksheet", "title": "Matching information in worksheet", "body": "<p>Users input specific information on (Sheet1) that is Workflow, server, where, start time, dependency and execution time.</p>\n\n<p>I have a chart that has those names in headers.</p>\n\n<p>I need to look for the information the user put in. I have tried using <code>VLookup</code> but that only works for one criteria. Is there something else I could use?</p>\n\n<p>This is my code: </p>\n\n<pre><code>Sub Button2_Click()\n    'Copy the ticket number'\n    Worksheets(\"Sheet1\").Range(\"c3\").Copy _\n      Destination:=Worksheets(\"Sheet3\").Range(\"b2\")\n    Call CopyTable\n    Call FINDSAL\nEnd Sub\n\nSub CopyTable()\n    '\n    ' CopyTable Macro to sheet 3\n    '\n    Sheets(\"Sheet2\").Select\n    Range(\"D1:I38\").Select\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    Range(\"C4\").Select\n    ActiveSheet.Paste\n    Columns(\"C:C\").EntireColumn.AutoFit\n    Columns(\"D:D\").EntireColumn.AutoFit\n    Columns(\"E:E\").EntireColumn.AutoFit\n    Columns(\"F:F\").EntireColumn.AutoFit\n    Columns(\"G:G\").EntireColumn.AutoFit\n    Columns(\"H:H\").EntireColumn.AutoFit\n    ActiveWindow.SmallScroll Down:=12\nEnd Sub\n\nSub FINDSAL()\n    'looking for the specific word'\n    Dim E_name As String\n    E_name = Worksheets(\"Sheet1\").Range(\"C5\").Value\n    sal = Application.WorksheetFunction.VLookup(E_name, Sheet3.Range(\"c4:h41\"), 1, False)\n    MsgBox sal\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469034461, "post_id": 38485807, "comment_id": 64375226, "body": "You&#39;re not going to be able to do this directly inside RowSource property. You could do it with VBA in a loop inside the Form_Load event that goes thru all your combobox controls with Tag&lt;&gt;&quot;&quot;. The syntax would need to be changed to <code>WHERE DropdownCategory=&quot;&quot;&quot; &amp; ctl.Tag &amp; &quot;&quot;&quot;&quot;</code> - given that ctl is defined in your loop."}, {"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1469043614, "post_id": 38485807, "comment_id": 64380531, "body": "@dbmitch Ah, somehow I&#39;m not surprised Access doesn&#39;t have an easy way to do this in one step."}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1469034976, "creation_date": 1469034976, "answer_id": 38486862, "question_id": 38485807, "link": "https://stackoverflow.com/questions/38485807/access-2013-refer-to-a-comboboxs-own-tag-in-its-rowsource/38486862#38486862", "title": "Access 2013 refer to a combobox&#39;s own tag in its rowsource", "body": "<p>Here's example of what I suggested.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Form_Load()\n\n    Const DROPDOWN_SQL  As String = \"SELECT DropdownNames FROM Table WHERE DropdownCategory = \"\n    Const DOUBLE_QUOTES As String = \"\"\"\"\n\n    Dim ctl             As Control\n    Dim strRowsource    As String\n\n    For Each ctl In Me.Controls\n        With ctl\n            ' Only look at Tagged Combo Boxes\n            If (.ControlType = acComboBox) And (.Tag &lt;&gt; \"\") Then\n                ' Set Dropdown Row Source\n                strRowsource = DROPDOWN_SQL &amp; DOUBLE_QUOTES &amp; .Tag &amp; DOUBLE_QUOTES\n                .RowSource = strRowsource\n            End If\n        End With\n    Next\n\n    Set ctl = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 38486862, "answer_count": 1, "score": 0, "last_activity_date": 1469034976, "creation_date": 1469031609, "question_id": 38485807, "link": "https://stackoverflow.com/questions/38485807/access-2013-refer-to-a-comboboxs-own-tag-in-its-rowsource", "title": "Access 2013 refer to a combobox&#39;s own tag in its rowsource", "body": "<p>I have some comboboxes on a form and I'd like each box's <code>RowSource</code> to refer to the tag I set. The tag will filter the appropriate dropdown options from a table.</p>\n\n<pre><code>SELECT DropdownNames\nFROM Table\nWHERE DropdownCategory=[Screen].[ActiveForm]![Me].[Tag]\n</code></pre>\n\n<p>What is the correct syntax? Is using the tag the best way to do this or is there a better property for this purpose?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3171, "user_id": 196852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33fdb4f51213d3eccb426cf4a4427d85?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/196852/chris"}, "edited": false, "score": 0, "creation_date": 1469118402, "post_id": 38485773, "comment_id": 64416951, "body": "The problem you have is a bit too broad to answer. Start with smaller pieces of your feature and use google to find starting points."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6614541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6148b6d33a9cad275b3efe4ff65a1a66?s=128&d=identicon&r=PG&f=1", "display_name": "AliciaW", "link": "https://stackoverflow.com/users/6614541/aliciaw"}, "is_accepted": true, "score": 0, "last_activity_date": 1470259037, "creation_date": 1470259037, "answer_id": 38753800, "question_id": 38485773, "link": "https://stackoverflow.com/questions/38485773/word-vba-adding-a-page-in-a-password-protected-document-with-a-button/38753800#38753800", "title": "Word VBA - adding a page in a password-protected document with a button", "body": "<p>After many days of cursing and trawling forums, I came up with this solution, and decided to leave it here in case someone else is interested in this for their own project:</p>\n\n<p>Private Sub PhotoPageTrigger_Click()</p>\n\n<p>' PhotoPage Macro</p>\n\n<pre><code>ActiveDocument.Unprotect Password:=\"password\" 'unprotect the document with the password\n\nSelection.GoTo What:=wdGoToBookmark, Name:=\"\\EndofDoc\" 'move cursor to the end of the last page\n\nSelection.TypeParagraph 'insert new paragraph to make a new page\n\nSelection.Font.Size = 12 'make the new page have a text size of 12\n\nChangeFileOpenDirectory _\n    \"I:\\FileLocation\\\" 'Go to this file location\n\nDocuments.Open FileName:= _\n    \"I:\\FileLocation\\Form Picture Template.docm\" _\n    , ConfirmConversions:=False, ReadOnly:=False, AddToRecentFiles:=False, _\n    PasswordDocument:=\"\", PasswordTemplate:=\"\", Revert:=False, _\n    WritePasswordDocument:=\"\", WritePasswordTemplate:=\"\", Format:= _\n    wdOpenFormatAuto, XMLTransform:=\"\" 'Open this template document and read with these settings\n\nSelection.GoTo What:=wdGoToBookmark, Name:=\"\\StartofDoc\" 'move cursor to the beginning of the document\n\nSelection.WholeStory 'select all\n\nSelection.Copy 'copy all\n\nSelection.GoTo What:=wdGoToBookmark, Name:=\"\\EndofDoc\" 'move cursor to home place at the end of the document\n\nActiveDocument.Close 'close the open template doc\n\nSelection.PasteAndFormat (wdUseDestinationStylesRecovery) 'paste contents of clipboard to now-active form doc at the cursor location\n\nDim oData   As New DataObject 'object to use the clipboard\n\noData.SetText Text:=Empty 'Clear the clipboard\noData.PutInClipboard\n\nActiveDocument.Protect Password:=\"password\", NoReset:=False, Type:= _\n    wdAllowOnlyReading, UseIRM:=False, EnforceStyleLock:=True 'reprotect document with password and these settings\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Pretty happy to have made it work all on my own! :)</p>\n"}], "owner": {"reputation": 1, "user_id": 6614541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6148b6d33a9cad275b3efe4ff65a1a66?s=128&d=identicon&r=PG&f=1", "display_name": "AliciaW", "link": "https://stackoverflow.com/users/6614541/aliciaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 1, "accepted_answer_id": 38753800, "answer_count": 1, "score": 0, "last_activity_date": 1470259037, "creation_date": 1469031503, "last_edit_date": 1469032309, "question_id": 38485773, "link": "https://stackoverflow.com/questions/38485773/word-vba-adding-a-page-in-a-password-protected-document-with-a-button", "title": "Word VBA - adding a page in a password-protected document with a button", "body": "<p>I edit and create word-document forms for an energy company. Field personnel will be opening these forms on a windows tablet in the field. We use Microsoft Word 2010. I have used the developer tab to add check-boxes and date pickers, and other functions to make the filling in of these forms quicker and easier on a tablet - but we have a few needs that will need to be coded.</p>\n\n<p>-The forms are password protected, with only certain fields available for the end user to edit.</p>\n\n<p>-My boss would like the user to have the option to add an additional page to the document with the click of a button, preferably on the form itself, but still have the form be password protected. He would like this additional page to be for adding photos of the work they are performing and checking for quality. He would like them to be able to add as many pages of photos as they need (I thought we could \"call\" a specific template with a button, add the button to the bottom of the page, and as they fill a page in, they could click the button on the template, and repeat the process).</p>\n\n<p>-I have created a template page for this additional page, which is also password-protected, and has two of the \"insert picture\" fields from the developer tab, and a 1x1 table beneath each for description of the picture.</p>\n\n<p>I really do want to learn VBA, and would rather not just copy and paste someone else's code. I want to understand why it works and build on it, as needed. </p>\n\n<p>I have coded in html, css, and javascript (the basics).</p>\n"}, {"tags": ["excel", "module", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469031173, "post_id": 38485513, "comment_id": 64373338, "body": "Please post your code.  Without it, it&#39;s hard to say what could be causing it, it could be many different things.  Likely, it&#39;s making explicit references to sheets/macros that aren&#39;t in your new one."}, {"owner": {"reputation": 1, "user_id": 6614602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NoQSgvCH61w/AAAAAAAAAAI/AAAAAAAAAHI/K3c-06V4xd8/photo.jpg?sz=128", "display_name": "Andrew Lowis", "link": "https://stackoverflow.com/users/6614602/andrew-lowis"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469031427, "post_id": 38485513, "comment_id": 64373489, "body": "Sub Client() &#39; &#39; Client Macro &#39;  &#39;          Range(&quot;Table28[#All]&quot;).AdvancedFilter Action:=xlFilterInPlace, CriteriaRange _         :=Range(&quot;Table26[[#All],[Corto Plazo]]&quot;), Unique:=False          ActiveSheet.ShowAllData           Range(&quot;B3&quot;).Select     Range(Selection, Selection.End(xlToRight)).Select     Range(Selection, Selection.End(xlDown)).Select     Selection.ClearContents     Range(&quot;B3&quot;).Select          Workbooks.Open (&quot;F:\\Advisory\\AAA Ficheros de Propuesta\\Master Files\\Propuesta Integral - Master File\\Datos de Cliente\\Positions.xlsm&quot;)"}, {"owner": {"reputation": 1, "user_id": 6614602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NoQSgvCH61w/AAAAAAAAAAI/AAAAAAAAAHI/K3c-06V4xd8/photo.jpg?sz=128", "display_name": "Andrew Lowis", "link": "https://stackoverflow.com/users/6614602/andrew-lowis"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469031453, "post_id": 38485513, "comment_id": 64373504, "body": "Sheets(&quot;E.SC.POS.ASSET.BS&quot;).Select     Range(&quot;F1&quot;).Select     Selection.AutoFilter     ActiveSheet.Range(&quot;$A$1:$AX$60123&quot;).AutoFilter field:=6, Criteria1:= _         Worksheets(&quot;Sheet1&quot;).Range(&quot;C2&quot;), Operator:=xlAnd     Range(&quot;AY1&quot;).Select     Range(Selection, Selection.End(xlDown)).Select     Selection.Copy     Windows(&quot;Propuesta Global - Template (Nuevo Formato).xlsm&quot;).Activate     Range(&quot;B3&quot;).Select     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _         :=False, Transpose:=False"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469031773, "post_id": 38485513, "comment_id": 64373689, "body": "Can you please edit that into your OP, and mark with the code tags (<code>{}</code>)? It&#39;s hard to read via comments.  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 6560622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3f702f95eb8dbff9c4e75931e01b0c?s=128&d=identicon&r=PG&f=1", "display_name": "thentt", "link": "https://stackoverflow.com/users/6560622/thentt"}, "is_accepted": false, "score": 0, "last_activity_date": 1469032640, "last_edit_date": 1469032640, "creation_date": 1469032118, "answer_id": 38485977, "question_id": 38485513, "link": "https://stackoverflow.com/questions/38485513/macro-doesnt-work-when-copied-into-another-workbook/38485977#38485977", "title": "Macro doesn&#39;t work when copied into another workbook", "body": "<p>Depending on the macro and how it is programmed.\nIf the macro use absolute paths like the place where the file is locate you need to change the macro. </p>\n\n<p>You can programm macro in different styles. To use it for different workbooks you can programm it with the ActiveWorkbook object. So if you open a workbook and start it, it will use the active one. You can even use it when you open the file with the macro and then change to a other workbook, because then that workbook is the active one. </p>\n\n<p>You need to look at the macro how it is programmed. Like you said, if you close all workbooks, copy the file, start the new file and it still reference the old one then there should be a absolute path in the macro code.</p>\n\n<p>Open the macro with the macroeditor and look for something like this:</p>\n\n<pre><code>Dim WB As Workbook\n</code></pre>\n\n<p>WB is an Variable here so it can be any other name, too. For the example I go here with the WB. When you found the workbook variable look for some like this:</p>\n\n<pre><code>Set WB = Workbooks.Open(\"c:\\somewhere\\file.xlsm\")\n</code></pre>\n\n<p>There you need to place the path with the new location or change it to </p>\n\n<pre><code>Set WB = ActiveWorkbook\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Set WB = ThisWorkbook\n</code></pre>\n\n<p>The different between this two is just that ActiveWorkbook always use the active one, so can use it for more then one workbook without the need to import it to the new file . If you choose ThisWorkbook the marco will always reference the Workbook with the macro belongs, too.</p>\n\n<p>I hope that is what you needed. </p>\n\n<p><strong>EDIT</strong>\nAfter reading the unformated code, there you go:</p>\n\n<pre><code>    Workbooks.Open (\"F:\\Advisory\\AAA Ficheros de Propuesta\\Master Files\\Propuesta Integral - Master File\\Datos de Cliente\\Positions.xlsm\")\n</code></pre>\n\n<p>That might be the problem </p>\n"}], "owner": {"reputation": 1, "user_id": 6614602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NoQSgvCH61w/AAAAAAAAAAI/AAAAAAAAAHI/K3c-06V4xd8/photo.jpg?sz=128", "display_name": "Andrew Lowis", "link": "https://stackoverflow.com/users/6614602/andrew-lowis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469032640, "creation_date": 1469030690, "last_edit_date": 1531161705, "question_id": 38485513, "link": "https://stackoverflow.com/questions/38485513/macro-doesnt-work-when-copied-into-another-workbook", "title": "Macro doesn&#39;t work when copied into another workbook", "body": "<p>I had to make an exact copy of a workbook in order to translate it, and the macros do not work because its source is the original workbook (according to the debugger). How can I make these macros work in the new workbook? can I change the macro code in the new workbook?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1469031598, "post_id": 38485405, "comment_id": 64373580, "body": "You can construct the <code>COUNTIFS()</code> as a string formula, but instead of inserting it to the worksheet, use the <code>Worksheet.Evaluate()</code> method to execute it."}, {"owner": {"reputation": 23, "user_id": 6605506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36cbdeec1f4352b598c27bb8b007333?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy", "link": "https://stackoverflow.com/users/6605506/timothy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469041701, "post_id": 38485405, "comment_id": 64379468, "body": "I assume you meant <code>SUMIFS()</code>. That should work. In testing this, I noticed that  if I use this code: &#39;OutString = &quot;SumIfs(Sheet1!C:C,Sheet1!A:A,&quot;&quot;A&quot;&quot;)&quot;     OutSh.Cells(1, 1) = Evaluate(OutString)     OutSh.Cells(2, 1) = [OutString]` I get different output. The first is a number the second is a string. I can use the first, but was wondering why there is a difference."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1469043652, "post_id": 38485405, "comment_id": 64380551, "body": "There are two different methods: <code>Application.Evaluate</code> (the default if you don&#39;t specify otherwise) evaluates in the context of the ActiveSheet: I would advise <i>not</i> using that method.  Typically the one you want is <code>Worksheet.Evaluate</code>.  For example  <code>Sheet1.Evaluate(...)</code> will evaluate the formula in the context of <code>Sheet1</code>, regardless of whether that sheet is active."}], "owner": {"reputation": 23, "user_id": 6605506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36cbdeec1f4352b598c27bb8b007333?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy", "link": "https://stackoverflow.com/users/6605506/timothy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 589, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1469030411, "creation_date": 1469030411, "question_id": 38485405, "link": "https://stackoverflow.com/questions/38485405/sumifs-with-variable-number-of-criteria", "title": "Sumifs with Variable number of Criteria", "body": "<p>I'm working on a project to automate some reports. The requirements are to summary tables at differing levels (Country, Region, Salesperson, Product for example) that are nested. The number of levels will differ depending on the user and client. What I am struggling with is how to VBA to build sumifs where the number of parameters will not be known until the code is run.</p>\n\n<pre><code>Dim i as Long\nDim InSh As Object\nDim OutSh As Object\nSet InSh = Workbooks(\"Readin\").Worksheets(\"Sheet1\")\nSet OutSh = Workbooks(\"Output\").Worksheets(\"Sheet1\")\n\nfor(i in 2 to n)\nOutSh.Cells(i, 1) = Application.WorksheetFunction.SumIfs(Insh.Range(rng_0),Insh.range(rng_1) _ \n,\"Criteria_1\",.....,Insh.Range(rng_n,\"Criteria_N\")\nnext i\n</code></pre>\n\n<p>I would like to avoid having VBA write the formula in an Excel cell for two reasons. One, access to the underlying data is limited and will not be sent out in the file. The second is speed. I believe this way will be faster as with making these reports by hand there will be 1000's of these formulas created, on multiple sheets.</p>\n\n<p>I've tried to feed the variables into the sumif statement by creating a string and array, but both times I received a mismatch error. The only solution that I can think of is a select case statement based on the number of criteria passed on, but that is limited to what I would program and I do not know how deep the criteria could become.</p>\n"}, {"tags": ["vba", "excel", "api-key", "google-distancematrix-api"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469030570, "post_id": 38485353, "comment_id": 64372894, "body": "<code>sensor=key=EntersKeyHere</code> that doesn&#39;t make sense (even assuming you anonymised your key)"}, {"owner": {"reputation": 11, "user_id": 6614560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3595c679fdefd65532d1d243c474ce?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick McCarthy", "link": "https://stackoverflow.com/users/6614560/patrick-mccarthy"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469030644, "post_id": 38485353, "comment_id": 64372961, "body": "What doesn&#39;t make sense?  If i take out the &#39;sensor=&#39; it doesn&#39;t calculate.  It calculates with it in."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469030809, "post_id": 38485353, "comment_id": 64373094, "body": "parameters should be separated by &#39;&amp;&#39; right now you have a parameter named sensor which equals &quot;key=EntersKeyHere&quot; instead of having a parameter named sensor equal to &quot;&quot; and a parameter named key equal to &quot;EntersKeyHere&quot;. And thats what does not make sense"}, {"owner": {"reputation": 11, "user_id": 6614560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3595c679fdefd65532d1d243c474ce?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick McCarthy", "link": "https://stackoverflow.com/users/6614560/patrick-mccarthy"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469031087, "post_id": 38485353, "comment_id": 64373280, "body": "I updated code using &#39; lastVal = &quot;&amp;mode=car&amp;language=en-US&amp;sensor=&quot;&quot;&amp;key=EntersKeyHere&quot; &#39; but doesn&#39;t calculate"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469031161, "post_id": 38485353, "comment_id": 64373327, "body": "You should remove the &quot;&quot; or else sensor will be equal to &quot; &quot;&quot; &quot;. Or just remove sensor completly"}, {"owner": {"reputation": 11, "user_id": 6614560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3595c679fdefd65532d1d243c474ce?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick McCarthy", "link": "https://stackoverflow.com/users/6614560/patrick-mccarthy"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469033130, "post_id": 38485353, "comment_id": 64374443, "body": "So I updated my code to use ClientID instead of API key &#39;&amp;clientid=EntersIDHere&#39; and it works, but still only does 2500 transactions"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1469034047, "post_id": 38485353, "comment_id": 64374972, "body": "according to <a href=\"https://developers.google.com/maps/documentation/distance-matrix/?hl=en\" rel=\"nofollow noreferrer\">this</a> exemple from google, it should be <code>key</code> but maybe you have to pass both for it to work?"}], "owner": {"reputation": 11, "user_id": 6614560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3595c679fdefd65532d1d243c474ce?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick McCarthy", "link": "https://stackoverflow.com/users/6614560/patrick-mccarthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2711, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1571059433, "creation_date": 1469030297, "last_edit_date": 1469033161, "question_id": 38485353, "link": "https://stackoverflow.com/questions/38485353/google-distance-matrix-api-key-excel-vba", "title": "Google Distance Matrix API Key Excel VBA", "body": "<p>I can't get the VBA Code in my Excel Document to connect to my account, using the API Key.  Not sure if I'm putting the key in the right place.  I've even upgraded my account, and have billing Enabled.  I'm trying to pay them, but it wont let me exceed 2,500 transactions.  Thanks in advance for the help.</p>\n\n<p>Edit (7/20):<br>\nSo I updated my code to use ClientID instead of API key '&amp;clientid=EntersIDHere' and it works, but still only does 2500 transactions.</p>\n\n<pre><code>'Calculate Google Maps distance between two addresses\nPublic Function GetDistance(start As String, dest As String)\n    Dim firstVal As String, secondVal As String, lastVal As String\n    firstVal = \"http://maps.googleapis.com/maps/api/distancematrix/json?origins=\"\n    secondVal = \"&amp;destinations=\"\n    lastVal = \"&amp;mode=car&amp;language=en-US&amp;clientid=EntersKeyHere\"\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    URL = firstVal &amp; Replace(start, \" \", \"+\") &amp; secondVal &amp; Replace(dest, \" \", \"+\") &amp; lastVal\n    objHTTP.Open \"GET\", URL, False\n    objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    objHTTP.send (\"\")\n    If InStr(objHTTP.responseText, \"\"\"distance\"\" : {\") = 0 Then GoTo ErrorHandl\n    Set regex = CreateObject(\"VBScript.RegExp\"): regex.Pattern = \"\"\"value\"\".*?([0-9]+)\": regex.Global = False\n    Set matches = regex.Execute(objHTTP.responseText)\n    tmpVal = Replace(matches(0).SubMatches(0), \".\", Application.International(xlListSeparator))\n    GetDistance = CDbl(tmpVal)\n    Exit Function\nErrorHandl:\n    GetDistance = -1\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 6494858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAxGo.jpg?s=128&g=1", "display_name": "BigElittles", "link": "https://stackoverflow.com/users/6494858/bigelittles"}, "is_accepted": false, "score": 0, "last_activity_date": 1469034660, "creation_date": 1469034660, "answer_id": 38486755, "question_id": 38485302, "link": "https://stackoverflow.com/questions/38485302/vba-picture-popup-on-click-bug-issue/38486755#38486755", "title": "VBA picture popup on click bug issue", "body": "<p>I'm not familair enough with your code.. But would it be possible to reset column D on every click on that column? I'm assuming that all the images are a standard size. </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n\nIf Not Intersect(Target, Range(\"D:D\")) Is Nothing Then\nMsgBox \"Nice Work!\" 'place reset image size code here. \nCall \"whatever your image resize macro is named\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6595230, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7f989ac37052417b8272366dc49d4c93?s=128&d=identicon&r=PG&f=1", "display_name": "Stackexplorer", "link": "https://stackoverflow.com/users/6595230/stackexplorer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469034660, "creation_date": 1469030143, "question_id": 38485302, "link": "https://stackoverflow.com/questions/38485302/vba-picture-popup-on-click-bug-issue", "title": "VBA picture popup on click bug issue", "body": "<p>I have a sheet in excel that list products and a picture for each product (Column D).  I have put the following code in the worksheet but my problem is this.</p>\n\n<p>Problem: If a user clicks on a product image and then clicks on another image before clicking on a 2nd time to make the image small again the 2nd clicked image disappears and the 1st image adjusted to the new size and will only enlarge even bigger.</p>\n\n<p>Image:</p>\n\n<p><a href=\"http://i.stack.imgur.com/0ujUf.png\" rel=\"nofollow\">Screenshot Steps of what is happening</a></p>\n\n<pre><code>Option Explicit\nDim fd As Boolean\nSub PicPopUp_Click()\nfd = fd Xor True\nWith ActiveSheet.Shapes(Application.Caller).OLEFormat.Object\nIf fd Then\n    .Left = .Left - 50\n    .Width = .Width + 50\n    .Top = .Top - 50\n    .Height = .Height + 50\nElse\n    .Left = .Left + 50\n    .Width = .Width - 50\n    .Top = .Top + 50\n    .Height = .Height - 50\nEnd If\n.ShapeRange.ZOrder msoBringToFront\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "css", "vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 4, "creation_date": 1469029945, "post_id": 38485179, "comment_id": 64372453, "body": "If you can do <code>start</code> and <code>end</code>, why can&#39;t you do <code>&lt;body&gt;</code> and <code>&lt;&#47;body&gt;</code> ? Welcome to Stack Overflow - people generally appreciate it you post the code you already tried to solve the problem with...."}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 6614512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a70efd790305bc5fa1247e693b39f9b?s=128&d=identicon&r=PG", "display_name": "George Kemp", "link": "https://stackoverflow.com/users/6614512/george-kemp"}, "edited": false, "score": 0, "creation_date": 1469474687, "post_id": 38536880, "comment_id": 64540889, "body": "What do I need to set each one of the dimensions as? Or do I not?"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1469232715, "creation_date": 1469232715, "answer_id": 38536880, "question_id": 38485179, "link": "https://stackoverflow.com/questions/38485179/extracting-data-from-html-file-vba/38536880#38536880", "title": "Extracting Data from HTML File (VBA?)", "body": "<p>Generally, it would be done like this:</p>\n\n<pre><code>Sub Test() Dim IE As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n    .Visible = True\n    .Navigate \"http://www.marketwatch.com/investing/stock/aapl/analystestimates\" ' should work for any URL\n    Do Until .ReadyState = 4: DoEvents: Loop\n\n        x = .document.body.innertext\n        y = InStr(1, x, \"Average Target Price:\")\n        Z = Mid(x, y, 6)\n\n        Range(\"A1\").Value = Trim(Z)\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<p>In your specific case, it should be something like this:</p>\n\n<pre><code>a = .document.body.innertext\nb = InStr(1, x, \"Start\")\nc = InStr(1, y, \"End\")\n\nd = Mid(a, b, (c-b))\n\nRange(\"A1\").Value = Trim(d)\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 6614512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a70efd790305bc5fa1247e693b39f9b?s=128&d=identicon&r=PG", "display_name": "George Kemp", "link": "https://stackoverflow.com/users/6614512/george-kemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3609, "favorite_count": 0, "accepted_answer_id": 38536880, "answer_count": 1, "score": 0, "last_activity_date": 1469232715, "creation_date": 1469029798, "question_id": 38485179, "link": "https://stackoverflow.com/questions/38485179/extracting-data-from-html-file-vba", "title": "Extracting Data from HTML File (VBA?)", "body": "<p>I'm currently working on a project at work (I'm an intern), that is expected to take me a few weeks to complete. It's basically a migration copy and paste job from one website to another. In order to save myself time, boredom and possibly win myself a job (If I'm able to complete this in a timely manner), I'm looking at ways to automate the process. Currently I've figured each step in the process but one. </p>\n\n<p>Basically, I have another automation program downloading the html file and converting it into a text file for each page on the site that needs to be copied over to the new one (over 1000). What I need to do with this html file is to extract just the body, I've identified an start and end point to extract from  to . Both these appear in all of the html files. </p>\n\n<p>I'm currently attempting to use VBA in excel to open up the file, extract the data and write the result in a new file, from here I can automate the copy and paste process. </p>\n\n<p>What I can't figure out is how to extract data between these two point. I can extract data between two strings i.e. \"Start\" &amp; \"End\" however, I can't seem to extract data between two html tags. Any suggestions would be fantastic. I'm not a programmer, and I'm learning on the fly in order to complete this project ASAP. </p>\n\n<p>Thanks again. </p>\n"}, {"tags": ["excel", "formatting", "conditional-formatting", "date-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 1, "creation_date": 1469120224, "post_id": 38489305, "comment_id": 64417936, "body": "Hi @Namkce, I edited the table to include your answer and the formula still does not work. I even tried inputting the formula column by column instead of by row, and it still trips up at 10:00 AM. What did I do wrong? I included another picture in my initial question for reference"}, {"owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "reply_to_user": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1469127100, "post_id": 38489305, "comment_id": 64421697, "body": "@SRag What is the exact formula that you&#39;re using?  I am using the following formula (to place in cell E11).  <code>=AND(E$8&gt;=$C11,E$8&lt;=$D11)</code> Create a new conditional formatting rule for Cell E11 with rule &quot;Use a formula to determine which cells to format&quot;, and then enter my formula above, and then drag and apply that condition to all the cells.  See my answer for <a href=\"http://stackoverflow.com/questions/37750273/excel-conditional-formating-over-multiple-rows/37751855#37751855\">Excel Conditional Formating over multiple rows</a> on how to apply the conditional formats to the other cells."}, {"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 1, "creation_date": 1469195947, "post_id": 38489305, "comment_id": 64450698, "body": "that worked! I changed it to <code>=AND(E$8&lt;=$C11, E$8&gt;=$D11)</code> but your formula works, thank you. I originally had 2 rules, one being <code>E$8&lt;$C11</code> and the other <code>E$8&gt;=$D11</code>"}, {"owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "reply_to_user": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1469200265, "post_id": 38489305, "comment_id": 64453648, "body": "@SRag you&#39;re welcome; glad to see you got it working!"}], "tags": [], "owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "is_accepted": true, "score": 0, "last_activity_date": 1469137010, "last_edit_date": 1469137010, "creation_date": 1469043102, "answer_id": 38489305, "question_id": 38485097, "link": "https://stackoverflow.com/questions/38485097/conditional-formatting-shading-cells-according-to-time-interval/38489305#38489305", "title": "conditional formatting: shading cells according to time interval", "body": "<p><strong>Update the format you're using for Time</strong><br>\n<code>10:00am</code> is not recognized as <code>10:00 AM</code> by excel, and neither is <code>8:30am</code>.  So when you're comparing whether or not <code>10:00am</code> is less than <code>8:30am</code> with the expression you provided, you're going to get an answer of <code>TRUE</code>, because the char order for <code>1</code> (the first char in <code>10:00am</code>) is before that of <code>8</code> (in <code>8:30am</code>).  </p>\n\n<p>Basically, change your Time values in the 8th Row from <code>6:00am</code> to <code>6:00 AM</code> etc, as well as the employee clock in and out time values in columns C and D.  </p>\n\n<p>You need to have a space between the time and the AM/PM part, otherwise you're not comparing time values, but instead char values, which is why I believe you are experiencing inconsistency in your results. </p>\n\n<p><strong>In Addition</strong>, try the following formula for your conditions:  <code>=AND(E$8&gt;=$C11,E$8&lt;=$D11)</code> in E11</p>\n"}], "owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 38489305, "answer_count": 1, "score": 1, "last_activity_date": 1469137010, "creation_date": 1469029550, "last_edit_date": 1531161705, "question_id": 38485097, "link": "https://stackoverflow.com/questions/38485097/conditional-formatting-shading-cells-according-to-time-interval", "title": "conditional formatting: shading cells according to time interval", "body": "<p>I have a table with time intervals as the column header and employee names as the row header. There is a column with each employee's time in and each employee's time out. I want to shade the cells in each row so that if the column header (say 6:30am) is less than that person's time in...its shaded grey. Likewise, if the column header (say 5:30pm) is >= the person's time out, its shaded grey.</p>\n\n<p>The formula I use for this is: for start of day <code>E$8&lt;$C11</code> and for end of day <code>E$8&lt;$D11</code></p>\n\n<p>I applied the first formula to the first row, and the second formula to the second row. As you can see, it gets tripped up at the 10:00am column for some reason. What am I doing wrong? </p>\n\n<p>UPDATE: I implemented what the answer below suggest I do, and no change :( </p>\n\n<p><a href=\"https://i.stack.imgur.com/3HVLa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3HVLa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6341511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/539c1f272569945385450961ba581bda?s=128&d=identicon&r=PG&f=1", "display_name": "YLS", "link": "https://stackoverflow.com/users/6341511/yls"}, "edited": false, "score": 0, "creation_date": 1469029934, "post_id": 38485136, "comment_id": 64372446, "body": "It does not work? What I got is: #NAME?, and the cell value is: =IF(Divider=0, 0, strTemp)"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 39, "user_id": 6341511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/539c1f272569945385450961ba581bda?s=128&d=identicon&r=PG&f=1", "display_name": "YLS", "link": "https://stackoverflow.com/users/6341511/yls"}, "edited": false, "score": 0, "creation_date": 1469030187, "post_id": 38485136, "comment_id": 64372616, "body": "because you dont have a named range <code>Divider</code> in your workbook."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1469030270, "post_id": 38485136, "comment_id": 64372681, "body": "@cyboashu <code>Divider</code> shouldn&#39;t be a named range in worksheet since it&#39;s a VBA project variable."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1469031655, "last_edit_date": 1469031655, "creation_date": 1469029665, "answer_id": 38485136, "question_id": 38484955, "link": "https://stackoverflow.com/questions/38484955/replace-formula-in-a-cell-in-vba/38485136#38485136", "title": "Replace Formula in a cell in VBA", "body": "<p>You can't use <code>.Value</code> to set formula</p>\n\n<p>Correct syntax is <code>.Formula</code></p>\n\n<p><code>ws.Range(\"c6\").Formula = \"=IF(\" &amp; Divider &amp; \"=0, 0, strTemp)\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1469030194, "creation_date": 1469030194, "answer_id": 38485317, "question_id": 38484955, "link": "https://stackoverflow.com/questions/38484955/replace-formula-in-a-cell-in-vba/38485317#38485317", "title": "Replace Formula in a cell in VBA", "body": "<p>You have to make a concatenation of the new formula parts with variables value:</p>\n\n<pre><code>Sub replaceingError()\n\n    Dim oWS As Worksheet\n    Dim sTemp As String\n    Dim sDivider As String\n    Dim sFormula As String\n\n    Set oWS = ActiveSheet\n    sTemp = oWS.Range(\"C6\").Formula\n    sDivider = Right(sTemp, 2)\n    sTemp = Mid(sTemp, 2)\n    sFormula = \"=IF(\" &amp; sDivider &amp; \"=0,0,\" &amp; sTemp &amp; \")\"\n    oWS.Range(\"C6\").Formula = sFormula\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6341511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/539c1f272569945385450961ba581bda?s=128&d=identicon&r=PG&f=1", "display_name": "YLS", "link": "https://stackoverflow.com/users/6341511/yls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 38485317, "answer_count": 2, "score": 1, "last_activity_date": 1479045879, "creation_date": 1469029191, "last_edit_date": 1531164843, "question_id": 38484955, "link": "https://stackoverflow.com/questions/38484955/replace-formula-in-a-cell-in-vba", "title": "Replace Formula in a cell in VBA", "body": "<p>I have a cell of <code>C6</code>, it's current value is formula of <code>C5/C4</code>, I want to change the formula to <code>If(C4=0, 0, C5/C4)</code>. </p>\n\n<p>I have many cells similar to this cell, that's why I want to develop a macro so I can loop through them. </p>\n\n<p>However, the code below does not work. I think the problem is <code>Divider=0</code> in the last line. Because if I replace this part directly with <code>C4=0</code>, the code will work. </p>\n\n<p>can someone advise me what would be the correct code? Thanks in advance! </p>\n\n<pre><code>Sub replaceingError()\n\n  Dim ws As Worksheet\n  Set ws = ActiveSheet\n  Dim StrTemp As String\n  Dim Divider As String\n  StrTemp = ws.Range(\"c6\").formula\n  MsgBox (StrTemp) \n  Divider = Right(StrTemp, 2)\n  MsgBox (Divider)\n  ws.Range(\"c6\").value = \"=IF(Divider=0, 0, strTemp)\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1469029361, "post_id": 38484923, "comment_id": 64372043, "body": "What have you tried so far? Please post any methods/formulas you&#39;ve attempted.  Also, is it possible for &quot;John Carter&quot;&#39;s emails to all be the same, or will they always be different email address?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1469029470, "post_id": 38484923, "comment_id": 64372124, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a>. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. I&#39;d suggest something like this: <code>For Each rngCell in Range(&quot;D2:I100&quot;) : If rngCell.Value2 &lt;&gt; vbNullString Then</code>"}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1469088610, "post_id": 38484923, "comment_id": 64396857, "body": "Is there only ever going to be a maximum of 6 Email addresses for one person or are we to assume that &quot;Phone&quot;, &quot;Website&quot; etc will move across?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6626629, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-InRUSrKRkPw/AAAAAAAAAAI/AAAAAAAAAFI/1D3ar39LBEU/photo.jpg?sz=128", "display_name": "Kuldeep Mishra", "link": "https://stackoverflow.com/users/6626629/kuldeep-mishra"}, "is_accepted": false, "score": 0, "last_activity_date": 1469209301, "creation_date": 1469209301, "answer_id": 38532431, "question_id": 38484923, "link": "https://stackoverflow.com/questions/38484923/excel-vba-reorganize-data-from-multiple-columns-into-new-rows/38532431#38532431", "title": "Excel VBA - Reorganize data from multiple columns into new rows", "body": "<pre><code>Sub Macro3()\nDim sh As Worksheet\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim m As Integer\nDim n As Integer\nSet sh = ThisWorkbook.Worksheets(\"Sheet1\")\n\nsh.Range(\"a1\").End(xlDown).Select\n\nFor m = 2 To Selection.Row\nsh.Range(\"d\" &amp; m &amp; \":\" &amp; \"i\" &amp; m).SpecialCells(xlCellTypeConstants, 2).Copy\nj = sh.Cells(Rows.Count, \"g\").End(xlUp).Row + 1\nsh.Range(\"g\" &amp; j).PasteSpecial (xlPasteValues), Transpose:=True\nApplication.CutCopyMode = False\nsh.Range(\"a\" &amp; m &amp; \":\" &amp; \"c\" &amp; m).Copy\nk = sh.Cells(Rows.Count, \"a\").End(xlUp).Row + 1\ni = sh.Cells(Rows.Count, \"g\").End(xlUp).Row\nsh.Range(\"a\" &amp; k &amp; \":\" &amp; \"c\" &amp; i).PasteSpecial (xlPasteValues)\nsh.Range(\"j\" &amp; m &amp; \":\" &amp; \"l\" &amp; m).Copy\nn = sh.Cells(Rows.Count, \"d\").End(xlUp).Row + 1\nsh.Range(\"d\" &amp; n &amp; \":\" &amp; \"f\" &amp; i).PasteSpecial (xlPasteValues)\nNext m\nEnd Sub\n</code></pre>\n\n<p>My raw data resides between A1:L1 and result output data reside between a to g column like this... First Name   Last Name   Number of Emails    Phone   Website Other Columns   Mail</p>\n"}], "owner": {"reputation": 19, "user_id": 5124224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78b87652d23583561dd2277d8f90090?s=128&d=identicon&r=PG&f=1", "display_name": "ali_r", "link": "https://stackoverflow.com/users/5124224/ali-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1469209301, "creation_date": 1469029113, "question_id": 38484923, "link": "https://stackoverflow.com/questions/38484923/excel-vba-reorganize-data-from-multiple-columns-into-new-rows", "title": "Excel VBA - Reorganize data from multiple columns into new rows", "body": "<p>I have some data in Excel that I need to reorganize. Here's essentially what I need:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sXY6v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sXY6v.png\" alt=\"Sample Data\"></a></p>\n\n<p>The data starts from cell A1 (\"First Name\" is in cell A1) and I have other columns after \"Website\" too. I don't know much VBA so I would appreciate if someone can provide a full solution to this.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["arrays", "excel", "for-loop", "conditional", "vba"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1469031497, "post_id": 38484675, "comment_id": 64373528, "body": "Shouldn&#39;t you calculate <code>LR</code> and <code>LR1</code> <i>before</i> the <code>ReDim</code> statement? Right now it appears that <code>R</code> is dimensioned to zero elements. Also, adding an <code>Option Explicit</code> statement to the top of your code may allow the compiler to flag additional problems."}], "answers": [{"tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 1, "last_activity_date": 1469028909, "creation_date": 1469028909, "answer_id": 38484861, "question_id": 38484675, "link": "https://stackoverflow.com/questions/38484675/conditional-statement-not-working-properly-in-vba-excel/38484861#38484861", "title": "Conditional Statement Not Working Properly in VBA Excel", "body": "<p>Your <code>If</code> statement looks wrong. If you need to check if two conditions are met, use:</p>\n\n<pre><code>If Datarray(p, 1) &lt;&gt; Empty And Datarray(p + 1, 1) &lt;&gt; Empty\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6525287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba8356685c35fc8acd9878ffd8e3fc1b?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/6525287/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 38484861, "answer_count": 1, "score": 1, "last_activity_date": 1469028909, "creation_date": 1469028476, "last_edit_date": 1531161705, "question_id": 38484675, "link": "https://stackoverflow.com/questions/38484675/conditional-statement-not-working-properly-in-vba-excel", "title": "Conditional Statement Not Working Properly in VBA Excel", "body": "<p>I am writing a code in VBA that loops through every row for several columns and finds the difference between every two rows and stores that value in an array. I added an if statement in the for loop to avoid blank cells being included in the operation, and it works for the first five columns but not for the sixth. </p>\n\n<pre><code>Dim Datarray As Variant\nDim LR As Long, LR1 As Long\nDim p As Integer, i As Integer\nLR1=LR-1\nReDim R(LR1) As Variant\n\nFor i = 1 To DateTime_Column\n\nLR = Cells(Rows.Count, i).End(xlUp).Row\nDatarray = Range(Cells(1, i), Cells(LR, i))\n\n For p = 2 To LR1\n\n   If Datarray(p, 1) And Datarray(p + 1, 1) &lt;&gt; Empty Then  \n    R(p) = Abs(Datarray(p + 1, 1) - Datarray(p, 1))\n   End If\n\n Next p\n\nRave = WorksheetFunction.Average(R)       ***Error occurs here because R is empty***\n\nNext i\n</code></pre>\n\n<p>Does anyone see anything wrong with the way my if statement is written? The code seems to think that the cells in the sixth column are empty when they are not. I checked the Datarray and every spot has values in it.  </p>\n"}, {"tags": ["vba", "function", "excel", "subroutine"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469028702, "post_id": 38484475, "comment_id": 64371597, "body": "Does that code block, that you want in a separate function, need any inputs? Why couldn&#39;t you just put that in it&#39;s own sub, then call that sub from your main function?"}, {"owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469029340, "post_id": 38484475, "comment_id": 64372026, "body": "ive tried that - if I do that, I have to put in the other letter variables like k and j for loops which defeats the purpose and also it doesn&#39;t map to the right row"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469030273, "post_id": 38484475, "comment_id": 64372684, "body": "What&#39;s the <code>If Cells(k,4) = row 1&quot;</code>?? Do you mean if the row that <code>Cells(k,4)</code> is on is row 1?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469030391, "post_id": 38484475, "comment_id": 64372759, "body": "Look into <a href=\"https://msdn.microsoft.com/en-us/library/aa263527(v=vs.60).aspx\" rel=\"nofollow noreferrer\">passing arguments to Functions</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469037176, "post_id": 38484475, "comment_id": 64376775, "body": "you&#39;d really add some more info about what your code is supposed to do. there are many <i>strange</i> things, the weirdest being that <code>With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))</code> reference that isn&#39;t exploited at all since no statement within the next <code>End With</code> has any dot (.) ... Anyhow I&#39;ll add an answer for what I could grasp of it"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1469029646, "creation_date": 1469029646, "answer_id": 38485128, "question_id": 38484475, "link": "https://stackoverflow.com/questions/38484475/is-there-a-way-to-place-recurring-code-into-a-function-to-be-called-by-multiple/38485128#38485128", "title": "Is there a way to place recurring code into a function to be called by multiple subs in VBA", "body": "<p>Well, you should do something like this...</p>\n\n<pre><code>Option Explicit\n\n\nPublic Sub CalCategoryInternal(ByVal str_col2 As String, _\n                             ByVal g As Long, _\n                             ByVal k As Long, _\n                             ByVal j As Long, _\n                             ByRef CWS As Worksheet)\n\n\n        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n            On Error Resume Next\n\n            CWS.Cells(k, g).Value = str_col2\n\n            On Error GoTo 0\n\n        End With\n\n    End Sub\n\nSub calccategory()\n\n    Dim k, ThisBook, j, g, col1_n, col2_n, col3_n, col4_n, col5_n\n\n\n    For k = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n        If Cells(k, 4) = \"row 1\" Then\n\n            Dim CWS As Worksheet\n\n            Workbooks(ThisBook).Activate\n\n            For j = 5 To 15\n\n                For g = 1 To ActiveSheet.Cells(3, Columns.Count).End(xlToLeft).Column\n                    If Cells(3, g) = \"col1\" Then\n\n                        Call CalCategoryInternal(\"col1\", g, k, j, CWS)\n'                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n'                            On Error Resume Next\n'                            CWS.Cells(k, g).Value = col1_n\n'                        End With\n\n                    ElseIf Cells(3, g) = \"col2\" Then\n                        Call CalCategoryInternal(\"col1\", g, k, j, CWS)\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col2_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col3\" Then\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col3_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col 4\" Then\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col4_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col5\" Then\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col5_n\n                        End With\n\n                    End If\n\n                Next g\n\n                On Error GoTo 0\n            Next j\n        End If\n    Next k\n\n\nEnd Sub\n</code></pre>\n\n<p>Beware - this is really a low quality code. E.g. the \"Dim\"s on the top should not be declared this way and you can improve it further a lot. I do not see where you set the worksheet, thus I suppose that this is just a small part of the code. Enjoy it!</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": false, "score": 0, "last_activity_date": 1469030788, "creation_date": 1469030788, "answer_id": 38485552, "question_id": 38484475, "link": "https://stackoverflow.com/questions/38484475/is-there-a-way-to-place-recurring-code-into-a-function-to-be-called-by-multiple/38485552#38485552", "title": "Is there a way to place recurring code into a function to be called by multiple subs in VBA", "body": "<p>yeah you can easily stick that in its own sub, and you can pass K into it as an argument by value, that would just look like this:</p>\n\n<pre><code>Sub calccategory()\n\nFor k = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n  If Cells(k, 4) = row 1\" Then\n    Call newSub(k)\n  End If\n Next k\n End Sub\n\nSub newSub(byval k as long)\nDim CWS As Worksheet\n\nWorkbooks(ThisBook).Activate  \n\nFor j = 5 To 15\n\nFor g = 1 To ActiveSheet.Cells(3, Columns.Count).End(xlToLeft).Column\n  If Cells(3, g) = \"col1\" Then\n\nWith Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n On Error Resume Next    \nCWS.Cells(k, g).Value = col1_n    \nEnd With\n\n ElseIf Cells(3, g) = \"col2\" Then    \n    With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n     On Error Resume Next  \n   CWS.Cells(k, g).Value = col2_n\n End With\n\nElseIf Cells(3, g) = \"col3\" Then    \n    With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n     On Error Resume Next    \n   CWS.Cells(k, g).Value = col3_n    \nEnd With\n\nElseIf Cells(3, g) = \"col 4\" Then\nWith Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n     On Error Resume Next      \n   CWS.Cells(k, g).Value = col4_n    \nEnd With\n\nElseIf Cells(3, g) = \"col5\" Then\nWith Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n     On Error Resume Next     \nCWS.Cells(k, g).Value = col5_n\nEnd With    \n\nEnd If\n\nNext g\n\n\n  On Error GoTo 0\n  Next j\n\nend sub\n</code></pre>\n\n<p>you might also consider using a select statement and nesting your select statement in your with range..  although it doesn't look like you're actually referencing your with statement so you can probably get rid of it. </p>\n\n<p>I'd wonder where you're getting variables \"ThisBook\" \"col1_n\" / \"col2_n\" ... cause you might run into a \"function or variable not defined\" issue unless you define them either module wide or pass them in as arguments into the function.  </p>\n\n<p>You're also not defining CWS equal to anything so you might get an object required error.  which is what I assume the on error resume next statements are about.  </p>\n\n<p>So some of the improvements might look similar to this:</p>\n\n<pre><code>Sub calccategory()\n\n    For k = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n        If Cells(k, 4) = \"row 1\" Then\n            Call newSub(k)\n        End If\n    Next k\n\nEnd Sub\nSub newSub(ByVal k As Long)\nDim CWS As Worksheet\nSet CWS = Workbooks(ThisBook).Sheets(\"mySheetName\")\n\nFor j = 5 To 15\n    On Error Resume Next\n    For g = 1 To ActiveSheet.Cells(3, Columns.Count).End(xlToLeft).Column\n        If Cells(3, g) = \"col1\" Then\n            With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))        'still unused\n                CWS.Cells(k, g).Value = col1_n\n                Select Case Cells(3, g)\n                    Case \"col2\"\n                        CWS.Cells(k, g).Value = col2_n\n                    Case \"col3\"\n                        CWS.Cells(k, g).Value = col3_n\n                    Case \"col 4\"\n                        CWS.Cells(k, g).Value = col4_n\n                    Case \"col5\"\n                        CWS.Cells(k, g).Value = col5_n\n                End Select\n            End With\n        End If\n    Next g\n    On Error GoTo 0\nNext j\nEnd Sub\n</code></pre>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1469030837, "creation_date": 1469030837, "answer_id": 38485571, "question_id": 38484475, "link": "https://stackoverflow.com/questions/38484475/is-there-a-way-to-place-recurring-code-into-a-function-to-be-called-by-multiple/38485571#38485571", "title": "Is there a way to place recurring code into a function to be called by multiple subs in VBA", "body": "<p>What you need to do, as I posted in a comment, is pass the arguments to the new sub.  Also, you have lots of recurring code, so I tried to tighten that up.</p>\n\n<pre><code>Sub calccategory()\nFor k = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n    If Cells(k, 4) = \"row 1\" Then\n        theLoop k\n    End If\nNext k\nEnd Sub\n</code></pre>\n\n<p><br></p>\n\n<pre><code>Sub theLoop(ByVal k As Integer)\nDim CWS     As Worksheet\n\nSet CWS = Workbooks(ThisBook)\n\nFor j = 5 To 15\n    With CWS\n        For g = 1 To .Cells(3, .Columns.Count).End(xlToLeft).Column\n            With .Range(.Cells(k, j * 4 + 2), .Cells(k + 1, j * 4 + 4))\n                On Error Resume Next\n                If .Cells(3, g) = \"col1\" Then .Cells(k, g).Value = col1_n\n                    ElseIf .Cells(3, g) = \"col2\" Then .Cells(k, g).Value = col2_n\n                    ElseIf .Cells(3, g) = \"col3\" Then .Cells(k, g).Value = col3_n\n                    ElseIf .Cells(3, g) = \"col 4\" Then .Cells(k, g).Value = col4_n\n                    ElseIf .Cells(3, g) = \"col5\" Then .Cells(k, g).Value = col5_n\n            End If\n        End With\n    Next g\nEnd With                     'CWS\nOn Error GoTo 0\nNext j\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470726882, "post_id": 38487630, "comment_id": 65053551, "body": "@durba138: did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1469037525, "creation_date": 1469037525, "answer_id": 38487630, "question_id": 38484475, "link": "https://stackoverflow.com/questions/38484475/is-there-a-way-to-place-recurring-code-into-a-function-to-be-called-by-multiple/38487630#38487630", "title": "Is there a way to place recurring code into a function to be called by multiple subs in VBA", "body": "<p>meanwhile you're adding more info, I can throw in what follows:</p>\n\n<pre><code>Option Explicit\n\nSub calccategory()\n    Dim k As Long\n    Dim CWS As Worksheet\n    Dim col1_n As Variant, col2_n As Variant, col3_n As Variant, col4_n As Variant, col5_n As Variant\n\n    With ActiveSheet\n        For k = 1 To .Cells(Rows.Count, 4).End(xlUp).Row\n            If .Cells(k, 4) = \"row 1\" Then FillValues k, Workbooks(\"ThisBook\").ActiveSheet, CWS, Array(col1_n, col2_n, col3_n, col4_n, col5_n)\n        Next k\n    End With\n\nEnd Sub\n\nSub FillValues(k As Long, ws As Worksheet, CWS As Worksheet, colArray As Variant)\n    Dim j As Long, G As Long, col As Long\n    Dim strng As String\n\n    With ws\n'        For j = 5 To 15 '&lt;--| I commented it since it seems not to be used anywhere, once removing that 'With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))'\n            For G = 1 To .Cells(3, .Columns.Count).End(xlToLeft).Column\n                strng = .Cells(3, G).Value2\n                If Left(strng, 3) = \"col\" Then\n                    If IsNumeric(Mid(strng, 4, 1)) Then\n                        col = CLng(Mid(strng, 4, 1))\n                        If col &lt;= 5 Then CWS.Cells(k, G).Value = colArray(col - 1)\n                    End If\n                End If\n            Next G\n'        Next j\n    End With\nEnd Sub\n</code></pre>\n\n<p>but there's plenty of thing you should explain (<code>ThisBook</code>, <code>CWS</code>, <code>With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))</code> )to make a sense of it!</p>\n"}], "owner": {"reputation": 37, "user_id": 6605427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d47dde2498124a63edcd2ac4ee20062f?s=128&d=identicon&r=PG&f=1", "display_name": "durba138", "link": "https://stackoverflow.com/users/6605427/durba138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1469037525, "creation_date": 1469025938, "last_edit_date": 1469031413, "question_id": 38484475, "link": "https://stackoverflow.com/questions/38484475/is-there-a-way-to-place-recurring-code-into-a-function-to-be-called-by-multiple", "title": "Is there a way to place recurring code into a function to be called by multiple subs in VBA", "body": "<p>I have a bunch of subs for different categories in a table I'm building in excel. Each sub has its' own data it pulls from various flat files, but it all has the same ending which is placing each value into a specific cell based on the category header it aligns to in the row and column. So, all that is different is the if statement at the beginning. Is there a way to put this block of code in a separate sub or function or something and have just one call to it in each other sub so that I don't have to constantly type it out/ if I want to change it I would only have to change it in one place? Here is an example of the code: </p>\n\n<p>This part is at the beginning of each sub and changes based on the row header</p>\n\n<pre><code>Sub calccategory()\n\n    For k = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n        If Cells(k, 4) = \"row 1\" Then\n</code></pre>\n\n<p>This part is the part I want to place in a function or sub because it will be the same every time</p>\n\n<pre><code>            Dim CWS As Worksheet\n            Workbooks(ThisBook).Activate\n\n            For j = 5 To 15\n\n                For g = 1 To ActiveSheet.Cells(3, Columns.Count).End(xlToLeft).Column\n\n                    If Cells(3, g) = \"col1\" Then\n\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col1_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col2\" Then\n\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col2_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col3\" Then\n\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col3_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col 4\" Then\n\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col4_n\n                        End With\n\n                    ElseIf Cells(3, g) = \"col5\" Then\n\n                        With Range(Cells(k, j * 4 + 2), Cells(k + 1, j * 4 + 4))\n                            On Error Resume Next\n                            CWS.Cells(k, g).Value = col5_n\n                        End With\n\n                    End If\n\n                Next g\n\n                On Error GoTo 0\n\n            Next j\n</code></pre>\n\n<p>This part would again me part of the end of each sub and not a part of this function I want</p>\n\n<pre><code>        End If\n\n    Next k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot", "drilldown"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1469046844, "post_id": 38484367, "comment_id": 64382322, "body": "Does it work if you do it manually or record a macro? The <code>+&#47;-</code> buttons are disabled when no pivot table is selected, so you might have to select it or try it after the <code>.CreatePivotTable</code> line"}], "answers": [{"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1469029398, "post_id": 38484494, "comment_id": 64372073, "body": "<code>ActiveSheet.PivotTables(&quot;HoldersPivotTable&quot;).ShowDrillIndica&zwnj;&#8203;tors = False</code> Should it be ``ActiveSheet.PivotTables(&quot;HoldersPivotTable&quot;).EnableDrilldo&zwnj;&#8203;wn = False` Iam not sure but just give it a try."}], "tags": [], "owner": {"reputation": 409, "user_id": 5604652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73bf206d862d877d6c866e97cbaf0184?s=128&d=identicon&r=PG&f=1", "display_name": "B540Glenn", "link": "https://stackoverflow.com/users/5604652/b540glenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1469041548, "last_edit_date": 1469041548, "creation_date": 1469025992, "answer_id": 38484494, "question_id": 38484367, "link": "https://stackoverflow.com/questions/38484367/drill-indicators-vba-pivot-table/38484494#38484494", "title": "Drill Indicators VBA Pivot Table", "body": "<p>Change the code to read: </p>\n\n<pre><code>ActiveSheet.PivotTables(\"HoldersPivotTable\").ShowDrillIndicators = False\nActiveSheet.PivotTables(\"HoldersPivotTable\").PivotCache.Refresh\n</code></pre>\n\n<p>This will re-display the pivot without the drilldown indicators.  You have to refresh the pivot to get the changes to appear.</p>\n\n<p><br/>  If it still does not work, then check for a </p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>that doesn't have the corresponding </p>\n\n<pre><code>Application.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1005, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469041548, "creation_date": 1469025672, "last_edit_date": 1531164843, "question_id": 38484367, "link": "https://stackoverflow.com/questions/38484367/drill-indicators-vba-pivot-table", "title": "Drill Indicators VBA Pivot Table", "body": "<p>I am currently using VBA in excel 2010 and have created a pivot table that I would like to format based on certain things. I am trying to get the +/- buttons removed from the table using</p>\n\n<pre><code>ActiveSheet.PivotTables(\"HoldersPivotTable\").ShowDrillIndicators = False\n</code></pre>\n\n<p>but that isn't working for some reason.</p>\n\n<p>Help would be much appreciated!  </p>\n\n<pre><code>Sub PivotTable_Creation_And_Formatting()\n\n    'PURPOSE: Creates a brand new Pivot table on a new worksheet from data in the ActiveSheet\n\n    Sheets(\"Sheet2\").Select\n\n    Dim sht As Worksheet\n    Dim pvtCache As PivotCache\n    Dim pvt As PivotTable\n    Dim pf As PivotField\n    Dim StartPvt As String\n    Dim SrcData As String\n    Dim LastRow As Long\n\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    'Determine the data range you want to pivot\n    SrcData = ActiveSheet.Name &amp; \"!\" &amp; Range(Cells(1, \"A\"), Cells(LastRow, \"E\")).Address\n\n    'Create a new worksheet\n    Set sht = Sheets(\"HOLDERS (CORP)\")\n\n    'Where do you want Pivot Table to start?\n\n    StartPvt = sht.Range(\"A1\").Address\n\n    'Create Pivot Cache from Source Data\n    Set pvtCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=SrcData)\n\n    'Create Pivot table from Pivot Cache\n    Set pvt = pvtCache.CreatePivotTable(TableDestination:=sht.Range(StartPvt), _\n    TableName:=\"HoldersPivotTable\")\n\n    pvt.PivotFields(\"SECURITY SHORT DESCRIPTION\").Orientation = xlRowField\n\n    'Add item to the Row Labels\n    pvt.PivotFields(\"HOLDERS\").Orientation = xlRowField\n\n    'Add item to the Row Labels\n    pvt.PivotFields(\"POSITION\").Orientation = xlRowField\n\n    'Add item to the Row Labels\n    pvt.PivotFields(\"LATEST CHANGE\").Orientation = xlRowField\n\n    'Add item to the Row Labels\n    pvt.PivotFields(\"FILE DT\").Orientation = xlRowField\n\n    pvt.ColumnGrand = False\n    pvt.RowGrand = False\n\n    'Show in Tabular Form\n    pvt.RowAxisLayout xlTabularRow\n\n    For Each pf In pvt.PivotFields\n        pf.Subtotals(1) = True\n        pf.Subtotals(1) = False\n    Next pf\n\n    Sheets(\"HOLDERS (CORP)\").Select\n    Columns(\"A:E\").Select\n    Selection.Columns.AutoFit\n    Columns(\"C:C\").ColumnWidth = 13.43\n    Columns(\"A:E\").HorizontalAlignment = xlLeft\n\n    Columns(\"B:E\").Interior.Color = RGB(141, 180, 226)\n    Range(\"A1\").Interior.Color = RGB(141, 180, 226)\n\n    With Range(\"A1:E1\").Borders\n        .LineStyle = xlContinuous\n        .Weight = xlMedium\n    End With\n\n    ActiveSheet.PivotTables(\"HoldersPivotTable\").ShowDrillIndicators = False\n\n    Range(\"B1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6614076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6014235a804493fd4de8da05678ac2?s=128&d=identicon&r=PG&f=1", "display_name": "OrlandoT", "link": "https://stackoverflow.com/users/6614076/orlandot"}, "edited": false, "score": 0, "creation_date": 1469107740, "post_id": 38500191, "comment_id": 64409573, "body": "Thanks @kernel!  I used ParamArray command, to insert different Ranges.  Then, to understand if all the data were stored, I made a function that gets these data and gives you them back in an array. the code is:  <code>Function EXAMPLE(ParamArray UserInput() As Variant) As Variant</code>  <code>EXAMPLE = UserInput()</code>  <code>End Function</code>  The function gives me back only the first group of data input (e.g. the first range input). If I type, at the end,  <code>UserInput(3)</code>, it gives me back the third range, and so on. It is like the data are &quot;taken&quot;, but it hides them in someway...."}, {"owner": {"reputation": 61, "user_id": 6614076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6014235a804493fd4de8da05678ac2?s=128&d=identicon&r=PG&f=1", "display_name": "OrlandoT", "link": "https://stackoverflow.com/users/6614076/orlandot"}, "edited": false, "score": 0, "creation_date": 1469109091, "post_id": 38500191, "comment_id": 64410541, "body": "Well, I&#39;ve just discovered that the data were stored in a 2D Array. In fact, if I select an area of the right sizes (columns and rows), and press CTRL+SHIFT+ENTER, it gives me all the values. I thought that the array I had created were 1D (an array of arrays), and I don&#39;t know how it became 2D..."}, {"owner": {"reputation": 11, "user_id": 6615305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2341f9f71f9d8745c5407cc38a609bfb?s=128&d=identicon&r=PG&f=1", "display_name": "kernel", "link": "https://stackoverflow.com/users/6615305/kernel"}, "reply_to_user": {"reputation": 61, "user_id": 6614076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6014235a804493fd4de8da05678ac2?s=128&d=identicon&r=PG&f=1", "display_name": "OrlandoT", "link": "https://stackoverflow.com/users/6614076/orlandot"}, "edited": false, "score": 0, "creation_date": 1469129699, "post_id": 38500191, "comment_id": 64422981, "body": "If you assign a Range variable to a Variant variable, the Variant becomes a 2D array containing the values in the Range. In your example, the function is taking a Range (or several) as a parameter, but you have your UserInput() as a Variant, so the UserInput() become a 2D array."}, {"owner": {"reputation": 61, "user_id": 6614076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6014235a804493fd4de8da05678ac2?s=128&d=identicon&r=PG&f=1", "display_name": "OrlandoT", "link": "https://stackoverflow.com/users/6614076/orlandot"}, "edited": false, "score": 0, "creation_date": 1469192666, "post_id": 38500191, "comment_id": 64448513, "body": "Thank you very much @kernel! After some trials and &quot;exploring&quot; the results, I &quot;discovered&quot; this thing as well. This is pretty good for me, because I can pick the values I want from <code>UserInput()</code>, as soon as I know precisely how they are allocated in the array. Thank you very much again for your help!!"}], "tags": [], "owner": {"reputation": 11, "user_id": 6615305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2341f9f71f9d8745c5407cc38a609bfb?s=128&d=identicon&r=PG&f=1", "display_name": "kernel", "link": "https://stackoverflow.com/users/6615305/kernel"}, "is_accepted": false, "score": 1, "last_activity_date": 1469093636, "last_edit_date": 1469093636, "creation_date": 1469093115, "answer_id": 38500191, "question_id": 38484290, "link": "https://stackoverflow.com/questions/38484290/variable-range-as-input/38500191#38500191", "title": "Variable Range as Input", "body": "<p>Not the full answer, but hopefully points you in the right direction.</p>\n\n<ul>\n<li><p>A standard Range object can already hold multiple 'areas' (e.g. C5:D9,G9:H16,B14:D18). You can loop through these using the .Areas property.</p></li>\n<li><p>You can get easily get a 2D array of values from a Range object by using a Variant variable (e.g. Dim a as Variant, a = SomeRange). If multiple areas are selected however, this method will only get the first area, so you'll need to loop through each area to get all values.</p></li>\n<li><p>The code below requires validation added, plus possibly handling any column / row offsets (i.e. See comment in loop related to indexes).</p></li>\n</ul>\n\n<p><pre>\nPublic Function ProcessRange(ByRef rng As Range)</p>\n\n<code>  '# PURPOSE: Process multi-area range\n\n  Dim rngArea As Range ' Single area in multi-area selection\n  Dim lngCol As Long ' Column in selected range(area), 1 based\n  Dim lngRow As Long ' Row in selected range(area), 1 based\n  Dim avarValues As Variant ' 2D variant array for range(area) values, 1 based\n\n\n  ' --&gt; Add validation here &lt;--\n\n\n  ' Go through each area in selected range\n  ' --------------------------------------\n  For Each rngArea In rng.Areas\n\n    ' Store the values into 2d array (Row, Column),  1 based\n    avarValues = rngArea\n\n    ' Show each value held in the array\n    For lngRow = 1 To UBound(avarValues, 1)\n      For lngCol = 1 To UBound(avarValues, 2)\n        ' Note row / column index is NOT necessarily the same as the row/column on the worksheet\n        ' Index 1 will be the first cell in the selected area\n        Debug.Print \"Area \" + rngArea.Address + \", value in AREA row \" &amp; lngRow &amp; \", column \" &amp; lngCol &amp; \": \" &amp; avarValues(lngRow, lngCol)\n      Next lngCol\n    Next lngRow\n  Next rng\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6614076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6014235a804493fd4de8da05678ac2?s=128&d=identicon&r=PG&f=1", "display_name": "OrlandoT", "link": "https://stackoverflow.com/users/6614076/orlandot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469093636, "creation_date": 1469025484, "last_edit_date": 1469025803, "question_id": 38484290, "link": "https://stackoverflow.com/questions/38484290/variable-range-as-input", "title": "Variable Range as Input", "body": "<p>I am a new user of VBA for Excel (2013), and I've been struggling with a problem for quite a while.</p>\n\n<p>I want to create a function that, among the other input variables that the user has to provide, has several ranges of cells, that should be variable and \"easily selectable\" by the user themselves.\nIt should be something like (for example) the Excel \"SUM\" formula, where you can input several ranges such as \"A1:C1,F1:H1,...\", selecting them with your mouse.</p>\n\n<p>Moreover, I have to transfer the values selected by the user in a 2D array. Every range selected by the user has to become a row of my 2D array.</p>\n\n<p>Further to what I've said so far, the number of ranges that the user inputs should be anyone, and only the first one should be mandatory.</p>\n\n<p>Given the \"structure\" of my spreadsheet, all the data that the user has to select are arranged in rows. (Does it make any difference if they are arranged in rows or in columns?)</p>\n\n<p>Please note that I shouldn't use the \"Input Box\", because it slows down a lot the procedure when I \"drag down\" a row to apply the formula to many rows below the active one.</p>\n\n<p>Below, I report the only parts of the code that I was able to write (not very much...)</p>\n\n<pre><code>Function Trial_Version(MyRange1 As Range, MyRange2 As Range, MyRange3 As Range) As Double\n''' The number of ranges that the user is be able to input\n'''should be anyone. Only the first Range should be mandatory\n\n    Dim TotalArray()() As Double\n\n'''The user should be able to input as many \"sub-arrays\" as they want,\n'''so I do not know how many parentheses to write\n\n    TotalArray = (MyRange1)(MyRange2)\n\n'''here, the same problem as the previous line\n\n    RANGE_TO_ARRAY = TotalArray\n'''This is the output of my function\n\nEnd Function\n</code></pre>\n\n<p>Thank you very much in advance,\nOrlando</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1469024498, "post_id": 38483759, "comment_id": 64370003, "body": "What happens after 67 emails. Does the code stop without errors, or is there an error on a particular line in your code? Please explain in further detail."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1469024985, "post_id": 38483759, "comment_id": 64370398, "body": "There seems to be a Compiler Error - Syntax error on the paragraph <code>strbody = &quot;&lt;p&gt;Dear &quot; &amp; Cells(r, &quot;J&quot;).Text &amp; &quot;, &lt;&#47;p&gt;&quot; &amp; _ .....</code>. Please recheck the code from your master code."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1469025607, "post_id": 38483759, "comment_id": 64370865, "body": "Remove the <code>On Error Resume Next</code> statements and let it fail so you can see what and where it fails?"}, {"owner": {"reputation": 19, "user_id": 6406261, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/788cce90ea973bb9e31755f9ca96fcca?s=128&d=identicon&r=PG&f=1", "display_name": "newkid59", "link": "https://stackoverflow.com/users/6406261/newkid59"}, "edited": false, "score": 0, "creation_date": 1469036317, "post_id": 38483759, "comment_id": 64376261, "body": "After 67 emails there&#39;s no error message, the emails just stop populating, so you assume that it ran through all of them."}, {"owner": {"reputation": 19, "user_id": 6406261, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/788cce90ea973bb9e31755f9ca96fcca?s=128&d=identicon&r=PG&f=1", "display_name": "newkid59", "link": "https://stackoverflow.com/users/6406261/newkid59"}, "edited": false, "score": 0, "creation_date": 1469038076, "post_id": 38483759, "comment_id": 64377372, "body": "I removed the On Error Resume Next, and this is the error message I got:   Run-time error &#39;-2147024882 (8007000e)&#39;: Out of memory or system resources. Close some windows or programs and try again.   So it is a limit issue. Any suggestions on how to go from here? Just off the top of my head I&#39;m thinking making separate macros for every 50 or 60 lines, and run emails just for each chunk of 50. Then employees don&#39;t forget which emails they&#39;ve gone through so far."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 6494858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KAxGo.jpg?s=128&g=1", "display_name": "BigElittles", "link": "https://stackoverflow.com/users/6494858/bigelittles"}, "is_accepted": true, "score": 0, "last_activity_date": 1469118442, "last_edit_date": 1469118442, "creation_date": 1469035879, "answer_id": 38487108, "question_id": 38483759, "link": "https://stackoverflow.com/questions/38483759/excel-email-macro-size-limits/38487108#38487108", "title": "Excel Email Macro Size Limits", "body": "<p>So here is some code that could handle your problem two ways. One is to limit the batch amount... The other is to save the mailobject in the my documents folder in each for loop, the set the mail objects as nothing. This should give the users the ability to run all the accounts at once, but open and edit before they send... which brings me to my real solution.  </p>\n\n<p>Find out what scenarios these users are editing emails, then code for them. Also, if the users are manually looking at each email before it is sent. Maybe get rid of the loop entirely and have them click a button when they want the next available account on the spreadsheet. This could be accomplished by having a column with \"sent status\" on it. </p>\n\n<pre><code>Option Explicit\n\nSub SendEMail()\nDim Email As String\nDim Subj As String\nDim Msg As String\nDim URL As String\nDim r As Integer\nDim x As Double\nDim OApp As Object\nDim OMail As Variant\nDim Signature As String\nDim strbody As String\n\n'for formatting reasons\nstrbody = \"&lt;html&gt;&lt;body&gt;\"\n\n'for looping\nWith Sheets(\"List\").Select\n    lastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\nEnd With\n\nFor r = 2 To lastrow\n\n\n    Set OApp = CreateObject(\"Outlook.Application\")\n    Set OMail = OApp.CreateItem(0)\n\n\n'       Get the email address\n    Sheets(\"List\").Select\n    Email = Cells(r, \"K\")\n\n'       Message subject\n    Sheets(\"List\").Select\n    Subj = \"Renewal for \" &amp; Cells(r, \"B\").Text &amp; \" Client # \" &amp; Cells(r, \"A\").Text &amp; \" Effective \" &amp; Cells(r, \"D\").Text\n\n'       Message body\n    Sheets(\"List\").Select\n    strbody = \"This was a syntax error, changing for simplicity.\"\n\n    On Error Resume Next\n\n    Sheets(\"List\").Select\n    With OMail\n        .display\n        .To = Email\n        .Subject = Subj\n        .HTMLBody = strbody &amp; vbNewLine &amp; .HTMLBody\n''New\n        .SaveAs (\"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Documents\\\" &amp;     Environ$(\"Username\") &amp; r &amp; \".msg\")\n    End With\n    Set OMail = Nothing\n    Set OApp = Nothing\n\n'''        'If you decide to limit your batches do it here\n'''        If r = 62 Then\n'''          MsgBox \"Could do an assortment of things here...anyways, its     not a very good solution. \"\n'''        End If\n\n    Next r\n\n    On Error GoTo 0\n\n\n    Set OMail = Nothing\n    Set OApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Also, and this is completely up to you and your business needs. I would really consider moving the strbody out of the hardcode and into a new sheet/text file or available cell in the spreadsheet. Makes support so much easier down the line.  </p>\n\n<p>After reading your comment above about memory.. the problem is all of those open email messages. You might want to use the save method above, then write a new macro that will open a file with the oldest date modified from that directory, after they click send have the file delete or archive... Something like that. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7751716, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/796d69fa420da857a1e4c46e97545192?s=128&d=identicon&r=PG", "display_name": "klaas", "link": "https://stackoverflow.com/users/7751716/klaas"}, "is_accepted": false, "score": 0, "last_activity_date": 1490190418, "creation_date": 1490190418, "answer_id": 42953511, "question_id": 38483759, "link": "https://stackoverflow.com/questions/38483759/excel-email-macro-size-limits/42953511#42953511", "title": "Excel Email Macro Size Limits", "body": "<p>I have built a similar batch tool and hit the same issue, but found it to be unpredictable. Looking for a solution I settled for throttling the speed at which the script generates the mails, roughly 500 milliseconds per mail - my mails carry multiple attachments so smaller mails may need less throttling.</p>\n\n<p>I can now very stability create > 100 emails with total size (all emails combined) ranging between 200Mb and 300Mb.</p>\n\n<p>I have the impression it is a technica issue in the interface between Excel/VBA and Outlook. </p>\n"}], "owner": {"reputation": 19, "user_id": 6406261, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/788cce90ea973bb9e31755f9ca96fcca?s=128&d=identicon&r=PG&f=1", "display_name": "newkid59", "link": "https://stackoverflow.com/users/6406261/newkid59"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1786, "favorite_count": 0, "accepted_answer_id": 38487108, "answer_count": 2, "score": 0, "last_activity_date": 1490190418, "creation_date": 1469024117, "last_edit_date": 1531164843, "question_id": 38483759, "link": "https://stackoverflow.com/questions/38483759/excel-email-macro-size-limits", "title": "Excel Email Macro Size Limits", "body": "<p>I have a macro I built to send out batches of emails to clients, using personalized info for each client. It's been working great, but it's just been brought to my attention that the macro doesn't create emails after about the 67th draft that populates in Outlook when you run the macro. I've tried to research and haven't found a constraint restriction as to how many email drafts Outlook will let you have open at once. I've posted my code below in case anyone can see if I inadvertently set up a limit. </p>\n\n<p>How the macro works: Employees have a list of about 500 accounts that they need to contact via email every month about renewing their contract with us. All of the info is in an Excel file, and this macro pulls each clients email address, customer name, customer contact, renewal date, etc. and uses that info in each email for a more personalized email. Once the employee hits the button to run the macro, it will create an email for each account in the list, populating in Outlook. I have the emails populate in Outlook instead of automatically sending in case the employee wants to edit or add more information to an email depending on the client. Most cases they send the email as is, but the employees do edit a few emails. So while it seems daunting to have so many drafts populate in Outlook at once, it's much faster for the employees to send out emails this way instead of typing each one out individually. </p>\n\n<p>So any advice or insight on why I can't send more than 67 emails at once when the macro should run through the last row of information, please let me know. If not I will just have to tell the employees to only use the macro in batches of 60 I suppose.  </p>\n\n<pre><code>Sub SendEMail()\n\n\nDim Email As String\nDim Subj As String\nDim Msg As String\nDim URL As String\nDim r As Integer\nDim x As Double\nDim OApp As Object\nDim OMail As Variant\nDim Signature As String\nDim strbody As String\n\n'for formatting reasons\nstrbody = \"&lt;html&gt;&lt;body&gt;\"\n\n'for looping\nWith Sheets(\"List\").Select\nlastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\nEnd With\n\nFor r = 2 To lastrow\n\n\nSet OApp = CreateObject(\"Outlook.Application\")\nSet OMail = OApp.CreateItem(0)\n\n\n'       Get the email address\nSheets(\"List\").Select\nEmail = Cells(r, \"K\")\n\n'       Message subject\n    Sheets(\"List\").Select\nSubj = \"Renewal for \" &amp; Cells(r, \"B\").Text &amp; \" Client # \" &amp; Cells(r, \"A\").Text &amp; \" Effective \" &amp; Cells(r, \"D\").Text\n\n'       Message body\nSheets(\"List\").Select\nstrbody = \"&lt;p&gt;Dear \" &amp; Cells(r, \"J\").Text &amp; \", &lt;/p&gt;\" &amp; _\n\"I am contacting you regarding the upcoming renewal for \" &amp; Cells(r, \"B\").Text &amp; \", account number \" &amp; Cells(r, \"A\").Text &amp; \", which is effective \" &amp; Cells(r, \"D\").Text &amp; \". We have reviewed the account and determined that we have the information we need on file in order to offer renewal terms. &amp; _\n\"Should you have any questions or if we can be of futher assistance, please don't hesitate to contact \" &amp; Cells(r, \"O\").Text &amp; \" at \" &amp; Cells(r, \"M\").Text &amp;                 \" or \" &amp; Cells(r, \"N\").Text &amp; _\n\" or respond to this email. If you are aware of changes to the contact on this account, please let us know, so we can be sure to get future correspondence to the proper person.&lt;br&gt;&lt;br&gt;\" &amp; _\n\"As always, we would like to thank you for your business.&lt;br&gt;&lt;br&gt;\" &amp; _\n\"Sincerely,\"\n\nOn Error Resume Next\n\nSheets(\"List\").Select\nWith OMail\n.Display\n.To = Email\n.Subject = Subj\n.HTMLBody = strbody &amp; vbNewLine &amp; .HTMLBody\nEnd With\nNext r\n\nOn Error GoTo 0\n\n\nSet OMail = Nothing\nSet OApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1469024882, "post_id": 38483748, "comment_id": 64370318, "body": "<i>&quot;many other fields which need to be copied over&quot;</i>  How many?  Dozens?"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1469025039, "post_id": 38483748, "comment_id": 64370437, "body": "@HansUp:  Yes, dozens, though less than 60. I will update the OP with this."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 3, "creation_date": 1469025596, "post_id": 38483748, "comment_id": 64370853, "body": "That&#39;s what I feared.  Let&#39;s say 58 fields total.  That means for each duplicated record, you will repeat the information already stored for 56 fields --- all of them except <code>ID</code> and <code>lob</code>.  If you&#39;re determined to do that, I&#39;m sure Andre&#39;s solution will do it.  But I encourage you to look into <a href=\"https://en.wikipedia.org/wiki/Database_normalization\" rel=\"nofollow noreferrer\">Database normalization</a>: <i>&quot;Database normalization, or simply normalization, is the process of organizing the columns (attributes) and tables (relations) of a relational database to minimize data redundancy.&quot;</i>"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1469025837, "post_id": 38483748, "comment_id": 64371018, "body": "@HansUp: Thank you! I will give that a read now.  It looks like it could really help to optimize my database."}], "answers": [{"comments": [{"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469024729, "post_id": 38483927, "comment_id": 64370182, "body": "The reason that I did that was that if I did not convert it to a string, then I get an error whenever a cell in that field has a null value.  I agree with you though, it is certainly not an optimal solution."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469025174, "post_id": 38483927, "comment_id": 64370533, "body": "I see, this could be avoided by using variables of type <code>Variant</code> instead of <code>String</code>. But it is even easier to directly set <code>rsTarget.myField = rsSource.myField</code>, without a variable inbetween."}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469025348, "post_id": 38483927, "comment_id": 64370643, "body": "Thank you for the suggestion.  I&#39;ll try it out!"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469028854, "post_id": 38483927, "comment_id": 64371691, "body": "I still need to update the first record before the for loop, right?"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469032152, "post_id": 38483927, "comment_id": 64373906, "body": "I am finding that when I update the record before the for loop, or even if I don&#39;t update the record at all, the program runs until it stops responding.  This happens even if I use my previous method to update the first record before the for loop."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469033633, "post_id": 38483927, "comment_id": 64374718, "body": "@Paradox: I have added more of your original code to give context. Maybe you had deleted the <code>.MoveNext</code> of <code>rs</code> by accident."}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1469035090, "post_id": 38483927, "comment_id": 64375564, "body": "Yep, that was the issue.  Thank you."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1469033533, "last_edit_date": 1469033533, "creation_date": 1469024573, "answer_id": 38483927, "question_id": 38483748, "link": "https://stackoverflow.com/questions/38483748/how-can-i-copy-almost-all-field-values-into-a-duplicated-row-in-access-vba/38483927#38483927", "title": "How can I copy almost all field values into a duplicated row in Access VBA?", "body": "<p>First, I find all these</p>\n\n<pre><code>strL3 = ![L3] &amp; \"\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>![L3] = strL3\n</code></pre>\n\n<p>problematic - you are converting NULL values to empty strings, there is no reason to do that.</p>\n\n<p>Second, to do this for all fields, you can loop the <code>Recordset.Fields</code> collection.</p>\n\n<p>Get rid of all the <code>str&lt;Fieldname&gt;</code> variables, and do this:</p>\n\n<pre><code>Dim fld As DAO.Field\n\n' ...\n\nSet rsADD = db.OpenRecordset(\"IIPM\", dbOpenDynaset, dbAppendOnly)\n\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\nWith rs\n    While Not .EOF\n        varData = Split(rs![Lines Of Business], \",\") ' Get all comma delimited fields\n\n        ' Update First Record\n        .Edit\n        !lob = Trim(varData(0)) ' remove spaces before writing new fields\n        ' ![App Code] = strAppCode  ' unnecessary\n        .Update\n\n        ' Add records with same first field\n        ' and new fields for remaining data at end of string\n\n        For i = 1 To UBound(varData)\n            rsADD.AddNew\n            For Each fld In rsADD.Fields\n                If fld.Name &lt;&gt; \"lob\" And fld.Name &lt;&gt; \"ID\" Then\n                    ' Copy all fields except \"lob\" and \"ID\"\n                    rsADD(fld.Name) = rs(fld.Name)\n                End If\n            Next fld\n            ' lob is set separately, ID is set automatically\n            rsADD!lob = Trim(varData(i))   ' remove spaces before writing new fields\n            rsADD.Update\n        Next i\n\n        .MoveNext\n    Wend\n\n    .Close\n    rsADD.Close\n\nEnd With\n\nSet rsADD = Nothing\nSet rs = Nothing\n</code></pre>\n\n<p>Note: nested <code>With</code> blocks are problematic, so I have always used the recordset names.</p>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1337, "favorite_count": 0, "accepted_answer_id": 38483927, "answer_count": 1, "score": 2, "last_activity_date": 1469033533, "creation_date": 1469024069, "last_edit_date": 1469025091, "question_id": 38483748, "link": "https://stackoverflow.com/questions/38483748/how-can-i-copy-almost-all-field-values-into-a-duplicated-row-in-access-vba", "title": "How can I copy almost all field values into a duplicated row in Access VBA?", "body": "<p>I have a program which splits the <code>Lines Of Business</code> field on commas, then takes those split values and distributes them over duplicate rows of the original row, in a column called <code>lob</code>.  The primary key is an auto-generated <code>ID</code>.</p>\n\n<p>Here is a concise example of desired behavior (many fields omitted for visual clarity):</p>\n\n<p>Before running module:</p>\n\n<blockquote>\n<pre><code> +--------------------------------------------+\n |  ID   | App Code  |   Lines Of Business    |\n +-------+-----------+------------------------+\n |   1   |    AB23   | Value1, Value 2,Value3 |\n +------ +-----------+------------------------+\n |   2   |    XY45   |         Value 2        |\n +--------------------------------------------+\n</code></pre>\n</blockquote>\n\n<p>After running module:</p>\n\n<blockquote>\n<pre><code> +-------------------------------------------------------+\n |  ID   | App Code  |   Lines Of Business    |   lob    |\n +-------+-----------+------------------------+----------+\n |   1   |    AB23   | Value1, Value 2,Value3 |  Value1  |\n +-------+-----------+------------------------+----------+\n |   2   |    XY45   |         Value 2        |  Value 2 |\n +-------+-----------+------------------------+----------+ \n |   3   |    AB23   | Value1, Value 2,Value3 |  Value 2 |\n +-------+-----------+------------------------+----------+\n |   4   |    AB23   | Value1, Value 2,Value3 |  Value3  |\n +-------------------------------------------------------+\n</code></pre>\n</blockquote>\n\n<p>You will see several similar statements in the code below, including:</p>\n\n<pre><code>strSOC1 = ![SOC 1] &amp; \"\"\nstrL3 = ![L3] &amp; \"\"\nstrAppCode = ![App Code] &amp; \"\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>![Current Lifecycle Phase] = strCurrentLifecyclePhase\n![SOC 1] = strSOC1\n![L3] = strL3\n</code></pre>\n\n<p>What I would like to do is simplify this so that instead of creating a variable for each field that needs to be copied over to the new duplicate row (i.e. the <code>App Code</code> field in the table above), all fields (except for <code>lob</code> which is generated by the split on commas) are copied over at once.  </p>\n\n<p>I have dozens of other fields which need to be copied over, so to complete this with my current method would result in me creating a long list of variables (or a dictionary) and the code would not be portable to other tables.  </p>\n\n<p>So, how could I accomplish this?</p>\n\n<p>Here is my code, which has had much help from other SO users since I am quite new to VBA.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ReformatTable()\n\n    Dim db                       As DAO.Database\n    Dim rs                       As DAO.Recordset\n    Dim rsADD                    As DAO.Recordset\n\n    Dim strSQL                   As String\n    Dim strLinesOfBusiness       As String\n    Dim strSOC1                  As String\n    Dim strCurrentLifecyclePhase As String\n    Dim strL3                    As String\n    Dim strL4                    As String\n    Dim strlob                   As String\n    Dim strAppCode               As String\n    Dim varData                  As Variant\n    Dim i                        As Integer\n\n    Set db = CurrentDb\n\n    ' Add a field into the existing IIPM table called lob.\n    ' Values created during the Line Of Business split will be stored here.\n    Dim strDdl As String\n    strDdl = \"ALTER TABLE IIPM ADD COLUMN lob TEXT(255);\"\n    CurrentProject.Connection.Execute strDdl\n\n    ' Select all fields that have a Line of Business and are unprocessed (lob is Null)\n    strSQL = \"SELECT *, lob FROM IIPM WHERE ([Lines Of Business] Is Not Null) AND ([lob] Is Null)\"\n\n    Set rsADD = db.OpenRecordset(\"IIPM\", dbOpenDynaset, dbAppendOnly)\n\n    Set rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\n    With rs\n        While Not .EOF\n            strLinesOfBusiness = ![Lines Of Business] &amp; \"\" ' Append empty string to mitigate error when cell in field is null\n            strCurrentLifecyclePhase = ![Current Lifecycle Phase] &amp; \"\"\n            strSOC1 = ![SOC 1] &amp; \"\"\n            strL3 = ![L3] &amp; \"\"\n            strAppCode = ![App Code] &amp; \"\"\n            varData = Split(strLinesOfBusiness, \",\") ' Get all comma delimited fields\n\n            ' Update First Record\n            .Edit\n            !lob = Trim(varData(0)) ' remove spaces before writing new fields\n            ![App Code] = strAppCode\n            .Update\n\n            ' Add records with same first field\n            ' and new fields for remaining data at end of string\n            For i = 1 To UBound(varData)\n                With rsADD\n                    .AddNew\n                    ![Lines Of Business] = strLinesOfBusiness\n                    ![Current Lifecycle Phase] = strCurrentLifecyclePhase\n                    ![SOC 1] = strSOC1\n                    ![L3] = strL3\n                    ![L4] = strL4\n                    !lob = Trim(varData(i)) ' remove spaces before writing new fields\n                    ![App Code] = strAppCode\n                    .Update\n                End With\n            Next\n            .MoveNext\n        Wend\n\n        .Close\n        rsADD.Close\n\n    End With\n\n    Set rsADD = Nothing\n    Set rs = Nothing\n\n    ' Remove empty rows which only contain an ID.\n    CurrentProject.Connection.Execute \"DELETE FROM IIPM WHERE lob IS NULL AND [App Code] IS NULL AND [Lines Of Business] IS NULL;\"\n\n    db.Close\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript", "macros"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6613122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118dd4ac27569896760da15b04250fec?s=128&d=identicon&r=PG&f=1", "display_name": "Marjan.R", "link": "https://stackoverflow.com/users/6613122/marjan-r"}, "edited": false, "score": 0, "creation_date": 1469183558, "post_id": 38501820, "comment_id": 64442902, "body": "Thanks for the replay."}, {"owner": {"reputation": 21, "user_id": 6613122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118dd4ac27569896760da15b04250fec?s=128&d=identicon&r=PG&f=1", "display_name": "Marjan.R", "link": "https://stackoverflow.com/users/6613122/marjan-r"}, "edited": false, "score": 0, "creation_date": 1469189476, "post_id": 38501820, "comment_id": 64446460, "body": "Please see my answer below."}], "tags": [], "owner": {"reputation": 145, "user_id": 6594977, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/xxT9K.jpg?s=128&g=1", "display_name": "mulla", "link": "https://stackoverflow.com/users/6594977/mulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1469097088, "creation_date": 1469097088, "answer_id": 38501820, "question_id": 38483398, "link": "https://stackoverflow.com/questions/38483398/automatic-refreshment-of-excel-dde-rtd/38501820#38501820", "title": "Automatic refreshment of Excel DDE RTD", "body": "<p>Kindly try the below one and \nbe careful when using</p>\n\n<p><code>Application.Calculation = xlCalculationManual\n Application.Calculation = xlCalculationAutomatic</code></p>\n\n<p>this sets the entire excel application to calculate formula's either automatically or manually. If you use \nApplication.Calculation = xlCalculationManual</p>\n\n<p>you'll notice your automatic formulas no longer work.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6613122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118dd4ac27569896760da15b04250fec?s=128&d=identicon&r=PG&f=1", "display_name": "Marjan.R", "link": "https://stackoverflow.com/users/6613122/marjan-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1469188493, "last_edit_date": 1469188493, "creation_date": 1469188089, "answer_id": 38525694, "question_id": 38483398, "link": "https://stackoverflow.com/questions/38483398/automatic-refreshment-of-excel-dde-rtd/38525694#38525694", "title": "Automatic refreshment of Excel DDE RTD", "body": "<p>Thanks for the reply @mulla, but this doesn't work. In vbscript I get runtime error and in vba nothing happens (does not affect refreshment). The same thing is for the Worksheet.Calculate.</p>\n\n<p>Than I recorded a macro upon manual update of the links (data) in order to inspect how Excel proceed update and this actually works, but not all the time. If I open Workbook manually and I keep it opened than whole export works perfectly since the data is constantly refreshed (not what I need). In case when the Workbook is opened via vbscript only (what I need), as you can see in the output below some of the values are exported successfully (for the faster refreshment I believe) and some are #N/A (for the slower refreshment). All the data is refreshed every second, except upon opening the file where successfully exported values are refreshed instantly and #N/A values need few seconds (2-3s) to be refreshed.</p>\n\n<p>Recorder macro uses ActiveWorkbook.UpdateLink as follows (the code below is for the first row, but the same logic is used and for the rest of the rows):</p>\n\n<pre><code>Sub PriceUpdate()\nActiveWorkbook.UpdateLinks = xlUpdateLinksAlways\n\nActiveWorkbook.UpdateLink Name:= _\n    \"vegadde|VEGA!897789,148,1@\"\"1,\\\"\"12,0,0\\\"\"\"\",1\", Type:=xlOLELinks\nActiveWorkbook.UpdateLink Name:= _\n    \"vegadde|VEGA!897789,148,1@\"\"1,\\\"\"12,0,0\\\"\"\"\",3\", Type:=xlOLELinks\nActiveWorkbook.UpdateLink Name:= _\n    \"vegadde|VEGA!897789,148,1@\"\"1,\\\"\"12,0,0\\\"\"\"\",4\", Type:=xlOLELinks\n\n    ...\n\nEnd Sub\n</code></pre>\n\n<p>Then I use vbscript to call the macro and export data in CSV comma delimited file with timestamp name:</p>\n\n<pre><code>Option Explicit\n\nDim objExcel, objBook, objSheet\n\nSet objExcel = CreateObject(\"Excel.Application\")\nSet objBook = objExcel.Workbooks.Open (\"d:\\exptest\\exptest.xlsm\", 0, False)\n'Set objSheet = objBook.Worksheets.Item(1)\nobjExcel.DisplayAlerts = False\n\nobjExcel.Run \"PriceUpdate\"\nWScript.Sleep 5000 ' Delay in order to update links \nobjBook.SaveAs \"d:\\exptest\\\" &amp; Year(Now) &amp; \".\" &amp; Month(Now) &amp; \".\" &amp; Day(Now) &amp; \"_\" &amp; Hour(Now) &amp; \"-\" &amp; Minute(Now) &amp; \".txt\",6\n\nobjBook.Close False\n\nobjExcel.DisplayAlerts = True\n\nobjExcel.Quit\n\n'Set objSheet = Nothing\nSet objBook = Nothing\nSet objExcel = Nothing\n</code></pre>\n\n<p>And what I get is the following uotput:</p>\n\n<pre><code>Inst,Price,Datetime\nUSD,1.1015,7/22/2016 12:48\nGBP,#N/A,#N/A\nCHF,#N/A,#N/A\nSEK,9.4962,7/22/2016 12:48\nNOK,#N/A,#N/A\nJPY,#N/A,#N/A\nDKK,#N/A,#N/A\nCAD,#N/A,#N/A\nAUD,1.47395,7/22/2016 12:48\nRUB,71.0082,7/22/2016 12:48\n</code></pre>\n\n<p>I'm struggling to learn Excel logic behind different updates in order to solve my problem and to get desired solution, but with no success.</p>\n\n<p>And this is only a test file with 22 links. The real one has 482 links that need to be updated.</p>\n"}, {"tags": [], "owner": {"reputation": 18, "user_id": 13059407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c22d8aa328906cefa44f909ac0d95c9?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/13059407/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1584481473, "creation_date": 1584481473, "answer_id": 60730673, "question_id": 38483398, "link": "https://stackoverflow.com/questions/38483398/automatic-refreshment-of-excel-dde-rtd/60730673#60730673", "title": "Automatic refreshment of Excel DDE RTD", "body": "<p>Marjan. Not sure if this is still a problem for you, but I ran into a similar problem with refreshing RTD data in a closed Excel workbook and seem to have found a solution. As you mentioned, when you open the workbook, the data refreshes automatically (with some of the more complex data points taking 2-3 sec). The problem is, you don't want to have to constantly manually open a workbook to refresh data. And I've found that the data fails to refresh with methods like <code>RTD.RefreshData</code> called to a <strong>closed</strong> workbook.</p>\n\n<p>So to fix this, I created a vba module that simply opens the workbook, refreshes it, <strong>pauses for a second</strong> (you may need 2-3 more seconds for all data to update) and then saves and closes the workbook. This method is called recursively. Essentially this does the work of constantly opening and closing the workbook, while delaying briefly so that the RTD data can refresh. So far, this is able to provide refreshed RTD data successfully (although there is an inherent slight delay of a few seconds). Here's the basis of my code:</p>\n\n<pre><code>Sub refreshXLS()\n    Path = \"workbook.xlsm\"  'the workbook path you want to refresh\n\n    Workbooks.Open Path\n    ActiveWorkbook.RefreshAll\n    Application.OnTime Now() + TimeValue(\"00:00:01\"), \"closeActive\" \nEnd Sub\n\n\nSub closeActive()\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\n    refreshXLS\nEnd Sub\n</code></pre>\n\n<p>Hope this helps if you still wish to solve this problem!</p>\n"}], "owner": {"reputation": 21, "user_id": 6613122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118dd4ac27569896760da15b04250fec?s=128&d=identicon&r=PG&f=1", "display_name": "Marjan.R", "link": "https://stackoverflow.com/users/6613122/marjan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1221, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1584481473, "creation_date": 1469023175, "last_edit_date": 1495541685, "question_id": 38483398, "link": "https://stackoverflow.com/questions/38483398/automatic-refreshment-of-excel-dde-rtd", "title": "Automatic refreshment of Excel DDE RTD", "body": "<p>I'm subscribed to a RTD financial application with the option to export real time data to Excel via DDE. So, using the DDE copy/paste app option, I've created a Excel table with real time DDE financial data. Cells actually contains DDE formulas. Now I open, refresh and save table manually, but what I need is a solution that will open, refresh the data, save and close this excel table automatically.</p>\n\n<p>I didn't now how to attach the file, so here is a screenshot of it.\n<a href=\"https://i.stack.imgur.com/pkZGK.png\" rel=\"nofollow noreferrer\">My Excel DDE file</a></p>\n\n<p>Since I'm new to vba and vbscript, I was searching internet for a solution but without any success, especially not for automatic update (refreshment) of the DDE data.</p>\n\n<p>What I've been doing for the past few days, was searching, trying and customising different kind of vba macros and vbscripts, and today I'm completely lost and confused.</p>\n\n<p>I have tried bunch of suggested solution, even yours \n<a href=\"https://stackoverflow.com/questions/26861133/refresh-data-and-exit-with-saving-macro-excel\">Refresh data and exit with saving Macro Excel</a>\nand <a href=\"https://stackoverflow.com/questions/31807441/on-workbook-open-excel-macro-to-refresh-all-data-connections-sheets-and-pivot-t\">On workbook open, Excel Macro to refresh all data connections sheets and pivot tables and then export the pivot to csv</a> but in my case they don't work. </p>\n\n<p>Any solution, reference, code example will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "html-parsing"], "owner": {"reputation": 23, "user_id": 1132345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112dabb1bbe1fa07612d071a4ac8de3d?s=128&d=identicon&r=PG", "display_name": "777string", "link": "https://stackoverflow.com/users/1132345/777string"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469022878, "creation_date": 1469022878, "question_id": 38483301, "link": "https://stackoverflow.com/questions/38483301/grabbing-microdata-attribute-in-excel", "title": "Grabbing microdata attribute in excel", "body": "<p>I want to grab the itemprop microdata from a website and put each one into a cell in an excel sheet.</p>\n\n<pre><code>&lt;li&gt;Item Num: &lt;span itemprop=\"productID\"&gt;123ABC-200&lt;/span&gt;\n        &lt;/li&gt;\n&lt;li&gt;ManufacturerNum: &lt;span itemprop=\"model\"&gt;ABC123&lt;/span&gt;\n        &lt;/li&gt;\n</code></pre>\n\n<p>I'm storing the addresses to scrape within a column and I'm trying to open up IE, navigate to the site, grab the data, and throw it into another cell.</p>\n\n<pre><code>Sub scrape()\n\nDim i As Integer\nlastrow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 2 To lastrow\nSet wb = CreateObject(\"internetExplorer.Application\")\nsURL = Cells(i, 1)\n\nwb.navigate sURL\nwb.Visible = True\n\nWhile wb.Busy\n    DoEvents\nWend\n\n'HTML document\nSet doc = wb.document\n\nCells(i, 2) = doc.Title\n\nOn Error GoTo err_clear\n\nDim el As Object\nelem = doc.GetElementsByTagName(\"span\")\natts = elem.getAttribute(\"itemprop\")\n\nFor Each el In atts\n    Cells(i, 3).Value = Cells(i, 3).Value &amp; \", \" &amp; el.innerText\nNext el\n\nerr_clear:\nIf Err &lt;&gt; 0 Then\nErr.Clear\nResume Next\nEnd If\nwb.Quit\nRange(Cells(i, 1), Cells(i, 3)).Columns.AutoFit\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I'm getting back nothing. If I just search for spans, I can pull them all in. I haven't successfully pulled in any attributes from any html element. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1469025254, "post_id": 38483375, "comment_id": 64370572, "body": "Perfect, Thank you."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 4, "last_activity_date": 1469023092, "creation_date": 1469023092, "answer_id": 38483375, "question_id": 38483282, "link": "https://stackoverflow.com/questions/38483282/add-text-to-a-text-box-excel-vba/38483375#38483375", "title": "Add text to a text box Excel VBA", "body": "<p>Use the <code>TextFrame</code> property </p>\n\n<p><code>ActiveSheet.Shapes(\"Textbox 6\").TextFrame.Characters.Text = \"Hello\"</code></p>\n"}], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8735, "favorite_count": 0, "accepted_answer_id": 38483375, "answer_count": 1, "score": 1, "last_activity_date": 1469023092, "creation_date": 1469022842, "question_id": 38483282, "link": "https://stackoverflow.com/questions/38483282/add-text-to-a-text-box-excel-vba", "title": "Add text to a text box Excel VBA", "body": "<p>I can add text to a textbox using the following method:</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"TextBox 6\")).Select\nSelection.Text = \"a\"\n</code></pre>\n\n<p>However selecting the shape seems like poor practice.  I'd like to use something like:</p>\n\n<pre><code>Worksheets(\"Dashboard\").Shapes(\"Textbox 6\").Text = \"a\"\n</code></pre>\n\n<p>How is this achievable?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469022192, "post_id": 38482904, "comment_id": 64368197, "body": "you need to change your <code>ThisWorkbook.Sheets(&quot;UI&quot;).Activate</code> to <code>ThisWorkbook.Sheets(&quot;UI&quot;).Select</code>"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1469022589, "post_id": 38482904, "comment_id": 64368536, "body": "Is the code contained in the same workbook that you&#39;re processing, or is it in an Add-In or a Personal Workbook? I&#39;d say the first step is to confirm that <code>ThisWorkbook</code> refers to the workbook you think it does. Add this line to check: <code>Debug.Print ThisWorkbook.Name</code> (the results populate in the Immediate Window in the VBE). If that is correct, maybe add a loop such as: <code>For each sh in ThisWorkbook.Sheets</code> <code>Debug.Print sh.Name</code> <code>Next sh</code> and look for any anomalies."}, {"owner": {"reputation": 33, "user_id": 6431850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e0fbc7cabdcb6115bcb92f30ac0940?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Wittmer", "link": "https://stackoverflow.com/users/6431850/jon-wittmer"}, "edited": false, "score": 0, "creation_date": 1469023143, "post_id": 38482904, "comment_id": 64368947, "body": "Shai, activate vs select makes no difference. I don&#39;t actually want to activate or select the sheet, I simply put that in there to confirm that the chart object was not causing my problems. Trying to change any property or call any method of <code>Sheets(&quot;UI&quot;)</code> causes this error."}, {"owner": {"reputation": 33, "user_id": 6431850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e0fbc7cabdcb6115bcb92f30ac0940?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Wittmer", "link": "https://stackoverflow.com/users/6431850/jon-wittmer"}, "edited": false, "score": 0, "creation_date": 1469023387, "post_id": 38482904, "comment_id": 64369140, "body": "I printed the names of the worksheets:   UI, DropDown, M-Code, BlackBoard, Database Mirror, Data.   They all appear as they should"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 6704803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dc236ddc76ba5014e5d1baa7bc0215?s=128&d=identicon&r=PG&f=1", "display_name": "xcl107", "link": "https://stackoverflow.com/users/6704803/xcl107"}, "is_accepted": false, "score": 0, "last_activity_date": 1471007102, "creation_date": 1471007102, "answer_id": 38918737, "question_id": 38482904, "link": "https://stackoverflow.com/questions/38482904/excel-application-defined-error-when-selecting-sheet/38918737#38918737", "title": "Excel Application-Defined Error When Selecting Sheet", "body": "<p>Any chance that your \"UI\" worksheet name has leading or trailing spaces?</p>\n"}], "owner": {"reputation": 33, "user_id": 6431850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e0fbc7cabdcb6115bcb92f30ac0940?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Wittmer", "link": "https://stackoverflow.com/users/6431850/jon-wittmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 527, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1601943521, "creation_date": 1469021858, "last_edit_date": 1531164843, "question_id": 38482904, "link": "https://stackoverflow.com/questions/38482904/excel-application-defined-error-when-selecting-sheet", "title": "Excel Application-Defined Error When Selecting Sheet", "body": "<p>A few months ago, I wrote a program in Excel using VBA, which worked fine. Today, I reopened the program and the code errored out on me, giving me an \"application-defined or object-defined error\" on me. This workbook is stored on a network drive that I do have read/write permissions to. I also tried working with a new copy of the workbook saved somewhere else on the drive, and also a copy saved on my desktop, each resulting in the same error.  Here is where the code stopped </p>\n\n<pre><code>ThisWorkbook.Sheets(\"UI\").Activate\nThisWorkbook.Sheets(\"UI\").ChartObjects(\"MainChart\").Chart.ProtectData = True\nThisWorkbook.Sheets(\"UI\").ChartObjects(\"MainChart\").Chart.ProtectFormatting = True\nThisWorkbook.Sheets(\"UI\").ChartObjects(\"VPricePerChart\").Chart.ProtectData = True\nThisWorkbook.Sheets(\"UI\").ChartObjects(\"VPricePerChart\").Chart.ProtectFormatting = True\nThisWorkbook.Sheets(\"UI\").ChartObjects(\"NewChart\").Chart.ProtectData = True\nThisWorkbook.Sheets(\"UI\").ChartObjects(\"NewChart\").Chart.ProtectFormatting = True\n</code></pre>\n\n<p>I know that I do not need to activate the sheet to change properties of specifically named objects, but I put that line in today after it quit working to see where the error occurred. The error occurs at the first line when I  use <code>Sheets(\"UI\").Activate</code>. I tried running other procedures that contain <code>Sheets(\"UI\")</code> and they all returned the same error. I checked to make sure the name of the worksheet had not changed, and it is still <code>UI</code>. The worksheet and the workbook are both unprotected and the worksheet is not hidden. I can run <code>ThisWorkbook.Sheets(\"Data\").Activate</code> fine where <code>Data</code> is another sheet. I have also tried using <code>ThisWorkbook.Sheets(1).Activate</code> since <code>UI</code> is the first sheet in my workbook and that does not work.</p>\n\n<p>The strangest part of this whole thing is that the exact same file opens perfectly fine, running all the code as written without causing any errors on my colleague's machine. </p>\n\n<p>Any thoughts on why I cannot do anything that involves that sheet?  </p>\n"}, {"tags": ["vb.net", "excel", "memory-leaks", "vba"], "comments": [{"owner": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1469022838, "post_id": 38482746, "comment_id": 64368710, "body": "<a href=\"http://stackoverflow.com/search?q=close+excel+interop\">There are a lot of response to this question</a>. I would suggest you look at an other library. I often had trouble with the interopt and it&#39;s very slow."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469022077, "post_id": 38482819, "comment_id": 64368094, "body": "I have an issue, one of the excel inputs has multiple sheets, and wbxl.close() breaks the code."}, {"owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "reply_to_user": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469022155, "post_id": 38482819, "comment_id": 64368160, "body": "<i>WorkBooks</i> by definition can have multiple <i>WorkSheets</i>, Calling <code>wbxl.Close</code> will attempt to close all of them"}, {"owner": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469022707, "post_id": 38482819, "comment_id": 64368620, "body": "Edit: Actually I am not sure is it is because of the multiple sheets, wbxl.close seems to work in one form but not the other where I check for multiple sheets.   I removed wbxl.close and everything else seems to be fine"}, {"owner": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469022889, "post_id": 38482819, "comment_id": 64368753, "body": "So I suppose the reason for the hang is that wbxl.close is having an issue closing all the sheets? Is there a different syntax that should be used in this case?"}, {"owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "reply_to_user": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469023463, "post_id": 38482819, "comment_id": 64369205, "body": "Please see the edit which now includes everything you need"}, {"owner": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469023707, "post_id": 38482819, "comment_id": 64369407, "body": "Thank you, that explains the hang."}, {"owner": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "edited": false, "score": 0, "creation_date": 1469099184, "post_id": 38482819, "comment_id": 64403779, "body": "Haha, I did but  votes are not visible for people with under 15 rep"}], "tags": [], "owner": {"reputation": 25863, "user_id": 500974, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/goEft.png?s=128&g=1", "display_name": "Matt Wilko", "link": "https://stackoverflow.com/users/500974/matt-wilko"}, "is_accepted": true, "score": 0, "last_activity_date": 1469023079, "last_edit_date": 1469023079, "creation_date": 1469021642, "answer_id": 38482819, "question_id": 38482746, "link": "https://stackoverflow.com/questions/38482746/vb-net-utilizing-excel-assemblies-memory-leak/38482819#38482819", "title": "VB.Net, Utilizing Excel assemblies, Memory leak", "body": "<p>Here is some fully working open and close code</p>\n\n<pre><code>Private _xlApp As Microsoft.Office.Interop.Excel.Application\nPrivate _xlWSheet As Microsoft.Office.Interop.Excel.Worksheet\nPrivate _xlWBook As Microsoft.Office.Interop.Excel.Workbook\n\nPrivate Sub btnOpen_Click(sender As Object, e As EventArgs) Handles btnOpen.Click\n    Dim filename As String = \"C:\\Scratch\\Test.xlsx\"\n    _xlApp = New Microsoft.Office.Interop.Excel.Application\n    _xlApp.DisplayAlerts = False\n    _xlWBook = _xlApp.Workbooks.Open(filename)\nEnd Sub\n\nPrivate Sub btnClose_Click(sender As Object, e As EventArgs) Handles btnClose.Click\n    'close the workbook and quit the app\n    If _xlWBook IsNot Nothing Then _xlWBook.Close()\n    If _xlApp IsNot Nothing Then _xlApp.Quit()\n    'destroy the objects\n    If _xlWSheet IsNot Nothing Then _xlWSheet = Nothing\n    If _xlWBook IsNot Nothing Then _xlWBook = Nothing\n    If _xlApp IsNot Nothing Then _xlApp = Nothing\n\n    'Force garbage collection\n    GC.Collect()\nEnd Sub\n</code></pre>\n\n<p>Also note that if you are <em>not</em> setting: <code>_xlApp.DisplayAlerts = False</code> then when you close the workbook, if you have any unsaved changes, this will wait for a non existant user to click yes or no to a \"Save Changes\" dialog which will probably cause the objects to hang around</p>\n"}], "owner": {"reputation": 13, "user_id": 6613837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99426a84376610e215bb5677110a070a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip C.", "link": "https://stackoverflow.com/users/6613837/philip-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 2, "accepted_answer_id": 38482819, "answer_count": 1, "score": 1, "last_activity_date": 1469023079, "creation_date": 1469021449, "last_edit_date": 1531161705, "question_id": 38482746, "link": "https://stackoverflow.com/questions/38482746/vb-net-utilizing-excel-assemblies-memory-leak", "title": "VB.Net, Utilizing Excel assemblies, Memory leak", "body": "<p>My program is essentially a form that uses the excel assemblies to open a file and puts the information into array lists. </p>\n\n<p>After running my program multiple iterations I have found that in task manager I have multiple excel files still open, although they are hidden from my task bar. Additionally \"System and compressed memory\" takes up more space each time.</p>\n\n<p>I assume that I did not properly release memory but I am not sure how, I currently have:</p>\n\n<pre><code>shXL = Nothing\nwbXl = Nothing\nappXL.Quit()\nappXL = Nothing\n</code></pre>\n\n<p>Note: shxl is the worksheet, wbxl is the workbook, and appxl is the application.</p>\n\n<p>Any help Would be appreciated</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5218793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/764a458e84513e8472f95b8bc3b66115?s=128&d=identicon&r=PG&f=1", "display_name": "George Halford", "link": "https://stackoverflow.com/users/5218793/george-halford"}, "edited": false, "score": 0, "creation_date": 1469029316, "post_id": 38482959, "comment_id": 64372012, "body": "Thank you I will try this out! :)"}, {"owner": {"reputation": 29, "user_id": 5218793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/764a458e84513e8472f95b8bc3b66115?s=128&d=identicon&r=PG&f=1", "display_name": "George Halford", "link": "https://stackoverflow.com/users/5218793/george-halford"}, "edited": false, "score": 0, "creation_date": 1469030265, "post_id": 38482959, "comment_id": 64372678, "body": "Works well but I had one question, If I wanted to use the left function on cells B and E for example using left(B,4) and left(E,4) these do not work for me. How could I rewrite to incorporate these two things?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 29, "user_id": 5218793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/764a458e84513e8472f95b8bc3b66115?s=128&d=identicon&r=PG&f=1", "display_name": "George Halford", "link": "https://stackoverflow.com/users/5218793/george-halford"}, "edited": false, "score": 0, "creation_date": 1469033163, "post_id": 38482959, "comment_id": 64374463, "body": "<code>Or .Left(Cells(i,&quot;B&quot;),3) &lt;&gt; Left(.Cells(i,&quot;E&quot;),3)</code> ... change 3 as need... you may want to wrap in <code>UCase()</code> if case sensitivity is an issue"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1469021988, "creation_date": 1469021988, "answer_id": 38482959, "question_id": 38482656, "link": "https://stackoverflow.com/questions/38482656/move-a-row-into-another-sheet-if-cells-do-not-match/38482959#38482959", "title": "Move a row into another sheet if cells do not match", "body": "<p>Assume <code>GILMOR</code> starts in column A. Change column references as needed.</p>\n\n<pre><code>Sub SingleTradeMove()\n\n Dim wsTD as Worksheet\n Set wsTD = Worksheets(\"Trade data\")\n\n  Sheets(\"Sheet2\").Range(\"A2:AK600\").ClearContents\n\n  With wsTD\n\n     lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n     For i = 2 To lastRow\n\n        If .Cells(i, \"J\").Value = \"\" Or .Cells(i,\"A\") &lt;&gt; .Cells(i,\"D\") _\n            Or .Cells(i,\"B\") &lt;&gt; .Cells(i,\"E\") _ \n            Or .Cells(i,\"C\") &lt;&gt; .Cells(i,\"F\") Then \n\n           .Cells(i, \"J\").EntireRow.Copy _ \n               Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\n         End If\n\n     Next i\n\n End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5218793, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/764a458e84513e8472f95b8bc3b66115?s=128&d=identicon&r=PG&f=1", "display_name": "George Halford", "link": "https://stackoverflow.com/users/5218793/george-halford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469022327, "creation_date": 1469021250, "last_edit_date": 1469021493, "question_id": 38482656, "link": "https://stackoverflow.com/questions/38482656/move-a-row-into-another-sheet-if-cells-do-not-match", "title": "Move a row into another sheet if cells do not match", "body": "<p>I am trying to create a small piece of code which will move a row to sheet2 if: G&lt;>M \"OR\" I&lt;>0 OR L&lt;>R </p>\n\n<p>For example in my made up table below:</p>\n\n<pre><code>G   I   L   M   O   R \n1   2   3   1   2   4\n</code></pre>\n\n<p>So this particular row would be moved to sheet two as one of the statements was satisfied: L&lt;>R</p>\n\n<p>I have this code so far:</p>\n\n<pre><code> Sub SingleTradeMove()\n lastRow = Sheets(\"Trade data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n Sheets(\"Sheet2\").Range(\"A2:AK600\").ClearContents\n For i = 2 To lastRow\n If Sheets(\"Trade data\").Cells(i, \"J\").Value = \"\" Then\n Sheets(\"Trade data\").Cells(i, \"J\").EntireRow.Copy Destination:=Sheets\n (\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\n End If\n Next i\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6610634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d8c8829de477a93891c7590d943b33?s=128&d=identicon&r=PG&f=1", "display_name": "Pilarczyk86", "link": "https://stackoverflow.com/users/6610634/pilarczyk86"}, "edited": false, "score": 0, "creation_date": 1469023424, "post_id": 38483259, "comment_id": 64369179, "body": "Unfortunately I&#39;m still getting the same error on the &quot;For Each cell&quot; line."}], "tags": [], "owner": {"reputation": 404, "user_id": 6445909, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ed5578df506ea24f73c59e8fc7fca753?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Welsch", "link": "https://stackoverflow.com/users/6445909/christian-welsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1469022785, "creation_date": 1469022785, "answer_id": 38483259, "question_id": 38482652, "link": "https://stackoverflow.com/questions/38482652/change-a-range-of-cells-on-one-or-more-sheets-based-on-a-selected-range-of-cells/38483259#38483259", "title": "Change a range of cells on one or more sheets based on a selected range of cells in a main sheet", "body": "<p>This should work:</p>\n\n<pre><code>Sub test()\n\n    With Selection\n        startRow = .Cells(1).Row\n        startColumn = .Cells(1).Column\n        endRow = .Cells(.Cells.Count).Row\n        endColumn = .Cells(.Cells.Count).Column\n    End With\n    If Range(\"AN6\").Text = \"Office\" Then\n        For n = 1 To Sheets.Count - 2\n            If Sheets(n).Range(\"AN6\").Text = \"Office\" And Sheets(n).CheckBox1.value = False Then\n                For Each cell In Range(Sheets(n).Cells(startRow, startColumn), Sheets(n).Cells(endRow, endColumn))\n                    cell.Interior.ColorIndex = 56\n                Next cell\n            End If\n        Next n\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6610634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d8c8829de477a93891c7590d943b33?s=128&d=identicon&r=PG&f=1", "display_name": "Pilarczyk86", "link": "https://stackoverflow.com/users/6610634/pilarczyk86"}, "edited": false, "score": 0, "creation_date": 1469025543, "post_id": 38483510, "comment_id": 64370799, "body": "This worked for the first sheet that met the criteria, but when it got to the second one it came up with the same error."}, {"owner": {"reputation": 3, "user_id": 6610634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d8c8829de477a93891c7590d943b33?s=128&d=identicon&r=PG&f=1", "display_name": "Pilarczyk86", "link": "https://stackoverflow.com/users/6610634/pilarczyk86"}, "edited": false, "score": 0, "creation_date": 1469029042, "post_id": 38483510, "comment_id": 64371823, "body": "Scratch that, I had the other sheets protected so I had to unprotect them as needed to solve the issue. Thanks! This works perfectly!"}], "tags": [], "owner": {"reputation": 37, "user_id": 5119846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/801ad618315b8bafa4fe1a7f8470da50?s=128&d=identicon&r=PG&f=1", "display_name": "Matan P", "link": "https://stackoverflow.com/users/5119846/matan-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1469023445, "creation_date": 1469023445, "answer_id": 38483510, "question_id": 38482652, "link": "https://stackoverflow.com/questions/38482652/change-a-range-of-cells-on-one-or-more-sheets-based-on-a-selected-range-of-cells/38483510#38483510", "title": "Change a range of cells on one or more sheets based on a selected range of cells in a main sheet", "body": "<p>You can use the .Address property of a range. I'm pretty sure you're getting an error because your selection is in one sheet, and you try to refer to that range in another sheet. Using just the address of the range should fix that issue. </p>\n\n<pre><code>Dim cell As Range\nDim n As Integer\nSet cell = Selection\nIf Range(\"AN6\").Text = \"Office\" Then\n    For n = 1 To Sheets.Count - 2\n        If Sheets(n).Range(\"AN6\").Text = \"Office\" And Sheets(n).CheckBox1.value = False Then\n            For Each cell In Selection\n                Sheets(n).Range(cell.Address(False,False)).Interior.ColorIndex = 56\n            Next cell\n        End If\n    Next n\nEnd If\n</code></pre>\n\n<p>The only testing I did on this code was using this sub. I selected a range on my worksheet and ran the macro and the msg box said Q12:U26</p>\n\n<pre><code>Sub test()\n    Dim cell As Range\n    Set cell = Selection\n    MsgBox cell.Address(False, False)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6610634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d8c8829de477a93891c7590d943b33?s=128&d=identicon&r=PG&f=1", "display_name": "Pilarczyk86", "link": "https://stackoverflow.com/users/6610634/pilarczyk86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 38483510, "answer_count": 2, "score": 0, "last_activity_date": 1469023445, "creation_date": 1469021247, "question_id": 38482652, "link": "https://stackoverflow.com/questions/38482652/change-a-range-of-cells-on-one-or-more-sheets-based-on-a-selected-range-of-cells", "title": "Change a range of cells on one or more sheets based on a selected range of cells in a main sheet", "body": "<p>I'd like to preface this by saying that I'm largely inexperienced with coding. I've been working on a project at work on my own, and finally ran into a wall that I can't solve by simple googling.</p>\n\n<p>To explain briefly with pertinent details, I have a workbook with a varying number of worksheets that each have a specific cell for text (explained later), and a checkbox.</p>\n\n<p>My goal is to select a range of cells, usually 1-5 in a row, and then have a button to change the color of the same selected cells of all sheets given a specific criteria. The criteria being that only the sheets that have \"Office\" listed in the aforementioned cell, and the check box un-checked, will be changed.</p>\n\n<p>While I have no issue having Excel cycle through the sheets and do something only on the sheets that meet the criteria, the problem comes with trying to edit the same cells as are selected on the main sheet.</p>\n\n<p>The coding I have come up with so far:</p>\n\n<pre><code>Dim cell As Range\nDim n As Integer\nSet cell = Selection\nIf Range(\"AN6\").Text = \"Office\" Then\n    For n = 1 To Sheets.Count - 2\n        If Sheets(n).Range(\"AN6\").Text = \"Office\" And Sheets(n).CheckBox1.value = False Then\n            For Each cell In Selection\n                Sheets(n).Range(cell).Interior.ColorIndex = 56\n            Next cell\n        End If\n    Next n\nEnd If\n</code></pre>\n\n<p>The error I am getting is: Application-defined or object-defined error.</p>\n\n<p>Hopefully there is a way to execute this. I'd greatly appreciate any help I can get.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 4, "creation_date": 1469021204, "post_id": 38482579, "comment_id": 64367348, "body": "Please edit your question to include code in the body of question and not as a snapshot."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469022257, "post_id": 38482579, "comment_id": 64368257, "body": "Are you getting errors? If so, try taking the parenthesis away from the variables you pass to the function. <code>RuleOne RowCount</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469022313, "post_id": 38482579, "comment_id": 64368307, "body": "<a href=\"http://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\" title=\"loop through all subfolders using vba\">stackoverflow.com/questions/22645347/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 6410118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/855fa6b54a07e8c1e660dfa932082a0d?s=128&d=identicon&r=PG&f=1", "display_name": "wiesliam", "link": "https://stackoverflow.com/users/6410118/wiesliam"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1469022711, "post_id": 38482579, "comment_id": 64368622, "body": "Got it, thanks @skkakkar!"}, {"owner": {"reputation": 3, "user_id": 6410118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/855fa6b54a07e8c1e660dfa932082a0d?s=128&d=identicon&r=PG&f=1", "display_name": "wiesliam", "link": "https://stackoverflow.com/users/6410118/wiesliam"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469022769, "post_id": 38482579, "comment_id": 64368647, "body": "@Nathan_Sav that question is quite different in that it is trying to loop through subfolders in a folder, but I really appreciate it."}, {"owner": {"reputation": 3, "user_id": 6410118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/855fa6b54a07e8c1e660dfa932082a0d?s=128&d=identicon&r=PG&f=1", "display_name": "wiesliam", "link": "https://stackoverflow.com/users/6410118/wiesliam"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469022843, "post_id": 38482579, "comment_id": 64368713, "body": "@BruceWayne the first error I&#39;m getting is presumably very simple, it&#39;s with the line: If Range(RowCount, 1).Value = 1 Then"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469023248, "post_id": 38482579, "comment_id": 64369023, "body": "Sorry, I copied the wrong link, but from the File System Object you can get the created and last modified dates."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1469024557, "post_id": 38482579, "comment_id": 64370044, "body": "You never set <code>RowCount</code> as a variable. That&#39;s why you&#39;re getting an error.  Do you mean <code>NumRows</code>??  Also, I&#39;d add <code>Option Explicit</code> above <code>Private Sub ...</code> to force declaration of all variables, this could have helped catch <code>RowCount</code> wasn&#39;t declared."}], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 0, "last_activity_date": 1469023123, "creation_date": 1469023123, "answer_id": 38483388, "question_id": 38482579, "link": "https://stackoverflow.com/questions/38482579/loop-through-excel-rows-and-call-vba-functions/38483388#38483388", "title": "Loop through excel rows and call VBA functions", "body": "<p>Try to change the <code>Range(RowCount, 1).Value = 1</code> to <code>Cells(x, 2).Value = 1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5747359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d942c9cb8cdc3dd5bb2787450a748bb?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5747359/ian"}, "is_accepted": false, "score": 0, "last_activity_date": 1469030903, "creation_date": 1469030903, "answer_id": 38485590, "question_id": 38482579, "link": "https://stackoverflow.com/questions/38482579/loop-through-excel-rows-and-call-vba-functions/38485590#38485590", "title": "Loop through excel rows and call VBA functions", "body": "<p>The variable RowCount has not been initialised/set.\nI assume this is what this variable is meant to be the number in column B </p>\n\n<pre><code>RowCount = Cells(x, \"B\").Value\n</code></pre>\n\n<p>I also noticed that the variable NumRows seemed to be one less than it should be (so if the last row was 1 it would skip it). So I used this instead:</p>\n\n<pre><code>NumRows = Cells(Rows.Count, \"B\").End(xlUp).Row\n</code></pre>\n\n<p>So try this code:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Dim x As Integer\n    NumRows = Cells(Rows.Count, \"B\").End(xlUp).Row\n    For x = 1 To NumRows\n        RowCount = Range(\"B\" &amp; x).Value\n        If RowCount = 1 Then\n             RuleOne (x)\n        End If\n    Next\n\n    'Dim RowCount As Integer\n    'RowCount = 1\n    'Worksheets(\"Sheet2\").Cells(1, 2) = Worksheets(\"Sheet1\").UsedRange.Row.Count\n\n    'While RowCount &lt; Worksheets(\"Sheet1\").Rows\n      'If Worksheets(\"Sheet1\").Cells(RowCount, 1).Value = 1 Then\n          'RuleOne (RowCount)\n      'End If\n    'Wend\nEnd Sub\n\nSub RuleOne(i As Integer)\n    'use filedatetime and path from i cell\n    'Worksheets(\"Sheet2\").Cells(1, 1) = FileDateTime(C, i)\n    Worksheets(\"Sheet2\").Cells(1, i) = \"hello\"\nEnd Sub\n\nSub RuleTwo(i As Integer)\n    Worksheets(\"Sheet2\").Cells(1, 1) = \"hello\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6410118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/855fa6b54a07e8c1e660dfa932082a0d?s=128&d=identicon&r=PG&f=1", "display_name": "wiesliam", "link": "https://stackoverflow.com/users/6410118/wiesliam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1066, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469030903, "creation_date": 1469021059, "last_edit_date": 1469022658, "question_id": 38482579, "link": "https://stackoverflow.com/questions/38482579/loop-through-excel-rows-and-call-vba-functions", "title": "Loop through excel rows and call VBA functions", "body": "<p>I need to be able to loop through my rows (specifically, column B), and use the number in a certain cell in order to do specific functions using other cells in that row. For example, Rule #1 indicates that I need to find last modified date of the path in the cell next to the Rule #, but the task is different for each Rule.</p>\n\n<p>I'm new to VBA and I've just been struggling with setting up a loop and passing variables to different subs, and would hugely appreciate any help. To be clear, I'm looking for syntax help with the loop and passing variables </p>\n\n<p>Thank you!</p>\n\n<p>Reference Images: <a href=\"http://i.stack.imgur.com/F0u6X.png\" rel=\"nofollow\">The spreadsheet</a> </p>\n\n<p><a href=\"http://i.stack.imgur.com/JoCFZ.png\" rel=\"nofollow\">The attempt at sketching out the code</a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim x As Integer\n    NumRows = Range(\"B2\", Range(\"B2\").End(xlDown)).Rows.Count\n    Range(\"B2\").Select\n    For x = 1 To NumRows\n        If Range(RowCount, 1).Value = 1 Then\n             RuleOne (RowCount)\n        End If\n    Next\n\n    'Dim RowCount As Integer\n    'RowCount = 1\n    'Worksheets(\"Sheet2\").Cells(1, 2) = Worksheets(\"Sheet1\").UsedRange.Row.Count\n\n    'While RowCount &lt; Worksheets(\"Sheet1\").Rows\n      'If Worksheets(\"Sheet1\").Cells(RowCount, 1).Value = 1 Then\n          'RuleOne (RowCount)\n      'End If\n    'Wend\nEnd Sub\n\nSub RuleOne(i As Integer)\n    'use filedatetime and path from i cell\n    'Worksheets(\"Sheet2\").Cells(1, 1) = FileDateTime(C, i)\n    Worksheets(\"Sheet2\").Cells(1, 1) = \"hello\"\nEnd Sub\n\nSub RuleTwo(i As Integer)\n    Worksheets(\"Sheet2\").Cells(1, 1) = \"hello\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "export", "text-files", "vba"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1469024030, "post_id": 38483491, "comment_id": 64369608, "body": "I was confused, but I trusted you and it works, I will take a time and understand it later, thank you @user35611813"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1469024168, "post_id": 38483491, "comment_id": 64369715, "body": "@BKChedlia Consider marking the question as answered so that other users know the problem is resolved. On a side note, it looks like you&#39;re trying to parse your spreadsheet into a <code>JSON</code> type of format. If this is the case, it may be syntactically incorrect since you open <code>Arrays</code> but don&#39;t close them. Follow up with a new question if this is the case."}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1469025565, "post_id": 38483491, "comment_id": 64370826, "body": "ts.Close doesn&#39;t close this arrays ?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1469035345, "post_id": 38483491, "comment_id": 64375708, "body": "@BKChedlia ts.Close closes the text file. In your ouput, you write: <code>cases:[{AimsId:69210794,...}</code> The <code>[</code> character opens an array, but the array is never closed using a <code>]</code>"}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1469082169, "post_id": 38483491, "comment_id": 64392865, "body": "I understand you, I made a close ] , for the lastrow , I will Add the last updates. Thank you a lot for your help"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1469023397, "creation_date": 1469023397, "answer_id": 38483491, "question_id": 38482543, "link": "https://stackoverflow.com/questions/38482543/copy-sheet-to-text-file-with-specific-template-skips-even-numbers/38483491#38483491", "title": "copy sheet to text file with specific template skips even numbers", "body": "<p>The problem lies in your <code>For Each</code> loop as detailed below.</p>\n\n<pre><code>  For Each a In rng\n    cellAimsID = a.Cells(a.Row, 1)\n    cellAmount = a.Cells(a.Row, 2)\n    cellCurrencyISO = a.Cells(a.Row, 3)\n    cellReason = a.Cells(a.Row, 4)\n    cellExpiryDate = a.Cells(a.Row, 5)\n</code></pre>\n\n<p>In this loop, the variable <code>a</code> refers to a <code>Range</code> object. Yet, inside of the loop, you assign to each variable a <code>Range</code> property of a <code>Range</code> object. Let's take a closer look as an example:</p>\n\n<pre><code>`cellAimsID = a.Cells(a.Row, 1)\n</code></pre>\n\n<p>Let's assume you are on the second iteration of the loop, and the variable <code>a</code> refers to cell <code>A3</code>. The syntax above says <code>cellsAimsID = Range(\"A3\").Range(\"A3\")</code>. What happens when we apply a <code>Range</code> property to a <code>Range</code> object? It basically offsets cell. In that above example, the cell pointer essentially moves to a cell that would be the third cell in Column A IF the range started with A3.</p>\n\n<p>I know that sounds a bit confusing, but follow up if you have questions.</p>\n\n<p>To fix the error, replace the syntax with (notice I removed the <code>a</code> qualifier):</p>\n\n<pre><code>cellAimsID = Cells(a.Row, 1)\ncellAimsID = Cells(a.Row, 1)\n</code></pre>\n\n<p>As a side note, it is a good practice to fully qualify your ranges with a sheet name in case your macro ever does processing on different sheets. So it would be <em>even</em> better to change the code to:</p>\n\n<pre><code>cellAimsID = wsDest.Cells(a.Row, 1)\ncellAimsID = wsDest.Cells(a.Row, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "is_accepted": false, "score": 0, "last_activity_date": 1469082377, "creation_date": 1469082377, "answer_id": 38496480, "question_id": 38482543, "link": "https://stackoverflow.com/questions/38482543/copy-sheet-to-text-file-with-specific-template-skips-even-numbers/38496480#38496480", "title": "copy sheet to text file with specific template skips even numbers", "body": "<p>This is my code after changes, \nIt allows the export of a worksheet in text file with specific template.\nPS : Last line have a close Array so I did it outside the range.</p>\n\n<pre><code> Option Explicit\n\n Sub txtFile()\n\n  Dim strPath As String\n  Dim fso As Object\n  Dim ts As Object\n\n   Dim wsDest As Worksheet\n   Set wsDest = Sheets(\"Filter FS\")\n   wsDest.Select\n  Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n  Dim cellAimsID As Variant\n  Dim cellAmount As Variant\n  Dim cellCurrencyISO As Variant\n  Dim cellReason As Variant\n  Dim cellExpiryDate As Variant\n  Dim FirstRow As String\n  Dim LastRow As String\n  Dim LastRowB As String\n  Dim a As Range, b As Range, cell As String, rng As Range, Lastrng As Range\n  Set a = Selection\n  Set ts = fso.CreateTextFile(\"C:\\Users\\cben\\Documents\\BKC\\FinancialSecurity\\test20.txt\", True, True)\n  ' for each cell in the worksheet create a line in text fil\n FirstRow = wsDest.UsedRange.Rows(1).Row\n LastRow = wsDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n LastRowB = (wsDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row) - 1\n Set rng = wsDest.Range(\"A2:A\" &amp; LastRowB)\n Set Lastrng = wsDest.Range(\"A\" &amp; LastRow)\n  ts.WriteLine (\"{\")\n  ts.WriteLine (Chr(9) &amp; \"\u201ccases\u201d\" &amp; \": [\")\n  For Each a In rng\ncellAimsID = Cells(a.Row, 1)\ncellCurrencyISO = Cells(a.Row, 2)\ncellAmount = Cells(a.Row, 3)\ncellReason = Cells(a.Row, 4)\ncellExpiryDate = Cells(a.Row, 5)\n\n'AimsID, Amount, Currency, Reason, ExpiryDate are the name of columns in worksheet\n\n  ts.WriteLine (Chr(9) &amp; \"{\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cAimsID\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellAimsID &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cAmount\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellAmount &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cCurrencyISO\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellCurrencyISO &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cReason\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellReason &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cExpiryDate\u201d\" &amp; \":\" &amp; Chr(9) &amp; \"\u201c\" &amp; cellExpiryDate &amp; \"\u201d\")\n  ts.WriteLine (Chr(9) &amp; \"}\" &amp; \",\")\n\n  Next\n\ncellAimsID = Cells(LastRow, 1)\ncellCurrencyISO = Cells(LastRow, 2)\ncellAmount = Cells(LastRow, 3)\ncellReason = Cells(LastRow, 4)\ncellExpiryDate = Cells(LastRow, 5)\n\n  ts.WriteLine (Chr(9) &amp; \"{\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cAimsID\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellAimsID &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cAmount\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellAmount &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cCurrencyISO\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellCurrencyISO &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cReason\u201d\" &amp; \":\" &amp; Chr(9) &amp; cellReason &amp; \",\")\n  ts.WriteLine (Chr(9) &amp; \"\u201cExpiryDate\u201d\" &amp; \":\" &amp; Chr(9) &amp; \"\u201c\" &amp; cellExpiryDate &amp; \"\u201d\")\n  ts.WriteLine (Chr(9) &amp; \"}\" &amp; \"]\")\n  ts.WriteLine (\"}\")\n ts.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 38483491, "answer_count": 2, "score": 0, "last_activity_date": 1469082377, "creation_date": 1469020951, "last_edit_date": 1531161705, "question_id": 38482543, "link": "https://stackoverflow.com/questions/38482543/copy-sheet-to-text-file-with-specific-template-skips-even-numbers", "title": "copy sheet to text file with specific template skips even numbers", "body": "<p>I want to copy sheet to text file with specific template, I defined a range but the problem is it skips even numbers it means rows A2, A4,A6... not copied\nso it brings at the end of the result empty rows</p>\n\n<pre><code>Option Explicit\n\n Sub txtFile()\n\n  Dim strPath As String\n  Dim fso As Object\n  Dim ts As Object\n\n   Dim wsDest As Worksheet\n   Set wsDest = Sheets(\"Filter FS\")\n   wsDest.Select\n  Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n  Dim cellAimsID As Variant\n  Dim cellAmount As Variant\n  Dim cellCurrencyISO As Variant\n  Dim cellReason As Variant\n  Dim cellExpiryDate As Variant\n  Dim FirstRow As String\n  Dim LastRow As String\n\n  Dim a As Range, b As Range, cell As String, rng As Range\n  Set a = Selection\n  Set ts = fso.CreateTextFile(\"C:\\Users\\cben\\Documents\\BKC\\FinancialSecurity\\test13.txt\", True, True)\n  ' for each cell in the worksheet create a line in text fil\n FirstRow = wsDest.UsedRange.Rows(1).Row\n LastRow = wsDest.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n Set rng = wsDest.Range(\"A2:A\" &amp; LastRow)\n 'Set rng = wsDest.Range(\"A1:A5\")\n  For Each a In rng\n    cellAimsID = a.Cells(a.Row, 1)\n    cellAmount = a.Cells(a.Row, 2)\n    cellCurrencyISO = a.Cells(a.Row, 3)\n    cellReason = a.Cells(a.Row, 4)\n    cellExpiryDate = a.Cells(a.Row, 5)\n\n    'AimsID, Amount, Currency, Reason, ExpiryDate are the name of columns in worksheet\n      ts.WriteLine (Chr(9) &amp; \"cases\" &amp; \": [\")\n      ts.WriteLine (Chr(9) &amp; \"{\")\n      ts.WriteLine (Chr(9) &amp; \"AimsID:\" &amp; cellAimsID &amp; \",\")\n      ts.WriteLine (Chr(9) &amp; \"Amount:\" &amp; cellAmount &amp; \",\")\n      ts.WriteLine (Chr(9) &amp; \"CurrencyISO:\" &amp; cellCurrencyISO &amp; \",\")\n      ts.WriteLine (Chr(9) &amp; \"Reason:\" &amp; cellReason &amp; \",\")\n      ts.WriteLine (Chr(9) &amp; \"ExpiryDate:\" &amp; cellExpiryDate &amp; \",\")\n      ts.WriteLine (Chr(9) &amp; \"}\" &amp; \",\")\n\n  Next\n ts.Close\n\nEnd Sub\n</code></pre>\n\n<p>here is the result</p>\n\n<p><a href=\"https://i.stack.imgur.com/TGeg8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TGeg8.png\" alt=\"enter image description here\"></a></p>\n\n<p>for exemple AimsID= 69210794 correspond to A41 next AimsID =86917526 corresponds to A43 not A42 in the result</p>\n"}, {"tags": ["database", "vba", "ms-access", "ms-access-2013"], "comments": [{"owner": {"reputation": 1308, "user_id": 3017149, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/K18gw.jpg?s=128&g=1", "display_name": "Tedo G.", "link": "https://stackoverflow.com/users/3017149/tedo-g"}, "edited": false, "score": 0, "creation_date": 1469021041, "post_id": 38482410, "comment_id": 64367205, "body": "Have you tried to compile step by step? stop the program at that sub and step forward."}, {"owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "reply_to_user": {"reputation": 1308, "user_id": 3017149, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/K18gw.jpg?s=128&g=1", "display_name": "Tedo G.", "link": "https://stackoverflow.com/users/3017149/tedo-g"}, "edited": false, "score": 0, "creation_date": 1469021066, "post_id": 38482410, "comment_id": 64367231, "body": "I have not will try that now."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1469021239, "post_id": 38482410, "comment_id": 64367378, "body": "Agree w/@TedoG. - debugging step by step is <i>always</i> the first thing to do when something&#39;s not working right."}, {"owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "edited": false, "score": 0, "creation_date": 1469021325, "post_id": 38482410, "comment_id": 64367444, "body": "I have figured it, I just code straight through my subform with setting up an event procedure for resume source internal."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 1, "creation_date": 1469023953, "post_id": 38482410, "comment_id": 64369566, "body": "If you have figured it out yourself, please close/delete this question as it doesn&#39;t really have a wide user-based need."}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1469021203, "creation_date": 1469021203, "answer_id": 38482631, "question_id": 38482410, "link": "https://stackoverflow.com/questions/38482410/running-a-vba-code-within-access/38482631#38482631", "title": "Running a VBA code within Access", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Resume_Source_Internal_Click()\n   If [Resume Source Internal].Value = True Then\n      [Personal Reference].Enabled = True\n      [Resume Previous Location].Enabled = False\n   Else\n      [Personal Reference].Enabled = False\n      [Resume Previous Location].Enabled = True\n   End If\nEnd Sub\n</code></pre>\n\n<p>Note that in the <code>Else</code>, I switched the values of <code>False</code> and <code>True</code>. As you have it written, you're setting the exact same values on both sides of the <code>If...Else</code></p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1469031371, "creation_date": 1469031371, "answer_id": 38485736, "question_id": 38482410, "link": "https://stackoverflow.com/questions/38482410/running-a-vba-code-within-access/38485736#38485736", "title": "Running a VBA code within Access", "body": "<p>Would this code work for you - set the fields to one enabled and one disabled in the Property Sheet.</p>\n\n<p>When you click the button the enabled property will switch from True to False and vice-versa.</p>\n\n<pre><code>Private Sub Resume_Source_Internal_Click()\n\n    Me.Personal_Reference.Enabled = Not Me.Personal_Reference.Enabled\n    Me.Resume_Previous_Location.Enabled = Not Me.Resume_Previous_Location.Enabled\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 6584970, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0115a1c68392ec4ca892d04d83ec5da0?s=128&d=identicon&r=PG&f=1", "display_name": "Orange56", "link": "https://stackoverflow.com/users/6584970/orange56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 38482631, "answer_count": 2, "score": 1, "last_activity_date": 1469031371, "creation_date": 1469020593, "question_id": 38482410, "link": "https://stackoverflow.com/questions/38482410/running-a-vba-code-within-access", "title": "Running a VBA code within Access", "body": "<p>I am currently working within Access 2013. I have two fields within a subform that I would like to lock if a button (yes/no field) is selected these two fields include Resume previous location and Personal Reference, the yes/no field is Resume Source Internal. </p>\n\n<p>My code:</p>\n\n<pre><code>Private Sub Resume_Source_Internal_Click()\n   If [Resume Source Internal].Value = True Then\n      [Personal Reference].Enabled = True\n      [Resume Previous Location].Enabled = False\n   Else\n      [Personal Reference].Enabled = True\n      [Resume Previous Location].Enabled = False\n   End If\nEnd Sub\n</code></pre>\n\n<p>The problem that I am having trouble with is that when I am selecting the button (yes/no) nothing is happening. I have ran this code before in another form and it worked perfectly. Is there anything that I could have missed? Personal Reference and Resume Previous Location are both look up fields.  </p>\n"}, {"tags": ["vba", "excel", "onedrive"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1469020879, "post_id": 38482264, "comment_id": 64367078, "body": "Have you tried to assign a mapped drive designator <i>(like D: or E:)</i> to the OneDrive folder ??"}, {"owner": {"reputation": 688, "user_id": 5878789, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22b3eb794027cc5e5eabc50b61a2ecfc?s=128&d=identicon&r=PG&f=1", "display_name": "tomdemaine", "link": "https://stackoverflow.com/users/5878789/tomdemaine"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1469025283, "post_id": 38482264, "comment_id": 64370588, "body": "@Gary&#39;s Student I can&#39;t alter the settings of the one drive is your suggestion something that I can do unilaterally?"}], "owner": {"reputation": 688, "user_id": 5878789, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22b3eb794027cc5e5eabc50b61a2ecfc?s=128&d=identicon&r=PG&f=1", "display_name": "tomdemaine", "link": "https://stackoverflow.com/users/5878789/tomdemaine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1601, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469025042, "creation_date": 1469020212, "last_edit_date": 1531164843, "question_id": 38482264, "link": "https://stackoverflow.com/questions/38482264/can-you-access-data-in-files-stored-on-onedrive-using-an-excel-macro", "title": "Can you access data in files stored on Onedrive using an Excel macro?", "body": "<p>I have a process that every day takes a day's worth of company data and inserts it into an Excel file which is then transferred via FTP to a folder on the company's Onedrive account. I want to be able to automatically amalgamate these daily files into a master file at the end of each month without having to go through one by one downloading copying and pasting. </p>\n\n<p>Is there some clever VBA (or otherwise) way to tell excel to go to onedrive, open each of the 30/31 daily files and copy the contents of the DATA tab from them into the DATA tab of one central file? If not what would the macro look like if the files are already downloaded and saved on my computer?  That way I can at least save some copy-paste time. </p>\n"}, {"tags": ["vba", "macros", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "is_accepted": false, "score": 1, "last_activity_date": 1469020111, "creation_date": 1469020111, "answer_id": 38482225, "question_id": 38481912, "link": "https://stackoverflow.com/questions/38481912/i-cant-get-this-macro-to-run-when-opening-a-document/38482225#38482225", "title": "I can&#39;t get this Macro to run when opening a document", "body": "<p>I found that it's Document_New instead of Document_Open</p>\n\n<pre><code>Private Sub Document_New()\n    Dim objExcel As Object\n    Dim FileName As String\n    Dim cc As ContentControl\n\n    FileName = \"Z:\\\" &amp; \"\\Data.xlsx\"\n    Set objExcel = CreateObject(\"Excel.Application\")\n    Set exWb = objExcel.Workbooks.Open(FileName)\n\n    For Each cc In ActiveDocument.SelectContentControlsByTag(\"Name\")\n        cc.Range.Text = exWb.Sheets(\"4\").Cells(1, 2)\n    Next\n\n    exWb.Close\n    Set exWb = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469020111, "creation_date": 1469019262, "question_id": 38481912, "link": "https://stackoverflow.com/questions/38481912/i-cant-get-this-macro-to-run-when-opening-a-document", "title": "I can&#39;t get this Macro to run when opening a document", "body": "<pre><code>Private Sub Document_Open()\n    Dim objExcel As Object\n    Dim FileName As String\n    Dim cc As ContentControl\n\n    FileName = \"Z:\\\" &amp; \"\\Data.xlsx\"\n    Set objExcel = CreateObject(\"Excel.Application\")\n    Set exWb = objExcel.Workbooks.Open(FileName)\n\n    For Each cc In ActiveDocument.SelectContentControlsByTag(\"Name\")\n        cc.Range.Text = exWb.Sheets(\"4\").Cells(1, 2)\n    Next\n\n    exWb.Close\n    Set exWb = Nothing\nEnd Sub\n</code></pre>\n\n<p>The file is saved as a <strong>Word Macro-Enabled Template</strong> so double clicking it creates a new file called <strong>Document1</strong> but the Macro doesn't appear to run because the content control is blank. However if I run the same code via \"Macros\" (under Developer), the form fills in.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 2, "creation_date": 1469019069, "post_id": 38481639, "comment_id": 64365674, "body": "In general, variables (even global ones) are destroyed when excel is closed, so very hidden sheets are the best way to store that kind of data.  However, <a href=\"https://www.experts-exchange.com/articles/1135/Use-Excel&#39;s-hidden-data-store-to-share-data-across-VBA-projects.html\" rel=\"nofollow noreferrer\">this resource</a>, though complex and from <i>that other site with hyphens</i>, may be helpful for you in providing an alternative"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469019643, "post_id": 38481639, "comment_id": 64366109, "body": "@RGA thanks, but it only holds the data if you don&#39;t close Excel. So when our users power down / reboot after the weekend it will disappear"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1469019762, "post_id": 38481639, "comment_id": 64366207, "body": "You could create a simple Access database with a table or two to store the values and read them from there via ODBC."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 2, "creation_date": 1469019900, "post_id": 38481639, "comment_id": 64366341, "body": "Check out this post. <a href=\"http://stackoverflow.com/questions/32970489/store-settings-on-user-pc/32970785#32970785\" title=\"store settings on user pc\">stackoverflow.com/questions/32970489/store-settings-on-user-&zwnj;&#8203;pc/&hellip;</a>  Here I answer how to store variables in the registry.  You will be able to read them the next time the program starts, but only on the same machine.  Might work for you."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1469022475, "post_id": 38481639, "comment_id": 64368450, "body": "@MatthewD great stuff, loves this solution, Thanks :)"}], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501325466, "creation_date": 1469018530, "last_edit_date": 1531164843, "question_id": 38481639, "link": "https://stackoverflow.com/questions/38481639/save-variables-and-parameters-values-inside-the-vb-project", "title": "Save Variables and Parameters Values inside the VB Project", "body": "<p>I have 2 userforms. One below is the <em>Main Menu</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PUYlU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PUYlU.jpg\" alt=\"Main-Menu form\"></a></p>\n\n<p>and the second has <em>Advanced Options</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f8KVD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f8KVD.jpg\" alt=\"Options form\"></a></p>\n\n<p>The second form is reading values and parameters from an Excel file (hidden worksheet), so every time I close the file it saves the parameters for next time I open the file.</p>\n\n<p><strong>Question:</strong> is there a way to store these variables inside the VB Project, in a way that they will be saved when closing the file, and next time when I open the file I can read them ? </p>\n\n<p>Maybe there is a work-around by using some kind of a special class? </p>\n"}, {"tags": ["excel", "notifications", "macros", "send", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1469018691, "post_id": 38481033, "comment_id": 64365392, "body": "What about the <code>Worksheet_Change</code> event?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6613608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d2a71741600dd4965842878b88c73a?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/6613608/andy"}, "edited": false, "score": 0, "creation_date": 1470659070, "post_id": 38509575, "comment_id": 65023779, "body": "Thank you Imran a lot, but could you explain a little bit more about what you mean by adjusting sendmail code?I tried your code as you wrote above but nothing happen :("}], "tags": [], "owner": {"reputation": 1, "user_id": 6620844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f793c47c642a82aae4a2a3e8990187?s=128&d=identicon&r=PG&f=1", "display_name": "Imran Shaikh", "link": "https://stackoverflow.com/users/6620844/imran-shaikh"}, "is_accepted": false, "score": 0, "last_activity_date": 1469118403, "creation_date": 1469118403, "answer_id": 38509575, "question_id": 38481033, "link": "https://stackoverflow.com/questions/38481033/macro-send-notification-when-release-date-is-not-valid-anymore/38509575#38509575", "title": "Macro send notification when release date is not valid anymore", "body": "<p>Use this code in worksheet_change event. It will compare the date in all the changed cells in column \"D\" and if condition is true, it will call the sendmail procedure. Please adjust your sendmail code accordingly.\nThis code also works if you copy paste multiple rows of data.\nHope that help!. :-)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim to_email As String\nDim subject As String\nDim body As String\nFor Each cell In Target.Cells\n    On Error Resume Next\n    If cell.Column = 4 And cell &lt; Date Then\n        On Error GoTo errhandler\n        to_email = ActiveSheet.Cells(cell.Row, \"L\").Value\n        subject = \"Release Date Changed\"\n        body = \"Dear \" &amp; ActiveSheet.Cells(cell.Row, \"E\").Value _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                \"The release date of \" &amp; ActiveSheet.Cells(cell.Row, \"A\").Value &amp; _\n                \" is changed to \" &amp; ActiveSheet.Cells(cell.Row, 4) _\n                &amp; vbNewLine &amp; vbNewLine _\n                &amp; vbNewLine &amp; vbNewLine &amp; _\n                \"Regards,\" &amp; vbNewLine &amp; _\n                \"Your Name\"\n        sendmail to_email, subject, body\n    End If\nNext cell\n\nExit Sub\n\nerrhandler:\nErr.Raise Err.Number, Err.Source, Err.Description\n\nEnd Sub\n\n\n\nSub sendmail(to_email As String, subject As String, body As String)\n</code></pre>\n\n<blockquote>\n  <p>adjust your code accordingly</p>\n</blockquote>\n\n<pre><code>End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6613608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d2a71741600dd4965842878b88c73a?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/6613608/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469118403, "creation_date": 1469016895, "last_edit_date": 1531161705, "question_id": 38481033, "link": "https://stackoverflow.com/questions/38481033/macro-send-notification-when-release-date-is-not-valid-anymore", "title": "Macro send notification when release date is not valid anymore", "body": "<p>Next is some macro which compare cell D with current date and if it is in past it send notification to email defined in cell L. The problem here is that the macro need to be run manually by pressing Alt+F8, so the question is how to make the macro automatically run when it noticed that updated cell D value is in past, so there is no need all the time to run the macro manually.</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>Sub SendMail()\nDim OutApp As Object\nDim OutMail As Object\nDim RelDate As Range\nDim lastRow As Long\nDim dateCell, dateCell1 As Date\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\nOutApp.Session.Logon\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nOn Error GoTo cleanup\nFor Each RelDate In Range(\"D2:D\" &amp; lastRow)\nIf RelDate = \"\" Then GoTo 1\ndateCell = RelDate.Value\ndateCell1 = Cells(RelDate.Row, \"C\").Value\n\nIf dateCell &lt; Date Then ' this if cell value is smalle than today then   it will send notification\n      Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = Cells(RelDate.Row, \"L\").Value\n            .Subject = \"Release Date Changed\"         ' Change your massage subject here\n            'Change body of the massage here\n            .Body = \"Dear \" &amp; Cells(RelDate.Row, \"E\").Value _\n                    &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"The release date of \" &amp; Cells(RelDate.Row, \"A\").Value &amp; _\n                    \" is changed to \" &amp; dateCell _\n                    &amp; vbNewLine &amp; vbNewLine _\n                    &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Regards,\" &amp; vbNewLine &amp; _\n                    \"Your Name\"\n            .send\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\n    ' Cells(RelDate.Row, \"C\").Value = dateCell\n   ' RelDate.ClearContents\n   1:  Next RelDate\n   cleanup:\n    Set OutApp = Nothing\n    Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2175, "user_id": 3045171, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/le4e9.jpg?s=128&g=1", "display_name": "shapiro yaacov", "link": "https://stackoverflow.com/users/3045171/shapiro-yaacov"}, "edited": false, "score": 0, "creation_date": 1469016574, "post_id": 38480817, "comment_id": 64363783, "body": "Open in Notepad++, Use CTRL+H to go to &quot;replace&quot; and replace every <code>;</code> with <code>\\t</code>"}, {"owner": {"reputation": 2732, "user_id": 4903925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1dff9e4f48d1f1049aa3ee598331e43b?s=128&d=identicon&r=PG", "display_name": "Bonatti", "link": "https://stackoverflow.com/users/4903925/bonatti"}, "edited": false, "score": 0, "creation_date": 1469018183, "post_id": 38480817, "comment_id": 64364959, "body": "Please, read <a href=\"http://stackoverflow.com/help/how-to-ask\">this (how to ask)</a> and <a href=\"http://stackoverflow.com/help/mcve\">this (mcve)</a> before asking, as those will help you get more and better answers from the community."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6525410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ddb84b8cd904f4006e86c5b0c22065c?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6525410/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1469117999, "last_edit_date": 1469117999, "creation_date": 1469037352, "answer_id": 38487575, "question_id": 38480817, "link": "https://stackoverflow.com/questions/38480817/i-have-input-in-format-of-9ak-it-abc2others-su1-in-one-cell-how-t/38487575#38487575", "title": "I have Input in format of 9:ak-IT-ABC;2:others- -su1; ..... ; in one cell, How to separate these values in excel", "body": "<p>Perform a Text-to-Columns on the cell, delimited by semicolon(;).  That will separate the entries horizontally.  Copy all entries and paste special/transpose them in a blank worksheet.  That will make them all vertical.  Do two more delimited Text-to-Columns separations on the vertical entries.  The first would be by colon (:), and the second would be by hyphen (-).  That should separate them all out the way you are asking.</p>\n\n<p>Does it have to be done by VBA?</p>\n"}], "owner": {"reputation": 9, "user_id": 6613402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a22a87260658e9df0c3326bfa877f5?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/6613402/rats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469117999, "creation_date": 1469016328, "last_edit_date": 1531164843, "question_id": 38480817, "link": "https://stackoverflow.com/questions/38480817/i-have-input-in-format-of-9ak-it-abc2others-su1-in-one-cell-how-t", "title": "I have Input in format of 9:ak-IT-ABC;2:others- -su1; ..... ; in one cell, How to separate these values in excel", "body": "<p>I have Input in format of:</p>\n\n<pre><code>9:ak-IT-ABC;2:others- -su1; ..... ; \n</code></pre>\n\n<p>in one cell, how to separate these values in excel &amp; write in another sheet?</p>\n\n<p>Input:</p>\n\n<pre><code>9:ak-IT-ABC;2:others- -su1; ..... ;\n</code></pre>\n\n<p>Output want:</p>\n\n<pre><code> A    B     C    D\n 9    ak    IT   ABC\n 2    others     su1\n</code></pre>\n"}, {"tags": ["vba", "performance", "excel", "optimization"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1469015802, "post_id": 38480570, "comment_id": 64363250, "body": "is it must be 1,000,000 times ? or the range can be dynamic and you can search the last row ?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469015810, "post_id": 38480570, "comment_id": 64363259, "body": "I think you could try a &quot;For Each Cell&quot; loop across the square range, although I have no idea if that would be any faster (I kind of suspect it wouldnt be)"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469015907, "post_id": 38480570, "comment_id": 64363332, "body": "@ShaiRado Yes, the range can be dynamic."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469016005, "post_id": 38480570, "comment_id": 64363401, "body": "what is your leading Column ? In what column you will allways have data (for each row)"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469016010, "post_id": 38480570, "comment_id": 64363406, "body": "@RGA I&#39;m not familiar with that method and am interested in knowing it. Could you post it as an answer if that helps improve the running time?"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469016260, "post_id": 38480570, "comment_id": 64363573, "body": "@ShaiRado My data are in column E and F. The output of the program will start from column G row 2. Anyway, do you have any idea to improve the running time <b>Test3</b>?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1469016348, "post_id": 38480570, "comment_id": 64363643, "body": "@Anastasiya-Romanova\u79c0 yes, try the code in answer below."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1469016428, "post_id": 38480570, "comment_id": 64363695, "body": "10^7 cells in 10^2 seconds is 10^-5 seconds per cell, or about 10 microseconds. In that time you are indexing the Cell array, calling Rnd, and storing into the Cell. In an interpreted language line VBA it&#39;s not too strange to spend 10 microseconds doing that. It might help if you declare the Cell array to be numeric, so it doesn&#39;t have to worry about types and formatting."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 2, "creation_date": 1469016829, "post_id": 38480570, "comment_id": 64363960, "body": "Just as an aside, minus a typo or two, nearly perfect grammar/English in this post :)  plus, a very good question"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469017038, "post_id": 38480570, "comment_id": 64364129, "body": "@RGA Feel free to edit it. I want to make SO not only is a site to improve my coding skills, but also to make my English gets better and better. :)"}], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469016397, "post_id": 38480791, "comment_id": 64363675, "body": "dont think this is really answering OP&#39;s question... her issue wasn&#39;t about changing the loop size, but making a loop run faster for a given size"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469016719, "post_id": 38480791, "comment_id": 64363868, "body": "@RGA again ? what is your problem ? look at her question, and her answers below, her range can by dynamic. Maybe she is putting 1000000 just to be sure ? maybe its 1000 rows. so having the loop scan only 1/1000 will not shorten her time ? really ?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469017019, "post_id": 38480791, "comment_id": 64364112, "body": "OP&#39;s question is asking about optimizing a loop to run faster.  It&#39;s a theoretical question (perhaps not technically within the scope of SO but that is a different issue).  Yes, shrinking the size of a loop will <i>obviously</i> make it run faster, but OP&#39;s question is about improving the speed of a loop for a given size."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469017097, "post_id": 38480791, "comment_id": 64364177, "body": "I don&#39;t have any problem with you specifically, as I will happily point out issues with answers with anyone on SO who isn&#39;t answering correctly, so perhaps the fact that I am commenting often on your posts is an indication that you should review properly answering questions.  In this particular case, this is technically an answer, just not an answer to what OP wanted.  Note also the &quot;+ 1&quot; on my original comment, which indicates that someone else agrees with my assessment"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469017137, "post_id": 38480791, "comment_id": 64364205, "body": "It&#39;s nothing personal at all, I just want SO to be the best it can be (as I&#39;m sure you do as well, given your commendable and active involvment).  Furthermore, I welcome anyone to make the same types of comments on my posts so that I can either delete or correct them to ensure that the highest quality of information is provided"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469017444, "post_id": 38480791, "comment_id": 64364426, "body": "Though I mentioned the range can be dynamic, but I did mention how to improve the performance of Test3 in the same comment. Have a look, please. Anyway, I do appreciate your answer to my question. So, (+1) for you. :)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469017512, "post_id": 38480791, "comment_id": 64364475, "body": "@RGA I agree that Gary&#39;s answer is ideal and faster, that&#39;s why it gets voted up (also by me). Giving -1 is for wrong answer (that&#39;s how I understood SO) , not to answers that are correct (in this case not the best answer I agree)."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469018278, "post_id": 38480791, "comment_id": 64365041, "body": "@ShaiRado I didn&#39;t downvote... only left a comment stating my opinion.  I agree that -1 is for totally incorrect answers."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1469016231, "creation_date": 1469016231, "answer_id": 38480791, "question_id": 38480570, "link": "https://stackoverflow.com/questions/38480570/optimizing-performance-of-double-loop-in-vba-excel/38480791#38480791", "title": "Optimizing performance of double loop in VBA Excel", "body": "<p>Try the following code, it checks the last row in <strong>Column E</strong>, and the Loop stops there. You can modify the \"E\" to whatever Column you need.</p>\n\n<pre><code>Sub Test3()\n\nDim i As Long, j As Long, LastRow As Long\nT0 = Timer\n\n' in case Column E allways has data for each row &gt;&gt; you can modify to your needed Column\nLastRow = Cells(Rows.count, \"E\").End(xlUp).row\n\nScreenUpdateState = Application.ScreenUpdating\nStatusBarState = Application.DisplayStatusBar\nCalcState = Application.Calculation\nEventsState = Application.EnableEvents\nDisplayPageBreakState = ActiveSheet.DisplayPageBreaks\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n\nFor i = 1 To LastRow\n    For j = 1 To 10\n        Cells(i, j) = j + Rnd()\n    Next j\nNext i\n\nApplication.ScreenUpdating = ScreenUpdateState\nApplication.DisplayStatusBar = StatusBarState\nApplication.Calculation = CalcState\nApplication.EnableEvents = EventsState\nActiveSheet.DisplayPageBreaks = DisplayPageBreaksState\n\nInputBox \"The runtime of this program is \", \"Runtime\", Timer - T0\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469016334, "post_id": 38480800, "comment_id": 64363634, "body": "Worth mentioning in the answer, it is ALWAYS faster (if the option is available to you) to write values to an array and then write the array values to the cells, rather than perpetually accessing the cells"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469016594, "post_id": 38480800, "comment_id": 64363800, "body": "FWIW, <code>Dim v(1 To 1000000, 1 To 10) As Variant</code> makes it run faster. It completes in 5.546875 s! (+1)"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469016756, "post_id": 38480800, "comment_id": 64363897, "body": "@Anastasiya-Romanova\u79c0 as far as I&#39;m aware, this is <b>the</b> fastest way to loop through a data set.  It saves time by only accessing the <code>Cells</code> once, rather than accessing it for each cell individually.  Very worthy of being an accepted answer IMO"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469017762, "post_id": 38480800, "comment_id": 64364645, "body": "@RGA This is indeed a great answer, at least for me. But I wanna wait for some time in case there is someone here who comes up with a better way than this."}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469019444, "post_id": 38480800, "comment_id": 64365958, "body": "Sir, how if the rows and columns are dynamic inputs? I try <code>n = 1000000</code> and <code>m = 10</code>, but <code>Dim v(1 To n, 1 To m) As Long</code> returns error."}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469020866, "post_id": 38480800, "comment_id": 64367066, "body": "I just got it. I use:  <code>Dim v() As Long</code>  <code>n = 1000000</code>  <code>m = 10</code>  <code>ReDim v(1 To n, 1 To m) As Long</code>  Thanks for the response. :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 7, "last_activity_date": 1469020524, "last_edit_date": 1469020524, "creation_date": 1469016255, "answer_id": 38480800, "question_id": 38480570, "link": "https://stackoverflow.com/questions/38480570/optimizing-performance-of-double-loop-in-vba-excel/38480800#38480800", "title": "Optimizing performance of double loop in VBA Excel", "body": "<p>I used an <strong>internal VBA array</strong> and this ran in under 10 seconds:</p>\n\n<pre><code>Sub QuickTest()\n    Dim v(1 To 1000000, 1 To 10) As Double\n    For i = 1 To 1000000\n        For j = 1 To 10\n            v(i, j) = j + Rnd\n        Next j\n    Next i\n\n    Range(\"A1:J1000000\") = v\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>the use of an internal VBA array allows us to avoid \"touching\" the worksheet more than once</li>\n<li>the array can be transferred to the worksheet cells in one step rather than in a loop.</li>\n</ul>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Consider this sequel:</p>\n\n<pre><code>Sub QuickTest2_The_Sequel()\n    Dim i As Long, j As Long, m As Long, n As Long\n    Range(\"K1\") = Evaluate(\"Now()\")\n\n    m = 10\n    n = 1000000\n\n    ReDim v(1 To n, 1 To m) As Double\n    For i = 1 To n\n        For j = 1 To m\n            v(i, j) = j + Rnd\n        Next j\n    Next i\n\n    Range(\"A1:J\" &amp; n) = v\n    Range(\"K2\") = Evaluate(\"Now()\")\nEnd Sub\n</code></pre>\n\n<p>Here we use cells <strong>K1</strong> and <strong>K2</strong> to record the start and stop times.  We also use <code>ReDim</code> rather than <code>Dim</code> to \"paramatize\" the limits:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s1qah.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s1qah.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469021146, "post_id": 38482433, "comment_id": 64367304, "body": "Thanks for the answer. (+1)"}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469022503, "post_id": 38482433, "comment_id": 64368473, "body": "There is an issue using your code. I Think we must declare the length of the array more specific like Gary&#39;s. If not, then the 1st row and 1st column of Range(&quot;A1:J1000000&quot;)  will be equal to 0."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1469020655, "creation_date": 1469020655, "answer_id": 38482433, "question_id": 38480570, "link": "https://stackoverflow.com/questions/38480570/optimizing-performance-of-double-loop-in-vba-excel/38482433#38482433", "title": "Optimizing performance of double loop in VBA Excel", "body": "<pre><code>Sub Checkthis()\n    starttime = Format(Now(), \"hh:mm:ss\")\n    Dim i, j As Long\n    Dim a(1000000, 10) As Long\n    For i = 1 To 1000000\n        For j = 1 To 10\n            a(i, j) = j + Rnd\n        Next j\n    Next i\n    Range(\"A1:J1000000\") = a\n    endtime = Format(Now(), \"hh:mm:ss\")\n    Elapsed = DateDiff(\"s\", starttime, endtime)\n    MsgBox (\"Finished in \" &amp; Elapsed &amp; \" seconds\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3401, "favorite_count": 0, "accepted_answer_id": 38480800, "answer_count": 3, "score": 5, "last_activity_date": 1469020655, "creation_date": 1469015584, "last_edit_date": 1469017469, "question_id": 38480570, "link": "https://stackoverflow.com/questions/38480570/optimizing-performance-of-double-loop-in-vba-excel", "title": "Optimizing performance of double loop in VBA Excel", "body": "<p>I'm interested in knowing the fastest way to execute a set of instructions in double loop to loop through a two-dimensional range of cells. My code will be like this:</p>\n\n<pre><code>Sub Test()\n\nFor i = 1 To 1000000\n    For j = 1 To 10   'It can be more than 10\n        'I put a set of instructions here\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>For example, suppose I write a simple code to implement such a following task:</p>\n\n<pre><code>Sub Test1()\nT0 = Timer\nFor i = 1 To 1000000\n    For j = 1 To 10\n        Cells(i, j) = j + Rnd()\n    Next j\nNext i\nInputBox \"The runtime of this program is \", \"Runtime\", Timer - T0\nEnd Sub\n</code></pre>\n\n<p>I ran the procedure <strong>Test1</strong> on my machine, it took 179.6406 seconds to complete. Since I don't declare the variables (i and j), the <strong>Test1</strong> is running with those variables defaulting to the Variant type. I then add one line to the <strong>Test1</strong> to declare the variables as Longs, since VBA is optimized for Longs. The new procedure, <strong>Test2</strong>, brought the running time on my machine down to 168.7539 seconds (almost 11 seconds faster). </p>\n\n<p>To improve performance of <strong>Test2</strong>, I turned off Excel functionality that isn't needed while <strong>Test2</strong> code runs.</p>\n\n<pre><code>Sub Test3()\nDim i As Long, j As Long\nT0 = Timer\n\nScreenUpdateState = Application.ScreenUpdating\nStatusBarState = Application.DisplayStatusBar\nCalcState = Application.Calculation\nEventsState = Application.EnableEvents\nDisplayPageBreakState = ActiveSheet.DisplayPageBreaks\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n\nFor i = 1 To 1000000\n    For j = 1 To 10\n        Cells(i, j) = j + Rnd()\n    Next j\nNext i\n\nApplication.ScreenUpdating = ScreenUpdateState\nApplication.DisplayStatusBar = StatusBarState\nApplication.Calculation = CalcState\nApplication.EnableEvents = EventsState\nActiveSheet.DisplayPageBreaks = DisplayPageBreaksState\n\nInputBox \"The runtime of this program is \", \"Runtime\", Timer - T0\nEnd Sub\n</code></pre>\n\n<p>The above method helps improve the performance of <strong>Test2</strong> and <strong>Test3</strong> completes in 96.13672 seconds on my machine. So I'm wondering if there is a more effective way for doing this. Can anyone come up with a quicker version? If possible, even avoiding the double loop procedure.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11205, "user_id": 686433, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6535c84c07e054321d32b271818bfec?s=128&d=identicon&r=PG", "display_name": "Brian Leeming", "link": "https://stackoverflow.com/users/686433/brian-leeming"}, "edited": false, "score": 0, "creation_date": 1469018584, "post_id": 38480715, "comment_id": 64365314, "body": "You are checking B1 on sheet 1 but B1 is in sheet 2"}, {"owner": {"reputation": 735, "user_id": 6223038, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d367b52256b10b8255bc9abb8740330?s=128&d=identicon&r=PG&f=1", "display_name": "vanathaiyan", "link": "https://stackoverflow.com/users/6223038/vanathaiyan"}, "reply_to_user": {"reputation": 11205, "user_id": 686433, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6535c84c07e054321d32b271818bfec?s=128&d=identicon&r=PG", "display_name": "Brian Leeming", "link": "https://stackoverflow.com/users/686433/brian-leeming"}, "edited": false, "score": 0, "creation_date": 1469074753, "post_id": 38480715, "comment_id": 64390205, "body": "Sheet 1 is the default one where the computation happens, based on the computation result in sheet1, sheet2 columns get hided."}], "tags": [], "owner": {"reputation": 735, "user_id": 6223038, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d367b52256b10b8255bc9abb8740330?s=128&d=identicon&r=PG&f=1", "display_name": "vanathaiyan", "link": "https://stackoverflow.com/users/6223038/vanathaiyan"}, "is_accepted": true, "score": 1, "last_activity_date": 1469015999, "creation_date": 1469015999, "answer_id": 38480715, "question_id": 38480555, "link": "https://stackoverflow.com/questions/38480555/hide-columns-in-one-sheet-based-on-a-cell-from-another-sheet-excel-vba/38480715#38480715", "title": "Hide columns in one sheet based on a cell from another sheet - Excel VBA", "body": "<p>Use the below code in sheet 1 calculate event,</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n   If Range(\"B1\").Value = \"0\" Then\n      Sheet2.Columns(\"E:I\").EntireColumn.Hidden = True\n   Else\n      Sheet2.Columns(\"E:I\").EntireColumn.Hidden = False\n   End If\nEnd Sub\n</code></pre>\n\n<p>and do some calculation in sheet1-B1 cell(say =0+0), if the result is 0 then it will hide the columns E:I in Sheet2.</p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 5899707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36788a940d8cdd58aa389644107d5fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Oliveira", "link": "https://stackoverflow.com/users/5899707/fernando-oliveira"}, "is_accepted": false, "score": 0, "last_activity_date": 1472652808, "last_edit_date": 1472652808, "creation_date": 1469023557, "answer_id": 38483556, "question_id": 38480555, "link": "https://stackoverflow.com/questions/38480555/hide-columns-in-one-sheet-based-on-a-cell-from-another-sheet-excel-vba/38483556#38483556", "title": "Hide columns in one sheet based on a cell from another sheet - Excel VBA", "body": "<p>Used code on sheet1 to hide columns on sheet2</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Range(\"A1\").Value = \"0\" Then\n        Sheet2.Columns(\"E:I\").EntireColumn.Hidden = True\n    Else\n        Sheet2.Columns(\"E:I\").EntireColumn.Hidden = False\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Worked great. Thanks for the tip vanathaiyan</p>\n"}], "owner": {"reputation": 25, "user_id": 5899707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36788a940d8cdd58aa389644107d5fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Oliveira", "link": "https://stackoverflow.com/users/5899707/fernando-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3847, "favorite_count": 0, "accepted_answer_id": 38480715, "answer_count": 2, "score": 1, "last_activity_date": 1605639779, "creation_date": 1469015546, "last_edit_date": 1469018430, "question_id": 38480555, "link": "https://stackoverflow.com/questions/38480555/hide-columns-in-one-sheet-based-on-a-cell-from-another-sheet-excel-vba", "title": "Hide columns in one sheet based on a cell from another sheet - Excel VBA", "body": "<p>Inside an excel workbook I have sheet1 and sheet2. </p>\n\n<p>In <strong>Sheet1</strong> I have a cell that changes dynamically (cell A1).\nIn <strong>Sheet2</strong> I have a cell (B1) that copies the value from cell A1 from Sheet1.\nOn <strong>Sheet 2</strong> cells will hide when the value in B1 is 0.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rPSdh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rPSdh.png\" alt=\"link image\"></a></p>\n\n<p>Here is the VBA code from sheet2</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Range(\"B1\").Value = \"0\" Then\n        Columns(\"E:I\").EntireColumn.Hidden = True\n    Else\n        Columns(\"E:I\").EntireColumn.Hidden = False\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The thing is that when I change the value on <strong>Sheet1</strong> nothing happens on <strong>Sheet2</strong>, and I don\u00b4t know why.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469015411, "post_id": 38480430, "comment_id": 64362957, "body": "Look at <code>DIR</code> look at <code>FileSystemObject</code> I think looping files in VBA should give you a google answer, also searching on here should. <a href=\"http://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\" title=\"loop through files in a folder using vba\">stackoverflow.com/questions/10380312/&hellip;</a> and also <code>SQL Insert</code>"}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469015723, "post_id": 38480430, "comment_id": 64363198, "body": "I did, I used DIR but it shows nothing to me, because all I can find is excel examples with &quot;Cells&quot; function, I wanna insert the names in my table (called table1)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469016790, "post_id": 38480843, "comment_id": 64363925, "body": "Thank you ! it is working !! but how can I show only the file name ?"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469016836, "post_id": 38480843, "comment_id": 64363966, "body": "with or without the extension (e.g. .exe)?"}, {"owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469016942, "post_id": 38480843, "comment_id": 64364044, "body": "F.Name gives me the name with extension, but just for knowing, how to show only the extension ?"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "edited": false, "score": 0, "creation_date": 1469017087, "post_id": 38480843, "comment_id": 64364165, "body": "You can use the FSO functions: FSO.getBaseName(F) is without the extension. FSO.getExtensionName(F) is just the extension. Here&#39;s the reference: <a href=\"https://msdn.microsoft.com/en-us/library/6tkce7xa(v=vs.84).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/6tkce7xa(v=vs.84).aspx</a>"}], "tags": [], "owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "is_accepted": false, "score": 0, "last_activity_date": 1571302742, "last_edit_date": 1571302742, "creation_date": 1469016388, "answer_id": 38480843, "question_id": 38480430, "link": "https://stackoverflow.com/questions/38480430/how-can-i-insert-all-the-files-names-in-a-folder-into-access-table/38480843#38480843", "title": "How can I insert all the files names in a folder into Access table?", "body": "<p>Try this:</p>\n\n<pre><code>Dim F as Variant, FSO As Object\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nDocmd.SetWarnings False\nFor each F in FSO.getFolder(\"Path to your folder\").Files\n    Docmd.RunSQL \"INSERT INTO table1 ([FieldName]) VALUES ('\" &amp; F &amp; \"');\"\nNext\nDocmd.SetWarnings True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1469085857, "creation_date": 1469085857, "answer_id": 38497629, "question_id": 38480430, "link": "https://stackoverflow.com/questions/38480430/how-can-i-insert-all-the-files-names-in-a-folder-into-access-table/38497629#38497629", "title": "How can I insert all the files names in a folder into Access table?", "body": "<p>So, all files into ONE table?</p>\n\n<p><a href=\"http://www.accessmvp.com/KDSnell/EXCEL_Import.htm#ImpFolderFiles\" rel=\"nofollow\">http://www.accessmvp.com/KDSnell/EXCEL_Import.htm#ImpFolderFiles</a></p>\n\n<p>Or, all files into SEPARATE tables?</p>\n\n<p><a href=\"http://www.accessmvp.com/KDSnell/EXCEL_Import.htm#ImpAllWkshtsFilesSepTbls\" rel=\"nofollow\">http://www.accessmvp.com/KDSnell/EXCEL_Import.htm#ImpAllWkshtsFilesSepTbls</a></p>\n"}], "owner": {"reputation": 43, "user_id": 5214068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/514911038666475/picture?type=large", "display_name": "Tarik Kaoukab", "link": "https://stackoverflow.com/users/5214068/tarik-kaoukab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1649, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1575512650, "creation_date": 1469015194, "last_edit_date": 1575512650, "question_id": 38480430, "link": "https://stackoverflow.com/questions/38480430/how-can-i-insert-all-the-files-names-in-a-folder-into-access-table", "title": "How can I insert all the files names in a folder into Access table?", "body": "<p>I'm a begginer in Access and VBA coding and I would love to list all files names I have in a folder into my access table (ID (automatic), File Name) ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1469015637, "post_id": 38480214, "comment_id": 64363114, "body": "Hey Dirk, none of them work."}, {"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1469016844, "post_id": 38480214, "comment_id": 64363973, "body": "I dont mind as long as that picture gets sent to ppt. What should I need to change for bitmap"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1469017414, "post_id": 38481027, "comment_id": 64364404, "body": "When i use <code>rng.CopyPicture xlScreen, xlBitmap</code> , I get an error in the following line of the code <code>mySlide.Shapes.PasteSpecial DataType:=2</code> and the error is <code>Shapes.PasteSpecial : Invalid request. The specified data type is unavailable</code>"}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "reply_to_user": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1469020979, "post_id": 38481027, "comment_id": 64367158, "body": "@Vinaybilla: It&#39;s obviously not going to work because the clipboard now contains only bitmap format and you are trying to paste an enhanced metafile which is just not present. If the clipboard only contains a bitmap you need to use <code>Shapes.PasteSpecial ppPasteBitmap</code> instead (or just use the regular <code>Shapes.Paste</code> method)"}], "tags": [], "owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1469016885, "creation_date": 1469016885, "answer_id": 38481027, "question_id": 38480214, "link": "https://stackoverflow.com/questions/38480214/why-does-white-font-appear-visible-when-i-export-excel-screenshot-to-vba/38481027#38481027", "title": "Why does white font appear visible when I export excel screenshot to vba?", "body": "<p>The issue is related to rendering text in metafiles on a transparent background. There are two ways you can resolve this:</p>\n\n<ul>\n<li>Copy the Excel range as a bitmap using <code>rng.CopyPicture xlScreen, xlBitmap</code>. As the bitmap format does not support transparency, the cell background is automatically rendered in white. The disadvantage of this option is that the copied range no longer scales well as it is no longer in a vector format.</li>\n<li>Explicitly remove the transparency from the cells by setting the cell to be filled with a white background. Then copy the range using <code>rng.CopyPicture xlPrinter, XlPicture</code>. When using this option you can still use a scalable metafile in PowerPoint.</li>\n</ul>\n"}], "owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469016885, "creation_date": 1469014551, "last_edit_date": 1531164843, "question_id": 38480214, "link": "https://stackoverflow.com/questions/38480214/why-does-white-font-appear-visible-when-i-export-excel-screenshot-to-vba", "title": "Why does white font appear visible when I export excel screenshot to vba?", "body": "<p>I used the following code to export excel screenshot to powerpoint </p>\n\n<pre><code>Sub ExcelRangeToPowerPoint()\n'PURPOSE: Copy/Paste An Excel Range Into a New PowerPoint Presentation\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim rng As Range\nDim PowerPointApp As Object\nDim myPresentation As Object\nDim mySlide As Object\nDim myShape As Object\n\n'Copy Range from Excel\n  Set rng = Worksheets(\"Overall\").Range(\"B2:AH47\")\n\n'Create an Instance of PowerPoint\n  On Error Resume Next\n\n    'Is PowerPoint already opened?\n      Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear the error between errors\n      Err.Clear\n\n    'If PowerPoint is not already open then open PowerPoint\n      If PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n    'Handle if the PowerPoint Application is not found\n      If Err.Number = 429 Then\n        MsgBox \"PowerPoint could not be found, aborting.\"\n        Exit Sub\n      End If\n\n  On Error GoTo 0\n\n'Optimize Code\n  Application.ScreenUpdating = False\n\n'Create a New Presentation\n  Set myPresentation = PowerPointApp.Presentations.Add\n\n'Add a slide to the Presentation\n  Set mySlide = myPresentation.Slides.Add(1, 11) '11 = ppLayoutTitleOnly\n\n'Copy Excel Range\n  rng.Copy\n\n'Paste to PowerPoint and position\n  mySlide.Shapes.PasteSpecial DataType:=2  '2 = ppPasteEnhancedMetafile\n  Set myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    'Set position:\n      myShape.Left = 35\n      myShape.Top = 15\n\n    'setting size\n      myShape.Height = 510\n\n\n'Make PowerPoint Visible and Active\n  PowerPointApp.Visible = True\n  PowerPointApp.Activate\n\n'Clear The Clipboard\n  Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>and it throws a screenshot to ppt which looks like this :</p>\n\n<p><a href=\"https://i.stack.imgur.com/xUdqr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xUdqr.png\" alt=\" \"></a></p>\n\n<p>All the red square boxes show text which was in white colour. They are hidden when viewed in excel but they appear only when the selection is screen captured and exported to ppt </p>\n\n<p>Please help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469014056, "post_id": 38479847, "comment_id": 64362033, "body": "You don&#39;t need wildcards with instr, you need Like for wildcards  instr( &quot;Nath&quot; , string) or string like &#39; * Nath * &#39;  (without spaces, kept becoming italic)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1469014553, "post_id": 38479847, "comment_id": 64362378, "body": "The comment in the code mentions column <b>A</b>, but the code examines only column <b>G</b>."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1469015981, "post_id": 38479847, "comment_id": 64363378, "body": "replace <code>If InStr(strConcatList, cell.Value) &gt; 0 Then</code> with <code>If cell.Value like strConcatList Then </code>"}, {"owner": {"reputation": 125, "user_id": 5821482, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1261345747225999/picture?type=large", "display_name": "Ming Xuan", "link": "https://stackoverflow.com/users/5821482/ming-xuan"}, "edited": false, "score": 0, "creation_date": 1469020380, "post_id": 38479847, "comment_id": 64366716, "body": "Thanks, that worked:"}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 5821482, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1261345747225999/picture?type=large", "display_name": "Ming Xuan", "link": "https://stackoverflow.com/users/5821482/ming-xuan"}, "is_accepted": true, "score": 0, "last_activity_date": 1469020532, "creation_date": 1469020532, "answer_id": 38482391, "question_id": 38479847, "link": "https://stackoverflow.com/questions/38479847/vba-code-to-find-a-cell-contains-a-certain-string-among-a-csv-list/38482391#38482391", "title": "VBA code to find a cell contains a certain string (among a .csv list)", "body": "<p>This code is working:</p>\n\n<pre><code>Sub Test()\n\n\nDim strConcatList As String\nDim cell As Range\n\n    Sheets.Add.Name = \"esES\"\n    strConcatList = \"*esES*\"\n\n\n    For Each cell In Intersect(Sheets(\"Requests\").Range(\"G:G\"), Sheets(\"Requests\").UsedRange)\n        If cell.Value Like strConcatList Then\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"esES\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Requests\").Select\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot for helping!</p>\n"}], "owner": {"reputation": 125, "user_id": 5821482, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1261345747225999/picture?type=large", "display_name": "Ming Xuan", "link": "https://stackoverflow.com/users/5821482/ming-xuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "accepted_answer_id": 38482391, "answer_count": 1, "score": 0, "last_activity_date": 1469020532, "creation_date": 1469013621, "last_edit_date": 1469020487, "question_id": 38479847, "link": "https://stackoverflow.com/questions/38479847/vba-code-to-find-a-cell-contains-a-certain-string-among-a-csv-list", "title": "VBA code to find a cell contains a certain string (among a .csv list)", "body": "<p>Found plenty of example to find a cell based on the value it contains but they are all for the example when the cell contains ONLY one value. I have this columns with a list of locales like deDE, esES, etc. and if I try to find a cell based on just one of those locale, the code I have doesn't work, I have no idea why.</p>\n\n<pre><code>Sub Test()\n\n\nDim strConcatList As String\nDim cell As Range\n\n    strConcatList = \"*\" &amp; \"esES\" &amp; \"*\"\n\n    'For each used cell in Column A of sheet1, check whether the value in that cell\n    'is contained within the concatenated string\n    For Each cell In Intersect(Sheets(\"Requests\").Range(\"G:G\"), Sheets(\"Requests\").UsedRange)\n        If InStr(strConcatList, cell.Value) &gt; 0 Then       'InStr returns 0 if the string isn't found\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n        Sheets.Add.Name = \"esES\"\n\n        Sheets(\"Sheet2\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Requests\").Select\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>For instance, this code snippet is supposed to find cells where \"esES\" is present, create a new sheet called esES and paste the row in it. I tried \"esES\", didn't work. I was hoping the current form I have would work - I have a little bit of experience with Regax albeit not in VBA and it should read anything + esES + anything.</p>\n\n<p>No clue what's going on, and I've been stuck for hours. I wouldn't mind a little help here.</p>\n\n<p>EDIT:</p>\n\n<p>This code is working, thanks for helping:</p>\n\n<pre><code>Sub Test()\n\n\nDim strConcatList As String\nDim cell As Range\n\n    Sheets.Add.Name = \"esES\"\n    strConcatList = \"*esES*\"\n\n    'For each used cell in Column G of sheet1, check whether the value in that cell\n    'is contained within the concatenated string\n    For Each cell In Intersect(Sheets(\"Requests\").Range(\"G:G\"), Sheets(\"Requests\").UsedRange)\n        If cell.Value Like strConcatList Then\n        matchRow = cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"esES\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Requests\").Select\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1469013091, "post_id": 38479502, "comment_id": 64361367, "body": "the Worksheet_Change event could be useful for you, but I don&#39;t fully understand your question so applying it might be difficult/unnecessary"}], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1469014854, "creation_date": 1469014854, "answer_id": 38480321, "question_id": 38479502, "link": "https://stackoverflow.com/questions/38479502/check-if-specific-cell-has-been-updated-excel/38480321#38480321", "title": "Check if specific cell has been updated excel", "body": "<p>Paste the below code in your worksheet VBA </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not (Intersect(Target, Target.Worksheet.Range(\"H11\")) Is Nothing) Then\n        'do you coding here\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "accepted_answer_id": 38480321, "answer_count": 1, "score": 0, "last_activity_date": 1469014854, "creation_date": 1469012639, "question_id": 38479502, "link": "https://stackoverflow.com/questions/38479502/check-if-specific-cell-has-been-updated-excel", "title": "Check if specific cell has been updated excel", "body": "<p>I'm looking for an excel formula, or VBA macro rolled into a UDF (user defined function) which effectively checks whether Enter/Return has been pressed in a particular cell.</p>\n\n<p>I happen to have iterative calculations turned on meaning that if I want to see whether the value in a cell has changed (in this example, <em>H11</em>), I can have code in <em>I11</em> like: <code>=IF(OR(ISBLANK(I11),I11=0),H11,I11)</code> Without returning a circular reference. I then compare the value in <em>H11</em> to the one stored in <em>I11</em>, if they are different then <em>H11</em> has changed</p>\n\n<p>However my problem is that I need to know if H11 has been updated at all, so the value in H11 may not have changed but I could've gone into H11, typed the same thing and pressed enter, and I need to know if that happens!</p>\n\n<p>I hope that's clear-ish, I'm thinking <code>Cell('address')</code> (with no reference) could be used to show whether H11 was the last cell edited, but the problem is, H11 may already be the last cell edited, so I can't get my head around it.</p>\n\n<p>I haven't touched VBA yet 'cos I don't know how, but if anyone finds a solution using that or normal formulae I'd be extremely grateful. Thanks!</p>\n"}, {"tags": ["excel", "vba", "automation"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469020996, "post_id": 38478763, "comment_id": 64367170, "body": "<code>Do While i.readyState &lt;&gt; READYSTATE_COMPLETE Or i.Busy</code>  the events you&#39;re trapping can happen in differing orders, this is what I use when im downloading fund information that I have to wait for,"}, {"owner": {"reputation": 31, "user_id": 5420456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d3c6051356d679697c2ae936c2a4b4?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5420456/john"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469029658, "post_id": 38478763, "comment_id": 64372257, "body": "Thanks Nathan, I don&#39;t believe I&#39;ve tried that.  I will have a go later and update!"}, {"owner": {"reputation": 31, "user_id": 5420456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d3c6051356d679697c2ae936c2a4b4?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5420456/john"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469566795, "post_id": 38478763, "comment_id": 64587488, "body": "No joy on that one either! thanks all the same."}], "owner": {"reputation": 31, "user_id": 5420456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d3c6051356d679697c2ae936c2a4b4?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5420456/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469025149, "creation_date": 1469010467, "last_edit_date": 1469025149, "question_id": 38478763, "link": "https://stackoverflow.com/questions/38478763/how-to-exit-webpage-without-getting-an-internet-explorer-there-are-unsaved-chan", "title": "How to exit webpage without getting an Internet explorer &quot;there are unsaved changes&quot; pop up when automating with vba", "body": "<p>I have tried the usual wait for internet page to finish loading and tried putting in a fixed delay before commencing with an exit. The wait for page to finish loading methods don't work at all, the fixed delay works most of the time but it's not ideal.  The last action befor I try to leave the page is to click on a save to server button, so I'm thinking it has something to do with the time it takes to for the server to respond which presumably is restricted to Internet speed and would explain why the fixed delay is successful most of the time.  </p>\n\n<p>Can anyone shed some light on how to determine if the the page has finished doing its thing?</p>\n\n<p>Here's what I've tried:</p>\n\n<p><code>While IE.Busy\n    DoEvents\nWend</code></p>\n\n<p><code>Do Until IE.statusText = \"Done\"\n    DoEvents\nLoop</code></p>\n\n<p><code>Do Until IE.readyState = 4\n    DoEvents\nLoop</code></p>\n\n<p>Also \nApplication.wait Now+Timevalue(\"00:00:02)</p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1469010931, "post_id": 38478706, "comment_id": 64360001, "body": "Presumably <code>cn</code> is your connection?  You need more of the code shown to give context to the question and expose your variables a little better. Either way, you are correct that <code>cn.Execute</code> isn&#39;t returning a string, if it&#39;s an <code>ADO</code> connection it will return an <code>ADO.Recordset</code>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6550276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0a511800eaff1f6fb71042bd29e419c?s=128&d=identicon&r=PG&f=1", "display_name": "Tomdw94", "link": "https://stackoverflow.com/users/6550276/tomdw94"}, "edited": false, "score": 0, "creation_date": 1469011602, "post_id": 38478883, "comment_id": 64360398, "body": "I have edited my post. It shows my almost-solution so far. Do you know how to continue on my mindset? I always prefer to use code that I understand myself and would re-use if needed."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 37, "user_id": 6550276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0a511800eaff1f6fb71042bd29e419c?s=128&d=identicon&r=PG&f=1", "display_name": "Tomdw94", "link": "https://stackoverflow.com/users/6550276/tomdw94"}, "edited": false, "score": 1, "creation_date": 1469012202, "post_id": 38478883, "comment_id": 64360811, "body": "Try <code>rss.Fields(0).Value</code> instead of <code>rss.Fields(0).Name</code> in your code. If it works for you I will update my answer."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1469010870, "creation_date": 1469010870, "answer_id": 38478883, "question_id": 38478706, "link": "https://stackoverflow.com/questions/38478706/store-a-single-value-in-variable-with-sql-select/38478883#38478883", "title": "Store a single value in variable with SQL Select", "body": "<p>If you are using the <code>ADO</code> library then the <code>Execute</code> method returns a <code>RecordSet</code> - see the <a href=\"https://msdn.microsoft.com/en-us/library/ms675023(v=vs.85).aspx\" rel=\"nofollow\">documentation</a>.</p>\n\n<p>So you need to:</p>\n\n<pre><code>Dim rsResult as Recordset\n...\nSet rsResult = cn.Execute(strSqlmail)\nDo While Not rs.EOF\n    Debug.Print rs!Email-Adress\n    rs.MoveNext\nLoop\nrs.Close\n</code></pre>\n\n<p>So, when you add your <code>WHERE</code> clause to only return one row, then the loop should only iterate once. Whatever is output to the immediate window is what you should assign to <code>cUserEmail</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 6550276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0a511800eaff1f6fb71042bd29e419c?s=128&d=identicon&r=PG&f=1", "display_name": "Tomdw94", "link": "https://stackoverflow.com/users/6550276/tomdw94"}, "is_accepted": false, "score": 0, "last_activity_date": 1469012225, "creation_date": 1469012225, "answer_id": 38479353, "question_id": 38478706, "link": "https://stackoverflow.com/questions/38478706/store-a-single-value-in-variable-with-sql-select/38479353#38479353", "title": "Store a single value in variable with SQL Select", "body": "<p>The following code gave me the requested value: </p>\n\n<pre><code>Dim cn As Object\nDim cUserEmail As String\nDim strSqlmail As String\nDim rss As Object\nDim strConnection As String\n\nSet cn = CreateObject(\"ADODB.Connection\")\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=C:\\ActionList.accdb\"\n\nstrSqlmail = \"SELECT [Email-Adress] FROM MyTable WHERE MyTable.[Name]='Test'\"\n\nSet rss = cn.Execute(strSqlmail)\ncUserEmail = rss.Fields(0)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6550276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f0a511800eaff1f6fb71042bd29e419c?s=128&d=identicon&r=PG&f=1", "display_name": "Tomdw94", "link": "https://stackoverflow.com/users/6550276/tomdw94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3902, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469012225, "creation_date": 1469010287, "last_edit_date": 1531164843, "question_id": 38478706, "link": "https://stackoverflow.com/questions/38478706/store-a-single-value-in-variable-with-sql-select", "title": "Store a single value in variable with SQL Select", "body": "<p>I have the following vba code. I am using MS Excel 2013. (I have an insert statement in this code as well, but I didn't copy this just to have a better highlight of my problem) </p>\n\n<pre><code>Dim cn As Object\nDim cUserEmail As String\nDim strSqlmail As String\nDim rss As Object\nDim strConnection As String\n\nSet cn = CreateObject(\"ADODB.Connection\")\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=C:\\ActionList.accdb\"\n\nstrSqlmail = \"SELECT [Email-Adress] FROM MyTable WHERE Name='Test'\"\n\nSet rss = cn.Execute(strSqlmail)\ncUserEmail = rss.Fields(0).Name\n</code></pre>\n\n<p>At this point it stores the column name (Email-Adress) in my variable. Running the query in Access returns the column with only my desired value in it. </p>\n\n<p>I think I'm as good as finished, but I cannot seem to find how to get the value. When i change to rss.Field(1) it gives an error saying that the item cannot be found. </p>\n"}, {"tags": ["excel", "vba", "inputbox"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6613029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f1ac0bd140829a81418782264d4fb9?s=128&d=identicon&r=PG&f=1", "display_name": "VilleT", "link": "https://stackoverflow.com/users/6613029/villet"}, "edited": false, "score": 0, "creation_date": 1469012258, "post_id": 38478426, "comment_id": 64360854, "body": "Thank you very much! This was exactly the one I was looking for."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6613029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f1ac0bd140829a81418782264d4fb9?s=128&d=identicon&r=PG&f=1", "display_name": "VilleT", "link": "https://stackoverflow.com/users/6613029/villet"}, "edited": false, "score": 0, "creation_date": 1469013452, "post_id": 38478426, "comment_id": 64361632, "body": "@VilleT, then your question was misleading since you started from cell &quot;A1&quot; downwards while this solution skips cell &quot;A1&quot;"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469013455, "post_id": 38478426, "comment_id": 64361635, "body": "@user3598756. purposely thats for header."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 3, "user_id": 6613029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f1ac0bd140829a81418782264d4fb9?s=128&d=identicon&r=PG&f=1", "display_name": "VilleT", "link": "https://stackoverflow.com/users/6613029/villet"}, "edited": false, "score": 0, "creation_date": 1469013671, "post_id": 38478426, "comment_id": 64361776, "body": "@VilleT, Welcome always."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469013888, "post_id": 38478426, "comment_id": 64361924, "body": "@KarthickGunasekaran no sign of this &quot;purpose&quot; in the OP&#39;s question"}, {"owner": {"reputation": 3, "user_id": 6613029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f1ac0bd140829a81418782264d4fb9?s=128&d=identicon&r=PG&f=1", "display_name": "VilleT", "link": "https://stackoverflow.com/users/6613029/villet"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469015318, "post_id": 38478426, "comment_id": 64362891, "body": "@user3598756,   the code was exactly the one I was looking for. I was using &quot;A1&quot; as an example."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1469015137, "last_edit_date": 1469015137, "creation_date": 1469009627, "answer_id": 38478426, "question_id": 38478373, "link": "https://stackoverflow.com/questions/38478373/vba-inbut-box-with-loop/38478426#38478426", "title": "VBA Inbut box with loop", "body": "<p>Try with below code</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim myValue As Variant\n    myValue = InputBox(\"Please insert number\")\n    Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = myValue\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT #1:</strong>\nUpdated the code as per the advice of user3598756 </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim myValue As Variant\n    myValue = InputBox(\"Please insert number\")\n    If Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value = \"\" Then\n        Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row) = myValue\n    Else\n        Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = myValue\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6613029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f1ac0bd140829a81418782264d4fb9?s=128&d=identicon&r=PG&f=1", "display_name": "VilleT", "link": "https://stackoverflow.com/users/6613029/villet"}, "edited": false, "score": 0, "creation_date": 1469012504, "post_id": 38478479, "comment_id": 64360990, "body": "Thank you for your answer"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1469009764, "creation_date": 1469009764, "answer_id": 38478479, "question_id": 38478373, "link": "https://stackoverflow.com/questions/38478373/vba-inbut-box-with-loop/38478479#38478479", "title": "VBA Inbut box with loop", "body": "<p>If you want to do a loop - for example 10 times - then you can use this example code:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n    Dim counter As Integer\n    Dim myValue As Variant\n\n\n    For counter = 1 To 10\n        myValue = InputBox(\"Please insert number\")\n        Sheets(\"Sheet1\").Cells(counter, 1).Value = myValue\n    Next counter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1469024183, "last_edit_date": 1469024183, "creation_date": 1469012121, "answer_id": 38479308, "question_id": 38478373, "link": "https://stackoverflow.com/questions/38478373/vba-inbut-box-with-loop/38479308#38479308", "title": "VBA Inbut box with loop", "body": "<p><strong>edited</strong> to</p>\n\n<ul>\n<li><p>shorten the code</p></li>\n<li><p>add solution should cell \"A1\" be already filled with header</p></li>\n</ul>\n\n<p>the following code will do:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    With Cells(Rows.Count, 1).End(xlUp)\n        .Offset(IIf(.Value &lt;&gt; \"\", 1, 0)) = InputBox(\"Please insert number\")\n    End With\nEnd Sub\n</code></pre>\n\n<p>where the \"conditional\" offset is necessary to manage the first empty cell being in row 1 (no offset) or lower (1 row offset)</p>\n\n<p>should cell \"A1\" be already filled with header, the code shortens down to:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Cells(Rows.Count, 1).End(xlUp).Offset(1) = InputBox(\"Please insert number\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6613029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f1ac0bd140829a81418782264d4fb9?s=128&d=identicon&r=PG&f=1", "display_name": "VilleT", "link": "https://stackoverflow.com/users/6613029/villet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 38478426, "answer_count": 3, "score": 0, "last_activity_date": 1469024183, "creation_date": 1469009474, "last_edit_date": 1469013744, "question_id": 38478373, "link": "https://stackoverflow.com/questions/38478373/vba-inbut-box-with-loop", "title": "VBA Inbut box with loop", "body": "<p>I have just started learning VBA (and coding in general) and I am faced with a problem to which I have not yet found a solution. I'd like to create an input box with a loop so that the output from the input box will be printed to separate cell. For example, I would like to write number \"5\" to the input box and the output will be printed to Cell \"A1\" and the next input, say number \"9\", will be printed to Cell \"A2\".</p>\n\n<p>So far, I have managed to this and everything works fine except the last row as I don't know how to continue from here.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim myValue As Variant\n\nmyValue = InputBox(\"Please insert number\")\n\nRange(\"A1\").Select\nActiveCell.Value = myValue\n\nRange(ActiveCell) = Range(ActiveCell) + 1\n\nEnd Sub\n</code></pre>\n\n<p>All help is appreciated</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1469012570, "post_id": 38477946, "comment_id": 64361033, "body": "You can create a hidden worksheet with your values and populate your arrays from there."}], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 4768174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a46a8c95de3547477df784d2a22d2b46?s=128&d=identicon&r=PG&f=1", "display_name": "Keppy", "link": "https://stackoverflow.com/users/4768174/keppy"}, "is_accepted": false, "score": 0, "last_activity_date": 1469008930, "creation_date": 1469008930, "answer_id": 38478179, "question_id": 38477946, "link": "https://stackoverflow.com/questions/38477946/coloring-specific-cells-in-a-column-without-having-to-change-the-column-ref-in-e/38478179#38478179", "title": "Coloring specific cells in a column without having to change the column ref in each range variable", "body": "<p>Are expecting something like this.</p>\n\n<p><a href=\"http://www.excel-easy.com/vba/examples/interactive-userform.html\" rel=\"nofollow\">Interactive UI for VBA-Excel</a></p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "edited": false, "score": 0, "creation_date": 1469049231, "post_id": 38479909, "comment_id": 64383477, "body": "Fantastic! Does exactly what i want.  Much appreciated!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1469013792, "creation_date": 1469013792, "answer_id": 38479909, "question_id": 38477946, "link": "https://stackoverflow.com/questions/38477946/coloring-specific-cells-in-a-column-without-having-to-change-the-column-ref-in-e/38479909#38479909", "title": "Coloring specific cells in a column without having to change the column ref in each range variable", "body": "<p>pass your sub a parameter to address the wanted week and use <code>Offset()</code> method of <code>Range</code> object, like follows</p>\n\n<pre><code>Option Explicit\n\nSub ColorPreviuosWeek(col As Long)\n    Dim ws As Worksheet\n    Dim WSArray As Variant\n\n    Set WSArray = Sheets(Array(\"Baking HO\", \"Fresh Consol\", \"Moorebank\", \"Tamworth\", \"Canberra\", \"Fairbank\", \"Dandenong\", \"Carina\", \"Burleigh\", \"Townsville\", _\n               \"Hobart\", \"Forestville\", \"Darwin\", \"Malaga\", \"Camellia\", \"EP-Total\", \"G144 Total\", \"G610 Total\"))\n\n    For Each ws In WSArray\n        ws.Range(\"i6:i9,i17:i18,i22:i24,i28:i34,i39:i40,i46:i49,i51:i52,i55,i59:i62,i70:i74\").Offset(, col - 1).Interior.Color = vbRed '&lt;--| offset must be reduced by one so as to have offset 1 referencing column \"i\"\n    Next\nEnd Sub\n</code></pre>\n\n<p>so that </p>\n\n<pre><code>ColorPreviuosWeek 2 '&lt;-- 2 stands for \"week2\" \n</code></pre>\n\n<p>will color column \"J\"</p>\n"}], "owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 38479909, "answer_count": 2, "score": 0, "last_activity_date": 1469013792, "creation_date": 1469008372, "question_id": 38477946, "link": "https://stackoverflow.com/questions/38477946/coloring-specific-cells-in-a-column-without-having-to-change-the-column-ref-in-e", "title": "Coloring specific cells in a column without having to change the column ref in each range variable", "body": "<p>The code below works fine.  However, I feel there must be a better way of writing it to do the job easier and quicker. Each week i have to go into VB and change the column ref in the range, so the previous week is highlighted red.  Is there a way to enter the column ref once so all others are updated automatically or, even better, i can input the column ref in an input box?  week1 is i, week2 is j, week3 k and so on.  Thank you!</p>\n\n<pre><code>    Option Explicit\n\nDim ws As Worksheet\nDim WSArray As Variant\n\n\nSet WSArray = Sheets(Array(\"Baking HO\", \"Fresh Consol\", \"Moorebank\", \"Tamworth\", \"Canberra\", \"Fairbank\", \"Dandenong\", \"Carina\", \"Burleigh\", \"Townsville\", _\n           \"Hobart\", \"Forestville\", \"Darwin\", \"Malaga\", \"Camellia\", \"EP-Total\", \"G144 Total\", \"G610 Total\"))\n\nFor Each ws In WSArray\nws.Range(\"i6:i9,i17:i18,i22:i24,i28:i34,i39:i40,i46:i49,i51:i52,i55,i59:i62,i70:i74\").Interior.Color = vbRed\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1469010255, "last_edit_date": 1469010255, "creation_date": 1469009159, "answer_id": 38478255, "question_id": 38477899, "link": "https://stackoverflow.com/questions/38477899/vba-read-a-texts-files-permission-denied/38478255#38478255", "title": "VBA Read a texts files: permission denied", "body": "<p>Some minor changes and it worked for me. Please change the path as per your own requirement in following code:</p>\n\n<pre><code>Sub change_txt()\nDim fso As Object\nSet fso = CreateObject(\"scripting.filesystemObject\")\nDim f\nDim path As String\nDim file_txt As String\n\npath = \"D:\\Folder\\Fileshare\\\"\nfile_txt = Dir(path &amp; \"*.*\")\n\nDo While Len(file_txt) &gt; 0\n    'Set objfile = FSO.CreateTextFile(path &amp; file_txt)\n    Set f = fso.opentextfile(path &amp; file_txt, 1)\n\n    While Not f.AtEndOfStream\n        Namechange = f.ReadAll\n    Wend\n    Namechange = Replace(Namechange, \"NAME\", \"name\")\n    Set f = fso.opentextfile(path &amp; file_txt, 2)\n    f.Write Namechange\n\n    file_txt = Dir()\nLoop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1469014708, "post_id": 38478835, "comment_id": 64362488, "body": "<code>Dir</code> and <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264163.aspx\" rel=\"nofollow noreferrer\"><code>Open</code></a> are generally much faster, but I agree if you&#39;re using FSO at all, you might as well use it for everything including traversing the directory."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1469010694, "creation_date": 1469010694, "answer_id": 38478835, "question_id": 38477899, "link": "https://stackoverflow.com/questions/38477899/vba-read-a-texts-files-permission-denied/38478835#38478835", "title": "VBA Read a texts files: permission denied", "body": "<p>I'd rewrite using a bit more of the <code>FileSystemObject</code> functionality rather than using <code>Dir()</code> personally, but that's open to your own choice.  The key issue I think you are having is that you have opened the file for reading and then immediately tried to open it for writing while the <code>TextStream</code> object is still in memory, and locking the file.  This is why you are getting \"Permission denied\".  To quote from a <a href=\"https://technet.microsoft.com/en-us/library/ee198716.aspx\" rel=\"nofollow\">TechNet Article</a>:</p>\n\n<blockquote>\n  <p>Opening Text Files </p>\n  \n  <p>Working with text files is a three-step process.\n  Before you can do anything else, you must open the text file. This can\n  be done either by opening an existing file or by creating a new text\n  file. (When you create a new file, that file is automatically opened\n  and ready for use.) Either approach returns a reference to the\n  TextStream object. After you have a reference to the TextStream\n  object, you can either read from or write to the file. However, you\n  cannot simultaneously read from and write to the same file. In other\n  words, you cannot open a file, read the contents, and then write\n  additional data to the file, all in the same operation. Instead, you\n  must read the contents, close the file, and then reopen and write the\n  additional data. When you open an existing text file, the file can be\n  opened either for reading or for writing. When you create a new text\n  file, the file is open only for writing, if for no other reason than\n  that there is no content to read. Finally, you should always close a\n  text file. Although this is not required (the file will generally be\n  closed as soon as the script terminates), it is good programming\n  practice.</p>\n</blockquote>\n\n<p>My code should work for your requirements.  I've removed the While loop from the middle as if you are using <code>ReadAll</code> then you don't need to loop over the text.</p>\n\n<pre><code>Sub MySub()\n    Dim fso\n    Set fso = CreateObject(\"scripting.filesystemObject\")\n    Dim file, folder\n    Dim path As String\n    Dim file_txt As String\n    path = \"C:\\users\\folders\\fileshere\\\"\n    Set folder = fso.GetFolder(path)\n\n    For Each file In folder.Files\n        Set file = fso.OpenTextFile(file.Path, 1)\n        Namechange = file.ReadAll\n        file.Close\n        Namechange = Replace(Namechange, \"NAME\", \"name\")\n        Set file = fso.OpenTextFile(file.Path, 2, True)\n        file.Write Namechange\n        file.Close\n    Next\nEnd Sub\n</code></pre>\n\n<p>If you have any difficulties or would like further explanation of the above, let me know.</p>\n"}], "owner": {"reputation": 91, "user_id": 6399647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b01afc2351152df54a6ca3f50f805f12?s=128&d=identicon&r=PG&f=1", "display_name": "JeanLo", "link": "https://stackoverflow.com/users/6399647/jeanlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469013899, "creation_date": 1469008262, "last_edit_date": 1469013899, "question_id": 38477899, "link": "https://stackoverflow.com/questions/38477899/vba-read-a-texts-files-permission-denied", "title": "VBA Read a texts files: permission denied", "body": "<p>I have a folder contain texts files . The text is presented as below :</p>\n\n<pre><code>NAME   Number   Mail  Date\nxx      1       zz    //\n</code></pre>\n\n<p>and I want to write a vba code that read all the text files and search for an information \"NAME\" to replace it with \"name\"and then save the modifications . \nI did the code below , but I have an <code>error 70 permission denied</code> in <code>Set f = FSO.OpenTextFile(Fichier, forWriting, True)</code>  ,</p>\n\n<p>could you help me ? </p>\n\n<pre><code>Sub Sample()\n     dim fso=createobject(\"scripting.filesystemObject\") \n     dim f\n     dim path as string\n     dim file_txt as string\n\n      path= \"C:\\Users\\Folder\\Fileshere\\\"\n      file_txt= Dir(path &amp; \"*.*\")\n\n    Do While Len(file_txt) &gt; 0\n      'Set objfile = FSO.CreateTextFile(path &amp; file_txt)\n      Set f = FSO.OpenTextFile(file_txt, ForReading)\n      While Not f.AtEndOfStream\n      Namechange = f.ReadAll\n      Wend\n      Namechange = Replace(Namechange , \"NAME\", \"name\")\n      Set f = FSO.OpenTextFile(file_txt, forWriting, True)\n      f.Write Namechange \n\n    file_txt=dir()\n    loop\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "if-statement"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 2, "creation_date": 1469007163, "post_id": 38477377, "comment_id": 64357540, "body": "Why do you need it in a single line?"}, {"owner": {"reputation": 429, "user_id": 2943191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8c3f216945a076981b9a993687f552?s=128&d=identicon&r=PG&f=1", "display_name": "Klaidonis", "link": "https://stackoverflow.com/users/2943191/klaidonis"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1469008136, "post_id": 38477377, "comment_id": 64358183, "body": "Just for reading. For short and simple code parts it&#39;s often easier to read and &quot;grasp&quot; the code on one line rather than putting everything on its own line."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1469018520, "post_id": 38477377, "comment_id": 64365252, "body": "Not an answer, but you&#39;ll find the same behavior with <i>all</i> of VBA&#39;s looping structures (<code>For...Next</code>, <code>Do...Loop</code>, <code>While...Wend</code>, <code>For Each...Next</code>).  My hunch is that it has to do with some combination of how the compiler has to deal with line numbers and debugging breakpoints."}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 2943191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8c3f216945a076981b9a993687f552?s=128&d=identicon&r=PG&f=1", "display_name": "Klaidonis", "link": "https://stackoverflow.com/users/2943191/klaidonis"}, "edited": false, "score": 0, "creation_date": 1469030688, "post_id": 38477869, "comment_id": 64372996, "body": "The only disadvantage is that you cannot omit the True or False clause. Is it possible to have multiple statements inside the True or False part?"}, {"owner": {"reputation": 58, "user_id": 7390790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21146d8d6654287d77019210537e26bc?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Schreuder", "link": "https://stackoverflow.com/users/7390790/gilles-schreuder"}, "edited": false, "score": 0, "creation_date": 1514571885, "post_id": 38477869, "comment_id": 83023228, "body": "a = b within the IIf clause is a comparison that will yield true or false, and is not an assigment statement giving the value of b to a."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 4, "last_activity_date": 1469008198, "creation_date": 1469008198, "answer_id": 38477869, "question_id": 38477377, "link": "https://stackoverflow.com/questions/38477377/excel-vba-for-and-if-statement-on-a-single-line/38477869#38477869", "title": "Excel VBA: &quot;For&quot; and &quot;If&quot; statement on a single line?", "body": "<p>You can do it with <code>IIf</code>, rather than <code>If</code>. </p>\n\n<p>This code won't throw the error:</p>\n\n<pre><code>For i = 0 To n: IIf a = i, a = b, False: Next i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9315819, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/eb084e2166047768f73a5d4b3b12c835?s=128&d=identicon&r=PG", "display_name": "florin", "link": "https://stackoverflow.com/users/9315819/florin"}, "is_accepted": false, "score": 3, "last_activity_date": 1517838424, "last_edit_date": 1517838424, "creation_date": 1517822897, "answer_id": 48619322, "question_id": 38477377, "link": "https://stackoverflow.com/questions/38477377/excel-vba-for-and-if-statement-on-a-single-line/48619322#48619322", "title": "Excel VBA: &quot;For&quot; and &quot;If&quot; statement on a single line?", "body": "<p>Use <code>select case</code> instead of if...</p>\n\n<p><code>For i = 0 To n: select case a = i: case true: a = b: end select: Next i</code></p>\n"}], "owner": {"reputation": 429, "user_id": 2943191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8c3f216945a076981b9a993687f552?s=128&d=identicon&r=PG&f=1", "display_name": "Klaidonis", "link": "https://stackoverflow.com/users/2943191/klaidonis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8847, "favorite_count": 0, "accepted_answer_id": 38477869, "answer_count": 2, "score": 2, "last_activity_date": 1594151765, "creation_date": 1469006731, "last_edit_date": 1594151765, "question_id": 38477377, "link": "https://stackoverflow.com/questions/38477377/excel-vba-for-and-if-statement-on-a-single-line", "title": "Excel VBA: &quot;For&quot; and &quot;If&quot; statement on a single line?", "body": "<p>Is it somehow possible in VBA to put a <code>For</code> and <code>If</code> statement in a single line?\nThe closest what I could get is this:</p>\n\n<pre><code>For i = 0 To n: If a = i Then a = b\nNext i\n</code></pre>\n\n<p>If I write:</p>\n\n<pre><code>For i = 0 To n: If a = i Then a = b: Next i\n</code></pre>\n\n<p>I get the \"<strong>Next without For</strong>\" error.</p>\n"}, {"tags": ["excel", "vba", "macros", "runtime-error", "vlookup"], "comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1469007591, "post_id": 38477369, "comment_id": 64357826, "body": "When you debug-through what is your &quot;cell&quot; coming back as? Mine is showing as Empty, though this may be to do with my dummy data that I whacked in. I had thought this is because Worksheets.Cells is expecting rowindex and columnindex as it&#39;s arguments and you&#39;ve used &quot;U&quot; as a string instead of a number."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 3, "creation_date": 1469007892, "post_id": 38477369, "comment_id": 64358001, "body": "<code>Application.VLookup</code> will return a <code>Variant</code>. This is either the value of the successful <code>VLOOKUP</code>ed cell or an <code>Error</code> value. But an <code>Error</code> value does not fit into <code>String</code>. That&#39;s why <code>Dim test As Variant</code> is needed."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1469008119, "post_id": 38477369, "comment_id": 64358172, "body": "@Tim Edwards: The &quot;U&quot; in <code>Worksheets(&quot;TOTAL&quot;).Cells(i, &quot;U&quot;)</code> means the column <code>U</code>. So you must put something  into <code>U3</code> in <code>Worksheets(&quot;TOTAL&quot;)</code>. Then you will get that back if <code>i</code> is 3."}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1469008376, "post_id": 38477369, "comment_id": 64358338, "body": "Thanks @AxelRichter, I&#39;d only used cells() with numbers, wasn&#39;t aware you could mix given i is a long."}, {"owner": {"reputation": 23, "user_id": 6612848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33fa82df33a6be3c96a6ad292744ed44?s=128&d=identicon&r=PG&f=1", "display_name": "gonzika", "link": "https://stackoverflow.com/users/6612848/gonzika"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1469012788, "post_id": 38477369, "comment_id": 64361179, "body": "Thank you @AxelRichter, works like a charm!"}], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1469009415, "creation_date": 1469009415, "answer_id": 38478350, "question_id": 38477369, "link": "https://stackoverflow.com/questions/38477369/vba-vlookup-is-running-to-runtime-error-13/38478350#38478350", "title": "VBA - vlookup is running to runtime error &#39;13&#39;", "body": "<p>Try with below code. It will work</p>\n\n<pre><code>Sub elsovlookup()\n    Dim i As Long\n    Dim size As Long\n    Dim cell As Range\n    size = WorksheetFunction.CountA(Worksheets(\"TOTAL\").Columns(1)) + 1\n    For i = 3 To size\n        Set cell = Worksheets(\"TOTAL\").Cells(i, \"U\")\n        If Application.WorksheetFunction.CountIf(Worksheets(\"OLA list\").Range(\"K:K\"), cell.Value) &gt; 0 Then\n            Worksheets(\"TOTAL\").Cells(i, \"AC\") = \"OLA found\"\n        Else\n            Worksheets(\"TOTAL\").Cells(i, \"AC\") = \"OLA not found\"\n        End If\n        Worksheets(\"TOTAL\").Cells(i, \"V\") = test\n    Next i\n    MsgBox \"First vlookup is complete.\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6612848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33fa82df33a6be3c96a6ad292744ed44?s=128&d=identicon&r=PG&f=1", "display_name": "gonzika", "link": "https://stackoverflow.com/users/6612848/gonzika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469009415, "creation_date": 1469006713, "last_edit_date": 1469008189, "question_id": 38477369, "link": "https://stackoverflow.com/questions/38477369/vba-vlookup-is-running-to-runtime-error-13", "title": "VBA - vlookup is running to runtime error &#39;13&#39;", "body": "<p>I am fairly new to VBA and I would like to create a VLOOKUP macro, but consequently facing the same issue, when the VLOOKUP cannot find the value from the range it runs into runtime error '13' Type mismatch.</p>\n\n<p>What I want the macro to do is for each line item in TOTAL sheet find the value from OLA list sheet and it does it, except for the ones that are not included in the OLA list sheet, for them I want it to write \"NA\".</p>\n\n<p>See my code below:</p>\n\n<pre><code>Sub elsovlookup()\n\n    Dim i As Long\n    Dim test As String\n    Dim size As Long\n\n    size = WorksheetFunction.CountA(Worksheets(\"TOTAL\").Columns(1)) + 1\n\n        For i = 3 To size\n\n        cell = Worksheets(\"TOTAL\").Cells(i, \"U\")\n        test = Application.VLookup(cell, Worksheets(\"OLA list\").Range(\"K:R\"), 8, False)\n        If IsError(test) Then\n            test = \"NA\"\n            Worksheets(\"TOTAL\").Cells(i, \"AC\") = \"OLA not found\"\n        Else:\n            Worksheets(\"TOTAL\").Cells(i, \"AC\") = \"OLA found\"\n        End If\n        Worksheets(\"TOTAL\").Cells(i, \"V\") = test\n    Next i\n\n    MsgBox \"First vlookup is complete.\"\n</code></pre>\n\n<p>Thank you in advance for the help</p>\n"}, {"tags": ["vba", "runtime-error"], "comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1469006684, "post_id": 38477179, "comment_id": 64357188, "body": "Your variables cannot start with the value 0 as rows and columns zero does not exist. Start with 1. Also, you cannot write <code>Cells(6, G)</code> columns are to be referred as number 1 for A, 2 for B, etc."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469006768, "post_id": 38477179, "comment_id": 64357252, "body": "You could do this with a formula, is there any need for VBA?"}, {"owner": {"reputation": 27, "user_id": 6612777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfa05297f509f227dea913d6ca1e3e8?s=128&d=identicon&r=PG&f=1", "display_name": "Trefl", "link": "https://stackoverflow.com/users/6612777/trefl"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1469006994, "post_id": 38477179, "comment_id": 64357429, "body": "@Nathan_Sav I am total newbie if we are talkig about Excel. :("}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1469007258, "creation_date": 1469007258, "answer_id": 38477553, "question_id": 38477179, "link": "https://stackoverflow.com/questions/38477179/visual-basic-macro-error/38477553#38477553", "title": "Visual Basic Macro error", "body": "<p>You can do this with an array formula, a normal formula, but works on many cells, so you need to CTRL SHIFT ENTER, and it will be this</p>\n\n<p><code>=MAX(IF(CONCATENATE($I$1:$I$3,\" \",$J$1:$J$3)=L1,ROW($I$1:$I$3)))</code></p>\n\n<p>My first name was in I, last name in J and the data entry in L1, this gives the row number of the occurrence, then you can use <code>INDEX</code> to get the values, or <code>OFFSET</code></p>\n\n<p><a href=\"https://support.office.com/en-gb/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow\">https://support.office.com/en-gb/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd</a></p>\n"}], "owner": {"reputation": 27, "user_id": 6612777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfa05297f509f227dea913d6ca1e3e8?s=128&d=identicon&r=PG&f=1", "display_name": "Trefl", "link": "https://stackoverflow.com/users/6612777/trefl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 38477553, "answer_count": 1, "score": 0, "last_activity_date": 1503577358, "creation_date": 1469006251, "last_edit_date": 1503577358, "question_id": 38477179, "link": "https://stackoverflow.com/questions/38477179/visual-basic-macro-error", "title": "Visual Basic Macro error", "body": "<p>I have a problem with my macro do Microsoft Excel. I want to make macro that will check if in one row there is word that its the same word that user inputed in cell, and than it have to check the whole row to compare other informations. In ex. User inputs Adam Smith 12.05.2016 and macro has to find name Adam in name column and than check if this Adam has surname Smith and date 12.05.2016. If yes print whole row. \n I have created the whole macro but I got error1004 Application-defined or object-defined error.</p>\n\n<pre><code>    Sub Test()\n Dim r As Integer\n Dim c1 As Integer\n Dim c2 As Integer\n Dim i As Integer\n r = 0\n c1 = 0\n c2 = 0\n i = 0\n ' Iterates through name column\n Do Until Cells(r, c1).Value = \"\"\n    ' If program finds the name in name row equal to name in (6, G) returns true\n        If Cells(r, c1).Value = Cells(6, G).Value Then\n            ' Iterates through surname row\n            Do Until Cells(r, c2).Value = \"\"\n                ' If surname is the same and date is on the right of the surname Return tur\n                If Cells(r, c2).Value = Cells(6, H).Value And Cells(r, c2 + 1).Value = Cells(6, i) Then\n                    Do Until i &lt;= 0\n                    ' Output whole data from the row\n                    Cells(10, H + i).Value = Cells(r, c1 + i).Value\n                    i = i + 1\n                    Loop\n                End If\n            c2 = c2 + 1\n            Loop\n        End If\nr = r + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "checkbox"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1469007747, "post_id": 38477106, "comment_id": 64357921, "body": "You need to create a class to handle the events - check these links:  <a href=\"http://stackoverflow.com/questions/3014421/how-to-add-events-to-controls-created-at-runtime-in-excel-with-vba\" title=\"how to add events to controls created at runtime in excel with vba\">stackoverflow.com/questions/3014421/&hellip;</a> (use the class event, not adding extra code!)."}, {"owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1469008358, "post_id": 38477106, "comment_id": 64358326, "body": "@DarrenBartrup-Cook Thanks for your post. I have it up-voted :) I will share my solution code soon."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1469010490, "creation_date": 1469010490, "answer_id": 38478773, "question_id": 38477106, "link": "https://stackoverflow.com/questions/38477106/checkbox-event-doesnt-work-in-vba/38478773#38478773", "title": "Checkbox event doesn&#39;t work in VBA", "body": "<p>Add a class module to your project, name it as you want (say \"ChkBox\"), and put this code in it:</p>\n\n<pre><code>Public WithEvents Chk As MSForms.CheckBox\n\nPrivate Sub Chk_Click()\n    MsgBox Chk.Value\nEnd Sub\n</code></pre>\n\n<p>In your userform code, add this</p>\n\n<pre><code>Dim myChks(1 To 4) As New ChkBox '&lt;--| this must be at the very top of your userform code pane\n\nSub Userform_Initialize()\n    Dim i As Long, k As Long\n\n    With Me.Frame4.Controls\n        For i = 1 To 4\n            With .Add(\"Forms.Checkbox.1\", \"Checkbox\" &amp; i)\n                .Top = 84 + k\n                .Left = 336\n                .Width = 100\n                .Height = 18\n                .Caption = \"Add item\"\n                .Visible = True\n                Set myChks(i).Chk = .Parent.Item(.Name)\n            End With\n            k = k + 24\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 38478773, "answer_count": 1, "score": 0, "last_activity_date": 1469010490, "creation_date": 1469006081, "last_edit_date": 1531164843, "question_id": 38477106, "link": "https://stackoverflow.com/questions/38477106/checkbox-event-doesnt-work-in-vba", "title": "Checkbox event doesn&#39;t work in VBA", "body": "<p>I dynamically defined checkboxes, which are added to the userform on runtime.</p>\n\n<pre><code>Sub Userform_Initialize()\n  For i = 1 To 4\n    Set Chk = Frame4.Controls.Add(\"Forms.Checkbox.1\", \"Checkbox\" &amp; i)\n    With Chk\n       .top = 84 + k\n       .left = 336\n       .Width = 100\n       .Height = 18\n       .Caption = \"Add item\"\n       .Visible = True\n    End With\n    k = k + 24\n  Next i\nEnd Sub\n\nPublic WithEvents Chk As MSForms.CheckBox\nPrivate Sub Chk_Click()\n    MsgBox Chk\nEnd Sub\n</code></pre>\n\n<p>For some reason, the event doesn't respond. Does anyone have an idea as to why? I need the boolean of the checkbox. That means when the user clicked on a dynamic checkbox, then I see \"True\" returned in the msgbox.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1469004650, "post_id": 38476322, "comment_id": 64355703, "body": "The problem is not the value of <code>A1</code> but the return value of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839468.aspx\" rel=\"nofollow noreferrer\">Application.InputBox</a>. This will be text until you use <code>Type:=1</code> or convert it with <code>Val(first_row)</code>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1469004865, "creation_date": 1469004865, "answer_id": 38476670, "question_id": 38476322, "link": "https://stackoverflow.com/questions/38476322/restrictions-on-application-inputbox-and-cell-formated-as-text/38476670#38476670", "title": "Restrictions on Application.Inputbox and cell formated as text", "body": "<p>Set <code>Application.Inputbox</code> type parameter = 2 will return a numeric value.  Declaring <code>first_row As Long</code> will ensure that first_row  is always a numeric value.</p>\n\n<pre><code>Sub test()\n    Dim first_row As Long\n    Dim prompt As String\n\n    Do\n        prompt = \"Below which row new row(s) should be inserted?\" &amp; vbCr &amp; \"Min: \" &amp; Sheets(\"Sheet1\").Range(\"A1\") &amp; \"  Max: 500\"\n\n        first_row = Application.InputBox(prompt:=prompt, Type:=1)\n\n        If first_row = 0 Then Exit Sub\n\n        If first_row &gt; 500 Or first_row &lt; Sheets(\"Sheet1\").Range(\"A1\") Then MsgBox (\"Row has to be &gt;= \" &amp; Sheets(\"Sheet1\").Range(\"A1\").Value &amp; \" and &lt;= 500\")\n\n    Loop Until first_row &lt;= 500 And first_row &gt;= Sheets(\"Sheet1\").Range(\"A1\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 38476670, "answer_count": 1, "score": 0, "last_activity_date": 1469004865, "creation_date": 1469003943, "last_edit_date": 1531161705, "question_id": 38476322, "link": "https://stackoverflow.com/questions/38476322/restrictions-on-application-inputbox-and-cell-formated-as-text", "title": "Restrictions on Application.Inputbox and cell formated as text", "body": "<p>I have the following simple excel table with this formula\nin cell A1: </p>\n\n<pre><code>= MID(B1;1;2))\n</code></pre>\n\n<p>which gives me a value of 30.</p>\n\n<pre><code>        A           B              C\n1      30        30:30\n2\n3\n4\n5\n</code></pre>\n\n<p>Now I want to apply the following loop in a macro to it:</p>\n\n<pre><code>Sub test()\n    Do\n        first_row = Application.InputBox(\"Below which row new row(s) should be inserted?\" _\n                                         &amp; vbCr &amp; \"Min: \" &amp; Sheets(\"Sheet1\").Range(\"A1\") &amp; \"  Max: 500\")\n        If first_row = False Then Exit Sub\n        If first_row &gt; 500 Or first_row &lt; Sheets(\"Sheet1\").Range(\"A1\") Then MsgBox (\"Row has to be &gt;= \" &amp; Sheets(\"Sheet1\").Range(\"A1\").Value &amp; \" and &lt;= 500\")\n    Loop Until first_row &lt;= 500 And first_row &gt;= Sheets(\"Sheet1\").Range(\"A1\") Or first_row = False\nEnd Sub\n</code></pre>\n\n<p>In this macro the user gets a message box in which he has to enter a number. This number must be between the value in cell A1 (in this case: 30) and 500.</p>\n\n<p>However, right now once the user enteres a number over 100 the loop does not accept the value although it is between 30 and 500.\nIt only accepts values under 100.</p>\n\n<p>So far I figured that the issue might be caused by cell B1 which is formated as \"TEXT\". Otherwise it won't be possible to use \"30:30\" in this cell.</p>\n\n<p>Therefore, I tried to change the formula in A1 to the following:</p>\n\n<pre><code>= VALUE(MID(B1;1;2)))\n</code></pre>\n\n<p>It does work but then the system also allows values below 30.</p>\n\n<p>Do you have any idea how to solve this issue?</p>\n"}, {"tags": ["postgresql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1469004379, "post_id": 38476427, "comment_id": 64355528, "body": "Great minds think alike. :) The <code>dbSQLPassThrough</code> parameter may be necessary though."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1469004560, "post_id": 38476427, "comment_id": 64355628, "body": "Possibly necessary, definitely more efficient :)"}], "tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": false, "score": 2, "last_activity_date": 1469004212, "creation_date": 1469004212, "answer_id": 38476427, "question_id": 38476094, "link": "https://stackoverflow.com/questions/38476094/insert-values-in-postgresql-database-from-vba-ms-access/38476427#38476427", "title": "Insert values in PostgreSQL database from VBA MS-ACCESS", "body": "<p>The line <code>DoCmd.RunSQL strsql &amp; salida</code> <strong>executes the SQL it the Access currentDb.</strong>\nReplace that line with this:</p>\n\n<pre><code>db.Execute strsql &amp; salida\n</code></pre>\n\n<p>So that the SQL <strong>gets executed from the Database object</strong> you have opened, and connected to PostgreSQL.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "edited": false, "score": 0, "creation_date": 1469004604, "post_id": 38476438, "comment_id": 64355666, "body": "Thanks marlan and Andre, It worked fine. Thank You very much!!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1469004241, "creation_date": 1469004241, "answer_id": 38476438, "question_id": 38476094, "link": "https://stackoverflow.com/questions/38476094/insert-values-in-postgresql-database-from-vba-ms-access/38476438#38476438", "title": "Insert values in PostgreSQL database from VBA MS-ACCESS", "body": "<p><code>DoCmd.RunSQL</code> runs the SQL string through the Access Database Engine. There <code>[..]</code> is interpreted as parameter, therefore the error message.</p>\n\n<p>You have opened a db connection to the PostgreSQL database, but you don't use it.</p>\n\n<p>It might be as simple as changing </p>\n\n<pre><code>DoCmd.RunSQL strsql &amp; salida\n</code></pre>\n\n<p>to</p>\n\n<pre><code>db.Execute strsql &amp; salida, dbSQLPassThrough\n</code></pre>\n\n<p>With a Pass-Through query the SQL string is passed directly to the database.</p>\n"}], "owner": {"reputation": 29, "user_id": 6612532, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9ef5a0c1ab32717d77371fe447f6b9cd?s=128&d=identicon&r=PG&f=1", "display_name": "E. Salas", "link": "https://stackoverflow.com/users/6612532/e-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 1, "accepted_answer_id": 38476438, "answer_count": 2, "score": 1, "last_activity_date": 1469004241, "creation_date": 1469003181, "last_edit_date": 1495540370, "question_id": 38476094, "link": "https://stackoverflow.com/questions/38476094/insert-values-in-postgresql-database-from-vba-ms-access", "title": "Insert values in PostgreSQL database from VBA MS-ACCESS", "body": "<p>I've seen this topic before <a href=\"https://stackoverflow.com/questions/25044447/how-to-insert-values-into-the-database-table-using-vba-in-ms-access\">How to insert values into the database table using VBA in MS access</a>\nBut it didn't solve my issue.\nI'm creating a form to insert values into a table in postgresql that contains arrays [] text.\nThe user must select the items to add and then execute the SQL statement by clicking a button. So I first create a button and a text box to load the items to add into the array, here is the code</p>\n\n<pre><code>Private Sub cmdSig_Click()\n Dim registros As String\n registros = \"'\" &amp; [memo] &amp; \"'\" &amp; \", \"\n [resu] = registros &amp; [resu]\nEnd Sub\n</code></pre>\n\n<p>Then I create the button to execute the SQL INSERT INTO statement. Here is the code:</p>\n\n<pre><code>    Private Sub cmdPruebas_Click()\n    Dim strsql As String, resultado As String, salida As String\n\n        Dim db As Database\n        dbconnect = \"ODBC;DRIVER=PostgreSQL ANSI;UID=***;PWD=***;PORT=5432;SERVER=***.***.**.**;DATABASE=somedb;DSN=C:\\***\"\n        Set db = OpenDatabase(\"\", False, False, dbconnect)\n        resultado = [resu]\n\n        strsql = \"insert into prueba_arrays (tipo_intervencion) values \"\n        salida = \"(array[\" &amp; resultado &amp; \"]);\"\n\n\n\n\n        DoCmd.SetWarnings False\n        DoCmd.RunSQL strsql &amp; salida\n        DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n\n<p>If I execute the result in PostgreSQL like \"Insert into sometable (array_field) values (array['value1','value2','value3']);\" it works fine. But in MS-Access it says: Error 3075 'execution time' Missing operator in the query 'array['value1','value2','value3']'.\nAny idea of what's happening?\nThanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1469003953, "post_id": 38475935, "comment_id": 64355261, "body": "Use the .find function, it&#39;s faster."}, {"owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1469006849, "post_id": 38475935, "comment_id": 64357319, "body": "can you change my code with your function because i am beginner in vba"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1469003859, "creation_date": 1469003859, "answer_id": 38476294, "question_id": 38475935, "link": "https://stackoverflow.com/questions/38475935/make-vba-search-for-entire-row-in-excel/38476294#38476294", "title": "make VBA Search for entire row in excel", "body": "<p>I made Agent name a parameter.  The sub will now add rows that match the creteria to Sheets(\"Remaining\").   You would call the sub like this <code>MatchingCityAndCardType2 \"Ali\"</code> <br></p>\n\n<pre><code>Sub MatchingCityAndCardType2(AgentName As String)\n    Dim City As String, Sale_Type As String, Agent_name As String, i As Long, rData As Range, j As Long, Last_Row As Long\n    Last_Row = Cells(Rows.Count, \"H\").End(xlUp).Row\n    Sheets(\"Remaining\").Cells.ClearContents\n\n    For i = Last_Row To 2 Step -1\n        Agent_name = Cells(i, \"B\").Value\n        City = Cells(i, \"D\").Value\n        Sale_Type = Cells(i, \"E\").Value\n\n        If City = \"Erbil\" And Sale_Type = \"bazar\" And Agent_name = AgentName And Mid(Cells(i, \"H\"), 1, 6) = 49000 Then\n            'Set the range destination, Range(\u201cA2\u201d), depending on which\n            'range you want in Sheets(\u201cRemaining\u201d)\n            Rows(i).EntireRow.Copy Destination:=Worksheets(\"Remaining\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n            Exit For\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 0, "last_activity_date": 1469006720, "creation_date": 1469006720, "answer_id": 38477371, "question_id": 38475935, "link": "https://stackoverflow.com/questions/38475935/make-vba-search-for-entire-row-in-excel/38477371#38477371", "title": "make VBA Search for entire row in excel", "body": "<p>First, you have to delete this line: <code>Sheets(\"Remaining\").Cells.ClearContents</code> from your code. Second, you add this variable below the variable <strong>Last_Row</strong> :</p>\n\n<p><code>Last_Row2 = Worksheets(\"Remaining\").Cells(Rows.Count, \"B\").End(xlUp).Row + 1</code></p>\n\n<p>Third, replace the line:</p>\n\n<pre><code>Rows(i).EntireRow.Copy Destination:=Worksheets(\"Remaining\").Range(\"A1\")\n</code></pre>\n\n<p>with this line:</p>\n\n<pre><code>Rows(i).EntireRow.Copy Destination:=Worksheets(\"Remaining\").Range(\"A\" &amp; Last_Row2)\n</code></pre>\n\n<p>Done!</p>\n"}], "owner": {"reputation": 43, "user_id": 3649406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100001038149154/picture?type=large", "display_name": "pashew", "link": "https://stackoverflow.com/users/3649406/pashew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469006720, "creation_date": 1469002656, "question_id": 38475935, "link": "https://stackoverflow.com/questions/38475935/make-vba-search-for-entire-row-in-excel", "title": "make VBA Search for entire row in excel", "body": "<p>Dears Good Day<a href=\"https://i.stack.imgur.com/xOWft.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xOWft.jpg\" alt=\"Main Picture\"></a>\nin (main)picture i have these data and  in (exported)picture i have the result.\nin my code i want to make (agent name) depends on specific row i will create it with agent names . that mean i don't want to duplicate the code for each agent .\nif i add another agent it will automatically add another row in (exported)picture.in my code the row start with \"A1\" and for other records \"A2\",\"A3\" and so on.....<a href=\"https://i.stack.imgur.com/lUU70.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lUU70.jpg\" alt=\"exported Picture\"></a>\nSimply I want make (Agent_Name) more than one record and depend on specific row i will create it</p>\n\n<pre><code>Sub MatchingCityAndCardType2()\nDim City As String, Sale_Type As String, Agent_name As String, i As Long, rData As Range, j As Long, Last_Row As Long\nLast_Row = Cells(Rows.Count, \"H\").End(xlUp).Row\nSheets(\"Remaining\").Cells.ClearContents\n\nFor i = Last_Row To 2 Step -1\n    Agent_name = Cells(i, \"B\").Value\n    City = Cells(i, \"D\").Value\n    Sale_Type = Cells(i, \"E\").Value\n\n    If City = \"Erbil\" And Sale_Type = \"bazar\" And Agent_name = \"Ali\" And Mid(Cells(i, \"H\"), 1, 6) = 49000 Then\n        'Set the range destination, Range(\u201cA2\u201d), depending on which\n        'range you want in Sheets(\u201cRemaining\u201d)\n        Rows(i).EntireRow.Copy Destination:=Worksheets(\"Remaining\").Range(\"A1\")\n        Exit For\n    End If\n\nNext i\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1469003606, "post_id": 38475674, "comment_id": 64355057, "body": "In the line <code>Dim fndEntry, rngTo, rngFrom As Range</code> , only rngFrom is defined as <code>Range</code>, fndEntry and rngTo are of type <code>Variant</code>."}, {"owner": {"reputation": 9, "user_id": 6587845, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e32afa48cea2f2257b2cb2f75cd5e022?s=128&d=identicon&r=PG&f=1", "display_name": "Smeltet", "link": "https://stackoverflow.com/users/6587845/smeltet"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1469003871, "post_id": 38475674, "comment_id": 64355209, "body": "Dont I feel like a fool, thx a bunch!!!"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6587845, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e32afa48cea2f2257b2cb2f75cd5e022?s=128&d=identicon&r=PG&f=1", "display_name": "Smeltet", "link": "https://stackoverflow.com/users/6587845/smeltet"}, "edited": false, "score": 0, "creation_date": 1469003590, "post_id": 38476091, "comment_id": 64355050, "body": "Thx, and then I get a Syntax error on the &quot;rngTo(, &quot;B&quot;) = rngFrom(, &quot;H&quot;) line, what am I doing wrong?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 9, "user_id": 6587845, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e32afa48cea2f2257b2cb2f75cd5e022?s=128&d=identicon&r=PG&f=1", "display_name": "Smeltet", "link": "https://stackoverflow.com/users/6587845/smeltet"}, "edited": false, "score": 0, "creation_date": 1469004174, "post_id": 38476091, "comment_id": 64355399, "body": "I updated my answer.  <code>rngTo(, &quot;B&quot;)</code> is not valid.  Use <code>rngTo.Offset(0,1)</code> instead."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1469004017, "last_edit_date": 1469004017, "creation_date": 1469003168, "answer_id": 38476091, "question_id": 38475674, "link": "https://stackoverflow.com/questions/38475674/vba-error-91-cannot-set-my-range/38476091#38476091", "title": "VBA Error 91 - Cannot set my range", "body": "<p>Change:</p>\n\n<pre><code>    Set rngTo = wsTo.Range(\"A\" &amp; I)\n    Set rngFrom = wsFrom.Range(\"A\" &amp; fndEntry.Row)\n\n    If Not fndEntry Is Nothing Then\n\n        rngTo(, \"B\") = rngFrom(, \"H\")\n\n    End If\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>    If Not fndEntry Is Nothing Then\n\n        Set rngTo = wsTo.Range(\"A\" &amp; I)\n        Set rngFrom = wsFrom.Range(\"A\" &amp; fndEntry.Row)\n        rngTo.Offset(0, 1) = rngFrom.Offset(0, 7)\n\n    End If\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6587845, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e32afa48cea2f2257b2cb2f75cd5e022?s=128&d=identicon&r=PG&f=1", "display_name": "Smeltet", "link": "https://stackoverflow.com/users/6587845/smeltet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469004017, "creation_date": 1469001835, "question_id": 38475674, "link": "https://stackoverflow.com/questions/38475674/vba-error-91-cannot-set-my-range", "title": "VBA Error 91 - Cannot set my range", "body": "<p>I have completed my very rough code, but I am in the process of optimising it.</p>\n\n<p>I have defined my worksheets, but now I need to define my 2 ranges, rngTo and rngFrom. The rngTo set without a problem, but rngFrom throws an Error 91 and I cannot understand why. It should be any different than the other? Below is the part of the code which I think is relevant, but there might be some Dim's that are not utilised in this snapshot:</p>\n\n<pre><code>Sub Worksheet_UpdateAllItemCostData()\n\nDim material As Variant\nDim fndEntry, rngTo, rngFrom As Range\nDim wb1 As Workbook, wb2 As Workbook\nDim wsTo, wsFrom As Worksheet\nDim lr As Long, I As Long, J As Long\nConst sPOS As String = \"Pos. \"\n\nApplication.Calculation = xlCalculationManual ' Disable\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet wb1 = ThisWorkbook\nSet wsTo = wb1.Sheets(\"Sagsnr.\")\n\nwsTo.Rows(\"1:1\").Hidden = False\n\nlr = wb1.Sheets(\"Sagsnr.\").Cells(Rows.Count, \"C\").End(xlUp).Row\n\nIf lr &lt; 21 Then\n    Exit Sub\nEnd If\n\nSet wb2 = Workbooks.Open(Filename:=\"G:\\Backoffice\\Tilbudsteam\\Kostdatabase\\Matcost.xls\", ReadOnly:=True)\n\nSet wsFrom = wb2.Sheets(\"Matcost\")\n\n    For I = 21 To lr\n\n        material = wsTo.Range(\"C\" &amp; I).Value\n\n        Set fndEntry = wsFrom.UsedRange.Columns(4).Find(What:=material)\n\n    Set rngTo = wsTo.Range(\"A\" &amp; I)\n    Set rngFrom = wsFrom.Range(\"A\" &amp; fndEntry.Row)\n\n    If Not fndEntry Is Nothing Then\n\n            rngTo(, \"B\") = rngFrom(, \"H\")\n\n        End If\n\nNext I\n\nwb2.Close\nwsTo.Rows(\"1:1\").Hidden = True\n\nApplication.Calculation = xlCalculationAutomatic 'Enable\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "filter", "vba"], "answers": [{"tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1469003321, "creation_date": 1469003321, "answer_id": 38476140, "question_id": 38475635, "link": "https://stackoverflow.com/questions/38475635/linking-2-excel-files-with-filters/38476140#38476140", "title": "linking 2 excel files with filters", "body": "<p>There are many ways of getting information from other workbooks / sheets etc.\nIt depends on what you want to do with that information and how it's laid out.</p>\n\n<p>Have a look into <code>VLOOKUP</code> / <code>MATCH</code> / <code>SUMIF</code> / <code>SUMIFS</code> / <code>COUNTIF</code> / <code>COUNTIFS</code></p>\n\n<p>Which you use will depend on how you want it to work.\nIf you edit your question to include specifics then I / others can advise further.</p>\n"}], "owner": {"reputation": 1, "user_id": 6612440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd179d9668bac82ea203384634afef8?s=128&d=identicon&r=PG&f=1", "display_name": "user6612440", "link": "https://stackoverflow.com/users/6612440/user6612440"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469074591, "creation_date": 1469001716, "last_edit_date": 1531161705, "question_id": 38475635, "link": "https://stackoverflow.com/questions/38475635/linking-2-excel-files-with-filters", "title": "linking 2 excel files with filters", "body": "<p>I have two separate workbooks that I am trying to link: Register and Budget. \nThe Register file is the source of data and contains only 1 table with columns Date, Category, Credit, Debit. The Budget file is the destination file and has 12 sheets named for each month of the year. Each sheet contains multiple tables named for the Categories. Each table contains columns in which I want to automatically populate from Register one at a time.   </p>\n\n<p>So basically, as I manually populate the Register workbook with values in Date, Category, Credit, Debit, I want the Budget workbook to automatically update itself based on these values. The main problem I have is how do I get the Date entered as 01/01/2016 in Register to be recognized as the January sheet in Budget workbook? In addition, I want the correct Category to be recognized in Register as each table's name in Budget. I have changed the table names in Budget based on the category. Finally, I would like the amounts Credit or Debit to be copied from Register into columns in each table of Budget after finding the correct sheet and table in Budget.</p>\n\n<p><a href=\"http://i.stack.imgur.com/4Ic2X.png\" rel=\"nofollow\">Register</a>, \n<a href=\"http://i.stack.imgur.com/VfO6O.png\" rel=\"nofollow\">Budget</a></p>\n\n<p>I looked into Vlookup and it works except for the fact I would have to manually change the formula each time the category or date changes. Sum and Count don't work because I don't want to sum columns nor count data. I simply want to copy and paste from columns Credit or Debit in Register into each table's columns in Budget. I have a feeling I'd have to go into VBA coding to achieve this daunting task which I'm not familiar with.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "edited": false, "score": 0, "creation_date": 1469001621, "post_id": 38475358, "comment_id": 64353876, "body": "Can you post the picture of your Excel worksheet and share some data to your question?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469002286, "post_id": 38475358, "comment_id": 64354285, "body": "The Like operator uses &quot;?&quot; and &quot;#&quot; as special characters.  To search for the string &quot;?#+@&quot; you will need to say <code>Like &quot;*[?][#]+@*&quot;</code>.  (The leading and trailing &quot;*&quot; indicate that there can be zero or more characters before/after the string."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1469002910, "post_id": 38475358, "comment_id": 64354634, "body": "Are you wanting the Results sheet to have a single cell containing the message and the date (still with the &quot;?#+@&quot; separating them) or do you want the message in a cell in column 1 and the date in the cell next to it in column 2?  (i.e. first message in A2, first date in B2, second message in A3, second date in B3, etc)"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1469003284, "creation_date": 1469003284, "answer_id": 38476130, "question_id": 38475358, "link": "https://stackoverflow.com/questions/38475358/not-able-to-extract-a-pattern-using-vba/38476130#38476130", "title": "Not able to extract a pattern using VBA", "body": "<p>The following code will hopefully do what you want:</p>\n\n<pre><code>Sub datascrub()\n\n    On Error Resume Next\n    Set SourceSheet = ActiveSheet\n    Set TargetSheet = ActiveWorkbook.Sheets(\"Results\")\n    If Err = 0 Then\n        Worksheets(\"Results\").Delete\n    End If\n\n    Worksheets.Add\n    ActiveSheet.Name = \"Results\"\n    Set TargetSheet = ActiveSheet\n    Cells(1, 1).Value = \"Found Codes\"\n    Cells(1, 1).Font.Bold = True\n    iTargetRow = 2\n\n    SourceSheet.Select\n    Selection.SpecialCells(xlCellTypeLastCell).Select\n    Range(Selection, Cells(1)).Select\n\n    For Each c In Selection.Cells\n        sRaw = c.Value\n        iPos = InStr(sRaw, \"?#+@\")\n        Do While iPos &gt; 0\n\n            'Use the following line if you want message?#+@date in column A\n            TargetSheet.Cells(iTargetRow, 1) = Left(sRaw, iPos + 27)\n\n            'Or use the following two lines if you want the message in column A and the date in column B\n            'TargetSheet.Cells(iTargetRow, 1) = Left(sRaw, iPos - 1)\n            'TargetSheet.Cells(iTargetRow, 2) = Mid(sRaw, iPos + 4, 24)\n\n\n            iTargetRow = iTargetRow + 1\n\n            sRaw = Mid(sRaw, iPos + 28)\n            iPos = InStr(sRaw, \"?#+@\")\n        Loop\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 0, "last_activity_date": 1469004429, "creation_date": 1469004429, "answer_id": 38476512, "question_id": 38475358, "link": "https://stackoverflow.com/questions/38475358/not-able-to-extract-a-pattern-using-vba/38476512#38476512", "title": "Not able to extract a pattern using VBA", "body": "<p>The problem is with <code>Like</code>: it will not match the literal \"?#+@\", because several of these characters have a special meaning for <code>Like</code>.</p>\n\n<p>I would suggest to:</p>\n\n<ul>\n<li>Declare your variables and put <code>Option Explicit</code> at the top to require variable declaration. This is a good habit and will help eliminate obvious errors;</li>\n<li>Not to suppress errors for longer than necessary. Put <code>On Error Goto 0</code> as soon as you don't need to suppress them any more. Again this will help you to troubleshoot code more easily;</li>\n<li>Use <code>Split</code> for grabbing parts of a string;</li>\n<li>Not to use <code>Like</code>: as mentioned in comments you would need to escape several characters, but more importantly, as you want to break up the string, you get faster results with <code>Split</code></li>\n<li>Convert the extracted timestamps to Excel date/time format.</li>\n</ul>\n\n<p>Here is the suggested code:</p>\n\n<pre><code>Option Explicit\n\nSub datascrub()\n    Dim SourceSheet As Worksheet\n    Dim TargetSheet As Worksheet\n    Dim iTargetRow As Long\n    Dim sDate As String\n    Dim c As Range\n    Dim line, pair\n\n    Set SourceSheet = ActiveSheet\n    On Error Resume Next\n        Worksheets(\"Results\").Delete\n    On Error GoTo 0\n    Worksheets.Add\n    ActiveSheet.Name = \"Results\"\n    Set TargetSheet = ActiveSheet\n    Cells(1, 1).Value = \"Found Codes\"\n    Cells(1, 1).Font.Bold = True\n    iTargetRow = 2\n\n    SourceSheet.Select\n    Selection.SpecialCells(xlCellTypeLastCell).Select\n    Range(Selection, Cells(1)).Select\n\n    For Each c In Selection.Cells\n        For Each line In Split(c.Value, \"+0000\")\n            If line = \"\" Then Exit For\n            pair = Split(line, \"?#+@\")\n            sDate = Replace(Replace(pair(1), \" \", \"-\"), \"T\", \" \")\n            TargetSheet.Cells(iTargetRow, 1) = pair(0)\n            TargetSheet.Cells(iTargetRow, 2) = CDate(sDate)\n            iTargetRow = iTargetRow + 1\n        Next line\n    Next c\nEnd Sub\n</code></pre>\n\n<p>For the sample data in the question, it would produce:</p>\n\n<pre><code>| Found Codes         |                  |\n| Hello               | 31/12/2013 06:27 |\n| Great post          | 31/12/2013 06:33 |\n| Awesome post Thanks | 31/12/2013 06:49 |\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470727035, "post_id": 38476837, "comment_id": 65053644, "body": "@vip_879: did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1469005406, "creation_date": 1469005406, "answer_id": 38476837, "question_id": 38475358, "link": "https://stackoverflow.com/questions/38475358/not-able-to-extract-a-pattern-using-vba/38476837#38476837", "title": "Not able to extract a pattern using VBA", "body": "<p>I believe that this is what you're after:</p>\n\n<pre><code>Option Explicit\n\nSub datascrub()\n    Dim SourceSheet As Worksheet, TargetSheet As Worksheet\n    Dim iArr As Long\n    Dim cell As Range\n    Dim tempArr As Variant\n\n    Set TargetSheet = GetWorkSheet(ThisWorkbook, \"Results\") '&lt;--| get/set \"results\" sheet\n    With TargetSheet\n        .Cells(1, 1).Value = \"Found Codes\"\n        .Cells(1, 1).Font.Bold = True\n    End With\n\n    With ThisWorkbook.Worksheets(\"Source\") '&lt;--| explicitly reference \"Source\" sheet (change \"Source\" as per your actuale source sheet name)\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(XlCellType.xlCellTypeConstants, xlTextValues) '&lt;--| consider only text values in column \"A\" (or change \"A\" as per your possible different needs)\n            .Replace What:=\"+0000\", Replacement:=\"+0000||\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True '&lt;--| \"mark\" the wanted records by inserting \"||\" after each date end (I assume it always ends with \"+0000\")\n            For Each cell In .Cells '&lt;--| loop through considered cells\n                tempArr = Split(cell.Value2, \"||\") '&lt;--| fill the temporary array with the current cell content records\n                For iArr = LBound(tempArr) To UBound(tempArr) - 1 '&lt;--| loop through the temporary array..\n                    TargetSheet.Cells(TargetSheet.Rows.Count, 1).End(xlUp).Offset(1) = Split(tempArr(iArr), \"?#+@\")(0) &amp; \" \" &amp; Split(tempArr(iArr), \"?#+@\")(1) '&lt;--| ... and write results\n                Next iArr\n            Next cell\n            .Replace What:=\"||\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True '&lt;--| remove the \"mark\" we inserted at the beginning\n        End With\n    End With\nEnd Sub\n\nFunction GetWorkSheet(wb As Workbook, shtName As String) As Worksheet\n    On Error Resume Next\n    Set GetWorkSheet = wb.Worksheets(shtName)\n    If GetWorkSheet Is Nothing Then\n        Set GetWorkSheet = wb.Worksheets.Add\n        ActiveSheet.Name = shtName\n    Else\n        GetWorkSheet.Cells.ClearContents\n    End If\nEnd Function\n</code></pre>\n\n<p>just change the references as per your needs (see comments)</p>\n\n<p>should you need to put some separator between each \"date &amp; content\" string or invert their sequence or put them in two different cells simply adjust:</p>\n\n<pre><code>TargetSheet.Cells(TargetSheet.Rows.Count, 1).End(xlUp).Offset(1) = Split(tempArr(iArr), \"?#+@\")(0) &amp; \" \" &amp; Split(tempArr(iArr), \"?#+@\")(1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6612357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ef589b54ee084206932a4fc0f20122?s=128&d=identicon&r=PG&f=1", "display_name": "vip_879", "link": "https://stackoverflow.com/users/6612357/vip-879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1469005406, "creation_date": 1469000909, "last_edit_date": 1469001892, "question_id": 38475358, "link": "https://stackoverflow.com/questions/38475358/not-able-to-extract-a-pattern-using-vba", "title": "Not able to extract a pattern using VBA", "body": "<p>I have numerous lines in a single cell, across a column. I want to extract the comment and date following that. Each date is preceded with <code>?#+@</code>. For eg.</p>\n\n<pre><code>Hello ?#+@2013 12 31T06:27:58+0000Great post ?#+@2013 12 31T06:33:23+0000Awesome post  Thanks?#+@2013 12 31T06:49:38+0000\n</code></pre>\n\n<p>So, I want to extract <code>hello</code> and <code>2013 12 31T06:27:58+0000</code> together in results sheet and so on..</p>\n\n<p>I came across a VBA code for the same. However, it is not giving any output. </p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub datascrub()\n\nOn Error Resume Next\n    Set SourceSheet = ActiveSheet\n    Set TargetSheet = ActiveWorkbook.Sheets(\"Results\")\n    If Err = 0 Then\n        Worksheets(\"Results\").Delete\n    End If\n\n    Worksheets.Add\n    ActiveSheet.Name = \"Results\"\n    Set TargetSheet = ActiveSheet\n    Cells(1, 1).Value = \"Found Codes\"\n    Cells(1, 1).Font.Bold = True\n    iTargetRow = 2\n\n    SourceSheet.Select\n    Selection.SpecialCells(xlCellTypeLastCell).Select\n    Range(Selection, Cells(1)).Select\n\n    For Each c In Selection.Cells\n        If c.Value Like \"?#+@\" Then\n            sRaw = c.Value\n            iPos = InStr(sRaw, \"?#+@\")\n            Do While iPos &gt; 0\n                If iPos &lt; 4 Then\n                    sRaw = \"  \" &amp; sRaw\n                    iPos = iPos + 4\n                End If\n                sTemp = Mid(sRaw, iPos, 4)\n                sRaw = Mid(sRaw, iPos + 4, 24)\n                If sTemp Like \"?#+@\" Then\n                    TargetSheet.Cells(iTargetRow, 1) = sTemp\n                    iTargetRow = iTargetRow + 1\n                Else\n                    sRaw = Mid(sTemp, 4, 5) &amp; sRaw\n                End If\n                iPos = InStr(sRaw, \"?#+@\")\n            Loop\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 6612231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b7eefb997e7710efcbebc21846aa5c3?s=128&d=identicon&r=PG&f=1", "display_name": "Echo_9er", "link": "https://stackoverflow.com/users/6612231/echo-9er"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 691, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469002937, "creation_date": 1468999680, "last_edit_date": 1469002937, "question_id": 38474915, "link": "https://stackoverflow.com/questions/38474915/how-to-copy-a-range-of-cells-and-paste-values-to-two-different-worksheets", "title": "How to copy a range of cells and paste values to two different worksheets?", "body": "<p>I have a range of data on Sheet2 that links it to Sheet1 (Sheet1 is formatted and linked by Sheet2 using <code>=if(Sheet2$x$x=\"\",\"\",Sheet2$x$x)</code>; this way any data put into the range C13:G62 of Sheet2 shows up in Sheet1 range C13:G62. The beginning portion on the code works to move JUST the data in the specified range to the BATCH file Sheet3 and finds the last row pasting the values from Sheet1 without copying the formulas. It was made this way so I can delete data on Sheet2 to wipe Sheet1 clean but still have all the backup data on one Sheet3.</p>\n\n<p>Anyway, the problem lies when I tried to manipulate the code to copy all contents on Sheet1 (to DUPLICATE SHEET1) to another sheet at the end of the workbook:</p>\n\n<pre><code> Sheets(Sheet1).Copy After:=Sheets(Sheets.Count)\n ActiveSheet.Name = _\n InputBox(\"Name of the New WorkSheet\")\n</code></pre>\n\n<p>This allowed me to name the sheet which was great. However by creating multiple variations of code it will not move the DATA in the RANGE to the newly created Sheet4 (there is no data). In one iteration of code I was able to get Sheet1 to copy and make Sheet4 at the end of the work book with no data in the range but have the cursor land in cell C13, the starting point for pasting just the values, and when I left click the mouse in that cell to \"paste values\" it would paste the values that I was trying to paste. However, either way I rearranged the code, the data would always be copied but would never paste to the Sheet4 range.</p>\n\n<p>Here I have posted one variation of the code IN WHICH IT STILL WILL NOT PASTE THE VALUES TO SHEET4 (THE NEWLY CREATED SHEET) but still copies to the BATCH FILE. What am I missing here? </p>\n\n<pre><code>Dim s1Sheet As Worksheet\nDim s2Sheet As Worksheet\nDim source As String\nDim target As String\nDim rngSource As Range\nDim rngTargetStart As Range\nsource = \"Invoice\"\ntarget = \"TOTAL_INVOICE\"\nApplication.EnableCancelKey = xlDisabled\nSet s1Sheet = Sheets(source)\nSet s2Sheet = Sheets(target)\nSet rngSource = s1Sheet.Range(\"C13:G62\")\nSet rngTargetStart = s2Sheet.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1)\n'Set rngTargetFinish = ws1.Range(\"C\"  &amp; Rows.Count).End(xlUp).Offset(1)\nrngTargetStart.Resize(rngSource.Rows.Count, rngSource.Columns.Count).Value = rngSource.Value\n'rngTargetFinish.Resize(rngSource.Rows.Count, rngSource.Columns.Count).Value = rngSource.Value\n'Set target = Sheets(\"Sheet4\").Range(\"B13:G63\")\ncopy_non_formulas source:=rngSource, target:=rngTargetStart\n ' copy_non_formulas source:=Range(\"B13:G63\"), target:=Range(\"B70:G109\")     Unhighlight\n ' copy_non_formulas source:=Range(\"B13:G63\"), target:=Range(\"B13:G63\")      Unhighlight\n\n\n\n'===Copies Sheet to End of WorkBook &amp; Pastes Values======\nSheets(source).Copy After:=Sheets(Sheets.Count)\nActiveSheet.Name = _\nInputBox(\"Name of the New WorkSheet\")\nRange(\"C13:G62\").ClearContents\nDim rng As Range\nSet rng = ActiveSheet.Range(\"C13:G62\")\nrng.ClearContents\nDim s3Sheet As Worksheet\nDim rngTargetStart2 As Range\nSet s3Sheet = Sheets(Sheets.Count)\nSet rngTargetStart2 = s3Sheet.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1)\nrngTargetStart2.Resize(rngSource.Rows.Count, rngSource.Columns.Count).Value = rngSource.Value\ncopy_non_formulas2 source:=rngSource, target2:=rngTargetStart2\ncopy_non_formulas2 source:=Range(\"C13:G62\"), target2:=Range(\"C13:G62\")\n</code></pre>\n\n<p>This is an Integrated Public Sub</p>\n\n<pre><code>copy_non_formulas(source As Range, target As Range)\nDim i As Long\nDim j As Long\nDim c As Range\n\nFor i = 1 To source.Rows.Count\n    For j = 1 To source.Columns.Count\n        Set c = source(RowIndex:=i, ColumnIndex:=j)\n        If Left(c.Formula, 1) &lt;&gt; \"=\" Then\n            target(RowIndex:=i, ColumnIndex:=j).Value = c.Value\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>And another Public Sub for the Second Move</p>\n\n<pre><code>copy_non_formulas2(source As Range, target2 As Range)\nDim x As Long\nDim y As Long\nDim d As Range\n\nFor x = 1 To source.Rows.Count\n    For y = 1 To source.Columns.Count\n        Set d = source(RowIndex:=x, ColumnIndex:=y)\n        If Left(d.Formula, 1) &lt;&gt; \"=\" Then\n            target2(RowIndex:=x, ColumnIndex:=y).Value = d.Value\n        End If\n    Next y\nNext x\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6612213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6888d9cf97a208874fbda188723b663?s=128&d=identicon&r=PG&f=1", "display_name": "shabin", "link": "https://stackoverflow.com/users/6612213/shabin"}, "edited": false, "score": 0, "creation_date": 1469029444, "post_id": 38475756, "comment_id": 64372104, "body": "when I used this code its working but another problem came. when I enter a number or word which is not in rows debug appear with yellow line on Set rFound = rSearch.FindNext(rFound)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 19, "user_id": 6612213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6888d9cf97a208874fbda188723b663?s=128&d=identicon&r=PG&f=1", "display_name": "shabin", "link": "https://stackoverflow.com/users/6612213/shabin"}, "edited": false, "score": 0, "creation_date": 1469030814, "post_id": 38475756, "comment_id": 64373097, "body": "I updated my answer.  The Find next should have been inside thel &quot;If not rFound is nothing&quot;  statement.  Thanks for the catch."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1469041235, "last_edit_date": 1469041235, "creation_date": 1469002083, "answer_id": 38475756, "question_id": 38474837, "link": "https://stackoverflow.com/questions/38474837/searching-for-diffrent-items-in-excel-using-vba/38475756#38475756", "title": "searching for diffrent items in excel using vba", "body": "<p>This can be accomplished using the <code>Range.Find</code> and <code>Range.FindNext</code> methods.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim rSearch As Range\n    Dim rFound As Range\n\n    With Sheets(\"SHEET1\")\n        Set rSearch = .Range(\"A1\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n\n        Set rFound = rSearch.Find(What:=TextBox1.Text, LookIn:=xlValues)\n\n        If rFound Is Nothing Then\n            TextBox2.Value = \"\"\n        Else\n            TextBox2.Value = rFound.Offset(0, 1).Value\n\n            Set rFound = rSearch.FindNext(rFound)\n\n            If rFound Is Nothing Then\n                TextBox3.Value = \"\"\n            Else\n                TextBox3.Value = rFound.Offset(0, 1).Value\n             End If\n\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Your code will also work with a little refactoring.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim row_number As Long\n    TextBox2.Value = \"\"\n    TextBox3.Value = \"\"\n\n    With Sheets(\"SHEET1\")\n        Do\n            row_number = row_number + 1\n            item_in_review = .Range(\"A\" &amp; row_number)\n\n            If item_in_review = TextBox1.Text Then\n                If TextBox2.Text = \"\" Then\n                    TextBox2.Text = .Range(\"B\" &amp; row_number)\n                Else\n                    TextBox3.Text = .Range(\"B\" &amp; row_number)\n                    Exit Do\n                End If\n\n            End If\n        Loop Until item_in_review = \"\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6612213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6888d9cf97a208874fbda188723b663?s=128&d=identicon&r=PG&f=1", "display_name": "shabin", "link": "https://stackoverflow.com/users/6612213/shabin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1469041235, "creation_date": 1468999427, "last_edit_date": 1531164843, "question_id": 38474837, "link": "https://stackoverflow.com/questions/38474837/searching-for-diffrent-items-in-excel-using-vba", "title": "searching for diffrent items in excel using vba", "body": "<p>I want to find when enter \"2\" in find what column and hit search my first item column need to show grapes and my second item column show banana.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RHs4B.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RHs4B.jpg\" alt=\"Userform\"></a>\n<a href=\"https://i.stack.imgur.com/loEhj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/loEhj.jpg\" alt=\"Worksheet data\"></a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\nrow_number = 0\nDo\nDoEvents\nrow_number = row_number + 1\nitem_in_review = Sheets(\"SHEET1\").Range(\"A\" &amp; row_number)\nIf item_in_review = TextBox1.Text Then\n   TextBox2.Text = Sheets(\"SHEET1\").Range(\"B\" &amp; row_number)\n   'want to know which code I want to use in textbox3.text to find next repetation\n    TextBox3.Text = Sheets(\"SHEET1\").Range(\"B\" &amp; row_number)\n\n   End If\nLoop Until item_in_review = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "ado"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6612272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hU2TZ.jpg?s=128&g=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/6612272/mohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1469002686, "last_edit_date": 1469002686, "creation_date": 1468998920, "answer_id": 38474676, "question_id": 38474559, "link": "https://stackoverflow.com/questions/38474559/how-to-combine-records-from-different-tables-and-run-the-query-using-sql/38474676#38474676", "title": "How to combine records from different tables and run the query using SQL?", "body": "<p>you can use temptable or CTE(common table expression) or using by JOINs</p>\n\n<p>Temptable:</p>\n\n<pre><code>create table #tablename(columname datatype)\n</code></pre>\n\n<p>CTE:</p>\n\n<pre><code>with ctename as (select columns from tablename)\n</code></pre>\n\n<p>JOINS:</p>\n\n<pre><code>select columnname \n       from table1 t1\n       left join table2 t2 on t1.commonecolumnname=t2.commoncolumnname\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 6547731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dgud8.jpg?s=128&g=1", "display_name": "Goutham", "link": "https://stackoverflow.com/users/6547731/goutham"}, "is_accepted": true, "score": 0, "last_activity_date": 1468999167, "creation_date": 1468999167, "answer_id": 38474764, "question_id": 38474559, "link": "https://stackoverflow.com/questions/38474559/how-to-combine-records-from-different-tables-and-run-the-query-using-sql/38474764#38474764", "title": "How to combine records from different tables and run the query using SQL?", "body": "<p>I think this may help you</p>\n\n<pre><code>SELECT Officer, name, sum(mkt) FROM (\nSELECT Officer,name,mkt FROM [$table1]\nUNION ALL\n SELECT  Officer,name,mkt \n    FROM [$table2]\n    ) as table3\nGROUP BY officer,name\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 6597894, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a44d8e0eda7534d6e86b6f035c0580ab?s=128&d=identicon&r=PG&f=1", "display_name": "Monchhichi", "link": "https://stackoverflow.com/users/6597894/monchhichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 38474764, "answer_count": 2, "score": 0, "last_activity_date": 1469002686, "creation_date": 1468998543, "last_edit_date": 1495542154, "question_id": 38474559, "link": "https://stackoverflow.com/questions/38474559/how-to-combine-records-from-different-tables-and-run-the-query-using-sql", "title": "How to combine records from different tables and run the query using SQL?", "body": "<p><em>The original question is unclear so I modify the question and ask again</em></p>\n\n<p>original question :<a href=\"https://stackoverflow.com/questions/38452390/how-to-combine-records-from-different-tables\">How to combine records from different tables?</a></p>\n\n<hr>\n\n<p>There are two worksheets in same workbook that have the same structure-same field names. </p>\n\n<p>for example : </p>\n\n<p>Table 1</p>\n\n<pre><code>- Officer  name   mkt \n - s15     peter  15\n - s17     mary   18\n - S32     tom    42\n - S32     tom    89\n</code></pre>\n\n<p>Table 2</p>\n\n<pre><code>- Officer  name   mkt \n - s56     jason  55\n - s31     alex   34\n - S54     gee    45\n</code></pre>\n\n<p>Now I'm using ADO to run the sql in excel-vba.There is no DBMS .I just run and paste on excel work-sheet.</p>\n\n<pre><code>select officer ,name ,sum(mkt) from [$table1]\n</code></pre>\n\n<p>Now I want to combine these 2 tables records and select later.</p>\n\n<p>That means:</p>\n\n<p>Table 3</p>\n\n<pre><code>- Officer  name   mkt \n - s15     peter  15\n - s17     mary   18\n - S32     tom    42\n - S32     tom    89\n - s56     jason  55\n - s31     alex   34\n - S54     gee    45\n</code></pre>\n\n<p>Then later make the selection(SQL) .</p>\n\n<pre><code>  select officer ,name ,sum(mkt) from [$table3] group by officer\n</code></pre>\n\n<p><strong>Is it able to perform it in SQL or VBA (i prefer to perform it in SQL Statement )?</strong></p>\n\n<p>*I prefer to use sth SQL technique to perform it . Something like join table ? But join table only join the columns in different tables.Now I want to join rows * </p>\n\n<h1>update</h1>\n\n<p>As people suggest to use <code>union all</code> \ni try </p>\n\n<pre><code>SELECT office, name, sum(mkt)\nFROM(\n    SELECT *\n    FROM [$table1]\n    UNION ALL\n    SELECT *\n    FROM [$table2]\n) as table3\nGROUP BY officer\n</code></pre>\n\n<p>it occurs <code>from-clause error</code> </p>\n"}, {"tags": ["vba", "excel", "replace"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468998071, "post_id": 38474343, "comment_id": 64351650, "body": "to replace only the value in D9 use <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;D9&quot;).Replace _ what:=val_Old, Replacement:=val_New, lookat:=xlWhole, _ SearchOrder:=xlByColumns, MatchCase:=False</code> . You want to loop entire Column D ?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1468998580, "post_id": 38474343, "comment_id": 64351973, "body": "Like this <code>Worksheets(&quot;Sheet1&quot;).Cells(9, 4).Replace &quot;hello&quot;, &quot;good&quot;</code> OR <code>Worksheets(&quot;Sheet1&quot;).Cells(9, 4).Replace &quot;old value&quot;, &quot;new value&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1468998150, "creation_date": 1468998150, "answer_id": 38474423, "question_id": 38474343, "link": "https://stackoverflow.com/questions/38474343/using-worksheets-replace-function-for-specific-cell-instead-of-entire-column-r/38474423#38474423", "title": "Using Worksheets. .Replace function for specific cell instead of entire column/row", "body": "<p>Replace value in one cell A2:</p>\n\n<pre><code>Range(\"A2\").Replace oldValue, newValue \n</code></pre>\n\n<p>Replace value in a range:</p>\n\n<pre><code>Range(\"A2:A10\").Replace oldValue, newValue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1468998847, "creation_date": 1468998847, "answer_id": 38474656, "question_id": 38474343, "link": "https://stackoverflow.com/questions/38474343/using-worksheets-replace-function-for-specific-cell-instead-of-entire-column-r/38474656#38474656", "title": "Using Worksheets. .Replace function for specific cell instead of entire column/row", "body": "<p>If you want to loop through the entire Column D (until last row):</p>\n\n<pre><code>Option Explicit\n\nSub Replace_ColumnD()\n\nDim sht1 As Excel.Worksheet\nDim LastRow As Long\nDim lrow As Long\nDim val_new As String\nDim val_old As String\n\n\nSet sht1 = ActiveWorkbook.Worksheets(\"Sheet1\")\nLastRow = sht1.Cells(sht1.Rows.Count, \"D\").End(xlUp).Row\n\nFor lrow = 1 To LastRow\n     sht1.Cells(lrow, 4).Replace val_old, val_new\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 6582911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce156dd1c3ba6868968a5c2e50acdf48?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib", "link": "https://stackoverflow.com/users/6582911/sohaib"}, "is_accepted": false, "score": 0, "last_activity_date": 1469095337, "creation_date": 1469095337, "answer_id": 38501096, "question_id": 38474343, "link": "https://stackoverflow.com/questions/38474343/using-worksheets-replace-function-for-specific-cell-instead-of-entire-column-r/38501096#38501096", "title": "Using Worksheets. .Replace function for specific cell instead of entire column/row", "body": "<p>Thanks guys. It was very helpful indeed.\nFinally the code looks like this:</p>\n\n<pre><code>For i = 2 To LastRow\n\nMyRange = MyColumnLetter &amp; i\n\nIf....condition met:\n   Worksheets(\"Sheet1\").Range(MyRange).Replace val_Old, val_New\nEnd If\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6582911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce156dd1c3ba6868968a5c2e50acdf48?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib", "link": "https://stackoverflow.com/users/6582911/sohaib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 38474656, "answer_count": 3, "score": 0, "last_activity_date": 1469095337, "creation_date": 1468997896, "question_id": 38474343, "link": "https://stackoverflow.com/questions/38474343/using-worksheets-replace-function-for-specific-cell-instead-of-entire-column-r", "title": "Using Worksheets. .Replace function for specific cell instead of entire column/row", "body": "<p>The following code works well for replacing a specific value in an entire column:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Columns(MyColumnLetter).Replace _\nwhat:=val_Old, Replacement:=val_New, lookat:=xlWhole, _\nSearchOrder:=xlByColumns, MatchCase:=False\n</code></pre>\n\n<p>However I only need to replace value in a specific cell (for example in cell \"D9\" as part of a vba loop) instead of the entire column or cell range.</p>\n\n<p>Can anyone please suggest the required modification to the code above?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468995818, "post_id": 38473486, "comment_id": 64350333, "body": "question: if you added a button, once the user clicks on it, it updates the values to all lables acoording to the <code>TextBoxes</code> related to them, is it OK? it will simplify your code a lot ? Unless you must have it every time one of the <code>TextBoxes</code> change"}, {"owner": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1468996539, "post_id": 38473486, "comment_id": 64350730, "body": "Answer: my boss doesn&#39;t like button T^T."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "edited": false, "score": 0, "creation_date": 1469000119, "post_id": 38474843, "comment_id": 64352940, "body": "Thomas, thank for you answer, but your answer look like wiki to me. I need some time to disguise. ^^Cheer"}, {"owner": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "edited": false, "score": 0, "creation_date": 1469000812, "post_id": 38474843, "comment_id": 64353396, "body": "In my case, i need to keep track more then 2 textbox change_event (all the textbox i write inside the class, that around 16), which currently i failed to write class to make it work. So i take the 1st method you mention(create sub) where i had to add to 16 textbox change_event. I do tried to name my controls to meaningful name, but i find out i might the name as it is for looping. Can i still able to loop those control after i rename them to unique name?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "edited": false, "score": 0, "creation_date": 1469000887, "post_id": 38474843, "comment_id": 64353441, "body": "It turned into more of a code review.  I had an error in <code>QuoTxtBoxEvt </code> class.  When working with events be careful not to re-trigger the event."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "edited": false, "score": 0, "creation_date": 1469001035, "post_id": 38474843, "comment_id": 64353525, "body": "If you can provide a download like, I will refactor it for you."}, {"owner": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "edited": false, "score": 0, "creation_date": 1469001585, "post_id": 38474843, "comment_id": 64353861, "body": "Hi Thomas, i edited my class code in main post. that my typo error in class calculate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "edited": false, "score": 0, "creation_date": 1469002564, "post_id": 38474843, "comment_id": 64354467, "body": "I updated my answer.  You really should give those textboxes meaningful names (e.g. txtCost , txtQuantity)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1469002255, "last_edit_date": 1469002255, "creation_date": 1468999448, "answer_id": 38474843, "question_id": 38473486, "link": "https://stackoverflow.com/questions/38473486/userform-event-change-for-multiple-textbox/38474843#38474843", "title": "Userform - event change for multiple textbox", "body": "<p>When grouping events we use a class to hold a reference to a control. Next we create a new instance of the class for each control and add it to a collection or array variable.  The collection or array variable needs to be declared at the module level.  In this way the references to the controls are keep alive in code after the initializing sub routine has finished executing.<br></p>\n\n<p>It looks like you are only going to need the event to fire when the value of <code>.TextBox8.value</code> or <code>.TextBox9.value</code> is changed.  For this reason, I wouldn't have went through the extra setup.</p>\n\n<pre><code>Private Sub TextBox8_Change()\n    RecalcTextBoxes\nEnd Sub\n\nPrivate Sub TextBox9_Change()\n    RecalcTextBoxes\nEnd Sub\n\nSub RecalcTextBoxes()\n    With frmQuo\n        TextBox28.Value = Val(TextBox8.Value) * Val(TextBox9.Value)\n        TextBox28.Value = Val(TextBox28.Value) + (Val(TextBox11.Value) * Val(TextBox12.Value))\n        TextBox28.Value = Val(TextBox28.Value) + (Val(TextBox14.Value) * Val(TextBox15.Value))\n        TextBox28.Value = Val(TextBox28.Value) + (Val(TextBox17.Value) * Val(TextBox18.Value))\n        TextBox28.Value = Val(TextBox28.Value) + (Val(TextBox20.Value) * Val(TextBox21.Value))\n        TextBox28.Value = Val(TextBox28.Value) + (Val(TextBox23.Value) * Val(TextBox23.Value))\n        If CheckBox1 = True Then TextBox28.Value = Val(TextBox28.Value) * (100 - Val(TextBox26.Value)) / 100\n        If CheckBox2 = True Then TextBox28.Value = Val(TextBox28.Value) + (Val(TextBox28.Value) * Val(TextBox27.Value) / 100)\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You should add a flag to your <code>QuoTxtBoxEvt</code> class that will prevent the <code>TxtBoxGroup_Change</code> event from retriggering itself.  The way it stands right now, you are changing the value of <code>TextBox28</code> 8 times.  That means you are calling the <code>TxtBoxGroup_Change</code> event 8 times, which triggers 8 * 8 more calls and so on and so on.</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents TxtBoxGroup As MSForms.TextBox\nPrivate EditMode As Boolean\n\nPublic Sub TxtBoxGroup_Change()\n\n    If EditMode Then \n       Exit Sub\n    Else\n       EditMode = True\n    End If\n\n    With frmQuo\n        .TextBox28.value = Val(.TextBox8.value) * Val(.TextBox9.value)\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox11.value) * Val(.TextBox12.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox14.value) * Val(.TextBox15.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox17.value) * Val(.TextBox18.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox20.value) * Val(.TextBox21.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox23.value) * Val(.TextBox23.value))\n        If .CheckBox1 = True Then .TextBox28.value = Val(.TextBox28.value) * (100 - Val(.TextBox26.value)) / 100\n        If .CheckBox2 = True Then .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox28.value) * Val(.TextBox27.value) / 100)\n    End With\n\n    EditMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6606396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-STyshrnsQYU/AAAAAAAAAAI/AAAAAAAADdE/OFlp3ZuVTxU/photo.jpg?sz=128", "display_name": "KokJoo89", "link": "https://stackoverflow.com/users/6606396/kokjoo89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4034, "favorite_count": 0, "accepted_answer_id": 38474843, "answer_count": 1, "score": 0, "last_activity_date": 1469002255, "creation_date": 1468994892, "last_edit_date": 1531164843, "question_id": 38473486, "link": "https://stackoverflow.com/questions/38473486/userform-event-change-for-multiple-textbox", "title": "Userform - event change for multiple textbox", "body": "<p>I try to update some lable value for each textbox change.\ni searched and found <a href=\"https://stackoverflow.com/questions/1083603/vba-using-withevents-on-userforms/1923457#1923457\">this link</a> and <a href=\"http://www.mrexcel.com/forum/excel-questions/431101-userform-global-textbox-change-event.html\" rel=\"nofollow noreferrer\">this link</a> in website, but i still having trouble adopt it in my code. Because i have no idea how \"class\" work.</p>\n\n<p>Code in Class named \"QuoTxtBoxEvt\":</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents TxtBoxGroup As MSForms.textbox\n\nPublic Sub TxtBoxGroup_Change()\n    With frmQuo\n        .TextBox28.value = Val(.TextBox8.value) * Val(.TextBox9.value)\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox11.value) * Val(.TextBox12.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox14.value) * Val(.TextBox15.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox17.value) * Val(.TextBox18.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox20.value) * Val(.TextBox21.value))\n        .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox23.value) * Val(.TextBox23.value))\n        If .CheckBox1 = True Then .TextBox28.value = Val(.TextBox28.value) * (100 - Val(.TextBox26.value)) / 100\n        If .CheckBox2 = True Then .TextBox28.value = Val(.TextBox28.value) + (Val(.TextBox28.value) * Val(.TextBox27.value) / 100)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Code in userform:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n'Variables for textbox change event handler\nDim TxtBoxGroupEventHandler() As New QuoTxtBoxEvt\nDim vfrmControl As Control\nDim i As Integer\n\n'Event handler for textbox change to update total cost\ni = 1\nFor Each vfrmControl In Me.Controls\n    If TypeName(vfrmControl) = \"TextBox\" Then\n        ReDim Preserve TxtBoxGroupEventHandler(1 To i)\n        Set TxtBoxGroupEventHandler(i).TxtBoxGroup = vfrmControl\n        i = 1 + i\n    End If\nNext vfrmControl\nEnd Sub\n</code></pre>\n\n<p>These my code so far, and it return an error. What i miss in my code? Can someone briefly teach me how to code \"class\"?</p>\n\n<p>Many thank Orz</p>\n\n<p>Edit:\nI got another method to achieve this by create a sub that update my value and call that sub in each textbox change event. But is this best way(correct way?) to do it? or using the class method is better?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 1, "creation_date": 1468994825, "post_id": 38473353, "comment_id": 64349828, "body": "Use a slicer for the company code!!! Or failing that at least Use foreach loop to loop through all pivot tables in the workbook setting the value to cell p6"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6559228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8511fd38a948d29b4ac20669a3db9997?s=128&d=identicon&r=PG&f=1", "display_name": "Lazarius", "link": "https://stackoverflow.com/users/6559228/lazarius"}, "edited": false, "score": 0, "creation_date": 1468996525, "post_id": 38473634, "comment_id": 64350714, "body": "How do I loop this to add another 2 Sheets? (&quot;Pivot Transaction&quot; and &quot;Pivot Level Segment&quot;)?  So far I tried looping the sub by repeating the whole code and It didn&#39;t work. Also tried creating subroutines but that also didn&#39;t work.   Apologies - my VBA-fu is definitely not up to scratch."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469001178, "post_id": 38473634, "comment_id": 64353606, "body": "shouldn&#39;t it be safer to add <code>Application.EnableEvents=False</code> at the beginning and turn it back to <code>True</code> by the end of it? Or <code>ClearAllFilters</code> method and <code>CurrentPage </code>property setting don&#39;t trigger <code>Worksheet_Change</code> event when acting on any pivot table on that same worksheet ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1469029321, "post_id": 38473634, "comment_id": 64372016, "body": "@user3598756 - yes, it would make sense to do that"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1468996930, "last_edit_date": 1468996930, "creation_date": 1468995461, "answer_id": 38473634, "question_id": 38473353, "link": "https://stackoverflow.com/questions/38473353/cutting-down-repetitive-code-to-avoid-procedure-too-large-error/38473634#38473634", "title": "Cutting Down Repetitive code to Avoid &quot;Procedure Too Large&quot; error", "body": "<p>If you want to change all the pivot tables on that sheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n        If Intersect(Target, Range(\"P6:P7\")) Is Nothing Then Exit Sub\n\n        Dim pt As PivotTable, NewCat As String, s\n\n        NewCat = Worksheets(\"Trending&amp;Benchmarking\").Range(\"P6\").Value\n\n        For Each s In Array(\"Pivot Booking\", \"Pivot Transaction\", _\n                                             \"Pivot Level Segment\")\n\n            For Each pt In Worksheets(s).PivotTables\n                With pt.PivotFields(\"Company Code\")\n                    .ClearAllFilters\n                    .CurrentPage = NewCat\n                End With\n            Next pt\n\n        Next s\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 6559228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8511fd38a948d29b4ac20669a3db9997?s=128&d=identicon&r=PG&f=1", "display_name": "Lazarius", "link": "https://stackoverflow.com/users/6559228/lazarius"}, "is_accepted": false, "score": 0, "last_activity_date": 1469062496, "creation_date": 1469062496, "answer_id": 38493160, "question_id": 38473353, "link": "https://stackoverflow.com/questions/38473353/cutting-down-repetitive-code-to-avoid-procedure-too-large-error/38493160#38493160", "title": "Cutting Down Repetitive code to Avoid &quot;Procedure Too Large&quot; error", "body": "<p>Thank you all - the complete code that has worked is as per below: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Intersect(Target, Range(\"P6:P7\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False\n\n    On Error GoTo ErrorHandler\n\n    Dim pt As PivotTable, NewCat As String, s\n\n    NewCat = Worksheets(\"Trending&amp;Benchmarking\").Range(\"P6\").Value\n\n    For Each s In Array(\"Pivot Booking\", \"Pivot Transaction\", \"Pivot Level Segment\", \"Pivot YoY TransactionGraph\")\n\n        For Each pt In Worksheets(s).PivotTables\n            With pt.PivotFields(\"Company Code\")\n                .ClearAllFilters\n                .CurrentPage = NewCat\n            End With\n        Next pt\n\n    Next s\n\nErrorHandler:\n\n  Debug.Print Err.Number &amp; vbNewLine &amp; Err.Description\n  Resume ErrorExit\n\nErrorExit:\n\n  Application.EnableEvents = True\n\n   Exit Sub\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6559228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8511fd38a948d29b4ac20669a3db9997?s=128&d=identicon&r=PG&f=1", "display_name": "Lazarius", "link": "https://stackoverflow.com/users/6559228/lazarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 38473634, "answer_count": 2, "score": 2, "last_activity_date": 1469062496, "creation_date": 1468994329, "question_id": 38473353, "link": "https://stackoverflow.com/questions/38473353/cutting-down-repetitive-code-to-avoid-procedure-too-large-error", "title": "Cutting Down Repetitive code to Avoid &quot;Procedure Too Large&quot; error", "body": "<p>I currently have some VBA code that essentially replaces a Filter Field in a PivotTable, but because the current excel spreadsheet has hundreds of PivotTables, I'm reaching to a point where the VBA doesn't work with Procedure too large. </p>\n\n<p>Problem is I don't know how to decrease the repetition - any assistance would be certainly appreciated. </p>\n\n<p>Code below: </p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n        If Intersect(Target, Range(\"P6:P7\")) Is Nothing Then Exit Sub\n\n        Dim pt As PivotTable\n        Dim Field As PivotField\n        Dim NewCat As String\n\n        Set pt = Worksheets(\"Pivot Booking\").PivotTables(\"PivotTable8\")\n        Set Field = pt.PivotFields(\"Company Code\")\n        NewCat = Worksheets(\"Trending&amp;Benchmarking\").Range(\"P6\").Value\n\n        With pt\n             Field.ClearAllFilters\n             Field.CurrentPage = NewCat\n\n\n        End With\n\n        Set pt = Worksheets(\"Pivot Booking\").PivotTables(\"PivotTable6\")\n        Set Field = pt.PivotFields(\"Company Code\")\n        NewCat = Worksheets(\"Trending&amp;Benchmarking\").Range(\"P6\").Value\n\n        With pt\n             Field.ClearAllFilters\n             Field.CurrentPage = NewCat\n\n\n        End With\n\n        Set pt = Worksheets(\"Pivot Booking\").PivotTables(\"PivotTable20\")\n        Set Field = pt.PivotFields(\"Company Code\")\n        NewCat = Worksheets(\"Trending&amp;Benchmarking\").Range(\"P6\").Value\n\n        With pt\n             Field.ClearAllFilters\n             Field.CurrentPage = NewCat\n\n\n        End With\n\n        Set pt = Worksheets(\"Pivot Booking\").PivotTables(\"PivotTable7\")\n        Set Field = pt.PivotFields(\"Company Code\")\n        NewCat = Worksheets(\"Trending&amp;Benchmarking\").Range(\"P6\").Value\n\n        With pt\n             Field.ClearAllFilters\n             Field.CurrentPage = NewCat\n\n\n     'Keeps on repeating for about 200 more PivotTables in Various Sheets\n\n End With\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1468988630, "creation_date": 1468988630, "answer_id": 38472282, "question_id": 38472208, "link": "https://stackoverflow.com/questions/38472208/how-to-automatically-cancel-file-open-prompts-using-vba/38472282#38472282", "title": "How to automatically cancel file open prompts using vba", "body": "<p>Try with this updated code</p>\n\n<pre><code>Sub GetData()\n    Dim path As String, r As Single, c As Single\n    Set fso = CreateObject(\"scripting.filesystemobject\")\n    Application.Calculation = xlCalculationManual\n    For c = 0 To 29\n        For r = 0 To 1000\n            path = Worksheets(\"String formulas\").Range(\"a3\").Offset(r, c)\n            If fso.FileExists(path) = True Then\n                Worksheets(\"Transformed data\").Range(\"bl3\").Offset(r, c).Formula = \"=\" &amp; path\n            End If\n        Next r\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1468994322, "creation_date": 1468994322, "answer_id": 38473351, "question_id": 38472208, "link": "https://stackoverflow.com/questions/38472208/how-to-automatically-cancel-file-open-prompts-using-vba/38473351#38473351", "title": "How to automatically cancel file open prompts using vba", "body": "<p>You can get around this by toggling <code>Application.DisplayAlerts</code>.</p>\n\n<pre><code>Sub GetData()\n    Dim path As String, r As Single, c As Single\n    Application.Calculation = xlCalculationManual\n    Application.DisplayAlerts = False\n\n    For c = 0 To 29\n        For r = 0 To 1000\n            path = Worksheets(\"String formulas\").Range(\"a3\").Offset(r, c)\n            Worksheets(\"Transformed data\").Range(\"bl3\").Offset(r, c).Formula = \"=\" &amp; path\n        Next r\n    Next c\n\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6611632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/486857aa466e59cd93d02bd270c5c37e?s=128&d=identicon&r=PG&f=1", "display_name": "Elvis", "link": "https://stackoverflow.com/users/6611632/elvis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468994322, "creation_date": 1468988112, "last_edit_date": 1468994014, "question_id": 38472208, "link": "https://stackoverflow.com/questions/38472208/how-to-automatically-cancel-file-open-prompts-using-vba", "title": "How to automatically cancel file open prompts using vba", "body": "<p>I have dynamic text strings created for external links to closed workbooks in excel that need to be converted to formulas. Some of the files do not yet exist, but I need the links created as formulas. When I execute the following code, I get prompted to open the non-existent file. Is there a way to automatically cancel the prompts so that the formula is entered regardless? It's annoying cancelling a gazillion prompts manually!</p>\n\n<pre><code>Sub GetData()\n    Dim path As String, r As Single, c As Single\n    Application.Calculation = xlCalculationManual\n    For c = 0 To 29\n        For r = 0 To 1000\n            path = Worksheets(\"String formulas\").Range(\"a3\").Offset(r, c)\n            Worksheets(\"Transformed data\").Range(\"bl3\").Offset(r, c).Formula = \"=\" &amp; path\n        Next r\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1468988836, "creation_date": 1468988836, "answer_id": 38472318, "question_id": 38472118, "link": "https://stackoverflow.com/questions/38472118/clear-content-of-cell-a2-if-a2-value-same-with-a1/38472318#38472318", "title": "Clear content of cell A2 if A2 value same with A1", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nSub clear()\nDim cRow As Long\nDim CellValue As String\n\ncRow = 2 ' start the loop in row 2\nCellValue = Range(\"a1\").Value\n\nDo Until Cells(cRow, 1) = \"\"\n    If Cells(cRow, 1) = CellValue Then\n        Cells(cRow, 1).ClearContents\n        Cells(cRow, 2).ClearContents ' clear column B cell\n    Else\n        CellValue = Cells(cRow, 1) ' when the cell value changes,\n    End If\n    cRow = cRow + 1 ' increment the row number so the next loop goes to the next row\nLoop\nEnd Sub\n</code></pre>\n\n<p>I prefer variables with descriptive names over <code>x</code> and <code>c</code>.</p>\n\n<p>Some issues with your code were:</p>\n\n<ul>\n<li>Range must have a parameter, but you don't need Range when you already have the cell object with Cells()</li>\n<li>you did not increment the variable that sets the row</li>\n<li>the cleared cell became the new current cell and since it had just been cleared, the loop would end</li>\n<li>you never used the <code>c</code> variable, but it is useful to keep a record of the comparison string. </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1469000216, "creation_date": 1469000216, "answer_id": 38475123, "question_id": 38472118, "link": "https://stackoverflow.com/questions/38472118/clear-content-of-cell-a2-if-a2-value-same-with-a1/38475123#38475123", "title": "Clear content of cell A2 if A2 value same with A1", "body": "<p>you may want to consider the following \"array\" approach should speed be an issue:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim i As Long, j As Long\n    Dim myArr As Variant, refVal As Variant\n\n    With Worksheets(\"MySheet\") '&lt;--| change \"MySheet\" with your actual sheet name\n        With Intersect(.UsedRange, .Columns(\"A:B\")) '&lt;--| consider only columns A and B rows down to the worksheet used range last one\n            myArr = .Value ''&lt;--|  store values in array\n            For j = LBound(myArr, 2) To UBound(myArr, 2) '&lt;--| loop through array columns\n                refVal = myArr(1, j) '&lt;--| get column fiurst reference value\n                For i = LBound(myArr, 1) + 1 To UBound(myArr, 1) '&lt;--| loop through form current column 2nd row downwards\n                    If myArr(i, j) = refVal Then '&lt;--| if there's a duplicate...\n                        myArr(i, j) = \"\" '&lt;--| ...erase it\n                    Else '&lt;--| otherwise...\n                        refVal = myArr(i, j) '&lt;--| ... get the new non duplicate value as the reference one\n                    End If\n                Next i\n            Next j\n            .Value = myArr '&lt;--| write back array to worksheet\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>using <code>Option Explicit</code> statement is a safe habit that at the cost of some little extra work to declare all variables pays you back with much more control over your code and much less issues in debugging and maintaining it</p>\n\n<p>using full range reference (like <code>Worksheets(\"MySheet\").Range(...)</code>) is a good habit to avoid issues due to user sheet jumping selections</p>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1469002023, "creation_date": 1469002023, "answer_id": 38475738, "question_id": 38472118, "link": "https://stackoverflow.com/questions/38472118/clear-content-of-cell-a2-if-a2-value-same-with-a1/38475738#38475738", "title": "Clear content of cell A2 if A2 value same with A1", "body": "<p>To complement the answers from teylyn and user3598756, you could work from bottom to top to check the values:</p>\n\n<pre><code>Public Sub myClear(Optional ByRef wks As Worksheet = Nothing)\n    Dim c As Range\n    Dim col As Long\n    If wks Is Nothing Then Set wks = ActiveSheet\n    For col = 1 To 2   'Columns A and B\n        Set c = wks.Cells(wks.Rows.Count, col).Rows.End(xlUp)\n        Do While c.Row &gt; 1\n            If c.Value = c.Offset(-1, 0).Value Then c.ClearContents\n            Set c = c.Offset(-1, 0)\n        Loop\n    Next col\nEnd Sub\n</code></pre>\n\n<p>The sub will work by default on the <code>ActiveSheet</code>, but you can give in parameter the actual sheet you want to work on.</p>\n"}], "owner": {"reputation": 39, "user_id": 5554211, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10208139662268683/picture?type=large", "display_name": "Adam Law", "link": "https://stackoverflow.com/users/5554211/adam-law"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 38472318, "answer_count": 3, "score": 0, "last_activity_date": 1469002023, "creation_date": 1468987362, "last_edit_date": 1531164843, "question_id": 38472118, "link": "https://stackoverflow.com/questions/38472118/clear-content-of-cell-a2-if-a2-value-same-with-a1", "title": "Clear content of cell A2 if A2 value same with A1", "body": "<p>I have lists of different value in column A and B which contents same value for several rows respectively. like the following:</p>\n\n<pre><code>        BEFORE\n  column A |   column B\n1.   a             b\n2.   a             b \n3.   a             b \n4.   a             b  \n5.   z             z\n6.   z             z\n7.   z             z\n8.   z             z\n\n         AFTER\n  column A |   column B\n1.   a             b\n2.                 \n3.                 \n4.                  \n5.   z             z\n6.                \n7.                \n8.             \n</code></pre>\n\n<p>How do I delete the duplicate cell with former rows cell in same column? Like the After.</p>\n\n<p>I have done the following so far:</p>\n\n<pre><code>Sub clear()\nDim x\nDim c\n\nx = 1\nc = Range(\"a1\").Value\n\nDo Until Cells(x, 1) = \"\"\n    If Cells(x, 1) = Cells(x + 1, 1) Then\n        Cells(x + 1, 1) = Range().ClearContents  \n    End If\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 1, "creation_date": 1468992298, "post_id": 38471830, "comment_id": 64348848, "body": "Take a look at <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using Select</a>"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1468995078, "post_id": 38471830, "comment_id": 64349944, "body": "Also in a line of code u are missing the . for autofiltermode"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6611507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870e9e3905cefe7f912e6f5bdeef2f58?s=128&d=identicon&r=PG&f=1", "display_name": "Danette", "link": "https://stackoverflow.com/users/6611507/danette"}, "edited": false, "score": 0, "creation_date": 1468996553, "post_id": 38473712, "comment_id": 64350737, "body": "Hi Thomas, I tried out your code but it no longer brings up the error message."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1468995794, "creation_date": 1468995794, "answer_id": 38473712, "question_id": 38471830, "link": "https://stackoverflow.com/questions/38471830/need-vba-code-to-run-faster/38473712#38473712", "title": "Need VBA code to run faster", "body": "<p>I refactored your code and removed any unnecessary operations.  </p>\n\n<pre><code>Sub DataSearch()\n    Dim rFilteredData As Range\n    Dim strKeyword As String\n\n    strKeyword = \"*\" &amp; Range(\"B4\").Value &amp; \"*\"\n\n    Application.ScreenUpdating = False\n\n    With Worksheets(\"List_of_Incidents\")\n        .AutoFilterMode = False\n\n        .Range(\"B1\", .Range(\"B\" &amp; Rows.Count).End(xlUp)).AutoFilter 1, strKeyword, xlAnd\n\n        Set rFilteredData = Intersect(.Range(\"B:D\"), .UsedRange)\n\n        rFilteredData.Copy\n\n        Sheets(\"Search\").Range(\"A9\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n                                                                                                , SkipBlanks:=False, Transpose:=False\n        AutoFilterMode = False\n\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6611507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870e9e3905cefe7f912e6f5bdeef2f58?s=128&d=identicon&r=PG&f=1", "display_name": "Danette", "link": "https://stackoverflow.com/users/6611507/danette"}, "edited": false, "score": 0, "creation_date": 1469056488, "post_id": 38474790, "comment_id": 64385980, "body": "Hi, this does not work. And completely freezes Excel."}], "tags": [], "owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1468999279, "creation_date": 1468999279, "answer_id": 38474790, "question_id": 38471830, "link": "https://stackoverflow.com/questions/38471830/need-vba-code-to-run-faster/38474790#38474790", "title": "Need VBA code to run faster", "body": "<blockquote>\n  <p>it crashes Excel (not responding) is anyone able to help me fix this.</p>\n</blockquote>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>Yes, you have to turn ScreenUpdating back on again.</p>\n"}], "owner": {"reputation": 1, "user_id": 6611507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870e9e3905cefe7f912e6f5bdeef2f58?s=128&d=identicon&r=PG&f=1", "display_name": "Danette", "link": "https://stackoverflow.com/users/6611507/danette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468999604, "creation_date": 1468985352, "last_edit_date": 1468999604, "question_id": 38471830, "link": "https://stackoverflow.com/questions/38471830/need-vba-code-to-run-faster", "title": "Need VBA code to run faster", "body": "<p>I've just started doing coding in Excel and this is what I have:</p>\n\n<pre><code>Public strKeyword\n\nSub DataSearch()\n    Dim strKeyword As String\n\n    strKeyword = ActiveSheet.Range(\"B4\").Value\n\n    strKeyword = \"*\" &amp; strKeyword &amp; \"*\"\n\n    Application.ScreenUpdating = False\n\n    Worksheets(\"List_of_Incidents\").Visible = True\n    Worksheets(\"List_of_Incidents\").Select\n\n    ActiveSheet.Range(\"$B$1:$B$500\").AutoFilter Field:=1\n    Range(\"B1\").Select\n\n    With ActiveSheet\n        .AutoFilterMode = False\n        With Range(\"B1\", Range(\"B\" &amp; Rows.Count).End(xlUp))\n            .AutoFilter 1, strKeyword, xlAnd\n\n        End With\n\n        AutoFilterMode = False\n\n    End With\n\n    CopyVisibleCells\n\nEnd Sub\n\nSub CopyVisibleCells()\n\n    Range(\"B1:D1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.SpecialCells(xlCellTypeVisible).Select\n    Selection.Copy\n\n    Sheets(\"Search\").Select\n\n    Range(\"A9:C9\").Select\n    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n                                                                         , SkipBlanks:=False, Transpose:=False\n\n    Columns(\"A:A\").EntireColumn.AutoFit\n    Rows(\"8:8\").EntireRow.AutoFit\n\n    Range(\"A8\").Select\n    Application.CutCopyMode = False\n\n    If Range(\"A10\") = \"\" Then ErrCapture\n\n    Range(\"B4:B5\").Select\n\n    Worksheets(\"List_of_Incidents\").Visible = False\n\nEnd Sub\n\nSub ErrCapture()\n\n    MsgBox (\"Invalid Search! Please click New Search and Try Again\")\n\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>The problem is: When I get an error, it takes forever for the error message to pop up then it crashes Excel (not responding) is anyone able to help me fix this.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1468995340, "post_id": 38471779, "comment_id": 64350079, "body": "Syntax is correct if Crafter Default is the name of the subform control."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1468996265, "post_id": 38471779, "comment_id": 64350575, "body": "Yes. Check and re-check for typos. Reference: <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a> -- <code>Forms!Mainform!Subform1.Form!Subform2.Form!ControlName</code>"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1469024096, "post_id": 38471779, "comment_id": 64369653, "body": "Alternatively you can pass the variable to a hidden control on the main form from your modal, and have your sub-subform pick up that value from the main form."}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "edited": false, "score": 0, "creation_date": 1469025554, "post_id": 38471779, "comment_id": 64370811, "body": "I failed to mention that these subforms are in a navigation subform.  Does that change the syntax?"}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1469030200, "post_id": 38471779, "comment_id": 64372626, "body": "@Gustav  my code works when it&#39;s not in a navigation subform.  As soon as I put the subforms into navigationSubforms it gives me  an error.  I think the problem is within the syntax on how to call the value within the navigationSubform that is within the navigationSubform that is within the MainForm."}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1469032087, "post_id": 38471779, "comment_id": 64373860, "body": "@Andre I am trying to pass a variable from a Modal Form (sfrChangeProfilePics), to a subform in a NavigationSubform (sfrProfiling), to a subform in a NavigationSubform (Crafter Default) which is in the main form (Main Form) and unable to create the proper syntax. My code works when they are simply a subform within a subform within the main form. As soon as I insert them into navigation control it doesn&#39;t work. My navigationSubform name is &quot;NavigationSubform&quot;."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1469033295, "post_id": 38471779, "comment_id": 64374529, "body": "Sorry, I have never used one of those. I suggest editing your question title to reflect that."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1469049716, "post_id": 38471779, "comment_id": 64383692, "body": "Ouch. The navigation form adds a lot of trouble - but I&#39;m not familiar with those. Sorry."}, {"owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1469656354, "post_id": 38471779, "comment_id": 64633260, "body": "@gustav The following code works:  Forms![Main Form].MainNavsfr.Form!CrafterDefaultNavsfr.Form!pic.value = varChangePicture"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "is_accepted": true, "score": 3, "last_activity_date": 1469656386, "creation_date": 1469656386, "answer_id": 38623808, "question_id": 38471779, "link": "https://stackoverflow.com/questions/38471779/syntax-passing-variable-from-form-to-subform-inside-subform/38623808#38623808", "title": "Syntax Passing Variable from Form to subform inside subform", "body": "<p>This works:</p>\n\n<pre><code>Forms![Main Form].MainNavsfr.Form!CrafterDefaultNavsfr.Form!pic.value = varChangePicture\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 6519837, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10209398473895833/picture?type=large", "display_name": "John Wolfenstein", "link": "https://stackoverflow.com/users/6519837/john-wolfenstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1416, "favorite_count": 0, "accepted_answer_id": 38623808, "answer_count": 1, "score": 1, "last_activity_date": 1469656386, "creation_date": 1468984964, "last_edit_date": 1469032008, "question_id": 38471779, "link": "https://stackoverflow.com/questions/38471779/syntax-passing-variable-from-form-to-subform-inside-subform", "title": "Syntax Passing Variable from Form to subform inside subform", "body": "<p>I am trying to pass a variable from a Modal Form to a subform within a subform and unable to create the proper syntax.  Subform \"sfrProfiling\" is contained within subform \"Crafter Default\" which is contained within \"Main Form\".  I have a modal pop up with the name \"sfrChangeProfilePics\". I can create the variable without a problem, but cannot pass the varible value to the field \"pic\" on the subform \"sfrProfiling'.The error says it cannot find the field.</p>\n\n<p>These subforms are also in navigation subforms as well.</p>\n\n<p>Update:</p>\n\n<p>I am trying to pass a variable from a Modal Form (sfrChangeProfilePics), to a subform in a NavigationSubform (sfrProfiling), to a subform in a NavigationSubform (Crafter Default) which is in the main form (Main Form) and unable to create the proper syntax. My code works when they are simply a subform within a subform within the main form. As soon as I insert them into navigation control it doesn't work. My navigationSubform name is \"NavigationSubform\".</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Public Sub Command4_Click()\nDim myProfiling As Recordset\n\nSet myProfiling = CurrentDb.OpenRecordset(\"Profiling\")\nvarChangePicture = Forms!sfrChangeProfilePics!FileName.value\n\nDoCmd.Close\n\nForms![Main Form].[Crafter Default].Form!sfrProfiling.Form!pic.value=varChangePicture\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1468996501, "post_id": 38472133, "comment_id": 64350700, "body": "I have included the above line on the MainSheet  and not on the button (code I provided above was given for button/module). Cells are now getting disabled when the sheet name dosent match the value of 2 cells. But the problem is when the sheet name matches, it will take 4-5 clicks on the cell to get it active and its annoying. Am I doing something wrong.."}, {"owner": {"reputation": 176, "user_id": 6566211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce40841f1a55640d22261334c077d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6566211/jason"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1469026007, "post_id": 38472133, "comment_id": 64371140, "body": "See my edited code above for a worksheet selection event that will help with when to lock/unlock those cells."}], "tags": [], "owner": {"reputation": 176, "user_id": 6566211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cce40841f1a55640d22261334c077d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6566211/jason"}, "is_accepted": true, "score": 0, "last_activity_date": 1469025963, "last_edit_date": 1469025963, "creation_date": 1468987528, "answer_id": 38472133, "question_id": 38471722, "link": "https://stackoverflow.com/questions/38471722/vba-code-to-disable-cells/38472133#38472133", "title": "VBA code to disable cells", "body": "<p>In your code to test sheet names, you could disable the cells with the code:</p>\n\n<pre><code>Range(\"H1:M40\").Locked = True\n</code></pre>\n\n<p>and then it would be equal to false when the name is no longer a duplicate.</p>\n\n<p><em>Note</em> This will only work if the sheet is protected.</p>\n\n<p><em>Edit:</em></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)  \n    If Target.Count &gt; 1 Then Exit Sub  \n    Set myRng = Range(\"H1:M40\")  \n    For Each C In myRng\n        If C.Address = Target.Address And ActiveSheet.Name = ActiveSheet.Range(\"C21\").Value &amp; \"-\" &amp; ActiveSheet.Range(\"G17\").Value Then\n            ActiveSheet.Unprotect Password:= \"xyz\"  \n            Range(\"H1:M40\").Locked = False  \n            ActiveSheet.Protect Password:= \"xyz\"  \n            Exit For  \n        Else  \n            ActiveSheet.Unprotect Password:= \"xyz\"  \n            Range(\"H1:M40\").Locked = True\n            ActiveSheet.Protect Password:= \"xyz\"  \n        End If  \n    Next C  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3391, "favorite_count": 0, "accepted_answer_id": 38472133, "answer_count": 1, "score": 0, "last_activity_date": 1469025963, "creation_date": 1468984580, "last_edit_date": 1531164843, "question_id": 38471722, "link": "https://stackoverflow.com/questions/38471722/vba-code-to-disable-cells", "title": "VBA code to disable cells", "body": "<p>I have a code that will rename sheet based on the cell values in the drop down list. I have two drop down list \"C21\" and \"G17\" and button that will help me in renaming the sheet. </p>\n\n<p>My concern is, I need to disable cells from  \"H1\" to \"M40\" so that user cannot input data until he renames the sheet. Basically if button is executed successfully cells should be active, if not  \"NO\". Can you please help me?</p>\n\n<pre><code>Sub RenameCurrentSheet()\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n    Dim worksh As Integer\n    Dim worksheetexists As Boolean\n    Dim ws As Worksheet\n    worksh = Application.Sheets.Count\n    worksheetexists = False\n    ThisWorkbook.Unprotect Password:=\"xyz\"\n    For x = 1 To worksh\n    If Worksheets(x).Name = ActiveSheet.Range(\"C21\").Value &amp; \"-\" &amp; ActiveSheet.Range(\"G17\").Value Then\n            worksheetexists = True\n            MsgBox (\"Sheet with the name \" + Worksheets(x).Name + \" Already Exists!!!\")\n    Exit For\n    End If\n    Next x\n    If worksheetexists = False Then\n    For x = 1 To worksh\n        If ActiveSheet.Name = \"MainSheet\" Then\n            MsgBox \"You Cannot Change Name of This Sheet!!!\"\n        Else\n            ActiveSheet.Name = Range(\"C21\").Value &amp; \"-\" &amp; Range(\"G17\").Value\n            Exit For\n        End If\n    Next x\n    End If\n\nApplication.DisplayAlerts = True\nThisWorkbook.Protect Password:=\"xyz\"\nEnd Sub\n</code></pre>\n\n<p>Please help!!</p>\n"}, {"tags": ["excel", "testing", "format", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 923194, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d48e182893f9d17460dd2404c4072828?s=128&d=identicon&r=PG", "display_name": "Imran Ali", "link": "https://stackoverflow.com/users/923194/imran-ali"}, "edited": false, "score": 0, "creation_date": 1468983494, "post_id": 38471526, "comment_id": 64346721, "body": "Is the code you share vba? please add the related tag if it is"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1468986302, "post_id": 38471526, "comment_id": 64347285, "body": "Does your filename (column B of RefSheet?) not include the file extension, and your problem is you don&#39;t know which one to use?"}, {"owner": {"reputation": 1, "user_id": 6596949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb038936cc37e7f77204b1b6ed313245?s=128&d=identicon&r=PG&f=1", "display_name": "rCorn", "link": "https://stackoverflow.com/users/6596949/rcorn"}, "edited": false, "score": 0, "creation_date": 1468986419, "post_id": 38471526, "comment_id": 64347311, "body": "Thanks for your reply. Though, what I really need to test is the format  of the actual file in the folder. It&#39;s easy enough to test my path name, but I need to be able to see if the actual file is .xlsx or .xlsm. Then I need to modify the name in column B with .xlsx or .xlsm accordingly"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1468989268, "last_edit_date": 1468989268, "creation_date": 1468986819, "answer_id": 38472043, "question_id": 38471526, "link": "https://stackoverflow.com/questions/38471526/file-format-test/38472043#38472043", "title": "File format test", "body": "<p>Change your code from</p>\n\n<pre><code>Set InBook = Workbooks.Open(Filename:=RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2), UpdateLinks:=False, ReadOnly:=True)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Dim fName As String\nIf Dir(RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2))&lt;&gt;\"\" Then\n    fName = RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2)\nElseIf Dir(RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2) &amp; \".xlsm\")&lt;&gt;\"\" Then\n    fName = RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2) &amp; \".xlsm\"\nElse\n    fName = RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2) &amp; \".xlsx\"\nEnd If\nSet InBook = Workbooks.Open(Filename:=fName, UpdateLinks:=False, ReadOnly:=True)\n</code></pre>\n\n<p>This will first test to see if the filename is valid exactly as it is recorded in column B.  If not, it will see if a file with an \"xlsm\" extension exists and, if so, use it.  Otherwise it will assume the file has an \"xlsx\" extension.</p>\n\n<p>An alternative method (which will probably work with csv and txt files as well) would be:</p>\n\n<pre><code>Dim fName As String\n'The Dir command will just return the filename.extension portion of the first file that matches the specification\nfName = Dir(RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2) &amp; \".*\")\nIf fName = \"\" Then\n    'No matching file was found\n    MsgBox \"File requested (\" &amp; RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2) &amp; \") does not exist\"\nElse\n    'Concatenate the path and filename.extension together and open the file\n    Set InBook = Workbooks.Open(Filename:=RefSheet.Cells(file, 1) &amp; fName, UpdateLinks:=False, ReadOnly:=True)\nEnd If\n</code></pre>\n\n<p>P.S.  The declaration of fName can be moved to the start of your Sub (or Function) if you prefer to have all your declarations done up-front.</p>\n"}], "owner": {"reputation": 1, "user_id": 6596949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb038936cc37e7f77204b1b6ed313245?s=128&d=identicon&r=PG&f=1", "display_name": "rCorn", "link": "https://stackoverflow.com/users/6596949/rcorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468989268, "creation_date": 1468983037, "last_edit_date": 1531164843, "question_id": 38471526, "link": "https://stackoverflow.com/questions/38471526/file-format-test", "title": "File format test", "body": "<p>I'm creating a program which opens a file in a specified file path, from a long list of files. They all have same name format, but they are not all .xlsx file format, some are .xlsm format. </p>\n\n<pre><code>For file = 2 To 200\nIf RefSheet.Cells(file, 1) = \"\" Then Exit For 'no more data, end now\n\n        If KeepOpen Then\n            'continue as is, because already open\n         Else\n            Set InBook = Workbooks.Open(Filename:=RefSheet.Cells(file, 1) &amp; RefSheet.Cells(file, 2), UpdateLinks:=False, ReadOnly:=True)\n\n         End if\n End If\n</code></pre>\n\n<p>I'm trying to make a simple test which would first text file name for .xlsx/.xlsm before trying to open, but can't seem to make it correctly.</p>\n\n<p>Have tried to do error handling, but it will not execute as desired</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 5833797, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153537724899331/picture?type=large", "display_name": "Dave Cook", "link": "https://stackoverflow.com/users/5833797/dave-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1487194456, "creation_date": 1487194456, "answer_id": 42260500, "question_id": 38470684, "link": "https://stackoverflow.com/questions/38470684/paste-values-into-new-worksheet-for-all-open-worksheets-including-pictures/42260500#42260500", "title": "Paste Values into new worksheet for all Open Worksheets including pictures", "body": "<p>I think this is what you're asking for:</p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim counter As Integer\nDim filePath As String\n\nSet wb = ActiveWorkbook\ncountet = 1\n\nfilePath = \"c:/\" 'Enter your destination folder here\n\nFor Each ws In wb.Sheets\n    Sheets(\"Sheet1\").Copy\n    With ActiveSheet.UsedRange\n        .Value = .Value\n    End With\n    ActiveWorkbook.SaveAs filePath &amp; counter &amp; \".xlsx\", FileFormat:=51\n    counter = counter + 1\nNext ws\nEnd Sub\n</code></pre>\n\n<p>This is mostly taken from <a href=\"https://www.mrexcel.com/forum/excel-questions/450640-visual-basic-applications-copy-active-worksheet-values-only.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The counter is a bit of a hack to make sure that the files aren't all being saved as the same name and overwriting each other. Maybe there's a more appropriate way that you can get around this.</p>\n"}], "owner": {"reputation": 1, "user_id": 6611085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ece98da8389003cdd6dea211286998d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason H", "link": "https://stackoverflow.com/users/6611085/jason-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487249565, "creation_date": 1468975782, "last_edit_date": 1487249565, "question_id": 38470684, "link": "https://stackoverflow.com/questions/38470684/paste-values-into-new-worksheet-for-all-open-worksheets-including-pictures", "title": "Paste Values into new worksheet for all Open Worksheets including pictures", "body": "<p>I am trying to create a renamed copy of all active workbooks (even non macro-enabled ones) without formulas, possibly by pasting values but without modifying images. I am working with Excel 2007.</p>\n\n<p>My process would ideally be to: </p>\n\n<p>1) Create a do while there are xls files loop that converts all xls files to xlsm. One possible addition would be an array to store A)the worksheet name(s) B)Its tabs name and their status</p>\n\n<p>2) Run a for each or for loop that automatically pastes values for all active worksheets include those with graphs or other images into a new document that has the same name with all small addition at the end.</p>\n\n<p>3) Convert my newly-named files containing values only into xls.</p>\n\n<p>One issue I am running into when I try to do this has to do with links. The initial worksheets have formulas with links that do not automatically update. When I do this, the formulas in the original worksheet with link references tend to get corrupted.</p>\n\n<p>Here is a general macro I found for pasting values:</p>\n\n<pre><code>Sub test()\nDim MyNames As Range, MyNewSheet As Range\n\n    Set MyNames = Range(\"R5\").CurrentRegion ' load contigeous range into variable\n    For Each MyNewSheet In MyNames.Cells    ' loop through cell children of range variable\n        Sheets.Add.Name = MyNewSheet.Value\n    Next MyNewSheet\n    MyNames.Worksheet.Select                ' move selection to original sheet\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1468976241, "post_id": 38470600, "comment_id": 64345205, "body": "You don&#39;t need to separate the case statements, the case is what separates them.  What line do you get the error at?  Overflow is when normally when you are trying to put to much or the wrong data in a variable."}, {"owner": {"reputation": 11, "user_id": 6611060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hm3RWrzkJmI/AAAAAAAAAAI/AAAAAAAABac/620wnJfyjmM/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/6611060/tom"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1469023444, "post_id": 38470600, "comment_id": 64369192, "body": "Hey MatthewD I think I&#39;ll just go with the code of Tim, it simplifies the problem and since it&#39;s not my code I think it can take ages till I find the &quot;correct&quot; mistake in the code which causes the overflow."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6611060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hm3RWrzkJmI/AAAAAAAAAAI/AAAAAAAABac/620wnJfyjmM/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/6611060/tom"}, "edited": false, "score": 0, "creation_date": 1469023490, "post_id": 38470727, "comment_id": 64369232, "body": "Hey Tim thanks a lot, this simplifies the problem since I only have to put in one new line per new Item, thanks a lot! Cheers"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1468976357, "creation_date": 1468976357, "answer_id": 38470727, "question_id": 38470600, "link": "https://stackoverflow.com/questions/38470600/overflow-error-with-select-case-in-for-loop/38470727#38470727", "title": "Overflow error with Select Case in For loop", "body": "<p>Untested:</p>\n\n<pre><code>Private Sub ComboBox5_Change() 'Auswahl Rohr\n\n    Dim v, arrRows, c\n\n    v = ComboBox5.Value\n\n    arrRows = Array(Tabelle6.Cells(4, 3), _\n                    Tabelle13.Cells(4, 3), _\n                    Tabelle13.Cells(5, 3))\n\n    For Each c In arrRows\n\n        If c.Value = v Then\n            'Found a match - assign from that row...\n            With c.EntireRow\n                L\u00e4ngRo = .Cells(6)\n                OnCenRo = .Cells(7)\n                OffCeRo = .Cells(8)\n                MinRRo = .Cells(9)\n            End With\n            Exit For  'stop looping\n        End If\n\n    Next c\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure I followed exactly what your layout is though...</p>\n"}], "owner": {"reputation": 11, "user_id": 6611060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hm3RWrzkJmI/AAAAAAAAAAI/AAAAAAAABac/620wnJfyjmM/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/6611060/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503711803, "creation_date": 1468974922, "last_edit_date": 1503711803, "question_id": 38470600, "link": "https://stackoverflow.com/questions/38470600/overflow-error-with-select-case-in-for-loop", "title": "Overflow error with Select Case in For loop", "body": "<p>I am a CAD engineer with a relativly small knowledge of VBA, but today I decided to modify a 5 year old program and came across this problem:</p>\n\n<p>I have a combobox that can display items from 2 different sheets, depending on which one of two radio boxes is selected.\nThis works with Cases. Honestly, I have no idea how cases really work, so I don't know how the combobox knows which case to take, but it works, so I'm not changing it.</p>\n\n<p>Now, currently, the code is like this:</p>\n\n<p>which means if I add a new row into the table, I have to copy those case select things</p>\n\n<pre><code>Private Sub ComboBox5_Change()                        'Auswahl Rohr\n\n    Select Case ComboBox5.Value\n        Case Tabelle6.Cells(4, 3)                     'Welle in Rohr\n\n            L\u00e4ngRo = Tabelle6.Cells(4, 6)\n            OnCenRo = Tabelle6.Cells(4, 7)\n            OffCeRo = Tabelle6.Cells(4, 8)\n            MinRRo = Tabelle6.Cells(4, 9)\n\n        Case Tabelle13.Cells(4, 3)                    'ROHR IN ROHR\n\n            L\u00e4ngRo = Tabelle13.Cells(4, 6)\n            OnCenRo = Tabelle13.Cells(4, 7)\n            OffCeRo = Tabelle13.Cells(4, 8)\n            MinRRo = Tabelle13.Cells(4, 9)\n\n        Case Tabelle13.Cells(5, 3)                    'ROHR IN ROHR\n\n            L\u00e4ngRo = Tabelle13.Cells(5, 6)\n            OnCenRo = Tabelle13.Cells(5, 7)\n            OffCeRo = Tabelle13.Cells(5, 8)\n            MinRRo = Tabelle13.Cells(5, 9)\n\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>I tried to fix this with something like this:</p>\n\n<pre><code>Private Sub ComboBox5_Change()                        'Auswahl Rohr\n\n    Dim for1 As Long\n    Dim for2 As Long\n    For for2 = 3 To 7\n        If Tabelle6.Cells(for2, 3) = \"\" Then\n            GoTo fert\n        Else\n            Select Case ComboBox5.Value\n                Case Tabelle6.Cells(for2, 3)          'Welle in Rohr\n\n                    L\u00e4ngRo = Tabelle6.Cells(for2, 6)\n                    OnCenRo = Tabelle6.Cells(for2, 7)\n                    OffCeRo = Tabelle6.Cells(for2, 8)\n                    MinRRo = Tabelle6.Cells(for2, 9)\n\n            End Select\n        End If\n    Next\n\n    For for1 = 3 To 7\n        If Tabelle10.Cells(for1, 3) = \"\" Then\n            GoTo fert\n        Else\n            Select Case ComboBox5.Value\n                Case Tabelle10.Cells(for1, 3)         'ROHR IN ROHR\n\n                    L\u00e4ngWe = Tabelle10.Cells(for1, 6)\n                    OnCenWe = Tabelle10.Cells(for1, 7)\n                    OffCeWe = Tabelle10.Cells(for1, 8)\n                    MinRWe = Tabelle10.Cells(for1, 9)\n\n            End Select\n        End If\n    Next\n\nfert:\n\nEnd Sub\n</code></pre>\n\n<p>But now I get an overflow error when I press a button that uses var <code>L\u00e4ngRO</code>, and I don't really know why</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468972876, "post_id": 38470332, "comment_id": 64344528, "body": "<code>Set visRng = </code> - need to use <code>Set</code> when assigning something to an object variable"}, {"owner": {"reputation": 49, "user_id": 4633880, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fe74844161e522ce7b34f06c7a8f3ac?s=128&d=identicon&r=PG&f=1", "display_name": "TradorDave", "link": "https://stackoverflow.com/users/4633880/tradordave"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1468989230, "post_id": 38470332, "comment_id": 64347972, "body": "@TimWilliams Thank you!! I can&#39;t believe it was such a simple answer."}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 0, "last_activity_date": 1468973382, "creation_date": 1468973382, "answer_id": 38470423, "question_id": 38470332, "link": "https://stackoverflow.com/questions/38470332/how-to-find-a-cell-value-within-the-visible-range/38470423#38470423", "title": "How to find a cell value within the visible range", "body": "<p>See comments for explanation.</p>\n\n<pre><code>Sub FindAndColor()\n\n    Dim visRng As Range\n    Dim rngCell As Range\n\n\n    '/ Set to range object. Yiu can't simply asign to it.\n    '/ This will get rid of Error 91\n    '/ Just Use VisibleCells of the usedRange\n    Set visRng = Worksheets(\"Work\").UsedRange.SpecialCells(XlCellType.xlCellTypeVisible)\n\n    '/ Loop through the range\n    For Each rngCell In visRng.Cells\n        If rngCell.Row &lt;&gt; 1 Then\n        If rngCell.Value = rngCell.Offset(-1).Value _\n        And rngCell.Interior.ColorIndex = -4142 Then    '/ -4142 is the default interior colorindex\n            rngCell.EntireRow.Interior.ColorIndex = 3\n        End If\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4633880, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fe74844161e522ce7b34f06c7a8f3ac?s=128&d=identicon&r=PG&f=1", "display_name": "TradorDave", "link": "https://stackoverflow.com/users/4633880/tradordave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 38470423, "answer_count": 1, "score": 1, "last_activity_date": 1468973382, "creation_date": 1468972564, "question_id": 38470332, "link": "https://stackoverflow.com/questions/38470332/how-to-find-a-cell-value-within-the-visible-range", "title": "How to find a cell value within the visible range", "body": "<p>I have a long list of entries to go through very quickly, where one of the columns, Column F, changes fairly often. Since I'm going through each entry individually, I want to highlight the entire row red where the value in Column F changes so that it's easy to see. Here's what I've written so far:</p>\n\n<pre><code>Dim visRng As Range, rngTop As Long, rngBot As Long\nrngTop = ActiveWindow.visiblerange.Row\nrngBot = ActiveWindow.visiblerange.Row + ActiveWindow.visiblerange.Rows.Count - 2\nvisRng = Worksheets(\"Work\").Range(\"F\" &amp; rngTop, \"F\" &amp; rngBot)\n\n    For Each Cell In visRng\n        If Cell.Value = Cell.Offset(-1).Value _\n            And Cell.Interior.ColorIndex = 0 Then\n            Cell.EntireRow.Interior.ColorIndex = 3\n        End If\n    Next\n</code></pre>\n\n<p>I keep getting an error on the row where I define \"visRng\":</p>\n\n<blockquote>\n  <p>Runtime Error '91':\n  Object variable or With block variable not set</p>\n</blockquote>\n\n<p>I am fairly new to VBA, and self-taught, so I can't guarantee I'll understand all the jargon. Any help is greatly appreciated!</p>\n"}]