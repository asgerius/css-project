[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1475113031, "post_id": 39759344, "comment_id": 66815823, "body": "The answer is yes = you can define &#39;IF combo box = &#39;whatever&#39; do these series of events&quot;."}, {"owner": {"reputation": 102, "user_id": 5821186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z0a2g.jpg?s=128&g=1", "display_name": "Sayyed Abbas Rizvi", "link": "https://stackoverflow.com/users/5821186/sayyed-abbas-rizvi"}, "edited": false, "score": 1, "creation_date": 1475121269, "post_id": 39759344, "comment_id": 66817687, "body": "It is very possible, Dear friend show us what have you tried so far,this is not get your work done for free website :)"}], "owner": {"reputation": 1, "user_id": 6896564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc60a169219e7a3990d2624355dce54?s=128&d=identicon&r=PG&f=1", "display_name": "EtInnovare", "link": "https://stackoverflow.com/users/6896564/etinnovare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475107071, "creation_date": 1475107071, "question_id": 39759344, "link": "https://stackoverflow.com/questions/39759344/excel-using-dropdown-menu-and-selection-to-enact-dynamic-information-availabi", "title": "Excel: Using dropdown menu (and selection) to enact dynamic information availability", "body": "<p>Is there anyway to use dropdown menus to instantaneously present pre-configured graphs/charts/other work from other sheets on the dropdown menu's sheet? </p>\n\n<p>More specifically: \nLets say that I have</p>\n\n<ul>\n<li>a pie chart in Sheet1 and </li>\n<li>a table of sales commissions in Sheet 2  </li>\n</ul>\n\n<p>Could I go to Sheet3 --> Define the pie chart and commissions as named \"Busy\"  --> then on a new sheet (Sheet4): </p>\n\n<p>1.) A1: Define Data --> List --> = Busy\n 2.) Select \"Pie Chart\" from the drop down box and have A2:A12,F2:F12 linked/connected to my Sheet1 graph so that the graph instantly appears in that area after selecting \"Pie Chart\"? Or so that my table from Sheet2 appears in that area after selecting \"Commission\" from the dropdown? </p>\n\n<p>Is this even possible to do? It seems possible, given that we can basically set select a range of cells for which to place our graphs. I do not see why it wouldn't possible to select a range of cells to link to an action/condition.   </p>\n"}, {"tags": ["ms-access", "sharepoint", "combobox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "edited": false, "score": 0, "creation_date": 1475180044, "post_id": 39777280, "comment_id": 66852678, "body": "Thanks, geeFlo, but I don&#39; think that will work. If I&#39;m not mistaken, your code will add records to my table, whereas what I need is to add records to the recordset that is stored within the multivalue field of the new record that the form created. If I&#39;m not understanding your answer, though, please say so. @geeFlo"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "edited": false, "score": 0, "creation_date": 1475248768, "post_id": 39777280, "comment_id": 66882571, "body": "the .Edit is editing your current record, but then you immediately state .addnew which moves you to a new empty record.  Looks like you probably want to repeat your other fields in the assignment section so that the records are complete.  i.e.  after .addnew, state assignments for each other field to repeat existing field values, until the FOR-NEXT is complete."}, {"owner": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "edited": false, "score": 0, "creation_date": 1475781107, "post_id": 39777280, "comment_id": 67093210, "body": "Hmmmm. This is a good point. However, my original problem arises at the .MoveFirst statement, since that&#39;s when the error is thrown. So even if I added the additional information, I would still encounter that error."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "edited": false, "score": 0, "creation_date": 1475782761, "post_id": 39777280, "comment_id": 67094081, "body": "oh, check for an .EOF maybe there is no record?"}, {"owner": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "edited": false, "score": 0, "creation_date": 1475789598, "post_id": 39777280, "comment_id": 67097384, "body": "See, that&#39;s the weird part. I&#39;ve checked that before, and that is indeed an issue if you haven&#39;t populated any part of the form previously. Bus as soon as you edit a different section of the form (for example, add in a title), there is definitely a record there."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "edited": false, "score": 0, "creation_date": 1475850637, "post_id": 39777280, "comment_id": 67123085, "body": "try refreshing the record prior to running your code, as the underlying table might not be updated yet."}], "tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": false, "score": 0, "last_activity_date": 1475172868, "creation_date": 1475172868, "answer_id": 39777280, "question_id": 39758621, "link": "https://stackoverflow.com/questions/39758621/ms-access-select-all-check-box-for-a-combobox-bound-to-a-sharepoint-multivalue-f/39777280#39777280", "title": "MS Access Select All Check Box for a Combobox Bound to a Sharepoint Multivalue Field", "body": "<p>Try this.  (I originally had said to check for EOF, but after further inspection it looks like you had an EDIT immediately followed by an ADD i.e. the EDIT wasn't doing anything, as you're adding records).  I've never used the me.recordset before either, as I always explicity define it - must try that next time to grab underlying form source.  Thx.</p>\n\n<pre><code>Private Sub testcheck_Click()\n    Dim counter As Integer\n    Dim rst As DAO.Recordset\nSet rst = Me.Recordset\n\nIf testcheck.Value = True Then\n    With rst\n        For counter = 0 To Me.testcombo.ListCount - 1\n            .AddNew\n            !Test = Val(Me.testcombo.Column(1, counter))\n            .Update\n         Next counter\n    End With\nElseIf testcheck.Value = False Then\n    Me.testcombo.Value = Array()\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 11, "user_id": 6896245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a04d7eb460a7aa3670ebef5fbaa705?s=128&d=identicon&r=PG&f=1", "display_name": "apynn", "link": "https://stackoverflow.com/users/6896245/apynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475775792, "creation_date": 1475101636, "last_edit_date": 1475775792, "question_id": 39758621, "link": "https://stackoverflow.com/questions/39758621/ms-access-select-all-check-box-for-a-combobox-bound-to-a-sharepoint-multivalue-f", "title": "MS Access Select All Check Box for a Combobox Bound to a Sharepoint Multivalue Field", "body": "<p>Alright, after a few weeks of trying to figure this out, and (I think) getting 99% of the way there, I have had to admit defeat, join Stack Overflow, and post my question. I apologize if my question etiquette isn't superb, but here goes;</p>\n\n<p>As the title implies, I am trying to create a select all checkbox for a combobox in an Access 2010 form. This combobox is bound to a multivalue field that is part of a SharePoint list (all of the tables in our database are stored as SharePoint lists and linked to the Access file. The Access file is effectively a front end).</p>\n\n<p>I have managed to get this to work in a test database that is not linked to SharePoint, but I can't seem to get it to work in our actual linked database. Here is the code from the test database that runs when the checkbox is clicked. Note that [Test] is the name of the multivalue field I defined in this example. It is a lookup field that gets its possible values from another simple table in the database.</p>\n\n<pre><code>Private Sub testcheck_Click()\n    Dim counter As Integer\n    Dim rst As DAO.Recordset\n\n    Set rst = Me.Recordset\n\n    If testcheck.Value = True Then\n        With rst\n            .MoveFirst\n            .Edit\n            For counter = 0 To Me.testcombo.ListCount - 1\n                With !Test.Value\n                    .AddNew\n                    .Value = Val(Me.testcombo.Column(1, counter))\n                    .Update\n                End With\n            Next counter\n            .Update\n        End With\n    ElseIf testcheck.Value = False Then\n        Me.testcombo.Value = Array()\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/PIY1Y.png\" rel=\"nofollow\">Snapshot of my test form</a></p>\n\n<p>When I try to run the above code in my actual database, it throws an error when it gets to the .MoveFirst command. The error is run time error 3426: \"This action was cancelled by an associated object\". I'm quite confident that it thinks I'm trying to move to a different record while still editing the current record (even though there is only one). From here, I've figured out that, when running the code in the test database, that little pencil icon in the top left corner of the form (which I assume means you are editing the record) is replaced by a black triangle when it gets to the .MoveFirst command. This does not happen in my actual database. I have no idea why the discrepancy, and I don't fully understand what it means. If anyone has an idea of how to fix this, I would be very appreciative to the input.</p>\n\n<p>I should note that my code only works if the form has already created a record to edit. I have a work around, but that tangent is beyond the scope of this question. </p>\n"}, {"tags": ["vba", "excel", "range", "cell"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1475100200, "post_id": 39758307, "comment_id": 66812794, "body": "Nothing in this code apperas to handle Cell A2, nor C2:C21, nor D2:D21..."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1475130674, "post_id": 39758393, "comment_id": 66820957, "body": "adding <code>Application.EnableEvents = False</code> before any statement making workbook/worksheet changes and then handling errors to have <code>Application.EnableEvents = True</code> run is always a good practice in a <code>Worksheet_Change</code> event handler"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 1, "last_activity_date": 1475100206, "creation_date": 1475100206, "answer_id": 39758393, "question_id": 39758307, "link": "https://stackoverflow.com/questions/39758307/copy-cell-value-to-a-range-of-cells/39758393#39758393", "title": "Copy cell value to a range of cells", "body": "<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"AS2\")) Is Nothing Then\n        For CurCol = 3 to 4\n            For CurRow = 2 to 21\n                If Cells(CurRow, CurCol).Value = \"\" Then\n                    Cells(CurRow, CurCol).Value = Target.Value\n                    Exit Sub\n                EndIf\n            Next CurRow\n        Next CurCol\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1475130426, "creation_date": 1475130426, "answer_id": 39762889, "question_id": 39758307, "link": "https://stackoverflow.com/questions/39758307/copy-cell-value-to-a-range-of-cells/39762889#39762889", "title": "Copy cell value to a range of cells", "body": "<p>I guess this is what you're after:</p>\n\n<pre><code>Option Explicit\n\nSub Worksheet_Change(ByVal Target As Range)\n    Dim nVals As Long\n\n    If Not Intersect(Target, Range(\"A2\")) Is Nothing Then\n        With Range(\"C2:D21\")\n            nVals = WorksheetFunction.CountA(.Cells)\n            If nVals = .Count Then Exit Sub\n            Application.EnableEvents = False\n            On Error GoTo exitsub\n            .Cells(nVals Mod .Rows.Count + 1, IIf(nVals &gt;= .Rows.Count, 2, 1)).Value = Target.Value\n        End With\n    End If\n\nexitsub:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6895919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7851b6004a42a6bd41d449ced8a679d?s=128&d=identicon&r=PG&f=1", "display_name": "Nanogorn", "link": "https://stackoverflow.com/users/6895919/nanogorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507658989, "creation_date": 1475099698, "last_edit_date": 1507658989, "question_id": 39758307, "link": "https://stackoverflow.com/questions/39758307/copy-cell-value-to-a-range-of-cells", "title": "Copy cell value to a range of cells", "body": "<p>I'm new to VBA and I am trying to copy values from one cell to multiple cells when its value changes. </p>\n\n<p>The value of A2 is constantly changing and when that happens I want that value to be copied to cells C2:C21 (and then eventually to cells D2:D21)</p>\n\n<p>Here is an example of what I would like to achieve:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xJZyZ.jpg\" rel=\"nofollow noreferrer\">http://i.stack.imgur.com/xJZyZ.jpg</a></p>\n\n<p>So far I wrote this code:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n   For i = 0 To 19\n      If Not Intersect(Target, Range(\"AS2\")) Is Nothing Then\n         Cells(Target.Row + i, 58).Value = Cells(Target.Row, 45).Value\n      End If\n   Next i\nEnd Sub\n</code></pre>\n\n<p>but this only copies one single value of A2 to all the cells C2 to C22.</p>\n\n<p>May anyone help me write this code properly?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475099150, "post_id": 39758139, "comment_id": 66812387, "body": "Are you asking a) for help with a problem in the code you&#39;ve written b) for someone to write the code for you <i>or</i> c) how to click a button?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475099167, "post_id": 39758139, "comment_id": 66812394, "body": "If it&#39;s a), then please <a href=\"http://stackoverflow.com/help/how-to-ask\">post your code</a>."}, {"owner": {"reputation": 23, "user_id": 6896280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910c547c7121fe91720a7b709760acf1?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/6896280/stefan"}, "edited": false, "score": 0, "creation_date": 1475100149, "post_id": 39758139, "comment_id": 66812757, "body": "Sub Button2_Click()   Dim Cell As Integer Dim SelectedCell As String    For i = 1 To 10  Cell = 4 SelectedCell = CStr(Cell) Range(&quot;C&quot; + SelectedCell).Value = Range(&quot;C38&quot;).Value Cell = Cell + 1  Next i  I need help with the code, sorry i wast clear about that. I have tried a for loop, do while and one kick ass if statement. None which seem to work. I am not able to edit my question as to include the code so had to paste it here."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475101989, "post_id": 39758139, "comment_id": 66813403, "body": "Why do you need VBA for this?  It sounds like this would be just a simple <code>SUMIF</code> on the worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "is_accepted": true, "score": 1, "last_activity_date": 1475129683, "creation_date": 1475129683, "answer_id": 39762699, "question_id": 39758139, "link": "https://stackoverflow.com/questions/39758139/excel-vba-loop-to-store-value-in-different-cell-on-button-click/39762699#39762699", "title": "Excel VBA loop to store value in different cell on button click", "body": "<p>As mentioned in the question, you are having trouble with moving to the next cell to store date and amount at that date.</p>\n\n<p>Assume that you have stored current balance at B8.</p>\n\n<p>Please try below code</p>\n\n<pre><code>Sub Button2_Click()\nDim col_num As Integer\n\ncol_num = 1\n\nDo Until Cells(1, col_num).Value = \"\"\n\n    col_num = col_num + 1\n\nLoop\n\nCells(1, col_num).Value = Date\nCells(2, col_num).Value = Range(\"B8\").Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6896280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910c547c7121fe91720a7b709760acf1?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/6896280/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 0, "accepted_answer_id": 39762699, "answer_count": 1, "score": 1, "last_activity_date": 1475129683, "creation_date": 1475098938, "last_edit_date": 1475101570, "question_id": 39758139, "link": "https://stackoverflow.com/questions/39758139/excel-vba-loop-to-store-value-in-different-cell-on-button-click", "title": "Excel VBA loop to store value in different cell on button click", "body": "<p>I currently have a worksheet in which I am storing my company's accounts eg. all transfers made (money coming in and going out). I simply require a button which when clicked will save the current date in a cell and next to it the amount \"Total\" of the company bank balance. I intend to click the button at the end of each month as to record all balances for a particular date. I am having trouble with moving to the next cell to store date and amount for the next month. </p>\n\n<p>An example of what i am trying to achieve</p>\n\n<p>Total (Cell B8) = $100 (<strong>Month 1</strong>)</p>\n\n<p>On Button_1 click</p>\n\n<p>Cell A1 = Current Date\nCell A2 = $100 (Cell B8)</p>\n\n<p>Total (Cell B8) = $200 (<strong>Month 2</strong>) (New amount as money has come in)</p>\n\n<p>On Button_1 click &lt;------ This should not change the amount in A1 and A2</p>\n\n<p>Cell B1 = Current Date</p>\n\n<p>Cell B2 = $200 (Cell B8) </p>\n\n<p>etc. for ever month thereafter</p>\n\n<p>My code:</p>\n\n<pre><code>Sub Button2_Click()\n\nDim Cell As Integer\nDim SelectedCell As String\n\nFor i = 1 To 10\n    Cell = 4\n    SelectedCell = CStr(Cell)\n    Range(\"C\" + SelectedCell).Value = Range(\"C38\").Value\n    Cell = Cell + 1\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6866212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cf854018ca9b672ae4a9d2c9ce5b7c3?s=128&d=identicon&r=PG&f=1", "display_name": "DavidR", "link": "https://stackoverflow.com/users/6866212/davidr"}, "edited": false, "score": 0, "creation_date": 1475108331, "post_id": 39758368, "comment_id": 66814923, "body": "Anthony Thank you pointing out the DMAX function is not working that is my promblem. Though I can not figure out the right syntax for field, table, and critera."}, {"owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "reply_to_user": {"reputation": 1, "user_id": 6866212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cf854018ca9b672ae4a9d2c9ce5b7c3?s=128&d=identicon&r=PG&f=1", "display_name": "DavidR", "link": "https://stackoverflow.com/users/6866212/davidr"}, "edited": false, "score": 0, "creation_date": 1475120655, "post_id": 39758368, "comment_id": 66817557, "body": "See my updated answer above. I missed the fact that defaultcorps was a variable and not a data value. This update should produce what you are looking for."}, {"owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "reply_to_user": {"reputation": 1, "user_id": 6866212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cf854018ca9b672ae4a9d2c9ce5b7c3?s=128&d=identicon&r=PG&f=1", "display_name": "DavidR", "link": "https://stackoverflow.com/users/6866212/davidr"}, "edited": false, "score": 0, "creation_date": 1475164694, "post_id": 39758368, "comment_id": 66844160, "body": "Glad I can help. You can mark it as the answer in case someone else has a similar question."}], "tags": [], "owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "is_accepted": false, "score": 0, "last_activity_date": 1475120542, "last_edit_date": 1475120542, "creation_date": 1475100079, "answer_id": 39758368, "question_id": 39757993, "link": "https://stackoverflow.com/questions/39757993/run-time-error-424-object-required/39758368#39758368", "title": "Run Time Error 424 Object Required", "body": "<p>I think you need to start off by figuring out if your DMAX() statement is correctly producing results. The next thing I see and which is probably your main culprit is the fact that you are using the Expression IIf() inside VBA. The IIf() expression you are using will work inside a query or in a textbox but VBA has it's own If statement block which you are correctly using in the lines preceding it.</p>\n\n<p>I would actually use the Nz Function to simplify it even more as follows:</p>\n\n<p><strong>UPDATED</strong> Based off of your comment below I re-looked at your overall code and noticed that \"defaultcorps\" is a variable and not a value I originally thought you were trying to filter by. You were wrapping the variable in quotes. My updated answer should work for you.</p>\n\n<pre><code>Me.ClientID = (Nz(DMax(\"[ClientID]\", \"tClientinfo\", \"[CorpsName]= '\" &amp; defaultcorps &amp; \"'\"),0)+1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6866212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cf854018ca9b672ae4a9d2c9ce5b7c3?s=128&d=identicon&r=PG&f=1", "display_name": "DavidR", "link": "https://stackoverflow.com/users/6866212/davidr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594654467, "creation_date": 1475098219, "last_edit_date": 1594654467, "question_id": 39757993, "link": "https://stackoverflow.com/questions/39757993/run-time-error-424-object-required", "title": "Run Time Error 424 Object Required", "body": "<p>I been working on the following code to when the user click on the button to save and go new record that Access locates the highest client id used by set location and then adds 1 to it. Prior to saving the record and moving on to new record.  While work through other errors, but I can not get past error object required on this line.  \"Me.ClientID = IIf(DMax(\"[ClientID]\", \"tClientinfo\", \"[CorpsName]=\" &amp; \"'defaultcorps'\") Is Null, 0, DMax(\"[ClientID]\", \"tClientinfo\", \"[CorpsName]=\" &amp; \"'defaultcorps'\")) + 1\"</p>\n\n<p>The more i look at the similar questions more confused I get as to what is wrong with the code.  Thank you in advance for any suggestions David</p>\n\n<pre><code>    Private Sub Save_Record_Click()\n\n'declare variables for default values\nDim defaultinterviewr As String\nDim defaultcorps As String\n\n\n'Variables get their values\ndefaultinterviewr = Me.Interviewer.Value\ndefaultcorps = Me.Corps.Value\n\n'Check to see if ClientID field is Blank.\nIf IsNull(Me.ClientID) Then\n\n'Check that Corps field is filled in\n\nIf IsNull(Me.Corps) Then\n    MsgBox \"Corps must be entered before saving record.\", vbOKOnly\n    Me.Corps.SetFocus\n'set client id base on corps by finding the highest id and adding 1 to that number\nElse\nMe.ClientID = IIf(DMax(\"[ClientID]\", \"tClientinfo\", \"[CorpsName]=\" &amp; \"'defaultcorps'\") Is Null, 0, DMax(\"[ClientID]\", \"tClientinfo\", \"[CorpsName]=\" &amp; \"'defaultcorps'\")) + 1\nEnd If\nEnd If\nMsgBox \"Done\", vbOKOnly\n\n'save record\n'DoCmd.RunCommand acCmdSaveRecord\n'Me.stateidnum1 = \"\"\n'open new record\n'DoCmd.GoToRecord , , acNewRec\n\n'set field default value\n'Me.Interviewer.Value = defaultinterviewr\n'Me.Corps.Value = defaultcorps\n\n'Me.Child_Subform.Form.AllowAdditions = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475096694, "post_id": 39757578, "comment_id": 66811253, "body": "So, you want <code>TE</code>, <code>FL</code>, <code>AD</code>, etc. across row 1, then under each one, have their relative <code>Time&#47;pc</code> values?"}], "answers": [{"tags": [], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "is_accepted": false, "score": 2, "last_activity_date": 1475099868, "creation_date": 1475099868, "answer_id": 39758328, "question_id": 39757578, "link": "https://stackoverflow.com/questions/39757578/i-need-to-take-2-columns-in-an-excel-sheet-and-convert-them-to-a-data-range-with/39758328#39758328", "title": "I need to take 2 columns in an excel sheet and convert them to a data range with column 1 as the headers", "body": "<p>I'm fairly new to VBA, but am trying to answer question to support the community. I welcome any/all corrections to this code, but I tested it. It works and it does what they asked. It is not however optimised in any way, shape, or form. </p>\n\n<p>I called the initial Sheet \"RawData\" and the new sheet \"NewData\"</p>\n\n<pre><code>Option Explicit\n\nSub Pivot()\nDim i, m, q As Integer\ni = 2\nq = 3\n\nDo While Sheets(\"RawData\").Cells(i, 1).Value &lt;&gt; \"\"\nIf Sheets(\"NewData\").Range(\"A1:ZZ1\").Find(Sheets(\"RawData\").Cells(i, 1), LookAT:=xlWhole) Is Nothing Then\n        If Sheets(\"NewData\").Range(\"A1\") &lt;&gt; \"\" Then\n                If Sheets(\"NewData\").Range(\"B1\") &lt;&gt; \"\" Then\n                        Worksheets(\"RawData\").Cells(i, 1).Copy\n                        Worksheets(\"NewData\").Activate\n                        Cells(1, q).Activate\n                        ActiveCell.PasteSpecial xlPasteValues\n                        Worksheets(\"RawData\").Cells(i, 2).Copy\n                        Worksheets(\"NewData\").Activate\n                        Cells(2, q).Activate\n                        ActiveCell.PasteSpecial xlPasteValues\n                        q = q + 1\n                Else\n                        Worksheets(\"RawData\").Cells(i, 1).Copy\n                        Worksheets(\"NewData\").Activate\n                        Range(\"B1\").Activate\n                        m = ActiveCell.Column\n                        ActiveCell.PasteSpecial xlPasteValues\n                        Worksheets(\"RawData\").Cells(i, 2).Copy\n                        Worksheets(\"NewData\").Activate\n                        Cells(2, m).Activate\n                        ActiveCell.PasteSpecial xlPasteValues\n                End If\n            Else\n                          Worksheets(\"RawData\").Cells(i, 1).Copy\n                        Worksheets(\"NewData\").Activate\n                        Range(\"A1\").Activate\n                        m = ActiveCell.Column\n                        ActiveCell.PasteSpecial xlPasteValues\n                        Worksheets(\"RawData\").Cells(i, 2).Copy\n                        Worksheets(\"NewData\").Activate\n                        Cells(2, m).Activate\n                        ActiveCell.PasteSpecial xlPasteValues\n            End If\n\n\nElse\nWorksheets(\"RawData\").Cells(i, 2).Copy\nWorksheets(\"NewData\").Activate\nSheets(\"NewData\").Range(\"A1:ZZ1\").Find(Sheets(\"RawData\").Cells(i, 1), LookAT:=xlWhole).Activate\nm = ActiveCell.Column\nWorksheets(\"NewData\").Cells(1, m).End(xlDown).Offset(1, 0).Activate\nActiveCell.PasteSpecial xlPasteValues     \nEnd If\n  i = i + 1\n Loop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 1, "creation_date": 1475158340, "post_id": 39763389, "comment_id": 66839708, "body": "Does this account for duplicates? To me it looks like a straight pivot, but I could be incorrect. They wanted to have only unique employees across the top and the the times listed under each employee."}, {"owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1475168979, "post_id": 39763389, "comment_id": 66846568, "body": "I&#39;ve edited the code. Now it will take care of duplicates as well. Thanks for review."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1475171011, "post_id": 39763389, "comment_id": 66847747, "body": "Hate to disagree, but this will leave blank rows occasionally. For example if Employee AA has three times and then you have a time for Employee BB it would get put on row 4 instead of row 1 where it belongs."}, {"owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1475173680, "post_id": 39763389, "comment_id": 66849280, "body": "No.... it will print time of employee BB in row 1. however it will stop if there is any blank row in between in column A. here is the workbook... <a href=\"https://drive.google.com/open?id=0BwkzD11CZOYYUmM2b3lKdy1JNlk\" rel=\"nofollow noreferrer\">drive.google.com/open?id=0BwkzD11CZOYYUmM2b3lKdy1JNlk</a>"}], "tags": [], "owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "is_accepted": false, "score": 2, "last_activity_date": 1475168749, "last_edit_date": 1475168749, "creation_date": 1475132060, "answer_id": 39763389, "question_id": 39757578, "link": "https://stackoverflow.com/questions/39757578/i-need-to-take-2-columns-in-an-excel-sheet-and-convert-them-to-a-data-range-with/39763389#39763389", "title": "I need to take 2 columns in an excel sheet and convert them to a data range with column 1 as the headers", "body": "<p>Check below code, it will help you get desired result.\nCode posted by Emily Alden will work as well. This is shorter way.</p>\n\n<pre><code>Sub test()\nDim raw_data, new_data As Worksheet\nDim new_col_num, data_row_num, i As Long\nDim employee, time As String\nDim rng As Range\n\ndata_row_num = 1\nnew_col_num = 1\n\nSet raw_data = ThisWorkbook.Sheets(\"raw_data\")\nSet new_data = ThisWorkbook.Sheets(\"new_data\")\n\nDo Until raw_data.Cells(data_row_num, 1).Value = \"\"\n\n    employee = raw_data.Cells(data_row_num, 1).Value\n    time = raw_data.Cells(data_row_num, 2).Value\n    new_data.Range(\"A1\").Activate\n    Set rng = new_data.Range(\"A1:XFD1\").Find(what:=employee, LookIn:=xlValues, LookAt:=xlWhole, searchorder:=xlByColumns)\n    If rng Is Nothing Then\n    new_data.Cells(1, new_col_num).Value = employee\n    new_data.Cells(2, new_col_num).Value = time\n\n    new_col_num = new_col_num + 1\n    data_row_num = data_row_num + 1\n\n    Else\n\n    i = new_data.Cells(1, rng.Column).End(xlDown).Row + 1\n    new_data.Cells(i, rng.Column).Value = time\n    data_row_num = data_row_num + 1\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6896134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610249b34a02ed75c3f235548b03eb67?s=128&d=identicon&r=PG&f=1", "display_name": "kdreyer", "link": "https://stackoverflow.com/users/6896134/kdreyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1475168749, "creation_date": 1475096447, "last_edit_date": 1531161705, "question_id": 39757578, "link": "https://stackoverflow.com/questions/39757578/i-need-to-take-2-columns-in-an-excel-sheet-and-convert-them-to-a-data-range-with", "title": "I need to take 2 columns in an excel sheet and convert them to a data range with column 1 as the headers", "body": "<p>I have some data as follows in Excel. They are in 2 columns as a list.  The left column has an employee name and the second column is time/pc.</p>\n\n<pre><code>Employee    Time/pc\nTE  0.616438356\nTE  0.581896552\nFL  0.474040632\nAD  0.473251029\nAD  0.491803279\nTE  0.616438356\nTE  0.652173913\nTE  0.575\nCG  0.744680851\nJU  0.784313725\nJU  0.568181818\nJU  0.709459459\nJU  0.227272727\nAD  0.461956522\nAD  0.555555556\nJU  0.014285714\nJU  0.692307692\n</code></pre>\n\n<p>I need easily convert this to a range where column 1 is used as the headers,  I need this remove the duplicates.  Then it needs to list all the values found beside each name, under each name.</p>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6894517, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/189c9fc33cee60832196541432b93409?s=128&d=identicon&r=PG&f=1", "display_name": "kong1802", "link": "https://stackoverflow.com/users/6894517/kong1802"}, "edited": false, "score": 0, "creation_date": 1475096920, "post_id": 39757555, "comment_id": 66811381, "body": "Worked beautifully!!!  Thank you.  It&#39;s been a long day, and that last part was giving me a headache.  Thanks again!"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 11, "user_id": 6894517, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/189c9fc33cee60832196541432b93409?s=128&d=identicon&r=PG&f=1", "display_name": "kong1802", "link": "https://stackoverflow.com/users/6894517/kong1802"}, "edited": false, "score": 0, "creation_date": 1475096979, "post_id": 39757555, "comment_id": 66811407, "body": "You&#39;re welcome. I understand long days and headaches myself. :)"}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 2, "last_activity_date": 1475096368, "creation_date": 1475096368, "answer_id": 39757555, "question_id": 39757498, "link": "https://stackoverflow.com/questions/39757498/vba-code-but-need-to-keep-rows-with-no-data/39757555#39757555", "title": "VBA Code, but need to keep rows with no data", "body": "<p>I think it should be enough to check for blank spaces and if a cell is blank, do not delete that row. Like this</p>\n\n<pre><code>Sub DeleteRows()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim i As Long\nFor i = Range(\"E\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\n    If (Range(\"E\" &amp; i).Value &gt; -5 And Range(\"E\" &amp; i).Value &lt; 5 and Range(\"E\" &amp; i) &lt;&gt; \"\") Then\n         Range(\"E\" &amp; i).EntireRow.Delete\n    Else\n        If (Range(\"D\" &amp; i).Value &gt; -500 And Range(\"D\" &amp; i).Value &lt; 500 and Range(\"D\" &amp; i) &lt;&gt; \"\") Then\n            Range(\"D\" &amp; i).EntireRow.Delete\n        End If\n    End If\nNext i\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 870, "user_id": 5053667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K5A4V.jpg?s=128&g=1", "display_name": "Darren H", "link": "https://stackoverflow.com/users/5053667/darren-h"}, "edited": false, "score": 0, "creation_date": 1475096623, "post_id": 39757581, "comment_id": 66811213, "body": "It&#39;s a while since I used VBA... why is <code>Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;&quot;</code> better than <code>NOT ISEMPTY(Range(&quot;E&quot; &amp; i).value)</code> ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 870, "user_id": 5053667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K5A4V.jpg?s=128&g=1", "display_name": "Darren H", "link": "https://stackoverflow.com/users/5053667/darren-h"}, "edited": false, "score": 0, "creation_date": 1475097005, "post_id": 39757581, "comment_id": 66811422, "body": "@DarrenH - If a cell is set to an empty string (e.g. simply type a <code>&#39;</code> into a cell, or use a formula such as <code>=&quot;&quot;</code>) then <code>Range(&quot;E&quot; &amp; i).Value &lt;&gt; &quot;&quot;</code> will be True but, because the cell is not empty, <code>ISEMPTY(Range(&quot;E&quot; &amp; i))</code> will be False."}, {"owner": {"reputation": 870, "user_id": 5053667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K5A4V.jpg?s=128&g=1", "display_name": "Darren H", "link": "https://stackoverflow.com/users/5053667/darren-h"}, "edited": false, "score": 0, "creation_date": 1475097977, "post_id": 39757581, "comment_id": 66811886, "body": "In this specific case though, any string (even a ZLS) would fail the <code>value &lt; 5</code> check and so would never even reach the empty check"}], "tags": [], "owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "is_accepted": false, "score": 0, "last_activity_date": 1475096453, "creation_date": 1475096453, "answer_id": 39757581, "question_id": 39757498, "link": "https://stackoverflow.com/questions/39757498/vba-code-but-need-to-keep-rows-with-no-data/39757581#39757581", "title": "VBA Code, but need to keep rows with no data", "body": "<p>Adding another And statement should do the trick for example you can use &lt;> to say Does Not Equal.</p>\n\n<pre><code>If (Range(\"E\" &amp; i).Value &gt; -5 And Range(\"E\" &amp; i).Value &lt; 5) And Range(\"E\" &amp; i).Value &lt;&gt; \"\" Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6894517, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/189c9fc33cee60832196541432b93409?s=128&d=identicon&r=PG&f=1", "display_name": "kong1802", "link": "https://stackoverflow.com/users/6894517/kong1802"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 39757555, "answer_count": 2, "score": 0, "last_activity_date": 1475096453, "creation_date": 1475096166, "question_id": 39757498, "link": "https://stackoverflow.com/questions/39757498/vba-code-but-need-to-keep-rows-with-no-data", "title": "VBA Code, but need to keep rows with no data", "body": "<p>I am using VBA to delete rows that do not meet a certain criteria.  The code is working, however, I can't figure out how to keep the blank rows separating the data.  Below is the code I'm using.  It works well for deleting what I want it to, however, it also is deleting the blank lines in between.    </p>\n\n<pre><code>Sub DeleteRows()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim i As Long\nFor i = Range(\"E\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\n    If (Range(\"E\" &amp; i).Value &gt; -5 And Range(\"E\" &amp; i).Value &lt; 5) Then\n         Range(\"E\" &amp; i).EntireRow.Delete\n    Else\n    If (Range(\"D\" &amp; i).Value &gt; -500 And Range(\"D\" &amp; i).Value &lt; 500) Then\n    Range(\"D\" &amp; i).EntireRow.Delete\n    End If\n    End If\n    Next i\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["image", "vba", "excel", "authentication"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1475096855, "post_id": 39757449, "comment_id": 66811346, "body": "Why the Excel tags, if needed in GoogleSheets?"}, {"owner": {"reputation": 1, "user_id": 6890587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1223904707660727/picture?type=large", "display_name": "Hunter Sagers", "link": "https://stackoverflow.com/users/6890587/hunter-sagers"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475194388, "post_id": 39757449, "comment_id": 66857733, "body": "I guess since Google Sheets and Excel were kind of the same concept, I put the excel tags, I had no idea about the GoogleSheets tag"}], "owner": {"reputation": 1, "user_id": 6890587, "user_type": "registered", "profile_image": "https://graph.facebook.com/1223904707660727/picture?type=large", "display_name": "Hunter Sagers", "link": "https://stackoverflow.com/users/6890587/hunter-sagers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475096778, "creation_date": 1475095950, "last_edit_date": 1475096778, "question_id": 39757449, "link": "https://stackoverflow.com/questions/39757449/how-to-script-a-log-in-system-using-pictures-on-google-sheets", "title": "How to Script a Log in System using Pictures on google sheets", "body": "<p>So I'm in the process of making a Game, but we are in the design phase, so were using Google sheets to organize everything from character models and tilesets, then putting them in the respective drive folders once agreed upon, we are coding soon but I wanted the sheets to have a overall database feel so we don't have to create a new one, so I tried to get a script going so that it does this (Step by Step):</p>\n\n<ol>\n<li>User A logs on</li>\n<li>Google Sheets runs a Auto-Log script</li>\n<li>User A is Tied to Cell A:4</li>\n<li>A:4 will say \"Working\" when User A logs on</li>\n<li>User B has logged on couple minutes after User A, Steps 1-3 Repeat on Cell C:4</li>\n<li>User B hasn't edited the sheet for X minutes, show as \"Away\" on C:4</li>\n<li>User A has Logged off, A:4 will register as \"Offline\"</li>\n</ol>\n\n<p>Problem is Google sheets scripting is a bit too complex for my feeble java script mind to comprehend fully and structure a script cohesively. I have been really stuck on figuring out Googles Scripting system.</p>\n\n<p>Can someone give me a starting point on what to run and maybe I can finish this script?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 1378703, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Kp0Tr.png?s=128&g=1", "display_name": "Amitava", "link": "https://stackoverflow.com/users/1378703/amitava"}, "edited": false, "score": 0, "creation_date": 1475100244, "post_id": 39758033, "comment_id": 66812813, "body": "This worked! But now a new problem started. Even though the Excel Calculation option is set to Automatic, I have to click on &quot;Calculate Now&quot; button to make things work. Is there any command I can include to avoid this?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 301, "user_id": 1378703, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Kp0Tr.png?s=128&g=1", "display_name": "Amitava", "link": "https://stackoverflow.com/users/1378703/amitava"}, "edited": false, "score": 0, "creation_date": 1475100656, "post_id": 39758033, "comment_id": 66812959, "body": "@Amitava - that code should not have interfered with Automatic calculation.  It was happily automatically calculating in my test workbook.  (I just had a simple formula in N45 saying <code>=D49-1</code>, and played with it by entering new values in D49 - and the macro constantly changed D49 back to 1.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1475098412, "creation_date": 1475098412, "answer_id": 39758033, "question_id": 39757359, "link": "https://stackoverflow.com/questions/39757359/goalseek-method-of-range-class-failed/39758033#39758033", "title": "GoalSeek Method of Range class failed", "body": "<p>Because the <code>GoalSeek</code> will force a worksheet calculation, it will fire the <code>Worksheet_Calculate</code> event, which will invoke <code>CheckGoalSeek</code>, which will perform a <code>GoalSeek</code>, which will force a worksheet calculation, which will fire the <code>Worksheet_Calculate</code> event, which will invoke <code>CheckGoalSeek</code>, which will perform a <code>GoalSeek</code>, which will force a worksheet calculation, which will ....</p>\n\n<p>To avoid this circular flow, you need to disable Event processing.</p>\n\n<p>Change your <code>Worksheet_Calculate</code> function to:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Application.EnableEvents = False\n    CheckGoalSeek\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Disclaimer:  The first time I tried this it locked up my copy of Excel.  The second time I tried it it worked.</p>\n"}], "owner": {"reputation": 301, "user_id": 1378703, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Kp0Tr.png?s=128&g=1", "display_name": "Amitava", "link": "https://stackoverflow.com/users/1378703/amitava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 39758033, "answer_count": 1, "score": 0, "last_activity_date": 1475098412, "creation_date": 1475095631, "last_edit_date": 1531161705, "question_id": 39757359, "link": "https://stackoverflow.com/questions/39757359/goalseek-method-of-range-class-failed", "title": "GoalSeek Method of Range class failed", "body": "<p>I am trying to implement the GoalSeek method using a macro which would run automatically whenever there is any change in the worksheet. The code is simple, but getting this error message, which I can not figureout how to solve. The code is:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n   CheckGoalSeek\nEnd Sub\n\nPrivate Sub CheckGoalSeek()\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"MAIN\")\n\n   ws.Range(\"N45\").GoalSeek Goal:=0, ChangingCell:=ws.Range(\"D49\")\n\nEnd Sub\n</code></pre>\n\n<p>where \"N45\" is a formula based cell and \"D49\" is a value. I am getting the runtime error message \"GoalSeek method of Range class failed\".</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1475159939, "post_id": 39758429, "comment_id": 66840852, "body": "#YowE3K, thank you so much for your help. That worked so well! I added an edit in your post only b/c I needed to elaborate a couple of changes I made to the code to further fit my situation, and I didn&#39;t think it was appropriate to put it in my initial post/question. I will mark it as the answer and mark as useful! Thanks, again."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1475166447, "last_edit_date": 1475166447, "creation_date": 1475100431, "answer_id": 39758429, "question_id": 39757001, "link": "https://stackoverflow.com/questions/39757001/shading-row-to-end-of-values-based-on-change-of-value-in-column-c-then-in-column/39758429#39758429", "title": "Shading row to end of values based on change of value in column C then in column B", "body": "<p>The following code has been tailored for your situation:</p>\n\n<pre><code>Sub color()\n    Dim r As Long\n    Dim colourIt As Boolean\n    Dim colour As XlColorIndex\n\n    colourIt = False\n\n    With ActiveSheet\n        r = 2  ' First row of data\n\n        Do While .Cells(r, \"B\").Value &lt;&gt; \"\"\n            'See if value has changed\n            If .Cells(r, \"B\").Value &lt;&gt; .Cells(r - 1, \"B\").Value Or _\n               .Cells(r, \"C\").Value &lt;&gt; .Cells(r - 1, \"C\").Value Then\n                colourIt = Not colourIt\n            End If\n\n            'Determine which colour to use on this row\n            If colourIt Then\n                colour = 15\n            Else\n                colour = xlColorIndexNone\n            End If\n            'Apply the colouring\n            .Range(.Cells(r, \"B\"), .Cells(r, .Cells(r, .Columns.Count).End(xlToLeft).Column)).Interior.ColorIndex = colour\n\n            'Point to the next row of data\n            r = r + 1\n        Loop\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note: The variable <code>colourIt</code> (was <code>colorIt</code>, but I'm Australian, so I'm going to use the English spelling!!) is simply a Boolean variable, which therefore can take the value <code>True</code> or <code>False</code>.  The code is toggling between the two possible values (using the code <code>colourIt = Not colourIt</code>) each time the criteria being tested for changes.</p>\n\n<p><strong>Poster's Edit:</strong> Thank you so much. I just wanted to add here how I changed it to further fit my situation. I changed it as follows: I changed the color to a light orange using the RGB palette (I guess that is what it's called) and I changed   .Range(.Cells(r, \"B\"),etc. to   .Range(.Cells(r, \"A\"), etc. b/c it was highlighting the row beginning at column B vs. starting at column A.</p>\n\n<p>I'm going to post a further thank you in the Comments.</p>\n\n<pre><code> 'Determine which colour to use on this row\n        If colourIt Then\n            colour = RGB(252, 228, 214)\n        Else\n            colour = xlColorIndexNone\n        End If\n        'Apply the colouring\n        .Range(.Cells(r, \"A\"), .Cells(r, .Cells(r, .Columns.Count).End(xlToLeft).Column)).Interior.color = colour\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 39758429, "answer_count": 1, "score": 1, "last_activity_date": 1475166447, "creation_date": 1475094230, "last_edit_date": 1531164843, "question_id": 39757001, "link": "https://stackoverflow.com/questions/39757001/shading-row-to-end-of-values-based-on-change-of-value-in-column-c-then-in-column", "title": "Shading row to end of values based on change of value in column C then in column B", "body": "<p>I don't know VBA well. Ivesleo answered an old post called, 'Shading entire column based on change of value'. <a href=\"https://stackoverflow.com/questions/4146822/excel-shading-entire-row-based-on-change-of-value\">Link to Shade Row Post</a></p>\n\n<p>I used his code and it works but I don't know how to change the code to modify it for what I need.</p>\n\n<ol>\n<li>I have columns of weeks (column B) when we will schedule a project in certain cities (column C). Now the codes highlights the rows for every change in column B or (2nd column/week column). I need the code to note every change in the week within that city, so that when we go to another city, say Piley, it will not highlight the W1N4 for Piley b/c it first noticed that we are in a new city. Kind of like a custom sort with 2 levels, the city first, then the week. I don't want it to highlight based on the change in city, just note that there is a change in city and then highlight within that city based on the change in value in week column.</li>\n<li>How do you just shade row to the end of the data in that row? I tried End(xlRight).Select, End(xlLeft).Select, and End(xlUp).Row.Select but they didn't work.</li>\n<li>Is colorIt something he made up? I don't understand what it does and how Excel knows what to do with it? Again, I'm a beginner. Thank you for your help.   </li>\n</ol>\n\n<blockquote>\n  <p>Week    /    City</p>\n\n<pre><code>W1N1    Silverton\nW1N1    Silverton\nW2N3    Silverton\nW1N4    Silverton\nW1N4    Piley\n</code></pre>\n</blockquote>\n\n<pre><code>    Sub color()\n    'Replace the 2 values of G = and C= by the number of the column containing _\n    'the values being referenced.\n    Dim g As Long\n    Dim c As Integer\n    Dim colorIt As Boolean\n\n    g = 2\n    c = 2\n    colorIt = True\n\n    Do While Cells(g, c) &lt;&gt; \"\"\n        test_value = Cells(g, c)\n        Do While Cells(g, c) = test_value\n            If colorIt Then\n                Cells(g, c).EntireRow.Select\n                Selection.Interior.ColorIndex = 15\n            Else\n                Cells(g, c).EntireRow.Select\n                Selection.Interior.ColorIndex = x1None\n            End If\n            g = g + 1\n        Loop\n        colorIt = Not (colorIt)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "shell", "cmd"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5619709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e8e88f0dca16fff2fdb9db7851fe6f51?s=128&d=identicon&r=PG&f=1", "display_name": "user5619709", "link": "https://stackoverflow.com/users/5619709/user5619709"}, "edited": false, "score": 0, "creation_date": 1475096284, "post_id": 39757178, "comment_id": 66811040, "body": "Worked. Thank you!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1475094912, "creation_date": 1475094912, "answer_id": 39757178, "question_id": 39756875, "link": "https://stackoverflow.com/questions/39756875/shell-command-in-vba-execution/39757178#39757178", "title": "Shell Command in VBA Execution", "body": "<p>Each <code>Shell</code> call runs in its own process, so you can't run separate commands by calling <code>Shell</code> consecutively. Generally, you'd want to either run multiple commands as a batch file or script if you were going to do a lot of processing.  In this case, just specify the full path for <code>copy</code>.  There's no need to change the working directory at all:</p>\n\n<pre><code>Shell \"cmd.exe /k copy C:\\Users\\n808037\\Desktop\\OTHER\\*.csv C:\\Users\\n808037\\Desktop\\OTHER\\merged.csv\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5619709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e8e88f0dca16fff2fdb9db7851fe6f51?s=128&d=identicon&r=PG&f=1", "display_name": "user5619709", "link": "https://stackoverflow.com/users/5619709/user5619709"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2468, "favorite_count": 0, "accepted_answer_id": 39757178, "answer_count": 1, "score": 0, "last_activity_date": 1475094912, "creation_date": 1475093781, "question_id": 39756875, "link": "https://stackoverflow.com/questions/39756875/shell-command-in-vba-execution", "title": "Shell Command in VBA Execution", "body": "<p>I'm trying to run two lines of commands using shell. I haven't been able to find a good source on how to actually execute shell in VBA. So far, I have been able to figure out how to open a specific directory.</p>\n\n<pre><code>Sub shellCMD()\n     Shell (\"cmd.exe /k CD\\Users\\n808037\\Desktop\\OTHER\")\nEnd Sub\n</code></pre>\n\n<p>This will at least lead me to the directory where I need to go. However, now that I've gotten to the directory I need to go, I need to execute a command after. That is</p>\n\n<p><strong>copy *.csv merged.csv</strong></p>\n\n<p>How do I do this in shell? </p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1475107961, "post_id": 39756789, "comment_id": 66814845, "body": "Can&#39;t reproduce your issue. I took your exact code and a PivotTable was generated. Are you sure that line is the problem? Is this part of a larger body of code?"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475159664, "post_id": 39756789, "comment_id": 66840684, "body": "@Parfait - this is the entirety of the module code. I wonder if this requires me to adjust settings within excel&#39;s vba editor?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475161113, "post_id": 39756789, "comment_id": 66841746, "body": "No adjustment needed as all these objects, <i>pvtCache, pvtTable</i> are of the Excel object library. I see <i>ThisWorkbook</i> and <i>ActiveWorkbook</i> assignments. Are you working across multiple workbooks?"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475161524, "post_id": 39756789, "comment_id": 66842054, "body": "@Parfait I am working within the same workbook, but across different sheets. Restarting excel has resulted in dropping the original error, but the pivot table still isn&#39;t being created"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475162152, "post_id": 39756789, "comment_id": 66842483, "body": "@Parfait - I changed my Excel options to read R1C1 headings and restarted excel. This has solved the issue. Thank you for all your help!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475162524, "post_id": 39756789, "comment_id": 66842724, "body": "Interesting. I do not have such R1C1 headings set in options and still code worked for me. What is your OS? Office version? Also, consider answering your own question for future readers."}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475169518, "post_id": 39756789, "comment_id": 66846875, "body": "@Parfait I have Excel 2013. I will update to have my own answer, but I am not sure if changing my settings was the &quot;solution&quot;. The sub module seems to run indefinitely which mean I can only run it once - If I have to rerun the Sub then I have to close and reopen the excel sheet."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475180263, "post_id": 39756789, "comment_id": 66852791, "body": "Look into <a href=\"https://support.office.com/en-us/article/Repair-an-Office-application-7821d4b6-7c1d-4205-aa0e-a6b40c5bb88b\" rel=\"nofollow noreferrer\">repairing your Office installation</a>."}], "answers": [{"tags": [], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "is_accepted": false, "score": 0, "last_activity_date": 1475175745, "creation_date": 1475175745, "answer_id": 39778098, "question_id": 39756789, "link": "https://stackoverflow.com/questions/39756789/createpivottable-error-application-defined-or-object-defined-error/39778098#39778098", "title": "CreatePivotTable() error - Application-defined or Object-defined error", "body": "<p>Answering my own question:</p>\n\n<p>@Parfait was correct, the code has no bugs. However, the macro still showed signs of freezing during the caching phase. In order to fix this error, I added the following code to the beginning of the code base. </p>\n\n<pre><code>'Delete previous pivottable\nWorksheets(\"PIVOT\").PivotTables(\"PivotTable1\").TableRange2.Clear\n</code></pre>\n\n<p>This code removes any pre-existing pivot table in preparation for a new table. </p>\n"}], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1371, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475175745, "creation_date": 1475093406, "question_id": 39756789, "link": "https://stackoverflow.com/questions/39756789/createpivottable-error-application-defined-or-object-defined-error", "title": "CreatePivotTable() error - Application-defined or Object-defined error", "body": "<p><strong>OBJECTIVE</strong></p>\n\n<p>Create pivot table based on a dynamic range of information.</p>\n\n<p><strong>APPROACH</strong></p>\n\n<ol>\n<li>Identify and Activate sheet (<code>ws</code>) that contains source data (<code>srcData</code>, <code>lastRow</code>) for pivot table</li>\n<li>Identify <code>target</code> sheet where new pivot table (<code>pvt</code>) will be displayed</li>\n<li>Highlight and record source data (<code>srcData</code>)</li>\n<li>Create pivot cache (<code>pvtCache</code>)</li>\n<li>Place pivot table (<code>startPvt</code>) on worksheet &amp; cell</li>\n</ol>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>Sub createPivot()\n\nDim ws As Worksheet\nDim pvtCache As pivotCache\nDim pvt As pivotTable\nDim srcData As String\nDim lastRow As Long\nDim startPvt As String\nDim target As Worksheet\n\n'Select pivot table data\nWorksheets(\"CONSOLIDATED\").Activate\nSet ws = ActiveSheet\nlastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nsrcData = ActiveSheet.Name &amp; \"!\" &amp; Range(\"A1:H\" &amp; lastRow).Address(ReferenceStyle:=xlR1C1)\n\n'Set pivot table location\nSet target = ThisWorkbook.Worksheets(\"PIVOT\")\nstartPvt = target.Name &amp; \"!\" &amp; target.Range(\"A1\").Address(ReferenceStyle:=xlR1C1)\n\n'Create pivot cache\nSet pvtCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=srcData)\n\nSet pvt = pvtCache.CreatePivotTable( _\n    TableDestination:=startPvt, _\n    TableName:=\"PivotTable1\")\n\nEnd Sub\n</code></pre>\n\n<p><em>inspired by: <a href=\"http://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables\" rel=\"nofollow\">http://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables</a></em></p>\n\n<p><strong>ISSUES</strong></p>\n\n<blockquote>\n  <p>Run-time error '1004': Application-defined or object-defined error</p>\n</blockquote>\n\n<p>@ line:</p>\n\n<pre><code>Set pvt = pvtCache.CreatePivotTable( _\n    TableDestination:=startPvt, _\n    TableName:=\"PivotTable1\")\n</code></pre>\n\n<p><strong>QUESTIONS</strong></p>\n\n<ol>\n<li>Am I going crazy? I've proofread this code multiple times and cannot understand where I am going wrong. At this point, I am at a loss. Any help is appreciated with an explanation on why the error has occurred. </li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "edited": false, "score": 0, "creation_date": 1475093373, "post_id": 39756729, "comment_id": 66809393, "body": "Cool, this would work. My brain is not letting me think of another way, so this might have to be it. Why lastCol - 1? Yeah, I will definitely have multiple duplicate values, i would need to add a counter to each one somehow, i.e. OLD 1, OLD 2, etc.."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "edited": false, "score": 0, "creation_date": 1475093655, "post_id": 39756729, "comment_id": 66809524, "body": "The reason for that is because you comparing what is in <code>i</code> with what is in <code>i+1</code>. I just edited to start the <code>j</code> loop from that spot. I keep improving the code as I think about it. :)"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "edited": false, "score": 0, "creation_date": 1475093772, "post_id": 39756729, "comment_id": 66809590, "body": "I edited my answer to handle the multiple duplicates."}, {"owner": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "edited": false, "score": 0, "creation_date": 1475094015, "post_id": 39756729, "comment_id": 66809723, "body": "Bam, nice! This makes sense, thanks. I somehow could not think of looping twice today"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "edited": false, "score": 0, "creation_date": 1475094055, "post_id": 39756729, "comment_id": 66809746, "body": "Glad I could help."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 1, "last_activity_date": 1475093887, "last_edit_date": 1475093887, "creation_date": 1475093190, "answer_id": 39756729, "question_id": 39756679, "link": "https://stackoverflow.com/questions/39756679/dynamically-check-if-cell-values-exist-more-than-once/39756729#39756729", "title": "Dynamically check if cell values exist more than once", "body": "<p>Might not be the best approach, but you could loop through the list twice and compare. If you have a lot of headers, this may be slow.</p>\n\n<pre><code>For i = 1 to lastCol - 1\n    numDuplicates = 0\n    for j = i + 1 to lastCol\n        if ws.Cells(1,i) = ws.Cells(1,j) then\n            numDuplicates = numDuplicates + 1\n            ws.Cells(1,j) = ws.Cells(1,j) &amp; \" \" &amp; numDuplicates\n        end if\n    next j\nnext i\n</code></pre>\n\n<p>Something like that? This retains the original header and then marks the duplicates with a 1, 2, ...</p>\n"}], "owner": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 39756729, "answer_count": 1, "score": 0, "last_activity_date": 1475093887, "creation_date": 1475092970, "question_id": 39756679, "link": "https://stackoverflow.com/questions/39756679/dynamically-check-if-cell-values-exist-more-than-once", "title": "Dynamically check if cell values exist more than once", "body": "<p>I have a row of data with headers, and the same headers can appear <code>n</code> number of times. I need to loop over the headers in VBA, check if each one exists more than once in the whole row, and if so, add a string at the end of each one. </p>\n\n<pre><code>HEADER 1 HEADER 2 HEADER 3 HEADER 1 HEADER 2 HEADER 3\n</code></pre>\n\n<p>and the result should be after looping (something like:</p>\n\n<pre><code>HEADER 1 OLD HEADER 2 OLD HEADER 3 OLD HEADER 1 NEW HEADER 2 NEW HEADER 3 NEW\n</code></pre>\n\n<p>I know i need to loop over the cells, but then the logic escapes me</p>\n\n<pre><code>For i = 1 to lastCol\n    If ws.Cells(1, i).Value = \"HEADER 1\" Then\n         headerCount = headerCount + 1\n    End if\nNext i\n</code></pre>\n\n<p>The logic after the for loop escapes me</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475092139, "post_id": 39756385, "comment_id": 66808694, "body": "So just sounds like your script has to paste from the source workbook to the target workbook before closing the first. This is not a problem even without specifying the workbook name if you set it as a workbook variable. Please provide the code you have developed so far for further assistance."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475093502, "post_id": 39756385, "comment_id": 66809449, "body": "<code>Sub CopyData()  Application.DisplayAlerts = False Workbooks.Open filename:=&quot;source.xlsx&quot;, _ UpdateLinks:=3 Range(&quot;A1:X105&quot;).Select Selection.Copy ActiveWindow.Close Sheets(&quot;Temp&quot;).Select ActiveSheet.Paste Application.DisplayAlerts = True End Sub</code>"}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475093889, "post_id": 39756385, "comment_id": 66809649, "body": "Sorry. I don&#39;t know how to do pre-formatted text in the comment."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475094244, "post_id": 39756385, "comment_id": 66809861, "body": "@Robby you have to put code in the question. ANything more than small one-liners can&#39;t render in the comments."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475094301, "post_id": 39756385, "comment_id": 66809902, "body": "<i>so the VBA code can&#39;t refer to a workbook filename for the target.</i> maybe not, but it <i>can</i> most definitely open a <code>FileDialog</code> prompt and programmatically <i>open</i> the workbooks in question... :)"}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1475094723, "post_id": 39756385, "comment_id": 66810173, "body": "Well, by &quot;can&#39;t&quot; I meant &quot;I&#39;d rather it not.&quot; :) The code I gave works exactly like I want it to except it doesn&#39;t retain the conditional formatting.  How do I set the target workbook as a variable?"}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475098238, "post_id": 39756554, "comment_id": 66811991, "body": "I don&#39;t think you can close the source before you paste as the clipboard only stores a link to the excel file and not the data in itself. Regards,"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1475098397, "post_id": 39756554, "comment_id": 66812066, "body": "Whoops. You&#39;re right. I meant to flip the order, but your answer is more concise so I&#39;ll leave this as is."}], "tags": [], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "is_accepted": false, "score": 0, "last_activity_date": 1475097736, "last_edit_date": 1495535560, "creation_date": 1475092533, "answer_id": 39756554, "question_id": 39756385, "link": "https://stackoverflow.com/questions/39756385/excel-copy-from-another-workbook-with-conditional-formatting-intact/39756554#39756554", "title": "Excel - copy from another workbook with conditional formatting intact", "body": "<p>Based on new information:</p>\n\n<pre><code>Sub CopyData() \nApplication.DisplayAlerts = False \nWorkbooks.Open filename:=\"source.xlsx\", _ \nUpdateLinks:=3 \nRange(\"A1:X105\").Select \nSelection.Copy \nActiveWindow.Close \nSheets(\"Temp\").Select \nActiveSheet.PasteSpecial xlPasteFormats\nApplication.DisplayAlerts = True \nEnd Sub\n</code></pre>\n\n<p>Previous:\nFrom:<a href=\"https://stackoverflow.com/questions/28388350/copy-conditional-formatting-from-one-cell-to-another-using-vba\">Copy conditional formatting from one cell to another using VBA?</a></p>\n\n<pre><code>Sub test()\n     Sheets(\"B\").[B1].Copy: Sheets(\"A\").[A1:A10].PasteSpecial xlPasteFormats\nEnd Sub\n</code></pre>\n\n<p>Is a code that will paste the conditional formatting. </p>\n\n<p>Mostly what you need to do is change the order:</p>\n\n<ol>\n<li><p>Open Source using a Prompt for the User to select file</p></li>\n<li><p>Copy Range from Source</p></li>\n<li>Paste Range to Original</li>\n<li>Close Source</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1475152893, "post_id": 39757986, "comment_id": 66835564, "body": "Awesome. This does exactly what I want. Thanks.  The paste part works because I have code before this that creates a new workbook and focuses on A1. So when the source.xlsx is closed and target.xlsx is made active, it&#39;s always going to be on A1."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1475168709, "post_id": 39757986, "comment_id": 66846424, "body": "Sorry. I don&#39;t know how it was working before, but it&#39;s not now. After A1:X105 is copied on source.xlsx, it&#39;s not going back to the target spreadsheet to paste before it closes. I think the &quot;ThisWorkbook.ActiveSheet.Paste&quot; is wrong."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1475169199, "post_id": 39757986, "comment_id": 66846671, "body": "Try <code>ThisWorkbook.ActiveSheet.Selection.Paste</code>. As you stated that it should be on A1, probably just missing stating what range to paste to and <code>.Selection</code> should do the trick for that."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 2, "last_activity_date": 1475175891, "last_edit_date": 1475175891, "creation_date": 1475098185, "answer_id": 39757986, "question_id": 39756385, "link": "https://stackoverflow.com/questions/39756385/excel-copy-from-another-workbook-with-conditional-formatting-intact/39757986#39757986", "title": "Excel - copy from another workbook with conditional formatting intact", "body": "<p>You can just dim the workbook and then copy and paste. After you have completed that you can then using the variable, close the workbook. Code would be as follows:</p>\n\n<pre><code>Sub CopyData()\n    Application.DisplayAlerts = False\n    Dim wbSource As Workbook\n    Set wbSource = Workbooks.Open(Filename:=\"source.xlsx\", UpdateLinks:=3)\n    wbSource.Sheets(1).Range(\"A1:X105\").Copy\n    ThisWorkbook.ActiveSheet.Selection.Paste\n    wbSource.Close\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I don't see how you determine what range you paste on the target workbook but will leave that for another question. The answer by Emily Alden I don't think will work because you can't copy from a source that is closed. Clipboard behaves differently with Excel than with other applications.</p>\n"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478540662, "creation_date": 1475091878, "last_edit_date": 1478540662, "question_id": 39756385, "link": "https://stackoverflow.com/questions/39756385/excel-copy-from-another-workbook-with-conditional-formatting-intact", "title": "Excel - copy from another workbook with conditional formatting intact", "body": "<p>I've figured out most of this myself, but the part that is hanging me up is being able to paste the conditional formatting.</p>\n\n<p>I want to be able to have a workbook open, run a VBA script to open another workbook, copy a range from it, then paste that to the original workbook.</p>\n\n<p>The most success I've had is recording the macro and make this happen:\nWith the original, target workbook open...</p>\n\n<ol>\n<li>Open the source workbook</li>\n<li>Copy range A1:X105</li>\n<li>Close source workbook</li>\n<li>Paste into worksheet titled \"Temp\" in target workbook</li>\n</ol>\n\n<p>The problem is that the source workbook contains conditional formatting, and if the source workbook is closed before you paste into the target workbook, the conditional formatting isn't being pasted.</p>\n\n<p>So either I need to find a way to paste the data with the conditional formatting, or I need to be able to switch back to the target workbook before closing the source workbook. This is a process that is going to need to be ran multiple times with different target workbooks, so the VBA code can't refer to a workbook filename for the target. The source workbook will always have the same path though.</p>\n\n<p>Searching the site, I could only find solutions that specified the path for both workbooks.</p>\n\n<p>This is what I have right now:</p>\n\n<pre><code>Sub CopyData() \nApplication.DisplayAlerts = False \nWorkbooks.Open filename:=\"source.xlsx\", _ \nUpdateLinks:=3 \nRange(\"A1:X105\").Select \nSelection.Copy \nActiveWindow.Close \nSheets(\"Temp\").Select \nActiveSheet.Paste \nApplication.DisplayAlerts = True \nEnd Sub\n</code></pre>\n\n<p>I suppose what I need to implement into this is to declare the target workbook as a variable. Can someone help with that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475095073, "post_id": 39756259, "comment_id": 66810380, "body": "Your &#39;VBA or macro knowledge&#39; does not only appears to be &#39;very basic&#39;; in fact, it appears non-existent."}, {"owner": {"reputation": 1, "user_id": 6895868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c2346d9de169c6c3b78c0b6bf53a65?s=128&d=identicon&r=PG&f=1", "display_name": "vungvang", "link": "https://stackoverflow.com/users/6895868/vungvang"}, "edited": false, "score": 0, "creation_date": 1475095426, "post_id": 39756259, "comment_id": 66810592, "body": "Well, that&#39;s right. Any suggestion or direction will be highly appreciated. Anyway I can improve my question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475095735, "post_id": 39756259, "comment_id": 66810762, "body": "I Voted-To-Close your question because you are asking for code and not supplying any. This is not a place to get free code that you are too lazy or incapable to write. To improve your question: <b>WRITE CODE AND INCLUDE IT IN YOUR QUESTION ALONG WITH A DESCRIPTION OF ANY ERROR OR PROBLEM</b> (<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>)."}, {"owner": {"reputation": 1, "user_id": 6895868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c2346d9de169c6c3b78c0b6bf53a65?s=128&d=identicon&r=PG&f=1", "display_name": "vungvang", "link": "https://stackoverflow.com/users/6895868/vungvang"}, "edited": false, "score": 0, "creation_date": 1475096422, "post_id": 39756259, "comment_id": 66811107, "body": "Got it and really sorry to waste yours time. I&#39;m incapable but not lazy. I have tried to search last few days here and google. All the suggestions are based on column not based on rows. Anyway thanks and sorry again."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475096742, "post_id": 39756259, "comment_id": 66811279, "body": "Sort each row, one at a time, from left to right.  Record a macro while you do that; then clean up the macro."}, {"owner": {"reputation": 1, "user_id": 6895868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c2346d9de169c6c3b78c0b6bf53a65?s=128&d=identicon&r=PG&f=1", "display_name": "vungvang", "link": "https://stackoverflow.com/users/6895868/vungvang"}, "edited": false, "score": 0, "creation_date": 1475130272, "post_id": 39756259, "comment_id": 66820736, "body": "@ Ron.   Thanks for your suggestion. Will work on it. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6895868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c2346d9de169c6c3b78c0b6bf53a65?s=128&d=identicon&r=PG&f=1", "display_name": "vungvang", "link": "https://stackoverflow.com/users/6895868/vungvang"}, "edited": false, "score": 0, "creation_date": 1475130091, "post_id": 39761688, "comment_id": 66820642, "body": "Thanks a lot for your continuous support. For sure I will start here and will update. Thanks again."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1475151718, "last_edit_date": 1475151718, "creation_date": 1475124892, "answer_id": 39761688, "question_id": 39756259, "link": "https://stackoverflow.com/questions/39756259/rearrange-row-data-based-on-cells-values-automatically/39761688#39761688", "title": "Rearrange Row data based on cells values automatically", "body": "<p>If you are having a hard time finding a place to start, you could try this <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow\">Worksheet_Change</a> event macro for Sheet1.</p>\n\n<pre><code>Option Explicit\n\nPrivate dALL As Double\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Application.Sum(Target.Parent.UsedRange.Cells) &lt;&gt; dALL Then\n        dALL = Application.Sum(Target.Parent.UsedRange.Cells)\n        On Error GoTo bm_Safe_Exit\n        'suspend events so nothing on Sheet2 gets triggered\n        Application.EnableEvents = False\n        Dim a As Long, i As Long, j As Long, aVALs As Variant\n        aVALs = Target.Parent.UsedRange.Cells.Value2\n        For i = LBound(aVALs, 1) To UBound(aVALs, 1)\n            For j = LBound(aVALs, 2) To UBound(aVALs, 2) - 1\n                If Not CBool(Len(aVALs(i, j))) Then\n                    For a = j + 1 To UBound(aVALs, 2)\n                        If CBool(Len(aVALs(i, a))) Then\n                            aVALs(i, j) = aVALs(i, a)\n                            aVALs(i, a) = vbNullString\n                            Exit For\n                        End If\n                    Next a\n                End If\n            Next j\n        Next i\n        With ThisWorkbook.Worksheets(\"Sheet2\")\n            .UsedRange.Clear\n            .Cells(1, 1).Resize(UBound(aVALs, 1), UBound(aVALs, 2)) = aVALs\n        End With\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6895868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c2346d9de169c6c3b78c0b6bf53a65?s=128&d=identicon&r=PG&f=1", "display_name": "vungvang", "link": "https://stackoverflow.com/users/6895868/vungvang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 722, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1475151718, "creation_date": 1475091521, "question_id": 39756259, "link": "https://stackoverflow.com/questions/39756259/rearrange-row-data-based-on-cells-values-automatically", "title": "Rearrange Row data based on cells values automatically", "body": "<p>Sheet1 Have 90 columns and 288 rows. Some cells of each row have value and some are blank (containing formula). I want to rearrange each row data in Sheet2 as value contain cells come to left and blank goes to right. I don\u2019t want to remove the blank cells so, if a row doesn\u2019t have any data will not got removed. Row order is very important in my case. \nSheet1 got updated each 5 minutes, if there is any possibility to update Sheet2 each 5 minute that will be really great.\nExample: \n Sheet1\n<a href=\"http://i.stack.imgur.com/zk18X.png\" rel=\"nofollow\">Sheet1</a></p>\n\n<p>Sheet2<a href=\"http://i.stack.imgur.com/DF68G.png\" rel=\"nofollow\">Sheet2</a></p>\n\n<p>NB: My VBA or Macro knowledge is very basic. If I\u2019m not asking too much, explanation to apply the solutions will be great.\nUsing office 365 latest version</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6882455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd0b0177a9760ea1bfb351ba3248061?s=128&d=identicon&r=PG&f=1", "display_name": "biz", "link": "https://stackoverflow.com/users/6882455/biz"}, "edited": false, "score": 0, "creation_date": 1475096636, "post_id": 39757534, "comment_id": 66811217, "body": "thanks for your help  .. i tried it but got error .. trying to fix if got luck .. anyways thanks for your help"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 29, "user_id": 6882455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd0b0177a9760ea1bfb351ba3248061?s=128&d=identicon&r=PG&f=1", "display_name": "biz", "link": "https://stackoverflow.com/users/6882455/biz"}, "edited": false, "score": 0, "creation_date": 1475096657, "post_id": 39757534, "comment_id": 66811236, "body": "Drat. I&#39;ll work on it too. Also could you ever have the same SKU going to multiple customers? I didn&#39;t include that in the checking for duplicates aspect. (It&#39;s literally just looking for duplicate SKU numbers.)"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 29, "user_id": 6882455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd0b0177a9760ea1bfb351ba3248061?s=128&d=identicon&r=PG&f=1", "display_name": "biz", "link": "https://stackoverflow.com/users/6882455/biz"}, "edited": false, "score": 0, "creation_date": 1475097115, "post_id": 39757534, "comment_id": 66811475, "body": "Try the new code. (Still doesn&#39;t check for customers or anything, but should run correctly.)"}], "tags": [], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "is_accepted": false, "score": 3, "last_activity_date": 1475097067, "last_edit_date": 1475097067, "creation_date": 1475096295, "answer_id": 39757534, "question_id": 39755828, "link": "https://stackoverflow.com/questions/39755828/get-values-from-othersheet-to-other-based-on-conditions-in-excel/39757534#39757534", "title": "Get values from othersheet to other based on conditions in excel", "body": "<p>Note: I'm very new to VBA myself so this is messy, but should work. </p>\n\n<p>Let RawData be the first sheet you mentioned with the full list with duplicates and let NewData be the second sheet with the \"R\"'s removed if a \"D\" exists. </p>\n\n<pre><code>Option Explicit\n\nSub RemoveDuplicates()\nDim i As Integer\ni = 3\nWorksheets(\"RawData\").Activate\nRange(\"A1:E2\").Copy\nWorksheets(\"NewData\").Activate\nRange(\"A1\").Activate\n        ActiveCell.PasteSpecial Paste:=xlPasteValues\n\nDo While Sheets(\"RawData\").Cells(i, 1).Value &lt;&gt; \"\"\nIf Sheets(\"NewData\").Range(\"A:A\").Find(Sheets(\"RawData\").Cells(i, 1),         LookAT:=xlWhole) Is Nothing Then\nWorksheets(\"RawData\").Activate\nRange(Cells(i, 1), Cells(i, 5)).Copy\nWorksheets(\"NewData\").Activate\n        Range(\"A1\").End(xlDown).Offset(1, 0).Activate\n        ActiveCell.PasteSpecial Paste:=xlPasteValues\nElse\n    Worksheets(\"RawData\").Activate\nRange(Cells(i, 1), Cells(i, 5)).Copy\nWorksheets(\"NewData\").Activate\nSheets(\"NewData\").Range(\"A:A\").Find(Sheets(\"RawData\").Cells(i, 1),     LookAT:=xlWhole).Activate\n        ActiveCell.PasteSpecial Paste:=xlPasteValues\n  End If\n\n  i=i+1\n  Loop\n</code></pre>\n\n<p>So what it does is check whether the item already exists in the list. If it does then it overwrites it with the new data. </p>\n"}, {"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 2, "last_activity_date": 1475116786, "creation_date": 1475116786, "answer_id": 39760518, "question_id": 39755828, "link": "https://stackoverflow.com/questions/39755828/get-values-from-othersheet-to-other-based-on-conditions-in-excel/39760518#39760518", "title": "Get values from othersheet to other based on conditions in excel", "body": "<p>It sounds to me like you want to make use of the Dictionary class.  This is packaged with VBA but isn't enabled by default -- you need to add it by adding a reference (Tools->References) to \"Microsoft Scripting Runtime.\"</p>\n\n<p>The Dictionary lets you store key-value pairs.  I am assuming by your sample data that an \"ORDER ID\" constitutes a unique \"record.\"  If that's the case, this should work -- if not, just change the key to whatever defines a distinct record.</p>\n\n<p>This code doesn't handle formatting, but you could easily manage that.  This just shows you how to update values on old rows when new records appear.</p>\n\n<pre><code>Sub CopySheet()\n  Dim rw As Range\n  Dim findRow, newRow As Integer\n  Dim ws1, ws2 As Worksheet\n  Dim data As New Scripting.Dictionary\n  Dim status, orderId As String\n\n  Set ws1 = Sheets(\"Sheet1\")\n  Set ws2 = Sheets(\"Sheet2\")\n  newRow = 1\n\n  For Each rw In ws1.Rows\n    If ws1.Cells(rw.row, 1).Value2 = \"\" Then\n      Exit For\n    End If\n\n    orderId = ws1.Cells(rw.row, 2).Value2\n    status = ws1.Cells(rw.row, 5).Value2\n\n    If data.Exists(orderId) Then\n      findRow = data(orderId)   ' found it -- replace existing\n      If status &lt;&gt; \"R\" Then     ' if it's not \"R\", don't overwrite\n        findRow = 0\n      End If\n    Else\n      findRow = newRow          ' never seen this order before\n      data.Add orderId, findRow ' add it to the dictionary\n      newRow = newRow + 1       ' add record on a new line\n    End If\n\n    If findRow &gt; 0 Then\n      ws2.Range(\"A\" &amp; findRow &amp; \":E\" &amp; findRow).Value = _\n          ws1.Range(\"A\" &amp; rw.row &amp; \":E\" &amp; rw.row).Value\n    End If\n  Next rw\nEnd Sub\n</code></pre>\n\n<p>Dictionaries are VERY efficient.  This means if you have huge lists they don't suffer from the typical Excel performance lags like you do with a vlookup.</p>\n"}, {"tags": [], "owner": {"reputation": 1064, "user_id": 6887294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOIuR.jpg?s=128&g=1", "display_name": "Aditya Pansare", "link": "https://stackoverflow.com/users/6887294/aditya-pansare"}, "is_accepted": true, "score": 2, "last_activity_date": 1475136180, "creation_date": 1475136180, "answer_id": 39764651, "question_id": 39755828, "link": "https://stackoverflow.com/questions/39755828/get-values-from-othersheet-to-other-based-on-conditions-in-excel/39764651#39764651", "title": "Get values from othersheet to other based on conditions in excel", "body": "<p>Sorting and removing duplicates may help you.</p>\n\n<p>rename sheet where you have data as \"raw_data\" and create new blank sheet in the same workbook named as \"new_data\". In sheet new_data\" you will get the result.</p>\n\n<p>Try below code</p>\n\n<pre><code>Sub copy_sheet()\n\nDim raw_data, new_data As Worksheet\n\nSet raw_data = ThisWorkbook.Sheets(\"raw_data\")\nSet new_data = ThisWorkbook.Sheets(\"new_data\")\n\nraw_data.Activate\nRange(\"A1:E1\").Select\nRange(Selection, Selection.End(xlDown)).Copy\nnew_data.Activate\nRange(\"A1\").PasteSpecial xlPasteValues\nRange(\"A1\").Sort key1:=Range(\"E1\"), order1:=xlDescending, Header:=xlYes\nRange(\"A1:E1\").Select\nRange(Selection, Selection.End(xlDown)).RemoveDuplicates Columns:=Array(1, 2, 3), Header:=xlYes\nRange(\"A1\").Sort key1:=Range(\"E1\"), order1:=xlAscending, Header:=xlYes\nRange(\"A1\").Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6882455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd0b0177a9760ea1bfb351ba3248061?s=128&d=identicon&r=PG&f=1", "display_name": "biz", "link": "https://stackoverflow.com/users/6882455/biz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 39764651, "answer_count": 3, "score": 2, "last_activity_date": 1475136180, "creation_date": 1475089914, "last_edit_date": 1475092204, "question_id": 39755828, "link": "https://stackoverflow.com/questions/39755828/get-values-from-othersheet-to-other-based-on-conditions-in-excel", "title": "Get values from othersheet to other based on conditions in excel", "body": "<p>I have sheet with data, i want to get data in other sheet but with conditions.For ex:</p>\n\n<pre><code>-------------------------------------------------\n| Cell A   | Cell B |  Cell C    | Cell D|Cell E |        \n|------------------------------------------------|\n| Sku      |Order_ID|Customer_ID | Price |Status | \n|------------------------------------------------|\n| TW22     |   123  |    1       |221    |   D   |\n|------------------------------------------------|\n| TS44     |  124   |     2      |221    |   D   |\n|------------------------------------------------|\n| Ts11-ab  |   33   |     3      |211    |   D   |\n|------------------------------------------------|\n| Ts11     |   231  |     4      |231    |   D   |\n|------------------------------------------------|\n| Ts11-ab  |   33   |     3      |211    |   R   |\n|------------------------------------------------|\n| Ts11     |   231  |     4      |231    |   R   |\n|------------------------------------------------|\n</code></pre>\n\n<p>I have data in sheet as above in ex:, Now i want values like bellow in my other sheet ex:</p>\n\n<pre><code>-------------------------------------------------\n| Cell A   | Cell B |  Cell C    | Cell D|Cell E |        \n|------------------------------------------------|\n| Sku      |Order_ID|Customer_ID | Price |Status | \n|------------------------------------------------|\n| TW22     |   123  |    1       |221    |   D   |\n|------------------------------------------------|\n| TS44     |  124   |     2      |221    |   D   |\n|------------------------------------------------|\n| Ts11-ab  |   33   |     3      |211    |   R   |\n|------------------------------------------------|\n| Ts11     |   231  |     4      |231    |   R   |\n|------------------------------------------------|\n</code></pre>\n\n<p>I have tried vlookup and other formulas find from net but not helpful as i need.</p>\n\n<p>update : If an order ID has two records in Sheet 1 with status \u201cD\u201d and \u201cR\u201d, it should show entry with just status \u201cR\u201d in the Sheet 2.And if there is only one record with status \u201cD\u201d, then it should show that record in the sheet 2. thanks</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475090641, "post_id": 39755639, "comment_id": 66807913, "body": "If there are random columns add column letters or indices are irrelevant.  Does the data have a header row?  Are there values that you can search for to identify columns?"}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1475154193, "post_id": 39755639, "comment_id": 66836540, "body": "Yes. Headers of the data are on row A3."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1475093331, "post_id": 39756066, "comment_id": 66809371, "body": "@DavidZemens - I&#39;ve decided to stop even suggesting late binding the Scripting Runtime. There is no benefit to doing so other than the convenience of not having to explain to askers how to add the reference."}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1475154896, "post_id": 39756066, "comment_id": 66837052, "body": "I&#39;ve tried this and I guess the good news is that the macro doesn&#39;t return any error. But it doesn&#39;t do anything either. When going through step by step, it loops through the [c] loop for a while, and when it gets out, goes from [For i = 2] ... line to end sub. Doesn&#39;t run through the [i] loop. What am I missing?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1475155236, "post_id": 39756066, "comment_id": 66837318, "body": "@Pomul - Hard to tell without seeing it, but I&#39;m guessing there is something wrong with the <code>lastrow</code> calculation."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1475156853, "post_id": 39756066, "comment_id": 66838559, "body": "@Pomul - <code>headers.Item()</code> is going to be a number, so you can&#39;t concat it into a cell address.  It should be <code>lastrow = Cells(Rows.Count, headers.Item(&quot;Survey: Interest to Participate&quot;)).End(xlUp).Row</code>"}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1475161541, "post_id": 39756066, "comment_id": 66842071, "body": "@ Comintern - Works like a charm! Thanks"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 4, "last_activity_date": 1475093132, "last_edit_date": 1475093132, "creation_date": 1475090845, "answer_id": 39756066, "question_id": 39755639, "link": "https://stackoverflow.com/questions/39755639/vba-excel-look-for-column-names-return-their-number-and-use-column-letters-in-f/39756066#39756066", "title": "VBA-Excel Look for column names, return their number and use column letters in function", "body": "<p>The way I'd go about this would be to create a <code>Dictionary</code> with header names as keys and column numbers as values:</p>\n\n<pre><code>Dim headers As Dictionary\nSet headers = New Scripting.Dictionary\n\nDim c As Long\n'Assuming headers are in row 1 for sake of example...\nFor c = 1 To Cells(1, Columns.Count).End(xlToLeft).Column\n    headers.Add Cells(1, c).Value, c\nNext\n</code></pre>\n\n<p>Then, instead of using hard-code column letters with the <code>Range</code>, use the <code>Cells</code> collection and index it by column number using the <code>Dictionary</code> to look it up based on the header.  For example, if your code expects column \"U\" to be under that header \"Role\" here:</p>\n\n<pre><code>Range(\"U\" &amp; i).Value = \"C-MEM\"\n</code></pre>\n\n<p>You can replace it with a column lookup like this using the <code>Dictionary</code> like this:</p>\n\n<pre><code>Cells(i, headers.Item(\"Role\")).Value = \"C-MEM\"\n</code></pre>\n\n<p>Note that this requires a reference to the Microsoft Scripting Runtime (Tools->References... then check the box).</p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1475091116, "post_id": 39756120, "comment_id": 66808136, "body": "Merely the suggestion to lock the sheet is worth the up-vote."}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1475154163, "post_id": 39756120, "comment_id": 66836515, "body": "If I could lock the sheet I defindetly would! But then, the static marco I already have would work as charm and wouldn&#39;t need to look by column headers..."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1475156967, "last_edit_date": 1475156967, "creation_date": 1475091027, "answer_id": 39756120, "question_id": 39755639, "link": "https://stackoverflow.com/questions/39755639/vba-excel-look-for-column-names-return-their-number-and-use-column-letters-in-f/39756120#39756120", "title": "VBA-Excel Look for column names, return their number and use column letters in function", "body": "<blockquote>\n  <p>But this is a shared workbook, so people are adding columns randomly and every time I need to go back to the code and modify the columns refereces. </p>\n</blockquote>\n\n<p>Protect the workbook to prevent this undesired behavior?</p>\n\n<p>I would personally prefer to use Named Ranges, which will adjust with insertions and re-sorting of the data columns.</p>\n\n<p>From Formulas ribbon, define a new name:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yewUl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yewUl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, confirm that you can move, insert, etc., with a simple procedure like:</p>\n\n<pre><code>Const ROLE As String = \"Role\"\nSub foo()\n\nDim rng As Range\n\nSet rng = Range(ROLE)\n\n' This will display $B$1\nMsgBox rng.Address, vbInformation, ROLE &amp; \" located:\"\n\nrng.Offset(0, -1).Insert Shift:=xlToRight\n\n' This will display $C$1\nMsgBox rng.Address, vbInformation, ROLE &amp; \" located:\"\n\nrng.Cut\nApplication.GoTo Range(\"A100\")\nActiveSheet.Paste\n\n ' This will display $A$100\nMsgBox rng.Address, vbInformation, ROLE &amp; \" located:\"  \nEnd Sub\n</code></pre>\n\n<p>So, I would define a Named Range for each of your columns (presently assumed to be AE, U, Y &amp; AJ).  The Named Range can span the entire column, which will minimize changes to the rest of your code.</p>\n\n<p>Given 4 named ranges like:</p>\n\n<ul>\n<li>Role, representing column U:U</li>\n<li>RevProfile, representing column AJ:AJ</li>\n<li>FollowUp, representing column Y:Y</li>\n<li>Intent, representing column AE:AE</li>\n</ul>\n\n<p>(<strong>NOTE:</strong> If you anticipate that users may insert <em>rows</em> above your header rows, then I would change the Named range assignments to only the header cells, e.g., \"$AE$1\", \"$U$1\", etc. -- this should require no additional changes to the code below)</p>\n\n<p><a href=\"https://i.stack.imgur.com/bQilS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bQilS.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could do like this:</p>\n\n<pre><code>'Constant strings representing named ranges in this worksheet\nPublic Const ROLE As String = \"Role\"\nPublic Const REVPROFILE As String = \"RevProfile\"\nPublic Const FOLLOWUP As String = \"FollowUp\"\nPublic Const INTENT As String = \"Intent\"\n\nSub AdjustForNoIntent()\n    'Adjusts columns Role(U) (to C-MEM), REV Profile Follow-up Date(AJ) (to N/A) and deletes Follow-up Date(Y) when column Survey: Intent to Participate = No\n    Dim lastrow As Long\n    Dim i As Long\n\n    lastrow = Range(INTENT).End(xlUp).Row\n    For i = 2 To lastrow\n        If Not IsError(Range(INTENT).Cells(i).Value) Then\n            If Range(INTENT).Cells(i).Value = \"No\" And Range(ROLE).Cells(i).Value = \"MEM\" Then\n                Range(ROLE).Cells(i).Value = \"C-MEM\"\n                Range(FOLLOWUP).ClearContents\n                Range(REVPROFILE).Cells(i).Value = \"N/A\"\n            ElseIf Range(INTENT).Cells(i).Value = \"No\" And Range(ROLE).Cells(i).Value = \"VCH\" Then\n                Range(ROLE).Cells(i).Value = \"C-VCH\"\n                Range(FOLLOWUP).Cells(i).ClearContents\n                Range(REVPROFILE).Value = \"N/A\"\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1475156776, "creation_date": 1475156776, "answer_id": 39772110, "question_id": 39755639, "link": "https://stackoverflow.com/questions/39755639/vba-excel-look-for-column-names-return-their-number-and-use-column-letters-in-f/39772110#39772110", "title": "VBA-Excel Look for column names, return their number and use column letters in function", "body": "<p>I would go with David Zemens answer but you could also use <code>Range().Find</code> to get the correct columns.</p>\n\n<p>Here I refactored you code to find and set references to your column headers.  Everything is based relative to these references. </p>\n\n<p>Here I set a reference to Row 3 of the Survey column where your column header is:</p>\n\n<p><code>Set rSurvey = .Rows(3).Find(What:=\"Survey\", MatchCase:=False, Lookat:=xlWhole)</code></p>\n\n<p>Because everything is relative to rSurvey the last row is = the actual last row - rSurvey's row</p>\n\n<p><code>lastrow = rSurvey(.Rows.Count - rSurvey.Row).End(xlUp).Row - rSurvey.Row</code></p>\n\n<p>Since rSurvey is a range we know that <code>rSurvey.Cells(1, 1)</code> is our column header.  What isn't apparent is that since rSurvey is a range <code>rSurvey(1, 1)</code> is also our column header and since column and row indices are optional <code>rSurvey(1)</code> is also the column header cell.  </p>\n\n<p>Know all of that we can iterate over the cells in each column like this</p>\n\n<pre><code>For i = 2 To lastrow \n   rSurvey( i )\n</code></pre>\n\n<hr>\n\n<pre><code>Sub AdjustForNoIntent()\n'Adjusts columns Role(U) (to C-MEM), REV Profile Follow-up Date(AJ) (to N/A) and deletes Follow-up Date(Y) when column Survey: Intent to Participate = No\n    Dim lastrow As Long\n    Dim i As Long\n    Dim rRev As Range    'AJ\n    Dim rRole As Range    'U\n    Dim rFollowUp As Range    'Y\n    Dim rSurvey As Range    'AE\n    With Worksheets(\"Tracking\")\n        Set rRev = .Rows(3).Find(What:=\"REV\", MatchCase:=False, Lookat:=xlWhole)\n        Set rRole = .Rows(3).Find(What:=\"Role\", MatchCase:=False, Lookat:=xlWhole)\n        Set rFollowUp = .Rows(3).Find(What:=\"Follow-up\", MatchCase:=False, Lookat:=xlWhole)\n        Set rSurvey = .Rows(3).Find(What:=\"Survey\", MatchCase:=False, Lookat:=xlWhole)\n        lastrow = rSurvey(.Rows.Count - rSurvey.Row).End(xlUp).Row - rSurvey.Row\n\n    End With\n\n    For i = 2 To lastrow \n        If Not IsError(rSurvey(i).value) Then\n            If rSurvey(i).value = \"No\" And rRole(i).value = \"MEM\" Then\n                rRole(i).value = \"C-MEM\"\n                rFollowUp(i).ClearContents\n                rRev(i).value = \"N/A\"\n            ElseIf rSurvey(i).value = \"No\" And rRole(i).value = \"VCH\" Then\n                rRole(i).value = \"C-VCH\"\n                rFollowUp(i).ClearContents\n                rRev(i).value = \"N/A\"\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2482, "favorite_count": 0, "accepted_answer_id": 39756066, "answer_count": 3, "score": 0, "last_activity_date": 1475156967, "creation_date": 1475089229, "last_edit_date": 1475156086, "question_id": 39755639, "link": "https://stackoverflow.com/questions/39755639/vba-excel-look-for-column-names-return-their-number-and-use-column-letters-in-f", "title": "VBA-Excel Look for column names, return their number and use column letters in function", "body": "<p>I'm quite new at VBA. I've used it in excel for a couple macros, but this one is way above my head.\nI'm looking to create a macro that will find the appropriate column, then based on the value in this columns, changes the values in three other columns. I already have a static macro:</p>\n\n<pre><code>    Sub AdjustForNoIntent()\n    'Adjusts columns Role(U) (to C-MEM), REV Profile Follow-up Date(AJ) (to N/A) and deletes Follow-up Date(Y) when column Survey: Intent to Participate = No\n    Dim lastrow As Long\n    Dim i As Long\n    lastrow = Range(\"AE\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n        If Not IsError(Range(\"AE\" &amp; i).Value) Then\n            If Range(\"AE\" &amp; i).Value = \"No\" And Range(\"U\" &amp; i).Value = \"MEM\" Then\n                Range(\"U\" &amp; i).Value = \"C-MEM\"\n                Range(\"Y\" &amp; i).ClearContents\n                Range(\"AJ\" &amp; i).Value = \"N/A\"\n            ElseIf Range(\"AE\" &amp; i).Value = \"No\" And Range(\"U\" &amp; i).Value = \"VCH\" Then\n                Range(\"U\" &amp; i).Value = \"C-VCH\"\n                Range(\"Y\" &amp; i).ClearContents\n                Range(\"AJ\" &amp; i).Value = \"N/A\"\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>But this is a shared workbook, so people are adding columns randomly and every time I need to go back to the code and modify the columns refereces. What I want is, for instance, to look for column with \"Role\" header in row A3 and to insert it where the macro looks for column \"U\". That way other users can add/delete columns but I won't have to modify the macro every time.</p>\n\n<p>In other macros, I manage to have this thing working:</p>\n\n<pre><code>Function fnColumnNumberToLetter(ByVal ColumnNumber As Integer)\n    fnColumnNumberToLetter = Replace(Replace(Cells(1,ColumnNumber).Address, \"1\", \"\"), \"$\", \"\")\nEnd Function\n\n    Dim rngColumn As Range\n    Dim ColNumber As Integer\n    Dim ColName As String\n\n  ColName = \"Email Address\"\n\n  Sheets(\"Tracking\").Select\n  Set rngColumn = Range(\"3:3\").Find(ColName)\n\n\n  ColNumber = Sheets(\"Tracking\").Range(rngColumn, rngColumn).Column\n\n  Sheets(\"Combined\").Range(ActiveCell, \"W2\").FormulaLocal = \"=IF(ISERROR(INDEX(Tracking!$A:$A,MATCH(O:O,Tracking!\" &amp; fnColumnNumberToLetter(ColNumber) &amp; \":\" &amp; fnColumnNumberToLetter(ColNumber) &amp; \",0))), INDEX(Tracking!$A:$A,MATCH(U:U,Tracking!\" &amp; fnColumnNumberToLetter(ColNumber) &amp; \":\" &amp; fnColumnNumberToLetter(ColNumber) &amp; \",0)), INDEX(Tracking!$A:$A,MATCH(O:O,Tracking!\" &amp; fnColumnNumberToLetter(ColNumber) &amp; \":\" &amp; fnColumnNumberToLetter(ColNumber) &amp; \",0)))\"\n</code></pre>\n\n<p>However, I am unable to link the latter to the first and much less to get it to find multiple columns. Any help is appreciated.</p>\n\n<p><strong>EDIT:</strong>\nFollowing suggestions, here is the new code. Doesn't return an error, but doesn't do anything either. It loops through the <code>c</code> loop ok, but jumps from <code>For i =2 ...</code> line to <code>End Sub</code>.</p>\n\n<pre><code>    Sub Adjust()\n\n    Dim lastrow As Long\n    Dim i As Long\n    Dim headers As Dictionary\n    Dim c As Long\n\n    Set headers = New Scripting.Dictionary\n\nFor c = 1 To Cells(3, Columns.Count).End(xlToLeft).Column\n    headers.Add Cells(3, c).Value, c\nNext c\n\n    lastrow = Cells(headers.Item(\"Survey: Interest to Participate\") &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n        If Not IsError(Cells(i, headers.Item(\"Survey: Interest to Participate\")).Value) Then\n            If Cells(i, headers.Item(\"Survey: Interest to Participate\")).Value = \"No\" And Cells(i, headers.Item(\"Role\")).Value = \"MEM\" Then\n                Cells(i, headers.Item(\"Role\")).Value = \"C-MEM\"\n                Cells(i, headers.Ittem(\" Follow-up date\")).ClearContents\n                Cells(i, headers.Item(\"REV profile follow-up date\")).Value = \"N/A\"\n            ElseIf Cells(i, headers.Item(\"Survey: Interest to Participate\")).Value = \"No\" And Cells(i, headers.Item(\"Role\")).Value = \"VCH\" Then\n                Cells(i, headers.Item(\"Role\")).Value = \"C-VCH\"\n                Cells(i, headers.Ittem(\" Follow-up date\")).ClearContents\n                Cells(i, headers.Item(\"REV profile follow-up date\")).Value = \"N/A\"\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "debugging"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 2, "creation_date": 1475087822, "post_id": 39755168, "comment_id": 66806522, "body": "Which line gives you an error? <code>Range(&quot;B&quot; &amp; a.rownum)</code> is incorrect, it should be <code>Range(&quot;B&quot; &amp; a.Row)</code>. Also, you should qualify your referecnes, for instance <code>Workbooks(&quot;Workbook Name&quot;).Sheets(&quot;Sheet Name&quot;).Range(&quot;A2:A183&quot;)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4954670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1e1579cdd1f1cf70849f65e6063647da?s=128&d=identicon&r=PG&f=1", "display_name": "Akshata T", "link": "https://stackoverflow.com/users/4954670/akshata-t"}, "edited": false, "score": 0, "creation_date": 1475088905, "post_id": 39755302, "comment_id": 66807135, "body": "I removed the &#39;with&#39; section and used the code as suggested with &amp; _ . The error now says &#39;Application defined or object defined error&#39;"}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 37, "user_id": 4954670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1e1579cdd1f1cf70849f65e6063647da?s=128&d=identicon&r=PG&f=1", "display_name": "Akshata T", "link": "https://stackoverflow.com/users/4954670/akshata-t"}, "edited": false, "score": 0, "creation_date": 1475089008, "post_id": 39755302, "comment_id": 66807193, "body": "There was a glitch in my formula, with the double-quotes before the =. It should be     formula=&quot;=ifna(Index( .... etc.  Also, make sure you&#39;re closing the &quot; at the end of each line and including the &amp;, then reopening the &quot; at the beginning of the next line."}, {"owner": {"reputation": 37, "user_id": 4954670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1e1579cdd1f1cf70849f65e6063647da?s=128&d=identicon&r=PG&f=1", "display_name": "Akshata T", "link": "https://stackoverflow.com/users/4954670/akshata-t"}, "edited": false, "score": 0, "creation_date": 1475089206, "post_id": 39755302, "comment_id": 66807311, "body": "Yep, I had noted that and wrote the formula accordingly so it looks like following code:                        Sheet(&quot;Sheet5&quot;).Range(&quot;A2:A183&quot;).FormulaArray =          &quot;=ifna(INDEX(&#39;DRG and Zip Summaries&#39;!$A$10:$A$58,&quot; &amp; _  &quot;MATCH(&#39;DRG Summary Target&#39;!F2,&#39;DRG and Zip Summaries&#39;!&quot; &amp; _                                    &quot;$C$10:$C$58,0)),&#39;FALSE&#39;)&quot;"}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 37, "user_id": 4954670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1e1579cdd1f1cf70849f65e6063647da?s=128&d=identicon&r=PG&f=1", "display_name": "Akshata T", "link": "https://stackoverflow.com/users/4954670/akshata-t"}, "edited": false, "score": 0, "creation_date": 1475089473, "post_id": 39755302, "comment_id": 66807427, "body": "Use double-quotes around &quot;False&quot; at the end, or remove the single quotes. Excel doesn&#39;t know what to do with &#39;FALSE&#39;, which is where the error is probably coming from."}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 1, "last_activity_date": 1475088054, "creation_date": 1475088054, "answer_id": 39755302, "question_id": 39755168, "link": "https://stackoverflow.com/questions/39755168/vba-object-required-error-with-range-function/39755302#39755302", "title": "VBA object required error with Range function", "body": "<p>Don't place your formula in the WITH declaration. The WITH declaration is just supposed to identify the object to work with, not make any changes like putting values in it. Use:</p>\n\n<pre><code>With Range(\"A2:A183\")\n    .FormulaArray = part1\n...\n</code></pre>\n\n<p>etc.</p>\n\n<p>I'm not sure why you're using the \"part1\" and \"part2\" structure either. If it's just because the formula was getting too long, you can break lines using an underscore character, thus:</p>\n\n<pre><code>formula=\"\"=ifna(INDEX('DRG and Zip Summaries'!$A$10:$A$58,\" &amp; _\n    \"MATCH('DRG Summary Target'!F2\",'DRG and Zip Summaries'!\" &amp; _\n    \"$C$10:$C$58,0)),'FALSE')\"\n</code></pre>\n\n<p>The underscore will ensure these three lines are all processed as a single line.</p>\n"}], "owner": {"reputation": 37, "user_id": 4954670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1e1579cdd1f1cf70849f65e6063647da?s=128&d=identicon&r=PG&f=1", "display_name": "Akshata T", "link": "https://stackoverflow.com/users/4954670/akshata-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 39755302, "answer_count": 1, "score": 0, "last_activity_date": 1475088054, "creation_date": 1475087609, "question_id": 39755168, "link": "https://stackoverflow.com/questions/39755168/vba-object-required-error-with-range-function", "title": "VBA object required error with Range function", "body": "<p>I have a piece of VBA code that looks up value from another excel to create a True/False flag and based on the flag, I have set two different char values. I get 'object required' error in the following code. Can some one please explain why? </p>\n\n<pre><code>Sub test()\n\n  Dim part1 As String\n  Dim part2 As String\n  Dim a As Range\n\n  part1 = \"=ifna(INDEX('DRG and Zip Summaries'!$A$10:$A$58,MATCH('DRG Summary Target'!F2 \"\"x_x_x\"\"\"\n  part2 = \",'DRG and Zip Summaries'!$C$10:$C$58,0)),'FALSE')\"\n\nWith Range(\"A2:A183\").FormulaArray = part1\n                                  .Replace \"\"\"x_x_x\"\"\", part2\nEnd With\n\nFor Each a In Range(\"A2:A183\")\n If a.Value = \"FALSE\" Then\n        Range(\"B\" &amp; a.rownum) = Chr(168)\n Else:  Range(\"B\" &amp; a.rownum) = Chr(254)\n End If\nNext\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "cells", "protection", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6895508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54344eefc753d9c720351e41e50905d?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Hornsby", "link": "https://stackoverflow.com/users/6895508/karen-hornsby"}, "edited": false, "score": 0, "creation_date": 1475256417, "post_id": 39756756, "comment_id": 66886679, "body": "Thanks, that works great. Also good tip on the protection loop."}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": true, "score": 5, "last_activity_date": 1475093268, "creation_date": 1475093268, "answer_id": 39756756, "question_id": 39755017, "link": "https://stackoverflow.com/questions/39755017/using-vba-to-unprotect-cells/39756756#39756756", "title": "Using VBA to unprotect cells", "body": "<p>Change the <code>Locked</code> property of the range.</p>\n\n<pre><code>Range(\"C2\", \"C8\").Locked = false\n</code></pre>\n\n<p>This is equivalent to using the Format Cells | Protection | Locked checkbox to remove protection from a cell, and will make the cell immediately available for editing.</p>\n\n<p>Also, for future use, you may want to think about adding a simple loop to the protection step:</p>\n\n<pre><code>Dim sht as Worksheet\n\nFor each sht in ThisWorkbook.Sheets\n    sht.protect password:=Password, Userinterfaceonly:=True\nNext sht\n</code></pre>\n\n<p>That way people can't get around the restriction by adding new sheets, and the protection will continue to work if sheets are renamed, etc.</p>\n"}], "owner": {"reputation": 23, "user_id": 6895508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c54344eefc753d9c720351e41e50905d?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Hornsby", "link": "https://stackoverflow.com/users/6895508/karen-hornsby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18094, "favorite_count": 0, "accepted_answer_id": 39756756, "answer_count": 1, "score": 2, "last_activity_date": 1537156129, "creation_date": 1475087142, "last_edit_date": 1531164843, "question_id": 39755017, "link": "https://stackoverflow.com/questions/39755017/using-vba-to-unprotect-cells", "title": "Using VBA to unprotect cells", "body": "<p>So I have a spreadsheet that I want to format based on user inputs, but the cells need to remain locked until it is determined by the formatting that they will be user input cells.\nI have code that will look the cells for the user interface only but allow VBA to edit them.</p>\n\n<pre><code>&gt; 'protects all sheets upon opening work book\n&gt;     Me.Worksheets(\"Sheet1\").Protect \"Password\", UserInterfaceOnly:=True\n&gt;     Me.Worksheets(\"Sheet2\").Protect \"Password\", UserInterfaceOnly:=True\n&gt;     Me.Worksheets(\"Sheet3\").Protect \"Password\", UserInterfaceOnly:=True\n</code></pre>\n\n<p>so now I need to allow the following cells to be editable by the user</p>\n\n<pre><code>Sheets(\"Sheets2\").Protection.AllowEditRanges.Add \"Test\", Range(\"C2\", \"C8\")\nSheets(\"Sheets2\").Protection.AllowEditRanges.Add \"Test\", Range(\"H6\")\nSheets(\"Sheets2\").Protection.AllowEditRanges.Add \"Test\", Range(\"K6\")\n</code></pre>\n\n<p>I have tried allowing edits before I lock the sheet and after. \nWhat I'd really like is some VBA code to unlock the cells after applying formatting rather than defining which cells might be editable in advance.\nAny help gratefully appreciated :)</p>\n"}, {"tags": ["vba", "path", "find"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1475089794, "post_id": 39754372, "comment_id": 66807574, "body": "Which line is the error raised for?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475096152, "post_id": 39754372, "comment_id": 66810966, "body": "Where exactly are you validating the path? I don&#39;t see any validation code for either <code>shortlocation</code> or <code>location_merger &amp; file_merger</code> actually existing."}, {"owner": {"reputation": 113, "user_id": 5380325, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/27a907c9ef972b761f18fed785ade090?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian brutus III", "link": "https://stackoverflow.com/users/5380325/maximilian-brutus-iii"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475169889, "post_id": 39754372, "comment_id": 66847087, "body": "@Comintern I&#39;ve incorporated the answers to your questions in the initial question, I believe that&#39;s the way I&#39;m supposed to work here on this forum."}], "owner": {"reputation": 113, "user_id": 5380325, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/27a907c9ef972b761f18fed785ade090?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian brutus III", "link": "https://stackoverflow.com/users/5380325/maximilian-brutus-iii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475162376, "creation_date": 1475084768, "last_edit_date": 1475162376, "question_id": 39754372, "link": "https://stackoverflow.com/questions/39754372/vba-error-1004-sorry-we-couldnt-find", "title": "VBA error 1004 Sorry, we couldn&#39;t find", "body": "<p>I've receive the above error for the following code:</p>\n\n<pre><code>            Dim location_results As String\n            location_results = Worksheets(\"merging\").Range(\"B1\").Text 'absorbing the initial computation results folder\n            file_results = Dir$(location_results &amp; \"\\\" &amp; \"*\" &amp; NBDID &amp; \"*\" &amp; \".*\") 'checks if there is a file with NBDID in the \"location results folder\n            If (Len(file_results) &gt; 0) Then\n                Worksheets(\"list\").Range(\"D\" &amp; i).Value = file_results                         \n            Else\n                MsgBox (NBDID &amp; \" result not found\")\n            End If\n\n            'problem todoB:\nlineD:\n            Dim shortlocation As String\n            shortlocation = ThisWorkbook.Path &amp; \"\\megaresults\\\" &amp; file_results\nOn Error GoTo lineD\n                'Workbooks(shortlocation).Open\n                Set InputFile = Workbooks.Open(FileName:=shortlocation)\n                'Set InputFile = Workbooks.Open(location_results &amp; file_results)\n                Set OutputFile = Workbooks.Open(location_merger &amp; file_merger)\n                On Error GoTo 0\n</code></pre>\n\n<p>The error is raised on the line:</p>\n\n<pre><code>                Set InputFile = Workbooks.Open(location_results &amp; file_results)\n</code></pre>\n\n<p>and on the line:</p>\n\n<pre><code>                Set InputFile = Workbooks.Open(FileName:=shortlocation)\n</code></pre>\n\n<p>Now googling that error, nearly everyone has an issue that the file they are trying to open is not in the parents-workbook folder, or that they did not preappend their path to the file specification. </p>\n\n<p>I have done that however, and the path is validated, both manually by me checking whether the file is in the folder, as well as with:</p>\n\n<pre><code>            If (Len(file_results) &gt; 0) Then\n                Worksheets(\"list\").Range(\"D\" &amp; i).Value = file_results                         \n            Else\n                MsgBox (NBDID &amp; \" result not found\")\n            End If\n</code></pre>\n\n<p>, the file exists, and the total path, including file name and extention is 222 characters long. It also contains spaces.</p>\n\n<p>But I can't find any reason for it to return as an error. On top of that, the on error goto lineD does not function, it still pops up with a message that does not allow continuing of the code.</p>\n\n<p>Could someone point out my mistake to me, or give me a solution that would work?</p>\n\n<p>Kind regards.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6884508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9cbecc773f3e6afa2ff4430e0a620a?s=128&d=identicon&r=PG&f=1", "display_name": "casaler", "link": "https://stackoverflow.com/users/6884508/casaler"}, "edited": false, "score": 0, "creation_date": 1475151451, "post_id": 39758912, "comment_id": 66834536, "body": "That worked for the rs(&quot;RESMILE&quot;) and code went through first loop. I applied Nz to rs(&quot;RESMONTH&quot;), executed code and now get a Type Mismatch error when executing the second loop.  Thoughts? The data types are the same for RESMILE and RESMONTH."}, {"owner": {"reputation": 31, "user_id": 6884508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9cbecc773f3e6afa2ff4430e0a620a?s=128&d=identicon&r=PG&f=1", "display_name": "casaler", "link": "https://stackoverflow.com/users/6884508/casaler"}, "edited": false, "score": 0, "creation_date": 1475151756, "post_id": 39758912, "comment_id": 66834750, "body": "Scratch my previous comment. I just realized that I had rs(&quot;RESMONTH&quot;) equaling dblDATEHOLD which is not a string; changed to strRESMONTH and code ran with no errors. Can you tell me why the code does not check the first entry of the VIN hold? That is, if the VIN has 3 entries, only entries 2 &amp; 3 are checked."}, {"owner": {"reputation": 31, "user_id": 6884508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9cbecc773f3e6afa2ff4430e0a620a?s=128&d=identicon&r=PG&f=1", "display_name": "casaler", "link": "https://stackoverflow.com/users/6884508/casaler"}, "edited": false, "score": 0, "creation_date": 1475605100, "post_id": 39758912, "comment_id": 67006162, "body": "Can you tell me why the code does not check the first entry of the VIN hold? That is, if the VIN has 3 entries, only entries 2 &amp; 3 are checked."}, {"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "reply_to_user": {"reputation": 31, "user_id": 6884508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9cbecc773f3e6afa2ff4430e0a620a?s=128&d=identicon&r=PG&f=1", "display_name": "casaler", "link": "https://stackoverflow.com/users/6884508/casaler"}, "edited": false, "score": 0, "creation_date": 1475615116, "post_id": 39758912, "comment_id": 67011371, "body": "It looks like you <code>.movenext</code> the first record, then loop the remainder. <code>If Not .BOF Then         strHold = rs(&quot;VIN&quot;)         dblDATEHold = rs(&quot;MONTHS&quot;)         .Edit         rs(&quot;RESMONTH&quot;) = &quot;&quot;         .Update         .MoveNext         Do Until .EOF</code>"}], "tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": false, "score": 1, "last_activity_date": 1475103622, "creation_date": 1475103622, "answer_id": 39758912, "question_id": 39754200, "link": "https://stackoverflow.com/questions/39754200/query-code-generating-invalid-use-of-null/39758912#39758912", "title": "Query code generating Invalid Use Of Null", "body": "<p>Handle the evident <code>NULL</code> in your <code>[RESMILE]</code> field by using <code>Nz()</code>.</p>\n\n<p>So change <code>strRESMILE = rs(\"RESMILE\")</code> to <code>strRESMILE = Nz(rs(\"RESMILE\"))</code></p>\n"}], "owner": {"reputation": 31, "user_id": 6884508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9cbecc773f3e6afa2ff4430e0a620a?s=128&d=identicon&r=PG&f=1", "display_name": "casaler", "link": "https://stackoverflow.com/users/6884508/casaler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475139345, "creation_date": 1475084140, "last_edit_date": 1475139345, "question_id": 39754200, "link": "https://stackoverflow.com/questions/39754200/query-code-generating-invalid-use-of-null", "title": "Query code generating Invalid Use Of Null", "body": "<p>My code is generating an Invalid Use Of Null and I am not seeing the issue. When I compile the code, I do not get an error, but when I run and debug it, the error occurs at strRESMILE = rs(\"RESMILE\"). </p>\n\n<p>Any thoughts? I can upload the database if need be.</p>\n\n<pre><code>    Sub COMPARE()\nOn Error GoTo err_COMPARE\n\n Dim db As DAO.Database\n Dim rs As DAO.Recordset\n Dim strSQL As String\n Dim strHold As String\n Dim strRESMILE As String\n Dim strRESMONTH As String\n Dim dblMILEAGEHold As Double\n Dim dblDATEHold As Double\n\n Set db = CurrentDb\n strSQL = \"SELECT * FROM TABLE3\"\n Set rs = db.OpenRecordset(strSQL)\n With rs\n' If Not .BOF And Not .EOF Then\n'        .MoveLast\n'        .MoveFirst\n    If Not .BOF Then\n        strHold = rs(\"VIN\")\n        dblMILEAGEHold = rs(\"MILES\")\n        .Edit\n        rs(\"RESMILE\") = \"\"\n        .Update\n        .MoveNext\n'While (Not .EOF)\n        Do Until .EOF\n            .Edit\n            If rs(\"VIN\") = strHold Then\n                'do comparison\n              If rs(\"MILEAGE\") &gt; rs(\"MILES\") Then\n                 rs(\"RESMILE\") = \"Y\"\n            Else\n                rs(\"RESMILE\") = \"N\"\n              End If\n            End If\n            .Update\n            strHold = rs(\"VIN\")\n            strRESMILE = rs(\"RESMILE\")\n            .MoveNext\n'            Wend\n        Loop\n    End If\n End With\n\n Set db = CurrentDb\n strSQL = \"SELECT * FROM TABLE3\"\n Set rs = db.OpenRecordset(strSQL)\n With rs\n    If Not .BOF Then\n        strHold = rs(\"VIN\")\n        dblDATEHold = rs(\"MONTHS\")\n        .Edit\n        rs(\"RESMONTH\") = \"\"\n        .Update\n        .MoveNext\n        Do Until .EOF\n            .Edit\n            If rs(\"VIN\") = strHold Then\n                'do comparison\n              If rs(\"INSM\") &gt; rs(\"MONTHS\") Then\n                 rs(\"RESMONTH\") = \"Y\"\n            Else\n                rs(\"RESMONTH\") = \"N\"\n               End If\n            End If\n            .Update\n            strHold = rs(\"VIN\")\n            dblDATEHold = rs(\"RESMONTH\")\n            .MoveNext\n        Loop\n    End If\nEnd With\n\nrs.Close\ndb.Close\nSet rs = Nothing\nSet db = Nothing\n\nMsgBox \"Comparisons Completed!\"\n\nexit_COMPARE:\n    Exit Sub\n\nerr_COMPARE:\n    MsgBox Err.Description\n    Resume exit_COMPARE\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475086145, "post_id": 39754470, "comment_id": 66805504, "body": "Thanks! For some reason I keep getting that &quot;Operation is not supported for this object&quot; but when I step into on Access, I can see it matching up the RecID&#39;s."}, {"owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475088361, "post_id": 39754470, "comment_id": 66806824, "body": "rs1.FindFirst &quot;RecID = &quot; &amp; rs!RecID"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475090354, "post_id": 39754470, "comment_id": 66807773, "body": "You may have to specify dbOpenDynaset for your recordset - I&#39;m assuming that both recordsets are just tables?"}, {"owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475093160, "post_id": 39754470, "comment_id": 66809287, "body": "Yup both are just tables"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475093991, "post_id": 39754470, "comment_id": 66809707, "body": "Change your open recordset to <code>Set rs1 = CurrentDb.OpenRecordset(&quot;Email2&quot;, dbOpenDynaset)</code>"}, {"owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475147001, "post_id": 39754470, "comment_id": 66831315, "body": "That seems to have done it! It seems to only write on the first record in Email1, however, even though I see it searching for the recID&#39;s that match."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475160314, "post_id": 39754470, "comment_id": 66841131, "body": "You might need to tell it to go back to the start before searching with <code>rs1.MoveFirst</code>"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1475085188, "creation_date": 1475085188, "answer_id": 39754470, "question_id": 39754062, "link": "https://stackoverflow.com/questions/39754062/how-to-read-record-from-one-table-and-write-to-another-table-with-the-correspond/39754470#39754470", "title": "How to read record from one table and write to another table with the corresponding record?", "body": "<p>You need to find the record - then edit it<br>\nYou can't do that on one line like you're trying</p>\n\n<p>Replace:</p>\n\n<pre><code>rs1.Edit where rs!RecID = rs1.RecID\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>rs1.FindFirst \"RecID = \" &amp; rs!RecID\nrs1.Edit\n</code></pre>\n\n<blockquote>\n  <p><strong>EDIT - add check for NoMatch</strong></p>\n</blockquote>\n\n<p><strong>NOTE</strong> - You should also check for rs1.NoMatch after your FindFirst attempt,<br>\nunless you know for sure that there's a RecID match for every record</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "edited": false, "score": 0, "creation_date": 1475090310, "post_id": 39755201, "comment_id": 66807756, "body": "Thanks! Changed the loop per your suggestion."}, {"owner": {"reputation": 50532, "user_id": 15354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca5a87d982422410d9f14aa89c0a842?s=128&d=identicon&r=PG", "display_name": "onedaywhen", "link": "https://stackoverflow.com/users/15354/onedaywhen"}, "edited": false, "score": 0, "creation_date": 1475137975, "post_id": 39755201, "comment_id": 66825252, "body": "&quot;not bother with the whole OpenRecordset deal for a simple update&quot; gets my +1"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 2, "last_activity_date": 1475087735, "creation_date": 1475087735, "answer_id": 39755201, "question_id": 39754062, "link": "https://stackoverflow.com/questions/39754062/how-to-read-record-from-one-table-and-write-to-another-table-with-the-correspond/39755201#39755201", "title": "How to read record from one table and write to another table with the corresponding record?", "body": "<p>I would not bother with the whole OpenRecordset deal for a simple update, I would just do:</p>\n\n<pre><code>DoCmd.RunSQL \"UPDATE Email2 SET EmailStat=#\" &amp; strNow &amp; \"# WHERE RecID=\" &amp; rs!RecID\n</code></pre>\n\n<p>A additional note:\nRecordCount is not exactly trustworthy. I prefer to loop like this:</p>\n\n<pre><code>rs.MoveFirst\nDo while Not rs.EOF\n    {Do Stuff}\n    rs. MoveNext\n  Loop\n</code></pre>\n\n<p>(this does not check for no records at all, to check for no records at all use:\n<code>rs.EOF=True AND rs.BOF=true</code>\nbefore rs.MoveFirst, otherwise you will get an error)</p>\n"}], "owner": {"reputation": 71, "user_id": 6285878, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/87316845281bedb4fc4b05ce15952f99?s=128&d=identicon&r=PG&f=1", "display_name": "Macellaria", "link": "https://stackoverflow.com/users/6285878/macellaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 39754470, "answer_count": 2, "score": 0, "last_activity_date": 1475087735, "creation_date": 1475083707, "last_edit_date": 1475084156, "question_id": 39754062, "link": "https://stackoverflow.com/questions/39754062/how-to-read-record-from-one-table-and-write-to-another-table-with-the-correspond", "title": "How to read record from one table and write to another table with the corresponding record?", "body": "<p>I'm trying to read from one access table send an email, \"Email1\" and then write to the corresponding record \"Email2\" with the date. To find the corresponding Record, the fields RecID from both tables will match. I keep returning the error that \"Syntax Error\" highlighting this line below \" rs1.Edit where rs!MaxOfForm_Record_Number = rs1.MaxOfForm_Record_Number\"</p>\n\n<pre><code>   Function EmailTest1()\n\n    Dim rs As Recordset\n    Dim strBody As String\n    Dim strBody2 As String\n    Dim strRecipient As String\n    Dim rs1 As Recordset\n    Set rs1 = CurrentDb.OpenRecordset(\"Email2\")\n    Set rs = CurrentDb.OpenRecordset(\"Email1\")\n    Dim strName As String\n    Dim strProject As String\n    Dim strLastDate As String\n    Dim strNow As String\n    Dim emailcheck As String\n\n    rs.MoveLast\n    rs.MoveFirst\n\n    For i = 1 To rs.RecordCount\n\n        If IsNull(rs!EmailStat) = True Then\n         strNow = Now()\n         strName = rs!Inspected_By\n         strProject = rs!Site_Location\n         strLastDate = rs!LastOfDate_Time_of_Inspection\n         strBody2 = \"BLah blah text \"\n\n         rs1.Edit where rs!RecID = rs1.RecID\n         rs1![EmailStat].Value = strNow\n         rs1.Update\n\n         strBody = \"blahblah\"\n         strRecipient = rs!Email\n         DoCmd.SendObject , , , strRecipient, , , \"Subject\", strBody, False, False\n\n\n         End If\n         rs.MoveNext\n    Next i\n\n    Set rs = Nothing\n\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25483, "user_id": 129750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bde9493348770b4f6bf0f632ef91fc1c?s=128&d=identicon&r=PG", "display_name": "IttayD", "link": "https://stackoverflow.com/users/129750/ittayd"}, "edited": false, "score": 0, "creation_date": 1475328936, "post_id": 39762049, "comment_id": 66905828, "body": "It doesn&#39;t go past the pt.ChangePivotCache line"}, {"owner": {"reputation": 25483, "user_id": 129750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bde9493348770b4f6bf0f632ef91fc1c?s=128&d=identicon&r=PG", "display_name": "IttayD", "link": "https://stackoverflow.com/users/129750/ittayd"}, "edited": false, "score": 0, "creation_date": 1475345544, "post_id": 39762049, "comment_id": 66911280, "body": "34 including the header line"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25483, "user_id": 129750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bde9493348770b4f6bf0f632ef91fc1c?s=128&d=identicon&r=PG", "display_name": "IttayD", "link": "https://stackoverflow.com/users/129750/ittayd"}, "edited": false, "score": 0, "creation_date": 1475345769, "post_id": 39762049, "comment_id": 66911345, "body": "did you modify the sheet name to match yours ? is your table formatted as table ? and named &quot;Table1&quot; ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25483, "user_id": 129750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bde9493348770b4f6bf0f632ef91fc1c?s=128&d=identicon&r=PG", "display_name": "IttayD", "link": "https://stackoverflow.com/users/129750/ittayd"}, "edited": false, "score": 0, "creation_date": 1475477599, "post_id": 39762049, "comment_id": 66941919, "body": "can u share on dropbox or something ? since I cant duplicate your error. (maybe a screen-shot with your Table data)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1475126744, "creation_date": 1475126744, "answer_id": 39762049, "question_id": 39753825, "link": "https://stackoverflow.com/questions/39753825/cant-refresh-using-vba-a-pivot-table-attached-to-a-table/39762049#39762049", "title": "Can&#39;t refresh using VBA a pivot table attached to a table", "body": "<p>I moved the code from <code>Worksheet_Change</code> event, to a <code>Sub</code> that you can call from a button, otherwise it will fire everytime someone modifies or touches anywhere in this Sheet.</p>\n\n<p>I defined the \"<strong>PivotSrc_Range</strong>\" that is Set-up to \"<strong>Table1</strong>\", and is set-up to the <code>PivotCache</code>, this way, everytime someone modifies or adds a data to \"<strong>Table1</strong>\", the <code>PivotCache</code> changes, and the <code>PivotTable</code> will be modified once you call the <code>Sub</code> below:</p>\n\n<pre><code>Sub UpdatePivot()\n\nDim sht1                            As Worksheet\nDim pt                              As PivotTable\nDim PvtCache                        As PivotCache\nDim PivotSrc_Range                  As Range\n\n' modify to your sheet name (I prefer not to use ActiveSheet)\nSet sht1 = ThisWorkbook.Sheets(\"Sheet1\")\n\n' modify to your Table's name\nSet PivotSrc_Range = sht1.Range(\"Table1\")\n\n' set the Pivot Cache\nSet PvtCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PivotSrc_Range, Version:=xlPivotTableVersion14)\n\n' add this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\nOn Error Resume Next\nSet pt = sht1.PivotTables(\"PivotTable1\")\n\nOn Error GoTo 0\nIf pt Is Nothing Then\n\n    ' create a new Pivot Table in \"Sheet1\" sheet, start from Cell I1\n    Set pt = sht1.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=sht1.Range(\"I1\"), TableName:=\"PivotTable1\")\nElse\n    ' just refresh the Pivot cache with the updated Range (data in Table1)\n    pt.ChangePivotCache PvtCache\n    pt.RefreshTable\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25483, "user_id": 129750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bde9493348770b4f6bf0f632ef91fc1c?s=128&d=identicon&r=PG", "display_name": "IttayD", "link": "https://stackoverflow.com/users/129750/ittayd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475126744, "creation_date": 1475082892, "question_id": 39753825, "link": "https://stackoverflow.com/questions/39753825/cant-refresh-using-vba-a-pivot-table-attached-to-a-table", "title": "Can&#39;t refresh using VBA a pivot table attached to a table", "body": "<p>I converted a range of cells to a table, called Table1. Then I inserted a pivot table and then I inserted this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  Dim pt As PivotTable\n  Set pt = ActiveSheet.PivotTables(\"PivotTable1\")\n  pt.PivotCache.Refresh\nEnd Sub\n</code></pre>\n\n<p>I'm getting an error 1004. The DataSource is 'Table1'</p>\n"}, {"tags": ["vba", "excel", "datetime", "copy"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 3, "creation_date": 1475083940, "post_id": 39753822, "comment_id": 66804195, "body": "Execute <code>ThisWorkbook.Worksheets(1).Cells(1,2).NumberFormat = &quot;@&quot;</code> first, after that execute <code>ThisWorkbook.Worksheets(1).Cells(1,2).Value = ThisWorkbook.Worksheets(1).Cells(1,1).Value</code> to prevent autoformatting in target cell."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475084597, "post_id": 39753822, "comment_id": 66804591, "body": "Excel stores dates as serial numbers with <code>1 Jan 1900</code> = <code>1</code>.  If you enter something that looks like a date, Excel will parse it in accord with the Windows Regional Short Date settings.  If the dates in the <code>RolandSource</code> are &quot;real dates&quot;, the solution will be different than if they are text representations of dates.   If they are text representations, then pre-format your column as text, and then copy the <code>.Text</code> property of source cell.  If they are real dates, and correct, you shouldn&#39;t be having this problem, but you could try accessing the <code>.Value2</code> property of the source cell."}, {"owner": {"reputation": 43, "user_id": 3190686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/500893146/picture?type=large", "display_name": "D10N-CB3", "link": "https://stackoverflow.com/users/3190686/d10n-cb3"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1475134298, "post_id": 39753822, "comment_id": 66823059, "body": "Thanks @omegastripes, tried this solution but causes the loop to fail."}, {"owner": {"reputation": 43, "user_id": 3190686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/500893146/picture?type=large", "display_name": "D10N-CB3", "link": "https://stackoverflow.com/users/3190686/d10n-cb3"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475136933, "post_id": 39753822, "comment_id": 66824537, "body": "@RonRosenfeld - The issue is the field in the source is formatted as text and contains non-date text values (IE: &quot;DNA&quot;) and dates in UK format (IE:&quot;15/04/2003&quot;). The script lifts these values from the source to the destination, but where dates are acceptable in UK and US format (IE: &quot;01/02/2003&quot;) excel assumes they are incorrect US format and converting to UK format (storing 02/01/2003 as a date value). Value2 does not resolve either; if I do the following:     MsgBox(ThisWorkbook.Worksheets(1).Cells(1,1).Value2) from the above the behaviour is correct, but using the line above it fails."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475141402, "post_id": 39753822, "comment_id": 66827559, "body": "What happens if you format the column as text before you write the values into it?"}, {"owner": {"reputation": 43, "user_id": 3190686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/500893146/picture?type=large", "display_name": "D10N-CB3", "link": "https://stackoverflow.com/users/3190686/d10n-cb3"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475145231, "post_id": 39753822, "comment_id": 66830204, "body": "Hi @RonRosenfeld, this resolves the issue, as did omegastripes solution, however broke the loop. Marking as answered though, as I then managed to ad some IF() statements in to protect against failure. Not an eloquent solution, but worked. (PS: how can I +1 you both for your support on this?)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475145359, "post_id": 39753822, "comment_id": 66830275, "body": "Through trial and error, I have come across another change that seems to work, although I don&#39;t understand why.  Try removing the <code>.Value</code>  property .  In 2016, with both columns formatted as General, it seems to work. IOW,<code>Cell1 = Cell2</code>, where <code>Cell2</code> contains text date, leaves it as text date.  Whereas <code>Cell1.Value = Cell2.Value</code> tries to change it into a real date, sometimes incorrectly."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 3190686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/500893146/picture?type=large", "display_name": "D10N-CB3", "link": "https://stackoverflow.com/users/3190686/d10n-cb3"}, "is_accepted": true, "score": 0, "last_activity_date": 1475145303, "creation_date": 1475145303, "answer_id": 39767931, "question_id": 39753822, "link": "https://stackoverflow.com/questions/39753822/excel-vba-us-uk-date-conversion-issue/39767931#39767931", "title": "Excel VBA US/UK date conversion issue", "body": "<p>Thanks to @OmegaStripes and @RonRosenfeld - answer was to format the cell prior to copying the value from source to destination. This was causing the loop to fail, but by adding If() statements to protect the loop from error I have resolved. Thank you both for your help.</p>\n"}], "owner": {"reputation": 43, "user_id": 3190686, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/500893146/picture?type=large", "display_name": "D10N-CB3", "link": "https://stackoverflow.com/users/3190686/d10n-cb3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1760, "favorite_count": 0, "accepted_answer_id": 39767931, "answer_count": 1, "score": 1, "last_activity_date": 1475145303, "creation_date": 1475082890, "question_id": 39753822, "link": "https://stackoverflow.com/questions/39753822/excel-vba-us-uk-date-conversion-issue", "title": "Excel VBA US/UK date conversion issue", "body": "<p>I am having an issue with a VBA script used to import data from one spreadsheet, reformat it, then transmit it on.</p>\n\n<p>The date entries in the source sheet are entered in dd/mm/yyyy format. The destination sheet uses the following line to import the date:</p>\n\n<pre><code>If RolandSource.Worksheets(tFocus).Cells(rFocus, 2).Value &lt;&gt; \"\" And RolandSource.Worksheets(tFocus).Cells(4, cFocus) &lt;&gt; \"\" And RolandSource.Worksheets(tFocus).Cells(rFocus, cFocus) &lt;&gt; \"\" Then ThisWorkbook.Worksheets(1).Cells(rRecord, 6).Value = RolandSource.Worksheets(tFocus).Cells(rFocus, cFocus).Value\n</code></pre>\n\n<p>The issue is that excel is copying the data, then automatically formatting as a date. During this process, dates that are ambiguous between UK and US date formats are being transformed, despite this not being needed.</p>\n\n<p>The dataset that is being imported may contain date (dd/mm/yyyy) or text entries, and as such usual date processing routes create errors. Does anybody have suggestions?</p>\n\n<p>You can see the issue I am describing by formatting cell A1 as Text, typing \"01/02/2003\" into Cell A1, then executing the following in the immediate window:</p>\n\n<pre><code>ThisWorkbook.Worksheets(1).Cells(1,2).value = ThisWorkbook.Worksheets(1).Cells(1,1).Value\n</code></pre>\n\n<p>(Please note, the solution will be used as part of a loop that needs to handle dates and words).</p>\n\n<p>Thanks in anticipation.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1475084447, "post_id": 39754098, "comment_id": 66804490, "body": "Thank you.  I assume this code takes all the ten elements, and not every 10th element in the mismatch array? What does the <code>- 10</code> do in the first line? Also, what if I want the mismatch elements that aren&#39;t divisible by 10 to do the same as those that are divisible by 10?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1475084627, "post_id": 39754098, "comment_id": 66804611, "body": "@user112947 - Yes, it will traverse each element, not every 10th. The -10 makes sure that the inner loop doesn&#39;t run past the array bound, because the inner loop is adding an offset to it. What to do with the extra <code>x</code> elements if it isn&#39;t evenly divisible would depend on what your use requirement dictates."}, {"owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1475085138, "post_id": 39754098, "comment_id": 66804886, "body": "Does this mean I can put the same code I put under &#39;other code&#39; for the extra x elements if it isn&#39;t evenly divisible?"}, {"owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "edited": false, "score": 0, "creation_date": 1475085698, "post_id": 39754098, "comment_id": 66805239, "body": "Thank you very much, I appreciate it."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1475085532, "last_edit_date": 1475085532, "creation_date": 1475083849, "answer_id": 39754098, "question_id": 39753798, "link": "https://stackoverflow.com/questions/39753798/how-to-loop-over-multiple-elements-in-an-array-at-a-time/39754098#39754098", "title": "How to loop over multiple elements in an array at a time", "body": "<p>If I understand the question correctly, all you should need to do is step through the array by 10s, then have the inner loop offset the main index:</p>\n\n<pre><code>For i = LBound(mismatch) To UBound(mismatch) - 10 Step 10\n    For j = 0 To 9\n        arr = mismatch(i + j)\n         'other code'\n    Next\nNext\n</code></pre>\n\n<p>If you don't have the requirement that the sub-groups have exactly 10 elements, you can add a separate bound calculation to the inner loop by looping through the maximum of elements or however many are left:</p>\n\n<pre><code>For i = LBound(mismatch) To UBound(mismatch) Step 10\n    Dim innerBound As Long\n\n    If i + 10 &gt; UBound(mismatch) Then\n        innerBound = UBound(mismatch) - i\n    Else\n        innerBound = 9\n    End If\n    For j = 0 To innerBound\n        arr = mismatch(i + j)\n        'other code\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 3676776, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4d06000231380985c233ceb9b149d202?s=128&d=identicon&r=PG&f=1", "display_name": "user112947", "link": "https://stackoverflow.com/users/3676776/user112947"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 39754098, "answer_count": 1, "score": 0, "last_activity_date": 1475085532, "creation_date": 1475082794, "last_edit_date": 1531164843, "question_id": 39753798, "link": "https://stackoverflow.com/questions/39753798/how-to-loop-over-multiple-elements-in-an-array-at-a-time", "title": "How to loop over multiple elements in an array at a time", "body": "<p>I am trying to loop over 10 elements within a big array and see if there are any mismatches with another array (let's call it array2).</p>\n\n<pre><code>Dim j As Long, i As Long, arr As Variant\n\nmismatch = Compare_array(array1, array2)    'Compare_array is a function and returns an array of mismatches\n\nFor i =LBound(mismatch) to UBound(mismatch)\n    j=0\n    For arr = mismatch(j + 1, 1) To mismatch(j + 10, 1)\n         'other code'\n    Next\nNext\n</code></pre>\n\n<p>Basically what I want to do is get 10 elements of the mismatch array and perform other procedures with it. After the other procedures are done, I want to take the next 10 elements of the mismatch array, and so on. I'm just not sure if I have done the second for statement correctly.</p>\n\n<p>Any advice would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1475085879, "post_id": 39753553, "comment_id": 66805339, "body": "Show us the code for <code>sms_send</code>"}, {"owner": {"reputation": 1, "user_id": 6894967, "user_type": "registered", "profile_image": "https://graph.facebook.com/1152342831514414/picture?type=large", "display_name": "\u0623\u0628\u0648 \u0645\u062d\u0645\u062f", "link": "https://stackoverflow.com/users/6894967/%d8%a3%d8%a8%d9%88-%d9%85%d8%ad%d9%85%d8%af"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1475161089, "post_id": 39753553, "comment_id": 66841731, "body": "thankx for repley Siddharth Rout"}, {"owner": {"reputation": 1, "user_id": 6894967, "user_type": "registered", "profile_image": "https://graph.facebook.com/1152342831514414/picture?type=large", "display_name": "\u0623\u0628\u0648 \u0645\u062d\u0645\u062f", "link": "https://stackoverflow.com/users/6894967/%d8%a3%d8%a8%d9%88-%d9%85%d8%ad%d9%85%d8%af"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1475161400, "post_id": 39753553, "comment_id": 66841970, "body": "the code is to long i will write it in new answer"}], "owner": {"reputation": 1, "user_id": 6894967, "user_type": "registered", "profile_image": "https://graph.facebook.com/1152342831514414/picture?type=large", "display_name": "\u0623\u0628\u0648 \u0645\u062d\u0645\u062f", "link": "https://stackoverflow.com/users/6894967/%d8%a3%d8%a8%d9%88-%d9%85%d8%ad%d9%85%d8%af"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475162414, "creation_date": 1475081998, "last_edit_date": 1531164843, "question_id": 39753553, "link": "https://stackoverflow.com/questions/39753553/vba-excel-auto-call-module", "title": "VBA Excel auto call module", "body": "<p>Thanks in advence for your replay, and sorry for my english\ni have a problem in my excel project\nthe project is to write a vba code in excel to auto send sms when a cell value change for that I used the OZEKI Excel sms client ( <a href=\"http://www.ozekisms.com/index.php?owpn=466\" rel=\"nofollow\">http://www.ozekisms.com/index.php?owpn=466</a> )\nbut the problem is that client have a button (Send all)\nthat you must click for sending messages, but i want to do this automaticly when a cell value change my code is </p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim Ozeki As Workbook\n    Dim FormulaRange As Range\n    Dim NotSentMsg As String\n    Dim MyMsg As String\n    Dim SentMsg As String\n    Dim MyLimit As Double\n\n    NotSentMsg = \"Normale\"\n    SentMsg = \"Alarme\"\n\n    'Above the MyLimit value it will run the macro\n    MyLimit = 200\n\n    'Set the range with the Formula that you want to check\n    Set FormulaRange = Me.Range(\"C2:C4\")\n\n    On Error GoTo EndMacro:\n    For Each FormulaCell In FormulaRange.Cells\n\n        With FormulaCell\n\n                      If .Value &gt; MyLimit Then\n                        MyMsg = SentMsg\n\n\n\n                         If .Offset(0, 1).Value = NotSentMsg Then\n\n                           Call Modul1.sms_send\n\n                     End If\n\n                  Else\n\n                    MyMsg = NotSentMsg\n\n                       If .Offset(0, 1).Value = SentMsg Then\n\n                         Call Modul1.sms_send\n\n                    End If\n\n                 End If\n\n\n\n            Application.EnableEvents = False\n            .Offset(0, 1).Value = MyMsg\n            Application.EnableEvents = True\n        End With\n\n    Next FormulaCell\n\nExitMacro:\n    Exit Sub\n\nEndMacro:\n    Application.EnableEvents = True\n\n    MsgBox \"Some Error occurred.\" _\n         &amp; vbLf &amp; Err.Number _\n         &amp; vbLf &amp; Err.Description\nEnd Sub\n</code></pre>\n\n<p>i have add \"Call Modul1.sms_send\" and this code call an combobox in wich i must select the Messages.xls workbook wich containe the phones numbers and messages texte to send</p>\n\n<p>But like i have already said i want to do this automaticly\nthe three sheets(Ozeki,Messages,formula value change) are in the same workbook</p>\n\n<p>So please any idea, and thankx again</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1475133192, "post_id": 39753412, "comment_id": 66822369, "body": "Hi Anthony, my subform doesn&#39;t have OnClick event (see image attached in my post). Have you the idea of why?"}, {"owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "reply_to_user": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1475165090, "post_id": 39753412, "comment_id": 66844388, "body": "It does... but in order to see it... it would be simpler if you opened up the subform itself. You may be thinking of it as still being a query... and it is. But the second you drop a query into a form it actually creates another form. Judging from your image look in your Forms Object List for a form called &quot;query query...&quot;. You should then see what I was talking about when you open this form up separately."}], "tags": [], "owner": {"reputation": 1125, "user_id": 1819403, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wnFWz.jpg?s=128&g=1", "display_name": "Anthony Griggs", "link": "https://stackoverflow.com/users/1819403/anthony-griggs"}, "is_accepted": false, "score": 0, "last_activity_date": 1475081504, "creation_date": 1475081504, "answer_id": 39753412, "question_id": 39753098, "link": "https://stackoverflow.com/questions/39753098/trigger-an-procedure-from-record-selection-of-a-subform/39753412#39753412", "title": "trigger an procedure from record selection of a subform", "body": "<p>The \"Form\" actually does have a On-Click event. <a href=\"https://i.stack.imgur.com/izBeC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/izBeC.png\" alt=\"enter image description here\"></a></p>\n\n<p>However for what it sounds like you are trying to do I would add the On-Click Event at the detail level and not the form level. That way you can capture the specific record you are clicking on:\n<a href=\"https://i.stack.imgur.com/uAguZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uAguZ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1475088226, "creation_date": 1475088226, "answer_id": 39755351, "question_id": 39753098, "link": "https://stackoverflow.com/questions/39753098/trigger-an-procedure-from-record-selection-of-a-subform/39755351#39755351", "title": "trigger an procedure from record selection of a subform", "body": "<p>If you want an event that triggers every time the form loads a new record use <code>OnCurrent</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1475141684, "post_id": 39765752, "comment_id": 66827775, "body": "The subform displayed in the image was placed there by dragging the form from the left menu that shows all the forms. Is there a different way?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1475142501, "post_id": 39765752, "comment_id": 66828387, "body": "@AlessioCazzaniga: The point is: you dragged a query, not a form. To use events, you must create a new form, based on the query, probably with Default View = Datasheet. Then drag this new form into the main form."}, {"owner": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1475151575, "post_id": 39765752, "comment_id": 66834629, "body": "believe me I dragged a form! I can even make you a video showing you this :) .. Anyway I dragged a form and set as recordsource the query. Probably for access when setting a query as recordsource of a form it considers it a query.."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1475152044, "post_id": 39765752, "comment_id": 66834971, "body": "You probably set the query as <code>SourceObject</code> of the subform control, not as <code>RecordSource</code> of the form. @AlessioCazzaniga"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1475139317, "creation_date": 1475139317, "answer_id": 39765752, "question_id": 39753098, "link": "https://stackoverflow.com/questions/39753098/trigger-an-procedure-from-record-selection-of-a-subform/39765752#39765752", "title": "trigger an procedure from record selection of a subform", "body": "<p>If you want to react to events in the subform, you must create an actual form that you insert as subform, instead of the query that you currently have.</p>\n\n<p>A <strong>subform control</strong> (which you have selected in your screenshot) only has <code>OnEnter</code> and <code>OnExit</code> events. This is by design.</p>\n\n<p>And a query inside a subform control has no events at all (same as a \"regular\" query).</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7408093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kelJyxUNnmU/AAAAAAAAAAI/AAAAAAAAAAA/B26izRtM2sE/photo.jpg?sz=128", "display_name": "Kerem Ercoskun", "link": "https://stackoverflow.com/users/7408093/kerem-ercoskun"}, "is_accepted": false, "score": 0, "last_activity_date": 1580021469, "last_edit_date": 1580021469, "creation_date": 1579982334, "answer_id": 59912918, "question_id": 39753098, "link": "https://stackoverflow.com/questions/39753098/trigger-an-procedure-from-record-selection-of-a-subform/59912918#59912918", "title": "trigger an procedure from record selection of a subform", "body": "<p>You don't have to write code for this.</p>\n\n<p>First \"<code>create an unbound text box</code>\" on the main form, then change the control source property of the text box from data tab in properties window to: </p>\n\n<pre><code>[SubForm_Name].[Form]![Control_Name_in_SubForm_to_gather_data]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6748382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SJX3kOjcPsk/AAAAAAAAAAI/AAAAAAAAAF8/L8jEccwPUd4/photo.jpg?sz=128", "display_name": "Alessio Cazzaniga", "link": "https://stackoverflow.com/users/6748382/alessio-cazzaniga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1465, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1593773995, "creation_date": 1475080519, "last_edit_date": 1593773995, "question_id": 39753098, "link": "https://stackoverflow.com/questions/39753098/trigger-an-procedure-from-record-selection-of-a-subform", "title": "trigger an procedure from record selection of a subform", "body": "<p>I have a subform called MacroAttivit\u00e0Sub. It  has a worksheet layout. The subform recordsource is a query result. On its side I have a text box naled 'text520' which must show the value of the field 'descrizione' of the subform when the user select the desired record row. In the form property tab there is no OnClick event. See image link please.\n<a href=\"http://i.stack.imgur.com/Wgb1e.png\" rel=\"nofollow\">form with no OnClick event</a>\nThere are only 'Enter' and 'Exit'. Why? I tried unsuccesfully this code behind its main form:</p>\n\n<pre><code>Sub MacroAttivit\u00e0Sub_OnClick()\n    Text520.Value = Me!MacroAttivit\u00e0Sub.Form!descrizione.Value\nEnd Sub\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1475080863, "post_id": 39753051, "comment_id": 66802492, "body": "You need to specify <code>ActiveWorkbook</code> to qualify all of the range references, such as <code>TitleName = ActiveWorkbook.Cells(5, 2).Value</code> and this needs to be done for each range reference (including the Columns(x) and Rows(x).Delete lines because those are also range references) <code>ActiveWorkbook.Columns(8).Delete</code> and so on."}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1475081456, "post_id": 39753051, "comment_id": 66802853, "body": "Thank you :) So activating a workbook does nothing then? I&#39;d assumed I could activate the wb and then everything that followed would happen to that wb until another was activated."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1475081541, "post_id": 39753051, "comment_id": 66802917, "body": "Activating doesn&#39;t do too much - I <b><i>highly</i></b> recommend reading through, and applying, <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code>/<code>.Activate</code></a>"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1475081649, "post_id": 39753051, "comment_id": 66802977, "body": "I&#39;ve changed it to Activeworkbook.Columns(8).Delete and am getting an error - object doesn&#39;t support this property or method"}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1475081668, "post_id": 39753051, "comment_id": 66802994, "body": "Thanks BruceWayne, I will"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1475081704, "post_id": 39753051, "comment_id": 66803022, "body": "@Sam <code>ActiveWorkbook.Sheets(&quot;Whatever sheet name you use&quot;).Columns...</code> or <code>ActiveSheet.Columns...</code> (but see BruceWayne&#39;s good advice, which is a better way!)."}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1475082064, "post_id": 39753051, "comment_id": 66803224, "body": "Thank you all, but no matter how I add in &quot;ActiveWorkbook.Sheets(&quot;Sheet1&quot;).Co...&quot; or &quot;wb.activesheets.Co...&quot; it&#39;s giving me the same error"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1475083079, "post_id": 39753669, "comment_id": 66803735, "body": "Thank you very much cxw. Is something wrong with &quot;set ws = wb.Sheets(&quot;Sheet1&quot;)&quot;?? I&#39;m putting that in, but when I follow up with wb.ws.Columns(8).delete I&#39;m hitting an error that&#39;s not there if I type out wb.Sheets(&quot;She...etc"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1475083490, "post_id": 39753669, "comment_id": 66803946, "body": "@Sam once you have done <code>dim ws as Worksheet</code> and <code>set ws=...</code>, you can refer to <code>ws</code> by itself.  The <code>ws</code> Worksheet object remembers what workbook it is associated with, so <code>ws.Columns(8).Delete</code> should work fine (leave off <code>wb.</code> at the beginning)."}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1475162021, "post_id": 39753669, "comment_id": 66842378, "body": "Ah! Brilliant. Thank you very much again :)"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 1, "creation_date": 1475165605, "post_id": 39753669, "comment_id": 66844731, "body": "@Sam glad to help!  As you&#39;ll recall from the tour, please hit the uparrow if an answer was helpful, and the checkmark if it solved your problem.  That helps others who may read this question later.  Plus, the checkmark clears the question off the &quot;Unanswered&quot; lists and gives us both reputation points :) ."}, {"owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "edited": false, "score": 0, "creation_date": 1477495027, "post_id": 39753669, "comment_id": 67792525, "body": "Done :) Much obliged."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1475082368, "last_edit_date": 1495541796, "creation_date": 1475082368, "answer_id": 39753669, "question_id": 39753051, "link": "https://stackoverflow.com/questions/39753051/vba-run-from-my-personal-wb-is-perfect-copied-to-a-distro-wb-and-it-breaks-why/39753669#39753669", "title": "VBA run from my PERSONAL wb is perfect, copied to a distro wb and it breaks. Why?", "body": "<p>I took a bit of a closer look at your code.  I think you are saying that you want to run code from <code>macros.xlsm</code> (or something like that), and have it operate on <code>mydata.xlsx</code> (or some such).  Therefore, in your macro, <code>ThisWorkbook</code> will refer to <code>macros.xlsm</code> (should you need to refer to that).</p>\n\n<p>After you have done <code>Set wb = Workbooks.Open(fNameAndPath)</code> to open <code>mydata.xlsx</code>, only and always refer to <code>wb</code> and <code>wb.Sheets(\"whatever\")</code> when you are talking about <code>mydata.xlsx</code>.  </p>\n\n<ul>\n<li>Don't use <code>Columns</code>, <code>Rows</code>, <code>Sheets</code>, or <code>Cells</code> without a sheet reference in front of them</li>\n<li>Don't use <code>ActiveWorkbook</code>/<code>ActiveWorksheet</code> at all.  </li>\n<li>Instead of <code>ActiveCell</code>, use a named range, e.g., as in <a href=\"https://stackoverflow.com/a/10714406/2877364\">this answer</a> to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">the question BruceWayne noted</a>.</li>\n</ul>\n\n<p>That should take care of it!</p>\n\n<p><code>&lt;soapbox&gt;</code>And, in general, please be careful of your indentation and use longer variable names &mdash; both will help you avoid bugs as you work on this code.<code>&lt;/soapbox&gt;</code></p>\n"}], "owner": {"reputation": 65, "user_id": 4146297, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1276eeeae4ad5d9e9a07c853b1ebd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4146297/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 39753669, "answer_count": 1, "score": 0, "last_activity_date": 1475082368, "creation_date": 1475080390, "question_id": 39753051, "link": "https://stackoverflow.com/questions/39753051/vba-run-from-my-personal-wb-is-perfect-copied-to-a-distro-wb-and-it-breaks-why", "title": "VBA run from my PERSONAL wb is perfect, copied to a distro wb and it breaks. Why?", "body": "<p>I have the following code in a macro in my personal book, and it works perfectly.</p>\n\n<p>I'm trying to copy it into the actual wb it's running from so I can send it around for others to use, and it's breaking at the commented line \"XXXXXX\". The selected wb is being opened fine, but none of the subsequent editing occurs to that book. All of the following code (deletion of columns, etc) that should be happening to the opened workbook only happens to the wb running the macro, which is...sub-optimal. </p>\n\n<p>I don't know why! Any thoughts welcomed.</p>\n\n<p>Thank you</p>\n\n<p>Sam</p>\n\n<pre><code>Sub PredictBoxValue()\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim TitleName As String\nDim sas As String\nDim sos As String\nDim unusedRow As Long\nDim filename As String\n\n'Optimize Macro Speed\nApplication.ScreenUpdating = False\n'Application.EnableEvents = False\n'Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n\nsos = ActiveWorkbook.Name\n\nActiveSheet.Range(\"B11\", \"AF11\").Clear\n\nDim fNameAndPath As Variant\nfNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.XLS),              \n*.XLS\", Title:=\"Select File To Be Opened\")\nIf fNameAndPath = False Then Exit Sub\nSet wb = Workbooks.Open(fNameAndPath)\n\nsas = ActiveWorkbook.Name\n\n'Delete extraneous columns and rows\n'XXXXXXXXXXX\nTitleName = Cells(5, 2).Value\n\nColumns(8).Delete\nColumns(12).Delete\nColumns(12).Delete\nColumns(3).Delete\nColumns(2).Delete\nColumns(1).Delete\nRows(3).Delete\nRows(2).Delete\nRows(1).Delete\n\nHere:\n\nDo Until Cells(2, 1).Value = \"1\"\n\nRange(\"A1\").End(xlDown).Select\n\n'Do Until ActiveCell.Value = \"1\"\n'ActiveCell.Offset(1).Select\n'Loop\n\nDo While ActiveCell.Value &lt; 1\nActiveCell.EntireRow.Delete\nActiveCell.Offset(-1, 0).Select\n\nLoop\n\nActiveCell.Offset(-1, 1).Select\n\nDo While ActiveCell.Offset(0, -1).Value &gt; 30\nActiveCell.EntireRow.Delete\nGoTo Here\n\nLoop\n\nActiveCell.Resize(, 7).Cut ActiveCell.Offset(1, 0).End(xlToRight).Offset(0,     \n1)\nActiveCell.EntireRow.Delete\n\nLoop\n\nRows(1).EntireRow.Delete\n\nCells(1, 1) = TitleName\nRange(\"A1\", Range(\"A1\").End(xlToRight)).Copy\n\nWindows(sos).Activate\n\nActiveSheet.Cells(11, 2).PasteSpecial (xlPasteValues)\n\nApplication.CutCopyMode = False\n\n\nWindows(sas).Activate\n\n'Save and Close Workbook\n wb.Close SaveChanges:=False\n\n Windows(sos).Activate\n\nActiveSheet.Cells(5, 3).Select\n\n'Message Box when tasks are completed\nMsgBox (\"Data uploaded for \") &amp; Range(\"B11\")\n\n\nResetSettings:\n  'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "angularjs", "vba", "excel"], "comments": [{"owner": {"reputation": 568, "user_id": 5305151, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TGFDCS97a20/AAAAAAAAAAI/AAAAAAAAAK4/plhuoqfNjdQ/photo.jpg?sz=128", "display_name": "Srikanth Sharma", "link": "https://stackoverflow.com/users/5305151/srikanth-sharma"}, "edited": false, "score": 0, "creation_date": 1475080155, "post_id": 39752893, "comment_id": 66802043, "body": "even tried &#39;angular.element(document.getElementsByTagName(&#39;button&#39;)[15]&zwnj;&#8203;).scope().title = &quot;112233&quot;&#39;;      followed by &#39;scope().apply();&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 568, "user_id": 5305151, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TGFDCS97a20/AAAAAAAAAAI/AAAAAAAAAK4/plhuoqfNjdQ/photo.jpg?sz=128", "display_name": "Srikanth Sharma", "link": "https://stackoverflow.com/users/5305151/srikanth-sharma"}, "is_accepted": false, "score": 3, "last_activity_date": 1475133662, "creation_date": 1475133662, "answer_id": 39763885, "question_id": 39752893, "link": "https://stackoverflow.com/questions/39752893/programmatically-input-angularjs-text-field-using-javascript-vba/39763885#39763885", "title": "Programmatically input angularjs text field using javascript/VBA", "body": "<p>I got the solution to the problem:</p>\n\n<pre><code>angular.element(document.getElementByTagName('input')[15]).scope().pList.pNumber = '112233';\n</code></pre>\n\n<p>followed by\n    <code>angular.element(document.getElementByTagName('input')[15]).scope().$apply();</code> \nOR <code>angular.element(document.getElementByTagName('input')[15]).scope().$digest();</code></p>\n\n<p>Include the above mentioned in <code>ie.Document.parentWindow.execScript \"...\"</code> to run it using VBA.</p>\n"}], "owner": {"reputation": 568, "user_id": 5305151, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-TGFDCS97a20/AAAAAAAAAAI/AAAAAAAAAK4/plhuoqfNjdQ/photo.jpg?sz=128", "display_name": "Srikanth Sharma", "link": "https://stackoverflow.com/users/5305151/srikanth-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1604, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550579302, "creation_date": 1475079856, "last_edit_date": 1531164843, "question_id": 39752893, "link": "https://stackoverflow.com/questions/39752893/programmatically-input-angularjs-text-field-using-javascript-vba", "title": "Programmatically input angularjs text field using javascript/VBA", "body": "<p>I am web scraping from AngularJS application using Excel VBA. I am trying to enter value in text-input by using something like- <code>ie.Document.getElementsByTagName(\"button\")(15).Value = \"112233\"</code>\n I also tried- <code>ie.Document.parentWindow.execScript \"document.getElementsByTagName('button')[15].Value = '112233';</code></p>\n\n<p>None of them is working. I have search few other posted questions but problems still exists. The element is:</p>\n\n<pre><code>&lt;input whole-number=\"\" type=\"text\" maxlength=\"20\" class=\"......\" ng-model=\"pList.pNumber\" bs-typeahead=\"typeahead_ProjectNumber\"  placeholder=\"enter a value\" data-provide=\"typeahead\" ng-change=\"reduceScrollMax()\"&gt;\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 1772, "user_id": 764474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34756b91f4b5d25d26578fc2a9962c9?s=128&d=identicon&r=PG", "display_name": "jeffrey_t_b", "link": "https://stackoverflow.com/users/764474/jeffrey-t-b"}, "edited": false, "score": 0, "creation_date": 1475080156, "post_id": 39752877, "comment_id": 66802045, "body": "If you are doing this within a macro, could you iterate over the cells in the selection, and set your FormatConditions for each cell <i>if</i> the regexp matches?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1475081362, "post_id": 39752877, "comment_id": 66802794, "body": "Why regex?  You could accomplish the same thing with <code>Cell.Value Like &quot;TN#&quot;</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1506030781, "last_edit_date": 1506030781, "creation_date": 1475081880, "answer_id": 39753516, "question_id": 39752877, "link": "https://stackoverflow.com/questions/39752877/excel-vba-using-regex-for-conditional-formating/39753516#39753516", "title": "Excel VBA using RegEx for Conditional Formating", "body": "<p>I would recommend using a <strong>Static</strong> type object for your VBScript.RegExp object.</p>\n\n<p>Cut the range passed into the function down to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow noreferrer\">Worksheet.UsedRange property</a>. This allows a selection of full columns without calculating empty rows/columns.</p>\n\n<pre><code>Option Explicit\n\nSub createCFR()\n    With Selection\n        'cut Selection down to the .UsedRange so that full row or full\n        'column references do not use undue calculation\n        With Intersect(.Cells, .Cells.Parent.UsedRange)\n            .FormatConditions.Delete\n            With .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=myCFR(\" &amp; .Cells(1).Address(0, 0) &amp; \")\")\n                .SetFirstPriority\n                With .Interior\n                    .PatternColorIndex = xlAutomatic\n                    .ColorIndex = 36\n                    .TintAndShade = 0\n                End With\n                .StopIfTrue = False\n            End With\n        End With\n    End With\nEnd Sub\n\nFunction myCFR(rng As Range)\n    Static rgx As Object\n\n    'with rgx as static, it only has to be created once\n    'this is beneficial when filling a long column with this UDF\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n\n    'make sure rng is a single cell\n    Set rng = rng.Cells(1, 1)\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"TN[0-9]\"\n        myCFR = .Test(rng.Value2)\n    End With\nEnd Function\n</code></pre>\n\n<p>Depending on your <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840834.aspx\" rel=\"nofollow noreferrer\">Selection</a>, you may need to modify the parameters of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">Range.Address property</a> used to create the CFR; e.g. <code>$A1</code> would be <code>.Address(1, 0)</code>.</p>\n\n<p>In the following image, B2:B7 contain <code>=myCFR(A2)</code> filled down to proof the UDF.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IUOTD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IUOTD.png\" alt=\"cfr_udf\"></a></p>\n"}], "owner": {"reputation": 168, "user_id": 4113608, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Ncslv.jpg?s=128&g=1", "display_name": "alindber", "link": "https://stackoverflow.com/users/4113608/alindber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506030781, "creation_date": 1475079807, "question_id": 39752877, "link": "https://stackoverflow.com/questions/39752877/excel-vba-using-regex-for-conditional-formating", "title": "Excel VBA using RegEx for Conditional Formating", "body": "<p>I have an Excel 2010 VBA macro that does some conditional formatting over a select area of a spreadsheet.  As an example the following snippet searches for a text pattern then colors the cell:</p>\n\n<pre><code>Selection.FormatConditions.Add Type:=xlTextString, String:=\"TextToMatch\", _\n    TextOperator:=xlContains    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ColorIndex = 36\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False \n</code></pre>\n\n<p>What I would like to add is to match against a regular expression <code>TN[0-9]</code>. A simple match of the string <code>TN</code> followed by a digit.</p>\n\n<p>I have created the RegExp obect:</p>\n\n<pre><code>Dim regEx As Object\nSet regEx = CreateObject(\"VBScript.RegExp\")\nWith regEx\n        .Pattern = \"TN[0-9]\"\nEnd With\n</code></pre>\n\n<p>However I have not figured out how to apply this to the <code>Selection</code>.</p>\n\n<p>As always, thank you for your assistance.</p>\n"}, {"tags": ["excel", "vba", "runtime-error", "copy-paste"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1475079181, "post_id": 39752664, "comment_id": 66801382, "body": "Please post the code that you are using."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475079254, "post_id": 39752664, "comment_id": 66801434, "body": "Just use the top-left cell for the target. The remainder of the cells will paste in adjoining cells."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475079352, "post_id": 39752664, "comment_id": 66801499, "body": "Also, after the error message (and going into debug), I could manually paste the picture."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475079408, "post_id": 39752664, "comment_id": 66801533, "body": "Please revise your question to include the code which is raising the error. This sounds like it might be a buffer issue that could be resolved with a small delay."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475079425, "post_id": 39752664, "comment_id": 66801543, "body": "That MS Support whitepaper was in regard to xl2003."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475079618, "post_id": 39752664, "comment_id": 66801671, "body": "@Jeeped, I inserted .Range(&quot;A1&quot;).select before the paste picture line, but no difference"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475080056, "post_id": 39752664, "comment_id": 66801975, "body": "If you&#39;re calling this in a loop (13 times?) can you show the code that calls this function?"}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475081748, "post_id": 39753447, "comment_id": 66803043, "body": "Thanks @davidzemens. Appreciate the guidance on bad practice too."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475081772, "post_id": 39753447, "comment_id": 66803058, "body": "No worries, it is a common oversight :)"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475086528, "post_id": 39753447, "comment_id": 66805772, "body": "Sorry I have not yet been able to run your code, but will do that in a couple of hours. Your guidance on DIM actually helped resolved one other problem - I kept getting error with undeclared variables when calling subs and functions despite having done so. I did have to separate each of the variables into its own DIM. Now I see why what I was doing is frown upon!"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 1, "creation_date": 1475087869, "post_id": 39753447, "comment_id": 66806548, "body": "your code work well with one change - Sleep was needed before the paste and does not appear to need it after export. I was able to get it down to 100ms without complaint. Thank you so much."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475088356, "post_id": 39753447, "comment_id": 66806821, "body": "@user110084 yes I think you&#39;re right about the order of <code>Sleep</code> -- the issue is sometimes the <code>Paste</code> can execute before the <code>Copy</code> has finished, and that results in the error. The <code>Sleep</code> produces just enough delay to ensure that Copy has finished allocating to clipboard."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475163145, "post_id": 39753447, "comment_id": 66843151, "body": "Overly optimistic unfortunately. It needed SLEEP 1200 in two more places! Before copy shp inside With ChtObj and before export. Otherwise, it exports an empty chart!"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 1, "creation_date": 1475166265, "post_id": 39753447, "comment_id": 66845088, "body": "I finally got to the bottom of this behaviour. There is a dynamic name range in the native spreadsheet and it is updated in the background after each loop. As the range grew longer, it was taking longer to recalc the sheet. Removing the name range and moving the calculations on the sheet to VBA eliminated the problem. I kept SLEEP 200 in the code just in case."}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475182236, "post_id": 39753447, "comment_id": 66853734, "body": "Spoke too soon once again. It ran without issues for a while, but it started again after running around 7 to 8 batches (each batch has 13 loops with each calling the code above). I started increasing SLEEP (to 5000ms) but eventually even restarting Excel would not overcome it. A full PC reboot did though. What is happening? I tried using CMD to clear the clipboard, didn&#39;t help. Only a full PC reboot would do it."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475184113, "post_id": 39753447, "comment_id": 66854644, "body": "Maybe try Application.CutCopyMode=False after the .Paste? Otherwise idk"}, {"owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "edited": false, "score": 0, "creation_date": 1475185922, "post_id": 39753447, "comment_id": 66855350, "body": "Thank @davidzemens, I did insert the very line hoping that it would clear the clipboard and placed it just before the copy ahead of the offending paste. Very odd, not experienced this before with Excel. It would allow me to run in steps or even click run to continue except that it would export a blank file (not even blank chart) for that particular loop."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1475088362, "last_edit_date": 1475088362, "creation_date": 1475081647, "answer_id": 39753447, "question_id": 39752664, "link": "https://stackoverflow.com/questions/39752664/excel-2010-vba-runtime-error-1004-microsoft-excel-cannot-paste-the-data/39753447#39753447", "title": "Excel 2010 VBA: Runtime error 1004, Microsoft Excel cannot paste the data", "body": "<p>I suspect the loop is causing the issue as the <code>.Export</code> method is running in to itself. Use the WinAPI <code>Sleep</code> function to insert a small delay (1 second is probably enough).  Also, I've cleaned up the code a little bit:</p>\n\n<pre><code>Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) 'For use in timer function\n\nSub PutPic(FN)\n\nDim fname As String\nDim shp As Picture\nDim ChtObj As ChartObject\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(2)\n\nfname = \"E:\\Users\\ABCD\\Documents\\EFGH\\\" &amp; FN\n\n'Copy the range of cells\nWith ws\n    .Range(.Cells(1, 1), .Cells(12, 12)).Copy\n\n    'Paste &amp; get a handle on the resulting picture:\n    Set shp = .Pictures.Paste(Link:=False)\nEnd With\n\n'Scale your picture:\nWith shp\n    .ShapeRange.ScaleWidth 2, msoFalse, msoScaleFromTopLeft\n    .ShapeRange.ScaleHeight 2, msoFalse, msoScaleFromMiddle\nEnd With\n\n'Add the ChtObj frame:\nSet ChtObj = ws.ChartObjects.Add(100, 100, 400, 400)\n'Size the chart, paste the picture in the chart, export\nWith ChtObj\n    .Width = shp.Width\n    .Height = shp.Height\n    shp.Copy\n    Sleep 1000  '1000 milliseconds = 1 second\n    .Chart.Paste\n    .Chart.Export Filename:=fname, FilterName:=\"png\"\n    .Delete\nEnd With\n\nshp.Delete\n\nEnd Sub\n</code></pre>\n\n<p>Note that this is generally frowned upon:</p>\n\n<pre><code> Dim i, j, k As Long\n Dim NMG, NMB As String\n\n Dim FNGBSig As String\n Dim FNUnivSig As String\n Dim BatchStart, Batch As Long\n</code></pre>\n\n<p>This declares <code>i as Variant, j as Variant, k as Long</code>, etc.  To do multiple declarations inline, you still need to specify the data type:</p>\n\n<pre><code>Dim i as Long, j as Long, k as Long\nDim NMG as String, NMB as String\n' etc...\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 6828374, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8e991fe8e0e112e80e8ec84a0e31ee20?s=128&d=identicon&r=PG&f=1", "display_name": "user110084", "link": "https://stackoverflow.com/users/6828374/user110084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "accepted_answer_id": 39753447, "answer_count": 1, "score": 1, "last_activity_date": 1475161868, "creation_date": 1475079083, "last_edit_date": 1475161868, "question_id": 39752664, "link": "https://stackoverflow.com/questions/39752664/excel-2010-vba-runtime-error-1004-microsoft-excel-cannot-paste-the-data", "title": "Excel 2010 VBA: Runtime error 1004, Microsoft Excel cannot paste the data", "body": "<p>I had been running a cut and paste picture routine for some time and all of a sudden Excel starting giving me this run time error. It had been working fine for several days until now (no OS update or reboot, though I did try closing and reopening Excel to see if it helped). Stranger still, the script does a batch copy and paste.picture, the same range (with recalculated values) is copied and pasted 13 times and the error message pops up usually in the last loop or occasionally at some random point.</p>\n\n<p>I looked up support.microsoft.com/en-us/kb/905164:\n\"This issue may occur if either of the following conditions is true:</p>\n\n<pre><code>The Microsoft Visual Basic for Applications (VBA) macro copies and pastes one whole row in an Excel 2003 workbook.\nThe Microsoft VBA macro copies and pastes a range of 2,516 rows or more rows in an Excel 2003 workbook.\"\n</code></pre>\n\n<p>However, I am copying a range of 12,12 cells, from A1 to L12 to be exact, not even close to an entire row. I have tried using range.offset, xldown, rannge(cells(1,1), cells(12,12)) but none of these helped.</p>\n\n<p>Has anyone experienced something similar?</p>\n\n<pre><code>Sub PutPic(ByRef FN As String)\n\n\n Dim fname As String\n fname = \"E:\\Users\\ABCD\\Documents\\EFGH\\\" &amp; FN\n Worksheets(2).Range(Cells(1, 1), Cells(12, 12)).Select\n 'Sheets(\"sheet2\").Range(\"A1:l12\").Select\n Selection.Copy\n 'Sheets(\"sheet2\").Range(\"a1\").Select\n ActiveSheet.Pictures.Paste(Link:=False).Select\n Selection.Name = \"Pic\"\n Selection.ShapeRange.ScaleWidth 2, msoFalse, msoScaleFromTopLeft\n Selection.ShapeRange.ScaleHeight 2, msoFalse, msoScaleFromMiddle\n\n Dim ChtObj As ChartObject\n With ThisWorkbook.Worksheets(2)\n    .Activate\n    Set ChtObj = .ChartObjects.Add(100, 100, 400, 400)\n    ChtObj.Name = \"PicFrame\"\n    ChtObj.Width = .Shapes(\"Pic\").Width\n    ChtObj.Height = .Shapes(\"Pic\").Height\n\n    ActiveSheet.Shapes.Range(Array(\"Pic\")).Select\n    Selection.Copy\n\n    ActiveSheet.ChartObjects(\"PicFrame\").Activate\n    ActiveChart.Paste\n\n    ActiveChart.Export Filename:=fname, FilterName:=\"png\"\n    ChtObj.Delete\n    ActiveSheet.Shapes.Range(Array(\"Pic\")).Delete\n\n End With\nEnd Sub\n</code></pre>\n\n<p>The sub with the looping routine, totally ordinary which feeds a filename to the subroutine.</p>\n\n<pre><code>Public Sub MainRun()\n Dim i, j, k As Long\n Dim NMG, NMB As String\n\n Dim FNGBSig As String\n Dim FNUnivSig As String\n Dim BatchStart, Batch As Long\n BatchStart = ThisWorkbook.Worksheets(2).Cells(15, 1).Value + 1\n Batch = 13\n For i = BatchStart To BatchStart + Batch - 1\n\n'Some calculations that refresh values in range A1:L12\n\nFNGBSig = i &amp; \"GoodBad.png\"\n\n        PutPic FNGBSig\n\n Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475078359, "post_id": 39752310, "comment_id": 66800831, "body": "What is the purpose of finding the Outlook executable? If it&#39;s installed on the machine, all you need to do is <code>CreateObject(&quot;Outlook.Application&quot;)</code> and then set it to <code>.Visible</code>."}, {"owner": {"reputation": 17, "user_id": 2880992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a8b9e43d3e8b4c9922f8e8f56e38a6?s=128&d=identicon&r=PG&f=1", "display_name": "DDietz", "link": "https://stackoverflow.com/users/2880992/ddietz"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475079854, "post_id": 39752310, "comment_id": 66801837, "body": "Maybe I&#39;m going about this wrong, but I&#39;m thinking that because different users may have different versions of office installed, and some may have 32-bit vs 64-bit, the executable would be in different locations.  The outlook routine that I posted works perfectly for my machine, but most likely not for every user that will be using this."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 2880992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a8b9e43d3e8b4c9922f8e8f56e38a6?s=128&d=identicon&r=PG&f=1", "display_name": "DDietz", "link": "https://stackoverflow.com/users/2880992/ddietz"}, "edited": false, "score": 0, "creation_date": 1475079349, "post_id": 39752499, "comment_id": 66801497, "body": "I have to admit that I&#39;m not a vba expert first of all.  I&#39;ve tried the code that you provided and the Outlook application opens for a few seconds and then closes.  The outlook routine that I originally posted works exactly how I want it to, but I need it to work for users with 32-bit or 64-bit office.  Maybe I went about it wrong, but I&#39;m learning as I go.  Is there any way I can get the path for myFile to be passed to the outlook routine as the PATH_TO_OUTLOOK constant or anything similar?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 17, "user_id": 2880992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a8b9e43d3e8b4c9922f8e8f56e38a6?s=128&d=identicon&r=PG&f=1", "display_name": "DDietz", "link": "https://stackoverflow.com/users/2880992/ddietz"}, "edited": false, "score": 0, "creation_date": 1475080105, "post_id": 39752499, "comment_id": 66802010, "body": "I&#39;ve updated the code so the inbox is visible once the code finishes.  To pass <code>myFile</code> to your Outlook routine you&#39;ll need to either set myFile as a variable visible to the whole module (declared at the top of the module), or update the your procedure name to <code>Sub Outlook(PATH_TO_OUTLOOK AS String)</code> and then when you call it use <code>Outlook myFile</code> or <code>CALL Outlook(myFile)</code> (the call keyword isn&#39;t required)."}, {"owner": {"reputation": 17, "user_id": 2880992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a8b9e43d3e8b4c9922f8e8f56e38a6?s=128&d=identicon&r=PG&f=1", "display_name": "DDietz", "link": "https://stackoverflow.com/users/2880992/ddietz"}, "edited": false, "score": 0, "creation_date": 1475080311, "post_id": 39752499, "comment_id": 66802146, "body": "Thank you both so much for your help!  With your help, I was finally able to get it working the way I want it to.  I&#39;m sure it&#39;s not as elaborate as it could be, but it&#39;s working!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1475079897, "last_edit_date": 1475079897, "creation_date": 1475078620, "answer_id": 39752499, "question_id": 39752310, "link": "https://stackoverflow.com/questions/39752310/excel-vba-pass-file-path-to-routine-to-open-outlook/39752499#39752499", "title": "Excel VBA pass file path to routine to open Outlook", "body": "<p>Exactly as Comintern commented - </p>\n\n<pre><code>Sub Test()\n\n    Dim oOL As Object\n    Dim ns As Object\n    Dim fldr As Object\n\n    Set oOL = CreateOL\n\n    Set ns = oOL.GetNameSpace(\"MAPI\")\n    Set fldr = ns.GetDefaultFolder(6) 'olFolderInbox\n    fldr.display\n\nEnd Sub\n\nPublic Function CreateOL() As Object\n\n    Dim oTmpOL As Object\n\n    On Error GoTo ERROR_HANDLER\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Creating an instance of Outlook is different from Excel. '\n    'There can only be a single instance of Outlook running,  '\n    'so CreateObject will GetObject if it already exists.     '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Set oTmpOL = CreateObject(\"Outlook.Application\")\n\n    Set CreateOL = oTmpOL\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure CreateOL.\"\n            Err.Clear\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 2880992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5a8b9e43d3e8b4c9922f8e8f56e38a6?s=128&d=identicon&r=PG&f=1", "display_name": "DDietz", "link": "https://stackoverflow.com/users/2880992/ddietz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 39752499, "answer_count": 1, "score": 0, "last_activity_date": 1475081114, "creation_date": 1475078052, "question_id": 39752310, "link": "https://stackoverflow.com/questions/39752310/excel-vba-pass-file-path-to-routine-to-open-outlook", "title": "Excel VBA pass file path to routine to open Outlook", "body": "<p>I have a few routines that I'm trying to get to work together.  The first 2 find the outlook.exe file on the user's machine and I would like the 3rd to use that file to open Outlook if it isn't already running.  The issue I'm having is being able to pass that file's path to the 3rd routine.  Here's my code.  Any help would be appreciated.</p>\n\n<pre><code>    Sub GetSubFolders()\n\n        Dim fso As New FileSystemObject\n        Dim f As Folder, sf As Folder\n        Dim myFile As File\n\n        On Error Resume Next\n\n        Set f = fso.GetFolder(\"C:\\Program Files\\\")\n\n        For Each myFile In f\n        Next\n\n        For Each sf In f.SubFolders\n            Call Recursive(sf)\n        Next\n\n        Set f = fso.GetFolder(\"C:\\Program Files (x86)\\\")\n\n        For Each myFile In f\n        Next\n\n        For Each sf In f.SubFolders\n            Call Recursive(sf)\n        Next\n\n    End Sub\n    Sub Recursive(sf As Folder)\n        Dim fso As New FileSystemObject\n        Dim f, nsf As Folder\n        Dim myFile As File\n        Dim s As String\n        Dim ofile As String\n\n        On Error Resume Next\n\n        Set f = fso.GetFolder(sf)\n\n        For Each myFile In f.Files\n            If Right(myFile, 11) = \"outlook.exe\" Then\n            Range(\"A1\").Value = myFile.Path\n            Call outlook\n            End\n            End If\n        Next\n        For Each nsf In f.SubFolders\n            Recursive nsf\n        Next\n\n\n    End Sub\n    Sub outlook()\n    Const PATH_TO_OUTLOOK = \"\"\"C:\\Program Files\\Microsoft Office 15\\root\\office15\\outlook.exe\"\"\"\n    Const SHOW_MAXIMIZED = 3\n    Const MINIMIZE = 1\n\n    Dim oShell, oOutlook As Object\n    On Error Resume Next\n    Set oOutlook = GetObject(, \"Outlook.Application\")\n    Set oShell = CreateObject(\"WScript.Shell\")\n    On Error GoTo 0\n\n    If oOutlook Is Nothing Then\n\n        ' Open Outlook\n        oShell.Run PATH_TO_OUTLOOK, SHOW_MAXIMIZED, False\n\n        On Error Resume Next\n\n        ' Grab a handle to the Outlook Application and minimize\n        Set oOutlook = WScript.CreateObject(\"Outlook.Application\")\n        WScript.Sleep (10000)\n        oOutlook.ActiveExplorer.WindowState = SHOW_MAXIMIZED\n\n        ' Loop on error to account for slow startup in which case the\n        ' process and/or the main Outlook window is not available\n          Err.Clear\n          WScript.Sleep (10000)\n          Set oOutlook = Nothing\n          Set oOutlook = CreateObject(\"Outlook.Application\")\n          oOutlook.ActiveExplorer.WindowState = MINIMIZE\n\n\n        Set oOutlook = Nothing\n        Set oShell = Nothing\n    End If\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1475077669, "post_id": 39752137, "comment_id": 66800391, "body": "Is the subroutine recorded in the <code>ThisWorkbook</code> object instead of a VBA Module?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1475077687, "post_id": 39752137, "comment_id": 66800407, "body": "Worksheet_Calculate() does not have a <code>Target</code> object.  Since it is just two remove the Select case and just use the Range.Value: <code>.Axes(xlCategory).MaximumScale = Range(&quot;$H$47&quot;).Value</code>"}, {"owner": {"reputation": 11, "user_id": 6894797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7596e1262eea4742e8d31df812a51f8d?s=128&d=identicon&r=PG", "display_name": "Kara Norton", "link": "https://stackoverflow.com/users/6894797/kara-norton"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1475236806, "post_id": 39752137, "comment_id": 66875020, "body": "The subroutine is recorded in &#39;Sheet1&#39;. @Jordan"}, {"owner": {"reputation": 11, "user_id": 6894797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7596e1262eea4742e8d31df812a51f8d?s=128&d=identicon&r=PG", "display_name": "Kara Norton", "link": "https://stackoverflow.com/users/6894797/kara-norton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475236909, "post_id": 39752137, "comment_id": 66875086, "body": "@ScottCraner After removing Select case, it now says &quot;Method MaximumScale of object Axis failed&quot;."}, {"owner": {"reputation": 11, "user_id": 6894797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7596e1262eea4742e8d31df812a51f8d?s=128&d=identicon&r=PG", "display_name": "Kara Norton", "link": "https://stackoverflow.com/users/6894797/kara-norton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1475237203, "post_id": 39752137, "comment_id": 66875245, "body": "I figured it out. @ScottCraner you&#39;re suggestion worked after I changed the xlCategory to xlValue. I thought xlCategory was always the x-axis but apparently for a bar graph xlValue is the x-axis. Thank you all !!"}], "owner": {"reputation": 11, "user_id": 6894797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7596e1262eea4742e8d31df812a51f8d?s=128&d=identicon&r=PG", "display_name": "Kara Norton", "link": "https://stackoverflow.com/users/6894797/kara-norton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475084828, "creation_date": 1475077503, "last_edit_date": 1475084828, "question_id": 39752137, "link": "https://stackoverflow.com/questions/39752137/vba-worksheet-calculate-not-triggering", "title": "VBA Worksheet_Calculate Not Triggering", "body": "<p>I'm trying to write a macro in <strong>Excel 2007</strong> to link the <strong>x</strong>-axis of a chart to a specified cells in the worksheet. The cells that I'm targeting for my max and min axis values contain the <code>INDEX</code> function which I'm using in conjunction with a scroll bar. As the scroll bar moves, the cell values change according to the <code>INDEX</code> function, and I'm trying to link these changes to the <strong>x</strong>-axis on the chart. </p>\n\n<p>I can't get the following code to execute: </p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nWith ActiveSheet.ChartObjects(\"Chart 7\").Chart\n      Select Case Target.Address\n        Case \"$H$47\"\n          .Axes(xlCategory).MaximumScale = Target.Value\n        Case \"$H$34\"\n         .Axes(xlCategory).MinimumScale = Target.Value\n      End Select\n  End With\nEnd Sub\n</code></pre>\n\n<p>Can anyone tell me what I'm doing wrong?</p>\n\n<p>Thanks,\nKara</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1475143665, "post_id": 39751871, "comment_id": 66829209, "body": "Which line throws the error?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6890438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f113423359d83f3468b2c810d1e16651?s=128&d=identicon&r=PG&f=1", "display_name": "user6890438", "link": "https://stackoverflow.com/users/6890438/user6890438"}, "is_accepted": false, "score": 0, "last_activity_date": 1475095381, "creation_date": 1475095381, "answer_id": 39757287, "question_id": 39751871, "link": "https://stackoverflow.com/questions/39751871/type-mismatch-error-i-dont-know-what-to-do/39757287#39757287", "title": "type mismatch error i dont know what to do", "body": "<p>Try replacing your IsNull with Nz:</p>\n\n<pre><code> If Nz(DLookup(\"UserLogin\", \"Accounts\", \"UserLogin='\" &amp; Me.txtLoginID.Value &amp; \"'\")) Or _\nNz(DLookup(\"Password\", \"Accounts\", \"Password='\" &amp; Me.txtPassword.Value &amp; \"'\")) Then\n    MsgBox \"Incorrect Login ID or Password\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6894773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbda16342dd3e287776e4ce6dd7a70b?s=128&d=identicon&r=PG&f=1", "display_name": "Edriene Stephen Mendoza", "link": "https://stackoverflow.com/users/6894773/edriene-stephen-mendoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1475140071, "creation_date": 1475076736, "last_edit_date": 1475140071, "question_id": 39751871, "link": "https://stackoverflow.com/questions/39751871/type-mismatch-error-i-dont-know-what-to-do", "title": "type mismatch error i dont know what to do", "body": "<p>I keep getting a type mis-match error, and I'm not sure what I'm doing incorrectly.</p>\n\n<p>This is what I have tried so far:</p>\n\n<pre><code>Private Sub Command1_Click()\nDim UserLevel As Integer\n\nIf IsNull(Me.txtLoginID) Then\n    MsgBox \"Please Enter Login ID\", vbInformation, \"Login ID Required\"\n    Me.txtLoginID.SetFocus\nElseIf IsNull(Me.txtPassword) Then\n    MsgBox \"Please Enter Password\", vbInformation, \"Password Required\"\n    Me.txtPassword.SetFocus\nElse\n    If (IsNull(DLookup(\"UserLogin\", \"Accounts\", \"UserLogin='\" &amp; Me.txtLoginID.Value &amp; \"'\"))) Or _\n    (IsNull(DLookup(\"Password\", \"Accounts\", \"Password='\" &amp; Me.txtPassword.Value &amp; \"'\"))) Then\n        MsgBox \"Incorrect Login ID or Password\"\n    Else\n        UserLevel = DLookup(\"UserSecurity\", \"Accounts\", \"UserLogin= '\" &amp; Me.txtLoginID.Value &amp; \"'\")\n        DoCmd.Close\n            If UserLevel = admin Then\n        DoCmd.OpenForm \"Administrator\"\n    Else\n         DoCmd.OpenForm \"Sales\"\n        End If\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1475228814, "creation_date": 1475228814, "answer_id": 39788512, "question_id": 39751701, "link": "https://stackoverflow.com/questions/39751701/change-style-and-format-of-tables/39788512#39788512", "title": "Change style and format of tables", "body": "<p>Try this</p>\n\n<pre><code>Dim tbl As Table\nFor Each tbl In ActiveDocument.Tables\n    tbl.Style = \"K2 Table\"\n\n    tbl.PreferredWidthType = wdPreferredWidthPoints\n    tbl.PreferredWidth = CentimetersToPoints(17)        \nNext\n</code></pre>\n\n<p>I'm guessing the second part doesn't work when you don't have a table selected</p>\n"}], "owner": {"reputation": 1, "user_id": 6532665, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/86f8c43c658b13b1476831c14b9d1430?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Faith", "link": "https://stackoverflow.com/users/6532665/daniel-faith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490464458, "creation_date": 1475076321, "last_edit_date": 1490464458, "question_id": 39751701, "link": "https://stackoverflow.com/questions/39751701/change-style-and-format-of-tables", "title": "Change style and format of tables", "body": "<p>I have code that is supposed to update the style of the tables in a Word document and then change the width to 17cm.</p>\n\n<pre><code>Sub ConvertTables()\n\n    Dim tbl As Table\n    For Each tbl In ActiveDocument.Tables\n        tbl.Style = \"K2 Table\"\n    Next\n\n    Selection.Tables(1).PreferredWidthType = wdPreferredWidthPoints\n    Selection.Tables(1).PreferredWidth = CentimetersToPoints(17)\nEnd Sub\n</code></pre>\n\n<p>When I run the macro, it stops at the second part. Sometimes it will run in the VB viewer but never from running the macro through the Developer.</p>\n\n<p>What is wrong with this piece of VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475076484, "post_id": 39751539, "comment_id": 66799598, "body": "While your target is contiguous (<code>A2:AQ2</code>), your source is not and there does not appear to be a mathematical pattern from what little you&#39;ve shown. You might try <code>Worksheets(&quot;Data&quot;).Range(&quot;XFD2&quot;).End(xlToLeft).Offset(0, 1).PasteSpecial xlPasteValues</code> but only after the first one is pasted into A2."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475076572, "post_id": 39751539, "comment_id": 66799658, "body": "That;s a lot of cli[board action. Have you considered putting it into an array and bulk dumping the array of values into the data worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1475077000, "post_id": 39751881, "comment_id": 66799949, "body": "I&#39;d suggest grabbing a reference to the source and target sheets <i>before</i> starting the loop for more efficiency."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475077262, "post_id": 39751881, "comment_id": 66800136, "body": "Why not write the values into <code>SomeArray</code> using the cell addresses in <code>SomeArray</code> then dump <code>SomeArray</code> back onto the worksheet with a transpose?"}], "tags": [], "owner": {"reputation": 83, "user_id": 6694804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6fDZj.jpg?s=128&g=1", "display_name": "JetSetJim", "link": "https://stackoverflow.com/users/6694804/jetsetjim"}, "is_accepted": false, "score": 1, "last_activity_date": 1475076778, "creation_date": 1475076778, "answer_id": 39751881, "question_id": 39751539, "link": "https://stackoverflow.com/questions/39751539/is-it-possible-to-loop-through-the-data-worksheet/39751881#39751881", "title": "Is it possible to loop through the Data Worksheet?", "body": "<p>Yes. The following may not be the best code, but it seems your source cells are not contiguously loopable...</p>\n\n<pre><code>Dim SomeArray(X) As String      'Define \"X\" suitably for your input cells\n\nSomeArray(0) = \"D9\"\nSomeArray(1) = \"D10\"\nSomeArray(2) = \"J9\"\nSomeArray(3) = \"J10\"\netc...\n</code></pre>\n\n<p>Then you loop over the source cells array and copy each one:</p>\n\n<pre><code>curOffset=0\nFor i = LBound(SomeArray) To UBound(SomeArray)\n    Worksheets(\"FORM TEMPLATE\").Range(SomeArray(i)).Copy\n    Worksheets(\"Data\").Range(\"A2\").Offset(0,curOffset).PasteSpecial xlPasteValues\n    curOffset = curOffset + 1\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1475077361, "post_id": 39752006, "comment_id": 66800199, "body": "Seems the two <code>With Worksheets(&quot;Data&quot;)</code> blocks aren&#39;t buying you anything really; the reference is acquired and dereferenced twice - IMO a better solution would be to either nest the <code>With</code> blocks or keep a local <code>Worksheet</code> variable for the &quot;Data&quot; sheet; an even better solution would refer to worksheets by their <i>code name</i>, using the already-existing global objects we get for free, e.g. <code>DataSheet.Range(...)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1475077496, "post_id": 39752006, "comment_id": 66800271, "body": "Fair enough. I try to proselytize the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980.aspx\" rel=\"nofollow noreferrer\">.Parent</a> worksheet property as much as I can but I will admit that occasionally I go overboard."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1475077112, "creation_date": 1475077112, "answer_id": 39752006, "question_id": 39751539, "link": "https://stackoverflow.com/questions/39751539/is-it-possible-to-loop-through-the-data-worksheet/39752006#39752006", "title": "Is it possible to loop through the Data Worksheet?", "body": "<p>Load the values into an array and assign values to the array. After loading the array in an orderly fashion, dump it all back onto the Data worksheet at once.</p>\n\n<pre><code>Sub wqewtry()\n    Dim a As Long, arr As Variant\n\n    'preload and shape the array\n    With Worksheets(\"Data\")\n        arr = .Range(\"A2:AQ2\").Value2\n    End With\n\n    With Worksheets(\"FORM TEMPLATE\")\n        'use .Value2 for text or numbers; .Value for dates\n        a = a + 1: arr(1, a) = .Range(\"D9\").Value2\n        a = a + 1: arr(1, a) = .Range(\"D10\").Value2\n        a = a + 1: arr(1, a) = .Range(\"J9\").Value2\n        a = a + 1: arr(1, a) = .Range(\"J10\").Value2\n        a = a + 1: arr(1, a) = .Range(\"J11\").Value2\n    End With\n\n    'dump back into the data worksheet\n    With Worksheets(\"Data\")\n        .Range(\"A2:AQ2\") = arr\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This should make it easier to write the code while keeping it organized and making it faster.</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1475077119, "creation_date": 1475077119, "answer_id": 39752008, "question_id": 39751539, "link": "https://stackoverflow.com/questions/39751539/is-it-possible-to-loop-through-the-data-worksheet/39752008#39752008", "title": "Is it possible to loop through the Data Worksheet?", "body": "<p>As JetSetJim said - your source cells aren't easily identified.</p>\n\n<pre><code>Sub Test()\n\n    Dim rToCopy As Range\n    Dim rCell As Range\n    Dim lColNum As Long\n\n    lColNum = 1\n    With ThisWorkbook\n        Set rToCopy = .Worksheets(\"FORM TEMPLATE\").Range(\"D9:D10,J9:J11\")\n        With .Worksheets(\"Data\")\n            For Each rCell In rToCopy\n                .Cells(2, lColNum) = rCell.Value\n                lColNum = lColNum + 1\n            Next rCell\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1475077953, "post_id": 39752148, "comment_id": 66800564, "body": "<code>Option Base 1</code> would introduce a bug here. Best practice is to never assume what the lower bound of a dynamic array might be; <code>For i = LBound(varSource) To UBound(varSource)</code>. Also, you could skip the string variable and <code>Split</code> processing by simply inlining the array declaration with <code>varSource = Array(&quot;D9&quot;,&quot;D10&quot;,&quot;J9&quot;,&quot;J10&quot;,&quot;J11&quot;)</code>, and lastly calling <code>Worksheets(&quot;SheetName&quot;)</code> in a loop makes quite a lot of overhead for little reason (get the sheet object <i>before</i> you start looping)... and I&#39;ll argue that <code>.Offset</code> makes everything <i>harder</i> to maintain and reason about."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1475078018, "post_id": 39752148, "comment_id": 66800602, "body": "Actually, exactly what is <code>Set rngSource = rngSource.Offset(0, 1)</code> accomplishing? <code>rngSource</code> isn&#39;t used anywhere in your loop. It&#39;s also undeclared."}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1475078272, "post_id": 39752148, "comment_id": 66800763, "body": "Good point - should&#39;ve been rngTarget, not rngsource. My mistake"}], "tags": [], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "is_accepted": false, "score": 0, "last_activity_date": 1475078302, "last_edit_date": 1475078302, "creation_date": 1475077547, "answer_id": 39752148, "question_id": 39751539, "link": "https://stackoverflow.com/questions/39751539/is-it-possible-to-loop-through-the-data-worksheet/39752148#39752148", "title": "Is it possible to loop through the Data Worksheet?", "body": "<p>A method I like to use when working with a random set of values that can't be automatically determined is to create an array from a constant. In your case, something like:</p>\n\n<pre><code>Const csSource as string = \"D9|D10|J9|J10|J11\"\n\nDim varSource as Variant, i as integer\nDim rngTarget as range\n\nvarsource = split(cssource,\"|\")\nset rngTarget = worksheets(\"Data\").range(\"A2\")\n\nfor i = 0 to ubound(varSource)\n    rngtarget.value = worksheets(\"Form Template\").range(varsource(i)).value\n    set rngTarget = rngTarget.offset(0, 1)\nnext i\n</code></pre>\n\n<p>You can add new source values in the constant at the top as needed. This is a little more memory heavy than other methods, since it uses variants, but it's a lot easier to code and maintain.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1475081870, "creation_date": 1475081870, "answer_id": 39753514, "question_id": 39751539, "link": "https://stackoverflow.com/questions/39751539/is-it-possible-to-loop-through-the-data-worksheet/39753514#39753514", "title": "Is it possible to loop through the Data Worksheet?", "body": "<ul>\n<li>Create an array to hold the data</li>\n<li>Resize the array to match the number of cells in the range</li>\n<li>Loop the cells in the range</li>\n<li>Increment the counter</li>\n<li>Add the value of the current cell to the array</li>\n<li>Size the destination range to fit the data and assign the array to this range</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub LoopData()\n    Dim Data()\n    Dim x As Long\n    Dim c As Range\n\n    With Worksheets(\"FORM TEMPLATE\").Range(\"D9,D10,J9:J11\")\n        ReDim Data(1 To .Cells.Count)\n\n        For Each c In .Cells\n            x = x + 1\n            Data(x) = c.Value\n        Next\n        Worksheets(\"Data\").Range(\"B2\").Resize(1, UBound(Data)) = Data\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4552023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fd27b3115916d610b0c9abab0afe65?s=128&d=identicon&r=PG&f=1", "display_name": "K.Reed", "link": "https://stackoverflow.com/users/4552023/k-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 39753514, "answer_count": 5, "score": 0, "last_activity_date": 1475081870, "creation_date": 1475075913, "question_id": 39751539, "link": "https://stackoverflow.com/questions/39751539/is-it-possible-to-loop-through-the-data-worksheet", "title": "Is it possible to loop through the Data Worksheet?", "body": "<p>I was wondering if there was a way to loop through my Data worksheet, rather than coding it out from A2 to AQ2?</p>\n\n<pre><code>Worksheets(\"FORM TEMPLATE\").Range(\"D9\").Copy\nWorksheets(\"Data\").Range(\"A2\").PasteSpecial xlPasteValues\n\nWorksheets(\"FORM TEMPLATE\").Range(\"D10\").Copy\nWorksheets(\"Data\").Range(\"B2\").PasteSpecial xlPasteValues\n\nWorksheets(\"FORM TEMPLATE\").Range(\"J9\").Copy\nWorksheets(\"Data\").Range(\"C2\").PasteSpecial xlPasteValues\n\nWorksheets(\"FORM TEMPLATE\").Range(\"J10\").Copy\nWorksheets(\"Data\").Range(\"D2\").PasteSpecial xlPasteValues\n\nWorksheets(\"FORM TEMPLATE\").Range(\"J11\").Copy\nWorksheets(\"Data\").Range(\"E2\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"tags": ["vba", "excel", "listbox", "label"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "edited": false, "score": 0, "creation_date": 1475080047, "post_id": 39751541, "comment_id": 66801965, "body": "Is there also a way to auto update Label6? As of right know i have to manually click on it to show the update."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1475076600, "last_edit_date": 1475076600, "creation_date": 1475075922, "answer_id": 39751541, "question_id": 39751486, "link": "https://stackoverflow.com/questions/39751486/change-label-caption-based-on-listbox-selection/39751541#39751541", "title": "Change Label Caption based on ListBox selection", "body": "<p>Unless your listbox is Multiselect, you don't need to loop through it:</p>\n\n<pre><code>Private Sub Label6_Click()\n    Dim lItem As Long\n    lItem = ListBox1.ListIndex\n    If lItem &lt;&gt; -1 then\n        Select Case ListBox1.List(lItem)\n            Case \"AAA\", \"BBB\"\n                Me.Label6.Caption = \"Select Graphite\"\n            Case Else\n                Me.Label6.Caption = \"Select Oil System\"\n        End Select\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1984, "favorite_count": 0, "accepted_answer_id": 39751541, "answer_count": 1, "score": 0, "last_activity_date": 1475076764, "creation_date": 1475075744, "last_edit_date": 1531164843, "question_id": 39751486, "link": "https://stackoverflow.com/questions/39751486/change-label-caption-based-on-listbox-selection", "title": "Change Label Caption based on ListBox selection", "body": "<p>What is the best way to change the Label Name depending of what the user selects in the ListBox.\nSo far I have this:</p>\n\n<pre><code>Private Sub Label6_Click()\n    Dim lItem As Long\n    For lItem = 0 To ListBox1.ListIndex &lt;&gt; -1\n        If ListBox1.Selected(lItem) = \"AAA\" Or \"BBB\" Then\n            Me.Label6.Caption = \"Select Graphite\"\n        Else\n            Me.Label6.Caption = \"Select Oil System\"\n        End If\n    Next lItem\nEnd Sub\n</code></pre>\n\n<p>Unfortunately its not working, what am I missing?\nThank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475075656, "post_id": 39751378, "comment_id": 66799010, "body": "Have a look at updating <code>Application.StatusBar</code> with <code>x</code> for one way of doing it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1475075677, "post_id": 39751378, "comment_id": 66799022, "body": "Forget the loop and use <code>.range(.cells(1, 1), .cells(.rows.count, 1).end(xlup)).offset(0,1).FormulaR1C1 = &quot;=trim(RC[-1])&quot;</code> Please note that the code I&#39;ve included references a worksheet defined by a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475076005, "post_id": 39751530, "comment_id": 66799254, "body": "The status bar text make blink a lot if you keep rewriting the same thing into it. I usually store the new formatted value and only actually write it if it is different."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1475076137, "post_id": 39751530, "comment_id": 66799367, "body": "I suggest a few changes: 1. ScreenUpdating needs to be reset. 2. You need a DoEvents every so often or the StatusBar/Excel won&#39;t display updates if he&#39;s doing a large number of cells. Try <code>If Right(x, 3) = &quot;000&quot; Then DoEvents</code> (I think Right won&#39;t break on numbers with less than 3 digits, not sure)"}, {"owner": {"reputation": 1, "user_id": 6894317, "user_type": "registered", "profile_image": "https://graph.facebook.com/1165217843517411/picture?type=large", "display_name": "Wei Hau", "link": "https://stackoverflow.com/users/6894317/wei-hau"}, "edited": false, "score": 0, "creation_date": 1475189658, "post_id": 39751530, "comment_id": 66856476, "body": "Thanks ! I but i have question on this:   lRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row  If the first row is at A5, so it should be : lRow = .Range(&quot;A5&quot; &amp; .Rows.Count).End(xlUp).Row     ?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1475191724, "post_id": 39751530, "comment_id": 66857058, "body": "No, that wouldn&#39;t work. The portion <code>.Range(&quot;A5&quot; &amp; .Rows.Count)</code> would evaluate to (in .xlsx files) <code>.Range(&quot;A1048581&quot;)</code> which is more rows than Excel holds."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1475076883, "last_edit_date": 1475076883, "creation_date": 1475075878, "answer_id": 39751530, "question_id": 39751378, "link": "https://stackoverflow.com/questions/39751378/updating-excel-status-bar-in-vba-loop/39751530#39751530", "title": "Updating Excel Status Bar in VBA Loop", "body": "<p>I would take this approach. I like a for loop better, and this will show you the % complete in the status bar.</p>\n\n<pre><code>Sub StatusBarExample()\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = True\nApplication.StatusBar = \"Trimming...\"\nDim x As Long\nDim lRow as Long\nDim prePct as Single, newPct as Single\n\nnewPct = 0\nprePct = 0\nWith ThisWorkbook.Sheets(\"Sheet Name Goes Here\")\n   lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n   For x = 1 to lRow\n      .Cells(x,2).FormulaR1C1 = \"=trim(RC[-1])\"\n      newPct = x/lRow\n\n      If newPct &gt; prePct + .01\n         DoEvents\n         prePct = newPct\n      End If\n\n      Application.StatusBar = \"Trimming...\" &amp; Format(x/lRow,\"0.00%\") &amp; \" Complete\"\n   Next x\nApplication.StatusBar = False\nApplication.ScreeUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thank you for the suggested edits. I made a couple changes. In the line <code>If newPct &gt; prePct + .01</code>, you may need to change the <code>.01</code> to something else depending on the amount of data.</p>\n"}], "owner": {"reputation": 1, "user_id": 6894317, "user_type": "registered", "profile_image": "https://graph.facebook.com/1165217843517411/picture?type=large", "display_name": "Wei Hau", "link": "https://stackoverflow.com/users/6894317/wei-hau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5393, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475076883, "creation_date": 1475075428, "last_edit_date": 1475075820, "question_id": 39751378, "link": "https://stackoverflow.com/questions/39751378/updating-excel-status-bar-in-vba-loop", "title": "Updating Excel Status Bar in VBA Loop", "body": "<p>I have a macro code to perform trimming for data. Below is my code:</p>\n\n<pre><code>Sub StatusBarExample()\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = True\nApplication.StatusBar = \"Trimming...\"\nDim x As Long\nx = 1\nDo While Cells(x, 1) &lt;&gt; \"\"\nCells(x, 2).Select\nActiveCell.FormulaR1C1 = \"=trim(RC[-1])\"\nx = x + 1\nLoop\nApplication.Wait Now + TimeValue(\"00:00:02\")\nApplication.StatusBar = False\nEnd Sub\n</code></pre>\n\n<p>The number of data always changes, which is why I use the <code>Do While</code> loop. With this code, I only can see a message \"Trimming\" without knowing the progress in percentage. Can anyone help me to improve this code?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6894757, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894757/werrf"}, "is_accepted": false, "score": 0, "last_activity_date": 1475076479, "creation_date": 1475076479, "answer_id": 39751764, "question_id": 39751342, "link": "https://stackoverflow.com/questions/39751342/vba-to-search-from-one-excel-to-another-excel-and-display-cell-address/39751764#39751764", "title": "VBA to search from one excel to another excel and display cell address", "body": "<p>Most likely in this case the error is coming because the Find method is not finding a match, so there's nothing to return. The Find method can be tricky to work with from VBA, especially when looking at xlWhole. Are you sure that there's a matching value in the other sheet? Are you sure the match is exact? Etc. Even merged cells can throw the Find method off.</p>\n\n<p>Normally using worksheet functions will slow things down, but in this case you might be best off using a MATCH function to find the matching row, then returning that value into your cell address.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475303087, "creation_date": 1475075324, "last_edit_date": 1531164843, "question_id": 39751342, "link": "https://stackoverflow.com/questions/39751342/vba-to-search-from-one-excel-to-another-excel-and-display-cell-address", "title": "VBA to search from one excel to another excel and display cell address", "body": "<p>I have two excel file. I am searching the data in another file with the unique email ID. I am taking email ID from one excel file one by one and searching in another excel file. Once the data is found, I want the cell address.\nI am getting error on \" MsgBox cell.Address \" code as \"Object variable or with block variable not set\". Please assist</p>\n\n<pre><code>Dim myFileNameDir As String\nDim myFileNameDir2 As String\nDim ws As Worksheet\nDim ws2 As Worksheet\nDim emailID As String\nDim cell As Range\nDim II As Integer\nDim III As Integer\n\nmyFileNameDir2 = TextBox2.Value\nWorkbooks.Open Filename:=myFileNameDir2, UpdateLinks:=0\nSet ws2 = Worksheets(1)\n\nmyFileNameDir = TextBox1.Value\nWorkbooks.Open Filename:=myFileNameDir, ReadOnly:=True, UpdateLinks:=0\nSet ws = Worksheets(1)\n\n\nII = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row\n\nFor III = 2 To II\nemailID = ws2.Cells(III, \"D\").Value\n\nSet cell = ws.Range(\"AA2:AA1048576\").find(emailID, LookAt:=xlWhole)\nMsgBox cell.Address\n\nNext III\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475075287, "post_id": 39751120, "comment_id": 66798761, "body": "You say you don&#39;t want someone to write <b>all</b> of the code for you, which bit do you have?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1475075451, "post_id": 39751120, "comment_id": 66798872, "body": "<a href=\"https://support.office.com/en-us/article/Step-1-Start-with-the-macro-recorder-6DC53056-1DE1-4483-AA07-63E4E0EFE3C2\" rel=\"nofollow noreferrer\">Step 1 - Start with the macro recorder</a>."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1475075983, "post_id": 39751120, "comment_id": 66799237, "body": "I&#39;ve already tried using the recorder, as I already said. It doesn&#39;t work right when I run it afterwards though. If someone could help me with the code for what I posted above, I think I could do the rest."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1475079624, "post_id": 39752238, "comment_id": 66801678, "body": "Thanks, but at least with that method, that&#39;s not going to work for me. And maybe what I want isn&#39;t possible at all with VBA. I replaced your &quot;Do Stuff&quot; with what I needed, but what I want it to do is to retain the default fill if the value of the cell is changed to a number below 300."}], "tags": [], "owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "is_accepted": false, "score": 0, "last_activity_date": 1475077873, "creation_date": 1475077873, "answer_id": 39752238, "question_id": 39751120, "link": "https://stackoverflow.com/questions/39751120/excel-lots-of-conditional-formatting-converted-to-vba/39752238#39752238", "title": "Excel - lots of conditional formatting converted to VBA", "body": "<p>You can do this fairly easily with a <code>DO-WHILE Loop</code>. I'll give a start for \"D78\" and you should be able to finish the rest.</p>\n\n<pre><code>sub formatCells()\n\n    Dim count as Integer\n    Range(\"D78\").Activate\n\n    count = 0\n    Do While ActiveCell.Offset(count, 0).Value &lt;&gt; \"\"\n        If ActiveCell.Offset(count, 0).Value &gt; 300 Then\n            'Do Stuff\n        End If\n        count = count + 1\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 5656296, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed50544a4557d43add0caac2f8305762?s=128&d=identicon&r=PG&f=1", "display_name": "JBStovers", "link": "https://stackoverflow.com/users/5656296/jbstovers"}, "is_accepted": false, "score": 0, "last_activity_date": 1525193849, "creation_date": 1525193849, "answer_id": 50120570, "question_id": 39751120, "link": "https://stackoverflow.com/questions/39751120/excel-lots-of-conditional-formatting-converted-to-vba/50120570#50120570", "title": "Excel - lots of conditional formatting converted to VBA", "body": "<p>You need to create a FormatCondition object for each rule you want to set.  Here are the basics for setting up a formula-based conditional format.</p>\n\n<pre><code>'Set a variable for the formatcondition to make it easier to work with.\nDim fc As FormatCondition\n\n'Create the formatcondition.\nstrFormula = \"=$A1=$B1\"\nSet fc = Range(\"A:A\").FormatConditions.Add(Type:=xlExpression, Formula1:=strFormula) '(There is a \"Formula2\" property that only applies if you are using one of the built-in conditional formatting rule types. It does not apply if you are using an xlExpression rule type).\n\n'Move it to the top of the list (optional).\nfc.SetFirstPriority\n\n'Set \"Stop if True\" (optional).\nfc.StopIfTrue = True\n\n'Set interior Color (optional).\nfc.Interior.Color = RGB(255,0,0) 'red\n\n'Set borders (optional).\narBorders = Array(xlLeft, xlRight, xlTop, xlBottom)\nFor Each borderConst In arBorders\n    fc.Borders(borderConst).LineStyle = xlContinuous\nNext\n\n'Set font (optional).\nfc.Font.Italic = True\nfc.Font.Bold = True\nfc.Font.Underline = True\n</code></pre>\n\n<p>I would recommend setting up a procedure as below to simplify this process.  I created this one for my own use.  It can only set borders and fill color, but could be modified to set font attributes, etc.</p>\n\n<pre><code>Sub AddFormatCondition(rgAppliesTo, strFormula, Optional bSetFirstPriority, Optional FillColor, Optional bBorders, Optional bStopIfTrue)\n\n    Dim fc As FormatCondition\n    Set fc = rgAppliesTo.FormatConditions.Add(Type:=xlExpression, Formula1:=strFormula)\n    If Not IsMissing(bSetFirstPriority) Then\n        If bSetFirstPriority Then fc.SetFirstPriority\n    End If\n    If Not IsMissing(FillColor) Then\n        With fc.Interior\n            .Color = FillColor\n        End With\n    End If\n    If Not IsMissing(bBorders) Then\n        If bBorders &lt;&gt; 0 Then\n            arBorders = Array(xlLeft, xlRight, xlTop, xlBottom)\n            For Each borderConst In arBorders\n                fc.Borders(borderConst).LineStyle = xlContinuous\n            Next\n        End If\n    End If\n    fc.StopIfTrue = bStopIfTrue\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 989, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525193849, "creation_date": 1475074717, "last_edit_date": 1592644375, "question_id": 39751120, "link": "https://stackoverflow.com/questions/39751120/excel-lots-of-conditional-formatting-converted-to-vba", "title": "Excel - lots of conditional formatting converted to VBA", "body": "<p>For an Excel spreadsheet order form, I need a way to apply conditional formatting to all rows with one macro, from row 78 down until there is no more data.</p>\n<p>Each column has its own conditional formatting formulas. Some have multiple formulas. I tried using the Record Macro function, but since there is so much going on, the resulting VBA code is messy, and I'm not sure how to combine it all.</p>\n<p>I don't need someone to write all the code for me, but I'm hoping I can get a little guidance to figure out how to do all of it.</p>\n<p>There are about 15 columns that need conditional formatting applied to them. Here are a few columns to show what I'm working with:</p>\n<p>A78:</p>\n<blockquote>\n<p>Formula: =AND($A$78=&quot;&quot;,COUNTA(78:78)&gt;=1) | white text, red fill | Stop\nIf True</p>\n</blockquote>\n<p>C78:</p>\n<blockquote>\n<p>Format only cells that contain &gt; Specific Text &gt; beginning with &gt; M |\nno format | Stop If True</p>\n<p>Format only cells that contain &gt; Specific Text &gt; beginning with &gt; F |\nno format | Stop If True</p>\n<p>Format only cells that contain &gt; No Errors | red background, white\ntext</p>\n</blockquote>\n<p>D78:</p>\n<blockquote>\n<p>Cell value is greater than 300</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1475074555, "post_id": 39750973, "comment_id": 66798219, "body": "As it is you&#39;ll just keep making York: J6 equal B1 of each sheet in turn, you&#39;re not changing where you want to paste it. It&#39;s also good practice to avoid select, copy &amp; paste wherever possible so use <code>Sheets(&quot;York&quot;).Range(&quot;J6&quot;).Value = sh.Range(&quot;B1&quot;).Value</code> (presumably changing J6 as you go)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4655643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9119097a836ebf24bfa61d9697b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Bronzie Kee", "link": "https://stackoverflow.com/users/4655643/bronzie-kee"}, "edited": false, "score": 0, "creation_date": 1475141382, "post_id": 39751433, "comment_id": 66827540, "body": "I think my main issue is getting it to loop through all the worksheets to look for the value &quot;York&quot; on cell B2. I can create the IF function that will copy cells if the criteria is met I am just having trouble with the loop. Ignore the current VBA I think it is confusing everyone."}], "tags": [], "owner": {"reputation": 26, "user_id": 6894534, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/fd451cde53802794b619c2ec607321ac?s=128&d=identicon&r=PG", "display_name": "user6894534", "link": "https://stackoverflow.com/users/6894534/user6894534"}, "is_accepted": true, "score": 0, "last_activity_date": 1475075602, "creation_date": 1475075602, "answer_id": 39751433, "question_id": 39750973, "link": "https://stackoverflow.com/questions/39750973/vba-to-search-value-then-transfer-data-from-one-worksheet/39751433#39751433", "title": "VBA to search value then transfer data from one worksheet", "body": "<p>I don't understand what you are tring to do. </p>\n\n<ol>\n<li><p>rng is set to one cell of one sheet \"$B$2\" on \"MATRIX - MASTER\"\nwhy do you loop it with for each?</p></li>\n<li><p>I think you ment to write instead of: ActiveWorkbook.Range(\"J6\").Paste</p></li>\n</ol>\n\n<p><code></p>\n\n<pre><code>ActiveSheet.Range(\"B1\").Copy ' source\nActiveWorkbook.Sheets(\"York\").Range(\"J6\").Paste ' target\n</code></pre>\n\n<p></code></p>\n\n<p>range on the workbook level is used by mamed range.</p>\n\n<ol start=\"3\">\n<li>Try to avoid Select... If you must, use Activate.</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 4655643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a9119097a836ebf24bfa61d9697b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Bronzie Kee", "link": "https://stackoverflow.com/users/4655643/bronzie-kee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 39751433, "answer_count": 1, "score": 0, "last_activity_date": 1475075602, "creation_date": 1475074299, "last_edit_date": 1475074335, "question_id": 39750973, "link": "https://stackoverflow.com/questions/39750973/vba-to-search-value-then-transfer-data-from-one-worksheet", "title": "VBA to search value then transfer data from one worksheet", "body": "<p>a little stuck on this VBA. Havent done VBA in a while so might need to cut me some slack :) </p>\n\n<p>Introduction\nWorking on a Doc that manages the skills and competencies of several employees in my organisation. All worksheets (with the exception of home have identical layout and cell organisation) </p>\n\n<p>Problem Statement \nI need a VBA that searches one particular cell (B2) for a factory location (i.e. York) if this cell = York, I then need it to copy and paste a list of values (i.e. B2) into a range of cells on another worksheet in the same workbook named \"York\". I then need this to loop through all worksheets in the doc (kinda like looping through all employees; each employee will have a new worksheet) for the cell value York and copy and paste those cells into the next empty row on the worksheet York. I cannot seem to get the loop to run through, but after writing the code I couldnt even get the copy paste function to work. </p>\n\n<p>Anyone up for the challenge. \nThis is my current code. Very poor I know. </p>\n\n<pre><code>Sub testv2()\n\nDim ws As Worksheet\nDim sh As Worksheet\nDim rng As Range\nDim c As Range\n\nSet ws = Sheets(\"MATRIX - MASTER\")\n\"Matrix-master was template copy for all skills\"\nSet rng = ws.Range(\"$B$2\")\n\nFor Each sh In Sheets\n    For Each c In rng.Cells\n        If rng.Value = \"York\" Then\n            ActiveWorkbook.Range(\"B1\").Copy\n            Sheets(\"York\").Select\n            ActiveWorkbook.Range(\"J6\").Paste\n        End If\n    Next c\n Next sh\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help at all would be appreciated! </p>\n"}, {"tags": ["vba", "excel", "excel-2013", "excel-2016"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1475074132, "post_id": 39750882, "comment_id": 66797904, "body": "Click Tools-References in the VB Editor and see which of the checked items is prefixed with &#39;MISSING:&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475074223, "post_id": 39750882, "comment_id": 66797972, "body": "Are aware that if the <code>xlCellTypeVisible</code> is a collection of non-contiguous ranges then you have to work with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196243.aspx\" rel=\"nofollow noreferrer\">Range.Areas property</a>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475074403, "post_id": 39750882, "comment_id": 66798110, "body": "While you can host multiple versions of Excel on a single machine, you can only ever have one Outlook version. If you updated Outlook to 2016, then the references to Outlook 2013 are no longer valid."}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1475074492, "post_id": 39750882, "comment_id": 66798184, "body": "@Rory Nothing is prefixed as MISSING."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1475074578, "post_id": 39750882, "comment_id": 66798238, "body": "Which line causes the error and which references do you have set? (I&#39;ve never seen this error caused by anything other than a reference issue)"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475074583, "post_id": 39750882, "comment_id": 66798245, "body": "Did the code originally come from <a href=\"http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\" title=\"Ron de Bruin\" rel=\"nofollow noreferrer\">HERE</a>?"}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "edited": false, "score": 0, "creation_date": 1475074633, "post_id": 39750882, "comment_id": 66798279, "body": "@Jeeped I am still in Outlook 2013 but a lot of users have shifted to outlook 2016. So whats the solution?"}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1475074762, "post_id": 39750882, "comment_id": 66798372, "body": "@Rory Since this is compile error so i am assuming its caused during compilation of code. Which will not give any specific line for the error."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1475074856, "post_id": 39750882, "comment_id": 66798450, "body": "Instead of assuming, tell us: does it or doesn&#39;t it highlight a line? And please answer the references question."}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475074872, "post_id": 39750882, "comment_id": 66798467, "body": "@SkipIntro Link is not working"}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1475074902, "post_id": 39750882, "comment_id": 66798486, "body": "@Rory it doesn&#39;t highlight any line."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1475075094, "post_id": 39750882, "comment_id": 66798621, "body": "Welcome to Stack Overflow! Your image of text <a href=\"//meta.unix.stackexchange.com/q/4086\">isn&#39;t very helpful</a>.  It can&#39;t be copied into an editor, and it doesn&#39;t index very well, meaning that other users with the same problem are less likely to find the answer here.  Please <a href=\"https://stackoverflow.com/posts/39750882/edit\">edit</a> your post to incorporate the relevant text directly (preferably using copy+paste to avoid transcription errors)."}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1475075249, "post_id": 39750882, "comment_id": 66798728, "body": "@TobySpeight As i am new please suggest what should i do? Like give me some example."}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475075404, "post_id": 39750882, "comment_id": 66798846, "body": "Apologies, try <a href=\"http://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/mail.htm</a>"}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475075602, "post_id": 39750882, "comment_id": 66798973, "body": "@SkipIntro No the code didn&#39;t come from there but i had referenced the code for mailing 1 sheet from the link shared by you. In the code"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475075805, "post_id": 39750882, "comment_id": 66799106, "body": "The code you posted doesn&#39;t match the code in your screenshot with the error message.  <a href=\"http://stackoverflow.com/posts/39750882/edit\">Edit your post</a> to include the code that is causing the error."}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475076458, "post_id": 39750882, "comment_id": 66799574, "body": "@SkipIntro No the code didn&#39;t come from there but i had referenced the code for mailing 1 sheet from the link shared by you. In the code .HasVBProject gives error as object not defined"}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475216823, "post_id": 39750882, "comment_id": 66863760, "body": "@SkipIntro I just found that code was taken from the link you had mentioned. Also error is happening because of line TempFile = Environ$(&quot;temp&quot;) &amp; &quot;\\&quot; &amp; Format(Now, &quot;dd-mm-yy h-mm-ss&quot;) &amp; &quot;.htm&quot; Error is can&#39;t find project or library"}, {"owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475221114, "post_id": 39750882, "comment_id": 66865963, "body": "@Comintern i have corrected the error screen shot as per the given code."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8933613, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b242ab5187eeac161b8ecdaf1d2a2c50?s=128&d=identicon&r=PG", "display_name": "Paul Ross", "link": "https://stackoverflow.com/users/8933613/paul-ross"}, "is_accepted": false, "score": 0, "last_activity_date": 1510589032, "last_edit_date": 1510589032, "creation_date": 1510586305, "answer_id": 47267646, "question_id": 39750882, "link": "https://stackoverflow.com/questions/39750882/vba-code-works-fine-in-excel-2013-but-gives-error-in-excel-2016-compile-error/47267646#47267646", "title": "VBA code works fine in Excel 2013 but gives error in excel 2016 - Compile error", "body": "<p>Just had the same error from Ron de Bruin <code>rangetohtml(rng as range)</code>.</p>\n\n<p>I have resolved.</p>\n\n<p>If you go back to the code before\nOn Error Resume Next\nand comment out.</p>\n\n<p>run and you will see it can't find the <code>drawingobjects.visible</code>.</p>\n\n<p>to fix.</p>\n\n<p>go to <code>file/options/formulas/</code></p>\n\n<p>make sure it isn't R1C1  - uncheck this box.</p>\n\n<p>Mine worked fine after this.</p>\n"}], "owner": {"reputation": 1, "user_id": 6894002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9475fc85f0645495964d531700e85?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi Sarkar", "link": "https://stackoverflow.com/users/6894002/abhi-sarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528892266, "creation_date": 1475074033, "last_edit_date": 1592644375, "question_id": 39750882, "link": "https://stackoverflow.com/questions/39750882/vba-code-works-fine-in-excel-2013-but-gives-error-in-excel-2016-compile-error", "title": "VBA code works fine in Excel 2013 but gives error in excel 2016 - Compile error", "body": "<p>I am reaching out to everyone after searching a lot for the solution.\nI have a code that works fine in Excel 2013 but when i try to run the same code in excel 2016 it gives me compile error.</p>\n<p>This code was developed by someone else and i was just doing minor modification to it. Below is the code. The error is happening due to Environ$ variable. Because that what is highlighted when i press ok button in the given screenshot.</p>\n<pre><code>Function RangetoHTML(rng As Range)\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ(&quot;temp&quot;) &amp; &quot;\\&quot; &amp; Format(Now, &quot;dd-mm-yy h-mm-ss&quot;) &amp; &quot;.htm&quot;\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.ReadAll\nts.Close\nRangetoHTML = Replace(RangetoHTML, &quot;align=center x:publishsource=&quot;, _\n                      &quot;align=left x:publishsource=&quot;)\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n<p>I am also attaching error screen shot.</p>\n<h3>Environ$ variable compile error</h3>\n<p><img src=\"https://i.stack.imgur.com/7NP3U.jpg\" alt=\"Environ$ variable compile error\" /></p>\n<p>Any quick help will be much appriciated.</p>\n"}, {"tags": ["excel", "sorting", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475072886, "post_id": 39750414, "comment_id": 66796940, "body": "You can shorten your code a ton by <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoiding the use of <code>.Select</code></a>. I haven&#39;t really looked through your code, but using <code>.Select</code> can cause unexpected results.  When it does error out, click &quot;Debug&quot; - what line does the error occur on, and what error is it?"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475072979, "post_id": 39750414, "comment_id": 66797012, "body": "What error message(s) do you get when it fails?"}, {"owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475072989, "post_id": 39750414, "comment_id": 66797019, "body": "@BruceWayne That is the problem, it doesn&#39;t show me any error, it just don&#39;t do what it is supposed to do sometimes"}, {"owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475073166, "post_id": 39750414, "comment_id": 66797145, "body": "@BruceWayne How can I use sorting system without using .Select? How can I decide where I want to have my cell selection without using it?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475073262, "post_id": 39750414, "comment_id": 66797222, "body": "I linked to an SO thread in my comment, or click <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">here</a>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1475073905, "post_id": 39750414, "comment_id": 66797715, "body": "I doubt that it &quot;decides to bug without any reason&quot;. More likely, it has a reason but you don&#39;t know what the reason is."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1475075310, "creation_date": 1475075310, "answer_id": 39751335, "question_id": 39750414, "link": "https://stackoverflow.com/questions/39750414/my-code-works-most-of-the-times-but/39751335#39751335", "title": "My code works most of the times but", "body": "<p>You're code is really hard to follow - there's a good chance the wrong cell is selected at some point and you're subsequently trying to perform an illegal operation on the cell.</p>\n\n<p>The code below will sort all the regions in your workbook by the second column (and will probably fail if any regions don't have a second column).</p>\n\n<p>The important bit (other than the important bit I've highlighted in the code) is<br>\n<code>Set rCurrentRegion =</code> - this needs to be a reference to the range you're sorting.<br>\nIt can be set manually using something like<br>\n<code>Set rCurrentRegion = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A10:Z5000\")</code>.<br>\nIn your code it would be<br>\n<code>Set rCurrentRegion = Range(MySortCellStart2 &amp; \":\" &amp; MySortCellEnd2)</code> (although you're missing the worksheet reference - it will act on the activesheet otherwise).</p>\n\n<pre><code>Sub Test()\n\n    Dim Regions As Variant\n    Dim x As Long\n    Dim rCurrentRegion As Range\n\n    'Get a list of all the regions in your workbook as the range\n    'in your code doesn't appear to be in a static location.\n    'This will return an array of cell addresses.\n    'e.g. Regions(0) = \"Sheet1!A4:P16\"\n    '     Regions(1) = \"Sheet1!A21:L33\"\n    Regions = FindRegionsInWorkbook(ThisWorkbook)\n\n    'Work through each element in the Regions array.\n    For x = LBound(Regions) To UBound(Regions)\n\n        'Turn the array element into a Range object.\n        Set rCurrentRegion = Range(Regions(x))\n\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        'THIS IS THE IMPORTANT BIT                            '\n        'Sorting without selecting - the range that was       '\n        'identified in the previous line of code is acted on. '\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n        'The Parent of the range is the worksheet object.\n        With rCurrentRegion.Parent\n            .Sort.SortFields.Clear\n            'We're going to sort by the second column in the range.\n            .Sort.SortFields.Add _\n                Key:=rCurrentRegion.Columns(2), _\n                SortOn:=xlSortOnValues, _\n                Order:=xlAscending, _\n                DataOption:=xlSortNormal\n            'Apply the sort.\n            With .Sort\n                .SetRange rCurrentRegion\n                .Header = xlYes\n                .MatchCase = False\n                .Orientation = xlTopToBottom\n                .SortMethod = xlPinYin\n                .Apply\n            End With\n        End With\n\n    Next x\n\nEnd Sub\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'This function returns all the separate regions in your workbook. '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nPublic Function FindRegionsInWorkbook(wrkBk As Workbook) As Variant\n    Dim ws As Worksheet, rRegion As Range, sRegion As String, sCheck As String\n    Dim sAddys As String, arrAddys() As String, aRegions() As Variant\n    Dim iCnt As Long, i As Long, j As Long\n    '//Cycle through each worksheet in workbook.\n    j = 0\n    For Each ws In wrkBk.Worksheets\n        sAddys = vbNullString\n        sRegion = vbNullString\n        On Error Resume Next\n        '//Find all ranges of constant &amp; formula valies in worksheet.\n        sAddys = ws.Cells.SpecialCells(xlCellTypeConstants, 23).Address(0, 0) &amp; \",\"\n        sAddys = sAddys &amp; ws.Cells.SpecialCells(xlCellTypeFormulas, 23).Address(0, 0)\n        If Right(sAddys, 1) = \",\" Then sAddys = Left(sAddys, Len(sAddys) - 1)\n        On Error GoTo 0\n        If sAddys = vbNullString Then GoTo SkipWs\n        '//Put each seperate range into an array.\n        If InStr(1, sAddys, \",\") = 0 Then\n            ReDim arrAddys(0 To 0)\n            arrAddys(0) = \"'\" &amp; ws.Name &amp; \"'!\" &amp; sAddys\n        Else\n            arrAddys = Split(sAddys, \",\")\n            For i = LBound(arrAddys) To UBound(arrAddys)\n                arrAddys(i) = \"'\" &amp; ws.Name &amp; \"'!\" &amp; arrAddys(i)\n            Next i\n        End If\n        '//Place region that range sits in into sRegion (if not already in there).\n        For i = LBound(arrAddys) To UBound(arrAddys)\n            If InStr(1, sRegion, ws.Range(arrAddys(i)).CurrentRegion.Address(0, 0)) = 0 Then\n                sRegion = sRegion &amp; ws.Range(arrAddys(i)).CurrentRegion.Address(0, 0) &amp; \",\" '*** no sheet\n                sCheck = Right(arrAddys(i), Len(arrAddys(i)) - InStr(1, arrAddys(i), \"!\"))\n                ReDim Preserve aRegions(0 To j)\n                aRegions(j) = Left(arrAddys(i), InStr(1, arrAddys(i), \"!\") - 1) &amp; \"!\" &amp; ws.Range(sCheck).CurrentRegion.Address(0, 0)\n                j = j + 1\n            End If\n        Next i\nSkipWs:\n    Next ws\n    On Error GoTo ErrHandle\n    FindRegionsInWorkbook = aRegions\n    Exit Function\nErrHandle:\n    'things you might want done if no lists were found...\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475096966, "creation_date": 1475072838, "last_edit_date": 1531161705, "question_id": 39750414, "link": "https://stackoverflow.com/questions/39750414/my-code-works-most-of-the-times-but", "title": "My code works most of the times but", "body": "<p>I created this program for a spreadsheet in my work.</p>\n\n<p>My code works almost all the time, but some times it decides to bug without any reason. (It doesn't show any error message, it just don't do what it was supposed to do. It when it sorts, sometimes it copies other row's information, but it should be all blank)</p>\n\n<p>My program is basically sorting automatically two stacked tables in the same sheet.</p>\n\n<p>CODE:</p>\n\n<pre><code>Option Explicit\n\nSub Sorting()\n\n' Keyboard Shortcut: Ctrl+m\n'\n'******************************* Define variables for the data that I want to store for later use\nDim MyDataFirstCell\nDim MyDataLastCell\nDim MySortCellStart\nDim MySortCellEnd\n\nDim MyDataFirstCell2\nDim MyDataLastCell2\nDim MySortCellStart2\nDim MySortCellEnd2\n\n'************************** Establish the Data Area\n  ActiveSheet.Range(\"B1\").Select\n  'Next Non Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While IsEmpty(ActiveCell)\n    DoEvents\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n  ActiveCell.Offset(1, 0).Select\n\n  DoEvents\n  MyDataFirstCell = ActiveCell.Address 'Get the first cell address of Data Area\n\n  Selection.End(xlDown).Select 'Get to Bottom Row of the data\n  Selection.End(xlToRight).Select 'Get to the last Column and data cell by heading to the righthand end\n  Selection.End(xlToRight).Select\n  ActiveCell.Offset(-1, 0).Select ' Select the correct last cell\n  MyDataLastCell = ActiveCell.Address 'Get the Cell address of the last cell of my data area\n\n'************************** Establish the Sort column first and last data points.\n  ActiveSheet.Range(\"B1\").Select\n  'Next Non Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While IsEmpty(ActiveCell)\n    DoEvents\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n  ActiveCell.Offset(1, 0).Select 'Get to first cell of data sort Column (Example Col 'R' Row 2 becuase Row 1 contains the header)\n  DoEvents\n  MySortCellStart = ActiveCell.Address 'Get the Cell address of the first cell of my data sort Column\n  Selection.End(xlDown).Select 'Get to the bottom Row of data\n  ActiveCell.Offset(-1, 0).Select\n  MySortCellEnd = ActiveCell.Address 'Get the Cell address of the last cell of my sort Column\n\n'************************** Start the sort by specifying sort area and columns\n  ActiveSheet.Sort.SortFields.Clear\n  ActiveSheet.Sort.SortFields.Add _\n    Key:=Range(MySortCellStart &amp; \":\" &amp; MySortCellEnd), SortOn:=xlSortOnValues, Order:=xlAscending, _\n    DataOption:=xlSortNormal\n  With ActiveSheet.Sort\n    .SetRange Range(MyDataFirstCell &amp; \":\" &amp; MyDataLastCell)\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n  End With\n\n  'Second sorting\n  '************************** Establish the Data Area\n  ActiveSheet.Range(\"B1\").Select\n  'Next Non Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While IsEmpty(ActiveCell)\n    DoEvents\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n  'Next Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While Not IsEmpty(ActiveCell)\n    DoEvents\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n  'Next Non Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While IsEmpty(ActiveCell)\n    DoEvents\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n  DoEvents\n  ActiveCell.Offset(1, 0).Select\n\n  MyDataFirstCell2 = ActiveCell.Address 'Get the first cell address of Data Area\n\n  Selection.End(xlDown).Select 'Get to Bottom Row of the data\n  Selection.End(xlToRight).Select 'Get to the last Column and data cell by heading to the righthand end\n  Selection.End(xlToRight).Select\n  ActiveCell.Offset(-1, 0).Select ' Select the correct last cell\n  MyDataLastCell2 = ActiveCell.Address 'Get the Cell address of the last cell of my data area\n\n'************************** Establish the Sort column first and last data points.\n  ActiveSheet.Range(\"B1\").Select\n  'Next Non Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While IsEmpty(ActiveCell)\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n'Next Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While Not IsEmpty(ActiveCell)\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n'Next Non Blank Cell down\n  ActiveCell.Offset(1, 0).Select\n  Do While IsEmpty(ActiveCell)\n    ActiveCell.Offset(1, 0).Select\n  Loop\n\n\n  ActiveCell.Offset(1, 0).Select 'Get to first cell of data sort Column (Example Col 'R' Row 2 becuase Row 1 contains the header)\n  MySortCellStart2 = ActiveCell.Address 'Get the Cell address of the first cell of my data sort Column\n  Selection.End(xlDown).Select 'Get to the bottom Row of data\n  ActiveCell.Offset(-1, 0).Select\n  MySortCellEnd2 = ActiveCell.Address 'Get the Cell address of the last cell of my sort Column\n\n'************************** Start the sort by specifying sort area and columns\n  ActiveSheet.Sort.SortFields.Clear\n  ActiveSheet.Sort.SortFields.Add _\n    Key:=Range(MySortCellStart2 &amp; \":\" &amp; MySortCellEnd2), SortOn:=xlSortOnValues, Order:=xlAscending, _\n    DataOption:=xlSortNormal\n  With ActiveSheet.Sort\n    .SetRange Range(MyDataFirstCell2 &amp; \":\" &amp; MyDataLastCell2)\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n  End With\n\n'Select first element of first table\n  DoEvents\n  ActiveSheet.Range(\"F1\").Select\n  Range(MyDataFirstCell).Select\n\nEnd Sub\n</code></pre>\n\n<p>I am new at coding with VBA, I know languages like C and for LPC, but I have never learned VBA. So, any help of how to solve the problem or to improve my code, I'm all about it.</p>\n\n<p>Thank you very much for your patience, attention and help.</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1475072506, "post_id": 39750169, "comment_id": 66796652, "body": "Don&#39;t use <code>Select</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 5, "creation_date": 1475072542, "post_id": 39750169, "comment_id": 66796689, "body": "I&#39;m pretty sure your original selection to copy goes all the way to teh bottom of the worksheet. Because of this, the copied cells are too large to fit into the target. . See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more on getting away from relying on select and activate to accomplish your goals."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1475072614, "post_id": 39750169, "comment_id": 66796741, "body": "Use only the single top-left cell to designate a target paste area for the copied cells."}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475072801, "post_id": 39750169, "comment_id": 66796889, "body": "giving it a try, will keep you updated."}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 1, "creation_date": 1475074084, "post_id": 39750362, "comment_id": 66797852, "body": "I am getting &quot;Object doesn&#39;t support this property or method.&quot; error (I have data in <code>D2:F10</code>) in <code>Range(&quot;A1&quot;).Paste</code>. Any guess what is wrong?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1475074189, "post_id": 39750362, "comment_id": 66797948, "body": "Try <code>Set rng = Range(rng.Address, rng.End(xlDown).Address)</code>"}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "reply_to_user": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1475074553, "post_id": 39750362, "comment_id": 66798218, "body": "@RCaetano I am also getting the same but was trying to figure. Thanks you asked it. I will try david &#39;s suggestion"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475074632, "post_id": 39750362, "comment_id": 66798278, "body": "the assignment to <code>rng</code> object works correctly, which line is raising the error?"}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475074686, "post_id": 39750362, "comment_id": 66798318, "body": "@DavidZemens Range(&quot;A1&quot;).Paste is causing the error."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 1, "creation_date": 1475075039, "post_id": 39750362, "comment_id": 66798587, "body": "What is below range D2:F2 in the sheet? Do you have any merged cells?"}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1475075285, "post_id": 39750362, "comment_id": 66798758, "body": "@ExcelDevelopers its very high 1048576."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475075538, "post_id": 39750362, "comment_id": 66798937, "body": "Try another revision, though I don&#39;t think that would make a difference if you select the single cell &quot;A2&quot; , etc., you should still be able to paste 3 columns there. However, if there are merged cells in column A, or if part of column A is locked/protected, then you may get a 1004."}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475076122, "post_id": 39750362, "comment_id": 66799347, "body": "@DavidZemens The problem is I don&#39;t want to paste on <code>Range(&quot;A1&quot;)</code>, I want to come end blank row or <code>A1</code> and then paste the selected data.  Your selection thing is perfect. Even paste is perfect only if i want to paste to <code>A1</code> but as soon as I apply <code>End(xlDown)</code> and <code>Offset</code> its beaks :("}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475076579, "post_id": 39750362, "comment_id": 66799663, "body": "Then the problem would seem to be that the range you&#39;re <i>cutting</i> is too big to fit in the destination. Too many rows, will exceed the limit of the worksheet, and raise the 1004 error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475077664, "post_id": 39750362, "comment_id": 66800387, "body": "I made a revision to get the last row more appropriately, however this can still fail if the sheet cannot accommodate the pasted data (i.e., if the cut range, when pasted, would overflow the available rows in the worksheet)."}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475081292, "post_id": 39750362, "comment_id": 66802751, "body": "Yeah! This one worked :). Just changed <code>GetLastRow = 2</code> in <code>GetLastRow</code> function as I need results starting from 2nd row. Thank you very much :). Could you please tell me what exactly <code>Application.WorksheetFunction.CountA(Columns(col))</code> does?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475081735, "post_id": 39750362, "comment_id": 66803036, "body": "@SandeepKushwah the <a href=\"https://support.office.com/en-us/article/COUNTA-function-7dc98875-d5c1-46f1-9a82-53f3219e2509\" rel=\"nofollow noreferrer\">COUNTA</a> function counts the number of non-empty cells in a range."}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475084453, "post_id": 39750362, "comment_id": 66804494, "body": "@DavidZemens : Why you passed <code>4</code> in the function argument? Should it be <code>6</code> for F right?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475085405, "post_id": 39750362, "comment_id": 66805045, "body": "@SandeepKushwah For my testing, I assumed that columns D, E and F all contained the same number of data rows in which case the choice of column number won&#39;t matter. If you need to scan from Column F (maybe Column D has not as much data?) then yes, you&#39;ll need to use 6 as the argument.."}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 1, "creation_date": 1475088296, "post_id": 39750362, "comment_id": 66806784, "body": "@DavidZemens Thanks! got the concept."}, {"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1475089564, "post_id": 39750362, "comment_id": 66807478, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/124459/discussion-between-sandeep-kushwah-and-david-zemens\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 6, "last_activity_date": 1475077399, "last_edit_date": 1495535255, "creation_date": 1475072721, "answer_id": 39750362, "question_id": 39750169, "link": "https://stackoverflow.com/questions/39750169/excel-vba-selection-cut-paste-error/39750362#39750362", "title": "Excel VBA - Selection Cut Paste Error", "body": "<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid <code>Select</code> at all costs</a>.  Try something like this instead</p>\n\n<pre><code>Sub foo()\nDim rng\nSet rng = Range(\"D2:F\" &amp; GetLastRow(4))\n\nrng.Cut\nApplication.Goto Range(\"A1\").Offset(GetLastRow(1))\nActiveSheet.Paste\n\nEnd Sub\n\nFunction GetLastRow(col As Long)\n' modified from:\n' https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\n\nIf Application.WorksheetFunction.CountA(Columns(col)) &lt;&gt; 0 Then\n    GetLastRow = Columns(col).Find(What:=\"*\", _\n                  After:=Cells(Rows.Count, col), _\n                  Lookat:=xlPart, _\n                  LookIn:=xlFormulas, _\n                  SearchOrder:=xlByRows, _\n                  SearchDirection:=xlPrevious, _\n                  MatchCase:=False).Row\nElse\n    GetLastRow = 1\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 1, "creation_date": 1475084234, "post_id": 39750484, "comment_id": 66804352, "body": "Thank you @vityata for your effort. Your answer taught me about <code>Debug.print.</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1475073082, "creation_date": 1475073082, "answer_id": 39750484, "question_id": 39750169, "link": "https://stackoverflow.com/questions/39750169/excel-vba-selection-cut-paste-error/39750484#39750484", "title": "Excel VBA - Selection Cut Paste Error", "body": "<p>The problem is that you are trying to select a cell, which is one cell below the end of the table. After the stop, you have an offset, which gives you one cell lower. Check this out:</p>\n\n<pre><code>Option Explicit\nSub test()\n    Range(\"D2:F2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Cut\n\n    Range(\"A1\").Select\n    Selection.End(xlDown).Select\n\n    Debug.Print ActiveCell.Address\n    Stop\n\n    ActiveCell.Offset(1, 0).Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>And, as already said, try to avoid select.</p>\n"}, {"comments": [{"owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "edited": false, "score": 0, "creation_date": 1475081459, "post_id": 39751348, "comment_id": 66802854, "body": "Thanks for your efforts! The approach was correct just implementing the same in paste selection would have resulted in the SOLUTION. Thanks!!!"}], "tags": [], "owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "is_accepted": false, "score": 1, "last_activity_date": 1475075954, "last_edit_date": 1475075954, "creation_date": 1475075332, "answer_id": 39751348, "question_id": 39750169, "link": "https://stackoverflow.com/questions/39750169/excel-vba-selection-cut-paste-error/39751348#39751348", "title": "Excel VBA - Selection Cut Paste Error", "body": "<p>As mentioned in other answers and comments avoid the use of <code>.Select</code> at all costs. It is the source of many common errors. The next solution finds the last row with data by using a simple function.</p>\n\n<pre><code>Option Explicit\n\nFunction lastrow(rng_str As String)\n\n    ' Adapted from http://www.rondebruin.nl/win/s9/win005.htm\n    Dim rng As Range: Set rng = Range(rng_str)\n    Dim r As Range\n    lastrow = rng.Column\n\n    With ActiveSheet\n        For Each r In rng.Columns\n            lastrow = Application.Max(lastrow, .Cells(.Rows.Count, r.Column).End(xlUp).Row)\n        Next\n    End With\n\nEnd Function\n\nSub test()\n\n    Dim source_rng As Range\n    Dim dest_rng As Range\n    Dim nr_rows As Long\n\n    ' Maximum number of rows from D to F\n    nr_rows = lastrow(\"D2:F2\")\n\n    Set source_rng = Range(\"D2:F\" &amp; nr_rows)\n    Set dest_rng = Range(\"A1\")\n\n    source_rng.Cut\n    dest_rng.Activate\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>HTH ;)</p>\n"}], "owner": {"reputation": 582, "user_id": 3895711, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/JQOU8.jpg?s=128&g=1", "display_name": "Sandeep Kushwah", "link": "https://stackoverflow.com/users/3895711/sandeep-kushwah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3363, "favorite_count": 0, "accepted_answer_id": 39750362, "answer_count": 3, "score": 3, "last_activity_date": 1476262189, "creation_date": 1475072238, "last_edit_date": 1476262189, "question_id": 39750169, "link": "https://stackoverflow.com/questions/39750169/excel-vba-selection-cut-paste-error", "title": "Excel VBA - Selection Cut Paste Error", "body": "<p>I am creating a macro but I am stuck at this cut paste statement and not able to proceed since yesterday.</p>\n\n<p>Here is the problem: I am selecting all the rows in column \"D2 to F2\" and pasting it at \"A1\".\nHere is the code for it :</p>\n\n<pre><code>Range(\"D2:F2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Cut\n\nRange(\"A1\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(1, 0).Select\nActiveSheet.Paste    \n</code></pre>\n\n<p>Getting this Error:<br>\n <a href=\"https://i.stack.imgur.com/N3IGr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N3IGr.png\" alt=\"Error\"></a></p>\n\n<p>Here's what I have tried :</p>\n\n<ol>\n<li><p>Code Change: Using <code>PasteSpecial</code> instead of simple <code>Paste</code>.</p>\n\n<pre><code>Range(\"D2:F2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Cut\n\nRange(\"A1\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(1, 0).Select\n'ActiveSheet.Paste  ' insted of this using paste special.\nActiveSheet.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre></li>\n</ol>\n\n<p>Getting the following error:<br>\n <a href=\"https://i.stack.imgur.com/su5Sr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/su5Sr.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li><p>Code Change: Resized the selection to 3 columns.</p>\n\n<pre><code>Range(\"D2:F2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Cut\n\nRange(\"A1\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(1, 0).Resize(1, 3).Select\n'ActiveSheet.Paste\n</code></pre></li>\n</ol>\n\n<p>Getting this error:<br>\n <a href=\"https://i.stack.imgur.com/oRwhS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oRwhS.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"3\">\n<li>Tried <code>On Error Resume Next</code> statement. It is ignoring the error message but not pasting the data as well.</li>\n</ol>\n\n<hr>\n\n<p>I am looking for a way to ignore this error message and proceed with paste. We normally get this error when we manually <code>copy-paste</code> or <code>cut-paste</code> in excel sheet, there we have option to ignore and paste data. Similarly is there any method to ignore it within a macro?</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1475071507, "post_id": 39749673, "comment_id": 66795891, "body": "Will the <code>W1T60</code> values keep incrementing too? I assume that you want B33 = 1, C33 = 2, and if we went to like, Z33, you&#39;d want Z33 = 25?"}], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "is_accepted": false, "score": 1, "last_activity_date": 1475072878, "last_edit_date": 1475072878, "creation_date": 1475072407, "answer_id": 39750233, "question_id": 39749673, "link": "https://stackoverflow.com/questions/39749673/excel-loop-vba-incrementing-rows/39750233#39750233", "title": "Excel Loop VBA incrementing rows", "body": "<p>I'd make it like:</p>\n\n<pre><code>i=2\ndo while i&lt;= maxColumn \n        If W1T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Cells(i,33).Value2 = i-1\n        If W1T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Cells(i,33).Value2 = \"\"\nloop\n</code></pre>\n\n<p>from your code I don't see how to change the Cells(i,<strong>j</strong>) parameter, so I left it constant, but with similar logic you can modify it</p>\n"}, {"tags": [], "owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "is_accepted": false, "score": 0, "last_activity_date": 1475076888, "last_edit_date": 1475076888, "creation_date": 1475074920, "answer_id": 39751192, "question_id": 39749673, "link": "https://stackoverflow.com/questions/39749673/excel-loop-vba-incrementing-rows/39751192#39751192", "title": "Excel Loop VBA incrementing rows", "body": "<p>There are a few different ways you can do this using for loops and the offset feature. I would probably do it by first defining your range as an array of ranges. <code>Dim rng(0 to 3) as Range</code> and then defining each of your 4 cells in column C.</p>\n\n<pre><code>Set rng(0) = Range(\"C26\")\nSet rng(1) = Range(\"C91\")\nSet rng(2) = Range(\"C156\")\nSet rng(3) = Range(\"C221\")\n</code></pre>\n\n<p>Then you can enclose your \"if\" statement in a for each loop.</p>\n\n<pre><code>Dim c As Variant\nFor Each c In rng\n    if Container1CB.Value &gt; \"\" Then\n\n        Sheets(\"StabDataCapture\").c.Value = Container1CB\n\n        If W1T60.Value = True Then Sheets(\"StabDataCapture\").c.Offset(7,-1).Value = \"1\"\n        If W1T60.Value = False Then sheets(\"StabDataCapture\").c.Offset(7,-1).Value = \"\"\n\n        If W2T60.Value = True Then sheets(\"StabDataCapture\").c.Offset(7,0).Value = \"2\"\n        If W2T60.Value = False Then sheets(\"StabDataCapture\").c.Offset(7,0).Value = \"\"\n\n....\n\nend if\n</code></pre>\n\n<p>Alternatively, you could use a for loop like <code>For i = 0 to 65*4 Step 65</code> and you could replace statements like <code>Range(\"C26\")</code> with <code>Cells(i,3).Value</code></p>\n\n<p>To set each value in your \"IF-THEN\" statements, your best solution again is probably an array. <code>Dim WT(1 To 8) as Variant</code> and then you can set each value of the array equal to the value of W1T60, W2T60, etc. <code>WT(1) = W1T60.Value</code>. Then the code can be updated to:</p>\n\n<pre><code>Dim c As Variant\nDim i as Integer\nFor Each c In rng\n    if Container1CB.Value &gt; \"\" Then\n\n        Sheets(\"StabDataCapture\").c.Value = Container1CB\n\n        For i = 1 To 8\n            If WT(i) Then \n                Sheets(\"StabDataCapture\").c.Offset(7, i - 2).Value = i\n            else\n                Sheets(\"StabDataCapture\").c.Offset(7, i - 2).Value = \"\"\n            end if\n        next i\n\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475076888, "creation_date": 1475070992, "question_id": 39749673, "link": "https://stackoverflow.com/questions/39749673/excel-loop-vba-incrementing-rows", "title": "Excel Loop VBA incrementing rows", "body": "<p>Hi I have a section of code that I am trying to write a loop for but I am struggling with how to go about it.</p>\n\n<p>This portion of the code runs fine. But I actually have 4 cells which are the ranges, C26,  C91, C156 and C221. (See Container 1 comment in code)</p>\n\n<p>I managed to get it to loop, but then my references below (e.g B33,C33,D33,etc.) just write over the top. Is there anyway to write a loop that can increment all of the successive code by the required 65 rows??</p>\n\n<p>I really want to learn how to do this properly rather than copying and pasting 4 times and manually updating the references!</p>\n\n<pre><code>Private Sub RunStabSetup()\n\n\n' Confirmation of Entry to Form\n\nIf MsgBox(\"Have you double checked your data is correct and ALL test points have been selected before entering on the spreadsheet?\", vbYesNo) = vbNo Then Exit Sub\n\nApplication.ScreenUpdating = False\n\nApplication.Worksheets(\"Req Sheet\").Range(\"C83\") = \" \"\n\nIf Container1CB.Value &gt; \"\" Then\n\n'Container 1\n\n    Application.Worksheets(\"StabDataCapture\").Range(\"C26\") = Container1CB\n\n  '60\u00b0 CheckBox logic statements\n\n    If W1T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"B33\") = \"1\"\n    If W1T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"B33\") = \"\"\n\n    If W2T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"C33\") = \"2\"\n    If W2T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"C33\") = \"\"\n\n    If W3T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"D33\") = \"3\"\n    If W3T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"D33\") = \"\"\n\n    If W4T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"E33\") = \"4\"\n    If W4T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"E33\") = \"\"\n\n    If W5T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"F33\") = \"5\"\n    If W5T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"F33\") = \"\"\n\n    If W6T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"G33\") = \"6\"\n    If W6T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"G33\") = \"\"\n\n    If W7T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"H33\") = \"7\"\n    If W7T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"H33\") = \"\"\n\n    If W8T60.Value = True Then Application.Worksheets(\"StabDataCapture\").Range(\"I33\") = \"8\"\n    If W8T60.Value = False Then Application.Worksheets(\"StabDataCapture\").Range(\"I33\") = \"\"\n End If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for you help everyone!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1475070515, "post_id": 39749430, "comment_id": 66795028, "body": "VB.NET is not vba.  Says so right on the tag."}, {"owner": {"reputation": 833, "user_id": 2654498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JENRC.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/2654498/nick"}, "edited": false, "score": 0, "creation_date": 1475070572, "post_id": 39749430, "comment_id": 66795080, "body": "1.) Can you remove 90% of the lines to reduce the data you&#39;re dealing with? 2.) Is this is a one-time operation, or will you be repeatedly doing this? This changes how robust your solution needs to be. Typically RDBMS allow import from Excel, CSV, XML, etc., into a database table(s). This is a manual step, but if it is a one time need for you, it may be the quickest and simplest..."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475070753, "post_id": 39749430, "comment_id": 66795232, "body": "You could query the excel sheet using ADO and do it using ADO and SQL."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6440081"}, "edited": false, "score": 0, "creation_date": 1475159905, "post_id": 39749971, "comment_id": 66840828, "body": "using dao over line-by-line approach increased the speed drastically, thanks alot!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475161172, "post_id": 39749971, "comment_id": 66841807, "body": "Awesome! Indeed SQL handles the job at once as opposed to iteratively. Glad I could help."}, {"owner": {"reputation": 739, "user_id": 7262393, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/10209827239390452/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/7262393/dan"}, "edited": false, "score": 0, "creation_date": 1568595539, "post_id": 39749971, "comment_id": 102311368, "body": "This is something I could use if it works well enough. I get an excel file from partner company once a week. It has 6 columns and at the moment about 800k+ rows.  Rows should never be deleted but fields may change and rows are always added. I need a fast way to update the access tables from the excel file and spit out a report/file/table of the changes. How quickly does it run on 500k rows of data?"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1475071756, "creation_date": 1475071756, "answer_id": 39749971, "question_id": 39749430, "link": "https://stackoverflow.com/questions/39749430/import-huge-dataset-into-access-from-excel-via-vba/39749971#39749971", "title": "Import huge dataset into Access from Excel via VBA", "body": "<p>Consider running a special Access query for the import. Add the below SQL into an Access query window or as SQL query in a DAO/ADO connection. Include any <code>WHERE</code> clauses which requires named column headers, right now set to <code>HDR:No</code>:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO [Table] (Column1, Column2)\nSELECT *\nFROM [Excel 12.0 Xml;HDR=No;Database=C:\\Path\\To\\Workbook.xlsx].[SHEET1$];\n</code></pre>\n\n<p>Alternatively, run a Make-Table query in case you need a staging temp table (to remove 90% of lines) prior to final table but do note this query replaces table if exists:</p>\n\n<pre><code>SELECT * INTO [NewTable]\nFROM [Excel 12.0 Xml;HDR=No;Database=C:\\Path\\To\\Workbook.xlsx].[SHEET1$];\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6440081"}, "edited": false, "score": 0, "creation_date": 1475159944, "post_id": 39756305, "comment_id": 66840858, "body": "thanks for the input, unfortunately this approach was still much slower than going with dao"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1475091662, "creation_date": 1475091662, "answer_id": 39756305, "question_id": 39749430, "link": "https://stackoverflow.com/questions/39749430/import-huge-dataset-into-access-from-excel-via-vba/39756305#39756305", "title": "Import huge dataset into Access from Excel via VBA", "body": "<p>A slight change in your code will do the filtering for you:</p>\n\n<pre><code>Dim strTest As String\nFor i = 1 To EOF\n    strTest=xlSheet.Cells(i, 1).Value\n    if Nz(strTest)&lt;&gt;\"\" Then\n        sql = \"Insert Into [Table] (Column1, Column2) VALUES ('\" &amp; _\n        strTest &amp; \" ', '\" &amp; _\n        xlSheet.Cells(i, 2).Value &amp; \"');\" \n            DoCmd.RunSQL sql\n      End If\nNext i\n</code></pre>\n\n<p>I assume having the RunSQL outside the loop was just a mistake in your pseudocode. This tests for the Cell in the first column to be empty but you can substitute with any condition is appropriate for your situation.</p>\n"}, {"tags": [], "owner": {"reputation": 739, "user_id": 7262393, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/10209827239390452/picture?type=large", "display_name": "Dan", "link": "https://stackoverflow.com/users/7262393/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1568818275, "creation_date": 1568818275, "answer_id": 57995602, "question_id": 39749430, "link": "https://stackoverflow.com/questions/39749430/import-huge-dataset-into-access-from-excel-via-vba/57995602#57995602", "title": "Import huge dataset into Access from Excel via VBA", "body": "<p>I'm a little late to the party but I stumbled on this looking for information on a similar problem. I thought I might share my solution in case it could help others or maybe OP, if he/she is still working on it. Here's my problem and what I did:</p>\n\n<p>I have an established Access database of approximately the same number of rows as OPs (6 columns, approx 850k rows). We receive a .xlsx file with one sheet and the data in the same structure as the db about once a week from a partner company. </p>\n\n<p>This file contains the entire db, plus updates (new records and changes to old records, no deletions). The first column contains a unique identifier for each row. The Access db is updated when we receive the file through similar queries as suggested by Parfait, but since it's the entire 850k+ records, this takes 10-15 minutes or longer to compare and update, depending on what else we have going on.</p>\n\n<p>Since it would be faster to load just the changes into the current Access db, I needed to produce a delta file (preferably .txt that can be opened with excel and saved as .xlsx if needed). I assume this is something similar to what OP was looking for. To do this I wrote a small application in c++ to compare the file from the previous week, to the one from the current week. The data itself is an amalgam of character and numerical data that I will just call <code>string1</code> through <code>string6</code> here for simplicity. It looks like this:</p>\n\n<pre><code>Col1       Col2       Col3       Col4       Col5       Col6\nstring1    string2    string3    string4    string5    string6\n.......\n''''Through 850k rows''''\n</code></pre>\n\n<p>After saving both .xlsx files as .txt tab delimited files, they look like this:</p>\n\n<pre><code>Col1\\tCol2\\tCol3\\tCol4\\tCol5\\tCol6\\n\nstring1\\tstring2\\tstring3\\tstring4\\tstring5\\tstring6\\n\n....\n//Through 850k rows//\n</code></pre>\n\n<p>The fun part! I took the old .txt file and stored it as a hash table (using the c++ <code>unordered_map</code> from the standard library). Then with an input filestream from the new .txt file I used <code>Col1</code> in the new file as a key to the hash table and output any differences to two different files. One you could use a query to append the db with new data and the other you could use to update data that has changed. </p>\n\n<p>I've heard it's possible to create a more efficient hash table than the <code>unordered_map</code> but at the moment, this works well so I'll stick with it. Here's my code.</p>\n\n<pre><code>#include &lt;iostream&gt;     \n#include &lt;fstream&gt;      \n#include &lt;string&gt;       \n#include &lt;iterator&gt;\n#include &lt;unordered_map&gt;\n\n\nint main()\n{\n    using namespace std;\n\n    //variables\n    const string myInFile1{\"OldFile.txt\"};\n    const string myInFile2{\"NewFile.txt\"};\n    string mappedData;\n    string key;\n\n    //hash table objects\n    unordered_map&lt;string, string&gt; hashMap;\n    unordered_map&lt;string, string&gt;::iterator cursor;\n\n    //input files\n    ifstream fin1;\n    ifstream fin2;\n    fin1.open(myInFile1);\n    fin2.open(myInFile2);\n\n    //output files\n    ofstream fout1;\n    ofstream fout2;\n    fout1.open(\"For Updated.txt\");  //updating old records \n    fout2.open(\"For Upload.txt\");   //uploading new records\n\n    //This loop takes the original input file (i.e.; what is in the database already)\n    //and hashes the entire file using the Col1 data as a key. On my system this takes\n    //approximately 2 seconds for 850k+ rows with 6 columns\n    while(fin1)\n    {\n            getline(fin1, key, '\\t');          //get the first column\n            getline(fin1, mappedData, '\\n');   //get the other 5 columns\n            hashMap[key] = mappedData;         //store the data in the hash table\n    }\n    fin1.close();\n\n    //output file headings\n    fout1 &lt;&lt; \"COl1\\t\" &lt;&lt; \"COl2\\t\" &lt;&lt; \"COl3\\t\" &lt;&lt; \"COl4\\t\" &lt;&lt; \"COl5\\t\" &lt;&lt; \"COl6\\n\";\n    fout2 &lt;&lt; \"COl1\\t\" &lt;&lt; \"COl2\\t\" &lt;&lt; \"COl3\\t\" &lt;&lt; \"COl4\\t\" &lt;&lt; \"COl5\\t\" &lt;&lt; \"COl6\\n\";\n\n    //This loop takes the second input file and reads each line, first up to the\n    //first tab delimiter and stores it as \"key\", then up to the new line character\n    //storing it as \"mappedData\" and then uses the value of key to search the hash table\n    //If the key is not found in the hash table, a new record is created in the upload\n    //output file. If it is found, the mappedData from the file is compared to that of\n    //the hash table and if different, the updated record is sent to the update output\n    //file. I realize that while(fin2) is not the optimal syntax for this loop but I\n    //have included a check to see if the key is empty (eof) after retrieving\n    //the current line from the input file. YMMV on the time here depending on how many\n    //records are added or updated (1000 records takes about another 5 seconds on my system)    \n    while(fin2)\n    {\n        getline(fin2, key, '\\t');           //get key from Col1 in the input file\n        getline(fin2, mappedData, '\\n');    //get the mappeData (Col2-Col6)\n        if(key.empty())                     //exit the file read if key is empty\n            break;\n        cursor = hashMap.find(key);         //assign the iterator to the hash table at key\n\n        if(cursor != hashMap.end())         //check to see if key in hash table\n        {\n            if(cursor-&gt;second != mappedData) //compare mappedData\n            {          \n                fout2 &lt;&lt; key &lt;&lt; \"\\t\" &lt;&lt; mappedData&lt;&lt; \"\\n\";\n            }\n        }\n        else                                //for updating old records\n        {\n            fout1 &lt;&lt; key &lt;&lt; \"\\t\" &lt;&lt; mappedData&lt;&lt; \"\\n\";\n        }\n    }\n\n\n    fin2.close();\n    fout1.close();\n    fout2.close();\n    return 0;\n}\n</code></pre>\n\n<p>There are a few things I am working on to make this an easy to use executable file (for example reading the xml structure of the excel.zip file for direct reading or maybe using an ODBC connection) but for now, I'm just testing it to make sure the outputs are correct. Of course the output files would then have to be loaded into the access database using queries similar to what Parfait suggested. Also, I'm not sure if Excel or Access VBA have a library to build hash tables but it might be worth exploring further if it saves time in accessing the excel data. Any criticisms or suggestions are welcomed.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6440081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2959, "favorite_count": 0, "accepted_answer_id": 39749971, "answer_count": 3, "score": 0, "last_activity_date": 1568818275, "creation_date": 1475070457, "last_edit_date": 1475070811, "question_id": 39749430, "link": "https://stackoverflow.com/questions/39749430/import-huge-dataset-into-access-from-excel-via-vba", "title": "Import huge dataset into Access from Excel via VBA", "body": "<p>I have a huge dataset which I need to import from Excel into Access (~800k lines). However, I can ignore lines with a particular column value, which make up like 90% of the actual dataset. So in fact, I only really need like 10% of the lines imported.</p>\n\n<p>In the past I've been importing Excel Files line-by-line in the following manner (pseudo code):</p>\n\n<pre><code>For i = 1 To EOF\n    sql = \"Insert Into [Table] (Column1, Column2) VALUES ('\" &amp; _\n    xlSheet.Cells(i, 1).Value &amp; \" ', '\" &amp; _\n    xlSheet.Cells(i, 2).Value &amp; \"');\"       \nNext i\nDoCmd.RunSQL sql\n</code></pre>\n\n<p>With ~800k lines this takes waaay to long as for every single line a query would be created and run.</p>\n\n<p>Considering the fact that I can also ignore 90% of the lines, what is the fastest approach to import the dataset from Excel to Access?</p>\n\n<p>I was thinking of creating a temporary excel file with a filter activated. And then I just import the filtered excel.</p>\n\n<p>But is there a better/faster approach than this? Also, what is the fastest way to import an excel via vba access?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1475070757, "post_id": 39749417, "comment_id": 66795235, "body": "trying to indent your code you have a <code>Loop</code> where is the <code>Do While</code> or other start statement ?"}, {"owner": {"reputation": 13, "user_id": 6894058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff61c6d2e72b088bed498bf55f1a541e?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia", "link": "https://stackoverflow.com/users/6894058/claudia"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475070985, "post_id": 39749417, "comment_id": 66795415, "body": "The problem is that I&#39;m trying to expand the formula of an existing file. The Loop starts further down the way, but that&#39;s a whole bunch of code.  What I would like to do to maybe not explain it in VBA code would be the following check:  If the Value in Cell C3 starts with 3 and the Value in cell D3 is not in the range of Cells AG2:AG23 of the worksheet Metadata, then the error message &quot;please enter a WBS element&quot; should appear"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475071216, "post_id": 39749417, "comment_id": 66795614, "body": "Are your values in Column D formatted as Numbers ? Id yes, there is no use to <code>Left(Cells(CLine, 4).Value, 7) &lt;&gt; &quot;1000000&quot;</code> just use <code>Cells(CLine, 4).Value &lt;&gt; 1000000</code> or <code>Cells(CLine, 4).Value &gt; 1000000</code>"}, {"owner": {"reputation": 13, "user_id": 6894058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff61c6d2e72b088bed498bf55f1a541e?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia", "link": "https://stackoverflow.com/users/6894058/claudia"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475071639, "post_id": 39749417, "comment_id": 66795979, "body": "Yes, they are formatted as numbers. What I&#39;m having trouble with is the &quot;between&quot; part since the error needs to only appear when I enter a number smaller than 8000000 or bigger than 9000000, but not when I enter a number between 80000000 and 9000000."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6894058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff61c6d2e72b088bed498bf55f1a541e?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia", "link": "https://stackoverflow.com/users/6894058/claudia"}, "edited": false, "score": 0, "creation_date": 1475072277, "post_id": 39749909, "comment_id": 66796485, "body": "This is great and seems to work partly. It does give me the error when I enter a number with 3 or 4 numbers that is smaller than 8000000 but if I enter one higher than the max in my range, it still doesn&#39;t give me the error which is strange since I&#39;m sure your Code should work"}, {"owner": {"reputation": 13, "user_id": 6894058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff61c6d2e72b088bed498bf55f1a541e?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia", "link": "https://stackoverflow.com/users/6894058/claudia"}, "edited": false, "score": 0, "creation_date": 1475072524, "post_id": 39749909, "comment_id": 66796673, "body": "Oh I&#39;ve just seen it only gave me another error message from further down the code road... I will have to check why this won&#39;t work... I have one other problem which I discovered with the new error... I can&#39;t format the cost type numbers as numbers since the Vlookup won&#39;t work if I do... So there text and I probably should check with the code if the value is in my range, but the then the min/max thing won&#39;t work, right?"}, {"owner": {"reputation": 13, "user_id": 6894058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff61c6d2e72b088bed498bf55f1a541e?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia", "link": "https://stackoverflow.com/users/6894058/claudia"}, "edited": false, "score": 0, "creation_date": 1475073522, "post_id": 39749909, "comment_id": 66797410, "body": "It works! It fist didn&#39;t to due to my own stupidity. I can&#39;t even copy/past :-) Probably been working on this file to long and made two &quot;and&quot; instead of one &quot;and&quot; and one &quot;or&quot; as you did... Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1475071592, "creation_date": 1475071592, "answer_id": 39749909, "question_id": 39749417, "link": "https://stackoverflow.com/questions/39749417/error-log-if-number-is-not-within-range-of-other-worksheet/39749909#39749909", "title": "Error log if number is not within range of other worksheet", "body": "<p>First, you can define your Range that you want to check if Cell D3 is inside the values like this:</p>\n\n<pre><code>Dim Rng     As Range\n\n' set-up check range (modify Sheet name and Range to your needs)\nSet Rng = Sheets(\"metadata\").Range(\"AG2:AG23\")\n</code></pre>\n\n<p>Second, to display an error message when Cell C3 starts with \"3\", and Cell D3 value is outside that range use the line below :</p>\n\n<pre><code>  If Left(Cells(CLine, 3).Value, 1) = \"3\" And _\n    (Cells(CLine, 4).Value &lt; WorksheetFunction.Min(Rng) Or _\n    Cells(CLine, 4).Value &gt; WorksheetFunction.Max(Rng)) Then\n</code></pre>\n\n<p>And third, to check if a certain cell is Blank (or empty) change your line :</p>\n\n<pre><code>If Cells(CLine, 5).Value = blank Then\n</code></pre>\n\n<p>To :</p>\n\n<pre><code>If IsEmpty(Cells(CLine, 5)) Then\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6894058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff61c6d2e72b088bed498bf55f1a541e?s=128&d=identicon&r=PG&f=1", "display_name": "Claudia", "link": "https://stackoverflow.com/users/6894058/claudia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 39749909, "answer_count": 1, "score": 1, "last_activity_date": 1475071592, "creation_date": 1475070433, "last_edit_date": 1475071181, "question_id": 39749417, "link": "https://stackoverflow.com/questions/39749417/error-log-if-number-is-not-within-range-of-other-worksheet", "title": "Error log if number is not within range of other worksheet", "body": "<p>I'm having some trouble writing my VBA macro which does the following:</p>\n\n<p>In cell C3 I will entered a cost center and in cell D3 there will be a cost type number entered. </p>\n\n<p>Now what I want to do is display an error message that pops up, when the value in C3 starts with 3 and the value in D3 (always 7 numbers) is NOT within the rage of numbers listed in cells AG2:AG23 of another worksheet called metadata.</p>\n\n<p>My code so far is the following:</p>\n\n<pre><code>'Do While...\n\n    '...\n\n    If Left(Cells(CLine, 3).Value, 1) = \"3\" Then\n\n        If Cells(CLine, 5).Value = blank Then\n            If SLine = 1 Then\n                ErrLog = ErrLog &amp; \"Costcenter in Line\" &amp; \" \" &amp; Dline\n                SLine = SLine + 1\n            Else\n                ErrLog = ErrLog &amp; \", \" &amp; Dline\n            End If\n        End If\n\n    End If\n\n    Dline = Dline + 10\n    CLine = CLine + 1\n\nLoop\n\nIf SLine &gt; 1 Then\n    ErrLog = ErrLog &amp; \" requires WBS Element.\" &amp; vbCrLf\nEnd If\n</code></pre>\n\n<p>Now if I expand the first line like this <code>If Left(Cells(CLine, 3).Value, 1) = \"3\" and Left(Cells(CLine, 4).Value, 7) &lt;&gt; \"1000000\" Then</code> it works fine and my error message will only come up when another Value than 1000000 is entered in the Cell D3.</p>\n\n<p>But as soon as I start to use things like &lt;1000000 and >2000000 (in order to not get the message when a number between 1000000 and 2000000 is used), I get error after error.</p>\n\n<p>Can someone help me and tell me how to include a \"Between\" in in the first line of my code in an easy way, so that I get no error as soon as a number between 10000000 and 2000000 is entered?</p>\n"}, {"tags": ["vba", "excel", "dom"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475070309, "post_id": 39748820, "comment_id": 66794848, "body": "try just using one class, like Tmbsearchright"}, {"owner": {"reputation": 25, "user_id": 6893943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23fe726bd038c909a64d8e7f0326d43b?s=128&d=identicon&r=PG&f=1", "display_name": "Sameer", "link": "https://stackoverflow.com/users/6893943/sameer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475071076, "post_id": 39748820, "comment_id": 66795490, "body": "Just tried that and it didn&#39;t work.  I got the error:   &quot;Run-time error &#39;438:  Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1475071808, "post_id": 39748820, "comment_id": 66796097, "body": "Make 2 lines: <code>Set oNode = objIE.document.getElementsByClassName(&quot;Tmbsearchright&quot;)(0)</code> and <code>oNode.click</code>. Note that <code>.getElementByClassName</code> is wrong syntax. Or you may try another way: <code>Set oForm = document.forms.item(&quot;hello2&quot;)</code> and <code>oForm.submit</code>"}, {"owner": {"reputation": 25, "user_id": 6893943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23fe726bd038c909a64d8e7f0326d43b?s=128&d=identicon&r=PG&f=1", "display_name": "Sameer", "link": "https://stackoverflow.com/users/6893943/sameer"}, "edited": false, "score": 0, "creation_date": 1475071922, "post_id": 39748820, "comment_id": 66796187, "body": "Nathan, got the same 438 error.  Omega, I tried your 2nd code: get error 424: object required   1st code: error 438: object doesn&#39;t support this property/method  Sorry, this is my first time actually coding from scratching in VBA."}, {"owner": {"reputation": 25, "user_id": 6893943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23fe726bd038c909a64d8e7f0326d43b?s=128&d=identicon&r=PG&f=1", "display_name": "Sameer", "link": "https://stackoverflow.com/users/6893943/sameer"}, "edited": false, "score": 0, "creation_date": 1475074654, "post_id": 39748820, "comment_id": 66798296, "body": "Got it! Thanks guys.  For those that are curious, I used: set oNode = objIE.document.getElementsbyClassName(&quot;iPadHack tbmsearchright&quot;)(0)  oNode.click"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 6893943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23fe726bd038c909a64d8e7f0326d43b?s=128&d=identicon&r=PG&f=1", "display_name": "Sameer", "link": "https://stackoverflow.com/users/6893943/sameer"}, "is_accepted": true, "score": 0, "last_activity_date": 1475769910, "last_edit_date": 1475769910, "creation_date": 1475677355, "answer_id": 39876584, "question_id": 39748820, "link": "https://stackoverflow.com/questions/39748820/hitting-search-button-in-website-with-no-id/39876584#39876584", "title": "Hitting search button in website with no id", "body": "<p>Got it! Thanks guys. For those that are curious, I used: </p>\n\n<pre><code>set oNode = objIE.document.getElementsbyClassName(\"iPadHack tbmsearchright\")(0) \noNode.click\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6893943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23fe726bd038c909a64d8e7f0326d43b?s=128&d=identicon&r=PG&f=1", "display_name": "Sameer", "link": "https://stackoverflow.com/users/6893943/sameer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 39876584, "answer_count": 1, "score": 0, "last_activity_date": 1475769910, "creation_date": 1475068933, "last_edit_date": 1531164843, "question_id": 39748820, "link": "https://stackoverflow.com/questions/39748820/hitting-search-button-in-website-with-no-id", "title": "Hitting search button in website with no id", "body": "<p>I'm putting together a VBA where it will search a firms name into a website and search it. \nThe problem is that I can't seem to get my code right to hit the search button </p>\n\n<p>Code:</p>\n\n<pre><code>Sub SearchBot()\n\n    Dim objIE As InternetExplorer\n    Dim aEle As HTMLLinkElement\n    Dim y As Integer\n    Dim result As String\n\n    Set objIE = New InternetExplorer\n    objIE.Visible = True\n    objIE.navigate \"https://website.com\"\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n    objIE.document.getElementById(\"SearchTopBar\").Value = Sheets(\"Sheet1\").Range(\"A2\").Value\n\n    'click the 'go' button; This line below is what is causing the problem\n    objIE.document.getElementByClassName(\"iPadHack Tmbsearchright\").Click\n\n    ' this line is what the button in the website is referencing\n    'a class=\"iPadHack tmbsearchright\"onclick=\"document.forms['hello2'].submit();\"&gt; &lt;/a\n\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n</code></pre>\n"}, {"tags": ["asp.net", "vb.net", "vba"], "answers": [{"tags": [], "owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "is_accepted": false, "score": 0, "last_activity_date": 1475073212, "creation_date": 1475073212, "answer_id": 39750534, "question_id": 39748589, "link": "https://stackoverflow.com/questions/39748589/return-multiple-htmlgenericcontrol/39750534#39750534", "title": "Return multiple HtmlGenericControl", "body": "<p>Normally, you can nest <strong>HtmlGenericControl</strong> inside other <strong>HtmlGenericControl</strong>. </p>\n\n<p>If you plan to render those JavaScripts at the bottom of a page, you can place it inside div tag. </p>\n\n<pre><code>Public Function test3() As HtmlGenericControl\n    Dim div = New HtmlGenericControl(\"div\")\n\n    Dim bootstrapmin = New HtmlGenericControl(\"script\")\n    bootstrapmin.Attributes(\"src\") = \n       \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js\"\n    div.Controls.Add(bootstrapmin)\n\n    Dim bootstrap = New HtmlGenericControl(\"script\")\n    bootstrap.Attributes(\"src\") = \n       \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.js\"\n    div.Controls.Add(bootstrapmin)\n\n    Return div\nEnd Function\n</code></pre>\n\n<p><strong><em>FYI:</strong> If you plan to render inside header tag, you do not want to place them inside div. Then you will have to call that method twice.</em></p>\n"}], "owner": {"reputation": 11, "user_id": 6893888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/167d7748d180c883a9e8c9ef1ce71c60?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus Ja.", "link": "https://stackoverflow.com/users/6893888/marcus-ja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475073212, "creation_date": 1475068351, "question_id": 39748589, "link": "https://stackoverflow.com/questions/39748589/return-multiple-htmlgenericcontrol", "title": "Return multiple HtmlGenericControl", "body": "<p>I created a function in a class MyClass. This feature is intended to include stylesheets and js code:</p>\n\n<pre><code>Public Function myfunction() As HtmlGenericControl\n        Dim bootstrapmin As New HtmlGenericControl(\"script\")\n        bootstrapmin.Attributes(\"href\") = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js\" \n        Return bootstrapmin\nEnd Function\n</code></pre>\n\n<p>So far everything is working, actually in the source code is included JavaScript code. My problem is: How can I make sure that Myfunction () includes multiple stylesheets/javascript code?</p>\n\n<p>This way does not work:</p>\n\n<pre><code>Public Function test3() As HtmlGenericControl\n         Dim bootstrapmin As New HtmlGenericControl(\"script\")\n            bootstrapmin.Attributes(\"src\") = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js\" \n            Return bootstrapmin\n\n     Dim bootstrap As New HtmlGenericControl(\"script\")\n            bootstrap.Attributes(\"src\") = \"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.js\"\n            Return bootstrap\n        End Function\n</code></pre>\n\n<p>THANK YOU</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475073927, "post_id": 39748540, "comment_id": 66797732, "body": "Have you tired stepping through the code to see where the problem occurs?"}, {"owner": {"reputation": 3, "user_id": 6889337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd640d600892ef52a312ea93cc70187?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hungerman", "link": "https://stackoverflow.com/users/6889337/anthony-hungerman"}, "reply_to_user": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475076602, "post_id": 39748540, "comment_id": 66799677, "body": "I have tried stepping through the code and it was just jumping out. Now I have added a loop with the Sheet count to try to control it, but it is giving multiple instances of the same thing and logging an incorrect cell.address:"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1475078018, "post_id": 39748540, "comment_id": 66800600, "body": "When you say jumping out, what do you mean? What is the last line that <b>successfully</b> runs?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6889337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd640d600892ef52a312ea93cc70187?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hungerman", "link": "https://stackoverflow.com/users/6889337/anthony-hungerman"}, "is_accepted": true, "score": 0, "last_activity_date": 1475090089, "creation_date": 1475090089, "answer_id": 39755882, "question_id": 39748540, "link": "https://stackoverflow.com/questions/39748540/take-a-user-specified-list-and-search-for-all-instance-of-text-in-a-folder-full/39755882#39755882", "title": "Take a User Specified list and search for all instance of text in a folder full of excel files", "body": "<p>I finally figured it out. Nothing like good old F8 to walk through each step and Google to give you options. </p>\n"}], "owner": {"reputation": 3, "user_id": 6889337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd640d600892ef52a312ea93cc70187?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hungerman", "link": "https://stackoverflow.com/users/6889337/anthony-hungerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 39755882, "answer_count": 1, "score": 0, "last_activity_date": 1475090089, "creation_date": 1475068223, "last_edit_date": 1531164843, "question_id": 39748540, "link": "https://stackoverflow.com/questions/39748540/take-a-user-specified-list-and-search-for-all-instance-of-text-in-a-folder-full", "title": "Take a User Specified list and search for all instance of text in a folder full of excel files", "body": "<p>I have the following code that takes user input for a folder containing excel files and then another input for a specified \"key-word\" or \"Dirty-Word\" search. I can not get it to pull every instance for the word search. It searches all files and is looking for the correct instances, but does not pull more than one hit. I have a test folder set with multiple simple excel 2013 workbooks containing a small amount of cells with some repeated text. The loops appear to be working correctly but how do I get it to display all matches and not just the first?</p>\n\n<pre><code>Sub WordSearch()\nDim WS As Worksheet\nDim Testfolder As String\nDim a As Single\nDim sheet As Worksheet\nDim CheckReport As Variant\nDim CheckLength As Long\nDim Wordcheck As String\nDim Checksheet As Object\n\nSet WS = Sheets.Add\n\n' Open file folder for excel files\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Show\n    Testfolder = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'Open the target workbook\nCheckReport = Application.GetOpenFilename(\"Excel-files,*.xls*\", _\n1, \"Select Your CheckList File To Open\", , False)\n\n' Create Header and information for final sheet\nWS.Range(\"A1\") = \"Path\"\nWS.Range(\"B1\") = Testfolder\nWS.Range(\"A2\") = \"CheckList:\"\nWS.Range(\"B2\") = CheckReport\nWS.Range(\"A4\") = \"Matched Word\"\nWS.Range(\"B4\") = \"Workbook\"\nWS.Range(\"C4\") = \"Worksheet\"\nWS.Range(\"D4\") = \"Cell Address\"\nWS.Range(\"E4\") = \"Link\"\n\nCells.EntireColumn.AutoFit\n\nFiles = Dir(Testfolder)\n\n'Set loop to search all files in the designated folder\nDo Until Files = \"\"\n\n    If Files = \".\" Or Files = \"..\" Then\n    MsgBox \"No Excel files found\"\n\n    Else\n        If Right(Files, 3) = \"xls\" Or Right(Files, 4) = \"xlsx\" Or Right(Files, 4) = \"xlsm\" Then\n            On Error Resume Next\n            Workbooks.Open Filename:=Testfolder &amp; Files, Password:=\"zzzzzzzzzzzz\"\n            If Err.Number &gt; 0 Then\n                WS.Range(\"B5\").Offset(a, 0).Value = Files\n                WS.Range(\"C5\").Offset(a, 0).Value = \"Password protected\"\n                a = a + 1\n\n                On Error GoTo 0\n            Else\n\n            ' Open the CheckSheet to let loop count and get search words\n            Set Checksheet = Workbooks.Open(Filename:=CheckReport).Worksheets(\"Sheet1\")\n            CheckLength = Checksheet.UsedRange.Rows.Count\n            For Checkcell = 1 To CheckLength\n\n                 Wordcheck = Checksheet.Cells(Checkcell, 1).Text\n\n                    ' Set loop for each sheet in a workbook\n                    For Each sheet In ActiveWorkbook.Worksheets\n\n                         ' Set loop for each cell on a worksheet\n                         Set CellCheck = sheet.Cells.Find(Wordcheck, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n                        If Not CellCheck Is Nothing Then\n                            firstaddress = CellCheck.Address\n                        End If\n\n                            Do Until CellCheck Is Nothing\n\n                                WS.Range(\"A5\").Offset(a, 0).Value = Wordcheck\n                                WS.Range(\"B5\").Offset(a, 0).Value = Files\n                                WS.Range(\"C5\").Offset(a, 0).Value = sheet.Name\n                                WS.Range(\"D5\").Offset(a, 0).Value = CellCheck.Address\n                                WS.Hyperlinks.Add Anchor:=WS.Range(\"E5\").Offset(a, 0), Address:=Testfolder &amp; Files, SubAddress:= _\n                                sheet.Name &amp; \"!\" &amp; CellCheck.Address, TextToDisplay:=\"Link\"\n\n                                a = a + 1\n\n                                Set CellCheck = Range(\"A1:A10\").FindNext(after:=CellCheck)\n\n                               If CellCheck.Address = firstaddress Then\n                                 Exit Do\n                               End If\n\n                            Loop \n\n                  Next sheet\n\n             Next Checkcell\n\n            Workbooks(Files).Close SaveChanges:=False\n\n            End If\n\n        End If\n\n    Files = Dir\n\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I modified the code to create a loop based on the activesheet count. Now it is giving multiple duplicate instances and not logging the correct cell.address.</p>\n\n<pre><code>Sub WordSearch()\nDim WS As Worksheet\nDim Testfolder As String\nDim a As Single\nDim sheet As Worksheet\nDim CheckReport As Variant\nDim CheckLength As Long\nDim Wordcheck As String\nDim Checksheet As Object\nDim CellLoop As Long\n\nSet WS = Sheets.Add\n\n' Open file folder for excel files\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Show\n    Testfolder = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'Open the target workbook\nCheckReport = Application.GetOpenFilename(\"Excel-files,*.xls*\", _\n1, \"Select Your CheckList File To Open\", , False)\n\n' Create Header and information for final sheet\nWS.Range(\"A1\") = \"Path\"\nWS.Range(\"B1\") = Testfolder\nWS.Range(\"A2\") = \"CheckList:\"\nWS.Range(\"B2\") = CheckReport\nWS.Range(\"A4\") = \"Matched Word\"\nWS.Range(\"B4\") = \"Workbook\"\nWS.Range(\"C4\") = \"Worksheet\"\nWS.Range(\"D4\") = \"Cell Address\"\nWS.Range(\"E4\") = \"Link\"\n\nCells.EntireColumn.AutoFit\n\nFiles = Dir(Testfolder)\n\n'Set loop to search all files in the designated folder\nDo Until Files = \"\"\n\n    If Files = \".\" Or Files = \"..\" Then\n    MsgBox \"No Excel files found\"\n\n    Else\n        If Right(Files, 3) = \"xls\" Or Right(Files, 4) = \"xlsx\" Or Right(Files, 4) = \"xlsm\" Then\n            On Error Resume Next\n            Workbooks.Open Filename:=Testfolder &amp; Files, Password:=\"zzzzzzzzzzzz\"\n            If Err.Number &gt; 0 Then\n                WS.Range(\"B5\").Offset(a, 0).Value = Files\n                WS.Range(\"C5\").Offset(a, 0).Value = \"Password protected\"\n                a = a + 1\n\n                On Error GoTo 0\n            Else\n\n            ' Open the CheckSheet to let loop count and get search words\n            Set Checksheet = Workbooks.Open(Filename:=CheckReport).Worksheets(\"Sheet1\")\n            CheckLength = Checksheet.UsedRange.Rows.Count\n\n            For Checkcell = 1 To CheckLength\n\n                 Wordcheck = Checksheet.Cells(Checkcell, 1).Text\n\n                    ' Set loop for each sheet in a workbook\n                    For Each sheet In ActiveWorkbook.Worksheets\n                    SheetCheck = ActiveSheet.UsedRange.Rows.Count\n\n                    ' Set loop for each cell on a worksheet\n                    For CellLoop = 1 To SheetCheck\n\n                         Set CellCheck = sheet.Cells.Find(Wordcheck, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n                        If Not CellCheck Is Nothing Then\n                            firstaddress = CellCheck.Address\n\n                            Do\n\n                                WS.Range(\"A5\").Offset(a, 0).Value = Wordcheck\n                                WS.Range(\"B5\").Offset(a, 0).Value = Files\n                                WS.Range(\"C5\").Offset(a, 0).Value = sheet.Name\n                                WS.Range(\"D5\").Offset(a, 0).Value = CellCheck.Address\n                                WS.Hyperlinks.Add Anchor:=WS.Range(\"E5\").Offset(a, 0), Address:=Testfolder &amp; Files, SubAddress:= _\n                                sheet.Name &amp; \"!\" &amp; CellCheck.Address, TextToDisplay:=\"Link\"\n\n                                a = a + 1\n\n                            Loop While Not CellCheck Is Nothing And CellCheck.Address &lt;&gt; firstaddress\n\n                        End If\n\n                        Next CellLoop\n\n                    Next sheet\n\n            Next Checkcell\n\n            Workbooks(Files).Close SaveChanges:=False\n\n            End If\n\n        End If\n\n    Files = Dir\n\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>After much trial and error...Here is the finished VBA Macro to take user inputs for folder location and search word criteria and generate another spreadsheet laying it all out. </p>\n\n<pre><code>Sub WordSearch()\nDim WS As Worksheet\nDim Testfolder As String\nDim a As Single\nDim sheet As Worksheet\nDim CheckReport As Variant\nDim CheckLength As Long\nDim Wordcheck As String\nDim Checksheet As Object\nDim CellAddress As String\n\nSet WS = Sheets.Add\n\nMsgBox \"Please select the Folder where the Excel files are located after you click OK.\"\n\n' Open file folder for excel files\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose the Excel Folder Location\"\n    .Show\n    Testfolder = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nMsgBox \"Please select the File that contains the Dirty Word list after. Click OK to continue.\"\n\n'Open the target workbook\nCheckReport = Application.GetOpenFilename(\"Excel-files,*.xls*\", _\n1, \"Select Your Dirty Word List File To Open\", , False)\n\n' Create Header and information for final sheet\nWS.Range(\"A1\") = \"Path\"\nWS.Range(\"B1\") = Testfolder\nWS.Range(\"A2\") = \"CheckList:\"\nWS.Range(\"B2\") = CheckReport\nWS.Range(\"A4\") = \"Matched Word\"\nWS.Range(\"B4\") = \"Workbook\"\nWS.Range(\"C4\") = \"Worksheet\"\nWS.Range(\"D4\") = \"Cell Address\"\nWS.Range(\"E4\") = \"Link\"\n\nCells.EntireColumn.AutoFit\n\nFiles = Dir(Testfolder)\n\n'Set loop to search all files in the designated folder\nDo Until Files = \"\"\n\n    If Files = \".\" Or Files = \"..\" Then\n    MsgBox \"No Excel files found\"\n\n    Else\n        If Right(Files, 3) = \"xls\" Or Right(Files, 4) = \"xlsx\" Or Right(Files, 4) = \"xlsm\" Then\n            On Error Resume Next\n            Workbooks.Open Filename:=Testfolder &amp; Files, Password:=\"zzzzzzzzzzzz\"\n            If Err.Number &gt; 0 Then\n                WS.Range(\"B5\").Offset(a, 0).Value = Files\n                WS.Range(\"C5\").Offset(a, 0).Value = \"Password protected\"\n                a = a + 1\n\n                On Error GoTo 0\n            Else\n\n            ' Open the CheckSheet to let loop count and get search words\n            Set Checksheet = Workbooks.Open(Filename:=CheckReport).Worksheets(\"Sheet1\")\n            CheckLength = Checksheet.UsedRange.Rows.Count\n\n            For Checkcell = 1 To CheckLength\n\n                 Wordcheck = Checksheet.Cells(Checkcell, 1).Text\n\n                    ' Activate Current Workbook\n                      Workbooks(Files).Activate\n                    ' Set loop for each sheet in a workbook\n                    For Each sheet In ActiveWorkbook.Worksheets\n\n                    SheetCheck = sheet.UsedRange.Rows.Count\n\n                         Set CellCheck = sheet.Cells.Find(What:=Wordcheck, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n                        If Not CellCheck Is Nothing Then\n                            CellAddress = CellCheck.Address\n\n                            Do\n\n                                WS.Range(\"A5\").Offset(a, 0).Value = Wordcheck\n                                WS.Range(\"B5\").Offset(a, 0).Value = Files\n                                WS.Range(\"C5\").Offset(a, 0).Value = sheet.Name\n                                WS.Range(\"D5\").Offset(a, 0).Value = CellCheck.Address\n                                WS.Hyperlinks.Add Anchor:=WS.Range(\"E5\").Offset(a, 0), Address:=Testfolder &amp; Files, SubAddress:= _\n                                sheet.Name &amp; \"!\" &amp; CellAddress, TextToDisplay:=\"Link\"\n\n                                a = a + 1\n\n                                Set CellCheck = sheet.Cells.FindNext(After:=CellCheck)\n\n                        Loop While Not CellCheck Is Nothing And CellCheck.Address &lt;&gt; CellAddress\n\n                      End If\n\n                    Next sheet\n\n            Next Checkcell\n\n            Workbooks(Files).Close SaveChanges:=False\n\n            End If\n\n        End If\n\n    Files = Dir\n\n    End If\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 6893847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac611886a02432d3a132253011a8b15b?s=128&d=identicon&r=PG&f=1", "display_name": "ara5244", "link": "https://stackoverflow.com/users/6893847/ara5244"}, "edited": false, "score": 0, "creation_date": 1475069768, "post_id": 39748634, "comment_id": 66794363, "body": "@ara5244 if it worked for you please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1475068481, "creation_date": 1475068481, "answer_id": 39748634, "question_id": 39748530, "link": "https://stackoverflow.com/questions/39748530/excel-vba-macro-copy-cells-and-paste-values-to-active-cell-range/39748634#39748634", "title": "Excel VBA Macro - Copy Cells and Paste Values to Active Cell Range", "body": "<p>D2 would be:</p>\n\n<pre><code>Selection.Value = ActiveSheet.Range(\"A1\").Value\n</code></pre>\n\n<p>D3 would use OFFSET:</p>\n\n<pre><code>Selection.Offset(1).Value = ActiveSheet.Range(\"B4\").Value\n</code></pre>\n\n<p>So D4:</p>\n\n<pre><code>Selection.Offset(2).Value = ActiveSheet.Range(\"C3\").Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6893847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac611886a02432d3a132253011a8b15b?s=128&d=identicon&r=PG&f=1", "display_name": "ara5244", "link": "https://stackoverflow.com/users/6893847/ara5244"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475068481, "creation_date": 1475068194, "question_id": 39748530, "link": "https://stackoverflow.com/questions/39748530/excel-vba-macro-copy-cells-and-paste-values-to-active-cell-range", "title": "Excel VBA Macro - Copy Cells and Paste Values to Active Cell Range", "body": "<p>I am running into some problems with this Excel macro, as I'm pretty new to it.</p>\n\n<p>I want to take various cells, copy them, then paste their values to the active cell and the cells below it.</p>\n\n<p>For example, I have cell D2 currently selected. The values I want to copy when I run the macro are A1, B4, and C3. When I run the macro, I want to have the values of these cells paste to cells D2, D3, and D4, respectively.</p>\n\n<p>Any help with this code would be greatly appreciated!</p>\n"}, {"tags": ["sql", "excel", "stored-procedures", "parameters", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475068757, "post_id": 39748577, "comment_id": 66793527, "body": "What is the logic behind 2x single quotes? Is each element wrapped or is each comma wrapped with 2x single quote? Do I need to wrap all the parameters with single quote or one would be enough I mean <code>&#39;&#39;&#39;1&#39;&#39;,&#39;&#39;2&#39;&#39;,&#39;&#39;3&#39;&#39;&#39;,&#39;Something Else&#39;</code>"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475069204, "post_id": 39748577, "comment_id": 66793887, "body": "Thanks. Just my second question please. Do I need to wrap all the parameters with single quote or one would be enough I mean <code>&#39;&#39;&#39;1&#39;&#39;,&#39;&#39;2&#39;&#39;,&#39;&#39;3&#39;&#39;&#39;,&#39;Something Else&#39;</code>"}, {"owner": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475069289, "post_id": 39748577, "comment_id": 66793952, "body": "If <code>Something Else</code> is not part of the same string, then a single quote (as per your comment) will do"}], "tags": [], "owner": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "is_accepted": true, "score": 1, "last_activity_date": 1475069033, "last_edit_date": 1475069033, "creation_date": 1475068324, "answer_id": 39748577, "question_id": 39748527, "link": "https://stackoverflow.com/questions/39748527/passing-a-string-parameter-with-many-commas-in-sql-through-excel-ado/39748577#39748577", "title": "Passing a string parameter with many commas in SQL through Excel ADO", "body": "<p>Use a 2x single quotes to include them in the string... <code>'''1'',''2'',''3'',''Something Else'''</code></p>\n\n<p>A breakdown: </p>\n\n<pre><code>' -- Opens a string\n'' -- a single quote in a string\n''' -- opens a string and places a single quote inside it\n</code></pre>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 39748577, "answer_count": 1, "score": 0, "last_activity_date": 1475069753, "creation_date": 1475068186, "last_edit_date": 1531161705, "question_id": 39748527, "link": "https://stackoverflow.com/questions/39748527/passing-a-string-parameter-with-many-commas-in-sql-through-excel-ado", "title": "Passing a string parameter with many commas in SQL through Excel ADO", "body": "<p>I would like to execute stored procedure through Excel ADO. Is there any way to pass parameter with many commas?</p>\n\n<p>In VBA I have:</p>\n\n<pre><code>par1=\"'1','2','3'\"\npar2=\"'somthing else'\"\n\nEXEC MyProcedure par1, par2\n</code></pre>\n\n<p>It cannot be done that way because SQL reads it as four parameters (not two):</p>\n\n<pre><code>EXEC MyProcedure '1','2','3','somthing else'\n</code></pre>\n\n<p>What I am doing now is to change commas in par1 to any sets of characters which will become delimiter i.e. <code>@@@</code> and then send it as a one string:</p>\n\n<pre><code>par1=\"'1@@@2@@@3'\"\n</code></pre>\n\n<p>Then I can use:</p>\n\n<pre><code>EXEC MyProcedure par1, par2\n</code></pre>\n\n<p>Then in SQL I regain the original delimiter with </p>\n\n<pre><code>par1=REPLACE(par1,'@@@',',')\n</code></pre>\n\n<p>Is there any other simpler way which allows to keep commas in par1? Something like:</p>\n\n<pre><code>EXEC MyProcedure par1='1','2','3', par2='somthing else'\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475067332, "post_id": 39747982, "comment_id": 66792410, "body": "What cell are you trying to write <code>ProductSection</code> to?  Using the last cell in the column as the row offset doesn&#39;t really make a lot of sense."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1475067614, "post_id": 39747982, "comment_id": 66792629, "body": "You should avoide using <code>Activate</code>, <code>Select</code> and <code>ActiveCell</code>, instead use <code>With Worksheets(&quot;BH&quot;)</code> , <code>If .Cells(&quot;J&quot; &amp; 10 + Counter1).Value &lt;&gt; 0 Then</code>"}, {"owner": {"reputation": 5, "user_id": 6893713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e133c0b001d25f7222bf2a94c496b9?s=128&d=identicon&r=PG&f=1", "display_name": "HarvB", "link": "https://stackoverflow.com/users/6893713/harvb"}, "edited": false, "score": 0, "creation_date": 1475138806, "post_id": 39747982, "comment_id": 66825822, "body": "Thanks for the comments and I understand the reasons for them.  When I have applied this I get an invalid procedure call or argument error.  Sorry, I&#39;m quite new to VBA."}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1475067073, "creation_date": 1475067073, "answer_id": 39748105, "question_id": 39747982, "link": "https://stackoverflow.com/questions/39747982/why-do-i-get-a-type-mismatch-error/39748105#39748105", "title": "Why do I get a Type Mismatch Error", "body": "<p><code>Range(\"B9\").Offset(Range(\"B9\").End(xlDown), 3).Value = ProductSection</code></p>\n\n<p>should be:</p>\n\n<p><code>Range(\"B9\").Offset(Range(\"B9\").End(xlDown).Row, 3).Value = ProductSection</code></p>\n\n<p>You need to get the row, which will be a number</p>\n"}], "owner": {"reputation": 5, "user_id": 6893713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e133c0b001d25f7222bf2a94c496b9?s=128&d=identicon&r=PG&f=1", "display_name": "HarvB", "link": "https://stackoverflow.com/users/6893713/harvb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 39748105, "answer_count": 1, "score": 0, "last_activity_date": 1475067073, "creation_date": 1475066751, "last_edit_date": 1475066956, "question_id": 39747982, "link": "https://stackoverflow.com/questions/39747982/why-do-i-get-a-type-mismatch-error", "title": "Why do I get a Type Mismatch Error", "body": "<p>I am attempting to write a subroutine in VBA for Excel to create a customer price list.</p>\n\n<p>When I step through the routine I get a type mismatch at the line where I have placed the asterisk.  Can someone explain what I am doing wrong please?  Below is the code as I written it so far and there may be more errors that I have yet to discover.</p>\n\n<pre><code>Sub Create_Customer_Price_List()\n\n    Dim Counter1 As Integer\n    Dim Counter2 As Integer\n    Dim SectionNum As Integer\n    Dim ProdNum As Integer\n    Dim ProductID As String\n    Dim ProductSection As String\n\n    Worksheets(\"BH\").Activate\n\n    SectionNum = Range(\"J10\", Range(\"J10\").End(xlDown)).Rows.Count\n    Range(\"J10\").Select\n\n    For Counter1 = 1 To SectionNum\n        If ActiveCell.Value &lt;&gt; 0 Then\n        ProductSection = ActiveCell.Offset(0, 1).Value\n *       Range(\"B9\").Offset(Range(\"B9\").End(xlDown), 3).Value = ProductSection\n\n\n        End If\n\n            ProdNum = Range(\"J10\").Value\n\n            For Counter2 = 1 To ProdNum\n            ProductID = Range(\"L10\").Value &amp; Counter2\n\n            Range(\"B9\").Offset(Counter2, 0).Value = ProductID\n\n            Next Counter2\n        Range(\"J10\").Offset(Counter1 + 1, 0).Select\n\n    Next Counter1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 5558552, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1fb71588edd29af3db4ed7b650b3dee0?s=128&d=identicon&r=PG&f=1", "display_name": "jrdev22", "link": "https://stackoverflow.com/users/5558552/jrdev22"}, "is_accepted": false, "score": 0, "last_activity_date": 1475066593, "creation_date": 1475066593, "answer_id": 39747921, "question_id": 39747652, "link": "https://stackoverflow.com/questions/39747652/vba-switching-worksheets-disabled/39747921#39747921", "title": "VBA Switching Worksheets Disabled", "body": "<p>Did you try to hide the worksheet in question?\n<code>Application.ScreenUpdate = False</code> will only prevent the worksheet from updating cells.</p>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "edited": false, "score": 0, "creation_date": 1475156038, "post_id": 39748102, "comment_id": 66837963, "body": "Had to modify it a bit to my needs but <code>xlSheetVeryHidden</code> works great. Thanks!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1475067070, "creation_date": 1475067070, "answer_id": 39748102, "question_id": 39747652, "link": "https://stackoverflow.com/questions/39747652/vba-switching-worksheets-disabled/39748102#39748102", "title": "VBA Switching Worksheets Disabled", "body": "<p>You can use the <code>xlSheetVeryHidden</code> property, which can't be unhidden using the regular right-click on the Sheet Tab (but only by VBA code).</p>\n\n<p>The sample code below checks which Username is opening the workbook, and accordingly hides or shows the relevant sheets.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nSelect Case Environ(\"Username\")\n    Case \"Me\" ' modify to your PC username\n        Worksheets(\"Sheet1\").Visible = True\n        Worksheets(\"Sheet2\").Visible = xlSheetVeryHidden\n\n    Case \"Player\"  ' modify to your opponent PC username\n        Worksheets(\"Sheet1\").Visible = xlSheetVeryHidden\n        Worksheets(\"Sheet2\").Visible = True\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 5766916, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lO4w7.jpg?s=128&g=1", "display_name": "MrDominikku", "link": "https://stackoverflow.com/users/5766916/mrdominikku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 39748102, "answer_count": 2, "score": 0, "last_activity_date": 1475067070, "creation_date": 1475065942, "question_id": 39747652, "link": "https://stackoverflow.com/questions/39747652/vba-switching-worksheets-disabled", "title": "VBA Switching Worksheets Disabled", "body": "<p>I've created workbook with Battleships game. The whole \"program\" works great. Its shared workbook with 2 worksheets and battleground on each one. Its creating random ships, mark hits/misses and calculate hits/misses %. Almost finished it but I would like to improve it even more. My goal is to create code which will not allow another player to look into my battleground and see ships. Tried to use <code>Deactivate</code> module and <code>Application.ScreenUpdate = False</code> but still when I click another worksheet or hold it I can see ships.</p>\n\n<p>Any alternatives or ideas?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1475070044, "post_id": 39747643, "comment_id": 66794619, "body": "@gserg - That is not an appropriate duplicate. Due to the high incidence of invalid characters in a long list, the solution here is to use a Dictionary object loaded from the worksheet. Please reopen so I can offer a response.\\"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1475070149, "post_id": 39747643, "comment_id": 66794701, "body": "@Jeeped I&#39;m not yet used to the fact that it now closes as soon as I vote."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1475070192, "post_id": 39747643, "comment_id": 66794742, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/24384952/11683\">How to type currency symbols in Visual Basic Editor</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475070381, "post_id": 39747643, "comment_id": 66794918, "body": "Thanks (and yeah... it took me a while to get used to having a question go <b>Boom</b> like that!)"}, {"owner": {"reputation": 127, "user_id": 6598318, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10155092957211632/picture?type=large", "display_name": "Pbalazs89", "link": "https://stackoverflow.com/users/6598318/pbalazs89"}, "edited": false, "score": 0, "creation_date": 1475071094, "post_id": 39747643, "comment_id": 66795507, "body": "Sorry, how do I reopen? I&#39;m new to stackoverflow. @jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475072212, "post_id": 39747643, "comment_id": 66796430, "body": "@P&#225;szliBal&#225;zs - It has been reopened."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1475066005, "creation_date": 1475066005, "answer_id": 39747674, "question_id": 39747643, "link": "https://stackoverflow.com/questions/39747643/how-to-filter-in-vba-for-%c5%91-character/39747674#39747674", "title": "How to filter in VBA for &#39;&#39;\u0151&#39;&#39; character?", "body": "<p>what I would do in your place would be to write the character in excel and to refer it from there. Write it in some kind of settings table. </p>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1475069584, "post_id": 39747747, "comment_id": 66794206, "body": "VBA code modules are saved in ANSI. You can only enter characters that are supported by the current Windows codepage for non-Unicode programs. Excel cells, on the other hand, support Unicode, and you can put any characters there."}], "tags": [], "owner": {"reputation": 523, "user_id": 2872574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e918dc08739c9c264bb14ee8ea3a3174?s=128&d=identicon&r=PG&f=1", "display_name": "wwn", "link": "https://stackoverflow.com/users/2872574/wwn"}, "is_accepted": false, "score": -1, "last_activity_date": 1475066216, "creation_date": 1475066216, "answer_id": 39747747, "question_id": 39747643, "link": "https://stackoverflow.com/questions/39747643/how-to-filter-in-vba-for-%c5%91-character/39747747#39747747", "title": "How to filter in VBA for &#39;&#39;\u0151&#39;&#39; character?", "body": "<p>Have you tried changing the font in the VBA editor.( Tools / Options / Editor Format)\nSwitch to Times New Roman for your desired language and you should be able to enter the characters.</p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1475068286, "post_id": 39748347, "comment_id": 66793154, "body": "Assuming that the windows regional settings are set to the appropriate code page, it can also be typed directly with Alt+0151."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 2, "creation_date": 1475072084, "post_id": 39748347, "comment_id": 66796328, "body": "Great answer... but... it is a bit confusing IMO for people who might not understand your subscript of 10 to indicate that its the unicode value in decimal... still upvoted you (plus you beat me to it earlier!)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1475073231, "post_id": 39748347, "comment_id": 66797198, "body": "@RobinMackenzie  Thanks for the comment...I adjusted the answer."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 5, "last_activity_date": 1475073194, "last_edit_date": 1475073194, "creation_date": 1475067670, "answer_id": 39748347, "question_id": 39747643, "link": "https://stackoverflow.com/questions/39747643/how-to-filter-in-vba-for-%c5%91-character/39748347#39748347", "title": "How to filter in VBA for &#39;&#39;\u0151&#39;&#39; character?", "body": "<p>It appears that you have a Unicode character  337<sub>10</sub> <em>(base 10 rather than hex)</em>.  Say we start with:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IuR0k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IuR0k.png\" alt=\"enter image description here\"></a></p>\n\n<p>and apply an AutoFilter with:</p>\n\n<pre><code>Sub Macro99()\n    Dim s As String\n\n    s = ChrW(337)\n\n    With Range(\"A1:A10\")\n        .AutoFilter\n        .AutoFilter Field:=1, Criteria1:=s\n    End With\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1GTd9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1GTd9.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>You can apply this to any or all worksheets.</em></p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1475068265, "creation_date": 1475068265, "answer_id": 39748552, "question_id": 39747643, "link": "https://stackoverflow.com/questions/39747643/how-to-filter-in-vba-for-%c5%91-character/39748552#39748552", "title": "How to filter in VBA for &#39;&#39;\u0151&#39;&#39; character?", "body": "<p>Only way is post it into a cell (say A1), then refer to that cell value to filter your range (say C1:F4) - <code>ActiveSheet.Range(\"$C$1:$F$4\").AutoFilter Field:=2, Criteria1:=\"=*\" &amp; Range(\"A1\").Value &amp; \"*\", Operator:=xlAnd</code></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1475072390, "post_id": 39750033, "comment_id": 66796575, "body": "I just saw your recent edit that included the fact that you are running this on a Mac. I&#39;m not sure if you can use a Scripting.Dictionary on a Mac but you can build an array from the worksheet list."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1475072962, "post_id": 39750033, "comment_id": 66796997, "body": "Yup, <a href=\"http://stackoverflow.com/questions/5702362/vba-collection-list-of-keys/5702529#comment47733642_5702529\">it won&#39;t work on Mac</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1475073866, "post_id": 39750033, "comment_id": 66797679, "body": "See my change from a dictionary to an array above."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1475073845, "last_edit_date": 1475073845, "creation_date": 1475071935, "answer_id": 39750033, "question_id": 39747643, "link": "https://stackoverflow.com/questions/39747643/how-to-filter-in-vba-for-%c5%91-character/39750033#39750033", "title": "How to filter in VBA for &#39;&#39;\u0151&#39;&#39; character?", "body": "<p>While you could use code for each of the entries that won't 'stick' in VBA (e.g. <code>\"l\"&amp;ChrW(337)&amp;\"s\u00fct\u00f6tt\"</code>), it would be easier to use some form of repository for your list. A worksheet makes a good choice and can be hidden later if you want to avoid displaying this to the user.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sj47X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sj47X.png\" alt=\"filter_terms\"></a></p>\n\n<blockquote>\n  <p><strong>Optional:</strong> Create a dynamic named range with a <em>Refers to:</em> of<br/> \u00a0\u00a0\u00a0\u00a0\u00a0<code>=hidden!$A$2:index(hidden!$A:$A, match(\"\u017e\u017e\u017e\", hidden!$A:$A))</code></p>\n</blockquote>\n\n<p>Build a variant array from the list and use the array elements as the filter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/c4BN3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c4BN3.png\" alt=\"dict_filter_before\"></a></p>\n\n<pre><code>Option Explicit\n\nSub keyedFilter()\n    Dim fltr As Range, a As Long, arr As Variant\n\n    'load the array\n    With Worksheets(\"Hidden\")\n        With .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n            arr = Application.Transpose(.Cells.Value2)\n        End With\n    End With\n\n    'filter the data\n    With Worksheets(\"Sheet2\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n            '.AutoFilter field:=1, Criteria1:=dDICT.keys, Operator:=xlFilterValues\n            .AutoFilter field:=1, Criteria1:=arr, Operator:=xlFilterValues\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                If CBool(Application.Subtotal(103, .Cells)) Then\n\n                    'there are filtered values.\n                    'sample image was taken here\n\n                End If\n            End With\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\nEnd Sub\n\nSub reallyHideHidden()\n    With Worksheets(\"Hidden\")\n        .Visible = xlVeryHidden\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pUK8O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pUK8O.png\" alt=\"dict_filter_after\"></a></p>\n"}], "owner": {"reputation": 127, "user_id": 6598318, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10155092957211632/picture?type=large", "display_name": "Pbalazs89", "link": "https://stackoverflow.com/users/6598318/pbalazs89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1593681443, "creation_date": 1475065919, "last_edit_date": 1593681443, "question_id": 39747643, "link": "https://stackoverflow.com/questions/39747643/how-to-filter-in-vba-for-%c5%91-character", "title": "How to filter in VBA for &#39;&#39;\u0151&#39;&#39; character?", "body": "<p>I'm trying to build a filter in excel that applies to all pages, however, due to my language, there's a character (\u0151) which I cannot enter into the VBA Editor.</p>\n\n<p>Any ideas?</p>\n\n<p>I'm currently using this code:</p>\n\n<p>With Worksheets(q)\n' With each worksheet selected in the looping process we apply the Autofilter with a specific criteria. We wish to filter out all persons whose name begins with H\n.Range(\"A1\").AutoFilter field:=1, Criteria1:=Array(\"Bazsalikom\", \"Koriander\", \"Barna Rizs\", \"J\u00e1zmin Rizs\", \"Faf\u00fclgomba\", <strong>\"Csirke (el\u0151s\u00fct\u00f6tt\"</strong>, \"Tofu (kock\u00e1zott)\", \"Fejesk\u00e1poszta (cs\u00edkozott)\", \"K\u00ednai kel (szeletelt)\", \"Sz\u00f3jacs\u00edra\", \"V\u00f6r\u00f6shagyma (cs\u00edkozott)\", <strong>\"Marha (el\u0151s\u00fct\u00f6tt)\"</strong>, \"\u00dajhagyma (szeletelt)\", \"S\u00e1rgar\u00e9pa (cs\u00edkozott)\", \"Karfiol (forr\u00e1zott)\", \"K\u00e1pia Paprika\", \"Bambuszr\u00fcgy (konzerv)\", <strong>\"Sert\u00e9s (el\u0151s\u00fct\u00f6tt)\"</strong>, <strong>\"Kacsa (el\u0151s\u00fct\u00f6tt)\"</strong>, \"R\u00e1k (mirelit)\", \"Csiperke Gomba\", \"Cukkini (szeletelt)\", \"Kaliforniai Paprika\", \"Brokkoli (forr\u00e1zott)\", \"Anan\u00e1sz (konzerv - \u00e9telhez)\"), Operator:=xlFilterValues\nEnd With\nNext q\nEnd Sub</p>\n\n<p>I highlighted the problematic items <em>bold</em>. I'm using Office 2016 on a mac.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1475067624, "post_id": 39747400, "comment_id": 66792638, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2524703/save-text-file-utf-8-encoded-with-vba\">Save text file UTF-8 encoded with VBA</a>"}, {"owner": {"reputation": 67, "user_id": 5387191, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Cekxw.jpg?s=128&g=1", "display_name": "RaviKPalanisamy", "link": "https://stackoverflow.com/users/5387191/ravikpalanisamy"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475069648, "post_id": 39747400, "comment_id": 66794257, "body": "thanks for the comments. will check it now"}, {"owner": {"reputation": 67, "user_id": 5387191, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Cekxw.jpg?s=128&g=1", "display_name": "RaviKPalanisamy", "link": "https://stackoverflow.com/users/5387191/ravikpalanisamy"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475071040, "post_id": 39747400, "comment_id": 66795451, "body": "the above Link doesn&#39;t solve my problems, in my string I have stored the Combination of Russian and English data. I have System which uses india region as default region. and I want to save the data as in the string variable"}], "owner": {"reputation": 67, "user_id": 5387191, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Cekxw.jpg?s=128&g=1", "display_name": "RaviKPalanisamy", "link": "https://stackoverflow.com/users/5387191/ravikpalanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475123932, "creation_date": 1475065361, "last_edit_date": 1531164843, "question_id": 39747400, "link": "https://stackoverflow.com/questions/39747400/while-writing-a-string-which-contains-russian-to-the-txt-file-it-shown-differen", "title": "while writing a string which contains Russian to the .Txt File It shown differently in Output File in VBA?", "body": "<p>I am using Excel VBA to write a macro which converts the data from an Excel worksheet to .txt Files. </p>\n\n<p>First I convert the data into string which may some time contain other language. For some of the other languages, the input and output differs.</p>\n\n<p>I used the <code>FreeFile</code> function to create the file from Excel. </p>\n\n<p>Please help me to save the file as it is in the input string.</p>\n\n<pre><code>Dim intFileNum As String\n\nintFileNum = FreeFile\nOpen strFullFileName For Output As #intFileNum\nPrint #intFileNum, strXML\nClose #intFileNum`\n</code></pre>\n\n<p>My question different from One that Suggested cause, I write the string that contains Russian Character  to the file, While Storing the strings in the variable it becomes some other word. Please help me with this</p>\n"}, {"tags": ["excel", "vba", "sas", "stata", "panel-data"], "comments": [{"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1475066362, "post_id": 39747392, "comment_id": 66791686, "body": "This is exactly wide data and a basic Proc transpose is all that&#39;s needed in SAS. If you can&#39;t determine the code post what you&#39;ve tried. Hint: only specify your input and output dataset and by date variable."}, {"owner": {"reputation": 1343, "user_id": 4355755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de4290a12de6af4a492e25768880908?s=128&d=identicon&r=PG&f=1", "display_name": "ander2ed", "link": "https://stackoverflow.com/users/4355755/ander2ed"}, "edited": false, "score": 0, "creation_date": 1475069546, "post_id": 39747392, "comment_id": 66794170, "body": "see <code>help reshape</code> in Stata."}, {"owner": {"reputation": 30202, "user_id": 1820446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d02e8debe07eabba742833727dfa0?s=128&d=identicon&r=PG", "display_name": "Nick Cox", "link": "https://stackoverflow.com/users/1820446/nick-cox"}, "edited": false, "score": 0, "creation_date": 1475080361, "post_id": 39747392, "comment_id": 66802186, "body": "Good questions here show <i>some</i> attempt at code and (in this territory) data examples that can copied and pasted."}], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "is_accepted": false, "score": 3, "last_activity_date": 1475080979, "last_edit_date": 1475080979, "creation_date": 1475067670, "answer_id": 39748348, "question_id": 39747392, "link": "https://stackoverflow.com/questions/39747392/best-technique-to-convert-to-panel-data/39748348#39748348", "title": "Best technique to convert to panel data", "body": "<p>This can be done very easily with <code>proc transpose</code> in SAS. All you will need to add is a column name for column A. This will be your <code>by</code> variable so that the following variables will be transposed along each specific date. Other than that just make sure your data is sorted by the date column. The code would look similar to this:</p>\n\n<pre><code>proc sort data=have;\nby date;\nrun;\n\nproc transpose data=have out=want; /* you could add a name= or prefix= statement here to rename your variables */\nby date;\nrun;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 201, "user_id": 4701641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67d97e11d912d032e35d80c296e9cb24?s=128&d=identicon&r=PG&f=1", "display_name": "elbarto", "link": "https://stackoverflow.com/users/4701641/elbarto"}, "edited": false, "score": 0, "creation_date": 1475126897, "post_id": 39752246, "comment_id": 66819312, "body": "Thanks for your response. This looks so close to what I need, but actually the output I am after needs to have all the obersvations for Firm A in the order of dates and corresponding returns ascending. How would I alter it to get that?"}, {"owner": {"reputation": 201, "user_id": 4701641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67d97e11d912d032e35d80c296e9cb24?s=128&d=identicon&r=PG&f=1", "display_name": "elbarto", "link": "https://stackoverflow.com/users/4701641/elbarto"}, "edited": false, "score": 0, "creation_date": 1475138117, "post_id": 39752246, "comment_id": 66825353, "body": "There is still a problem with this. I am not sure how to sort by ascending date and ascending id at the same time. That is, have the date ascending for id = 1, then looping back to the start and ascending for id = 2.  I tried <code>gsort +date +id</code> to no avail"}, {"owner": {"reputation": 201, "user_id": 4701641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67d97e11d912d032e35d80c296e9cb24?s=128&d=identicon&r=PG&f=1", "display_name": "elbarto", "link": "https://stackoverflow.com/users/4701641/elbarto"}, "edited": false, "score": 0, "creation_date": 1475138552, "post_id": 39752246, "comment_id": 66825644, "body": "Scratch that - it actually worked but it&#39;s sorted the dates into ascending order, but recognizing the dates variable as string... i just need to change it to date"}], "tags": [], "owner": {"reputation": 1343, "user_id": 4355755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de4290a12de6af4a492e25768880908?s=128&d=identicon&r=PG&f=1", "display_name": "ander2ed", "link": "https://stackoverflow.com/users/4355755/ander2ed"}, "is_accepted": true, "score": 3, "last_activity_date": 1475077903, "creation_date": 1475077903, "answer_id": 39752246, "question_id": 39747392, "link": "https://stackoverflow.com/questions/39747392/best-technique-to-convert-to-panel-data/39752246#39752246", "title": "Best technique to convert to panel data", "body": "<p>Consider this example using <code>reshape</code> in Stata:</p>\n\n<pre><code>clear *\ninput float(date FIRM_A FIRM_B FIRM_C FIRM_D)\n 1 .14304407   .8583148  .3699433  .7310092\n 2 .34405795   .9531917  .6376472  .2895169\n 3 .04766626   .6588161  .6988417  .5564945\n 4 .21615694  .18380463  .4781089  .3058527\n 5   .709911     .85116 .14080866 .10687433\n 6  .3805699 .070911616 .55129284  .8039169\n 7  .1680727   .7267236  .1779183 .51454383\n 8  .3610604   .1578059 .15383714  .9001798\n 9  .7081585   .9755411 .28951603 .20034006\n10 .27780765   .8351805 .04982195  .3929535\nend\n\nreshape long FIRM_, i(date) j(Firm_ID) string\nrename FIRM_ return\nreplace Firm_ID = \"Firm \" + Firm_ID\n\nlist in 1/8, sepby(date)\n     +---------------------------+\n     | date   Firm_ID     return |\n     |---------------------------|\n  1. |    1    Firm A   .1430441 |\n  2. |    1    Firm B   .8583148 |\n  3. |    1    Firm C   .3699433 |\n  4. |    1    Firm D   .7310092 |\n     |---------------------------|\n  5. |    2    Firm A   .3440579 |\n  6. |    2    Firm B   .9531917 |\n  7. |    2    Firm C   .6376472 |\n  8. |    2    Firm D   .2895169 |\n     +---------------------------+\n</code></pre>\n\n<p>see <code>help reshape</code> for more on the topic. </p>\n"}], "owner": {"reputation": 201, "user_id": 4701641, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67d97e11d912d032e35d80c296e9cb24?s=128&d=identicon&r=PG&f=1", "display_name": "elbarto", "link": "https://stackoverflow.com/users/4701641/elbarto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5829, "favorite_count": 0, "accepted_answer_id": 39752246, "answer_count": 2, "score": -1, "last_activity_date": 1475080979, "creation_date": 1475065335, "last_edit_date": 1475080244, "question_id": 39747392, "link": "https://stackoverflow.com/questions/39747392/best-technique-to-convert-to-panel-data", "title": "Best technique to convert to panel data", "body": "<p>I have some returns data on 1000+ firms that I want to convert into panel form.</p>\n\n<p>From my understanding, it is neither truly wide nor long form (at least from the examples I've seen).</p>\n\n<p>I have attached an example of the original data set and what I want it to look like. Is there a way to achieve this? I am intermediate with Excel/VBA, and new to SAS/Stata but can use them and self-teach myself. </p>\n\n<p><a href=\"https://i.stack.imgur.com/OGPkt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OGPkt.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 1797935, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4197a761e1dbbc2c8e3710ca57b02314?s=128&d=identicon&r=PG", "display_name": "user1797935", "link": "https://stackoverflow.com/users/1797935/user1797935"}, "edited": false, "score": 0, "creation_date": 1475070430, "post_id": 39748262, "comment_id": 66794971, "body": "Thanks, will try that out tomorrow. Could you tell me how the update query looks like?"}], "tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 0, "last_activity_date": 1475067468, "creation_date": 1475067468, "answer_id": 39748262, "question_id": 39747384, "link": "https://stackoverflow.com/questions/39747384/how-to-update-multiple-records-at-once-in-ms-access-2013/39748262#39748262", "title": "How to update multiple records at once in MS Access 2013?", "body": "<p>Make your datasheet form a subform to an unbound main form. On the main form, add a dropdown to select status, and a command button. Get the week from whatever record is selected in the subform (or add a dropdown on the main form to select it). On the button_click, run an update query to do what you want, then refresh the subform.</p>\n"}], "owner": {"reputation": 57, "user_id": 1797935, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4197a761e1dbbc2c8e3710ca57b02314?s=128&d=identicon&r=PG", "display_name": "user1797935", "link": "https://stackoverflow.com/users/1797935/user1797935"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593766737, "creation_date": 1475065319, "last_edit_date": 1593766737, "question_id": 39747384, "link": "https://stackoverflow.com/questions/39747384/how-to-update-multiple-records-at-once-in-ms-access-2013", "title": "How to update multiple records at once in MS Access 2013?", "body": "<p>I have a database where i register the appointments of the employees. Every appointment has a status (tpi_status). Default it is on: \"Wachten op akkoord\" (Waiting for agreement).</p>\n\n<p><a href=\"https://i.stack.imgur.com/K7a3M.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K7a3M.jpg\" alt=\"TBL_PlanningIndicatie\"></a></p>\n\n<p>I use this table in a query. In this query i calculate the weeknumber (Week) and the year (Jaar) and i add the teamname (tcl_hoofd). I use this query data in a form to show me the query information. In this form i'd like to change the status of all records of a certain week at once.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TTRy9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTRy9.jpg\" alt=\"Query\"></a></p>\n\n<p>So for example i select year 2016 and week 39 in my form, i then select a new status in a dropdown and then all records in TBL_PlanningIndicatie of week 39 and year 2016 change to the new status.</p>\n\n<p>Could somebody help me out, i am thinking of a VBA after update script that inserts the new status in the table after i select a new value in the dropdown.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1475065399, "post_id": 39747301, "comment_id": 66790975, "body": "Where you have <code>Err.Clear</code> you should have <code>On Error GoTo del_Click_Err</code>, otherwise all your code will ignore errors, which is not a good idea."}, {"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475065634, "post_id": 39747301, "comment_id": 66791134, "body": "Thankyou @Andre see above edit"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475068719, "post_id": 39747301, "comment_id": 66793496, "body": "While debugging, <code>On Error Goto 0</code> is sometimes the best option, it will stop the code and highlight the offending line. With the generic <code>On Error Goto Handler</code> one doesn&#39;t know where the error occured."}, {"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475069091, "post_id": 39747301, "comment_id": 66793809, "body": "Cool, thanks again"}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1475068472, "post_id": 39748371, "comment_id": 66793311, "body": "See here for a better readable implementation of the formatted MsgBox than doing it all inline in your code: <a href=\"http://access.mvps.org/access/bugs/bugs0035.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/bugs/bugs0035.htm</a>"}], "tags": [], "owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "is_accepted": false, "score": 1, "last_activity_date": 1475067731, "creation_date": 1475067731, "answer_id": 39748371, "question_id": 39747301, "link": "https://stackoverflow.com/questions/39747301/ms-access-2010-msgbox-to-run-query-delete-record-not-working/39748371#39748371", "title": "MS Access 2010 - MsgBox to Run Query &amp; Delete Record Not Working", "body": "<p>So it turns out it was all in the Quotes.  The quotation issue is still a bit of a mystery to me, but I managed to get my code working.</p>\n\n<p>Here's the change - </p>\n\n<pre><code>LResponse = Eval(\"MsgBox(\"\"You are about to delete a record.\"\" &amp; \" &amp; _\n            \"\"\"@If you click yes, you won't be able to undo this delete operation.\"\" &amp; Chr(13) &amp; Chr(10) &amp; \" &amp; _\n            \"\"\"Are you sure you want to delete this record?@@\"\", 276, \"\"Are you sure?\"\")\")\n</code></pre>\n\n<p>Single quotes seemed to work when it was just the msgBox code by itself but not in the extended code.  Anyway, I'll know to look out for this again.</p>\n\n<p>@Andre your comment helped me debug this.  I initially left 'Error Clear' as that was what the wizard put in for the delete button.</p>\n"}], "owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475067731, "creation_date": 1475065093, "last_edit_date": 1475066064, "question_id": 39747301, "link": "https://stackoverflow.com/questions/39747301/ms-access-2010-msgbox-to-run-query-delete-record-not-working", "title": "MS Access 2010 - MsgBox to Run Query &amp; Delete Record Not Working", "body": "<p>I have a button on a Continuous subform with the below VBA attached -</p>\n\n<pre><code>Private Sub del_Click()\nOn Error GoTo del_Click_Err\nDim LResponse As Integer\n\n    On Error Resume Next\n    DoCmd.GoToControl Screen.PreviousControl.Name\n    Err.Clear\n\n    If (Not Form.NewRecord) Then\n        LResponse = Eval(\"MsgBox('You are about to delete a record.'\" &amp; _\n                    \"'@If you click yes, you won't be able to undo this delete operation.' &amp; Chr(13) &amp; Chr(10) &amp; \" &amp; _\n                    \"'Are you sure you want to delete this record?@@', 276, 'Are you sure?')\")\n        If LResponse = vbYes Then\n            DoCmd.SetWarnings False\n            DoCmd.OpenQuery \"qry_DeleteSpecific\"\n            DoCmd.RunCommand acCmdDeleteRecord\n            DoCmd.SetWarnings True\n        Else\n        End If\n    End If\n\n    If (Form.NewRecord And Not Form.Dirty) Then\n        Beep\n    End If\n\n    If (Form.NewRecord And Form.Dirty) Then\n        DoCmd.RunCommand acCmdUndo\n    End If\n\n    If (MacroError &lt;&gt; 0) Then\n        Beep\n        MsgBox MacroError.Description, vbOKOnly, \"\"\n    End If\n\ndel_Click_Exit:\n    DoCmd.SetWarnings True\n    Exit Sub\n\ndel_Click_Err:\n    MsgBox Error$\n    Resume del_Click_Exit\n\nEnd Sub\n</code></pre>\n\n<p>The button was originally the auto-generated 'Delete Record' button and I have since modified it to include the query activation as well as my own msgBox.</p>\n\n<p>The 'delete' button obviously worked fine before modification.  The query also works as intended and I tested a button on a seperate form that just included the MsgBox code, which also worked.</p>\n\n<p>But bringing it all together has failed somehow.  When I click the button I don't get the MsgBox and it doesn't delete a record or run the query.</p>\n\n<pre><code>DoCmd.GoToControl Screen.PreviousControl.Name\n</code></pre>\n\n<p>This line appears to have fired correctly though.</p>\n\n<p>Could anybody explain what may be going wrong with this?</p>\n\n<p><strong>---Edit---</strong></p>\n\n<p>Replaced</p>\n\n<pre><code>Error Clear\n</code></pre>\n\n<p>With</p>\n\n<pre><code>On Error GoTo del_Click_Err\n</code></pre>\n\n<p>I now get the error message -</p>\n\n<blockquote>\n  <p>The expression you entered contains invalid syntax</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1475065033, "post_id": 39747206, "comment_id": 66790706, "body": "Look at Regular Expressions to perform the necessary pattern matching on the filenames.  If I get time later (and nobody else has done so already) I&#39;ll put together a fuller answer for you"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1475066223, "creation_date": 1475066223, "answer_id": 39747751, "question_id": 39747206, "link": "https://stackoverflow.com/questions/39747206/would-like-excel-vba-to-refer-to-open-workbook-starting-with/39747751#39747751", "title": "Would like Excel VBA to refer to open workbook starting with", "body": "<p>You could ask the user to select the files to open, or use some way of getting a valid date (maybe a calendar control) and then use the references to those workbooks in the code.  </p>\n\n<p>The code below will ask for the location of the file (using the <code>GetFile1</code> function) and open that.  It will then open the file with todays date on the users desktop (<code>GetFile</code>) - just pass a different date for a different file.</p>\n\n<p>It will then grab the value from cell A1 in the two workbooks and place those values in cells A1:A2 of the workbook containing the code.</p>\n\n<pre><code>Public Sub Test()\n\n    Dim wrkBk1 As Workbook\n    Dim wrkBk2 As Workbook\n\n    Set wrkBk1 = Workbooks.Open(GetFile1)\n    Set wrkBk2 = Workbooks.Open(GetFile(Date))\n\n    'ThisWorkbook is the file containing this code.\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Cells(1, 1) = wrkBk1.Worksheets(\"Sheet1\").Cells(1, 1) 'Get the value from A1 and place in A1.\n        .Cells(2, 1) = wrkBk2.Worksheets(\"Sheet1\").Cells(1, 1) 'Get the value from A1 and place in A2.\n    End With\n\nEnd Sub\n\nFunction GetFile1(Optional startFolder As Variant = -1) As Variant\n    Dim fle As FileDialog\n    Dim vItem As Variant\n    Set fle = Application.FileDialog(msoFileDialogFilePicker)\n    With fle\n        .Title = \"Select a File\"\n        .AllowMultiSelect = False\n        .Filters.Add \"Excel Files\", \"*.xls*\", 1\n        If startFolder = -1 Then\n            .InitialFileName = Application.DefaultFilePath\n        Else\n            If Right(startFolder, 1) &lt;&gt; \"\\\" Then\n                .InitialFileName = startFolder &amp; \"\\\"\n            Else\n                .InitialFileName = startFolder\n            End If\n        End If\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        vItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFile = vItem\n    Set fle = Nothing\nEnd Function\n\n\nFunction GetFile(dDate As Date) As Variant\n\n    GetFile = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\Example Report \" &amp; Format(dDate, \"dd.mm.yyyy\") &amp; \".xls\"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6893569, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WLnlRL_aeS0/AAAAAAAAAAI/AAAAAAAAAYE/U1TFDGMblHk/photo.jpg?sz=128", "display_name": "Andrew Whitty", "link": "https://stackoverflow.com/users/6893569/andrew-whitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 778, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475066223, "creation_date": 1475064820, "last_edit_date": 1475065249, "question_id": 39747206, "link": "https://stackoverflow.com/questions/39747206/would-like-excel-vba-to-refer-to-open-workbook-starting-with", "title": "Would like Excel VBA to refer to open workbook starting with", "body": "<p>We work off multiple reports that all start with the name of the report and end with the date in the same format every time, such as 'Example Report 28.09.16.xls'.</p>\n\n<p>I am trying to show results from one workbook in another workbook when they are both open at the same time, is there anyway to make this work using left function or contains so that I can open any combination of 2 reports and they will pull over irrelevant of the date?</p>\n\n<pre><code>Windows(\"Example Report 28.09.16.xls\").Activate\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>=VLOOKUP(B1,'[Example Report 28.09.16.xls]Sheet1'!$B$1:$C$10,2,FALSE)\n</code></pre>\n\n<p>I would prefer this to be a macro but a formula version would be good also.</p>\n\n<p>As above I need the date to be able to be anything else, as the person opening the report will open the relevant report at the same time.</p>\n\n<p>The goal is to have an item that is referenced in a number of reports show all the data for each report next to that item in one report.</p>\n\n<p>Does anyone know of how I can do this or any better way around this?</p>\n\n<p>EDIT</p>\n\n<p>Another idea ive just had, is there a way to piece together the window to activate by using the 'Right' function to pull the date from the filename of the current file open then add it to the static report name I am referencing? such as:</p>\n\n<pre><code>Dim ReportDate As String\n\nReportDate = Right(ThisWorkbook.FullName,12)\n\nDim ReportName As String\n\nReportName = \"Example Report \"\n\nWindows( ReportName + ReportName ).Activate\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475065597, "post_id": 39747106, "comment_id": 66791106, "body": "on a side note <code>dim a,b,c as string</code> only makes c a string....."}, {"owner": {"reputation": 1, "user_id": 6893573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827414d52fb01825ae5cc1d6737129?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Garden", "link": "https://stackoverflow.com/users/6893573/daniel-garden"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475067240, "post_id": 39747106, "comment_id": 66792330, "body": "Haha was hoping that was the issue, I separated the variable but same problem. Thanks for the tip though! Will keep in mind."}, {"owner": {"reputation": 191, "user_id": 3747824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af45cd0dc3eac8e267754d1a23e703e3?s=128&d=identicon&r=PG&f=1", "display_name": "m  e", "link": "https://stackoverflow.com/users/3747824/m-e"}, "edited": false, "score": 0, "creation_date": 1475069144, "post_id": 39747106, "comment_id": 66793852, "body": "How do you define the connection to de DataBase? ODBC?"}, {"owner": {"reputation": 1, "user_id": 6893573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827414d52fb01825ae5cc1d6737129?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Garden", "link": "https://stackoverflow.com/users/6893573/daniel-garden"}, "edited": false, "score": 0, "creation_date": 1475070613, "post_id": 39747106, "comment_id": 66795116, "body": "I&#39;m opening a recordset using CurrentDb. I&#39;m sorry if that doesn&#39;t make sense, because I have no idea what I&#39;m explaining. TBH I programmed my entire life in C++ and focus on Contest Programming (CCC). Never had much experience with application development."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6893573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827414d52fb01825ae5cc1d6737129?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Garden", "link": "https://stackoverflow.com/users/6893573/daniel-garden"}, "is_accepted": true, "score": 0, "last_activity_date": 1475073161, "creation_date": 1475073161, "answer_id": 39750514, "question_id": 39747106, "link": "https://stackoverflow.com/questions/39747106/export-data-from-microsoft-access-vba-using-recordset-without-making-it-append/39750514#39750514", "title": "Export data from Microsoft Access (VBA) using recordset without making it append to previous documents", "body": "<p>Figured out the reason. The actual SQL Insert statement continued to create entries in the DB. This would all be exported to the Excel Spreadsheet making it look like it was \"appended\" to the previous document.</p>\n\n<p>Solution was just to make tables (Orders would have a parallel table called Orders_Export as an example) and use it as a middle man. The INSERT Command would insert data into both tables and the export would only export data from the Orders_Export table. The Orders_Export table was then cleared but all data remained in the Orders table. This was the work around I implemented. Thanks to all that helped!</p>\n"}], "owner": {"reputation": 1, "user_id": 6893573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed827414d52fb01825ae5cc1d6737129?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Garden", "link": "https://stackoverflow.com/users/6893573/daniel-garden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 39750514, "answer_count": 1, "score": 0, "last_activity_date": 1475073161, "creation_date": 1475064612, "question_id": 39747106, "link": "https://stackoverflow.com/questions/39747106/export-data-from-microsoft-access-vba-using-recordset-without-making-it-append", "title": "Export data from Microsoft Access (VBA) using recordset without making it append to previous documents", "body": "<p>I am working on a group project at school and need to be able to export data from an Access table to an excel document that is formatted with specific headings (for Sage import). I am having trouble with the \"exportItems\" function.</p>\n\n<p>Everytime I run my code, it will create duplicate rows in excel. For example: On export, it exports 1 item that a customer ordered. If I export it again to a different file name and location, that item will be duplicated and the excel document contains 2 instances. It then becomes 3, and then 4, if I repeat those steps.</p>\n\n<p>Any help would be appreciated. I feel like it is an error somewhere in my SQL Insert Statement.</p>\n\n<pre><code>Private Sub cmdConfirmExport_Click()\n\n\nIf Not IsNull(txtInputFile.Value) Or txtInputFile.Value = \"\" Then\n    Dim exportID As Integer\n    Dim insertOESQL, insertOEDSQL, FileName, DeleteSQL, nameInput, rsSQL As String\n    exportID = Form_QuoteDetail.QuotesID\n    nameInput = txtInputFile.Value\n\n    exportOrders (exportID)\n\n    ' To insert the order details and be able to get the line number,\n    ' create a function similar to exportCommentsOE that will use a recordset to get the values for\n    'ORDUNIQ(QuotesID FK), ITEM(Vendor Item Num), DESC(Item Description), QTYORDERED(Quantity), QTYBACKORD(Quantity),\n    'UNITPRICE(Unit Price), UNITCOST(Unit Cost)\n    ' Then with While (Not .EOF), Insert individual item records using rs.Fields([FieldName]). LINENUM\n    ' will be added as a value from a counter that goes up by 32 until it reaches the end of the recordset.\n\n    exportItems (exportID)\n    exportCommentsOE (exportID)\n\n\n    FileName = FolderSelection &amp; \"\\\" &amp; \"OE_\" &amp; nameInput &amp; \"_\" &amp; Format(Date, \"yyyyMMdd\") &amp; \".xlsx\"\n\n    'FileName = CurrentProject.Path &amp; \"\\\" &amp; \"OE_\" &amp; nameInput &amp; \"_\" &amp; Format(Date, \"yyyyMMdd\") &amp; \".xlsx\"\n\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Orders\", FileName, True\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Order_Details\", FileName, True\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Order_Detail_Lot_Numbers\", FileName, True\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Order_Detail_Serial_Numbers\", FileName, True\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Order_Payment_Schedules\", FileName, True\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Order_Comments_Instructions\", FileName, True\n    MsgBox \"Export Complete\", vbOKOnly, \"Success\"\n\n    DeleteSQL = \"DELETE * FROM Orders WHERE NOT ORDUNIQ = \" &amp; exportID\n\n    CurrentDb.Execute DeleteSQL\n    DoCmd.Close\n\nElse\n    MsgBox \"You must input a file name.\", vbOKOnly, \"Invalid Input\"\nEnd If\n\nEnd Sub\n\n\n\nFunction exportItems(itemQuoteID As Integer)\nOn Error GoTo exportError\nDim rsSQL, rsINSERTSQL As String\nDim rs As DAO.Recordset\nDim rslineCount As Integer\nDim rsORDUNIQ, rsQTYO, rsQTYBO As Integer\nDim rsUP, rsUC As Currency\nDim rsDesc, rsITEM, rsHC As String\nSet rs = Nothing\nrslineCount = 32\nrsSQL = \"SELECT [QuotesID FK], [Vendor Item Num], [Item Description], [Quantity], [Unit Price], [Unit Cost], [HASCOMMENT] FROM [Quote Detail]\" _\n        &amp; \"WHERE [QuotesID FK] = \" &amp; itemQuoteID\n\nSet rs = CurrentDb.OpenRecordset(rsSQL)\n\nWith rs\n    .MoveLast\n    .MoveFirst\n\n    While (Not .EOF)\n    rsORDUNIQ = .Fields(\"[QuotesID FK]\")\n    rsITEM = .Fields(\"[Vendor Item Num]\")\n    rsDesc = .Fields(\"[Item Description]\")\n    rsQTYO = .Fields(\"[Quantity]\")\n    rsQTYBO = .Fields(\"[Quantity]\")\n    rsUP = .Fields(\"[Unit Price]\")\n    rsUC = .Fields(\"[Unit Cost]\")\n    rsHC = .Fields(\"[HASCOMMENT]\")\n\n    rsINSERTSQL = \"INSERT INTO Order_Details(ORDUNIQ, [LINENUM], [ITEM], [DESC], [QTYORDERED], [QTYBACKORD], [UNITPRICE], [UNITCOST], [COMMINST])\" _\n                    &amp; \"VALUES (\" &amp; rsORDUNIQ &amp; \",\" &amp; rslineCount &amp; \", '\" &amp; rsITEM &amp; \"', '\" &amp; rsDesc &amp; \"',\" &amp; rsQTYO &amp; \",\" &amp; rsQTYBO &amp; \",\" &amp; rsUP &amp; \",\" &amp; rsUC _\n                    &amp; \", '\" &amp; rsHC &amp; \"')\"\n    CurrentDb.Execute rsINSERTSQL\n    rslineCount = rslineCount + 32\n    .MoveNext\n\n    Wend\n    .Close\nEnd With\n    Set rs = Nothing\nExitFunction:\n    Set rs = Nothing\n    Exit Function\nexportError:\n    MsgBox \"An error has occured during export of items.\"\n    Resume ExitFunction\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "ibm-midrange"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 1, "creation_date": 1475064324, "post_id": 39746924, "comment_id": 66790172, "body": "SQL is very powerful, so it is quite possible that you could.  Your question is too broad because you don&#39;t explain what Excel is doing."}, {"owner": {"reputation": 25, "user_id": 6377768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b5358c410b00580ea061373cf8cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Lost_In_The_Sauce", "link": "https://stackoverflow.com/users/6377768/lost-in-the-sauce"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1475064579, "post_id": 39746924, "comment_id": 66790359, "body": "The VBA code is checking if a user has filled out his/her time card(if the user has logged 37.5hr)  . If said user has not, it sends a reminder."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 2, "creation_date": 1475065724, "post_id": 39746924, "comment_id": 66791212, "body": "Depends how your time data is stored, if it&#39;s <code>USER|DATE|CLOCK IN OR OUT?|TIME|</code> then it will be very difficult using SQL. If it is <code>|USER|DATE|HOURS|</code> Then it might fairly easy, but then you have to set up the SMTP server in the DB2 and then set up the job to do it every week."}, {"owner": {"reputation": 25, "user_id": 6377768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b5358c410b00580ea061373cf8cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Lost_In_The_Sauce", "link": "https://stackoverflow.com/users/6377768/lost-in-the-sauce"}, "edited": false, "score": 0, "creation_date": 1475066751, "post_id": 39746924, "comment_id": 66791990, "body": "The data itself is |USER|DATE|HOURS| . I&#39;ll look into a setting up a SMTP server in the DB2. Thank you for the help Cody"}], "answers": [{"comments": [{"owner": {"reputation": 1239, "user_id": 4801598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7uGZ.jpg?s=128&g=1", "display_name": "CRPence", "link": "https://stackoverflow.com/users/4801598/crpence"}, "edited": false, "score": 0, "creation_date": 1475111849, "post_id": 39749589, "comment_id": 66815621, "body": "Probably easily enough scheduled, e.g. with the RUNSQL or \u2026; <a href=\"http://stackoverflow.com/questions/39331040/how-can-you-run-a-stored-procedure-from-an-ibm-command-line\" title=\"how can you run a stored procedure from an ibm command line\">stackoverflow.com/questions/39331040/&hellip;</a>"}, {"owner": {"reputation": 16176, "user_id": 2933177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LRuRW.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/2933177/charles"}, "reply_to_user": {"reputation": 1239, "user_id": 4801598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7uGZ.jpg?s=128&g=1", "display_name": "CRPence", "link": "https://stackoverflow.com/users/4801598/crpence"}, "edited": false, "score": 0, "creation_date": 1475152924, "post_id": 39749589, "comment_id": 66835584, "body": "True, but I was thinking error handling might leave something to be desired when a schedule job that just does a RUNSQL.  And if you&#39;re going to put it in a CL to schedule it, there&#39;s no real reason to go with a SQL stored proc."}, {"owner": {"reputation": 2113, "user_id": 2338816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdca08e3dceb1f254e907d6f4e7faec?s=128&d=identicon&r=PG", "display_name": "user2338816", "link": "https://stackoverflow.com/users/2338816/user2338816"}, "edited": false, "score": 0, "creation_date": 1475167970, "post_id": 39749589, "comment_id": 66846024, "body": "A CL RCVF/send-mail loop seems efficient enough."}], "tags": [], "owner": {"reputation": 16176, "user_id": 2933177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LRuRW.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/2933177/charles"}, "is_accepted": true, "score": 1, "last_activity_date": 1475070815, "creation_date": 1475070815, "answer_id": 39749589, "question_id": 39746924, "link": "https://stackoverflow.com/questions/39746924/as400-using-strsql-and-mailing-to-replace-vba-code/39749589#39749589", "title": "As400 using STRSQL and mailing? to replace VBA code", "body": "<p>The technically correct answer to your specific question is no.</p>\n\n<p>Because, STRSQL is an interactive program; you're not going to be able to run it at a set time every week.</p>\n\n<p>However what you're generally asking to do: extract data via SQL, perform some business logic over the data and send out an email, is perfectly doable on the IBM i.</p>\n\n<p>You need something to tie all three steps together.  In the IBM i world, that something would generally be RPGLE and/or CL.  You'd use embedded SQL in an RPG program to retrieve the data, then your choice of APIs to send the emails.  CL doesn't support embedded SQL like RPG does.  But you can issue an SQL statement using the <a href=\"https://www.ibm.com/support/knowledgecenter/ssw_ibm_i_72/sqlp/rbafyrunsql.htm\" rel=\"nofollow\">Run SQL (RUNSQL)</a> command to build a temporary table and then read the resulting table in CL and use for example the <a href=\"https://www.ibm.com/support/knowledgecenter/ssw_ibm_i_72/cl/sndsmtpemm.htm\" rel=\"nofollow\">Send SMTP Email (SNDSMTPEMM)</a> command to send an email.</p>\n\n<p>You could also conceivably dispense with the RPG or CL; instead using an SQL stored procedure.  However, the resulting stored procedure isn't easily directly called from the built in job scheduler access via the Work with Job Schedule Entries (WRKJOBSCDE) command.</p>\n"}, {"comments": [{"owner": {"reputation": 1239, "user_id": 4801598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7uGZ.jpg?s=128&g=1", "display_name": "CRPence", "link": "https://stackoverflow.com/users/4801598/crpence"}, "edited": false, "score": 1, "creation_date": 1475426995, "post_id": 39815285, "comment_id": 66928758, "body": "Depending on what is actually the nearly-unexplained-scenario, just send out emails with a URL so the recipient can obtain the data/results soon after they receive/read the email; thus the results [obtained with the SQL] could even be up-to-the-minute, instead of stale information."}, {"owner": {"reputation": 5378, "user_id": 2202675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4473030cd8d97fda61e3f1f023a00a9d?s=128&d=identicon&r=PG", "display_name": "danny117", "link": "https://stackoverflow.com/users/2202675/danny117"}, "edited": false, "score": 0, "creation_date": 1475512785, "post_id": 39815285, "comment_id": 66962401, "body": "And add a to the task scheduler."}], "tags": [], "owner": {"reputation": 13106, "user_id": 3735690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fOisS.png?s=128&g=1", "display_name": "Esperento57", "link": "https://stackoverflow.com/users/3735690/esperento57"}, "is_accepted": false, "score": 1, "last_activity_date": 1475397602, "creation_date": 1475397602, "answer_id": 39815285, "question_id": 39746924, "link": "https://stackoverflow.com/questions/39746924/as400-using-strsql-and-mailing-to-replace-vba-code/39815285#39815285", "title": "As400 using STRSQL and mailing? to replace VBA code", "body": "<p>I agree Charles. do a CLP with RUNSQL, SNDSMTPEMM and planed with WRKJOBSCDE</p>\n\n<p>But you can do it too:</p>\n\n<p>Do an extern program on Windows (vb, vbs, PowerShell, C# ... langages you want use) and execute your query on iseries (with ODBC by example or with native dll)</p>\n"}], "owner": {"reputation": 25, "user_id": 6377768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b5358c410b00580ea061373cf8cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Lost_In_The_Sauce", "link": "https://stackoverflow.com/users/6377768/lost-in-the-sauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 39749589, "answer_count": 2, "score": 0, "last_activity_date": 1475397602, "creation_date": 1475064198, "last_edit_date": 1531164843, "question_id": 39746924, "link": "https://stackoverflow.com/questions/39746924/as400-using-strsql-and-mailing-to-replace-vba-code", "title": "As400 using STRSQL and mailing? to replace VBA code", "body": "<p>My current solution involoves importing data from my As400 into excel and then using VBA to check conditions and send email out via outlook.</p>\n\n<p>I was wondering if there is a way to possible to trade my VBA code for a SQL statement and do this at set time (every week). i was wondering if someone could point me in the right direction.Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1475069862, "post_id": 39746311, "comment_id": 66794461, "body": "Clicking an option button will always make it&#39;s value = True.  This line is not needed: <code>OptionButton1.Value = True</code> .  You can avoid your loop and just use <code>Selection.Value  = &quot;OFF&quot;</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1475077816, "post_id": 39746311, "comment_id": 66800486, "body": "Your Click event code isn&#39;t related to your issue.  Can you <a href=\"http://stackoverflow.com/posts/39746311/edit\">edit your post</a> to include the code for your initialization?"}], "owner": {"reputation": 181, "user_id": 5018622, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b3a68ce96852446e7266cbd2e007d2ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ethannn", "link": "https://stackoverflow.com/users/5018622/ethannn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 574, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475104824, "creation_date": 1475062575, "last_edit_date": 1531164843, "question_id": 39746311, "link": "https://stackoverflow.com/questions/39746311/excel-vba-how-to-prevent-a-click-event-to-be-triggered-upon-initialize", "title": "Excel VBA | How to prevent a click-event to be triggered upon initialize", "body": "<p>Cell editing on my worksheet is done through an UF.\nUpon selecting a cell, the cell value is shown in a combobox on the UF.</p>\n\n<p>Selecting a range of cells and clicking on another item in the combobox will populate the selected range with the newly chosen item from the Combobox.</p>\n\n<p>The problem starts with the selecting of multiple cells.\nFor some reason the click-event is triggered and all selected cells are populated with value of the first selected cell in the range.</p>\n\n<p>Most probably because the initialize-event determines the first selected cells value, looks if it is found in the combobox-list, and if it is, it will show that value in the combobox.\nIt seems that showing the selected cell-value in the combobox triggers the click-event and will therefore populate all selected cells with that value.</p>\n\n<p>The same goes for option buttons on the UF.\nSome values are not in the combobox list, for example the value \"OFF\"\nSelecting a cell with the value \"OFF\" will switch the option button to true.\nbut again, if more than one cell is selected, of which the first selected cell has the value \"OFF\", all other selected cells will take the same value.</p>\n\n<p>the initialize event has for example the following line of code:</p>\n\n<pre><code>If ActiveCell.Value = \"OFF\" Then OptionButton1.Value = True\n</code></pre>\n\n<p>the click-event of the option button is as follows:</p>\n\n<pre><code>Private Sub OptionButton1_Click()\n    OptionButton1.Value = True\n    For Each C In Selection\n        C.Value = \"OFF\"\n    Next\nEnd Sub\n</code></pre>\n\n<p>The question is, how do I prevent the click-event to be triggered upon initialize?</p>\n\n<p>update:</p>\n\n<pre><code>Public Sub UserForm_Initialize() \nIf Selection.Cells.Count &gt; 1 Then\n    OptionButton1.Value = False\n    OptionButton2.Value = False\n    OptionButton3.Value = False\n    OptionButton4.Value = False\n    ComboBox1.ListIndex = -1\n    TextBox3.Text = \"\"\n    TextBox1.Text = \"\"\n    TextBox2.Text = \"\"\n    Exit Sub\nEnd If\n\nMe.ComboBox1.Clear\nFor Each Item In Sheets(\"MISC\").Range(\"UNIQUESHIFTS\")\n    myRange = Replace(Item.Value, \";\", \" | \")\n    Me.ComboBox1.AddItem myRange\nNext Item\n\nMe.ComboBox2.Clear\nFor Each Item In Sheets(\"ROSTERS\").Range(\"Rosters\")\n    Me.ComboBox2.AddItem Item.Value\nNext Item\n\nOptionButton1.Value = False\nOptionButton2.Value = False\nOptionButton3.Value = False\nOptionButton4.Value = False\nIf ActiveCell.Value = \"OFF\" Then OptionButton1.Value = True\nIf ActiveCell.Value = \"SICK\" Then OptionButton2.Value = True\nIf ActiveCell.Value = \"TRAINING\" Then OptionButton3.Value = True\nIf ActiveCell.Value = \"\" Then OptionButton4.Value = True\n\nOn Error Resume Next\nDim l As Long\nMyCell = Replace(ActiveCell.Value, Chr(10), \";\")\nl = Application.WorksheetFunction.Match(MyCell, Sheets(\"MISC\").Range(\"UNIQUESHIFTS\"), 0)\nComboBox1.ListIndex = l - 1\n\nIf InStr(ActiveCell.Value, \"-\") &gt; 0 Then\n    TextBox3.Text = Split(ActiveCell.Value, Chr(10))(0)\n    TextBox1.Text = Right(Split(ActiveCell.Value, \"-\")(0), 4)\n    TextBox2.Text = Left(Split(ActiveCell.Value, \"-\")(1), 4)\nElse\n    TextBox3.Text = \"\"\n    TextBox1.Text = \"\"\n    TextBox2.Text = \"\"\nEnd If\n\nOn Error Resume Next\nTextBox4.Value = \"\"\nTextBox4.Value = ActiveCell.Comment.Text\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "highlight"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6893175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hD2mn.jpg?s=128&g=1", "display_name": "juleshg", "link": "https://stackoverflow.com/users/6893175/juleshg"}, "edited": false, "score": 0, "creation_date": 1475141674, "post_id": 39748402, "comment_id": 66827763, "body": "I don&#39;t know if this is right but I&#39;m posting the improvements with your recommendation in another answer, to put the code."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 13, "user_id": 6893175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hD2mn.jpg?s=128&g=1", "display_name": "juleshg", "link": "https://stackoverflow.com/users/6893175/juleshg"}, "edited": false, "score": 0, "creation_date": 1475141871, "post_id": 39748402, "comment_id": 66827914, "body": "It&#39;s only right if the improvements solved the problem (in which case it isn&#39;t really necessary). If there are new problems that would be an edit to the question or a new question."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 0, "last_activity_date": 1475069578, "last_edit_date": 1475069578, "creation_date": 1475067838, "answer_id": 39748402, "question_id": 39746188, "link": "https://stackoverflow.com/questions/39746188/highlight-found-text-if-it-is-a-complete-word-count-separation-of-repeated-word/39748402#39748402", "title": "Highlight found text if it is a complete word, count separation of repeated words, process selected text", "body": "<p>1) There are <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193977.aspx\" rel=\"nofollow\">many options</a> for the <code>Find.Execute</code> method. <code>MatchWholeWord</code> is probably what you're looking for. I'd recommend setting your options before executing, such as in this example taken from the MSDN site</p>\n\n<pre><code>With Selection.Find \n    .ClearFormatting \n    .MatchWholeWord = True \n    .MatchCase = False \n    .Execute FindText:=\"library\" \nEnd With\n</code></pre>\n\n<p>2) <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836346.aspx\" rel=\"nofollow\">Punctuation and paragraph marks in a document are included in the Words collection.</a>\nSince you are counting manually you could just exclude the punctuation manually. It's a bit messy but the quickest fix I can think of. Something like</p>\n\n<pre><code>If Instr(\".,;:!?...\", SingleWordR) = 0 Then thisWord = thisWord + 1 'would have to put all punctuation character inside the string\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If SingleWordR Like \"[!a-zA-Z]\" Then thisWord = thisWord + 1 'this would not include special characters though\n</code></pre>\n\n<p><strong>edit:</strong> This would also have to be done with <code>countword</code></p>\n\n<p>3) Apparently a selection change event <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192791.aspx\" rel=\"nofollow\">is possible</a> but an easier way might be to write a macro that checks if the current selection is highlighted and highlights other occurrences, then assign a key command to it (through the word options). The same macro could also be used to recolor the words to turquoise (would have to be run again by the user).</p>\n\n<hr>\n\n<p>I'm not sure about your highlighting and distance counting though. You store each word that appears more than once and the distance to each of the other occurences. So your array for a text like \"a b b a b\" would look like this</p>\n\n<pre><code>a  3\nb  1\nb  3\na -3\nb -1\nb  2\nb -3\nb -2\n</code></pre>\n\n<p>Then you highlight all the occurences of each entry based on the second column. That would mean that the only relevant value is the last (positive), in this case 2 for a and 2 for b. It can be seen with \"day\" in your example. The first two occurrences are less then 21 apart are underlined dotted.</p>\n\n<p>You are also looping through all the words for every word. That means (number of words)*(number of words) iterations. You should at least stop once thisword-countword > 50.</p>\n\n<p>Maybe another approach would be to look ahead of each word by 5, 10, 20, 50 words and highlight all the other occurrences (and the word itself) if found. </p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6893175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hD2mn.jpg?s=128&g=1", "display_name": "juleshg", "link": "https://stackoverflow.com/users/6893175/juleshg"}, "edited": false, "score": 0, "creation_date": 1475147515, "post_id": 39767444, "comment_id": 66831654, "body": "@arcadeprecinct Another update, I&#39;ve tried my inefficient code and it took 15 minutes! to process 2570 words. Not the better solution, obviously. Now I know that I don&#39;t need too much words revised, only the &quot;neighbor&quot; words up to 150 or 200 in distance."}], "tags": [], "owner": {"reputation": 13, "user_id": 6893175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hD2mn.jpg?s=128&g=1", "display_name": "juleshg", "link": "https://stackoverflow.com/users/6893175/juleshg"}, "is_accepted": false, "score": 0, "last_activity_date": 1475144841, "last_edit_date": 1475144841, "creation_date": 1475143905, "answer_id": 39767444, "question_id": 39746188, "link": "https://stackoverflow.com/questions/39746188/highlight-found-text-if-it-is-a-complete-word-count-separation-of-repeated-word/39767444#39767444", "title": "Highlight found text if it is a complete word, count separation of repeated words, process selected text", "body": "<p>I've come with this:</p>\n\n<pre><code>Sub RepeatedWordsShow()\n    Const maxwords = 9000                               'Maximum unique words allowed\n    Dim SingleWordA As String                           'Raw word pulled from doc\n    Dim SingleWordR As String\n    Dim RepeatedWords(maxwords) As String\n    Dim RepeatedWordsDistances(maxwords) As Integer\n    Dim rwnum As Integer\n    Dim worddistance As Integer\n    Dim countWord As Integer\n    Dim thisWord As Integer\n    Dim ttlwds As Long                      'Total words in the document\n    Dim Excludes As String                  'Words to be excluded\n    Dim Found As Boolean                    'Temporary flag\n    Dim j, k As Integer                     'Temporary variables\n\n    ' Set up excluded words\n    Excludes = \"[a][an][and][at][for][from][he][her][his][in][of][on][she][the][to][was][with]\"\n\n\n    Selection.HomeKey Unit:=wdStory\n    System.Cursor = wdCursorWait\n    ttlwds = ActiveDocument.Words.Count\n\n    rwnum = 0\n    countWord = 0\n    thisWord = 0\n\n    For Each aword In ActiveDocument.Words\n        SingleWordA = Trim(LCase(aword))\n        'Out of range?\n        If SingleWordA &lt; \"a\" Or SingleWordA &gt; \"z\" Then\n            SingleWordA = \"\"\n        End If\n        'On exclude list?\n        If InStr(Excludes, \"[\" &amp; SingleWordA &amp; \"]\") Then\n            SingleWordA = \"\"\n            countWord = countWord + 1\n        End If\n        'If word is valid, compare with all words\n        If Len(SingleWordA) &gt; 0 And SingleWordA Like \"[a-zA-Z]*\" Then\n            'Comparing\n            countWord = countWord + 1\n            For Each rword In ActiveDocument.Words\n                SingleWordR = Trim(LCase(rword))\n                If SingleWordR &lt; \"a\" Or SingleWordR &gt; \"z\" Then\n                    SingleWordR = \"\"\n                End If\n                If InStr(Excludes, \"[\" &amp; SingleWordR &amp; \"]\") Then\n                    SingleWordR = \"\"\n                    thisWord = thisWord + 1\n                End If\n                If Len(SingleWordR) &gt; 0 And SingleWordR Like \"[a-zA-Z]*\" Then\n                    thisWord = thisWord + 1\n                    If SingleWordR = SingleWordA Then\n                        If thisWord &lt;&gt; countWord Then\n                           RepeatedWords(rwnum) = SingleWordR\n                           worddistance = thisWord - countWord\n                           RepeatedWordsDistances(rwnum) = Abs(worddistance)\n                           rwnum = rwnum + 1\n                           'Debug.Print \"Repeated Word:\" + RepeatedWords(rwnum) + \"  Distance:\" + Str(RepeatedWordsDistances(rwnum))\n                        End If\n                    End If\n                End If\n            Next rword\n            thisWord = 0\n\n        End If\n       ttlwds = ttlwds - 1\n       StatusBar = \"Remaining: \" &amp; ttlwds\n\n    Next aword\n\n\n    'Highlighs and Underlines words\n\n    k = 0\n    For Each itm In RepeatedWords\n        Selection.Find.ClearFormatting\n        Selection.Find.MatchWholeWord = True\n        Selection.HomeKey wdStory, wdMove\n        Selection.Find.Execute itm\n        Do Until Selection.Find.Found = False\n            If RepeatedWordsDistances(k) &gt; 0 And RepeatedWordsDistances(k) &lt; 6 Then\n            Selection.Font.Underline = wdUnderlineDouble\n            End If\n            If RepeatedWordsDistances(k) &gt; 5 And RepeatedWordsDistances(k) &lt; 11 Then\n            Selection.Font.Underline = wdUnderlineSingle\n            End If\n            If RepeatedWordsDistances(k) &gt; 10 And RepeatedWordsDistances(k) &lt; 21 Then\n            Selection.Font.Underline = wdUnderlineDash\n            End If\n            If RepeatedWordsDistances(k) &gt; 20 Then\n            Selection.Font.Underline = wdUnderlineDotted\n            End If\n            Selection.Range.HighlightColorIndex = wdTurquoise\n            Selection.Find.Execute\n        Loop\n    k = k + 1\n    Next\n\n    'Now write out the results\n    'tmpName = ActiveDocument.AttachedTemplate.FullName\n    'Documents.Add Template:=tmpName, NewTemplate:=False\n    'Selection.ParagraphFormat.TabStops.ClearAll\n    'With Selection\n    '    For j = 1 To rwnum\n    '        .TypeText Text:=Trim(Str(RepeatedWordsDistances(j))) _\n    '          &amp; vbTab &amp; RepeatedWords(j) &amp; vbCrLf\n    '    Next j\n    'End With\n\n    'Write results in immediate window\n    For j = 1 To rwnum\n     Debug.Print \"Repeated Word:\" + RepeatedWords(j) + \"  Distance:\" + Str(RepeatedWordsDistances(j))\n    Next j\n\n    System.Cursor = wdCursorNormal\nEnd Sub\n</code></pre>\n\n<p>To your answer, arcadeprecinct:</p>\n\n<p>1) I have implemented this, that was exactly what I needed (sorry, I'm not an experienced programmer) <code>.MatchWholeWord = True</code> works as expected.</p>\n\n<p>2) I implemented this, too. The expression <code>Like \"[a-zA-Z]*\"</code> works very well.</p>\n\n<p>3) Let me explain, the reason what I'm doing this is because I'm writing in spanish, and I've observed this is a frequent problem with writing. I have to check and recheck my text and sometimes is difficult to spot repeated words. Some repetitions are intentional, some are not. I've tried some software, Scrivener only reports text statistics but I have to close the report and search manually all the occurrences. MSWord only counts words. ProWritingAid does a very good job but still the text has to be pasted in their box. Notepad++ has a feature: when you click any word, it highlights all the same words in the same text, but still I have to make the corrections in the original text, losing all formatting. My macro helps me to work directly on the text, a combo of ProWritingAid and Notepad++.</p>\n\n<p>So I'll look forward to:</p>\n\n<p>a) Highlight the same words with a special click on one. Highlighting tells me \"this word is repeated, 2 or more times\" (it would be nice to implement color code for ranges of occurrences). The Underline feature works like: the heaviest underlined is the nearest repetition, is easier to spot it with that method. It depends to me as a writer to preserve the word or not.</p>\n\n<p>b) To give a context to work with: Document, Section or Paragraph. Obviously, my macro will be difficult to use in a document of a greater number of words, so as you say, I'll try to put the limits to sections only, or a limited number of words. If I use this in a long, long file, it could hang or crash the system.</p>\n\n<p>I solved the issue of the \"negative distances\" with <code>Abs(worddistance)</code>.</p>\n\n<p>Anyway, I'll give a try to another approach, as you say, because I agree that my code is inefficient. My interest is to heavily underline the nearest words. Distanced duplications are least important, but it finally has to mark every duplicated word. Can you help me to improve the code in the main For-Each block? The objective is: any given distance between two identical words, the one that matters is the lesser one, so it'll have to mark the words with the heaviest underline (Double), even if other occurrences of that words are far. </p>\n\n<p>Am I allowed to keep posting my future editions in this thread? I'm new to this.</p>\n\n<p>Thank you very much for the valuable help!</p>\n\n<p><strong>edit:</strong> You said </p>\n\n<blockquote>\n  <p>\"Maybe another approach would be to look ahead of each word by 5, 10,\n  20, 50 words and highlight all the other occurrences (and the word\n  itself) if found.\"</p>\n</blockquote>\n\n<p>I agree with this, but looking ahead until the end of the text, highlighting all the occurrences, the word itself, and storing only the lesser distance for the underlines. That would be nice but at this moment I have no idea how to search from the actual word to forward. I'll figure it out or you can give me a clue.</p>\n"}], "owner": {"reputation": 13, "user_id": 6893175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hD2mn.jpg?s=128&g=1", "display_name": "juleshg", "link": "https://stackoverflow.com/users/6893175/juleshg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491775979, "creation_date": 1475062234, "last_edit_date": 1491775979, "question_id": 39746188, "link": "https://stackoverflow.com/questions/39746188/highlight-found-text-if-it-is-a-complete-word-count-separation-of-repeated-word", "title": "Highlight found text if it is a complete word, count separation of repeated words, process selected text", "body": "<p>I need to highlight words in a document and show some clues on distances between them. I've this program that I assembled from different pieces.</p>\n\n<pre><code>Sub RepeatedWordsShow()\n\n    Const maxwords = 9000                               'Maximum words allowed\n    Dim SingleWordA As String                       'Raw word pulled from doc\n    Dim SingleWordR As String               'Raw word to compare\n    Dim RepeatedWords(maxwords) As String       'Array to hold repeated words\n    Dim RepeatedWordsDistances(maxwords) As Integer 'Distances of words\n    Dim rwnum As Integer                'counter for repeated word list\n    Dim worddistance As Integer             'Temporary variable\n    Dim countWord As Integer                'Actual word\n    Dim thisWord As Integer             'Actual comparing word\n    Dim ttlwds As Long                                  'Total words in the document\n    Dim Excludes As String                              'Words to be excluded\n    Dim Found As Boolean                'Temporary flag\n    Dim j, k As Integer                         'Temporary variables\n\n    ' Set up excluded words\n    Excludes = \"[a][an][and][at][for][from][he][her][his][in][of][on][she][the][to][was]\"\n\n    Selection.HomeKey Unit:=wdStory\n    System.Cursor = wdCursorWait\n    ttlwds = ActiveDocument.Words.Count\n\n    rwnum = 0\n    countWord = 0\n    thisWord = 0\n\n    For Each aword In ActiveDocument.Words\n        SingleWordA = Trim(LCase(aword))\n        'Out of range?\n        If SingleWordA &lt; \"a\" Or SingleWordA &gt; \"z\" Then\n            SingleWordA = \"\"\n        End If\n        'On exclude list?\n        If InStr(Excludes, \"[\" &amp; SingleWordA &amp; \"]\") Then\n            SingleWordA = \"\"\n        End If\n        If Len(SingleWordA) &gt; 0 Then\n            For Each rword In ActiveDocument.Words\n                SingleWordR = Trim(LCase(rword))\n                If SingleWordR &lt; \"a\" Or SingleWordR &gt; \"z\" Then\n                    SingleWordR = \"\"\n                End If\n                If InStr(Excludes, \"[\" &amp; SingleWordR &amp; \"]\") Then\n                    SingleWordR = \"\"\n                End If\n                If Len(SingleWordR) &gt; 0 Then\n                    If SingleWordR = SingleWordA Then\n                        If thisWord &lt;&gt; countWord Then\n                           RepeatedWords(rwnum) = SingleWordR\n                           worddistance = thisWord - countWord\n                           RepeatedWordsDistances(rwnum) = worddistance\n                           rwnum = rwnum + 1\n                        End If\n                    End If\n                End If\n            thisWord = thisWord + 1\n            Next rword\n            thisWord = 0\n\n        End If\n        ttlwds = ttlwds - 1\n        StatusBar = \"Remaining: \" &amp; ttlwds\n        countWord = countWord + 1\n    Next aword\n\n    'Highlights and Underlines words\n\n    k = 0\n    For Each itm In RepeatedWords\n        Selection.Find.ClearFormatting\n        Selection.HomeKey wdStory, wdMove\n        Selection.Find.Execute itm\n        Do Until Selection.Find.Found = False\n            'Selection.Font.Underline = wdUnderlineDotted\n            If RepeatedWordsDistances(k) &gt; 0 And RepeatedWordsDistances(k) &lt; 6 Then\n            Selection.Font.Underline = wdUnderlineDouble\n            End If\n            If RepeatedWordsDistances(k) &gt; 5 And RepeatedWordsDistances(k) &lt; 11 Then\n            Selection.Font.Underline = wdUnderlineSingle\n            End If\n            If RepeatedWordsDistances(k) &gt; 10 And RepeatedWordsDistances(k) &lt; 21 Then\n            Selection.Font.Underline = wdUnderlineDash\n            End If\n            If RepeatedWordsDistances(k) &gt; 20 And RepeatedWordsDistances(k) &lt; 51 Then\n            Selection.Font.Underline = wdUnderlineDotted\n            End If\n            Selection.Range.HighlightColorIndex = wdTurquoise\n            Selection.Find.Execute\n        Loop\n    k = k + 1\n    Next\n\n    'Now report the results\n    'tmpName = ActiveDocument.AttachedTemplate.FullName\n    'Documents.Add Template:=tmpName, NewTemplate:=False\n    'Selection.ParagraphFormat.TabStops.ClearAll\n    'With Selection\n    '    For j = 1 To rwnum\n    '        .TypeText Text:=Trim(Str(RepeatedWordsDistances(j))) _\n    '          &amp; vbTab &amp; RepeatedWords(j) &amp; vbCrLf\n    '    Next j\n    'End With\n\n    System.Cursor = wdCursorNormal\n\nEnd Sub\n</code></pre>\n\n<p>The objective is to highlight the repeated words (now in turquoise), and underline the words according to various ranges of distances from their occurrences (double line to nearest words, dots to far).</p>\n\n<p>This solution has some problems:</p>\n\n<p>1) The last block: 'Highlights and underlines words' processes words inside words. t marks \"light\" in \"highlighting\", as an example, if light is marked as a repeated word in the obtained list (RepeatedWords). How I can avoid that?</p>\n\n<p>2) The distance number counts commas, dots and semicolons from the text, even if they do not appear in the list. The last commented section generates a report to see that.</p>\n\n<p>3) How can the user, after that macro is done, perform an action over a marked word (double-right click, middle click, triple click, something like that, and the same words of that occurrence then highlights with another color (yellow) to identify them?</p>\n\n<p>See it in action <img src=\"https://i.stack.imgur.com/Yre5R.jpg\" alt=\"See it in action\"></p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475062145, "post_id": 39746114, "comment_id": 66788692, "body": "put stop the line before End If or just after the if line"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1475063765, "creation_date": 1475063765, "answer_id": 39746764, "question_id": 39746114, "link": "https://stackoverflow.com/questions/39746114/excel-vba-sreach/39746764#39746764", "title": "Excel VBA sreach", "body": "<p>I am not sure why you are using <code>If .Cells(currentrow, 3).Text Like \"*\" &amp; myfname &amp; \"*\" Then</code> since you are searching for wildcard, it will enter this <code>If</code> condition on every try.</p>\n\n<p>The code below will execute one \"<strong>find</strong>\" on every click of the button, when you reach the end, it will restart. (you can remove it by modifying the first <code>If startrow &lt; 2 Or startrow &gt;= lastrow Then</code>)</p>\n\n<pre><code>Option Explicit \n\nPublic startrow                 As Long\n\nSub cmdFindNext_Click()\n\nDim lastrow                     As Long\nDim currentrow                  As Long\nDim myfname                     As String\n\nWith Sheets(\"Sheet2\")\n\n    lastrow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    ' reset the start row if first run, or finished scanning entire range\n    If startrow &lt; 2 Or startrow &gt;= lastrow Then\n        startrow = 2\n    End If\n\n    myfname = txtUsername.Text\n\n    For currentrow = startrow To lastrow\n        If .Cells(currentrow, 3).Text Like \"*\" &amp; myfname &amp; \"*\" Then\n\n            txtHost.Text = .Cells(currentrow, 2).Text\n            txtUsername.Text = .Cells(currentrow, 3).Text\n            txtPassword.Text = .Cells(currentrow, 4).Text\n            txtUser.Text = .Cells(currentrow, 5).Text\n            txtDepartment.Text = .Cells(currentrow, 6).Text\n            txtPosition.Text = .Cells(currentrow, 7).Text\n            txtFormerusers.Text = .Cells(currentrow, 8).Text\n            txtCompany.Text = .Cells(currentrow, 9).Text\n\n            startrow = startrow + 1\n            Exit Sub\n        End If\n    Next currentrow\nEnd With\n\ntxtUsername.SetFocus\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6893184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac964159994fbfc34783d2ad991092c?s=128&d=identicon&r=PG&f=1", "display_name": "admin", "link": "https://stackoverflow.com/users/6893184/admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 39746764, "answer_count": 1, "score": 0, "last_activity_date": 1475063765, "creation_date": 1475061993, "question_id": 39746114, "link": "https://stackoverflow.com/questions/39746114/excel-vba-sreach", "title": "Excel VBA sreach", "body": "<p>I have a piece of code (VBA) that search through a sheet and finds matches then shows up the last matching row in some text boxes.\nI put this code in a button,and want to make it to stop each time it finds an occurrence instead of finding the last one and stop.</p>\n\n<p>here's the code: </p>\n\n<pre><code>Private Sub cmdFindNext_Click()\nDim lastrow\nDim myfname As String\nlastrow = Sheets(\"Sheet2\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nmyfname = txtUsername.Text\nFor currentrow = 2 To lastrow\nIf Cells(currentrow, 3).Text Like \"*\" &amp; myfname &amp; \"*\" Then\n\ntxtHost.Text = Cells(currentrow, 2).Text\ntxtUsername.Text = Cells(currentrow, 3).Text\ntxtPassword.Text = Cells(currentrow, 4).Text\ntxtUser.Text = Cells(currentrow, 5).Text\ntxtDepartment.Text = Cells(currentrow, 6).Text\ntxtPosition.Text = Cells(currentrow, 7).Text\ntxtFormerusers.Text = Cells(currentrow, 8).Text\ntxtCompany.Text = Cells(currentrow, 9).Text\n\nEnd If\nNext currentrow\ntxtUsername.SetFocus\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1475059743, "post_id": 39745198, "comment_id": 66787008, "body": "Assuming the textbox is named <code>TextBox1</code>, could you check for this in <code>TextBox1_Change()</code> and process it accordingly?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1475060994, "post_id": 39745198, "comment_id": 66787892, "body": "You have narrowed it down too much. The showed code neither populates nor clears a text box. It calls a file dialog and then does nothing with the selected file. It simply ends without returning something, regardless of whether there is a file selected or cancel is clicked."}, {"owner": {"reputation": 513, "user_id": 3801724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/247966d9c96524df4f3f320d69300d45?s=128&d=identicon&r=PG&f=1", "display_name": "Cornflake2068", "link": "https://stackoverflow.com/users/3801724/cornflake2068"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1475063666, "post_id": 39745198, "comment_id": 66789701, "body": "@AxelRichter I Missed out GetFileName = .SelectedItems(1) just above the End With. I Know where It was going wrong now beceause the GetFileName was being set to &quot;&quot; which was then populating in my textbox. I now test it before it populates the textbox. Thanks for responding though guys!"}], "answers": [{"tags": [], "owner": {"reputation": 513, "user_id": 3801724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/247966d9c96524df4f3f320d69300d45?s=128&d=identicon&r=PG&f=1", "display_name": "Cornflake2068", "link": "https://stackoverflow.com/users/3801724/cornflake2068"}, "is_accepted": true, "score": 0, "last_activity_date": 1475073206, "creation_date": 1475073206, "answer_id": 39750532, "question_id": 39745198, "link": "https://stackoverflow.com/questions/39745198/vba-excel-choose-file-when-cancel-is-clicked-it-clears-the-textbox/39750532#39750532", "title": "VBA Excel Choose File - When cancel is clicked it clears the textbox", "body": "<p>This done the trick. Making sure the file name has a value before populating the textbox    </p>\n\n<pre><code>Private Sub btnBrowse_Click()\n\n    Dim sFileName As String\n\n    sFileName = GetFileName()\n\n    If Len(sFileName) &gt; 0 Then\n        TextBox1.Value = sFileName\n    End If\n\nEnd Sub\n\nFunction GetFileName()\n\n    Set MyFile = Application.FileDialog(msoFileDialogOpen)\n\n    With MyFile\n        .Title = \"Choose File\"\n        .AllowMultiSelect = False\n\n        If .Show &lt;&gt; -1 Then\n            Exit Function\n        End If\n        GetFileName = .SelectedItems(1)\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 3801724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/247966d9c96524df4f3f320d69300d45?s=128&d=identicon&r=PG&f=1", "display_name": "Cornflake2068", "link": "https://stackoverflow.com/users/3801724/cornflake2068"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 39750532, "answer_count": 1, "score": 2, "last_activity_date": 1475073206, "creation_date": 1475059393, "last_edit_date": 1475064626, "question_id": 39745198, "link": "https://stackoverflow.com/questions/39745198/vba-excel-choose-file-when-cancel-is-clicked-it-clears-the-textbox", "title": "VBA Excel Choose File - When cancel is clicked it clears the textbox", "body": "<p>Basically I have a spreadsheet with a form on it. On that form there is a textbox that contains a file path which could be pre-populated from a cell on the sheet. But the user can choose to browse for another file. When they are browsing they have an option of \"Open\" or \"Cancel\". The open button works fine and populates the textbox, but if they choose cancel it clears the textbox if it is already populated. How can I stop the textbox being cleared? </p>\n\n<p>I have narrowed it down to this block of code where it is happening:</p>\n\n<pre><code>Function GetFileName()\n\n    Set MyFile = Application.FileDialog(msoFileDialogOpen)\n\n    With MyFile\n        .Title = \"Choose File\"\n        .AllowMultiSelect = False\n\n        If .Show &lt;&gt; -1 Then\n            Exit Function\n        End If\n        GetFileName = .SelectedItems(1)\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475059862, "post_id": 39744901, "comment_id": 66787096, "body": "in which worksheet event is this code placed ? in &quot;Sheet4&quot; ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475060644, "post_id": 39744901, "comment_id": 66787665, "body": "are your formulas realy changing ? you are looking to use R1C1 ? since you are using these formulas only on Cells B8 and C8 in Sheet4"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 0, "last_activity_date": 1475062175, "last_edit_date": 1475062175, "creation_date": 1475061492, "answer_id": 39745942, "question_id": 39744901, "link": "https://stackoverflow.com/questions/39744901/using-countif-and-count-in-vba-macro-from-different-sheet-but-getting-error-subs/39745942#39745942", "title": "using countif and count in vba macro from different sheet but getting error Subscript out of range", "body": "<p>You are changing the selection in a macro that is called when the selection changes, so it forms an infinite loop.</p>\n\n<p>You are also mixing R1C1 notation and column letter notation.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Sheets(\"Sheet4\").Range(\"B8\").Formula = \"=COUNTA('Raw data'!B:B)-1\"\n  Sheets(\"Sheet4\").Range(\"C8\").Formula = \"=COUNTIF('Raw data'!M:M,\"\"Suppress\"\")\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2742224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd00db1359da31f47903863e1b25e8ac?s=128&d=identicon&r=PG&f=1", "display_name": "ROHIT VIJAY", "link": "https://stackoverflow.com/users/2742224/rohit-vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 39745942, "answer_count": 1, "score": 0, "last_activity_date": 1475062175, "creation_date": 1475058612, "last_edit_date": 1475060348, "question_id": 39744901, "link": "https://stackoverflow.com/questions/39744901/using-countif-and-count-in-vba-macro-from-different-sheet-but-getting-error-subs", "title": "using countif and count in vba macro from different sheet but getting error Subscript out of range", "body": "<p>I'm using <code>COUNTIF</code> and <code>COUNTA</code> in VBA macro from different sheets but getting error </p>\n\n<blockquote>\n  <p>Subscript out of range</p>\n</blockquote>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Sheets(\"Sheet4\").Range(\"B8\").Select\n  ActiveCell.FormulaR1C1 = \"=COUNTA('Raw data'![B:B]-1)\"\n  Sheets(\"Sheet4\").Range(\"C8\").Select\n  ActiveCell.FormulaR1C1 = \"=COUNTIF('Raw data'![M:M],\"\"Suppress\"\")\"\n  Range(\"C9\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "edited": false, "score": 0, "creation_date": 1475059232, "post_id": 39744982, "comment_id": 66786658, "body": "Thanks - how would I use that to assign the value retrieved by the formula to a variable in the VBA?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1475059563, "last_edit_date": 1475059563, "creation_date": 1475058845, "answer_id": 39744982, "question_id": 39744869, "link": "https://stackoverflow.com/questions/39744869/vba-macro-sum-variable-range/39744982#39744982", "title": "VBA Macro Sum Variable Range", "body": "<pre><code>activecell.Formula = \"=SUM(L\" &amp; lrow &amp; \":L\" &amp; frow &amp; \")\"\n</code></pre>\n\n<p>Edit - Added:</p>\n\n<pre><code>Sub Assign\n  dim dbl_assign as long\n\n  lRow = Cells(Rows.Count, 2).End(xlUp).Row\n  fRow = Cells(lRow, \"B\").Value\n\n  activecell.Formula = \"=SUM(L\" &amp; lrow &amp; \":L\" &amp; frow &amp; \")\"\n\n  dbl_assign = activecell.value\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 1199443, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27372d76e2ce94ae12dd3ecc3b2d9a3f?s=128&d=identicon&r=PG", "display_name": "davidjwest", "link": "https://stackoverflow.com/users/1199443/davidjwest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 39744982, "answer_count": 1, "score": 1, "last_activity_date": 1521478467, "creation_date": 1475058524, "last_edit_date": 1521478467, "question_id": 39744869, "link": "https://stackoverflow.com/questions/39744869/vba-macro-sum-variable-range", "title": "VBA Macro Sum Variable Range", "body": "<p>I need to add up the total for column L, I know the first and last rows:</p>\n\n<pre><code>lRow = Cells(Rows.Count, 2).End(xlUp).Row\nfRow = Cells(lRow, \"B\").Value\n</code></pre>\n\n<p>So how do I use <code>lRow</code> and <code>fRow</code> in my SUM?</p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475058444, "post_id": 39744791, "comment_id": 66786118, "body": "VLOOKUP will do this?"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1475061995, "creation_date": 1475061995, "answer_id": 39746116, "question_id": 39744791, "link": "https://stackoverflow.com/questions/39744791/excel-vba-if-countif-function/39746116#39746116", "title": "Excel / VBA If Countif Function", "body": "<p>Try:</p>\n\n<p><code>=IFERROR(IF(SEARCH(\"search text here\",AufgabenListe!A8),AufgabenListe!B8),\"\")</code></p>\n\n<p>in column C</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6733541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475061995, "creation_date": 1475058288, "question_id": 39744791, "link": "https://stackoverflow.com/questions/39744791/excel-vba-if-countif-function", "title": "Excel / VBA If Countif Function", "body": "<p>I'm trying to automate my Sheets in Excel.</p>\n\n<p>I don't care if the solution works in vba or as a Excel function.</p>\n\n<p>I want following: </p>\n\n<p>If Row A contains specific word, copy neighbour cell in Row B to Cell C ( in another sheet )</p>\n\n<p>What I already have :</p>\n\n<pre><code> Sub Kopieren()\n Dim Zelle As Range\n Dim i%\n  i = 7\n\n\n  For Each Zelle In Sheets(\"AufgabenListe\").Range(\"B8:B12\")\n  If Zelle &lt;&gt; \"\" Then\n  Zelle.Copy\n  Sheets(\"Mikro-RACI\").Cells(i, \"B\").PasteSpecial Paste:=xlPasteValues\n  Application.CutCopyMode = False\n\n End If\n\n\n Next\n End Sub\n</code></pre>\n\n<p>The above only copies it. Wheter Row A has specific text or not. How can i Append a conditions (if Row A contains specific text) ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1475066550, "post_id": 39744208, "comment_id": 66791819, "body": "I am guessing that you are getting the error on the line starting with <code>Set</code>. If that&#39;s the case then the problem resides probably within <code>ws0</code>. From your code it is not clear if <code>ws0</code> is the first worksheet in the Excel file you just opened or if <code>ws0</code> should be the first worksheet in the Excel file with the macro. In other words, is it <code>Set ws0 = ThisWorkbook.Worksheets(1)</code> or should it be <code>Set wbNew = Workbooks.Open ....</code> and then <code>Set ws0 = wbNew.Worksheets(1)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "edited": false, "score": 0, "creation_date": 1475058834, "post_id": 39744511, "comment_id": 66786378, "body": "email0 is a string."}, {"owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "edited": false, "score": 0, "creation_date": 1475058978, "post_id": 39744511, "comment_id": 66786473, "body": "complete code Dim myFileNameDir0 As String Dim ws0 As Worksheet Dim cell0 As Range Dim email0 As String  email0 = ws4.Range(&quot;D&quot; &amp; 2)  myFileNameDir0 = TextBox1.Value Workbooks.Open Filename:=myFileNameDir0, ReadOnly:=True, UpdateLinks:=0 Set ws0 = Worksheets(1) ws0.Activate  Dim cell As Range Set cell = ws0.Range(&quot;AA2:AA1048576&quot;).Find(email0, LookAt:=xlWhole) MsgBox cell.Address"}, {"owner": {"reputation": 1, "user_id": 5910439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0bcf144c93eee31749c6bdd09eb4ce?s=128&d=identicon&r=PG&f=1", "display_name": "John Phillips", "link": "https://stackoverflow.com/users/5910439/john-phillips"}, "reply_to_user": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "edited": false, "score": 1, "creation_date": 1475059884, "post_id": 39744511, "comment_id": 66787114, "body": "To start with;   - ws4 has not been dimmed or set   -&quot;Dim cell As Range&quot; may be throwing out an error, should be &quot;cell0&quot;.   Perhaps this task would be more easily achieved by using a &quot;Match&quot; formula?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "edited": false, "score": 0, "creation_date": 1475065213, "post_id": 39744511, "comment_id": 66790833, "body": "@ZaidShaikh Please don&#39;t post code in comments but rather update your original post if you want to add / change something. To show you what I mean I updated the post for you."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1475065505, "post_id": 39744511, "comment_id": 66791047, "body": "@JohnPhillips Maybe <code>ws4</code> is not a variable but merely the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow noreferrer\">CodeName</a> as shown here: <a href=\"http://www.wiseowl.co.uk/blog/s112/microsoft-excel-vba-worksheet-sheet-name-codename.htm\" rel=\"nofollow noreferrer\">wiseowl.co.uk/blog/s112/&hellip;</a> Yet, you are right and such information should be included in the original post (for clarification)."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0bcf144c93eee31749c6bdd09eb4ce?s=128&d=identicon&r=PG&f=1", "display_name": "John Phillips", "link": "https://stackoverflow.com/users/5910439/john-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1475064304, "last_edit_date": 1475064304, "creation_date": 1475057611, "answer_id": 39744511, "question_id": 39744208, "link": "https://stackoverflow.com/questions/39744208/vba-to-rearch-email-id-in-another-excel-sheet/39744511#39744511", "title": "VBA to rearch email ID in another excel sheet", "body": "<p>Looks like the problem might be in the worksheet identifier.\nWhat happens if you change it to read;</p>\n\n<pre><code>Set cell =  sheets(\"NAME\").Range(\"AA2:AA1048576\").Find(email0, LookAt:=xlWhole)\n</code></pre>\n\n<p>Also, what is email0? Is it a variable or a string?\nWhat have you dimmed email0 to be as, if it is a variable?</p>\n"}], "owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475311553, "creation_date": 1475056881, "last_edit_date": 1531164843, "question_id": 39744208, "link": "https://stackoverflow.com/questions/39744208/vba-to-rearch-email-id-in-another-excel-sheet", "title": "VBA to rearch email ID in another excel sheet", "body": "<p>I have a simple VBA code with search email ID in another excel sheet and provide cell address. I am getting error that </p>\n\n<blockquote>\n  <p>\"Object variable or With block variable not set\".</p>\n</blockquote>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Dim cell As Range\nSet cell = ws0.Range(\"AA2:AA1048576\").Find(email0, LookAt:=xlWhole)\nMsgBox cell.Address\n</code></pre>\n\n<p>Updated code (from a comment below):</p>\n\n<pre><code>Dim myFileNameDir0 As String\nDim ws0 As Worksheet\nDim cell0 As Range\nDim email0 As String\n\nemail0 = ws4.Range(\"D\" &amp; 2)\nmyFileNameDir0 = TextBox1.Value\nWorkbooks.Open Filename:=myFileNameDir0, ReadOnly:=True, UpdateLinks:=0\nSet ws0 = Worksheets(1)\nws0.Activate\n\nDim cell As Range\nSet cell = ws0.Range(\"AA2:AA1048576\").Find(email0, LookAt:=xlWhole)\nMsgBox cell.Address\n</code></pre>\n\n<p>Any help welcome.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2866975, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152709137996017/picture?type=large", "display_name": "Roll_Dice_Get_Data", "link": "https://stackoverflow.com/users/2866975/roll-dice-get-data"}, "edited": false, "score": 0, "creation_date": 1475141598, "post_id": 39749423, "comment_id": 66827714, "body": "Thanks, Robin. This worked well for pages with a single image. Can I ask how you would go about modifying this to grab multiple images?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 15, "user_id": 2866975, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152709137996017/picture?type=large", "display_name": "Roll_Dice_Get_Data", "link": "https://stackoverflow.com/users/2866975/roll-dice-get-data"}, "edited": false, "score": 0, "creation_date": 1475142060, "post_id": 39749423, "comment_id": 66828080, "body": "@user2866975 - see my edit - basically need to set the Global flag to true and then loop through all the matches."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1475142024, "last_edit_date": 1495542287, "creation_date": 1475070446, "answer_id": 39749423, "question_id": 39744077, "link": "https://stackoverflow.com/questions/39744077/excel-vba-extract-image-src-attribute-from-html-as-string/39749423#39749423", "title": "Excel VBA: Extract Image Src attribute from HTML as string", "body": "<p>For the regular expression method you should check out these two links:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/450108/regular-expression-to-extract-src-attribute-from-img-tag\">Regular Expression to extract src attribute from img tag</a></li>\n<li><a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></li>\n</ul>\n\n<p>Which basically boils down to this:</p>\n\n<ul>\n<li>Regular expression to get a <code>src</code> attribute value from <code>img</code> is <code>src\\s*=\\s*\"(.+?)\"</code></li>\n<li>Use the <code>VBScript.RegExp</code> library to use regular expressions in VBA</li>\n</ul>\n\n<p>I've used late binding but you can include the reference if you want.</p>\n\n<p>Then the VBA goes like this:</p>\n\n<p>Option Explicit</p>\n\n<p>Sub Test()</p>\n\n<pre><code>Dim strHtml As String\n\n' sample html, note single img tag\nstrHtml = \"\"\nstrHtml = strHtml &amp; \"&lt;div id=\"\"foo\"\"&gt;\"\nstrHtml = strHtml &amp; \"&lt;bar class=\"\"baz\"\"&gt;\"\nstrHtml = strHtml &amp; \"&lt;img alt=\"\"fred\"\" src=\"\"\\\\server\\path\\picture1.png\"\" /&gt;\"\nstrHtml = strHtml &amp; \"&lt;/bar&gt;\"\nstrHtml = strHtml &amp; \"&lt;bar class=\"\"baz\"\"&gt;\"\nstrHtml = strHtml &amp; \"&lt;img alt=\"\"ned\"\" src=\"\"\\\\server\\path\\picture2.png\"\" /&gt;\"\nstrHtml = strHtml &amp; \"&lt;/bar&gt;\"\nstrHtml = strHtml &amp; \"&lt;bar class=\"\"baz\"\"&gt;\"\nstrHtml = strHtml &amp; \"&lt;img alt=\"\"teddy\"\" src=\"\"\\\\server\\path\\picture3.png\"\" /&gt;\"\nstrHtml = strHtml &amp; \"&lt;/bar&gt;\"\nstrHtml = strHtml &amp; \"&lt;/div&gt;\"\n\nDim strSrc As String\nDim objRegex As Object\nDim objMatches As Object\nDim lngMatchCount As Long, lngCounter As Long\n\n' create regex\nSet objRegex = CreateObject(\"VBScript.RegExp\")\n\n' set pattern and execute\nWith objRegex\n    .IgnoreCase = True\n    .Pattern = \"src\\s*=\\s*\"\"(.+?)\"\"\"\n    .Global = True\n\n    If .Test(strHtml) Then\n        Set objMatches = .Execute(strHtml)\n        lngMatchCount = objMatches.Count\n        For lngCounter = 0 To lngMatchCount - 1\n            strSrc = objMatches(lngCounter).SubMatches(0)\n            ' youve successfully captured the img src value\n            Debug.Print strSrc\n        Next\n    Else\n        strSrc = \"Not found\"\n    End If\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Note that I am getting the first item of the <code>SubMatches</code> collection in order to get the value of the <code>src</code> attribute. The difference between <code>objMatches(0)</code> and <code>objMatches(0).SubMatches(0)</code> in this code is:</p>\n\n<pre><code>src=\"\\\\server\\path\\picture.png\"\n</code></pre>\n\n<p>Versus:</p>\n\n<pre><code>\\\\server\\path\\picture.png\n</code></pre>\n\n<p>You probably want to wrap this up as a function and call it when you get work out the value of <code>IE.document.getElementById(\"NewsDetail\").outerHTML</code> in the <code>If..End If</code> block of your code.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 2866975, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152709137996017/picture?type=large", "display_name": "Roll_Dice_Get_Data", "link": "https://stackoverflow.com/users/2866975/roll-dice-get-data"}, "edited": false, "score": 0, "creation_date": 1475141513, "post_id": 39756269, "comment_id": 66827666, "body": "I only require images from a specific section of each page and require the images to be labelled in such a way that they can be matched up to specific page and placement in the text. I am also on Windows with no access to a *nix box."}], "tags": [], "owner": {"reputation": 113, "user_id": 3310902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a524735a8ffc1c625b16b291b682e6?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasDoe", "link": "https://stackoverflow.com/users/3310902/thomasdoe"}, "is_accepted": false, "score": 1, "last_activity_date": 1475091539, "last_edit_date": 1495541231, "creation_date": 1475091539, "answer_id": 39756269, "question_id": 39744077, "link": "https://stackoverflow.com/questions/39744077/excel-vba-extract-image-src-attribute-from-html-as-string/39756269#39756269", "title": "Excel VBA: Extract Image Src attribute from HTML as string", "body": "<p>Using VBA seems very complicated when you can do this easily with Wget: <a href=\"https://stackoverflow.com/questions/4602153/how-do-i-use-wget-to-download-all-images-into-a-single-folder\">How do I use Wget to download all Images into a single Folder</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 2866975, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152709137996017/picture?type=large", "display_name": "Roll_Dice_Get_Data", "link": "https://stackoverflow.com/users/2866975/roll-dice-get-data"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3616, "favorite_count": 1, "accepted_answer_id": 39749423, "answer_count": 2, "score": 0, "last_activity_date": 1594203572, "creation_date": 1475056575, "last_edit_date": 1594203572, "question_id": 39744077, "link": "https://stackoverflow.com/questions/39744077/excel-vba-extract-image-src-attribute-from-html-as-string", "title": "Excel VBA: Extract Image Src attribute from HTML as string", "body": "<p>I am trying to scrape my employers website to extract images from their Blog post en mass. I have started creating a scraping tool in Excel using VBA.</p>\n\n<p>(We don't have access to the SQL database)</p>\n\n<p>I have setup a work sheet that contains a list of post identifiers in column A and the URL of the post in column B.</p>\n\n<p>My VBA script so far runs through the list of URL's in column B extracts the HTML from a Tag on the page by ID, using getElementById and pastes the resulting output as a string into column C.</p>\n\n<p>I am now at the point where I am trying to figure out how to extract the src attribute from every image in the resulting output and paste it into the relevant columns. I can't for the life of me come up with an easy solution. I am not very familiar with RegEx and am struggling with Excel's built in string functions.</p>\n\n<p>The end game is to get the macro to run through each image URL and save the image to disk with a filename format like \"{Event No.}-{Image Number}\".jpg</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p><a href=\"http://i.stack.imgur.com/ITKRM.jpg\" rel=\"nofollow\">Worksheet setup</a></p>\n\n<pre><code>Sub Get_Image_SRC()\n\nDim sht As Worksheet\nDim LastRow As Long\nDim i As Integer\nDim url As String\nDim IE As Object\nDim objElement As Object\nDim objCollection As Object\nDim Elements As IHTMLElementCollection\nDim Element As IHTMLElement\n\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\n'Ctrl + Shift + End\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nFor i = 2 To LastRow\n    url = Cells(i, \"C\").Value\n    MsgBox (url)\n    IE.navigate url\n    Application.StatusBar = url &amp; \" is loading...\"\n    Do While IE.readyState = 4: DoEvents: Loop\n    Do Until IE.readyState = 4: DoEvents: Loop\n    Application.StatusBar = url &amp; \" Loaded\"\n    If Cells(i, \"B\").Value = \"WEBNEWS\" Then\n        Cells(i, \"D\").Value = IE.document.getElementById(\"NewsDetail\").outerHTML\n       Else\n        Cells(i, \"D\").Value = IE.document.getElementById(\"ReviewContainer\").outerHTML\n    End If\n\n\n\nNext i\n\nSet IE = Nothing\nSet objElement = Nothing\nSet objCollection = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Example resulting HTML:</p>\n\n<pre><code>&lt;div id=\"\"NewsDetail\"\"&gt;&lt;div class=\"\"NewsDetailTitle\"\"&gt;Video: Race Face Behind the Scenes Tour&lt;/div&gt;&lt;div class=\"\"NewsDetailImage\"\"&gt;&lt;img alt=\"\"HeadlinesThumbnail.jpg\"\" src=\"\"/ImageHandler/6190/515/1000/0/\"\"&gt;&lt;/div&gt;    &lt;div class=\"\"NewsDetailBody\"\"&gt;Pinkbike posted this video a while ago, if you missed it, its' definitely worth a watch. \n\nKen from Camp of Champions took a look at their New Westminster factory last year which gives a look at the production, people and culture of Race Face. The staff at Race Face are truly their greatest asset they had, best wishes to everyone!\n\n&lt;p&gt;&lt;center&gt;&lt;object width=\"\"500\"\" height=\"\"281\"\"&gt;&lt;param name=\"\"allowFullScreen\"\" value=\"\"true\"\"&gt;&lt;param name=\"\"AllowScriptAccess\"\" value=\"\"always\"\"&gt;&lt;param name=\"\"movie\"\" value=\"\"http://www.pinkbike.com/v/188244\"\"&gt;&lt;embed width=\"\"500\"\" height=\"\"281\"\" src=\"\"http://www.pinkbike.com/v/188244\"\" type=\"\"application/x-shockwave-flash\"\" allowscriptaccess=\"\"always\"\" allowfullscreen=\"\"true\"\"&gt;&lt;/object&gt;&lt;/center&gt;&lt;p&gt;&lt;/p&gt;\n\n\n&lt;/div&gt;&lt;div class=\"\"NewsDate\"\"&gt;Published Friday, 25 November 2011&lt;/div&gt;&lt;/div&gt;\"\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/ERGqS.jpg\" rel=\"nofollow\">My current references</a></p>\n"}, {"tags": ["vba", "excel", "ms-word", "bookmarks"], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1475066672, "post_id": 39745114, "comment_id": 66791928, "body": "This was super insightful, thank you!!! It really just came down to deleting the bookmarks after I&#39;d copied everything. This was the first time I had to work with bookmarks, so that info really saved me lots of work. You&#39;re the boss @Maarten van Stam"}], "tags": [], "owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "is_accepted": true, "score": 1, "last_activity_date": 1475059198, "creation_date": 1475059198, "answer_id": 39745114, "question_id": 39743270, "link": "https://stackoverflow.com/questions/39743270/copy-and-paste-including-bookmarks-vba/39745114#39745114", "title": "Copy and paste INCLUDING bookmarks VBA", "body": "<p>First try, instead of Copy/Paste, using WordOpenXml. This is much more reliable than copy/paste. Now remember that a Bookmark is a named location, when you copy a section of the document and put it back on another location when the original bookmark is still in place, the new section won't get the copied Bookmark.</p>\n\n<p>I'll provide a little bit of code to show this to you:</p>\n\n<pre><code>Sub Test()\n\n   ActiveDocument.Bookmarks.Add Name:=\"BM1\", Range:=ActiveDocument.Paragraphs(1).Range\n\n   ActiveDocument.Application.Selection.WholeStory\n\n   Dim openxml As String\n   openxml = ActiveDocument.Application.Selection.wordopenxml\n\n   ActiveDocument.Bookmarks(1).Delete\n\n   With ActiveDocument\n      .Application.Selection.EndKey Unit:=wdStory\n      .Application.Selection.InsertBreak Type:=wdPageBreak\n      .Application.Selection.InsertXML xml:=openxml\n   End With\n\n'      ActiveDocument.Bookmarks(1).Delete\n\n   With ActiveDocument\n      .Application.Selection.EndKey Unit:=wdStory\n      .Application.Selection.InsertBreak Type:=wdPageBreak\n      .Application.Selection.InsertXML xml:=openxml\n   End With\nEnd Sub\n</code></pre>\n\n<p>Now open a new document enter some text by entering <code>=Rand()</code> as text in the document and hit enter\nNext run the code from the Test macro.</p>\n\n<p>You'll see that because you delete the bookmark using <code>ActiveDocument.Bookmarks(1).Delete</code> from the original part the first inserted text now contains the bookmark, the second does not.</p>\n\n<p>If you uncomment the <code>' ActiveDocument.Bookmarks(1).Delete</code> line you will see that the bookmark ends up in the second added text part because there is no duplicate bookmark anymore when creating the second section.</p>\n\n<p>So in short, copying a bookmark will not duplicate the bookmark when pasting it, so you need to make sure you either delete the original bookmark or rename the bookmarks to make them unique again. Duplicates is a no go.</p>\n"}], "owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1351, "favorite_count": 0, "accepted_answer_id": 39745114, "answer_count": 1, "score": 0, "last_activity_date": 1475059198, "creation_date": 1475054797, "last_edit_date": 1475058720, "question_id": 39743270, "link": "https://stackoverflow.com/questions/39743270/copy-and-paste-including-bookmarks-vba", "title": "Copy and paste INCLUDING bookmarks VBA", "body": "<p>I have an Excel worksheet from which I am trying to paste Information into a wordfile \"Template\" (just a word-document in the layout I want), which contains bookmarks. What I would like to do is:</p>\n\n<ol>\n<li>Copy everything in the word document (including bookmarks)</li>\n<li>Replace the bookmarks with the data in my sheet</li>\n<li>Go to the bottom of the page, insert a page break and paste the copied Text, including bookmarks</li>\n<li>Loop through points 2 &amp; 3 for all the rows in my excel file</li>\n</ol>\n\n<p>I have patched together some code, but I'm unable to get the bookmark to paste the text with the bookmarks still intact. Can any of you help me get there?</p>\n\n<pre><code>Sub ReplaceBookmarks\n\n'Select template\nPickFolder = \"C:\\Users\\Folder\"   \nSet fdn = Application.FileDialog(msoFileDialogFilePicker)\nWith fdn\n    .AllowMultiSelect = False\n    .Title = \"Please select the file containing the Template\"\n    .Filters.Clear\n    .InitialFileName = PickFolder\n    If .Show = True Then\n    Temp = fdn.SelectedItems(1)\n    End If\nEnd With\n\n'open the word document\nSet wdApp = CreateObject(\"Word.Application\")\nSet wdDoc = wdApp.Documents.Open(Temp)\n'show the word document - put outside of loop for speed later\nwdApp.Visible = True\n\n'Copy everything in word document    \n    wdDoc.Application.Selection.Wholestory\n    wdDoc.Application.Selection.Copy\n\nLastRow2 = 110    ' In real code this is counted on the sheet\nFor i = 2 To LastRow2      \n'Data that will replace bookmarks in ws2 (defined somewhere in real code)\n    Rf1 = ws2.Cells(i, 4).Value\n    Rf2 = ws2.Cells(i, 2).Value\n    Rf3 = ws2.Cells(i, 3).Value\n\n'replace the bookmarks with the variables - references sub \"Fillbookmark\"\nFillBookmark wdDoc, Rf1, \"Rf1\"\nFillBookmark wdDoc, Rf2, \"Rf2\"\nFillBookmark wdDoc, Rf3, \"Rf3\"\n\n' Jump to bottom of document, add page break and paste\nWith wdDoc\n.Application.Selection.EndKey Unit:=wdStory\n.Application.Selection.InsertBreak Type:=wdPageBreak\n.Application.Selection.PasteAndFormat (wdFormatOriginalFormatting)\nEnd With\nNext i\nEnd Sub\n\nSub FillBookmark(ByRef wdDoc As Object, _\nByVal vValue As Variant, _\nByVal sBmName As String, _\nOptional sFormat As String)\n\nDim wdRng As Object\n\n'store the bookmarks range\nSet wdRng = wdDoc.Bookmarks(sBmName).Range\n'if the optional format wasn\u2019t supplied\nIf Len(sFormat) = 0 Then\n'replace the bookmark text\n   wdRng.Text = vValue\nElse\n'replace the bookmark text with formatted text\n   wdRng.Text = Format(vValue, sFormat)\nEnd If \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1475056271, "post_id": 39743645, "comment_id": 66784434, "body": "That&#39;s still not doing it. Currently in my excel file I have data in rows 2:13 and I inputted some dummy data in cells in A21 and A33 to make sure the macro will catch any time there is a blank row. Currently, the macro will run the SQL queries and output them bu the dummy data remains."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1475064601, "post_id": 39743645, "comment_id": 66790383, "body": "Even commenting out everything bar                                   Sheets(&quot;Complaints Report&quot;).Activate     &#39;Clear out old detail      Sheets(&quot;Complaints Report&quot;).Range(&quot;A2:Z10000&quot;).Clear                           does nothing"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 1, "creation_date": 1475066327, "post_id": 39743645, "comment_id": 66791655, "body": "Just spotted another issue when trying to mimic your set-up: the parentheses in the VBScript should be left out. See my updated answer."}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 1, "last_activity_date": 1475066296, "last_edit_date": 1475066296, "creation_date": 1475055661, "answer_id": 39743645, "question_id": 39742599, "link": "https://stackoverflow.com/questions/39742599/how-to-delete-excel-cells-when-running-a-macro-from-vbs-script/39743645#39743645", "title": "How to delete Excel cells when running a macro from VBs Script", "body": "<p>Two things:</p>\n\n<ol>\n<li><p>The <code>Run</code> method needs the name of the <code>Sub</code> to run, so there should not be parentheses:</p>\n\n<p>Change:</p>\n\n<pre><code>xlApp.Run \"Complaints_Report.Complaints_Report()\"\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>xlApp.Run \"Complaints_Report.Complaints_Report\"\n</code></pre></li>\n<li><p>Make sure to specify the sheet explicitly when using <code>Range</code>, as the activation of the sheet may not be reliable</p>\n\n<p>Change:</p>\n\n<pre><code>Range(\"A2:Z10000\").Clear\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Sheets(\"Complaints Report\").Range(\"A2:Z10000\").Clear\n</code></pre></li>\n</ol>\n\n<p>You may then even remove the statement to activate the sheet, as the code will do its job without that.</p>\n"}], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "accepted_answer_id": 39743645, "answer_count": 1, "score": 0, "last_activity_date": 1475066296, "creation_date": 1475053125, "last_edit_date": 1475055732, "question_id": 39742599, "link": "https://stackoverflow.com/questions/39742599/how-to-delete-excel-cells-when-running-a-macro-from-vbs-script", "title": "How to delete Excel cells when running a macro from VBs Script", "body": "<p>I have a VBS script which runs a VBA macro in Excel. The macro works when I manually run it in the Excel file, but when called from the VBS it won't delete out the existing data before running the queries.</p>\n\n<p>Here is my VBS script dealing with Excel:</p>\n\n<pre><code>Dim xlApp, xlBook\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.DisplayAlerts = False\nSet xlBook = xlApp.Workbooks.Open(\"Y:\\Public\\Eoin\\Complaints Report\\Complaints Report.xlsm\", False)\n\nmsgbox(\"3\")\n\nxlApp.Run \"Complaints_Report.Complaints_Report()\"\n\nWScript.Sleep 100000\nxlbook.Save\nxlBook.Close False\nset xlBook = Nothing\n\nxlApp.Quit\nSet xlApp = Nothing\n</code></pre>\n\n<p>Here is my Excel VBA macro stored in a module:</p>\n\n<pre><code>Sub Complaints_Report()\n    Sheets(\"Complaints Report\").Activate\n    'Clear out old detail\n    Range(\"A2:Z10000\").Clear\n\n    'Declare variables'\n    Set objMyConn = New ADODB.Connection\n    Set objMyRecordset = New ADODB.Recordset\n    Dim strSQL As String\n\n    'Open Connection'\n    objMyConn.ConnectionString = \"Driver={Microsoft ODBC for Oracle}; \" &amp; _\n            \"CONNECTSTRING=(DESCRIPTION=\" &amp; _\n            \"(ADDRESS=(PROTOCOL=***)\" &amp; _\n            \"(HOST=*****)(PORT=****))\" &amp; _\n            \"(CONNECT_DATA=(SERVICE_NAME =*****))); uid=******; pwd=*****;\"\n    objMyConn.Open\n\n    'Set and Excecute SQL Command'\n    strSQL = \"Select distinct * From Temp_Final_Complaints_Report\"\n\n    'Open Recordset'\n    Set objMyRecordset.ActiveConnection = objMyConn\n    objMyRecordset.Open strSQL\n\n    'Copy Data to Excel'\n    Sheets(\"Complaints Report\").Range(\"A2\").CopyFromRecordset (objMyRecordset)\nEnd Sub\n</code></pre>\n\n<p>The macro returns the results but does not delete out everything in the sheet beforehand.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1475054363, "post_id": 39742491, "comment_id": 66783048, "body": "See <a href=\"http://stackoverflow.com/questions/1439200/vba-shell-and-wait-with-exit-code\" title=\"vba shell and wait with exit code\">stackoverflow.com/questions/1439200/&hellip;</a> or <a href=\"http://stackoverflow.com/questions/8902022/wait-for-shell-to-finish-then-format-cells\" title=\"wait for shell to finish then format cells\">stackoverflow.com/questions/8902022/&hellip;</a>"}], "owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1594641335, "creation_date": 1475052779, "last_edit_date": 1594641335, "question_id": 39742491, "link": "https://stackoverflow.com/questions/39742491/close-every-step-in-vba-before-go-to-the-other-step", "title": "close every step in VBA before go to the other step", "body": "<p>I wrote a VBA-code which uses a <code>batch</code> to copy some files from <strong>A</strong> to <strong>B</strong> and then run Access-macros  which use the copied files in <strong>B</strong>. After running the macros the VBA-code  the queries results from Access into the excel.</p>\n\n<pre><code>' run the batch\n    RetVal = Shell(\"I:\\myW\\k1ltios1_k1ltit31_Kopie.bat\", 1)\n\n' ============================\n' run the macros in ACCESS\n\nDim accessApp\nSet accessApp = CreateObject(\"Access.Application\")  'define an Access object\n\naccessApp.Visible = True 'hold Access object open\n\naccessApp.UserControl = True\n.\n.\n.\n' &lt;&lt;&lt; copy the results from Access into th eExcel files &gt;&gt;&gt;\n'#Enter  the valus of cells in the arrays\ni = 0\nReDim marrSql(0)\n For Each cell In Worksheets(\"eingaben\").Range(\"B20:B21\")\n    marrSql(i) = cell\n    i = i + 1\n    ReDim Preserve marrSql(i)\n    Debug.Print marrSql(i)\nNext\n\n\ni = 0\nReDim marrPlace(0)\n For Each cell In Worksheets(\"eingaben\").Range(\"A20:A21\")\n    marrPlace(i) = cell\n    i = i + 1\n    ReDim Preserve marrPlace(i)\nNext\n'# end of entering\n\nFor i = 0 To 1\n'\nsSQL = \"SELECT * FROM [\" &amp; marrSql(i) &amp; \"];\"\n\nDim cnn As ADODB.Connection\nDim rst As ADODB.Recordset\nDim cmdCommand As ADODB.Command\n.\n.\n.\n\nNext\n</code></pre>\n\n<p>If I run the code it works well but all windows (batch, Access and Excel) open immediately together! \n<strong>Now my question</strong>: How is it possible to start the <em>batch</em> and if there is no error it should be closed then run the macros in <em>Access</em> and generate the queries if there is no problem copy the results into Excel and then close the Access? I want to be sure that the steps are done one after each other because otherwise the code would peek up the old results in one or another step!</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475052671, "post_id": 39742340, "comment_id": 66781854, "body": "Hi. There is no column for date. I need to do in macro VB"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475052776, "post_id": 39742340, "comment_id": 66781932, "body": "Where are the different dates stored then? Are you simply using today&#39;s date?"}, {"owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 0, "creation_date": 1475053155, "post_id": 39742340, "comment_id": 66782192, "body": "Ya I am using today&#39;s date"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "edited": false, "score": 1, "creation_date": 1475053618, "post_id": 39742340, "comment_id": 66782502, "body": "If you need to do it in a macro, what have you tried so far? - this isn&#39;t a free code writing service so you&#39;ll need to supply evidence of your own attempts first."}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 2, "last_activity_date": 1475052403, "creation_date": 1475052403, "answer_id": 39742340, "question_id": 39742149, "link": "https://stackoverflow.com/questions/39742149/number-to-be-incremented-and-then-reset-with-each-date/39742340#39742340", "title": "Number to be incremented and then reset with each date", "body": "<p>You can do this using a formula. If you have your dates in column A and put this formula in column B to create the serial numbers:</p>\n\n<pre><code>=TEXT(A1,\"DDMM\")&amp;TEXT(COUNTIF($A$1:A1,A1),\"0#\")\n</code></pre>\n\n<p>You will get the following:</p>\n\n<pre><code>28/09/2016  280901\n28/09/2016  280902\n28/09/2016  280903\n28/09/2016  280904\n29/09/2016  290901\n29/09/2016  290902\n29/09/2016  290903\n29/09/2016  290904\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1475054142, "creation_date": 1475054142, "answer_id": 39742990, "question_id": 39742149, "link": "https://stackoverflow.com/questions/39742149/number-to-be-incremented-and-then-reset-with-each-date/39742990#39742990", "title": "Number to be incremented and then reset with each date", "body": "<p>This isn't a free code writing service but to get you started you could try something like the following.</p>\n\n<pre><code>Dim iVal As Integer, tdate As String, serial as String\n'sets todays date as string\ntdate = Date\n\n'counts how many serials there are for today and adds 1\niVal = Application.WorksheetFunction.CountIf(Range(\"A:A\"), \"*\" &amp; tdate &amp; \"*\") + 1\n\n'creates new serial\nserial = Date &amp; \" 000\" &amp; iVal\n\n'just for this example it will put the new serial in column A\nRange(\"A\" &amp; iVal).Value = serial\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5538704, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ff69708079e3e51051085496cd65fdb8?s=128&d=identicon&r=PG&f=1", "display_name": "user5538704", "link": "https://stackoverflow.com/users/5538704/user5538704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475054142, "creation_date": 1475051867, "question_id": 39742149, "link": "https://stackoverflow.com/questions/39742149/number-to-be-incremented-and-then-reset-with-each-date", "title": "Number to be incremented and then reset with each date", "body": "<p>I have searched a lot on net and this forum. I found similar questions but it didn't answer my question.\nWhat I need to do is that I need to generate a number which contains date,month,and then a serial number which needs to be reset with each new date.\nFor eg 280901 (28-date 09-month 01- serial number), 280902, 280903...\nand then 290901 for the next date\nI am new to VB. \nPlease help!!</p>\n"}, {"tags": ["c#", ".net", "excel", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 1, "creation_date": 1475052528, "post_id": 39741768, "comment_id": 66781760, "body": "Without any code neither do we. Please post some more info if you seek any advice."}, {"owner": {"reputation": 2299, "user_id": 665550, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bf1b12d9535289a6ced83d634e4140bc?s=128&d=identicon&r=PG", "display_name": "Alezis", "link": "https://stackoverflow.com/users/665550/alezis"}, "reply_to_user": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1475053078, "post_id": 39741768, "comment_id": 66782139, "body": "@Pav you are right. I added code, but, probably, not enough. This is legacy project that is used Aspose an interop at the same time. Now I will try to create POC on VBA to research this case."}, {"owner": {"reputation": 2299, "user_id": 665550, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bf1b12d9535289a6ced83d634e4140bc?s=128&d=identicon&r=PG", "display_name": "Alezis", "link": "https://stackoverflow.com/users/665550/alezis"}, "reply_to_user": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 0, "creation_date": 1476265768, "post_id": 39741768, "comment_id": 67268847, "body": "My POC on VBA didn&#39;t show me issue. At the momment we found workaround, but this code must be refactored. If I had any results would share here."}, {"owner": {"reputation": 1132, "user_id": 3188762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51dc5ca2d1d2b1b1e2804aa70304aa4?s=128&d=identicon&r=PG", "display_name": "Taraz", "link": "https://stackoverflow.com/users/3188762/taraz"}, "edited": false, "score": 0, "creation_date": 1512249670, "post_id": 39741768, "comment_id": 82183689, "body": "If it&#39;s like Word VBA, you may need to set the document &quot;saved&quot; status to false, then save. Also, maybe check if there&#39;s an &quot;update&quot; option and use that if the custom property already exists. You may not be able to &quot;add&quot; the property if it&#39;s already there (at least, you can&#39;t in VBA for Word custom properties)."}], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1475204947, "creation_date": 1475204947, "answer_id": 39783044, "question_id": 39741768, "link": "https://stackoverflow.com/questions/39741768/saving-customproperty-in-excel-worksheet/39783044#39783044", "title": "Saving CustomProperty in Excel Worksheet", "body": "<p>Maybe I've oversimplified your task, but I set custom properties (for example, attributes when the file is saved to a Sharepoint document library) as follows:</p>\n\n<pre><code>Excel.Workbook wb;\n\nwb.ContentTypeProperties[\"Region\"].Value = \"Northeast\";\n</code></pre>\n\n<p>It's possible these are different properties than the ones you are talking about...  this will change the properties, for example, when you click on the \"File\" tab and see the \"Properties\" list in the right-most panel.</p>\n"}], "owner": {"reputation": 2299, "user_id": 665550, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bf1b12d9535289a6ced83d634e4140bc?s=128&d=identicon&r=PG", "display_name": "Alezis", "link": "https://stackoverflow.com/users/665550/alezis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1148, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1475204947, "creation_date": 1475050708, "last_edit_date": 1531161705, "question_id": 39741768, "link": "https://stackoverflow.com/questions/39741768/saving-customproperty-in-excel-worksheet", "title": "Saving CustomProperty in Excel Worksheet", "body": "<p>We have Excel add-in in C#. To support some features we are using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197822.aspx\" rel=\"nofollow\">Worksheet.CustomProperties</a>. We found that after adding some custom property we are changing its value. For example we set \"1\" via <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194005.aspx\" rel=\"nofollow\">Add</a> method. At some point we change the same value to \"2\". Then we save workbook and open it again. For some reason we see \"1\" instead of \"2\". Why ? It looks I missed something, but don't know what.\nUpdated:</p>\n\n<pre><code>    public class CustomPropertyUtil\n{\n    protected readonly Worksheet Sheet;\n\n    public WorkSheetCustomPropertyUtil(Worksheet sheet)\n    {\n        this.Sheet = sheet;\n    }\n\n    protected bool Exists(string propertyName)\n    {\n        try\n        {\n            return Sheet.CustomProperties.Cast&lt;CustomProperty&gt;().Any(c =&gt; c.Name == propertyName);\n        }\n        catch (System.Runtime.InteropServices.COMException)\n        {\n            return false;\n        }\n    }\n\n    protected object GetValue(string propertyName)\n    {\n        CustomProperty property = GetProperty(propertyName);\n        return property != null ? property.Value : null;\n    }\n\n    protected void SetValue(string propertyName, object value)\n    {\n        CustomProperty customProperty = GetProperty(propertyName);\n\n        if (customProperty == null)\n        {\n            AddCustomProperty(propertyName, value);\n        }\n        else\n        {\n            customProperty.Value = value;\n        }\n\n    }\n\n    private void AddCustomProperty(string propertyName, object value)\n    {\n        Sheet.CustomProperties.Add(propertyName, value);\n    }\n\n    protected CustomProperty GetProperty(string propertyName)\n    {\n        return Exists(propertyName)\n            ? Sheet.CustomProperties.Cast&lt;CustomProperty&gt;().FirstOrDefault(c =&gt; c.Name == propertyName)\n            : null;\n    }\n}\n</code></pre>\n\n<p>This is how we manage custom properties. When we save we do following:</p>\n\n<pre><code>Workbook.SaveAs(filePath, AccessMode: XlSaveAsAccessMode.xlNoChange);\n</code></pre>\n\n<p>When I open it in VBA I see that my CustomProperties were not saved. </p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475049248, "post_id": 39741101, "comment_id": 66779692, "body": "You look to be switching to sheet 2, so the 2nd time the loop is run, Range(Cells.... will refer to and copy from sheet 2 not wsht1.   Where is the error?"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475049323, "post_id": 39741101, "comment_id": 66779757, "body": "the error occurs when i try to run the code!  Run time error - 1004 Application-defined or object defined error"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475049506, "post_id": 39741101, "comment_id": 66779863, "body": "@Prabhu what is this line <code>Range(Cells(i, 2), Cells(i, 2)).Copy</code> ? are you trying to copy a range of a single cell ?"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475049641, "post_id": 39741101, "comment_id": 66779946, "body": "@ShaiRado I want to copy that single cell (within that range) and paste it to the another sheet cell."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475049821, "post_id": 39741101, "comment_id": 66780047, "body": "@Prabhu but in your code you are just copying the formats, do you want also to copy the values ?"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475049971, "post_id": 39741101, "comment_id": 66780134, "body": "@ShaiRado ?Yes i want to copy the values from the next column cell"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475050118, "post_id": 39741101, "comment_id": 66780219, "body": "@Prabhu let me know if the code in my answer below works for you"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1475050143, "post_id": 39741101, "comment_id": 66780232, "body": "In what line does the error happen"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475050182, "post_id": 39741424, "comment_id": 66780257, "body": "I changed the code, but when i put a break, i can see the cellis copied but not pasted correctly to the destination  wsht2.Cells(i, 1).PasteSpecial Paste:=xlPasteFormats"}], "tags": [], "owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "is_accepted": false, "score": 1, "last_activity_date": 1475050183, "last_edit_date": 1475050183, "creation_date": 1475049625, "answer_id": 39741424, "question_id": 39741101, "link": "https://stackoverflow.com/questions/39741101/copy-data-with-in-sheets/39741424#39741424", "title": "Copy data with in sheets", "body": "<p>You cannot define a range like that:</p>\n\n<pre><code>wsht2.Range(Cells(1, i))\n</code></pre>\n\n<p>you might use: </p>\n\n<pre><code>wsht2.Cells(1, i).PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n\n<p>BTW: with this code you won't find empty cells:</p>\n\n<pre><code>If wsht1.Cells(i, 1).Value &lt;&gt; \" \" Then\n</code></pre>\n\n<p>you should use:</p>\n\n<pre><code>If wsht1.Cells(i, 1).Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>(the difference is a missing space between the quotes)</p>\n\n<p>if you want to copy the values only and to make it with a loop I'd do the following:</p>\n\n<pre><code>Sub copying()\n\n    Set wsht1 = ThisWorkbook.Worksheets(\"Sheet1\")\n     Set wsht2 = Sheets(\"Sheet2\")\n     finalrow = wsht1.Cells(wsht1.Rows.Count, 1).End(xlUp).Row\n\n For i = 1 To finalrow\n    If wsht1.Cells(i, 1).Value &lt;&gt; \"\" Then\n        For j = 1 To 5\n            wsht2.Cells(i, j).Value = wsht1.Cells(i, j).Value\n        Next j\n    End If\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475050501, "post_id": 39741541, "comment_id": 66780457, "body": "Hi, Thanks for the code. When I run the code, and indeed i get he values, but coming with blanks still :("}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475050682, "post_id": 39741541, "comment_id": 66780558, "body": "@Prabhu perhaps you also have spaces inside cells, try edited code"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1475050825, "post_id": 39741541, "comment_id": 66780642, "body": "This code will always create blanks in <code>wsht2</code> because you are using <code>i</code> to say where to paste the data, you need a separate counter for sheet two like <code>j = 1, wsht2.Range(&quot;A&quot; &amp; j).PasteSpecial, j = j + 1</code>"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475051077, "post_id": 39741541, "comment_id": 66780778, "body": "@ShaiRado I had included the screenshot of the output as an image where in i still get the blank cell"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1475051108, "post_id": 39741541, "comment_id": 66780799, "body": "Try my answer below."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475051390, "post_id": 39741541, "comment_id": 66780974, "body": "@Prabhu forgot to add Paste counter for Non-blank cells, try now"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475051666, "post_id": 39741541, "comment_id": 66781170, "body": "@ShaiRado Still have blank :("}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1475051953, "post_id": 39741541, "comment_id": 66781371, "body": "do you have values in column A with space inside ? 2 spaces ? what values are copied ?"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475052103, "post_id": 39741541, "comment_id": 66781482, "body": "@ShaiRado No there is no space, The copied values are with the blank entries as well"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475052465, "post_id": 39741541, "comment_id": 66781714, "body": "@Prabhu sre you sure you coped the last code here ? with J counter ? Please copy the code again, and I test it. I just tested again on my PC and it&#39;s working without copying blanks"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475052758, "post_id": 39741541, "comment_id": 66781921, "body": "@ShaiRado Hi, Yes it is working.  Thanks a lot for your valuable timing"}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475053743, "post_id": 39741541, "comment_id": 66782590, "body": "Thanks all for solving this issue."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1475054248, "post_id": 39741541, "comment_id": 66782959, "body": "This says it will only copy values but the code also copies the formats, be careful as it&#39;s a bit misleading."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1475052473, "last_edit_date": 1475052473, "creation_date": 1475050033, "answer_id": 39741541, "question_id": 39741101, "link": "https://stackoverflow.com/questions/39741101/copy-data-with-in-sheets/39741541#39741541", "title": "Copy data with in sheets", "body": "<p>The code below will copy only values in Column A (non-empty cells) from Sheet 1 to Sheet2:</p>\n\n<pre><code>Dim j                           As Long\n\nSet wsht1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet wsht2 = Sheets(\"Sheet2\")\nfinalrow = wsht1.Cells(wsht1.Rows.Count, 1).End(xlUp).Row\n\nj = 1\nFor i = 1 To finalrow\n    With wsht1\n        ' if you compare to empty string, you need to remove the space inside the quotes\n        If .Cells(i, 1).Value &lt;&gt; \"\" And .Cells(i, 1).Value &lt;&gt; \" \" Then\n            .Cells(i, 1).Copy ' since you are copying a single cell, there's no need to use a Range\n            wsht2.Range(\"A\" &amp; j).PasteSpecial Paste:=xlPasteValues, Paste:=xlPasteFormats\n            j = j + 1\n        End If\n    End With\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475051936, "post_id": 39741917, "comment_id": 66781364, "body": "can i make the j value dynamic?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475051997, "post_id": 39741917, "comment_id": 66781399, "body": "Do you mean if each row in Sheet 1 has different amounts of data per row?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475052501, "post_id": 39741917, "comment_id": 66781737, "body": "I edited the answer to count the columns used in each row."}, {"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475053733, "post_id": 39741917, "comment_id": 66782582, "body": "Great, working fine and thanks a lot for sharing your thoughts."}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 1, "last_activity_date": 1475052276, "last_edit_date": 1475052276, "creation_date": 1475051137, "answer_id": 39741917, "question_id": 39741101, "link": "https://stackoverflow.com/questions/39741101/copy-data-with-in-sheets/39741917#39741917", "title": "Copy data with in sheets", "body": "<p>If you only have 5 cells with data in Sheet 1 and only want those 5 rows copying to Sheet 2 use the following, similar to Shai's answer above with an extra counter for the rows in Sheet 2.</p>\n\n<pre><code>Sub copying()\n\nSet wsht1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet wsht2 = Sheets(\"Sheet2\")\nfinalrow = wsht1.Cells(wsht1.Rows.Count, 1).End(xlUp).Row\nk = 1\n\nFor i = 1 To finalrow\n    If wsht1.Cells(i, 1).Value &lt;&gt; \"\" Then\n        For j = 1 To 5\n            wsht2.Cells(k, j).Value = wsht1.Cells(i, j).Value\n        Next j\n        k = k + 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>EDIT</p>\n\n<p>As per your comment if you want to dynamically change <code>j</code> replace <code>For j = 1 To 5</code> with</p>\n\n<pre><code>For j = 1 To wsht1.Cells(i, Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1475052473, "creation_date": 1475048699, "last_edit_date": 1475050988, "question_id": 39741101, "link": "https://stackoverflow.com/questions/39741101/copy-data-with-in-sheets", "title": "Copy data with in sheets", "body": "<p><a href=\"http://i.stack.imgur.com/TPzmu.png\" rel=\"nofollow\">enter image description here</a>There are 2 sheets, Sheet1 and Sheet2. \nSheet1 contain 10 columns and 5 rows with data including blank.</p>\n\n<p>The requirement is to copy the data from Sheet 1 and to put in another sheet Sheet 2, wherein only populate the cell which is not blank.</p>\n\n<p>I get the run time error 1004 - Application or object defined error.</p>\n\n<p>The code snippet is:-</p>\n\n<pre><code> Set wsht1 = ThisWorkbook.Worksheets(\"Sheet1\")\n Set wsht2 = Sheets(\"Sheet2\")\n finalrow = wsht1.Cells(wsht1.Rows.Count, 1).End(xlUp).Row\n\n For i = 1 To finalrow\n If wsht1.Cells(i, 1).Value &lt;&gt; \" \" Then\n    Range(Cells(i, 2), Cells(i, 2)).Copy \n        Worksheets(\"Sheet2\").Select\n        wsht2.Range(Cells(1, i)).PasteSpecial Paste:=xlPasteFormats\n\n    End If\nNext i\n</code></pre>\n\n<p>Can u help me in sorting this out?</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1475054496, "post_id": 39739535, "comment_id": 66783143, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31653347/how-to-filter-outlook-mail-items-received-by-today-from-other-mail-items-in-exce\">How to filter Outlook mail items received by today from other mail items in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1475064096, "last_edit_date": 1475064096, "creation_date": 1475062898, "answer_id": 39746443, "question_id": 39739535, "link": "https://stackoverflow.com/questions/39739535/how-to-iterate-through-only-mails-of-a-specific-date-and-not-the-entire-folder-i/39746443#39746443", "title": "How to iterate through only mails of a specific date and not the entire folder in outlook vba", "body": "<p>You need to use the <a href=\"http://msdn.microsoft.com/en-us/library/ff869662.aspx\" rel=\"nofollow\">Find</a>/<a href=\"http://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow\">FindNext</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow\">Restrict</a> methods of the Items class instead of iterating over all items in the folder. Read more about them in the following articles:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/bb147584%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Filtering Items Using a Date-time Comparison</a></li>\n</ul>\n\n<p>Also you may find the <a href=\"http://msdn.microsoft.com/en-us/library/bb219884.aspx\" rel=\"nofollow\">AdvancedSearch</a> method of the Application class helpful. See <a href=\"https://www.add-in-express.com/creating-addins-blog/2012/05/31/outlook-search-csharp-vbnet/\" rel=\"nofollow\">Advanced search in Outlook programmatically: C#, VB.NET</a> .</p>\n"}], "owner": {"reputation": 177, "user_id": 4666839, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d191846b1d45ea64eadf57996a6a10d9?s=128&d=identicon&r=PG&f=1", "display_name": "Linda", "link": "https://stackoverflow.com/users/4666839/linda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 795, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475064096, "creation_date": 1475044035, "question_id": 39739535, "link": "https://stackoverflow.com/questions/39739535/how-to-iterate-through-only-mails-of-a-specific-date-and-not-the-entire-folder-i", "title": "How to iterate through only mails of a specific date and not the entire folder in outlook vba", "body": "<p>I have a requirement to iterate through inbox and more specifically only today's mails.</p>\n\n<p>Using the following code I am able to iterate through inbox and run another function only if the received date is today. </p>\n\n<p>I want to know if there is any other way of iterating only through today's mail instead of going through the entire inbox (as the inbox of the end user has lot of mails and the current code takes a lot of time). Thanks in advance! </p>\n\n<pre><code>For Each item In olFolder.Items\n    If TypeOf item Is Outlook.MailItem Then\n        Dim oMail As Outlook.MailItem: Set oMail = item\n            MsgBox Format(oMail.ReceivedTime, \"Short Date\")\n\n            recDate = Format(oMail.ReceivedTime, \"Short Date\")\n            If recDate = Date Then\n                MsgBox \"Today's mail\"\n                Call CopyToServer(oMail)\n            End If\n\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6891853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8669813cf7c4129db70a5bb1945f69a7?s=128&d=identicon&r=PG&f=1", "display_name": "Vivien", "link": "https://stackoverflow.com/users/6891853/vivien"}, "edited": false, "score": 0, "creation_date": 1475045042, "post_id": 39739612, "comment_id": 66777120, "body": "I&#39;ve tried the above mentioned method, however, it hangs my program everytime I tried to enter new data. Thank you. (:"}, {"owner": {"reputation": 3, "user_id": 6891853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8669813cf7c4129db70a5bb1945f69a7?s=128&d=identicon&r=PG&f=1", "display_name": "Vivien", "link": "https://stackoverflow.com/users/6891853/vivien"}, "edited": false, "score": 0, "creation_date": 1475045276, "post_id": 39739612, "comment_id": 66777266, "body": "Works like a charm! Thank you!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1475044857, "last_edit_date": 1475044857, "creation_date": 1475044302, "answer_id": 39739612, "question_id": 39739490, "link": "https://stackoverflow.com/questions/39739490/how-to-clear-contents-of-other-cells-if-i-delete-the-main-data-of-which-the-othe/39739612#39739612", "title": "How to clear contents of other cells if I delete the main data of which the other cells depend on?", "body": "<p>If you mean , that if you clear Column E contents, then clear the contents in columns B,D and F, then use the code below </p>\n\n<p>(However, why do you need to scan the entire rows, on every cell change ? )</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim i               As Integer\n\nFor i = 2 To 10000\n    If Cells(i, \"E\").Value &lt;&gt; \"\" And Cells(i, \"B\").Value = \"\" Then\n        Cells(i, \"B\").Value = Date\n        Cells(i, \"B\").NumberFormat = \"dd.mm.yyyy\"\n        Cells(i, \"D\").Value = \"NEW\"\n        Cells(i, \"F\").Value = \"NEW\"\n    Else\n        If Cells(i, \"E\").Value = \"\" Then\n            Cells(i, \"B\").ClearContents\n            Cells(i, \"D\").ClearContents\n            Cells(i, \"F\").ClearContents\n        End If\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>Improved code:</strong> only run the code if a cell inside Column E is changed, in that case modify the value only for cells in Columns B,D and F for that row.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim WatchRange                  As Range\nDim IntersectRange              As Range\n\n' can modify it to your need, also using dynamic last row with data\nSet WatchRange = Range(\"E2:E10000\")\nSet IntersectRange = Intersect(Target, WatchRange)\n\n' check values in Column E, only if cells in Column E are modified\nIf Not IntersectRange Is Nothing Then\n    Dim i               As Integer\n\n   ' change value only for relevant row change\n    i = Target.Row\n\n    If Cells(i, \"E\").Value &lt;&gt; \"\" And Cells(i, \"B\").Value = \"\" Then\n        Cells(i, \"B\").Value = Date\n        Cells(i, \"B\").NumberFormat = \"dd.mm.yyyy\"\n        Cells(i, \"D\").Value = \"NEW\"\n        Cells(i, \"F\").Value = \"NEW\"\n    Else\n        If Cells(i, \"E\").Value = \"\" Then\n            Cells(i, \"B\").ClearContents\n            Cells(i, \"D\").ClearContents\n            Cells(i, \"F\").ClearContents\n        End If\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6891853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8669813cf7c4129db70a5bb1945f69a7?s=128&d=identicon&r=PG&f=1", "display_name": "Vivien", "link": "https://stackoverflow.com/users/6891853/vivien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 39739612, "answer_count": 1, "score": 0, "last_activity_date": 1475044857, "creation_date": 1475043889, "question_id": 39739490, "link": "https://stackoverflow.com/questions/39739490/how-to-clear-contents-of-other-cells-if-i-delete-the-main-data-of-which-the-othe", "title": "How to clear contents of other cells if I delete the main data of which the other cells depend on?", "body": "<p>I have the following code for my worksheet now. When I input the data in Column E, the returning values such as dates of the comment \"new\" will work fine in Column B, D and F respectively.</p>\n\n<p>However, when i delete the data on Column E, the returning values at Column B, D and F stays there.</p>\n\n<p>How can I have them cleared if I delete the data that I've entered in Column E?</p>\n\n<p>Much Thanks!</p>\n\n<p>Private Sub Worksheet_Change(ByVal Target As Range)</p>\n\n<pre><code>Dim i As Integer\nFor i = 2 To 10000\n    If Cells(i, \"E\").Value &lt;&gt; \"\" And Cells(i, \"B\").Value = \"\" Then\n        Cells(i, \"B\").Value = Date\n        Cells(i, \"B\").NumberFormat = \"dd.mm.yyyy\"\n        Cells(i, \"D\").Value = \"NEW\"\n        Cells(i, \"F\").Value = \"NEW\"\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 1, "creation_date": 1475050842, "post_id": 39739451, "comment_id": 66780651, "body": "As your question has <i>I&#39;m struggling with the code</i> and <i>Could you please help</i> it&#39;s unclear if your current code errors when running or if it is missing the part you want. Based on this it&#39;s unlikely people will just try your code and try to read your mind. To get an answer (I&#39;m presuming you&#39;re missing the part you want here) I suggest you add in an attempt and add information about which part&#39;s then not doing as desired."}], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 3744216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6e66d6e12167e7206d9ea845e03f72?s=128&d=identicon&r=PG&f=1", "display_name": "Show_me_your_selector", "link": "https://stackoverflow.com/users/3744216/show-me-your-selector"}, "is_accepted": true, "score": 0, "last_activity_date": 1475053355, "creation_date": 1475053355, "answer_id": 39742702, "question_id": 39739451, "link": "https://stackoverflow.com/questions/39739451/combining-data-from-multiple-workbooks-with-multiple-worksheets-into-summary-wor/39742702#39742702", "title": "combining data from multiple workbooks with multiple worksheets into summary workbook", "body": "<p>As Tim kindly pointed out, it is unclear what you specifically want help with. However, the code I've included below should provide you with a <em>cookie-cutter</em> base that you take away and customise for your purposes. I've tested it, and it seems to work well. It will iterate through a range of workbooks that you select, and all of the sheets contained within. </p>\n\n<p>I hope this helps</p>\n\n<p>P.S Sorry for the messy code - I do not have the time to clean it up. </p>\n\n<pre><code>Sub MergeMultiple1()\n\nDim sh As Excel.Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim shLast As Long\nDim CopyRng As Range\nDim StartRow As Long\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n' Delete the summary sheet if it exists.\nApplication.DisplayAlerts = False\nOn Error Resume Next\nActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\nOn Error GoTo 0\nApplication.DisplayAlerts = True\n' Add a new summary worksheet.\nSet DestSh = ActiveWorkbook.Worksheets.Add\nDestSh.Name = \"RDBMergeSheet\"\n' Fill in the start row.\n\ncurrentfiles = selectedfiles()\n\nFor nfile = LBound(currentfiles) To UBound(currentfiles)\n    Set oFS = CreateObject(\"scripting.filesystemobject\")\n    Filename = currentfiles(nfile)\n    Set workbk1 = Workbooks.Open(Filename)\n    StartRow = 1\n' Loop through all worksheets and copy the data to the\n    For Each sh In ActiveWorkbook.Worksheets\n'Set sh = ActiveWorkbook.Worksheets(1)\n        If sh.Name &lt;&gt; DestSh.Name Then\n            ' Find the last row with data on the summary\n            ' and source worksheets.\n            Last = LastRow(DestSh)\n            shLast = LastRow(sh)\n            ' If source worksheet is not empty and if the last\n            ' row &gt;= StartRow, copy the range.\n\n            If shLast &gt; 0 And shLast &gt;= StartRow Then\n                'Set the range that you want to copy\n                Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n                ' Test to see whether there are enough rows in the summary\n                ' worksheet to copy all the data.\n\n                If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                    MsgBox \"There are not enough rows in the \" &amp; _\n                    \"summary worksheet to place the data.\"\n                    GoTo ExitTheSub\n                End If\n\n                ' This statement copies values and formats.\n                CopyRng.Copy\n                rnga = DestSh.Cells(Last + 1, \"A\")\n\n            With DestSh.Cells(Last + 1, \"A\")\n            .PasteSpecial xlPasteValues\n            .PasteSpecial xlPasteFormats\n            Application.CutCopyMode = False\n            End With\n\n            DestSh.Cells(Last + 1, \"X\").Value = workbk1.Name\n\n        End If\n\n    End If\n\nNext\nworkbk1.Close\nNext\nExitTheSub:\n\nApplication.GoTo DestSh.Cells(1)\n\nDestSh.Columns.AutoFit\n\nWith Application\n.ScreenUpdating = True\n.EnableEvents = True\nEnd With\n\nEnd Function\n\nFunction LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\nAfter:=sh.Range(\"A1\"), _\nLookat:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByRows, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Row\nOn Error GoTo 0\nEnd Function\n\nFunction LastCol(sh As Worksheet)\nOn Error Resume Next\nLastCol = sh.Cells.Find(What:=\"*\", _\nAfter:=sh.Range(\"A1\"), _\nLookat:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByColumns, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Column\nOn Error GoTo 0\nEnd Function\n\nFunction selectedfiles()\nselectedfiles = Application.GetOpenFilename( _\nfilefilter:=\"Speadsheets, *.xl*; *.csv\", MultiSelect:=True)\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 6886431, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/28469072af870d763617dce69e9cc21e?s=128&d=identicon&r=PG&f=1", "display_name": "MopMop", "link": "https://stackoverflow.com/users/6886431/mopmop"}, "is_accepted": false, "score": 0, "last_activity_date": 1475053878, "creation_date": 1475053878, "answer_id": 39742880, "question_id": 39739451, "link": "https://stackoverflow.com/questions/39739451/combining-data-from-multiple-workbooks-with-multiple-worksheets-into-summary-wor/39742880#39742880", "title": "combining data from multiple workbooks with multiple worksheets into summary workbook", "body": "<p>If you wish to make a summary out of several worksheets but not workbooks I would recommend you to check this <a href=\"https://www.youtube.com/watch?v=vbC2lGLFXS0\" rel=\"nofollow\">procedure</a> that explains in details how to create your own code adapted to your request. </p>\n\n<p>Because most of the times, if you ask someone to fix your code you will not be able to debug it or to modify it in the future as it is often the case.</p>\n"}], "owner": {"reputation": 27, "user_id": 5022623, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3ccc20c2b8cbdb3b9f6486a1d34f7ac5?s=128&d=identicon&r=PG&f=1", "display_name": "salti", "link": "https://stackoverflow.com/users/5022623/salti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 39742702, "answer_count": 2, "score": -1, "last_activity_date": 1475053878, "creation_date": 1475043756, "question_id": 39739451, "link": "https://stackoverflow.com/questions/39739451/combining-data-from-multiple-workbooks-with-multiple-worksheets-into-summary-wor", "title": "combining data from multiple workbooks with multiple worksheets into summary workbook", "body": "<p>I have a code which combines data from multiple workbooks(but only with one sheet) into summary workbook. I'm struggling with the code to change it for multiple workbooks with multiple worksheets but can't do it. Could you please help:</p>\n\n<pre><code>Sub MergeAllWorkbooks()\n\nDim myPath As String, FilesInPath As String, lastrow As String\nDim MyFiles() As String\nDim SourceRcount As Long, Fnum As Long\nDim mybook As Workbook, BaseWks As Worksheet, mysht As Worksheet\nDim sourceRange As Range, destRange As Range\nDim rnum As Long, CalcMode As Long\nDim i As Integer, j As Integer\n\n\n'Fill in the path\\folder where the files are\nmyPath = ThisWorkbook.Path &amp; \"\\Some\"\n\n'Add a slash at the end if the user forget it\nIf Right(myPath, 1) &lt;&gt; \"\\\" Then\n    myPath = myPath &amp; \"\\\"\nEnd If\n\n'If there are no Excel files in the folder exit the sub\nFilesInPath = dir(myPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n'Fill the array(myFiles)with the list of Excel files in the folder\nFnum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    Fnum = Fnum + 1\n    ReDim Preserve MyFiles(1 To Fnum)\n    MyFiles(Fnum) = FilesInPath\n    FilesInPath = dir()\nLoop\n\n'Change ScreenUpdating, Calculation and EnableEvents\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n\nSet BaseWks = ThisWorkbook.Worksheets(3)\nrnum = 1\n\n'Loop through all files in the array(myFiles)\nIf Fnum &gt; 0 Then\n    For Fnum = LBound(MyFiles) To UBound(MyFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(myPath &amp; MyFiles(Fnum))\n        Set mysht = mybook.Worksheet\n\n        On Error GoTo 0\n\n        If Not mybook Is Nothing Then\n\n            On Error Resume Next\n\n\n\n\n            'For i = 1 To Worksheets(i).Count\n            'LastRow = Worksheets(i).Range(\"F\" &amp; rows.Count).End(xlUp).Row\n            'MsgBox LastRow\n\n            With mybook.Worksheets(1)\n                Set sourceRange = Range(\"A6:I100\") ' &amp; LastRow)\n            End With\n\n\n\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close SaveChanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        'For j = 1 To Worksheets(j).Count 'Worksheets.Count\n                            With sourceRange\n                                BaseWks.Cells(rnum, \"A\"). _\n                                        Resize(.rows.Count).Value = Range(\"A2\").Value 'MyFiles(Fnum)\n                            End With\n\n                         'Next j\n\n\n                        'Set the destrange\n                        Set destRange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destRange = destRange. _\n                                            Resize(.rows.Count, .Columns.Count)\n                        End With\n                        destRange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n\n\n\n\n                    End If\n\n                End If\n\n            'Next i\n\n            mybook.Close SaveChanges:=False\n        End If\n\n    Next Fnum\n    BaseWks.Columns.AutoFit\nEnd If\n\n\n\nExitTheSub:\n' Restore the application properties.\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = CalcMode\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1475103897, "post_id": 39738845, "comment_id": 66813940, "body": "Thanks for responding. How would you do this if you only want to loop through column C?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1475104064, "post_id": 39738845, "comment_id": 66813987, "body": "You would change <code>With Worksheets(&quot;Sheet1&quot;).Cells</code> to With Worksheets(&quot;Sheet1&quot;).Columns(&quot;C&quot;)`"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1475104559, "post_id": 39738845, "comment_id": 66814117, "body": "I updated my answer to show how you can select the used range in a column."}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1475107544, "post_id": 39738845, "comment_id": 66814761, "body": "Aaaarrgh.... if only you posted the alternative first.  I was pulling my hair with the solution using Find. Thank you though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1475112673, "post_id": 39738845, "comment_id": 66815750, "body": "@Gary&#39;sStudent Thanks :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1475104530, "last_edit_date": 1475104530, "creation_date": 1475041236, "answer_id": 39738845, "question_id": 39738468, "link": "https://stackoverflow.com/questions/39738468/loop-through-first-nonempty-cell-to-last-nonempty-cell/39738845#39738845", "title": "Loop Through First Nonempty Cell to Last Nonempty Cell", "body": "<p>Here is a couple of techniques:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DLMOb.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DLMOb.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub LoopThroughCells()\n    Dim c As Range, Target As Range, rFirst As Range, rLast As Range\n    Dim x As Long, y As Long\n\n    With Worksheets(\"Sheet1\").Cells\n        Set rLast = .Find(What:=\"*\", _\n                          After:=.Cells(1), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False)\n\n        Set rFirst = .Find(What:=\"*\", _\n                           After:=rLast, _\n                           Lookat:=xlPart, _\n                           LookIn:=xlFormulas, _\n                           SearchOrder:=xlByRows, _\n                           SearchDirection:=xlNext, _\n                           MatchCase:=False)\n\n\n        With .Range(rFirst, rLast)\n            Debug.Print \"For Each c In .Cells\"\n            For Each c In .Cells\n                If x &lt;&gt; c.Row Then Debug.Print\n                x = c.Row\n                Debug.Print c.Value,\n            Next\nStop\n            Debug.Print\n            Debug.Print \"For x = 1 To .Rows.Count\"\n            For x = 1 To .Rows.Count\n                Debug.Print\n\n                For y = 1 To .Columns.Count\n                    Debug.Print .Cells(x, y),\n                Next\n            Next\n\n        End With\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Note: A <code>For Each Loop</code> to iterates over a range row by row (e.g. All cells in Rows(1) then all the cells in Rows(2) ..etc.). </p>\n\n<h2>UPDATE:</h2>\n\n<p>Selecting the range starting from the first used cell and last used cell; without using find.</p>\n\n<hr>\n\n<pre><code> With Worksheets(\"Sheet1\")\n    With .Range(.Range(\"C1\").End(xlDown), .Range(\"C\" &amp; Rows.Count).End(xlUp))\n        For Each c In .Cells\n            If x &lt;&gt; c.Row Then Debug.Print\n            x = c.Row\n            Debug.Print c.Value,\n        Next\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 39738845, "answer_count": 1, "score": 1, "last_activity_date": 1475104530, "creation_date": 1475039162, "last_edit_date": 1531164843, "question_id": 39738468, "link": "https://stackoverflow.com/questions/39738468/loop-through-first-nonempty-cell-to-last-nonempty-cell", "title": "Loop Through First Nonempty Cell to Last Nonempty Cell", "body": "<p>I am trying to loop through the first occurrence of a cell up to some unknown last nonempty cell. For example.</p>\n\n<p>I know how to find the <strong>last</strong> and <strong>first</strong> nonempty cell but how can I put \nthem in a loop?</p>\n\n<pre><code> With Worksheets(\"AssignedTickets\").Columns(\"F\")\n    Set test = .Find(what:=\"*\", after:=.Cells(1, 1), LookIn:=xlValues)\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yqBLY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yqBLY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1475074243, "post_id": 39737994, "comment_id": 66797986, "body": "I think <a href=\"http://stackoverflow.com/a/3746558/4717755\">How to get Shape&#39;s internal name</a> may shed some insight into this situation."}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1475075683, "post_id": 39737994, "comment_id": 66799025, "body": "That&#39;s an interesting article, which leads me to the conclusion that if one does not already know what the internal name is, there&#39;s no way to get it."}], "answers": [{"tags": [], "owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "is_accepted": true, "score": 0, "last_activity_date": 1475294803, "creation_date": 1475294803, "answer_id": 39802913, "question_id": 39737994, "link": "https://stackoverflow.com/questions/39737994/excel-doesnt-release-a-shapes-creation-name/39802913#39802913", "title": "Excel doesn&#39;t release a shape&#39;s creation name", "body": "<p>As the main purpose of this post was to pass along information, I'm going to make this an answer so it can be closed.</p>\n"}], "owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 39802913, "answer_count": 1, "score": 2, "last_activity_date": 1475294803, "creation_date": 1475036458, "last_edit_date": 1531161705, "question_id": 39737994, "link": "https://stackoverflow.com/questions/39737994/excel-doesnt-release-a-shapes-creation-name", "title": "Excel doesn&#39;t release a shape&#39;s creation name", "body": "<p>I\u2019m posting this in the hope that it might help someone else, as none of my searches revealed any information regarding this.</p>\n\n<p>I ran into this while building a procedure that would copy an imbedded form shape, and paste it on the same sheet, then run a renaming scheme that would facilitate referencing either of these shapes</p>\n\n<p>This should be simple enough, but I was running into an intermittent problem.  Eventually I came to realize that Excel appears to \u201cremember\u201d the shape\u2019s original name at the time of its creation, and keeps it flagged as being in use, releasing it only when the shape is deleted.  So if you rename the shape, you can never return it to the original name.  E.g., if you rename \u201cButton 1\u201d to \u201cBtn1\u201d, you can never change it back to \u201cButton 1\u201d.  Interestingly, you can now reference the shape by either name, \u201cButton 1\u201d or \u201cBtn1\u201d. </p>\n\n<p>In the macro below, assuming \u201cButton 1\u201d is the creation name, s.Name will end up as \u201cBtn1\u201d, even though it looks like it would return to \u201cButton 1\u201d. </p>\n\n<pre><code>Sub RenameShape()\nDim s As Shape\nDim nm As String\nSet s = ActiveSheet.Shapes(\"Button 1\")\nnm = s.Name\ns.Name = \"Btn1\"\ns.Name = nm\nEnd Sub  \n</code></pre>\n\n<p>I have since come across a couple of links that talk about the shape\u2019s  \u201cinternal\u201d and \u201cexternal\u201d names \u2013 I\u2019m assuming the \u201cinternal\u201d name is the inaccessible one that Excel won\u2019t forget, while the \u201cexternal\u201d name is the exposed name that one normally sees.</p>\n\n<p>I\u2019d be interested to hear from anyone who can shed more insight into this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5447, "user_id": 498949, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ts1hR.jpg?s=128&g=1", "display_name": "Chris Rae", "link": "https://stackoverflow.com/users/498949/chris-rae"}, "edited": false, "score": 0, "creation_date": 1475036777, "post_id": 39737659, "comment_id": 66773805, "body": "Range(&quot;11&quot;) isn&#39;t a valid range reference."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6763891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f281c0cfe4b3b686443a11337fdd21c8?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6763891/manu"}, "edited": false, "score": 0, "creation_date": 1475126153, "post_id": 39737965, "comment_id": 66819050, "body": "@Thomas Inzina, I have 2 concerns with the code you provided.               1. Its working as expected, cells are enabled/unlocked when the drop down value is yes. I can input the data, but the problem is its not highlighting the cell when I click on it (On Sheet Manage-d) 2. Is it possible to throw a prompt to the user to change the drop down value, when he tries to click on locked cells when the value of drop down is &quot;NO&quot;"}, {"owner": {"reputation": 83, "user_id": 6763891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f281c0cfe4b3b686443a11337fdd21c8?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6763891/manu"}, "edited": false, "score": 0, "creation_date": 1475169397, "post_id": 39737965, "comment_id": 66846799, "body": "@Thomas Inzina, do you want me to post an other question? as this question is answered."}, {"owner": {"reputation": 83, "user_id": 6763891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f281c0cfe4b3b686443a11337fdd21c8?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6763891/manu"}, "edited": false, "score": 0, "creation_date": 1475170353, "post_id": 39737965, "comment_id": 66847365, "body": "I think it make sense to post new question. Hence I have posted an other question as per policies. Please help if possible <a href=\"http://stackoverflow.com/questions/39776578/vba-to-disable-sheet-based-on-cell-value\" title=\"vba to disable sheet based on cell value\">stackoverflow.com/questions/39776578/&hellip;</a>"}], "tags": [], "owner": {"reputation": 102, "user_id": 5821186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z0a2g.jpg?s=128&g=1", "display_name": "Sayyed Abbas Rizvi", "link": "https://stackoverflow.com/users/5821186/sayyed-abbas-rizvi"}, "is_accepted": false, "score": 1, "last_activity_date": 1475036249, "creation_date": 1475036249, "answer_id": 39737965, "question_id": 39737659, "link": "https://stackoverflow.com/questions/39737659/vba-to-select-sheet-based-on-cell-value-of-another-sheet/39737965#39737965", "title": "VBA to select sheet based on cell value of another sheet", "body": "<p>Range object represents a single cell or a range of cells.This code is working for me</p>\n\n<pre><code> If Range(\"A1\").Value = \"YES\" Then '' Range A1 is the first cell\n        Sheets(\"Manage-d\").Select\n        Sheets(\"Manage-d\").Range(\"A11:D30\").Locked = False\n        Sheets(\"Manage-d\").Range(\"A11:D30\").Activate\n    Else\n         Sheets(\"Manage-d\").Range(\"A11:D30\").Locked = True\n End If\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1475039447, "last_edit_date": 1475039447, "creation_date": 1475038376, "answer_id": 39738311, "question_id": 39737659, "link": "https://stackoverflow.com/questions/39737659/vba-to-select-sheet-based-on-cell-value-of-another-sheet/39738311#39738311", "title": "VBA to select sheet based on cell value of another sheet", "body": "<p>I use the <code>Worksheet_Change</code> instead of the <code>Worksheet_SelectionChange</code> so that the user doesn't have to ciack another cell to trigger the macro.</p>\n\n<p>Assuming the drop-down(validation) is in <code>Range(\"A11\")</code>:</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A11\")) Is Nothing Then\n        With Sheets(\"Manage-d\")\n\n            .Range(\"A11:D30\").Locked = (UCase(Target.Value) = \"NO\")\n\n            If UCase(Target.Value) = \"YES\" Then\n                Application.Goto .Range(\"A11:D30\"), True\n            End If\n\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/t4lfU.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t4lfU.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 83, "user_id": 6763891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f281c0cfe4b3b686443a11337fdd21c8?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6763891/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2753, "favorite_count": 0, "accepted_answer_id": 39738311, "answer_count": 2, "score": 0, "last_activity_date": 1475039447, "creation_date": 1475034151, "last_edit_date": 1475034859, "question_id": 39737659, "link": "https://stackoverflow.com/questions/39737659/vba-to-select-sheet-based-on-cell-value-of-another-sheet", "title": "VBA to select sheet based on cell value of another sheet", "body": "<p>On Sheet 1(viva-2) Row 11 has a drop-down(validation) with yes/no.\nBy default, value will be \"no\" and sheet 11(Manage-d) cell range A11:D30 should be disabled/locked.\nSelecting \"Yes\", user should be able to select Sheet11(Manage-d) and cells from range A11:D30 should be unlocked.</p>\n\n<p>I am new to VBA, but I am putting my effort to learn.</p>\n\n<pre><code>Public Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n\n    Dim RNG                         As Range\n\n\n    If Target.Row = 11 Then\n     If Range(\"11\").Value = \"YES\" Then\n            Sheets(\"Manage-d\").Select\n            Sheets(\"Manage-d\").Range(\"A11:D30\").Locked = False\n            Sheets(\"Manage-d\").Range(\"A11:D30\").Activate\n        Else\n             Sheets(\"Manage-d\").Range(\"A11:D30\").Locked = True\n     End If\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "row"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475032420, "post_id": 39737436, "comment_id": 66772743, "body": "I did not put as macro. I put this inside the Objects inside the objects sheet"}], "tags": [], "owner": {"reputation": 11330, "user_id": 937222, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ej6Cg.jpg?s=128&g=1", "display_name": "Apollo SOFTWARE", "link": "https://stackoverflow.com/users/937222/apollo-software"}, "is_accepted": false, "score": 0, "last_activity_date": 1475032450, "last_edit_date": 1475032450, "creation_date": 1475032385, "answer_id": 39737436, "question_id": 39737409, "link": "https://stackoverflow.com/questions/39737409/finding-last-row-in-excel-vba/39737436#39737436", "title": "Finding last row in Excel VBA", "body": "<p>It's probably because you recorded the macro at the worksheet level. You have to make sure it's on the project/entire module level. </p>\n\n<p>Right click on the modules node on the project window and paste your macro into a new module. Also ensure that the worksheet is not in protected mode, or else the error will occur as well.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "edited": false, "score": 0, "creation_date": 1475033726, "post_id": 39737569, "comment_id": 66773058, "body": "indeed you are correct."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1475033476, "creation_date": 1475033476, "answer_id": 39737569, "question_id": 39737409, "link": "https://stackoverflow.com/questions/39737409/finding-last-row-in-excel-vba/39737569#39737569", "title": "Finding last row in Excel VBA", "body": "<p>You have <code>x1Up</code> instead of <code>xlUp</code>.  compare them side to side <code>1l</code> on the left is the number 1 in your code and on the right is the letter l.</p>\n"}, {"tags": [], "owner": {"reputation": 24, "user_id": 3744216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6e66d6e12167e7206d9ea845e03f72?s=128&d=identicon&r=PG&f=1", "display_name": "Show_me_your_selector", "link": "https://stackoverflow.com/users/3744216/show-me-your-selector"}, "is_accepted": false, "score": 0, "last_activity_date": 1475054097, "creation_date": 1475054097, "answer_id": 39742974, "question_id": 39737409, "link": "https://stackoverflow.com/questions/39737409/finding-last-row-in-excel-vba/39742974#39742974", "title": "Finding last row in Excel VBA", "body": "<p>You might want to consider the function below. The method used above will not work if the last row of the dataset is hidden, or (possibly) has a filter applied). The function below presents a more robust way of achieving the same result. </p>\n\n<p>Hope this helps </p>\n\n<pre><code>Function LastRowColumn(sht As Worksheet, RowColumn As String) As Long\n'PURPOSE: Function To Return the Last Row Or Column Number In the Active Spreadsheet\n'INPUT: \"R\" or \"C\" to determine which direction to search\n\nDim rc As Long\n\nSelect Case LCase(Left(RowColumn, 1)) 'If they put in 'row' or column instead of 'r' or 'c'.\n  Case \"c\"\n    LastRowColumn = sht.Cells.Find(\"*\", LookIn:=xlFormulas, SearchOrder:=xlByColumns, _\n    SearchDirection:=xlPrevious).Column\n  Case \"r\"\n    LastRowColumn = sht.Cells.Find(\"*\", LookIn:=xlFormulas, SearchOrder:=xlByRows, _\n    SearchDirection:=xlPrevious).Row\n  Case Else\n    LastRowColumn = 1\nEnd Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6856821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b492bab6f300c8e92d5351c6f7362da1?s=128&d=identicon&r=PG&f=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/6856821/prabhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "closed_date": 1475141848, "answer_count": 3, "score": -2, "last_activity_date": 1475054097, "creation_date": 1475032194, "question_id": 39737409, "link": "https://stackoverflow.com/questions/39737409/finding-last-row-in-excel-vba", "closed_reason": "Not suitable for this site", "title": "Finding last row in Excel VBA", "body": "<p>I get the run time error 1004: Application-defined or Object defined error</p>\n\n<pre><code>Set wsht = ThisWorkbook.Worksheets(\"Input Checklist\")\nfinalrow = wsht.Cells(wsht.Rows.Count, 1).End(x1Up).Row\n</code></pre>\n\n<p>What is the error related to?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 6850672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcd5b8bce9819d4a06926e5b5196ad9?s=128&d=identicon&r=PG&f=1", "display_name": "PLH", "link": "https://stackoverflow.com/users/6850672/plh"}, "edited": false, "score": 0, "creation_date": 1475028346, "post_id": 39736889, "comment_id": 66771791, "body": "I can&#39;t figure out how to more clearly point out the line that&#39;s giving me an error so I apologize if it&#39;s hard to find in my code"}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1475028760, "post_id": 39736889, "comment_id": 66771898, "body": "Consider changing the way you find the number of rows (m), e.g. <a href=\"http://stackoverflow.com/questions/6301665/how-to-count-the-number-of-rows-in-excel-with-data\" title=\"how to count the number of rows in excel with data\">stackoverflow.com/questions/6301665/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475028983, "post_id": 39736889, "comment_id": 66771960, "body": "The problem is that all ranges within a range must reference the same worksheet:  <code>wbk.Worksheets(ws).Range(Range(&quot;A9&quot;).End(xlDown), Range(&quot;A9&quot;).End(xlDown).End(xlDown)).Rows.Count</code> . wbk.Worksheets(ws).Range()` refers to cells on <code>wbk.Worksheets(ws)</code> and <code>Range(&quot;A9&quot;).End(xlDown), Range(&quot;A9&quot;).End(xlDown).End(xlDown)</code> refers to cells on the ActiveSheet."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475033300, "post_id": 39736889, "comment_id": 66772947, "body": "Do you <i>reaaallllyyyy</i> have to use <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">.Select</a>???"}, {"owner": {"reputation": 1, "user_id": 6850672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcd5b8bce9819d4a06926e5b5196ad9?s=128&d=identicon&r=PG&f=1", "display_name": "PLH", "link": "https://stackoverflow.com/users/6850672/plh"}, "edited": false, "score": 0, "creation_date": 1475528096, "post_id": 39736889, "comment_id": 66970274, "body": "I looked at the duplicate question marked by chris neilsen and reasoned out a solution. Also thanks to @Thomas for your explanation as well."}, {"owner": {"reputation": 1, "user_id": 6850672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcd5b8bce9819d4a06926e5b5196ad9?s=128&d=identicon&r=PG&f=1", "display_name": "PLH", "link": "https://stackoverflow.com/users/6850672/plh"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475528181, "post_id": 39736889, "comment_id": 66970313, "body": "@Tyeler I updated my code to remove select. Thanks for that added challenge ;)"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475544243, "post_id": 39736889, "comment_id": 66975180, "body": "@PLH No problem! It&#39;s usually best, for your code and mental health, to avoid using <code>.Select</code> as much as possible. It often provides non-intuitive results that could lead you to troubleshooting the wrong parts of your code. I&#39;m glad you got it all working!"}], "owner": {"reputation": 1, "user_id": 6850672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcd5b8bce9819d4a06926e5b5196ad9?s=128&d=identicon&r=PG&f=1", "display_name": "PLH", "link": "https://stackoverflow.com/users/6850672/plh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1475028638, "answer_count": 0, "score": 0, "last_activity_date": 1475028143, "creation_date": 1475028143, "last_edit_date": 1531164843, "question_id": 39736889, "link": "https://stackoverflow.com/questions/39736889/vba-run-time-error-1004-declaring-a-data-type-based-on-number-of-rows-in-parti", "closed_reason": "Duplicate", "title": "VBA Run-time error 1004 - Declaring a data type based on number of rows in particular range", "body": "<p>I am using VBA for Excel 2016 and keep getting the following error:</p>\n\n<blockquote>\n  <p>Run-time error '1004':<br>\n  Application-defined or object-defined error</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Macro2()\n\nDim wbk As Workbook\nDim countermax As Integer\nDim ws As String\nDim i As Integer 'for counter\nDim x As Integer 'for serial number of month\nDim m As Long\nDim macro As Worksheet\n\nSet wbk = ThisWorkbook\nSet macro = wbk.Worksheets(\"Macro\")\ncountermax = wbk.Worksheets(\"macro\").Range(\"A1\")\ni = 2\nx = wbk.Worksheets(\"macro\").Range(\"D2\")\ny = 12 - x\nz = y - 1\n\nDo While i &lt; countermax\n    ws = wbk.Worksheets(\"macro\").Range(\"B\" &amp; i)\n    **m = wbk.Worksheets(ws).Range(Range(\"A9\").End(xlDown), Range(\"A9\").End(xlDown).End(xlDown)).Rows.Count**\n\n    Worksheets(ws).Range(Range(\"A9\").End(xlDown), Range(\"A9\").End(xlDown).Offset(m, 0)).EntireRow.Select\n    Selection.Rows.Hidden = False\n    On Error Resume Next\n    Selection.Rows.Ungroup\n\n   If y &lt;&gt; 0 Then\n        Range(\"A9\").Select\n        Selection.End(xlDown).Select\n        Selection.End(xlDown).Select\n        Range(Range(\"A9\").End(xlDown), Range(\"A9\").End(xlDown).Offset(-z, 0)).EntireRow.Select\n        Selection.Rows.Group\n        Selection.Rows.Hidden = True\n    Else: End If\n\n    i = i + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Debugging this code highlights the line in **. </p>\n\n<p>Every month I have to manually go through each tab in a workbook and ungroup + unhide the next hidden row in a particular range that represents the months of the year. What I'd like to do is have a macro go through every worksheet that has its name listed in the macro worksheet and unhide the next month's row. Because not every worksheet has the same number of rows (e.g. the first month may be January for one worksheet, March for another), I'm trying to have Excel count the number of rows and store that as a data type so it knows how many to hide. </p>\n\n<p>When I hover my cursor over the \"m\" variable, it tells me \"m = 0\". Can someone please explain to me why it's not giving me the row count? </p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1475029247, "post_id": 39736400, "comment_id": 66772018, "body": "You can look into Power Query or Microsoft Query"}, {"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1475076045, "post_id": 39736400, "comment_id": 66799285, "body": "Not sure why this got a downvote.. if you are downvoting, please mention the reason for doing so.  for me, this looks like a complete question.."}], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475024552, "post_id": 39736438, "comment_id": 66770876, "body": "Thanks. thats what we are doing now manually. but this is prone to error and since we have to do it for 200+ Records, also we need to do it 3 times a day which  is kind of painful.  Thats why planning to do it in a macro."}, {"owner": {"reputation": 15, "user_id": 6850866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f975a2e0bd625dd4965afc4f74f2d6d8?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey", "link": "https://stackoverflow.com/users/6850866/bailey"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475026189, "post_id": 39736438, "comment_id": 66771240, "body": "<code>=IF(VLOOKUP(A1,[File1.xls]Sheet1!A:A,1,FALSE),[File1.xls]She&zwnj;&#8203;et1!C1,&quot; &quot;)</code>  You can paste this into the D column on your second sheet, youll need to change the [File1.xls] to your workbook name.  This will search if the ID is found on File 2 in File1 then return column C (Gender) from File1 if it is found. You can then see if it matches what you have and make adjustments a bit easier this way.  This can be completely reversed and done on Sheet1 looking up Sheet2, the purpose of this is to have a side by side of the incorrect/correct genders in the ONE sheet so you can quickly make changes"}, {"owner": {"reputation": 15, "user_id": 6850866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f975a2e0bd625dd4965afc4f74f2d6d8?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey", "link": "https://stackoverflow.com/users/6850866/bailey"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475026390, "post_id": 39736438, "comment_id": 66771286, "body": "The next step we can look into if you need to automate even further is a way we can show only your ~200 correct results lined up side by side against the ~200 incorrect results and simply copy/paste the gender column onto it.  Data will have to be manipulated for this but I believe it can be possible."}], "tags": [], "owner": {"reputation": 15, "user_id": 6850866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f975a2e0bd625dd4965afc4f74f2d6d8?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey", "link": "https://stackoverflow.com/users/6850866/bailey"}, "is_accepted": false, "score": 0, "last_activity_date": 1475024206, "creation_date": 1475024206, "answer_id": 39736438, "question_id": 39736400, "link": "https://stackoverflow.com/questions/39736400/excel-compare-two-sheets-and-update-sheet-1/39736438#39736438", "title": "Excel Compare two sheets and update sheet 1", "body": "<p>A super quick way, copy your CORRECT employee ID list and paste below the CORRUPT employee ID list... highlight duplicates and correct the highlighted.</p>\n\n<p>Otherwise a VLOOKUP could label which ones are corrupt? basically getting a unique field from your correct list and comparing that to your corrupt list then fixing the ~200 errors. </p>\n"}, {"comments": [{"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475075946, "post_id": 39737977, "comment_id": 66799212, "body": "Thanks @jamheadart .. was looking for something similar to this."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475076187, "post_id": 39737977, "comment_id": 66799402, "body": "No probs! There&#39;s probably a slightly more elegant way to write the code using <code>Evaluate(COUNTIF(.range(&quot;A:A&quot;), cur)</code> and <code>Evaluate(MATCH etc</code> but I didn&#39;t get a chance to try it and not sure it&#39;ll affect performance too much."}, {"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475101393, "post_id": 39737977, "comment_id": 66813233, "body": "I am running into a issue..  while the first line worksheetfunction.countif works and returns 1 record, the next line - worksheetfunction.match returns nothing and throws 1004 error. Any idea why?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475102519, "post_id": 39737977, "comment_id": 66813541, "body": "That is weird.. it can find &quot;cur&quot; well enough to register it but then can&#39;t find it again in the same range using <code>MATCH</code> .. did the code change much at all? Maybe missing the <code>.</code> in front of the range(&quot;A:A&quot;). I&#39;m hoping it&#39;s something simple like that and not a weird limit to how many rows <code>match</code> can find. If you want you could copy/paste the code in to your original question I may be able to help more."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475102712, "post_id": 39737977, "comment_id": 66813604, "body": "There&#39;s not many places it can go wrong in that one line really, make sure it&#39;s <code>Application.WorksheetFunction.Match</code> also <code>theRow</code> variable is an integer? Like I mentioned make sure the <code>range</code> is preceded by the correct worksheet declaration (it&#39;s just <code>.</code> on my example cos they were on the same sheet."}, {"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475104482, "post_id": 39737977, "comment_id": 66814101, "body": "No, so i did some research and change it to Application.Match which seems to be more elegant. it handled the error but it had an error code 2042 which means, that match was not found which is weird."}, {"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475104504, "post_id": 39737977, "comment_id": 66814106, "body": "The code did not change at all. it is exactly the same as it is above. So i am thinking to replace the match function with find and see if there are any changes to the result"}, {"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1475106470, "post_id": 39737977, "comment_id": 66814563, "body": "Find worked absolutely fine. not sure what the problem was with match.   thank you for your help"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 1, "creation_date": 1475125723, "post_id": 39737977, "comment_id": 66818924, "body": "I have no idea then. I&#39;ve used this method a few times and tried putting values way down in to the 20,000 rows to see if there was a match limit or something but I can&#39;t get any errors from it. As long you have it working you way :)"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 1, "last_activity_date": 1475036354, "creation_date": 1475036354, "answer_id": 39737977, "question_id": 39736400, "link": "https://stackoverflow.com/questions/39736400/excel-compare-two-sheets-and-update-sheet-1/39737977#39737977", "title": "Excel Compare two sheets and update sheet 1", "body": "<p>One way to do this through VBA is to just loop through the 200 corrections, comparing the ID with the MATCH function to find the row it belongs on, as opposed to a second loop (a second loop through 20000 would take ages like you say).</p>\n\n<p>For the below sub I have copied and pasted the 200 table into columns 5:7 of the 20000 table, you can either automate this part easily enough, or just put in the correct sheet references for each part of the code.</p>\n\n<p>I've also put in a checking line to make sure there IS a match for the current ID from the small table, otherwise it'd throw up an error. You could put an ELSE in front of the END IF in this error catch to highlight any ID's which weren't actually found. Here's the code, hope this method helps!</p>\n\n<pre><code>Sub replace_things()\nWith ActiveSheet\nFor x = 2 To 200 'Change this to however many is in the small table\n    cur = .Cells(x, 5) 'Defined cur as ID from small table\n    aMatch = Application.WorksheetFunction.CountIf(.Range(\"A:A\"), cur) 'Check to see there's a match in large table\n    If aMatch &gt; 0 Then ' if there's a match then...\n        theRow = Application.WorksheetFunction.Match(cur, .Range(\"A:A\"), 0) 'get the row number the match is actually on\n        .Cells(theRow, 3) = .Cells(x, 7) 'when row is found, replace with the relevant value from col7 (col3 of small table)\n    End If\nNext x\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "is_accepted": false, "score": 0, "last_activity_date": 1475053169, "creation_date": 1475053169, "answer_id": 39742621, "question_id": 39736400, "link": "https://stackoverflow.com/questions/39736400/excel-compare-two-sheets-and-update-sheet-1/39742621#39742621", "title": "Excel Compare two sheets and update sheet 1", "body": "<p>I assume that the employee ID is a unique record so you can paste the correct ones under existing ones, sort by empID and highlight duplicates to find them easily.</p>\n"}], "owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 39737977, "answer_count": 3, "score": 0, "last_activity_date": 1475053169, "creation_date": 1475023863, "last_edit_date": 1495541703, "question_id": 39736400, "link": "https://stackoverflow.com/questions/39736400/excel-compare-two-sheets-and-update-sheet-1", "title": "Excel Compare two sheets and update sheet 1", "body": "<p>Okay  - This has been asked multiple times, but asking again for best possible solution : </p>\n\n<p>I have two excel files (not sheets).  the first excel sheet is very huge and has close to 200,000 records. One of the column (Gender) is corrupted and i have to fix it.<br>\nI have a second excel file and it has only around 200 records - these have the correct value for those ones which are messed up. </p>\n\n<p>for eg:<br>\n<a href=\"https://i.stack.imgur.com/6GIfa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6GIfa.png\" alt=\"Master List with 200,000 records\"></a></p>\n\n<p>and this is the file that has correct values with only around 200 records (only the corrupted ones). \n<a href=\"https://i.stack.imgur.com/mFO1P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mFO1P.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now i need  a macro , where i need to find these exact 200 records out of 200,000 records (by employee id) and replace the Gender value with correct one.<br>\ni found something similar <a href=\"https://stackoverflow.com/questions/5387929/vba-macro-to-compare-all-cells-of-two-excel-files/\" title=\"here\">here</a>.  but i dont want to loop 200,000 records 200 times. feels like a performance overhead. \nis there a better option?  </p>\n\n<p>I am thinking an ideal solution would be  </p>\n\n<ol>\n<li>Loop through 200 items and use employee id per loop</li>\n<li>Take that employee id and do a \"Find\" operation in the Employee id column of the master excel </li>\n<li>If found, replace the Gender column value </li>\n</ol>\n\n<p>would there be any other better solution? Any inputs is gladly appreciated</p>\n"}, {"tags": ["vba", "excel", "function", "filter"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1475047615, "post_id": 39736343, "comment_id": 66778673, "body": "The code written by the original developer  expects your system to be using a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd317794(v=vs.85).aspx\" rel=\"nofollow noreferrer\">DBCS code page</a>. On those systems, <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264313.aspx\" rel=\"nofollow noreferrer\">Asc</a> will return an negative integer for Chinese characters."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1475033068, "creation_date": 1475033068, "answer_id": 39737516, "question_id": 39736343, "link": "https://stackoverflow.com/questions/39736343/how-to-separate-filter-english-text-from-chinese-in-excel/39737516#39737516", "title": "How to separate/filter English text from Chinese in Excel", "body": "<p>This sounds like a job for Regular Expressions!!</p>\n\n<p><a href=\"https://i.stack.imgur.com/VI5ti.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VI5ti.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Function getCharSet(Target As Range) As String\n    Const ChinesePattern = \"[\\u4E00-\\u9FFF\\u6300-\\u77FF\\u7800-\\u8CFF\\u8D00-\\u9FFF]+\"\n    Const EnglishPattern = \"[A-Za-z]\"\n    Dim results As String\n    Dim Data, v\n    Dim Regex1 As Object\n    Set Regex1 = CreateObject(\"VBScript.RegExp\")\n    Regex1.Global = True\n\n    If Target.Count = 1 Then\n        Data = Array(Target.Value2)\n    Else\n        Data = Target.Value2\n    End If\n\n    For Each v In Data\n\n        If Not InStr(results, \"CHN\") Then\n            Regex1.Pattern = ChinesePattern\n            If Regex1.Test(v) Then\n                If Len(results) Then\n                    getCharSet = \"CHN\" &amp; \" - \" &amp; results\n                    Exit Function\n                Else\n                    results = \"CHN\"\n                End If\n            End If\n        End If\n\n        If Not InStr(results, \"ENG\") Then\n            Regex1.Pattern = EnglishPattern\n            If Regex1.Test(v) Then\n                If Len(results) Then\n                    getCharSet = results &amp; \" - ENG\"\n                    Exit Function\n                Else\n                    results = \"ENG\"\n                End If\n            End If\n        End If\n    Next\n    getCharSet = results\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 5182777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7826204353d38e61aa39839183a355e4?s=128&d=identicon&r=PG&f=1", "display_name": "Docmarti", "link": "https://stackoverflow.com/users/5182777/docmarti"}, "is_accepted": false, "score": 1, "last_activity_date": 1475041579, "last_edit_date": 1475041579, "creation_date": 1475040629, "answer_id": 39738735, "question_id": 39736343, "link": "https://stackoverflow.com/questions/39736343/how-to-separate-filter-english-text-from-chinese-in-excel/39738735#39738735", "title": "How to separate/filter English text from Chinese in Excel", "body": "<p>A basic approach :</p>\n\n<pre><code>Sub Main()\n\nDim sh As Worksheet\nSet sh = ActiveSheet\n\nDim rng As Range\nSet rng = sh.Range(\"A6:D10\")\n\nCall Separate_English_Chinese(rng)\n\nEnd Sub\n\nSub Separate_English_Chinese(rng)\n\nDim sh As Worksheet\nSet sh = rng.Parent\n\nDim EnglishCharacters As String\nDim colEng As Long, colChn As Long, colContains As Long\nDim a As String, i As Long, k As Long\nDim colFullText As Long, txtEnglish As String, txtChinese As String\nDim Result As Long, Contains As String\nDim First As Long, Last As Long\n\nFirst = rng.Row\nLast = rng.Rows.Count + rng.Row - 1\n\nEnglishCharacters = \"qwertyuiopasdfghjklzxcvbnm\"\n\nEnglishCharacters = UCase(EnglishCharacters) &amp; LCase(EnglishCharacters)\n\ncolFullText = 1\ncolEng = 2\ncolChn = 3\ncolContains = 4\n\nFor i = First To Last\n\n    a = sh.Cells(i, colFullText).Value\n\n    txtEnglish = \"\"\n    txtChinese = \"\"\n\n    For k = 1 To Len(a)\n\n        If InStr(EnglishCharacters, Mid(a, k, 1)) Then\n            txtEnglish = txtEnglish &amp; Mid(a, k, 1)\n        Else\n            txtChinese = txtChinese &amp; Mid(a, k, 1)\n        End If\n\n    Next\n\n    sh.Cells(i, colEng).Value = txtEnglish\n    sh.Cells(i, colChn).Value = txtChinese\n\n    Result = 0\n    If txtEnglish &lt;&gt; \"\" Then Result = Result + 1\n    If txtChinese &lt;&gt; \"\" Then Result = Result + 10\n\n    Select Case Result\n\n        Case 1\n        Contains = \"ENG\"\n        Case 10\n        Contains = \"CHN\"\n        Case 11\n        Contains = \"BOTH\"\n        Case Else\n        Contains = \"\"\n\n    End Select\n\n    sh.Cells(i, colContains).Value = Contains\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6530843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995882c0b6575066cf50deb8c07de71d?s=128&d=identicon&r=PG", "display_name": "Elijah", "link": "https://stackoverflow.com/users/6530843/elijah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3821, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1475052042, "creation_date": 1475023347, "last_edit_date": 1475052042, "question_id": 39736343, "link": "https://stackoverflow.com/questions/39736343/how-to-separate-filter-english-text-from-chinese-in-excel", "title": "How to separate/filter English text from Chinese in Excel", "body": "<p>I am working on a project that includes multiples Excel files with cells containing English, Chinese, or both English and Chinese. </p>\n\n<p>I need to keep the rows that are completely in Chinese and put them first. Then, I need lines with both Chinese characters and English. And only then those that are in English only.</p>\n\n<p>I came across the following 3 functions that could help me mark the content accordingly, yet they do not seem to be working as expected, and I cannot figure out why.</p>\n\n<pre><code>Function ExtractChn(txt As String)\nDim i As Integer\nDim ChnTxt As String\nFor i = 1 To Len(txt)\n    If Asc(Mid(txt, i, 1)) &lt; 0 Then\n        ChnTxt = ChnTxt &amp; Mid(txt, i, 1)\n    End If\nNext i\nExtractChn = ChnTxt\nEnd Function\n\nFunction ExtractEng(txt As String)\nDim i As Integer\nDim EngTxt As String\nFor i = 1 To Len(txt)\n    If Asc(Mid(txt, i, 1)) &gt;= 0 Then\n        EngTxt = EngTxt &amp; Mid(txt, i, 1)\n    End If\nNext i\nExtractEng = EngTxt\nEnd Function\n\nFunction CheckTxt(txt)\nDim i As Integer\nDim Eng As Integer\nDim Chn As Integer\nChn = 0\nEng = 0\nFor i = 1 To Len(txt)\n    If Asc(Mid(txt, i, 1)) &gt; 0 Then\n        Eng = 1\n    Else:\n        Chn = 1\n    End If\nNext i\nIf Chn = 1 And Eng = 1 Then   'Contains Both Eng &amp; Chn\n    CheckTxt = \"BOTH\"\nElse:\n    If Chn = 1 And Eng = 0 Then    'Chn\n        CheckTxt = \"CHN\"\n    Else:\n        If Chn = 0 And Eng = 1 Then   'Eng\n            CheckTxt = \"ENG\"\n        End If\n    End If\nEnd If\nEnd Function\n</code></pre>\n\n<p>The person who created them even supplied a file demonstrating how the functions work. I am attaching the link to the file which has the arrangement as follows: </p>\n\n<pre><code>Text|English part of it|Chinese part of it|ExtractEng|ExtractChn|CheckTxt\n</code></pre>\n\n<p>According to the author's intentions, the <code>CheckTxt</code> result should display either <code>CH</code>, <code>ENG</code>, or <code>BOTH</code>. However, it is only displaying <code>ENG</code> at all times and I cannot figure why.</p>\n\n<p>Any ideas how to make it work? Unless there is an easier way to 'advance-filter' the content in Excel? Any help will be much appreciated.</p>\n\n<p><a href=\"https://a13d85c3-a-62cb3a1a-s-sites.googlegroups.com/site/exceltkk2/excel-tutorial/howtoseparateenglishandchineseword-vbafunctionasc/HowtoSeparateEnglishandChineseWord-VBAFunctionASC.xls?attachauth=ANoY7cqrghw6DmqtRoV2yy-vfRFZz66oEa1e3NNrR-_PdS8Fe61NRntZGQQMAbBuEwSw48p0iDNLd-9TEXSDR90HF2dTfb_MQjtVC0RgHab1cBX6npR4Ng7Yla9lF-OOz7GXQkgNCVZgSoG_RXe9muQEoIiE6SyRRgZ12IXiIChY9UqFhxF7f9DoET_98d_lo6rS_UAE6McZuaVBGVCtT72MT0xogEwFiERKWkjivUQM28_qHfbymrYqHEH5sl2qD7fTCSwSVpZjbRT4EkWepOpzp9tCG6JXgDhLP8xGo-u0Twdrg0ZPBORElaHiXy4cAQ8ARKxZq6dXKuchA3JrLNuBObiHc8lyvtj2xjrmMq-Uux6dwxEfW44%3D&amp;attredirects=0&amp;d=1\" rel=\"nofollow\" title=\"Test file\">Test Excel file from the developer</a></p>\n"}, {"tags": ["arrays", "excel", "vba", "size", "limit"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 4, "creation_date": 1475025505, "post_id": 39736261, "comment_id": 66771090, "body": "The limit is 65536 (2^16)."}, {"owner": {"reputation": 380, "user_id": 5423218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7b59b832166bdb7fb0e9f32d1b2555f?s=128&d=identicon&r=PG&f=1", "display_name": "AndyW", "link": "https://stackoverflow.com/users/5423218/andyw"}, "edited": false, "score": 1, "creation_date": 1475043411, "post_id": 39736261, "comment_id": 66776289, "body": "Excel has some issues. Technically if you have excel &gt;2010 and use a newer file format you can have a larger array size than 65536 however some functions have not been recoded to handle the larger arrays and still have an array size 65536 limit so it very much depends upon how you are manipulating the data."}], "owner": {"reputation": 21, "user_id": 6890729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f26b8108f02d953eaad5e3cdbcc465?s=128&d=identicon&r=PG&f=1", "display_name": "Saengard", "link": "https://stackoverflow.com/users/6890729/saengard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 917, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531244208, "creation_date": 1475022615, "last_edit_date": 1531244208, "question_id": 39736261, "link": "https://stackoverflow.com/questions/39736261/excel-vba-array-transpose-size-limit", "title": "Excel vba array transpose size limit", "body": "<p>I have a fairly straightforward sub that loads a 2d array via a series of loops.\n After loading the array with strings, I run a simple filter and load only the wanted columns into a new array of rows.\nAfterwards I transpose the array using a generic transpose function posted on this site in another question...</p>\n\n<p>The problem I'm having is my data set is something like:</p>\n\n<p>Array (27, 8000) \nI print this to a sheet ...range(rng) .resize.ubound(Array...\nBut nothing outputs. I reduce the array to (24,8000) and it works. \nThe research I've found gives me a conservative limit of 2^31-1 which is much higher than what I'm messing with. I think I'm running into a limit issue, but it doesn't make sense why. It's excel 2013 on a Windows 7 64 bit Hp desktop from a couple years ago. It shouldn't be a machine limit and excel limit shouldn't be an issue either... I'm flummoxed. If anyone could throw me a bone I'd appreciate it!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 3, "creation_date": 1475021587, "post_id": 39736133, "comment_id": 66770147, "body": "Do you mean a database or a table in Excel? I&#39;m pretty sure if it is all in Excel you don&#39;t need VBA. You just need some Excel formulae"}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1475024053, "post_id": 39736133, "comment_id": 66770749, "body": "Clarify your answer please. If not you&#39;ll tend to get down-voted and no-one will bother with your question."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1475042657, "last_edit_date": 1475042657, "creation_date": 1475042217, "answer_id": 39739061, "question_id": 39736133, "link": "https://stackoverflow.com/questions/39736133/find-cells-that-contain-keywords-in-excel-vba/39739061#39739061", "title": "find cells that contain keywords in excel VBA", "body": "<p>use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\">Autofilter()</a> method of <code>Range</code> object</p>\n\n<pre><code>Sub main()\n    With Worksheets(\"hammer\") '&lt;--| reference searched worksheet (change \"hammer\" to its actual name)\n        With .Range(\"A1\", .Cells(.Rows.Count, \"A\").End(xlUp)) '&lt;--| reference its column \"A\" cells from row 1 down to last non empty one (change \"A\"s to your actual searched column index)\n            .AutoFilter Field:=1, Criteria1:=\"*hammer*\" '&lt;--| filter on referenced column to get cell containing \"hammer\"\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy Destination:=Worksheets(\"different tab\").Range(\"A1\") '&lt;--| copy any filtered cell into \"different tab\" worksheet\n        End With\n        .AutoFilterMode = False '&lt;--| show all rows back\n    End With\nEnd Sub\n</code></pre>\n\n<p>it assumes the first cell of searched range (\"A1\" in this example) is a <em>header</em> cell, so that it won't be searched for \"*hammer\".</p>\n"}], "owner": {"reputation": 1, "user_id": 6890740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b88dbb00c33c85bff15034fdef959ec9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Fisher", "link": "https://stackoverflow.com/users/6890740/j-fisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1475042657, "creation_date": 1475021479, "question_id": 39736133, "link": "https://stackoverflow.com/questions/39736133/find-cells-that-contain-keywords-in-excel-vba", "title": "find cells that contain keywords in excel VBA", "body": "<p>I would like to write a macro that searches through a column in a database and returns, in a different tab, all the cells that contain a certain given keyword. In other words, I want to type in \"hammer\" and get a list of every cell that contains the word hammer, even if the word is in the middle of the value (for example, \"the builder bought a hammer yesterday\").</p>\n\n<p>I'm fairly new to VBA so I would like some help/input on what functions to use to do this. I've tried to use AdvancedFilter, however that only looks at the very beginning of each cell value. All feedback is welcome, thank you!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "edited": false, "score": 0, "creation_date": 1475027247, "post_id": 39735995, "comment_id": 66771506, "body": "Is Me.AreaCBDrop a numeric value? Is the field <code>LArea</code> a numeric field?"}, {"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "edited": false, "score": 0, "creation_date": 1475068037, "post_id": 39735995, "comment_id": 66792965, "body": "Neither is numeric.  They are both text."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1475106729, "post_id": 39758383, "comment_id": 66814619, "body": "Worked like a Champ.  Thank you so much."}], "tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": true, "score": 1, "last_activity_date": 1475100143, "creation_date": 1475100143, "answer_id": 39758383, "question_id": 39735995, "link": "https://stackoverflow.com/questions/39735995/opening-form-from-combo-box-in-another-form/39758383#39758383", "title": "Opening form from combo box in another form", "body": "<p>Your <code>WHERE</code> condition is expecting a text parameter, but you are not supplying the expected format, so it is asking for one.</p>\n\n<p>Surround your <code>Me.AreaCBDrop</code> with single quotes, like this:</p>\n\n<pre><code>If Not Me.NewRecord Then\nDoCmd.OpenForm \"AreaForm\", _\n    WhereCondition:=\"LArea='\" &amp; Me.AreaCBDrop &amp; \"'\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 39758383, "answer_count": 1, "score": 0, "last_activity_date": 1475661489, "creation_date": 1475020263, "last_edit_date": 1475661489, "question_id": 39735995, "link": "https://stackoverflow.com/questions/39735995/opening-form-from-combo-box-in-another-form", "title": "Opening form from combo box in another form", "body": "<p>I have a form called DisplayForm.  In that form is a combo box drop down that is at the top of column on the form where a label would usually go. I want to select an item from that drop down menu and use that bit of data to open another form. I have copied an example from the web, changed the names and can't get it to work. Here is the code;</p>\n\n<pre><code>If Not Me.NewRecord Then\nDoCmd.OpenForm \"AreaForm\", _\n    WhereCondition:=\"LArea=\" &amp; Me.AreaCBDrop\nEnd If\n</code></pre>\n\n<p>Area is the name of the field in the query that is the recordsource for the form, but when I run it, it opens a msgbox that wants me to enter a peramater value. I also don't understand what the IF is about. I have tried this with and without the if but get the same result. Me.AreaCBDrop has the correct value in it, but the where does not work.</p>\n\n<p>Thanks</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1475018101, "post_id": 39735693, "comment_id": 66769231, "body": "Please do some research before posting a question. Especially about how to ask good questions, and also check for similar questions. There are hundreds of macros here about inserting rows when a condition is met."}, {"owner": {"reputation": 27, "user_id": 5402276, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3bc958b4651b3a6d932bf17bfaa3e5b1?s=128&d=identicon&r=PG&f=1", "display_name": "D. Cruz", "link": "https://stackoverflow.com/users/5402276/d-cruz"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1475019767, "post_id": 39735693, "comment_id": 66769693, "body": "umm thanks I guess"}], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "edited": false, "score": 0, "creation_date": 1475043550, "post_id": 39735742, "comment_id": 66776369, "body": "Not first few characters but he can use text to rows delimited by &quot; &quot;."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1475018245, "creation_date": 1475018245, "answer_id": 39735742, "question_id": 39735693, "link": "https://stackoverflow.com/questions/39735693/excel-vba-insert-row-if-cells-match-first-characters/39735742#39735742", "title": "Excel VBA Insert row if cells match first characters", "body": "<p>Add a column that extracts the first few characters of the first column. Then create a pivot table with that new column in the rows and the other columns in the values area. No VBA required. </p>\n"}, {"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1475049222, "post_id": 39740293, "comment_id": 66779677, "body": "Whatever happened to &quot;this site is not a free code writing service&quot; or &quot;post the code you have a problem with&quot;? You are inviting people to not do any work, because you are doing it for them."}, {"owner": {"reputation": 27, "user_id": 5402276, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3bc958b4651b3a6d932bf17bfaa3e5b1?s=128&d=identicon&r=PG&f=1", "display_name": "D. Cruz", "link": "https://stackoverflow.com/users/5402276/d-cruz"}, "edited": false, "score": 0, "creation_date": 1475098663, "post_id": 39740293, "comment_id": 66812187, "body": "It worked! Thank you so much user3598756! I didn&#39;t post a code because I didn&#39;t even know where to begin and needed help/direction. I never expect someone to write a complete code. Instead I was expecting someone to give tips/help writing the code but I am really grateful for your help!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1475046345, "creation_date": 1475046345, "answer_id": 39740293, "question_id": 39735693, "link": "https://stackoverflow.com/questions/39735693/excel-vba-insert-row-if-cells-match-first-characters/39740293#39740293", "title": "Excel VBA Insert row if cells match first characters", "body": "<p>you may try the following (commented) code:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range, cell2 As Range\n\n    With Worksheets(\"experiment\").Range(\"A1\").CurrentRegion '&lt;--| reference data worksheet(change \"experiment\" to its actual name) cell \"A1\" contiguous range column \"A\"\n        .Sort key1:=Range(\"A1\"), order1:=xlAscending, Header:=xlYes '&lt;--| sort it by \"experiment\" column to have \"smaller\" names at the top\n        For Each cell In .Offset(1).Resize(.Rows.Count - 1, 1) '&lt;--| loop through its 1st column cells skipping header row\n            If cell.Value &lt;&gt; \"\" Then '&lt;--| if current cell isn't blank (also as a result of subsequent operations)\n                .AutoFilter Field:=1, Criteria1:=\"*\" &amp; cell.Value &amp; \"*\" '&lt;--| filter on referenced column to get cell \"containing\" current cell content\n                If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 2 Then '&lt;--| if more than 2 rows has been foun: header row gets always filtered so to have at least 2 rows to consolidate we must filter at least 3\n                    With .Offset(1).Resize(.Rows.Count - 1) '&lt;--| reference filtered rows skipping header row\n                        For Each cell2 In .Offset(, 1).Resize(, .Columns.Count - 1).SpecialCells(xlCellTypeVisible).Areas(1).Rows(1).Cells '&lt;--| loop through 1st filtered row cells skipping 1st column (\"experiment\")\n                            cell2.Value = WorksheetFunction.Subtotal(9, cell2.EntireColumn) '&lt;--| update their content to the sum of filtered cells in corresponding column\n                        Next cell2\n                        With .Resize(, 1).SpecialCells(xlCellTypeVisible) '&lt;--| reference filtered rows 1st column (\"experiment\") cells\n                            .Value = .Cells(1, 1) '&lt;--| have them share the same name\n                        End With\n                        .RemoveDuplicates Columns:=Array(1), Header:=xlNo '&lt;--| remove duplicates, thus leaving the 1st filtered row with totals\n                    End With\n                End If\n            End If\n        Next cell\n        .Parent.AutoFilterMode = False '&lt;--| show all rows back\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5402276, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3bc958b4651b3a6d932bf17bfaa3e5b1?s=128&d=identicon&r=PG&f=1", "display_name": "D. Cruz", "link": "https://stackoverflow.com/users/5402276/d-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 39740293, "answer_count": 2, "score": -1, "last_activity_date": 1475046345, "creation_date": 1475017830, "last_edit_date": 1475043049, "question_id": 39735693, "link": "https://stackoverflow.com/questions/39735693/excel-vba-insert-row-if-cells-match-first-characters", "title": "Excel VBA Insert row if cells match first characters", "body": "<p>So I have a large data set where I would like to combine rows depending if the information in the first column matches to a certain degree. I was wondering if there is a macro that could do this. Below I have included images of a similar simplified data set. I would assume the macro would create the new table in a new worksheet or insert a row below the existing data but I am not sure. Any help or tips on this problem would be very helpful.</p>\n\n<p>Sample dataset:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ULt9X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ULt9X.png\" alt=\"Sample Dataset\"></a></p>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Qu0Iq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qu0Iq.png\" alt=\"Output\"></a></p>\n"}, {"tags": ["xml", "vba", "edgar"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1475024266, "creation_date": 1475024266, "answer_id": 39736443, "question_id": 39735429, "link": "https://stackoverflow.com/questions/39735429/read-xml-using-vba-list-all-occurrences-of-a-tag-including-contextref/39736443#39736443", "title": "Read XML using VBA: List all occurrences of a tag including contextRef", "body": "<p>Consider using MSXML DOM's <a href=\"https://support.microsoft.com/en-us/kb/288913\" rel=\"nofollow\">XPath</a>, making sure to declare the namespace <code>us:gaap</code>. Below iterates by node index <code>[#]</code> of each <code>&lt;us-gaap:grossProfit&gt;</code> tag:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub XMLfromPPTExample()\nOn Error GoTo ErrHandle\n    Dim XDoc As MSXML2.DOMDocument\n    Dim objxmlnodexbrl As MSXML2.IXMLDOMNode\n    Dim grossProfitList As MSXML2.IXMLDOMNodeList\n    Dim XmlNamespaces As String\n    Dim row As Integer\n\n    Set XDoc = New MSXML2.DOMDocument\n    XDoc.async = False\n    XDoc.validateOnParse = False\n    XDoc.Load (\"https://www.sec.gov/Archives/edgar/data/936468/000119312516476010/lmt-20151231.xml\")\n\n    XmlNamespaces = \"xmlns:us-gaap='http://fasb.org/us-gaap/2015-01-31'\"\n    XDoc.setProperty \"SelectionNamespaces\", XmlNamespaces\n    XDoc.setProperty \"SelectionLanguage\", \"XPath\"\n\n    Set grossProfitList = XDoc.DocumentElement.SelectNodes(\"//us-gaap:GrossProfit\")\n\n    For row = 1 To grossProfitList.Length\n        Worksheets(\"Tabelle1\").Range(\"A\" &amp; row).Value = XDoc.DocumentElement.SelectNodes(\"//us-gaap:GrossProfit[\" &amp; row &amp; \"]\")(0).Text\n        Worksheets(\"Tabelle1\").Range(\"B\" &amp; row).Value = XDoc.DocumentElement.SelectNodes(\"//us-gaap:GrossProfit[\" &amp; row &amp; \"]/@contextRef\")(0).Text\n    Next row\n\n    Set grossProfitList = Nothing\n    Set XDoc = Nothing\n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>4187000000  eol_PE11373---1510-K0017_STD_365_20131231_0\n5255000000  eol_PE11373---1510-K0017_STD_365_20141231_0\n5200000000  eol_PE11373---1510-K0017_STD_365_20151231_0\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6890536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d1b4ff9c15d7773c5ca949715c057f?s=128&d=identicon&r=PG&f=1", "display_name": "PerseusSagittarius", "link": "https://stackoverflow.com/users/6890536/perseussagittarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475038613, "creation_date": 1475016020, "last_edit_date": 1475038613, "question_id": 39735429, "link": "https://stackoverflow.com/questions/39735429/read-xml-using-vba-list-all-occurrences-of-a-tag-including-contextref", "title": "Read XML using VBA: List all occurrences of a tag including contextRef", "body": "<p>I'm new to VBA and XML and would appreciate your help. I have the following code:</p>\n\n<pre><code>Option Explicit\nSub XMLfromPPTExample()\nDim XDoc As MSXML2.DOMDocument\nDim objxmlnodexbrl As MSXML2.IXMLDOMNode\nDim objXMLNodeDIIRSP As MSXML2.IXMLDOMNode\nSet XDoc = New MSXML2.DOMDocument\nXDoc.async = False\nXDoc.validateOnParse = False\nXDoc.Load(\"https://www.sec.gov/Archives/edgar/data/936468/000119312516476010/lmt-20151231.xml\")\nSet objxmlnodexbrl = XDoc.SelectSingleNode(\"xbrl\")\nSet objXMLNodeDIIRSP = objxmlnodexbrl.SelectSingleNode(\"us-gaap:GrossProfit\")\nWorksheets(\"Tabelle1\").Range(\"A1\").Value = objXMLNodeDIIRSP.Text\nEnd Sub\n</code></pre>\n\n<p>This accesses a specific XML-sheet on SEC's Edgar database and writes the value of a defined tag (\"us-gaap:GrossProfit\") into Excel field A1.</p>\n\n<p>However, it is possible that this tag occurs several times in this XML-file with different values. What I need is that each of these occurrences are printed into an excel table, including the value and the value of \"contextRef\".</p>\n\n<p>Could you please adapt my code so that this works? Thank you very much.</p>\n"}, {"tags": ["sql", "vba", "recordset"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1475017769, "post_id": 39735331, "comment_id": 66769134, "body": "You need to either assign or pass in as arguments the <i>Table</i> and <i>DNI</i> variables."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475018728, "post_id": 39735331, "comment_id": 66769408, "body": "See <a href=\"http://stackoverflow.com/documentation/vba/3578/working-with-ado/12354/creating-parameterized-commands#t=201609272324299867052\">Creating parameterized commands</a>."}, {"owner": {"reputation": 1, "user_id": 4104032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b214d453fdce9de90e1cd7d8a678af23?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/4104032/marcos"}, "edited": false, "score": 0, "creation_date": 1475157007, "post_id": 39735331, "comment_id": 66838666, "body": "Thanks! It&#180;s working now : :  Query = &quot;Select * from  &quot; &amp; Tabla &amp; &quot;  where DNI = &#39;&quot; &amp; DNI &amp; &quot;&#39;&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4104032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b214d453fdce9de90e1cd7d8a678af23?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/4104032/marcos"}, "is_accepted": true, "score": 0, "last_activity_date": 1475157195, "creation_date": 1475157195, "answer_id": 39772267, "question_id": 39735331, "link": "https://stackoverflow.com/questions/39735331/vba-rs-execute-parameter-query/39772267#39772267", "title": "Vba rs.execute (Parameter Query)", "body": "<p>Its Done... passing parameters to this Function works well :</p>\n\n<pre><code>Public Function Abrir_Recordset(Tabla As String, DNI As String) As ADODB.Recordset\n\nDim comm As ADODB.Command\n\nDim rs As ADODB.Recordset\n\nSet rs = New ADODB.Recordset\nrs.CursorType = adOpenStatic\nrs.LockType = adLockOptimistic\n\nQuery = \"Select * from  \" &amp; Tabla &amp; \"  where DNI = '\" &amp; DNI &amp; \"'\"\n\nAbrir_Conexion\n\n\nSet rs = conn.Execute(Query)\n\nSet Abrir_Recordset = rs\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4104032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b214d453fdce9de90e1cd7d8a678af23?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/4104032/marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 39772267, "answer_count": 1, "score": 0, "last_activity_date": 1475157195, "creation_date": 1475015482, "question_id": 39735331, "link": "https://stackoverflow.com/questions/39735331/vba-rs-execute-parameter-query", "title": "Vba rs.execute (Parameter Query)", "body": "<p>Please, could you tell me how is the sentence to execute a SQL Query using vba? (With parameters)\nI'm trying to do this :</p>\n\n<ul>\n<li><p>First prepare a sub to call the function Arir_Recordset:</p>\n\n<p>Public Sub Retriev_rs()</p>\n\n<pre><code>Dim Query As String\nQuery = \"SELECT * FROM  '\" &amp; Table &amp; \"'  WHERE DNI = '\" &amp; DNI &amp; \"'  \"\nDim rs2 As ADODB.Recordset\nSet rs2 = New ADODB.Recordset\n\n\nOpen_Connection---- Works well!\n\nSet rs2 = Abrir_Recordset(Query, \"PRODUCTOS_CLIENTESBCO\", \"00000098687\")\n\n\nEnd Sub\n</code></pre></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><p>The Function:</p>\n\n<p>Public Function Abrir_Recordset(Query As String, Table As String, DNI As String) As ADODB.Recordset</p>\n\n<pre><code>Dim comm As ADODB.Command\n\nDim rs As ADODB.Recordset\n\nSet rs = New ADODB.Recordset\nrs.CursorType = adOpenStatic\nrs.LockType = adLockOptimistic\n\nSet rs = conn.Execute(QUERY)\n\nSet Abrir_Recordset = rs\n\n\nEnd Function\n</code></pre></li>\n</ul>\n\n<hr>\n\n<ul>\n<li>Issue:</li>\n</ul>\n\n<p>It's not recognising the Query. It says : </p>\n\n<p>Incorrect sintax near \"</p>\n\n<p>It's reading: </p>\n\n<pre><code> - \"SELECT * FROM  ''  WHERE DNI = ''  \"\n</code></pre>\n\n<p>Of course... it isn't write well the Query. Could you help me ??</p>\n\n<p>Many thanks!!!</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 1999, "user_id": 4694757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOLpM.png?s=128&g=1", "display_name": "i_thamary", "link": "https://stackoverflow.com/users/4694757/i-thamary"}, "edited": false, "score": 0, "creation_date": 1475013697, "post_id": 39734957, "comment_id": 66767903, "body": "use the information given here <a href=\"http://stackoverflow.com/questions/20250070/creating-an-excel-macro-for-multiple-graphs-with-the-same-x-values-but-different\" title=\"creating an excel macro for multiple graphs with the same x values but different\">stackoverflow.com/questions/20250070/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6890438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f113423359d83f3468b2c810d1e16651?s=128&d=identicon&r=PG&f=1", "display_name": "user6890438", "link": "https://stackoverflow.com/users/6890438/user6890438"}, "is_accepted": false, "score": 0, "last_activity_date": 1475021963, "creation_date": 1475021963, "answer_id": 39736193, "question_id": 39734957, "link": "https://stackoverflow.com/questions/39734957/plot-a-graph-with-two-series-from-a-range-of-selected-data-in-excel-using-a-macr/39736193#39736193", "title": "Plot a graph with two series from a range of selected data in Excel using a macro", "body": "<p>You ranges are static because you have dollar signs in front of your R1C1 references. Try removing the dollar signs from you code.</p>\n\n<p>However there is a more dynamic way of doing this using a named range and a pivot table. A dynamic range will automatically shrink and grow as records are added or removed from the range. Define a new range (Formulas/Define Name) and set the \"refers to\" line to read something like \"=OFFSET(Sheet1!$A$1,0,0,COUNTA(Sheet1!$A:$A),7)\"</p>\n\n<p>Then create a pivot table with this range as its data source. Then create a pivot chart. Manually create these - but you only have to manually create once.</p>\n\n<p>Then you will need to enter some code on the worksheet double click event (right mouse click the worksheet tab and select 'view code' Enter the following code: </p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n'Double-click cell to update chart\n'You need to create a dynamic range and refer to that range as the pivottable data source\n'For this to work you need to create a pivot table and a pivot table chart\n\nIf Intersect(Target, Range(\"A:A\")) Is Nothing Then Exit Sub 'code will only run if values in col A are double clicked\n\nOn Error GoTo ErrorHandler\n\nDim Pt As PivotTable                                        'refer to pivottables as shorter text 'Pt'\nDim Fd As PivotField                                        'refer to pivottable fields as shorter text 'Fd'\nDim FilterChoice As String                                  'declare that a text string will be used as the filter choice\n\nSet Pt = ActiveSheet.PivotTables(\"PivotTable3\")         'tell this code where the pivottable is and what its called\nSet Fd = Pt.PivotFields(\"Gene Name\")                    'tell this code what pivottable field you are changing\nFilterChoice = CStr(ActiveCell)                         'tell this code that the pivottable filter is the text in the cell you double-click\n\n    With Pt                                             'these lines refresh the pivottable after you have double clicked\n    Fd.ClearAllFilters\n    Fd.CurrentPage = FilterChoice\n    Pt.RefreshTable\n    End With\n\nActiveSheet.ChartObjects(\"Gene_Chart\").Activate             'Sets the chart title. Name the chart as 'Gene_Chart' first\nActiveChart.SetElement (msoElementChartTitleAboveChart)\nActiveChart.charttitle.Text = CStr(ActiveCell)\n\nErrorExit:\nExit Sub\n\nErrorHandler:\n    msgbox \"Dont click on an empty cell\"\n\nActiveSheet.ChartObjects(\"Gene_Chart\").Activate             'Sets the chart title. Name the chart as 'Gene_Chart' first\nActiveChart.SetElement (msoElementChartTitleAboveChart)\nActiveChart.charttitle.Text = \"All\"\n\nResume ErrorExit\n\nEnd Sub\n</code></pre>\n\n<p>When you double click a cell in col A in on your table, the pivot value you double click will be transferred to the pivot table filter field and change the graph. The chart title will also change to show the value you double clicked.</p>\n\n<p>Let me know if you want me to mail you the excel example.</p>\n\n<p>Pete.</p>\n"}], "owner": {"reputation": 55, "user_id": 6890388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/043889877e776adeb73c033c7693efa5?s=128&d=identicon&r=PG&f=1", "display_name": "eggrandio", "link": "https://stackoverflow.com/users/6890388/eggrandio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 988, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475021963, "creation_date": 1475013381, "question_id": 39734957, "link": "https://stackoverflow.com/questions/39734957/plot-a-graph-with-two-series-from-a-range-of-selected-data-in-excel-using-a-macr", "title": "Plot a graph with two series from a range of selected data in Excel using a macro", "body": "<p>I work in a molecular biology laboratory and have obtained a huge datasheet with expression levels of genes in different conditions. I want to automate the process of plotting the different values for each gene. I have no idea of VBA and can only understand roughly the output of the \"record macro\" function.</p>\n\n<p>My data is arranged as follows (in one row): Gene name, expression in condition1, condition2... up to condition 6. What I want to do is: I want to select a row and after doing the macro, I want to have a plot with conditions 1-3 in one series and 4-6 in a the second series.</p>\n\n<p>When I select the first row and record a macro, I get this:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$4:$G$4\")\n    ActiveChart.FullSeriesCollection(1).Delete\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(1).Name = \"=Sheet1!$B$3\"\n    ActiveChart.FullSeriesCollection(1).Values = \"=Sheet1!$B$4:$D$4\"\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(2).Name = \"=Sheet1!$E$3\"\n    ActiveChart.FullSeriesCollection(2).Values = \"=Sheet1!$E$4:$G$4\"\n    ActiveChart.FullSeriesCollection(2).XValues = \"=Sheet1!$B$2:$D$2\"\n    ActiveChart.SetElement (msoElementChartTitleAboveChart)\n\nEnd Sub\n</code></pre>\n\n<p>This works for the first row, but when I run it on other row of data, I get the first plot as the source of values is fixed. What I would like to change is the fixed values in </p>\n\n<pre><code>ActiveChart.FullSeriesCollection(1).Values = \"=Sheet1!$B$4:$D$4\"\n</code></pre>\n\n<p>To the second to fourth values in my selected range. And the values in </p>\n\n<pre><code>ActiveChart.FullSeriesCollection(2).Values = \"=Sheet1!$E$4:$G$4\"\n</code></pre>\n\n<p>To the fifth to the seventh values in my selected row.</p>\n\n<p>In addition, if I could add as a title the value in the first cell of the row, it would be really helpful, but that's not my main concern.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1475014504, "post_id": 39734923, "comment_id": 66768164, "body": "Let me clarify, you want a button that when gets clicked shows a form with the combobox , and when a value of that cb its selected the code executes ?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475016399, "post_id": 39734923, "comment_id": 66768783, "body": "If your <code>Sub code1()</code> is not in the <code>Userform (Code)</code> window, you can get the value of the combobox by <code>UserForm1.ComboBox1.Value</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "edited": false, "score": 0, "creation_date": 1475016637, "post_id": 39734923, "comment_id": 66768844, "body": "@Tyeler - once the form is unloaded, the values won&#39;t be available any more"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1475018004, "post_id": 39734923, "comment_id": 66769194, "body": "@YowE3K Oh that first Sub..... I somehow didn&#39;t even read that.. you&#39;re right, I assumed too much lol.."}, {"owner": {"reputation": 39, "user_id": 4379602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5b6146448ffdde46055272440277e1?s=128&d=identicon&r=PG&f=1", "display_name": "mm90", "link": "https://stackoverflow.com/users/4379602/mm90"}, "reply_to_user": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 0, "creation_date": 1475039812, "post_id": 39734923, "comment_id": 66774722, "body": "@jsanchezs Exactly"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4379602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5b6146448ffdde46055272440277e1?s=128&d=identicon&r=PG&f=1", "display_name": "mm90", "link": "https://stackoverflow.com/users/4379602/mm90"}, "edited": false, "score": 0, "creation_date": 1475081468, "post_id": 39735521, "comment_id": 66802866, "body": "@ YowE3K It worked. BTW how do i format posts here so i can have a vba code in the greyed out field with colored fonts like you do?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 39, "user_id": 4379602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5b6146448ffdde46055272440277e1?s=128&d=identicon&r=PG&f=1", "display_name": "mm90", "link": "https://stackoverflow.com/users/4379602/mm90"}, "edited": false, "score": 0, "creation_date": 1475091399, "post_id": 39735521, "comment_id": 66808281, "body": "@mm90 - The easiest way to format code is to paste the code in, making sure that there is at least one blank line before and after it, then highlight the entire section and press Ctrl-K.  (It just shifts it to the right so that there are at least 4 spaces at the start of each line.  So the harder way is to just manually insert the 4 spaces.)  And to enclose small snippets (in comments etc) so that they look like <code>this</code> just put ` marks before and after them."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1475016576, "creation_date": 1475016576, "answer_id": 39735521, "question_id": 39734923, "link": "https://stackoverflow.com/questions/39734923/vba-excel-use-value-from-combobox-in-other-code/39735521#39735521", "title": "VBA excel - use value from combobox in other code", "body": "<p>In your UserForm1 code module have the code you currently set up, except get rid of the declaration of the variable <code>fruit</code>, i.e.</p>\n\n<pre><code>Option Explicit\nPrivate Sub ComboBox1_Click()\n    Unload UserForm1\nEnd Sub\nPrivate Sub ComboBox1_AfterUpdate()\n    fruit = ComboBox1.Value\nEnd Sub\nPrivate Sub Userform_Initialize()\n    Dim fruits As Variant\n    ReDim fruits(4)\n    fruits = Array(\"banana\", \"mango\", \"orange\", \"berry\")\n    ComboBox1.ColumnCount = 1\n    ComboBox1.List() = fruits\nEnd Sub\n</code></pre>\n\n<p>In your main code module (Module1?) include code such as:</p>\n\n<pre><code>Option Explicit\n\nPublic fruit As String\n\nSub code1()\n    UserForm1.Show\n    MsgBox \"You selected \" &amp; fruit\nEnd Sub\n\nSub Button1_Click()\n    code1\nEnd Sub\n</code></pre>\n\n<p>By declaring <code>fruit</code> in your code module (as <code>Public</code>), your userform will be able to update its value, and your macro will be able to read the value.</p>\n"}], "owner": {"reputation": 39, "user_id": 4379602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5b6146448ffdde46055272440277e1?s=128&d=identicon&r=PG&f=1", "display_name": "mm90", "link": "https://stackoverflow.com/users/4379602/mm90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4569, "favorite_count": 0, "accepted_answer_id": 39735521, "answer_count": 1, "score": -1, "last_activity_date": 1475016576, "creation_date": 1475013217, "question_id": 39734923, "link": "https://stackoverflow.com/questions/39734923/vba-excel-use-value-from-combobox-in-other-code", "title": "VBA excel - use value from combobox in other code", "body": "<p>So i have a macro <code>code1</code> that do stuff with the value selected by user. Currently the selection is made thanks to simple data validation (user can only select item from the list). After the selection is made, user presses <code>button1</code> and a <code>code1</code> macro is performed.</p>\n\n<p>Instead of data validation i would like the user to first press mentioned <code>button1</code> and then select an item from the <code>combobox1</code> list that appeard as <code>userform1</code>, and then use that value in code.</p>\n\n<p>I have found some simple coding for combobox and userform. This works by itself, but i dont know how to implement this into my <code>code1</code></p>\n\n<p>Here is the code i found for combobox and userform</p>\n\n<p><code>Private Sub ComboBox1_Click() \n    Unload UserForm1 \nEnd Sub \nPrivate Sub ComboBox1_AfterUpdate() \n    Dim fruit As String \n    fruit = ComboBox1.Value \n   End Sub \nPrivate Sub Userform_Initialize() \n    Dim fruits As Variant \n    ReDim fruits(4) \n    fruits = Array(\"banana\", \"mango\", \"orange\", \"berry\") \n    ComboBox1.ColumnCount = 1 \n    ComboBox1.List() = fruits \nEnd Sub\n</code></p>\n\n<p>My <code>code1</code> just takes the value from the cell with data validation and do stuff with it. Id like it to take the value from combobox instead. Putting the <code>ComboBox1.Value</code> or <code>fruit</code> instead of <code>worksheets(\"Sheet1\").range(\"a1\").value</code> in my <code>code1</code> doesnt help. </p>\n\n<p>I dont know how to merge those codes together.</p>\n\n<p>Can you help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1475016166, "post_id": 39734817, "comment_id": 66768713, "body": "None of the hundreds of existing posts with the same error message helped you? I know I&#39;ve seen this exact issue (with the same solution the answer here provides) many times. Please do some basic research before posting a new question here, which would include reading a large number of the search results you&#39;d get searching on the <b>exact</b> error message you included. There are 10 already mentioned to the right in the <b>Related</b> list ===&gt;&gt;&gt;, which the site suggested as potential duplicates when you were writing your post, without even needing to search."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1475014860, "post_id": 39734987, "comment_id": 66768281, "body": "Also that line sets <code>Target_Workbooks</code> to be a Worksheet object. Once it&#39;s changed to <code>Target_Workbook</code> it will error as &quot;Type Mismatch&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1475020832, "post_id": 39734987, "comment_id": 66769949, "body": "<code>Option Explicit</code>... just sayin&#39;"}], "tags": [], "owner": {"reputation": 46, "user_id": 6037243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9tAv2.png?s=128&g=1", "display_name": "Verity", "link": "https://stackoverflow.com/users/6037243/verity"}, "is_accepted": false, "score": 1, "last_activity_date": 1475013512, "creation_date": 1475013512, "answer_id": 39734987, "question_id": 39734817, "link": "https://stackoverflow.com/questions/39734817/object-variable-or-with-block-variable-not-set/39734987#39734987", "title": "Object Variable or With Block variable not set", "body": "<p>You have Set Target_Workbook<strong>s</strong> \n, remove the s.</p>\n"}], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475013512, "creation_date": 1475012720, "question_id": 39734817, "link": "https://stackoverflow.com/questions/39734817/object-variable-or-with-block-variable-not-set", "title": "Object Variable or With Block variable not set", "body": "<p><strong>OBJECTIVE</strong></p>\n\n<p>Business units submit monthly financial information to Corporate each month. Develop a VBA macro that will pull in financial data from multiple business units.</p>\n\n<p><strong>APPROACH</strong></p>\n\n<ol>\n<li>Create a MASTER workbook that consolidates each business unit's information. Make sure that each business unit is represented in the MASTER workbook (\"<code>Target_workbook</code>\") with their own tab (e.g \"1120\", \"1130\", \"1210\"; \"<code>businessUnit</code>\")</li>\n<li>Create an array from each of the business unit tabs (\"<code>arr</code>\")</li>\n<li>Use array information to find corresponding Monthly financial report (\"<code>Source_Workbook</code>\", \"<code>Source_Path</code>\")</li>\n<li>Copy and paste financial information into the MASTER workbook (\"<code>Target_workbook</code>\") and corresponding business unit's tab (<code>businessUnit</code>)</li>\n</ol>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>Sub getBusinessUnits()\n\n\nDim ws As Worksheet\nDim Target_Workbook As Workbook\nDim Source_Workbook As Workbook\nDim element As Variant\nDim col As New Collection\nDim Source_Path As String\nDim businessUnit As String\nDim businessName As String\n\n\n'Set up collection to identify Business Unit Tabs and convert into array\nFor Each ws In ThisWorkbook.Worksheets\n    If IsNumeric(ws.Name) Then\n        col.Add ws.Name\n        Dim arr As Variant\n    End If\nNext\narr = toArray(col) 'Collection converted into Array\n\n\n\n'Loop through worksheets in array, open relative workbook, and pull in relevant data\nFor i = LBound(arr, 1) To UBound(arr, 1)\n\n    'assign business unit information to variables.\n    'Define workbook where we will paste copied information (target_workbook)\n    businessUnit = ThisWorkbook.Sheets(arr(i)).Activate\n    Set Target_Workbooks = ThisWorkbook.Sheets(arr(i))\n    businessName = ActiveSheet.Cells(2, 2)\n\n    'Open up the corresponding business unit's financial report, copy data\n    Source_Path = ThisWorkbook.Path &amp; \"\\Business Unit Monthly Reporting Template_\" &amp; businessName &amp; \".xlsx\"\n    Set Source_Workbook = Workbooks.Open(Source_Path)\n    Source_Workbook.Sheets(\"Auth Expense Data Entry\").Range(\"A1:H150\").Copy\n\n    'Paste copied information from Source_Workbook into Target_workbook\n    Target_Workbook.Sheets(arr(i)).Range(\"A5\").PasteSpecial Paste:=xlPasteValues '!!!ERROR: \"Object Variable or With Block variable not set\" !!!!\n\n\n   'Clear cache, close source_workbook\n    Application.CutCopyMode = False\n    Source_Workbook.Close (False)\n  End\nNext\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>    'Function to convert collection into array\n    Function toArray(col As Collection)\n        Dim arr() As Variant\n        ReDim arr(1 To col.Count) As Variant\n        For i = 1 To col.Count\n            arr(i) = col(i)\n        Next\n        toArray = arr\n    End Function\n</code></pre>\n\n<p><strong>ISSUES</strong></p>\n\n<ol>\n<li>Error @ Line: <code>Target_Workbook.Sheets(arr(i)).Range(\"A5\").PasteSpecial Paste:=xlPasteValues</code>, \"Object Variable or With Block variable not set\". Why is this the case? <strong>Is it because the arr(i) is a variant/string?</strong></li>\n<li>Any other suggestions for code improvement?</li>\n</ol>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 238489, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fdadea3899d019c87ac2459e1be30bf3?s=128&d=identicon&r=PG", "display_name": "pnswdv", "link": "https://stackoverflow.com/users/238489/pnswdv"}, "edited": false, "score": 0, "creation_date": 1475073119, "post_id": 39736510, "comment_id": 66797115, "body": "Much less trivial than I expected!"}, {"owner": {"reputation": 171, "user_id": 238489, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fdadea3899d019c87ac2459e1be30bf3?s=128&d=identicon&r=PG", "display_name": "pnswdv", "link": "https://stackoverflow.com/users/238489/pnswdv"}, "edited": false, "score": 0, "creation_date": 1475073962, "post_id": 39736510, "comment_id": 66797758, "body": "I don&#39;t need to worry about the column break ambiguity you describe, however. The source document is guaranteed to have the format Language1 + ColumnBreak + Language2 + SectionBreak when viewed in draft mode."}], "tags": [], "owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "is_accepted": false, "score": 0, "last_activity_date": 1475024922, "creation_date": 1475024922, "answer_id": 39736510, "question_id": 39734688, "link": "https://stackoverflow.com/questions/39734688/selecting-text-from-a-specific-column-in-word-with-vba/39736510#39736510", "title": "Selecting text from a specific column in Word with VBA", "body": "<p>TextColums.Count is actually not specified by the number of Column Breaks. You can have 2 columns (i.e. TextColumns.Count = 2) without a single Column Break.</p>\n\n<p>If you for instance create a new document, fill it with random text by typing</p>\n\n<p><code>=Rand(100)</code></p>\n\n<p>and hit enter and select Two Columns from the Layout Tab. You will notice that you get two columns over 8 pages or so where none of the pages have Column Breaks.</p>\n\n<p>The Office Object Model does not provide with an option to automatically select a specific column on a specifice page within a section. If the document actually has Column Breaks you can use the Find option to find the Column Break and from there select the Range from the start of the page to the start of the Column Break character that you just found using the Find option. Not a trivial thing to do as you can see.</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 238489, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fdadea3899d019c87ac2459e1be30bf3?s=128&d=identicon&r=PG", "display_name": "pnswdv", "link": "https://stackoverflow.com/users/238489/pnswdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1475157594, "creation_date": 1475157594, "answer_id": 39772430, "question_id": 39734688, "link": "https://stackoverflow.com/questions/39734688/selecting-text-from-a-specific-column-in-word-with-vba/39772430#39772430", "title": "Selecting text from a specific column in Word with VBA", "body": "<p>Since the column break marker is represented by the ASCII value 14, all I had to do was look at each word in the section until I found the expected marker</p>\n\n<pre><code>Sub ExtractColumnText()\n'\n' On pages with no columns, the text is copied to both output files\n' On pages with two columns, the column1 text is copied to \"C:\\DocTemp\\Italian.doc\"\n'                            and column2 text is copied to \"C:\\DocTemp\\English.doc\"\n'\nDim DestFileNum1 As Long\nDim DestFileNum2 As Long\nDim strDestFile1 As String\nDim strDestFile2 As String\nDim strCol1 As String\nDim strCol2 As String\nDim i As Integer\n\nDim oSec As Section\nDim oRngCol1 As Range\nDim oRngCol2 As Range\nDim oRngWord As Range\n\nstrDestFile1 = \"C:\\DocTemp\\Italian.doc\" 'Location of external file\nDestFileNum1 = FreeFile()\nstrDestFile2 = \"C:\\DocTemp\\English.doc\" 'Location of external file\nDestFileNum2 = DestFileNum1 + 1\nOpen strDestFile1 For Output As DestFileNum1 \nOpen strDestFile2 For Output As DestFileNum2\n\nFor Each oSec In ActiveDocument.Sections\n    Set rngWorking = oSec.Range.Duplicate\n    Set oRngCol1 = rngWorking.Duplicate\n    oRngCol1.End = rngWorking.End - 1   ' exclude the page break\n    Set oRngCol2 = oRngCol1.Duplicate\n    If 2 &lt;= oSec.PageSetup.TextColumns.Count Then\n        'examine each word in the section until we switch columns\n        For Each rngWord In rngWorking.Words\n            ' 14 = column break marker\n            If 14 = AscW(rngWord.Text) Then             \n                oRngCol1.End = rngWord.Start\n                oRngCol2.Start = rngWord.End\n                GoTo Xloop\n            End If\n        Next rngWord\n    End If\nXloop:   \n    oRngCol1.Select\n    Print #DestFileNum1, oRngCol1.Text\n    oRngCol2.Select\n    Print #DestFileNum2, oRngCol2.Text\nNext oSec\nClose #DestFileNum1\nClose #DestFileNum2\nMsgBox \"Done!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 238489, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fdadea3899d019c87ac2459e1be30bf3?s=128&d=identicon&r=PG", "display_name": "pnswdv", "link": "https://stackoverflow.com/users/238489/pnswdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 887, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475157594, "creation_date": 1475012142, "last_edit_date": 1475025918, "question_id": 39734688, "link": "https://stackoverflow.com/questions/39734688/selecting-text-from-a-specific-column-in-word-with-vba", "title": "Selecting text from a specific column in Word with VBA", "body": "<p>I have a document which is separated by section breaks.\nWithin each section I may have zero or one column breaks.\nI want to extract the text from the first column of each section that contains 2 columns, like so:</p>\n\n<pre><code>For Each oSec In ActiveDocument.Sections\n    iSectionStart = oSec.Range.Start\n    iSectionEnd = oSec.Range.End\n    i = oSec.PageSetup.TextColumns.Count\n    If (2 = i) Then\n      ' Update the range to only contain the text in textcolumn 1\n      ' then select and copy it to a destination string\n    End If\n Next oSec\n</code></pre>\n\n<p>However, the TextColumns object does not seem to have a method for returning the column contents.</p>\n"}, {"tags": ["excel", "textbox", "listbox", "concatenation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "edited": false, "score": 0, "creation_date": 1475014091, "post_id": 39734885, "comment_id": 66768030, "body": "Omg, I spent two days looking for this! Thank you SO much !!! Big thank you to the community!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1475013057, "creation_date": 1475013057, "answer_id": 39734885, "question_id": 39734631, "link": "https://stackoverflow.com/questions/39734631/vba-concatenate-textbox-and-listbox/39734885#39734885", "title": "VBA concatenate TextBox and ListBox", "body": "<p>You could set either the <code>ListBox1.Bound</code> or <code>Listbox1.TextColumn</code> to 1 or you can use the <code>ListBox1.ListIndex</code> to lookup the value in the Listbox's List.</p>\n\n<pre><code>Private Sub ListBox1_Click()\n\n    Me.Caption = ListBox1.Value\n    TextBox1.Value = TextBox1.Value &amp; ListBox1.List(ListBox1.ListIndex, 1)\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/keUaw.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/keUaw.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 39734885, "answer_count": 1, "score": 1, "last_activity_date": 1475013057, "creation_date": 1475011898, "last_edit_date": 1531161705, "question_id": 39734631, "link": "https://stackoverflow.com/questions/39734631/vba-concatenate-textbox-and-listbox", "title": "VBA concatenate TextBox and ListBox", "body": "<p>I'm new to VBA and I'm wondering what is the best way to Concatenate the Value of the second Column in a ListBox with a TextBox that is filled out by the user?</p>\n\n<p>My code so far:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nWith ListBox1\n.ColumnCount = 2\n.ColumnHeads = False\n.ColumnWidths = \"30;15\"\n.MultiSelect = 0\n\nListBox1.AddItem \"AAA\"\nListBox1.AddItem \"BBB\"\nListBox1.AddItem \"CCC\"\nListBox1.AddItem \"DDD\"\nListBox1.List(0, 1) = 15\nListBox1.List(1, 1) = 19\nListBox1.List(2, 1) = 49\nListBox1.List(3, 1) = 45\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Now I have TextBox aka <code>DWG</code> where the user is typing in about 5 numbers or so.</p>\n\n<pre><code>Private Sub DWG_change\n    Dwg= \"Numbers\" &amp; ListBox.\"SecondColumnValue\"\nEnd Sub\n</code></pre>\n\n<p>Here is my userForm that I'm testing:\n<a href=\"https://i.stack.imgur.com/eOMaR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eOMaR.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "is_accepted": false, "score": 1, "last_activity_date": 1553887743, "last_edit_date": 1553887743, "creation_date": 1475012280, "answer_id": 39734720, "question_id": 39734590, "link": "https://stackoverflow.com/questions/39734590/counting-the-number-of-emails-in-an-outlook-drafts-folder/39734720#39734720", "title": "Counting the number of emails in an Outlook Drafts folder", "body": "<p>I was able to answer my own question. Firstly, I did not have the MS Outlook Object library clicked. Secondly, I modified my code to the following: </p>\n\n<pre><code>Dim objOutlook As Object, objNameSpace As Object, objFolder As Object\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objNameSpace = objOutlook.GetNamespace(\"MAPI\")\nSet objFolder = objNameSpace.GetDefaultFolder(olFolderDrafts)\n\nMsgBox objFolder.items.count\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1553887823, "post_id": 39803532, "comment_id": 97567819, "body": "This could well be the start of a good answer, but I wonder if it would benefit from some paragraph text to explain why it would help? The question author may have long gone, but new readers may find such modifications helpful."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1475301761, "creation_date": 1475301761, "answer_id": 39803532, "question_id": 39734590, "link": "https://stackoverflow.com/questions/39734590/counting-the-number-of-emails-in-an-outlook-drafts-folder/39803532#39803532", "title": "Counting the number of emails in an Outlook Drafts folder", "body": "<p>You could also do This</p>\n\n<pre><code>Option Explicit\nPublic Const olFolderInbox As Long = 6\nPublic Const olFolderDrafts As Long = 16\nPublic Const olFolderContacts As Long = 10\nPublic Const olFolderDeletedItems As Long = 3\n\nPublic Sub Count_MailItems()\n    Dim olApp As Object  ' Outlook.Application\n    Dim olNs As Object   ' Outlook.Namespace\n    Dim Folder As Object ' Outlook.MAPIFolder\n    Dim Items As Object  ' Outlook.Items\n    Dim Msg As String\n\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n\n'    Set Folder = olNs.Session.PickFolder\n    'or\n'    Set Folder = olApp.ActiveExplorer.CurrentFolder\n    'or\n    Set Folder = olNs.GetDefaultFolder(olFolderInbox)\n'                                      olFolderDrafts\n'                                      olFolderContacts\n'                                      olFolderDeletedItems\n\n    Set Items = Folder.Items\n\n    Msg = Items.Count &amp; \" Items in \" &amp; Folder.Name &amp; \" Folder\"\n\n    MsgBox (Msg)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592984403, "creation_date": 1475011692, "last_edit_date": 1592984403, "question_id": 39734590, "link": "https://stackoverflow.com/questions/39734590/counting-the-number-of-emails-in-an-outlook-drafts-folder", "title": "Counting the number of emails in an Outlook Drafts folder", "body": "<p>I am trying to count the number of emails in my Outlook \"Drafts\" folder from Excel VBA. </p>\n\n<p>I have not programmed using the Outlook object hierarchy so I am having some trouble. </p>\n\n<p>Below is one of the variations I've tried. </p>\n\n<pre><code>Dim objOutlook As Object\nSet objOutlook = CreateObject(\"Outlook.Application\")\n\nDim objNameSpace As Object\nSet objNameSpace = objOutlook.GetNamespace(\"MAPI\")\nSet items = objNameSpace.GetDefaultFolder(olFolderDrafts).items\n\nMsgBox items.count\n</code></pre>\n\n<p>When I run this code I receive the error:</p>\n\n<blockquote>\n  <p>Run-time error 5 Invalid procedure call or argument</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 11, "user_id": 6849791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992e8a64e2ac99c5e17ee4e92969b9e?s=128&d=identicon&r=PG&f=1", "display_name": "gp mn", "link": "https://stackoverflow.com/users/6849791/gp-mn"}, "edited": false, "score": 0, "creation_date": 1475078149, "post_id": 39739615, "comment_id": 66800687, "body": "@gpmn I am glad it helped :). Mark the answer as accepted please."}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 3, "last_activity_date": 1475044303, "creation_date": 1475044303, "answer_id": 39739615, "question_id": 39734224, "link": "https://stackoverflow.com/questions/39734224/click-button-without-id-on-vba-to-use-on-ie/39739615#39739615", "title": "click button without id on vba to use on IE", "body": "<p>The <code>tagx.Value</code> is always empty. Check Html-Button Value attribute information <a href=\"http://www.w3schools.com/tags/att_button_value.asp\" rel=\"nofollow\">here</a>.</p>\n\n<p>The buttons seems to have <code>Span</code> with text <em>Save</em> or <em>Cancel</em> inside of it so you could check for <code>tagx.innerText</code> to find the save button and then call <code>Click</code> method on it.</p>\n\n<pre><code>Set tags = ie.document.getElementsByTagName(\"button\")\nFor Each tagx In tags\n    If tagx.innerText = \"Save\" Then\n        tagx.Click\n        Exit For\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6849791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992e8a64e2ac99c5e17ee4e92969b9e?s=128&d=identicon&r=PG&f=1", "display_name": "gp mn", "link": "https://stackoverflow.com/users/6849791/gp-mn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4946, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475044303, "creation_date": 1475010023, "last_edit_date": 1531164843, "question_id": 39734224, "link": "https://stackoverflow.com/questions/39734224/click-button-without-id-on-vba-to-use-on-ie", "title": "click button without id on vba to use on IE", "body": "<p>I'm trying to made a click on a button that does not have an ID or a Name; I tried using tabs, but it didn't work, and I tried the following code, but it doesn't do anything:</p>\n\n<pre><code>Set tags = Ie.document.getElementsByTagName(\"button\")\nFor Each tagx In tags\n    If tagx.Value = \"Save\" Then\n        tagx.onclick\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>And here is the HTML markup:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div class=\"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\"&gt;\n  &lt;div class=\"ui-dialog-buttonset\"&gt;\n    &lt;button type=\"button\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\" role=\"button\" aria-disabled=\"false\"&gt;&lt;span class=\"ui-button-text\"&gt;Cancel&lt;/span&gt;&lt;/button&gt;\n    &lt;button type=\"button\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\" role=\"button\" aria-disabled=\"false\"&gt;&lt;span class=\"ui-button-text\"&gt;Save&lt;/span&gt;&lt;/button&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}]