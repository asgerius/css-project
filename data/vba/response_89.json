[{"tags": ["excel", "event-handling", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1474502443, "post_id": 39628217, "comment_id": 66561870, "body": "How is the other workbook being opened? Is your code opening it?  If Yes then you should include your code in the question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474503787, "post_id": 39628217, "comment_id": 66562204, "body": "...if No then you need to explain exactly what is going on."}, {"owner": {"reputation": 1, "user_id": 6861221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb90558d511b320033312be85bf4166c?s=128&d=identicon&r=PG&f=1", "display_name": "madmouse", "link": "https://stackoverflow.com/users/6861221/madmouse"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474505293, "post_id": 39628217, "comment_id": 66562478, "body": "Tim;  Thanks for the quick response.  The other workbook is being opened from an external application (SAP)  The user will run a listing in SAP and export it into a new excel workbook named &quot;worksheet in basis (1).xlsx.  unfortunatly, this is default and can not be changed.  When that workbook opens, I would like to be able to have the original workbook notice it and perform a routine to extract the data from the new workbook and paste it into a set sheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474508112, "post_id": 39628217, "comment_id": 66563033, "body": "Is the workbook with the code already open in Excel?  If yes then when the report opens does it open in the same instance as the one where your code is?"}, {"owner": {"reputation": 1, "user_id": 6861221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb90558d511b320033312be85bf4166c?s=128&d=identicon&r=PG&f=1", "display_name": "madmouse", "link": "https://stackoverflow.com/users/6861221/madmouse"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474509632, "post_id": 39628217, "comment_id": 66563385, "body": "Tim:  The workbook with the code is open in Excel.  A few routines have already been executed and it needs to wait for the new workbook with the extracted SAP data to open.  When the new workbook opens, it is in a new instance of Excel."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474526003, "post_id": 39628217, "comment_id": 66568357, "body": "It&#39;s not that simple to work across Excel instances, but it could be done.  Try this for starters:  <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/e3e99712-01a7-483e-bf0e-52bb1f94889c/how-to-use-accessibleobjectfromwindow-api-in-vba-to-get-excel-application-object-from-excel?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 5, "last_activity_date": 1474503983, "creation_date": 1474503983, "answer_id": 39628435, "question_id": 39628217, "link": "https://stackoverflow.com/questions/39628217/pause-execution-of-vba-script-until-another-specific-excel-workbook-opens/39628435#39628435", "title": "Pause execution of VBA script until another specific excel workbook opens?", "body": "<p><code>WithEvents</code> allows us to monitor ActiveX Events that are exposed to Automation.  Here I declare a variable <code>WithEvents</code> to monitor the <code>Excel.Application</code> <code>NewWorkbook</code> event.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FVTiZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FVTiZ.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nPrivate WithEvents ExcelApp As Excel.Application\n\nPrivate Sub ExcelApp_NewWorkbook(ByVal Wb As Workbook)\n    If Wb.Name = \"MyWorkbook.xlsm\" Then Call ProcessMyWorkbook\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Set ExcelApp = Application\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6861221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb90558d511b320033312be85bf4166c?s=128&d=identicon&r=PG&f=1", "display_name": "madmouse", "link": "https://stackoverflow.com/users/6861221/madmouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474626167, "creation_date": 1474502342, "last_edit_date": 1531161705, "question_id": 39628217, "link": "https://stackoverflow.com/questions/39628217/pause-execution-of-vba-script-until-another-specific-excel-workbook-opens", "title": "Pause execution of VBA script until another specific excel workbook opens?", "body": "<p>I would like to have a VBA script run in Excel and, at a certain point, pause until a specific workbook opens.  Then continue the script in the original workbook.  This because the original workbook needs to import data from the newly opened workbook, then close that new workbook after..  I assume that I should be using some sort of Windows event handler that watches for things like a file opening.<br>\nVersions in use are MS windows 10 and excel 2013</p>\n"}, {"tags": ["vba", "excel", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1474524942, "post_id": 39628348, "comment_id": 66567819, "body": "code works great with one exception, namely the month &quot;November&quot;. &quot;December&quot; is the last sheet in this workbook but by some reason the cell color doesn&#39;t change if I check the checkboxes in &quot;November&quot;... any thoughts on this?"}, {"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1474531103, "post_id": 39628348, "comment_id": 66571310, "body": "and another question: how did you make the &quot;TRUE&quot; or &quot;FALSE&quot; which appear after checking the checkbox unseen?"}, {"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1480245534, "post_id": 39628348, "comment_id": 68874501, "body": "this code works great for the first two months but sadly not for the other months... do you have any thoughts on this?"}, {"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1480978998, "post_id": 39628348, "comment_id": 69179494, "body": "Here is a link to the file. Please note that I annonimized names and titles but that should not stand in the way: <a href=\"https://drive.google.com/file/d/0B6v7lPApXN7mZjJjRWVvM3ZNdGc/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B6v7lPApXN7mZjJjRWVvM3ZNdGc/&hellip;</a>"}, {"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1482613294, "post_id": 39628348, "comment_id": 69837404, "body": "I found the solution. I made a mistake by copying the sheet multiple times. By this the checkboxes had the same names on each sheet. After I inserted manually each cell on each sheet (avioding multiple checkboxes with same name) it worked."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1482639445, "post_id": 39628348, "comment_id": 69840947, "body": "@user3185735 I must have been busy I forgot to debug it.  I am glad that you finally got it.  Take Care"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1474503306, "creation_date": 1474503306, "answer_id": 39628348, "question_id": 39627964, "link": "https://stackoverflow.com/questions/39627964/change-cell-color-of-cell-on-next-worksheet-if-checkbox-is-checked/39628348#39628348", "title": "Change cell color of cell on next worksheet if checkbox is checked", "body": "<p>Worksheets have a <code>.Next</code> method that references the next worksheet in the worksheets collection.  If the worksheet is the last worksheet in the collection it will return nothing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OOs40.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OOs40.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>Paste into a standard module</h2>\n\n<pre><code>Sub CheckedUnchecked()\n    Dim cb As CheckBox\n    With ActiveSheet\n        Set cb = .CheckBoxes(Application.Caller)\n        If Not cb Is Nothing Then\n            If .Next Is Nothing Then\n                Worksheets(\"January\").Range(cb.TopLeftCell.Address).Interior.ColorIndex = IIf(cb.Value = 1, 5, 3)\n            Else\n                .Next.Range(cb.TopLeftCell.Address).Interior.ColorIndex = IIf(cb.Value = 1, 5, 3)\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474561393, "post_id": 39634984, "comment_id": 66591900, "body": "@ThomasInzina, thanks for noticing the two digits month issue. I handled it (still) avoiding the use of <i>Date</i> functions to keep the &quot;promised&quot; feature of handling <i>&quot;any sheets name&quot;</i>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474572609, "post_id": 39634984, "comment_id": 66598095, "body": "@ThomasInzina, thanks. I <i>could</i> have used an array but I wouldn&#39;t to lessen the user input burden. While I don&#39;t get the &quot;Worksheets (Month(ActiveSheet.name &amp; &quot; 1&quot;)) &quot; thing"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474578618, "post_id": 39634984, "comment_id": 66601228, "body": "@ThomasInzina, still can&#39;t get what &quot;Month(ActiveSheet.name &amp; &quot; 1&quot;)&quot; is supposed to do. I&#39;m not by my PC but it seems to me it should evaluate to something like &quot;Month(&quot;January 1&quot;)&quot; that can&#39;t figure out. Furthermore if &quot;Month&quot; is a &#39;Date&#39; function than it&#39;d still defeat my purpose of allowing any sheets names (not only month names)."}, {"owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1480246756, "post_id": 39634984, "comment_id": 68874822, "body": "@user3598756 same as the code above... it works for the first and the second worksheet but for the rest it doesn&#39;t work. Do I need to paste the code in the VBA Module &quot;This Workbook&quot;? Or should I just paste it in a random module and it will work automatically?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1474561177, "last_edit_date": 1474561177, "creation_date": 1474535858, "answer_id": 39634984, "question_id": 39627964, "link": "https://stackoverflow.com/questions/39627964/change-cell-color-of-cell-on-next-worksheet-if-checkbox-is-checked/39634984#39634984", "title": "Change cell color of cell on next worksheet if checkbox is checked", "body": "<p><strong>edited</strong> NextMonthSht() to properly handle months <em>index</em> after 9 </p>\n\n<p>Here follows a slightly different solution to:</p>\n\n<ul>\n<li><p>allow for months sheets in any index order</p></li>\n<li><p>allow for any sheets name</p></li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>Sub CheckedUnchecked()\n    With ActiveSheet.CheckBoxes(Application.Caller)\n        NextMonthSht.Range(.TopLeftCell.Address).Interior.ColorIndex = IIf(.Value = 1, 5, 3)\n    End With\nEnd Sub\n\nFunction NextMonthSht() As Worksheet\n    Const MONTHS As String = \"January,February,March,April,Maj,June,July,August,September,October,November,December,January\"\n\n    Set NextMonthSht = Worksheets(Split(MONTHS, \",\")(Len(Left(MONTHS, InStr(MONTHS, ActiveSheet.name))) - Len(Replace(Left(MONTHS, InStr(MONTHS, ActiveSheet.name)), \",\", \"\")) + 1))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 39628348, "answer_count": 2, "score": 2, "last_activity_date": 1474561177, "creation_date": 1474500167, "last_edit_date": 1474503229, "question_id": 39627964, "link": "https://stackoverflow.com/questions/39627964/change-cell-color-of-cell-on-next-worksheet-if-checkbox-is-checked", "title": "Change cell color of cell on next worksheet if checkbox is checked", "body": "<p>I have an excel document with sheets representing information for each month. These sheets contain lists of members. On each sheet there are multiple checkboxes (about 250 per sheet). I would like to do the following. </p>\n\n<p>Lets take months <code>September</code> and <code>October</code> as an example. if I check a checkbox on the <code>September</code>-sheet then the color of the same cell the checkbox is located (ex. <code>D23</code>) on the next sheet (in this case it would be <code>\"October\"</code>) should change to blue. If the same checkbox is being unchecked (even for example in the future) then the cell should turn red.</p>\n\n<ol>\n<li>check checkbox on <code>'September'!D:23</code></li>\n<li>color on cell <code>D23</code> on the next sheet <code>October</code> turns blue</li>\n<li>uncheck checkbox on <code>'September'!D:23</code></li>\n<li>color on cell <code>D23</code> on the next sheet <code>October</code> turns red</li>\n</ol>\n\n<p>My way of solving the problem: I have written a <code>Sub</code> which, when a checkbox is created, it links the checkbox to the cell it was placed on (for example <code>D23</code>) so that I can know which cell needs to change when checked/unchecked on the next sheet:</p>\n\n<pre><code>.LinkedCell = Selection.Address(False, False)\n</code></pre>\n\n<p>This is what I've tried so far but with no success:</p>\n\n<pre><code>Sub SetMacro()\n  Dim cb\n  For Each cb In ActiveSheet.CheckBoxes\n    If cb.OnAction = \"\" Then cb.OnAction = \"CheckedUnchecked\"\n  Next cb\nEnd Sub\n</code></pre>\n\n<p>and here is the code for the check/uncheck:</p>\n\n<pre><code>Sub CheckedUnchecked()\nWith ActiveSheet.Range(ActiveSheet.CheckBoxes(Application.Caller).LinkedCell)\n    If .Value Then\n        Worksheet(ActiveSheet.Index + 1).Range(ActiveSheet.CheckBoxes(Application.Caller).LinkedCell).Interior.ColorIndex = 5\n    Else\n    Worksheet(ActiveSheet.Index + 1).Range(ActiveSheet.CheckBoxes(Application.Caller).LinkedCell).Interior.ColorIndex = 3\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Any thoughts on this matter?</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474498814, "post_id": 39627670, "comment_id": 66561079, "body": "Is the ListBox on a UserForm, or on the worksheet itself?"}, {"owner": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474507922, "post_id": 39627670, "comment_id": 66562992, "body": "The listbox is on a userform."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "edited": false, "score": 0, "creation_date": 1474507097, "post_id": 39627808, "comment_id": 66562806, "body": "OK, I think I should have known that one. However, now I get &quot;Could not set the Selected Property. Invalid Property value&quot;."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "edited": false, "score": 0, "creation_date": 1474514651, "post_id": 39627808, "comment_id": 66564610, "body": "@colinsinclair - Do you have MultiSelect set to true?"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 1, "last_activity_date": 1474499062, "creation_date": 1474499062, "answer_id": 39627808, "question_id": 39627670, "link": "https://stackoverflow.com/questions/39627670/adding-selection-property-to-listboxvba/39627808#39627808", "title": "Adding Selection Property to ListboxVBA", "body": "<p><code>Set</code> is used to assign objects. When you want to assign a non-object value like a Boolean or an Integer, you don't use <code>Set</code></p>\n\n<p>Try changing:</p>\n\n<pre><code>Set FRM_StorageOptions.StorageList.Selected(i - 1) = True\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>FRM_StorageOptions.StorageList.Selected(i - 1) = True\n</code></pre>\n\n<p>and do the same for the other two lines that use <code>Set</code></p>\n\n<p>Even though the Listbox itself is an object, the properties you are assigning are not objects and thus <code>Set</code> is not used</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "edited": false, "score": 0, "creation_date": 1474507728, "post_id": 39628594, "comment_id": 66562946, "body": "That ended up just adding all the items, with none of them selected. Thanks for the help though!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "edited": false, "score": 0, "creation_date": 1474508318, "post_id": 39628594, "comment_id": 66563077, "body": "I think that you might have the settings wrong for the listbox.  Here is my test stub <a href=\"https://www.dropbox.com/s/5yl69y0eho0p7in/test-select-list.xlsm?dl=0\" rel=\"nofollow noreferrer\">Download</a>"}, {"owner": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "edited": false, "score": 0, "creation_date": 1474509922, "post_id": 39628594, "comment_id": 66563446, "body": "That worked! Thanks a lot! Follow up question, what setting can I change so it doesn&#39;t highlight the entire list item, but just checks the box next to it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "edited": false, "score": 0, "creation_date": 1474509980, "post_id": 39628594, "comment_id": 66563461, "body": "I&#39;m happy that I could help :-)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1474505377, "creation_date": 1474505377, "answer_id": 39628594, "question_id": 39627670, "link": "https://stackoverflow.com/questions/39627670/adding-selection-property-to-listboxvba/39628594#39628594", "title": "Adding Selection Property to ListboxVBA", "body": "<p><code>ws.Range(Cells(2, 2), Cells(Count, 2))</code> will fail if <code>ws &lt;&gt; ActiveSheet</code>.  That is because the cells inside a range have to be be qualified to the same worksheet as the range.</p>\n\n<p>It appears that you want to add values from column A and check column B to see if they should be selected.  You could is adding from column B and checking column B.</p>\n\n<pre>\n\n    Item    Include?\n    TaskA         1 \n    TaskB         0 \n    TaskC         1\n\n</pre>\n\n<h2>Here is my best guess to what you what to accomplish.</h2>\n\n<pre><code>With FRM_StorageOptions.StorageList\n    For Each RngTask In ws.Range(\"A2\", \"A\" &amp; Count)\n\n        .AddItem RngTask.Value\n\n        .Selected(.ListCount - 1) = RngTask.Offset(0, 1) = 1\n\n    Next RngTask\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3965027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0f96f5d96f25e859693c479b66088882?s=128&d=identicon&r=PG&f=1", "display_name": "colin sinclair", "link": "https://stackoverflow.com/users/3965027/colin-sinclair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39628594, "answer_count": 2, "score": 0, "last_activity_date": 1474507830, "creation_date": 1474498082, "last_edit_date": 1474507830, "question_id": 39627670, "link": "https://stackoverflow.com/questions/39627670/adding-selection-property-to-listboxvba", "title": "Adding Selection Property to ListboxVBA", "body": "<p>I'm trying to populate a Listbox from a Worksheet, and would like to predetermine which list items already have a Check Box. I've found ways to determine which items in a listbox are checked, but no the other way around. I have the code to run through my list and insert each item within my range, but cannot find a way to assign the selected property. My worksheet will have each item to add and a 1 or 0 as to whether its selected. </p>\n\n<p>Worksheet;</p>\n\n<pre><code>    Item   Include?\n\n    TaskA   1 \n    TaskB   0 \n    TaskC   1\n</code></pre>\n\n<p>I would like to have a selected mark next to everything with a 1, and not include one for everything with a 0. </p>\n\n<p>Here's my current attempt where I attempt a loop(i) that looks up in the table next to the field it inserts:</p>\n\n<pre><code>For Each RngTask In ws.Range(Cells(2, 2), Cells(Count, 2))\n    FRM_StorageOptions.StorageList.AddItem RngTask.Value\n    If ws.Cells(i, 2) = 1 Then\n        FRM_StorageOptions.StorageList.Selected(i - 1) = True\n    Else\n        FRM_StorageOptions.StorageList.Selected(i - 1) = False\n    End If\n    i = i + 1\nNext RngTask\n</code></pre>\n\n<p>However it wont allow me to assign this property and returns \"Could not set the selected property. Invalid Property value \". Adding to the list works fine without my attempt to add the selected value. </p>\n\n<p>Any help is appreciated. </p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474496120, "post_id": 39627375, "comment_id": 66560320, "body": "What isn&#39;t working?  Do you get an error? What is in <code>Range(&quot;B6&quot;)</code>?"}, {"owner": {"reputation": 541, "user_id": 5416228, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e452d36e47fb54073d9a725d37a1ab44?s=128&d=identicon&r=PG&f=1", "display_name": "Rods2292", "link": "https://stackoverflow.com/users/5416228/rods2292"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474496344, "post_id": 39627375, "comment_id": 66560392, "body": "I get an error which highlights &quot;Sheets(&quot;My_sheet&quot;).Select&quot; part of this macro and I can&#39;t save the worksheet. <code>Range(&quot;B6&quot;)</code> it&#39;s a cell where is written a name. This name needs to be the name of the saved file."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1474496417, "post_id": 39627375, "comment_id": 66560421, "body": "I&#39;m assuming you have a sheet named &quot;My_sheet&quot;? What is the error?"}], "answers": [{"tags": [], "owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "is_accepted": true, "score": 0, "last_activity_date": 1474534819, "creation_date": 1474534819, "answer_id": 39634596, "question_id": 39627375, "link": "https://stackoverflow.com/questions/39627375/excel-macro-which-saves-a-worksheet/39634596#39634596", "title": "Excel Macro which saves a worksheet", "body": "<p>it seems to work fine as long as the sheet name is set as \"My_Sheet\", folder exist and file name is correct.\nYou can try this to check if they are OK before saving:</p>\n\n<pre><code>Sub SaveMe()\nDim filename As String\n'check if directory exist\nIf Dir(\"C:\\my_file\", vbDirectory) = \"\" Then\n    'if not ask if it should be created and continued\n    rspCreate = MsgBox(\"Directory doesn't exist, do you wish to create it and continue?\", vbYesNo)\n    If rspCreate = vbYes Then\n        'create dir and carry on\n        MkDir \"C:\\my_file\"\n    ElseIf rspCreate = vbNo Then\n        'no selected, stop execution\n        Exit Sub\n    End If\nEnd If\n\nfilename = Range(\"B6\")\nSheets(\"My_sheet\").Select\nChDir \"C:\\my_file\"\n'check if file name is valid\nIf FileNameValid(filename) Then\nActiveWorkbook.SaveAs filename:=Range(\"B6\"), FileFormat:=xlOpenXMLWorkbookMacroEnabled, _\n    Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False, _\n    CreateBackup:=False\nElse\n    MsgBox \"Invalid file name, file not saved\"\nEnd If\nSheets(\"My_sheet\").Select\nEnd Sub\n\n\n'check if vali file name is used in cell\nFunction FileNameValid(sFileName As String) As Boolean\nDim notAllowed As Variant\nDim i As Long\nDim result As Boolean\n'list of forbidden characters\nnotAllowed = Array(\"/\", \"\\\", \":\", \"*\", \"?\", \"&amp;lt; \", \"&gt;\", \"|\", \"\"\"\")\n'Initial result = OK\nresult = True\nFor i = LBound(notAllowed) To UBound(notAllowed)\n    If InStr(1, sFileName, notAllowed(i)) &gt; 0 Then\n    'forbidden character used\n        result = False\n        Exit Function\n    End If\nNext i\nFileNameValid = result\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 5416228, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e452d36e47fb54073d9a725d37a1ab44?s=128&d=identicon&r=PG&f=1", "display_name": "Rods2292", "link": "https://stackoverflow.com/users/5416228/rods2292"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 39634596, "answer_count": 1, "score": 1, "last_activity_date": 1474539860, "creation_date": 1474496029, "last_edit_date": 1474499729, "question_id": 39627375, "link": "https://stackoverflow.com/questions/39627375/excel-macro-which-saves-a-worksheet", "title": "Excel Macro which saves a worksheet", "body": "<p>I'm totally new to Microsoft VBA and I'm getting trouble to fix an Excel macro.</p>\n\n<p>The intention of this macro is that, when pressing a button, it automatically saves the active worksheet on a file but it is not working and I don't know why.</p>\n\n<p>It seems correct to me.</p>\n\n<pre><code>Sub Save()\n'\n' Save Macro\n'\nSheets(\"My_sheet\").Select\n    ChDir \"C:\\my_file\"\n    ActiveWorkbook.SaveAs Filename:=Range(\"B6\"), FileFormat:=xlOpenXMLWorkbookMacroEnabled, _\n        Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False, _\n        CreateBackup:=False\n    Sheets(\"My_sheet\").Select\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474493453, "post_id": 39626869, "comment_id": 66559221, "body": "Read, learn, and love: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using <code>.Select</code>/<code>.Activate</code></a>. :D"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1474493579, "post_id": 39626869, "comment_id": 66559278, "body": "The syntax is <code>Workbooks(&quot;Master List.xlsm&quot;).Sheets(&quot;Audit&quot;).Cells(1,1)</code> to modify Cell <code>A1</code>. You can also use <code>Workbooks(&quot;Master List.xlsm&quot;).Sheets(&quot;Audit&quot;).Range(&quot;A1&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6557019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a6cf9e0b2409888e3a2b433eb68069?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6557019/victoria"}, "edited": false, "score": 0, "creation_date": 1474494326, "post_id": 39627020, "comment_id": 66559614, "body": "ugh that was so simple I hate myself for not getting it lol. Thank you very much!"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 1, "last_activity_date": 1474494336, "last_edit_date": 1474494336, "creation_date": 1474494116, "answer_id": 39627020, "question_id": 39626869, "link": "https://stackoverflow.com/questions/39626869/how-do-i-reference-cells-on-a-sheet-without-activating-it/39627020#39627020", "title": "How do I reference cells on a sheet without activating it?", "body": "<p>To take your existing code snippet:</p>\n\n<pre><code>If Dir(File1) = \"\" Then\n    Workbooks(\"Master List.xlsm\").Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File1\nEnd If\n</code></pre>\n\n<p>As a rule of thumb, you can remove the trailing <code>.Activate</code> and the leading <code>ActiveSheet</code>/<code>ActiveCell</code> statements, and merge the lines:</p>\n\n<pre><code>If Dir(File1) = \"\" Then\n    Workbooks(\"Master List.xlsm\").Worksheets(\"Audit\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Value = File1\nEnd If\n</code></pre>\n\n<p>But, it's only a rule of thumb. Notice for example, the use of <code>Rows.Count</code>. That is relative to the active sheet, so it won't work without further editing.</p>\n\n<pre><code>If Dir(File1) = \"\" Then\n    With Workbooks(\"Master List.xlsm\").Worksheets(\"Audit\")\n      .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = File1\n    End With\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6557019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a6cf9e0b2409888e3a2b433eb68069?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6557019/victoria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 39627020, "answer_count": 1, "score": 1, "last_activity_date": 1474494336, "creation_date": 1474493374, "question_id": 39626869, "link": "https://stackoverflow.com/questions/39626869/how-do-i-reference-cells-on-a-sheet-without-activating-it", "title": "How do I reference cells on a sheet without activating it?", "body": "<p>So I'm running an audit on a set of digital files but I think the way I wrote is pretty convoluted so maybe someone can help me...</p>\n\n<p>What I can't figure out is why activesheet.cells is working fine, but when I try to reference the cells with Workbooks(\"Master List\").worksheets(\"Master Shipped\").cells it gives me an error. I've tried it with the full file location, I've tried it with worksheets.cells, I've tried it with sheets.cells, I've tried making the worksheet a variable, and I can't get it to work.</p>\n\n<p>It does work at the top where I'm naming the variables, but it doesn't work in my if statements which is where I want it work because I don't want to have to activate the sheet 10 times each loop.</p>\n\n<pre><code>Application.ScreenUpdating = False\nLR = Cells(Rows.Count, 2).End(xlUp).Row\nDim AuditSheet As Worksheet, Mastersheet As Worksheet\nSet AuditSheet = ThisWorkbook.Sheets(\"Audit\")\nSet Mastersheet = ThisWorkbook.Sheets(\"Master Shipped\")\n\nFor r = 3 To LR\n   FpathBOL = \"U:\\Warehouse Associate\\Shipped Orders 2016\\Bill of Lading\\\"\n   fnamebol = Mastersheet.Cells(r, 21).Text\n   FNamePOD = Left(Mastersheet.Cells(r, 21).Text, (Len(Mastersheet.Cells(r, 21)) - 8))\n   FpathFile = \"V:\\LVA Files\\\" &amp; Mastersheet.Cells(r, 4).Value &amp; \"\\Line \" &amp; Mastersheet.Cells(r, 10).Value &amp; \"\\\"\n   FnameFile = Mastersheet.Cells(r, 4).Value &amp; \"-\"\n   BOL = FpathBOL &amp; \"\\\" &amp; fnamebol &amp; \".pdf\"\n   POD = FpathBOL &amp; FNamePOD &amp; \"POD.pdf\"\n   File1 = FpathFile &amp; FnameFile &amp; \"PO.pdf\"\n   File2 = FpathFile &amp; FnameFile &amp; \"EIC PO.pdf\"\n   File3 = FpathFile &amp; FnameFile &amp; \"EDI 855.pdf\"\n   File4 = FpathFile &amp; FnameFile &amp; \"EDI 870.pdf\"\n   File5 = FpathFile &amp; FnameFile &amp; \"VENDOR INVOICE.pdf\"\n   File6 = FpathFile &amp; FnameFile &amp; \"EIC INVOICE.pdf\"\n   File7 = FpathFile &amp; FnameFile &amp; \"PCGR.pdf\"\n   File8 = FpathFile &amp; FnameFile &amp; \"PL.pdf\"\n   File9 = FpathFile &amp; FnameFile &amp; \"EDI.pdf\"\nIf Dir(File1) = \"\" Then\n    Workbooks(\"Master List.xlsm\").Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File1\nEnd If\nIf Dir(File2) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File2\nEnd If\n\nIf Dir(File3) = \"\" And Dir(File9) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File3\nEnd If\nIf Dir(File4) = \"\" And Dir(File9) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File4\nEnd If\nIf Dir(File5) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File5\nEnd If\nIf Dir(File6) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File6\nEnd If\nIf Dir(File7) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File7\nEnd If\nIf Dir(File8) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = File8\nEnd If\nIf Dir(BOL) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = FnameFile &amp; BOL\nEnd If\nIf Dir(POD) = \"\" Then\n    Worksheets(\"Audit\").Activate\n    ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Activate\n    ActiveCell.Value = FnameFile &amp; POD\nEnd If\nNext r\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1474491918, "post_id": 39626409, "comment_id": 66558455, "body": "I assume you have cells A6:E66 formatted with commas in Excel, and you want it to continue to be formatted that way while in Excel - you just don&#39;t want it formatted that way in the email?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1474492318, "post_id": 39626409, "comment_id": 66558686, "body": "I just tested <a href=\"https://msdn.microsoft.com/en-us/library/ff519602(v=office.11).aspx\" rel=\"nofollow noreferrer\">RangetoHTML</a> and @YowE3K is correct.  <code>RangetoHTML</code> accurately mimics the number format of the range."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474492376, "post_id": 39626409, "comment_id": 66558711, "body": "@ThomasInzina - Ron de Bruin will be wondering why he is getting so many hits on his website!  (I just tested it too.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1474492551, "post_id": 39626409, "comment_id": 66558795, "body": "Lol..I didn&#39;t want to overload his site so I got his code from MSDN OfficeTalk."}, {"owner": {"reputation": 1, "user_id": 6860714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce9f334fa6d1ffc5aa659cf35eec67f?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6860714/leo"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474645393, "post_id": 39626409, "comment_id": 66631086, "body": "@YowE3K no I have not applied a comma formatting in those cells. I have tried to keep it as text, number, general and custom formatting however the issue still persists. Whatever format I keep it in, the comma still appears in the email on outlook. Did you try with 6 digit numbers when you were testing it? Also I have an option compare text in our Macro. Does that make a difference?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474657083, "post_id": 39626409, "comment_id": 66637145, "body": "(a) I tested with about 8 digits, formatted with commas, formatted with commas and 2 decimal places, formatted as currency, formatted as accounting, formatted as General.  (b) When your code runs, what is the value of <code>d</code> in your code when the cell is written to?  What data type is <code>d</code>? (As a Variant, it could be holding a String, or a Double, or a Currency, or an Integer, etc.)  How is the number displayed in Excel immediately after the cell is written to?"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1474493170, "creation_date": 1474493170, "answer_id": 39626825, "question_id": 39626409, "link": "https://stackoverflow.com/questions/39626409/vba-to-outlook-issue-dont-want-number-with-comma/39626825#39626825", "title": "VBA to Outlook Issue - Don&#39;t want Number with Comma", "body": "<p>If you need to have the cells formatted with commas in Excel, but want to use General format for column D when placing it in the email, you could try using </p>\n\n<pre><code>dim a , b, c, d, e as integer  ' Note: This command is only declaring e to be integer\n                               '       a, b, c and d are being declared as Variant\nDim oldFormat As String\n\nActiveSheet.Range(\"A6\").Value = a\nActiveSheet.Range(\"B6\").Value = b\nActiveSheet.Range(\"C6\").Value = c\nActiveSheet.Range(\"D6\").Value = d\nActiveSheet.Range(\"E6\").Value = e\n\nSet msg_range = ActiveSheet.Range(\"A1\", \"E66\")\n\noldFormat = ActiveSheet.Range(\"D1\").NumberFormat\nActiveSheet.Range(\"D1:D66\").NumberFormat = \"General\"\n\nSet MItem = OutlookApp.CreateItem(0)\nWith MItem\n    .To = toEmails\n    .CC = ccEmails\n    .Subject = email_subject\n    .HTMLBody = RangetoHTML(msg_range) &amp; \"&lt;IMG SRC=\"\"signatures.png\"\"&gt;\"\n    .Display\nEnd With\n\nActiveSheet.Range(\"D1:D66\").NumberFormat = oldFormat\n</code></pre>\n\n<p>Note:  This will set all cells in D1:D66 back to the format that existed in D1 at the start of the macro.  If various cells had different formats, the code will need to be a bit more complicated.</p>\n"}], "owner": {"reputation": 1, "user_id": 6860714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce9f334fa6d1ffc5aa659cf35eec67f?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6860714/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474493170, "creation_date": 1474491246, "question_id": 39626409, "link": "https://stackoverflow.com/questions/39626409/vba-to-outlook-issue-dont-want-number-with-comma", "title": "VBA to Outlook Issue - Don&#39;t want Number with Comma", "body": "<p>I have a problem with generating Outlook emails through VBA. The problem is that when the VBA exports information from Excel sheet to Outlook, the numbers on Excel sheet will always be translated into numbers with commas, rather than their original formatting in Excel. Please see the codes below. I need to get rid of comma in one cells in column D. Ex. if d is 123456, in Outlook, it will show 123,456 but i don't want the comma.</p>\n\n<p>Thanks!</p>\n\n<pre><code>                    dim a , b, c, d, e as integer\n\n                    ActiveSheet.Range(\"A6\").Value = a\n                    ActiveSheet.Range(\"B6\").Value = b\n                    ActiveSheet.Range(\"C6\").Value = c\n                    ActiveSheet.Range(\"D6\").Value = d\n                    ActiveSheet.Range(\"E6\").Value = e\n\n                    Set msg_range = ActiveSheet.Range(\"A1\", \"E66\")\n                    Set MItem = OutlookApp.CreateItem(0)\n                    With MItem\n                        .To = toEmails\n                        .CC = ccEmails\n                        .Subject = email_subject\n                        .HTMLBody = RangetoHTML(msg_range) &amp; \"&lt;IMG SRC=\"\"signatures.png\"\"&gt;\"\n                        .Display\n                    End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1474491133, "post_id": 39626327, "comment_id": 66558047, "body": "You can lock it and have it password protected. This method does not show the contents unless the correct password is entered. It also does not rely on a username - just a password."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1474491229, "post_id": 39626327, "comment_id": 66558098, "body": "Hopefully the <code>visble</code> in your code is just a typo as you wrote the question."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474491319, "post_id": 39626327, "comment_id": 66558141, "body": "@YowE3K - yes it is. I apologize."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 1, "creation_date": 1474491353, "post_id": 39626327, "comment_id": 66558165, "body": "@PartyHatPanda - i like using the UserForm with login/password info because this way I can display a logo and confidentiality message and such."}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1474491415, "post_id": 39626327, "comment_id": 66558200, "body": "Use what works best for you. I only know of a work around; hopefully someone here knows more about it than I do."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1474491493, "creation_date": 1474491493, "answer_id": 39626471, "question_id": 39626327, "link": "https://stackoverflow.com/questions/39626327/hide-workbook-worksheets-excel-vba/39626471#39626471", "title": "Hide workbook/worksheets Excel VBA", "body": "<p><code>xlhidden</code> is not an acceptable value for <code>Worksheet().Visible</code>.  </p>\n\n<ul>\n<li><code>Sheet1.Visible = xlSheetVisible</code> makes the Worksheet visible</li>\n<li><code>Sheet1.Visible = xlSheetHidden</code>: hides the Worksheet but allows users to unhide it</li>\n<li><p><code>Sheet1.Visible = xlSheetVeryHidden</code>: hides the Worksheet and prevents users from unhiding it</p>\n\n<p><a href=\"https://i.stack.imgur.com/ESIX6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ESIX6.png\" alt=\"enter image description here\"></a></p></li>\n</ul>\n"}], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 39626471, "answer_count": 1, "score": 0, "last_activity_date": 1474491581, "creation_date": 1474490894, "last_edit_date": 1474491581, "question_id": 39626327, "link": "https://stackoverflow.com/questions/39626327/hide-workbook-worksheets-excel-vba", "title": "Hide workbook/worksheets Excel VBA", "body": "<p>I have a simple Microsoft Excel spreadsheet with a few tabs. On opening the workbook I have a USER LOGIN form that loads up and asks for login and password. What I'm trying to do is somehow not let the user see the sheets in the workbook until they've successfully logged in. The problem I'm seeing is that one of my sheets has a macro in it, so what I do</p>\n\n<pre><code>sheet1.visible=xlhidden\n</code></pre>\n\n<p>it gives me a debug error. However, even if I skipped that sheet and hid all the other ones - and on proper login I tried to make them Visible=xlVisible, they still did not become visible. How would I go about something like that?</p>\n\n<p>Is there some kind of a way to be able to hide the workbook possibly and then make it visible after successful login?</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1474489514, "post_id": 39625720, "comment_id": 66557177, "body": "I like the idea of throwing in a With Current after the for Each Current line and then a period before the Range in each of the For Each cell lines and End With after the last Next cell.  Unless there is a compelling reason (ie the tests are different or will be) why don&#39;t you combine the ranges/cell loops?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1474489501, "last_edit_date": 1474489501, "creation_date": 1474489111, "answer_id": 39625856, "question_id": 39625720, "link": "https://stackoverflow.com/questions/39625720/vba-issue-loop-through-every-worksheet/39625856#39625856", "title": "VBA issue - loop through every worksheet", "body": "<p>As per my comment:</p>\n\n<p>You have not assigned any of the range objects to a parent sheet so it only works on the active sheet. Just because you are looping does not automatically assign the sheet to those ranges. You will need to put <code>Current.</code> in front of ALL Range Objects.</p>\n\n<p>The outer loop was not necessary.</p>\n\n<p>I redid the logic on the hide to save some typing:</p>\n\n<pre><code>Sub HideEmptyRows()\n\n    Dim rngName As Range\n    Dim cell As Range\n    Dim current As Worksheet\n\n\n    Application.ScreenUpdating = False\n    For Each current In Worksheets\n        ' This code hides the adv and group merch rows\n        For Each cell In current.Range(\"EQ29:EQ51\")\n            cell.EntireRow.Hidden = cell.Value = 0\n        Next cell\n\n        ' This code hides the consulting rows\n        For Each cell In current.Range(\"EQ61:EQ172\")\n            cell.EntireRow.Hidden = cell.Value = 0\n        Next cell\n    Next\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3537568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8020ba7a322b6b539a13f3f67eeba1ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Konnect", "link": "https://stackoverflow.com/users/3537568/ali-konnect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 39625856, "answer_count": 1, "score": 0, "last_activity_date": 1474489501, "creation_date": 1474488614, "last_edit_date": 1474489129, "question_id": 39625720, "link": "https://stackoverflow.com/questions/39625720/vba-issue-loop-through-every-worksheet", "title": "VBA issue - loop through every worksheet", "body": "<p>I have a macro with a loop logic that I copied off of another stackoverflow/ms support page, but it doesn't seem to work.</p>\n\n<p>I am not experienced with VBA so I am having trouble figuring out why the 'loop through all worksheets' part isn't working.</p>\n\n<p>Can anyone please take a look at my code and tell me how it can be fixed?</p>\n\n<pre><code>Sub HideEmptyRows()\n    Dim rngName As Range\n    Dim cell As Range\n    Dim ws_count As Integer\n    Dim i As Integer\n\n    ws_count = ActiveWorkbook.Worksheets.Count\n    For i = 1 To ws_count\n        Application.ScreenUpdating = False\n        For Each Current In Worksheets\n            ' This code hides the adv and group merch rows\n            For Each cell In Range(\"eq29\", \"eq51\")\n                If cell.Value = 0 Then\n                    cell.EntireRow.Hidden = True\n                    Else\n                    cell.EntireRow.Hidden = False\n                End If\n\n            Next cell\n\n            ' This code hides the consulting rows\n            For Each cell In Range(\"eq61\", \"eq172\")\n                If cell.Value = 0 Then\n                    cell.EntireRow.Hidden = True\n                    Else\n                    cell.EntireRow.Hidden = False\n                End If\n            Next cell\n        Next\n\n    Application.ScreenUpdating = True\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1474492284, "post_id": 39625257, "comment_id": 66558667, "body": "<code>v = [sum(a2:a4*b2:b4)]</code> seems simple enough to me"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1474491304, "last_edit_date": 1474491304, "creation_date": 1474487713, "answer_id": 39625470, "question_id": 39625257, "link": "https://stackoverflow.com/questions/39625257/performing-a-sumproduct-without-using-the-built-in-function-in-excel-vba/39625470#39625470", "title": "Performing a Sumproduct without using the built-in function in Excel VBA", "body": "<p>The main problem is you only want to loop once and refer to the same row.  To do that you would use a simple for loop and use the counter as the index of both arrays.</p>\n\n<p>There is no reason to load the arrays with a loop, as you can assign the values directly.</p>\n\n<pre><code>Sub DiscountedCashflows()\n\nDim CashFlows() As Variant\nDim DiscountFactors() As Variant\nDim i As Long\nDim temp As Double\nWith Worksheets(\"Sheet16\")\n    'Populating Cashflows array\n    CashFlows = .Range(\"A2:A4\").Value\n    'Populating DiscountFactors array\n    DiscountFactors = .Range(\"B2:B4\").Value\n\n    'Loop through the elements in the first array\n    For i = LBound(CashFlows, 1) To UBound(CashFlows, 1)\n        temp = temp + (CashFlows(i, 1) * DiscountFactors(i, 1))\n    Next i\nEnd With\n\nMsgBox \"Answer is...\" &amp; temp\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1474488013, "creation_date": 1474488013, "answer_id": 39625546, "question_id": 39625257, "link": "https://stackoverflow.com/questions/39625257/performing-a-sumproduct-without-using-the-built-in-function-in-excel-vba/39625546#39625546", "title": "Performing a Sumproduct without using the built-in function in Excel VBA", "body": "<pre><code>Function MySumProduct() As Double\n    Dim CashFlows As Variant\n    Dim DiscountFactors As Variant\n\n    With Sheet1\n        CashFlows = Application.Transpose(.Range(\"A1\", .Range(\"A1\").End(xlDown)).Value)\n        DiscountFactors = Application.Transpose(.Range(\"B1\", .Range(\"B1\").End(xlDown)).Value)\n    End With\n\n    For i = LBound(CashFlows) to UBound(CashFlows)\n        MySumProduct= MySumProduct + CashFlow(i) * DiscountFactor(i)\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 4481814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bef03daa49eec19229a4ab592bde3d8?s=128&d=identicon&r=PG&f=1", "display_name": "Hyp0thesis", "link": "https://stackoverflow.com/users/4481814/hyp0thesis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 39625470, "answer_count": 2, "score": 0, "last_activity_date": 1474491304, "creation_date": 1474487006, "question_id": 39625257, "link": "https://stackoverflow.com/questions/39625257/performing-a-sumproduct-without-using-the-built-in-function-in-excel-vba", "title": "Performing a Sumproduct without using the built-in function in Excel VBA", "body": "<p>I've simplified my problem for the purposes of asking this question.  Imagine I have the following data in Excel:</p>\n\n<h2>Cashflows | DiscountFactor</h2>\n\n<h2>11,851 | 0.9901</h2>\n\n<h2>96,401 | 0.9679</h2>\n\n<h2>80,412 | 0.9494</h2>\n\n<p>I want to perform a SUMPRODUCT on these two columns in VBA but without using the built in SUMPRODUCT Function.  This is because my project is going to get more complicated than that - but I just need to figure this out to begin with.  My code so far:</p>\n\n<pre><code>Sub DiscountedCashflows()\n\nDim CashFlows(1 To 3) As Variant\nDim DiscountFactors(1 To 3) As Variant\nDim CashFlowsElms 'Elements in the cashflow array\nDim DiscountFactorElms 'Elements in the DiscountFactors array\n\nSheet1.Select\n\n'Populating Cashflows array\nDim Counter1 As Long\nFor Counter1 = LBound(CashFlows) To UBound(CashFlows)\n    CashFlows(Counter1) = Range(\"A1\").Offset(Counter1, 0).Value\nNext Counter1\n\n'Populating DiscountFactors array\nDim Counter2 As Long\nFor Counter2 = LBound(DiscountFactors) To UBound(DiscountFactors)\n    DiscountFactors(Counter2) = Range(\"B1\").Offset(Counter2, 0).Value\nNext Counter2\n\n'Loop through the elements in the first array\nFor Each CashFlowsElms In CashFlows\n    'Loop through the elements in the second array\n    For Each DiscountFactorElms In DiscountFactors\n        x = x + 1\n        'Multiply the two array elements together\n        Cells(x, 1) = CashFlowElms * DiscountFactorElms\n    Next DiscountFactorElms\nNext CashFlowsElms\n\nMsgBox \"Answer is...\"\n\nErase CashFlows\nErase DiscountFactors\n\nEnd Sub\n</code></pre>\n\n<p>How do I get the code to output the correct answer?</p>\n\n<p>To give some context I'll be expanding this to work for dynamic arrays and I'll eventually turn it into a user defined function.</p>\n\n<p>Any help is appreciated.  </p>\n"}, {"tags": ["ms-access", "vba", "erwin"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1474496134, "post_id": 39625196, "comment_id": 66560324, "body": "<i>&quot;there is no output specific for Access&quot;</i> - The product description page <a href=\"http://erwin.com/products/data-modeler/community-edition\" rel=\"nofollow noreferrer\">here</a> says that it supports ODBC, so does it offer an output for ODBC?"}, {"owner": {"reputation": 43, "user_id": 6859812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531ce054471d4251fe7cada11a51d53d?s=128&d=identicon&r=PG&f=1", "display_name": "Orange", "link": "https://stackoverflow.com/users/6859812/orange"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1474599445, "post_id": 39625196, "comment_id": 66606821, "body": "Thanks for your response.Yes, it offers output to ODBC. However, I don&#39;t have specifics on getting that info into Access. I am looking for a tutorial/guidance, preferably an example, to get the info from logical to  physical database  and into Access."}, {"owner": {"reputation": 43, "user_id": 6859812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531ce054471d4251fe7cada11a51d53d?s=128&d=identicon&r=PG&f=1", "display_name": "Orange", "link": "https://stackoverflow.com/users/6859812/orange"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1507341373, "post_id": 39625196, "comment_id": 80183685, "body": "Since ERWin dropped support of their Community Edition, I have found and downloaded TOAD data modeler  (free edition limited functionality). It does allow generation of Access tables  from  data model."}], "owner": {"reputation": 43, "user_id": 6859812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531ce054471d4251fe7cada11a51d53d?s=128&d=identicon&r=PG&f=1", "display_name": "Orange", "link": "https://stackoverflow.com/users/6859812/orange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474486785, "creation_date": 1474486785, "question_id": 39625196, "link": "https://stackoverflow.com/questions/39625196/erwin-commuity-editon-and-ms-access", "title": "Erwin commuity editon and ms-access", "body": "<p>I am looking for examples or tips related to developing logical and physical data models and to forward engineer same to MS Access. In r9 of the community edition, there is no output specific for Access.\nI'm hoping someone has an example (vba) for going from the physical model and the script file generated  to actually loading the info into  Access.</p>\n\n<p>I am aware of the youtube videos re Erwin but have not found an example.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 1, "creation_date": 1474486847, "post_id": 39625195, "comment_id": 66555693, "body": "Show what you&#39;ve tried...."}], "answers": [{"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1474487587, "creation_date": 1474487587, "answer_id": 39625426, "question_id": 39625195, "link": "https://stackoverflow.com/questions/39625195/vba-scrape-by-sub-division-and-class/39625426#39625426", "title": "vba scrape by sub division and class", "body": "<p>Not quite sure what you're asking but to get the value 1 from the NO IPLAN tag bit you could use this rudimentary text string manipulation that I've recently started to employ as a function due to XML parsing problems:</p>\n\n<pre><code>Sub ho()\n\nDim str As String\nDim schSTR As String\nDim t1 As Integer\nDim t2 As Integer\nDim t3 As Integer\n\nstr = *this is where your HTML scrape would be assigned*\nschSTR = \"NO IPLAN PRODUCT\"\"&gt;:\"\n\nIf InStr(1, str, schSTR, vbBinaryCompare) Then\n  t1 = InStr(1, str, schSTR, vbBinaryCompare) + Len(schSTR)\n  t2 = InStr(t1, str, \"&lt;\", vbBinaryCompare)\n  t3 = t2 - t1\n  result = Mid(str, t1, t3)\n  MsgBox result\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This will give you a message of \"1.\"</p>\n\n<p>If I've understood your requeset properly this will work for any html page/scrape that contains the schSTR variable (in this case \"NO IPLAN PRODUCT\">:\"</p>\n"}], "owner": {"reputation": 1, "user_id": 6788323, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z95SS2DG0Qo/AAAAAAAAAAI/AAAAAAAAA10/eP6_xgmqxNE/photo.jpg?sz=128", "display_name": "Prakash Rawat", "link": "https://stackoverflow.com/users/6788323/prakash-rawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1474487587, "creation_date": 1474486784, "question_id": 39625195, "link": "https://stackoverflow.com/questions/39625195/vba-scrape-by-sub-division-and-class", "title": "vba scrape by sub division and class", "body": "<p>form this html scrap, I just want to get \"NO IPLAN PRODUCT - 1\" this is only last time under columno4, </p>\n\n<p><code>&lt;div  class=\"row02\"&gt;\n        &lt;div class=\"column01\"&gt;\n            &lt;span class=\"outputLabel\"&gt;Originator:&lt;/span&gt;\n            &lt;span class=\"outputText\" id=\"originator_sessionheader\"&gt;DORIS M MORRIS - SUBSCRIBER/RECIPIENT&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div class=\"column02\"&gt;\n            &lt;span class=\"outputLabel\"&gt;Tax ID:&lt;/span&gt;&lt;span class=\"outputText\"&gt;&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div class=\"column03\"&gt;\n            &lt;span class=\"outputLabel\" style=\"vertical-align: 2px;\"&gt;PBB\n                &lt;!--  IE11 remediation changes --&gt;\n                &lt;img class='imgLink' onclick=\"openKMWindow('https://svckm.uhc.com/eAgent/iq/ISET/gateway.jsp?create=kb%3AUHG&amp;report()=p[prem_based_ben]');return false;\" src=\"/chap/images/qm_drkBlue.gif\" width=\"13\" height=\"13\" alt=\"PBB KM\" title=\"PBB KM\"/&gt;\n            &lt;/span&gt;\n            &lt;span class=\"outputText\" style=\"vertical-align: 2px;\"&gt;:N&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div class=\"column04\"&gt;\n            &lt;span class=\"outputLabel style=\"vertical-align: 2px;\"&gt;iPlan\n            &lt;!--  IE11 remediation changes --&gt;\n                &lt;img class='imgLink' onclick=\"openKMWindow('https://svckm.uhc.com/eAgent/iq/ISET/gateway.jsp?create=kb%3AUHG&amp;view()=c[i_iplan_ind]');return false;\" src=\"/chap/images/qm_drkBlue.gif\" width=\"13\" height=\"13\" alt=\"IPLAN KM\" title=\"IPLAN KM\"/&gt;\n            &lt;/span&gt;\n        &lt;span class=\"outputText\" style=\"vertical-align: 2px;cursor:pointer\" title=\"NO IPLAN PRODUCT\"&gt;:1&lt;/span&gt;</code></p>\n\n<p>I tried multiple vba codes but not getting any solution,</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1474558680, "post_id": 39625532, "comment_id": 66590003, "body": "@tim.williams -- thanks so much. I get run time error &#39;9&#39; - subscript out of range, when it gets to the &quot;With Worksheets(c.Value)&quot; line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1474560074, "post_id": 39625532, "comment_id": 66591008, "body": "That would indicate there&#39;s no worksheet with that name in the active workbook.  Does your list of worksheets have a header?  If Yes then change that <code>.Range(&quot;A1&quot;)</code> to <code>.Range(&quot;A2&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1474641314, "post_id": 39625532, "comment_id": 66628574, "body": "Got it. I tried to add the list of tabs to an existing tab and move it from A1 to where the list started. But, sounds like it&#39;s easier to have its own dedicated tab. Thanks so much!!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1474644507, "post_id": 39625532, "comment_id": 66630555, "body": "It can be anywhere - as long as it&#39;s in its own column with nothing below it, so the code can find the last populated value using <code>End(xlUp)</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1474487964, "creation_date": 1474487964, "answer_id": 39625532, "question_id": 39625115, "link": "https://stackoverflow.com/questions/39625115/define-array-by-named-range-for-variant-vba/39625532#39625532", "title": "Define Array by named range for variant vba", "body": "<p>If the list of sheet names is stored on the worksheet \"Config\" beginning at A1:</p>\n\n<pre><code>Sub Filter_To_Send()\n\n    Dim c As Variant\n    Dim rngSheets As Range\n\n    With Sheets(\"Config\")\n        Set rngSheets = .Range(.Range(\"A1\"), .Cells(.Rows.Count, 1).End(xlUp))\n    End with\n\n\n    For Each c In rngSheets.Cells\n        With Worksheets(c.Value)\n            .Range(\"A5\").AutoFilter field:=16, Criteria1:=\"&lt;&gt;0\"\n        End With\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474487964, "creation_date": 1474486450, "question_id": 39625115, "link": "https://stackoverflow.com/questions/39625115/define-array-by-named-range-for-variant-vba", "title": "Define Array by named range for variant vba", "body": "<p>I have the below VBA, which loops through all the named tabs in the array() formula. I want that to be a dynamic range that, instead of having the values typed into the array(), it references a range in a worksheet that has those values, and it dynamic when I add more</p>\n\n<pre><code>Sub Filter_To_Send()\n\nDim WshtNames As Variant\nDim WshtNameCrnt As Variant\n\nWshtNames = Array(\"RASC\", \"RSUV\", \"SBKP\", \"RGRN\", \"SBTK\", \"RWAS\", \"RABT\", \"RHAY\", \"RLEX\", \"RARM\", \"RBCK\", \"RBER\", \"RCCP\", \"RDAL\", \"RHEB\", \"RSST\", \"RMST\", \"RMIA\", \"REHV\", \"RNBY\", \"RNOF\", \"RUTC\", \"RSCS\", \"RSJO\", \"RSCQ\", \"RSHA\", \"RAWP\", \"SART\", \"SASK\", \"SALC\", \"SNHQ\", \"SOEX\", \"SPHL\", \"SSHP\", \"SMRN\")\n\nFor Each WshtNameCrnt In WshtNames\nWith Worksheets(WshtNameCrnt)\n    .Range(\"A5\").AutoFilter field:=16, Criteria1:=\"&lt;&gt;0\"\nEnd With\nNext WshtNameCrnt\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474488575, "post_id": 39624990, "comment_id": 66556631, "body": "<code>...FROM Part_MatrixORDER BY...</code> you need to leave spaces between the words in your query."}, {"owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474543045, "post_id": 39624990, "comment_id": 66578914, "body": "are you talking about in the vba? or the query?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474556341, "post_id": 39624990, "comment_id": 66588347, "body": "Your SQL variable&#39;s value in your VBA: you haven&#39;t left a space between Part_Matrix and ORDER"}, {"owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474660781, "post_id": 39624990, "comment_id": 66638914, "body": "@TimWilliams @geeFlo Ok I think im getting alittle to detailed. I Simply want the following to work if you can help me <code>SELECT *Selected Field From Combobox Here* FROM Part_Matrix</code> With that the SQL returns the literal field name from the combobox 178 times, 1 for each record. Its not selecting the values from records from that specific field."}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1474656274, "post_id": 39667074, "comment_id": 66636722, "body": "thanks techspider.  new to this and didn&#39;t know how to block the code like that."}, {"owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "edited": false, "score": 0, "creation_date": 1474659529, "post_id": 39667074, "comment_id": 66638338, "body": "The user changes the search parameter, its not always Large_OD. The point is that what ever field name is selected in the combo box is the search parameter, <code>WHERE &quot;Selected Search Parameter&quot;</code>. The example I gave was Large_OD. It could be Small_OD , BPT , theres 13 different options."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "edited": false, "score": 0, "creation_date": 1474916009, "post_id": 39667074, "comment_id": 66718394, "body": "I think I get it now.  See my other answer that I just posted."}], "tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": false, "score": 0, "last_activity_date": 1474655157, "last_edit_date": 1474655157, "creation_date": 1474654151, "answer_id": 39667074, "question_id": 39624990, "link": "https://stackoverflow.com/questions/39624990/using-a-form-control-as-a-field-selector-in-sql-query/39667074#39667074", "title": "Using a form control as a field selector in SQL query", "body": "<p>In your BETWEEN statement, reference the table's [Large_OD] field and not the form'S.  </p>\n\n<p>i.e </p>\n\n<pre><code> WHERE Large_OD\n  BETWEEN (((SELECT  Large_OD FROM Part_Matrix WHERE Part_Number = [Forms]![UI]![lbSelected])   - [Forms]![UI]![txtTolerance])\n  AND ((SELECT  Large_OD FROM Part_Matrix WHERE Part_Number = [Forms]![UI]![lbSelected])   + [Forms]![UI]![txtTolerance]))\n ORDER BY \" &amp; Me.cmbFilter &amp; \" DESC;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "edited": false, "score": 0, "creation_date": 1475016615, "post_id": 39710143, "comment_id": 66768837, "body": "I like where this going but I get an error, <code>Syntax error (missing operator) in query expression &#39;[Part_Number] = 01.N221.10</code>  01.N221.10 is the lbSelected"}, {"owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "edited": false, "score": 0, "creation_date": 1475017861, "post_id": 39710143, "comment_id": 66769155, "body": "Ahh got it, <code>intTarget = DLookup(Forms![UI]!cmbFilter, &quot;Part_Matrix&quot;, &quot;Part_Matrix.Part_Number = &#39;&quot; &amp; Me!lbSelected.Value &amp; &quot;&#39;&quot;)</code>. You missed the <code>&amp;&quot;&#39;&quot;</code> at the end and the <code>&#39;</code> at the beginning. Thank you for your help!"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "edited": false, "score": 0, "creation_date": 1475166867, "post_id": 39710143, "comment_id": 66845428, "body": "Ah yes the dreaded string vs numeric ID.   Glad it worked out for ya."}], "tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": true, "score": 2, "last_activity_date": 1474916532, "last_edit_date": 1474916532, "creation_date": 1474915513, "answer_id": 39710143, "question_id": 39624990, "link": "https://stackoverflow.com/questions/39624990/using-a-form-control-as-a-field-selector-in-sql-query/39710143#39710143", "title": "Using a form control as a field selector in SQL query", "body": "<p>Try this, using a dlookup instead of SELECT to return the values you want in the BETWEEN statement.  I believe the dlookup should return the value for whatever field you select in the combo box.  Also, I've simplified to remove the forms!UI statement with a \"me\" assuming you are running code from the same form.  Let me know if this works for ya.</p>\n\n<pre><code>intTarget = dlookup(me!CmbFilter, \"PartMatrix\", \"Part_Number = \" &amp; me!LbSelected)\nintLower = intTarget - me!txtTolerance\nintUpper = intTarget + me!txtTolerance\n\n    strSQL = \"SELECT * FROM Part_Matrix WHERE \" &amp; me!cmbFilter &amp; \" \" &amp; _\n          \"BETWEEN \" &amp; intLower &amp; \" AND \" &amp; intUpper\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 39710143, "answer_count": 2, "score": 1, "last_activity_date": 1475664301, "creation_date": 1474485937, "last_edit_date": 1475664301, "question_id": 39624990, "link": "https://stackoverflow.com/questions/39624990/using-a-form-control-as-a-field-selector-in-sql-query", "title": "Using a form control as a field selector in SQL query", "body": "<p>I am attempting to build a form ,called UI, that users will select a dimension parameter from a combobox \"cmbFilter\" and then add a +/- tolerance in a text box \"txtTolerance\". After selection a part number from a list this should return results for similar part numbers in the the tolorence range for that parameter.  The field names in the table are the dimension parameters and are <code>.AddItem</code> to the combobox in the form load code.</p>\n\n<p>Example. Part#1 OD is 5, so I select \"OD\" as the search parameter then I set a tolerance to +/- 1. The results should show Part#2 with a OD of 6 but not Part#3 with a OD of 7.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MrSPr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MrSPr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have set a listboxs row source to the query but\nno matter what I change in the syntax in this code I get operation or syntax errors. So I assume Im not referencing the form control right, or my logic isn't right? </p>\n\n<p>I have tired the following code in the SQL design view in access.</p>\n\n<p>SQL</p>\n\n<pre><code>  SELECT Part_Matrix.Part_Number, Part_Matrix.Customer, Part_Matrix.Large_OD, Part_Matrix.Vent_Opening, &amp; _\n  Part_Matrix.BPT, Part_Matrix.MFT, Part_Matrix.PD, Part_Matrix.Hat_ID, Part_Matrix.Microfinish, &amp; _\n  Part_Matrix.Turn_Operations, Part_Matrix.Stud_Holes, Part_Matrix.SH_Dimensions, Part_Matrix.Manufacturer_Holes, &amp; _\n  Part_Matrix.MH_Dimensions, Part_Matrix.Other_Holes, Part_Matrix.Other_Dimension\n  FROM Part_Matrix\n  WHERE [Forms]![UI]![cmbFilter]\n  BETWEEN (((SELECT  [Forms]![UI]![cmbFilter] FROM Part_Matrix WHERE Part_Number = [Forms]![UI]![lbSelected])   - [Forms]![UI]![txtTolerance])\n  AND ((SELECT  [Forms]![UI]![cmbFilter] FROM Part_Matrix WHERE Part_Number = [Forms]![UI]![lbSelected])   + [Forms]![UI]![txtTolerance]))\n ORDER BY [Forms]![UI]![cmbFilter] DESC;\n</code></pre>\n\n<p>I have also tried to write the SQL code in access vba still no luck, the code below was just a simple text, I know its now the same logic as above.</p>\n\n<pre><code>Private Sub btnSearch_Click()\nDim SQL As String\nIf txtTolerance = \"\" Then\n    MsgBox (\"No Tolerance Entered\")\n    Exit Sub\nElseIf cmbFilter = \"\" Then\n    MsgBox (\"No Filter Criteria Entered\")\n    Exit Sub\nElse\n\n    SQL = \"SELECT Part_Matrix.[Part_Number], \" &amp; Me.cmbFilter &amp; \" \" &amp; _\n    \"FROM Part_Matrix\" &amp; _\n    \"ORDER BY \" &amp; Me.cmbFilter &amp; \" DESC;\"\n\n    Debug.Print SQL\n    DoCmd.RunSQL SQL\n    lbFilterResults.RowSource = SQL\n    lbFilterResults.Requery\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474484764, "post_id": 39624590, "comment_id": 66554537, "body": "Where did you place that code? &quot;<a href=\"http://www.ozgrid.com/VBA/auto-run-macros.htm\" rel=\"nofollow noreferrer\">Workbook_Open procedure MUST reside in the private module of the Workbook Object (ThisWorkbook)</a>&quot;"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474484797, "post_id": 39624590, "comment_id": 66554552, "body": "@BruceWayne I right click on ThisWorkbook open the module and type the code there. I select WORKBOOK from the drop down and same with OPEN"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1474485183, "post_id": 39624590, "comment_id": 66554754, "body": "Looks correct to me - check to make it runs manually by creating a test sub that does <code>Userform1.Show</code> - then run it using F5. Also - make sure it&#39;s actually in the file you saved - if you open the file (.xlsm extension) is it actually in your code? You have to open the file that ends in .xlsm"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474485237, "post_id": 39624590, "comment_id": 66554788, "body": "In the Immediate Window, (Press <code>CTRL+G</code> in the VB Editor), type <code>UserForm1.Show</code>. It should pop up for you. If it doesn&#39;t let us know."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 2, "creation_date": 1474485500, "post_id": 39624590, "comment_id": 66554929, "body": "@i didn&#39;t have macros enabled in Trust Center. All set thanks forlks!"}], "answers": [{"tags": [], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "is_accepted": true, "score": 0, "last_activity_date": 1474490834, "last_edit_date": 1474490834, "creation_date": 1474490713, "answer_id": 39626282, "question_id": 39624590, "link": "https://stackoverflow.com/questions/39624590/ms-excel-user-forms-vba/39626282#39626282", "title": "MS Excel User forms vba", "body": "<p>In trust center I didn't have macros enabled. I did that and everything seems to work perfectly. </p>\n"}], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 39626282, "answer_count": 1, "score": 0, "last_activity_date": 1474490834, "creation_date": 1474484643, "question_id": 39624590, "link": "https://stackoverflow.com/questions/39624590/ms-excel-user-forms-vba", "title": "MS Excel User forms vba", "body": "<p>Hi \"im kind of new with excel VBA. I'm trying to do something simple as creating a USERFORM1 in VBA and showing it when workbook opens. I've looked it up online but for some reason something is not working.</p>\n\n<p>I open excel, go to developer, create a userform1, add some stuff to it. </p>\n\n<p>I open code for THISWORKBOOK and under Open procedure I type</p>\n\n<pre><code>Private Sub Workbook_Open()\nUserForm1.Show\n\nEnd Sub\n</code></pre>\n\n<p>Then I save it as Macro Enabled and when i open it, nothing happens. What is going on? I know this is a silly question but am i doing something wrong? </p>\n"}, {"tags": ["excel", "vba", "internet-explorer-9"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474484631, "post_id": 39624426, "comment_id": 66554477, "body": "&quot;Put in your file request string here&quot; is the name of the file or what?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474485188, "post_id": 39624426, "comment_id": 66554757, "body": "Sorry I couldn&#39;t be more specific with example for this part because I couldn&#39;t seem to access the website via the URL you supplied to do a test. The &quot;file request string&quot; would be some key/value pairs that tell the server what you&#39;re after. I will try to find an example file download you can replicate on your site to get the gist of how it works."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474486613, "post_id": 39624426, "comment_id": 66555580, "body": "Edited answer to show worked example for a GET request, if you can use your Network traffic monitor (For IE this is the F12 button) you will be able to see what the POST request string is when you download a file. Try to emulate that."}, {"owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474488476, "post_id": 39624426, "comment_id": 66556574, "body": "I see, but my url doesn&#39;t change when i click on the file. that&#39;s why i cannot track it. in your example you have &quot;src=<a href=\"http://www.princexml.com/samples/catalog/PrinceCatalogue.pdf\" rel=\"nofollow noreferrer\">princexml.com/samples/catalog/PrinceCatalogue.pdf</a>&quot; really clear, i don&#39;t"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474489607, "post_id": 39624426, "comment_id": 66557224, "body": "If your URL doesn&#39;t change then I assume it must be a POST request you need to use. I will update my answer to locate how to find the strings required using POST requests. WIthout access to your specific site I can&#39;t really create a fully working code for your specific problem :("}, {"owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474552433, "post_id": 39624426, "comment_id": 66585449, "body": "thanks for all the help but i can&#39;t crack it unfortunately. couldn&#39;t find a reference to the file in that body"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1474557139, "post_id": 39624426, "comment_id": 66588916, "body": "Ah that&#39;s a shame, all I can say is keep on trying - took me a bit of trial and error to crack this technique for the first time. Keep on monitoring the network traffic when you browse the site/ download from other sites. I use the technique all the time now to pull stuff from various systems at work and it&#39;s such a timesaver for me and others!"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 2, "last_activity_date": 1474490028, "last_edit_date": 1474490028, "creation_date": 1474484078, "answer_id": 39624426, "question_id": 39624214, "link": "https://stackoverflow.com/questions/39624214/download-excel-file-from-web-using-vba/39624426#39624426", "title": "download excel file from web using vba", "body": "<p>From what I recall by using the Internet Explorer object you can't bypass its safety prompts.</p>\n\n<p>I get round this at work by using post/get requests via a serverhttp object, getting the file as a responsebody and then use ADODB object to save the body directly to predetermined location.</p>\n\n<p>Here is an example for a GET request which should download a file directly from the URL:</p>\n\n<pre><code>set objhttp = new MSXML2.ServerXMLHTTP60\nURL = \"http://www.princexml.com/samples/catalog/PrinceCatalogue.pdf\"\nobjhttp.Open \"GET\", URL, False\nobjhttp.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nobjhttp.send\nIf objhttp.Status = 200 Then\nSet oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write objhttp.responseBody\n    oStream.SaveToFile \"filepath and filename.pdf\", 2\n    oStream.Close\nEnd If\n</code></pre>\n\n<p>To make this work for a POST request you need a bit more info. To try and find the info you will need to use the F12 Developer tool on internet explorer:</p>\n\n<ul>\n<li>Have InternetExplorer open on the page you're downloading from</li>\n<li>press F12 to open the developer tool</li>\n<li>Click on \"Network\"</li>\n<li>Click on the \"play\" button (\"Enable network traffic capturing\")</li>\n<li>now download the file and you should see the POST that requested the file pop up in the Network summaries.</li>\n<li>Double click on that POST line in the F12 tool and click on \"Request body\", whatever is in there is the goldmine, the thing that was sent to the URL to request the file. If you can interpret that and deploy it in your code then you've cracked it.</li>\n</ul>\n\n<p>the last thing to do would be to change two lines in the code above:</p>\n\n<pre><code> objhttp.Open \"POST\", URL, False\n objhttp.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n objhttp.send (This is where you put the data string i.e. the REQUEST BODY)\n</code></pre>\n\n<p>Sorry I can't specify any more, there are tonnes of formats that a POST request body can have so without seeing an example of your system's I can't go any further.</p>\n"}], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2465, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474490028, "creation_date": 1474483250, "question_id": 39624214, "link": "https://stackoverflow.com/questions/39624214/download-excel-file-from-web-using-vba", "title": "download excel file from web using vba", "body": "<p>i have the following code to download an specific file from the web. the webpage has the name of the file and if you click on it you get the \"Do you want to open or save ....... from ......?Open/Save/Cancel.\nthis is what i have so far:</p>\n\n<pre><code>    Dim ie As InternetExplorer\n    Dim html As HTMLDocument\n    Set ie = New InternetExplorer\n    ie.Navigate \"http://customerservice.ciena.com/BidRegister/Queue.aspx?REGIONID=3\"\nSet fe1 = html.getElementById(\"ctl00_P1_rdgFileList_ctl00_ctl00_btnGetFile\")\nfe1.click\n</code></pre>\n\n<p>at this point i get the pop up message i was telling you about above. How can i continue my code to either avoid this pop up and directly save the file in a given location? is there a line of code that saves the file directly?</p>\n"}, {"tags": ["sql", "vba", "excel", "sql-server-2008", "vb6"], "comments": [{"owner": {"reputation": 217, "user_id": 5493940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IcJ0n.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5493940/jackson"}, "edited": false, "score": 0, "creation_date": 1474483630, "post_id": 39624204, "comment_id": 66553929, "body": "This is a line copy/pasted from a Excel VBA SQL spreadsheet I worked on a little while ago: <code>AND d1_17.ddeath&gt;={ts &#39;&quot; &amp; StartDate &amp; &quot; 00:00:00&#39;} AND d1_17.ddeath&lt;={ts &#39;&quot; &amp; StopDate &amp; &quot; 00:00:00&#39;}</code> StartDate and StopDate were user-selected parameters"}, {"owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 1, "creation_date": 1474483962, "post_id": 39624204, "comment_id": 66554132, "body": "Am I missing something here? What is wrong with a SQL query SELECT fields FROM table WHERE (DateAndTime BETWEEN &#39;2016-09-21 14:00&#39;  AND &#39;2016-09-21 22:00&#39;)"}, {"owner": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "reply_to_user": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 0, "creation_date": 1474485309, "post_id": 39624204, "comment_id": 66554823, "body": "@jac It will select all data between 14:00 to 22:00. (like 14:10:25) I need data for 14:00, 15:00, 16:00 ..... 22:00"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "edited": false, "score": 0, "creation_date": 1474519440, "post_id": 39625499, "comment_id": 66565763, "body": "i only want select data hourly...skip other data....like in a day i want 24 values"}, {"owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "reply_to_user": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "edited": false, "score": 0, "creation_date": 1474554062, "post_id": 39625499, "comment_id": 66586685, "body": "@user3868044 And that is what the queries above give you."}, {"owner": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "edited": false, "score": 0, "creation_date": 1474652017, "post_id": 39625499, "comment_id": 66634532, "body": "...Thank you so much...it was working superb....Thanks alot.  I have one more requirement : Suppose i have selected 8 hours time period, then i need 8 values. Suppose for some time if value is not present, then i need to show Null/0/Blank."}, {"owner": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "edited": false, "score": 0, "creation_date": 1475145595, "post_id": 39625499, "comment_id": 66830428, "body": "Hello, @jac  have one more requirement : Suppose i have selected 8 hours time period, then i need 8 values. Suppose for some time if value is not present, then i need to show Null/0/Blank."}, {"owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "reply_to_user": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "edited": false, "score": 1, "creation_date": 1475164087, "post_id": 39625499, "comment_id": 66843754, "body": "@user3868044 Notice the ISNULL in the query. That is what that handles. You may have to do some of the work yourself."}], "tags": [], "owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "is_accepted": true, "score": 3, "last_activity_date": 1475102171, "last_edit_date": 1475102171, "creation_date": 1474487839, "answer_id": 39625499, "question_id": 39624204, "link": "https://stackoverflow.com/questions/39624204/how-to-select-data-between-given-interval-of-time-from-sql/39625499#39625499", "title": "How to select data between given interval of time from SQL", "body": "<p>You need to use an SQL statement that selects the fields you want from the records you want. You said you are trying to select only the even minutes so the SQL is something like</p>\n\n<pre><code>SELECT\n    fields\nFROM table\nWHERE\n    (DateAndTime BETWEEN '2016-09-21 14:00' AND '2016-09-21 22:00')\nAND\n    (DATEPART(MINUTE, DateAndTime) % 60 = 0)\n</code></pre>\n\n<p>If you need even seconds also just add another AND to the the WHERE clause.</p>\n\n<pre><code>SELECT\n    fields\nFROM table\nWHERE\n    (DateAndTime BETWEEN '2016-09-21 14:00' AND '2016-09-21 22:00')\nAND\n    (DATEPART(MINUTE, DateAndTime) % 60 = 0)\nAND\n    (DATEPART(SECOND, DateAndTime) % 60 = 0)\n</code></pre>\n\n<p>To answer the question in the last comment, I have worked up a SQL query that works. It may be that if you post your exact requirements with a SQL tag and ignore the vb6, vba tags because this is really all SQL and has nothing to do with the environment running it, that you'll get a better answer. This will work. I would suggest incorporating this into a stored procedure.</p>\n\n<p>This works by creating a table variable and populating it with the possible time values that can be returned. It then left joins the table you want to query. The result is a null value from the second table when there is no record to join on.</p>\n\n<pre><code>--select records on the hour from 8:00 to 5:00\nDECLARE @MinTime datetime = '2016-9-9 09:00'   --need to parameterize\nDECLARE @MaxTime datetime = '2016-9-10 17:00'  --need to parameterize\nDECLARE @TempTime datetime = @MinTime\n\nDECLARE @Times TABLE\n(\n    TimeValue datetime\n)\nWHILE @TempTime &lt;= @MaxTime\nBEGIN\n    INSERT INTO @Times\n    (\n        TimeValue\n    )\n    VALUES\n    (\n        @TempTime\n    )\n    SET @TempTime = DATEADD(hour, 1, @TempTime)\nEND\n\nSELECT\n    CONVERT(varchar(10), TimeRange.TimeValue, 101) AS [Date]\n    ,CONVERT(varchar(10), TimeRange.TimeValue, 108) AS [Time]\n    ,ISNULL(Tag, 'NA')\n    ,ISNULL(Value, 0)\nFROM\n    @Times TimeRange\nLEFT JOIN\n    table\nON\n    (CONVERT(datetime, CONVERT(varchar(10), table.DateAndTime, 101) + ' ' + CONVERT(varchar(2), DATEPART(HOUR, table.DateAndTime)) + ':' + CONVERT(varchar(2), DATEPART(MINUTE, table.DateAndTime)) + ':' + CONVERT(varchar(2), DATEPART(SECOND, table.DateAndTime))) = TimeRange.TimeValue)\nWHERE\n    (TimeRange.TimeValue BETWEEN @MinTime AND @MaxTime)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3868044, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/JiJpG.jpg?s=128&g=1", "display_name": "Viks", "link": "https://stackoverflow.com/users/3868044/viks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5062, "favorite_count": 0, "protected_date": 1604080280, "accepted_answer_id": 39625499, "answer_count": 1, "score": 1, "last_activity_date": 1604072321, "creation_date": 1474483213, "question_id": 39624204, "link": "https://stackoverflow.com/questions/39624204/how-to-select-data-between-given-interval-of-time-from-sql", "title": "How to select data between given interval of time from SQL", "body": "<p>I have following data in SQL <a href=\"https://i.stack.imgur.com/Lmiro.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lmiro.jpg\" alt=\"SQL Data i am having\"></a></p>\n\n<p>Need sql queue:</p>\n\n<p>I have 10 tags, it is continuously logging to SQl at every 10 Seconds of intervals.\nNow i want create report like.....User will provide time interval and tag name on that basis it will select data from table &amp; display in Excel\nSuppose My inputs are :\n<em>interval is</em> <strong>2016-09-21 14.00.00</strong> to <strong>2016-09-21 22.00.00</strong>\n<em>Tag Name is</em> : <strong>system\\Year</strong>\nI want following output:<a href=\"https://i.stack.imgur.com/4aI81.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4aI81.jpg\" alt=\"output result\"></a>\n<strong>Suppose record is not present at that time, then i need blank/Zero value.</strong>\nI want to create this in VB6.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1474484966, "post_id": 39624018, "comment_id": 66554639, "body": "Are you filling the dropdown from a range?"}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1474485020, "post_id": 39624018, "comment_id": 66554678, "body": "Populating from a SQL query"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 3, "creation_date": 1474485580, "post_id": 39624018, "comment_id": 66554979, "body": "If the data was on a worksheet Mat&#39;s Mug shows you how to do it here: <a href=\"http://codereview.stackexchange.com/questions/140995/populating-a-combobox-from-a-range/140999#140999\">Populating a ComboBox from a Range</a>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1474490977, "creation_date": 1474490977, "answer_id": 39626351, "question_id": 39624018, "link": "https://stackoverflow.com/questions/39624018/excel-combobox-autosize-dropdown-only/39626351#39626351", "title": "Excel ComboBox - Autosize Dropdown Only", "body": "<p>Some of the columns seem a little wide, but over all I think the code does a pretty good job of configuring the drop down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hMKYT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hMKYT.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub ConfigureComboBox()\n    Dim arrData, arrWidths\n    Dim x As Long, y As Long, ListWidth As Double\n    arrData = ComboBox1.List\n    ReDim arrWidths(UBound(arrData, 2))\n\n    For x = 0 To UBound(arrData, 1)\n        For y = 0 To UBound(arrData, 2)\n\n            If Len(arrData(x, y)) &gt; arrWidths(y) Then arrWidths(y) = Len(arrData(x, y))\n\n        Next\n    Next\n\n    For y = 0 To UBound(arrWidths)\n\n        arrWidths(y) = arrWidths(y) * ComboBox1.Font.Size\n        ListWidth = ListWidth + arrWidths(y)\n    Next\n\n    With ComboBox1\n        .ColumnCount = UBound(arrWidths) + 1\n        .ColumnWidths = Join(arrWidths, \";\")\n        .ListWidth = ListWidth\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Sample data from <a href=\"http://www.contextures.com/xlSampleData01.html#download\" rel=\"nofollow noreferrer\">Excel Sample Data</a></p>\n"}], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2259, "favorite_count": 0, "accepted_answer_id": 39626351, "answer_count": 1, "score": 0, "last_activity_date": 1474490977, "creation_date": 1474482591, "last_edit_date": 1531164843, "question_id": 39624018, "link": "https://stackoverflow.com/questions/39624018/excel-combobox-autosize-dropdown-only", "title": "Excel ComboBox - Autosize Dropdown Only", "body": "<p>Is it possible to have just the drop down menu of a ComboBox in a UserForm autofit to the text size, without changing the actual size of the ComboBox?</p>\n\n<p>I've found some answers on how to autofit the actual ComboBox based on the values within, but that makes the size bigger than I actually want (<a href=\"http://www.ozgrid.com/forum/showthread.php?t=55098\" rel=\"nofollow noreferrer\">link here</a>).</p>\n\n<p>The following image somewhat represents what I'm trying to accomplish:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JKHMX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JKHMX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know if this is even possible?</p>\n"}, {"tags": ["vba", "csv", "append"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1474482423, "post_id": 39623845, "comment_id": 66553269, "body": "Why wouldn&#39;t it have a row limit?  You&#39;re opening it as an Excel file."}, {"owner": {"reputation": 53, "user_id": 5619709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e8e88f0dca16fff2fdb9db7851fe6f51?s=128&d=identicon&r=PG&f=1", "display_name": "user5619709", "link": "https://stackoverflow.com/users/5619709/user5619709"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474483048, "post_id": 39623845, "comment_id": 66553627, "body": "What should I be writing then?"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474496891, "post_id": 39624278, "comment_id": 66560561, "body": "The <i>second</i> way to do this is to use Excel to create the .csv files individually, then use any number of methods to append them to each other without using Excel."}], "tags": [], "owner": {"reputation": 709, "user_id": 6406676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tKqoTYfIoLg/AAAAAAAAAAI/AAAAAAAAAE4/nAM6WSK4jN0/photo.jpg?sz=128", "display_name": "David Cram", "link": "https://stackoverflow.com/users/6406676/david-cram"}, "is_accepted": false, "score": 0, "last_activity_date": 1474483456, "creation_date": 1474483456, "answer_id": 39624278, "question_id": 39623845, "link": "https://stackoverflow.com/questions/39623845/csv-file-has-row-limit-vba/39624278#39624278", "title": ".csv file has row limit? (VBA)", "body": "<p>This is just one way to do this:<br>\nAdd a reference to your project to the Microsoft Scripting Runtime library.  Create a file object for your csv file.  You can then use the OpenAsTextStream method to read, write, or append to the csv file.  As long as you are dealing with the file as an Excel workbookyou are going to have the same limitations as Excel.  Since you are now dealing with it as text it will also be up to you to add the comma delimiter (or stuff like quotes around string values, etc...)</p>\n"}], "owner": {"reputation": 53, "user_id": 5619709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e8e88f0dca16fff2fdb9db7851fe6f51?s=128&d=identicon&r=PG&f=1", "display_name": "user5619709", "link": "https://stackoverflow.com/users/5619709/user5619709"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 398, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474483456, "creation_date": 1474482011, "question_id": 39623845, "link": "https://stackoverflow.com/questions/39623845/csv-file-has-row-limit-vba", "title": ".csv file has row limit? (VBA)", "body": "<p>I wrote a code that will transfer date from an .xls file to a csv file. But the code cuts out once the .csv file hits it's 1Million row limit mark, just like a regular excel file. You will see where I put mainwb.activate where I paste information into the csv. I think this may have something to do with how Im pasting it, but I'm not sure. Thanks.</p>\n\n<pre><code>Sub LoopThroughFilesInFolder_Click()\n\nDim mainwb As Workbook\nDim wb As Workbook\nDim main_i As Long\nDim wb_i As Long\nDim transfer_array(1, 14) As Variant\n\nSet mainwb = Workbooks.Open(Filename:=\"C:\\Users\\n808037\\Desktop\\csv\\test.csv\", ReadOnly:=False)\n\nmainwb.Activate\n\nSet FileSystemObj = CreateObject(\"Scripting.FileSystemObject\")\nSet FolderObj = FileSystemObj.GetFolder(\"C:\\Users\\...\")\n\nmain_i = 1\n\nFor Each fileObj In FolderObj.Files     'loop through the files\n\nSet wb = Workbooks.Open(fileObj.Path)\n\n'workbook row counter\n    wb_i = 2\nDo While wb.Sheets(1).Cells(wb_i, 1) &lt;&gt; \"\"\n\n    For i = 1 To 13\n        transfer_array(1, i) = wb.Sheets(1).Cells(wb_i, i).Value\n    Next i\n\nmainwb.Activate 'THIS WILL BE WHERE I OPEN AND PASTE TO THE CSV FILE\n\n    For i = 1 To 13\n    mainwb.Worksheets(\"test\").Cells(main_i, i).Value = transfer_array(1, i) &amp; \"\"\n    Next i\n\n    mainwb.Worksheets(\"test\").Cells(main_i, 14).Value = Now &amp; \"\"\n\n    wb_i = wb_i + 1\n    main_i = main_i + 1\nLoop\n\nwb.Activate\nwb.Save\nwb.Close\n\nNext fileObj\n\nmainwb.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1474482589, "post_id": 39623837, "comment_id": 66553370, "body": "you need to provide more information such as how the workbook has been uploaded to sharepoint, in a document container, via the Excel Webpart ect..... Also an example of the list and link would be beneficial too."}, {"owner": {"reputation": 5177, "user_id": 1258518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jck8F.png?s=128&g=1", "display_name": "Javascript Coder", "link": "https://stackoverflow.com/users/1258518/javascript-coder"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1474482711, "post_id": 39623837, "comment_id": 66553433, "body": "That&#39;s what I am looking for.. How to upload that workbook or excel and how to use in hyperlink and say what I want to selected.."}, {"owner": {"reputation": 5177, "user_id": 1258518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jck8F.png?s=128&g=1", "display_name": "Javascript Coder", "link": "https://stackoverflow.com/users/1258518/javascript-coder"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1474483106, "post_id": 39623837, "comment_id": 66553659, "body": "Can someone please guide me.."}], "owner": {"reputation": 5177, "user_id": 1258518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jck8F.png?s=128&g=1", "display_name": "Javascript Coder", "link": "https://stackoverflow.com/users/1258518/javascript-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474699267, "creation_date": 1474481977, "last_edit_date": 1474699267, "question_id": 39623837, "link": "https://stackoverflow.com/questions/39623837/how-to-use-macros-for-hyperlink-in-excel", "title": "How to use macros for hyperlink in Excel", "body": "<p>I have sharpoint site where I have uploaded the Excel.\nI have few list each list have same excel hyper link..</p>\n\n<p>What I want to perform..</p>\n\n<p>In Excel I have some data, Onclick of first hyperlink I want to open same excel sheet but I want some row to be selected.</p>\n\n<p>same I want when I click on other option it should open same excel but row should be different one slected.</p>\n\n<p>I tried to acheive this using the Macros but not able kno, How i will configure for hperlink..</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Quick-start-Create-a-macro-455512ef-3532-404e-b8dd-ea6589512c1b\" rel=\"nofollow\">https://support.office.com/en-us/article/Quick-start-Create-a-macro-455512ef-3532-404e-b8dd-ea6589512c1b</a></p>\n"}, {"tags": ["vba", "excel", "error-handling", "web-scraping"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 2, "creation_date": 1474479990, "post_id": 39623228, "comment_id": 66552048, "body": "What line gets the error?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1474480304, "post_id": 39623228, "comment_id": 66552228, "body": "I can&#39;t see where you set <code>Sheet1</code> to anything."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1474481262, "post_id": 39623228, "comment_id": 66552687, "body": "Piggybacking off @MattCremeens - Do you mean <code>Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)...</code>?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474482363, "post_id": 39623228, "comment_id": 66553239, "body": "You need to test the return values of <code>getElementsByClassName</code> and <code>getElementsByName</code> before you apply indexing to them."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474487687, "post_id": 39623573, "comment_id": 66556156, "body": "That is great. Thanks a lot! Huge help."}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474489730, "post_id": 39623573, "comment_id": 66557293, "body": "Do you have any links for the string manipulation. I&#39;m fairly new at working with the XML stuff in VBA. I would like to learn, just looking for some good reference material or other stackoverflow examples. Thanks again!"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474490959, "post_id": 39623573, "comment_id": 66557964, "body": "No problems! When I look for &quot;parse html in vba&quot; I get a fair few StackOverflow pages all which have some hints in but I can&#39;t find anything with all the golden rules in. Top answer here is a good start point for loading the result in to an htmldoc: <a href=\"http://stackoverflow.com/questions/25488687/parse-html-content-in-vba\">link</a> BUT I&#39;ve actually taken to just finding individual strings within the response, using e.g. the instr() function to locate the open and end tags or whatever. (fairly sure this is very bad practice but it works awesome for my job where html outputs are very standardised)."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474492091, "post_id": 39623573, "comment_id": 66558556, "body": "I just added to the answer my &quot;string only&quot; parser function that I use at work... to help get you started at least if you&#39;re going for string manipulation alone. I find this string editing method much easier to keep track of but there&#39;s a lot of scope for trip ups :/"}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474492457, "post_id": 39623573, "comment_id": 66558748, "body": "This may be asking to much, but when i run the original logic that you submitted, it looks like it is just pulling back the htlm from the first page. What i need to do is iterate through the result pages. Any quick thoughts? if not i can go do some more research with the XML/HTML functions."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474495094, "post_id": 39623573, "comment_id": 66559969, "body": "Ha, this was a troublesome site compared to most others (typical) in that it seems to require a resubmission of the same info through two URLs. Once submitted though, it&#39;s easy and quick to navigate the pages with GET requests. I&#39;ve updated my answer again (middle section and the first chunk of code), hope it helps :D"}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474497398, "post_id": 39623573, "comment_id": 66560706, "body": "Works like a charm now! I really appreciate the help."}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 1, "last_activity_date": 1474494987, "last_edit_date": 1474494987, "creation_date": 1474481023, "answer_id": 39623573, "question_id": 39623228, "link": "https://stackoverflow.com/questions/39623228/vba-object-variable-or-with-block-variable-not-set-error-web-scraping/39623573#39623573", "title": "VBA Object Variable or with block variable not set error - web scraping", "body": "<p>You have a waiting loop for initiation of the site but not for pressing the button - you just have an arbitrary time set - does the code throw an error here?</p>\n\n<p>May I recommened using MSXML2.ServerXMLHTTP60 objects to send GET/POST requests and then parse the html response as opposed to automating internet explorer.</p>\n\n<p>By sending requests in sync fashion it will wait until the request is  totally complete before running the next part of the code meaning you won't have to do \"wait loops\" or set random times for results.</p>\n\n<p>I know it's not a real answer to your individual problem but this may get you started:</p>\n\n<pre><code>Sub do_rework_son()\nDim oHTTP As MSXML2.ServerXMLHTTP60\nDim URL As String\nDim myHTMLresult As String\nDim zipCODE As String\nDim myREQUEST As String\n\nSet oHTTP = New MSXML2.ServerXMLHTTP60\nURL = \"http://avmed.prismisp.com/Search\"\nzipCODE = \"32258\"\nmyREQUEST = \"SearchType=ByProvider&amp;ProviderType=Provider&amp;Plan=1&amp;City=&amp;County=&amp;State=&amp;Zip=&amp;Address=\" &amp; zipCODE &amp; \"&amp;Proximity=5&amp;PrimaryCareProvider=true&amp;Name=\"\n\noHTTP.Open \"POST\", URL, False\noHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\noHTTP.send (myREQUEST)\n\nURL = \"http://avmed.prismisp.com/ResetFilters\"\noHTTP.Open \"POST\", URL, False\noHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\noHTTP.send (myREQUEST)\n\noHTTP.Open \"GET\", \"http://avmed.prismisp.com/SearchResults?PageRequested=1\", False\noHTTP.send\n\nmyHTMLresult = oHTTP.responseText\n\nEnd sub\n</code></pre>\n\n<p>This site is a bit funny and requires a resubmission of the same info to follow on from the first Search (note the URL difference for the first two POST requests - was the only way I could get access to the search results).</p>\n\n<p>Once that search has been comitted the ohttp connection is still live and you can use a simpler GET request (which relies on the URL only - no body string to the request).</p>\n\n<p>The GET request can navigate the results pages (change the URL to pagerequested=xyz page as many times as you like, just repeat the two GET request lines through a simple loop or something, to get through all the pages).</p>\n\n<p>To get the limit of the loop i.e. the amount of results pages, they're near the bottom of the html response.</p>\n\n<p>This code will navigate to the site, submit the form, and you can replace individual parts of the form in the \"myREQUEST\" string (as I've done here with zipCODE which is a variable you can change x amount of times and resubmit the code in loop or whatever). This is all done in the background with no Internet explorer and completely negates the use of any WAIT functions.</p>\n\n<p>For parsing the results you could look in to string manipulation of the text string response or load the response in to an html document where you can use getelementsbyID etc.</p>\n\n<p>Here's a rudimentary \"Strings only\" parser that I created for work (Be careful of finding strings that include quotation marks)</p>\n\n<pre><code>Sub parse_my_example_string()\n\nDim string_to_parse As String\nDim extracted_info As String\n\nstring_to_parse = \"&lt;spec tag&gt;Woah!&lt;/spec tag&gt;&lt;class='this'&gt;This is my result!&lt;/class&gt;&lt;p&gt;Chicken&lt;/p&gt;\"\n\nextracted_info = parseResult(string_to_parse, \"&lt;class='this'&gt;\", \"&lt;/class&gt;\")\nMsgBox extracted_info\n\nextracted_info = parseResult(string_to_parse, \"&lt;spec tag&gt;\", \"&lt;\")\nMsgBox extracted_info\n\nEnd Sub\n\nFunction parseResult(ByRef resStr As String, ByRef schStr As String, ByRef endStr As String)\nDim t1 As Integer: Dim t2 As Integer: Dim t3 As Integer\n  If InStr(1, resStr, schStr, vbBinaryCompare) &gt; 0 Then\n  t1 = InStr(1, resStr, schStr, vbBinaryCompare) + Len(schStr)\n  t2 = InStr(t1, resStr, endStr, vbBinaryCompare)\n  t3 = t2 - t1\n  parseResult = Mid(resStr, t1, t3)\n  End If\nEnd Function\n</code></pre>\n\n<p>Like I mentioned in the comment, this practice is probably frowned upon by many coders but I found it works well for my job and specially when xml dom documents freak Excel out for no apparent reason!</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474489658, "post_id": 39623703, "comment_id": 66557254, "body": "I agree with the above comments. Even when i took out the array piece i was still getting the error... as well as assigning sheet1. I will try and remove the .readystate loop and see if that helps. I appreciate all the quick responses!"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474489971, "post_id": 39623703, "comment_id": 66557420, "body": "When I ran it, I received no error and got output in the first row of <code>Sheet1</code>. Hoping you have a similar experience."}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474490307, "post_id": 39623703, "comment_id": 66557610, "body": "Did you alter the logic at all?? Maybe i just need to restart my machine."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474490420, "post_id": 39623703, "comment_id": 66557667, "body": "All I did was keep what you had and made the changes I outlined above. Worked like a charm."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474490858, "post_id": 39623703, "comment_id": 66557901, "body": "Oh, I also commented out the custom <code>Dims</code> since I didn&#39;t have those types. Maybe try doing that."}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474491685, "post_id": 39623703, "comment_id": 66558331, "body": "So strange. i have done everything you mentioned below and i can still step through the code fine. Whenever i try hitting run i get an error right after i go to the next page (after i click the submit button)."}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474493034, "post_id": 39623703, "comment_id": 66559024, "body": "Could i be using wrong references? or maybe missing one/be pointing to an outdated one?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474501664, "post_id": 39623703, "comment_id": 66561722, "body": "Did you try commenting out all of your <code>dim</code> statements?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474501744, "post_id": 39623703, "comment_id": 66561741, "body": "Can you post your code after you made my changes? That way I can look at it."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474549168, "post_id": 39623703, "comment_id": 66583189, "body": "I&#39;ve added as an edit to my answer my complete code. I think if you just copy and paste it, you will be fine. If not, let me know."}, {"owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474916497, "post_id": 39623703, "comment_id": 66718673, "body": "Sorry for the delay. I ran your code and like before i can step through it, but i keep getting that same error when it gets to the second page... error on &quot;LString = doc.getElementsByClassName(&quot;profileDetails&quot;)(0).innerText&quot;  line. I&#39;m not really sure what else im missing. What references do you have?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "edited": false, "score": 0, "creation_date": 1474922909, "post_id": 39623703, "comment_id": 66722318, "body": "Maybe try putting in longer waiting times."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 1, "last_activity_date": 1474548929, "last_edit_date": 1474548929, "creation_date": 1474481506, "answer_id": 39623703, "question_id": 39623228, "link": "https://stackoverflow.com/questions/39623228/vba-object-variable-or-with-block-variable-not-set-error-web-scraping/39623703#39623703", "title": "VBA Object Variable or with block variable not set error - web scraping", "body": "<p>I see a few issues here.</p>\n\n<p>One is that the loop waiting for the ready state to be complete goes on and on for some reason. I would take this line out</p>\n\n<pre><code>Do Until .readyState = READYSTATE_COMPLETE: DoEvents: Loop\n</code></pre>\n\n<p>as I don't think it's needed.</p>\n\n<p>You don't set <code>Sheet1</code> to anything, and I suspect that is where your code is actually throwing an error. Try this</p>\n\n<pre><code>Set Sh1 = Worksheets(\"Sheet1\")\n</code></pre>\n\n<p>and use the new reference <code>Sh1</code> to refer to that worksheets.</p>\n\n<p>You do not have 7 elements in this array</p>\n\n<pre><code>LArray = Split(LString, vbCrLf)\n</code></pre>\n\n<p>Perhaps you never know how many elements you will have. In that case I would do this</p>\n\n<pre><code>For i = LBound(LArray) to UBound(LArray)\n    Sh1.Cells(1, i+1) = LArray(i)\nNext i\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code> Sheet1.Range(\"A1\") = LArray(0)\n Sheet1.Range(\"B1\") = LArray(2)\n Sheet1.Range(\"C1\") = LArray(3)\n Sheet1.Range(\"D1\") = LArray(4)\n Sheet1.Range(\"E1\") = LArray(5)\n Sheet1.Range(\"F1\") = LArray(6)\n</code></pre>\n\n<p>Here is my code complete with all of the above changes:</p>\n\n<pre><code>Sub Do_Work_Son()\n\nDim strSQL As String\nDim LString As String\nDim LArray() As String\n\nstrSQL = \"http://avmed.prismisp.com/?tab=doctor\"\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nWith IE\n    .Visible = True\n    .navigate strSQL\n    'Do Until .readyState = READYSTATE_COMPLETE: DoEvents: Loop\n     Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n Set doc = IE.document\n\n    'Call WaitBrowser(IE)\n\n   '-----------------------------\n   '--Start Page Select Criteria--\n   '-----------------------------\n\n     Set plnSelect = doc.getElementsByClassName(\"full jqSelectPlan\")(0)\n     plnSelect.selectedIndex = 1\n\n     Set adrInput = doc.getElementsByClassName(\"address-type-ahead enteredText ac_input defaultText\")(0)\n     adrInput.Value = \"32258\" 'this is where we will link to zip code table\n\n     Set dirSelect = doc.getElementsByName(\"Proximity\")(0)\n     dirSelect.selectedIndex = 0\n\n\n     doc.getElementsByClassName(\"button large\")(0).Click 'this submits the initial page\n     '------------------------------------------------------\n     'Call WaitBrowser(IE)\n     Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n\n\n     LString = doc.getElementsByClassName(\"profileDetails\")(0).innerText\n     LArray = Split(LString, vbCrLf)\n\n     Application.Wait (Now + TimeValue(\"0:00:02\"))\n\n     Set Sh1 = Worksheets(\"Sheet1\")\n\n     For i = LBound(LArray) To UBound(LArray)\n         Sh1.Cells(1, i + 1) = LArray(i)\n     Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You'll notice I added a little bit more time for your page to load than before. 5 seconds may not be enough. If 10 is not enough, add more, but this seems to be a page that loads fairly quickly. </p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 4164144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c1ICqKyDEHg/AAAAAAAAAAI/AAAAAAAAAKE/D2Xdjq6K-dc/photo.jpg?sz=128", "display_name": "BGagnon05", "link": "https://stackoverflow.com/users/4164144/bgagnon05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 1, "accepted_answer_id": 39623573, "answer_count": 2, "score": 0, "last_activity_date": 1474548929, "creation_date": 1474479809, "question_id": 39623228, "link": "https://stackoverflow.com/questions/39623228/vba-object-variable-or-with-block-variable-not-set-error-web-scraping", "title": "VBA Object Variable or with block variable not set error - web scraping", "body": "<p>So i am writing some VBA code to step through a website and i keep getting an \"Object variable or with block variable not set error\" I can usually step through the code without error, which led me to believe it was a timing issue. I loaded this code up with wait statements and still would get that error. Any thoughts? Am i doing something crazy?</p>\n\n<pre><code>Sub Do_Work_Son()\n\n\nDim IE As InternetExplorer\nDim doc As HTMLDocument\nDim plnSelect As HTMLSelectElement 'this selects the plan\nDim adrInput As HTMLInputElement 'this selects the address\nDim dirSelect As HTMLSelectElement 'this selects the distance\nDim strSQL As String\nDim LString As String\nDim LArray() As String\n\nstrSQL = \"http://avmed.prismisp.com/?tab=doctor\"\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nWith IE\n    .Visible = True\n    .navigate strSQL\n    Do Until .readyState = READYSTATE_COMPLETE: DoEvents: Loop\n       Application.Wait (Now + TimeValue(\"0:00:5\"))\n\n Set doc = IE.document\n\n        'Call WaitBrowser(IE)\n\n       '-----------------------------\n       '--Start Page Select Criteria--\n       '-----------------------------\n\n         Set plnSelect = doc.getElementsByClassName(\"full jqSelectPlan\")(0)\n         plnSelect.selectedIndex = 1\n\n         Set adrInput = doc.getElementsByClassName(\"address-type-ahead enteredText ac_input defaultText\")(0)\n         adrInput.Value = \"32258\" 'this is where we will link to zip code table\n\n         Set dirSelect = doc.getElementsByName(\"Proximity\")(0)\n         dirSelect.selectedIndex = 0\n\n\n         doc.getElementsByClassName(\"button large\")(0).click 'this submits the initial page\n         '------------------------------------------------------\n         'Call WaitBrowser(IE)\n         Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n\n         Debug.Print (doc.getElementsByClassName(\"profileDetails\")(0).innerText)\n\n\n         LString = doc.getElementsByClassName(\"profileDetails\")(0).innerText\n         LArray = Split(LString, vbCrLf)\n\n         Debug.Print (LArray(0))\n\n\n         Application.Wait (Now + TimeValue(\"0:00:2\"))\n\n         Sheet1.Range(\"A1\") = LArray(0)\n         Sheet1.Range(\"B1\") = LArray(2)\n         Sheet1.Range(\"C1\") = LArray(3)\n         Sheet1.Range(\"D1\") = LArray(4)\n         Sheet1.Range(\"E1\") = LArray(5)\n         Sheet1.Range(\"F1\") = LArray(6)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 4369, "user_id": 248349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c118aaeb5bb7162db613a37e595be8?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/248349/mick"}, "edited": false, "score": 0, "creation_date": 1474479601, "post_id": 39623059, "comment_id": 66551854, "body": "It&#39;s been ages since I&#39;ve done any Excel programming but I think you need Shapes.Range( ... ). ActiveSheet.Shapes just gives you a collection and you need to create a Range object from it."}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1474480650, "post_id": 39623172, "comment_id": 66552388, "body": "How can I dim this shape when it is clicked and return it to normal color upon a second click"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1474481890, "post_id": 39623172, "comment_id": 66553005, "body": "Thanks David, I will go deeper next time as stated :) @DukeLuke I am not quite sure if the life cycle of the object considers click event, you would need to look deeper for that matter HINT: Google Handle click events on Shapes."}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 2, "last_activity_date": 1474480137, "last_edit_date": 1474480137, "creation_date": 1474479614, "answer_id": 39623172, "question_id": 39623059, "link": "https://stackoverflow.com/questions/39623059/vba-code-to-hide-unhide-charts-boxes/39623172#39623172", "title": "VBA code to hide/unhide charts/boxes", "body": "<p>The error message gives you some hints, <em>Wrong number of arguments or invalid property assingment.</em> You're sending too many arguments to the <code>.Shapes</code> property.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821817.aspx\" rel=\"nofollow\"><code>Worksheet.Shapes</code> property</a> collection takes a single argument and returns a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841148.aspx\" rel=\"nofollow\"><code>Shapes</code> object</a>, which is a collection of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835842.aspx\" rel=\"nofollow\"><code>Shape</code> objects</a>. From the dox,</p>\n\n<blockquote>\n  <p>Use <code>Shapes(index)</code>, where <code>index</code> is the shape\u2019s name or index number, to return a single Shape object. </p>\n</blockquote>\n\n<p>And further:</p>\n\n<blockquote>\n  <p>Use <code>Shapes.Range(index)</code>, where <code>index</code> is the shape\u2019s name or index number or an array of shape names or index numbers, to return a <code>ShapeRange</code> collection that represents a subset of the Shapes collection.</p>\n</blockquote>\n\n<p>You need to set the elements in an array and specify the items within range </p>\n\n<pre><code> ActiveSheet.Shapes.Range(Array(\"Chart 20\", \"List Box 1\", \"Chart 19\", \"List Box 3\", \"Chart 22\", \"List Box 4\", \"Chart 24\", \"List Box 5\")).Visible = True\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1607, "favorite_count": 0, "accepted_answer_id": 39623172, "answer_count": 1, "score": 0, "last_activity_date": 1474480137, "creation_date": 1474479276, "question_id": 39623059, "link": "https://stackoverflow.com/questions/39623059/vba-code-to-hide-unhide-charts-boxes", "title": "VBA code to hide/unhide charts/boxes", "body": "<p>I wrote a vba code to hide/unhide charts/list boxes in my active sheet that I assigned to a \"button\" or just a shape that I pulled from the Insert Tab in excel. This code works with 1 shape, but I can't get it to work with multiple. I'm new to VBA so I'm not sure about all the nuances with the syntax. Here's what I have:</p>\n\n<pre><code>Sub OverviewB()\n\n    With ActiveSheet.Shapes(\"Rounded Rectangle 1\").TextFrame2.TextRange.Characters\n\n        If .Text = \"Hide Overview\" Then\n\n            .Text = \"Show Overview\"\n\n            ActiveSheet.Shapes(\"Chart 20\", \"List Box 1\", \"Chart 19\", \"List Box 3\", \"Chart 22\", \"List Box 4\", \"Chart 24\", \"List Box 5\").Visible = False\n\n        Else\n\n            .Text = \"Hide Overview\"\n\n                ActiveSheet.Shapes(\"Chart 20\", \"List Box 1\", \"Chart 19\", \"List Box 3\", \"Chart 22\", \"List Box 4\", \"Chart 24\", \"List Box 5\").Visible = True\n\n\n\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I did have a line seperator \"_\" in the middle of my chart/list box names so that it wasn't as wide, but I took that out because I thought it might be causing some errors.</p>\n\n<p>Can anyone see where the syntax error is here? The error I receive is:\n<strong>\"Runtime Error 450\": Wrong number of arguments or invalid property assingment.</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474474935, "post_id": 39621740, "comment_id": 66549237, "body": "One quick note, <code>Set RngToCopy = Range(&quot;a2:j56&quot;)</code> is missing the <code>.</code> before <code>Range()</code> to link it to <code>inputWks</code>. Thus, the <code>RngToCopy</code> is always going to be from the <code>ActiveSheet</code>, whatever that may be."}, {"owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1474475836, "post_id": 39621740, "comment_id": 66549754, "body": "Since you&#39;re new to VBA, have you tried to step thru the code using F8 and break points?  Here&#39;s a good how-to: <a href=\"http://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/debugging.html</a>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474476020, "post_id": 39621740, "comment_id": 66549860, "body": "Also, what&#39;s the <code>Application.GoTo .Cells(1)</code> supposed to do?"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474479886, "post_id": 39621740, "comment_id": 66552001, "body": "@BruceWayne He clears that range on the Master sheet, and moves focus to Master sheet range B2."}, {"owner": {"reputation": 5452, "user_id": 3714940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bwcdU.jpg?s=128&g=1", "display_name": "SiHa", "link": "https://stackoverflow.com/users/3714940/siha"}, "edited": false, "score": 0, "creation_date": 1474835424, "post_id": 39621740, "comment_id": 66682305, "body": "I see you tried to add the images to the answer below. You should <a href=\"https://stackoverflow.com/posts/39621740/edit\">edit</a> them into your question, instead."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "edited": false, "score": 0, "creation_date": 1474714514, "post_id": 39623183, "comment_id": 66651446, "body": "Thanksyou very much Tyeler for the prompt response but Its still writing all the code in one row but I would like to have all 56 rows from master sheet to record sheet every day when I press the button follow the previous day recording.  please giude me with full code.  Many thanks in advance."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "edited": false, "score": 0, "creation_date": 1474751061, "post_id": 39623183, "comment_id": 66662106, "body": "@senthuran I don&#39;t really understand your question.. I&#39;ve updated my answer to list a bunch of different options. Just swap out your <code>For Loop</code> for whichever one fits your needs.. Maybe a picture of what you want the end result to be would help."}, {"owner": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "edited": false, "score": 0, "creation_date": 1474794729, "post_id": 39623183, "comment_id": 66669986, "body": "Thanks Tyeler, your Transfer Master Range to record, Offset by Date and Username is working perfectly OK for me but when I create another record in master sheet  press the button to record in &quot;record sheet&quot; its overwriting on previous record. I wanted to use the next available blank row to record each time.please see the screen shot thanks again."}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "edited": false, "score": 0, "creation_date": 1474836621, "post_id": 39623183, "comment_id": 66682671, "body": "@senthuran Sorry, there is one more change you have to make I forgot to tell you about. On the line where you first define <code>nextRow</code>, it should be searching in column C, not A. <code>nextRow = historyWks.Cells(historyWks.Rows.Count, &quot;C&quot;).End(xlUp).Offset(1, 0).Row</code>"}, {"owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "reply_to_user": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "edited": false, "score": 0, "creation_date": 1474836743, "post_id": 39623183, "comment_id": 66682703, "body": "@senthuran If your report sheet looks too cluttered, on <code>nextRow</code> you can change the <code>.Offset(2,0)</code> to put a space between record entries. Should make it easier to navigate, if it works for you. If I&#39;ve answered your original question, would you mind marking this as the answer? Thanks!"}, {"owner": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "edited": false, "score": 0, "creation_date": 1474839354, "post_id": 39623183, "comment_id": 66683411, "body": "Thank you so much Tyler ,it&#39;s working perfectly as I expected thank to you.ill make this question as answered now. Thanks again.kindly Senthuran"}], "tags": [], "owner": {"reputation": 1068, "user_id": 5360811, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AlXj1.jpg?s=128&g=1", "display_name": "Tyeler", "link": "https://stackoverflow.com/users/5360811/tyeler"}, "is_accepted": true, "score": 0, "last_activity_date": 1474836662, "last_edit_date": 1474836662, "creation_date": 1474479655, "answer_id": 39623183, "question_id": 39621740, "link": "https://stackoverflow.com/questions/39621740/copy-range-of-data-and-paste-in-recording-sheet-without-overwrite-and-follow-the/39623183#39623183", "title": "Copy Range of Data and paste in recording sheet without overwrite and follow the next available line", "body": "<p>You had a few errors in your code that I've corrected for you. This code works for me. It takes the 10 columns of data from \"Master sheet\" and places all of the data on 1 row in \"report\". On the report page, it places everything on the next available row.\n<strong>Issues I found:</strong></p>\n\n<ol>\n<li><p>You didn't define which worksheet your range was coming from when Setting <code>RngToCopy</code></p></li>\n<li><p>In your <code>For Loop</code>, you were trying to get the value of your entire range. What should have gone there was your Variant.Value <code>myCell.Value</code></p></li>\n</ol>\n\n<p><strong>Note:</strong> I removed a lot of your <code>With blocks</code>, not because they were wrong or anything like that, just a personal preference. I left notes in the codes where errors were corrected. </p>\n\n<pre><code>Option Explicit\nSub UpdateReport2()\n\n    Dim historyWks As Worksheet, inputWks As Worksheet\n    Dim RngToCopy As Range, myCell\n    Dim nextRow As Long, oCol As Long\n\n    Set inputWks = ThisWorkbook.Sheets(\"Master Sheet\")\n    Set historyWks = ThisWorkbook.Sheets(\"report\")\n\n    nextRow = historyWks.Cells(historyWks.Rows.Count, \"C\").End(xlUp).Offset(1, 0).Row\n\n    Set RngToCopy = inputWks.Range(\"A2:J56\") 'assigned the sheet the range comes from\n\n    If Application.CountA(RngToCopy) &lt;&gt; RngToCopy.Cells.Count Then\n        MsgBox \"Please fill in all the cells!\", Title:=\"Missing Data\"\n        Exit Sub\n    End If\n\n    With historyWks.Cells(nextRow, \"A\")\n        .Value = Now\n        .NumberFormat = \"dd/mm/yyyy\"\n    End With\n\n    historyWks.Cells(nextRow, \"B\").Value = Application.UserName\n\n    '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;THIS IS THE FOR LOOP TO CHANGE&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n    oCol = 3\n    For Each myCell In RngToCopy.Cells\n        historyWks.Cells(nextRow, oCol).Value = myCell.Value 'you want the cell value, not range value\n        oCol = oCol + 1\n    Next myCell\n    '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\n    'clear input cells that contain constants\n    On Error Resume Next\n       With inputWks.Range(\"B2:J56\").Cells.SpecialCells(xlCellTypeConstants)\n            .ClearContents\n            Application.GoTo .Cells(1) ', Scroll:=True     \n       End With\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p><strong>To Transfer Master Range to One Row on record</strong></p>\n\n<pre><code>oCol = 3\nFor Each mycell In RngToCopy.Cells\n    historyWks.Cells(nextRow, oCol).Value = mycell.Value 'you want the cell value, not range value\n    oCol = oCol + 1\nNext mycell\n</code></pre>\n\n<p><strong>To Transfer Master Range to One Column on record</strong></p>\n\n<pre><code>oCol = 3\nFor Each mycell In RngToCopy.Cells\n    historyWks.Cells(nextRow, oCol).Value = mycell.Value 'you want the cell value, not range value\n    nextRow = nextRow + 1\nNext mycell\n</code></pre>\n\n<p><strong>To Transfer Master Range to record, Offset by Date and Username</strong></p>\n\n<pre><code>For Each mycell In RngToCopy.Cells\n    historyWks.Cells(mycell.Row + nextRow - 2, mycell.Column + 2).Value = mycell.Value 'you want the cell value, not range value\nNext mycell\n</code></pre>\n\n<p><strong>To Transfer Master Range to record, Columns and Rows swapped</strong></p>\n\n<pre><code>For Each mycell In RngToCopy.Cells\n    historyWks.Cells(mycell.Column + nextRow - 1, mycell.Row + 1).Value = mycell.Value 'you want the cell value, not range value\nNext mycell\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3860059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15bd33e72b38fdb79bff37947596b4b?s=128&d=identicon&r=PG&f=1", "display_name": "senthuran", "link": "https://stackoverflow.com/users/3860059/senthuran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 39623183, "answer_count": 1, "score": 0, "last_activity_date": 1494424622, "creation_date": 1474474816, "last_edit_date": 1474475346, "question_id": 39621740, "link": "https://stackoverflow.com/questions/39621740/copy-range-of-data-and-paste-in-recording-sheet-without-overwrite-and-follow-the", "title": "Copy Range of Data and paste in recording sheet without overwrite and follow the next available line", "body": "<p>I'm very new to VBA but i manage to gather up a code that I actually need.\nbut the code is recording multiple rows in one row. I need to record range of rows every week and clear master sheet only specified columns.\n2nd issue is is not recording to the next available row when I press the macro button 2nd time.please help me to sort this out. here is my Code:</p>\n\n<pre><code>Option Explicit\nSub UpdateReport2()\n\n    Dim historyWks As Worksheet\n    Dim inputWks As Worksheet\n    Dim RngToCopy As Range\n    Dim nextRow As Long\n    Dim oCol As Long\n\n\n    Dim myCell As Range\n\n\n\n    Set inputWks = Worksheets(\"Master Sheet\")\n    Set historyWks = Worksheets(\"report\")\n\n    With historyWks\n        nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n    End With\n\n    With inputWks\n        Set RngToCopy = Range(\"a2:j56\")\n\n        If Application.CountA(RngToCopy) &lt;&gt; RngToCopy.Cells.Count Then\n            MsgBox \"Please fill in all the cells!\"\n            Exit Sub\n        End If\n    End With\n\n    With historyWks\n        With .Cells(nextRow, \"A\")\n            .Value = Now\n            .NumberFormat = \"dd/mm/yyyy\"\n        End With\n        .Cells(nextRow, \"B\").Value = Application.UserName\n        oCol = 3\n        For Each myCell In RngToCopy.Cells\n            historyWks.Cells(nextRow, oCol).Value = RngToCopy.Value\n            oCol = oCol + 1\n        Next myCell\n    End With\n\n    'clear input cells that contain constants\n    With inputWks\n      On Error Resume Next\n         With .Range(\"b2:j56\").Cells.SpecialCells(xlCellTypeConstants)\n              .ClearContents\n              Application.GoTo .Cells(1) ', Scroll:=True\n         End With\n      On Error GoTo 0\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6859320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee01b9e0ad618fc20ee56a2d699cf82?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Smasal", "link": "https://stackoverflow.com/users/6859320/todd-smasal"}, "edited": false, "score": 0, "creation_date": 1474558645, "post_id": 39621505, "comment_id": 66589972, "body": "So what if to trigger this event I need to find the word Summary as it goes through the range in column A.  sorry I am really bad at coding and just starting to read up on it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 6859320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee01b9e0ad618fc20ee56a2d699cf82?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Smasal", "link": "https://stackoverflow.com/users/6859320/todd-smasal"}, "edited": false, "score": 0, "creation_date": 1474558793, "post_id": 39621505, "comment_id": 66590105, "body": "<code>c</code> represents the current cell that is being iterated over in <code>&quot;A2:A500&quot;</code>.  <code>If c.Value = &quot;Summary&quot; then</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1, "user_id": 6859320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee01b9e0ad618fc20ee56a2d699cf82?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Smasal", "link": "https://stackoverflow.com/users/6859320/todd-smasal"}, "edited": false, "score": 0, "creation_date": 1474560627, "post_id": 39621505, "comment_id": 66591371, "body": "You should start by watching this series <a href=\"https://www.youtube.com/playlist?list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Into to VBA</a> on youtube"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1474473960, "creation_date": 1474473960, "answer_id": 39621505, "question_id": 39621307, "link": "https://stackoverflow.com/questions/39621307/vba-code-to-copy-cells-from-previous-row-if-a-cell-has-a-specific-name/39621505#39621505", "title": "vba code to copy cells from previous row if a cell has a specific name", "body": "<pre><code>Sub CopyDataFromPreviosRow()\n    Application.ScreenUpdating = False\n    Dim c As Range\n\n    For Each c In Range(\"A2:A500\")\n        If c.Value = c.Offset(-1).Value Then\n            c.EntireRow.Columns(\"B:L\").Value = c.Offset(-1).EntireRow.Columns(\"B:L\").Value\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6859320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee01b9e0ad618fc20ee56a2d699cf82?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Smasal", "link": "https://stackoverflow.com/users/6859320/todd-smasal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2948, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1474483522, "creation_date": 1474473317, "last_edit_date": 1531164843, "question_id": 39621307, "link": "https://stackoverflow.com/questions/39621307/vba-code-to-copy-cells-from-previous-row-if-a-cell-has-a-specific-name", "title": "vba code to copy cells from previous row if a cell has a specific name", "body": "<p>I have a formula in Excel that will check the value of a cell and if it is True then it will copy the data from the previous cell, if it is not, cell will remain blank.</p>\n\n<pre><code>=IF(A2=\"Summary\",B1,\"\")\n</code></pre>\n\n<p>I would want to create VBA code that would check the range of A, A1:A500 and if it is equal to Summary  then copy the data in the previous row from columns B, C, D, E, F, G, H, I, J, K, L.</p>\n\n<p>So some columns already have existing data in them .</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1474473061, "post_id": 39621191, "comment_id": 66548075, "body": "This thing with .Activate and true at the end of the .Find is wrong. Take a look here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839746.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 4, "last_activity_date": 1474473614, "last_edit_date": 1474473614, "creation_date": 1474473135, "answer_id": 39621253, "question_id": 39621191, "link": "https://stackoverflow.com/questions/39621191/excel-macro-search-for-word-on-sheet/39621253#39621253", "title": "Excel macro search for word on sheet", "body": "<p>Consider:</p>\n\n<pre><code>Sub findText()\nDim r As Range\nSet r = Cells.Find(What:=\"Tons\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\nIf Not r Is Nothing Then\n    MsgBox \"Word Found\"\nElse\n    MsgBox \"Word Not Found\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><em>Try to create a <code>Range</code> and then test if you succeeded.</em></p>\n"}], "owner": {"reputation": 147, "user_id": 3264602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c11f2021f402f0bd655c17842669729b?s=128&d=identicon&r=PG&f=1", "display_name": "user3264602", "link": "https://stackoverflow.com/users/3264602/user3264602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1474473614, "creation_date": 1474472938, "question_id": 39621191, "link": "https://stackoverflow.com/questions/39621191/excel-macro-search-for-word-on-sheet", "title": "Excel macro search for word on sheet", "body": "<p>This is an easy one, but I can't get it to work. I need to search for the word \"Tons\" on a sheet. </p>\n\n<pre><code>Sub findText()\n\nIf Cells.Find(What:=\"Tons\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate = True Then\nMsgBox \"Word Found\"\nElse\nMsgBox \"Word Not Found\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I get the error \"Object variable or With Block variable not set\". My code works whenever the word \"Tons\" is on a sheet but comes back with an error whenever it is not. \nThanks for the help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1474472876, "creation_date": 1474472876, "answer_id": 39621173, "question_id": 39620995, "link": "https://stackoverflow.com/questions/39620995/error-handling-conditions/39621173#39621173", "title": "Error handling conditions", "body": "<pre><code>On Error Resume Next\nSheets(\"Sheet1\").Range(\"D2:D250\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nOn Error Goto 0\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 39621173, "answer_count": 1, "score": 0, "last_activity_date": 1474472876, "creation_date": 1474472356, "last_edit_date": 1531164843, "question_id": 39620995, "link": "https://stackoverflow.com/questions/39620995/error-handling-conditions", "title": "Error handling conditions", "body": "<p>The line below stops running the code if there are no empty cells in D row </p>\n\n<pre><code>    Sheets(\"Sheet1\").Range(\"D2:D250\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>how can I modify the code to avoid that?</p>\n"}, {"tags": ["vba", "excel", "for-loop", "delete-row", "strikethrough"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1474471590, "post_id": 39620661, "comment_id": 66547116, "body": "Loop backward if you&#39;re deleting rows."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1474471610, "post_id": 39620661, "comment_id": 66547129, "body": "You should never delete rows in a loop like that. Use a reverse loop. Search stackoverflow. I have answered a post before"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1474473079, "post_id": 39620661, "comment_id": 66548087, "body": "see my <a href=\"http://stackoverflow.com/questions/19241905/vba-conditional-delete-loop-not-working\">post</a> You can also use a range object to identify the rows you want to delete. It is much faster than deleting rows in a loop"}, {"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1474475092, "post_id": 39620661, "comment_id": 66549337, "body": "Thanks for the tip about reverse looping, but now that it&#39;s working it is also very slow.  @Siddharth Rout: I will look into your post now to see if I can make sense of your method"}], "answers": [{"comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1474476332, "post_id": 39621111, "comment_id": 66550031, "body": "@ThomasInzina Thanks for the catch, much appreciated!"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1474476315, "last_edit_date": 1474476315, "creation_date": 1474472705, "answer_id": 39621111, "question_id": 39620661, "link": "https://stackoverflow.com/questions/39620661/entirerow-delete-skips-entries-in-for-loop/39621111#39621111", "title": "&quot;entirerow.delete&quot; skips entries in For loop", "body": "<p>Find the end of your range:</p>\n\n<pre><code>Dim wSheet As Worksheet : Set wSheet = ThisWorkbook.Worksheets(\"Sheetname\")\nDim lastRow\n' gets the last row in col 1, adjust as required\nlastRow = wSheet.Cells(wSheet.Rows.Count, 1).End(xlUp).Row \n</code></pre>\n\n<p>Now perform a For loop, backwards.  The issue you are facing is that when you delete a row, the data moves up (for example: row 56 gets deleted, row 57 becomes 56).  The solution is to delete from the bottom up.</p>\n\n<pre><code>For myLoop = lastRow to 2 Step -1 ' or to 1 if you've no header row\n    Set myRange  = wSheet.Range(\"A\" &amp; myLoop)\n    For mySubLoop = 1 To Len(myRange.Value)\n        'If any letter is strikethrough,delete entire row \n        If myRange.Characters(mySubLoop, 1).Font.Strikethrough = True Then\n            myRange.EntireRow.Delete\n            Exit For ' skip out of this inner loop and move to the next row\n        End If\n    Next\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1474476526, "post_id": 39622217, "comment_id": 66550146, "body": "++ Good Job on arriving at a solution :)"}], "tags": [], "owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "is_accepted": true, "score": 2, "last_activity_date": 1474476410, "last_edit_date": 1495541703, "creation_date": 1474476410, "answer_id": 39622217, "question_id": 39620661, "link": "https://stackoverflow.com/questions/39620661/entirerow-delete-skips-entries-in-for-loop/39622217#39622217", "title": "&quot;entirerow.delete&quot; skips entries in For loop", "body": "<p>Thanks to all of your quick responses I figured it out. Special thanks @Siddarth Rout for nudging me towards a (slightly) quicker method on this thread here: <a href=\"https://stackoverflow.com/questions/19241905/vba-conditional-delete-loop-not-working\">VBa conditional delete loop not working</a>\nHere's the working code in case anyone is curious:</p>\n\n<pre><code>Dim delRange As Range\nDim ws2 As Worksheet\nDim i As Long\n\n'Find Lastrow in ws2\nLastRow2 = ws2.Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\nWith ws2\n    For i = 1 To LastRow2\n        If .Cells(i, 2).Font.Strikethrough = True Then\n'This if statement adds all the identified rows to the range that will be deleted\n            If delRange Is Nothing Then\n                Set delRange = .Rows(i)\n            Else\n                Set delRange = Union(delRange, .Rows(i))\n            End If\n        End If\n    Next i\n\n    If Not delRange Is Nothing Then delRange.Delete\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 1, "accepted_answer_id": 39622217, "answer_count": 2, "score": 1, "last_activity_date": 1474476410, "creation_date": 1474471449, "question_id": 39620661, "link": "https://stackoverflow.com/questions/39620661/entirerow-delete-skips-entries-in-for-loop", "title": "&quot;entirerow.delete&quot; skips entries in For loop", "body": "<p>I'm trying to clean up a set of data and noticed something strange with vba function entirerow.delete\nThe following code will, as intended, delete the entire row if it is in the format strikethrough, but will skip the rows immediately following it, if they are also in that format. It seems like a it takes a row that is not in the strikethrough format to \"reset\" the ability to delete more rows. Does anyone know why, or what I could do to debug this?</p>\n\n<pre><code>For Each rng In rng1\n'Check each character in the cell\n    For i = 1 To Len(rng.Value)\n'If any letter is Strikethrough,delete entire column\n        If rng.Characters(i, 1).Font.Strikethrough = True Then\n            rng.Select    'just serves the purpose of observing which rows are being selected\n            rng.EntireRow.Delete\n        GoTo NextRng\n        End If\n    Next i\nNextRng:\nNext rng\n</code></pre>\n\n<p>I should say that I have found a workaround using a different approach, but it is very slow:</p>\n\n<pre><code>'Delete cells that have the strikethrough format - works but is super slow!\nws2.Range(\"B2\").Activate\nDo Until ActiveCell.Value = \"\"\n    If ActiveCell.Font.Strikethrough = True Then\n        ActiveCell.EntireRow.Delete\n        Else: ActiveCell.Offset(1, 0).Activate\n    End If\nLoop\n</code></pre>\n\n<p>If anyone has an alternative method to solve this issue that is also fast, I'd also be immensely grateful for your input.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474471666, "post_id": 39620594, "comment_id": 66547162, "body": "When you step through it does it work?"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474471705, "post_id": 39620594, "comment_id": 66547193, "body": "yes if i brake after the refresh it works"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474471774, "post_id": 39620594, "comment_id": 66547241, "body": "Take a look at <a href=\"http://stackoverflow.com/questions/22083668/wait-until-activeworkbook-refreshall-finishes-vba\" title=\"wait until activeworkbook refreshall finishes vba\">stackoverflow.com/questions/22083668/&hellip;</a>"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474471852, "post_id": 39620594, "comment_id": 66547289, "body": "Also to note i am reasonably new to VBA, and i no i have the refresh in twice in the posted example i have been trying all sorts to get it working this is just the current state"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474472032, "post_id": 39620594, "comment_id": 66547418, "body": "i have tried that at the end of the first macro and it makes no difference"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474472110, "post_id": 39620594, "comment_id": 66547464, "body": "just spotted the post under it let me try that"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474472677, "post_id": 39620594, "comment_id": 66547834, "body": "tried the second solution and that fails with Variable not defined"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1474472705, "post_id": 39620594, "comment_id": 66547850, "body": "Sub Refresh_All_Data_Connections()     For Each objConnection In ThisWorkbook.Connections         &#39;Get current background-refresh value         bBackground = objConnection.ODBCConnection.BackgroundQuery         &#39;Temporarily disable background-refresh         objConnection.ODBCConnection.BackgroundQuery = False         &#39;Refresh this connection         objConnection.Refresh         &#39;Set background-refresh value back to original value         objConnection.ODBCConnection.BackgroundQuery = bBackground     Next     MsgBox &quot;Finished refreshing all data connections&quot; End Sub"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1474476588, "post_id": 39620594, "comment_id": 66550188, "body": "Try <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">removing the <code>.Select</code></a> and work directly with the sheets. Your first macro is just one line, between the <code>RefreshAll</code>: <code>Sheets(&quot;Execution&quot;).PivotTables(&quot;PivotTable1&quot;).PivotCache.Re&zwnj;&#8203;fresh</code>  Also, what variable was not defined when you tried <code>DoEvents</code> suggestion?"}], "answers": [{"comments": [{"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "edited": false, "score": 0, "creation_date": 1474529235, "post_id": 39622544, "comment_id": 66570149, "body": "1st solution fails to update the data connections before the error message is displayed"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "edited": false, "score": 0, "creation_date": 1474529283, "post_id": 39622544, "comment_id": 66570175, "body": "2nd Solution produces an application -defined or object defined error (run-time error 1004)"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "edited": false, "score": 0, "creation_date": 1474529327, "post_id": 39622544, "comment_id": 66570198, "body": "on the second solution i have changed the connections to ODBCConnection as this is what i am using , Still fails as above"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "edited": false, "score": 0, "creation_date": 1474530706, "post_id": 39622544, "comment_id": 66571062, "body": "I have also stripped the second solution down to just the refresh (not changing the background settings) and then the message and this still fails as with the other solutions the data connection is updated and refreshed after the message is generated."}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "edited": false, "score": 0, "creation_date": 1474532224, "post_id": 39622544, "comment_id": 66572005, "body": "also worth a mention when i step through t it works as expected this is only an issue when it is run as a whole"}, {"owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "edited": false, "score": 0, "creation_date": 1474532743, "post_id": 39622544, "comment_id": 66572282, "body": "i have also tried adding a wait in case the DoEvents is overlooked some how and the refresh is still not completing till after the message box is closed"}], "tags": [], "owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "is_accepted": false, "score": 0, "last_activity_date": 1474482194, "last_edit_date": 1495535243, "creation_date": 1474477525, "answer_id": 39622544, "question_id": 39620594, "link": "https://stackoverflow.com/questions/39620594/excell-refreshall-runs-after-other-macros/39622544#39622544", "title": "Excell RefreshAll runs after other macros", "body": "<p>Here are the two solutions based on this <a href=\"https://stackoverflow.com/questions/22083668/wait-until-activeworkbook-refreshall-finishes-vba\">link</a></p>\n\n<p>First Solution:</p>\n\n<pre><code>Sub CheckTrafficLights1()\n\n\n    ActiveWorkbook.RefreshAll\n    DoEvents\n    Sheets(\"Execution\").PivotTables(\"PivotTable1\").PivotCache.Refresh\n    DoEvents ' Not sure if necessary.\n\n    If Sheets(\"Traffic Lights\").Range(\"G2\").Value &gt; \"0\" Then\n        MsgBox \"Error with data!\" &amp; vbCr &amp; \n        \"Please Note There is an issue with the data\" &amp; vbCr &amp; \n        \"See Traffic Lights for more details!\", vbOKOnly + vbExclamation, \n        \"Red Traffic Lights\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Second solution:</p>\n\n<pre><code>Sub CheckTrafficLights2()\n\n    For Each objConnection In ThisWorkbook.Connections\n        'Get current background-refresh value\n        bBackground = objConnection.OLEDBConnection.BackgroundQuery\n\n        'Temporarily disable background-refresh\n        objConnection.OLEDBConnection.BackgroundQuery = False\n\n        'Refresh this connection\n        objConnection.Refresh\n\n        'Set background-refresh value back to original value\n        objConnection.OLEDBConnection.BackgroundQuery = bBackground\n    Next\n    Sheets(\"Execution\").PivotTables(\"PivotTable1\").PivotCache.Refresh\n    DoEvents ' Not sure if necessary.\n\n    If Sheets(\"Traffic Lights\").Range(\"G2\").Value &gt; \"0\" Then\n        MsgBox \"Error with data!\" &amp; vbCr &amp; \n        \"Please Note There is an issue with the data\" &amp; vbCr &amp; \n        \"See Traffic Lights for more details!\", vbOKOnly + vbExclamation, \n        \"Red Traffic Lights\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "is_accepted": true, "score": 0, "last_activity_date": 1474536206, "creation_date": 1474536206, "answer_id": 39635104, "question_id": 39620594, "link": "https://stackoverflow.com/questions/39620594/excell-refreshall-runs-after-other-macros/39635104#39635104", "title": "Excell RefreshAll runs after other macros", "body": "<p>Ok so i have tried all sorts to get this to work and have managed with the below, \nThis seems to do the trick: </p>\n\n<pre><code>Application.CalculateUntilAsyncQueriesDone\nApplication.CalculateFullRebuild\nApplication.CalculateUntilAsyncQueriesDone\n</code></pre>\n\n<p>as in the below full query </p>\n\n<pre><code>Sub CheckTrafficLights2()\n    For Each objConnection In ThisWorkbook.Connections\n             objConnection.Refresh\nDoEvents\n    Next\nThisWorkbook.RefreshAll\n\nApplication.CalculateUntilAsyncQueriesDone\nApplication.CalculateFullRebuild\nApplication.CalculateUntilAsyncQueriesDone\n\nSheets(\"Execution\").PivotTables(\"PivotTable1\").PivotCache.Refresh\n    If Sheets(\"Traffic Lights\").Range(\"G2\").Value &gt; \"0\" Then\n        MsgBox \"Error with data!\" &amp; vbCr &amp; \"Please Note There is an issue with the data\" &amp; vbCr &amp; \"See Traffic Lights for more details!\", vbOKOnly + vbExclamation, \"Red Traffic Lights\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 18, "user_id": 5069144, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V9GadDW9k7E/AAAAAAAAAAI/AAAAAAAAAFM/AB15S4H8N2E/photo.jpg?sz=128", "display_name": "craig booth", "link": "https://stackoverflow.com/users/5069144/craig-booth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 39635104, "answer_count": 2, "score": 0, "last_activity_date": 1474536206, "creation_date": 1474471252, "question_id": 39620594, "link": "https://stackoverflow.com/questions/39620594/excell-refreshall-runs-after-other-macros", "title": "Excell RefreshAll runs after other macros", "body": "<p>I want to refresh my workbook and then run a check on a cell and if value > 0 display a message, the code i have seems right and logical but the refresh is done after the check value, i have tried spliting these into seperate macros and calling them in sequence but the refresh still runs after the check. not sure if it is worth noting that the refresh involves refreshing data connections to an SQL DB. </p>\n\n<p>this is the two macros i have at the moment :</p>\n\n<pre><code>Sub RefreshMacro()\n\nActiveWorkbook.RefreshAll\nSheets(\"Execution\").Select\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\nSheets(\"Traffic Lights\").Select\nActiveWorkbook.RefreshAll\n\nEnd Sub\nSub ErrorMessage()\nIf Sheets(\"Traffic Lights\").Range(\"G2\").Value &gt; \"0\" Then\nMsgBox \"Error with data!\" &amp; vbCr &amp; \n\"Please Note There is an issue with the data\" &amp; vbCr &amp; \n\"See Traffic Lights for more details!\", vbOKOnly + vbExclamation, \n\"Red Traffic Lights\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "checkbox", "activex", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 39, "user_id": 5581245, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yNGFs.jpg?s=128&g=1", "display_name": "Steve101", "link": "https://stackoverflow.com/users/5581245/steve101"}, "edited": false, "score": 0, "creation_date": 1474555350, "post_id": 39623635, "comment_id": 66587616, "body": "@Steve101 If this answer worked for you, you can &quot;Accept&quot; the answer by clicking on the green checkmark."}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": true, "score": 1, "last_activity_date": 1474481228, "creation_date": 1474481228, "answer_id": 39623635, "question_id": 39620568, "link": "https://stackoverflow.com/questions/39620568/vba-checkboxes-in-word/39623635#39623635", "title": "VBA checkboxes in Word", "body": "<p>I'm not exactly sure what your design is, but assuming you have 3 checkboxes and you want to hide the section if all three are checked or show the section otherwise (including re-showing the section if the user unchecks one of the three), I suggest creating a separate function that updates the format of the section anytime a checkbox is clicked:</p>\n\n<pre><code>Private Sub CheckBox21_Click()\n    UpdateSection\nEnd Sub\n\nPrivate Sub CheckBox22_Click()\n    UpdateSection\nEnd Sub\n\nPrivate Sub CheckBox23_Click()\n    UpdateSection\nEnd Sub\n\nPublic Sub UpdateSection()\n    If CheckBox21.Value = True And CheckBox22.Value = True And CheckBox23.Value = True Then\n        'Code to hide section\n    Else\n        'Code to show section\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5581245, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yNGFs.jpg?s=128&g=1", "display_name": "Steve101", "link": "https://stackoverflow.com/users/5581245/steve101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5172, "favorite_count": 0, "accepted_answer_id": 39623635, "answer_count": 1, "score": 1, "last_activity_date": 1474481228, "creation_date": 1474471181, "last_edit_date": 1474471813, "question_id": 39620568, "link": "https://stackoverflow.com/questions/39620568/vba-checkboxes-in-word", "title": "VBA checkboxes in Word", "body": "<p>I have a word document which has lots of pages, and sections which after each step have an <code>ActiveX</code> control check box.</p>\n\n<p>At the end of the document there is a completion table which has the name of the sections and when the last check box for a certain section is checked, it turns that part of the table green.</p>\n\n<p>So for an example:</p>\n\n<p>SECTION 1:</p>\n\n<p>Text</p>\n\n<p>(Checkbox 1)</p>\n\n<p>moretext</p>\n\n<p>(Checkbox 2)</p>\n\n<p>evenmoretext</p>\n\n<p>(Checkbox 3)</p>\n\n<p>Completion list:</p>\n\n<p>Section 1</p>\n\n<p>What I am trying to achieve is have some vba that will check to see if ALL of the checkboxes are ticked, and then make the section one part on the table at the end green.</p>\n\n<p>I currently have it working so it turns it green but only when then last checkbox (3) is checked.</p>\n\n<p>Is there anyway to do this?</p>\n\n<p>There is also another matter: I have a button at the top of the document that hides a few of the sections throughout the document, which when pressed, checks any checkboxes it is going to be hiding first. (I use page breaks to show which parts I want to hide)</p>\n\n<p>This is a problem however because the <code>ActiveX</code> checkboxes do not hide, and so I have written some VBA which instead makes them super tiny, and then resizes them after its done.</p>\n\n<p>Here is the vba I have so far:</p>\n\n<pre><code>Private Sub DTSCheckBox_Click()\n\n    If (DTSCheckBox.Value = True And AdminCheckBox.Value = True) Then\n        Section2Complete.Caption = \"Complete\"\n        Section2Complete.BackColor = RGB(0, 255, 0)\n        CheckAndAmmendBy.Caption = UpgradeTechnic.Text\n    Else\n        Section2Complete.Caption = \"Outstanding\"\n        Section2Complete.BackColor = RGB(255, 0, 0)\n        CheckAndAmmendBy.Caption = \"\"\n    End If\n\nEnd Sub\n\nPrivate Sub V4ToV6Button_Click()\n\n    ActiveDocument.Sections(2).Range.Font.Hidden = True\n    ActiveDocument.Sections(4).Range.Font.Hidden = True\n    ActiveDocument.Sections(6).Range.Font.Hidden = True\n    ActiveDocument.Sections(8).Range.Font.Hidden = True\n    Section15Complete.Caption = \"\": Section15Complete.BackColor = RGB(255, 255, 255)\n    ActiveDocument.Tables(1).Rows(15).SetHeight 1, wdRowHeightExactly\n    SQLScriptCheckbox.Value = True\n    SQLScriptCheckbox.Height = 1\n    SQLScriptCheckbox.Width = 1\n    SQLScriptCheckbox.Enabled = False\n    RestoreEmailScriptCheckBox.Value = True\n    RestoreEmailScriptCheckBox.Height = 1\n    RestoreEmailScriptCheckBox.Width = 1\n    RestoreEmailScriptCheckBox.Enabled = False\n    SQLCleanScriptCheckBox.Value = True\n    SQLCleanScriptCheckBox.Height = 1\n    SQLCleanScriptCheckBox.Width = 1\n    SQLCleanScriptCheckBox.Enabled = False\n    SandboxJobHasBeenSetUpCheckBox.Value = True\n    SandboxJobHasBeenSetUpCheckBox.Width = 1\n    SandboxJobHasBeenSetUpCheckBox.Height = 1\n    SandboxJobHasBeenSetUpCheckBox.Enabled = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "range", "cells"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1474470378, "post_id": 39620218, "comment_id": 66546304, "body": "You have your rows and columns switched <code>Worksheets(&quot;Thermal Data&quot;).Cells(106, 7).Interior.Color = 65535</code>"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1474470745, "post_id": 39620218, "comment_id": 66546578, "body": "Also, <code>E106</code> isn&#39;t changing as both the commands refer to <code>G106</code> (Column 7 is <code>G</code>).  Use 5 for column <code>E</code> and you&#39;ll see it works."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474471202, "post_id": 39620218, "comment_id": 66546853, "body": "you could use one line only: <code>Worksheets(&quot;Thermal Data&quot;).Range(&quot;E106,G106&quot;).Interior.Color = 65535</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1474470400, "creation_date": 1474470400, "answer_id": 39620242, "question_id": 39620218, "link": "https://stackoverflow.com/questions/39620218/vba-cells-vs-range-why-is-cells-not-working/39620242#39620242", "title": "VBA Cells vs Range - Why is Cells not working?", "body": "<p>You should be looking in the wrong cell somewhere. Take a look at this, it works:</p>\n\n<pre><code>Sub Macro4()\n    Cells(1, 1).Interior.Color = 65535\n    Range(\"A3\").Interior.Color = 65535\nEnd Sub\n</code></pre>\n\n<p>Hint - in the cell the first value is the row, then the column.</p>\n"}], "owner": {"reputation": 31, "user_id": 3317613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41bff749a3dfc1a4064039a3cef91bbc?s=128&d=identicon&r=PG&f=1", "display_name": "K00kykelly", "link": "https://stackoverflow.com/users/3317613/k00kykelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521480558, "creation_date": 1474470305, "last_edit_date": 1521480558, "question_id": 39620218, "link": "https://stackoverflow.com/questions/39620218/vba-cells-vs-range-why-is-cells-not-working", "title": "VBA Cells vs Range - Why is Cells not working?", "body": "<p>I have the following code in an excel workbook module. Why don't both E106 and G106 turn yellow?? </p>\n\n<pre><code>Sub Macro4()\n    Worksheets(\"Thermal Data\").Cells(7, 106).Interior.Color = 65535\n    Worksheets(\"Thermal Data\").Range(\"G106\").Interior.Color = 65535\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1474470807, "post_id": 39620189, "comment_id": 66546622, "body": "What was your code that put it in a spreadsheet cell?"}, {"owner": {"reputation": 13, "user_id": 6849552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a00339e7c212b8db399cd1310b881d5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul  Kuriakides", "link": "https://stackoverflow.com/users/6849552/paul-kuriakides"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1474471281, "post_id": 39620189, "comment_id": 66546896, "body": "Set R = Range(&quot;A2:A6&quot;)"}, {"owner": {"reputation": 13, "user_id": 6849552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a00339e7c212b8db399cd1310b881d5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul  Kuriakides", "link": "https://stackoverflow.com/users/6849552/paul-kuriakides"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1474471329, "post_id": 39620189, "comment_id": 66546927, "body": "So at the start i did     ....Dim R As Range.... Then just at the end of the code i added   ....  Set R = Range(&quot;A2:A6&quot;)....."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6849552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a00339e7c212b8db399cd1310b881d5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul  Kuriakides", "link": "https://stackoverflow.com/users/6849552/paul-kuriakides"}, "edited": false, "score": 0, "creation_date": 1474471405, "post_id": 39620578, "comment_id": 66546989, "body": "Thanks for the help."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 13, "user_id": 6849552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a00339e7c212b8db399cd1310b881d5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul  Kuriakides", "link": "https://stackoverflow.com/users/6849552/paul-kuriakides"}, "edited": false, "score": 0, "creation_date": 1474471432, "post_id": 39620578, "comment_id": 66547009, "body": "You bet! Just updated to work with the Range variable mentioned in your comments above."}, {"owner": {"reputation": 13, "user_id": 6849552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a00339e7c212b8db399cd1310b881d5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul  Kuriakides", "link": "https://stackoverflow.com/users/6849552/paul-kuriakides"}, "edited": false, "score": 0, "creation_date": 1474471997, "post_id": 39620578, "comment_id": 66547399, "body": "Yeah i just changed the range to ....Sheet1.Range(Cells.Address).CopyFromRecordset rcs..... So I could display all the celsl"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1474471409, "last_edit_date": 1474471409, "creation_date": 1474471205, "answer_id": 39620578, "question_id": 39620189, "link": "https://stackoverflow.com/questions/39620189/displaying-an-sql-query-in-vba-to-appear-on-a-spread-sheet/39620578#39620578", "title": "Displaying an SQL query in VBA to appear on a spread sheet", "body": "<p>You've got a good start, but in the end you are left with an opened recordset full of data and... you don't do anything with it. It's not going to magically show up in your worksheet. You can use the range object's method <code>.copyFromRecordset</code> to quickly dump the recordset to a worksheet range. </p>\n\n<p>At the end of your code, before <code>END SUB</code> put:</p>\n\n<pre><code> Sheet1.Range(\"A1\").CopyFromRecordset rcs\n</code></pre>\n\n<p>It will then dump the results of your query into Sheet1 at Cell <code>A1</code>.</p>\n\n<p>Updated to work with the code mentioned in your question's comments. After you do your <code>Set R = Range(\"A2:A6\")</code> you can use that <code>.copyfromrecordset</code> method to dump to <code>R</code>:</p>\n\n<pre><code> R.CopyFromRecordset rcs\n</code></pre>\n\n<p>For the sake of thoroughness, you can also iterate through your recordset, and even the fields. After you have loaded your recordset you can do things like:</p>\n\n<pre><code> Dim f as Adodb.Field\n\n\n 'loop through each record\n While now rcs.EOF \n\n     'loop through all the fields in this record:\n     For each f in rcs.fields\n         'get the fields name and value:\n         debug.print f.name, f.value\n     Next f\n\n     'refer to a specific field (instead of looping through fields)\n     debug.print rcs.Fields(\"price_crossing\").name, rcs.Fields(\"price_Crossing\").value\n\n     'go to the next record\n     rsc.movenext\n Loop\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6849552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a00339e7c212b8db399cd1310b881d5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul  Kuriakides", "link": "https://stackoverflow.com/users/6849552/paul-kuriakides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 39620578, "answer_count": 1, "score": 0, "last_activity_date": 1474471409, "creation_date": 1474470232, "last_edit_date": 1531164843, "question_id": 39620189, "link": "https://stackoverflow.com/questions/39620189/displaying-an-sql-query-in-vba-to-appear-on-a-spread-sheet", "title": "Displaying an SQL query in VBA to appear on a spread sheet", "body": "<p>I'm trying to make this SQL query display in an excel sheet but each time I run the macro nothing happens. I've tried adding a range with cells in so it could display there but nothing happens. There are no error messages when i run the code as well. </p>\n\n<pre><code>Sub Run()\n\nCall ConnectDB\n\nDim Cmd As ADODB.Command\nDim rcs As ADODB.Recordset\nDim SQL As String\nDim res() As String\n\nSet Cmd = New ADODB.Command\nSet Cmd.ActiveConnection = con\n\nSQL = \"select tl.id, al.price_crossing, al.price_exchange_fees, tl.charges_execution, tl.charges_mariana, tl.charges_exchange, tl.trade_date, un.value, tl.nb_crossing  from mfb.trade_leg AS tl \" &amp; _\n\"inner join mfb.trade t on t.id = tl.id_trade \" &amp; _\n\"inner join mfb.instrument i on t.id_instrument = i.id \" &amp; _\n\"inner join mfb.instrument_type it on it.id = i.id_instrument_type \" &amp; _\n\"inner join mfb.options o on o.id_instrument = i.id \" &amp; _\n\"inner join mfbref.mfb.underlying un on un.id = o.id_underlying \" &amp; _\n\"inner join mfb.allocation_leg al on al.id_trade_leg = tl.id \" &amp; _\n\"where tl.trade_date &gt; '20160101' and t.state = 3 \"\n\nCmd.CommandText = SQL\nSet rcs = Cmd.Execute()\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1474480274, "post_id": 39620337, "comment_id": 66552218, "body": "Thank you! This works ! However, after the code has executed, I get the dialogue box: &quot;Can&#39;t enter break mode at this time&quot;. Is there a way to bypass this?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1474480626, "post_id": 39620337, "comment_id": 66552376, "body": "Nevermind! SIlly me, I was running the code using F8.. works when it executes normally"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1474470607, "creation_date": 1474470607, "answer_id": 39620337, "question_id": 39619970, "link": "https://stackoverflow.com/questions/39619970/add-reference-using-guid/39620337#39620337", "title": "Add reference using GUID", "body": "<p>Try this</p>\n\n<pre><code>ActiveWorkbook.VBProject.References.AddFromGuid _\nGUID:=\"{0002E157-0000-0000-C000-000000000046}\", _\nMajor:=5, Minor:=3\n</code></pre>\n\n<p>You may want to see <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264769(v=office.15).aspx\" rel=\"nofollow\">This</a></p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "accepted_answer_id": 39620337, "answer_count": 1, "score": 1, "last_activity_date": 1474470607, "creation_date": 1474469671, "question_id": 39619970, "link": "https://stackoverflow.com/questions/39619970/add-reference-using-guid", "title": "Add reference using GUID", "body": "<p>I am trying to activate Visual Basic For Applications Extensibility Library(version 5.3) programmatically using GUID. My code encounters the error \"Object library not registered\" when trying to do this. I have enabled access to VBProjects. </p>\n\n<p>Any help would be appreciated!</p>\n\n<pre><code>Sub ActivateReferenceLibrary()\n\n\n    'Activate Visual Basic for Applications Extensibility Library (version 5.3)\n      ActiveWorkbook.VBProject.References.AddFromGuid \"{002E157-0000-0000-C000-000000000046}\", 0, 0\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "postgresql", "insert"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474468897, "post_id": 39619588, "comment_id": 66545375, "body": "Add <code>Option Explicit</code> to the top of the module.  It will help in debugging issues like this. You need to add <code>Dim Action As String</code> and change your execute line to <code>cnn.Execute(Action)</code>. This won&#39;t return a recordset."}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474469731, "post_id": 39619588, "comment_id": 66545862, "body": "I have added: Option Explicit - on the top, also: Dim Category As Variant Dim segment As Variant, Dim brand As Variant. Amend this: Dim LRow As Long and replace Result = cnn.Execute(Action) with  cnn.Execute (Action). And still the same error"}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474470254, "post_id": 39619588, "comment_id": 66546228, "body": "Dim Action As String - I have added this also but still gets the issue"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474473751, "post_id": 39619588, "comment_id": 66548545, "body": "Add this just before the <code>Action = </code> line  - <code>Debug.Print TypeName(Category), TypeName(segment), TypeName(brand)</code>  What is the output in the Immediate pane?"}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474536147, "post_id": 39619588, "comment_id": 66574385, "body": "Here is what immediate window shows: Variant()     Variant()     Variant()"}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474536965, "post_id": 39619588, "comment_id": 66574933, "body": "In the postgre&#39;s table, all these columns (category, segment, brand) have a &quot;character varying&quot; data type. if its matter"}], "answers": [{"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1474539509, "creation_date": 1474539509, "answer_id": 39636393, "question_id": 39619588, "link": "https://stackoverflow.com/questions/39619588/sql-insert-in-vba-code/39636393#39636393", "title": "SQL &quot;Insert&quot; in VBA code", "body": "<p>You are assigning range to <code>Category</code>, <code>segment</code> and <code>brand</code> variables. Once a range is assigned to a variable, it converts the variable from variant to an array (unless the variable is specifically declared otherwise). Now that the variables are arrays, you have to reference the item (i.e. <code>Category(0)</code>). Try referencing the item in your <code>Action =</code> statement</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474546534, "post_id": 39636583, "comment_id": 66581227, "body": "Thanks Vincent. Now I get &quot;Invalid procedure call or argument&quot; error in the line Action =...  In my test file LRow = 4000, Is this too many for this procedure?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474548167, "post_id": 39636583, "comment_id": 66582402, "body": "Since your data are in row, I thin you need to transpose your array before using Join."}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474617883, "post_id": 39636583, "comment_id": 66613825, "body": "hmm, so I am wondering is this a good idea to use COPY instead of INSERT INTO [link] (<a href=\"https://www.postgresql.org/docs/9.2/static/sql-copy.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.2/static/sql-copy.html</a>)? I feel weak in sql so that&#39;s I am asking"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474618239, "post_id": 39636583, "comment_id": 66613992, "body": "Still not working with Transpose as in my edited answer?"}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474618374, "post_id": 39636583, "comment_id": 66614060, "body": "If I transpose data I will get 4000 column. What if my data reach 100k?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474618846, "post_id": 39636583, "comment_id": 66614307, "body": "Well, I don&#39;t know if there is limitation on the OCDB connection, but I think Strings are limited to 2^31 characters, so there is some room. You can also try to insert data in smaller blocks (by groups of 1k rows?) with a for loop."}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474637700, "post_id": 39636583, "comment_id": 66625968, "body": "Vincent, I followed your solution and finally import sth to my postgres table. It is still imperfect but I think need slight adjustement...."}, {"owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "edited": false, "score": 0, "creation_date": 1474637949, "post_id": 39636583, "comment_id": 66626149, "body": "...This is how my postgres table looks now <a href=\"http://oi67.tinypic.com/2rcpqbk.jpg\" rel=\"nofollow noreferrer\">link</a>. It has one row only and the JOIN values are all inside a cell"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1474548349, "last_edit_date": 1474548349, "creation_date": 1474540070, "answer_id": 39636583, "question_id": 39619588, "link": "https://stackoverflow.com/questions/39619588/sql-insert-in-vba-code/39636583#39636583", "title": "SQL &quot;Insert&quot; in VBA code", "body": "<p>Category, Segment and Brand are 2D-arrays, you can't concatenate them in a string like that. You first need to transpose them to 1D-Array, then use Join to build a string from them:</p>\n\n<p>First replace</p>\n\n<pre><code>Category = .Range(\"A3:A\" &amp; LRow).Value\nsegment = .Range(\"B3:B\" &amp; LRow).Value\nbrand = .Range(\"C3:C\" &amp; LRow).Value\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Category = Application.Transpose(.Range(\"A3:A\" &amp; LRow).Value)\nsegment = Application.Transpose(.Range(\"B3:B\" &amp; LRow).Value)\nbrand = Application.Transpose(.Range(\"C3:C\" &amp; LRow).Value)\n</code></pre>\n\n<p>Then replace</p>\n\n<pre><code>Action = \"INSERT INTO temp.avon_dictionary_test\" &amp; \" VALUES ('{\" &amp; Category &amp; \"}','{\" &amp; segment &amp; \"}','{\" &amp; brand &amp; \"}')\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Action = \"INSERT INTO temp.avon_dictionary_test\" &amp; \" VALUES ('{\" &amp; Join(Category, \",\") &amp; \"}','{\" &amp; Join(segment, \",\") &amp; \"}','{\" &amp; Join(brand, \",\") &amp; \"}')\"\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff196261.aspx\" rel=\"nofollow\">Transpose</a> will change the (1 to LRow, 1 to 1) arrays to plain (1 to LRow) arrays.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264098.aspx\" rel=\"nofollow\">Join</a> will concatenate the values from the arrays in a string separated by the delimiter (here \",\").</p>\n"}], "owner": {"reputation": 13, "user_id": 6682880, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4abc579cdadf112651c9a0d67a025d6c?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek", "link": "https://stackoverflow.com/users/6682880/bartek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1019, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1474636887, "creation_date": 1474468566, "question_id": 39619588, "link": "https://stackoverflow.com/questions/39619588/sql-insert-in-vba-code", "title": "SQL &quot;Insert&quot; in VBA code", "body": "<p>There is an issue (Type mismatch error) in the code below in the line:\nAction = ....</p>\n\n<p>I try to use Sql INSERT INTO to copy arrays from Excel and paste it into PostgreSQl database.</p>\n\n<pre><code>Sub UploadToDatamart2()\n\n'Defining connection objects\nDim cnn As New ADODB.Connection\nDim rst As New ADODB.Recordset\nDim LastRow As Long\n\nSheets(\"AVON DICTIONARY\").Activate\n\n'Opening the ODBC connection\ncnn.Open \"Driver={PostgreSQL Unicode(x64)};DSN=postgres;Server=XXX;Port=5432;UID=YYY;PWD=ZZZ;Database=hurtownia;READONLY=0;PROTOCOL=6.4;FAKEOIDINDEX=0;SHOWOIDCOLUMN=0;ROWVERSIONING=0;SHOWSYSTEMTABLES=1\"\n\n'Find the last row\nWith ActiveSheet\n    LRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n'Picking up cell values\n    Category = .Range(\"A3:A\" &amp; LRow).Value\n    segment = .Range(\"B3:B\" &amp; LRow).Value\n    brand = .Range(\"C3:C\" &amp; LRow).Value\nEnd With\n\n'Defining and executing SQL insert\nAction = \"INSERT INTO temp.avon_dictionary_test\" &amp; \" VALUES ('{\" &amp; Category &amp; \"}','{\" &amp; segment &amp; \"}','{\" &amp; brand &amp; \"}')\"\nResult = cnn.Execute(Action)\n\ncnn.Close\nEnd Sub\n</code></pre>\n\n<p>I would be glad if anyone could help</p>\n"}, {"tags": ["vba", "csv", "append"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474469074, "post_id": 39619581, "comment_id": 66545485, "body": "There are numerous examples of this on the site.  What have you tried?"}, {"owner": {"reputation": 53, "user_id": 5619709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e8e88f0dca16fff2fdb9db7851fe6f51?s=128&d=identicon&r=PG&f=1", "display_name": "user5619709", "link": "https://stackoverflow.com/users/5619709/user5619709"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474480964, "post_id": 39619581, "comment_id": 66552538, "body": "I set mainwb to be the .csv file. And then I did this. For i = 1 To 13         mainwb.Worksheets(&quot;test&quot;).Cells(main_i, i).Value = transfer_array(1, i) &amp; &quot;&quot;         Next i                                                                                               This let&#39;s me paste into the csv file. The &quot;&quot; allows me to seperate the columns (somehow). But now the csv file has a limit of 1Million rows! How can this be?"}], "owner": {"reputation": 53, "user_id": 5619709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e8e88f0dca16fff2fdb9db7851fe6f51?s=128&d=identicon&r=PG&f=1", "display_name": "user5619709", "link": "https://stackoverflow.com/users/5619709/user5619709"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474468536, "creation_date": 1474468536, "question_id": 39619581, "link": "https://stackoverflow.com/questions/39619581/append-xls-information-to-csv-file-vba", "title": "Append .xls Information to .csv File - VBA", "body": "<p>Say that I create an array that copy's from a .xls file in VBA and want to APPEND that information to a .csv file somewhere on my drive. How do I do this? Mind you, I want it to append to the first blank row. Thanks,</p>\n\n<pre><code>Do While wb.Sheets(1).Cells(wb_i, 1) &lt;&gt; \"\"\n\n    For i = 1 To 13\n        transfer_array(1, i) = wb.Sheets(1).Cells(wb_i, i).Value\n    Next i\n\n'THIS WILL BE WHERE I OPEN AND APPEND TO THE CSV FILE\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1474468376, "creation_date": 1474468376, "answer_id": 39619521, "question_id": 39619458, "link": "https://stackoverflow.com/questions/39619458/excel-to-voice-cells-value-whenever-it-is-selected-with-vba/39619521#39619521", "title": "Excel to voice cells&#39; value whenever it is selected with VBA", "body": "<p>Try this out:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Debug.Print Target.Address\nEnd Sub\n</code></pre>\n\n<p>Then change it to speak, and not to debug. :)</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1474469897, "last_edit_date": 1474469897, "creation_date": 1474469434, "answer_id": 39619879, "question_id": 39619458, "link": "https://stackoverflow.com/questions/39619458/excel-to-voice-cells-value-whenever-it-is-selected-with-vba/39619879#39619879", "title": "Excel to voice cells&#39; value whenever it is selected with VBA", "body": "<p>If you want Excel to \"say\" whatever you enter in a cell, first run this short macro, then make entries:</p>\n\n<pre><code>Sub WhatDidYouEnter()\n    Application.Speech.SpeakCellOnEnter = True\nEnd Sub\n</code></pre>\n\n<p>and if you want Excel to \"say\" whatever you have Selected, then the Event Macro:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    With ActiveCell\n        If .Value &lt;&gt; \"\" Then Application.Speech.Speak (.Value)\n    End With\nEnd Sub\n</code></pre>\n\n<p>will do the trick.</p>\n"}], "owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 39619879, "answer_count": 2, "score": 0, "last_activity_date": 1474469897, "creation_date": 1474468194, "last_edit_date": 1474468629, "question_id": 39619458, "link": "https://stackoverflow.com/questions/39619458/excel-to-voice-cells-value-whenever-it-is-selected-with-vba", "title": "Excel to voice cells&#39; value whenever it is selected with VBA", "body": "<p>I'm triyin to achieve that Excel \"says\" the value of a cell when placing on it.</p>\n\n<p>I've got this code but i'm able to hear cells' value only after i select another one. Can you help me?</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = True\n    Set Target = ActiveCell    \n    Application.Speech.Speak (Target)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1474467388, "creation_date": 1474467388, "answer_id": 39619159, "question_id": 39619094, "link": "https://stackoverflow.com/questions/39619094/how-to-pass-dynamic-string-parameter-to-a-select-case-in-vba/39619159#39619159", "title": "How to pass dynamic string parameter to a select case in VBA?", "body": "<p><code>str</code>is a variable and when put within quotes will behave as a string. Directly use it as shown below</p>\n\n<pre><code>Select Case sht.Name\n    Case str\n      'SVE UPDATE\nEnd Select   \n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 4388503, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f7e56f5fc3ecac98abdf6f33a095045?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta Reddy", "link": "https://stackoverflow.com/users/4388503/shweta-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 39619159, "answer_count": 1, "score": 1, "last_activity_date": 1474467388, "creation_date": 1474467205, "question_id": 39619094, "link": "https://stackoverflow.com/questions/39619094/how-to-pass-dynamic-string-parameter-to-a-select-case-in-vba", "title": "How to pass dynamic string parameter to a select case in VBA?", "body": "<p>I am having code like below.,</p>\n\n<pre><code>  'a User Defined function\n   Sub fill(str As String)\n   For Each sht In ThisWorkbook.Sheets\n     Select Case sht.Name\n        Case \"str\"\n          'SVE UPDATE\n     End Select\n    Next sht\n</code></pre>\n\n<p>I am passing variable as below.,</p>\n\n<pre><code>   fill(\"STP\") ' STP is sheet name\n   fill(\"SEZ\") 'SEZ is sheet name\n</code></pre>\n\n<p>so that I can update my data in all the sheets by passing as parameners.\nbut here I am not getting STP / SEZ passed to select case.\nAny help please.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 3206247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9OIV.gif?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3206247/marco"}, "is_accepted": false, "score": 0, "last_activity_date": 1474468504, "creation_date": 1474468504, "answer_id": 39619569, "question_id": 39618820, "link": "https://stackoverflow.com/questions/39618820/excel-transform-sub-to-function/39619569#39619569", "title": "Excel Transform Sub to Function", "body": "<p>Here is an example to create a function that brings just the first 3 letters of a cell:</p>\n\n<pre><code>Public Function FirstThree(Cell As Range) As String\n    FirstThree = Left(Cell.Text, 3)\nEnd Function\n</code></pre>\n\n<p>And using this in a Excel worksheet would be like:</p>\n\n<pre><code>=FirstThree(b1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6858671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c87ca591db2869fc290952e65b15c69?s=128&d=identicon&r=PG&f=1", "display_name": "AnBA", "link": "https://stackoverflow.com/users/6858671/anba"}, "edited": false, "score": 0, "creation_date": 1474618812, "post_id": 39620051, "comment_id": 66614286, "body": "Thanks! This is exacly how I have implemented it so far. Any suggestions how to get it run as a function is still much appreciated!"}], "tags": [], "owner": {"reputation": 11, "user_id": 6377866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022479605ffaad493e826297db85b5e8?s=128&d=identicon&r=PG&f=1", "display_name": "BKruk", "link": "https://stackoverflow.com/users/6377866/bkruk"}, "is_accepted": false, "score": 0, "last_activity_date": 1474469856, "creation_date": 1474469856, "answer_id": 39620051, "question_id": 39618820, "link": "https://stackoverflow.com/questions/39618820/excel-transform-sub-to-function/39620051#39620051", "title": "Excel Transform Sub to Function", "body": "<p>If the sub works fine and you just want to make it easier to call you can add a hotkey to execute the Macro. In the developer tab click on Macros then Options. You can then add a shortcut key (Crtl + \"the key you want\" it can be a shortcut key already used like C, V, S, but you will lose those functions (Copy, Paste Save, Print)\n<a href=\"http://i.stack.imgur.com/pikpa.jpg\" rel=\"nofollow\">enter image description here</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6858671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c87ca591db2869fc290952e65b15c69?s=128&d=identicon&r=PG&f=1", "display_name": "AnBA", "link": "https://stackoverflow.com/users/6858671/anba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1474469856, "creation_date": 1474466557, "question_id": 39618820, "link": "https://stackoverflow.com/questions/39618820/excel-transform-sub-to-function", "title": "Excel Transform Sub to Function", "body": "<p>I am quite new in VBA and wrote a subroutine that copy-paste cells from one document into another one. Being more precise, I am working in document 1 where I have names of several product (all in column \"A\"). For these product, I need to look up certain variables (e.g. sales) in a second document.</p>\n\n<p>The subroutine is doing the job quite nicely, but I want to use it as a funcion, i.e. I want to call the sub by typing in a cell \"=functionname(productname)\".</p>\n\n<p>I am grateful for any helpful comments!\nBest, Andreas </p>\n\n<pre><code>Sub copy_paste_data()\n\nDim strVerweis As String               \nDim Spalte                     \nDim Zeile                      \nDim findezelle1 As Range          \nDim findezelle2 As Range          \nDim Variable                    \nDim Produkt                     \n\n'Variable I need to copy from dokument 2\nVariable = \"frequency\"\n\n\n\n'Produkt I need to copy data from document 2\nProdukt = Cells(ActiveCell.Row, 1)\n\n\n\n'path, file and shhet of document 2\nConst strPfad = \"C:\\Users\\Desktop\\test\\\"          \nConst strDatei = \"Bezugsdok.xlsx\"           \nConst strBlatt = \"post_test\"              \n\n'open ducument 2\nWorkbooks.Open strPfad &amp; strDatei\nWorksheets(strBlatt).Select\n\nSet findezelle = ActiveSheet.Cells.Find(Variable)\nSpalte = Split(findezelle.Address, \"$\")(1)\n\nSet findezelle2 = ActiveSheet.Cells.Find(Produkt)\nZeile = Split(findezelle2.Address, \"$\")(2)\n\n\n\n'copy cell that I need\nstrZelle = Spalte &amp; Zeile                  'Zelladresse\nstrVerweis = \"'\" &amp; strPfad &amp; \"[\" &amp; strDatei &amp; \"]\" &amp; strBlatt &amp; \"'!\" &amp; strZelle\n\n'close document 2\nWorkbooks(strDatei).Close savechanges:=False\n\n\n\nWith ActiveCell\n   .Formula = \"=IF(\" &amp; strVerweis &amp; \"=\"\"\"\",\"\"\"\",\" &amp; strVerweis &amp; \")\"    \n   .Value = .Value                                                      \nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 1, "creation_date": 1474465449, "post_id": 39618144, "comment_id": 66542766, "body": "change <code>RefersToR1C1:=&quot;=Range(&quot;THREEMO&quot;)!C2:C3&quot;</code> to <code>RefersToR1C1:=Range(&quot;THREEMO&quot;) &amp; &quot;!C2:C3&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6855067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e1e59231c25a8dfc81a975dd078598?s=128&d=identicon&r=PG&f=1", "display_name": "Richard G", "link": "https://stackoverflow.com/users/6855067/richard-g"}, "edited": false, "score": 0, "creation_date": 1474479027, "post_id": 39618408, "comment_id": 66551494, "body": "So I found out that the &quot;!C5:C6&quot; is transferring over just like that with the quotation marks. This is not allowing the array to function correctly, but when I remove them it breaks."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6855067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e1e59231c25a8dfc81a975dd078598?s=128&d=identicon&r=PG&f=1", "display_name": "Richard G", "link": "https://stackoverflow.com/users/6855067/richard-g"}, "edited": false, "score": 0, "creation_date": 1474479168, "post_id": 39618408, "comment_id": 66551580, "body": "Sorry I just noticed a typo.. Now try the code that I posted above.. You may have to refrsh the page..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 25, "user_id": 6855067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e1e59231c25a8dfc81a975dd078598?s=128&d=identicon&r=PG&f=1", "display_name": "Richard G", "link": "https://stackoverflow.com/users/6855067/richard-g"}, "edited": false, "score": 0, "creation_date": 1474479225, "post_id": 39618408, "comment_id": 66551618, "body": "<code>ActiveWorkbook.Names.Add Name:=stNewTab, RefersToR1C1:=&quot;=&quot; &amp; stNewTab &amp; &quot;!C2:C3&quot;</code> Try this. It will work now :)"}, {"owner": {"reputation": 25, "user_id": 6855067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e1e59231c25a8dfc81a975dd078598?s=128&d=identicon&r=PG&f=1", "display_name": "Richard G", "link": "https://stackoverflow.com/users/6855067/richard-g"}, "edited": false, "score": 0, "creation_date": 1474480318, "post_id": 39618408, "comment_id": 66552234, "body": "I was doing it wrong. Thank you very much you got me back on track."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1474479147, "last_edit_date": 1474479147, "creation_date": 1474465518, "answer_id": 39618408, "question_id": 39618144, "link": "https://stackoverflow.com/questions/39618144/set-an-array-with-a-variable-name-vba/39618408#39618408", "title": "Set an Array with a variable name VBA", "body": "<p>Change</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=Range(\"THREEMO\"), RefersToR1C1:=\"=Range(\"THREEMO\")!C2:C3\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=stNewTab, _\n                         RefersToR1C1:=\"=\" &amp; stNewTab &amp; \"!C2:C3\"\n</code></pre>\n\n<p><strong>Note/Explanation</strong>: </p>\n\n<p><code>Range(\"THREEMO\")</code> within quotes is considered as a string. Keep it outside the quotes. Better still use the variable <code>stNewTab</code></p>\n\n<p>The line </p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"AUG\", RefersToR1C1:=\"=Aug!C5:C6\"\n</code></pre>\n\n<p>can also be written as </p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"AUG\", RefersToR1C1:=\"=\" &amp; \"Aug\" &amp; \"!C5:C6\"\n</code></pre>\n\n<p>Now all you have to do is replace \"Aug\" with the variable.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25, "user_id": 6855067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e1e59231c25a8dfc81a975dd078598?s=128&d=identicon&r=PG&f=1", "display_name": "Richard G", "link": "https://stackoverflow.com/users/6855067/richard-g"}, "edited": false, "score": 0, "creation_date": 1474513368, "post_id": 39618901, "comment_id": 66564307, "body": "@RichardGyou took off the <b>V</b> sign ? at least leave the upvote :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1474513655, "post_id": 39618901, "comment_id": 66564360, "body": "++ I upvoted your answer. Shai, one point though... Asking users to accept your answer or upvoting your answer is frowned upon in stackoverflow. No offence meant but it is considered &quot;begging&quot; which I am sure you do not want to do? ;)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1474513804, "post_id": 39618901, "comment_id": 66564389, "body": "@SiddharthRout you&#39;re right (it&#39;s 5:00 AM here). it&#39;s just the past few days I&#39;ve encountered too many answers of mine which were used later on with future posts, but the user never accepted them (a little frustrating)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1474514637, "post_id": 39618901, "comment_id": 66564604, "body": "Yeah I understand that. I have been there ;)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1474466734, "creation_date": 1474466734, "answer_id": 39618901, "question_id": 39618144, "link": "https://stackoverflow.com/questions/39618144/set-an-array-with-a-variable-name-vba/39618901#39618901", "title": "Set an Array with a variable name VBA", "body": "<p>Another option, you can set up the Range like this:</p>\n\n<pre><code>Dim Rng As range\nSet Rng = WS.Range(\"C5:C6\")\n</code></pre>\n\n<p>And then, you can use the <code>Names.Add</code> command a little different </p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=stNewTab, RefersTo:=Rng\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6855067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e1e59231c25a8dfc81a975dd078598?s=128&d=identicon&r=PG&f=1", "display_name": "Richard G", "link": "https://stackoverflow.com/users/6855067/richard-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1822, "favorite_count": 0, "accepted_answer_id": 39618408, "answer_count": 2, "score": 2, "last_activity_date": 1474479147, "creation_date": 1474464927, "last_edit_date": 1531164843, "question_id": 39618144, "link": "https://stackoverflow.com/questions/39618144/set-an-array-with-a-variable-name-vba", "title": "Set an Array with a variable name VBA", "body": "<p>I am trying to use VBA to set an array based on a cell value in my workbook. I have an Array set on my data called THREEMO. For this month the value is Aug. I want to add a Sheet named Aug and then set an array for Columns B:C and name them Aug as well. I was able to add the sheet and name it but the array is not letting me use the variable to name the array. Here is what I have so far:</p>\n\n<pre><code>Dim WS As Worksheet\nSet WS = Sheets.Add(After:=Sheets(Worksheets.Count))\nWS.Name = Range(\"THREEMO\")\n\nDim stNewTab As String\nstNewTab = Range(\"THREEMO\")\n\n'Set Arrays\nColumns(\"B:C\").Select\nActiveWorkbook.Names.Add Name:=Range(\"THREEMO\"), RefersToR1C1:=\"=Range(\"THREEMO\")!C2:C3\"\n</code></pre>\n\n<p>I am getting the error on the \"'Set Arrays\" section. This is what it looks like when I record the macro, so I am just having trouble setting up RefersToR1C1 with the variable for the month:</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"AUG\", RefersToR1C1:=\"=Aug!C5:C6\"\n</code></pre>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1474464844, "post_id": 39618054, "comment_id": 66542336, "body": "Did you use <code>.Replace</code>? You need <code>.Execute</code>."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474467570, "post_id": 39618054, "comment_id": 66544451, "body": "I haven&#39;t. I am looking at an example using .Execute instead, which does seem to be what I need to use. Trying to figure out how to implement."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474467844, "post_id": 39618054, "comment_id": 66544655, "body": "Are <a href=\"https://regex101.com/r/hZ2qT7/1\" rel=\"nofollow noreferrer\">these values matched correctly</a>? Or better <a href=\"https://regex101.com/r/hZ2qT7/2\" rel=\"nofollow noreferrer\">look at this one - <code>[12][0-9]{3}(?:[&#47;-][0-9]{2,4})?</code></a>. Or even enclose with <code>\\b</code>: <a href=\"https://regex101.com/r/hZ2qT7/3\" rel=\"nofollow noreferrer\"><code>\\b[12][0-9]{3}(?:[&#47;-][0-9]{2,4})?\\b</code></a>."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474468528, "post_id": 39618054, "comment_id": 66545133, "body": "Looking at the regex tester from your hyperlink, the only thing that isn&#39;t matched exactly is the last line, 1979-2012/2013. I have been trying to piece together all instances that will match, and if what you have provided is more accurate, I will definitely use it. Thank you. My alternative is to manually remove characters/numbers that aren&#39;t needed in every excel cell (roughly 10k), so I am trying my best to use regex, unless there is an alternative."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474468643, "post_id": 39618054, "comment_id": 66545221, "body": "Ok, does this - <a href=\"https://regex101.com/r/hZ2qT7/4\" rel=\"nofollow noreferrer\"><code>\\b[12][0-9]{3}(?:[&#47;-][0-9]{2,4})*\\b</code></a> - return all what you need?"}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474468755, "post_id": 39618054, "comment_id": 66545286, "body": "Almost, I have one more instance: 1951,52. Can the above be modified to add?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474468875, "post_id": 39618054, "comment_id": 66545363, "body": "Sure - <a href=\"https://regex101.com/r/hZ2qT7/5\" rel=\"nofollow noreferrer\"><code>\\b[12][0-9]{3}(?:[,&#47;-][0-9]{2,4})*\\b</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1474489744, "post_id": 39619831, "comment_id": 66557300, "body": "Having some difficulties converting this sub into a UDF. Trying to use Function FetchDates(data As String) As String. Then where Cell Contents = &quot;arbitrary value&quot;, I replaced that with data."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "edited": false, "score": 0, "creation_date": 1474522833, "post_id": 39619831, "comment_id": 66566901, "body": "Cell contents is the Cell.Value (a string). The result must also be a string. You might want to concat the match values found using any separator you want."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1474469610, "last_edit_date": 1474469610, "creation_date": 1474469184, "answer_id": 39619831, "question_id": 39618054, "link": "https://stackoverflow.com/questions/39618054/udf-regex-yyyy-only/39619831#39619831", "title": "UDF Regex - yyyy only", "body": "<p>You may use</p>\n\n<pre><code>\\b[12][0-9]{3}(?:[,/-][0-9]{2,4})*\\b\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/hZ2qT7/5\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Note</strong> that <code>\\b</code> might be removed if you are not interested in a whole word search.</p>\n\n<p><em>Pattern details</em>:</p>\n\n<ul>\n<li><code>\\b</code> - leading word boundary (the preceding char must be either a non-word char or the start of string)</li>\n<li><code>[12][0-9]{3}</code> - <code>1</code> or <code>2</code> followed with any 3 digits</li>\n<li><code>(?:[,/-][0-9]{2,4})*</code> - zero or more sequences (<code>(?:...)*</code>) of:\n\n<ul>\n<li><code>[,/-]</code> - a <code>,</code>, <code>/</code> or <code>-</code> characters</li>\n<li><code>[0-9]{2,4}</code> - any 2 to 4 digits</li>\n</ul></li>\n<li><code>\\b</code> - trailing word boundary (there must be a non-word char or the end of string after).</li>\n</ul>\n\n<p>Sample VBA code to grab all those values using <code>RegExp#Execute</code>:</p>\n\n<pre><code>Sub FetchDateLikeStrs()\nDim cellContents As String\nDim reg As regexp\nDim mc As MatchCollection\nDim m As match\n\nSet reg = New regexp\nreg.pattern = \"\\b[12][0-9]{3}(?:[,/-][0-9]{2,4})*\\b\"\nreg.Global = True\n\ncellContents = \"1951/52 1909-13  2005-2014  7 . (1989)-  1 (1933/34)-2 (1935/36) 1979-2012/2013  1951,52\"\nSet mc = reg.Execute(cellContents)\nFor Each m In mc\n Debug.Print m.Value\nNext\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ORh7R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ORh7R.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 39619831, "answer_count": 1, "score": 0, "last_activity_date": 1474469610, "creation_date": 1474464714, "last_edit_date": 1474464786, "question_id": 39618054, "link": "https://stackoverflow.com/questions/39618054/udf-regex-yyyy-only", "title": "UDF Regex - yyyy only", "body": "<p>I am just learning some regex, and I need help spitting out matches generated by my regex code. I found some very useful resources here to output anything not matched, but I want to output only the parts of a cell that do match. I am looking for dates in cells, that may be a single yyyy date or yyyy-yy, or the like (as shown from the sample data below). </p>\n\n<p>Sample data:</p>\n\n<pre><code>1951/52\n1909-13\n2005-2014\n7 . (1989)-\n1 (1933/34)-2 (1935/36)\n1979-2012/2013\n</code></pre>\n\n<p>Current Function Code: (A snippet found from an existing post here, but returns the replacement value instead of what was matched)</p>\n\n<pre><code>Function simpleCellRegex(Myrange As Range) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n    strPattern = \"([12][0-9]{3}[/][0-9]{2,4})|([12][0-9]{3}[-][0-9]{2,4})|([12][0-9]{3})\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "find"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 1, "creation_date": 1474465692, "post_id": 39618011, "comment_id": 66542948, "body": "Do try to avoid using <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">.Select</a>. That may be your problem. Instead, try <code>Set cel_checker = Worksheets(&quot;BU Names&quot;).Find</code>"}, {"owner": {"reputation": 1, "user_id": 6853459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a546b32546681cf96e388db5576184?s=128&d=identicon&r=PG&f=1", "display_name": "Dejw", "link": "https://stackoverflow.com/users/6853459/dejw"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1474466775, "post_id": 39618011, "comment_id": 66543821, "body": "Thanks for your answer. Although, it&#39;s not working due to bad reference here. We cannot refer to whole worksheet i believe, at least I am getting here &quot;Run-time error &#39;438&#39; Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1474469859, "post_id": 39618011, "comment_id": 66545946, "body": "Oh my mistake, I forgot to add the range. How about try something like <code>Set cel_checker = Sheets(&quot;BU Names&quot;).Range(Sheets(&quot;BU Names&quot;).Cells(2, 1), Sheets(&quot;BU Names&quot;).Cells(LastBU, 1)).Find</code>, and note you may need to move the <code>LastBU</code> variable outside of the <code>With</code>, unsure of how VBA uses variable scope regarding <code>With</code> statements."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474474417, "post_id": 39618011, "comment_id": 66548925, "body": "I all you need to do is check to see if a value is in a <code>Range</code>, you can skip the <code>.Find</code> and use <code>WorksheetFunction.CountIf(searchRange, value) &lt;&gt; 0</code> instead."}, {"owner": {"reputation": 1, "user_id": 6853459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a546b32546681cf96e388db5576184?s=128&d=identicon&r=PG&f=1", "display_name": "Dejw", "link": "https://stackoverflow.com/users/6853459/dejw"}, "edited": false, "score": 0, "creation_date": 1474532888, "post_id": 39618011, "comment_id": 66572370, "body": "thanks guys, Tim was right ;)"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1474474608, "creation_date": 1474474608, "answer_id": 39621683, "question_id": 39618011, "link": "https://stackoverflow.com/questions/39618011/find-method-within-a-loop-doesnt-work-while-selecting-a-variablewithin-a-rang/39621683#39621683", "title": ".find method within a loop doesn&#39;t work while selecting a variable(within a range)", "body": "<p>This should do what you want:</p>\n\n<pre><code>Set Myrange = Worksheets(\"Import Data\").Range(\"E5:G6\") '&lt;&lt;&lt;&lt; need Set here\n\nMyrange.Parent.Activate\n\nFor Each cel In Myrange\n\n    Is IsError(Application.Match(cel.Value, _\n               Worksheets(\"BU Names\").Range(\"A:A\"), 0)) Then\n\n          MsgBox \"Please correct \" &amp; cel.Address &amp; \" ('\" &amp; cel.Value &amp; _\n                 \"') as this is not valid Business Unit\"\n    End If\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6853459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a546b32546681cf96e388db5576184?s=128&d=identicon&r=PG&f=1", "display_name": "Dejw", "link": "https://stackoverflow.com/users/6853459/dejw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474474608, "creation_date": 1474464608, "last_edit_date": 1531164843, "question_id": 39618011, "link": "https://stackoverflow.com/questions/39618011/find-method-within-a-loop-doesnt-work-while-selecting-a-variablewithin-a-rang", "title": ".find method within a loop doesn&#39;t work while selecting a variable(within a range)", "body": "<p>I am trying to loop across each cell in a range (IN ACTIVE TAB \"Import Data\") and match it with values from range in de-actvie Tab (\"BU Names\"), in case of a cell that holds a string that is not compliant with my selected range i would like to inform the user about an error</p>\n\n<p>WHEN IT WORKS?\nWhen instead of few cells within a range I have only one.</p>\n\n<p>ERRORS WHILE:\nRange is brighter. </p>\n\n<hr>\n\n<h2><strong>working part</strong></h2>\n\n<pre><code>With Worksheets(\"BU Names\")\n\n    LastBU = .Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"BU Names\").Activate\n    .Range(.Cells(2, 1), .Cells(LastBU, 1)).Select\n    Worksheets(\"Import Data\").Activate\n\nEnd With\n</code></pre>\n\n<hr>\n\n<hr>\n\n<h2><strong>help below please</strong></h2>\n\n<pre><code>Myrange = Range(\"E5:G6\")\n\nFor Each cel In Myrange       \n    Set cel_checker = Selection.Find(What:=cel, After:=ActiveCell, LookIn:= _\n    xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:= _\n    xlNext, MatchCase:=True, SearchFormat:=False)        \n\n    If cel_checker Is Nothing Then\n        MsgBox \"Please correct \" &amp; cel2 &amp; \" as this is not valid Business Unit\"\n    End If\n\nNext\n</code></pre>\n\n<hr>\n\n<p>The problem seems to be at \"Set cel_checker = Selection.Find\" when it keeps under cel_cheker 'nothing' instead of values which is correct</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1474464466, "post_id": 39617867, "comment_id": 66542072, "body": "add the line <code>Set wbk = Workbook.Add</code> inside the <code>Do</code> loop, as first line, before <code>wbk.SaveAs &quot;C:\\Users\\User1\\Desktop\\abc\\&quot; &amp; i</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1474464600, "post_id": 39617867, "comment_id": 66542154, "body": "should be Workbook<b>s</b> <code>Set wbk = Workbooks.Add</code> and make sure the path <code>&quot;C:\\Users\\User1\\Desktop\\abc\\&quot;</code> exists"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1474464742, "post_id": 39617867, "comment_id": 66542259, "body": "path was ok. as @Slai said the biggest problem was with the &quot;s&quot; :)Thanks for your help guys."}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 2, "last_activity_date": 1474465137, "last_edit_date": 1474465137, "creation_date": 1474464657, "answer_id": 39618028, "question_id": 39617867, "link": "https://stackoverflow.com/questions/39617867/create-multiple-workbooks-in-certain-folder-location/39618028#39618028", "title": "create multiple workbooks in certain folder location", "body": "<p><code>Set wbk = Workbooks.Add</code></p>\n\n<p>You need to specify <code>Workbooks</code> instead of <code>Workbook</code>.</p>\n\n<p><code>Workbooks</code> is a collection object. You're adding a <code>Workbook</code> to the collection of <code>Workbooks</code>.</p>\n\n<p>You also need to change the order of your code, so you're either not closing the workbook each time, or so that you are closing the workbook, but you're then adding a new workbook (which doesn't really make much sense, but I'll show an example anyway).</p>\n\n<pre><code>Set wbk = Workbooks.Add\n\nDo Until i = 5\n    wbk.SaveAs \"C:\\Users\\User1\\Desktop\\abc\\\" &amp; i\n    i = i + 1\nLoop\n</code></pre>\n\n<p><strong>Or</strong></p>\n\n<pre><code>Do Until i = 5\n    Set wbk = Workbooks.Add\n    wbk.SaveAs \"F:\\\" &amp; i\n    wbk.Close\n    i = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474465137, "creation_date": 1474464235, "last_edit_date": 1474464414, "question_id": 39617867, "link": "https://stackoverflow.com/questions/39617867/create-multiple-workbooks-in-certain-folder-location", "title": "create multiple workbooks in certain folder location", "body": "<p>Lets say I want to create 5 workbooks in certain location. I was trying to use this code but it doesn't work. (run-time error, automation error), what is wrong with it?</p>\n\n<pre><code>Sub blabal()\n\nDim wbk As Workbook\nDim i As Integer\ni = 1\nSet wbk = Workbook.Add\n\nDo Until i = 5\n    wbk.SaveAs \"C:\\Users\\User1\\Desktop\\abc\\\" &amp; i\n    wbk.Close\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1474464670, "post_id": 39617785, "comment_id": 66542198, "body": "Here is a possible solution to your problem which doesn&#39;t require VBA: <a href=\"https://blog.jamesbayley.com/2013/03/14/create-the-union-of-two-tables-in-excel/\" rel=\"nofollow noreferrer\">blog.jamesbayley.com/2013/03/14/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1474465210, "post_id": 39617962, "comment_id": 66542588, "body": "@Ralph: you&#39;re right about unique values, I didn&#39;t notice it at my first (and too fast) reading of OP&#39;s question. I added a <code>RemoveDuplicates()</code> method on the final column C &quot;used&quot; range"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1474465525, "post_id": 39617962, "comment_id": 66542818, "body": "Slick and short! Like it. <i>(+1)</i>"}, {"owner": {"reputation": 33, "user_id": 6835299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771958639745270/picture?type=large", "display_name": "Sophie Fu", "link": "https://stackoverflow.com/users/6835299/sophie-fu"}, "edited": false, "score": 0, "creation_date": 1474465941, "post_id": 39617962, "comment_id": 66543158, "body": "Yes, I think my case is Union."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1474470942, "post_id": 39617962, "comment_id": 66546697, "body": "Thanks @Ralph and SophieFu"}, {"owner": {"reputation": 33, "user_id": 6835299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771958639745270/picture?type=large", "display_name": "Sophie Fu", "link": "https://stackoverflow.com/users/6835299/sophie-fu"}, "edited": false, "score": 0, "creation_date": 1474484346, "post_id": 39617962, "comment_id": 66554332, "body": "Thanks a lot. @user3598756"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1474465123, "last_edit_date": 1474465123, "creation_date": 1474464487, "answer_id": 39617962, "question_id": 39617785, "link": "https://stackoverflow.com/questions/39617785/excel-vba-find-the-union-of-two-tables/39617962#39617962", "title": "Excel VBA: find the union of two tables", "body": "<p><strong>edited</strong>: added removal of duplicated values</p>\n\n<p>try this</p>\n\n<pre><code>Sub main()\n    With Worksheets(\"Columns\") '&lt;--| change \"Columns\" to your actual worksheet name\n        With .Range(\"A1\", .Range(\"A1\").End(xlDown))\n            .Parent.Range(\"C1\").Resize(.Rows.Count).Value = .Value\n        End With\n        With .Range(\"B1\", .Range(\"B1\").End(xlDown))\n            .Parent.Range(\"C1\").End(xlDown).Offset(1).Resize(.Rows.Count).Value = .Value\n        End With\n        .Range(\"C1\", .Range(\"C1\").End(xlDown)).RemoveDuplicates Array(1)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6835299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771958639745270/picture?type=large", "display_name": "Sophie Fu", "link": "https://stackoverflow.com/users/6835299/sophie-fu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "accepted_answer_id": 39617962, "answer_count": 1, "score": 0, "last_activity_date": 1474465152, "creation_date": 1474464050, "last_edit_date": 1474465152, "question_id": 39617785, "link": "https://stackoverflow.com/questions/39617785/excel-vba-find-the-union-of-two-tables", "title": "Excel VBA: find the union of two tables", "body": "<p>I am new to <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> and I've got two updating columns of text &amp; I want to find the union of the two columns.  </p>\n\n<p><em>For Example</em></p>\n\n<pre><code>+---------+---------+\n| ColumnA | ColumnB |\n+---------+---------+\n|   ABC   |    F    |\n|   DE    |    F    |\n|   F     |   AB    |\n|   DBCA  |   CDE   |\n|   E     |         |\n+---------+---------+\n</code></pre>\n\n<p>I want to write the result in a new column <code>columnC</code> (<strong>order doesn't matter</strong>)</p>\n\n<pre><code>+---------+\n| ColumnC |\n+---------+\n|   ABC   |\n|   F     |\n|   DE    |\n|   DBCA  |\n|   E     |\n|   AB    |\n|   CDE   |\n+---------+\n</code></pre>\n\n<p>How to work out this? Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474463331, "post_id": 39617434, "comment_id": 66541286, "body": "try replacing <code>buildRef.Offset(i, 1)</code> with <code>buildRef.Offset(i, 1)).value</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1474465278, "post_id": 39617434, "comment_id": 66542639, "body": "what are the address ranges of <code>buildRef</code> and <code>range</code> ?"}, {"owner": {"reputation": 41, "user_id": 6858478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21edc45b6e798ef00a5092062eebd3c?s=128&d=identicon&r=PG", "display_name": "M&#228;rten", "link": "https://stackoverflow.com/users/6858478/m%c3%a4rten"}, "edited": false, "score": 0, "creation_date": 1474467103, "post_id": 39617434, "comment_id": 66544075, "body": "Adding .value still doesn&#39;t give me the correct answer."}, {"owner": {"reputation": 41, "user_id": 6858478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21edc45b6e798ef00a5092062eebd3c?s=128&d=identicon&r=PG", "display_name": "M&#228;rten", "link": "https://stackoverflow.com/users/6858478/m%c3%a4rten"}, "edited": false, "score": 0, "creation_date": 1474467250, "post_id": 39617434, "comment_id": 66544195, "body": "range is B2:B1466 and buildRef is C2 on a different sheet"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6858478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21edc45b6e798ef00a5092062eebd3c?s=128&d=identicon&r=PG", "display_name": "M&#228;rten", "link": "https://stackoverflow.com/users/6858478/m%c3%a4rten"}, "edited": false, "score": 0, "creation_date": 1474467048, "post_id": 39618160, "comment_id": 66544036, "body": "I&#39;ve checked offset(i,1)&#39;s values. They&#39;re correct."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 41, "user_id": 6858478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21edc45b6e798ef00a5092062eebd3c?s=128&d=identicon&r=PG", "display_name": "M&#228;rten", "link": "https://stackoverflow.com/users/6858478/m%c3%a4rten"}, "edited": false, "score": 0, "creation_date": 1474467320, "post_id": 39618160, "comment_id": 66544240, "body": "I just showed you it works. May I see your excel file? If yes then please upload it to a free file sharing site and share the link here. Also if the file and confidential date then replace it with dummy data"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1474464968, "creation_date": 1474464968, "answer_id": 39618160, "question_id": 39617434, "link": "https://stackoverflow.com/questions/39617434/using-a-relative-reference-offset-in-a-countif-function-in-excel-vba/39618160#39618160", "title": "Using a relative reference (offset) in a COUNTIF function in Excel VBA", "body": "<p>There is nothing wrong with the code. You are getting <code>0</code> because of your <code>i</code>. The <code>.Offset(i, 1)</code> may not be referring to the cell you think it is referring to. I would recommend stepping through the code to check the value of <code>i</code>.</p>\n\n<p>Here is an example to show it works. I have hard coded the value of <code>i</code> to demonstrate how it works.</p>\n\n<pre><code>Sub Sample()\n    Dim rng As Range, buildRef As Range\n\n    Set rng = [A1:A10]\n    Set buildRef = [D1]\n\n    buildRef.Offset(1, 2) = WorksheetFunction.CountIfs(rng, \"&gt;=\" &amp; buildRef.Offset(1, 1))\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YFyPj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YFyPj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 6858478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b21edc45b6e798ef00a5092062eebd3c?s=128&d=identicon&r=PG", "display_name": "M&#228;rten", "link": "https://stackoverflow.com/users/6858478/m%c3%a4rten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474464968, "creation_date": 1474463191, "last_edit_date": 1474463228, "question_id": 39617434, "link": "https://stackoverflow.com/questions/39617434/using-a-relative-reference-offset-in-a-countif-function-in-excel-vba", "title": "Using a relative reference (offset) in a COUNTIF function in Excel VBA", "body": "<p>I'm having problems using a relative reference (offset) in a COUNTIF function in Excel VBA:</p>\n\n<pre><code>buildRef.Offset(i, 2) = WorksheetFunction.CountIfs _\n            (range, \"&gt;=\" &amp; buildRef.Offset(i, 1))\n</code></pre>\n\n<p>This always results in 0 but I know that it's not the correct answer. However,</p>\n\n<p><code>WorksheetFunction.CountIfs (range, buildRef.Offset(i, 1))</code> does give the correct answer.</p>\n\n<p>Can anyone tell me why the <strong>COUNTIFS</strong> function doesn't work when the criteria is \"greater than\" some relative reference?</p>\n"}, {"tags": ["vba", "csv", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474463841, "post_id": 39617266, "comment_id": 66541664, "body": "If it&#39;s just the one file, I suspect that it&#39;s broken in some way - i.e. missing an end of file marker or something like that."}, {"owner": {"reputation": 33, "user_id": 1970101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96530d75513f77d19d5d4ff9c47acef?s=128&d=identicon&r=PG", "display_name": "JGR", "link": "https://stackoverflow.com/users/1970101/jgr"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474464143, "post_id": 39617266, "comment_id": 66541851, "body": "I tried creating a completelly new file and manually added a few records with the column lengths as in the specifications and i got the same error. And like i said when importing the file manually it works perfectly"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1474467142, "post_id": 39617266, "comment_id": 66544102, "body": "Have you done Repair+Compact and <a href=\"http://stackoverflow.com/a/3268188/3820271\">Decompile</a> on your DB?"}, {"owner": {"reputation": 33, "user_id": 1970101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96530d75513f77d19d5d4ff9c47acef?s=128&d=identicon&r=PG", "display_name": "JGR", "link": "https://stackoverflow.com/users/1970101/jgr"}, "edited": false, "score": 0, "creation_date": 1474468305, "post_id": 39617266, "comment_id": 66544993, "body": "Just tried it and didn&#39;t help either but thanks"}], "owner": {"reputation": 33, "user_id": 1970101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96530d75513f77d19d5d4ff9c47acef?s=128&d=identicon&r=PG", "display_name": "JGR", "link": "https://stackoverflow.com/users/1970101/jgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474465108, "creation_date": 1474462719, "last_edit_date": 1474465108, "question_id": 39617266, "link": "https://stackoverflow.com/questions/39617266/runtime-error-in-access-2010-when-importing-csv-with-vba", "title": "Runtime error in Access 2010 when importing csv with VBA", "body": "<p>i am writing a simple application in Access 2010 which imports FlatFiles into the database according to an import specification (fixed column lengths).</p>\n\n<p>The following line:</p>\n\n<pre><code>DoCmd.TransferText acImportFixed, \"Betreuer_Importspezifikation\", \"Betreuer\", Me.txt_betreuer_path, 0\n</code></pre>\n\n<p>Produces this error: </p>\n\n<blockquote>\n  <p>Runtime Error '3035': System resouce exceeded</p>\n</blockquote>\n\n<p>When importing this exact File with this specification in the table manually everything works fine. The same line works with other files and the according specifications. And i also tried to not use the textfield but hardcode the path (same error occured).</p>\n\n<p>Also the file that raises this error only has 37 records with 11 columns and files with >4k records and 150 columns work find so i don't think the size is the problem (although the error message sounds like it).</p>\n\n<p>Does anyone have an idea what the problem could be? I am really out of ideas at this point.</p>\n\n<p>BR</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 834, "user_id": 3206247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9OIV.gif?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3206247/marco"}, "edited": false, "score": 0, "creation_date": 1474463880, "post_id": 39617002, "comment_id": 66541695, "body": "I saw the same problem here: <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/72201c7c-81e6-4f6a-b109-ddad86dc8e59/bug-naming-activex-checkbox-in-excel-2010?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a> . Apparently it is the limit."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1474464164, "post_id": 39617002, "comment_id": 66541866, "body": "you can see it directly in Excel UI, where my Excel 2013 limits it to 31 characters. You could use alphanumeric names: &quot;a1&quot;, &quot;a2&quot;,..."}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474464357, "post_id": 39617002, "comment_id": 66541985, "body": "The Microsoft Documentation doesn&#39;t have any information regarding max name length, but I cannot find a work around to get more than 33 characters. If it is not necessary to use &quot;a&quot; repeatedly, @user3598756 has a great suggestion!"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 1, "creation_date": 1474468819, "post_id": 39617002, "comment_id": 66545323, "body": "@PartyHatPanda its not about repeating A. This was just my testcase to figure out why is excel failing :) My thought was to have some checkbox tree structure, with parent&lt;&gt;child reference. But names was too long..."}], "answers": [{"comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1474468918, "post_id": 39619079, "comment_id": 66545385, "body": "Good point, i was just trying to type longer name in Excel manualy (and everything was okay). Checkbox was even created with that name, but after that i cannot acces him."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1474467159, "creation_date": 1474467159, "answer_id": 39619079, "question_id": 39617002, "link": "https://stackoverflow.com/questions/39617002/vba-checkbox-name-length-limit/39619079#39619079", "title": "VBA checkbox name length limit", "body": "<p>Whenever you face such kind of limits, simply use the inbuilt office help. However to make the best use of help in your case, manually try to change the name of the control and you will see an error as shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/G7clt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G7clt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Simply click on help and it will take you to the relevant MSDN page in you have internet connectivity :)</p>\n\n<p>Please refer to the link <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251363(v=office.15).aspx\" rel=\"nofollow noreferrer\">Not a legal object name</a></p>\n\n<p>In case the link dies</p>\n\n<blockquote>\n  <p>Not a legal object name: 'item</p>\n  \n  <p>Office 2013 and later Other Versions </p>\n  \n  <p>Form and control names must start with a letter and can be a maximum\n  of 40 characters \u2014 including letters, numbers, and underscores (_).\n  Note that the Name property of a form or control is different from the\n  Label properties \u2014 Caption, Text, and Value \u2014 that label or display\n  the contents of a control at run time. These properties can be\n  restricted keywords, can begin with a number, and can contain\n  nonalphanumeric characters.</p>\n</blockquote>\n"}], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1474467159, "creation_date": 1474462062, "question_id": 39617002, "link": "https://stackoverflow.com/questions/39617002/vba-checkbox-name-length-limit", "title": "VBA checkbox name length limit", "body": "<p>i have just simple question. Is here some limit in excel VBA to checkbox name?</p>\n\n<p>i have code like this, and when im using name longer than 33 characters, i have error Unable to set the Name property of the checkbox class (its only a test code)</p>\n\n<p>So is here some way to bypass this?</p>\n\n<pre><code> Sub createTestBox()\n\n    Dim shimSheet As Worksheet\n    Set shimSheet = Sheets(\"ShimSheet\")\n\n    Dim chkbox As checkBox\n\n    Dim i As Long\n\n    Dim name As String\n    name = \"\"\n\n    For i = 1 To 50\n        name = name &amp; \"a\"\n        With shimSheet.Cells(12 + i, 3)\n\n            shimSheet.CheckBoxes.Add(.Left, .Top, .Width, .Height).name = name\n            shimSheet.CheckBoxes(name).Delete\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "count", "median"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1474460720, "post_id": 39616445, "comment_id": 66539400, "body": "<code>If CountAbove = 6 Then ...</code>"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474461110, "post_id": 39616445, "comment_id": 66539673, "body": "Do you add that before the else because it asks for the next For then. I am having trouble knowing where to insert that statement"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1474461224, "post_id": 39616626, "comment_id": 66539745, "body": "Thanks, that makes perfect sense. I was leaving out the &quot;exit function part&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1474461394, "post_id": 39616626, "comment_id": 66539865, "body": "@user3018495 you&#39;re welcome, please accept my answer"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1474898319, "post_id": 39616626, "comment_id": 66707865, "body": "Can i ask one more question, If i want the count to skip  If (cCell.Value = MedianOfLastGroup) and move onto the next row, could i add that into same function?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1474900653, "post_id": 39616626, "comment_id": 66709418, "body": "Not sure what do u mean ? What do you want the function to do ?"}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1474902292, "post_id": 39616626, "comment_id": 66710485, "body": "I want it to skip if a value is equal to the MedianOfLastGroup but continue to count because at the moment is stops the count."}, {"owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "edited": false, "score": 0, "creation_date": 1474973043, "post_id": 39616626, "comment_id": 66742578, "body": "i basically want the function to count values in A that are above values in B and if the value in A is equal to B then i need it to skip that value but don&#39;t reset the counter"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1474461092, "creation_date": 1474461092, "answer_id": 39616626, "question_id": 39616445, "link": "https://stackoverflow.com/questions/39616445/function-to-stop-after-counting-to-6/39616626#39616626", "title": "Function to stop after counting to 6", "body": "<p>As @Comintern wrote, put the condition <code>If CountAbove = 6</code> inside your <code>If</code>, as added in the edited code below:</p>\n\n<pre><code>Function CountAbove(RangeToCountAbove As Range, _\n                MedianOfLastGroup As Double) As Long\n\nDim i As Double\nDim rows As Double\nDim cCell As Range\n\nCountAbove = 0\n\nFor Each cCell In RangeToCountAbove\n    If (cCell.Value &gt; MedianOfLastGroup) Then\n        CountAbove = CountAbove + 1\n        If CountAbove = 6 Then Exit Function\n    Else\n        Exit Function\n    End If\n\nNext cCell\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3018495, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d06dfd0b95be5838ab5f974f75ab6b38?s=128&d=identicon&r=PG&f=1", "display_name": "user3018495", "link": "https://stackoverflow.com/users/3018495/user3018495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 39616626, "answer_count": 1, "score": 1, "last_activity_date": 1474461092, "creation_date": 1474460544, "question_id": 39616445, "link": "https://stackoverflow.com/questions/39616445/function-to-stop-after-counting-to-6", "title": "Function to stop after counting to 6", "body": "<p>I have a function below counting values above a median value but it counts all values in A that are above the median. I need this to stop counting when it gets to 6. Any help would be great.</p>\n\n<pre><code>Function CountAbove(RangeToCountAbove As Range, _\n                MedianOfLastGroup As Double) As Long\n\nDim i As Double\nDim rows As Double\nDim cCell As Range\n\nCountAbove = 0\n\nFor Each cCell In RangeToCountAbove\nIf (cCell.Value &gt; MedianOfLastGroup) Then\n    CountAbove = CountAbove + 1\nElse\nExit Function\nEnd If\nNext cCell\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "combinations", "permutation"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474463447, "post_id": 39616375, "comment_id": 66541369, "body": "Thanks. Can the N variable case be done efficiently in vba?"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 0, "last_activity_date": 1474460308, "creation_date": 1474460308, "answer_id": 39616375, "question_id": 39616146, "link": "https://stackoverflow.com/questions/39616146/combination-of-n-variables-in-vba/39616375#39616375", "title": "Combination of N variables in VBA", "body": "<p>Why you require 2 dimensional array if you want 3 arrays for startValue, stopValue and stepValue. Alternately, You can use only one 2-dimensional array</p>\n\n<pre><code>ReDim arrValue(0 To 2, 0 To n-1) As Double\n</code></pre>\n\n<p>where index 0 = Start, 1 = Stop, 2 = Step</p>\n"}, {"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474467995, "post_id": 39617977, "comment_id": 66544767, "body": "<code>arrColAddress = Split(oWS.Cells(1, Columns.Count).End(xlToLeft).Address, &quot;$&quot;)&#39; will give you the address for the last column in your sheet, which is then </code>Split` into an array. Next line <code>arrMyValues = oWS.Range(&quot;A2:&quot; &amp; arrColAddress(1) &amp; oWS.Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row)&#39;: to explain: if you assign a </code>Range` to a variable, Excel will create the array for you. This line gives the range to be assigned in your array. Your question about the N variable I presumed you are looking for the last column used in the sheet. You can get this by: <code>Cells(1, Columns.Count).End(xlToLeft).Column</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474468801, "post_id": 39617977, "comment_id": 66545312, "body": "I&#39;ve added explanation for the code. Hope this helps"}, {"owner": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474469422, "post_id": 39617977, "comment_id": 66545649, "body": "Hi. Zac. Thanks for your code. Is this code can generate 900 combination of 3 variables like in my example. Further more, can this approach adapted for N variable case ? Thanks for your help."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474528197, "post_id": 39617977, "comment_id": 66569485, "body": "All the code does is put the range from your sheet into a multidimensional array. by N variables do you mean N number of columns in the sheet? if so then yes the code will do that. Also not sure how you are arranging in combination of 3. So if you have 5 columns, how would you generate the 3 number combination?"}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1474468765, "last_edit_date": 1474468765, "creation_date": 1474464515, "answer_id": 39617977, "question_id": 39616146, "link": "https://stackoverflow.com/questions/39616146/combination-of-n-variables-in-vba/39617977#39617977", "title": "Combination of N variables in VBA", "body": "<p>Rather than creating an array and then assigning values to it, you can let <code>Excel</code> do the job by assigning a range to your variable (i.e. <code>arrMyValues = Range(\"A2:C4\")</code>). But as in your case we don't know the last column, we first have to get the last column. We can get this by: <br></p>\n\n<pre><code>oWS.Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>This will return the number of columns used in your sheet. In this instance however, we need the name of the last column. To get that we first get the last column addres:<br></p>\n\n<pre><code>oWS.Cells(1, Columns.Count).End(xlToLeft).Address\n</code></pre>\n\n<p>We then split this address into an array so that we can get the column name: <br></p>\n\n<pre><code>arrColAddress = Split(oWS.Cells(1, Columns.Count).End(xlToLeft).Address, \"$\")\n</code></pre>\n\n<p>Now that we have the name of the last column, we can use the name with row count to pass the range into our variable. To get the row count for the sheet, we can use: <br></p>\n\n<pre><code>oWS.Cells(Rows.Count, \"B\").End(xlUp).Row\n</code></pre>\n\n<p>If we put all of this together (only thing I added was a worksheet object), we get: <br></p>\n\n<pre><code>Dim oWS as Worksheet : Set oWS = Worksheets(\"your worksheet name\")\narrColAddress = Split(oWS.Cells(1, Columns.Count).End(xlToLeft).Address, \"$\")\narrMyValues = oWS.Range(\"A2:\" &amp; arrColAddress(1) &amp; oWS.Cells(Rows.Count, \"B\").End(xlUp).Row)\n</code></pre>\n\n<p>Code is based on the table you provided</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474605644, "post_id": 39643843, "comment_id": 66608360, "body": "This is magic. John. Thanks so much. It is accurate and flexible. Great solution."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474631607, "post_id": 39643843, "comment_id": 66621919, "body": "@auto9817 Glad I could help. If the answer solves your problems you could mark it as &quot;accepted&quot;."}, {"owner": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474687232, "post_id": 39643843, "comment_id": 66645459, "body": "Where is accepted button located ? I can&#39;t see them in my web browser. Sorry for very na&#239;ve question. :)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "edited": false, "score": 0, "creation_date": 1474687658, "post_id": 39643843, "comment_id": 66645533, "body": "@auto9817 The Stack Overflow interface is on the cluttered side (since there is so much going on). Maybe this will help: <a href=\"http://stackoverflow.com/help/accepted-answer\">stackoverflow.com/help/accepted-answer</a>"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1474560221, "creation_date": 1474560221, "answer_id": 39643843, "question_id": 39616146, "link": "https://stackoverflow.com/questions/39616146/combination-of-n-variables-in-vba/39643843#39643843", "title": "Combination of N variables in VBA", "body": "<p>Here is a solution which should work for any number of variables:</p>\n\n<pre><code>'The following takes a 1-based variant area with 3 rows\n'And n columns, where n is the number of variables\n'The first row are start values, the second is stop, and the\n'third is step-size.\n'It returns a variant array consisting of all combos\n\nFunction MakeCombos(Vals As Variant) As Variant\n    Dim i As Long, j As Long, n As Long\n    Dim numCombos As Long\n    Dim combos As Variant, levels As Variant\n    Dim var As Double, varStep As Double, colStep As Long\n\n    If TypeName(Vals) = \"Range\" Then Vals = Vals.Value 'make into a VBA array if passed a range\n    n = UBound(Vals, 2)\n    ReDim levels(1 To n)\n\n    'first find the *number* of levels for each variable\n    numCombos = 1\n    For i = 1 To n\n        levels(i) = 1 + Round((Vals(2, i) - Vals(1, i)) / Vals(3, i))\n        numCombos = numCombos * levels(i)\n    Next i\n\n    ReDim combos(1 To numCombos, 1 To n)\n\n    'Now -- just fill in column by column in reverse order with some modular arithmetic\n    colStep = 1 'how often value is changed in column\n    For j = n To 1 Step -1\n        var = Vals(1, j)\n        varStep = Vals(3, j)\n        combos(1, j) = var\n        For i = 1 To numCombos - 1\n            combos(i + 1, j) = var + (Int(i / colStep) Mod levels(j)) * varStep\n        Next i\n        'before next pass theough outer loop, increase colStep so that\n        'in the next column will step more slowly\n        colStep = colStep * levels(j)\n    Next j\n\n    MakeCombos = combos\n\nEnd Function\n</code></pre>\n\n<p>To test it, I started with a spreadsheet that looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AovWZ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AovWZ.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Then ran this code:</p>\n\n<pre><code>Sub test()\n    Range(\"F1:H900\").Value = MakeCombos(Range(\"B2:D4\"))\nEnd Sub\n</code></pre>\n\n<p>After which the data in columns F:H starts with:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F9F4U.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F9F4U.gif\" alt=\"enter image description here\"></a></p>\n\n<p>and 900 rows down ends with:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zeqEq.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zeqEq.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 103, "user_id": 4298039, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c0429c36521dc699b009308a02a9d50c?s=128&d=identicon&r=PG&f=1", "display_name": "auto9817", "link": "https://stackoverflow.com/users/4298039/auto9817"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 938, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1474560221, "creation_date": 1474459615, "question_id": 39616146, "link": "https://stackoverflow.com/questions/39616146/combination-of-n-variables-in-vba", "title": "Combination of N variables in VBA", "body": "<p>Here I Have some complex combination problem for VBA in Excel.\nI have n variable defined by starting value, stop value and steps.\nN variables are double values basically like below.</p>\n\n<pre><code>      Var1, Var2,  Var3, .... VarN\nstart:  20,    1,   0.1, ....  \nstop : 100,   10,   1.0, ....\nstep :  10,    1,   0.1, ....\n</code></pre>\n\n<p>What is the most efficient (fast) way of generating combination of each variable like below:</p>\n\n<pre><code>20, 1, 0.1\n20, 1, 0.2\n20, 1, 0.3\n...\n...\n...\n\n100, 10, 0.8\n100, 10, 0.9\n100, 10, 1.0\n</code></pre>\n\n<p>I believe that there are all 900 combinations (=9x10x10) for this case.</p>\n\n<p>More challenging part is that I need more flexible solution for N variable cases using double array like this (without involving any worksheet formula): </p>\n\n<pre><code>Private startValue() As Double ' start value of each variable\nPrivate stopValue() As Double  ' stop value of each variable\nPrivate stepValue() As Double  ' step value of each variable\nPrivate combination() as double 'combination of all N variable\nPrivate n as integer ' number of variable = N\n\n\nReDim startValue(1 To 1, 1 To n) As Double\nReDim stopValue(1 To 1, 1 To n) As Double\nReDim stepValue(1 To 1, 1 To n) As Double\n</code></pre>\n\n<p>I really appreciated for your kind help.</p>\n\n<p>Kind regards.</p>\n"}, {"tags": ["excel", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474461338, "post_id": 39615988, "comment_id": 66539829, "body": "<code>Workbooks()</code> indexes off of just the name, not the full path - use <code>Set wb2 = Workbooks(&quot;VehicleList1&quot;)</code> if it&#39;s already open, otherwise <code>Set wb2 = Workbooks.Open(&quot;C:\\Users\\og677\\Desktop\\NightHawk\\Matlab\\Vehi&zwnj;&#8203;cleList1.xlsx&quot;)</code>. Everything else looks fine."}], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1474460603, "last_edit_date": 1474460603, "creation_date": 1474460127, "answer_id": 39616300, "question_id": 39615988, "link": "https://stackoverflow.com/questions/39615988/copy-three-columns-from-one-workbook-into-another-when-all-three-ranges-are-diff/39616300#39616300", "title": "Copy Three Columns from one workbook into another when all three ranges are different than the original ranges using Command Button", "body": "<p>You can specify the range where you want to paste. \nThis is how I did in my macro to copy from wbTarget column A to wbThis column B</p>\n\n<pre><code>wbTarget.Sheets(\"sheet1\").Range(\"A14:A100\").Copy\nwbThis.Activate\nwbThis.Sheets(\"Sheet1\").Range(\"B14:B100\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Split the copy/paste in more steps called by the same Command, so that A and B are pasted to A and B, while C is pasted to G</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 6858136, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-D-Vl4CIJ0us/AAAAAAAAAAI/AAAAAAAAAB8/OY2qEe7cp8c/photo.jpg?sz=128", "display_name": "Trevor Burger", "link": "https://stackoverflow.com/users/6858136/trevor-burger"}, "edited": false, "score": 0, "creation_date": 1474462884, "post_id": 39616498, "comment_id": 66540974, "body": "I received an error referring to the code where the range is selected before being pasted.   <code>Windows(&quot;Workbook2.xlsx&quot;).Activate  Range(&quot;B1&quot;).Select  &#39; Error occurred here  ActiveSheet.Paste</code>  Any ideas why? It looks fine to me @sn152 Thanks for the help"}], "tags": [], "owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "is_accepted": false, "score": -1, "last_activity_date": 1474460727, "creation_date": 1474460727, "answer_id": 39616498, "question_id": 39615988, "link": "https://stackoverflow.com/questions/39615988/copy-three-columns-from-one-workbook-into-another-when-all-three-ranges-are-diff/39616498#39616498", "title": "Copy Three Columns from one workbook into another when all three ranges are different than the original ranges using Command Button", "body": "<p>Try this code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nWorkbooks.Open Filename:=\"enter file name.xlsx\"\n'Column A\nWindows(\"Workbook1.xlsm\").Activate\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"Workbook2.xlsx\").Activate\nRange(\"B1\").Select\nActiveSheet.Paste\n'Column B\nWindows(\"Workbook1.xlsm\").Activate\nRange(\"B1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"Workbook2.xlsx\").Activate\nRange(\"C1\").Select\nActiveSheet.Paste\n'Column C\nWindows(\"Workbook1.xlsm\").Activate\nRange(\"C1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"Workbook2.xlsx\").Activate\nRange(\"G1\").Select\nActiveSheet.Paste\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 6858136, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-D-Vl4CIJ0us/AAAAAAAAAAI/AAAAAAAAAB8/OY2qEe7cp8c/photo.jpg?sz=128", "display_name": "Trevor Burger", "link": "https://stackoverflow.com/users/6858136/trevor-burger"}, "is_accepted": true, "score": 1, "last_activity_date": 1474465443, "creation_date": 1474465443, "answer_id": 39618363, "question_id": 39615988, "link": "https://stackoverflow.com/questions/39615988/copy-three-columns-from-one-workbook-into-another-when-all-three-ranges-are-diff/39618363#39618363", "title": "Copy Three Columns from one workbook into another when all three ranges are different than the original ranges using Command Button", "body": "<p>Here's what I came up with:</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\nActiveSheet.Range(\"A2:B250\").Copy\nWorkbooks.Open Filename:=\"C:\\Users\\og677\\Desktop\\N\\Matlab\\VehicleList.xlsx\"\nActiveSheet.Cells(2, 2).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, skipblanks:=False, Transpose:=False\nApplication.CutCopyMode = False\n\nThisWorkbook.Activate\nActiveSheet.Range(\"C2:C250\").Copy\nWindows(\"VehicleList.xlsx\").Activate\nActiveSheet.Cells(2, 7).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, skipblanks:=False, Transpose:=False\nApplication.CutCopyMode = False\n\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6858136, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-D-Vl4CIJ0us/AAAAAAAAAAI/AAAAAAAAAB8/OY2qEe7cp8c/photo.jpg?sz=128", "display_name": "Trevor Burger", "link": "https://stackoverflow.com/users/6858136/trevor-burger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "accepted_answer_id": 39618363, "answer_count": 3, "score": 0, "last_activity_date": 1474997197, "creation_date": 1474459210, "last_edit_date": 1531161705, "question_id": 39615988, "link": "https://stackoverflow.com/questions/39615988/copy-three-columns-from-one-workbook-into-another-when-all-three-ranges-are-diff", "title": "Copy Three Columns from one workbook into another when all three ranges are different than the original ranges using Command Button", "body": "<p>I am attempting to copy three ranges, Column A, B and C in Workbook 1 to columns B, C, and G in Workbook 2 using a command button and without having to have the destination workbook open. Here, Column A from WB1 goes to column B WB2, Column B from WB1 goes to column C WB2, and Column C from WB1 goes to column G WB2. </p>\n\n<p>I've been able to copy and paste A and B into B and C using the following Code, but cannot figure out how to get C into G without using a different Command Button.\nI need the button to completely update the columns in the destination worksheet when it is clicked. \nThis is how I went about the first two columns :</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nActiveSheet.Range(\"A2:B250\").Copy\nWorkbooks.Open Filename:=\"C:\\Users\\og677\\Desktop\\N\n</code></pre>\n\n<p>\\Matlab\\VehicleList1.xlsx\"\n    ActiveSheet.Cells(2, 2).Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, skipblanks:=False, Transpose:=False\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\n    Application.CutCopyMode = False</p>\n\n<pre><code>End Sub\n</code></pre>\n\n<p>I thought I might need to set the ranges so I was trying something like this, but I didn't know how and was getting in error where I attempt to set wb2.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim O As Workbook\n\nDim wb2 As Workbook\n\nDim ESN As Worksheet\nDim List As Worksheet\n\nDim I As Integer\nDim n As Integer\n\n\nSet O = ThisWorkbook\nSet wb2 = Workbooks(\"C:\\Users.xlsx\")\n\nSet ESN = O.Sheets(\"ESN Regression\")\nSet List = VehicleList.Sheets(\"Sheet1\")\n\n\nn = 2\n\nFor I = 2 To WorksheetFunction.CountA(O.Columns.EntireColumn(1))\n\n\n    If Cells(I, \"I\").Value = \"Yes\" Then\n\n        List.Cells(n, \"B\").Value = ESN.Cells(I, \"A\")\n        List.Cells(n, \"C\").Value = ESN.Cells(I, \"B\")\n        List.Cells(n, \"G\").Value = ESN.Cells(I, \"C\")\n\n\n        n = n + 1\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I'd like to be able to keep my first attempt if it could be done but I'm open to any changes at all.</p>\n\n<p>Thanks ahead of time!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474458611, "post_id": 39615532, "comment_id": 66538052, "body": "what Range do you want to have inside the PivotTable ? from which Worksheet ? and also, what dimensions are dynamic ? rows? columns ?"}, {"owner": {"reputation": 3, "user_id": 6757397, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05c69b2195a3f66045f27842b673b3a0?s=128&d=identicon&r=PG&f=1", "display_name": "PranavM", "link": "https://stackoverflow.com/users/6757397/pranavm"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474458747, "post_id": 39615532, "comment_id": 66538138, "body": "In the column Break Type, I want the range to start from &#39;N6&#39; and continue till the last filled row in the same column. The pivot should be on the same worksheet &#39;Sheet1&#39; but it should appear a little below the last row."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474458887, "post_id": 39615532, "comment_id": 66538232, "body": "Range from N6 all the way down to last filled cell is : <code>Range(&quot;N6:N&quot; &amp; Cells(Rows.Count, &quot;N&quot;).End(xlUp).Row)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474459056, "post_id": 39615532, "comment_id": 66538350, "body": "it is not recommended to put the Pivot table under the sourcedata, as if the souredata is dymanic, and future records are added it wiil overlap the PivotTable and will result in an Error"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6757397, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05c69b2195a3f66045f27842b673b3a0?s=128&d=identicon&r=PG&f=1", "display_name": "PranavM", "link": "https://stackoverflow.com/users/6757397/pranavm"}, "edited": false, "score": 0, "creation_date": 1474464999, "post_id": 39616548, "comment_id": 66542427, "body": "Why do you not recommend adding the pivot in the same worksheet. Should I add the pivot in a new sheet?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 6757397, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05c69b2195a3f66045f27842b673b3a0?s=128&d=identicon&r=PG&f=1", "display_name": "PranavM", "link": "https://stackoverflow.com/users/6757397/pranavm"}, "edited": false, "score": 0, "creation_date": 1474465045, "post_id": 39616548, "comment_id": 66542469, "body": "I think it&#39;s better , or a few columns to the right (if you won&#39;t get anymore columns)"}, {"owner": {"reputation": 3, "user_id": 6757397, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05c69b2195a3f66045f27842b673b3a0?s=128&d=identicon&r=PG&f=1", "display_name": "PranavM", "link": "https://stackoverflow.com/users/6757397/pranavm"}, "edited": false, "score": 0, "creation_date": 1474982249, "post_id": 39616548, "comment_id": 66748823, "body": "Hi Shai, your code was running fine till I was using it on a individual file. But when I am trying to save it in he PERSONAL.XLSB for future use and then run it then I am getting an error, i.e. Run-time error &#39;5&#39;: Invalid procedure call or argument. The line it is highlighting is this one:  Set PvtTbl = shtPivot.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=shtPivot.Range(&quot;N&quot; &amp; lastRow + 10), TableName:=&quot;PivotTable1&quot;)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1474460866, "creation_date": 1474460866, "answer_id": 39616548, "question_id": 39615532, "link": "https://stackoverflow.com/questions/39615532/how-do-i-make-a-dynamic-pivot-macro/39616548#39616548", "title": "How do I make a dynamic pivot macro?", "body": "<p>The code below checks for last row with data in Column N, then it checks if there is already a Pivot Table in \"Sheet1\".</p>\n\n<p>If there is, it just refreshes the Pivot cache, according to updated Data.\nIf there isn't, it creates a PivotTable (2 rows under - Not Recommended).</p>\n\n<pre><code>Option Explicit\n\nSub Macro2()\n\nDim shtPivot                        As Worksheet\nDim PivotSrc_Range                  As Range\nDim PvtTbl                          As PivotTable\nDim PvtCache                        As PivotCache\nDim lastRow                         As Long\n\n' modify to your Sheet name that holds the Pivot source data\nSet shtPivot = ThisWorkbook.Sheets(\"Sheet1\")\n\nWith shtPivot\n    lastRow = .Cells(.Rows.Count, \"N\").End(xlUp).Row\n\n    ' setting dynamic Range in Column N\n    Set PivotSrc_Range = Range(\"N6:N\" &amp; lastRow)\n\n    ' for debug\n    Debug.Print PivotSrc_Range.Address\nEnd With\n\n' set the Pivot Cache\nSet PvtCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PivotSrc_Range, Version:=xlPivotTableVersion14)\n\n' add this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\nOn Error Resume Next\nSet PvtTbl = shtPivot.PivotTables(\"PivotTable1\")\n\nOn Error GoTo 0\nIf PvtTbl Is Nothing Then\n\n    ' create a new Pivot Table in \"Sheet1\" sheet, start 3 rows below your last line with data\n    Set PvtTbl = shtPivot.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=shtPivot.Range(\"N\" &amp; lastRow + 3), TableName:=\"PivotTable1\")\n\n    ' modify the name in brackets according to your Pivot Fields\n    With PvtTbl.PivotFields(\"BREAK TYPE\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    PvtTbl.AddDataField PvtTbl.PivotFields(\"BREAK TYPE\"), \"Count of BREAK TYPE\", xlCount\n\nElse\n    ' just refresh the Pivot cache with the updated Range (data in Sheet1)\n    PvtTbl.ChangePivotCache PvtCache\n    PvtTbl.RefreshTable\nEnd If\n\nActiveWorkbook.ShowPivotTableFieldList = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6757397, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05c69b2195a3f66045f27842b673b3a0?s=128&d=identicon&r=PG&f=1", "display_name": "PranavM", "link": "https://stackoverflow.com/users/6757397/pranavm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 39616548, "answer_count": 1, "score": 0, "last_activity_date": 1474460866, "creation_date": 1474457855, "last_edit_date": 1531164843, "question_id": 39615532, "link": "https://stackoverflow.com/questions/39615532/how-do-i-make-a-dynamic-pivot-macro", "title": "How do I make a dynamic pivot macro?", "body": "<p>I have recorded a macro for inserting a pivot. Since the macro is recorded it works fine with the specific excel sheet. But I want to generalize it such that it works on all sheets irrespective of the number of rows. So I want to select the 'N' column starting from 'N6' to the last filled cell. This I did using,\n <code>Range(Range(\"N5\"), Range(\"N5\").End(xlDown)).Select</code></p>\n\n<p>But I want a dynamic destination for the pivot. It should be a couple of rows below the last filled rows in the sheet. How do I do that?    </p>\n\n<pre><code>Sub Macro2()\n\nRange(\"N6:N31\").Select\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Sheet1!R6C14:R31C14\", Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=\"Sheet1!R38C11\", TableName:=\"PivotTable1\", _\n    DefaultVersion:=xlPivotTableVersion14\nSheets(\"Sheet1\").Select\nCells(38, 11).Select\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"BREAK TYPE\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable1\").PivotFields(\"BREAK TYPE\"), \"Count of BREAK TYPE\", xlCount\n\nRange(\"K38\").Select\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"BREAK TYPE\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveWorkbook.ShowPivotTableFieldList = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 2, "creation_date": 1474458221, "post_id": 39615513, "comment_id": 66537801, "body": "What query are you executing in the macro? post the relevant part of the macro"}, {"owner": {"reputation": 1235, "user_id": 1323474, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/b434e36ec89dcb5183c99c2e7e83e957?s=128&d=identicon&r=PG&f=1", "display_name": "pvaitonis", "link": "https://stackoverflow.com/users/1323474/pvaitonis"}, "reply_to_user": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1474459077, "post_id": 39615513, "comment_id": 66538364, "body": "I didn&#39;t write any query, I even don&#39;t know where to add that query. Updating question."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1474652113, "post_id": 39615513, "comment_id": 66634575, "body": "@pvaitonis It seems that you do not appreciate any of the work people have put into their answers. You&#39;ve posted ten questions and never accepted any of the answer nor have you ever upvoted any of them. Maybe if you start showing some appreciation people will feel more compelled to look at your questions and post an answer."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1474906239, "post_id": 39615513, "comment_id": 66713082, "body": "BTW: you are currently using <code>xlCmdTable</code> for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840602.aspx\" rel=\"nofollow noreferrer\">query table command type</a>. But you can change this to <code>xlCmdSql</code>. Then you&#39;d have a query where you could select only one column from the table (instead of all columns from the table). Of course, you&#39;d have to change the <code>CommandText</code> to something like <code>select ItemID from ABC.dbo.Table</code>."}], "owner": {"reputation": 1235, "user_id": 1323474, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/b434e36ec89dcb5183c99c2e7e83e957?s=128&d=identicon&r=PG&f=1", "display_name": "pvaitonis", "link": "https://stackoverflow.com/users/1323474/pvaitonis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474459808, "creation_date": 1474457819, "last_edit_date": 1531161705, "question_id": 39615513, "link": "https://stackoverflow.com/questions/39615513/how-to-get-one-column-from-sql-to-excel-using-vba", "title": "How to get one column from SQL to excel using vba?", "body": "<p>I have recorded this macro:</p>\n\n<pre><code>    Sub Macro1()\n' Macro1 Macro\n    ActiveWorkbook.Worksheets.Add\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array( _\n        \"OLEDB;Provider=SQLOLEDB.1;Persist Security Info=True;User ID=user;Data Source=10.0.10.10;Use Procedure for Prepare=1;Auto Translate=\" _\n        , _\n        \"True;Packet Size=4096;Workstation ID=PC01;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=ABC\"), Destination:=Range(\"$A$1\")).QueryTable\n        .CommandType = xlCmdTable\n        .CommandText = Array(\"\"\"ABC\"\".\"\"dbo\"\".\"\"Table\"\"\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"Table__10.0.10.10_ABC_TABLE\"\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>How to show only ID field. In current macro I get all records from my SQL table, how to get result:\n<a href=\"https://i.stack.imgur.com/n6Bm0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n6Bm0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1474458731, "post_id": 39615796, "comment_id": 66538129, "body": "If you don&#39;t want to update on a change event, ok. I have shown you how to use the If and Pclient.Value"}, {"owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1474463454, "post_id": 39615796, "comment_id": 66541375, "body": "It gives me a error if i try to add this private sub in the middle of my private sub, sais it needs a end sub before it.  I&#39;ll try to change it to a <code>with</code> and define <code>Pcodclient</code> as a string  EDIT:  tried  <code>Dim Pcodclient As String   If Pclient.Value = &quot;CMN&quot; Then     Pcodclient.Value = &quot;LSR000&quot;   End If   If Pclient.Value = &quot;RSS&quot; Then     Pcodclient.Value = &quot;LSR000&quot;   End If </code>  i get a error on <code>Pcodclient</code> :-/"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1474466039, "post_id": 39615796, "comment_id": 66543238, "body": "I have added a procedure in the answer above. You cannot use a procedure/function within another procedure/function. So, place it outside."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475066116, "post_id": 39615796, "comment_id": 66791502, "body": "Your edit shows Pcodclient is a String, hence I updated the code. Initially, my code treated Pcodclient as comboBox."}, {"owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475067354, "post_id": 39615796, "comment_id": 66792423, "body": "i am a bit confused about the private sub pclient_change()  i&#39;ll try to add this after my end sub (that comes after cells part)"}, {"owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475067718, "post_id": 39615796, "comment_id": 66792719, "body": "i get a &quot;object required&quot; error ...   i copied your code in a sub before and after my insert cells sub"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475145272, "post_id": 39615796, "comment_id": 66830228, "body": "Pcodclient is undefined. What is it ? If it is a control then which control ? If its a string variable, then remove Pcodclient.Value and just use Pcodclient."}, {"owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475150137, "post_id": 39615796, "comment_id": 66833514, "body": "It&#39;s a string. I need the text &quot;LSR000&quot; to be entered in column C when i choose CMN from the combobox Pclient. I removed .value, and it doesn&#39;t give any errors but it doesn&#39;t complete column C."}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475151994, "post_id": 39615796, "comment_id": 66834933, "body": "I hope Paddline_Click() is called after Pclient_Change(). Put a break point at &quot;Cells(ActiveCell.Row, 3).Value = Pcodclient&quot; statement and check the value of Pcodclient."}, {"owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475153429, "post_id": 39615796, "comment_id": 66835966, "body": "yes it is called after it... both are private subs, don&#39;t know if that matters. the code in the pastebin is exactly how it is in my excel...  breakpoint says &quot;pcodclient = empty&quot;"}, {"owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475153686, "post_id": 39615796, "comment_id": 66836166, "body": "Tried using a multi value per line combo box <a href=\"http://pastebin.com/FwuaqcDf\" rel=\"nofollow noreferrer\">pastebin.com/FwuaqcDf</a> but here i get a error on the array... :-/  Run-time error &#39;9&#39; subscript out of range"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "edited": false, "score": 0, "creation_date": 1475160338, "post_id": 39615796, "comment_id": 66841154, "body": "pcodclient should not be empty. Put a break point in Pclient_Change() and also at Cells(ActiveCell.Row, 3).Value = Pcodclient&quot; statements. Execution should break first in the Pclient_Change() then next time at 2nd break point"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 0, "last_activity_date": 1475066161, "last_edit_date": 1475066161, "creation_date": 1474458656, "answer_id": 39615796, "question_id": 39615471, "link": "https://stackoverflow.com/questions/39615471/excel-vba-when-a-value-is-selected-another-value-is-changed-based-on-the-selec/39615796#39615796", "title": "Excel VBA - When a value is selected another value is changed based on the selection made", "body": "<p>Use the change event to update the Pcodclient</p>\n\n<pre><code>Private Sub Pclient_Change()\n  If Pclient.Value = \"CMN\" Then\n    Pcodclient = \"X\"\n  End If\n\n  If Pclient.Value = \"RSS\" Then\n    Pcodclient = \"Y\"\n  End If\n\n  If Pclient.Value = \"ORD\" Then\n    Pcodclient = \"Y\"\n  End If\nEnd Sub\n\nPrivate Sub NewMethod()\n'Do something\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1474459499, "last_edit_date": 1474459499, "creation_date": 1474458949, "answer_id": 39615888, "question_id": 39615471, "link": "https://stackoverflow.com/questions/39615471/excel-vba-when-a-value-is-selected-another-value-is-changed-based-on-the-selec/39615888#39615888", "title": "Excel VBA - When a value is selected another value is changed based on the selection made", "body": "<p>I would recommend to create a <code>Combobox</code> by linking it to the cell (<a href=\"http://www.techrepublic.com/blog/microsoft-office/how-to-add-a-drop-down-list-to-an-excel-cell/\" rel=\"nofollow\">have a look here</a>). Now use <code>VLOOKUP</code> to get the values from a table. It would mean that you don't have to do any VBA</p>\n"}], "owner": {"reputation": 3, "user_id": 6631614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208835758950150/picture?type=large", "display_name": "Andrei Mesaro\u0219", "link": "https://stackoverflow.com/users/6631614/andrei-mesaro%c8%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475066161, "creation_date": 1474457705, "last_edit_date": 1475066151, "question_id": 39615471, "link": "https://stackoverflow.com/questions/39615471/excel-vba-when-a-value-is-selected-another-value-is-changed-based-on-the-selec", "title": "Excel VBA - When a value is selected another value is changed based on the selection made", "body": "<p>OK so i have a combo box set up for:</p>\n\n<p><code>\n<code>With Pclient\n    Pclient.AddItem \"CMN\"\n    Pclient.AddItem \"RSS\"\n    Pclient.AddItem \"ORD\"\nEnd With</code>\n</code></p>\n\n<p>When i select a option for Pclient, i want Pcodclient to be setup to X so it sets the value the client code without having to imput it manually.</p>\n\n<p><code>\n<code>Cells(ActiveCell.Row, 2).Value = Pclient.Value\nCells(ActiveCell.Row, 3).Value = Pcodclient.Value</code>\n</code></p>\n\n<p>How do i do this?\nI tried running some \n<code>IF Pclient.Value = CMN then Pcodclient.Value = X</code>\nbefore the Cells part... but it doesn't work.</p>\n\n<p>EDIT:</p>\n\n<p><code></p>\n\n<p>Dim Pcodclient As String\n  If Pclient.Value = \"CMN\" Then\n    Pcodclient.Value = \"LSR000\"\n  End If\n  If Pclient.Value = \"RSS\" Then\n    Pcodclient.Value = \"LSR000\"\n  End If\n  If Pclient.Value = \"DEI\" Then\n    Pcodclient.Value = \"LSR041\"\n  End If\n  If Pclient.Value = \"CTD\" Then\n    Pcodclient.Value = \"LSR040\"\n  End If</p>\n\n<pre><code>'in randul 1\nCells(ActiveCell.Row, 2).Value = Pclient.Value\nCells(ActiveCell.Row, 3).Value = Pcodclient.Value\nCells(ActiveCell.Row, 4).Value = Pptype.Value\n</code></pre>\n\n<p></code></p>\n\n<p>I get a invalid qualifier on Pcodclient.Value = \"LSR000\"</p>\n\n<p>how do i fix this?</p>\n"}, {"tags": ["vba", "replace", "ms-word"], "comments": [{"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1474456957, "post_id": 39614673, "comment_id": 66536954, "body": "Can you please share the part of code where you are facing the problem."}, {"owner": {"reputation": 11, "user_id": 6857921, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274653439241169/picture?type=large", "display_name": "Paul Baciu", "link": "https://stackoverflow.com/users/6857921/paul-baciu"}, "reply_to_user": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1474546562, "post_id": 39614673, "comment_id": 66581244, "body": "It is not a part of some code, it is just one find/replace with wildcards, and I had to go step by step (cell by cell), in column 1, in order to break the number from the text.  Example:  I have:  1. some text 2. some text And I need to make it look like this: 1.(^p) the text.... 2.(^p) the text...  I hope this is more clear. Thank you in advance."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6857921, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274653439241169/picture?type=large", "display_name": "Paul Baciu", "link": "https://stackoverflow.com/users/6857921/paul-baciu"}, "edited": false, "score": 0, "creation_date": 1474547003, "post_id": 39616251, "comment_id": 66581528, "body": "Thank you for your response. Yes... in my find/replace I used wildcards."}, {"owner": {"reputation": 11, "user_id": 6857921, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274653439241169/picture?type=large", "display_name": "Paul Baciu", "link": "https://stackoverflow.com/users/6857921/paul-baciu"}, "edited": false, "score": 0, "creation_date": 1474547825, "post_id": 39616251, "comment_id": 66582164, "body": "Thank you for this code. The problem is that I don&#39;t know how to make it work. I guess I have to complete some values somewhere, because isn&#39;t working in this form. I am newer in VBA coding... can you be more explicit how to implement this code (where should I put the number of column in which this code should look, where I have to put the find regexp and where to put the replace regexp). And what should I do with the seconde code? Thank you very much."}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1474460460, "last_edit_date": 1474460460, "creation_date": 1474459986, "answer_id": 39616251, "question_id": 39614673, "link": "https://stackoverflow.com/questions/39614673/find-and-replace-text-in-first-column-of-tables/39616251#39616251", "title": "Find and replace text in first column of tables", "body": "<p>Here you go :</p>\n\n<pre><code>Sub Replace_in_Tables(strFind As String, strReplace As String, intColumn As Integer)\n\n    Dim oTable As Table\n    Dim oRow As Row\n\n    For Each oTable In ThisDocument.Tables\n\n        For Each oRow In oTable.Rows\n            oTable.Cell(oRow.Index, intColumn).Range.Text = Replace(oTable.Cell(oRow.Index, intColumn).Range.Text, strFind, strReplace)\n        Next oRow\n\n    Next oTable\n\nEnd Sub\n</code></pre>\n\n<p>Call it like this :</p>\n\n<pre><code>Sub test()\n\n    ' replace in all tables of this document, on column 1, the string \"aaa\" with \"xxxxxxxxxxx\"\n\n    Replace_in_Tables \"aaa\", \"xxxxxxxxxxxxx\", 1\n\nEnd Sub\n</code></pre>\n\n<p>This will replace strings only... Not sure if your find/replace example was a regexp or not, as it is not clearly stated in your question. </p>\n"}], "owner": {"reputation": 11, "user_id": 6857921, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274653439241169/picture?type=large", "display_name": "Paul Baciu", "link": "https://stackoverflow.com/users/6857921/paul-baciu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1335, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474464371, "creation_date": 1474455588, "last_edit_date": 1474464371, "question_id": 39614673, "link": "https://stackoverflow.com/questions/39614673/find-and-replace-text-in-first-column-of-tables", "title": "Find and replace text in first column of tables", "body": "<p>I have a document with multiple tables and I need to look <strong>only</strong> in every cell of first column and do the next replacement:</p>\n\n<ul>\n<li><em>find:</em> ([0-9]{1;2}).^s</li>\n<li><em>replace:</em> \\1.^p</li>\n</ul>\n\n<p>Is it possible to choose in which column to look, in order to use it for other documents, replacements?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1474454604, "post_id": 39614021, "comment_id": 66535363, "body": "You will need to create sections. The header/footer can be different by sections. First section - first page, second section - your new page, third section - rest of the doc."}, {"owner": {"reputation": 33, "user_id": 6164971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dET8g.jpg?s=128&g=1", "display_name": "peppe1", "link": "https://stackoverflow.com/users/6164971/peppe1"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1474455520, "post_id": 39614021, "comment_id": 66536001, "body": "I did this by Selection.InsertBreak Type:=wdSectionBreakNextPage, but as  I delete the header and footer on the second page by Selection.Sections(1).Headers(wdHeaderFooterPrimary).Range.D&zwnj;&#8203;elete , it gets deleted on the others too"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1474455631, "post_id": 39614021, "comment_id": 66536083, "body": "Ah, also make sure to &quot;disconnect&quot; the headers: set the &quot;link to previous&quot; property to false. (I&#39;d need to look up the VBA code for that.) By default, it is on."}], "owner": {"reputation": 33, "user_id": 6164971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dET8g.jpg?s=128&g=1", "display_name": "peppe1", "link": "https://stackoverflow.com/users/6164971/peppe1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1848, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474458684, "creation_date": 1474453789, "last_edit_date": 1531164843, "question_id": 39614021, "link": "https://stackoverflow.com/questions/39614021/remove-header-and-footer-in-second-page-of-word-file-with-vba", "title": "remove header and footer in second page of word file with VBA", "body": "<p>I have a Word Document file and I wish to code a VBA macro that enters a new page in the document between two existing pages. Pages of the Word Document have a header and a footer which is an image file.</p>\n\n<p>In the new page I will add a TextBox that reads content from the third page, an image and a blank table.</p>\n\n<p>I wish to remove the header and footer from the new page (which is to become the 2nd page in the whole Word Document). And I wish to keep the existing header and footer on all other pages of the document.\nSo it would be:</p>\n\n<ul>\n<li>1st page of the document : cover page no header and footer ( resolved )</li>\n<li>2nd page of the document : no header and footer (looking for solution)</li>\n<li>3rd and after page of the document : all should keep the initial header and footer.</li>\n</ul>\n\n<p>here is my code for the procedure:</p>\n\n<pre><code>Sub processSecondPage()\n\nDim imgPathSecondPageBackground As String\nDim secondPageBackground As Shape\nDim tableNew As Table\n\nimgPathSecondPageBackground = \"C:\\solutionProposals\\Pictures\\Second_Page_Background_Cables.jpg\"\n\n'Moves selection to the 2nd Page\nSelection.GoTo what:=wdGoToPage, which:=wdGoToNext, Name:=\"2\"\n\n'inserts a new Page before the 2nd Page\nSelection.InsertBreak Type:=wdPageBreak     'wdSectionBreakNextPage\n'Selection.InsertBreak Type:=wdSectionBreakNextPage\n\nSelection.GoTo what:=wdGoToPage, which:=wdGoToNext, Name:=\"2\"\n\n'inserts the image on the 2nd page that will look like the background\nSet secondPageBackground = \n\nActiveDocument.Shapes.AddPicture(FileName:=imgPathSecondPageBackground, LinkToFile:=False, SaveWithDocument:=True, Left:=CentimetersToPoints(0.1), Top:=CentimetersToPoints(-3))\n    With secondPageBackground.WrapFormat\n    .Type = wdWrapBehind\nEnd With\nSelection.GoTo what:=wdGoToPage, which:=wdGoToNext, Name:=\"2\"\nSelection.InsertAfter Text:=\"processing 2nd page\"\n\n\n'enter a table on the second page at a certain position\nSet tableNew = ActiveDocument.Tables.Add(Range:=Selection.Range, NumRows:=6, NumColumns:=4, DefaultTableBehavior:=wdWord9TableBehavior)\nWith tableNew.Rows\n    .HorizontalPosition = CentimetersToPoints(0.2)\n    .VerticalPosition = CentimetersToPoints(20)\n    .Height = 30 'sets the height of the cells\nEnd With\n\n'apply zebra stripes to table cells\ntableNew.Cell(2, 1).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(4, 1).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(6, 1).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(2, 2).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(4, 2).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(6, 2).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(2, 3).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(4, 3).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(6, 3).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(2, 4).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(4, 4).Shading.BackgroundPatternColorIndex = wdGray25\ntableNew.Cell(6, 4).Shading.BackgroundPatternColorIndex = wdGray25\n\n\n'Hide the header and footer on the second page\nSelection.Sections(1).Headers(wdHeaderFooterPrimary).LinkToPrevious = False\nSelection.Sections(1).Headers(wdHeaderFooterPrimary).Range.Delete\nSelection.Sections(1).Footers(wdHeaderFooterPrimary).LinkToPrevious = False\nSelection.Sections(1).Footers(wdHeaderFooterPrimary).Range.Delete\n\nEnd Sub\n</code></pre>\n\n<p>The closest match for a workaround I could find is this: <a href=\"https://stackoverflow.com/questions/35741762/insert-a-new-page-in-word-without-header\">Insert a new page in word without header</a> , but it removes headers and footers on all pages of the document. I could not adjust it.</p>\n\n<p>What do I have to do to remove the header and footer from the second page, while keeping it on all others?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474454872, "post_id": 39613819, "comment_id": 66535557, "body": "do you have other sheets in your workbook except the list you provided, &quot;MASTER&quot; and &quot;hideMASTER&quot; ? if you don&#39;t you can save a lot of rows and Use a total different approach (there&#39;s no need to define worksheet object per sheet, and then filter each one in 3 different rows"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474455429, "post_id": 39613819, "comment_id": 66535939, "body": "Yes I have another sheet. hideMASTER only converts the content via excel formulas."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474456399, "post_id": 39613819, "comment_id": 66536580, "body": "this line <code>lngLastRow = Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row</code> are you trying to find the last row ? in which worksheet ?"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474456808, "post_id": 39613819, "comment_id": 66536855, "body": "This is one code line I forgot, after changing something. Thanks! I&#39;ll remove it and replace it with LASSSST."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474456853, "post_id": 39613819, "comment_id": 66536889, "body": "I&#39;ll write a piece of code below, it&#39;s not the answer, but it&#39;s a more elegant way of writing what you have coded here"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1474456951, "post_id": 39613819, "comment_id": 66536951, "body": "Its important for me that I can run the macro from a different sheet. Thanks in advance!"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1474458037, "post_id": 39615319, "comment_id": 66537693, "body": "thanks! but it clears the sheet MASTER instead of all other sheets."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1474458412, "post_id": 39615319, "comment_id": 66537915, "body": "are you sure ? did you copy the entire code here ? I just tested again on my PC and it&#39;s working fine. You are clearing sheet &quot;MASTER&quot; in your code, you have the line <code>Sheets(&quot;MASTER&quot;).Cells.clearcontents</code> I just copied it here"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1474458968, "post_id": 39615319, "comment_id": 66538295, "body": "Yes but it does not copy the content from hideMASTER. I know you coded the but it does not work somehow..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1474459138, "post_id": 39615319, "comment_id": 66538400, "body": "did you read my comments in my code ? you are setting <code>LASSSST</code> fromsheet &quot;Input&quot; , but using it on sheet &quot;hideMASTER&quot; ??"}, {"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1474459353, "post_id": 39615319, "comment_id": 66538539, "body": "Input and hideMASTER have the same amount of rows."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1474459601, "post_id": 39615319, "comment_id": 66538699, "body": "you can see that part of the code is the same as yours, I just reduced all the code aftewards"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1474457266, "creation_date": 1474457266, "answer_id": 39615319, "question_id": 39613819, "link": "https://stackoverflow.com/questions/39613819/excel-vba-filter-and-copy-in-multiple/39615319#39615319", "title": "Excel VBA - Filter and copy in multiple", "body": "<p>This is not the full answer, just a shorter, \"cleaner\" and more versatile way.\nSee my comments inside the code, some are questions</p>\n\n<pre><code>Option Explicit\n\nSub DeleteFilterAndCopy()\n\nDim LASSSST                     As Long\nDim IP                          As Worksheet\nDim Sht                         As Worksheet\nDim ShtNamesArr                 As Variant\nDim i                           As Long\n\n' put all your desired sheet names into array\nShtNamesArr = Array(\"Alex\", \"Anett Edith\", \"Angela\", \"Dirk\", \"Daniel\", \"Klaus\", \"Konrad\", \"Marion\", \"Martin\", \"Michael\", \"Mirko\", \"Nils\", \"Ulrike\")\n\nSet IP = ThisWorkbook.Worksheets(\"Input\")\n\n' get last row in Column B fron sheet \"Input\"\nLASSSST = IP.Cells(IP.Rows.Count, \"B\").End(xlUp).Row\n\nSheets(\"MASTER\").Cells.ClearContents\n\n' using Last row from sheet \"Input\" and use it in sheet \"hideMASTER\" ???\nSheets(\"hideMASTER\").Range(\"A4:U\" &amp; LASSSST).Copy\nSheets(\"MASTER\").Range(\"A1\").PasteSpecial xlPasteValues\n\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n' Method 1 of clearing contents in Range A2:T1000 in all specific sheets\nFor i = LBound(ShtNamesArr) To UBound(ShtNamesArr)\n    On Error Resume Next\n    Sheets(ShtNamesArr(i)).Range(\"A2:T1000\").ClearContents  ' this method might return an error if sheet name not found\n    On Error GoTo 0\nNext i\n\n' Method 2 of clearing contents in Range A2:T1000 in all specific sheets\nFor Each Sht In ThisWorkbook.Sheets\n    Select Case Sht.Name\n        Case \"Alex\", \"Anett Edith\", \"Angela\", \"Dirk\", \"Daniel\", \"Klaus\", \"Konrad\", \"Marion\", \"Martin\", \"Michael\", \"Mirko\", \"Nils\", \"Ulrike\"\n            Sht.Range(\"A2:T1000\").ClearContents\n    End Select\nNext Sht\n\nDim lngLastRow                  As Long\n\n' which sheet is this suppose to be ???\nlngLastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\nWith ThisWorkbook.Sheets(\"MASTER\")\n    .Range(\"T4\").CurrentRegion.Sort Key1:=.Range(\"T4\"), order1:=xlDescending, _\n        Header:=xlYes, OrderCustom:=1, DataOption1:=xlSortNormal\nEnd With\n\nWith Range(\"B1:U\" &amp; lngLastRow)\n    .AutoFilter\n\n    ' lppo through all sheet names array elements, and per each element filter the table and copy it to the relevant sheet\n    For i = LBound(ShtNamesArr) To UBound(ShtNamesArr)\n        .AutoFilter Field:=6, Criteria1:=ShtNamesArr(i)\n        .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n        .Copy Sheets(ShtNamesArr(i)).Range(\"A1\")\n    Next i\nEnd With\n\n\nSheets(\"INPUT\").Select\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474457266, "creation_date": 1474453239, "last_edit_date": 1531164843, "question_id": 39613819, "link": "https://stackoverflow.com/questions/39613819/excel-vba-filter-and-copy-in-multiple", "title": "Excel VBA - Filter and copy in multiple", "body": "<p>The macro filters for different names (filter field 6) and days (filter field 20) in the sheet \"<strong>MASTER</strong>\". After filtering the sheet, it copies for example everything with \"<strong>Nils</strong>\" in filter field 6 to the sheet \"<strong>Nils</strong>\".</p>\n\n<p>It thought it works, but after checking the results I noticed something I can't solve. He does not copy every row that meets the criteria (name and >-9 days).\nWhen I take a look in the <strong>MASTER</strong> sheet, I can find the row the macro should have copied.</p>\n\n<pre><code>Sub DeleteFilterAndCopy()\n\nDim LASSSST As Long\nDim IP As Worksheet\n\nSheets(\"MASTER\").Select\n\nSet IP = ThisWorkbook.Worksheets(\"Input\")\n\nLASSSST = IP.Cells(Rows.Count, \"B\").End(xlUp).Row\n\nSheets(\"MASTER\").Cells.clearcontents\nSheets(\"hideMASTER\").Range(\"A4:U\" &amp; LASSSST).Copy\nSheets(\"MASTER\").Range(\"A1\").PasteSpecial xlPasteValues\n\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nSheets(\"Alex\").Range(\"A2:T1000\").clearcontents\nSheets(\"Anett Edith\").Range(\"A2:T1000\").clearcontents\nSheets(\"Angela\").Range(\"A2:T1000\").clearcontents\nSheets(\"Dirk\").Range(\"A2:T1000\").clearcontents\nSheets(\"Daniel\").Range(\"A2:T1000\").clearcontents\nSheets(\"Klaus\").Range(\"A2:T1000\").clearcontents\nSheets(\"Konrad\").Range(\"A2:T1000\").clearcontents\nSheets(\"Marion\").Range(\"A2:T1000\").clearcontents\nSheets(\"Martin\").Range(\"A2:T1000\").clearcontents\nSheets(\"Michael\").Range(\"A2:T1000\").clearcontents\nSheets(\"Mirko\").Range(\"A2:T1000\").clearcontents\nSheets(\"Nils\").Range(\"A2:T1000\").clearcontents\nSheets(\"Ulrike\").Range(\"A2:T1000\").clearcontents\n\nDim lngLastRow As Long\nDim AlexSheet As Worksheet, AnettEdithSheet As Worksheet, AngelaShett As Worksheet, DanielSheet As Worksheet\nDim DirkSheet As Worksheet, KlausSheet As Worksheet, Konradsheet As Worksheet\nDim MarionSheet As Worksheet, MartinSheet As Worksheet, MichaelSheet As Worksheet, MirkoSheet As Worksheet\nDim NilsSheet As Worksheet, Ulrikesheet As Worksheet\n\nSet AlexSheet = Sheets(\"Alex\")\nSet AnettEdithSheet = Sheets(\"Anett Edith\")\nSet AngelaSheet = Sheets(\"Angela\")\nSet DanielSheet = Sheets(\"Daniel\")\nSet DirkSheet = Sheets(\"Dirk\")\nSet KlausSheet = Sheets(\"Klaus\")\nSet Konradsheet = Sheets(\"Konrad\")\nSet MarionSheet = Sheets(\"Marion\")\nSet MartinSheet = Sheets(\"Martin\")\nSet MichaelSheet = Sheets(\"Michael\")\nSet MirkoSheet = Sheets(\"Mirko\")\nSet NilsSheet = Sheets(\"Nils\")\nSet Ulrikesheet = Sheets(\"Ulrike\")\n\nlngLastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\nWith ThisWorkbook.Sheets(\"MASTER\")\n.Range(\"T4\").CurrentRegion.Sort Key1:=.Range(\"T4\"), order1:=xlDescending, _\n        Header:=xlYes, OrderCustom:=1, DataOption1:=xlSortNormal\nEnd With\n\n\nWith Range(\"B1:U\" &amp; lngLastRow)\n    .AutoFilter\n    .AutoFilter Field:=6, Criteria1:=\"Alexandra\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy AlexSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Anett / Edith\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy AnettEdithSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Angela\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy AngelaSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Daniel\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy DanielSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Dirk\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy DirkSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Klaus\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy KlausSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Konrad\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy Konradsheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Marion\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy MarionSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Martin\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy MartinSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Michael\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy MichaelSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Mirko\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy MirkoSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Nils\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy NilsSheet.Range(\"A1\")\n    .AutoFilter Field:=6, Criteria1:=\"Ulrike\"\n    .AutoFilter Field:=20, Criteria1:=\"&gt;=-9\"\n    .Copy Ulrikesheet.Range(\"A1\")\n    .AutoFilter\nEnd With\n\nSheets(\"INPUT\").Select\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>Could it be some type of calculation restriction? It's about 1000 rows that the macro has to filter and copy into 13 different sheets.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5424220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fae7bea85da69f684ed0602aaf1fdcb7?s=128&d=identicon&r=PG&f=1", "display_name": "rubs90", "link": "https://stackoverflow.com/users/5424220/rubs90"}, "edited": false, "score": 0, "creation_date": 1474466115, "post_id": 39617214, "comment_id": 66543296, "body": "I&#39;ve tried running it but I&#39;m getting a &quot;Object doesn&#39;t support this property or method&quot;. I&#39;ve replaced the &quot;mention the field name&quot; with &quot;Day&quot; (field name) and &quot;Row Labels&quot; (how it displays on the pivot table) but it doesn&#39;t seem to be picking up either."}, {"owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "reply_to_user": {"reputation": 45, "user_id": 5424220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fae7bea85da69f684ed0602aaf1fdcb7?s=128&d=identicon&r=PG&f=1", "display_name": "rubs90", "link": "https://stackoverflow.com/users/5424220/rubs90"}, "edited": false, "score": 0, "creation_date": 1474544445, "post_id": 39617214, "comment_id": 66579812, "body": "I have updated my previous answer above. Pls check that."}], "tags": [], "owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "is_accepted": false, "score": 0, "last_activity_date": 1474544419, "last_edit_date": 1474544419, "creation_date": 1474462578, "answer_id": 39617214, "question_id": 39613313, "link": "https://stackoverflow.com/questions/39613313/issue-with-filtering-and-vba/39617214#39617214", "title": "Issue with filtering and vba", "body": "<p>Please try adding this and let me know if this works</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Day\")\n.PivotItems(\"(blank)\").Visible = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5424220, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fae7bea85da69f684ed0602aaf1fdcb7?s=128&d=identicon&r=PG&f=1", "display_name": "rubs90", "link": "https://stackoverflow.com/users/5424220/rubs90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474544419, "creation_date": 1474451924, "question_id": 39613313, "link": "https://stackoverflow.com/questions/39613313/issue-with-filtering-and-vba", "title": "Issue with filtering and vba", "body": "<p>Essentially I've created a reporting dashboard at work using Adobe's Report Builder tool, and then I use the VBA macro below to update my report builder queries and refresh my pivot tables:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\n Dim addIn As COMAddIn\n Dim automationObject As Object\n Dim success As String\n Set addIn = Application.COMAddIns(\"ReportBuilderAddIn.Connect\")\n Set automationObject = addIn.Object\n success = automationObject.RefreshAllRequests(ActiveWorkbook)\n\n Dim PT As PivotTable\n Dim WS As Worksheet\n\n    For Each WS In ThisWorkbook.Worksheets\n\n        For Each PT In WS.PivotTables\n          PT.RefreshTable\n        Next PT\n\n Next WS\n\nEnd Sub\n</code></pre>\n\n<p>The macro seems to be working well, but I initially had an issue with my pivot tables not updating properly. I then found out it was because I had the (blank) row filtered out, which meant that when the pivot table refreshed with a new day's worth of data that day was automatically filtered. Is there any way I can make all my pivot tables update without having the (blank) field on them?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1474453085, "last_edit_date": 1474453085, "creation_date": 1474452298, "answer_id": 39613448, "question_id": 39613179, "link": "https://stackoverflow.com/questions/39613179/setting-password-on-excel-files-using-vba/39613448#39613448", "title": "Setting password on Excel files using VBA", "body": "<p>I do not believe you can set a file password without saving.</p>\n\n<p>So in this instance you will need to <code>SaveAs</code>.</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughFiles()\n    Dim StrFolder As String\n    Dim StrFile As String\n    Dim wb As Workbook\n\n    StrFolder = \"S:\\lnb\\SecPFM\\REPORTS\\CRC\\201608\\\"\n    StrFile = Dir(StrFolder &amp; \"*xls*\")\n\n    Do While Len(StrFile) &gt; 0\n\n        Set wb = Workbooks.Open(Filename:=StrFolder &amp; StrFile)\n\n        With wb\n            .SaveAs .Path &amp; \"\\protected_\" &amp; .Name, xlExcel12, \"OpenFile\"\n        End With\n\n        Application.DisplayAlerts = False\n        ActiveWorkbook.Close Savechanges:=True\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>You can even just override the existing file if you don't want to create a new protected version:</p>\n\n<pre><code>Application.DisplayAlerts = False\n\n    Do While Len(StrFile) &gt; 0\n\n        Set wb = Workbooks.Open(Filename:=StrFolder &amp; StrFile)\n\n        With wb\n            .SaveAs .FullName, , \"OpenFile\"\n        End With\n\n        ActiveWorkbook.Close Savechanges:=True\n        StrFile = Dir\n    Loop\n\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 1934932, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1a7975cf70238ddfb2692248ba24fc3f?s=128&d=identicon&r=PG", "display_name": "Hitesh P", "link": "https://stackoverflow.com/users/1934932/hitesh-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1237, "favorite_count": 0, "accepted_answer_id": 39613448, "answer_count": 1, "score": 1, "last_activity_date": 1474466738, "creation_date": 1474451556, "last_edit_date": 1531164843, "question_id": 39613179, "link": "https://stackoverflow.com/questions/39613179/setting-password-on-excel-files-using-vba", "title": "Setting password on Excel files using VBA", "body": "<p>I am trying to set password on all excel files in a particular directory. I tried following code but unfortunately it doesn't set password. I can see it opening and closing files but it still doesn't ask for a password when I open files manually.</p>\n\n<pre><code>Sub LoopThroughFiles()\n    Dim StrFolder As String\n    Dim StrFile As String\n    StrFolder = \"S:\\lnb\\SecPFM\\REPORTS\\CRC\\201608\\\"\n    StrFile = Dir(StrFolder &amp; \"*xls*\")\n    Do While Len(StrFile) &gt; 0\n\n        Workbooks.Open Filename:=StrFolder &amp; StrFile, Password:=\"OpenFile\"\n        Application.DisplayAlerts = False\n        ActiveWorkbook.Close Savechanges:=True\n        StrFile = Dir\n    Loop\nEnd Sub \n</code></pre>\n\n<p>Any idea what am I doing wrong here ? This is with Excel 2010</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1474451735, "post_id": 39613145, "comment_id": 66533429, "body": "The value of test is probably never incremented because the error mentioned is before the point where the increment occurs, but you didn&#39;t tell us exactly where the error happens."}, {"owner": {"reputation": 13, "user_id": 6842114, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-18eLnv4hV5E/AAAAAAAAAAI/AAAAAAAAAD8/Tsn0p17diWM/photo.jpg?sz=128", "display_name": "Dracus_Loki", "link": "https://stackoverflow.com/users/6842114/dracus-loki"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1474452110, "post_id": 39613145, "comment_id": 66533709, "body": "I think the error is happening in <code>Set firstchar = Selection.Characters(test)</code>"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1474452672, "post_id": 39613145, "comment_id": 66534079, "body": "Is the error &quot;the requested collection doesn&#39;t exist&quot; or &quot;The requested member of the collection does not exist&quot;? You are looping over all characters in the document and try to access that same number of characters in the selection. That will lead to an error if you haven&#39;t selected the whole document, at which point the selection becomes irrelevant because you can just use the document range."}, {"owner": {"reputation": 13, "user_id": 6842114, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-18eLnv4hV5E/AAAAAAAAAAI/AAAAAAAAAD8/Tsn0p17diWM/photo.jpg?sz=128", "display_name": "Dracus_Loki", "link": "https://stackoverflow.com/users/6842114/dracus-loki"}, "edited": false, "score": 0, "creation_date": 1474472861, "post_id": 39613145, "comment_id": 66547951, "body": "yes , That was the error ,, I wasn&#39;t selecting the text"}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 1, "last_activity_date": 1474455327, "creation_date": 1474455327, "answer_id": 39614579, "question_id": 39613145, "link": "https://stackoverflow.com/questions/39613145/issue-with-incrementing-variable/39614579#39614579", "title": "Issue with incrementing variable", "body": "<p>Well, it works on the <code>Selection</code>. If you don't select any text, it will give you the mentioned error. But why overcomplicate it? This code does what you (seem to) want:</p>\n\n<pre><code>Dim chr As Range\n\nFor Each chr In Selection.Characters\n\n  MsgBox chr.Text\n\nNext chr\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6842114, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-18eLnv4hV5E/AAAAAAAAAAI/AAAAAAAAAD8/Tsn0p17diWM/photo.jpg?sz=128", "display_name": "Dracus_Loki", "link": "https://stackoverflow.com/users/6842114/dracus-loki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 39614579, "answer_count": 1, "score": 0, "last_activity_date": 1474455327, "creation_date": 1474451479, "question_id": 39613145, "link": "https://stackoverflow.com/questions/39613145/issue-with-incrementing-variable", "title": "Issue with incrementing variable", "body": "<pre><code>Dim chr As Range\ntest = 1\n\nFor Each chr In ActiveDocument.Range.Characters\nDim firstChar As Word.Range\nSet firstChar = Selection.Characters(test)\nMsgBox (Selection.Characters(test))\nMsgBox (test)\ntest = test + 1\n\nNext chr\n</code></pre>\n\n<p>This is supposed to select the first character and then later do something with it , and move to the second character, that part isn't happening as the value of \"test\" is not increasing , and the macro gives an error of :\"the requested collection doesn't exist\" </p>\n\n<p>Why isn't the value incrementing .</p>\n"}, {"tags": ["sql-server", "vba", "odbc", "dao", "ms-access-2013"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1474454272, "post_id": 39612793, "comment_id": 66535140, "body": "It would help to remove all non-essential code from your question, especially all those <code>SysCmd</code> calls."}, {"owner": {"reputation": 1530, "user_id": 2264956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a7410a06675e9d42a06e2e3a74c3dae?s=128&d=identicon&r=PG", "display_name": "erg", "link": "https://stackoverflow.com/users/2264956/erg"}, "edited": false, "score": 0, "creation_date": 1474458336, "post_id": 39612793, "comment_id": 66537874, "body": "Are you 100% sure that the value in the blob column contains the original data? Or is the data already corrupted during upload? What values are appended at the end?"}, {"owner": {"reputation": 1408, "user_id": 1992767, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3ec3225fd79cb814067aac314d888cf3?s=128&d=identicon&r=PG", "display_name": "Steve F", "link": "https://stackoverflow.com/users/1992767/steve-f"}, "reply_to_user": {"reputation": 1530, "user_id": 2264956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a7410a06675e9d42a06e2e3a74c3dae?s=128&d=identicon&r=PG", "display_name": "erg", "link": "https://stackoverflow.com/users/2264956/erg"}, "edited": false, "score": 0, "creation_date": 1474459081, "post_id": 39612793, "comment_id": 66538366, "body": "@erg: File is corrupted during upload. I checked by downloading the raw file from the database using a blob editor program. But then that is the reason I asked this question."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1474460281, "last_edit_date": 1474460281, "creation_date": 1474459896, "answer_id": 39616231, "question_id": 39612793, "link": "https://stackoverflow.com/questions/39612793/code-to-read-and-then-write-a-file-into-a-sql-server-blob-column-producing-files/39616231#39616231", "title": "Code to read and then write a file into a SQL Server BLOB column producing files with different bytes", "body": "<p>I <em>think</em> the problem is:</p>\n\n<p>Unless you have an <code>Option Base 1</code> declaration in your module, arrays are zero-based.</p>\n\n<p>So if e.g. <code>LeftOver</code> = 2, </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>ReDim FileData(LeftOver)\n</code></pre>\n\n<p>will actually declare an array <code>FileData(0 To 2)</code>, which contains 3 bytes. And so the following <code>Get</code> will read 3 bytes, but you expect it to read 2 bytes.</p>\n\n<p>The same is true for the full-size arrays.</p>\n\n<p>In the end you read <code>NumBlocks + 1</code> bytes too much from the file, and the remainders will be <code>00</code> bytes.</p>\n\n<p>Solution: use</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ReDim FileData(1 To LeftOver)\nReDim FileData(1 To BlockSize)\n</code></pre>\n\n<p>Edit: Note that you will have to check for the case <code>LeftOver = 0</code>.</p>\n"}], "owner": {"reputation": 1408, "user_id": 1992767, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3ec3225fd79cb814067aac314d888cf3?s=128&d=identicon&r=PG", "display_name": "Steve F", "link": "https://stackoverflow.com/users/1992767/steve-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1538, "favorite_count": 0, "accepted_answer_id": 39616231, "answer_count": 1, "score": 3, "last_activity_date": 1474460281, "creation_date": 1474450600, "last_edit_date": 1474455248, "question_id": 39612793, "link": "https://stackoverflow.com/questions/39612793/code-to-read-and-then-write-a-file-into-a-sql-server-blob-column-producing-files", "title": "Code to read and then write a file into a SQL Server BLOB column producing files with different bytes", "body": "<p>Using:</p>\n\n<ul>\n<li>MS-SQL Server 2014</li>\n<li>MS-Access 2013 with linked ODBC tables to the SQL\nServer database </li>\n<li>\"SQL Server\" ODBC driver (10.00.10586.00, Microsoft\nCorporation, SQLSRV32.DLL) </li>\n<li>DAO</li>\n</ul>\n\n<p>We have an Access database with linked ODBC tables to a SQL Server 2014 database with VBA code behind a form in the Access application to upload a file to a SQL Server blob (varbinary[max]) column, and to later download the file from the same blob column. </p>\n\n<p>However we found that upon retrieving a file that was uploaded earlier from the blob column, the saved file has some extra bytes added to the end of the file. </p>\n\n<p>A screen capture of a comparison of the 2 files in Beyond Compare is below:\n<a href=\"https://i.stack.imgur.com/bej3p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bej3p.png\" alt=\"Extra bytes at the end of the downloaded file\"></a></p>\n\n<p>I would appreciate if someone could check and point out the error in the code. Code follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function ReadBLOB(SourceFileName As String, TableName As String, FieldName As String, _\n                  IDFieldName As String, IDFieldValue As Variant)\n    Dim NumBlocks As Integer, SourceFile As Integer, i As Integer\n    Dim FileLength As Long\n    Dim LeftOver As Long\n    Dim FileData() As Byte\n    Dim RetVal As Variant\n    Dim BlockSize As Long\n\n    Dim s As String\n\n    On Error GoTo Err_ReadBLOB\n\n    BlockSize = 32767\n\n    ' Open the source file.\n    SourceFile = FreeFile\n    Open SourceFileName For Binary Access Read As SourceFile\n\n    ' Get the length of the file.\n    FileLength = LOF(SourceFile)\n    If FileLength = 0 Then\n        ReadBLOB = 0\n        Exit Function\n    End If\n\n    ' Calculate the number of blocks to read and leftover bytes.\n    NumBlocks = FileLength \\ BlockSize\n    LeftOver = FileLength Mod BlockSize\n\n    Dim T As dao.Recordset\n\n    If TypeName(IDFieldValue) = \"String\" Then\n        IDFieldValue = \"'\" &amp; IDFieldValue &amp; \"'\"\n    End If\n\n    s = \"SELECT [\" &amp; FieldName &amp; \"] FROM [\" &amp; TableName &amp; \"] WHERE [\" &amp; IDFieldName &amp; \"] = \" &amp; IDFieldValue\n\n    Set T = CurrentDb.OpenRecordset(s, dbOpenDynaset, dbSeeChanges)\n\n    T.Edit\n\n    ' Read the 1st block of data (upto Leftover in size), writing it to the table.\n    'FileData = String$(LeftOver, 32)\n    ReDim FileData(LeftOver)\n    Get SourceFile, , FileData\n    T(FieldName).AppendChunk (FileData)\n\n    ' Read the remaining blocks of data, writing them to the table.\n    'FileData = String$(BlockSize, 32)\n    ReDim FileData(BlockSize)\n    For i = 1 To NumBlocks\n        Get SourceFile, , FileData\n        T(FieldName).AppendChunk (FileData)\n\n    Next i\n\n    ' Update the record and terminate function.\n    T.Update\n    Close SourceFile\n    ReadBLOB = FileLength\n    Exit Function\n\nErr_ReadBLOB:\n    ReadBLOB = -Err\n\n    MsgBox Err.Description\n\n    Exit Function\nEnd Function\n\nFunction WriteBLOB2(TableName As String, FieldName As String, IDFieldName As String, _\n                    IDFieldValue As Variant, DestinationFileName As String) As Long\n\n    Dim NumBlocks As Integer, DestFile As Integer, i As Integer\n    Dim FileLength As Long, LeftOver As Long\n    Dim FileData() As Byte\n    Dim RetVal As Variant\n    Dim BlockSize As Long\n    Dim s As String\n    Dim f As String\n\n    On Error GoTo Err_WriteBLOB\n\n    BlockSize = 32767\n\n    Dim T As dao.Recordset\n\n    If TypeName(IDFieldValue) = \"String\" Then\n        IDFieldValue = \"'\" &amp; IDFieldValue &amp; \"'\"\n    End If\n\n    s = \"SELECT [\" &amp; FieldName &amp; \"] FROM [\" &amp; TableName &amp; \"] WHERE [\" &amp; IDFieldName &amp; \"] = \" &amp; IDFieldValue\n\n    Set T = CurrentDb.OpenRecordset(s, dbOpenSnapshot, dbSeeChanges)\n\n    If T.RecordCount = 0 Then\n        WriteBLOB2 = 0\n        Exit Function\n    End If\n\n    ' Get the size of the field.\n    FileLength = T(FieldName).FieldSize()\n    If FileLength = 0 Then\n        WriteBLOB2 = 0\n        Exit Function\n    End If\n\n    ' Calculate number of blocks to write and leftover bytes.\n    NumBlocks = FileLength \\ BlockSize\n    LeftOver = FileLength Mod BlockSize\n\n    ' Remove any existing destination file.\n    DestFile = FreeFile\n    Open DestinationFileName For Output As DestFile\n    Close DestFile\n\n    ' Open the destination file.\n    Open DestinationFileName For Binary As DestFile\n\n    ' Write the leftover data to the output file.\n    FileData = T(FieldName).GetChunk(0, LeftOver)\n    Put DestFile, , FileData\n\n    ' Write the remaining blocks of data to the output file.\n    For i = 1 To NumBlocks\n        ' Reads a chunk and writes it to output file.\n        FileData = T(FieldName).GetChunk((i - 1) * BlockSize + LeftOver, BlockSize)\n        Put DestFile, , FileData\n\n    Next i\n\n    ' Terminates function\n    Close DestFile\n    WriteBLOB2 = FileLength\n    Exit Function\n\nErr_WriteBLOB:\n    WriteBLOB2 = -Err\n\n    MsgBox Err.Description\n\n    Exit Function\nEnd Function\n\nPublic Sub ClearSQLBlob2(TableName As String, FieldName As String, _\n                         IDFieldName As String, IDFieldValue As Variant)\n\n    If TypeName(IDFieldValue) = \"String\" Then\n        IDFieldValue = \"'\" &amp; IDFieldValue &amp; \"'\"\n    End If\n\n    DoCmd.SetWarnings False\n    DoCmd.RunSQL \"UPDATE [\" &amp; TableName &amp; \"] SET [\" &amp; FieldName &amp; \"] = NULL WHERE [\" &amp; IDFieldName &amp; \"] = \" &amp; IDFieldValue\n    DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1292744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bce6e23ccf9260cf3fd706c10174cdf8?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/1292744/gary"}, "edited": false, "score": 0, "creation_date": 1474450865, "post_id": 39612733, "comment_id": 66532878, "body": "Thanks for the suggestion but the problem occurs even if I already do have an open form bound to a table."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 51, "user_id": 1292744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bce6e23ccf9260cf3fd706c10174cdf8?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/1292744/gary"}, "edited": false, "score": 0, "creation_date": 1474454982, "post_id": 39612733, "comment_id": 66535647, "body": "OK. You didn&#39;t mention that."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1474450431, "creation_date": 1474450431, "answer_id": 39612733, "question_id": 39612569, "link": "https://stackoverflow.com/questions/39612569/ms-access-dropping-connection-to-odbc-tables-after-long-period-of-inactivity/39612733#39612733", "title": "MS Access dropping connection to ODBC tables after long period of inactivity", "body": "<p>You could try an old trick - at launch to open a simple form bound to a table and hide that form, and leave it open.</p>\n"}, {"tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1474462972, "last_edit_date": 1474462972, "creation_date": 1474461915, "answer_id": 39616946, "question_id": 39612569, "link": "https://stackoverflow.com/questions/39612569/ms-access-dropping-connection-to-odbc-tables-after-long-period-of-inactivity/39616946#39616946", "title": "MS Access dropping connection to ODBC tables after long period of inactivity", "body": "<p>I rarely worked during several hours on MySQL tables so I never experienced this issue, but IMO it sounds like a driver-related issue or feature. </p>\n\n<p>Waht I would do in this case is to refresh the tables' connections in VBA, looping over your TableDef objects. </p>\n\n<p>Make a hidden form with a 1 hour timer for instance, and add the following code in the form_timer:</p>\n\n<pre><code>Sub Form_Timer()\n\n    Dim tDef As DAO.TableDef\n    Dim strConString As String\n\n    Dim strMySQLServer As String\n    Dim strMySQLDB As String\n    Dim strMySQLUser As String\n    Dim strMySQLPass As String\n\n        ' ADAPT THIS :\n        strMySQLServer = \"\"\n        strMySQLDB = \"\"\n        strMySQLUser = \"\"\n        strMySQLPass = \"\"\n\n     strConString = \"ODBC;DRIVER={MySQL ODBC 5.1 Driver};Server=\" &amp; strMySQLServer &amp; \";Database=\" &amp; strMySQLDB &amp; \";Uid=\" &amp; strMySQLUser &amp; \";Pwd=\" &amp; strMySQLPass &amp; \";Option=3\"\n\n     For Each tDef In CurrentDb.TableDefs\n\n        ' You probably have to adapt the folowing if\n        ' Debug and inspect  the connection string of your actual MySQL Linked tables\n\n         If Left(tDef.Connect, 4) = \"ODBC\" And InStr(tDef.Connect, \"MySQL\") &gt; 0 Then\n             tDef.Connect = strConString\n             tDef.RefreshLink\n         End If\n\n     Next tDef\n\nEnd Sub\n</code></pre>\n\n<p>Watch my comments carefully, espacially if you have linked table to several MySQL databases. It will break some of them without adaptation.</p>\n\n<p>You might also have to adapt the connection string following your MySQL driver, or to use the DSN entry that you specified in the ODBC control panel instead.</p>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1474484867, "creation_date": 1474484867, "answer_id": 39624658, "question_id": 39612569, "link": "https://stackoverflow.com/questions/39612569/ms-access-dropping-connection-to-odbc-tables-after-long-period-of-inactivity/39624658#39624658", "title": "MS Access dropping connection to ODBC tables after long period of inactivity", "body": "<p>Unfortunately there is no readily available way at this point in time to resolve this issue.</p>\n\n<p>Often the issue is the result of power management on the computer. If the computer goes to sleep, or the computer puts the network card to sleep, then you in trouble and you have to re-start Access.</p>\n\n<p>So if your computer sleeps, or puts the network card to sleep, you often loose the connection - once lost you have to re-start.</p>\n\n<p>Also some hardware with windows 10 also has issues since the DEFAULT setting for windows 10 is fast start up (this means a copy of the kernel and MOST important a copy of the drivers loaded and initialized are written to disk and used to shorten boot/start up time).</p>\n\n<p>If you seeing this issue on windows 10, then I would consider disabling fast start up as that will \u201calways\u201d force a cold re-initializing of the drivers (such as those for the network card). I would also consider turning off the \u201csleep\u201d mode if that\u2019s been determined to be an issue here (and that such offending computers are seeing this issue after a wake up).</p>\n\n<p>Edit: I should also point out that some \"test\" for a ODBC connection will not fix this issue since as noted, once lost, you have to re-start Access. </p>\n"}], "owner": {"reputation": 51, "user_id": 1292744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bce6e23ccf9260cf3fd706c10174cdf8?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/1292744/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1948, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1474496862, "creation_date": 1474450018, "last_edit_date": 1474496862, "question_id": 39612569, "link": "https://stackoverflow.com/questions/39612569/ms-access-dropping-connection-to-odbc-tables-after-long-period-of-inactivity", "title": "MS Access dropping connection to ODBC tables after long period of inactivity", "body": "<p>I have an Access 2010 front end which has multiple linked tables on a local MySQL server (Windows) connected via ODBC. Most of the time it works just fine however Access drops the connection if left for several hours with Access open but not being used. When a form is opened again I get an ODBC error.</p>\n\n<p>The problem is fixed by closing Access and opening it again.</p>\n\n<p>I'm guessing that it's a timeout issue but I'm not an Access expert. It seems that I need a way of checking for a valid ODBC connection and if necessary, re-connecting?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "edited": false, "score": 1, "creation_date": 1475224186, "post_id": 39611493, "comment_id": 66867498, "body": "Code works fine, OP attached his xls file below and his &quot;Eqipment&quot; sheet column C was blank and that is the macro loop count hence he had no output."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6203639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2838cb7263f630078674c25fdfde8e?s=128&d=identicon&r=PG&f=1", "display_name": "Priyank", "link": "https://stackoverflow.com/users/6203639/priyank"}, "is_accepted": false, "score": 0, "last_activity_date": 1474454937, "creation_date": 1474454937, "answer_id": 39614444, "question_id": 39611493, "link": "https://stackoverflow.com/questions/39611493/using-vba-to-add-rows-based-on-a-cell-value-onto-another-worksheet/39614444#39614444", "title": "Using VBA to Add Rows based on a cell value onto another worksheet", "body": "<p>Hope this will solve your problem :)   </p>\n\n<pre><code>    For i = 1 To 30 Step 1\n            If Sheets(\"Equipment\").Cells(1 + 4, 3).Value &gt; 0 Then\n            Sheet1.Range(Cells(i + 3, 5), Cells(i + 3, 13)).Copy\n                For j = 1 To Sheet1.Cells(1 + 4, 3).Value Step 1\n                LR = Sheets(\"Programming\").Cells(Sheets(\"Programming\").Rows.Count, \"A\").End(xlUp).Row\n                    Sheets(\"Programming\").Range(\"A\" &amp; LR + 1).PasteSpecial Paste:=xlPasteValues\n\n                Next\n            End If\nNext\n</code></pre>\n\n<p>Cheers ;)</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6274615, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k_nZlV1YAkI/AAAAAAAAAAI/AAAAAAAAAQk/CPLinmQBzNA/photo.jpg?sz=128", "display_name": "Lee King", "link": "https://stackoverflow.com/users/6274615/lee-king"}, "edited": false, "score": 1, "creation_date": 1475045443, "post_id": 39614521, "comment_id": 66777370, "body": "Hello Pav, Thank you for helping. I have tried your suggestion and although I believe I understand the code now I still can&#39;t get it to copy the parts of the rows I need. I have added a link below to the file. Are you able to take a look and see where I went wrong?    <a href=\"https://drive.google.com/drive/folders/0B8KHS4e3ETm0VEhvTTFlT0c1U1E?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/drive/folders/&hellip;</a>      Thank You"}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 1, "user_id": 6274615, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k_nZlV1YAkI/AAAAAAAAAAI/AAAAAAAAAQk/CPLinmQBzNA/photo.jpg?sz=128", "display_name": "Lee King", "link": "https://stackoverflow.com/users/6274615/lee-king"}, "edited": false, "score": 0, "creation_date": 1475049691, "post_id": 39614521, "comment_id": 66779978, "body": "@Lee King fundamental problem is that you spreadsheet doen&#39;t meet the starting cell image that you attached. Macro works perfectly fine. It will run that many times as many records it will find in the Sheet1 column C. In the file that you have on gDrive that column is empty! When I have put some numbers in then it works."}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 1, "user_id": 6274615, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k_nZlV1YAkI/AAAAAAAAAAI/AAAAAAAAAQk/CPLinmQBzNA/photo.jpg?sz=128", "display_name": "Lee King", "link": "https://stackoverflow.com/users/6274615/lee-king"}, "edited": false, "score": 0, "creation_date": 1475050511, "post_id": 39614521, "comment_id": 66780467, "body": "@LeeKing see revised answer above, populate your spreadsheet with desired quantity for each device on &quot;Programming&quot; and it will be working fine."}, {"owner": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475059359, "post_id": 39614521, "comment_id": 66786755, "body": "@Pav - I saw you have an edit pending approval on the question to rollback an earlier edit made by the OP. I&#39;m not sure what you&#39;re trying to gain by rolling back the edit?"}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475060120, "post_id": 39614521, "comment_id": 66787289, "body": "@TomRedfern have a look at what was the OP edit, he pasted in the code which was provided as my answer with a comment that its getting somewhere while it still doesn&#39;t work. In reality it was a fully functional solution that didn&#39;t work due to his spreadsheet not having the data that he presented in the graphics attached to his question. When I investigated the xlsm file that he linked it lacked the Column &quot;C&quot; data containing quantity which is the count of macro loops execution and a requirement of the amount of repetition that wants to see as a result.. No data resulted in lack of actions."}, {"owner": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475060711, "post_id": 39614521, "comment_id": 66787718, "body": "@Pav - while I understand that it can be frustrating when users behave in a certain manner, the solution to this is not to get into an edit war. Despite being irritating the OP is perfectly within their right to update their question as they acquire new learnings. You have done your job and posted a complete solution. If the OP doesn&#39;t accept that you have two choices, leave it alone or try to communicate further and make them understand (or both)."}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475063486, "post_id": 39614521, "comment_id": 66789565, "body": "@TomRedfern I did the edit for another user not to investigate an issue that doesn&#39;t really exist as I pointed the problem in the comment to the OP and updated my answer. If the question was to be updated it should rather say that using an x user solution it got me somewhere but still doesn&#39;t work the way I wanted because..."}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475221288, "post_id": 39614521, "comment_id": 66866045, "body": "@TomRedfern - so you say &quot;solution to this is not to get into an edit war&quot; and then you edit the post to remove my edit that you do not agree with..."}, {"owner": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475222339, "post_id": 39614521, "comment_id": 66866601, "body": "@Pav - I&#39;ve already said I understand and your frustration with the OP copying your complete, working solution and implementing it in a flawed manner without giving any kind of credit for your effort. However, this is what people do sometimes. Regardless, you cannot just go and edit someone else&#39;s question unless it&#39;s for clarity, grammar, etc. Your answer still stands as a complete solution and will help others with similar problems in the future. As an answer writer on SO, that is how it works - you post an answer and then move on. I&#39;m sorry if you feel I&#39;m acting against you."}, {"owner": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475222648, "post_id": 39614521, "comment_id": 66866746, "body": "@Pav - also, addressing your previous comment <i>I did the edit for another user not to investigate an issue that doesn&#39;t really exist</i> - another way to address this is to post a comment directly under the OPs post, pointing out why what they have done is wrong. This will call out to other users so they are not led astray."}, {"owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "reply_to_user": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1475223967, "post_id": 39614521, "comment_id": 66867381, "body": "@TomRedfern I don&#39;t feel that you are acting against me, you have a different opinion on that topic. I still think that as the OP was using correct solution based on different example than his current data set it should not form a part of his question. I will leave it as it is though and move on. No need for any of us to waste more time here, regards."}], "tags": [], "owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "is_accepted": false, "score": 1, "last_activity_date": 1475050174, "last_edit_date": 1475050174, "creation_date": 1474455136, "answer_id": 39614521, "question_id": 39611493, "link": "https://stackoverflow.com/questions/39611493/using-vba-to-add-rows-based-on-a-cell-value-onto-another-worksheet/39614521#39614521", "title": "Using VBA to Add Rows based on a cell value onto another worksheet", "body": "<p>Here you go, use this macro. Based on names <code>Programming</code> and <code>Equipment</code> as originally requested.  </p>\n\n<pre><code>Sub copySheetCells()\n'loop by each cell in column \"C\"\nFor i = 2 To Sheets(\"Programming\").Cells(Rows.Count, \"C\").End(xlUp).Row\n    'repeat copy x times (based on cell in column \"C\" value)\n    For j = 0 To (Sheets(\"Programming\").Cells(i, \"C\").Value - 1)\n        'define source range\n        Source = \"D\" &amp; (i) &amp; \":M\" &amp; (i)\n        'find last row on second sheet\n        lastRowS2 = Sheets(\"Equipment\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        'copy data\n        Sheets(\"Programming\").Range(Source).copy Destination:=Sheets(\"Equipment\").Range(\"A\" &amp; lastRowS2 + 1)\n    Next j\nNext i\n'copy headers\nSheets(\"Programming\").Range(\"D1:M1\").copy Destination:=Sheets(\"Equipment\").Range(\"A1:J1\")\nEnd Sub\n</code></pre>\n\n<h2>EDIT</h2>\n\n<p>Please avoid copying the code from the answer and posting it back at your question, I replaced the <code>Sheet1</code> with <code>Programming</code> so you can rename that sheet in your workbook.</p>\n\n<p>Macro seems to do what it does, the quantity in Sheet1/Programming was not provided (column \"C\" according to your initial requirements):</p>\n\n<p>Source (with added quantity)\n<a href=\"https://i.stack.imgur.com/T6mkF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T6mkF.png\" alt=\"Source\"></a></p>\n\n<p>Result:\n<a href=\"https://i.stack.imgur.com/87ZTQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/87ZTQ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6274615, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k_nZlV1YAkI/AAAAAAAAAAI/AAAAAAAAAQk/CPLinmQBzNA/photo.jpg?sz=128", "display_name": "Lee King", "link": "https://stackoverflow.com/users/6274615/lee-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1759, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1475162222, "creation_date": 1474447180, "last_edit_date": 1475162222, "question_id": 39611493, "link": "https://stackoverflow.com/questions/39611493/using-vba-to-add-rows-based-on-a-cell-value-onto-another-worksheet", "title": "Using VBA to Add Rows based on a cell value onto another worksheet", "body": "<p>I am trying to create a spreadsheet whereby I have a value in a cell in a worksheet called \"Equipment\" cell C5, for example a Value of 4.</p>\n\n<p><a href=\"http://i.stack.imgur.com/sfQQW.png\" rel=\"nofollow\">Starting Cell Image</a></p>\n\n<p>I need to use this value to copy a section of the same row (D5:M5) and paste it that many times into a worksheet called \"Programming\" also if this changes I would like it to delete or add where required, ignoring where there is a blank or 0 value in the \"equipment\" sheet</p>\n\n<p><a href=\"http://i.stack.imgur.com/7y1pF.png\" rel=\"nofollow\">Desired Result</a></p>\n\n<p>I have around 30 different items and all will have different sections to copy but they will be of the same size. Also Could this look down a list of values all in the same column and do the same for all the values</p>\n\n<p>I'm very new to VBA and have managed to hide and show tabs based on values but i'm struggling to get my head around this as it's a little too complicated at this point.</p>\n\n<p>Thank You in advance</p>\n\n<p>Lee</p>\n\n<p>This is what I have so far, I have edited the code to what I believe is correct but it still isn't working</p>\n\n<pre><code>Sub copySheetCells()\n\n'loop by each cell in column \"C\"\nFor i = 2 To Sheets(\"Equipment\").Cells(Rows.Count, \"C\").End(xlUp).Row\n    'repeat copy x times (based on cell in column \"C\" value)\n    For j = 0 To (Sheets(\"Equipment\").Cells(i, \"C\").Value - 1)\n        'define source range\n        Source = \"D\" &amp; (i) &amp; \":M\" &amp; (i)\n        'find last row on second sheet\n        lastRowS2 = Sheets(\"Hardware_Programming\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        'copy data\n    Sheets(\"Equipment\").Range(Source).copy Destination:=Sheets(\"Hardware_Programming\").Range(\"A\" &amp; lastRowS2 + 1)\nNext j\nNext i\n'copy headers\nSheets(\"Equipment\").Range(\"D1:M1\").copy Destination:=Sheets    (\"Hardware_Programming\").Range(\"A1:J1\")\nEnd Sub\n</code></pre>\n\n<p>I only get blank spaces, is anyone able to advise any further?</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1474446799, "post_id": 39611126, "comment_id": 66530052, "body": "What does your existing code look like?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1474446901, "post_id": 39611126, "comment_id": 66530104, "body": "Have a look at DAO - also, google is your friend. ;) Come back to StackOverflow if you have tried it, and need help with an error. We will be happy to help."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1474460240, "post_id": 39611126, "comment_id": 66539089, "body": "You need to escape your quotes on this line: <code>&quot;Data Source=&quot;&quot;\\\\localhost\\SQLEXPRESS&quot;&quot;; &quot;</code>. See <a href=\"http://stackoverflow.com/documentation/vba/3578/working-with-ado/12352/retrieving-records-with-a-query\">documentation</a> for an example of retrieving records."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 6829107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aba9366abdb0a5083f0d43fc34d093f?s=128&d=identicon&r=PG&f=1", "display_name": "love-to-code", "link": "https://stackoverflow.com/users/6829107/love-to-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1536419698, "creation_date": 1536419698, "answer_id": 52236621, "question_id": 39611126, "link": "https://stackoverflow.com/questions/39611126/how-to-connect-to-sql-server-using-excel-macros/52236621#52236621", "title": "How to connect to SQL Server using Excel Macro&#39;s?", "body": "<p>You first need to create and open the connection with the database. Here I am posting a sample example for three rows:</p>\n\n<pre><code>Sub Button1_Click()\n\nDim conn As New ADODB.Connection\nDim iRowNo As Integer\nDim sCustomerId, sFirstName, sLastName As String\n\nWith Sheets(\"Customers\")\n\n    'Open a connection to SQL Server\n    conn.Open \"Provider=SQLOLEDB;Data Source=TESTpc\\SQLEXPRESS;Initial Catalog=ExcelSQLServerDemo;Trusted_connection=yes\"\n\n   'Skip the header row\n    iRowNo = 2\n\n    'Loop until empty cell in CustomerId\n    Do Until .Cells(iRowNo, 1) = \"\"\n        sCustomerId = .Cells(iRowNo, 1)\n        sFirstName = .Cells(iRowNo, 2)\n        sLastName = .Cells(iRowNo, 3)\n\n        'Generate and execute sql statement to import the excel rows to SQL Server table\n        conn.Execute \"INSERT into dbo.Customers (CustomerId, FirstName, LastName) values ('\" &amp; sCustomerId &amp; \"', '\" &amp; sFirstName &amp; \"', '\" &amp; sLastName &amp; \"')\"\n\n        iRowNo = iRowNo + 1\n    Loop\n\n    MsgBox \"Customers Exported To Database\"\n\n    conn.Close\n    Set conn = Nothing\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Even though there are more efficient ways to export the data. This example is just for your reference purpose.</p>\n"}], "owner": {"reputation": 1235, "user_id": 1323474, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/b434e36ec89dcb5183c99c2e7e83e957?s=128&d=identicon&r=PG&f=1", "display_name": "pvaitonis", "link": "https://stackoverflow.com/users/1323474/pvaitonis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3802, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536419698, "creation_date": 1474446085, "last_edit_date": 1474447785, "question_id": 39611126, "link": "https://stackoverflow.com/questions/39611126/how-to-connect-to-sql-server-using-excel-macros", "title": "How to connect to SQL Server using Excel Macro&#39;s?", "body": "<p>I have <code>SQLEXPRESS</code> connection details. I want to connect to database using VBA way, and export data from SQL Server table <code>items</code> to new sheet in current Excel workbook and specified sheet. </p>\n\n<p>I have tried data import from excel \"External Data\", that gives me full table when adding it to excel workbook. </p>\n\n<p>How to add to Excel only 1 or 2 columns from my external table?</p>\n\n<p>Updated: my code right now is</p>\n\n<pre><code>Sub SQL_Connection()\n\nDim con As ADODB.Connection\nDim rs As ADODB.Recordset\nDim query As String\nSet con = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\nstrCon = \"Provider=SQLOLEDB; \" &amp; _\n    \"Data Source=\"\\\\localhost\\SQLEXPRESS\"; \" &amp; _\n    \"Initial Catalog=catalog;\" &amp; _\n    \"User ID=User; Password=password; Trusted_Connection=yes\"\ncon.Open (strCon)\nEnd Sub\n</code></pre>\n\n<p>Getting compile error:</p>\n\n<blockquote>\n  <p>Syntax error</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "button"], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "edited": false, "score": 0, "creation_date": 1474455331, "post_id": 39612582, "comment_id": 66535880, "body": "Thanks! It works so long as the Target is updated manually and so long as a single cell is updated. If I update multiple cells then it doesn&#39;t work, but that&#39;s no biggie.  Also I wanted the button to update based on a calculated cell, i.e. a cell that updates based on the value of other cells; is that possible?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "edited": false, "score": 0, "creation_date": 1474461183, "post_id": 39612582, "comment_id": 66539720, "body": "Check the updated code - it will fire only if a single cell is changed and works with the calculated cell."}, {"owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "edited": false, "score": 0, "creation_date": 1474488563, "post_id": 39612582, "comment_id": 66556620, "body": "Awesome! I had to put in a few If statements to protect it as otherwise it would get in to a bit of a tizzy and it now works well."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1474462793, "last_edit_date": 1495535651, "creation_date": 1474450048, "answer_id": 39612582, "question_id": 39610631, "link": "https://stackoverflow.com/questions/39610631/excel-vba-change-button-visibility-based-on-update-to-adjacent-cell/39612582#39612582", "title": "Excel VBA - Change button visibility based on update to adjacent cell", "body": "<p>I'm not sure if you can directly reference a shape by its location on the sheet.<br>\nThis code will look at each shape until it finds the one to the right of the cell you've just changed, it will then change the visibility based on the contents of the cell.<br>\n<code>(Target.Value &lt;&gt; \"\")</code> returns TRUE/FALSE.<br>\nThis will only work if your buttons are placed in the correct cell (slightly too high and it will return the cell above).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim shp As Shape\n\n    For Each shp In ThisWorkbook.Worksheets(\"Sheet1\").Shapes\n        If shp.TopLeftCell.Address = Target.Offset(, 1).Address Then\n            shp.Visible = (Target.Value &lt;&gt; \"\")\n            Exit For 'Exit the loop - the correct button has been found.\n        End If\n    Next shp\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nI've updated the code so it checks that only a single cell has been changed and then looks at each dependent cell of the cell that was changed.<br>\nThis will probably muck up if the dependent cell is on another sheet though.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rUpdated As Range\n    Dim shp As Shape\n    Dim rCell As Range\n\n    If Target.Cells.Count = 1 Then\n        'Hopefully someone will have better code than On Error....\n        On Error Resume Next\n        Set rUpdated = Range(Target.Dependents.Address)\n        On Error GoTo 0\n        If Not rUpdated Is Nothing Then\n            'Look at each dependent cell in rUpdated.\n            For Each rCell In rUpdated\n                'Look at each shape in the sheet and cross-reference with rCell.\n                For Each shp In Target.Parent.Shapes\n                    If shp.TopLeftCell.Address = rCell.Offset(, 1).Address Then\n                        shp.Visible = (Target.Value = 0)\n                        Exit For 'Exit the loop - the correct button has been found.\n                    End If\n                Next shp\n            Next rCell\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>NB:  I got the idea for checking the dependent cell from here: <a href=\"https://stackoverflow.com/questions/4388279/how-can-i-run-a-vba-code-each-time-a-cell-get-is-value-changed-by-a-formula\">How can I run a VBA code each time a cell get is value changed by a formula?</a></p>\n"}], "owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 39612582, "answer_count": 1, "score": 1, "last_activity_date": 1474462793, "creation_date": 1474444577, "question_id": 39610631, "link": "https://stackoverflow.com/questions/39610631/excel-vba-change-button-visibility-based-on-update-to-adjacent-cell", "title": "Excel VBA - Change button visibility based on update to adjacent cell", "body": "<p>I have data in column \"AK\" and a button in Column \"AL\"; there are several hundred rows and there is only one macro for all buttons as it uses relative references based on the row it is in.</p>\n\n<p>I want the button to only be visible when there is data in the adjacent cell. The following pseudo-code explains what I am trying to achieve:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 37 Then\n        If Target.Value = 0 Then\n            Shapes(Target.offset(0, 1)).Visible = False\n        Else\n            Shapes(Target.offset(0, 1)).Visible = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>The reason for doing this is that the value in AK is calculated based on other values and only displays once all mandatory fields have been completed. The button should only be available for an automation task once all details are complete. What real code would make this work without having to call each button out individually?</p>\n"}, {"tags": ["c++", "excel", "vba", "dll"], "answers": [{"tags": [], "owner": {"reputation": 944, "user_id": 3260013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xm2VE.jpg?s=128&g=1", "display_name": "Trifon", "link": "https://stackoverflow.com/users/3260013/trifon"}, "is_accepted": false, "score": 1, "last_activity_date": 1474443594, "creation_date": 1474443594, "answer_id": 39610310, "question_id": 39610157, "link": "https://stackoverflow.com/questions/39610157/vba-calling-c-dll-error-48-file-not-found/39610310#39610310", "title": "VBA Calling C++ DLL - error 48 (file not found)", "body": "<p>Most probably your DLL depends on C++ redistributables. Depending on the version of VC++ you have used to develop your DLL, you should install the relevant version of VC++ redistributables on the target machine. </p>\n\n<p>In case of VS 2015 you can find VC++ redistributables here:\n<a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=48145\" rel=\"nofollow\">https://www.microsoft.com/en-us/download/details.aspx?id=48145</a></p>\n"}, {"tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1474445031, "last_edit_date": 1495540456, "creation_date": 1474445031, "answer_id": 39610783, "question_id": 39610157, "link": "https://stackoverflow.com/questions/39610157/vba-calling-c-dll-error-48-file-not-found/39610783#39610783", "title": "VBA Calling C++ DLL - error 48 (file not found)", "body": "<p>Use the SysInternals Process Monitor utility to monitor DLL access and look for errors.  An example is in this <a href=\"https://stackoverflow.com/a/18650202/235698\">other answer</a>.  Watch the Excel process and the CreateFile operation.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 5010609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5646af62192791d51ef9322ce35bffd1?s=128&d=identicon&r=PG&f=1", "display_name": "efnfast", "link": "https://stackoverflow.com/users/5010609/efnfast"}, "is_accepted": false, "score": 0, "last_activity_date": 1474468565, "creation_date": 1474468565, "answer_id": 39619587, "question_id": 39610157, "link": "https://stackoverflow.com/questions/39610157/vba-calling-c-dll-error-48-file-not-found/39619587#39619587", "title": "VBA Calling C++ DLL - error 48 (file not found)", "body": "<p>Ah-ha, I found the issue.  It turns out that it requires 2 DLL files - msvcr120.dll and msvc120.dll.  I had these 2 files in my System32 folder, but not in my SysWOW64 folder.  As soon as i populated that folder then the DLLs started working. </p>\n\n<p>I found many threads on google with the 'same' problem but no answer, so if you run into the same issue I'd suggest using dependency walker and making sure the DLLs are in both system folders to be safe (although I suspect System32 is only needed for 64bit DLL, and SysWOW64 for 32bit DLLs).</p>\n"}, {"tags": [], "owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "is_accepted": false, "score": 0, "last_activity_date": 1492197104, "creation_date": 1492197104, "answer_id": 43417788, "question_id": 39610157, "link": "https://stackoverflow.com/questions/39610157/vba-calling-c-dll-error-48-file-not-found/43417788#43417788", "title": "VBA Calling C++ DLL - error 48 (file not found)", "body": "<p>Error 48 can also be returned when the dll does not correspond to the bitness of the calling program. So, if you're runnning Excel's VBA with Excel 64-bit, for example, you want to make sure the DLL is compiled as a 64-bit binary.</p>\n\n<p>Note this is different from error 53 wich really means the DLL is not found in any paths.</p>\n"}], "owner": {"reputation": 45, "user_id": 5010609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5646af62192791d51ef9322ce35bffd1?s=128&d=identicon&r=PG&f=1", "display_name": "efnfast", "link": "https://stackoverflow.com/users/5010609/efnfast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3875, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1571862595, "creation_date": 1474443113, "last_edit_date": 1474468622, "question_id": 39610157, "link": "https://stackoverflow.com/questions/39610157/vba-calling-c-dll-error-48-file-not-found", "title": "VBA Calling C++ DLL - error 48 (file not found)", "body": "<p>I have an Excel workbook that calls a test DLL I wrote in C++.  The path to DLL is hardcoded in VBA.  The only files the DLL uses are stdlib and iostream.</p>\n\n<p>On my machine it works.  On several other office machines it works.  However, on the remainder when i try to call the DLL through Excel I get error 48 - file not found. </p>\n\n<p>My understanding is error 53 is the file is missing; error 48 is there are missing dependencies.  I have used dependency walker and have not found any issues. </p>\n\n<p>What I did discover, however, is that if I install Visual Studio on a machine there is a 90% chance that after the install the Excel file/DLL works perfectly.  On the 10% that it does not work, I restart and re-run the Visual Studio install, selected 'repair', and after the installation finishes again the Excel/DLL combo works.  So basically installing Visual Studio allows the DLL to be loaded by Excel.  If i uninstall Visual Studio the DLL still works fine. </p>\n\n<p>Obviously this means something is missing on those machines, but I have no idea what - I've tried separately installing all the pieces that show up under 'programs', such as most current .net framework, visual c++ re-distributables, etc... and it doesn't work.  The only thing that works is installing Visual Studio itself. \nI'm not certain how to proceed since asking users to mount a 5gig ISO and install a developer environment isn't really ideal.</p>\n\n<hr>\n\n<p>Ah-ha, I found the issue. It turns out that it requires 2 DLL files - msvcr120.dll and msvc120.dll. I had these 2 files in my System32 folder, but not in my SysWOW64 folder. As soon as i populated that folder then the DLLs started working.</p>\n\n<p>I found many threads on google with the 'same' problem but no answer, so if you run into the same issue I'd suggest using dependency walker and making sure the DLLs are in both system folders to be safe (although I suspect System32 is only needed for 64bit DLL, and SysWOW64 for 32bit DLLs).</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1474443169, "post_id": 39610003, "comment_id": 66527933, "body": "It is kind of hard to understand what you want. Are you asking how to check two conditions at once? Just use <code>If condition1 And condition2 Then</code>. That would not be considered &quot;looping twice&quot; though because... well, you&#39;re only looping once. Using <code>Select Case</code> seems kind of overkill here unless you want to add more cases. Oh and also string comparisons are mostly case sensitive."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1474443336, "post_id": 39610003, "comment_id": 66528035, "body": "Some of your Cell calls are missing dots, so refer to the active sheet rather than your With block sheet"}, {"owner": {"reputation": 345, "user_id": 4388503, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f7e56f5fc3ecac98abdf6f33a095045?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta Reddy", "link": "https://stackoverflow.com/users/4388503/shweta-reddy"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1474444412, "post_id": 39610003, "comment_id": 66528691, "body": "@arcadeprecinct here I want all the rows with STP in one loop and within this loop I need to again check for case if that is eng/sve/gmo If this condition is satisfied then I need to take that row as active row.  can you please check my edited question with expected output"}, {"owner": {"reputation": 345, "user_id": 4388503, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f7e56f5fc3ecac98abdf6f33a095045?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta Reddy", "link": "https://stackoverflow.com/users/4388503/shweta-reddy"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1474444618, "post_id": 39610003, "comment_id": 66528819, "body": "@chrisneilsen Can you please check my edited question with expected output so that you can help me"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1474444955, "post_id": 39610003, "comment_id": 66528997, "body": "@ShopShop sounds like you would want to do an <code>If</code> check for STP first and then a <code>Select Case</code> for eng/sve/gmo? It also sounds like it could be done with formulas instead of vba."}, {"owner": {"reputation": 345, "user_id": 4388503, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f7e56f5fc3ecac98abdf6f33a095045?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta Reddy", "link": "https://stackoverflow.com/users/4388503/shweta-reddy"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1474445106, "post_id": 39610003, "comment_id": 66529094, "body": "@arcadeprecinct Exactly ! but I am supposed to do this in vba only :(..  Checking for STP and select case for eng/sve/gmo.. any help on looping structure to achive correct rows???  i am actully missing correct rows in this looping"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1474445121, "post_id": 39610003, "comment_id": 66529104, "body": "Can you not just use Filters in your worksheet to achieve this? sounds like it would give you what you need without having to write VBA"}, {"owner": {"reputation": 345, "user_id": 4388503, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f7e56f5fc3ecac98abdf6f33a095045?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta Reddy", "link": "https://stackoverflow.com/users/4388503/shweta-reddy"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1474445196, "post_id": 39610003, "comment_id": 66529139, "body": "@Zac Actully I am supposed to automate calculations for every month in next 12 sheets ... so thats the reason I am using vba."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1474445436, "post_id": 39610003, "comment_id": 66529278, "body": "If you really want to use VBA, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow noreferrer\">have a look here</a>. It should give you an idea on how to use filters within your VBA"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1474448282, "creation_date": 1474448282, "answer_id": 39611898, "question_id": 39610003, "link": "https://stackoverflow.com/questions/39610003/looping-twice-in-vba/39611898#39611898", "title": "looping twice in vba?", "body": "<p>Instead of looping twice you may loop once and then check for condition something like below:</p>\n\n<pre><code>With Worksheets(\"Mktg.Effort\")\n    For lrow = 2 To .Cells(.Rows.Count, \"R\").End(xlUp).Row\n    Select Case CStr(Cells(lrow, \"R\").Value)\n    Case \"STP\"\n        If CStr(Cells(lrow, \"A\").Value) = \"Eng\" Then\n            ' adding all eng cols\n            ' and this data should fall in STP sheet.\n        ElseIf CStr(Cells(lrow, \"A\").Value) = \"SVE\" Then\n            '....and so on\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 4388503, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f7e56f5fc3ecac98abdf6f33a095045?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta Reddy", "link": "https://stackoverflow.com/users/4388503/shweta-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "accepted_answer_id": 39611898, "answer_count": 1, "score": 0, "last_activity_date": 1474448282, "creation_date": 1474442688, "last_edit_date": 1474444551, "question_id": 39610003, "link": "https://stackoverflow.com/questions/39610003/looping-twice-in-vba", "title": "looping twice in vba?", "body": "<p>I am having excel like below,</p>\n\n<pre><code>  Src   Base  June  July\n  Eng   STP   10    20\n  Sve   STP   20    30\n  GMO   SEZ   30    10\n  Eng   STP   20    30\n  Sve   SEZ   40    50\n</code></pre>\n\n<p>Here I want to loop all based on condition like..\n       STP should be fallen in STP sheet along with addition of Eng fields in it\n       SEZ should fall in SEZ sheet along with their respective columns</p>\n\n<p>I am unable to loop with each case here..</p>\n\n<p>My trial was like below..</p>\n\n<pre><code>    With Worksheets(\"Mktg.Effort\")\n    For lrow = 2 To .Cells(.Rows.Count, \"R\").End(xlUp).Row\n    Select Case CStr(Cells(lrow, \"R\").Value) \n    Case \"STP\"\n     Worksheets(\"Mktg.Effort\").Rows(lrow).Activate\n     For lroww = 1 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n     Select Case CStr(Cells(lroww, \"A\").Value)\n     Case \"engg\"\n         ' adding all eng cols \n         ' and this data should fall in STP sheet.\n</code></pre>\n\n<p>Here I am geting all Eng fields irrespective to base(STP/SEZ) condition.\nI want to loop with both the conditions \n1. should check if STP/ SEZ\n2. SHould check if Eng/Sve/gmo \nand accordingly i must automate data.</p>\n\n<p>ENy help please. I am struck here with no idea.</p>\n\n<p>Expected output:</p>\n\n<pre><code>     Src  Base  June  July\n     Eng  STP   30    50    ' added all ENG into one row\n     Sve  STP   20    30\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 3, "creation_date": 1474439816, "post_id": 39608986, "comment_id": 66525995, "body": "With 4 nested <code>With</code> blocks I would highly recommend proper indentation. You will notice that the <code>ElseIf</code> is indeed without <code>If</code> in the <code>With Range(&quot;L3:L&quot; &amp; LR)</code> block."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1474440000, "post_id": 39608986, "comment_id": 66526078, "body": "I count 6 <code>With</code> and 4 <code>End With</code>, so that points to a problem right there...  Also there&#39;s no <code>Return</code> in VBA, unless that&#39;s a method you&#39;ve created."}, {"owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "edited": false, "score": 0, "creation_date": 1474440347, "post_id": 39608986, "comment_id": 66526283, "body": "I have added 2 End With and Else  Return, however still it is giving same error message"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1474440633, "post_id": 39608986, "comment_id": 66526426, "body": "You can&#39;t have interleaving blocks of <code>With... End With</code> and <code>If ... End If</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 5, "last_activity_date": 1474441165, "creation_date": 1474441165, "answer_id": 39609495, "question_id": 39608986, "link": "https://stackoverflow.com/questions/39608986/getting-an-error-msg-while-using-if-condition/39609495#39609495", "title": "Getting an Error msg while using IF condition", "body": "<p>You can't interleave blocks.</p>\n\n<p>Following code will generate a <code>End If without If block</code> error:</p>\n\n<pre><code>If True Then\n    With Range(\"A1\")\nEnd If\n    End With\n</code></pre>\n\n<p>Following code will generate a <code>End With without With block</code> error:</p>\n\n<pre><code>With Range(\"A1\")\n    If True Then\nEnd With\n    End If\n</code></pre>\n\n<p>Use code like this:</p>\n\n<pre><code>With Range(\"A1\")\n    If True Then\n    End If\nEnd With\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If True Then\n    With Range(\"A1\")\n    End With\nEnd If\n</code></pre>\n\n<p>As mentioned by arcadeprecinc, a proper indentitation of your code would have shown the problem.</p>\n"}], "owner": {"reputation": 19, "user_id": 6743256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e60d776d46fb6ff13be8f9c407f2bf2a?s=128&d=identicon&r=PG&f=1", "display_name": "Nilesh Pawar", "link": "https://stackoverflow.com/users/6743256/nilesh-pawar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1474441165, "creation_date": 1474439468, "last_edit_date": 1531164843, "question_id": 39608986, "link": "https://stackoverflow.com/questions/39608986/getting-an-error-msg-while-using-if-condition", "title": "Getting an Error msg while using IF condition", "body": "<p>I am using IF condition but is given me compile error \"Else without IF\"\n    I want to right loop statement, so it will calculate formula till display cells</p>\n\n<pre><code>With Range(\"K3:K\" &amp; LR)\nLR = Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\nWith .Resize(.Rows.Count - 1, .Columns.Count).Offset(2, 0)\n\n\nIf Range(\"K\" &amp; LR).Value = \"No\" Then\nWith .Resize(.Rows.Count - 1, .Columns.Count).Offset(2, 0)\nWith Range(\"L3:L\" &amp; LR)\nSheets(\"Sheet1\").Range(\"L3\" &amp; LR).FormulaR1C1 = \"\"\n\nElseIf Range(\"K\" &amp; LR).Value = \"Yes\" Then\n\nWith .Resize(.Rows.Count - 1, .Columns.Count).Offset(2, 0)\nWith Range(\"L3:L\" &amp; LR)\nSheets(\"Sheet1\").Range(\"L3\" &amp; LR).FormulaR1C1 = \"=RC[-2]*0.25%\"\n\nElse\n\nReturn\n\n\n\n\nEnd With\n End With\n  End If\n   End With\n    End With\n</code></pre>\n\n<p>Please can you help on this</p>\n"}, {"tags": ["vba", "excel", "inputbox"], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 2, "creation_date": 1474438028, "post_id": 39608101, "comment_id": 66525188, "body": "FYI: The <code>IsNumeric(CO2PriceBox)</code> is obsolete as all non-numerical values will trigger an VBA-error at the <code>&lt;</code> sign (because it can not be compared). Still, using <code>Application.InputBox</code> with <code>Type:=1</code> is possible to avoid this by default. ;)"}, {"owner": {"reputation": 23, "user_id": 6851629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05b2253ee05e681d186fea4f1241537?s=128&d=identicon&r=PG&f=1", "display_name": "AF721", "link": "https://stackoverflow.com/users/6851629/af721"}, "edited": false, "score": 0, "creation_date": 1474464329, "post_id": 39608101, "comment_id": 66541972, "body": "Thanks! This solution is almost perfect, but one slight issue: I typed it in exactly as stated and it works smoothly, but it doesn&#39;t actually revert the value in the cell to the default value (10) if a value entered is outside the range. It corrects it in the dialogue box, but not the actual cell. Any advice? Thanks!"}, {"owner": {"reputation": 23, "user_id": 6851629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05b2253ee05e681d186fea4f1241537?s=128&d=identicon&r=PG&f=1", "display_name": "AF721", "link": "https://stackoverflow.com/users/6851629/af721"}, "edited": false, "score": 0, "creation_date": 1474464667, "post_id": 39608101, "comment_id": 66542197, "body": "Never mind, problem solved! I just needed to add &quot;Range(&quot;C11&quot;).Value = CO2PriceBox&quot; after the line instructing the macro to use the default value. Thanks!"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 1, "last_activity_date": 1474436416, "last_edit_date": 1474436416, "creation_date": 1474435157, "answer_id": 39608101, "question_id": 39608016, "link": "https://stackoverflow.com/questions/39608016/inputbox-only-allow-certain-range-of-values/39608101#39608101", "title": "InputBox: Only allow certain range of values", "body": "<p>I would do it like this:</p>\n\n<pre><code>Dim CO2PriceBox As Variant\n\nCO2PriceBox = InputBox(\"Please Enter CO2 Allowance Price ($/ton)\", \"Enter CO2 Allowance Price\", 0)\n\nIf Not IsNumeric(CO2PriceBox) Or CO2PriceBox &lt; 0 Or 100 &lt; CO2PriceBox Then 'If value out of specified range\n\n    CO2PriceBox = 10 'Default value\n    MsgBox \"You Entered a wrong value, using default\", vbOKOnly\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1474437188, "creation_date": 1474437188, "answer_id": 39608483, "question_id": 39608016, "link": "https://stackoverflow.com/questions/39608016/inputbox-only-allow-certain-range-of-values/39608483#39608483", "title": "InputBox: Only allow certain range of values", "body": "<p>you could use Excel <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839468(v=office.15).aspx\" rel=\"nofollow\">InputBox()</a> method to build a little \"wrapper\" function:</p>\n\n<pre><code>Function GetValue(prompt As String, title As String, minVal As Long, maxVal As Long, defVal As Long) As Variant\n    GetValue = Application.InputBox(prompt &amp; \"[\" &amp; minVal &amp; \"-\" &amp; maxVal &amp; \"]\", title, Default:=defVal, Type:=1)\n    If GetValue &lt; minVal Or GetValue &gt; maxVal Then\n        GetValue = defVal\n        MsgBox \"your input exceeded the range: [\" &amp; minVal &amp; \"-\" &amp; maxVal &amp; \"]\" &amp; vbCrLf &amp; vbCrLf &amp; \"the default value (\" &amp; defVal &amp; \") was applied\", vbInformation\n    End If\nEnd Function\n</code></pre>\n\n<p>and use it as follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n\n    Range(\"C11\").Value = GetValue(\"Please Enter CO2 Allowance Price ($/ton)\", \"Enter CO2 Allowance Price\", 0, 100, 10)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6851629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05b2253ee05e681d186fea4f1241537?s=128&d=identicon&r=PG&f=1", "display_name": "AF721", "link": "https://stackoverflow.com/users/6851629/af721"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3695, "favorite_count": 0, "accepted_answer_id": 39608101, "answer_count": 2, "score": 1, "last_activity_date": 1474466284, "creation_date": 1474434716, "last_edit_date": 1474466284, "question_id": 39608016, "link": "https://stackoverflow.com/questions/39608016/inputbox-only-allow-certain-range-of-values", "title": "InputBox: Only allow certain range of values", "body": "<p>I want to limit the range of accepted values that users can input.</p>\n\n<p>For instance, I want to allow 0-100 only, and if they enter over 100, then </p>\n\n<ol>\n<li>automatically enter a default value (such as 10) and </li>\n<li>create a pop-up message indicating that the default value was applied. </li>\n</ol>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Dim CO2PriceBox As Variant\n    CO2PriceBox = InputBox(\"Please Enter CO2 Allowance Price ($/ton)\", \"Enter CO2 Allowance Price\", 0)\n    Range(\"C11\").Value = CO2PriceBox\n</code></pre>\n"}, {"tags": ["vba", "fax"], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 6373627, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5317d7af58dbee5f16f41159db958aac?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyBaltimore", "link": "https://stackoverflow.com/users/6373627/johnnybaltimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1474469054, "creation_date": 1474469054, "answer_id": 39619779, "question_id": 39607562, "link": "https://stackoverflow.com/questions/39607562/vba-fax-using-fax-server-on-server-from-computer-on-network/39619779#39619779", "title": "VBA Fax using fax server on server from computer on network", "body": "<p>I figured out the solution.  I needed to set Adobe Acrobat Reader DC as the default program to handle .pdfs on the remote computers.</p>\n"}], "owner": {"reputation": 57, "user_id": 6373627, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5317d7af58dbee5f16f41159db958aac?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyBaltimore", "link": "https://stackoverflow.com/users/6373627/johnnybaltimore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474469054, "creation_date": 1474432092, "last_edit_date": 1474468986, "question_id": 39607562, "link": "https://stackoverflow.com/questions/39607562/vba-fax-using-fax-server-on-server-from-computer-on-network", "title": "VBA Fax using fax server on server from computer on network", "body": "<p>I am running Windows Server 2008 R2.  I installed the fax server role on the server.  I am able to fax documents using the external fax modem attached to the server from computers attached to the network by printing the documents and selecting \"Fax on MYSERVER\".  I am able to fax a .pdf using the following code (which I got from mdsn.microsoft.com) from the server but not from any other computer even when logged into the computer using the administrator account.</p>\n\n<pre><code>Sub fax_report(location_fax_number, report_name, fax_location, fax_file_path)\n    Dim objFaxDocument As New FAXCOMEXLib.FaxDocument\n    Dim objFaxServer As New FAXCOMEXLib.FaxServer\n    Dim JobID As Object\n\n    On Error GoTo Err_Clear\n\nErr_Clear:\n    If Err &lt;&gt; 0 Then\n        Err.Clear\n        Resume Next\n    End If\n\n    'Connect to the fax server\n    objFaxServer.Connect (\"\\\\MYSERVER\")\n\n    'Set the fax body\n    objFaxDocument.Body = fax_file_path\n\n    'Name the document\n    objFaxDocument.DocumentName = report_name\n\n    objFaxDocument.Recipients.add (location_fax_number)\n\n    JobID = objFaxDocument.ConnectedSubmit(objFaxServer)\n\n    objFaxServer.Disconnect\n\nEnd Sub\n</code></pre>\n\n<p>The error I'm getting is:</p>\n\n<ul>\n<li>Description: \"Operation failed\" </li>\n<li>HelpContext: 1000440 </li>\n<li>HelpFile: \"C:\\Program Files (x86)\\Common Files\\Microsoft\nShared\\VBA\\VBA7.1\\1033\\VbLR6.chm\" </li>\n<li>LastDllError: 0 </li>\n<li>Number: -2147023741</li>\n<li>Source: \"FaxComEx.FaxDocument.1\"</li>\n</ul>\n\n<p>Although I am able to fax a .pdf from the server when I try from a computer on the network it fails.  I am able to send a .txt file fro a computer on the network.  It looks like the .pdf isn't automatically being converted to a .tiff file like it is when I run the code on the server.  When I run the code from the server Adobe Acrobat Reader DC opens, the .pdf is opened and converted then faxed without error.  Adobe stays open and I can see a temp file was created, it isn't available to be opened from the recent file lists menu.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1474432720, "creation_date": 1474432720, "answer_id": 39607664, "question_id": 39607492, "link": "https://stackoverflow.com/questions/39607492/referring-to-the-same-dynamic-range-across-multiple-worksheets/39607664#39607664", "title": "Referring to the same dynamic range across multiple worksheets", "body": "<p>Assuming that the address is too long to pass to <code>.Range()</code> directly, the best I can think of is to manually recreate the range using <code>Union</code>:</p>\n\n<pre><code>For j = 2 To blockNo\n    row1 = 3 + (j - 1) * (pronum + 18)\n    row2 = row1 + pronum - 1\n    Set rng2 = Union(rng2, Range(\"Q\" &amp; row1 &amp; \":BA\" &amp; row2))\nNext\n\nDim sheet As Worksheet\nDim target As Range\nFor k = 1 To 8\n    Set sheet = Sheets(k)\n    Set target = sheet.Range(rng2.Cells(1, 1).Address)\n    Dim cell as Range\n    For Each cell In rng2.Cells\n        Set target = Union(sheet.Cells(cell.Row, cell.Column), target)\n    Next cell\n    sheet.Activate\n    rng2.Copy........\nNext\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6389159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d5c71a4cb764ed03d7cf8720d1185f?s=128&d=identicon&r=PG&f=1", "display_name": "datrubuk", "link": "https://stackoverflow.com/users/6389159/datrubuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474432720, "creation_date": 1474431594, "question_id": 39607492, "link": "https://stackoverflow.com/questions/39607492/referring-to-the-same-dynamic-range-across-multiple-worksheets", "title": "Referring to the same dynamic range across multiple worksheets", "body": "<p>I'm looping to create a generic range which I want to apply to 8 worksheets (which are identical apart from values.)</p>\n\n<pre><code>For j = 2 To blockNo\nrow1 = 3 + (j - 1) * (pronum + 18)\nrow2 = row1 + pronum - 1\nSet rng2 = Union(rng2, Range(\"Q\" &amp; row1 &amp; \":BA\" &amp; row2))\nNext j\n\nFor k = 1 To 8\nSheets(k).Activate\nrng2.Copy........\n</code></pre>\n\n<p>It's not working because rng2 is worksheet specific, so it's copying the range values from sheet 1.</p>\n\n<p>I think the following may be a solution, but it's not elegant and would be slow. </p>\n\n<pre><code>For k = 1 To 8\n    Sheets(k).Activate\n    For j = 2 To blockNo\n    row1 = 3 + (j - 1) * (pronum + 18)\n    row2 = row1 + pronum - 1\n    Set rng2 = Union(rng2, Range(\"Q\" &amp; row1 &amp; \":BA\" &amp; row2))\n    Next j\n    rng2.Copy........\n</code></pre>\n\n<p>I've tried sheets(k).range(rng2.address), but this appears to be limited to certain number of characters so my range doesn't capture the whole of rng2.</p>\n\n<p>Is there another solution?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474430707, "post_id": 39607301, "comment_id": 66522844, "body": "Assuming the current code works and produces Test.txt, and assuming the ActiveSheet&#39;s name does not contain any characters that are not valid as part of a file name, I can&#39;t see why <code>Open ActiveSheet.Name &amp; &quot;.txt&quot; For Output As #nFileNum</code> wouldn&#39;t work (unless you were trying to use that statement <b>as well as</b> the <code>Open &quot;Test.txt&quot; For Output As #nFileNum</code> statement).  Are you getting any error messages?  Or does it just run but not produce anything?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1474431148, "post_id": 39607301, "comment_id": 66522934, "body": "<code>ThisWorkbook.FullName</code> includes the full path, <code>Worksheet.Name</code> / <code>ActiveSheet.Name</code> do not.  Try <code>ThisWorkbook.Path &amp; Application.PathSeparator &amp; ActiveSheet.Name &amp; &quot;.txt&quot;</code>"}, {"owner": {"reputation": 196, "user_id": 63504, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f405a5a57404409f6ce8088dd4d9ff37?s=128&d=identicon&r=PG", "display_name": "monkeypushbutton", "link": "https://stackoverflow.com/users/63504/monkeypushbutton"}, "edited": false, "score": 0, "creation_date": 1474481360, "post_id": 39607301, "comment_id": 66552737, "body": "chris neilsen - thanks, a life saver.  If you put this as an answer, I will accept it."}], "owner": {"reputation": 196, "user_id": 63504, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f405a5a57404409f6ce8088dd4d9ff37?s=128&d=identicon&r=PG", "display_name": "monkeypushbutton", "link": "https://stackoverflow.com/users/63504/monkeypushbutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474430272, "creation_date": 1474430272, "question_id": 39607301, "link": "https://stackoverflow.com/questions/39607301/save-excel-worksheet-as-text-file-with-name-of-worksheet", "title": "Save Excel worksheet as text file with name of worksheet", "body": "<p>Trying to save the current worksheet of an Excel workbook with the name of the worksheet.  Based on an example from <a href=\"http://www.mcgimpsey.com/excel/textfiles.html\" rel=\"nofollow\">http://www.mcgimpsey.com/excel/textfiles.html</a>.  I can save it with the name of the workbook (using Open (ThisWorkbook.FullName &amp; \".txt\") For Output As #nFileNum), but not the worksheet.  Tried ActiveSheet.Name, which will show in a msgBox, but it doesn't save.</p>\n\n<pre><code>    'from http://www.mcgimpsey.com/excel/textfiles.html\nPublic Sub FixedFieldTextFile()\n    Const DELIMITER As String = \"\" 'Normally none\n    Const PAD As String = \" \"   'or other character\n    Dim vFieldArray As Variant\n    Dim myRecord As Range\n    Dim nFileNum As Long\n    Dim i As Long\n    Dim sOut As String\n    'MsgBox (ActiveSheet.Name)\n    'vFieldArray contains field lengths, in characters, from field 1 to N\n    vFieldArray = Array(30, 10, 10, 25, 25, 14, 14, 14, 14, 10, 10, 10, 10)\n    nFileNum = FreeFile\n    Open \"Test.txt\" For Output As #nFileNum\n    'Open (ThisWorkbook.FullName &amp; \".txt\") For Output As #nFileNum\n    'Open (ActiveSheet.Name &amp; \".txt\") For Output As #nFileNum\n    'Open (Worksheet.Name &amp; \".txt\") For Output As #nFileNum\n    For Each myRecord In Range(\"A1:A\" &amp; _\n            Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n        With myRecord\n            For i = 0 To UBound(vFieldArray)\n                sOut = sOut &amp; DELIMITER &amp; Left(.Offset(0, i).Text &amp; _\n                        String(vFieldArray(i), PAD), vFieldArray(i))\n            Next i\n            Print #nFileNum, Mid(sOut, Len(DELIMITER) + 1)\n            sOut = Empty\n        End With\n    Next myRecord\n    Close #nFileNum\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474437781, "post_id": 39607190, "comment_id": 66525086, "body": "what combobox type do you have: a <code>Form</code> one or an <code>ActiveX</code> one ?"}, {"owner": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474512978, "post_id": 39607190, "comment_id": 66564222, "body": "its an ActiveX combobox"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "edited": false, "score": 0, "creation_date": 1474431589, "post_id": 39607363, "comment_id": 66523042, "body": "it really works! thank you captain  any way how if the combobox is literally not only &quot;PM&quot; &quot;CM&quot; &quot;QMC&quot; but it has their own types such as &quot;PM-F&quot; &quot;PM-F-LV&quot; &quot;CM-S&quot; and so....is it possible to detect by the most left words? or should I write down all possibilities ?"}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "reply_to_user": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "edited": false, "score": 0, "creation_date": 1474434823, "post_id": 39607363, "comment_id": 66523980, "body": "Depending on how the combo is populating you could set the array to use that range as the array source. If they can alter the types and create user defined values maybe look at storing the values somewhere and they checking the value entered against the stored list and if not there adding it. Oh the left most part yeah, try Left(Range(&quot;C10&quot;).Value, 2).... Maybe change the 2 to a max of the result of a find of the value and &quot;-&quot; and the value of 2. That is off the top of my head and I would have to play with it to get it going. Have a go and see where you end up."}, {"owner": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "edited": false, "score": 0, "creation_date": 1474512952, "post_id": 39607363, "comment_id": 66564218, "body": "i already figured how, i made 2 combobox which is the 2nd one are correlated to the 1st one, and the 1st one is the key-word. thanks for your help!"}], "tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": false, "score": 0, "last_activity_date": 1474430656, "creation_date": 1474430656, "answer_id": 39607363, "question_id": 39607190, "link": "https://stackoverflow.com/questions/39607190/vba-get-value-from-combobox-to-hide-row/39607363#39607363", "title": "VBA get value from ComboBox to hide row", "body": "<p>Try using the filter method on an array of the values.</p>\n\n<pre><code>allowed = Array(\"QM\", \"PM\", \"QMC\", \"CM\")\n\nIf UBound(Filter(allowed, Range(\"C10\").Value)) &gt; -1 Then\n  Worksheets(\"page2\").Rows(\"43\").EntireRow.Hidden = False\nElse\n  Worksheets(\"page2\").Rows(\"43\").EntireRow.Hidden = True\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474430656, "creation_date": 1474429512, "question_id": 39607190, "link": "https://stackoverflow.com/questions/39607190/vba-get-value-from-combobox-to-hide-row", "title": "VBA get value from ComboBox to hide row", "body": "<p>I have a little bit difficult in getting combobox value.\nThe properties of this combobox is already linked to \"C10\" cell. So I assumed the combobox value = C10 value.\nThe combobox values are supposed to be hide non-used row, if the value of C10 = CM or QM or QMC or CM </p>\n\n<pre><code>If Worksheets(\"QC Generator\").Range(\"C10\").Value = \"QM,PM,QMC,CM\" Then\nWorksheets(\"page2\").Rows(\"43\").EntireRow.Hidden = False\nElse\nWorksheets(\"page2\").Rows(\"43\").EntireRow.Hidden = True\nEnd If\n</code></pre>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["javascript", "jquery", "excel", "vba", "scriptcontrol"], "answers": [{"tags": [], "owner": {"reputation": 292139, "user_id": 965051, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XgLe7.gif?s=128&g=1", "display_name": "adeneo", "link": "https://stackoverflow.com/users/965051/adeneo"}, "is_accepted": true, "score": 1, "last_activity_date": 1474427014, "creation_date": 1474427014, "answer_id": 39606865, "question_id": 39606837, "link": "https://stackoverflow.com/questions/39606837/convert-recursive-jquery-for-each-loop-into-javascript-for-vba-script-control/39606865#39606865", "title": "Convert Recursive jQuery For each loop into JavaScript for VBA Script Control", "body": "<p>You could just create your own <code>each</code> function</p>\n\n<pre><code>function each(obj, cb) {\n    for (var key in obj) {\n        cb(key, obj[key]);\n    }\n}\n\nfunction jsonFunction() {\n    var jsonObj = {\n        Item1: 'This is a test',\n        Item2: { Value1: '100', Value2: '200' },\n        Item3: { Value1: '101', Value2: '201' },\n    };\n\n    var result = '';\n\n    each(jsonObj, jsonLoop);\n\n    function jsonLoop(key, value) {\n        if (typeof value === 'object') {\n            each(value, jsonLoop);\n        } else {\n            result += key + ' : ' + value + ', ';\n        }\n    } \n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 39606865, "answer_count": 1, "score": 1, "last_activity_date": 1474427014, "creation_date": 1474426860, "question_id": 39606837, "link": "https://stackoverflow.com/questions/39606837/convert-recursive-jquery-for-each-loop-into-javascript-for-vba-script-control", "title": "Convert Recursive jQuery For each loop into JavaScript for VBA Script Control", "body": "<p>I'm trying to use the following script to iterate through a nested JSON object.  It works fine in html, however, I'm calling it from a Excel VBA ScriptControl object.  When I do, it returns an \"undefined\" error for the \"$\"</p>\n\n<p>I'm assuming it's because the VBA ScriptControl does not allow for jQuery (is that true?)</p>\n\n<p>So... Can some help in converting the \"$.each()\" parts below into javascript?</p>\n\n<p>Code:</p>\n\n<pre><code>function jsonFunction() {\n    var jsonObj = {\n        Item1: 'This is a test',\n        Item2: { Value1: '100', Value2: '200' },\n        Item3: { Value1: '101', Value2: '201' },\n    };\n\n    var result = '';\n\n    $.each(jsonObj, jsonLoop);\n\n    function jsonLoop(key, value) {\n        if (typeof value === 'object') {\n            $.each(value, jsonLoop);\n        } else {\n            result += key + ' : ' + value + ', ';\n        }\n    } \n    return result;\n}\n</code></pre>\n"}, {"tags": ["excel", "vba", "printing"], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 3634802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/724745702/picture?type=large", "display_name": "Hudlommen", "link": "https://stackoverflow.com/users/3634802/hudlommen"}, "is_accepted": true, "score": 0, "last_activity_date": 1476981769, "creation_date": 1476981769, "answer_id": 40160039, "question_id": 39606110, "link": "https://stackoverflow.com/questions/39606110/application-dialogsxldialogprint-show-only-prints-2-pages-at-a-time/40160039#40160039", "title": "Application.Dialogs(xlDialogPrint).Show only prints 2 pages at a time", "body": "<p>I found the reason (at least in my case). A pop-up was hidden behind my form as i pressed print, that got closed down with excel, so i never saw it. For some reason (Not excel or the code) the printer or network triggered a \"Data size overload\" on my printing job. Explaining how printing out 100's of pages at a time could see the printer run into memory trouble. For some reason my 8 page printout triggered that.. But like all other magic, it solved it self at some point.</p>\n"}], "owner": {"reputation": 69, "user_id": 3634802, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/724745702/picture?type=large", "display_name": "Hudlommen", "link": "https://stackoverflow.com/users/3634802/hudlommen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 40160039, "answer_count": 1, "score": 0, "last_activity_date": 1476981769, "creation_date": 1474420934, "question_id": 39606110, "link": "https://stackoverflow.com/questions/39606110/application-dialogsxldialogprint-show-only-prints-2-pages-at-a-time", "title": "Application.Dialogs(xlDialogPrint).Show only prints 2 pages at a time", "body": "<p>So, i've written this form overlay for an excel sheet. Long story short, all the values ends up in cells (surprise!). I have then preset a printout area a print button that calls </p>\n\n<pre><code>Application.Dialogs(xlDialogPrint).Show\n</code></pre>\n\n<p>But every time, no matter what amount of pages to print is input, i prints out 2 copies.. What?!\nI know you can use:</p>\n\n<pre><code>Application.Dialogs(xlDialogPrint).Show arg4:=4\n</code></pre>\n\n<p>But that is just a preset so you dont have to put in 4 your self.</p>\n\n<p>Do anyone have an idea of why excel is behaving like a printer prune? </p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1474421206, "post_id": 39606069, "comment_id": 66520629, "body": "This sort of thing is usually done by writing an event handler for the <code>Worksheet_Change</code> event. It is easy to find various examples online."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 6828511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OsEeD.jpg?s=128&g=1", "display_name": "EricIndecisive", "link": "https://stackoverflow.com/users/6828511/ericindecisive"}, "is_accepted": true, "score": 1, "last_activity_date": 1474430295, "last_edit_date": 1474430295, "creation_date": 1474429024, "answer_id": 39607121, "question_id": 39606069, "link": "https://stackoverflow.com/questions/39606069/how-to-run-macro-based-on-content-of-the-cell/39607121#39607121", "title": "How to run macro based on content of the cell", "body": "<p>Here's one way it can be done, this is assuming that all of your values are already there and you are running a check, rather than someone typing live in which case John's would be a good way to go.  However the one thing I don't like about worksheet_change is that once the macro is executed you can't hit undo.  I added in if length > 0, as if you have two empty cells it would still trigger.</p>\n\n<pre><code>Sub TestValues()\n\n'Define variables\nDim rng As Range\nDim cell As Range\n\n'Set variables\nSet rng = Range(\"A1:A10\")\n\n'Begin\nFor Each cell In rng\n    If Len(cell) &gt; 0 Then\n        If cell.Value = cell.Offset(0, 1).Value Then\n            'Run macro\n        End If\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>*Edit - I guess I didn't exactly read it right.  For some reason I was thinking you had a range of values to go through.  To do exactly what you asked for it would be more like this, sorry for the long post...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$A$1\" Then\n    If Len(Target) &gt; 0 Then\n        If Target.Value = Target.Offset(0, 1).Value Then\n            'Run macro\n        End If\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474700119, "post_id": 39609138, "comment_id": 66647783, "body": "@kitarika, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1474440028, "creation_date": 1474440028, "answer_id": 39609138, "question_id": 39606069, "link": "https://stackoverflow.com/questions/39606069/how-to-run-macro-based-on-content-of-the-cell/39609138#39609138", "title": "How to run macro based on content of the cell", "body": "<p>I assume your macro is in charge of changing A1 and/or B1 cells so that it really knows <em>when</em> to do that \"continuation check\".</p>\n\n<p>In this case you can do that in multiple ways, here are two of them:</p>\n\n<ul>\n<li><p>keep \"continuation\" code inside your macro</p>\n\n<pre><code>Sub main()\n\n    ' your code till the statement that changes A1 and/or B1\n\n    If Range(\"A1\").Value &lt;&gt; Range(\"B1\").Value Then Exit Sub '&lt;-- if cells A1 and B1 DON'T have the same values then exit sub\n\n    'here follows your code for the \"Task\"\n\nEnd Sub\n</code></pre></li>\n<li><p>demand the Task to another <code>Sub</code></p>\n\n<pre><code>Sub main()\n\n    ' your code till the statement that changes A1 and/or B1\n\n    If Range(\"A1\").Value = Range(\"B1\").Value Then DoTask '&lt;-- if cells A1 and B1 HAVE the same values then call 'DoTask()'\nEnd Sub\n\n\nSub DoTask()\n    ' here your code code for the \"Task\"\nEnd Sub\n</code></pre>\n\n<p>in this latter case you may want to pass one (or more) parameter from \"Main\" macro to <code>DoTask</code></p>\n\n<pre><code>Sub main()\n\n    ' your code till the statement that changes A1 and/or B1\n\n    If Range(\"A1\").Value = Range(\"B1\").Value Then DoTask Range(\"A1\").Value '&lt;-- if cells A1 and B1 HAVE the same values then call 'DoTask  passing A1 cell value as \"argument\"\nEnd Sub\n\n\nSub DoTask(val As Variant) '&lt;--| DoTask accepts a parameter declared as of Variant type (but you may choose a more proper one\n    ' here your code code for the \"Task\"\n    ' it will use 'val'\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 165, "user_id": 3193160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/GrsLp.jpg?s=128&g=1", "display_name": "kitarika", "link": "https://stackoverflow.com/users/3193160/kitarika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1442, "favorite_count": 0, "accepted_answer_id": 39607121, "answer_count": 2, "score": -1, "last_activity_date": 1474440028, "creation_date": 1474420635, "question_id": 39606069, "link": "https://stackoverflow.com/questions/39606069/how-to-run-macro-based-on-content-of-the-cell", "title": "How to run macro based on content of the cell", "body": "<p>I'm looking for some assisting on how to trigger continuation of macro based on the value of a cell please.</p>\n\n<p>What I'm hoping for is that when cell A1 = cell B1, I need it to perform a task, otherwise end script.</p>\n\n<p>I assume this would be a simple <code>If... Then</code> script? Any assistance is greatly appreciated!</p>\n"}, {"tags": ["excel", "listbox", "multi-select", "userform", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474419702, "post_id": 39605923, "comment_id": 66520253, "body": "Are you trying to copy all the files from <b>one</b> directory to <b>multiple</b> destination directories?"}, {"owner": {"reputation": 47, "user_id": 6168307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef3a77703a1231ad76f91548dbb8c79?s=128&d=identicon&r=PG", "display_name": "A Rossi", "link": "https://stackoverflow.com/users/6168307/a-rossi"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474420351, "post_id": 39605923, "comment_id": 66520441, "body": "It currently copies all the .sli file from the source folder to the destination folder. i want to copy the files from the source folder to multiple selected destination folders"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474420542, "post_id": 39606056, "comment_id": 66520495, "body": "<code>ListBox2.Items(i).Selected</code> should be <code>ListBox2.Selected(i)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474420718, "post_id": 39606056, "comment_id": 66520531, "body": "@Comintern - Thanks - you can tell I don&#39;t use ListBoxes very often - I just assumed the OP&#39;s code was correct, other than not knowing how to do the looping."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474420868, "post_id": 39606056, "comment_id": 66520553, "body": "That&#39;s probably why it was commented out. ;-)"}, {"owner": {"reputation": 47, "user_id": 6168307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef3a77703a1231ad76f91548dbb8c79?s=128&d=identicon&r=PG", "display_name": "A Rossi", "link": "https://stackoverflow.com/users/6168307/a-rossi"}, "edited": false, "score": 0, "creation_date": 1474420989, "post_id": 39606056, "comment_id": 66520579, "body": "I got a &quot;Compile error: Method or data member not found&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474421142, "post_id": 39606056, "comment_id": 66520611, "body": "@Comintern - there are a few other errors in the commented out code too"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 47, "user_id": 6168307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef3a77703a1231ad76f91548dbb8c79?s=128&d=identicon&r=PG", "display_name": "A Rossi", "link": "https://stackoverflow.com/users/6168307/a-rossi"}, "edited": false, "score": 0, "creation_date": 1474421397, "post_id": 39606056, "comment_id": 66520671, "body": "@ARossi - try now - I had to fix some of your other coding errors too."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474421414, "post_id": 39606056, "comment_id": 66520678, "body": "Yeah, I just noticed that.  I was going to post, but you were the quick draw."}, {"owner": {"reputation": 47, "user_id": 6168307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef3a77703a1231ad76f91548dbb8c79?s=128&d=identicon&r=PG", "display_name": "A Rossi", "link": "https://stackoverflow.com/users/6168307/a-rossi"}, "edited": false, "score": 0, "creation_date": 1474423134, "post_id": 39606056, "comment_id": 66521051, "body": "You guys rock! Thanks so much."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1474421362, "last_edit_date": 1474421362, "creation_date": 1474420451, "answer_id": 39606056, "question_id": 39605923, "link": "https://stackoverflow.com/questions/39605923/how-to-use-multiple-selections-from-vba-userform-multiselect-listbox-in-path/39606056#39606056", "title": "How to use multiple selections from VBA Userform Multiselect Listbox in path", "body": "<p>The following code is a \"minimal change\" alteration to your code so that it should handle copying the files from one directory to multiple directories:</p>\n\n<pre><code>Private Sub CmdBtn_transfer_Click()\n\n    Dim FSO As Object\n    Dim FromPath As String\n    Dim ToPath As String\n    Dim FileExt As String\n    Dim Value As String\n    Dim i As Integer\n\n    FromPath = \"C:\\Users\\us-lcn-dataprep03\\Desktop\\Production files\\\" &amp; (Me.ListBox1) '&lt;&lt; Change\n\n    FileExt = \"*.sli*\"  '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n    If FSO.FolderExists(FromPath) = False Then\n        MsgBox FromPath &amp; \" doesn't exist\"\n        Exit Sub\n    End If\n\n    For i = 0 To ListBox2.ListCount - 1\n        If ListBox2.Selected(i) Then\n            ToPath = \"\\\\bego.hb\\MED_PRODUCTION\\USA_Datapreparation\\\" &amp; (Me.ListBox2.List(i))    '&lt;&lt; Change\n\n            If Right(ToPath, 1) &lt;&gt; \"\\\" Then\n                ToPath = ToPath &amp; \"\\\"\n            End If\n\n            If FSO.FolderExists(ToPath) = False Then\n                MsgBox ToPath &amp; \" doesn't exist\"\n                Exit Sub\n            End If\n\n            FSO.CopyFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n            MsgBox \"You can find the files from \" &amp; FromPath &amp; \" in \" &amp; ToPath\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>All I did was move your commented out code re looping through the selected items in ListBox2 so that it was wrapped around the parts of the code which are affected by the <code>ToPath</code>.  (Note: The <code>MsgBox</code> is within the loop - you may wish to move it outside the loop but, if you do, you may want to make the message more generic - e.g. \"Your files have been moved as requested\".)</p>\n\n<p>I also corrected some mistakes in your commented code:</p>\n\n<ul>\n<li><code>ListBox2.Items.Count</code> should be <code>ListBox2.ListCount</code></li>\n<li><code>ListBox2.Items(i).Selected</code> should be <code>ListBox2.Selected(i)</code></li>\n<li><code>ListBox2.Items(i).Value</code> should be <code>ListBox2.List(i)</code></li>\n</ul>\n"}], "owner": {"reputation": 47, "user_id": 6168307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef3a77703a1231ad76f91548dbb8c79?s=128&d=identicon&r=PG", "display_name": "A Rossi", "link": "https://stackoverflow.com/users/6168307/a-rossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 39606056, "answer_count": 1, "score": 0, "last_activity_date": 1474421362, "creation_date": 1474419256, "last_edit_date": 1531161705, "question_id": 39605923, "link": "https://stackoverflow.com/questions/39605923/how-to-use-multiple-selections-from-vba-userform-multiselect-listbox-in-path", "title": "How to use multiple selections from VBA Userform Multiselect Listbox in path", "body": "<p>I have created a VBA userform, by manipulating code i found from a  website, for coworkers to transfer files from selected folder from one listbox to another folder in a second listbox. The folders that populate in the listboxes change daily. It works fine for both listboxes with fmSingleSelect but i cannot figure out how to run it properly with a fmMultiSelect property on the second listbox (Yes, i changed the property to fmMultiSelect on the second listbox).</p>\n\n<p>It would save time to be able to multiselect the projects folder and run the transfers simultaneously. </p>\n\n<p>Below is the code for single select and commented out some code i was working with for multiselect</p>\n\n<p>Also an image is below code</p>\n\n<p>Thanks</p>\n\n<pre><code>Private Sub CmdBtn_transfer_Click()\n\n    Dim FSO As Object\n    Dim FromPath As String\n    Dim ToPath As String\n    Dim FileExt As String\n    Dim Value As String\n    Dim i As Integer\n\n    FromPath = \"C:\\Users\\us-lcn-dataprep03\\Desktop\\Production files\\\" &amp; (Me.ListBox1) '&lt;&lt; Change\n    ToPath = \"\\\\bego.hb\\MED_PRODUCTION\\USA_Datapreparation\\\" &amp; (Me.ListBox2)   '&lt;&lt; Change\n\n' For i = 0 To ListBox2.Items.Count - 1\n   ' If ListBox2.Items(i).Selected = True Then\n       ' Val = ListBox2.Items(i).Value\n   ' End If\n'Next i\n\n    FileExt = \"*.sli*\"  '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n    If FSO.FolderExists(FromPath) = False Then\n        MsgBox FromPath &amp; \" doesn't exist\"\n        Exit Sub\n    End If\n\n    If FSO.FolderExists(ToPath) = False Then\n        MsgBox ToPath &amp; \" doesn't exist\"\n        Exit Sub\n    End If\n\n    FSO.CopyFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n    MsgBox \"You can find the files from \" &amp; FromPath &amp; \" in \" &amp; ToPath\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/HkbDn.png\" rel=\"nofollow\">Userform list boxes</a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1474442512, "post_id": 39605916, "comment_id": 66527523, "body": "If <code>sample_id</code> is a number then you do not require the single quotation field qualifiers. That is for string variables."}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1474458409, "post_id": 39605916, "comment_id": 66537914, "body": "sample_id is also a string variable that contains the sample number. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "is_accepted": false, "score": 0, "last_activity_date": 1480000658, "creation_date": 1480000658, "answer_id": 40789838, "question_id": 39605916, "link": "https://stackoverflow.com/questions/39605916/open-single-form-subform-to-a-specific-record/40789838#40789838", "title": "open &#39;single form&#39; subform to a specific record", "body": "<p>Syntax error in your code.<br>\nTry the code below:  </p>\n\n<pre><code>DoCmd.OpenForm \"frm_combined_CNVs\", , , \"sampleid = '\" &amp; sample_id &amp; \"'\"\n</code></pre>\n\n<p>Do try to include the reason why your code doesn't work or what error you receive next time.</p>\n"}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594023047, "creation_date": 1474419193, "last_edit_date": 1594023047, "question_id": 39605916, "link": "https://stackoverflow.com/questions/39605916/open-single-form-subform-to-a-specific-record", "title": "open &#39;single form&#39; subform to a specific record", "body": "<p>I would like to open a single record subform \"frm_sample_cnv1\" to a specific record. The record is specified by sample_id which is the primary key. I've tried the following method without success:</p>\n\n<pre><code>DoCmd.OpenForm \"frm_combined_CNVs\", , , \"Forms!frm_combined_CNVs.frm_sample_cnv1.Form.[sample_id] = '\" &amp; sample_id &amp; \"'\"\n</code></pre>\n\n<p>Also, frm_sample_cnv1 contains a linked subform that should automatically be filtered when frm_sample_cnv1 is set.  The Main form \"frm_combined_CNVs\" is unbound form.\nPlease suggest how to make this work. </p>\n"}, {"tags": ["arrays", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1474419158, "creation_date": 1474419158, "answer_id": 39605911, "question_id": 39605826, "link": "https://stackoverflow.com/questions/39605826/vba-arrays-in-word/39605911#39605911", "title": "VBA Arrays in Word", "body": "<p>A couple issues here.  First, <code>Public</code> can only be used as an access modifier for Module level variables - not local ones, so it should be <code>Dim ListArr() As String</code>.  Second, you don't need to use <code>Application.Run</code> to call procedures in the same project.  If you <em>did</em>, you aren't passing the required parameter (which can't be passed <code>ByRef</code> via <code>Application.Run</code> anyway).  Third, <code>Get_Input_List</code> is a function, so you should probably return the result of the <code>Split</code>.  Right now it always returns <code>vbNullString</code>.  I'm guessing that you're looking for something more like this:</p>\n\n<pre><code>Option Explicit\n\nSub Main()\n   Dim ListArr() As String\n   ListArr = Get_Input_List\n\n   Dim inputWord As Variant\n   For Each inputWord In ListArr\n        MsgBox inputWord\n   Next\nEnd Sub\n\nFunction Get_Input_List() As String()\n    Dim list As String\n\n    list = InputBox(\"Please enter words to sort separated with a comma and no spaces\", \"Words\")\n    Get_Input_List = Split(list, \",\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6271579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaee10c904906cb4b792d36f9fdf883a?s=128&d=identicon&r=PG&f=1", "display_name": "LRoyster", "link": "https://stackoverflow.com/users/6271579/lroyster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2170, "favorite_count": 0, "accepted_answer_id": 39605911, "answer_count": 1, "score": 0, "last_activity_date": 1474444835, "creation_date": 1474418569, "last_edit_date": 1474444835, "question_id": 39605826, "link": "https://stackoverflow.com/questions/39605826/vba-arrays-in-word", "title": "VBA Arrays in Word", "body": "<p>I want to declare a dynamic string array, then make calls to each of the other procedures. This is what I have, I thought it would work but I keep getting errors.</p>\n\n<pre><code>Option Explicit\n\nSub Main()\n\n   Public ListArr() As String\n\n   Application.Run \"Get_Input_List\"\n\nEnd Sub\n\nFunction Get_Input_List(ByRef ListArr() As String) As String\n\n   Dim list As String\n   Dim MesBox As String\n\n  list = InputBox(\"Please enters word to sort using a comma with no space to separate\", \"Words\")\n\n  ListArr = Split(list, \",\")\n\n  MsgBox ListArr(1)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 881, "user_id": 6710305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xU3bC.jpg?s=128&g=1", "display_name": "M T Head", "link": "https://stackoverflow.com/users/6710305/m-t-head"}, "edited": false, "score": 2, "creation_date": 1474416155, "post_id": 39605514, "comment_id": 66519370, "body": "beautiful code...   lol"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474416767, "post_id": 39605514, "comment_id": 66519512, "body": "What is it testing?"}, {"owner": {"reputation": 1, "user_id": 6855860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea8fe2e0a42b7e93125e1a3fce1671b?s=128&d=identicon&r=PG&f=1", "display_name": "Sourav", "link": "https://stackoverflow.com/users/6855860/sourav"}, "edited": false, "score": 0, "creation_date": 1474417362, "post_id": 39605514, "comment_id": 66519646, "body": "so i have 500 rows of data in an excel file and each row corresponds to a product. I am trying to determine which product it is by using this logic so for example if O2 = AA and P2 &lt;&gt;BB,CC,DD,EE,FF,GG then the product is A and so on...I am sure this function itself is written in a very bad way as M T head has suggested but i am new to this and learning."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474422573, "post_id": 39605514, "comment_id": 66520924, "body": "The code doesn&#39;t make sense, for instance it starts with <code>IF(AND(OR(O2=&quot;AA&quot;,O2=&quot;BB&quot;,P2&lt;&gt;&quot;CC&quot;,P2&lt;&gt;&quot;DD&quot;,P2&lt;&gt;&quot;EE&quot;,P2&lt;&gt;&quot;FF&zwnj;&#8203;&quot;,P2&lt;&gt;&quot;GG&quot;),&quot;A&quot;,...</code>.  Getting rid of the <code>OR</code> section (which will evaluate to <code>TRUE</code> or <code>FALSE</code>, let&#39;s say <code>TRUE</code> for the moment) we get <code>IF(AND(TRUE,&quot;A&quot;,....</code>.  I&#39;m not sure what an <code>AND</code> of <code>TRUE</code> (or <code>FALSE</code>) and <code>&quot;A&quot;</code> will evaluate to but I think it will be error value."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1474422915, "post_id": 39605514, "comment_id": 66520996, "body": "OK - just tested - a way of recreating this formula in VBA would be <code>Cells(2,1) = CVErr(xlErrValue)</code>.  (But I suspect that the problem is just in the formula placed in the question, not in the original formula being used, so I think you need to edit the question to show a more accurate version of the formula.)"}, {"owner": {"reputation": 1, "user_id": 6855860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea8fe2e0a42b7e93125e1a3fce1671b?s=128&d=identicon&r=PG&f=1", "display_name": "Sourav", "link": "https://stackoverflow.com/users/6855860/sourav"}, "edited": false, "score": 0, "creation_date": 1474424249, "post_id": 39605514, "comment_id": 66521294, "body": "Here is a shorter portion of the function =IF(AND(OR(O2=&quot;IRSWAP&quot;,O2=&quot;BASIS&quot;),P2&lt;&gt;&quot;CAP&quot;,P2&lt;&gt;&quot;FLOOR&quot;),&quot;D&zwnj;&#8203;erivative&quot;,IF(AND(O2&zwnj;&#8203;=&quot;AMP&quot;,P2&lt;&gt;&quot;TIPS&quot;,P2&zwnj;&#8203;&lt;&gt;&quot;LTSP&quot;,P2&lt;&gt;&quot;TIFF&quot;)&zwnj;&#8203;,&quot;Debt&quot;,IF(OR(P2=&quot;CM&zwnj;&#8203;X&quot;,P2=&quot;CMP&quot;,P2=&quot;CMD&quot;&zwnj;&#8203;,P2=&quot;CMS&quot;),&quot;Treasury&zwnj;&#8203;&quot;,&quot;Null&quot;)))...So the products can be derivative/ Debt or Treasury. I had initially forgotten the closing braces for the OR statement which i have now placed. So if the OR statement is true you will end up with If(AND(P2&lt;&gt;&quot;CAP&quot;, P2&lt;&gt;&quot;FLOOR&quot;),&quot;Derivative&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1474425005, "creation_date": 1474425005, "answer_id": 39606591, "question_id": 39605514, "link": "https://stackoverflow.com/questions/39605514/using-if-and-or-nested-statement-in-vba/39606591#39606591", "title": "Using IF AND OR nested statement in VBA", "body": "<p>I <strong>BELIEVE</strong> that the following is faithfully replicating the code shown in your question (after adding the missing <code>)</code> after <code>\"BB\"</code>):</p>\n\n<pre><code>Dim O2 As String\nDim P2 As String\nDim Q2 As String\nDim r As Long\n\nWith ActiveSheet\n    For r = 2 To .Cells(.Rows.Count, \"O\").End(xlUp).Row\n        O2 = CStr(.Cells(r, \"O\").Value)\n        P2 = CStr(.Cells(r, \"P\").Value)\n        Select Case True\n            Case (O2 = \"AA\" Or O2 = \"BB\") And P2 &lt;&gt; \"CC\" And P2 &lt;&gt; \"DD\" And P2 &lt;&gt; \"EE\" And P2 &lt;&gt; \"FF\" And P2 &lt;&gt; \"GG\"\n                Q2 = \"A\"\n            Case O2 = \"HH\" And P2 &lt;&gt; \"II\" And P2 &lt;&gt; \"JJ\" And P2 &lt;&gt; \"KK\"\n                Q2 = \"B\"\n            Case P2 = \"LL\" Or P2 = \"MM\" Or P2 = \"NN\" Or P2 = \"OO\"\n                Q2 = \"C\"\n            Case O2 = \"PP\"\n                Q2 = \"D\"\n            Case O2 = \"QQ\"\n                Q2 = \"E\"\n            Case O2 = \"RR\"\n                Q2 = \"F\"\n            Case O2 = \"SS\"\n                Q2 = \"G\"\n            Case P2 = \"TT\" ' ??? P2??\n                Q2 = \"H\"\n            Case O2 = \"UU\"\n                Q2 = \"I\"\n            Case O2 = \"VV\" And P2 &lt;&gt; \"XX\"\n                Q2 = \"J\"\n            Case O2 = \"YY\" And P2 &lt;&gt; \"ZZ\" And P2 &lt;&gt; \"AAA\" And P2 &lt;&gt; \"BB\" And P2 &lt;&gt; \"CCC\" And P2 &lt;&gt; \"DDD\" And P2 &lt;&gt; \"EEE\" 'Warning \"BB\" here is probably different to \"BB\" on an earlier line\n                Q2 = \"K\"\n            Case P2 = \"FFF\" Or P2 &lt;&gt; \"GGG\" Or P2 = \"HHH\" Or P2 = \"III\"\n                Q2 = \"L\"\n            Case O2 = \"JJJ\"\n                Q2 = \"M\"\n            Case O2 = \"KKK\"\n                Q2 = \"N\"\n            Case O2 = \"LLL\"\n                Q2 = \"O\"\n            Case Else\n                Q2 = \"NULL\"\n        End Select\n        .Cells(r, \"Q\").Value = Q2\n    Next r\nEnd With\n</code></pre>\n\n<p>I suggest you check the logic thoroughly before using it!!</p>\n"}], "owner": {"reputation": 1, "user_id": 6855860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea8fe2e0a42b7e93125e1a3fce1671b?s=128&d=identicon&r=PG&f=1", "display_name": "Sourav", "link": "https://stackoverflow.com/users/6855860/sourav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474425005, "creation_date": 1474416022, "last_edit_date": 1531164843, "question_id": 39605514, "link": "https://stackoverflow.com/questions/39605514/using-if-and-or-nested-statement-in-vba", "title": "Using IF AND OR nested statement in VBA", "body": "<p>I want to convert an Excel function that I have written to VBA. The Excel function is </p>\n\n<pre><code>IF(AND(OR(O2=\"AA\",O2=\"BB\",P2&lt;&gt;\"CC\",P2&lt;&gt;\"DD\",P2&lt;&gt;\"EE\",P2&lt;&gt;\"FF\",P2&lt;&gt;\"GG\"),\"A\",\nIF(AND(O2=\"HH\",P2&lt;&gt;\"II\",P2&lt;&gt;\"JJ\",P2&lt;&gt;\"KK\"),\"B\",IF(OR(P2=\"LL\",P2=\"MM\",P2=\"NN\",\nP2=\"OO\"),\"C\",IF(O2=\"PP\",\"D\",IF(O2=\"QQ\",\"E\",IF(O2=\"RR\",\"F\",IF(O2=\"SS\",\"G\",\nIF(P2=\"TT\",\"H\",IF(O2=\"UU\",\"I\",IF(AND(O2=\"VV\",P2&lt;&gt;\"XX\"),\"J\",IF(AND(O2=\"YY\",\nP2&lt;&gt;\"ZZ\",P2&lt;&gt;\"AAA\",P2&lt;&gt;\"BB\",P2&lt;&gt;\"CCC\",P2&lt;&gt;\"DDD\",P2&lt;&gt;\"EEE\"),\"K\",IF(OR(P2=\"FFF\",\nP2=\"GGG\",P2=\"HHH\",P2=\"III\"),\"L\",IF(O2=\"JJJ\",\"M\",IF(O2=\"KKK\",\"N\",IF(O2=\"LLL\",\"O\",\n\"NULL\")))))))))))))))\n</code></pre>\n\n<p>How to create nested IF, AND, OR and nested IF, AND, NOT to accomplish this?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1474427914, "post_id": 39605286, "comment_id": 66522150, "body": "There is almost certainly a easier formula to accomplish what you are trying. Please add sample data together with expected results."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1474436068, "post_id": 39605286, "comment_id": 66524397, "body": "As stated in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow noreferrer\">Range.FormulaArray Property (Excel)</a> : &quot;The FormulaArray property also has a character limit of 255.&quot; Your formula contains 264 characters. That&#39;s to much. So do what @Jeeped suggested."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1474439473, "post_id": 39608867, "comment_id": 66525823, "body": "btw, My tests show that you are using many wide and full column references. That&#39;s probably not an efficient means of calculating an array formula."}, {"owner": {"reputation": 21, "user_id": 6855799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d730722a191f46d3fc5e033c6be2130b?s=128&d=identicon&r=PG&f=1", "display_name": "WOLF81", "link": "https://stackoverflow.com/users/6855799/wolf81"}, "edited": false, "score": 0, "creation_date": 1474494079, "post_id": 39608867, "comment_id": 66559513, "body": "I&#39;ll give this a shot tomorrow. I&#39;m very new at VBA and without lessons,so I&#39;m not the least surprised that my formulas/coding is over complicated. On that I will be learning a lot in the near future. I&#39;ve just been making do of what works for me at the time. I do appreciate the feedback. This worked. I just have a lot to learn in Excel as well as VBA but I&#39;m at least getting somewhere. The only VBA I know is from learning the code from recording in excel and examples from this site. My spreadsheet has a lot of work, but it&#39;s functional. Thanks for the help"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1474438943, "last_edit_date": 1495541303, "creation_date": 1474438943, "answer_id": 39608867, "question_id": 39605286, "link": "https://stackoverflow.com/questions/39605286/excel-vba-formulaarray-error/39608867#39608867", "title": "Excel VBA .FormulaArray Error", "body": "<p>As long as you insist on doing things the hard way,</p>\n\n<pre><code>Option Explicit\n\nSub wqer()\n    With ThisWorkbook\n        .Worksheets(\"KPI\").Name = \"K\"\n        .Worksheets(\"Monday\").Name = \"M\"\n        'geez - decide what cell you want without Selection\u00b9 !!??!!\n        Selection.FormulaArray = _\n            \"=INDEX(K!C[-3]:C[39],MATCH(1,(K!C[-3]=M!R1C11)*(K!C[-1]=M!RC[-2]),0),37)+INDEX(K!C[-3]:C[39],MATCH(1,(K!C[-3]=M!R1C11)*(K!C[-1]=M!RC[-2]),0),38)-INDEX(K!C[-3]:C[39],MATCH(1,(K!C[-3]=M!R1C11)*(K!C[-1]=M!RC[-2]),0),39)\"\n        .Worksheets(\"K\").Name = \"KPI\"\n        .Worksheets(\"M\").Name = \"Monday\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Renaming your worksheets back and forth puts your formula under the built-in character limit\u00b2 noted by <a href=\"https://stackoverflow.com/users/3915431/axel-richter\">Axel Richter</a> for the time it takes to insert the array formula into the cell. This will put an undue calculation demand on your workbook but it may be an acceptable solution for you. Consider changing the application's calculation mode to manual for the duration of the operation.</p>\n\n<hr>\n\n<p>.\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n\n<p>\u00b2 <sub>See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow noreferrer\">Range.FormulaArray property</a>.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1505893275, "last_edit_date": 1505893275, "creation_date": 1505823539, "answer_id": 46300298, "question_id": 39605286, "link": "https://stackoverflow.com/questions/39605286/excel-vba-formulaarray-error/46300298#46300298", "title": "Excel VBA .FormulaArray Error", "body": "<p>You can also try this(<br>\nplease don't run it from the VBE, try to run it from sheets environment. Go to Developer-Macros-Your Macro -Run or Run it from a button or shortcut and it will work without problem):</p>\n\n<pre><code>Selection.Formula = _\n    \"=INDEX(KPI!C[-3]:C[39],MATCH(1,(KPI!C[-3]=Monday!R1C11)*(KPI!C[-1]=Monday!RC[-2]),0),37)+INDEX(KPI!C[-3]:C[39],MATCH(1,(KPI!C[-3]=Monday!R1C11)*(KPI!C[-1]=Monday!RC[-2]),0),38)-INDEX(KPI!C[-3]:C[39],MATCH(1,(KPI!C[-3]=Monday!R1C11)*(KPI!C[-1]=Monday!RC[-2]),0),39)\"\n\nSendKeys \"{F2}\"\nSendKeys \"^+{ENTER}\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6855799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d730722a191f46d3fc5e033c6be2130b?s=128&d=identicon&r=PG&f=1", "display_name": "WOLF81", "link": "https://stackoverflow.com/users/6855799/wolf81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1505893275, "creation_date": 1474414329, "last_edit_date": 1474439071, "question_id": 39605286, "link": "https://stackoverflow.com/questions/39605286/excel-vba-formulaarray-error", "title": "Excel VBA .FormulaArray Error", "body": "<p>The error is a 1004 error but I don't understand why. The formula in the cell would be:</p>\n\n<blockquote>\n  <p>{=INDEX(KPI!A:AQ,MATCH(1,(KPI!A:A=Monday!$K$1)*(KPI!C:C=Monday!B4),0),37)+INDEX(KPI!A:AQ,MATCH(1,(KPI!A:A=Monday!$K$1)*(KPI!C:C=Monday!B4),0),38)-INDEX(KPI!A:AQ,MATCH(1,(KPI!A:A=Monday!$K$1)*(KPI!C:C=Monday!B4),0),39)}</p>\n</blockquote>\n\n<p>To get this formula into a macro I simply used the recording tool but it did not work.</p>\n\n<pre><code>Selection.FormulaArray = _\n    \"=INDEX(KPI!C[-3]:C[39],MATCH(1,(KPI!C[-3]=Monday!R1C11)*(KPI!C[-1]=Monday!RC[-2]),0),37)+INDEX(KPI!C[-3]:C[39],MATCH(1,(KPI!C[-3]=Monday!R1C11)*(KPI!C[-1]=Monday!RC[-2]),0),38)-INDEX(KPI!C[-3]:C[39],MATCH(1,(KPI!C[-3]=Monday!R1C11)*(KPI!C[-1]=Monday!RC[-2]),0),39)\"\n</code></pre>\n"}, {"tags": ["mysql", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1474413094, "post_id": 39604960, "comment_id": 66518535, "body": "At least part of your problem is that you cannot parameterise a table name: only field values.  See: <a href=\"http://stackoverflow.com/questions/11312737/can-i-parameterize-the-table-name-in-a-prepared-statement\" title=\"can i parameterize the table name in a prepared statement\">stackoverflow.com/questions/11312737/&hellip;</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474413201, "post_id": 39604960, "comment_id": 66518572, "body": "<code>INSERT INTO SET</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474413205, "post_id": 39604960, "comment_id": 66518575, "body": "...and your insert syntax looks wrong"}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474413634, "post_id": 39604960, "comment_id": 66518688, "body": "@TimWilliams By insert syntax you are referring to where the parameters are set or to what Comintern mentioned above your last comment?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474413658, "post_id": 39604960, "comment_id": 66518695, "body": "The whole thing looks odd"}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474413911, "post_id": 39604960, "comment_id": 66518766, "body": "@TimWilliams I am following example like this: <a href=\"https://msdn.microsoft.com/en-us/library/ms675860(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms675860(v=vs.85).aspx</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474414161, "post_id": 39604960, "comment_id": 66518831, "body": "I&#39;d test your sql in the DB provider <i>first</i>, and then parameterise it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474414184, "post_id": 39604960, "comment_id": 66518839, "body": "<a href=\"https://www.techonthenet.com/mysql/insert.php\" rel=\"nofollow noreferrer\">techonthenet.com/mysql/insert.php</a>"}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474414803, "post_id": 39604960, "comment_id": 66519001, "body": "@Comintern I verified that the provider is MSDASQL.1 on this line &quot;cmd.ActiveConnection = conn&quot;."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474414909, "post_id": 39604960, "comment_id": 66519031, "body": "No, I meant verify that your <b><i>SQL statement</i></b> works by executing a sample directly in the back-end."}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474415613, "post_id": 39604960, "comment_id": 66519228, "body": "@Comintern I have done that and it does work... now. I updated the code above."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474416727, "post_id": 39605489, "comment_id": 66519501, "body": "This is still errors out in the same place complaining that &quot;No value was given for one or more required parameters&quot;."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474417007, "post_id": 39605489, "comment_id": 66519565, "body": "@noc_coder - Change the <code>Set rs = cmd.Execute</code> to <code>cmd.Execute</code> and <code>cmd.CommandType = adCmdStoredProc</code> to <code>cmd.CommandType = adCmdText</code>."}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474417949, "post_id": 39605489, "comment_id": 66519756, "body": "I used the debugger after making these changes because excel is just closing on cmd.Execute. Im printing each parameter and they all print out with Debug.print. However, str as a whole shows up as ...VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?). Then it just closes on that line."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474418129, "post_id": 39605489, "comment_id": 66519800, "body": "@noc_coder - That&#39;s what it is supposed to be.  The parameters are processed in the ODBC provider. What do you mean by &quot;Excel is just closing&quot;?"}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474418295, "post_id": 39605489, "comment_id": 66519846, "body": "Ahh I see. That makes sense. But yes, literally on the cmd.Execute line before iteration 2 of the for loop even starts, all the excel files including VBA close. So its not even adding the line to the DB. Even if I change it back to &quot;Set rs = cmd.Execute&quot; it crashes."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474418498, "post_id": 39605489, "comment_id": 66519910, "body": "@noc_coder - There&#39;s nothing there that should be taking Excel down like that...  I did notice that the data types of your parameters don&#39;t match the sample query in your question - The code has the first 3 as <code>adInteger</code>, but in your test <code>INSERT</code> you are passing them as strings."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474418587, "post_id": 39605489, "comment_id": 66519932, "body": "@noc_coder - Also try calling <code>Cells(i, x).Value</code> explicitly - it may be trying to add the <code>Range</code> as the parameter instead of calling the default member."}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474420267, "post_id": 39605489, "comment_id": 66520418, "body": "I updated the current state above. I updated the DB types and the types here to completely match. And now its not crashing. But the error is: &quot;Multiple step OLE DB operation generated errors. Check each OLE DB status value, if available. No work was done&quot;. So Ill look into this, although I do not see whats wrong. The params all printed when I had the debug lines there."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474420387, "post_id": 39605489, "comment_id": 66520452, "body": "@noc_coder - That error means that one of your parameters is declared as the wrong type."}, {"owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474420929, "post_id": 39605489, "comment_id": 66520567, "body": "I see what you mean. But its not making sense why the error is there.. From the DB: int(4), int(2), int(2), varchar(30), varchar(30), varchar(30), int(2), varchar(10), varchar(10), varchar(10), varchar(10), varchar(10), int(1), varchar(10). I tried both adChar and adVarChar."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "edited": false, "score": 0, "creation_date": 1474421148, "post_id": 39605489, "comment_id": 66520615, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/123826/discussion-between-comintern-and-noc-coder\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1474434074, "last_edit_date": 1474434074, "creation_date": 1474415857, "answer_id": 39605489, "question_id": 39604960, "link": "https://stackoverflow.com/questions/39604960/parameters-not-adding-to-ado-string-for-insert-statement-vba/39605489#39605489", "title": "Parameters not adding to ADO string for INSERT statement VBA", "body": "<p>Remove the \"qualifer=?\" from the SQL statement.  ODBC parameters are specified with a single <code>?</code>, and have to be added in the same order as they appear in the statement:</p>\n\n<pre><code>INSERT INTO  `NLVMerlinResults` (Year, Month, Day, Lab, Station, IP, \nthisWeek, Week1, Week2, Week3, Week4, Week5, WeeksInMonth, SumOverWeeks) \nVALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n</code></pre>\n\n<p>OP EDIT: Functional code provided in the question's statement. </p>\n"}], "owner": {"reputation": 347, "user_id": 4326515, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ea648e2af03a3f5535a7a42564f8c0c?s=128&d=identicon&r=PG&f=1", "display_name": "noc_coder", "link": "https://stackoverflow.com/users/4326515/noc-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 39605489, "answer_count": 1, "score": 0, "last_activity_date": 1474434113, "creation_date": 1474412153, "last_edit_date": 1474434113, "question_id": 39604960, "link": "https://stackoverflow.com/questions/39604960/parameters-not-adding-to-ado-string-for-insert-statement-vba", "title": "Parameters not adding to ADO string for INSERT statement VBA", "body": "<p>I am trying to learn how to avoid SQL injection and am using VBA connecting to a mysql DB via ADO in VB. </p>\n\n<p>The problem I am having is that for the line </p>\n\n<pre><code>Set rs = cmd.Execute \n</code></pre>\n\n<p>I get the following error that I have not been able to figure in two days: \"No value given for one or more required parameters\". </p>\n\n<p>And surely, when printing the param string, it returns this: (I have noticed the difference in params.. not sure why it occurs)</p>\n\n<pre><code>INSERT INTO prm1=? VALUES prm2=?, prm3=?, prm4=?, prm5=?, prm6=?, prm7=?, prm8=?, prm9=?, prm10=?, prm11=?, prm12=?, prm13=?;\n</code></pre>\n\n<p>This is the code that I am using for clarification: </p>\n\n<pre><code>Function addToServer(file As String, server As Integer, lastRow As Integer)\n\nSheets(\"usage\").Select\nDim str As String\nDim i As Integer\n\nDim conn As ADODB.Connection\nSet conn = DBConnection\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nDim cmd As ADODB.Command\n Dim prm2 As ADODB.Parameter\n  Dim prm3 As ADODB.Parameter\n   Dim prm4 As ADODB.Parameter\n    Dim prm5 As ADODB.Parameter\n     Dim prm6 As ADODB.Parameter\n      Dim prm7 As ADODB.Parameter\n       Dim prm8 As ADODB.Parameter\n        Dim prm10 As ADODB.Parameter\n         Dim prm11 As ADODB.Parameter\n          Dim prm12 As ADODB.Parameter\n           Dim prm13 As ADODB.Parameter\n            Dim prm14 As ADODB.Parameter\n             Dim prm15 As ADODB.Parameter\n\nSet cmd = New ADODB.Command\ncmd.ActiveConnection = conn\n\n    With cmd\n        If server &lt;&gt; 0 Then\n            .CommandText = \"INSERT INTO NLVMerlinResults (Year, Month, Day, Lab, Station, IP, thisWeek, Week1, Week2, Week3, Week4, Week5, WeeksInMonth, SumOverWeeks) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);\"\n        Else\n            .CommandText = \"INSERT INTO STMerlinResults (Year, Month, Day, Lab, Station, IP, thisWeek, Week1, Week2, Week3, Week4, Week5, WeeksInMonth, SumOverWeeks) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) ;\"\n        End If\n\n        cmd.CommandType = adCmdText\n\n        Set prm2 = .CreateParameter(Name:=\"year\", Type:=adInteger, size:=4)\n        .Parameters.Append prm2\n        Set prm3 = .CreateParameter(Name:=\"month\", Type:=adSmallInt, size:=2)\n        .Parameters.Append prm3\n        Set prm4 = .CreateParameter(Name:=\"day\", Type:=adSmallInt, size:=2)\n        .Parameters.Append prm4\n        Set prm5 = .CreateParameter(Name:=\"lab\", Type:=adVarChar, size:=30)\n        .Parameters.Append prm5\n        Set prm6 = .CreateParameter(Name:=\"cell\", Type:=adVarChar, size:=30)\n        .Parameters.Append prm6\n        Set prm7 = .CreateParameter(Name:=\"ip\", Type:=adVarChar, size:=20)\n        .Parameters.Append prm7\n        Set prm8 = .CreateParameter(Name:=\"week\", Type:=adSmallInt, size:=2)\n        .Parameters.Append prm8\n        Set prm9 = .CreateParameter(Name:=\"1\", Type:=adVarChar, size:=10)\n        .Parameters.Append prm9\n        Set prm10 = .CreateParameter(Name:=\"2\", Type:=adVarChar, size:=10)\n        .Parameters.Append prm10\n        Set prm11 = .CreateParameter(Name:=\"3\", Type:=adVarChar, size:=10)\n        .Parameters.Append prm11\n        Set prm12 = .CreateParameter(Name:=\"4\", Type:=adVarChar, size:=10)\n        .Parameters.Append prm12\n        Set prm13 = .CreateParameter(Name:=\"5\", Type:=adVarChar, size:=10)\n        .Parameters.Append prm13\n        Set prm14 = .CreateParameter(Name:=\"weeksinmonth\", Type:=adTinyInt, size:=1)\n        .Parameters.Append prm14\n        Set prm15 = .CreateParameter(Name:=\"total\", Type:=adVarChar, size:=10)\n        .Parameters.Append prm15\n\n    Dim j As Integer\n    For i = 1 To lastRow\n        For j = 1 To 15\n            If (j = 1) Then\n                prm2.value = CLng(cells(i, j))\n            ElseIf (j = 2) Then\n                prm3.value = CInt(cells(i, j))\n            ElseIf (j = 3) Then\n                prm4.value = CInt(cells(i, j))\n            ElseIf (j = 4) Then\n                prm5.value = CStr(cells(i, j))\n            ElseIf (j = 5) Then\n                prm6.value = CStr(cells(i, j))\n            ElseIf (j = 6) Then\n                prm7.value = CStr(cells(i, j))\n            ElseIf (j = 7) Then\n                prm8.value = CInt(cells(i, j))\n            ElseIf (j = 8) Then\n                If IsEmpty((cells(i, j))) Then\n                    prm9.value = vbNullString\n                Else\n                    prm9.value = CStr(cells(i, j))\n                End If\n            ElseIf (j = 9) Then\n                If IsEmpty((cells(i, j))) Then\n                    prm10.value = vbNullString\n                Else\n                    prm10.value = CStr(cells(i, j))\n                End If\n            ElseIf (j = 10) Then\n                If IsEmpty((cells(i, j))) Then\n                    prm11.value = vbNullString\n                Else\n                    prm11.value = CStr(cells(i, j))\n                End If\n            ElseIf (j = 11) Then\n                If IsEmpty((cells(i, j))) Then\n                    prm12.value = vbNullString\n                Else\n                    prm12.value = CStr(cells(i, j))\n                End If\n            ElseIf (j = 12) Then\n                If IsEmpty((cells(i, j))) Then\n                    prm13.value = vbNullString\n                Else\n                    prm13.value = CStr(cells(i, j))\n                End If\n            ElseIf (j = 13) Then\n                prm14.value = CByte(cells(i, j))\n            ElseIf (j = 14) Then\n                prm15.value = CStr(cells(i, j))\n            End If\n        Next j\n           .Execute\n    Next i\n\nEnd With\nSet cmd = Nothing\nEnd Function\n</code></pre>\n\n<p>I have two different approaches that I used shown above, but it seems neither of the two work. Can someone give general direction as to what I can do to help? I tried taking the params out from the .CreateParameter function (<a href=\"http://www.w3schools.com/asp/met_comm_createparameter.asp\" rel=\"nofollow\">http://www.w3schools.com/asp/met_comm_createparameter.asp</a> says they were optional), but that didnt work either. </p>\n\n<p>Best, </p>\n\n<p>Ashley</p>\n\n<p>EDIT:: I have added edits above. I tried a test insert and it was successful. </p>\n\n<pre><code>INSERT INTO  `NLVMerlinResults` (Year, Month, Day, Lab, Station, IP, thisWeek, Week1, Week2, Week3, Week4, Week5, WeeksInMonth, SumOverWeeks) VALUES (\"1\", \"2\", \"3\", \"4\", \"5\", 1, 5, \"5\", \"5\", \"6\", 6, \"5\", \"4\", \"5\")\n</code></pre>\n\n<p>Although its odd that it lets me enter integers and strings when the DB takes only varchar... </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 5, "last_activity_date": 1474413040, "creation_date": 1474413040, "answer_id": 39605101, "question_id": 39604955, "link": "https://stackoverflow.com/questions/39604955/how-to-pass-full-qualified-excel-sheet-name-to-vba/39605101#39605101", "title": "How to Pass Full-Qualified Excel Sheet Name to VBA?", "body": "<p>You could use the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980.aspx\" rel=\"noreferrer\">.Parent</a> of a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"noreferrer\">Range object</a>.</p>\n\n<pre><code>Set oSht = Range(\"'[My Book.xlsb]MySheet'!A1\").Parent\n</code></pre>\n\n<p>This works because the .Range object accepts and interprets a wider variety of text describing a specific cell. If you drill down to an individual cell and use that to call the .parent, you can achieve the worksheet reference.</p>\n\n<p>If there is a chance that My Book.xlsb may be closed, use the equivalent of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834975.aspx\" rel=\"noreferrer\">Workbook.FullName property</a>, not just the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195422.aspx\" rel=\"noreferrer\">Workbook.Name property</a>.</p>\n"}], "owner": {"reputation": 1404, "user_id": 209942, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/df626edfce8ddc13702ec0b57a4898e9?s=128&d=identicon&r=PG", "display_name": "johny why", "link": "https://stackoverflow.com/users/209942/johny-why"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1474427136, "creation_date": 1474412119, "last_edit_date": 1474427136, "question_id": 39604955, "link": "https://stackoverflow.com/questions/39604955/how-to-pass-full-qualified-excel-sheet-name-to-vba", "title": "How to Pass Full-Qualified Excel Sheet Name to VBA?", "body": "<p>In VBA, i'd like to refer to sheets in different workbooks by string-name. </p>\n\n<p>The following return errors:</p>\n\n<pre><code>Set oSht = Worksheets( \"'[My Book.xlsb]MySheet'\" )\nSet oSht = Evaluate( \"'[My Book.xlsb]MySheet'\" )\n</code></pre>\n\n<p>I know i can say:</p>\n\n<pre><code>Set oSht = Workbooks(\"My Book.xlsb\").Sheets(\"MySheet\")\n</code></pre>\n\n<p>but seeking a method which does not use the Workbooks collection.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1474414342, "last_edit_date": 1474414342, "creation_date": 1474410535, "answer_id": 39604697, "question_id": 39604630, "link": "https://stackoverflow.com/questions/39604630/pastespecial-end-of-statement-expected/39604697#39604697", "title": "PasteSpecial - End of Statement Expected", "body": "<p>Excel doesn't support (AFAIK) Cut / PasteValues, so you will need to use:</p>\n\n<pre><code>Newcastle_Shrinkage.Copy \nToSite_Shrinkage.Range(\"B\" &amp; ToSite_Shrinkage.UsedRange.Rows.Count + 1).PasteSpecial Paste:=xlPasteValues\nNewcastle_Shrinkage.ClearContents\n</code></pre>\n\n<p>Note: The answer by Comintern is probably (definitely!) better than mine. Anything that avoids the clipboard, and the associated problems that causes when the user is doing something in the background, is a much, much, much better solution.</p>\n"}, {"comments": [{"owner": {"reputation": 6124, "user_id": 461887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73a86b3136bfdda99045ba5de86dd9ec?s=128&d=identicon&r=PG", "display_name": "sayth", "link": "https://stackoverflow.com/users/461887/sayth"}, "edited": false, "score": 0, "creation_date": 1474429743, "post_id": 39604815, "comment_id": 66522598, "body": "I do like this answer, I was struggling to understand it initially with the use of cells(rowCount + 1, 2). I could see what the +1 was for but then 2 is the reference to column B. But that took me a little to get."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 6124, "user_id": 461887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73a86b3136bfdda99045ba5de86dd9ec?s=128&d=identicon&r=PG", "display_name": "sayth", "link": "https://stackoverflow.com/users/461887/sayth"}, "edited": false, "score": 1, "creation_date": 1474430489, "post_id": 39604815, "comment_id": 66522796, "body": "@sayth - Ah yes - that is setting the size of the target range to the size of the source range.  The second argument to <code>.Cells</code> is the column ordinal."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 4, "last_activity_date": 1474411238, "creation_date": 1474411238, "answer_id": 39604815, "question_id": 39604630, "link": "https://stackoverflow.com/questions/39604630/pastespecial-end-of-statement-expected/39604815#39604815", "title": "PasteSpecial - End of Statement Expected", "body": "<p>If all you need are the values, you can skip using the clipboard entirely.  Just set the values directly, then clear the source Range:</p>\n\n<pre><code>Sub SaveShrinkage()\n\n    Dim LRow As Long\n    Dim ws As Worksheet\n    Dim Newcastle_Shrinkage As Range\n    Dim ToSite_Shrinkage As Worksheet\n\n    Set ws = ThisWorkbook.ActiveSheet\n    LRow = ws.Cells(ws.Rows.Count, 5).End(xlUp).Row\n\n    Set Newcastle_Shrinkage = ws.Range(\"A6:E\" &amp; LRow)\n\n    Set ToSite_Shrinkage = Worksheets(\"Site_Shrinkage\")\n\n    With ToSite_Shrinkage\n        Dim rowCount As Long\n        rowCount = ToSite_Shrinkage.UsedRange.Rows.Count\n        .Range(.Cells(rowCount + 1, 2), _\n               .Cells(rowCount + Newcastle_Shrinkage.Rows.Count, 6)).Value = _ \n                   Newcastle_Shrinkage.Value\n    End With\n    Newcastle_Shrinkage.ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 1, "last_activity_date": 1474412049, "creation_date": 1474412049, "answer_id": 39604941, "question_id": 39604630, "link": "https://stackoverflow.com/questions/39604630/pastespecial-end-of-statement-expected/39604941#39604941", "title": "PasteSpecial - End of Statement Expected", "body": "<p>You're getting the error as you write the code because you're trying to use \"Cut\" \"Destination\" and \"PasteSpecial\" in one line - Destination and PasteSpecial overlap here so you could suggest a start by getting rid of one of these terms to get either:</p>\n\n<pre><code>range(\"A1\").cut destination:=range(\"A2\")\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>range(\"A1\").cut\nrange(\"A2\").pastespecial xlpastevalues\n</code></pre>\n\n<p>however, as flagged in the answer by @YowE3K, \"CUT\" doesn't work with subsequent \"pastespecial\" so this second method will only work with .copy as he shows.</p>\n\n<p>The best answer to follow is Comintern's.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 3, "last_activity_date": 1474412440, "creation_date": 1474412440, "answer_id": 39605004, "question_id": 39604630, "link": "https://stackoverflow.com/questions/39604630/pastespecial-end-of-statement-expected/39605004#39605004", "title": "PasteSpecial - End of Statement Expected", "body": "<p>The reason you are getting an error is that the <code>Range().Cut</code> method takes a range as a parameter and <code>Range().PasteSpecial xlPasteValues</code> does not return a range.</p>\n\n<p>This will correct your code.</p>\n\n<pre>\n\nNewcastle_Shrinkage.Cut Destination:=ToSite_Shrinkage.Range(\"B\" & ToSite_Shrinkage.UsedRange.Rows.Count + 1)\n\n</pre>\n\n<p>Personally I would refactor the code removing most of the variables that will only be used once and using a more generic name for the source range.  I think that the more condense code is actually easier to read.</p>\n\n<h2>Cut Range with formatting</h2>\n\n<pre><code>Sub SaveShrinkageWithFormat()\n\n    Dim Source As Range\n\n    With ThisWorkbook.ActiveSheet\n        Set Source = .Range(\"A6\", .Range(\"E\" &amp; .Rows.Count).End(xlUp))\n    End With\n\n\n    With Worksheets(\"Site_Shrinkage\")\n        Source.Cut Destination:=.Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1)\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>Move values no formatting</h2>\n\n<pre><code>Sub SaveShrinkageValuesOnly()\n\n    Dim Source As Range\n\n    With ThisWorkbook.ActiveSheet\n        Set Source = .Range(\"A6\", .Range(\"E\" &amp; .Rows.Count).End(xlUp))\n    End With\n\n    With Worksheets(\"Site_Shrinkage\")\n        .Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1) = Source.Value\n        Source.ClearContents\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6124, "user_id": 461887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73a86b3136bfdda99045ba5de86dd9ec?s=128&d=identicon&r=PG", "display_name": "sayth", "link": "https://stackoverflow.com/users/461887/sayth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 0, "accepted_answer_id": 39604697, "answer_count": 4, "score": 1, "last_activity_date": 1474420451, "creation_date": 1474410135, "last_edit_date": 1474420451, "question_id": 39604630, "link": "https://stackoverflow.com/questions/39604630/pastespecial-end-of-statement-expected", "title": "PasteSpecial - End of Statement Expected", "body": "<p>I have this script that saves my selection to another page. I use cut as part of my tidying the page for the next input. </p>\n\n<p>Anyway I have tried several variation on <code>xlPasteValues</code> however keep receiving end of statement expected.</p>\n\n<p>From <a href=\"http://www.mrexcel.com/forum/excel-questions/49124-visual-basic-applications-copy-paste-cell-value-only-not-formula.html\" rel=\"nofollow\">Mr Excel</a> I was replicating this however produces the error.</p>\n\n<pre><code>Worksheets(\"Positions\").Range(\"W2\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Tried the variant from the <a href=\"https://blog.udemy.com/pastespecial-vba/\" rel=\"nofollow\">udemy blog</a></p>\n\n<pre><code>wb.Sheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>I am just not understanding how those implementations are not encountering the end of statement and mine is.</p>\n\n<pre><code>Sub SaveShrinkage()\n\n    Dim LRow As Long\n    Dim ws As Worksheet\n    Dim Newcastle_Shrinkage As Range\n    Dim ToSite_Shrinkage As Worksheet\n\n    Set ws = ThisWorkbook.ActiveSheet\n    LRow = ws.Cells(ws.Rows.Count, 5).End(xlUp).Row\n\n    Set Newcastle_Shrinkage = ws.Range(\"A6:E\" &amp; LRow)\n\n    Set ToSite_Shrinkage = Worksheets(\"Site_Shrinkage\")\n\n    Newcastle_Shrinkage.Cut Destination:=ToSite_Shrinkage.Range(\"B\" &amp; ToSite_Shrinkage.UsedRange.Rows.Count + 1).PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "dateadd"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1474408920, "post_id": 39604331, "comment_id": 66517346, "body": "I believe you have your criteria in the wrong order see: <a href=\"https://support.office.com/en-us/article/DateAdd-Function-63befdf6-1ffa-4357-9424-61e8c57afc19\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>  so it should be <code>=DateAdd(&quot;d&quot;,18, txtStartDate)</code>"}, {"owner": {"reputation": 11, "user_id": 5374284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/842ec8f3af6a74917628d520bb1ff53e?s=128&d=identicon&r=PG&f=1", "display_name": "ktcn414", "link": "https://stackoverflow.com/users/5374284/ktcn414"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1474409277, "post_id": 39604331, "comment_id": 66517456, "body": "Thanks @ScottCraner"}], "answers": [{"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1474409235, "creation_date": 1474409235, "answer_id": 39604478, "question_id": 39604331, "link": "https://stackoverflow.com/questions/39604331/dateadd-function-in-microsoft-access-vba/39604478#39604478", "title": "DateAdd Function in Microsoft Access VBA", "body": "<p>Hope this helps somewhat, two declarations for the original date and the new date. Msgbox then shows them both here on different lines:</p>\n\n<pre><code>sub addingDate()\nDim txtStartDate As Date\nDim txtEndDate As Date\n    txtStartDate = Now 'Or wherever you get this info from\n    txtEndDate = DateAdd(\"d\", 18, txtStartDate)\n    MsgBox (txtStartDate &amp; vbNewLine &amp; txtEndDate)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1474409516, "creation_date": 1474409516, "answer_id": 39604536, "question_id": 39604331, "link": "https://stackoverflow.com/questions/39604331/dateadd-function-in-microsoft-access-vba/39604536#39604536", "title": "DateAdd Function in Microsoft Access VBA", "body": "<p>It sounds like you're implicitly converting a textbox value from a String to a Date. You might want to add some checks like:</p>\n\n<pre><code>If IsDate(txtStartDate) Then\n</code></pre>\n\n<p>And you'll want to be particularly conscious of the behavior should your code be running on systems that have varying Regional Date settings for American/English/Japanese dates. That <em>might</em> require using a date-picker or some other date-validation on the control itself.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1474447620, "creation_date": 1474447620, "answer_id": 39611656, "question_id": 39604331, "link": "https://stackoverflow.com/questions/39604331/dateadd-function-in-microsoft-access-vba/39611656#39611656", "title": "DateAdd Function in Microsoft Access VBA", "body": "<p>You don't need VBA to do that, only an expression as <em>ControlSource</em> for that other textbox:</p>\n\n<pre><code>=DateAdd(\"d\", 18, [txtStartDate])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1475697593, "creation_date": 1475697593, "answer_id": 39882676, "question_id": 39604331, "link": "https://stackoverflow.com/questions/39604331/dateadd-function-in-microsoft-access-vba/39882676#39882676", "title": "DateAdd Function in Microsoft Access VBA", "body": "<p>It sounds like you wish to set it after an update. Thus, use the <em>AfterUpdate</em> event of the start date:</p>\n\n<pre><code>Private Sub txtStartDate_AfterUpdate()\n\n    Dim EndDate As Variant\n\n    If IsDate(Me!txtStartDate.Value) Then\n       EndDate = DateAdd(\"d\", 18, Me!txtStartDate.Value)\n    Else\n       EndDate = Null\n    End If\n    Me!txtEndDate.Value = EndDate\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 8258123, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FofQH.jpg?s=128&g=1", "display_name": "Azog the Debugger", "link": "https://stackoverflow.com/users/8258123/azog-the-debugger"}, "is_accepted": false, "score": 0, "last_activity_date": 1501056282, "creation_date": 1501056282, "answer_id": 45320931, "question_id": 39604331, "link": "https://stackoverflow.com/questions/39604331/dateadd-function-in-microsoft-access-vba/45320931#45320931", "title": "DateAdd Function in Microsoft Access VBA", "body": "<p>Try This:</p>\n\n<pre><code>= DateAdd(\"d\", 18, cdate(txtStartDate)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5374284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/842ec8f3af6a74917628d520bb1ff53e?s=128&d=identicon&r=PG&f=1", "display_name": "ktcn414", "link": "https://stackoverflow.com/users/5374284/ktcn414"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4111, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1501056282, "creation_date": 1474408522, "last_edit_date": 1475696296, "question_id": 39604331, "link": "https://stackoverflow.com/questions/39604331/dateadd-function-in-microsoft-access-vba", "title": "DateAdd Function in Microsoft Access VBA", "body": "<p>I am trying to implement the DateAdd function into my Microsoft Access 2010 form. I have a form that when the user inputs the date (property name called \"txtStartDate\", then I want the output in a different part to be 18 calendar days in the future (property name called \"textEndDate\"). </p>\n\n<p>I know the format will be </p>\n\n<pre><code>=DateAdd(\"d\", 18, txtStartDate) \n</code></pre>\n\n<p>but how do I write it in VBA code to implement?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1474409474, "post_id": 39604235, "comment_id": 66517516, "body": "Can you debug on the error and check what values are populating the sheet name ie make sure it doesn&#39;t have any of these \\ / * [ ] : ? characters or that its not longer than 31 characters. Otherwise add watches to each part of the line to see which one is erroring out. Hope this helps."}, {"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 1, "creation_date": 1474409483, "post_id": 39604235, "comment_id": 66517520, "body": "Surely you need to create the worksheet before you can name it, workbooks don&#39;t contain infinite sheets."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1474409669, "post_id": 39604235, "comment_id": 66517558, "body": "<a href=\"https://www.extendoffice.com/documents/excel/456-combine-multiple-workbooks.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 0, "creation_date": 1474410013, "post_id": 39604235, "comment_id": 66517651, "body": "@NickA I would considering copying the sheet to be creating it. Maybe something to do with the <code>sheetIndex</code>? Stepping through here and checking the values I think is the best stategy to see what is going on."}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1474410587, "post_id": 39604235, "comment_id": 66517817, "body": "I had a similar problem with sheet name length and characters at work once, my solution was to initially remove special characters then reduce the name to a max of 31 and then cycle through the sheets testing the name and if it exists to alter the new sheet name (in my case I shortened it)."}, {"owner": {"reputation": 1003, "user_id": 177312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a50b5ef9981e74ae1debe2f3afc0d529?s=128&d=identicon&r=PG", "display_name": "Jeff Lundstrom", "link": "https://stackoverflow.com/users/177312/jeff-lundstrom"}, "edited": false, "score": 0, "creation_date": 1474465903, "post_id": 39604235, "comment_id": 66543123, "body": "Thanks everyone for the comments.  The answer below fixed the code and works great.  The only thing I had to add was a check for hidden sheets and to move the activate of the source sheet inside the loop."}], "answers": [{"comments": [{"owner": {"reputation": 1003, "user_id": 177312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a50b5ef9981e74ae1debe2f3afc0d529?s=128&d=identicon&r=PG", "display_name": "Jeff Lundstrom", "link": "https://stackoverflow.com/users/177312/jeff-lundstrom"}, "edited": false, "score": 0, "creation_date": 1474465822, "post_id": 39604880, "comment_id": 66543049, "body": "Works great!  Thanks so much for the help"}], "tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": true, "score": 1, "last_activity_date": 1474411601, "creation_date": 1474411601, "answer_id": 39604880, "question_id": 39604235, "link": "https://stackoverflow.com/questions/39604235/vba-copying-all-the-excel-files-in-a-folder-to-a-single-file-causes-runtime-erro/39604880#39604880", "title": "VBA copying all the Excel files in a folder to a single file causes runtime error", "body": "<p>Replace</p>\n\n<pre><code>FileWorkbook.Sheets(sheetIndex).Name = FileName &amp; \"-\" &amp; currentSheet.Name\n</code></pre>\n\n<p>with (I separated it out for readability)</p>\n\n<pre><code>sWSName = FileName &amp; \"-\" &amp; currentSheet.Name\nsWSName = NameTest(sWSName)\nsWSName = TestDup(sWSName)\nFileWorkbook.Sheets(sheetIndex).Name = sWSName\n</code></pre>\n\n<p>You will need to define the sWSName.</p>\n\n<p>Below are the modified functions I have previously used.</p>\n\n<pre><code>Function NameTest(sName As String) As String\n  NameTest = sName\n  aSpecChars = Array(\"\\\", \"/\", \"*\", \"[\", \"]\", \":\", \"?\")\n  For Each c In aSpecChars\n    NameTest = Replace(NameTest, c, \"\")\n  Next c\n\n  If Len(sName) &gt; 31 Then NameTest = Left(sName, 31)\n\nEnd Function\n\nFunction TestDup(sWSName As String) As String\n  TestDup = sWSName\n  For Each ws In Worksheets\n    Debug.Print ws.Name\n    If sWSName = ws.Name Then TestDup = TestDup(Left(sWSName, Len(sWSName) - 1))\n  Next ws\nEnd Function\n</code></pre>\n\n<p><em>If posting this code (or to this extent) is out of line please let me know as I am still coming to terms with the level of effort require versus reasonable response.</em></p>\n"}], "owner": {"reputation": 1003, "user_id": 177312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a50b5ef9981e74ae1debe2f3afc0d529?s=128&d=identicon&r=PG", "display_name": "Jeff Lundstrom", "link": "https://stackoverflow.com/users/177312/jeff-lundstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 39604880, "answer_count": 1, "score": 0, "last_activity_date": 1474411601, "creation_date": 1474408040, "question_id": 39604235, "link": "https://stackoverflow.com/questions/39604235/vba-copying-all-the-excel-files-in-a-folder-to-a-single-file-causes-runtime-erro", "title": "VBA copying all the Excel files in a folder to a single file causes runtime error", "body": "<p>I am attempting to use VBA to open all the excel files in a directory (in this case c:\\temp) and put all the files datasheets in one large file.  Each new sheet is named with the filename plus the name of the sheet on the original document.  The code that I have copies the first file's first sheet and even names it correctly, but then fails with a Run-time error 1004: Application defined or object defined error on the second sheet when I try to set the name.  Anyone have any suggestions on how to fix. </p>\n\n<pre><code>Sub MergeAllWorkbooks()\nDim FolderPath As String\nDim FileName As String\n\n' Create a new workbook\nSet FileWorkbook = Workbooks.Add(xlWBATWorksheet)\n\n' folder path to the files you want to use.\nFolderPath = \"C:\\Temp\\\"\n\n' Call Dir the first time, pointing it to all Excel files in the folder path.\nFileName = Dir(FolderPath &amp; \"*.xl*\")\n\n' Loop until Dir returns an empty string.\nDo While FileName &lt;&gt; \"\"\n\n    ' Open a workbook in the folder\n    Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n\n    Dim currentSheet As Worksheet\n    Dim sheetIndex As Integer\n    sheetIndex = 1\n\n    Windows(WorkBk.Name).Activate\n\n    For Each currentSheet In WorkBk.Worksheets\n        currentSheet.Select\n        currentSheet.Copy Before:=Workbooks(FileWorkbook.Name).Sheets(sheetIndex)\n        FileWorkbook.Sheets(sheetIndex).Name = FileName &amp; \"-\" &amp; currentSheet.Name\n        sheetIndex = sheetIndex + 1\n    Next currentSheet\n\n    ' Close the source workbook without saving changes.\n    WorkBk.Close savechanges:=False\n\n    ' Use Dir to get the next file name.\n    FileName = Dir()\nLoop\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1474404984, "post_id": 39603543, "comment_id": 66515740, "body": "Pretty sure msaccess calls this a crosstab query.  <a href=\"https://support.office.com/en-us/article/Make-summary-data-easier-to-read-by-using-a-crosstab-query-8465b89c-2ff2-4cc8-ba60-2cd8484667e8\" rel=\"nofollow noreferrer\">Example</a>  Pivot in enterprise databases.  However, Access doesn&#39;t require the dynamic SQL which Enterprise DBs do."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1474405988, "post_id": 39603543, "comment_id": 66516171, "body": "Given the sketchy support of pivots in Access, if all you need to do is get these into a spreadsheet like that, you&#39;d probably do better automating the Excel side."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1474410965, "post_id": 39603543, "comment_id": 66517929, "body": "Is there a <code>123 | Bob Smith  | Self</code> record? What does the <code>Wife</code> point to in <code>123 | Jane Smith  | Wife</code>?"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1474422465, "post_id": 39603543, "comment_id": 66520899, "body": "Write some VBA code to loop through your table per ID. Not sure why your want to store the output in a table, are there any specific reasons for that? How about writing the output to a txt file?"}, {"owner": {"reputation": 161, "user_id": 6855370, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/06edc8da1cc91dedf31ca834baeeeabc?s=128&d=identicon&r=PG&f=1", "display_name": "Rumba", "link": "https://stackoverflow.com/users/6855370/rumba"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1474423417, "post_id": 39603543, "comment_id": 66521114, "body": "@Brad There is one but they&#39;re INNER JOIN&#39;d ON the field ID, thus the output is multiple Bob Smith rows with the corresponding relative"}], "owner": {"reputation": 161, "user_id": 6855370, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/06edc8da1cc91dedf31ca834baeeeabc?s=128&d=identicon&r=PG&f=1", "display_name": "Rumba", "link": "https://stackoverflow.com/users/6855370/rumba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474404917, "creation_date": 1474404830, "last_edit_date": 1474404917, "question_id": 39603543, "link": "https://stackoverflow.com/questions/39603543/merge-multiple-rows-into-a-single-one-in-access-table-with-unique-id-value", "title": "Merge multiple rows into a single one in Access table with unique ID value", "body": "<p>I have a table which goes:</p>\n\n<pre><code>ID | Name | Relationship\n123 | Jane Smith  | Wife\n123 | Bruce Smith | Child \n</code></pre>\n\n<p>and so on...</p>\n\n<p>I want to create a table where people with the same ID reside in the same row:</p>\n\n<pre><code>ID  | 1st_Name | Relationship | 2nd_Name | Relationship\n123 | Jane Smith | Wife | Bruce Smith | Child\n</code></pre>\n\n<p>I do have a field which indicates the number of incidence of each ID i.e.</p>\n\n<pre><code>ID | CountofID\n123 | 2\n123 | 2\n456 | 3\n456 | 3\n456 | 3\n</code></pre>\n\n<p>Not sure if that will help.</p>\n\n<p>Someone suggested to use DCount and a function to produce Row Numbers.\n<a href=\"https://www.599cd.com/tips/access/140703-row-number/\" rel=\"nofollow\">https://www.599cd.com/tips/access/140703-row-number/</a>\nNot sure how to proceed. Is there a way to generate a DCount only For Each unique ID and then loop and reset it for every new ID? i.e. 1-4 for ID 123, then 1-3 for ID 456, etc.?</p>\n\n<p>Are there other ways to go about this in Access?</p>\n\n<p>Anything to point me to the right direction is greatly appreciated.</p>\n\n<p>Note: I asked in other sites and they took notice of how wrong the structure is of the table. The goal isn't about data structure. I want to merge multiple rows into a single one automatically, because I had to do it manually through Excel sheets.</p>\n"}, {"tags": ["mysql", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2344, "user_id": 757661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22d55e7c13896272c09c997eeba72318?s=128&d=identicon&r=PG", "display_name": "gordon613", "link": "https://stackoverflow.com/users/757661/gordon613"}, "edited": false, "score": 0, "creation_date": 1474406511, "post_id": 39603866, "comment_id": 66516395, "body": "I think this only shifts one column to the right... I think the question asks for the number of columns shifted to be variable..."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1474406279, "creation_date": 1474406279, "answer_id": 39603866, "question_id": 39603440, "link": "https://stackoverflow.com/questions/39603440/inserting-a-cell-in-excel-based-on-cell-value/39603866#39603866", "title": "Inserting a cell in excel based on cell value", "body": "<p>This will do it. The issue looks like it's within the line <code>Rows(Cells(i, 1).Column).Insert shift:=xlShiftRight</code>. If you break that down, it computes as follows:</p>\n\n<p><code>Cells(i,1).Column</code> which equals 1, since the column of <code>.Cells(i,1)</code> is 1.\n<code>Rows(1)</code> the <code>1</code> comes from the above. So <code>Rows(1)</code> is 1.\n<code>Rows(1).Insert</code> inserts above row 1, regardless of what you specify for shift.</p>\n\n<pre><code>Sub test()\nDim d As Integer\nd = Range(\"A:A\").End(xlDown).row\nDim c As Range\n  For i = d To 1 Step -1\n    If Cells(i, 1).Value Like \"1\" Then\n       Cells(i, 1).Insert shift:=xlToRight\n   End If\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2344, "user_id": 757661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22d55e7c13896272c09c997eeba72318?s=128&d=identicon&r=PG", "display_name": "gordon613", "link": "https://stackoverflow.com/users/757661/gordon613"}, "is_accepted": false, "score": 0, "last_activity_date": 1474406457, "creation_date": 1474406457, "answer_id": 39603914, "question_id": 39603440, "link": "https://stackoverflow.com/questions/39603440/inserting-a-cell-in-excel-based-on-cell-value/39603914#39603914", "title": "Inserting a cell in excel based on cell value", "body": "<p>This should do it.</p>\n\n<pre><code>Sub test()\nDim d As Integer\nd = Range(\"A:A\").End(xlDown).Row\nDim c As Range\n  For i = d To 1 Step -1\n    aMove = Val(Cells(i, 1))\n    If aMove &gt; 0 Then\n    Range(Cells(i, 1), Cells(i, aMove)).Insert shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n   End If\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1474407250, "creation_date": 1474407250, "answer_id": 39604099, "question_id": 39603440, "link": "https://stackoverflow.com/questions/39603440/inserting-a-cell-in-excel-based-on-cell-value/39604099#39604099", "title": "Inserting a cell in excel based on cell value", "body": "<p>Quite a few ways to do this, but by using the number in columnA to define the amount of cells to insert you can do a second loop like so:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim x, d, i As Integer\nWith ActiveSheet\nd = .Range(\"A:A\").End(xlDown).Row\n    For x = 2 To d\n    i = .Cells(x, 1).Value\n        For a = 1 To i\n            .Cells(x, 1).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n        Next a\n    Next x\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6855291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cdebdec5886b56514cda80da145e5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Beau0207", "link": "https://stackoverflow.com/users/6855291/beau0207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1474407250, "creation_date": 1474404380, "question_id": 39603440, "link": "https://stackoverflow.com/questions/39603440/inserting-a-cell-in-excel-based-on-cell-value", "title": "Inserting a cell in excel based on cell value", "body": "<p>I am working on exporting CSVs of large groups from an active directory environment.  Many of these groups have extensive nesting and I need to insert cells so that the worksheet is human readable.</p>\n\n<p>For example my worksheet looks like this:\nWS Example</p>\n\n<blockquote>\n  <p>Int User  Path</p>\n  \n  <p>0              User1     CN</p>\n  \n  <p>0              User2     CN</p>\n  \n  <p>1          User3     CN</p>\n  \n  <p>1          User4     CN</p>\n  \n  <p>0          User5     CN</p>\n  \n  <p>1          User6     CN</p>\n  \n  <p>2          User7     CN</p>\n</blockquote>\n\n<p>I am looking for help adapting a VBA script that reads the integer value from the first column and inserts the corresponding number of cells to the left of the column for that particular row.  The constraint is that the list cannot change the order of the rows so as to preserve the nested structure.</p>\n\n<p>Here is what I have in VBA so far</p>\n\n<pre><code>Sub test()\nDim d As Integer\nd = Range(\"A:A\").End(xlDown).row\nDim c As Range\n  For i = d To 1 Step -1\n    If Cells(i, 1).Value Like \"1\" Then\n  Rows(Cells(i, 1).Column).Insert shift:=xlShiftRight\n   End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>Currently this snippet counts the number of 1's from the column and inserts a new row at the top of the list.  I believe the error in my logic is within the If statement and once I have that ironed out I know I can expand that with an ElseIf to address the rest of the values. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1474407065, "creation_date": 1474407065, "answer_id": 39604046, "question_id": 39603164, "link": "https://stackoverflow.com/questions/39603164/excel-determining-if-save-or-saveas-is-used/39604046#39604046", "title": "Excel: Determining if Save or SaveAs is Used", "body": "<p>If the code is operating in a similar fashion to Excel's <code>Workbook_BeforeSave</code> event, the value of <code>SaveAsUI</code> will be <code>True</code> if the user is doing a Save As (i.e. if the SaveAs User Interface is being invoked, which therefore includes the first time a workbook is Saved), and <code>False</code> if they are just doing a normal Save.</p>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1474420664, "post_id": 39605951, "comment_id": 66520517, "body": "I guess my workbook <code>Things To Contemplate When Naming A File.xlsx</code> is going to be treated as a template? ;-P"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1474424324, "post_id": 39605951, "comment_id": 66521308, "body": "Yep :) Possibly a RegExp or Like would better to filter out such matches."}, {"owner": {"reputation": 209, "user_id": 6530405, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/15c1a2350b32b5dff5a8ecb304a57d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Slavisha", "link": "https://stackoverflow.com/users/6530405/slavisha"}, "edited": false, "score": 0, "creation_date": 1474466455, "post_id": 39605951, "comment_id": 66543575, "body": "Thank you all for the response. This will work if I save the code within template itself, but it doesn&#39;t work when I include it in the add-in."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1474419508, "creation_date": 1474419508, "answer_id": 39605951, "question_id": 39603164, "link": "https://stackoverflow.com/questions/39603164/excel-determining-if-save-or-saveas-is-used/39605951#39605951", "title": "Excel: Determining if Save or SaveAs is Used", "body": "<p>Using YowE3K's point you can shorten the code to just</p>\n\n<pre><code>If Not SaveAsUI Then Exit Sub\nIf LCase$(ActiveWorkbook.Name) Like \"*template*\" Then _\nCancel = (MsgBox(\"Are you sure you want to over-write the Template?\", vbYesNo) = vbNo)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 280, "user_id": 6857287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b7806f503c554653991a305e9a146f?s=128&d=identicon&r=PG&f=1", "display_name": "Pav", "link": "https://stackoverflow.com/users/6857287/pav"}, "is_accepted": false, "score": 0, "last_activity_date": 1474448072, "creation_date": 1474448072, "answer_id": 39611826, "question_id": 39603164, "link": "https://stackoverflow.com/questions/39603164/excel-determining-if-save-or-saveas-is-used/39611826#39611826", "title": "Excel: Determining if Save or SaveAs is Used", "body": "<p>HI I used the same method as suggested by YowE3K  using the SaveAsUI.\nAdditionally make sure to store your templates as *.xltx or *xltm (for macro enabled) so when anyone opens them in the usual way it will create an unsaved document instead of actually opening the template file and allowing them to mess it by saving their changes.</p>\n"}], "owner": {"reputation": 209, "user_id": 6530405, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/15c1a2350b32b5dff5a8ecb304a57d3a?s=128&d=identicon&r=PG&f=1", "display_name": "Slavisha", "link": "https://stackoverflow.com/users/6530405/slavisha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1474448072, "creation_date": 1474403177, "last_edit_date": 1531161705, "question_id": 39603164, "link": "https://stackoverflow.com/questions/39603164/excel-determining-if-save-or-saveas-is-used", "title": "Excel: Determining if Save or SaveAs is Used", "body": "<p>I'm using a version of the code for an add-in from the link below to check whether or not I have \"Template\" in the file name of any file I'm trying to save; however, I don't want a message box to appear if I click \"Save As.\" Is there a way to determine what type of save is being executed? Thanks for the help!</p>\n\n<p>Link: <a href=\"http://www.excelforum.com/excel-prog...e-w-addin.html\" rel=\"nofollow\">http://www.excelforum.com/excel-prog...e-w-addin.html</a></p>\n\n<p>I've updated part of the Class Module as follows: </p>\n\n<pre><code> Private Sub xlApp_WorkbookBeforeSave(ByVal Wb As Workbook, ByVal SaveAsUI As Boolean, Cancel As Boolean) \n    Dim UserInput As String \n    If LCase(ActiveWorkbook.Name) Like \"*template*\" Then \n        UserInput = MsgBox(\"Are you sure you want to over-write the Template?\", vbYesNo) \n        If UserInput &lt;&gt; vbYes Then \n            Cancel = True \n        End If \n    End If \n End Sub \n</code></pre>\n"}, {"tags": ["excel", "function", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1474402349, "post_id": 39602934, "comment_id": 66514446, "body": "You can do a check in a Worksheet_Change event to test if the function is one of the banned function."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1474402759, "post_id": 39602934, "comment_id": 66514657, "body": "You might have to disable automatic calculations for that worksheet in the <code>Worksheet_Change</code> event that @ScottCraner mentioned in order to prevent those banned functions from executing. Alert the user to remove the functions, then enable automatic calculations if there are no banned functions."}, {"owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "edited": false, "score": 0, "creation_date": 1474404112, "post_id": 39602934, "comment_id": 66515307, "body": "Thanks for help :)"}], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474402110, "creation_date": 1474402110, "last_edit_date": 1531164843, "question_id": 39602934, "link": "https://stackoverflow.com/questions/39602934/how-to-disable-function-e-g-sum-in-only-one-tab", "title": "How to disable function, e. g. SUM in only one Tab", "body": "<p>I would like to know if there is posibbility to disable function like SUM or custom function (created in VBA), so that user will not be able to use it in one, defined tab but will be ale to use it on all other tabs?</p>\n\n<p>Kind regards </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1474400366, "post_id": 39602370, "comment_id": 66513374, "body": "What are the incorrect results you are getting and what are the expected results?  This code works fine for me."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1474400673, "post_id": 39602370, "comment_id": 66513556, "body": "Nevermind, I found the issue.  Writing answer."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1474400757, "creation_date": 1474400757, "answer_id": 39602597, "question_id": 39602370, "link": "https://stackoverflow.com/questions/39602370/vba-ado-query-on-excel-workbook/39602597#39602597", "title": "VBA ADO query on Excel workbook", "body": "<p>I'm guessing you are not getting cost centers that contain \"5560\" but would get cost centers that are exactly \"5560.\"</p>\n\n<p>The problem is in this line:</p>\n\n<pre><code>strSQL = \"SELECT * from [sheet1$] WHERE [COST_CENTER] LIKE 5560\"\n</code></pre>\n\n<p>The <code>LIKE</code> statement requires wildcard characters.  For ADO, the wildcard character is <code>%</code></p>\n\n<p>Change the code to:</p>\n\n<pre><code>strSQL = \"SELECT * from [sheet1$] WHERE [COST_CENTER] LIKE '%5560%'\"\n</code></pre>\n\n<p>and it should work as desired.</p>\n"}], "owner": {"reputation": 45, "user_id": 2112509, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a20eba8a1197be17e3b5a7027c5fd44d?s=128&d=identicon&r=PG", "display_name": "Michiel Soede", "link": "https://stackoverflow.com/users/2112509/michiel-soede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474435973, "creation_date": 1474399831, "question_id": 39602370, "link": "https://stackoverflow.com/questions/39602370/vba-ado-query-on-excel-workbook", "title": "VBA ADO query on Excel workbook", "body": "<p>I have the following code to retrieve data from another workbook. However I want the SQL code take into account a where clause. This where clause should be applied on one of the columns. Up till now my code works but not after adding the where clause. The column header is Cost_center. What should I write differently in my code to let the code only get data where the Cost_center column is like a certain number?</p>\n\n<pre><code>Sub newbie2() Set cn = CreateObject(\"ADODB.Connection\") Set rs = CreateObject(\"ADODB.Recordset\")\n\nstrCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; ThisWorkbook.Path &amp; \"\\INP_DEPARTMENT_SOL_DEL.xlsx\" &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes;IMEX=1\"\";\"\ncn.Open strCon\n\nstrSQL = \"SELECT * from [sheet1$] WHERE [COST_CENTER] LIKE 5560\"\nrs.Open strSQL, cn, 0, 1  'cursortype = adOpenForwardOnly, locktype = adOpenReadonly\n\nThisWorkbook.Worksheets(\"Sheet2\").Range(\"A:A\").CopyFromRecordset rs\nrs.Close\ncn.Close\n\nSet rs = Nothing\nSet con = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance, </p>\n\n<p>Michiel</p>\n"}, {"tags": ["php", "excel", "vba", "com"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1474401738, "post_id": 39602134, "comment_id": 66514144, "body": "Once you have a reference to the COM object the interfaces are the same as using any other scripting language (such as vbscript for example)  PHP automation via COM doesn&#39;t use VBA, although the syntax will be similar so you should be able to find plenty of examples you can translate to PHP.  One big difference is you can&#39;t use any of the &quot;built-in&quot; constants which are available within VBA: you will need to provide the numeric values instead."}, {"owner": {"reputation": 11, "user_id": 3079761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727d3a3d647ee8f08d9cf129641f5831?s=128&d=identicon&r=PG&f=1", "display_name": "user3079761", "link": "https://stackoverflow.com/users/3079761/user3079761"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474402579, "post_id": 39602134, "comment_id": 66514548, "body": "Thank you, I&#39;m looking at VBA functions and trying to transate them to PHP. They are in fact similar. I do not need the built in constants, just a little styling for the reports."}], "owner": {"reputation": 11, "user_id": 3079761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727d3a3d647ee8f08d9cf129641f5831?s=128&d=identicon&r=PG&f=1", "display_name": "user3079761", "link": "https://stackoverflow.com/users/3079761/user3079761"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474398973, "creation_date": 1474398973, "question_id": 39602134, "link": "https://stackoverflow.com/questions/39602134/where-can-i-find-a-php-com-objects-library-with-all-their-functions", "title": "Where can I find a PHP COM objects library with all their functions?", "body": "<p>I have been searching everywhere on the internet for certain functions to manipulate an excel COM object with PHP. I am able to create a new excel sheet and save data but I cannot play with styling functions to make the reports look nice. </p>\n\n<p>Here is my code in case it can help in any way : </p>\n\n<p>\n\n<pre><code>private $users;\n\nprivate $brdata;\n\nprivate $excel;\n\nprivate $book;\n\nprivate $sheet;\n\nprivate $today;\n\nprivate $columns;\n\npublic function __construct()\n{\n    $this-&gt;users = $this-&gt;model('users');\n    $this-&gt;brdata = $this-&gt;model('brdata');\n    $this-&gt;excel = new COM(\"Excel.Application\");\n    $this-&gt;excel-&gt;Workbooks-&gt;Add();\n    $this-&gt;book = $this-&gt;excel-&gt;Workbooks(1);\n    $this-&gt;sheet = $this-&gt;book-&gt;Worksheets(1);\n    $this-&gt;today = date('Y-m-d', strtotime(\"-1 days\"));\n    $this-&gt;columns = array(\"UPC\" =&gt; \"UPC\", \"VDR ITEM #\" =&gt; \"CertCode\", \"BRAND\" =&gt; \"Brand\", \"ITEM DESCRIPTION\" =&gt; \"ItemDescription\", \"PACK\" =&gt; \"Pack\", \"SIZE\" =&gt; \"SizeAlpha\", \"CASE COST\" =&gt; \"CaseCost\", \"RETAIL\" =&gt; \"Retail\", \"ON-HAND\" =&gt; \"onhand\", \"LAST ORDER\" =&gt; \"lastReceiving\", \"LAST ORDER DATE\" =&gt; \"lastReceivingDate\", \"SALES\" =&gt; \"sales\", \"VDR #\" =&gt; \"VdrNo\", \"VDR NAME\" =&gt; \"VdrName\");;\n} \n\npublic function index()\n{\n    $header = array(\"A\" =&gt; \"UPC\", \"B\" =&gt; \"VDR ITEM #\", \"C\" =&gt; \"BRAND\", \"D\" =&gt; \"ITEM DESCRIPTION\", \"E\" =&gt; \"PACK\", \"F\" =&gt; \"SIZE\", \"G\" =&gt; \"CASE COST\", \"H\" =&gt; \"RETAIL\", \"I\" =&gt; \"ON-HAND\", \"J\" =&gt; \"LAST ORDER\", \"K\" =&gt; \"LAST ORDER DATE\", \"L\" =&gt; \"SALES\", \"M\" =&gt; \"VDR #\", \"N\" =&gt; \"VDR NAME\");\n    $this-&gt;setSheetName(\"Sheet 1\");\n    $this-&gt;setHeader(\"Example Report\", $header);\n    $this-&gt;setReport('0035', '2016-07-01', '2016-08-01', $header);\n    $this-&gt;saveReport('example');\n}\n\nprivate function setSheetName($sheetName)\n{\n    $this-&gt;sheet-&gt;Name = $sheetName;\n}\n\nprivate function setHeader($title, $header)\n{\n    $cell = $this-&gt;sheet-&gt;Range('A1');\n    $cell-&gt;value = $title; \n    foreach($header as $key =&gt; $value)\n    {\n        $cell = $this-&gt;sheet-&gt;Range($key . '2');\n        $cell-&gt;value = $value; \n    }\n}\n\nprivate function setReport($value, $from, $to, $header)\n{\n    $report = $this-&gt;brdata-&gt;get_sectionReport($value, $this-&gt;today, $from, $to);\n    for ($i=3;$i&lt;count($report);$i++)\n    {\n        foreach($header as $key =&gt; $value)\n        {\n            $cell = $this-&gt;sheet-&gt;Range($key . $i);\n            $cell-&gt;value = $report[$i][$this-&gt;columns[$value]];\n            if($value == \"ITEM DESCRIPTION\")\n            {\n                $cell-&gt;HorizontalAlignment=-4108;\n            }\n        } \n    }\n}\n\nprivate function styleReport()\n{\n\n}\n\nprivate function SaveReport($documentName)\n{\n    $this-&gt;book-&gt;SaveAs('C:\\wamp\\documents\\\\' . $documentName . '.xls');//Enregistrement du document\n    $this-&gt;sheet = null;//Lib\u00e9ration de $sheet\n    $this-&gt;book = null;//Lib\u00e9ration de $book\n    $this-&gt;excel-&gt;Workbooks-&gt;Close();//Fermeture du classeur\n    $this-&gt;excel-&gt;Quit();//On quitte Excel\n    $this-&gt;excel = null;//Lib\u00e9ration de l'objet $excel\n}\n</code></pre>\n\n<p>}</p>\n\n<p>f I understand correctly, PHP COM objects uses VBA... are the functions similar ?</p>\n\n<p>Thanks for your help !! :-)</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 2, "creation_date": 1474398537, "post_id": 39601955, "comment_id": 66512326, "body": "Please remove all the brackets from your WHERE clause. Also, look into aliases, they will shorten your code and make it more readable. Like that: <code>SELECT gd.EmployeeID FROM GroupedData gd</code>"}, {"owner": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 1, "creation_date": 1474398698, "post_id": 39601955, "comment_id": 66512409, "body": "Apart from the cosmetics, the query should work fine."}, {"owner": {"reputation": 1, "user_id": 6855016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aea89f3154b3d946ee9f1c97f0b297?s=128&d=identicon&r=PG&f=1", "display_name": "SqU33z3R", "link": "https://stackoverflow.com/users/6855016/squ33z3r"}, "edited": false, "score": 0, "creation_date": 1474400244, "post_id": 39601955, "comment_id": 66513304, "body": "Thank you for your tips but after getting rid of the brackets the code is still not producing the right results. If I paste this code into access it works brilliantly"}, {"owner": {"reputation": 709, "user_id": 6406676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tKqoTYfIoLg/AAAAAAAAAAI/AAAAAAAAAE4/nAM6WSK4jN0/photo.jpg?sz=128", "display_name": "David Cram", "link": "https://stackoverflow.com/users/6406676/david-cram"}, "edited": false, "score": 0, "creation_date": 1474403187, "post_id": 39601955, "comment_id": 66514863, "body": "Just for kicks, clear the listbox before adding records.  If the problem isn&#39;t your query (and it doesn&#39;t seem to be) then maybe the issue is that you have somewhere else that also populates the listbox."}, {"owner": {"reputation": 1, "user_id": 6855016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aea89f3154b3d946ee9f1c97f0b297?s=128&d=identicon&r=PG&f=1", "display_name": "SqU33z3R", "link": "https://stackoverflow.com/users/6855016/squ33z3r"}, "edited": false, "score": 0, "creation_date": 1474403847, "post_id": 39601955, "comment_id": 66515181, "body": "Double checked and ran the code line by line. This is not the issue"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6855016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aea89f3154b3d946ee9f1c97f0b297?s=128&d=identicon&r=PG&f=1", "display_name": "SqU33z3R", "link": "https://stackoverflow.com/users/6855016/squ33z3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1474410460, "creation_date": 1474410460, "answer_id": 39604683, "question_id": 39601955, "link": "https://stackoverflow.com/questions/39601955/sql-query-in-access-not-applying-where-clause/39604683#39604683", "title": "SQL Query in Access not applying WHERE clause", "body": "<p>Ok i have fixed the issue. Here is what happened:\nI have made a separate function that was retrieving Employee Name based on EmployeeID. But in that function i had recordset and database declared the same way, that is: rs and db. What happened when i ran the query was it was taking the first record filtered but then the rest of them were unfiltered because they were based on the recordset within the function (which is of course all of the employees) Such a silly mistake :) Thanks anyways</p>\n"}], "owner": {"reputation": 1, "user_id": 6855016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aea89f3154b3d946ee9f1c97f0b297?s=128&d=identicon&r=PG&f=1", "display_name": "SqU33z3R", "link": "https://stackoverflow.com/users/6855016/squ33z3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474415484, "creation_date": 1474398281, "last_edit_date": 1474415484, "question_id": 39601955, "link": "https://stackoverflow.com/questions/39601955/sql-query-in-access-not-applying-where-clause", "title": "SQL Query in Access not applying WHERE clause", "body": "<p>I am an amateur vba programmer currently struggling with the following:</p>\n\n<p>I wrote a simple SQL Query for my VBA program to extract data from an existing Query (GroupedData) in Access:</p>\n\n<pre><code>Dim strSQL as string\nDim db as dao.database\ndim rs as dao.recordset\n\nstrSQL = \"SELECT GroupedData.EmployeeID, GroupedData.End, GroupedData.LOB, GroupedData.Position, GroupedData.WorkStatus \" &amp; _\n    \"FROM GroupedData WHERE (((GroupedData.End) Is Null) AND ((GroupedData.Position)=0) AND ((GroupedData.WorkStatus)=0));\"\n\nSet db = OpenDatabase(MY_DB, dbOpenDynaset)\nSet rs = db.openrecordset(strSQL, dbOpenSnapshot)\n\nDo While Not rs.EOF\n    ListBox1.AddItem rs!EmployeeID\n    rs.MoveNext\nLoop\n</code></pre>\n\n<p>So my problem is that SQL is running smoothly but is not applying any filters (that is where clause - it produces records where workstatus and position contain values above 0)</p>\n\n<p>I have done such queries in the past without having any issues. This time however I am stuck</p>\n\n<p>Any help would be much appreciated!</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1474397829, "post_id": 39601727, "comment_id": 66511898, "body": "Hm, I can&#39;t duplicate your error. It works okay for me. (Excel 2016).  Create a brand new workbook, throw some data in column <code>AB</code> and see if it works then."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1474397983, "post_id": 39601727, "comment_id": 66511992, "body": "You probably have errors in the column."}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1474398041, "post_id": 39601727, "comment_id": 66512031, "body": "I&#39;ve had this macro work once or twice too. I think part of the problem is I have other macros running prior to that one for the same columns. I suspect the other macros might be somehow changing the property of the columns/cells? The odd thing is when I try this macro on another column of the same sheet, it works fine."}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1474398248, "post_id": 39601727, "comment_id": 66512167, "body": "This macro is not. The one running prior are."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1474398284, "post_id": 39601727, "comment_id": 66512187, "body": "When you step though, is <code>lastRow</code> &gt; 2?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1474398572, "post_id": 39601727, "comment_id": 66512345, "body": "What is the value in cell <code>&quot;AB &amp; i</code> when this errors out?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1474398758, "post_id": 39601727, "comment_id": 66512442, "body": "@port yeah and that wouldn&#39;t give a mismatch error anyway."}], "answers": [{"comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1474398852, "post_id": 39602008, "comment_id": 66512498, "body": "You&#39;re saying that <i>ABi</i> could be a formula resulting in an error, right?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1474398901, "post_id": 39602008, "comment_id": 66512529, "body": "@Raystafarian that was the intent of my assumption."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1474398488, "creation_date": 1474398488, "answer_id": 39602008, "question_id": 39601727, "link": "https://stackoverflow.com/questions/39601727/vba-in-excel-returning-type-mismatch/39602008#39602008", "title": "VBA in Excel returning Type mismatch", "body": "<p>You are trying to test if an error is = <code>No</code>.</p>\n\n<p>Test for the error and skip the logic in that loop:</p>\n\n<pre><code>Sub test()\n    Dim lastrow As Long\n    Dim i As Long\n    lastrow = Range(\"AB\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n        If Not IsError(Range(\"AB\" &amp; i).Value) Then\n            If Range(\"AB\" &amp; i).Value = \"No\" Then\n                Range(\"S\" &amp; i).Value = \"C-MEM\"\n                Range(\"W\" &amp; i).Value = \"\"\n                Range(\"AH\" &amp; i).Value = \"N/A\"\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 39602008, "answer_count": 1, "score": 0, "last_activity_date": 1474398488, "creation_date": 1474397564, "question_id": 39601727, "link": "https://stackoverflow.com/questions/39601727/vba-in-excel-returning-type-mismatch", "title": "VBA in Excel returning Type mismatch", "body": "<p>I'm trying to create a Macro that will modify contents in columns S, W and AH based on the content in AB\ne.g. if AB1 = No, then S1=C-MEM, AH = N/A and W is cleared.</p>\n\n<p>For some reason, I get a 'Type mismatch' error on the first line of my if statement and can't figure out why or how to fix it - even after reading other posts about similar issue.</p>\n\n<pre><code>Sub test()\n    Dim lastrow As Long\n    Dim i As Long\n    lastrow = Range(\"AB\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n    **-&gt;  If Range(\"AB\" &amp; i).Value = \"No\" Then\n            Range(\"S\" &amp; i).Value = \"C-MEM\"\n            Range(\"W\" &amp; i).Value = \"\"\n            Range(\"AH\" &amp; i).Value = \"N/A\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "math", "logic"], "comments": [{"owner": {"reputation": 55420, "user_id": 52443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a220753dbb4d24a76430971a18ed4dce?s=128&d=identicon&r=PG", "display_name": "Welbog", "link": "https://stackoverflow.com/users/52443/welbog"}, "edited": false, "score": 0, "creation_date": 1474398783, "post_id": 39600973, "comment_id": 66512456, "body": "199990 is the first one I found with a brute-force script O(n^2), adding 10 to y every time. You could definitely do this in linear time, though, by counting how many <code>1</code>s you&#39;re adding in each step."}, {"owner": {"reputation": 23, "user_id": 5305647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/74SOX.jpg?s=128&g=1", "display_name": "cauchy", "link": "https://stackoverflow.com/users/5305647/cauchy"}, "reply_to_user": {"reputation": 55420, "user_id": 52443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a220753dbb4d24a76430971a18ed4dce?s=128&d=identicon&r=PG", "display_name": "Welbog", "link": "https://stackoverflow.com/users/52443/welbog"}, "edited": false, "score": 0, "creation_date": 1474399086, "post_id": 39600973, "comment_id": 66512637, "body": "this is the result my code finally returned after !1.5 hours of running..can you share your full code, please?"}], "answers": [{"tags": [], "owner": {"reputation": 55420, "user_id": 52443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a220753dbb4d24a76430971a18ed4dce?s=128&d=identicon&r=PG", "display_name": "Welbog", "link": "https://stackoverflow.com/users/52443/welbog"}, "is_accepted": true, "score": 0, "last_activity_date": 1474399387, "creation_date": 1474399387, "answer_id": 39602248, "question_id": 39600973, "link": "https://stackoverflow.com/questions/39600973/code-or-logic-to-find-number-of-char-appearances-in-a-string-composed-of-consecu/39602248#39602248", "title": "Code or Logic to find number of char appearances in a string composed of consecutive numbers", "body": "<p>Python:</p>\n\n<pre><code>x = ''\ny = 0\n\n####################################\n# BRUTE FORCE, FINDS ANSWER 199990 #\n####################################\n#for iteration in range(100000):\n#    for index in range(10):\n#        y+=1\n#        x+=str(y)\n#    if (y == x.count('1')):\n#        print 'Found: ' + str(y) + ': ' + x\n####################################\n\n# More elegantly and efficiently, just track how many '1's we've added in each step\nones = 0\nfor iteration in range(100000):\n    x = ''\n    for index in range(10):\n        y += 1\n        x += str(y)\n    ones += x.count('1')\n    if (y == ones):\n        print 'Found: ' + str(y)\n</code></pre>\n\n<p>The commented-out solution takes about 2 minutes to execute. The second solution finishes in .46 seconds.</p>\n"}], "owner": {"reputation": 23, "user_id": 5305647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/74SOX.jpg?s=128&g=1", "display_name": "cauchy", "link": "https://stackoverflow.com/users/5305647/cauchy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 39602248, "answer_count": 1, "score": 0, "last_activity_date": 1474399387, "creation_date": 1474395037, "question_id": 39600973, "link": "https://stackoverflow.com/questions/39600973/code-or-logic-to-find-number-of-char-appearances-in-a-string-composed-of-consecu", "title": "Code or Logic to find number of char appearances in a string composed of consecutive numbers", "body": "<p>I am struggling with this exercise where I have to find a number (y) so that when counting the times (nr) the value \"1\" appears in a string (x) composed of all the consecutive numbers starting from 1 to y, the following conditions are met: nr=y and nr is divisible by 10.</p>\n\n<p>example:</p>\n\n<p>x (string with consecutive from 1 to 12)= 123456789101112</p>\n\n<p>y (the number) = 12</p>\n\n<p>nr (times of \"1\" appearances) = 5</p>\n\n<p>so i need to find the situation where nr=y and y mod 10 = 0</p>\n\n<p>I've tried creating a vba sub to do this, but it takes forever and cannot seem to find a suitable result:</p>\n\n<pre><code>Sub abc2()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim i As Double\nDim y As Double\nDim nr As Double\nDim x As String\nx = 1\ny = 1\n\n    For i = 1 To 500001\n\n\n        x = x &amp; (y + 1)\n        y = y + 1\n\n        nr = Len(x) - Len(Replace(x, \"1\", \"\"))\n\n\n        If nr = y And nr Mod 10 = 0 Then\n            Range(\"E1\") = y\n            GoTo out\n        End If\n\nNext i\n\nout:\n    Range(\"A1\") = x\n    Range(\"B1\") = y\n    Range(\"C1\") = nr\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>I'd really appreciate some suggestions. Maybe it can be solved in some other ingenious way.\nThank you!</p>\n"}, {"tags": ["vba", "excel", "event-handling"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1474392975, "post_id": 39600325, "comment_id": 66509264, "body": "If this is in the middle of processing when new data is fed, it seems like Excel wouldn&#39;t like that much. You would be triggering the event in the middle of the event. Never tested specifically."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1474393154, "post_id": 39600325, "comment_id": 66509343, "body": "@Kyle How do you mean?  I tested the use of the event data feed by highlighting rows with certain keywords in the worksheet module and it worked fine.  It&#39;s actually how I discovered that it feeds in by single rows.  I tested this with MsgBox as well and it worked through each iteration.  Even held the following data input until i had clicked ok on the MSG box for that first event."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1474393319, "post_id": 39600325, "comment_id": 66509406, "body": "fwiw, <code>Right(expirationDate, 2)</code> cannot be equal to <code>1</code>, it <b>can</b> however be equal to <code>&quot;1&quot;</code>. <code>CInt(Right(expirationDate, 2))</code> would be more appropriate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1474393484, "post_id": 39600325, "comment_id": 66509489, "body": "<code>application.enableevents = false</code> is your friend. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821508.aspx\" rel=\"nofollow noreferrer\">Application.EnableEvents property</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1474393624, "post_id": 39600325, "comment_id": 66509560, "body": "It would be prudent to check any possible conditions that match a data update. Perhaps the number of cells in a typical Target."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1474393977, "post_id": 39600325, "comment_id": 66509748, "body": "@Jeeped I&#39;ll make that change (to the case statement)! stupid mistake I&#39;ve known that in the past.  Thanks for pointing it out! I&#39;m unsure of the last comment though.  How can I check any/all conditions that could arise from the data update?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1474394439, "post_id": 39600325, "comment_id": 66509999, "body": "Try debug.print target.rows(1).cells.count as the first line within the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event macro. IDK if that is appropriate but you need to find some property of the data pull that can identify when to engage the worksheet_change and when to ignore it even if that is only 99% of the time."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1474396032, "post_id": 39600325, "comment_id": 66510860, "body": "@Jeeped input the debug line and it&#39;s printing 18 repetitively in the Immediate window.  The data no matter what is always 18 columns wide in the same columns.  The if statements i have in the worksheet module determine if it runs through the rest of the code or not so it sort of moderates the rest of the data."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1474397017, "post_id": 39600325, "comment_id": 66511442, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/123812/discussion-between-stormsedge-and-jeeped\">continue this discussion in chat</a>."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1474400017, "post_id": 39600325, "comment_id": 66513161, "body": "Would a change event making a change to a cell in the current target range initiate a new event?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474400214, "post_id": 39600325, "comment_id": 66513291, "body": "Yes - your <code>target.item(1,1) = </code> is the culprit."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474400266, "post_id": 39600325, "comment_id": 66513322, "body": "As it is currently set up, assuming the data feed fills a cell at a time, your code just wipes out the value the data feed inserts and often locks up Excel."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1474400323, "post_id": 39600325, "comment_id": 66513347, "body": "Would it be more sensible only to check a row once the feed starts populating the next row?"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1474404050, "creation_date": 1474404050, "answer_id": 39603360, "question_id": 39600325, "link": "https://stackoverflow.com/questions/39600325/worksheet-change-event-crashing-excel-with-live-data-feed/39603360#39603360", "title": "Worksheet_Change Event Crashing Excel With Live Data Feed", "body": "<p>The line saying </p>\n\n<pre><code>target.Item(1, 1) = finalTradeStructure\n</code></pre>\n\n<p>is probably causing an infinite loop, as it will fire a new Change event if it is executed.</p>\n\n<p>I recommend you just watch a single column (not the one that you might modify), e.g.:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal target As Range)\n\n    Dim initialTradeStructure As String, finalTradeStructure As String, rawStructure As String\n\n    'See if the change affects something in column 3 and only process if it does\n    If Not Intersect(Target, Columns(3)) Is Nothing Then\n\n        With Target.Rows(1)\n            'RFQs\n            If .Cells(1, \"D\") = \"RequestForQuote\" Then\n\n                'Do Nothing....no analysis of RFQs is necessary....will be filtered later\n\n            'Screen Trades\n            ElseIf .Cells(1, \"D\") = \"GlobexTrades\" Then\n\n                rawStructure = .Cells(1, \"C\")\n\n                initialTradeStructure = Right(rawStructure, Len(rawStructure) - 4)\n\n                'Bulk of analaysis conducted in analsyis engine to keep worksheet code clean/short\n                finalTradeStructure = OptionStructureAnalysisEngine(initialTradeStructure, target)\n\n            'Block screen represented as Multileg in datafeed structure\n            ElseIf .Cells(1, \"D\") = \"Block\" Then\n\n                If .Cells(1, \"R\") = \"TRUE\" Then\n\n                    rawStructure = .Cells(1, \"C\")\n\n                    initialTradeStructure = Right(rawStructure, Len(rawStructure) - 4)\n\n                    'Bulk of analysis conducted in analysis engine to keep worksheet code clean/short\n                    finalTradeStructure = OptionStructureAnalysisEngine(initialTradeStructure, target)\n\n                ElseIf .Cells(1, \"R\") = \"FALSE\" And .Cells(1, \"Q\") = \"FALSE\" Then\n\n                    'Live block trade\n\n                Else\n\n                    'Do Nothing....No analysis of single block legs is necessary\n\n                End If\n\n            End If\n\n            If Not finalTradeStructure = \"Nothing\" Then\n\n                .Cells(1, \"B\") = finalTradeStructure\n\n            End If\n\n        End With\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Note: I have changed your <code>Target.Items(1,x)</code> format to be <code>Target.Rows(1).Cells(1,x+1)</code> format (with the x+1 being coded as the actual alphabetic column name) as I think it will make it easier to see which columns are being referred to.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1474430091, "last_edit_date": 1495535651, "creation_date": 1474430091, "answer_id": 39607272, "question_id": 39600325, "link": "https://stackoverflow.com/questions/39600325/worksheet-change-event-crashing-excel-with-live-data-feed/39607272#39607272", "title": "Worksheet_Change Event Crashing Excel With Live Data Feed", "body": "<p>I cannot see your data nor see how these subs and functions interact with them but this is my blind rewrite on your problem. I also rewrote one of your functions to make it a little more readable (to me).</p>\n\n<p><strong>Sheet1 - Code Sheet</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Rows(1).Cells.Count = 18 Then\n        'set a custom error procedure; essentially revert to as normal as ppossible\n        On Error GoTo bm_Safe_Exit\n        'turn off event handling so if anything is changed, the sub procedure does not try to walk on top of itself\n        Application.EnableEvents = False\n        'only dim things now that you know that something is actually going to happen\n        Dim iTS As String, fTS As String, rS As String\n        'always determine text comparisons as case-insensitive\n        Select Case LCase(Target.Cells(1, 3).Value2)\n            caae \"requestforquote\"\n                'do nothing\n            caae \"globextrades\"\n                rS = Target.Cells(1, 2).Value2\n                initialTritsadeStructure = Right(rS, Len(rS) - 4)\n                'Bulk of analaysis conducted in analsyis engine to keep worksheet code clean/short\n                fTS = OptionStructureAnalysisEngine(iTS, Target)\n                'Block screen represented as Multileg in datafeed structure\n            caae \"block\"\n                'Is this actually TRUE/FALSE or text...????!!!?????\n                Select Case UCase(Target.Item(1, 17).Text)\n                    Case \"TRUE\"\n                        rS = Target.Item(1, 2).Value2\n                        iTS = Right(rS, Len(rS) - 4)\n                    Case \"FALSE\"\n                        'Bulk of analysis conducted in analysis engine to keep worksheet code clean/short\n                        fTS = OptionStructureAnalysisEngine(iTS, Target.Cells(1, 1)) '&lt;~~ need to know which of a typical target's 18 cells to throw into this\n                    Case Else\n                        'do nothing\n                End Select\n            Case Else\n                'do nothing\n        End Select\n    End If\n\n    If Not fTS = \"Nothing\" And CBool(Len(fTS)) Then\n        Target.Item(1, 1) = fTS\n    End If\n\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>Module1 code sheet</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Function OptionStructureAnalysisEngine(tradeStructure As String, tradeDataRange As Range) As String\n    'analyzes and translates tradeStructure and dataRange\n    'Driver\n    Dim structureAssemblyString As String, optionType As String\n\n    'Tests for / in tradeStructure to determine if it's a LIVE option trade or if it's a multi leg structure\n    If InStr(1, tradeStructure, \"/\") &lt; 1 Then\n        'Declares LIVE and option Type\n        structureAssemblyString = \"LIVE \" &amp; GetOptionCodes(Mid(tradeStructure, 8, 2)) &amp; \" \" &amp; TranslateExpirationDate(Mid(tradeStructure, 11, 6)) _\n                                    &amp; \" \" &amp; GetCallOrPut(Mid(tradeStructure, 18, 1))\n    Else\n        'Place holder for multileg structures\n        structureAssemblyString = \"Nothing\"\n    End If\n\n    OptionStructureAnalysisEngine = structureAssemblyString\n\nEnd Function\n\nPublic Function GetOptionCodes(optionType As String) As String\n\n    Select Case UCase(optionType)\n        Case \"LO\"\n            GetOptionCodes = \"WTI American\"\n        Case \"OH\"\n            GetOptionCodes = \"HO American\"\n        Case \"OB\"\n            GetOptionCodes = \"RB American\"\n        Case \"LN\"\n            GetOptionCodes = \"NG European\"\n        Case Else\n            'do nothing\n    End Select\n\nEnd Function\n\nPublic Function TranslateExpirationDate(expirationDate As Long) As String\n    Dim c As Integer, str As String\n    c = CInt(Right(expirationDate, 2))\n    str = Mid(expirationDate, 3, 2)\n    Select Case c\n        Case 1, 2, 3\n            TranslateExpirationDate = Chr(c + 69) &amp; str\n        Case 4, 5\n            TranslateExpirationDate = Chr(c + 70) &amp; str\n        Case 6, 7\n            TranslateExpirationDate = Chr(c + 71) &amp; str\n        Case 8\n            TranslateExpirationDate = Chr(c + 72) &amp; str\n        Case 9, 10\n            TranslateExpirationDate = Chr(c + 76) &amp; str\n        Case 11\n            TranslateExpirationDate = Chr(c + 77) &amp; str\n        Case 12\n            TranslateExpirationDate = Chr(c + 78) &amp; str\n        Case Else\n            'do nothing\n    End Select\nEnd Function\n\nPublic Function GetCallOrPut(legOption As String) As String\n    Select Case UCase(legOption)\n        Case \"C\"\n            GetCallOrPut = \"Call\"\n        Case \"P\"\n            GetCallOrPut = \"Put\"\n        Case Else\n            'do nothing\n    End Select\nEnd Function\n</code></pre>\n\n<p>As mentioned, I did this blind. If you cannot use it or modify it to your own purposes, edit your original question to include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> (redact your sample data as necessary).</p>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 39607272, "answer_count": 2, "score": 0, "last_activity_date": 1474430091, "creation_date": 1474392520, "question_id": 39600325, "link": "https://stackoverflow.com/questions/39600325/worksheet-change-event-crashing-excel-with-live-data-feed", "title": "Worksheet_Change Event Crashing Excel With Live Data Feed", "body": "<p>I am attempting to run code that is driven by a <code>Private Sub Worksheet_Change(ByVal target As Range)</code> event.  I want my code to analyze the data as it feeds in real time rather than having to input a big block of data every 15-20 minutes to analyze the new data.</p>\n\n<p>The data I am attempting to run is fed in through an API from a data service and streams live into my excel sheet.  I use a function called <code>CMED.MA</code> which has two different parameters (irrelevant at the current moment).  It feeds in rolling down the rows so you'd have one row, then new data would feed in the next row, etc, etc.  At times it's fairly rapid (every few seconds)...other times it's very stagnant (every few minutes or so).  <strong>Note:</strong> The data is fed in a <strong>single row</strong> at a time.</p>\n\n<p>I created a bunch of functions to use and stored them in a separate module (all <code>Public Functions</code>) in order to keep the worksheet module clean and short.  </p>\n\n<p><strong>Problem</strong></p>\n\n<p>After writing a small piece of it to cover analysis of the live data I wanted to test it (thankfully decided to test it) and now when I attempt to make the code go live in the worksheet module it crashes excel entirely.  I have to shut off the data feed from the source so that I can disable the code in the worksheet module.  Any ideas or glaring issues with my code?  This is my first attempt at using a <code>Worksheet_Change</code> event</p>\n\n<p><strong>Worksheet Module Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal target As Range)\n\n    Dim initialTradeStructure As String, finalTradeStructure As String, rawStructure As String\n\n    'RFQs\n    If target.Item(1, 3) = \"RequestForQuote\" Then\n\n        'Do Nothing....no analysis of RFQs is necessary....will be filtered later\n\n    'Screen Trades\n    ElseIf target.Item(1, 3) = \"GlobexTrades\" Then\n\n        rawStructure = target.Item(1, 2)\n\n        initialTradeStructure = Right(rawStructure, Len(rawStructure) - 4)\n\n        'Bulk of analaysis conducted in analsyis engine to keep worksheet code clean/short\n        finalTradeStructure = OptionStructureAnalysisEngine(initialTradeStructure, target)\n\n    'Block screen represented as Multileg in datafeed structure\n    ElseIf target.Item(1, 3) = \"Block\" Then\n\n        If target.Item(1, 17) = \"TRUE\" Then\n\n            rawStructure = target.Item(1, 2)\n\n            initialTradeStructure = Right(rawStructure, Len(rawStructure) - 4)\n\n            'Bulk of analysis conducted in analysis engine to keep worksheet code clean/short\n            finalTradeStructure = OptionStructureAnalysisEngine(initialTradeStructure, target)\n\n        ElseIf target.Item(1, 17) = \"FALSE\" And target.Item(1, 16) = \"FALSE\" Then\n\n            'Live block trade\n\n        Else\n\n            'Do Nothing....No analysis of single block legs is necessary\n\n        End If\n\n    End If\n\n    If Not finalTradeStructure = \"Nothing\" Then\n\n        target.Item(1, 1) = finalTradeStructure\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Function Module</strong></p>\n\n<pre><code>Public Function OptionStructureAnalysisEngine(tradeStructure As String, tradeDataRange As Range) As String\n    'analyzes and translates tradeStructure and dataRange\n    'Driver\n    Dim structureAssemblyString As String, optionType As String\n\n    'Tests for / in tradeStructure to determine if it's a LIVE option trade or if it's a multi leg structure\n    If InStr(1, tradeStructure, \"/\") &lt; 1 Then\n\n        'Declares LIVE and option Type\n        structureAssemblyString = \"LIVE \" &amp; GetOptionCodes(Mid(tradeStructure, 8, 2)) &amp; \" \" &amp; TranslateExpirationDate(Mid(tradeStructure, 11, 6)) _\n        &amp; \" \" &amp; GetCallOrPut(Mid(tradeStructure, 18, 1))\n\n    Else\n\n        'Place holder for multileg structures\n        structureAssemblyString = \"Nothing\"\n\n    End If\n\n    OptionStructureAnalysisEngine = structureAssemblyString\n\nEnd Function\n\nPublic Function GetOptionCodes(optionType As String) As String\n\n    Select Case optionType\n\n        Case \"LO\"\n\n            GetOptionCodes = \"WTI American\"\n\n        Case \"OH\"\n\n            GetOptionCodes = \"HO American\"\n\n        Case \"OB\"\n\n            GetOptionCodes = \"RB American\"\n\n        Case \"LN\"\n\n            GetOptionCodes = \"NG European\"\n\n    End Select\n\nEnd Function\n\nPublic Function TranslateExpirationDate(expirationDate As Double) As String\n\n    Select Case Right(expirationDate, 2)\n\n        Case 1\n\n            TranslateExpirationDate = \"F\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 2\n\n            TranslateExpirationDate = \"G\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 3\n\n            TranslateExpirationDate = \"H\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 4\n\n            TranslateExpirationDate = \"J\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 5\n\n            TranslateExpirationDate = \"K\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 6\n\n            TranslateExpirationDate = \"M\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 7\n\n            TranslateExpirationDate = \"N\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 8\n\n            TranslateExpirationDate = \"Q\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 9\n\n            TranslateExpirationDate = \"U\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 10\n\n            TranslateExpirationDate = \"V\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 11\n\n            TranslateExpirationDate = \"X\" &amp; Mid(expirationDate, 3, 2)\n\n        Case 12\n\n            TranslateExpirationDate = \"Z\" &amp; Mid(expirationDate, 3, 2)\n\n    End Select\n\nEnd Function\n\nPublic Function GetCallOrPut(legOption As String) As String\n    'Translates C to Call and P to Put in option Structure\n\n    If legOption = \"C\" Then\n\n        GetCallOrPut = \"Call\"\n\n    ElseIf legOption = \"P\" Then\n\n        GetCallOrPut = \"Put\"\n\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "pdf", "vba"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1474395502, "post_id": 39600452, "comment_id": 66510553, "body": "OP wants to export the sheets into a single PDF - the <code>Select</code> is required for that."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474396129, "post_id": 39600452, "comment_id": 66510920, "body": "@TimWilliams - Oh, really? That&#39;s the first (that I can recall) where <code>.Select</code> is required.  How come I can&#39;t just add <code>sht.Select</code> and replace <code>sht.ExportAs...</code> with <code>ActiveSheet.ExportAs...</code>? That also throws an error for me."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1474415559, "post_id": 39600452, "comment_id": 66519215, "body": "@TimWilliams - <code>Workbook.ExportAsFixedFormat</code> skips hidden sheets (at least in 2013). See <a href=\"https://stackoverflow.com/a/36107539/4088852\">this answer</a>."}, {"owner": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "edited": false, "score": 0, "creation_date": 1474540053, "post_id": 39600452, "comment_id": 66576990, "body": "@bruce hi bruce what it does is to save the main page where the checkboxes and other form located. actually i am trying to avoid to print the main page. thanks!"}, {"owner": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "edited": false, "score": 0, "creation_date": 1474541557, "post_id": 39600452, "comment_id": 66577971, "body": "&quot;@TimWilliams - Workbook.ExportAsFixedFormat skips hidden sheets (at least in 2013). See this answer. \u2013 Comintern&quot;  this link solved my problem, thanks Comintern!!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1474392981, "creation_date": 1474392981, "answer_id": 39600452, "question_id": 39600183, "link": "https://stackoverflow.com/questions/39600183/save-visible-sheets-to-pdf-ignore-hidden-sheets/39600452#39600452", "title": "Save visible sheets to pdf, ignore hidden sheets", "body": "<p>It's likely due to the use of <code>.Select</code>. We want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a> wherever possible. Instead, just set a loop to go through each worksheet in your workbook.</p>\n\n<pre><code>Sub save_PDFs()\nDim sht As Worksheet\nFor Each sht In ActiveWorkbook.Worksheets\n    sht.ExportAsFixedFormat Type:=xlTypePDF, fileName:=Sheets(\"MAIN\").Range(\"customer_name\") + \" - Project Initiation_ Document.pdf\", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\nNext sht\nEnd Sub\n</code></pre>\n\n<p>However, if you want only visible sheets, then do this:</p>\n\n<pre><code>Sub save_PDFs()\nDim sht As Worksheet\nFor Each sht In ActiveWorkbook.Worksheets\n    If sht.Visible = True Then sht.ExportAsFixedFormat Type:=xlTypePDF, fileName:=Sheets(\"MAIN\").Range(\"customer_name\") + \" - Project Initiation_ Document.pdf\", Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\nNext sht\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "edited": false, "score": 0, "creation_date": 1474539696, "post_id": 39601263, "comment_id": 66576767, "body": "thanks tim, but what it does is save only the title page."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "edited": false, "score": 0, "creation_date": 1474556529, "post_id": 39601263, "comment_id": 66588466, "body": "Try commenting out the Sheets(&quot;TITLE&quot;).Activate line"}, {"owner": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "edited": false, "score": 0, "creation_date": 1474666209, "post_id": 39601263, "comment_id": 66641256, "body": "i am sorry tim, i am really a beginner in this field what do you mean by &quot;commenting out the Sheets(&quot;TITLE&quot;).Activate&quot;?"}, {"owner": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "edited": false, "score": 0, "creation_date": 1474667618, "post_id": 39601263, "comment_id": 66641731, "body": "great sir tim, i got it on a search and after commenting out that line it works fine like what i am looking for. thank you very much."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1474670087, "last_edit_date": 1474670087, "creation_date": 1474395999, "answer_id": 39601263, "question_id": 39600183, "link": "https://stackoverflow.com/questions/39600183/save-visible-sheets-to-pdf-ignore-hidden-sheets/39601263#39601263", "title": "Save visible sheets to pdf, ignore hidden sheets", "body": "<p>Something like this:</p>\n\n<pre><code>Sub ExportVisible()\n    Dim shts, sht As Worksheet, s, i As Long\n\n\n    shts = Array(\"TITLE\", \"CML\", \"CLUSTER\", \"ORS\", \"MOBILE\", \"YPS\", \"DEVICES\", \"PORTS\")\n    i = 0\n\n    For Each s In shts\n        Set sht = ActiveWorkbook.Sheets(s)\n        If sht.Visible = xlSheetVisible Then\n            i = i + 1\n            sht.Select (i = 1) '\"replace\" parameter true when i=1\n        End If\n    Next s\n\n    'Sheets(\"TITLE\").Activate '&lt;&lt;EDIT: remove this\n\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n                  Filename:=Sheets(\"MAIN\").Range(\"customer_name\").Value &amp; _\n                  \" - Project Initiation_Document.pdf \", _\n                  Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                  IgnorePrintAreas:=False, OpenAfterPublish:=True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6854363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1518d82a1a699b63b2c1dc94edc79c4?s=128&d=identicon&r=PG", "display_name": "RHON", "link": "https://stackoverflow.com/users/6854363/rhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2674, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1490482641, "creation_date": 1474391959, "last_edit_date": 1531161705, "question_id": 39600183, "link": "https://stackoverflow.com/questions/39600183/save-visible-sheets-to-pdf-ignore-hidden-sheets", "title": "Save visible sheets to pdf, ignore hidden sheets", "body": "<p>I recorded a macro.</p>\n\n<p>It works if all of the sheets are visible but when I hide a sheet it will not save to pdf.</p>\n\n<p>This is the code.</p>\n\n<pre><code>Sub save_pdf() \n' \n' save_pdf Macro \n'\n\n' \nSheets(Array(\"TITLE\", \"CML\", \"CLUSTER\", \"ORS\", \"MOBILE\", \"YPS\", \"DEVICES\", \"PORTS\")).Select \nSheets(\"TITLE\").Activate\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, fileName:= _ Sheets(\"MAIN\").Range(\"customer_name\") + \" - Project Initiation_ Document.pdf\", Quality:=xlQualityStandard, IncludeDocProperties:=True,_ IgnorePrintAreas:=False, OpenAfterPublish:=True \n\nSheets(\"MAIN\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "slicers", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1474389460, "post_id": 39599449, "comment_id": 66507276, "body": "How many slicer items do you loop through?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1474391953, "post_id": 39599449, "comment_id": 66508728, "body": "It&#39;s probably just going to be slow. Monkeying with sliceritems in a slicercache causes filtering on it&#39;s connected pivotcache, which takes processing. So everytime it flips a <code>sliceritem.selected</code> to <code>true</code> or <code>false</code> the pivotcache gets filtered for the connected pivot table and excel crawls. I guess.. theoretically you could empty the connected pivot&#39;s pivotcache (temporarily move the data but not the headers and refresh), then run this code to filter the nothing by toggling the <code>sliceritems.Selected</code> property and then tossing the data back in and refreshing the pivottable all at once...?"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1474392822, "post_id": 39599449, "comment_id": 66509187, "body": "@Kyle          Alot and probably more to come.  I&#39;m wondering if it would be a better/quicker solution to set the value/selection of &quot;slicer2&quot; to match that of a hidden cell? e.g. have A1 = the filtered value of the main pivot table and then set &quot;slicer2&quot; selection to equal that of cell A1? I&#39;m unsure how to decipher this though, have not turned up any functional coding so far."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1474425139, "post_id": 39599449, "comment_id": 66521495, "body": "How many items in each slicer will be selected? Just 1? Or will you want users to be able to make multiple selections?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1474434865, "post_id": 39599449, "comment_id": 66523994, "body": "And when you say &#39;a lot and probably more to come&#39; can you be more specific? How many PivotTables do you need to sync up? How many PivotItems are in each of them?"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474459002, "post_id": 39599449, "comment_id": 66538318, "body": "I have my one &quot;main&quot; pivot table and chart from one cache, then 4 additional pivots from another cache. I want only one item to be selected for each of the two desired slicers. One of the slicers will have 150+ items, the other will just be months. I did try some work with syncing the pivots up rather than the slicer but this will not work for me I don&#39;t think, as I do not have a matching field for what I am filtering with the slicer. For example the additional pivots have only the fields, &quot;users&quot; w/ count of user to display the top 5...."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474459287, "post_id": 39599449, "comment_id": 66538500, "body": "...users for a given criteria. I do not have a field corresponding to the slicer with 150+ items or a &quot;date of&quot; field, and I do not want to add them. However when I select a department from the slicer (the slicer with 150+ items) or a month from the second slicer, it will filter the synced tables accordingly. I was unable to achieve this with the pivots directly because there is a missing pagefield. It&#39;s also note worthy that I am incredibly inexperienced with VBA and have just recently began to dabble so I&#39;m unsure if using the slave pivots would be a workaround for that."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1474491670, "post_id": 39599449, "comment_id": 66558327, "body": "My <i>Connect with slicers, sync Slaves with VBA</i> approach will work even though your displayed pivots don&#39;t have the &#39;Department&#39; field in them. See new screenshot in my answer below. Try it out, and holler if you get stuck. Otherwise, you&#39;re going to be stuck with the slow iteration-based approach that you have."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474552152, "post_id": 39599449, "comment_id": 66585239, "body": "Got it to work in a test file. This is awesome thank you!. I am struggling however, to figure out how to get this to work with a second slicer field. I want the user to only be able to select one item in the slicer but I would like an additional one for dates. I attempted to create a second set of slaves and repeat the code but get hit with a duplicate <code>sField</code> error. Is this possible?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474459312, "post_id": 39604425, "comment_id": 66538518, "body": "Hey thanks a ton for the reply, I added an additional reply to your comments above the answer. I&#39;m unsure if this will work for me as you&#39;ll read above. Another approach I was trying to figure out was if I could send selected item of slicer 1 to a cell and use that value to drive the selection of  the slicer for the tables on the second cache.  thanks a ton."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474495882, "post_id": 39604425, "comment_id": 66560236, "body": "Yes, you can send the selected item of Slicer1 to a cell, but then you are still faced with the issue of syncing Slicer2 to that one item. Which will require you to iterate though the SlicerItems of Slicer2 (or one of the PivotTables it connects to) and which brings you right back to your initial issue. Read this link, because it explains the inherent problems involved in that: <a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2013/11/14/&hellip;</a>"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474495976, "post_id": 39604425, "comment_id": 66560271, "body": "If you set .ManualUpdate to true in all the pivots connected to Slicer2 while you do that then things should get faster. But that is still a heck of a lot more complicated than my suggested approach above of using Slave pivots to both &#39;harvest&#39; the click on Slicer1 and then efficiently sync that single selection on to the other Pivots via Slicer2"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474556876, "post_id": 39604425, "comment_id": 66588714, "body": "I cannot figure out how this could be tweaked to allow syncing of two different slicer categories. Tried second set of slave tables, second page field, hmm."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474573427, "post_id": 39604425, "comment_id": 66598553, "body": "Awill...what are the two different slicer category names? You basically need to duplicate everything between my comment at the top and the errhandler at the bottom, and then change the following bits to reflect the name of the second slicer and pivots:  Const sField As String = &quot;Name&quot; vArray = Array(&quot;PivotTable2 Slave&quot;, &quot;PivotTable3 Slave&quot;) If Target.Name = &quot;PivotTable1 Slave&quot; Then..."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474574300, "post_id": 39604425, "comment_id": 66599022, "body": "Hi, that was my original attempt, however I was getting flagged for a duplicate declaration in scope with the sField As String = all highlighted when I chose debug."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474576168, "post_id": 39604425, "comment_id": 66600039, "body": "sorry missed this; the first slicer category is department. I have that successfully updating all my tables. It&#39;s giving me overall/total metrics for the department selected but I also want to be able to break it down by date with a month slicer."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474580004, "post_id": 39604425, "comment_id": 66601822, "body": "Ah yes, my bad. Change <i>Const sField As String = &quot;SomeFieldName&quot;</i> to <i>sField = &quot;SomeFieldName&quot;</i> and also add <i>DIM sField as String</i> to the declarations at the top."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474580117, "post_id": 39604425, "comment_id": 66601873, "body": "That said, there may be a better way to handle syncing of the dates. See <a href=\"http://stackoverflow.com/questions/39105890/filtering-multiple-pivot-tables-based-on-drop-down-selections-using-vba/39111413#39111413\" title=\"filtering multiple pivot tables based on drop down selections using vba\">stackoverflow.com/questions/39105890/&hellip;</a> Also, what version of Excel are you doing? It strikes me that if you have 2013 or later you should consider using the DataModel to link the underlying source tables, so that everything can then appear in the same PivotCache."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474642750, "post_id": 39604425, "comment_id": 66629492, "body": "Tossed my outcome up top since it was much too long."}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1474643486, "post_id": 39604425, "comment_id": 66629951, "body": "Would you be opposed to me emailing you my example instead of dragging out the comments? I&#39;m also struggling with getting one of my pivots with combined data from two other pivots to update automatically. It works perfectly fine when manually updating it, but when I attempt to add code to the worksheet it bugs out, hope I didn&#39;t just break any posting rules by commenting on a second roadblock I&#39;m running into with this sheet."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 1, "last_activity_date": 1474491586, "last_edit_date": 1474491586, "creation_date": 1474408978, "answer_id": 39604425, "question_id": 39599449, "link": "https://stackoverflow.com/questions/39599449/vba-to-connect-slicers-looking-for-improvements-to-code/39604425#39604425", "title": "VBA to connect slicers (looking for improvements to code)", "body": "<p>If you only want the user to select just one item at a time, you can do this very quickly by using the following trick that leverages off a quirk to do with PageFields. Here's an example where I sync three different PivotTables that are on different caches.</p>\n\n<ol>\n<li><p>Set up a slave PivotTable for each of the master PivotTables\nsomewhere out of sight, and put the field of interest in each of\nthem as a PageField, like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5GzVP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5GzVP.jpg\" alt=\"enter image description here\"></a></p></li>\n<li>Make sure the 'Select Multiple Items' checkbox is <em>deselected</em> for each of those slave PivotTables:\n<a href=\"https://i.stack.imgur.com/rdSPJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rdSPJ.jpg\" alt=\"enter image description here\"></a></li>\n<li>Add a Slicer to each of those Slaves. Again, these will be somewhere out of sight:\n<a href=\"https://i.stack.imgur.com/l6O5K.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l6O5K.jpg\" alt=\"enter image description here\"></a></li>\n<li>Connect each of those Slicers up to the actual PivotTables you had to begin with. (i.e. connect each hidden Slicer to it's visible counterpart PivotTable using the Report Connections box.\n<a href=\"https://i.stack.imgur.com/A3D6C.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A3D6C.jpg\" alt=\"enter image description here\"></a></li>\n</ol>\n\n<p>Now this is where the clever hack comes in: We move the Slicer that is connected to the <em>PivotTable1 Slave</em> PivotTable into the main sheet so the user can click on it. When they select an item using it, it generates a PivotTable_Update event for that <em>PivotTable1 Slave</em> PivotTable, which we keep an eye out for. And then we set the .PageField of those other slave PivotTables to match the .PageField of the <em>PivotTable1 Slave</em> PivotTable. And then more magic happens: that single selection in those slave PageFields gets replicated in the master PivotTables thanks to those hidden Slicers we set up earlier. No VBA neccessary. No slow iteration necessary. Just lightning fast syncing. </p>\n\n<p>Here's how the entire setup looks:\n<a href=\"https://i.stack.imgur.com/wT4Eq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wT4Eq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...and this will work even if the field you want to filter on isn't visible in any of your pivots:\n<a href=\"https://i.stack.imgur.com/KXu5c.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KXu5c.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the code that achieves this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n\nDim pt As PivotTable\nDim pf As PivotField\nDim sCurrentPage As String\nDim vItem As Variant\nDim vArray As Variant\n\n'########################\n'# Change these to suit #\n'########################\n\nConst sField As String = \"Name\"\nvArray = Array(\"PivotTable2 Slave\", \"PivotTable3 Slave\")\n\n\nIf Target.Name = \"PivotTable1 Slave\" Then\n    On Error GoTo errhandler\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    'Find out what item they just selected\n    Set pf = Target.PivotFields(sField)\n    With pf\n        If .EnableMultiplePageItems Then\n            .ClearAllFilters\n            .EnableMultiplePageItems = False\n            sCurrentPage = \"(All)\"\n        Else:\n            sCurrentPage = .CurrentPage\n        End If\n    End With\n\n    'Change the other slave pivots to match. Slicers will pass on those settings\n    For Each vItem In vArray\n        Set pt = ActiveSheet.PivotTables(vItem)\n        Set pf = pt.PivotFields(sField)\n        With pf\n            If .CurrentPage &lt;&gt; sCurrentPage Then\n                .ClearAllFilters\n                .CurrentPage = sCurrentPage\n            End If\n        End With\n    Next vItem\n\nerrhandler:\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n    End With\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>There's a bit of code in there to ensure that the user can't select more than one item in the slicer at a time.</p>\n\n<p><strong>But what if you want the User to be able to select <em>multiple</em> items?</strong></p>\n\n<p>If you want the user to be able to select multiple items, things become way, way more complicated.  For starters, you need to set each PivotTable's ManualUpdate property to TRUE so that they don't refresh ater each and every PivotItems changes. And even then, it can take minutes to sync just one PivotTable if it has say 20,000 items in it. I've got a good post on this at the following link that I'd recommend you read, that shows just how long it takes to perform different actions when it comes to iterate through a large number of PivotItems:\n<a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/</a></p>\n\n<p>Even then, you have a lot of other challenges to overcome depending on what you're doing. Slicers seem to really slow things down, for starters. Read my post at <a href=\"http://dailydoseofexcel.com/archives/2015/11/17/filtering-pivottables-with-vba-deselect-slicers-first/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2015/11/17/filtering-pivottables-with-vba-deselect-slicers-first/</a> for more on this. </p>\n\n<p>I'm in the final stages of launching a commercial addin that does a lot of this stuff lightning fast, but launch is at least a month away. </p>\n"}, {"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1474833327, "post_id": 39661175, "comment_id": 66681648, "body": "Awill - flick your spreadsheet to me at weir.jeff@gmail.com and I&#39;ll take a look, and then post back here."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1474943553, "post_id": 39661175, "comment_id": 66728110, "body": "Given this answer has addressed your original question, how &#39;bout you mark it as Accepted."}], "tags": [], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "is_accepted": false, "score": 0, "last_activity_date": 1474634871, "creation_date": 1474634871, "answer_id": 39661175, "question_id": 39599449, "link": "https://stackoverflow.com/questions/39599449/vba-to-connect-slicers-looking-for-improvements-to-code/39661175#39661175", "title": "VBA to connect slicers (looking for improvements to code)", "body": "<p>I'm unsure what I'm doing incorrect. I posted my code below, I'm not hitting any errors, it's simply just not updating any of the other slicers/fields. Upon first test, the Department slicer updated all the tables once, but then would not clear the filter or allow another selection, as far as the Month slicer, I haven't gotten it to work at all. Do I perhaps need to duplicate each item so that it's separately identifiable? As in <code>Dim sCurrentPage As String</code> and <code>Dim sCurrentPage2 As String</code>. Thank you so much for your continued assistance with this, I've never wanted the weekend to come so badly while working on a spreadsheet before. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n\nDim pt As PivotTable\nDim pf As PivotField\nDim sCurrentPage As String\nDim vItem As Variant\nDim vArray As Variant\nDim sField As String\n\n'########################\n'# Change these to suit #\n'########################\n\nsField = \"Department\"\nvArray = Array(\"PivotTable2 Slave\", \"PivotTable3 Slave\")\n\n\nIf Target.Name = \"PivotTable1 Slave\" Then\n    On Error GoTo errhandler\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    'Find out what item they just selected\n    Set pf = Target.PivotFields(sField)\n    With pf\n        If .EnableMultiplePageItems Then\n            .ClearAllFilters\n            .EnableMultiplePageItems = False\n            sCurrentPage = \"(All)\"\n        Else:\n            sCurrentPage = .CurrentPage\n        End If\n    End With\n\n    'Change the other slave pivots to match. Slicers will pass on those settings\n    For Each vItem In vArray\n        Set pt = ActiveSheet.PivotTables(vItem)\n        Set pf = pt.PivotFields(sField)\n        With pf\n            If .CurrentPage &lt;&gt; sCurrentPage Then\n                .ClearAllFilters\n                .CurrentPage = sCurrentPage\n            End If\n        End With\n    Next vItem\n\n'########################\n\nsField = \"Month\"\nvArray = Array(\"PivotTable2 Slave2\", \"PivotTable3 Slave2\")\n\n\nIf Target.Name = \"PivotTable1 Slave2\" Then\n    On Error GoTo errhandler\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    'Find out what item they just selected\n    Set pf = Target.PivotFields(sField)\n    With pf\n        If .EnableMultiplePageItems Then\n            .ClearAllFilters\n            .EnableMultiplePageItems = False\n            sCurrentPage = \"(All)\"\n        Else:\n            sCurrentPage = .CurrentPage\n        End If\n    End With\n\n    'Change the other slave pivots to match. Slicers will pass on those settings\n    For Each vItem In vArray\n        Set pt = ActiveSheet.PivotTables(vItem)\n        Set pf = pt.PivotFields(sField)\n        With pf\n            If .CurrentPage &lt;&gt; sCurrentPage Then\n                .ClearAllFilters\n                .CurrentPage = sCurrentPage\n            End If\n        End With\n    Next vItem\n\nerrhandler:\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n    End With\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3947, "favorite_count": 0, "accepted_answer_id": 39604425, "answer_count": 2, "score": 2, "last_activity_date": 1550326731, "creation_date": 1474389254, "last_edit_date": 1531164843, "question_id": 39599449, "link": "https://stackoverflow.com/questions/39599449/vba-to-connect-slicers-looking-for-improvements-to-code", "title": "VBA to connect slicers (looking for improvements to code)", "body": "<p>I finally found a code that will connect slicers with different caches on pivot table update. Basically when the value of slicer1 changes, it will change slicer2 to match slicer1 thus updating any pivot table connected to the second slicer.</p>\n\n<p>I've added <code>.Application.ScreenUpdating</code> and <code>.Application.EnableEvents</code> in an attempt to speed up the macro but it's still laggy and causes Excel to become unresponsive.</p>\n\n<p>Is there a more direct way of coding this or are there any potentially volatile lines in here causing Excel to fry it's brain?</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate _\n    (ByVal Target As PivotTable)\nDim wb As Workbook\nDim scShort As SlicerCache\nDim scLong As SlicerCache\nDim siShort As SlicerItem\nDim siLong As SlicerItem\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nOn Error GoTo errHandler\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSet wb = ThisWorkbook\nSet scShort = wb.SlicerCaches(\"Slicer_Department\")\nSet scLong = wb.SlicerCaches(\"Slicer_Department2\")\n\nscLong.ClearManualFilter\n\nFor Each siLong In scLong.VisibleSlicerItems\n    Set siLong = scLong.SlicerItems(siLong.Name)\n    Set siShort = Nothing\n    On Error Resume Next\n    Set siShort = scShort.SlicerItems(siLong.Name)\n    On Error GoTo errHandler\n    If Not siShort Is Nothing Then\n        If siShort.Selected = True Then\n            siLong.Selected = True\n        ElseIf siShort.Selected = False Then\n            siLong.Selected = False\n        End If\n    Else\n        siLong.Selected = False\n    End If\nNext siLong\n\nexitHandler:\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Exit Sub\n\nerrHandler:\n    MsgBox \"Could not update pivot table\"\n    Resume exitHandler\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>original code found on <a href=\"http://www.contextures.com/excelslicersupdatevba.html\" rel=\"nofollow noreferrer\">Contextures</a></p>\n\n<p>Thanks for any advice as always.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39376238/macro-to-change-multiple-slicer-values/39599114#39599114\">link to original inquiry:</a> </p>\n"}, {"tags": ["vba", "sorting", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1474389827, "post_id": 39599419, "comment_id": 66507507, "body": "You need to qualify your key ranges, <code>Key1:=sh.Range(&quot;B1&quot;)</code>, etc."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474389971, "post_id": 39599419, "comment_id": 66507604, "body": "BINGO! And I know I had that in there. I think I backed out some changes, I must&#39;ve gone too far. Thanks! Wish I could give you credit for this as an answer."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1474390170, "post_id": 39599419, "comment_id": 66507734, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/15296400/1004-the-sort-reference-is-not-valid\">&#39;1004&#39;: &quot;The sort reference is not valid.&quot;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1474390265, "post_id": 39599419, "comment_id": 66507794, "body": "FWIW this [<b>very</b>] common mistake is covered by a code inspection in the latest <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> - &quot;Member &#39;Range&#39; implicitly references ActiveSheet&quot; would have popped up."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 3, "creation_date": 1474393260, "post_id": 39599419, "comment_id": 66509387, "body": "Why do you need to sort in Excel? Access SQL can robustly sort and Access VBA can import csv files."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1474400690, "post_id": 39599419, "comment_id": 66513564, "body": "I understand that. Loading the files for one month exceeds 100 megabytes and it&#39;s not in a format for final use. Some of the data have problematic values that get lost when I import, yet don&#39;t trigger an error. Normalizing the data changes it from 5 files into 17 tables at less than half the size of importing just the main file. By processing as Excel I can fix data that needs fixing, purge the data that should be purged, I avoid having to manually handle import errors, I don&#39;t lose any values and I don&#39;t have to delete the imported data when finished."}], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474404466, "creation_date": 1474389140, "last_edit_date": 1495541963, "question_id": 39599419, "link": "https://stackoverflow.com/questions/39599419/access-vba-sort-error-1004-application-defined-or-object-defined-error", "title": "Access VBA Sort: Error 1004, Application-defined or object-defined error", "body": "<p>Note: the solution to this is the same as <a href=\"https://stackoverflow.com/questions/15296400/1004-the-sort-reference-is-not-valid\">&#39;1004&#39;: &quot;The sort reference is not valid.&quot;</a>\nbut should probably be kept because for whatever reason, I received a different error text, so I see other people having potentially the same error but not seeing that the above solution is the same.</p>\n\n<p>I am trying to process 5 related .csv files, with 4 of them needing to be sorted to get the key relationships correct for processing. We're talking a separate set of files for each month, several years of data, so presorting them is not a preferred option. Anyway, I get the above error when I try to sort. My original code called \"sortSheet\" (commented out below, but included after the code), I thought moving it inline might solve the problem but it's not happening, can anyone give me any insight to what's causing this? Here's the current code snippet:</p>\n\n<pre><code>filename = Dir(fullFolder + \"HapDiagnosis.csv\")\nDim wbDiag As Excel.Workbook\nDim shDiag As Excel.Worksheet\nSet wbDiag = xL.Workbooks.Open(fullFolder + filename)\nxOpenDiag = True\nSet shDiag = wbDiag.Sheets(1)\nlastRow = shDiag.Cells(shDiag.Rows.Count, \"A\").End(xlUp).row\n'sortSheet shDiag, \"C\", lastRow\nshDiag.Range(\"A1:C\" + CStr(lastRow)).Select\nSelection.Sort Key1:=Range(\"B1\"), _\n        Key2:=Range(\"A1\"), _\n        Header:=xlYes, _\n        MatchCase:=False\n</code></pre>\n\n<p>I've heard that using \".Select\" is not a good idea, but I got the same error using this subroutine:</p>\n\n<pre><code>Private Sub sortSheet(ByRef sh As Excel.Worksheet, ByVal rightCol As String, _\n                ByVal lastRow As Long)\n  With sh.Range(\"A1:\" + rightCol + CStr(lastRow))\n    .Sort Key1:=Range(\"B1\"), _\n        Order1:=xlAscending, _\n        Key2:=Range(\"A1\"), _\n        Order2:=xlAscending, _\n        Header:=xlYes, _\n        MatchCase:=False, _\n        Orientation:=xlTopToBottom\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "ms-word"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474389166, "post_id": 39599405, "comment_id": 66507104, "body": "It should be <code>&quot;going\\rto&quot;</code> if there is a CR symbol in-between. Or use <code>&quot;going[\\r\\n]*to&quot;</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1474389529, "post_id": 39599405, "comment_id": 66507320, "body": "Are you setting the multiline flag?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474389590, "post_id": 39599405, "comment_id": 66507354, "body": "Multiline flag has nothing to do with matching a linebreak."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1474389926, "post_id": 39599405, "comment_id": 66507578, "body": "It seems that actually the best approach is to use <code>going\\s+on</code> since <code>\\s+</code> matches 1 or more whitespace symbols."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1474393961, "post_id": 39599405, "comment_id": 66509740, "body": "Why are you using word to count the number of matches? seems like you&#39;re going all around the houses to do something quite simple. In any case, <code>\\r\\n</code> (Chr 13) is the standard new line format assuming you&#39;re using a windows PC. Finally, <b>show your code</b> - it could be that the problem is being caused by something else and nothing to do with your pattern"}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 1, "last_activity_date": 1474393764, "creation_date": 1474393764, "answer_id": 39600633, "question_id": 39599405, "link": "https://stackoverflow.com/questions/39599405/vba-regex-matching-over-two-lines/39600633#39600633", "title": "VBA regex matching over two lines", "body": "<p>The best way to match whitespace between two words is <code>\\s+</code>.</p>\n\n<p>It matches 1 or more whitespace symbols.</p>\n\n<p>Here is a sample VBA piece of code printing 3 \"going on\"s that are separated with 1) just a CR, 2) CR+LF, 3) spaces.</p>\n\n<pre><code>Sub MatchStrWithWhitespaces()\nDim rx As RegExp\nDim m As MatchCollection\nDim s As String\n\ns = \"going\" &amp; vbCr + \"to and \" &amp; \"going\" &amp; vbCrLf + \"to and \" &amp; \"going    to and \"\nSet rx = New RegExp\nrx.Global = True\nrx.Pattern = \"going\\s+to\"\nSet m = rx.Execute(s)\nIf m.Count &gt; 0 Then\n  For Each n In m\n    Debug.Print m(0)\n  Next\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6749690, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/47e66be475b356e41eb4f93162e47af1?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas K", "link": "https://stackoverflow.com/users/6749690/andreas-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474418151, "creation_date": 1474389090, "last_edit_date": 1474418151, "question_id": 39599405, "link": "https://stackoverflow.com/questions/39599405/vba-regex-matching-over-two-lines", "title": "VBA regex matching over two lines", "body": "<p>I created a VBA macro, which searches regular expressions in txt documents. You have to input a regular eypression in a cell in an excel spreadsheet and the macro will use Word to count the occurences of the regex in a particular txt document. So far everything works great.</p>\n\n<p>Now I am trying to search for phrases like \"going to\". Which also works fine, as long as it is not spread out over two lines. Potentially, there is a line break between \"going\" and \"to\". So I tried patterns like:</p>\n\n<pre><code>going\\nto\ngoing[\\n]to\ngoing\\rto\ngoing\\sto\n</code></pre>\n\n<p>None of them found \"going to\" spread out over two lines. I also entered it manually in the txt documents and couldn't find it either.</p>\n\n<p>When I only search for <code>\\n</code>. The line breaks between \"going\" and \"to\" are found correctly.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1474389009, "post_id": 39599337, "comment_id": 66507008, "body": "<code>I have tried other macros&#47;solutions posted here with no avail</code> Please post the one that got you the closest and tell us what errors are happening when you run the code.  Post the code in the original post using edit.  Do not use comments to post code."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1474390204, "creation_date": 1474390204, "answer_id": 39599700, "question_id": 39599337, "link": "https://stackoverflow.com/questions/39599337/copy-row-into-new-sheet-when-criteria-met/39599700#39599700", "title": "Copy Row into new sheet when criteria met", "body": "<p>This is a pretty simple VBA routine, but I totally get how tricky it is to wrap your head around this stuff when your first starting out. Below I have an untested subroutine that should get you like 99% of the way there. I made copious comments to help out.</p>\n\n<pre><code>Sub copyWhenCriteriaIsMet()\n    Dim shFrom as worksheet, shTo as worksheet\n    Dim rngReadCell as Range, rngRead as Range\n    Dim intWriteRow as integer\n\n\n    'Change shFrom to the sheet name we are reading and shTo to the sheet we are writing to\n    set shFrom = Sheets(\"Sheet1\")\n    set shTo = Sheets(\"Sheet2\")\n\n    'Change this to fit the range we are reading\n    set rngRead = shFrom.Range(\"GG1:GG5000\")\n\n    'Set the initial row to which we are writing the found data\n    'Inside the For loop below we will increase this by one whenever we write a new line\n    intWriteRow = 1\n\n    'Now loop through each cell in the range using a \"For\" loop\n    For Each rngReadCell in rngRead.Cells\n        'Everything happening between \"For\" and \"Next\" is done over and over again for each cell\n        'We can reference the Cell that is being read as it will be automatically stored in \n        'variable \"rngReadCell\"\n\n        'Use an \"IF\" statement to test if the value in rngReadCell says \"Passed with flying colors\"\n        If rngReadCell.Value = \"Passed with flying colors\" 'note this is case sensitive here in VBA\n            'Everything happening between \"If\" and \"End IF\" only happens if that conditions is true\n\n            'Copy the contents of rngReadCell's Row (between Column A and GH) to the other sheet\n            'There are a few ways to reference this A:GH range, I'm going to use \"RANGE()\" and concatenate\n            'since that's the easier to understand than .offset().resize() or .Row().Range()\n            shFrom.Range(\"A\" &amp; rngReadCell.row &amp; \":GH\" &amp; rngReadCell.row).copy Destination:=shTo.Range(\"A\" &amp; intWriteRow)\n\n            'Now that we wrote that line out, lets increment the intWriteRow variable\n            intWriteRow = intWriteRow + 1\n\n        End IF\n\n        'Nothing else to do here, so this will loop back to the top of the For loop and test the next\n        'rngReadCell.Value\n    Next rngReadRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6854486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0125c793cbc0e2dacc160be407637b?s=128&d=identicon&r=PG&f=1", "display_name": "airjus", "link": "https://stackoverflow.com/users/6854486/airjus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 39599700, "answer_count": 1, "score": -2, "last_activity_date": 1474390204, "creation_date": 1474388856, "last_edit_date": 1531161705, "question_id": 39599337, "link": "https://stackoverflow.com/questions/39599337/copy-row-into-new-sheet-when-criteria-met", "title": "Copy Row into new sheet when criteria met", "body": "<p>I'm trying to find a solution on how to copy rows from one sheet in excel to another when a certain criteria is met. I have tried other macros/solutions posted here with no avail.</p>\n\n<p>The data that I would like to copy into a new sheet is in row GG and is text \"Passed with flying colors\". It is found in a sheet called SchoolEast</p>\n\n<p>I would like for it to copy the entire row from A to GH when this phrase is found in a cell in column GG in the dataset. The target sheet is called PassedFC.</p>\n\n<p>Would love to get some help with this. Please let me know if you need any more information. </p>\n"}, {"tags": ["vb.net", "excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1474388838, "post_id": 39599133, "comment_id": 66506913, "body": "What happens if you replace <code>vTitles</code> with just the range? Also can you try this <code>ws.Range(vTitles).AutoFilter(Nothing, Operator:=Excel.XlAutoFilterOperator.xlFilterValues)</code>"}, {"owner": {"reputation": 312, "user_id": 4496336, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cfa08924ecf4108c3544de8e4dfb574e?s=128&d=identicon&r=PG&f=1", "display_name": "Darw1n34", "link": "https://stackoverflow.com/users/4496336/darw1n34"}, "reply_to_user": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1474389745, "post_id": 39599133, "comment_id": 66507455, "body": "@Zaggler Yes I have, it landed the same error.  I also tried your snippet in its place, and received the same error as well."}, {"owner": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "edited": false, "score": 2, "creation_date": 1474392178, "post_id": 39599133, "comment_id": 66508860, "body": "Looks like something like <code>ws.Range(vTitles).AutoFilter(Field:=1)</code> works."}, {"owner": {"reputation": 312, "user_id": 4496336, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cfa08924ecf4108c3544de8e4dfb574e?s=128&d=identicon&r=PG&f=1", "display_name": "Darw1n34", "link": "https://stackoverflow.com/users/4496336/darw1n34"}, "reply_to_user": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "edited": false, "score": 0, "creation_date": 1474392297, "post_id": 39599133, "comment_id": 66508914, "body": "@JimHewitt that did the trick...I feel a bit dumb now,  Thank you!  Submit that as an answer and I&#39;ll close this."}], "answers": [{"tags": [], "owner": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "is_accepted": true, "score": 5, "last_activity_date": 1474392438, "creation_date": 1474392438, "answer_id": 39600298, "question_id": 39599133, "link": "https://stackoverflow.com/questions/39599133/autofilter-method-of-range-class-failed-in-vb-net/39600298#39600298", "title": "AutoFilter method of Range class failed in VB.NET", "body": "<p>Looks like you need to specify at least one optional parameter.  Try this:</p>\n\n<p><code>ws.Range(vTitles).AutoFilter(Field:=1)</code></p>\n"}], "owner": {"reputation": 312, "user_id": 4496336, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cfa08924ecf4108c3544de8e4dfb574e?s=128&d=identicon&r=PG&f=1", "display_name": "Darw1n34", "link": "https://stackoverflow.com/users/4496336/darw1n34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2008, "favorite_count": 0, "accepted_answer_id": 39600298, "answer_count": 1, "score": 1, "last_activity_date": 1474392438, "creation_date": 1474388250, "question_id": 39599133, "link": "https://stackoverflow.com/questions/39599133/autofilter-method-of-range-class-failed-in-vb-net", "title": "AutoFilter method of Range class failed in VB.NET", "body": "<p>I am trying to use some Parsing i was able to tweak a little.  If I use it in straight VBA in excel, it works fine.  However, when I use the same code as a module in VB.NET I get the error in the title on the line of code </p>\n\n<blockquote>\n  <p>ws.Range(vTitles).AutoFilter()</p>\n</blockquote>\n\n<p>(duh!)  I am not sure what is going wrong in the conversion, since I am not a hardcore VB.Net programmer, so I am doing a lot of googling, but not finding much that works.  Any ideas on how this could be fixed or do I have to abandon the idea of using this snippet in VB.Net?</p>\n\n<p>Here is the code I am using:</p>\n\n<pre><code>'turned strict off or autofilter per     http://www.pcreview.co.uk/threads/autofilter-method-of-range-class-failed.3994483/\nOption Strict Off\nImports xl = Microsoft.Office.Interop.Excel\n\nModule ParseItems\n\nPublic Sub ParseItems(ByRef fileName As String)\n    'Jerry Beaucaire  (4/22/2010)\n    'Based on selected column, data is filtered to individual workbooks are named for the value plus today's date\n    Dim wb As xl.Workbook\n    Dim xlApp As xl.Application\n    Dim LR As Long, Itm As Long, MyCount As Long, vCol As Long\n    Dim ws As xl.Worksheet, MyArr As Object, vTitles As String, SvPath As String\n\n    'Set new application and make wb visible\n    xlApp = New xl.Application\n    xlApp.Visible = True\n\n    'open workbook\n    wb = xlApp.Workbooks.Open(fileName)\n\n\n    'Sheet with data in it\n    ws = wb.Sheets(\"Original Data\")\n\n    'Path to save files into, remember the final \"\\\"\n    SvPath = \"G:\\MC VBA test\\\"\n\n    'Range where titles are across top of data, as string, data MUST have titles in this row, edit to suit your titles locale\n    vTitles = \"A1:L1\"\n\n    'Choose column to evaluate from, column A = 1, B = 2, etc.\n    vCol = xlApp.InputBox(\"What column to split data by? \" &amp; vbLf &amp; vbLf &amp; \"(A=1, B=2, C=3, etc)\", \"Which column?\", 1, Type:=1)\n    If vCol = 0 Then Exit Sub\n\n    'Spot bottom row of data\n    LR = ws.Cells(ws.Rows.Count, vCol).End(xl.XlDirection.xlUp).Row\n\n    'Speed up macro execution\n    'Application.ScreenUpdating = False\n\n    'Get a temporary list of unique values from key column\n    ws.Columns(vCol).AdvancedFilter(Action:=xl.XlFilterAction.xlFilterCopy, CopyToRange:=ws.Range(\"EE1\"), Unique:=True)\n\n    'Sort the temporary list\n    ws.Columns(\"EE:EE\").Sort(Key1:=ws.Range(\"EE2\"), Order1:=xl.XlSortOrder.xlAscending, Header:=xl.XlYesNoGuess.xlYes, _\n       OrderCustom:=1, MatchCase:=False, Orientation:=xl.Constants.xlTopToBottom, DataOption1:=xl.XlSortDataOption.xlSortNormal)\n\n    'Put list into an array for looping (values cannot be the result of formulas, must be constants)\n    MyArr = xlApp.WorksheetFunction.Transpose(ws.Range(\"EE2:EE\" &amp; ws.Rows.Count).SpecialCells(xl.XlCellType.xlCellTypeConstants))\n\n    'clear temporary worksheet list\n    ws.Range(\"EE:EE\").Clear()\n\n    'Turn on the autofilter, one column only is all that is needed\n    ws.Range(vTitles).AutoFilter()\n\n    'Loop through list one value at a time\n    For Itm = 1 To UBound(MyArr)\n        ws.Range(vTitles).AutoFilter(Field:=vCol, Criteria1:=MyArr(Itm))\n\n        ws.Range(\"A1:A\" &amp; LR).EntireRow.Copy()\n        xlApp.Workbooks.Add()\n        ws.Range(\"A1\").PasteSpecial(xl.XlPasteType.xlPasteAll)\n        ws.Cells.Columns.AutoFit()\n        MyCount = MyCount + ws.Range(\"A\" &amp; ws.Rows.Count).End(xl.XlDirection.xlUp).Row - 1\n\n        xlApp.ActiveWorkbook.SaveAs(SvPath &amp; MyArr(Itm), xl.XlFileFormat.xlWorkbookNormal)\n        'ActiveWorkbook.SaveAs SvPath &amp; MyArr(Itm) &amp; Format(Date, \" MM-DD-YY\") &amp; \".xlsx\", 51   'use for Excel 2007+\n        xlApp.ActiveWorkbook.Close(False)\n\n        ws.Range(vTitles).AutoFilter(Field:=vCol)\n    Next Itm\n\n    'Cleanup\n    ws.AutoFilterMode = False\n    MsgBox(\"Rows with data: \" &amp; (LR - 1) &amp; vbLf &amp; \"Rows copied to other sheets: \" &amp; MyCount &amp; vbLf &amp; \"Hope they match!!\")\n    xlApp.Application.ScreenUpdating = True\nEnd Sub\n\n\n\nEnd Module\n</code></pre>\n"}, {"tags": ["excel", "shell", "ms-access", "vba"], "comments": [{"owner": {"reputation": 355, "user_id": 6810625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00e89de0883d8f0f629179cc2150ac6?s=128&d=identicon&r=PG&f=1", "display_name": "Robert F.", "link": "https://stackoverflow.com/users/6810625/robert-f"}, "edited": false, "score": 0, "creation_date": 1474387599, "post_id": 39598837, "comment_id": 66506142, "body": "The MDB file is different in the second command. Is that on purpose?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1474387670, "post_id": 39598837, "comment_id": 66506179, "body": "When you paste the paths into Windows Explorer&#39;s navigation bar, do they take you to the correct folder?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1474388869, "post_id": 39598837, "comment_id": 66506926, "body": "Um. Why don&#39;t you use the <b>full</b> paths instead of these <code>PROGRA~1</code> things? It&#39;s not 1995 anymore. On 64bit Windows there are 2 &quot;Program Files&quot; folders, and <code>C:\\PROGRA~1</code> probably points to the wrong one."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1474389126, "post_id": 39598837, "comment_id": 66507082, "body": "Have you checked that the path and filename that you have entered are correct?  (Use the <code>&#47;X</code> switch with the DOS <code>DIR</code> command to show the short name for non-8dot3 files.)  Or just use the non-8dot3 filenames but wrap each one with double-quotation marks (double double-quotation marks within a literal), So <code>Shell &quot;&quot;&quot;C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\MSAccess.EXE&quot;&quot; &quot;&quot;\\Vs300\\...whatever...MDB&quot;&quot; &#47;X Upload_Manheim&quot;</code>."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1474488787, "post_id": 39598837, "comment_id": 66556755, "body": "@Andre............Thanks........After I posted the question, I did some more research and found a similar post and that was the solution.  Once I put in the full path name, it worked like I was expecting it to...."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1474488846, "post_id": 39598837, "comment_id": 66556801, "body": "@YowE3K.....That is exactly what I ended up doing and it worked for me.  The original code was developed by someone else and I was just following what worked before....."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1474488899, "post_id": 39598837, "comment_id": 66556840, "body": "@ComIntern.........I hadn&#39;t thought of doing that but will definitely keep that in mind for the future...."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1474488946, "post_id": 39598837, "comment_id": 66556870, "body": "@RobertF......Yes....it was done on purpose.  the current production machine has Office 2014 while the test machine has Office 2016...."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5953480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5GyKLX0YIp4/AAAAAAAAAAI/AAAAAAAAWS8/FNd0amluVDw/photo.jpg?sz=128", "display_name": "Erick 3E", "link": "https://stackoverflow.com/users/5953480/erick-3e"}, "edited": false, "score": 0, "creation_date": 1474411035, "post_id": 39604758, "comment_id": 66517957, "body": "dont forget to add a reference to the Access object model!"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1474489055, "post_id": 39604758, "comment_id": 66556940, "body": "@ErickTripleE..........thanks for the suggestion.  I ended up entering the full paths and it worked for me.  I will definitely keep this suggestion in mind for future development,  Thanks for the help...."}], "tags": [], "owner": {"reputation": 115, "user_id": 5953480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5GyKLX0YIp4/AAAAAAAAAAI/AAAAAAAAWS8/FNd0amluVDw/photo.jpg?sz=128", "display_name": "Erick 3E", "link": "https://stackoverflow.com/users/5953480/erick-3e"}, "is_accepted": false, "score": 0, "last_activity_date": 1474410843, "creation_date": 1474410843, "answer_id": 39604758, "question_id": 39598837, "link": "https://stackoverflow.com/questions/39598837/importing-excel-files-into-access-with-excel-2016/39604758#39604758", "title": "Importing Excel files into Access with Excel 2016", "body": "<p>Instead of going thru the command line you could stay inside your Excel Macro and do the same without making reference to the location of the Access application. Instead you can create a new instance of MS Access from within vba, open the Access database the contains the macro, and then run the macro.\nSomething like:</p>\n\n<pre><code>Dim accApp As Access.Application\nDim db As Object\n\nSet accApp = CreateObject(\"Access.Application\")\naccApp.OpenCurrentDatabase \"Your database location\\dbName\", True\n\nSet db = accApp.CurrentDb\nWith db\n    DoCmd.RunMacro \"MacroNameHere\" \nEnd With\n\nSet accApp = Nothing\nSet db = Nothing\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531323258, "creation_date": 1474387345, "last_edit_date": 1531323258, "question_id": 39598837, "link": "https://stackoverflow.com/questions/39598837/importing-excel-files-into-access-with-excel-2016", "title": "Importing Excel files into Access with Excel 2016", "body": "<p>We currently have Office 2010 and are moving to Office 2016.  I have an Excel macro that I am try to testing.  I use the following shell command to open access and run a macro to import some excel files into a database.  This has worked great and never has any issues.</p>\n\n<pre><code>Shell \"C:\\PROGRA~1\\MICROS~1\\Office14\\MSACCESS.EXE \\\\Vs300\\rental_public\\SHARED~1\\SSDATA~2.MDB /X Upload_Manheim\", vbMaximizedFocus\n</code></pre>\n\n<p>When I look for the Access application on my machine the path is as follows:</p>\n\n<pre><code>C:Program Files\\Microsoft Office\\Office14\n</code></pre>\n\n<p>When I search for the Access application on the test machine, the path is as follows:</p>\n\n<pre><code>C:Program Files (x86)\\Microsoft Office\\root\\Office16\n</code></pre>\n\n<p>I've tried modifying the shell command as follows:</p>\n\n<pre><code>Shell \"C:\\PROGRA~1\\MICROS~1\\root\\Office16\\MSACCESS.EXE \\\\Vs300\\rental_public\\OFFICE~1\\SHARED~1\\SSDATA~1.MDB /X Upload_Manheim\", vbMaximizedFocus\n</code></pre>\n\n<p>When I try to run my macro, I'm getting a file not found error message.  I believe the 2nd half of the shell command is fine, so I believe it is the issue is in the 1st half of the shell command.  </p>\n\n<p>The database being opened is an Access 2000 database.  I'm not sure what is wrong.</p>\n"}, {"tags": ["arrays", "string", "vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1474385441, "post_id": 39597999, "comment_id": 66504646, "body": "The first thing that pops to mind is <i>Save As -&gt; CSV</i> - and then read the file into a string if that&#39;s what you need. The question is <i>why</i> would you need a comma-separated list of cell values in a string?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1474386687, "post_id": 39597999, "comment_id": 66505536, "body": "Re your update - you aren&#39;t planning to use this in an INSERT statement are you?  If that&#39;s the case you might want to rethink this and use a parameterized query instead."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1474397411, "post_id": 39597999, "comment_id": 66511653, "body": "Thank you for that hint. @Comintern yes, unfortunately I want to do it that way. I know other solutions like these here: <a href=\"http://www.excel-sql-server.com/\" rel=\"nofollow noreferrer\">excel-sql-server.com</a> However stored procedure with one big parameter - the string - which later on the SQL server is cut to pieces to make inserts is the fastest solution. Much more faster than all solutions from Excel side I know."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475583009, "post_id": 39597999, "comment_id": 66991584, "body": "@PrzemyslawRemin the last character should not be a delimiter.  It will create an empty element.  Your example creates an empty record."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1475589437, "post_id": 39597999, "comment_id": 66996266, "body": "I see the bounty is still open - what haven&#39;t any of the answers done correctly?  What are we missing?"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475603242, "post_id": 39597999, "comment_id": 67005229, "body": "@ThomasInzina My idea was to imitate CSV file which has the return carriage at the end of every line, including the last line. But I accept solutions omitting the EOL delimiter at very end."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475603436, "post_id": 39597999, "comment_id": 67005340, "body": "Gotcha. Just be aware that when you split the values in your query, that you will have to ignore the last row"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1475603689, "post_id": 39597999, "comment_id": 67005474, "body": "I believe that my function will turn out to be the fastest way to build the string, however, I would use ADO Recordset.getString method to build it because of it&#39;s versatility."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475607056, "post_id": 39597999, "comment_id": 67007266, "body": "@ThomasInzina if you mean my query here <a href=\"http://stackoverflow.com/a/39758478/1903793\">stackoverflow.com/a/39758478/1903793</a> I have just corrected presented there stored procedure so it splits correctly both strings (with, and without row delimiter at the very end of string). Thank you for idea of <code>Recordset.getString</code>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1475616337, "post_id": 39597999, "comment_id": 67011974, "body": "@ThomasInzina RE: GetString -- If the macro is running within the workbook, I&#39;m not sure it&#39;s possible to open an ADO connection to the worksheet. If possible, I would suggest opening an external connection to the worksheet from a different environment (another workbook, another VBA environment, WSH) and then calling <code>GetString</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1475616910, "post_id": 39597999, "comment_id": 67012269, "body": "You can query the Activeworkbook.  I&#39;ve experimented before where I joined an Access table, a Worksheet on the ActiveWorkbook and a worksheet on an external Workbook in a single query."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1475619042, "post_id": 39597999, "comment_id": 67013123, "body": "@ZevSpitz <a href=\"https://www.dropbox.com/s/8s5l9wi274yw30a/Turn%20Excel%20range%20into%20VBA%20string.xlsm?dl=0\" rel=\"nofollow noreferrer\">Download Sample Workbook</a> The ADODB.Recordset.GetString took 15 seconds to execute compared to my String Builder function that took 0.98 Seconds.  The Recordset performed the same using early or late binding.  The query itself only took 0.53125 Second(s).  So it took 14.5 seconds for it to build the string.  In my sample file I had the row and column delimiters reversed."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1550279523, "post_id": 39597999, "comment_id": 96223476, "body": "Join() is NOT a worksheet function!"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1474387086, "post_id": 39598502, "comment_id": 66505832, "body": "Just an FYI this UDF mimics TEXTJOIN() somewhat: <a href=\"http://stackoverflow.com/questions/39532189/vlookup-with-multiple-criteria-returning-values-in-one-cell\" title=\"vlookup with multiple criteria returning values in one cell\">stackoverflow.com/questions/39532189/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1474387341, "post_id": 39598502, "comment_id": 66505991, "body": "@ScottCraner - Yeah, I think <code>TextJoin</code> was probably a request that Excel folks got a lot, and they implemented it.  OP - If you don&#39;t have Excel 2016, check the link Scott provided."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 5, "last_activity_date": 1474386386, "creation_date": 1474386386, "answer_id": 39598502, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39598502#39598502", "title": "Turn Excel range into VBA string", "body": "<p>Here's a quick way to test (Note: this will only work with Excel 2016 (or if you have the <code>TextJoin()</code> function).</p>\n\n<p>First, in the empty column D, do <code>=C1&amp;\"@\"</code>, so you get your last column filled with the cell+@</p>\n\n<p>Then, say in cell E1, <code>=TEXTJOIN(\",\",TRUE,A1:C5)</code>\n(Note: <code>TRUE</code> there means to skip blanks. If you have blanks, and want to keep them, change that to <code>FALSE</code>).</p>\n\n<p>THen, on that cell, run</p>\n\n<p><code>=Substitute(E1,\"@,\",\"@\")</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/7V02j.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/7V02j.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Or combine the formulas into one: <code>=SUBSTITUTE(TEXTJOIN(\",\",TRUE,A1:C4),\"@,\",\"@\")</code>.</p>\n\n<p>If you <em>need</em> vba, just throw the formula into a VBA macro and run like that.</p>\n"}, {"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475143714, "post_id": 39599597, "comment_id": 66829242, "body": "This is very elegant short code, The external reference is a big drawback as solution will be used by different users."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 3, "creation_date": 1475176476, "post_id": 39599597, "comment_id": 66850823, "body": "You can eliminate the external reference by using late binding: <code>Dim clip as Object</code> and use <code>Set clip =CreateObject(&quot;New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}&quot;)</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 1, "creation_date": 1475536158, "post_id": 39599597, "comment_id": 66973289, "body": "@PrzemyslawRemin -  Microsoft Forms 2.0 shouldn&#39;t be a problem at all - it automatically gets added any time you insert a UserForm anyway."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1475579310, "post_id": 39599597, "comment_id": 66989301, "body": "@Comintern or an activeX control for that matter"}], "tags": [], "owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "is_accepted": false, "score": 3, "last_activity_date": 1474389832, "creation_date": 1474389832, "answer_id": 39599597, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39599597#39599597", "title": "Turn Excel range into VBA string", "body": "<p>This solution will require either a reference to the Microsoft Forms 2.0 Object Library in your project or some other way of fetching the contents of the clipboard (like through an API call).</p>\n\n<pre><code>Function TurnExcelRangeIntoVBAString(Optional cellDelimiter As String = \",\", _\n                                     Optional rowDelimiter As String = \"@\") _\n         As String\n\n    Dim rng As Range\n    Set rng = ActiveSheet.UsedRange\n    rng.Copy\n\n    Dim clip As New MSForms.DataObject\n    Dim txt As String\n    clip.GetFromClipboard\n    txt = clip.GetText()\n    txt = Replace(Replace(txt, vbTab, cellDelimiter), vbCrLf, rowDelimiter)\n\n    TurnExcelRangeIntoVBAString = txt\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1474700044, "post_id": 39599680, "comment_id": 66647753, "body": "@PrzemyslawRemin, did you get through it?"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475060085, "post_id": 39599680, "comment_id": 66787259, "body": "Yes, thank you. Works good. I also like your idea. Voted up. Your solution would be better if it was a function like the one proposed by Ron Rosenfeld, because it allows to choose exact range."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475071874, "post_id": 39599680, "comment_id": 66796148, "body": "You are welcome. Thanks for upvote. Turning my Sub into a Function is quite straightforward like you can see with Ron solution. Fine that you found the most suited one!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475089160, "post_id": 39599680, "comment_id": 66807274, "body": "Look, it&#39;s not a race between Ron and me. It&#39;s a chance to help you. And the greatest help I myself would appreciate is help me learning. That said, you try switching my Sub into a Function and if you meet problems just make a new post showing your efforts and telling what&#39;s wrong with them."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475092134, "post_id": 39599680, "comment_id": 66808690, "body": "I am grateful for your contribution. I would accept both answers if it was possible. Your solution seems very fast in my tests."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1474390126, "creation_date": 1474390126, "answer_id": 39599680, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39599680#39599680", "title": "Turn Excel range into VBA string", "body": "<p>you could try this</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim strng As String\n    Dim cell As Range\n\n    With Worksheets(\"TurnRangeIntoString\") '&lt;--| change \"TurnRangeIntoString\" to your actual worksheet name\n        For Each cell In Intersect(.UsedRange, .Columns(1)) '&lt;--| loop through its column 1 cells\n            strng = strng &amp; Join(Application.Transpose(Application.Transpose(.Range(cell, cell.End(xlToRight)).value)), \",\") &amp; \"@\" '&lt;--| build string\n        Next cell\n    End With\n    MsgBox strng\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1474396974, "post_id": 39600211, "comment_id": 66511414, "body": "Thanks a lot. That is awesome code. What is the line with <code>Set COL = New Collection</code> for? What is New Collection?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 1, "creation_date": 1474397316, "post_id": 39600211, "comment_id": 66511602, "body": "@PrzemyslawRemin It is a new instance of the Collection object.  The Collection object is used to collect arrays containing the elements of each row, for later <code>Join</code> ing with the appropriate delimiter."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475059835, "post_id": 39600211, "comment_id": 66787074, "body": "Both your solutions does not add EOL at the end, after the final matrix element (<code>$C$5</code>)."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475060864, "post_id": 39600211, "comment_id": 66787810, "body": "@PrzemyslawRemin  If you require that, it is a trivial modification.  See the edit."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475061137, "post_id": 39600211, "comment_id": 66787988, "body": "Why the last EOL didn&#39;t join like its earlier brothers? The Join is the same?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475061284, "post_id": 39600211, "comment_id": 66788116, "body": "@PrzemyslawRemin That is how <code>Join</code> works.  Usually, if you are creating a delimited string, you do NOT want the delimiter after the last substring."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 4, "last_activity_date": 1475060992, "last_edit_date": 1475060992, "creation_date": 1474392047, "answer_id": 39600211, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39600211#39600211", "title": "Turn Excel range into VBA string", "body": "<p>Here is a UDF that returns the desired output:</p>\n\n<p><strong>EDIT</strong> Changed to add EOL at the end.</p>\n\n<pre><code>Option Explicit\nFunction MultiJoin(Rng As Range, Delimiter As String, EOL As String) As String\n    Dim V As Variant, W As Variant\n    Dim COL As Collection\n    Dim I As Long, J As Long\n\nV = Rng\nSet COL = New Collection\nReDim W(1 To UBound(V, 2))\nFor I = 1 To UBound(V, 1)\n    For J = 1 To UBound(V, 2)\n        W(J) = V(I, J)\n    Next J\n    COL.Add W\nNext I\n\nReDim V(1 To COL.Count)\nFor I = 1 To COL.Count\n    V(I) = Join(COL(I), Delimiter)\nNext I\n\nW = Join(V, EOL)\nMultiJoin = W &amp; EOL\n\nEnd Function\n</code></pre>\n\n<p>One could shorten the code by using <code>WorksheetFunction</code>s, but I would guess execution time would be slower.</p>\n\n<p><strong>Shortened Code</strong></p>\n\n<pre><code>Option Explicit\nFunction MultiJoin(Rng As Range, Delimiter As String, EOL As String) As String\n    Dim V As Variant, W As Variant\n    Dim I As Long, J As Long\n\nV = Rng\nWith WorksheetFunction\n\nFor I = 1 To UBound(V, 1)\n    V(I, 1) = Join(.Index(V, I, 0), Delimiter)\nNext I\nMultiJoin = Join(.Transpose(.Index(V, 0, 1)), EOL) &amp; EOL\n\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475579742, "post_id": 39781372, "comment_id": 66989560, "body": "Can you please explain in short the logic of your UDF? What buffering for? How the string is constructed?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475580346, "post_id": 39781372, "comment_id": 66989904, "body": "This article: <a href=\"https://support.microsoft.com/en-us/kb/170964\" rel=\"nofollow noreferrer\">MSDN: How To Improve String Concatenation Performance</a> Every time you concatenate a string a temp memory location is created the first string is copied to being of the temp memory, the second string is copied to the end of the temp memory, the destination string is then resized, the memory is copied from the temp memory to the newly resized memory and the old variables are cleaned up."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475580917, "post_id": 39781372, "comment_id": 66990260, "body": "In my test I am combining 535,563 cells together with another 535,563 delimiters.  Instead of performing 1,071,126 concatenations I create a buffered string large enough to hold all the data.  If my buffer size is too small it will concatenate another very large string.  Reducing the number of concatenations to 2 or 3 at the most. I&#39;m never took computer science but at 6 operations per concatenation this reduces the total number of operations from over 6 million to 535,563 + (6 + 6 + 1) ish."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1475582203, "post_id": 39781372, "comment_id": 66991073, "body": "According to that article it is 100 times faster than concatenating the strings."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1477316752, "post_id": 39781372, "comment_id": 67703347, "body": "I have just noticed two issues with your code. (1) It cannot handle delimiters longer then one character. (2) It skips empty cells. If the cell is empty it should add to string at least column delimiter. Otherwise it leads to catastrophic results. Would you be kind to correct your answer?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1477327842, "post_id": 39781372, "comment_id": 67710559, "body": "@PrzemyslawRemin I just modified my answer to accept multi-character delimiters.  Empty cells were never skipped.  You can test this out by selecting an empty worksheet and running this <code>?getRangeText([A1:F2])</code> in the Immediate Window."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1507816509, "post_id": 39781372, "comment_id": 80369272, "body": "Your code needs further modification to deal with delimiters longer then one character. Instead of &#39;length = length + 1&#39; (first occurrence) should be <code>length = length + Len(rowDelimiter)</code>. In the second occurrence should be <code>length = length + Len(ColumnDelimiter)</code>."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1508333372, "post_id": 39781372, "comment_id": 80569765, "body": "@Thomas Inzina : Great code Thomas, I knew Mid could be used as an left hand operator but your example shows just how mega-powerful this technique can be.  Superb!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1508352439, "post_id": 39781372, "comment_id": 80581579, "body": "Thanks @PrzemyslawRemin.  I made those modifications."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1508352971, "post_id": 39781372, "comment_id": 80581859, "body": "Thanks @SMeaden.  At the time I didn&#39;t know that we could use CreateObject(&quot;System.Text.StringBuilder&quot;).   <a href=\"http://blog.nkadesign.com/2013/access-using-net-strings-in-vba-for-fun-and-profit/\" rel=\"nofollow noreferrer\">Access: using .Net strings in VBA for fun and profit | Cypris&#39; lookout</a> does an excellent job of Wrapping a StringBuilder.  It would be interesting to test my code against an actual StringBuilder."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 7, "last_activity_date": 1508352332, "last_edit_date": 1508352332, "creation_date": 1475190612, "answer_id": 39781372, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39781372#39781372", "title": "Turn Excel range into VBA string", "body": "<p>To optimize performance my function emulates a String Builder.</p>\n\n<p>Variables</p>\n\n<ul>\n<li>Text:  A very large string  to hold the data</li>\n<li>CELLLENGTH: A contant that determines the size of the BufferSize</li>\n<li>BufferSize:  The initial size of Text string</li>\n<li>Data():  An Array derived from the source range</li>\n</ul>\n\n<p>As the rows and columns of the Data() array are iterated over the current element (<code>Data(x, y)</code>) value replaces a portion of the Text string.  The text string is resized as needed. This reduces the number of concatenations immensely.  The initial BufferSize is set pretty high.  I got my best results, 0.8632813 Second(s), by reducing CELLLENGTH to 25.</p>\n\n<p><a href=\"http://www.sample-videos.com/csv/Sample-Spreadsheet-500000-rows.csv\" rel=\"nofollow noreferrer\">Download Sample Data from Sample-Videos.com</a> </p>\n\n<h2>Results</h2>\n\n<p><a href=\"https://i.stack.imgur.com/zUgTP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zUgTP.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Code</h2>\n\n<pre><code>Function getRangeText(Source As Range, Optional rowDelimiter As String = \"@\", Optional ColumnDelimiter As String = \",\")\n    Const CELLLENGTH = 255\n    Dim Data()\n    Dim text As String\n    Dim BufferSize As Double, length As Double, x As Long, y As Long\n    BufferSize = CELLLENGTH * Source.Cells.Count\n    text = Space(BufferSize)\n\n    Data = Source.Value\n\n    For x = 1 To UBound(Data, 1)\n        If x &gt; 1 Then\n            Mid(text, length + 1, Len(rowDelimiter)) = rowDelimiter\n            length = length + Len(rowDelimiter)\n        End If\n\n        For y = 1 To UBound(Data, 2)\n            If length + Len(Data(x, y)) + 2 &gt; Len(text) Then text = text &amp; Space(CDbl(BufferSize / 4))\n            If y &gt; 1 Then\n                Mid(text, length + 1, Len(ColumnDelimiter)) = ColumnDelimiter\n                length = length + Len(ColumnDelimiter))\n            End If\n\n            Mid(text, length + 1, Len(Data(x, y))) = Data(x, y)\n            length = length + Len(Data(x, y))\n        Next\n    Next\n\n    getRangeText = Left(text, length) &amp; rowDelimiter\nEnd Function\n</code></pre>\n\n<h2>Test</h2>\n\n<pre><code>Sub TestGetRangeText()\n    Dim s As String\n    Dim Start: Start = Timer\n\n    s = getRangeText(ActiveSheet.UsedRange)\n\n    Debug.Print \"Execution Time: \"; Timer - Start; \"Second(s)\"\n    Debug.Print \"Rows: \"; ActiveSheet.UsedRange.Rows.Count; \"Columns: \"; ActiveSheet.UsedRange.Columns.Count\n    Debug.Print \"Result Length: \"; Format(Len(s), \"#,###\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 1, "last_activity_date": 1475233314, "creation_date": 1475233314, "answer_id": 39789995, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39789995#39789995", "title": "Turn Excel range into VBA string", "body": "<pre><code>Sub aquatique()\ndim a(),s$,i&amp;,j&amp;:a=selection.value\nfor i=1 to ubound(a)\nfor j=1 to ubound(a,2)\n    if j=1 then\n        if i=1 then\n            s=  a(i,j)\n        else\n            s=s &amp;\"@\" &amp; vbnewline &amp; a(i,j)\n        end if\n    else\n        s=s &amp;\";\" &amp; a(i,j)\n    end if\nnext\nnext\nend sub\n</code></pre>\n\n<p>simple but does the job. Slow on huge ranges, you'd need to use \"join\"</p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1475570136, "creation_date": 1475570136, "answer_id": 39847704, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string/39847704#39847704", "title": "Turn Excel range into VBA string", "body": "<p>How about this?:</p>\n\n<pre><code>Sub Concatenate()\nDim Cel As Range, Rng As Range\nDim sString As String, r As Long, c As Long, r2 As Long\n\nSet Rng = Selection\nr = Selection.Row\nc = Selection.Column\nr2 = Selection.Row\nFor Each Cel In Rng\n    r = Cel.Row\n    If sString = \"\" Then\n        sString = Cel.Value\n        Else\n            If r &lt;&gt; r2 Then sString = sString &amp; \"@\" &amp; Cel.Value\n            If r = r2 Then sString = sString &amp; \",\" &amp; Cel.Value\n    End If\n    r2 = Cel.Row\nNext\n\nsString = sString &amp; \"@\"\nDebug.Print sString\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5609, "favorite_count": 3, "protected_date": 1475677858, "accepted_answer_id": 39781372, "answer_count": 7, "score": 7, "last_activity_date": 1508352332, "creation_date": 1474385014, "last_edit_date": 1495535552, "question_id": 39597999, "link": "https://stackoverflow.com/questions/39597999/turn-excel-range-into-vba-string", "title": "Turn Excel range into VBA string", "body": "<p>I would like to turn values in given range into VBA string where original cell values are separated by any chosen column delimiter and row delimiter. Delimiters could be one character or longer strings. The row delimiter is the string at the end of the line. The string should be done just as we read text from left top corner, from left to right, to bottom right corner.</p>\n\n<p>Here is an example of the VALUES in range A1:C5:</p>\n\n<pre><code>+----+----+----+\n| A1 | B1 | C1 |\n+----+----+----+\n| A2 | B2 | C2 |\n+----+----+----+\n| A3 | B3 | C3 |\n+----+----+----+\n| A4 | B4 | C4 |\n+----+----+----+\n| A5 | B5 | C5 |\n+----+----+----+\n</code></pre>\n\n<p>Desired results is a VBA string:</p>\n\n<pre><code>A1,B1,C1@$A$2,$B$2,$C$2@A3,B3,C3@A4,B4,C4@A5,B5,C5@\n</code></pre>\n\n<p>For the sake of readability I will show it like this:</p>\n\n<pre><code>A1,B1,C1@\nA2,B2,C2@\nA3,B3,C3@\nA4,B4,C4@\nA5,B5,C5@\n</code></pre>\n\n<p>As a column delimiter I have chosen <code>,</code> (comma), and as a row delimiter <code>@</code> sign. Of course these could be any characters like <code>\\r\\n</code>.</p>\n\n<p>The reason why I want fast cooking of the string from range is because I want to to send it to SQL Server through ADO connection. As I have tested so far it is the fastest way to transfer lots of data on the fly. The twin question how to split this string on SQL Server is here: <a href=\"https://stackoverflow.com/questions/39752188/split-string-into-table-given-row-delimiter-and-column-delimiter-in-sql-server\">Split string into table given row delimiter and column delimiter in SQL server</a> </p>\n\n<p><strong>Solution 1.</strong> Loop through all rows and columns. Question is if there be any more elegant way then just looping through all rows and columns? I would prefer VBA solution, not formula one. </p>\n\n<p><strong>Solution 2.</strong> Suggested by Mat's Mug in comment. CSV file is desired results. I would like to do it on the fly without saving. But good point - imitate CSV is what I want but I want it without saving. </p>\n\n<p><strong>Edit after bounty</strong></p>\n\n<p>Answer of Thomas Inzina works crazy fast and his solution is portable. Ordinary VBA loop turned out to be way faster then worksheet functions like JOIN on large data sets. I do not recommend using worksheet functions in VBA for that purpose. I have voted up everybody. Thank you all.</p>\n"}]