[{"tags": ["vba", "excel", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 2, "last_activity_date": 1441236745, "last_edit_date": 1525816098, "creation_date": 1441236745, "answer_id": 32364776, "question_id": 32364397, "link": "https://stackoverflow.com/questions/32364397/place-a-formula-in-every-cell-in-column-n-for-which-there-is-a-value-two-columns/32364776#32364776", "title": "Place a formula in every cell in column N for which there is a value two columns to the left", "body": "<p>Maybe try:  </p>\n\n<pre><code>Sub KeepOnlyAtSymbolRows()\nDim rng2 As Range\nDim LASTROW2 As Long\n    LASTROW2 = Range(\"L\" &amp; Rows.Count).End(xlUp).Row\n    Set rng2 = Range(\"N1:N\" &amp; LASTROW2)\n    For Each cell In rng2\n        If cell.Offset(0, -2) &lt;&gt; \"\" Then\n        cell.Formula = \"foo bar etc\"\n        End If\n     Next cell\nEnd Sub  \n</code></pre>\n\n<p>You seem not to be applying <code>rng1</code> nor <code>lastRow</code> and not setting the <code>ws</code> value anyway. And if you were and wanted to dimension as Range/Long then in VBA you need to <a href=\"http://www.cpearson.com/excel/declaringvariables.aspx\" rel=\"nofollow noreferrer\">Pay Attention To Variables Declared With One Dim Statement</a>.  </p>\n\n<p>You are trying to set <code>rng2</code> with syntax that would give something like <code>L29</code> if <code>9</code> is your last occupied row in ColumnL.</p>\n\n<p>Since I think it is ColumnN you want to populate I think <code>rng2</code> should be based on that, even if using ColumnL to determine the last populated row.</p>\n\n<p>It seems you want a conditional (<code>&lt;&gt; \"\"</code> is interpreted as \"not blank\") and <code>.offset</code> needs parameters (<code>(0,-2)</code> is interpreted as \"same row, two columns to the left\").  </p>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32364776, "answer_count": 1, "score": 2, "last_activity_date": 1462522450, "creation_date": 1441234159, "last_edit_date": 1462522450, "question_id": 32364397, "link": "https://stackoverflow.com/questions/32364397/place-a-formula-in-every-cell-in-column-n-for-which-there-is-a-value-two-columns", "title": "Place a formula in every cell in column N for which there is a value two columns to the left", "body": "<p>How do I place a formula in every cell in column N for which there is a value two columns to the left (in column L)?   </p>\n\n<pre><code> Sub KeepOnlyAtSymbolRows()\n        Dim ws As Worksheet\n        Dim rng1, rng2 As Range\n        Dim lastRow, LASTROW2 As Long\n\n    LASTROW2 = ws.Range(\"L\" &amp; ws.Rows.Count).End(xlUp).Row\n         Set rng2 = ws.Range(\"L2\" &amp; LASTROW2)\n         'Debug.Print rng2\n         For Each cell In rng2\n            cell.offset()\n            cell.Formula = \"foo bar etc\"\n            Next cell\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1441233479, "post_id": 32364185, "comment_id": 52601000, "body": "These elements have no such IDs."}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 1, "last_activity_date": 1441234471, "creation_date": 1441234471, "answer_id": 32364462, "question_id": 32364185, "link": "https://stackoverflow.com/questions/32364185/excel-vba-login-to-ie-site/32364462#32364462", "title": "Excel VBA Login to IE Site", "body": "<p>As there are no HTML elements with IDs \"username\", \"password\" and \"login_go\", the <code>Value</code> of null cannot be set.</p>\n\n<p>If the structure of the document remains the same all the time, you may access these elements with indices:</p>\n\n<pre><code>IE.Document.getElementsByTagName(\"input\")(3).Value = \"xxxxxx\"     \nIE.Document.getElementsByTagName(\"input\")(8).Value = \"xxxxxx\"\n...\nIE.Document.getElementsByTagName(\"form\")(1).Submit\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1441234478, "creation_date": 1441234478, "answer_id": 32364465, "question_id": 32364185, "link": "https://stackoverflow.com/questions/32364185/excel-vba-login-to-ie-site/32364465#32364465", "title": "Excel VBA Login to IE Site", "body": "<p>You are attempting to use the HTML input element's <em>name</em> as its <em>id</em> The two are not necessarily the same although sometimes you will see.</p>\n\n<pre><code>&lt;input type=\"text\" id=\"username\" name=\"username\" value=\"\" size=\"10\" class=\"s2\" maxlength=\"63 \"&gt;\n</code></pre>\n\n<p>But that is not he case here. You need to treat the elements by theor names and not ids.</p>\n\n<pre><code>dim n as long  'this belongs at hte top witrh the other Dims\n\n'Input the userid and password\nFor n = 0 To ie.document.getelementsbytagname(\"input\").Length - 1\n    With ie.document.getelementsbytagname(\"input\")(n)\n        Select Case LCase(.Name)\n            Case \"username\"\n                .Value = \"xxxxxx\"\n            Case \"password\"\n                .Value = \"zzzzzz\"\n            Case \"login_go\"\n                .Click\n                n = 99999\n            Case Else\n                'ignore\n        End Select\n    End With\nNext n\nDo While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n</code></pre>\n\n<p>The click works in this case because the submit comes after the input elements named <em>username</em> and <em>password</em>.</p>\n"}], "owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 4, "accepted_answer_id": 32364465, "answer_count": 2, "score": 3, "last_activity_date": 1441234478, "creation_date": 1441232953, "question_id": 32364185, "link": "https://stackoverflow.com/questions/32364185/excel-vba-login-to-ie-site", "title": "Excel VBA Login to IE Site", "body": "<p>I am a VBA novice and new to Stack Overflow, even though I have been reading posts on here for a while.  I have searched a lot for an answer to my coding problem, but I can't seem to find the answer. I am trying to login to a website, navigate to a page, and then scrape data from that page.  I have started to build the code which I have parsed together from what I've found on the internet.  I can't seem to get IE to even put my credentials in the appropriate user and PW boxes after looking up their IDs using \"get elements\".  What I end up with is Run Time Error 424 - Object Required.  Thanks in advance for any help.</p>\n\n<pre><code>'Open IE, navigate to the desired page and loop until fully loaded\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    site = \"https://www.ivolatility.com/login.j\"\n\n    With IE\n        .Visible = True\n        .navigate site\n    Do Until Not IE.Busy And IE.readyState = 4\n        DoEvents\n    Loop\n\n    End With\n\n'Input the userid and password\n    IE.Document.getElementById(\"username\").Value = \"xxxxxx\"\n    IE.Document.getElementById(\"password\").Value = \"xxxxxx\"\n\n'Click the \"Search\" button\n    IE.Document.getElementById(\"login_go\").Click\n\n    Do Until Not IE.Busy And IE.readyState = 4\n        DoEvents\n    Loop\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1441232884, "post_id": 32364098, "comment_id": 52600822, "body": "Look at <code>DateDiff</code> <a href=\"http://www.techonthenet.com/access/functions/date/datediff.php\" rel=\"nofollow noreferrer\">Here</a> Should do what you want"}], "answers": [{"tags": [], "owner": {"reputation": 1263, "user_id": 719554, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea46f3685910390d7d5e80f734d7d1a6?s=128&d=identicon&r=PG", "display_name": "Gacci", "link": "https://stackoverflow.com/users/719554/gacci"}, "is_accepted": false, "score": 0, "last_activity_date": 1441242935, "creation_date": 1441242935, "answer_id": 32365530, "question_id": 32364098, "link": "https://stackoverflow.com/questions/32364098/how-can-i-find-the-age-of-a-person-from-a-query-based-on-a-given-date/32365530#32365530", "title": "How can I find the age of a person from a query based on a given date?", "body": "<p>UNIX_TIMESTAMP(NOW()) - UNIX_TIMESTAMP(date_in_table) gives you the difference in seconds. Now just convert to years.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4993935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90952c4a945e1e3b2687a564cd22a530?s=128&d=identicon&r=PG&f=1", "display_name": "J.Hartslief", "link": "https://stackoverflow.com/users/4993935/j-hartslief"}, "is_accepted": false, "score": 0, "last_activity_date": 1441267889, "last_edit_date": 1441267889, "creation_date": 1441266473, "answer_id": 32369845, "question_id": 32364098, "link": "https://stackoverflow.com/questions/32364098/how-can-i-find-the-age-of-a-person-from-a-query-based-on-a-given-date/32369845#32369845", "title": "How can I find the age of a person from a query based on a given date?", "body": "<p>You can use a Expression in the Control source of a textbox on a form\nCurrent Date: 01/01/2015</p>\n\n<pre><code>Table1:\n|Birth_Date |\n|01/01/1995 | = 20\n|01/01/1994 | = 21\n</code></pre>\n\n<p>Expression:\n    =DateDiff(\"yyyy\",[BirthDate],Date())</p>\n\n<p>The age will update every time you open the form</p>\n\n<p>or </p>\n\n<p>VBA(will need a button)</p>\n\n<pre><code>Sub Bottun1_Click()\n\nMe.MyTextBox = DateDiff(\"yyyy\", Me.BirthDate, Date)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1441273748, "creation_date": 1441273748, "answer_id": 32372314, "question_id": 32364098, "link": "https://stackoverflow.com/questions/32364098/how-can-i-find-the-age-of-a-person-from-a-query-based-on-a-given-date/32372314#32372314", "title": "How can I find the age of a person from a query based on a given date?", "body": "<p>DateDiff only returns the difference in calendar years.</p>\n\n<p>For a true age as of today, use a function like this:</p>\n\n<pre><code>Public Function AgeSimple( _\n  ByVal datDateOfBirth As Date) _\n  As Integer\n\n' Returns the difference in full years from datDateOfBirth to current date.\n'\n' Calculates correctly for:\n'   leap years\n'   dates of 29. February\n'   date/time values with embedded time values\n'\n' DateAdd() is used for check for month end of February as it correctly\n' returns Feb. 28. when adding a count of years to dates of Feb. 29.\n' when the resulting year is a common year.\n' After an idea of Markus G. Fischer.\n'\n' 2007-06-26. Cactus Data ApS, CPH.\n\n  Dim datToday  As Date\n  Dim intAge    As Integer\n  Dim intYears  As Integer\n\n  datToday = Date\n  ' Find difference in calendar years.\n  intYears = DateDiff(\"yyyy\", datDateOfBirth, datToday)\n  If intYears &gt; 0 Then\n    ' Decrease by 1 if current date is earlier than birthday of current year\n    ' using DateDiff to ignore a time portion of datDateOfBirth.\n    intAge = intYears - Abs(DateDiff(\"d\", datToday, DateAdd(\"yyyy\", intYears, datDateOfBirth)) &gt; 0)\n  End If\n\n  AgeSimple = intAge\n\nEnd Function\n</code></pre>\n\n<p>For any combo of dates, use this function:</p>\n\n<pre><code>Public Function Years( _\n  ByVal datDate1 As Date, _\n  ByVal datDate2 As Date, _\n  Optional ByVal booLinear As Boolean) _\n  As Integer\n\n' Returns the difference in full years between datDate1 and datDate2.\n'\n' Calculates correctly for:\n'   negative differences\n'   leap years\n'   dates of 29. February\n'   date/time values with embedded time values\n'   negative date/time values (prior to 1899-12-29)\n'\n' Optionally returns negative counts rounded down to provide a\n' linear sequence of year counts.\n' For a given datDate1, if datDate2 is decreased step wise one year from\n' returning a positive count to returning a negative count, one or two\n' occurrences of count zero will be returned.\n' If booLinear is False, the sequence will be:\n'   3, 2, 1, 0,  0, -1, -2\n' If booLinear is True, the sequence will be:\n'   3, 2, 1, 0, -1, -2, -3\n'\n' If booLinear is False, reversing datDate1 and datDate2 will return\n' results of same absolute Value, only the sign will change.\n' This behaviour mimics that of Fix().\n' If booLinear is True, reversing datDate1 and datDate2 will return\n' results where the negative count is offset by -1.\n' This behaviour mimics that of Int().\n\n' DateAdd() is used for check for month end of February as it correctly\n' returns Feb. 28. when adding a count of years to dates of Feb. 29.\n' when the resulting year is a common year.\n'\n' 2000-11-03. Cactus Data ApS, CPH.\n' 2000-12-16. Leap year correction modified to be symmetrical.\n'             Calculation of intDaysDiff simplified.\n'             Renamed from YearsDiff() to Years().\n' 2000-12-18. Introduced cbytMonthDaysMax.\n' 2007-06-22. Version 2. Complete rewrite.\n'             Check for month end of February performed with DateAdd()\n'             after idea of Markus G. Fischer.\n\n  Dim intDiff   As Integer\n  Dim intSign   As Integer\n  Dim intYears  As Integer\n\n  ' Find difference in calendar years.\n  intYears = DateDiff(\"yyyy\", datDate1, datDate2)\n  ' For positive resp. negative intervals, check if the second date\n  ' falls before, on, or after the crossing date for a full 12 months period\n  ' while at the same time correcting for February 29. of leap years.\n  If DateDiff(\"d\", datDate1, datDate2) &gt; 0 Then\n    intSign = Sgn(DateDiff(\"d\", DateAdd(\"yyyy\", intYears, datDate1), datDate2))\n    intDiff = Abs(intSign &lt; 0)\n  Else\n    intSign = Sgn(DateDiff(\"d\", DateAdd(\"yyyy\", -intYears, datDate2), datDate1))\n    If intSign &lt;&gt; 0 Then\n      ' Offset negative count of years to continuous sequence if requested.\n      intDiff = Abs(booLinear)\n    End If\n    intDiff = intDiff - Abs(intSign &lt; 0)\n  End If\n\n  ' Return count of years as count of full 12 months periods.\n  Years = intYears - intDiff\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5294493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b57c6215ec2996c8db459f8837c855b?s=128&d=identicon&r=PG&f=1", "display_name": "Declan", "link": "https://stackoverflow.com/users/5294493/declan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594643743, "creation_date": 1441232527, "last_edit_date": 1594643743, "question_id": 32364098, "link": "https://stackoverflow.com/questions/32364098/how-can-i-find-the-age-of-a-person-from-a-query-based-on-a-given-date", "title": "How can I find the age of a person from a query based on a given date?", "body": "<p>How can I find the age of a person from a query on a given date from the date of birth. </p>\n\n<p>I want to run a query that will return the age of everyone in a table, on any date of the following year calculated from their date of birth. </p>\n\n<p>I want to return the age in years they will be, say on the 01/09(September) of the next year.</p>\n\n<p>Todays date is 02/09/2015</p>\n\n<p>If the date of birth is 09/10/2006 the answer is 9</p>\n\n<p>If the date of birth is 28/01/2006 the answer is 10</p>\n\n<p>Any ideas?? Anyone?</p>\n"}, {"tags": ["vba", "excel", "formula"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1441228337, "post_id": 32363105, "comment_id": 52599058, "body": "Please specify what is the sheet and column of &quot;the cell with the formula&quot;."}, {"owner": {"reputation": 6778, "user_id": 2573244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0879cced934d7c3b466af0b59b59cc6b?s=128&d=identicon&r=PG", "display_name": "Clarkie", "link": "https://stackoverflow.com/users/2573244/clarkie"}, "edited": false, "score": 0, "creation_date": 1441228392, "post_id": 32363105, "comment_id": 52599083, "body": "Can you show some examples of what you have tried?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1441229082, "post_id": 32363105, "comment_id": 52599378, "body": "From your description <code>VLOOKUP()</code> will do what you need."}, {"owner": {"reputation": 23, "user_id": 5294303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oNCXIalDQG0/AAAAAAAAAAI/AAAAAAAAACk/NCgdIOIS70M/photo.jpg?sz=128", "display_name": "Steve L.", "link": "https://stackoverflow.com/users/5294303/steve-l"}, "edited": false, "score": 0, "creation_date": 1441230644, "post_id": 32363105, "comment_id": 52600047, "body": "The cell with the formula will be on sheet 1."}, {"owner": {"reputation": 23, "user_id": 5294303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oNCXIalDQG0/AAAAAAAAAAI/AAAAAAAAACk/NCgdIOIS70M/photo.jpg?sz=128", "display_name": "Steve L.", "link": "https://stackoverflow.com/users/5294303/steve-l"}, "edited": false, "score": 0, "creation_date": 1441230950, "post_id": 32363105, "comment_id": 52600160, "body": "column C will be where the formula goes"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5294303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oNCXIalDQG0/AAAAAAAAAAI/AAAAAAAAACk/NCgdIOIS70M/photo.jpg?sz=128", "display_name": "Steve L.", "link": "https://stackoverflow.com/users/5294303/steve-l"}, "edited": false, "score": 0, "creation_date": 1441232302, "post_id": 32363937, "comment_id": 52600619, "body": "whoa! thanks, that worked perfectly!! thank you so much, I really appreciate your help!"}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 0, "last_activity_date": 1441231605, "creation_date": 1441231605, "answer_id": 32363937, "question_id": 32363105, "link": "https://stackoverflow.com/questions/32363105/update-parts-list-with-new-descriptions-in-excel/32363937#32363937", "title": "Update parts list with new descriptions in excel", "body": "<p>Consider the example below:</p>\n\n<pre><code>Sub PopulateDescriptions()\n    Dim objList As Object\n    Dim objSrc As Range\n    Dim objDst As Range\n    Dim arrList() As Variant\n    Dim arrDesc() As Variant\n    Dim i As Long\n\n    Set objList = CreateObject(\"Scripting.Dictionary\")\n    With Sheets(\"Sheet 2\")\n        arrList = Intersect(.UsedRange, .Range(\"A:B\")).Value\n    End With\n    For i = 1 To UBound(arrList, 1)\n        objList(arrList(i, 1)) = arrList(i, 2)\n    Next\n\n    With Sheets(\"Sheet 1\")\n        Set objSrc = Intersect(.UsedRange.Rows, .Range(\"A:A\"))\n    End With\n    Set objDst = objSrc.Offset(0, 2) ' column C\n    arrList = objSrc.Value\n    arrDesc = objDst.Value\n    For i = 1 To UBound(arrList, 1)\n        If objList.Exists(arrList(i, 1)) Then\n            arrDesc(i, 1) = objList(arrList(i, 1))\n        End If\n    Next\n    objDst.Value = arrDesc\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5294303, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oNCXIalDQG0/AAAAAAAAAAI/AAAAAAAAACk/NCgdIOIS70M/photo.jpg?sz=128", "display_name": "Steve L.", "link": "https://stackoverflow.com/users/5294303/steve-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 32363937, "answer_count": 1, "score": 1, "last_activity_date": 1441231605, "creation_date": 1441227998, "last_edit_date": 1441230593, "question_id": 32363105, "link": "https://stackoverflow.com/questions/32363105/update-parts-list-with-new-descriptions-in-excel", "title": "Update parts list with new descriptions in excel", "body": "<p>Ive got two sheets. Each with about 20k part numbers, and I need to grab the part number from Sheet 1 col. B, check to see if it exists anywhere in Sheet 2 col.A, if it does then grab the contents of Sheet 2 col. B of that row, and paste it into the cell with the formula. the part numbers list doesn't match up 100% so I cant simply sort and copy/paste.</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 9, "user_id": 3877581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssNfX.jpg?s=128&g=1", "display_name": "IT Minion", "link": "https://stackoverflow.com/users/3877581/it-minion"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1441227600, "post_id": 32362828, "comment_id": 52598720, "body": "I do hide the Excel file right after setting the object using xl.Visible = False."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441232082, "post_id": 32362828, "comment_id": 52600550, "body": "Any hidden Excel instances visible in Task Manager?"}, {"owner": {"reputation": 9, "user_id": 3877581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssNfX.jpg?s=128&g=1", "display_name": "IT Minion", "link": "https://stackoverflow.com/users/3877581/it-minion"}, "edited": false, "score": 0, "creation_date": 1441233795, "post_id": 32362828, "comment_id": 52601090, "body": "No extra instances of Excel are visible in the Task Manager. I should add that this is a multi-user (100+ users) database. I realize that Access was not made for this kind of use. We are in the process of migrating this database over to MySQL, but in the meantime we need this to be working correctly."}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "edited": false, "score": 0, "creation_date": 1441240769, "post_id": 32362828, "comment_id": 52602918, "body": "I know this sounds simple and that you have tried several methods independently, but did you try minimizing the access window, setting xl visible , activating the xl workbook , and then maximizing the excel window ? sometimes xl hangs and performing another action like maximizing will get it to appear."}, {"owner": {"reputation": 9, "user_id": 3877581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssNfX.jpg?s=128&g=1", "display_name": "IT Minion", "link": "https://stackoverflow.com/users/3877581/it-minion"}, "edited": false, "score": 0, "creation_date": 1441299508, "post_id": 32362828, "comment_id": 52633339, "body": "Just did try that... I added &quot;xl.WindowState = xlNormal&quot; right after my &quot;xl.Visible = True&quot; statement. The code will work until I close out of my database and reopen it or try to create the ACCDE, then the code fails again."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 3877581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssNfX.jpg?s=128&g=1", "display_name": "IT Minion", "link": "https://stackoverflow.com/users/3877581/it-minion"}, "edited": false, "score": 0, "creation_date": 1441723339, "post_id": 32460691, "comment_id": 52783411, "body": "&#39;code&#39; xl.Visible = True xl.WindowState = xlMaximized &lt;--- optional statement AppActivate &quot;Microsoft Excel&quot;"}], "tags": [], "owner": {"reputation": 9, "user_id": 3877581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssNfX.jpg?s=128&g=1", "display_name": "IT Minion", "link": "https://stackoverflow.com/users/3877581/it-minion"}, "is_accepted": false, "score": 0, "last_activity_date": 1441723283, "creation_date": 1441723283, "answer_id": 32460691, "question_id": 32362828, "link": "https://stackoverflow.com/questions/32362828/application-visible-true-does-not-work/32460691#32460691", "title": "application.visible = true Does Not Work", "body": "<p>I was able to get this done by doing the following:</p>\n\n<p>xl.Visible = True\nxl.WindowState = xlMaximized &lt;--- optional statement\nAppActivate \"Microsoft Excel\"</p>\n\n<p>Thank you everyone for your responses. Hopefully this will save someone from the major headache that I had.</p>\n"}], "owner": {"reputation": 9, "user_id": 3877581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssNfX.jpg?s=128&g=1", "display_name": "IT Minion", "link": "https://stackoverflow.com/users/3877581/it-minion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2779, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1441723283, "creation_date": 1441226875, "last_edit_date": 1531161705, "question_id": 32362828, "link": "https://stackoverflow.com/questions/32362828/application-visible-true-does-not-work", "title": "application.visible = true Does Not Work", "body": "<p>I need some help. I have an Access 2007 database that creates an Excel file. I do hide the Excel file in the beginning using xl.Visible = True... I can make a code change and it will work while I have Access open, but as soon as I close Access and re-open the same database the code does not work anymore. I know my code is working because I had used message boxes around the code and those were firing. It is essential for the Excel file to be showing on top of the Access database.</p>\n\n<p>I have tried ActivateMicrosoftApp, ActiveWindow, GoTo, and WindowState... All have no effect...</p>\n\n<p>We are using Access 2007 on a Windows Server 2012 R2 server. Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5312968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9433b56a004713d1881ba53ed220f038?s=128&d=identicon&r=PG&f=1", "display_name": "Goergie158", "link": "https://stackoverflow.com/users/5312968/goergie158"}, "is_accepted": false, "score": 0, "last_activity_date": 1441870844, "creation_date": 1441870844, "answer_id": 32495920, "question_id": 32362823, "link": "https://stackoverflow.com/questions/32362823/visio-button-to-compare-text-in-excel-file-error-438/32495920#32495920", "title": "Visio button to compare text in excel file; error 438", "body": "<p>I think you're just missing as 's' in XLApp.WorkbookS.Open(\"C:\\printers\\schprint.xlsx\")\nThat should fix the problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 5215463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03f64093aabbf42cedfc4b157b0afd8?s=128&d=identicon&r=PG&f=1", "display_name": "George Tibbs", "link": "https://stackoverflow.com/users/5215463/george-tibbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441870844, "creation_date": 1441226854, "question_id": 32362823, "link": "https://stackoverflow.com/questions/32362823/visio-button-to-compare-text-in-excel-file-error-438", "title": "Visio button to compare text in excel file; error 438", "body": "<p>I am trying to make a visio diagram that you click a button and it searchs and excel file for the \"location\" once it find the location in the excel file it then copies over a URL and proceeds to open that URL with the default browser. I keep getting runtime error 438: Object doesn't support this property or method. Any ideas?</p>\n\n<pre><code>Option Compare Text\n\nPrivate Sub Mail_Room_Click()\n\n\nDim XLApp As Excel.Application\nDim XLWB As Excel.Workbook\n\nSet XLApp = New Excel.Application\nSet XLWB = XLApp.Workbook.Open(\"C:\\printers\\schprint.xlsx\")\nSet XLWsht = XLWB.Sheets(1)\n\nDim URL As String\nDim Location As String\nLocation = \"Mail Room\"\nURL = \"\"\n\nFor Each i In XLWsht.Range(\"D2:D11\")\nIf StrComp(i.Cells.Value, Location) = 0 Then\n    URL = i.Cells.Offset(7, 0).Value\n    Exit For\n    End If\n    Next i\n\n\nCreateObject(\"WScript.Shell\").Run (URL)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "prompt", "inputbox"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 1, "creation_date": 1441228638, "post_id": 32362821, "comment_id": 52599187, "body": "I have tried to do this with <code>Application.EnableEvents = False</code> but then when I re-open the document <b>none</b> of my macros execute.  I believe this only happens when I close the individual Workbook, and not the entire Excel instance, but I wanted to know if there is a better solution."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1441226845, "creation_date": 1441226845, "answer_id": 32362821, "question_id": 32362754, "link": "https://stackoverflow.com/questions/32362754/vba-inputbox-prompts-twice/32362821#32362821", "title": "VBA InputBox Prompts Twice", "body": "<p>Disable Events before the Close.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 0, "creation_date": 1441292012, "post_id": 32365585, "comment_id": 52628611, "body": "Thank you for the suggestion!  I didn&#39;t think to include the <code>.Saved</code> portion beforehand."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 0, "last_activity_date": 1441243401, "creation_date": 1441243401, "answer_id": 32365585, "question_id": 32362754, "link": "https://stackoverflow.com/questions/32362754/vba-inputbox-prompts-twice/32365585#32365585", "title": "VBA InputBox Prompts Twice", "body": "<p>If you code it like this:</p>\n\n<ul>\n<li>the code simply proceeds to save the workbook if the password is correctly without a second close</li>\n<li>The <code>ThisWorkbook.Saved</code> at front tells Excel the workbook is fully updated so there wont be a <em>do you want to save</em> message - ie it does the same task as the <code>False</code> part of <code>ThisWorkbook.Close SaveChanges:=False</code> and the existing Save event closes the workbook.</li>\n</ul>\n\n<p><em>recut</em> </p>\n\n<pre><code>Sub Workbook_BeforeClose(Cancel As Boolean)\n\nThisWorkbook.Saved = True\nIf InputBox(\"Please enter the password to close the workbook.\") &lt;&gt; \"pa55word\" Then\n     MsgBox (\"Incorrect password.  Please try again\")\n     Cancel = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 32365585, "answer_count": 2, "score": 1, "last_activity_date": 1441243401, "creation_date": 1441226634, "question_id": 32362754, "link": "https://stackoverflow.com/questions/32362754/vba-inputbox-prompts-twice", "title": "VBA InputBox Prompts Twice", "body": "<p>I have a simple script to require a <em>password</em> before closing a workbook (to prevent accidental closing), but the <code>InputBox</code> re-opens if I enter the correct keyword.  I have created multiple iterations of the below script, but I cannot resolve it.</p>\n\n<pre><code>Sub Workbook_BeforeClose(Cancel As Boolean)\n\nIf InputBox(\"Please enter the password to close the workbook.\") &lt;&gt; \"pa55word\" Then\n    MsgBox (\"Incorrect password.  Please try again\")\n    Cancel = True\n    Exit Sub\nElse\n    GoTo GoToClose\nEnd If\n\nGoToClose:\nThisWorkbook.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1441226732, "post_id": 32362732, "comment_id": 52598305, "body": "<i>It doesn&#39;t give an error, the folders just don&#39;t show up...</i>. Well, remove <code>On Error GoTo Handle</code> and you should see your error."}, {"owner": {"reputation": 65, "user_id": 5047691, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd0481d130f00e91dfb13b85966e693b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark L", "link": "https://stackoverflow.com/users/5047691/mark-l"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1441226935, "post_id": 32362732, "comment_id": 52598415, "body": "I just removed it, but it still doesn&#39;t come up with an error?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 2, "creation_date": 1441227079, "post_id": 32362732, "comment_id": 52598491, "body": "Column R is irrelevant? <code>FolderRange.Offset(0, 1).Value</code>...and FolderRange is a range in Column Q...offset by 1...*singing the alphabet song*..."}, {"owner": {"reputation": 65, "user_id": 5047691, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd0481d130f00e91dfb13b85966e693b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark L", "link": "https://stackoverflow.com/users/5047691/mark-l"}, "edited": false, "score": 0, "creation_date": 1441227510, "post_id": 32362732, "comment_id": 52598692, "body": "Thanks for pointing that out, Tim; I appreciate it. I&#39;ll go review my alphabet now. haha"}], "owner": {"reputation": 65, "user_id": 5047691, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd0481d130f00e91dfb13b85966e693b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark L", "link": "https://stackoverflow.com/users/5047691/mark-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441245182, "creation_date": 1441226535, "last_edit_date": 1441245182, "question_id": 32362732, "link": "https://stackoverflow.com/questions/32362732/creating-folders-based-on-a-column-macro-issue", "title": "Creating Folders Based on a Column Macro Issue", "body": "<p>I have a macro that creates new folders based on the data in Column Q. It works great except for the fact that Column R is required to be populated with data in order for it to work. </p>\n\n<p>I don't understand this because the data in Column R is irrelevant. It doesn't give an error, the folders just don't show up for some reason. </p>\n\n<pre><code>Sub CreateFolders()\n\n\n Dim FolderListRange As Range\n Dim FolderRange As Variant\n Dim FolderName As String\n Dim ParentFolderPath As String\nSet xWb = Application.ThisWorkbook\n\n\nOn Error GoTo Handle\n\nParentFolderPath = xWb.Path\n\nSet FolderListRange = ActiveSheet.Range(\"Q2:Q64000\").SpecialCells(xlCellTypeConstants)\n\nFor Each FolderRange In FolderListRange\n    If FolderRange.Offset(0, 1).Value = \"\" Then GoTo Continue\n\n    FolderName = ParentFolderPath &amp; \"\\\" &amp; FolderRange.Value\n\n    If FileSystem.Dir(FolderName, vbDirectory) = vbNullString Then\n        FileSystem.MkDir FolderName\n    End If\n\n Continue:\n  Next\n\n Handle:\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "sharepoint", "dao"], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 3438194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2e23c82bd095e743f6b1eac496fbaa28?s=128&d=identicon&r=PG&f=1", "display_name": "Dimas", "link": "https://stackoverflow.com/users/3438194/dimas"}, "is_accepted": true, "score": 0, "last_activity_date": 1442335476, "creation_date": 1442335476, "answer_id": 32591399, "question_id": 32362637, "link": "https://stackoverflow.com/questions/32362637/mydb-execute-hangs-the-application-when-updating-sharepoint-list/32591399#32591399", "title": "myDB.execute hangs the application when updating SharePoint list", "body": "<p>I have found that instead of using DAO, by using ADO I can successfully update the sharepoint list from the server.</p>\n"}], "owner": {"reputation": 108, "user_id": 3438194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2e23c82bd095e743f6b1eac496fbaa28?s=128&d=identicon&r=PG&f=1", "display_name": "Dimas", "link": "https://stackoverflow.com/users/3438194/dimas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 32591399, "answer_count": 1, "score": 0, "last_activity_date": 1442335476, "creation_date": 1441226256, "question_id": 32362637, "link": "https://stackoverflow.com/questions/32362637/mydb-execute-hangs-the-application-when-updating-sharepoint-list", "title": "myDB.execute hangs the application when updating SharePoint list", "body": "<p>I am running this script in an Outlook application. It will analyze emails, forward to the appropriate team, move the received email to a \"processed\" folder, etc...\nNow for the next step, I want to log the movements to our SharePoint.</p>\n\n<p>I have added a few lines of code, and it worked as a charm in my (company provided) computer.</p>\n\n<p>What I added is basically: </p>\n\n<pre><code>Dim db as Database\nSet db = DAO.OpenDatabase(\"path\\thedb.accdb\")\ndb.execute(myquery)\n</code></pre>\n\n<p>The query is always an insert. I have tried the full insert with the variables in it, or just something like this</p>\n\n<pre><code>db.Execute \"INSERT INTO the_list ([tktnum]) VALUES ('987654');\"\n</code></pre>\n\n<p>I have searched and the only thing that gave me hope is to add <code>dbFailOnError</code>, as in</p>\n\n<pre><code>db.Execute \"INSERT INTO the_list ([tktnum]) VALUES ('987654');\", dbFailOnError\n</code></pre>\n\n<p>but it made no difference.</p>\n\n<p>and again: from my computer, it runs perfectly.</p>\n\n<p>Now, if I go to the server where the script is running and add the SharePoint update code, it will crash Outlook. With a breakpoint on the <code>db.execute</code> line, I see that Outlook stays [running] for about 5 seconds, then it crashes. I have left it there, working other things, and came back hours later and it was still hung.</p>\n\n<ul>\n<li>I have 2 servers I can use for this, which are in a dedicated datacenter zone. Error happens in both.</li>\n<li>They are in the same subnet.</li>\n<li>Both are 2008R2, I have installed Office 2013 Pro.</li>\n<li>One server is connected to the company KMS while the other has the firewall rule pending for it, so Office shows unlicensed in the latter.</li>\n<li>I can browse the SharePoint from both servers, I actually had to in order to click \"Open with Access\" in IE, which would download the accdb file I am opening with the OpenDatabase method.</li>\n<li>Currently, a local user runs the script. I have logged on with the application ID domain\\my.team.name, configured Outlook in this session, error continues.\n\n<ul>\n<li>This ID has permissions over the SharePoint site and list.</li>\n</ul></li>\n</ul>\n\n<p>I am clueless. If anyone knows if there are more ports other than 443 that this uses, I can request any policies to be created.</p>\n\n<p>Thanks for reading, hope you can help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3422, "user_id": 1458030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3728aa864efa903f4d0c7db9ac39989?s=128&d=identicon&r=PG", "display_name": "qPCR4vir", "link": "https://stackoverflow.com/users/1458030/qpcr4vir"}, "edited": false, "score": 1, "creation_date": 1441226439, "post_id": 32362558, "comment_id": 52598142, "body": "indirect (your cell) ?"}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 1, "creation_date": 1441226551, "post_id": 32362558, "comment_id": 52598207, "body": "You can also rely on this approach. For example: Dim CellFrom As String Dim CellTo As String CellFrom = &quot;A1&quot; and CellTo = &quot;B4&quot; you can do: range(CellFrom &amp; &quot;:&quot; &amp; CellTo).Select. You might also access the Columns/Rows via indices (which are 1-based, but not everything in VBA, which has nothing to do with VB.NET coupled with Excel, is 1-based by default -&gt; I am clarifying this because I had a long discussion a while ago about this :)). There are quite a few alternatives. Perhaps you should take a look at some basic sample codes."}, {"owner": {"reputation": 3422, "user_id": 1458030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3728aa864efa903f4d0c7db9ac39989?s=128&d=identicon&r=PG", "display_name": "qPCR4vir", "link": "https://stackoverflow.com/users/1458030/qpcr4vir"}, "edited": false, "score": 1, "creation_date": 1441226592, "post_id": 32362558, "comment_id": 52598225, "body": "<a href=\"http://stackoverflow.com/a/31301086/1458030\">stackoverflow.com/a/31301086/1458030</a>"}, {"owner": {"reputation": 51, "user_id": 4406628, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a793e1d577a85f7616e07531e8393016?s=128&d=identicon&r=PG&f=1", "display_name": "QProgram", "link": "https://stackoverflow.com/users/4406628/qprogram"}, "edited": false, "score": 0, "creation_date": 1441228866, "post_id": 32362558, "comment_id": 52599290, "body": "That worked, thank you thank you"}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 0, "last_activity_date": 1441227996, "creation_date": 1441227996, "answer_id": 32363104, "question_id": 32362558, "link": "https://stackoverflow.com/questions/32362558/selecting-multiple-cells-using-variables-in-excel/32363104#32363104", "title": "Selecting Multiple Cells Using Variables in Excel", "body": "<p>Here are the examples for currently selected sheet:</p>\n\n<pre><code>Sub test()\n    TopRow = 1\n    BottomRow = 10\n    LeftColumn = 3\n    RightColumn = 9\n    Range(Cells(TopRow, LeftColumn), Cells(BottomRow, RightColumn)).Select\nEnd Sub\n</code></pre>\n\n<p>And for certain specified sheet:</p>\n\n<pre><code>Sub test()\n    SheetName = \"Test\"\n    TopRow = 1\n    BottomRow = 10\n    LeftColumn = 3\n    RightColumn = 9\n    With Sheets(SheetName)\n        .Select\n        .Range(.Cells(TopRow, LeftColumn), .Cells(BottomRow, RightColumn)).Select\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4406628, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a793e1d577a85f7616e07531e8393016?s=128&d=identicon&r=PG&f=1", "display_name": "QProgram", "link": "https://stackoverflow.com/users/4406628/qprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 0, "accepted_answer_id": 32363104, "answer_count": 1, "score": 0, "last_activity_date": 1441246881, "creation_date": 1441225906, "last_edit_date": 1531164843, "question_id": 32362558, "link": "https://stackoverflow.com/questions/32362558/selecting-multiple-cells-using-variables-in-excel", "title": "Selecting Multiple Cells Using Variables in Excel", "body": "<p>If I want to select multiple cells in Excel with VBA I do this:</p>\n\n<pre><code>range(\"A1:B4\").Select\n</code></pre>\n\n<p>If my rows are the values of a variable, I don't know how to select those cells.  </p>\n\n<p>Any one know how to do that?</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement", "for-loop"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441225866, "post_id": 32362476, "comment_id": 52597811, "body": "what does the error say?"}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1441225936, "post_id": 32362546, "comment_id": 52597860, "body": "Beat me by  15 seconds ;)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1441226072, "last_edit_date": 1441226072, "creation_date": 1441225869, "answer_id": 32362546, "question_id": 32362476, "link": "https://stackoverflow.com/questions/32362476/loop-works-fine-on-a-single-sheet-having-trouble-looping-through-workbook/32362546#32362546", "title": "Loop works fine on a single sheet, having trouble looping through workbook.", "body": "<p>It's not looping because you're using <code>ActiveSheet</code>'s range.  Change it to:</p>\n\n<pre><code>Dim CEL As Range\nDim RNG As Range\nDim I As Integer\nDim WrkSht As Worksheet\nDim WS_Count As Integer\n\nI = 0\nWS_Count = ActiveWorkbook.Worksheets.Count\n    For Each WrkSht In ActiveWorkbook.Worksheets\n    I = I + 1\n        If 6 &lt; I &lt; WS_Count Then\n            Set RNG = wrksht.Range(\"c9:C200\")\n                For Each CEL In RNG\n                         If CEL.HasFormula = True Then\n                            CEL.Offset(, 3) = CEL.Value\n                         ElseIf IsNumeric(CEL) = True Then\n                                    CEL.Offset(, 3) = CEL.Value\n                         Else\n\n                         End If\n                Next CEL\n        Else\n\n        End If\n    Next WrkSht\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "edited": false, "score": 0, "creation_date": 1441226732, "post_id": 32362552, "comment_id": 52598303, "body": "Thank you both, The debugger still runs to the innermost end if. Looks like I&#39;ve still got some work to do."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "edited": false, "score": 0, "creation_date": 1441226903, "post_id": 32362552, "comment_id": 52598398, "body": "What error are you getting though? Remove that <code>ELSE</code> command cause it&#39;s not doing anything."}, {"owner": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "edited": false, "score": 0, "creation_date": 1441227407, "post_id": 32362552, "comment_id": 52598644, "body": "Code Execution Has Been Interrupted. When I step through I get [Cel.Value = 40011.15] , the 40011.15 being an actual number in the data somewhere."}, {"owner": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "edited": false, "score": 0, "creation_date": 1441230020, "post_id": 32362552, "comment_id": 52599801, "body": "restarted the worksheet and ran the same code and it executed cleanly, not sure why... in any case, thanks for the help"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 1, "last_activity_date": 1441225884, "creation_date": 1441225884, "answer_id": 32362552, "question_id": 32362476, "link": "https://stackoverflow.com/questions/32362476/loop-works-fine-on-a-single-sheet-having-trouble-looping-through-workbook/32362552#32362552", "title": "Loop works fine on a single sheet, having trouble looping through workbook.", "body": "<p>When you declare your range you are doing it based on ActiveSheet but you are not activating the following sheets through each loop. But rather than using ActiveSheet just set the target range with your WrkSht variable:</p>\n\n<pre><code>Set RNG = WrkSht.Range(\"c9:C200\")\n</code></pre>\n\n<p>Hope this resolves your issue.</p>\n"}], "owner": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 32362552, "answer_count": 2, "score": 1, "last_activity_date": 1441226072, "creation_date": 1441225545, "question_id": 32362476, "link": "https://stackoverflow.com/questions/32362476/loop-works-fine-on-a-single-sheet-having-trouble-looping-through-workbook", "title": "Loop works fine on a single sheet, having trouble looping through workbook.", "body": "<p>I have a workbook with several sheets and I am trying to detect numbers in C9:C200 and copy them in a cell three columns over - for every sheet starting at the 7th. The code within the outermost forloop works fine on a single sheet but I get an error message when I try to loop it through the rest of the sheets. I think I have two problems:</p>\n\n<ol>\n<li><p>I'm not sure how to bounce the c9:c200 range from sheet to sheet as it loops through the workbook</p></li>\n<li><p>I think I need to tell VBA to reset the evaluations so that it starts from scratch on the next sheet.</p></li>\n</ol>\n\n<p>Am I going in the right direction with this?</p>\n\n<p>Thanks!</p>\n\n<p>Sub MoveQtrLoop()</p>\n\n<pre><code>Dim CEL As Range\nDim RNG As Range\nDim I As Integer\nDim WrkSht As Worksheet\nDim WS_Count As Integer\n\nI = 0\n\nWS_Count = ActiveWorkbook.Worksheets.Count\n\n    For Each WrkSht In ActiveWorkbook.Worksheets\n\n    I = I + 1\n\n        If 6 &lt; I &lt; WS_Count Then\n\n            Set RNG = ActiveSheet.Range(\"c9:C200\")\n\n                For Each CEL In RNG\n                         If CEL.HasFormula = True Then\n                            CEL.Offset(, 3) = CEL.Value\n\n                         ElseIf IsNumeric(CEL) = True Then\n                                    CEL.Offset(, 3) = CEL.Value\n\n                         Else\n\n                         End If ****ERR. OCCURS HERE****\n                Next CEL\n        Else\n\n        End If\n    Next WrkSht\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1441224546, "post_id": 32362163, "comment_id": 52597141, "body": "You will have to show the code to get any help. The SO community is pretty firm on that position. So just edit your question, and show us the code and the error that the line is on and someone should be able to help you out."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441224654, "post_id": 32362163, "comment_id": 52597198, "body": "a) show the code and indicate what line is generating the error b) why aren&#39;t you using <code>Workbook_SheetActivate</code> and a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow noreferrer\">Select Case statement</a> on the Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a>?"}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "reply_to_user": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1441224710, "post_id": 32362163, "comment_id": 52597232, "body": "@Constuntine Sorry, will post!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441224810, "post_id": 32362163, "comment_id": 52597281, "body": "You might want to check Formulas \u25ba Defined Names \u25ba Name Manager for a valid <code>list3 </code> with workbook scope."}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1441225007, "post_id": 32362163, "comment_id": 52597384, "body": "@Jeeped A. I get the error as soon as I try to run it. (It highlights the first line, even when the sub isn&#39;t private.) B. I have no idea what that even means, I taught myself vba from here and a macro I found at work. I also didn&#39;t write the code. I assume the code was found using the dropdown in VBA with Worksheet on the left and Activate on the left. Edit: Yes, list1 to list4 have workbook scope"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441225301, "post_id": 32362163, "comment_id": 52597531, "body": "There is nothing wrong with the code. Check the existence and validity of the Refers to: for <code>list3</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441225576, "post_id": 32362163, "comment_id": 52597650, "body": "If this is a cascading failure then you may be experiencing a corruption in the VBA project. Start by getting all code into a safe environment before proceeding."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441232158, "post_id": 32362163, "comment_id": 52600577, "body": "Maybe <a href=\"http://blogs.msdn.com/b/vsod/archive/2009/06/05/visual-basic-6-controls-stop-working-after-security-advisory-960715.aspx\" rel=\"nofollow noreferrer\">blogs.msdn.com/b/vsod/archive/2009/06/05/&hellip;</a>"}, {"owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1441985582, "post_id": 32362163, "comment_id": 52912154, "body": "You shouldn&#39;t write two statements on one line. Try to separate hidden (cell.entireRow.Hidden = True) and the assignment of &quot;&quot; to the cell value (cell.value = &quot;&quot;). Maybe that helps to avoid the error."}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "reply_to_user": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1442177640, "post_id": 32362163, "comment_id": 52964731, "body": "@Hubisan I think that actually works as an if statement... I will have to try it later... It means to hide the row if the cell is blank as I understand it"}, {"owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1442269172, "post_id": 32362163, "comment_id": 53004769, "body": "Try to narrow down the error by commenting out (&#39; in front) the line with &quot;cell.EntireRow...&quot; and then check if there is still an error. If that line causes the error try it with an If...Then...Else statement. Else comment the for each loop out and try again etc. And google your error message."}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "reply_to_user": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1442503405, "post_id": 32362163, "comment_id": 53116968, "body": "@Hubisan it is an if statement... could be replaced with &quot;if c.value = &quot;&quot; then cell.entireRow.hidden = true else cell.entireRow.hidden = false&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442870216, "post_id": 32543430, "comment_id": 53252903, "body": "I have multiple sheets, and I get this when I switch between them. Deactivating isn&#39;t the problem."}, {"owner": {"reputation": 347, "user_id": 5326540, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/316744cecf1f05658bf01f607ceb6539?s=128&d=identicon&r=PG&f=1", "display_name": "Sorin GFS", "link": "https://stackoverflow.com/users/5326540/sorin-gfs"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442918535, "post_id": 32543430, "comment_id": 53271757, "body": "First of all, for proper use you MUST place that code into the appropriate object module, the one containing the <code>list3</code> list. (e.g.Sheet1.Module). The reason for this is to give a reference for <code>worksheet_activate</code> to know which sheet to activate (since there can be only one <code>list3</code> ). Secondly, after you do the first step you could run the code within Visual Basic, it will reveal hidden rows, but because <code>Application.ScreenUpdating = False</code> the sheet won&#39;t activate, you must activate it manually."}], "tags": [], "owner": {"reputation": 347, "user_id": 5326540, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/316744cecf1f05658bf01f607ceb6539?s=128&d=identicon&r=PG&f=1", "display_name": "Sorin GFS", "link": "https://stackoverflow.com/users/5326540/sorin-gfs"}, "is_accepted": false, "score": 0, "last_activity_date": 1442090050, "creation_date": 1442090050, "answer_id": 32543430, "question_id": 32362163, "link": "https://stackoverflow.com/questions/32362163/worksheet-activate-code-fails-to-run-in-only-1-worksheet/32543430#32543430", "title": "Worksheet_Activate code fails to run in only 1 worksheet", "body": "<p>Not activate is the failure, but deactivate. Before activate excel must deactivate active sheet, so if there is only one sheet... can't be deactivated!</p>\n\n<p>You can try a trick, minimize then maximize by activate. Is going to have the same effect, if you put them on the same statement you will not even feel the break.</p>\n"}], "owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 759, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1442090050, "creation_date": 1441224387, "last_edit_date": 1531164843, "question_id": 32362163, "link": "https://stackoverflow.com/questions/32362163/worksheet-activate-code-fails-to-run-in-only-1-worksheet", "title": "Worksheet_Activate code fails to run in only 1 worksheet", "body": "<p>I have a curious VBA problem. It has simple code to hide lines that aren't used. It has served me well, (I didn't actually make it) and all of the bugs fixed. </p>\n\n<p>Now, however, it has stopped running the worksheet activate code in only one worksheet. The code for the other worksheets runs fine, and is nearly identical (list3 instead of list1 as a named range, and EntireColumn instead of EntireRow). </p>\n\n<p>When I open Visual Basic and try to run the worksheet activate code manually, it gives me this error: </p>\n\n<blockquote>\n  <p>Compile error: Object library invalid or contains references to object definitions that could not be found. </p>\n</blockquote>\n\n<p>I don't know where to start to try to fix it, especially when the Google seems to yield no results, even with the new condescending logo.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n    Application.ScreenUpdating = False\n\n    Dim cell As Range\n\n    For Each cell In Range(\"list3\") 'This changes to list1 to list4\n        cell.EntireRow.Hidden = cell.Value2 = \"\"\n    Next cell\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Two worksheets don't work now, I wonder if it has something to do with <code>\"EntireRow.Hidden\"</code>.</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441231988, "post_id": 32362034, "comment_id": 52600519, "body": "This ? &quot;A similar result can be had by applying a custom format to the cell. Just use the format &quot;;;;&quot; (that&#39;s three semicolons, without the quote marks) and the information in the cell disappears from view. Again, you can still click the link, even though it is quite invisible.&quot;  Would be kind of random for the cells to have that format by chance though..."}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 9178046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c495c6c64ade720eb0349d1b77ce9b?s=128&d=identicon&r=PG&f=1", "display_name": "HTh", "link": "https://stackoverflow.com/users/9178046/hth"}, "edited": false, "score": 0, "creation_date": 1517558778, "post_id": 32385326, "comment_id": 84152735, "body": "If you dont want to unprotect your sheet (which might be favorable in some cases) you can add the &quot;text to display&quot; after setting the Hyperlink manually by simply editing the <code>.Value</code> property of your corresponding Cell: <code>MyCell.Hyperlinks.ADD Anchor:=MyCell, Address:=&quot;MyAddress&quot;, TextToDisplay:=&quot;MyText&quot;</code> <code>MyCell.Value = &quot;MyText&quot;</code>"}], "tags": [], "owner": {"reputation": 135, "user_id": 4220727, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NMmWd.jpg?s=128&g=1", "display_name": "CarloC", "link": "https://stackoverflow.com/users/4220727/carloc"}, "is_accepted": true, "score": 0, "last_activity_date": 1441314015, "creation_date": 1441314015, "answer_id": 32385326, "question_id": 32362034, "link": "https://stackoverflow.com/questions/32362034/vba-hyperlinks-add-creates-working-hyperlink-but-text-display-is-not-visible-in/32385326#32385326", "title": "VBA Hyperlinks.Add creates working hyperlink but text display is not visible in Excel 2010", "body": "<p>The problem is the protected worksheet. While a protected Excel 2007 worksheet allows for formatting and adding hyperlink text display without implicitly setting it so, in Excel 2010 it appears you must do so. For my purposes, I simply unprotected the sheet, let the program do its thing, then reset the Protect at the end. So as a precursor to the actual hyperlinking routine, I added a clean up routine.</p>\n\n<pre><code>                ' Clear links and colour formatting from the WEBLink col etc:  _Buggsie.178\n            With p_wksCompDetailReport\n                .Unprotect Password:=PROTECT_PASSWORD\n                If .Hyperlinks.Count &gt; 0 Then\n                    .Hyperlinks.Delete\n                End If\n                With .Range(p_typCDCols.strWebLinkCol &amp; REPORT_DATA_ROW_START &amp; \":\" &amp; p_typCDCols.strWebLinkCol &amp; p_lngRowLast)\n                    .Interior.ColorIndex = xlNone\n                    .Cells.Clear\n                End With\n            End With\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4220727, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/NMmWd.jpg?s=128&g=1", "display_name": "CarloC", "link": "https://stackoverflow.com/users/4220727/carloc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 0, "accepted_answer_id": 32385326, "answer_count": 1, "score": 1, "last_activity_date": 1441314015, "creation_date": 1441223952, "last_edit_date": 1531164843, "question_id": 32362034, "link": "https://stackoverflow.com/questions/32362034/vba-hyperlinks-add-creates-working-hyperlink-but-text-display-is-not-visible-in", "title": "VBA Hyperlinks.Add creates working hyperlink but text display is not visible in Excel 2010", "body": "<p>I have a basic Hyperlinks.Add call developed in VBA Excel 2007 (Windows 7) and it works all fine.  However, a user with Excel 2010 runs the same program and while the hyperlink is written out, it works (hovering over the cell with the link shows the URL) but the text display is a no show. The cell is blank.</p>\n\n<p>Here's the code.</p>\n\n<pre><code>Private Sub Write_PartSpecPartDetails(ByRef p_wksCompDetailReport As Worksheet, p_lngRowNow As Long, p_strReturnedRecords() As String, p_typCDCols As CompDetailCols)\n\nWith p_wksCompDetailReport\n\n    .Range(p_typCDCols.strPartsSpecCol &amp; p_lngRowNow).Value = p_strReturnedRecords(XML_ARRAY_PART_ELE)\n    .Range(p_typCDCols.strPartsSpecStatusCol &amp; p_lngRowNow).Value = p_strReturnedRecords(XML_ARRAY_PS_STAT_ELE)\n    .Range(p_typCDCols.strOracleStatus &amp; p_lngRowNow).Value = p_strReturnedRecords(XML_ARRAY_ORACLE_STAT_ELE)\n    .Hyperlinks.ADD Anchor:=.Range(p_typCDCols.strWebLinkCol &amp; p_lngRowNow), _\n                        Address:=ITB_WEBPN_URL &amp; p_strReturnedRecords(XML_ARRAY_PART_ELE) &amp; \"?OpenDocument\", _\n                        TextToDisplay:=ITB_WEBPN_PREFIX &amp; p_strReturnedRecords(XML_ARRAY_PART_ELE)\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The user's file is saved as Excel 2003 (.xls), it's not shared but it is protected.  Thoughts?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6511, "user_id": 4765200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb1ac82079e2f813975cfa1aad1e234?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Pressler", "link": "https://stackoverflow.com/users/4765200/brian-pressler"}, "is_accepted": false, "score": 0, "last_activity_date": 1441225773, "last_edit_date": 1441225773, "creation_date": 1441224269, "answer_id": 32362127, "question_id": 32362023, "link": "https://stackoverflow.com/questions/32362023/how-do-you-transition-date-from-one-column-to-the-next-in-a-loop/32362127#32362127", "title": "How do you transition date from one column to the next in a loop?", "body": "<p>Can you convert to a .xlsx, .xlsm and .xlsb workbook?  They have a limit of 1048576 rows per sheet.</p>\n\n<p>Also, you will have to change the data type of <code>CellRow</code> to <code>LONG</code>.</p>\n\n<p>If you still need to break it into more than one column you can use modular opreations... like this:</p>\n\n<pre><code>Private Sub mythirdlesson()\nDim wks As Worksheet\nDim s As Integer\nDim m As Integer\nDim h As Long\nDim cellrow As Long\n\nSet wks = ThisWorkbook.Worksheets(\"Sheet1\")\ncellrow = 0\n\nFor h = 0 To 24\n    For m = 0 To 59\n        For s = 0 To 59\n            wks.Cells(cellrow Mod 65536 + 1, cellrow \\ 65536 + 1) = h &amp; \":\" &amp; m &amp; \":\" &amp; s\n            cellrow = cellrow + 1\n        Next\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1441224855, "post_id": 32362213, "comment_id": 52597310, "body": "This should fix your issue though it doesn&#39;t respond to your specific question. If you want to break it into 2 lines you can have an <code>IF cellrow&gt;43200 THEN</code> statement where if <code>cellrow</code> or some other variable goes beyond a certain value in your nested loop then you would execute <code>wks.Cells(cellrow - 43200, 2) = ...</code> writing on the second column and adjusting your row. Regards,"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 3, "last_activity_date": 1441224545, "creation_date": 1441224545, "answer_id": 32362213, "question_id": 32362023, "link": "https://stackoverflow.com/questions/32362023/how-do-you-transition-date-from-one-column-to-the-next-in-a-loop/32362213#32362213", "title": "How do you transition date from one column to the next in a loop?", "body": "<p>The issue is not with the Excel rows but rather with the <code>cellrow</code> data type. I changed it to long and it worked without issue. Also note that your script has a design error calculating 60 hours in a day rather than 24. Please consider the corrected script:</p>\n\n<pre><code>Private Sub mythirdlesson()\n    Dim wks As Worksheet\n    Dim s As Integer\n    Dim m As Integer\n    Dim h As Long\n    Dim cellrow As Long\n\n    Set wks = ThisWorkbook.Worksheets(\"Library\")\n    cellrow = 1\n\n    For h = 0 To 23\n        For m = 0 To 59\n            For s = 0 To 59\n            wks.Cells(cellrow, 1) = h &amp; \":\" &amp; m &amp; \":\" &amp; s\n            cellrow = cellrow + 1\n            Next\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>Regards,</p>\n"}, {"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1441226685, "last_edit_date": 1441226685, "creation_date": 1441225860, "answer_id": 32362541, "question_id": 32362023, "link": "https://stackoverflow.com/questions/32362023/how-do-you-transition-date-from-one-column-to-the-next-in-a-loop/32362541#32362541", "title": "How do you transition date from one column to the next in a loop?", "body": "<p>I realize you are doing this exercise for practice and to learn VBA. Here's a good lesson regarding speed. Look how long it takes to write out your 86400 time values, the way you are doing it in this exercise.</p>\n\n<p>Here's how I would do it. It takes about tenth of a second to complete:</p>\n\n<pre><code>Private Sub FastTimes()\n    [d:d].NumberFormat = \"hh:mm:ss\"\n    [d1:d86400] = [row(1:86400)/86400]\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1441225877, "creation_date": 1441225877, "answer_id": 32362548, "question_id": 32362023, "link": "https://stackoverflow.com/questions/32362023/how-do-you-transition-date-from-one-column-to-the-next-in-a-loop/32362548#32362548", "title": "How do you transition date from one column to the next in a loop?", "body": "<p>Working with arrays is always faster. The code below populates 86400 rows in 0.4 sec on my PC, against 5.3 sec for <code>wks.Cells(cellrow, 1) = h &amp; \":\" &amp; m &amp; \":\" &amp; s</code> method:</p>\n\n<pre><code>Sub TestFill86400()\n    Dim filler(1 To 86400, 1 To 1) As Date\n    Dim i As Long\n    For i = 1 To 86400\n        filler(i, 1) = (i - 1) / 86400\n    Next\n    With ThisWorkbook.Worksheets(\"Library\")\n        With .Range(.Cells(1, 1), .Cells(86400, 1))\n            .Value = filler\n            .NumberFormat = \"hh:mm:ss\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5294108, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153636136493901/picture?type=large", "display_name": "FJ Junior", "link": "https://stackoverflow.com/users/5294108/fj-junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 32362213, "answer_count": 4, "score": 3, "last_activity_date": 1441226685, "creation_date": 1441223911, "question_id": 32362023, "link": "https://stackoverflow.com/questions/32362023/how-do-you-transition-date-from-one-column-to-the-next-in-a-loop", "title": "How do you transition date from one column to the next in a loop?", "body": "<p>I am creating a program that displays the amount of seconds in a day (86400) which means there will be 86400 rows of data displayed from 00:00:01 to 59:59:59 in that format. However I get a Run-time error: Overflow. Therefore, I am assuming I need to use more than one column to collect this data - if so how do I do that?</p>\n\n<pre><code>Private Sub mythirdlesson()\nDim wks As Worksheet\nDim s As Integer\nDim m As Integer\nDim h As Long\nDim cellrow As Integer\n\nSet wks = ThisWorkbook.Worksheets(\"Library\")\ncellrow = 1\n\nFor h = 0 To 59\n    For m = 0 To 59\n        For s = 0 To 59\n        wks.Cells(cellrow, 1) = h &amp; \":\" &amp; m &amp; \":\" &amp; s\n        cellrow = cellrow + 1\n        Next\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access-2010", "cascadingdropdown", "subform"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5293913, "user_type": "registered", "profile_image": "https://graph.facebook.com/821026689128/picture?type=large", "display_name": "Britain Bruner", "link": "https://stackoverflow.com/users/5293913/britain-bruner"}, "edited": false, "score": 0, "creation_date": 1442238805, "post_id": 32409260, "comment_id": 52988207, "body": "I was hoping I wouldn&#39;t have to post everything, as lengthy as it is, but the code you took the time to write/modify does not resolve my problem. So, I have added everything to my original post."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1441424168, "creation_date": 1441424168, "answer_id": 32409260, "question_id": 32361776, "link": "https://stackoverflow.com/questions/32361776/cascading-combo-box-query-for-union-query/32409260#32409260", "title": "Cascading Combo Box Query for Union Query", "body": "<p>A couple of things stand out in your VBA query: </p>\n\n<ol>\n<li>Multiple combo box instances are not included in the logic;  </li>\n<li>String and numeric data may not be fully adhered. Unless SubCommitteeName and PaperTypeName are numeric fields, their expressions need single quotes;</li>\n</ol>\n\n<p>Consider the following to allow any box to be concatenated in <code>WHERE</code> statement (notice the seemingly redundant use of the true statement <code>1 = 1</code> which is used to begin concatenation. Also, I broke the <code>ElseIfs</code> since multiple outcomes should be possible for any combination of combox box selections.</p>\n\n<pre><code>Private Sub FilterPaperList()\n\nDim strRS As String\n\nstrRS = \"SELECT qrylstpapers.Title, qrylstpapers.PaperTypeName \" _\n          &amp; \" FROM qrylstpapers \" _\n          &amp; \" WHERE 1 = 1 \"\n\nIf Not IsNull(Me.cboPaperNumberAssign) Then\n    strRS = strRS &amp; \" AND PaperNumber = \" &amp; Me.cboPaperNumberAssign\nEnd if\nIf Not IsNull(Me.cboSessionAssign) Then\n    strRS = strRS &amp; \" AND SessionNumber = '\" &amp; Me.cboSessionAssign\nEnd If\nIf Not IsNull(Me.cboSubCommitteeAssign) Then\n    strRS = strRS &amp; \" AND SubCommitteeName = \" &amp; Me.cboSubCommitteeAssign &amp; \"'\"\nEnd If\nIf Not IsNull(Me.cboPaperTypeAssign) Then\n    strRS = strRS &amp; \" AND PaperTypeName = '\" &amp; Me.cboPaperTypeAssign &amp; \"'\"\nEnd If\n\nstrRS = strRS &amp; \" ORDER BY qrylstpapers.Title;\"\n\nMe.lstPapers.RowSource = strRS    \nMe.lstPapers.Requery\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5293913, "user_type": "registered", "profile_image": "https://graph.facebook.com/821026689128/picture?type=large", "display_name": "Britain Bruner", "link": "https://stackoverflow.com/users/5293913/britain-bruner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442239096, "creation_date": 1441222955, "last_edit_date": 1442239096, "question_id": 32361776, "link": "https://stackoverflow.com/questions/32361776/cascading-combo-box-query-for-union-query", "title": "Cascading Combo Box Query for Union Query", "body": "<p>I've been working on a database to organize a resource of papers for assigned readers to easily access and review in my office.</p>\n\n<p>I've taken to a cascading combo box skeleton from <a href=\"http://www.fmsinc.com/microsoftaccess/forms/combo-boxes/cascading.html\" rel=\"nofollow\">here</a>, and I am hoping to get the reviewers and assigners to filter the papers down in a subform according to the criteria. The problem has largely been due to the fact that my organization leaves me to have a branched then linear relationship tree as opposed to a straight linear relationship tree. There are a lot of useful tips out there but I just cannot seem to get the correct combination because of this, to resolve my obstacle.</p>\n\n<p>The relationship tree is as follows Paper Type>SubCommittee>Session>Papers. I've settled on this because I am reviewing papers from one source (international resource) that has two paper types (working and informal) and has several subcommittees (my office is only interested in two of the committees).</p>\n\n<p>The cascade works fine, the subform populates initially in a correct manner from a query, but as the options are selected the query is unable to match the criteria as they are lookup values.</p>\n\n<p>The query identified as qrylstpapers contains the following fields: </p>\n\n<pre><code>PaperTypeName, SubCommitteeName, SessionNumber, PaperNumber, Title, Subject, Origin.\n</code></pre>\n\n<p>These fields are pulled from the tables PaperType, SubCommittee, Session, Papers</p>\n\n<p>I have two queries, one for Working and one for Informal papertypes. I have a third Union query to combine the two. </p>\n\n<p>I thought, making a query from the union query would make it easier, and while it populates the subform, sorting is not working.</p>\n\n<p>The command I am using in VBA to sort the query of the union query is as follows:</p>\n\n<pre><code>Private Sub FilterPaperList()\n\nDim strRS As String\n\nstrRS = \"SELECT qrylstpapers.Title, qrylstpapers.PaperTypeName FROM qrylstpapers\"\n\nIf Not IsNull(Me.cboPaperNumberAssign) Then\n    strRS = strRS &amp; \" WHERE PaperNumber = \" &amp; Me.cboPaperNumberAssign\nElseIf Not IsNull(Me.cboSessionAssign) Then\n    strRS = strRS &amp; \" WHERE SessionNumber = \" &amp; Me.cboSessionAssign\nElseIf Not IsNull(Me.cboSubCommitteeAssign) Then\n    strRS = strRS &amp; \" WHERE SubCommitteeName = \" &amp; Me.cboSubCommitteeAssign\nElseIf Not IsNull(Me.cboPaperTypeAssign) Then\n   strRS = strRS &amp; \" WHERE PaperTypeName = \" &amp; Me.cboPaperTypeAssign\nEnd If\n\nstrRS = strRS &amp; \" ORDER BY qrylstpapers.Title;\"\n\nMe.lstPapers.RowSource = strRS\n\nMe.lstPapers.Requery\n\nEnd Sub\n</code></pre>\n\n<p>One thing I did try that kind of worked was specify \"Me.cboPapertypeAssign.Column(1)\" and it would pop up a dialog window asking for input, following with the papertypename \"WP\" or \"INF\" would give me the appropriate sorting.</p>\n\n<p>Any thoughts, insight, and/or general criticism would be much appreciated. Even if it's a restructuring of the relationships.</p>\n\n<p><em>EDIT</em></p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub cboAgency_AfterUpdate()\n\n  ' Set the Mode combo box to be limited by the selected Agency\n  Me.cboMode.RowSource = \"SELECT tblMode.ModeID, tblMode.ModeName FROM tblMode \" &amp; _\n     \" WHERE AgencyID = \" &amp; Nz(Me.cboAgency) &amp; _\n     \" ORDER BY ModeName\"\n  Me.cboMode = Null\n\n    EnableControls\n\n\nEnd Sub\n\nPrivate Sub cboMode_AfterUpdate()\n  ' Set the Branch combo box to be limited by the selected Mode\n  Me.cboBranch.RowSource = \"SELECT tblBranch.BranchID, tblBranch.BranchName FROM tblBranch \" &amp; _\n     \" WHERE ModeID = \" &amp; Nz(Me.cboMode) &amp; _\n     \" ORDER BY BranchName\"\n  Me.cboBranch = Null\n\n    EnableControls\n\n\n\nEnd Sub\n\nPrivate Sub cboBranch_AfterUpdate()\n  ' Set the Office combo box to be limited by the selected Branch\n  Me.cboOffice.RowSource = \"SELECT tblOffice.OfficeID, tblOffice.OfficeNumber FROM tblOffice \" &amp; _\n     \" WHERE BranchID = \" &amp; Nz(Me.cboBranch) &amp; _\n     \" ORDER BY OfficeNumber\"\n  Me.cboOffice = Null\n\n    EnableControls\n\n\nEnd Sub\n\n\nPrivate Sub cboOffice_AfterUpdate()\n  ' Set the Reviewer combo box to be limited by the selected Office\n  Me.cboReviewer.RowSource = \"SELECT tblReviewers.ReviewerID, tblReviewers.LastName FROM tblReviewers \" &amp; _\n     \" WHERE OfficeID = \" &amp; Nz(Me.cboOffice) &amp; _\n     \" ORDER BY LastName\"\n  Me.cboReviewer = Null\n\n    EnableControls\n\n\n\nEnd Sub\n\nPrivate Sub cboPaperTypeAssign_AfterUpdate()\n'Enable the SubCommittee Combo Box\nIf Me.cboPaperTypeAssign.Column(1) = \"WP\" Then\n    Me.cboSubCommitteeAssign.RowSource = \"SELECT tblUNWPSubCommittee.SubCommitteeID, tblUNWPSubCommittee.SubCommitteeName From tblUNWPSubCommittee \" &amp; _\n        \" Where PaperTypeID = \" &amp; Nz(Me.cboPaperTypeAssign) &amp; _\n        \" ORDER BY SubCommitteeName\"\n    Me.cboSubCommitteeAssign = Null\nElseIf Me.cboPaperTypeAssign.Column(1) = \"INF\" Then\n    Me.cboSubCommitteeAssign.RowSource = \"SELECT tblUNINFSubCommittee.SubCommitteeID, tblUNINFSubCommittee.SubCommitteeName From tblUNINFSubCommittee \" &amp; _\n        \" Where PaperTypeID = \" &amp; Nz(Me.cboPaperTypeAssign) &amp; _\n        \" ORDER BY SubCommitteeName\"\n    Me.cboSubCommitteeAssign = Null\nEnd If\n\n    EnableControls\n    FilterPaperList\n\nEnd Sub\n\nPrivate Sub cboSubCommitteeAssign_AfterUpdate()\n'Enable the Session Combo Box\nIf Me.cboSubCommitteeAssign.Column(1) = \"GHS\" And Me.cboPaperTypeAssign.Column(1) = \"INF\" Then\n    Me.cboSessionAssign.RowSource = \"SELECT tblUNINFSessions.SessionID, tblUNINFSessions.SessionNumber From tblUNINFSessions \" &amp; _\n        \" Where SubCommitteeID = \" &amp; Nz(Me.cboSubCommitteeAssign) &amp; _\n        \" ORDER BY SessionNumber\"\n    Me.cboSessionAssign = Null\nElseIf Me.cboSubCommitteeAssign.Column(1) = \"TDG\" And Me.cboPaperTypeAssign.Column(1) = \"INF\" Then\n    Me.cboSessionAssign.RowSource = \"SELECT tblUNINFSessions.SessionID, tblUNINFSessions.SessionNumber From tblUNINFSessions \" &amp; _\n        \" Where SubCommitteeID = \" &amp; Nz(Me.cboSubCommitteeAssign) &amp; _\n        \" ORDER BY SessionNumber\"\n    Me.cboSessionAssign = Null\nElseIf Me.cboSubCommitteeAssign.Column(1) = \"GHS\" And Me.cboPaperTypeAssign.Column(1) = \"WP\" Then\n    Me.cboSessionAssign.RowSource = \"SELECT tblUNWPSessions.SessionID, tblUNWPSessions.SessionNumber From tblUNWPSessions \" &amp; _\n        \" Where SubCommitteeID = \" &amp; Nz(Me.cboSubCommitteeAssign) &amp; _\n        \" ORDER BY SessionNumber\"\n    Me.cboSessionAssign = Null\nElseIf Me.cboSubCommitteeAssign.Column(1) = \"TDG\" And Me.cboPaperTypeAssign.Column(1) = \"WP\" Then\n    Me.cboSessionAssign.RowSource = \"SELECT tblUNWPSessions.SessionID, tblUNWPSessions.SessionNumber From tblUNWPSessions \" &amp; _\n        \" Where SubCommitteeID = \" &amp; Nz(Me.cboSubCommitteeAssign) &amp; _\n        \" ORDER BY SessionNumber\"\n    Me.cboSessionAssign = Null\nEnd If\n\n    EnableControls\n    FilterPaperList\nEnd Sub\n\nPrivate Sub cboSessionAssign_AfterUpdate()\n\n'Enable the Paper Number Combo Box\nIf Me.cboSubCommitteeAssign.Column(1) = \"GHS\" And Me.cboPaperTypeAssign.Column(1) = \"INF\" Then\n    Me.cboPaperNumberAssign.RowSource = \"Select tblUNINFPapers.ID, tblUNINFpapers.PaperNumber From tblUNINFPapers \" &amp; _\n        \" Where SessionID = \" &amp; Nz(Me.cboSessionAssign) &amp; _\n        \" Order by PaperNumber\"\nElseIf Me.cboSubCommitteeAssign.Column(1) = \"TDG\" And Me.cboPaperTypeAssign.Column(1) = \"INF\" Then\n    Me.cboPaperNumberAssign.RowSource = \"Select tblUNINFPapers.ID, tblUNINFpapers.PaperNumber From tblUNINFPapers \" &amp; _\n        \" Where SessionID = \" &amp; Nz(Me.cboSessionAssign) &amp; _\n        \" Order by PaperNumber\"\nElseIf Me.cboSubCommitteeAssign.Column(1) = \"GHS\" And Me.cboPaperTypeAssign.Column(1) = \"WP\" Then\n    Me.cboPaperNumberAssign.RowSource = \"Select tblUNWPPapers.ID, tblUNWPPapers.PaperNumber From tblUNWPPapers \" &amp; _\n        \" Where SessionID = \" &amp; Nz(Me.cboSessionAssign) &amp; _\n        \" Order by PaperNumber\"\nElseIf Me.cboSubCommitteeAssign.Column(1) = \"TDG\" And Me.cboPaperTypeAssign.Column(1) = \"WP\" Then\n    Me.cboPaperNumberAssign.RowSource = \"Select tblUNWPPapers.ID, tblUNWPPapers.PaperNumber From tblUNWPPapers \" &amp; _\n        \" Where SessionID = \" &amp; Nz(Me.cboSessionAssign) &amp; _\n        \" Order by PaperNumber\"\nEnd If\n    EnableControls\n    FilterPaperList\nEnd Sub\n\nPrivate Sub cboPaperNumberAssign_AfterUpdate()\n    ' Filter the list of papers based on the selection(s)\n    FilterPaperList\nEnd Sub\n\n\nPrivate Sub FilterPaperList()\n\n    Dim strRS As String\n\n'     Filter the list box appropriateley based on the combo box selection(s)\n    strRS = \"SELECT qrylstpapers.Title, qrylstpapers.PaperTypeName FROM qrylstpapers\"\n\n    If Not IsNull(Me.cboPaperNumberAssign) Then\n        strRS = strRS &amp; \" WHERE PaperNumber = \" &amp; Me.cboPaperNumberAssign\n    ElseIf Not IsNull(Me.cboSessionAssign) Then\n        strRS = strRS &amp; \" WHERE SessionNumber = \" &amp; Me.cboSessionAssign\n    ElseIf Not IsNull(Me.cboSubCommitteeAssign) Then\n        strRS = strRS &amp; \" WHERE SubCommitteeName = \" &amp; Me.cboSubCommitteeAssign\n    ElseIf Not IsNull(Me.cboPaperTypeAssign) Then\n       strRS = strRS &amp; \" WHERE PaperTypeName = \" &amp; Me.cboPaperTypeAssign\n    End If\n\n    strRS = strRS &amp; \" ORDER BY qrylstpapers.Title;\"\n\n    Me.lstPapers.RowSource = strRS\n\n    Me.lstPapers.Requery\n\n\nEnd Sub\n\n\nPrivate Sub EnableControls()\n\n  ' Clear the Reviewer combo boxes\n  If IsNull(Me.cboAgency) Then\n     Me.cboMode = Null\n  End If\n\n  If IsNull(Me.cboMode) Then\n    Me.cboBranch = Null\n  End If\n\n  If IsNull(Me.cboBranch) Then\n    Me.cboOffice = Null\n  End If\n\n  If IsNull(Me.cboOffice) Then\n    Me.cboReviewer = Null\n  End If\n\n' Clear the PaperAssign combo boxes\nIf IsNull(Me.cboPaperTypeAssign) Then\n    Me.cboSubCommitteeAssign = Null\n    End If\nIf IsNull(Me.cboSubCommitteeAssign) Then\n    Me.cboSessionAssign = Null\n    End If\nIf IsNull(Me.cboSessionAssign) Then\n    Me.cboPaperNumberAssign = Null\n    End If\n\n' Enable or disable Reviewer combo boxes based on whether the combo box preceeding it has a value.\n\n  Me.cboMode.Enabled = (Not IsNull(Me.cboAgency))\n  Me.cboBranch.Enabled = (Not IsNull(Me.cboMode))\n  Me.cboOffice.Enabled = (Not IsNull(Me.cboBranch))\n  Me.cboReviewer.Enabled = (Not IsNull(Me.cboOffice))\n\n' Enable or disable PaperAssign combo boxes based on whether the combo box preceeding it has a value.\n\n Me.cboSubCommitteeAssign.Enabled = (Not IsNull(Me.cboPaperTypeAssign))\n Me.cboSessionAssign.Enabled = (Not IsNull(Me.cboSubCommitteeAssign))\n Me.cboPaperNumberAssign.Enabled = (Not IsNull(Me.cboSessionAssign))\n\nEnd Sub\n\n\nPrivate Sub Form_Load()\n    EnableControls\n    FilterPaperList\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "html", "excel", "vba"], "owner": {"reputation": 21, "user_id": 5294015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636c5cc1d5922f44a806cf6f0352ed91?s=128&d=identicon&r=PG&f=1", "display_name": "Constantine", "link": "https://stackoverflow.com/users/5294015/constantine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1441222534, "creation_date": 1441222534, "question_id": 32361674, "link": "https://stackoverflow.com/questions/32361674/excel-vba-manipulate-javascript", "title": "Excel VBA - Manipulate Javascript", "body": "<p>I have researched stackoverflow and other sources for many weeks for an answer to this question but have not been able to uncover an answer.  I appreciate that there may be other posts that indirectly deal with the topic, but nothing seems to address the requirements of the specific example I have in mind, so I'm taking the plunge and posting.  My request:</p>\n\n<p>On the website www.4-traders.com there's an input box located at the top center of the page for entering a company name or stock ticker symbol.  The page contains code that calls a javascript function as one types into the input box.  The javascript searches a database for the best matches to the text being input, and the output of the javascript function is presented as a floating list box that one can select from.  The code for this component of the page is as follows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;td class=\"recherche_bl\"&gt;\r\n          &lt;input type=\"hidden\" name=\"lien\" value=\"recherche\"&gt;\r\n          &lt;input onblur=\"GlobalSearch.ACblur();\" onkeyup=\"GlobalSearch.ACkeyUp(event)\" onkeydown=\"return GlobalSearch.ACkeyDown(event);\" autocomplete=\"off\" type=\"text\" name=\"mots\" id=\"autocomplete\" class=\"inputrecherche\" value=\"Symbol or Keyword(s)\" onclick=\"document.recherche_menu.mots.value='';GlobalSearch.LoadHisto()\"&gt;\r\n          &lt;input type=\"image\" src=\"/images/loupe_recherche.png\" class=\"htZo\" align=\"absmiddle\" onclick=\"document.getElementById('noredirect').value='1'\"&gt;\r\n          &lt;input type=\"hidden\" name=\"RewriteLast\" value=\"zbat\"&gt;\r\n          &lt;input type=\"hidden\" id=\"noredirect\" name=\"noredirect\" value=\"0\"&gt;\r\n          &lt;input type=\"hidden\" id=\"type_recherche\" name=\"type_recherche\" value=\"0\"&gt;      \r\n&lt;/td&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>GlobalSearch is the javascript function I'm interested in.  I'd like to get Excel VBA to somehow select from the output of the GlobalSearch function after a value is input into the form.  I currently have to use sendkeys to accomplish this, which as everyone knows has a number of drawbacks and requires that an Internet Explorer windows is open at the time.  Here is the code I'm currently using for this piece:</p>\n\n<ol>\n<li>The value of Ticker is set before this part of the code.</li>\n<li>.document refers to an Internetexplorer.Application object I have created earlier on in the code.</li>\n<li>PauseTime is a procedure used to delay the execution of code.</li>\n<li>The two lines involving sending a 'space' and 'backspace' key are used to get the javascript to run (it doesn't seem to run without some manual user input).  Once the javascript runs I want the procedure to select the first instance in the list box, so I send a 'down' key and then an 'enter' key.</li>\n</ol>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>.document.recherche_menu.mots.Focus\r\n.document.forms(\"recherche_menu\")(\"mots\").Value = Ticker\r\nPauseTime (2)\r\nApplication.SendKeys (\" \")\r\nApplication.SendKeys (\"{BS}\")\r\nPauseTime (2)\r\nApplication.SendKeys (\"{DOWN}\")\r\nApplication.SendKeys (\"~\")</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I would really appreciate some help to figure this out.  I think the real issue is that I don't have a deep enough understanding of javascript to code what I need to into Excel VBA.  Thanks in advance for your help.</p>\n\n<p>Constantine</p>\n"}, {"tags": ["arrays", "excel", "dictionary", "vba"], "comments": [{"owner": {"reputation": 1096, "user_id": 5144555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0f1046a519313e19ad3929479ec85?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S Priz", "link": "https://stackoverflow.com/users/5144555/michael-s-priz"}, "edited": false, "score": 0, "creation_date": 1441221707, "post_id": 32361389, "comment_id": 52595594, "body": "What is the question?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1441221967, "post_id": 32361389, "comment_id": 52595735, "body": "why not use a class and a collection?"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441221970, "post_id": 32361389, "comment_id": 52595737, "body": "The way I defined the dictionary isn&#39;t working code. Is just wrote that to describe what I think needs to happen. I&#39;m not using a collection because I need the Key feature of a dictionary to selectively pull data. i.e. be able to get information about a specific item I have in mind."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1441223306, "post_id": 32361389, "comment_id": 52596490, "body": "you can do that w/ a collection.  I&#39;ll post an example..."}], "answers": [{"tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": true, "score": 1, "last_activity_date": 1441223490, "last_edit_date": 1525816150, "creation_date": 1441223490, "answer_id": 32361909, "question_id": 32361389, "link": "https://stackoverflow.com/questions/32361389/two-dimensional-array-as-item-of-dictionary/32361909#32361909", "title": "Two dimensional array as item of dictionary", "body": "<p>Here is a simple example using a class and a collection (basically modified from the examples <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<p>Class is pretty simple (class name is Employee):</p>\n\n<pre><code>Option Explicit\n\nPrivate pName As String\nPrivate pAddress As String\nPrivate pSalary As Double\n\nPublic Property Get Name() As String\n    Name = pName\nEnd Property\nPublic Property Let Name(Value As String)\n    pName = Value\nEnd Property\nPublic Property Get Address() As String\n    Address = pAddress\nEnd Property\nPublic Property Let Address(Value As String)\n    pAddress = Value\nEnd Property\nPublic Property Get Salary() As Double\n    Salary = pSalary\nEnd Property\nPublic Property Let Salary(Value As Double)\n    pSalary = Value\nEnd Property\n</code></pre>\n\n<p>Here is the test code:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim counter As Integer\n\n    Dim Employees As Collection\n    Dim Emp As Employee\n\n    Dim currentEmployee As Employee\n\n\n    Set Employees = New Collection\n\n    For counter = 1 To 10\n        Set Emp = New Employee\n\n        Emp.Name = \"Employee \" &amp; counter\n        Emp.Address = \"Address \" &amp; counter\n        Emp.Salary = counter * 1000\n\n        Employees.Add Emp, Emp.Name\n\n    Next counter\n\n    Set currentEmployee = Employees.Item(\"Employee 1\")\n\n\n    Debug.Print (currentEmployee.Address)\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, I'm adding items to my class specifying a key: </p>\n\n<pre><code>Employees.Add Emp, Emp.Name\n</code></pre>\n\n<p>which you can then use to pull directly from without looping. </p>\n"}, {"comments": [{"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441224708, "post_id": 32361962, "comment_id": 52597227, "body": "That&#39;s a nice way to go about it. What&#39;s happening with the array as we move through the rows ? We&#39;re basically doing <code>Array(Value1,Value2,Value3)</code>, is the data just being overwritten ? What would happen when we move to the second row ? Also, how does VBA know to set <code>Array[1] = &quot;Value1&quot;</code> and not call <code>Array[1]</code>?"}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441261199, "post_id": 32361962, "comment_id": 52608377, "body": "Array(1, 2, 3) creates a new array with elements 1,2,3. Each time through the for loop, Array() is called, so a new array is created for each row. You would index the dict like Debug.Print ItemsDict(&quot;Key&quot;)(0) (to get the first element). Not sure what your last question is."}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441298101, "post_id": 32361962, "comment_id": 52632561, "body": "Thanks, I appreciate you coming back and understanding the other approaches. A lot of people run off after they get some working code."}], "tags": [], "owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "is_accepted": false, "score": 1, "last_activity_date": 1441223657, "creation_date": 1441223657, "answer_id": 32361962, "question_id": 32361389, "link": "https://stackoverflow.com/questions/32361389/two-dimensional-array-as-item-of-dictionary/32361962#32361962", "title": "Two dimensional array as item of dictionary", "body": "<p>You can also do what you originally proposed by using the <code>Array</code> function to create a Variant array. If your data structure is getting this elaborate, it's usually better to have a data model class as in @sous2817's answer. But this technique is useful for adhoc, throwaway code.</p>\n\n<pre><code>Dim r As Range\n\nFor Each r In ['[testing macro.xlsx]test'!D7:G8].Rows\n    ItemsDict.Add r.Cells(1).Value, Array( _\n        r.Cells(2).Value, _\n        r.Cells(3).Value, _\n        r.Cells(4).Value)\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441227779, "post_id": 32362499, "comment_id": 52598823, "body": "<code>subItms.Add Key:=ws.Cells(1, j).Value2, Item:=ws.Cells(i, j).Value2</code> The first loop sets <code>Property 1</code> =&gt; <code>A</code> , <code>Property 2</code> =&gt; <code>B</code> , <code>Property 3</code> =&gt; <code>C</code>. However, the second one sets <code>Property 1</code> =&gt; <code>D</code> , <code>Property 2</code> =&gt; <code>E</code> , <code>Property 3</code> =&gt; <code>F</code>. What line is telling it that these Properties belong to Item 2 not Item 1 ?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441228600, "post_id": 32362499, "comment_id": 52599172, "body": "The 2 nested For loops make the distinction between the dictionaries: The outer loop creates the main dictionary, while the inner loop creates multiple sub-dictionaries. The line that shows what properties belong to the main dictionary is <code>itms.Add Key:=...</code> (object named &quot;itms&quot; is the top level dictionary). I&#39;ll add an image of the structure to make it clearer"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441228790, "post_id": 32362499, "comment_id": 52599254, "body": "It seems to me that after you&#39;re done with Item 1&#39;s loop, you&#39;re going back to setting sdict(&quot;Property 1&quot;) when it&#39;s already set. I&#39;m also getting a key already in use error for code that mimics your logic. Edit: It seems that me that you&#39;re not creating more than one sub-dictionary."}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441246036, "post_id": 32362499, "comment_id": 52604013, "body": "I copied pasted your code as-is this time. I still get the error &quot;This key is already associated with an element of this collection&quot;. This agrees with my understanding of how this is running, you&#39;re using the same dictionary during the second loop and hence you can&#39;t use the same <code>Keys</code> which are Property 1, 2 and 3."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441246513, "post_id": 32362499, "comment_id": 52604098, "body": "I&#39;m glad you tried it out, but the problem is caused by the data you used: on the sheet, use exactly the same data in your post: A, B, C, then D, E, F, then G, H, I. and it will work. The error <code>&quot;This key is already associated with an element of this collection&quot;</code> is caused by your test data having <i>duplicate keys</i> (like &quot;Item 1&quot;, &quot;Item 2&quot;, ..., &quot;Item 1&quot; again). I will make an edit to mention that <i>dictionaries cannot have duplicate keys</i> (dictionary Items can be duplicated, but the keys must be unique)"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441247316, "post_id": 32362499, "comment_id": 52604274, "body": "I&#39;m using the same data in the picture I posted, I made a whole new workbook with only your code to test it. <code>cell(1,j)</code> in <code>subItms.Add Key:=ws.Cells(1, j).Value2, Item:=ws.Cells(i, j).Value2</code> has only three values throughout the loop (Property 1 through 3). You&#39;re using that as a key, hence when you finish with Item 1 and start with Item 2, you&#39;re reusing Property 1 through 3 as keys in the same <code>subItms</code> dictionary which already has those keys."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441247561, "post_id": 32362499, "comment_id": 52604324, "body": "I got it (finally) - For me the code works fine, but for you is not releasing the previously used subItms dictionary. I&#39;ll check on how to prevent that from happening. What version of Excel are you using (just curious)"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441247729, "post_id": 32362499, "comment_id": 52604365, "body": "Office 2013. If in your version it&#39;s releasing the previously used subItms how are they saved at all at the end of the Macro ?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441249373, "post_id": 32362499, "comment_id": 52604703, "body": "Not sure if 2013 works differently but for 2010 all objects are as I&#39;d expect them, however I added <code>Set subItms = Nothing</code> before moving on to the next I (Item 2)"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441249575, "post_id": 32362499, "comment_id": 52604735, "body": "But if you do that how is anything saved? Edit: Our goal is to populate the dictionaries with values, but now you&#39;re emptying it before we can add the rest of the values."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441250484, "post_id": 32362499, "comment_id": 52604915, "body": "Once added to the main dictionary as an Item, the populated sub dictionaries will still contain all data (that&#39;s the entire purpose of this logic - create a memory mapping of all data using dictionaries containing other dictionaries as items where data can be accessed in a very convenient way: <code>itms(ws.Cells(3, 1))(ws.Cells(1, 3)) = &quot;I&quot;</code> (using other loops, or just using the header names as the key for the main dictionary, and row headers to access the data contained in sub dictionaries. (I&#39;ve implemented previous applications like this)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441250752, "post_id": 32362499, "comment_id": 52604993, "body": "When we do <code>Set subItms = Nothing</code> we are just releasing a reference to an existing object; that object is now part of the main dictionary, so it&#39;s not an object without a reference (ready to be discarded by the garbage collection). It&#39;s still accessible through the dictionary hierarchy"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441250905, "post_id": 32362499, "comment_id": 52605045, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/88644/discussion-between-newdimension-and-paul-bica\">continue this discussion in chat</a>."}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 1, "creation_date": 1441257386, "post_id": 32362499, "comment_id": 52606786, "body": "You reset the dictionary using <code>Set subItms = New Dictionary</code> INSIDE the loop! That was my problem. I didn&#39;t realize that this was inside the loop resetting the dictionary and allowing us to use the same <code>Keys</code> on a, now, brand new dictionary."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1441257743, "post_id": 32362499, "comment_id": 52606905, "body": "I should have pointed it out earlier (I&#39;m too used to it), but yes, that&#39;s the most important aspect of it"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 2, "last_activity_date": 1441250148, "last_edit_date": 1441250148, "creation_date": 1441225638, "answer_id": 32362499, "question_id": 32361389, "link": "https://stackoverflow.com/questions/32361389/two-dimensional-array-as-item-of-dictionary/32362499#32362499", "title": "Two dimensional array as item of dictionary", "body": "<p>Another approach - dictionary of dictionaries:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub nestedList()\n    Dim ws As Worksheet, i As Long, j As Long, x As Variant, y As Variant, z As Variant\n    Dim itms As Dictionary, subItms As Dictionary   'ref to \"Microsoft Scripting Runtime\"\n\n    Set ws = Worksheets(\"Sheet1\")\n    Set itms = New Dictionary\n\n    For i = 2 To ws.UsedRange.Rows.Count\n\n        Set subItms = New Dictionary         '&lt;-- this should pick up a new dictionary\n\n        For j = 2 To ws.UsedRange.Columns.Count\n\n            '           Key: \"Property 1\",          Item: \"A\"\n            subItms.Add Key:=ws.Cells(1, j).Value2, Item:=ws.Cells(i, j).Value2\n\n        Next\n\n        '        Key: \"Item 1\",              Item: subItms\n        itms.Add Key:=ws.Cells(i, 1).Value2, Item:=subItms\n\n        Set subItms = Nothing                '&lt;-- releasing previous object\n\n    Next\n    MsgBox itms(\"Item 3\")(\"Property 3\")      'itms(ws.Cells(3, 1))(ws.Cells(1, 3)) = \"I\"\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<p>It adjusts dynamically to total number of rows and columns, so there is no maintenance needed</p>\n\n<p>The benefit over collections is that you can check if <strong>keys exist</strong> or not</p>\n\n<p>The slowest part is adding all items to dictionaries, but when done accessing the items is very fast</p>\n\n<p><strong>Note</strong>: Dictionaries cannot have duplicate Keys</p>\n\n<p>.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>If you step through the code you'll be able to see the following objects:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KrR32.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KrR32.png\" alt=\"DictionaryOfDictionaries\"></a></p>\n\n<p>.</p>\n\n<p>If you replace the MsgBox line with the following:</p>\n\n<pre><code>For Each x In itms.Keys\n    For Each y In itms(x)\n        If InStr(y, 1) &gt; 0 Then\n            Debug.Print vbNullString\n            Debug.Print x &amp; \" ---&gt; Key: '\" &amp; y &amp; \"' -&gt; Item: '\" &amp; itms(x)(y) &amp; \"'\"\n        Else\n            Debug.Print vbTab &amp; vbTab &amp; \" -&gt; Key: '\" &amp; y &amp; \"' -&gt; Item: '\" &amp; itms(x)(y) &amp; \"'\"\n        End If\n    Next\nNext\n</code></pre>\n\n<p>You will get:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Item 1 ---&gt; Key: 'Property 1' -&gt; Item: 'A'\n         -&gt; Key: 'Property 2' -&gt; Item: 'B'\n         -&gt; Key: 'Property 3' -&gt; Item: 'C'\n\nItem 2 ---&gt; Key: 'Property 1' -&gt; Item: 'D'\n         -&gt; Key: 'Property 2' -&gt; Item: 'E'\n         -&gt; Key: 'Property 3' -&gt; Item: 'F'\n\nItem 3 ---&gt; Key: 'Property 1' -&gt; Item: 'G'\n         -&gt; Key: 'Property 2' -&gt; Item: 'H'\n         -&gt; Key: 'Property 3' -&gt; Item: 'I'\n</code></pre>\n\n<p>or type</p>\n\n<pre><code>For Each x In itms.Keys: For Each y in itms(x): Debug.Print x &amp; \" -&gt; \" &amp; y &amp; \" -&gt; \" &amp; itms(x)(y): Next: Next\n</code></pre>\n\n<p>in the Debug window</p>\n"}], "owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9856, "favorite_count": 1, "accepted_answer_id": 32361909, "answer_count": 3, "score": 5, "last_activity_date": 1441250148, "creation_date": 1441221474, "last_edit_date": 1531164843, "question_id": 32361389, "link": "https://stackoverflow.com/questions/32361389/two-dimensional-array-as-item-of-dictionary", "title": "Two dimensional array as item of dictionary", "body": "<p>I would like to populate a dictionary with several properties of an item. Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gXrVD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gXrVD.png\" alt=\"Sample data\"></a></p>\n\n<p>I was thinking of having <em>Item 1</em> and <em>Item 2</em> as <code>Dictionary</code> keys with an <code>array</code> that would hold its properties. \nI would need to be able to separately access each property of an item so concatenating them as one string is not an option. </p>\n\n<p>I'm thinking about something like the below <strong>pseudo-code</strong>:</p>\n\n<pre><code>    With Workbooks(\"testing macro\").Sheets(test).Range(\"D7:G8\")\n\n     For i = 1 To .Rows.count\n\n        items_dict.Add Key:=.Cells(i, 1).Value, _\n Item:= array(i,1)= .cells(i,2).value array(i,2)=.cells(i,3).value array(i,3).cells(i,4)\n</code></pre>\n"}, {"tags": ["vba", "validation"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5089787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d51d7ea033e3dd7f927ff2947d6f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Craized", "link": "https://stackoverflow.com/users/5089787/craized"}, "edited": false, "score": 0, "creation_date": 1441222205, "post_id": 32361402, "comment_id": 52595871, "body": "I chose Pavel&#39;s because I do have formulas returning &quot;&quot;.  Thank you for the quick response though!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 33, "user_id": 5089787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d51d7ea033e3dd7f927ff2947d6f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Craized", "link": "https://stackoverflow.com/users/5089787/craized"}, "edited": false, "score": 0, "creation_date": 1441223485, "post_id": 32361402, "comment_id": 52596592, "body": "I am confused. If you wanted to count zero-length strings returned by formulas as blanks then the above works; as does the solution provided by @Pavel_V. If you only wanted to count truly blank cells then an alternate method needs to be applied."}, {"owner": {"reputation": 33, "user_id": 5089787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d51d7ea033e3dd7f927ff2947d6f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Craized", "link": "https://stackoverflow.com/users/5089787/craized"}, "edited": false, "score": 0, "creation_date": 1441223734, "post_id": 32361402, "comment_id": 52596734, "body": "Sorry, I read your post incorrectly.  One of my ranges has formula that could return &quot;&quot;, the other range could have true blanks so I need a solution that can catch both (or two separate solutions for each range)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 33, "user_id": 5089787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d51d7ea033e3dd7f927ff2947d6f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Craized", "link": "https://stackoverflow.com/users/5089787/craized"}, "edited": false, "score": 0, "creation_date": 1441224067, "post_id": 32361402, "comment_id": 52596914, "body": "It&#39;s a bit of a moot point now but to catch truly blank cells the following will be True - <code>CBool(rng2.Count - application.Countif(rng2, &quot;&lt;&gt;&quot;))</code>. Only truly blank cells will be counted and any non-zero count will be true. This avoids having to crash the environment with <code>On Error Resume Next</code> when there is nothing to find."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1441224170, "last_edit_date": 1441224170, "creation_date": 1441221542, "answer_id": 32361402, "question_id": 32360939, "link": "https://stackoverflow.com/questions/32360939/vba-validating-no-empty-cells-in-ranges-before-proceeding/32361402#32361402", "title": "VBA: validating no empty cells in ranges before proceeding", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a> is <strong>Nothing</strong> when there are no <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow\">xlCellTypeBlanks</a> cells available and Nothing does not have a count; not even a count of zero.</p>\n\n<p>You can use the <code>On Error Resume Next</code> or choose a non-destructive method of determining if there are blank cells.</p>\n\n<pre><code>if cbool(application.countblank(rng2)) then\n    'there are zero-length string and/or blank cells\n    'do something\nend if\n</code></pre>\n\n<p>The problem with the above is that the worksheet's <a href=\"https://support.office.com/en-au/article/countblank-function-c72134a2-695e-43ab-a3f3-714aa770f385\" rel=\"nofollow\">COUNTBLANK function</a> will count zero-length strings returned by a formula (e.g. <code>\"\"</code>) as blanks when they are not truly blank.</p>\n\n<p>To catch only truly blank cells the following will be True - <code>CBool(rng2.Count - application.Countif(rng2, \"&lt;&gt;\"))</code>. Only truly blank cells will be counted and any non-zero count will be true. This avoids having to crash the environment with <code>On Error Resume Next</code> when there is nothing to find.</p>\n"}, {"tags": [], "owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "is_accepted": true, "score": 2, "last_activity_date": 1441221748, "creation_date": 1441221748, "answer_id": 32361464, "question_id": 32360939, "link": "https://stackoverflow.com/questions/32360939/vba-validating-no-empty-cells-in-ranges-before-proceeding/32361464#32361464", "title": "VBA: validating no empty cells in ranges before proceeding", "body": "<p>I try to avoid using goto in such way - it makes the code confusing when it gets bigger. Here is what I came up with:</p>\n\n<pre><code>Sub check_blank()\n\nDim sht As Worksheet\nDim twb As Workbook\nDim tws As Worksheet\nDim lrow As Long\nDim rng1 As Range\nDim rng2 As Range\nDim rng3 As Range\nDim finprod As Variant\nDim subprod As Variant\n\nApplication.ScreenUpdating = False\nSet wrk = ActiveWorkbook\nSet sht = wrk.Worksheets(1)\n\nFor Each sht In wrk.Worksheets\n\n\n    lrow = sht.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set rng1 = sht.Range(\"A2:A\" &amp; lrow)\n    Set rng2 = sht.Range(\"F2:F\" &amp; lrow)\n    Set rng3 = sht.Range(\"E2:E\" &amp; lrow)\n\n\n    If Application.CountIf(rng3, \"\") &gt; 0 Then\n        MsgBox (\"Invalid item number.\")\n    Exit Sub\n    End If\n\n    If Application.CountIf(rng2, \"\") &gt; 0 Then\n        MsgBox (\"Missing quantity.\")\n    Exit Sub\n    End If\n\n\nNext sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5089787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d51d7ea033e3dd7f927ff2947d6f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Craized", "link": "https://stackoverflow.com/users/5089787/craized"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 32361464, "answer_count": 2, "score": 1, "last_activity_date": 1441224170, "creation_date": 1441219839, "question_id": 32360939, "link": "https://stackoverflow.com/questions/32360939/vba-validating-no-empty-cells-in-ranges-before-proceeding", "title": "VBA: validating no empty cells in ranges before proceeding", "body": "<p>I have three ranges in a sheet (rng1, rng2, rng3) where I need to make sure that rng2 and rng3 contain no blanks before proceeding with the macro.</p>\n\n<p>I have tried several methods that I can find and cannot get any of them to work. Willing to try a different method if someone has suggestions.</p>\n\n<p>This is me trying to count blank cells using specialcells(xlCellTypeBLanks) but something isn't working with my error handling when neither range is blank:</p>\n\n<pre><code>Dim wrk As Workbook\nDim sht As Worksheet\nDim twb As Workbook\nDim tws As Worksheet\nDim lrow As Long\nDim rng1 As Range\nDim rng2 As Range\nDim rng3 As Range\nDim finprod As Variant\nDim subprod As Variant\n\nApplication.ScreenUpdating = False\nSet wrk = ActiveWorkbook\nSet sht = wrk.Worksheets(1)\n\nFor Each sht In wrk.Worksheets\nlrow = sht.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet rng1 = sht.Range(\"A2:A\" &amp; lrow)\nSet rng2 = sht.Range(\"F2:F\" &amp; lrow)\nSet rng3 = sht.Range(\"E2:E\" &amp; lrow)\nOn Error GoTo Err1\nIf rng3.SpecialCells(xlCellTypeBlanks).Count &gt; 0 Then\nMsgBox (\"Invalid item number.\")\nExit Sub\nEnd If\n\nErr1:\n    On Error GoTo Err2\n    If rng2.SpecialCells(xlCellTypeBlanks).Count &gt; 0 Then\n    MsgBox (\"Missing quantity.\")\n    Exit Sub\n    End If\nErr2:\n    On Error GoTo 0\n\n    Exit For\n    Next sht\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 1, "creation_date": 1441220696, "post_id": 32360643, "comment_id": 52595093, "body": "Are you sure it&#39;s due to the number of files?  Maybe it&#39;s a malformed file or special characters in the file name?"}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1441221910, "post_id": 32360643, "comment_id": 52595699, "body": "@Marc , good point, is there anyway of checking this other then manually?"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1441221952, "post_id": 32361329, "comment_id": 52595725, "body": "dam, could be true, how could I fix this, sigh"}, {"owner": {"reputation": 1753, "user_id": 5029763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc3efc4f0769c9f851af0b17d2a56fc?s=128&d=identicon&r=PG&f=1", "display_name": "user5029763", "link": "https://stackoverflow.com/users/5029763/user5029763"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1441226093, "post_id": 32361329, "comment_id": 52597953, "body": "It depends on the purpuse of your macro. One possibility is to verify the last filled row of wksSummary first. If the sheet is completly filled, create a new sheet (&quot;Unique data2&quot;) and continue from there."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1441294167, "post_id": 32361329, "comment_id": 52630072, "body": "im confused, seems like a complex problem. So try running it but create a new sheet?"}], "tags": [], "owner": {"reputation": 1753, "user_id": 5029763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc3efc4f0769c9f851af0b17d2a56fc?s=128&d=identicon&r=PG&f=1", "display_name": "user5029763", "link": "https://stackoverflow.com/users/5029763/user5029763"}, "is_accepted": false, "score": 0, "last_activity_date": 1441221216, "creation_date": 1441221216, "answer_id": 32361329, "question_id": 32360643, "link": "https://stackoverflow.com/questions/32360643/vba-loop-through-directory-crashing-excel/32361329#32361329", "title": "VBA, Loop through directory crashing excel", "body": "<p>Not sure if this is the cause of the error message you posted, but this part of your code could be a problem:</p>\n\n<pre><code>With wksSummary\n    Set y = .Cells(.Rows.Count, 3).End(xlUp).Offset(1, 0)\n    Set r = y.Offset(0, 1)\n    Set z = y.Offset(0, -2)\n    lngStartRow = y.Row\n    .Range(\"A1:D1\").Value = Array(\"File Name\", \"Sheet Name\", \"Node Name\", \"Scenario Name\")\nEnd With\n</code></pre>\n\n<p>If wksSummary has its third column all filled out, there will be an error when you offset(1,0). </p>\n"}], "owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441221216, "creation_date": 1441218699, "question_id": 32360643, "link": "https://stackoverflow.com/questions/32360643/vba-loop-through-directory-crashing-excel", "title": "VBA, Loop through directory crashing excel", "body": "<p>I got the following code that loops through a directory and does an advanced filter. \nWorks fine on maybe up to 20 files, when I get to 50+ files, I run into issues \"Method 'Open' of object 'workbooks' failed\". Could it just be the size of these files to large?</p>\n\n<p>Any help would be appreciated.\nThis is the debug line , which may be about my function module:</p>\n\n<pre><code>      Set wb = Workbooks.Open(fileNames(Key))\n</code></pre>\n\n<p>Here is my full code:</p>\n\n<pre><code>Sub Stackoverflow()\n\n\nDim wb As Workbook, fileNames As Object, errCheck As Boolean\n    Dim ws As Worksheet, wks As Worksheet, wksSummary As Worksheet\n    Dim y As Range, intRow As Long, i As Integer\n    Dim r As Range, lr As Long, myrg As Range, z As Range\n    Dim boolWritten As Boolean, lngNextRow As Long\n    Dim intColNode As Integer, intColScenario As Integer\n    Dim intColNext As Integer, lngStartRow As Long\n\n    Dim lngLastNode As Long, lngLastScen As Long\n\n     ' Turn off screen updating and automatic calculation\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n     ' Create a new worksheet, if required\n    On Error Resume Next\n    Set wksSummary = ActiveWorkbook.Worksheets(\"Unique data\")\n    On Error GoTo 0\n    If wksSummary Is Nothing Then\n        Set wksSummary = ActiveWorkbook.Worksheets.Add(After:=ActiveWorkbook.Worksheets(ActiveWorkbook.Worksheets.Count))\n        wksSummary.Name = \"Unique data\"\n    End If\n\n     ' Set the initial output range, and assign column headers\n    With wksSummary\n        Set y = .Cells(.Rows.Count, 3).End(xlUp).Offset(1, 0)\n        Set r = y.Offset(0, 1)\n        Set z = y.Offset(0, -2)\n        lngStartRow = y.Row\n        .Range(\"A1:D1\").Value = Array(\"File Name\", \"Sheet Name\", \"Node Name\", \"Scenario Name\")\n    End With\n\n'get user input for files to search\nSet fileNames = CreateObject(\"Scripting.Dictionary\")\nerrCheck = UserInput.FileDialogDictionary(fileNames)\nIf errCheck Then\n   Exit Sub\nEnd If\n'''\nFor Each Key In fileNames 'loop through the dictionary\n    Set wb = Workbooks.Open(fileNames(Key))\n    wb.Application.Visible = False 'make it not visible\n\n ' Check each sheet in turn\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws\n             ' Only action the sheet if it's not the 'Unique data' sheet\n            If .Name &lt;&gt; wksSummary.Name Then\n                boolWritten = False\n\n                 ' Find the Scenario column\n                intColScenario = 0\n                On Error Resume Next\n                intColScenario = WorksheetFunction.Match(\"scenarioName\", .Rows(1), 0)\n                On Error GoTo 0\n\n                If intColScenario &gt; 0 Then\n                     ' Only action if there is data in column E\n                    If Application.WorksheetFunction.CountA(.Columns(intColScenario)) &gt; 1 Then\n                         ' Find the next free column, in which the extract formula will be placed\n                        intColNext = .Cells(1, .Columns.Count).End(xlToLeft).Column + 1\n\n                         ' Assign formulas to the next free column to identify the scenario name to the left of the first _ character\n                        .Cells(1, intColNext).Value = \"Test\"\n                        lr = .Cells(.Rows.Count, intColScenario).End(xlUp).Row\n                        Set myrg = .Range(.Cells(2, intColNext), .Cells(lr, intColNext))\n                        With myrg\n                            .ClearContents\n                            .FormulaR1C1 = \"=IFERROR(LEFT(RC\" &amp; intColScenario &amp; \",FIND(INDEX({\"\"+\"\",\"\"-\"\",\"\"_\"\",\"\"$\"\",\"\"%\"\"},1,MATCH(1,--(ISNUMBER(FIND({\"\"+\"\",\"\"-\"\",\"\"_\"\",\"\"$\"\",\"\"%\"\"},RC\" &amp; _\n                            intColScenario &amp; \"))),0)), RC\" &amp; intColScenario &amp; \")-1), RC\" &amp; intColScenario &amp; \")\"\n                            .Value = .Value\n                        End With\n\n                         ' Copy unique values from the formula column to the 'Unique data' sheet, and write sheet &amp; file details\n                        .Range(.Cells(1, intColNext), .Cells(lr, intColNext)).AdvancedFilter xlFilterCopy, , r, True\n                        r.Offset(0, -2).Value = ws.Name\n                        r.Offset(0, -3).Value = ws.Parent.Name\n\n                         ' Clear the interim results\n                        .Range(.Cells(1, intColNext), .Cells(lr, intColNext)).ClearContents\n\n                         ' Delete the column header copied to the list\n                        r.Delete Shift:=xlUp\n                        boolWritten = True\n                    End If\n                End If\n\n                 ' Find the Node column\n                intColNode = 0\n                On Error Resume Next\n                intColNode = WorksheetFunction.Match(\"node\", .Rows(1), 0)\n                On Error GoTo 0\n\n                If intColNode &gt; 0 Then\n                     ' Only action if there is data in column A\n                    If Application.WorksheetFunction.CountA(.Columns(intColNode)) &gt; 1 Then\n                        lr = .Cells(.Rows.Count, intColNode).End(xlUp).Row\n\n                         ' Copy unique values from column A to the 'Unique data' sheet, and write sheet &amp; file details (if not already written)\n                        .Range(.Cells(1, intColNode), .Cells(lr, intColNode)).AdvancedFilter xlFilterCopy, , y, True\n                        If Not boolWritten Then\n                            y.Offset(0, -1).Value = ws.Name\n                            y.Offset(0, -2).Value = ws.Parent.Name\n                        End If\n\n                         ' Delete the column header copied to the list\n                        y.Delete Shift:=xlUp\n                    End If\n                End If\n\n         ' Identify the next row, based on the most rows used in columns C &amp; D\n                lngLastNode = wksSummary.Cells(wksSummary.Rows.Count, 3).End(xlUp).Row\n                lngLastScen = wksSummary.Cells(wksSummary.Rows.Count, 4).End(xlUp).Row\n                lngNextRow = WorksheetFunction.Max(lngLastNode, lngLastScen) + 1\n                If (lngNextRow - lngStartRow) &gt; 1 Then\n\n\n\n                     ' Fill down the workbook and sheet names\n                    z.Resize(lngNextRow - lngStartRow, 2).FillDown\n                    If (lngNextRow - lngLastNode) &gt; 1 Then\n                         ' Fill down the last Node value\n                        wksSummary.Range(wksSummary.Cells(lngLastNode, 3), wksSummary.Cells(lngNextRow - 1, 3)).FillDown\n                    End If\n                    If (lngNextRow - lngLastScen) &gt; 1 Then\n                         ' Fill down the last Scenario value\n                        wksSummary.Range(wksSummary.Cells(lngLastScen, 4), wksSummary.Cells(lngNextRow - 1, 4)).FillDown\n                    End If\n                End If\n\n\n\n                Set y = wksSummary.Cells(lngNextRow, 3)\n                Set r = y.Offset(0, 1)\n                Set z = y.Offset(0, -2)\n                lngStartRow = y.Row\n            End If\n        End With\n    Next ws\nwb.Close savechanges:=False 'close the workbook do not save\nSet wb = Nothing 'release the object\nNext 'End of the fileNames loop\nSet fileNames = Nothing\n\n ' Autofit column widths of the report\nwksSummary.Range(\"A1:D1\").EntireColumn.AutoFit\n\n' Reset system settings\nWith Application\n   .Calculation = xlCalculationAutomatic\n   .ScreenUpdating = True\n   .Visible = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Here is my function:</p>\n\n<pre><code>        Function FileDialogDictionary(ByRef file As Object) As Boolean ' returns true if the user cancels\n'Declare a variable as a FileDialog object.\nDim fd As FileDialog\nDim item As Variant\nDim i As Long\n'Create a FileDialog object as a File Picker dialog box.\nfile.RemoveAll 'clear the dictionary\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\n'Declare a variable to contain the path\n'of each selected item. Even though the path is a String,\n'the variable must be a Variant because For Each...Next\n'routines only work with Variants and Objects.\n'Use a With...End With block to reference the FileDialog object.\nWith fd\n    'Use the Show method to display the File Picker dialog box and return the user's action.\n    'The user pressed the action button.\n    .Title = \"Select Excel Workbooks\" 'Change this to suit your purpose\n    .AllowMultiSelect = True\n    .Filters.Clear\n    .Filters.Add \"Microsoft Excel files\", \"*.xlsx,*.xls\"\n    If .Show = -1 Then\n        'Step through each string in the FileDialogSelectedItems collection.\n        For Each item In .SelectedItems 'loop through all selected and add to dictionary\n            i = i + 1\n            file.Add i, item\n        Next item\n        FileDialogDictionary = False\n    'The user pressed Cancel.\n    Else\n        FileDialogDictionary = True\n        Set fd = Nothing\n        Exit Function\n    End If\nEnd With\nSet fd = Nothing 'Set the object variable to Nothing.\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441217156, "post_id": 32360056, "comment_id": 52593165, "body": "Why are you saving as xlExcel8 (e.g. FileFormat:=56)? Is there some restriction against an .XLSX (e.g. xlOpenXMLWorkbook or FileFormat:=51)?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441217496, "post_id": 32360056, "comment_id": 52593331, "body": "I may be wrong but wouldn&#39;t you want {...Filename: = myfolder &amp; &quot;\\&quot; &amp; GetBook2 &amp; &quot;.xls&quot; ...}"}], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1441221162, "post_id": 32360390, "comment_id": 52595345, "body": "Thanks for the quick reply!  However, it appears as though the code is not creating the Excel file, and is also deleting the .CSV file.  The code executed, and I ended up with no files.  Upon removing the &quot;Kill&quot; line and re-running, the folder just contains the two .csv files.  It appears as though it&#39;s not even saving an Excel file.  Thoughts?  Thanks again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1441221735, "post_id": 32360390, "comment_id": 52595609, "body": "The <code>MyFolder = &quot;REDACTED&quot;</code> is not a complete path to start with. It is relative to the current directory (not necessarily the directory of the active workbook). Is it intended to be a subfolder of the active workbook&#39;s path?"}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1441222066, "post_id": 32360390, "comment_id": 52595801, "body": "No reason as to why .xls and not .xlsx.  Here is a rough outline of the path, which the names redacted:    MyFolder = &quot;L:\\Folder\\Sub-Folder\\Sub-Folder&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1441222644, "post_id": 32360390, "comment_id": 52596089, "body": "I&#39;ve chopped out all of the unnecessary code and left only what is absolutely needed to perform the task you have described. Edit and change <code>Environ(&quot;TEMP&quot;) &amp; Chr(92) &amp; &quot;REDACTED&quot;</code> to <code>L:\\Folder\\Sub-Folder\\Sub-Folder</code>. This was tested and performs as expected on a subfolder of my %TEMP% folder."}, {"owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "edited": false, "score": 0, "creation_date": 1441223285, "post_id": 32360390, "comment_id": 52596477, "body": "That&#39;s awesome.  Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1441222542, "last_edit_date": 1441222542, "creation_date": 1441217774, "answer_id": 32360390, "question_id": 32360056, "link": "https://stackoverflow.com/questions/32360056/excel-vba-convert-csv-to-excel-file/32360390#32360390", "title": "Excel VBA Convert .csv to Excel File", "body": "<p>You are not calling the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278779.aspx\" rel=\"nofollow\">Dir function</a> to get the next file.</p>\n\n<pre><code>Sub Test()\n    'Set variables for the below loop\n    Dim myFolder As String\n    Dim getBook As String\n    Dim myCSVFile As String\n\n    Application.DisplayAlerts = False\n\n    myFolder = Environ(\"TEMP\") &amp; Chr(92) &amp; \"REDACTED\"\n\n    myCSVFile = Dir(myFolder &amp; \"\\*.csv\")\n\n    Do While myCSVFile &lt;&gt; \"\"\n        Workbooks.Open Filename:=myFolder &amp; \"\\\" &amp; myCSVFile\n        getBook = ActiveSheet.Name  '&lt;~ Sheet1 of an opened CSV is the name of the CSV\n        ActiveSheet.Name = \"Sheet1\"\n        ActiveWorkbook.SaveAs Filename:=myFolder &amp; Chr(92) &amp; getBook, FileFormat:=56\n        ActiveWorkbook.Close False\n        Kill myFolder &amp; Chr(92) &amp; myCSVFile  '&lt;~~ delete the CSV, not the workbook\n        myCSVFile = Dir   '&lt;~~ this is important to get the next file in the folder listing\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>The only worksheet in an opened CSV is named for the CSV (without the .CSV extension) so that can be used in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow\">Workbook.SaveAs method</a>. I've used <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198017.aspx\" rel=\"nofollow\">xlOpenXMLWorkbook</a> as the SaveAs FileFormat type.</p>\n"}], "owner": {"reputation": 219, "user_id": 5293740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e86add1b9e17ce4744bc8f05ea47c2c?s=128&d=identicon&r=PG&f=1", "display_name": "battery514", "link": "https://stackoverflow.com/users/5293740/battery514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7775, "favorite_count": 0, "accepted_answer_id": 32360390, "answer_count": 1, "score": 4, "last_activity_date": 1441222542, "creation_date": 1441216621, "question_id": 32360056, "link": "https://stackoverflow.com/questions/32360056/excel-vba-convert-csv-to-excel-file", "title": "Excel VBA Convert .csv to Excel File", "body": "<p>I have a folder which has .csv files, .xls files, and xlsx files.  The below code is a portion of an overall project (when I remove the below code, the remaining code achieves what I want).  A large chunk of the code was compiled from somewhere (here and around the internet).  What I want the code to do is open only the .csv files in the folder, convert them to an Excel file, close the files, and then delete the .csv files in the folder.  What ends up happening with the code is that one or both of the files created by the code are deleted from the folder, and I am left with nothing.  Thanks in advance for any help.</p>\n\n<pre><code>Sub Test()\n'\n' Test Macro\n'\n'Set variables for the below loop\nDim MyFolder As String\nDim MyFile As String\nDim GetBook As String\nDim GetBook2 As String\nDim MyCSVFile As String\nDim KillFile As String\nMyFolder = \"REDACTED\"\nMyFile = Dir(MyFolder &amp; \"\\*.xls\")\nMyCSVFile = Dir(MyFolder &amp; \"\\*.csv\")\n\n'Open all of the .csv files in the folder and convert to .xls\nDo While MyCSVFile &lt;&gt; \"\"\n    Workbooks.Open Filename:=MyFolder &amp; \"\\\" &amp; MyCSVFile\n    GetBook = ActiveWorkbook.Name\n    GetBook2 = Left(GetBook, Len(GetBook) - 4)\n    ActiveSheet.Name = \"Sheet1\"\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs Filename:=GetBook2, FileFormat:=56\n    ActiveWorkbook.Close False\n    Kill MyFolder &amp; \"\\\" &amp; GetBook\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 950673, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/619a3f83c24657f169eb2f0a26b8d851?s=128&d=identicon&r=PG", "display_name": "RonR", "link": "https://stackoverflow.com/users/950673/ronr"}, "edited": false, "score": 0, "creation_date": 1441219420, "post_id": 32360201, "comment_id": 52594383, "body": "Thank you.  Bummer, but now I know what I have to work with."}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": true, "score": 1, "last_activity_date": 1441217153, "creation_date": 1441217153, "answer_id": 32360201, "question_id": 32359916, "link": "https://stackoverflow.com/questions/32359916/excel-macro-for-multiple-string-autofilter/32360201#32360201", "title": "Excel macro for multiple string autofilter", "body": "<p>You cannot filter more than two criteria with wildcards. If you want to do that, you'll have to add a temporary helper column, or filter with a loop, or another workaround.</p>\n"}, {"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1441218013, "creation_date": 1441218013, "answer_id": 32360469, "question_id": 32359916, "link": "https://stackoverflow.com/questions/32359916/excel-macro-for-multiple-string-autofilter/32360469#32360469", "title": "Excel macro for multiple string autofilter", "body": "<p>As far as I am aware of, you cannot filter on the same column by more than two criteria with wildcard. I think what you would need to do is to move the filtering requirement into an additional column populated by a formula along the lines of:</p>\n\n<p>Assuming <code>ProductTypeCol</code> is column A.  </p>\n\n<pre><code>=SUM(COUNTIF($A2,{\"=*maintenance*\",\"=*services*\",\"=*training*\"}))&gt;0\n</code></pre>\n\n<p>Then filter on this column for the Trues (you can extend this to more search terms if required)</p>\n"}], "owner": {"reputation": 176, "user_id": 950673, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/619a3f83c24657f169eb2f0a26b8d851?s=128&d=identicon&r=PG", "display_name": "RonR", "link": "https://stackoverflow.com/users/950673/ronr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 32360201, "answer_count": 2, "score": 1, "last_activity_date": 1441224586, "creation_date": 1441216126, "last_edit_date": 1441224586, "question_id": 32359916, "link": "https://stackoverflow.com/questions/32359916/excel-macro-for-multiple-string-autofilter", "title": "Excel macro for multiple string autofilter", "body": "<p>I am trying to add code to a macro to autofilter based on if a specific column contains one of several strings. Here's what I did for 2 strings (R is the range):</p>\n\n<pre><code>R.AutoFilter Field:=ProductTypeCol, _\n    Criteria1:=Array(\"*maintenance*\", \"*services*\"), _\n    Operator:=xlFilterValues\n</code></pre>\n\n<p>This works exactly as I expected, and shows some rows for each string. Then I added a third string and re-executed the macro:</p>\n\n<pre><code>R.AutoFilter Field:=ProductTypeCol, _\n    Criteria1:=Array(\"*maintenance*\", \"*services*\", \"*training*\"), _\n    Operator:=xlFilterValues\n</code></pre>\n\n<p>Instead of showing some additional rows, this mysteriously results in no rows at all. </p>\n\n<p>So in search of truth, I removed the asterisks from all three strings and got exactly what I expected: rows where the value was exactly one of those strings.\nUnfortunately, I really need those asterisks.</p>\n\n<p>Am I missing something here?</p>\n"}, {"tags": ["excel", "xml", "vba", "xmlhttprequest"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441216390, "post_id": 32359729, "comment_id": 52592722, "body": "What does this mean: <i>a page that loads more items on it while you are on the page</i> ??"}, {"owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441216668, "post_id": 32359729, "comment_id": 52592904, "body": "So when I go on this website with a browser, it will open to a header and load a section at a time. I need all of these sections though. Its a company website so unfortunately I cannot just share it to make explaining it any easier."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441216988, "post_id": 32359729, "comment_id": 52593063, "body": "What do you mean by &quot;a section at a time&quot;? Is this automatically loaded? Or is it like an ajax/javascript dynamic load (i.e., as you scroll down the page, it loads more items)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441217325, "post_id": 32359729, "comment_id": 52593238, "body": "If it&#39;s not dynamic, you probably want to check for .readyState = 4."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1441219571, "post_id": 32359729, "comment_id": 52594477, "body": "@DavidZemens <code>.readyState</code> is always 4 for synchronous XHR like in code above @Forbidden your website obviously uses dynamic load, you may try to find out dynamic XHR parameters, eg in Chrome I see them in developer tools (F12) on Network tab, then just employ that parameters in your code."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1441220817, "post_id": 32359729, "comment_id": 52595151, "body": "Try approach like <a href=\"http://stackoverflow.com/a/26129999/2165759\">this</a>, if you find dynamic XHRs then at least you can add screenshots (<a href=\"http://i.stack.imgur.com/6h997.png\" rel=\"nofollow noreferrer\">like this</a>) from the browser to your question."}, {"owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "edited": false, "score": 0, "creation_date": 1441223067, "post_id": 32359729, "comment_id": 52596352, "body": "Okay I added a screen shot, I noticed that Request Method is set to POST instead of GET but when I changed it the output was the same."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441227605, "post_id": 32359729, "comment_id": 52598725, "body": "Try using <code>.Open &quot;GET&quot;, URL, False</code>. I&#39;ll update my answer to show you how to wait so the response doesn&#39;t contain the word &quot;Updating&quot; (also, you shouldn&#39;t hardcode a wait time of 30 seconds)"}], "answers": [{"comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 3, "creation_date": 1441219242, "post_id": 32360253, "comment_id": 52594268, "body": "In this case <code>.ReadyState = 4</code> condition always returns true, so the loop will be skipped since you&#39;ve set synchronous mode in third argument: <code>.Open &quot;GET&quot;, URL, False</code>."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1441219756, "post_id": 32360253, "comment_id": 52594591, "body": "You want to say you updated request to be <b>A</b>synchronous :) For what? Leaving XHR synchronous renders unnecessary <code>.ReadyState</code> check."}, {"owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1441222083, "post_id": 32360253, "comment_id": 52595813, "body": "Thank you so much for attempting, however it still pulls the page with section data saying &quot;Updating&quot;. Im trying to figure out how to find XHR parameters like @omegastripes said."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441222716, "post_id": 32360253, "comment_id": 52596131, "body": "If you can&#39;t get the parameters to work, try waiting until the response body doesn&#39;t contain the word &quot;Updating&quot; (regardless of section)"}, {"owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "edited": false, "score": 0, "creation_date": 1441223979, "post_id": 32360253, "comment_id": 52596871, "body": "Where would I put in the waiting period? before Send?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441225438, "post_id": 32360253, "comment_id": 52597590, "body": "I would add a new waiting loop after <code>If httpRequest.Status = 200</code>"}, {"owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "edited": false, "score": 0, "creation_date": 1441227093, "post_id": 32360253, "comment_id": 52598507, "body": "Gah! It looks like it about to work but I still get the &quot;Updating&quot; output. Ill put an update of my code in OP."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441231934, "post_id": 32360253, "comment_id": 52600505, "body": "Thanks for letting me know"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 5, "last_activity_date": 1441228249, "last_edit_date": 1441228249, "creation_date": 1441217322, "answer_id": 32360253, "question_id": 32359729, "link": "https://stackoverflow.com/questions/32359729/vba-xml-v6-0-how-to-make-it-wait-for-page-to-load/32360253#32360253", "title": "VBA XML V6.0 How to make it wait for page to load?", "body": "<p>Try waiting for the ready state and body of the response not to contain the word \"Updating\":</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub pullSomeSite()\n    Dim httpRequest As XMLHTTP\n    Set httpRequest = New XMLHTTP\n    Dim URL As String\n\n    URL = \"SomeSite\"\n    With httpRequest\n        .Open \"GET\", URL, False\n        .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n        .send\n    End With\n    With httpRequest\n        While Not .ReadyState = 4                               '&lt;---------- wait\n            Application.Wait Now + TimeValue(\"0:00:01\")\n        Wend\n        If .Status = 200 Then\n            While InStr(1, .responseText, \"Updating\", 0) &gt; 0    '&lt;---------- wait again\n                Application.Wait Now + TimeValue(\"0:00:01\")\n            Wend\n            Debug.Print .responseText\n            'continue...\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1593293536, "last_edit_date": 1593293536, "creation_date": 1593293047, "answer_id": 62615709, "question_id": 32359729, "link": "https://stackoverflow.com/questions/32359729/vba-xml-v6-0-how-to-make-it-wait-for-page-to-load/62615709#62615709", "title": "VBA XML V6.0 How to make it wait for page to load?", "body": "<p>A slight modification to @paul bica's answer, which hopefully can help anyone in the future.</p>\n<p>For me I just wanted to make 20 attempts, then give up and continue with other parts of the code.</p>\n<pre><code>Option Explicit\n    \nSub pullSomeSite()\n    Dim httpRequest As XMLHTTP\n    Set httpRequest = New XMLHTTP\n    Dim URL As String\n    \n    Dim count_try As Long\n    count_try = 1\n\n    URL = &quot;SomeSite&quot;\n    With httpRequest\n        .Open &quot;GET&quot;, URL, False\n        .setRequestHeader &quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;\n        .send\n    End With\n    With httpRequest\n        While Not .ReadyState = 4                               '&lt;---------- wait\n            Application.Wait Now + TimeValue(&quot;0:00:01&quot;)\n        Wend\n        If .Status = 200 Then\n            While InStr(1, .responseText, &quot;Updating&quot;, 0) &gt; 0    '&lt;---------- wait again\n                If count_try &lt; 20 Then ' Set the amount of tries before giving up\n                    Application.Wait Now + TimeValue(&quot;0:00:01&quot;)\n                    count_try = count_try + 1 'For each try, increase with 1\n                Else\n                    'If more than 20 attempts where made, jump to this part of the code to continue (not get stuck in infinity loop)\n                    GoTo ContinTry\n                End IF\n            Wend\n            Debug.Print .responseText\n            'continue...\n        End If\n    End With\n\nContinTry:      \n'Code to handle the error for example:\nCells(1,1).Value = &quot;Request Failed&quot;\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7060, "favorite_count": 0, "accepted_answer_id": 32360253, "answer_count": 2, "score": 3, "last_activity_date": 1593676781, "creation_date": 1441215497, "last_edit_date": 1593676781, "question_id": 32359729, "link": "https://stackoverflow.com/questions/32359729/vba-xml-v6-0-how-to-make-it-wait-for-page-to-load", "title": "VBA XML V6.0 How to make it wait for page to load?", "body": "<p>I have been pulling my hair out trying to find an answer for this and I cant seem to find anything useful.</p>\n\n<p>Basically I am pulling from a website that loads more items on it while you are on the page. I would like my code to pull the final data after its done loading but am not sure how to make XML httprequest wait for that.</p>\n\n<p>Edited:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub pullsomesite()\n    Dim httpRequest As XMLHTTP\n    Dim DataObj As New MSForms.DataObject\n    Set httpRequest = New XMLHTTP\n    Dim URL As String\n    URL = \"somesite\"\n     With httpRequest\n        .Open \"GET\", URL, True\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n        Application.Wait Now + TimeValue(\"0:02:00\")\n        .send\n        ' ... after the .send call finishes, you can check the server's response:\n    End With\n    While Not httpRequest.readyState = 4            '&lt;---------- wait\nWend\n If httpRequest.Status = 200 Then\n Application.Wait Now + TimeValue(\"0:00:30\")\n    Debug.Print httpRequest.responseText\n    'continue...\nEnd If\n    'Debug.Print httpRequest.Status\n    'Debug.Print httpRequest.readyState\n    'Debug.Print httpRequest.statusText\n    DataObj.SetText httpRequest.responseText\n    DataObj.PutInClipboard\n\n    With Sheets(\"Sheet1\")\n        .Activate\n        .Range(\"A1000000\").End(xlUp).Offset(1, 0).Select\n        .PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True\n    End With\nEnd Sub\n</code></pre>\n\n<h3>Screenshot</h3>\n\n<p><a href=\"https://i.imgur.com/6wjb5t5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/6wjb5t5.png\" alt=\"Screenshot\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441243770, "post_id": 32359502, "comment_id": 52603485, "body": "Are you looking to get all file details, or only <i>txt</i> file details."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441246085, "post_id": 32359502, "comment_id": 52604019, "body": "All file details please in Second Phase. Presently worked for txt files only as a sample to establish and prove the program code."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441267074, "post_id": 32359502, "comment_id": 52611588, "body": "@skkhar don&#39;t populate the data cell by cell, look at using an array as I did."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441268306, "post_id": 32359502, "comment_id": 52612363, "body": "I would be grateful if you kindly update your answer to list all files in directories and sub directories which will help me a lot in right way of placing code for my future programs. Thanks"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441272297, "post_id": 32359502, "comment_id": 52614895, "body": "for a recursive process take a look at <a href=\"http://stackoverflow.com/questions/9827715/get-list-of-subdirs-in-vba/9832978#9832978\" title=\"get list of subdirs in vba\">stackoverflow.com/questions/9827715/get-list-of-subdirs-in-v&zwnj;&#8203;ba/&hellip;</a>"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441273655, "post_id": 32359502, "comment_id": 52615821, "body": "@brettdj I am posting another update. Hope it is in-line with your suggestion"}], "answers": [{"tags": [], "owner": {"reputation": 4811, "user_id": 601622, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/306bd9f9b99cfbc85e645b821c7dbfc8?s=128&d=identicon&r=PG", "display_name": "Andy Brown", "link": "https://stackoverflow.com/users/601622/andy-brown"}, "is_accepted": false, "score": 1, "last_activity_date": 1441214986, "creation_date": 1441214986, "answer_id": 32359582, "question_id": 32359502, "link": "https://stackoverflow.com/questions/32359502/using-filesystemobject-to-list-files-getting-error/32359582#32359582", "title": "Using FileSystemObject to list files getting error", "body": "<p>You're referencing Microsoft Scriptlet Library; should be Microsoft Scripting Runtime.</p>\n"}, {"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 1, "last_activity_date": 1441215116, "creation_date": 1441215116, "answer_id": 32359612, "question_id": 32359502, "link": "https://stackoverflow.com/questions/32359502/using-filesystemobject-to-list-files-getting-error/32359612#32359612", "title": "Using FileSystemObject to list files getting error", "body": "<p>Try this:  </p>\n\n<pre><code>Sub ListFilesinFolder()\n\n    Dim FSO\n    Dim SourceFolder\n    Dim FileItem\n\n    SourceFolderName = \"C:\\mydir\"\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\") '&lt;-- New change\n    Set SourceFolder = FSO.GetFolder(SourceFolderName)\n\n    Range(\"A1:C1\") = Array(\"text file\", \"path\", \"Date Last Modified\")\n\n    i = 2\n    For Each FileItem In SourceFolder.Files\n        Cells(i, 1) = FileItem.Name\n        Cells(i, 2) = FileItem\n        Cells(i, 3) = FileItem.DateLastModified\n        i = i + 1\n    Next FileItem\n\n    Set FSO = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1441266658, "post_id": 32366418, "comment_id": 52611320, "body": "Taking cue from your program and some research, I have updated the program to list all files in directories and sub directories. Look forward to your opinion to further refine and improve it. Thanks a lot."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1441269415, "post_id": 32366418, "comment_id": 52613055, "body": "I would be grateful if you kindly update your answer to list all files in directories and sub directories which will help me a lot in right way of placing code for my future programs. Thanks"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1441275062, "post_id": 32366418, "comment_id": 52616708, "body": "I have posted revised update which is not based  on cell by cell filling method. Hope it meets your approval"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 1, "last_activity_date": 1441250523, "creation_date": 1441250523, "answer_id": 32366418, "question_id": 32359502, "link": "https://stackoverflow.com/questions/32359502/using-filesystemobject-to-list-files-getting-error/32366418#32366418", "title": "Using FileSystemObject to list files getting error", "body": "<p>Would recommend using an array approach for speed</p>\n\n<pre><code>Sub ListFilesinFolder()\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim lngCnt As Long\n    Dim X\n\n    objFolderName = \"C:\\temp\"\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.GetFolder(objFolderName)\n\n\n    ReDim X(1 To objFolder.Files.Count, 1 To 3)\n\n    For Each objFile In objFolder.Files\n        lngCnt = lngCnt + 1\n        X(lngCnt, 1) = objFile.Name\n        X(lngCnt, 2) = objFile.Path\n        X(lngCnt, 3) = Format(objFile.DateLastModified, \"dd-mmm-yyyy\")\n    Next\n\n    [a2].Resize(UBound(X, 1), 3).Value2 = X\n\n    With Range(\"A1:C1\")\n        .Value2 = Array(\"text file\", \"path\", \"Date Last Modified\")\n        .Font.Bold = True\n        .Columns.EntireColumn.AutoFit\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3303, "favorite_count": 0, "accepted_answer_id": 32366418, "answer_count": 3, "score": 2, "last_activity_date": 1441274917, "creation_date": 1441214709, "last_edit_date": 1441274917, "question_id": 32359502, "link": "https://stackoverflow.com/questions/32359502/using-filesystemobject-to-list-files-getting-error", "title": "Using FileSystemObject to list files getting error", "body": "<p>I have Excel-2007. I am using File System Object VBA code to list files in a directory. I have also set up reference to Microsoft Scriptlet Library in excel. \nI am getting:</p>\n\n<p><code>Compiler error:User-defined type not defined</code></p>\n\n<p>on this very first code line</p>\n\n<p><code>Dim FSO As Scripting.FileSystemObject</code></p>\n\n<p>Code used by me as follows:</p>\n\n<pre><code> Sub ListFilesinFolder()\n\n    Dim FSO As Scripting.FileSystemObject\n    Dim SourceFolder As Scripting.Folder\n    Dim FileItem As Scripting.File\n\n    SourceFolderName = \"C:\\mydir\"\n\n    Set FSO = New Scripting.FileSystemObject\n    Set SourceFolder = FSO.GetFolder(SourceFolderName)\n\n    Range(\"A1:C1\") = Array(\"text file\", \"path\", \"Date Last Modified\")\n\n    i = 2\n    For Each FileItem In SourceFolder.Files\n        Cells(i, 1) = FileItem.Name\n        Cells(i, 2) = FileItem\n        Cells(i, 3) = FileItem.DateLastModified\n        i = i + 1\n    Next FileItem\n\n    Set FSO = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Can someone point out where am I going wrong?</p>\n\n<pre><code>      **UPDATE -03-09-2015**   \n</code></pre>\n\n<p>I have updated my program based on @brettdj program and some research to list all files including sub-folder files. It works for me. I look forward to suggestions to further improve it.</p>\n\n<pre><code>      Sub ListFilesinFolder()\n           Dim objFSO As Object\n           Dim ws As Worksheet\n           Dim cl As Range\n           Dim objFolderName As String\n\n           objFolderName = \"C:\\FY_2015-2016\\sunil\"\n           Set objFSO = New Scripting.FileSystemObject\n\n           Set ws = ActiveSheet \n           With Range(\"A1:C1\")\n             .Value2 = Array(\"File\", \"path\", \"Date Last Modified\")\n             .Font.Bold = True\n           End With\n\n           Set cl = ws.Cells(2, 1)\n\n           ListFolders cl, objFSO.GetFolder(objFolderName)\n           Set objFSO = Nothing\n    End Sub\n\n    Sub ListFolders(rng As Range, Fol As Scripting.Folder)\n          Dim SubFol As Scripting.Folder\n          Dim FileItem As Scripting.File\n          ' List Files\n          For Each FileItem In Fol.Files\n             rng.Cells(1, 1) = FileItem.Name\n             rng.Cells(1, 2) = FileItem.ParentFolder.Path\n             rng.Cells(1, 3) = FileItem.DateLastModified\n             Set rng = rng.Offset(1, 0)\n          Next\n        ' Proces subfolders\n         For Each SubFol In Fol.SubFolders\n              ListFolders rng, SubFol\n         Next\n         With ActiveSheet\n            .Columns.EntireColumn.AutoFit\n         End With\n    End Sub\n</code></pre>\n\n<p>I am posting another update which is not cell by cell filling.\n    <strong>REVISED UPDATE ON 3-09-2015</strong></p>\n\n<pre><code>  Sub GetFileList()\n\n    Dim strFolder As String\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim myResults As Variant\n    Dim lCount As Long\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    ' Get the directory from the user\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Show\n        If .SelectedItems.Count = 0 Then Exit Sub\n        'user cancelled\n        strFolder = .SelectedItems(1)\n    End With\n\n    Set objFolder = objFSO.GetFolder(strFolder)\n\n    'the variable dimension has to be the second one\n    ReDim myResults(0 To 5, 0 To 0)\n\n    ' place make some headers in the array\n    myResults(0, 0) = \"Filename\"\n    myResults(1, 0) = \"Size\"\n    myResults(2, 0) = \"Created\"\n    myResults(3, 0) = \"Modified\"\n    myResults(4, 0) = \"Accessed\"\n    myResults(5, 0) = \"Full path\"\n\n    'Send the folder to the recursive function\n    FillFileList objFolder, myResults, lCount\n\n    ' Dump these to a worksheet\n    fcnDumpToWorksheet myResults\n\n    'tidy up\n    Set objFSO = Nothing\n\n    End Sub\n\nPrivate Sub FillFileList(objFolder As Object, ByRef myResults As Variant, ByRef lCount As Long, Optional strFilter As String)\n\n    Dim i As Integer\n    Dim objFile As Object\n    Dim fsoSubFolder As Object\n    Dim fsoSubFolders As Object\n\n    'load the array with all the files\n    For Each objFile In objFolder.Files\n        lCount = lCount + 1\n        ReDim Preserve myResults(0 To 5, 0 To lCount)\n        myResults(0, lCount) = objFile.Name\n        myResults(1, lCount) = objFile.Size\n        myResults(2, lCount) = objFile.DateCreated\n        myResults(3, lCount) = objFile.DateLastModified\n        myResults(4, lCount) = objFile.DateLastAccessed\n        myResults(5, lCount) = objFile.Path\n    Next objFile\n\n    'recursively call this function with any subfolders\n    Set fsoSubFolders = objFolder.SubFolders\n\n    For Each fsoSubFolder In fsoSubFolders\n        FillFileList fsoSubFolder, myResults, lCount\n    Next fsoSubFolder\n\nEnd Sub\n\nPrivate Sub fcnDumpToWorksheet(varData As Variant, Optional mySh As Worksheet)\n\n    Dim iSheetsInNew As Integer\n    Dim sh As Worksheet, wb As Workbook\n    Dim myColumnHeaders() As String\n    Dim l As Long, NoOfRows As Long\n\n    If mySh Is Nothing Then\n        'make a workbook if we didn't get a worksheet\n        iSheetsInNew = Application.SheetsInNewWorkbook\n        Application.SheetsInNewWorkbook = 1\n        Set wb = Application.Workbooks.Add\n        Application.SheetsInNewWorkbook = iSheetsInNew\n        Set sh = wb.Sheets(1)\n    Else\n        Set mySh = sh\n    End If\n\n    'since we switched the array dimensions, have to transpose\n    With sh\n        Range(.Cells(1, 1), .Cells(UBound(varData, 2) + 1, UBound(varData, 1) + 1)) = _\n            Application.WorksheetFunction.Transpose(varData)\n\n        .UsedRange.Columns.AutoFit\n    End With\n\n    Set sh = Nothing\n    Set wb = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441215031, "post_id": 32359441, "comment_id": 52591971, "body": "Hmm - plugged that in to <a href=\"http://www.wolframalpha.com/input/?i=fix%28log%281000%29%2Flog%2810%29%29\" rel=\"nofollow noreferrer\">Wolfram Alpha</a>, and the result is &quot;3&quot;, but look at the numberline visual, it&#39;s &quot;2&quot;...I wonder if that is what Excel&#39;s getting too?"}, {"owner": {"reputation": 115, "user_id": 2956241, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/trOQU.jpg?s=128&g=1", "display_name": "BoNDoK", "link": "https://stackoverflow.com/users/2956241/bondok"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441215198, "post_id": 32359441, "comment_id": 52592060, "body": "I don&#39;t understand your request to look at the numberline visual."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441215331, "post_id": 32359441, "comment_id": 52592130, "body": "It probably doesn&#39;t help get to an answer, but if you click the link, do you not see a numberline?  Also, <code>int(log(1000)&#47;log(10))</code> is giving <code>2</code> as well. Odd.  Why do you want to use <code>Fix()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1441215456, "last_edit_date": 1495539843, "creation_date": 1441215456, "answer_id": 32359716, "question_id": 32359441, "link": "https://stackoverflow.com/questions/32359441/vba-fix-function-double-comparisons-returning-unexpected-value/32359716#32359716", "title": "vba Fix function, double comparisons returning unexpected value", "body": "<p>Hm - I think this is how VB handles Log vs how the worksheet function handles it.  Using this, I get <code>3</code>:</p>\n\n<p><code>Debug.Print fix(worksheetfunction.log10(1000)/worksheetfunction.log10(10))</code></p>\n\n<p>I remembered I had a similar issue with Logs, and asked about it on <a href=\"https://stackoverflow.com/questions/31618472/logarithm-is-different-using-vba-and-excel-function\">SO</a>, so perhaps it's a related issue here.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1441215482, "creation_date": 1441215482, "answer_id": 32359722, "question_id": 32359441, "link": "https://stackoverflow.com/questions/32359441/vba-fix-function-double-comparisons-returning-unexpected-value/32359722#32359722", "title": "vba Fix function, double comparisons returning unexpected value", "body": "<p><code>Log(1000)/Log(10)</code> or 6.90775527898214 \u00f7 2.30258509299405 should be equal to <strong>3</strong> but it appears that the 15 digit floating point precision is generating a <a href=\"http://blogs.office.com/2008/04/10/understanding-floating-point-precision-aka-why-does-excel-give-me-seemingly-wrong-answers\" rel=\"nofollow\">15 digit precision floating point error</a> and Fix is trucating off all of the decimal. If you <a href=\"https://msdn.microsoft.com/en-us/library/aa242034(v=vs.60).aspx\" rel=\"nofollow\">Round</a> to 15 decimal places to remove the infinitesimally small error, you will receive <strong>3</strong> as your answer.</p>\n\n<pre><code>?round(log(1000)/log(10), 15)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 2, "last_activity_date": 1441219367, "last_edit_date": 1441219367, "creation_date": 1441215807, "answer_id": 32359827, "question_id": 32359441, "link": "https://stackoverflow.com/questions/32359441/vba-fix-function-double-comparisons-returning-unexpected-value/32359827#32359827", "title": "vba Fix function, double comparisons returning unexpected value", "body": "<pre><code>Debug.Print Log(1000)   '6.90775527898214\nDebug.Print Log(10)     '2.30258509299405\n\n6.90775527898214\n   /\n2.30258509299405\n=2.999999999999996      'VBA is convering this to '3#'\n\nDebug.Print Fix(3#)     '2\nDebug.Print Round(Fix(Log(1000) / Log(10)))     '2\nDebug.Print Round(Round(Fix(Log(1000)) / Round(Log(10))))   '3 (This is what you want)  \nDebug.Print (Round(Fix(Log(1000)) / Round(Log(10))))        '3 (Or may be only this)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 4956888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66f9c4e27a46292e10b24f5ef898719?s=128&d=identicon&r=PG&f=1", "display_name": "jameseg", "link": "https://stackoverflow.com/users/4956888/jameseg"}, "is_accepted": false, "score": 1, "last_activity_date": 1441216332, "creation_date": 1441216332, "answer_id": 32359968, "question_id": 32359441, "link": "https://stackoverflow.com/questions/32359441/vba-fix-function-double-comparisons-returning-unexpected-value/32359968#32359968", "title": "vba Fix function, double comparisons returning unexpected value", "body": "<p>Doing a debug on the Log function:</p>\n\n<pre><code>Public Sub Test()\n    Dim number As Double\n    number = Log(1000)\n    Debug.Print number\nEnd Sub\n</code></pre>\n\n<p>prints: 6.90775527898214</p>\n\n<p>And</p>\n\n<pre><code>Public Sub Test()\n    Dim number As Double\n    number = Log(10)\n    Debug.Print number\nEnd Sub\n</code></pre>\n\n<p>prints: 2.30258509299405 </p>\n\n<p>when you divide those you get: 2.(a lot of 9's) and calling Fix on that number will give you 2 not 3.</p>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 2956241, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/trOQU.jpg?s=128&g=1", "display_name": "BoNDoK", "link": "https://stackoverflow.com/users/2956241/bondok"}, "is_accepted": false, "score": 0, "last_activity_date": 1441222282, "creation_date": 1441222282, "answer_id": 32361605, "question_id": 32359441, "link": "https://stackoverflow.com/questions/32359441/vba-fix-function-double-comparisons-returning-unexpected-value/32361605#32361605", "title": "vba Fix function, double comparisons returning unexpected value", "body": "<blockquote>\n  <p>When you work with floating-point numbers (Single Data Type (Visual\n  Basic) and Double Data Type (Visual Basic)), remember that they are\n  stored as binary fractions. This means they cannot hold an exact\n  representation of any quantity that is not a binary fraction (of the\n  form k / (2 ^ n) where k and n are integers). For example, 0.5 (= 1/2)\n  and 0.3125 (= 5/16) can be held as precise values, whereas 0.2 (= 1/5)\n  and 0.3 (= 3/10) can be only approximations.</p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ae382yt8.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ae382yt8.aspx</a></p>\n\n<p>So what I did is created another fix function which looks like this:\n'fix has issues with</p>\n\n<pre><code>Public Function FixModified(ByVal x As Double, ByVal threshold As Double)\n    If Fix(x) = x Then\n        FixModified = x\n    ElseIf Fix(x) + 1 - x &lt; threshold Then\n        FixModified = Fix(x) + 1\n    Else\n        FixModified = Fix(x)\n    End If\nEnd Function\n</code></pre>\n\n<p>The threshold I am passing now is 0.000000000001 and it is working as expected.</p>\n"}], "owner": {"reputation": 115, "user_id": 2956241, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/trOQU.jpg?s=128&g=1", "display_name": "BoNDoK", "link": "https://stackoverflow.com/users/2956241/bondok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1441226460, "creation_date": 1441214539, "last_edit_date": 1441226460, "question_id": 32359441, "link": "https://stackoverflow.com/questions/32359441/vba-fix-function-double-comparisons-returning-unexpected-value", "title": "vba Fix function, double comparisons returning unexpected value", "body": "<p>Fix function in vba is returning 2 when 3 is passed:</p>\n\n<pre><code>Debug.Print (Fix(Log(1000) / Log(10)))\n</code></pre>\n\n<p>--> This prints 2 instead of 3</p>\n\n<p>Why is that?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7342, "user_id": 2891365, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/131e13d046177d22357db9b8f5c789fd?s=128&d=identicon&r=PG&f=1", "display_name": "user193130", "link": "https://stackoverflow.com/users/2891365/user193130"}, "is_accepted": false, "score": 0, "last_activity_date": 1441212509, "last_edit_date": 1441212509, "creation_date": 1441211702, "answer_id": 32358492, "question_id": 32358427, "link": "https://stackoverflow.com/questions/32358427/login-to-multiples-urls-with-user-password-and-export-information-to-an-excel/32358492#32358492", "title": "login to multiples URLs with user/password and export information to an excel", "body": "<p>If it's using HTTP authentication, you can try adding <code>username:password@</code> between the URI scheme and the domain name.</p>\n\n<p>For example:</p>\n\n<pre><code>https://username:password@yourdomain.com/\n</code></pre>\n\n<p>From <a href=\"http://www.w3.org/Addressing/URL/url-spec.txt\" rel=\"nofollow\">http://www.w3.org/Addressing/URL/url-spec.txt</a>:</p>\n\n<pre><code>   Those schemes which refer to internet protocols mostly have a\n   common syntax for the rest of the object name. This starts with a\n   double slash \"//\" to indicate its presence, and continues until the\n   following slash \"/\".  Within that section are   \n\n\n      An optional user name, \n                              if required (as it is with a few FTP\n                             servers). The password, is present, follows\n                             the user name, separated from it by a colon;\n                             the user name and optional password are\n                             followed by a commercial at sign \"@\".  The\n                             user of user name and passwords which are\n                             public is discouraged. \n</code></pre>\n\n<p>Note that you need to <a href=\"https://url.spec.whatwg.org/#userinfo-encode-set\" rel=\"nofollow\">% encode</a> the username &amp; password if they contain special characters. </p>\n"}], "owner": {"reputation": 1, "user_id": 5293456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84e62273fcc8739f16f36368b881e9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Matias Nicolas Fumazoni", "link": "https://stackoverflow.com/users/5293456/matias-nicolas-fumazoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441212509, "creation_date": 1441211504, "last_edit_date": 1531164843, "question_id": 32358427, "link": "https://stackoverflow.com/questions/32358427/login-to-multiples-urls-with-user-password-and-export-information-to-an-excel", "title": "login to multiples URLs with user/password and export information to an excel", "body": "<p>Good morning, I need to automatize a daily control that we must do. In every URL we have information about the servers status in tabs.</p>\n\n<p>I tried did that with excel Data > From Web, but when I share the file with my partners they aren't logged into the urls, so the automate itn't working fine. We need to open, for example an excel, refresh and get the information about the server status. I tried with multiples examples shared in this web, but I had no success. </p>\n\n<p>There are 17 urls, some with the same user and password.</p>\n\n<p>Can anybody help me? </p>\n"}, {"tags": ["excel", "wait", "vba"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1441213904, "post_id": 32358251, "comment_id": 52591284, "body": "Are you saying that you want each loop to last 1 second? Or that you want each loop to last one second plus the time it takes to execute the loop?"}], "answers": [{"comments": [{"owner": {"reputation": 1096, "user_id": 5144555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0f1046a519313e19ad3929479ec85?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S Priz", "link": "https://stackoverflow.com/users/5144555/michael-s-priz"}, "edited": false, "score": 0, "creation_date": 1441212261, "post_id": 32358558, "comment_id": 52590221, "body": "Good catch. I think I misunderstood the OP&#39;s problem. I will leave my answer up as it still offers a nice solution for wait times larger than a second."}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 1, "last_activity_date": 1441211902, "creation_date": 1441211902, "answer_id": 32358558, "question_id": 32358251, "link": "https://stackoverflow.com/questions/32358251/application-wait-in-vba/32358558#32358558", "title": "Application.wait in VBA", "body": "<p>You need to use different technique with <code>do...loop + timer</code>.</p>\n\n<pre><code>Sub WaitOneSecond()\n\n    Dim Start as single\n        start = timer\n    do while start + 1 &gt; timer\n       doevents\n    loop\nend sub\n</code></pre>\n\n<p>and in your original sub call <code>WaitOnSecond</code> where necessary:</p>\n\n<pre><code>Sub workwithdelay()\n(...)\n\nFor i = 1 To done\n(...)\ncall WaitOnSecond\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Some information to above:</p>\n\n<ol>\n<li><code>timer</code> counts seconds and milliseconds from midnights of today</li>\n<li>be careful with my code run just before midnight- it is not correct when new day starts</li>\n<li><code>application.wait</code> doesn't recognise milliseconds therefore you are not able to get exact 1 second waiting time</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1096, "user_id": 5144555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0f1046a519313e19ad3929479ec85?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S Priz", "link": "https://stackoverflow.com/users/5144555/michael-s-priz"}, "is_accepted": true, "score": 1, "last_activity_date": 1441212068, "creation_date": 1441212068, "answer_id": 32358621, "question_id": 32358251, "link": "https://stackoverflow.com/questions/32358251/application-wait-in-vba/32358621#32358621", "title": "Application.wait in VBA", "body": "<p>You have the right idea, but I think what you want is the <code>TimeValue</code> function (<a href=\"http://www.techonthenet.com/excel/formulas/timevalue.php\" rel=\"nofollow\">documented here</a>).</p>\n\n<p>You can use it like this:</p>\n\n<pre><code>Dim StartTime as Date\nDim EndTime as Date\n\nStartTime =  Now\nEndTime = StartTime + TimeValue(\"00:00:01\")\n' Do Stuff\nApplication.Wait EndTime\n</code></pre>\n\n<p>This will cause the application to wait until one second after the <em>start</em> of the <code>Do Stuff</code> section, which I think is what you are asking for.</p>\n\n<p>Hope this helps :)</p>\n"}], "owner": {"reputation": 142, "user_id": 5290180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KFw6h.jpg?s=128&g=1", "display_name": "nikhil patil", "link": "https://stackoverflow.com/users/5290180/nikhil-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3246, "favorite_count": 0, "accepted_answer_id": 32358621, "answer_count": 2, "score": 0, "last_activity_date": 1441212068, "creation_date": 1441210947, "last_edit_date": 1531164843, "question_id": 32358251, "link": "https://stackoverflow.com/questions/32358251/application-wait-in-vba", "title": "Application.wait in VBA", "body": "<p>I want to add wait time of 1 second in my Application. </p>\n\n<hr>\n\n<p><strong>What I found online?</strong> </p>\n\n<pre><code>newHour = Hour(Now())\n   newMinute = Minute(Now())\n   newSecond = Second(Now()) + 1\n   waitTime = TimeSerial(newHour, newMinute, newSecond)\n   Application.Wait waitTime\n</code></pre>\n\n<hr>\n\n<p><strong>Here is my code</strong> </p>\n\n<pre><code>Sub workwithdelay()\nDim i As Integer\nDim done As Integer\nDim newHour As Integer\nDim newMinute As Integer\nDim newSecond As Integer\nDim waitTime As String\nDim ws As Worksheet\n\n\nSet ws = ActiveSheet\n\nframe = Cells(1, \"A\").Value\n\n\nFor i = 1 To done\n\nnewHour = Hour(Now)\nnewMinute = Minute(Now)\nnewSecond = second(Now) + 1\nwaitTime = newHour: newMinute: newSecond\n\n(ALL of work Code)\n\nApplication.Wait waitTime\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The code takes 0.30 seconds to 0.45 seconds to complete one cycle in for loop(not including wait time) depending on the processing of data. I want to add a definite 1 second to complete one for loop cycle no matter what the processing time of the loop is.    </p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441209964, "post_id": 32357812, "comment_id": 52588916, "body": "Could you post a small sample table of what you have and what you expect to happen? I kind of understand, but some (can be fake) data would help."}], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1441885151, "post_id": 32357905, "comment_id": 52861040, "body": "Or INDEX or whatever. The easiest way is to use a formula to get the particular value you want in its own section of the worksheet, and plot this range. The chart range doesn&#39;t move, but it changes as the formula updates."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1441209690, "creation_date": 1441209690, "answer_id": 32357905, "question_id": 32357812, "link": "https://stackoverflow.com/questions/32357812/using-a-formula-as-a-range/32357905#32357905", "title": "Using a formula as a range", "body": "<p>I think you need to find out about the function INDIRECT.</p>\n"}], "owner": {"reputation": 11, "user_id": 5293328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bf76a7cca5fc322f7efadb1086ed995?s=128&d=identicon&r=PG&f=1", "display_name": "MGordon", "link": "https://stackoverflow.com/users/5293328/mgordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 32357905, "answer_count": 1, "score": 0, "last_activity_date": 1441209690, "creation_date": 1441209428, "question_id": 32357812, "link": "https://stackoverflow.com/questions/32357812/using-a-formula-as-a-range", "title": "Using a formula as a range", "body": "<p>I have a bit of an inventory tracking program in excel 2010 that we are using at my workplace.  It is used to track our chemical usage and packaged goods.</p>\n\n<p>Currently it is a bit bulky, if we change a product from one tank to another, there is a bit of reprogramming that needs to be done every time.  I want a co-worker to be able to do all of this easily without knowledge of VBA.</p>\n\n<p>There are different sized tanks that each have their own gauge chart that gets referenced by the program to determine volume removed or delivered etc.</p>\n\n<p>So my question is...  </p>\n\n<p>Can I use a formula as a range?  I would then be able to just change a cell in the workbook so that the VBA programming would reference a different gauge chart.</p>\n\n<p>P.S. - I have tried to find information on something like this but have turned up nil.</p>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441210048, "post_id": 32357683, "comment_id": 52588968, "body": "Use a counter to count up as you go through the loop.  HTML doesn&#39;t have an &quot;Index&quot; concept.  Code looks odd though - you&#39;re getting all td&#39;s with class name &quot;tdData&quot;, but within the loop you&#39;re checking for className &quot;tdTitle&quot; - that should never be true (from your sample HTML)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441210311, "post_id": 32357683, "comment_id": 52589113, "body": "I thought it did? Say I use the counter and find that the info I want happens when <code>i = 3</code>.  Instead of writing an If statement to check, I thought you could do something like <code>Document.getElementByClassName(&quot;tdData&quot;)(3)</code> which would only pull the third one?  (Perhaps that&#39;s not called &quot;index&quot;, sorry for my lack of technical jargon with the HTML stuff :P)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441210638, "post_id": 32357683, "comment_id": 52589293, "body": "(Note: I am trying to learn and found <a href=\"http://stackoverflow.com/questions/16141394/excel-vba-get-content-from-online-html-table\">this</a> page, which is where my thinking comes from)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1441211261, "post_id": 32357683, "comment_id": 52589674, "body": "<code>Document.getElementByClassName(&quot;tdData&quot;)(3)</code> Yes, you can do this (though that index starts at zero so that would give you the <i>fourth</i> element)  I just meant that HTML document elements don&#39;t have a direct <code>Index</code> property"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441211817, "post_id": 32357683, "comment_id": 52589979, "body": "What is the <code>type</code> for the <code>Document.getElementByClassName(&quot;tdData&quot;)(3)</code>?  Because when I use that for <code>Set TDelementsRef = HTMLdoc.getElementsByClassName(&quot;tdData&quot;)(3)</code>, I get a &quot;Run Time Error 13: Type Mismatch&quot;.  What would I need to change, so that <code>TDelementsRef</code> gets set to <code>123456789</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1441212577, "post_id": 32357683, "comment_id": 52590394, "body": "You&#39;ve declared <code>TDelementsRef</code> as a Collection, but you&#39;re trying to set it to a single element.  If you only want to get the value of the td then <code>Document.getElementByClassName(&quot;tdData&quot;)(3).innerText</code> should give you that"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441212738, "post_id": 32357683, "comment_id": 52590502, "body": "Aha! That works (note I also had to change <code>TDElementsRef</code> to a <code>String</code>).  Thanks so much @TimWilliams! (if you put that as an answer, I&#39;ll mark as such)."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1441220089, "creation_date": 1441220089, "answer_id": 32361002, "question_id": 32357683, "link": "https://stackoverflow.com/questions/32357683/get-html-element-index-number/32361002#32361002", "title": "Get HTML Element index number?", "body": "<p>You've declared <code>TDelementsRef</code> as a Collection, but you're trying to set it to a single element. </p>\n\n<p>If you only want to get the value of a single specific td element then:</p>\n\n<pre><code>Dim tdVal as String\ntdVal = Document.getElementByClassName(\"tdData\")(3).innerText \n</code></pre>\n\n<p>should do what you need.</p>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2300, "favorite_count": 0, "accepted_answer_id": 32361002, "answer_count": 1, "score": 1, "last_activity_date": 1501324311, "creation_date": 1441209105, "last_edit_date": 1501324311, "question_id": 32357683, "link": "https://stackoverflow.com/questions/32357683/get-html-element-index-number", "title": "Get HTML Element index number?", "body": "<p>I'm trying to write something that pulls the <code>.innerText</code> from an HTML element.  Here's my applicable code:</p>\n\n<pre><code>Sub test()\nDim URL = \"https:// ** the website **\"\nDim TDelements As IHTMLElementCollection, TDElementsRef As IHTMLElementCollection\nSet IE = New InternetExplorer\nWith IE\n    .Navigate URL\n    .Visible = True\n\n    ' Wait for the page to load\n    While .Busy Or .READYSTATE &lt;&gt; 4: DoEvents: Wend\n    Set HTMLdoc = .Document\nEnd With\n\nSet TDelements = HTMLdoc.getElementsByTagName(\"td\")\nSet TDElementsRef = HTMLdoc.getElementsByClassName(\"tdData\")\n\nr = 0\n\nFor Each TDelement In TDElementsRef\n    If bGetNext Then\n        Range(\"A1\").Offset(r - 1, 1).Value = TDelement.innerText\n        bGetNext = False\n    End If\n    Debug.Print TDelement.innerText\n    If TDelement.className = \"tdTitle\" Then\n        If TDelement Then\n            Range(\"A1\").Offset(r + 1, 0).Value = TDelement(2).innerText\n            bGetNext = True 'Trigger to get the information from the next TDelement\n            r = r + 1\n        End If\n    End If\nNext\nEnd sub\n</code></pre>\n\n<p>This will loop through all the info in between the <code>&lt;td&gt;</code> tags in the HTML.  How though, do I ask VB what INDEX I'm currently at? I tried doing (just after the two <code>Debug.Print</code> lines) <code>Debug.Print TDelement.Index</code> but of course that's not right.  How do I get the index of each TDelement??</p>\n\n<p>The HTML looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f6WI6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f6WI6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and I just need to get the info in Green.</p>\n"}, {"tags": ["vba", "loops", "events", "target", "worksheet"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1441211116, "creation_date": 1441211116, "answer_id": 32358306, "question_id": 32357604, "link": "https://stackoverflow.com/questions/32357604/vba-running-a-variable-loop-during-a-worksheet-change-event/32358306#32358306", "title": "VBA Running a Variable Loop during a Worksheet Change Event", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n\n    Dim rw As Range\n\n    If Application.Intersect(Target, Me.Columns(1)) Is Nothing Then Exit Sub\n\n    'On Error GoTo enditall\n\n    Application.EnableEvents = False\n\n    For Each rw In Target.Rows\n\n        If rw.Cells(1, \"A\").Value &lt;&gt; \"\" Then\n            rw.Cells(1, \"J\") = DateValue(Left(rw.Cells(1, \"H\"), 10))\n            rw.Cells(1, \"k\") = Left(rw.Cells(1, \"B\"), 3)\n            rw.Cells(1, \"L\") = Mid(rw.Cells(1, \"B\"), 5, 2)\n            rw.Cells(1, \"M\") = Left(rw.Cells(1, \"D\"), 1)\n            If rw.Cells(1, \"M\") = \"B\" Then rw.Cells(1, \"N\") = rw.Cells(1, \"E\")\n            If rw.Cells(1, \"M\") = \"S\" Then rw.Cells(1, \"N\") = rw.Cells(1, \"E\") * -1\n        End If\n\n    Next rw\n\nenditall:\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5293168, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2hd96JAJYOU/AAAAAAAAAAI/AAAAAAAAXdU/Xnu0ULj_ym0/photo.jpg?sz=128", "display_name": "CaptainDanJ", "link": "https://stackoverflow.com/users/5293168/captaindanj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "accepted_answer_id": 32358306, "answer_count": 1, "score": 1, "last_activity_date": 1441211116, "creation_date": 1441208871, "question_id": 32357604, "link": "https://stackoverflow.com/questions/32357604/vba-running-a-variable-loop-during-a-worksheet-change-event", "title": "VBA Running a Variable Loop during a Worksheet Change Event", "body": "<p>Having trouble getting a variable loop working.</p>\n\n<p>The spreadsheet works by pasting new data into the next blank row in column A to H, and has a variable number of rows each time.</p>\n\n<p>The change event happens when the target row in column A is &lt;> 0 and information is extrapolated from the pasted data and shown in columns J to N. But this code only works on the top line of new data. I believe it requires a loop but I am unsure how to make this work?</p>\n\n<p>I've tried to find a good example online but I am struggling and failing with each attempt. Massive thanks to anyone who can help me or point me in the right direction!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nOn Error GoTo enditall\nIf Target.Cells.Column = 1 Then\n\n    n = Target.row\n    arange = Range(\"A\" &amp; n)\n    brange = Range(\"B\" &amp; n)\n    crange = Range(\"C\" &amp; n)\n    drange = Range(\"D\" &amp; n)\n    erange = Range(\"E\" &amp; n)\n    frange = Range(\"F\" &amp; n)\n    grange = Range(\"G\" &amp; n)\n    hrange = Range(\"H\" &amp; n)\n\n    Dim myRange As Excel.Range\n    Dim myCell As Excel.Range\n    Set myRange = Target\n\nApplication.EnableEvents = False\n\nFor Each myCell In myRange.Cells\nIf Excel.Range(\"A\" &amp; n).Value &lt;&gt; \"\" Then\n    Excel.Range(\"J\" &amp; n) = DateValue(Left(hrange, 10))\n    Excel.Range(\"k\" &amp; n) = Left(brange, 3)\n    Excel.Range(\"L\" &amp; n) = Mid(brange, 5, 2)\n    Excel.Range(\"M\" &amp; n) = Left(drange, 1)\n    If Excel.Range(\"M\" &amp; n) = \"B\" Then Excel.Range(\"N\" &amp; n) = erange\n    If Excel.Range(\"M\" &amp; n) = \"S\" Then Excel.Range(\"N\" &amp; n) = erange * -1\nEnd If\nNext\n\nEnd If\n</code></pre>\n\n<p>enditall:</p>\n\n<pre><code>Application.EnableEvents = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "add-in", "password-protection", "userform"], "owner": {"reputation": 938, "user_id": 1964692, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/dBSCt.jpg?s=128&g=1", "display_name": "Korean_Of_the_Mountain", "link": "https://stackoverflow.com/users/1964692/korean-of-the-mountain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450398874, "creation_date": 1441208451, "last_edit_date": 1450398874, "question_id": 32357477, "link": "https://stackoverflow.com/questions/32357477/modify-user-form-from-password-protected-add-ins", "title": "Modify user form from password protected Add-In&#39;s", "body": "<p>I'm trying to automate a process where I run a macro in an Excel Add-In. The Add-In macro requires user to populate a user form. The Excel Add-In is also password protected.</p>\n\n<p>I know there's a way to write macros that populate user forms. I know that I first need the names of the form fields to modify them in the macro, BUT how do I get this information if the information is in a password protected Add-In?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441209061, "post_id": 32357470, "comment_id": 52588312, "body": "Welcome to SO.  SO is a place to have the community help find and correct issues with existing code.  If you have code you have tried please post it.  If what is wanted is for the community to write code from scratch, that is not what SO is for."}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441210516, "post_id": 32357470, "comment_id": 52589222, "body": "Thank You so much... this is the code I&#39;ve been trying."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441213228, "post_id": 32357470, "comment_id": 52590814, "body": "Post that code to your original post, and wrap with the code tags. (highlight the text, and click the {} button)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441251235, "post_id": 32366386, "comment_id": 52605121, "body": "Thanks immensely...but when I paste the code you suggested in cell A1 and ch ange the value in the linked cells it gives me the following massage: Run-time error &#39;91&#39;. &#39;Object Variable or with Block Variable not set&#39;"}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441251959, "post_id": 32366386, "comment_id": 52605299, "body": "Sorry ... Hmm I put that in my excel and it works... I&#39;m not sure about &quot;pasting into cell A1&quot;.  You put the code exactly as is into your VBA window into the Sheet you are making the changes on right? Because the action is &quot;Worksheet_Change&quot; it has to be put into the VBA window for the specific worksheet you are working with."}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441252896, "post_id": 32366386, "comment_id": 52605533, "body": "Did I do a wrong thing?... I click the cell A1 and click the view code in the developer and paste there. Any help to get rectified this problem would be highly appreciated. Thanks in advance"}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441253380, "post_id": 32366386, "comment_id": 52605632, "body": "From there does it say Worksheet and Change in the top of the editor window? I added an image of what it should look like in my original answer."}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441255338, "post_id": 32366386, "comment_id": 52606139, "body": "Ok after some playing around I think I recreated your error. Two things.    1. You have to paste the code and save it before testing it or it will throw and error.  and    2. you have to save it as an .xlsm (Macro enabled workbook) in order to save a workbook with VBA in it or it will throw that error."}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441265239, "post_id": 32366386, "comment_id": 52610508, "body": "Sorry, I had to go off line for an urgent matter.... Yes, same as you mentioned... when I pasted in &quot;view code&quot;of developer I got &#39;Worksheet&#39; and &#39;Change&#39; in the top of the editor window.   Also, I saved it in Macro enable work book and reopened. But same error popups. Please note the cells in &#39;A&#39; column linked with other cells in columns &#39;B&#39; &#39;C&#39; and &#39;D&#39; and when the value of those cells changes the error comes even though the value of the cells of column &#39;A&#39; less than 12. When I manually change the value of cells in column &#39;A&#39; your code works perfectly, but formula will be erased."}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441341134, "post_id": 32366386, "comment_id": 52649192, "body": "do you have a way to put a link to your file somewhere I can get to it with example data so I can see more what you are trying to accomplish... I think my issue is that I&#39;m confused about how the number changes that is being evaluated."}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441348197, "post_id": 32366386, "comment_id": 52651724, "body": "Thank you very much. Would you please give me an email address so I can mail a part of the file in which you can add the code?"}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441354100, "post_id": 32366386, "comment_id": 52654875, "body": "Christopher.gambill@yahoo.com"}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441372797, "post_id": 32366386, "comment_id": 52666198, "body": "Thank you... I have emailed the file."}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441466850, "post_id": 32366386, "comment_id": 52696259, "body": "A gentle reminder about my request... kindly attend to it."}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441467350, "post_id": 32366386, "comment_id": 52696421, "body": "Sorry I was on the road all day yesterday. I&#39;ll take a look today and get back to you"}, {"owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "reply_to_user": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441513335, "post_id": 32366386, "comment_id": 52705969, "body": "sorry about the delay I added the adjusted code which seems to work in your workbook you sent me."}, {"owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "edited": false, "score": 0, "creation_date": 1441522031, "post_id": 32366386, "comment_id": 52707335, "body": "Thank you very much. When you get a free time would you kindly send me the file with your code? I really appreciate this."}], "tags": [], "owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "is_accepted": false, "score": 0, "last_activity_date": 1441513260, "last_edit_date": 1441513260, "creation_date": 1441250232, "answer_id": 32366386, "question_id": 32357470, "link": "https://stackoverflow.com/questions/32357470/how-to-pop-up-a-message-in-excel-depending-on-the-value-of-a-cell-range/32366386#32366386", "title": "How to pop up a message in Excel depending on the value of a cell range?", "body": "<p>Ok, So I think I understand your question to be stating that if the cell is changed to anything greater than 12 you need the message box to fire. This would be the code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) \n    If Intersect(Target, Range(\"A1:A300\")) &gt; 12 Then \n        MsgBox \"add \" &amp; Target.value - 12 &amp; \" into the existing Forfeited PH value?\" \n    End If \nEnd Sub\n</code></pre>\n\n<p>That is based on the existing message you have in your message box... I'm assuming based on the message that increasing the ph lowers the number so maybe the number is the acidity? Regardless. That should get the result you are looking for. In fact, if you don't want to limit it to 300 rows, you can just put your range as \"A:A\" and you can select the whole column as your field.\nOk after review of your spreadsheet the issue is you are not actually changing the target so all the target code is not useful ... please use the code below which should apply relative to the sheet you sent me in email. and be sure you of course save the file as an .xlsm file. </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nOn Error GoTo eSub\n If (Worksheets(\"2015\").Range(Cells(ActiveCell.Row, 5), Cells(ActiveCell.Row, 5)) - 12 - Worksheets(\"2015\").Range(Cells(ActiveCell.Row, 6), Cells(ActiveCell.Row, 6))) &gt; 0 Then\n        MsgBox \"add \" &amp; Worksheets(1).Range(Cells(ActiveCell.Row, 5), Cells(ActiveCell.Row, 5)) - 12 &amp; \" into the Forfeited PH value?\"\n End If\neSub:\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5293209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13471c3330bb7670e9dd5a6f725e5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Leonard W.", "link": "https://stackoverflow.com/users/5293209/leonard-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6788, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1441513260, "creation_date": 1441208424, "last_edit_date": 1531164843, "question_id": 32357470, "link": "https://stackoverflow.com/questions/32357470/how-to-pop-up-a-message-in-excel-depending-on-the-value-of-a-cell-range", "title": "How to pop up a message in Excel depending on the value of a cell range?", "body": "<p>I have variable values in the cells of column A starting with cell A1. I want to write a VB code to popup different message boxes if the value in the targeted cells become equal to 12, and equal to 13, and so. But less than 12 no need a massage box to popup. The cells in the column A has formula which is relevant to the cells in same sheet.   </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) \n    If Intersect(Target, Range(\"A24:A300\")) = 13 Then \n        MsgBox \"add 1 into the existing Forfeited PH value?\" \n    End If \n    If Intersect(Target, Range(\"A24:A300\")) = 14 Then \n        MsgBox \"add 2 into the existing Forfeited PH value?\" \n    End If \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 2, "creation_date": 1441207717, "post_id": 32356922, "comment_id": 52587401, "body": "rather than looping through each row, couldn&#39;t you just filter by country name (or code) and copy over the visible rows?  Just build up a list of unique county names and loop through that.  Doing it this way, you don&#39;t have to worry about blank rows (and it&#39;ll be a lot faster)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441207727, "post_id": 32356922, "comment_id": 52587412, "body": "Take out your error resume next and see it troughs an error.  My guess is that it is doing that and skipping your end of loop statement."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441209265, "post_id": 32356922, "comment_id": 52588429, "body": "Do Until IsEmpty(ActiveCell).  Dodgy.  Your code looks OK, but why no replace using ActiveCell with a range variable set set be the ActiveCell prior to the loop, then adjust teh range variable using offset (like you currently do) later.   This way you can be &quot;more sure&quot; the active cell is not changing inadvertently.."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 3954329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbff3e9e185d4f8012928694bbf9719?s=128&d=identicon&r=PG&f=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/3954329/bart"}, "is_accepted": true, "score": 0, "last_activity_date": 1441406350, "last_edit_date": 1495541680, "creation_date": 1441374427, "answer_id": 32399725, "question_id": 32356922, "link": "https://stackoverflow.com/questions/32356922/report-split-excel-vba-doesnt-copy-all-rows-and-runs-indefinetly/32399725#32399725", "title": "Report Split - Excel VBA Doesn&#39;t Copy all Rows and runs Indefinetly", "body": "<p>Solved it. </p>\n\n<p>I have used filters as recommended by @sous2817 \nInstead of running couple of hours - it does the entire job within 2 minutes :D</p>\n\n<p>Thanks for your help</p>\n\n<p>Problem has been solved here: <a href=\"https://stackoverflow.com/questions/32374003/excel-vba-autofilter-adds-empty-rows\">Excel VBA AutoFilter adds empty rows</a></p>\n"}], "owner": {"reputation": 45, "user_id": 3954329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbff3e9e185d4f8012928694bbf9719?s=128&d=identicon&r=PG&f=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/3954329/bart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 32399725, "answer_count": 1, "score": 0, "last_activity_date": 1441406350, "creation_date": 1441206818, "last_edit_date": 1441225140, "question_id": 32356922, "link": "https://stackoverflow.com/questions/32356922/report-split-excel-vba-doesnt-copy-all-rows-and-runs-indefinetly", "title": "Report Split - Excel VBA Doesn&#39;t Copy all Rows and runs Indefinetly", "body": "<p>I have written the following Excel VBA Macro, its job is to split a report based on CountryCode. It creates a new workbook, copies the relevant rows to a new workbook, saves the workbook by the CountryCode. </p>\n\n<p>The problem I encouter is missing rows and for one worksheet, it continues running on empty rows? - Basically it doesn't stop and copies over empty rows.</p>\n\n<p>Has cell formatting anything to do with it?</p>\n\n<p>There is another Macro that runs only once which creates the workbooks first. It is only run once on the first worksheet, never again.</p>\n\n<pre><code>Sub RUN2_ReportSplitterOptimized()\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n' Current Workbook\n    Dim cW As Workbook\n    Dim cWL As String\n    Dim cWN As String\n\n    Set cW = ThisWorkbook\n    cWL = cW.Path\n    cWN = cW.Name\n\n' Current Worksheet\n    Dim cS As Worksheet\n    Set cS = ActiveSheet\n\n    Do Until IsEmpty(ActiveCell)\n\n' Current Active Cell\n        Dim aC As Range\n        Set aC = ActiveCell\n\n' Split input string\n        Dim CC As String\n        CC = splitCC(aC.Text)\n\n        Dim wb As Workbook\n        Dim ws As Worksheet\n\n        On Error Resume Next\n        Set wb = Workbooks(CC &amp; \".xlsx\")\n        If Err.Number &lt;&gt; 0 Then\n            Set wb = Workbooks.Open(cWL &amp; \"\\\" &amp; CC &amp; \".xlsx\")\n            ' Create the worksheet\n            Set ws = wb.Sheets.Add\n            ' Copy the row to the worksheet\n            ws.Rows(1).Value = cS.Rows(1).Value\n            ws.Rows(2).Value = aC.EntireRow.Value\n\n            With ws\n                .Name = cS.Name\n            End With\n        Else\n            wb.Activate\n            On Error Resume Next\n            Set ws = wb.Sheets(cS.Name)\n            If Err.Number &lt;&gt; 0 Then\n                Set ws = wb.Sheets.Add\n                ' Copy the row to the worksheet\n                ws.Rows(1).Value = cS.Rows(1).Value\n                ws.Rows(2).Value = aC.EntireRow.Value\n                With ws\n                    .Name = cS.Name\n                End With\n            Else\n            LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n            ws.Rows(LastRow + 1).Value = aC.EntireRow.Value\n            End If\n        End If\n    wb.Save\n    cW.Activate\n    aC.Offset(1, 0).Select\n    Loop\nDim wbk As Workbook\nFor Each wbk In Workbooks\n    If Len(wbk.Name) = 7 Then\n        wbk.Close\n    End If\nNext\nEnd Sub\n\nFunction splitCC(countrycode As String) As String\nIf Len(countrycode) &lt; 3 Then\n    splitCC = countrycode\nElse\n    splitCC = Mid(countrycode, InStr(countrycode, \"(\") + 1, 2)\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441206894, "post_id": 32356692, "comment_id": 52586825, "body": "Code looks ok. What line is it failing on?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441206991, "post_id": 32356692, "comment_id": 52586909, "body": "Is the sheet protected?"}, {"owner": {"reputation": 158, "user_id": 5293100, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207991111322193/picture?type=large", "display_name": "Klevin Delimeta", "link": "https://stackoverflow.com/users/5293100/klevin-delimeta"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441208368, "post_id": 32356692, "comment_id": 52587880, "body": "@brettdj, its failing on Set aCell = .Columns(1).Find(....."}, {"owner": {"reputation": 158, "user_id": 5293100, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207991111322193/picture?type=large", "display_name": "Klevin Delimeta", "link": "https://stackoverflow.com/users/5293100/klevin-delimeta"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441208393, "post_id": 32356692, "comment_id": 52587902, "body": "@Rory no the sheet is not protected, pls help"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441208618, "post_id": 32356692, "comment_id": 52588052, "body": "As @brettdj said, there&#39;s nothing wrong with the code as written."}, {"owner": {"reputation": 158, "user_id": 5293100, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207991111322193/picture?type=large", "display_name": "Klevin Delimeta", "link": "https://stackoverflow.com/users/5293100/klevin-delimeta"}, "edited": false, "score": 0, "creation_date": 1441208945, "post_id": 32356692, "comment_id": 52588240, "body": "This is the first function, which calls kl():                        Private Sub Worksheet_Change(ByVal Target As Range)      If Not Application.Intersect(Target, Range(&quot;C1:C300&quot;)) Is Nothing Then     kl                                                                                         End If                                                                                   End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 5293100, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207991111322193/picture?type=large", "display_name": "Klevin Delimeta", "link": "https://stackoverflow.com/users/5293100/klevin-delimeta"}, "edited": false, "score": 0, "creation_date": 1441276583, "post_id": 32358190, "comment_id": 52617637, "body": "I tried it and it perfectly worked, thank you very much"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 0, "last_activity_date": 1441210744, "last_edit_date": 1525816189, "creation_date": 1441210744, "answer_id": 32358190, "question_id": 32356692, "link": "https://stackoverflow.com/questions/32356692/vba-excel-macro-run-time-error-1004-when-trying-to-find/32358190#32358190", "title": "VBA Excel Macro Run-time error &#39;1004&#39; when trying to .Find()", "body": "<p>your code</p>\n\n<pre><code>aCell.Value = \"Test\"\n</code></pre>\n\n<p>will cause the event code to execute again!</p>\n\n<p>Please see <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">this</a> page, look for the section \"Preventing Event Loops\".</p>\n\n<p>If has other info that is worth reading.</p>\n\n<p>So adding code similar this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    Target.Value = Target.Value + 1\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 5293100, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207991111322193/picture?type=large", "display_name": "Klevin Delimeta", "link": "https://stackoverflow.com/users/5293100/klevin-delimeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "accepted_answer_id": 32358190, "answer_count": 1, "score": -1, "last_activity_date": 1441210744, "creation_date": 1441206144, "last_edit_date": 1441206640, "question_id": 32356692, "link": "https://stackoverflow.com/questions/32356692/vba-excel-macro-run-time-error-1004-when-trying-to-find", "title": "VBA Excel Macro Run-time error &#39;1004&#39; when trying to .Find()", "body": "<p>i am new to macro, and wanted to find a text or part of text from a range in a worksheet, i researched and found this code:</p>\n\n<pre><code>Set aCell = .Columns(1).Find(What:=\"Custom \", LookIn:=xlValues, _\n                LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                MatchCase:=False, SearchFormat:=False)\n</code></pre>\n\n<p>But when i run, it gives me 1004 error. So this is my full sub:</p>\n\n<pre><code>Sub kl()\n    Dim ws As Worksheet\n    Dim aCell As Range\n\n    Set ws = ThisWorkbook.Sheets(\"te-dhenat\")\n\n    With ws\n        Set aCell = .Columns(1).Find(What:=\"Custom \", LookIn:=xlValues, _\n                    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n        If Not aCell Is Nothing Then\n            aCell.Value = \"Test\"\n        Else\n            MsgBox \"Not Found\"\n        End If\n    End With \n\nEnd Sub\n</code></pre>\n\n<p>i think the code looks good, so i don't know why excel is showing this error, please help, and thank you in advance</p>\n"}, {"tags": ["vba", "ms-word", "shapes"], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 4119126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/970405749664f65ae1f862a6caa1b499?s=128&d=identicon&r=PG&f=1", "display_name": "Mostafa Anssary", "link": "https://stackoverflow.com/users/4119126/mostafa-anssary"}, "is_accepted": false, "score": 0, "last_activity_date": 1516500310, "last_edit_date": 1516500310, "creation_date": 1513619021, "answer_id": 47873750, "question_id": 32356475, "link": "https://stackoverflow.com/questions/32356475/vba-word-smartarts-and-range/47873750#47873750", "title": "VBA Word : SmartArts and range", "body": "<p>firt It not like Question but it is task but i will give you some hint to help you</p>\n\n<p>1) to get any node in any level loop will be like this</p>\n\n<pre><code> Set oShape = ActiveSheet.Shapes(1)\nFor i = 1 To oShape.SmartArt.AllNodes.Count\n  oShape.SmartArt.AllNodes(i).TextFrame2.TextRange.Text = \"Sample \" &amp; i\nNext\n</code></pre>\n\n<p>2)To Get specific node for delete or edit you must determine an id i can not do that perfect but i assign the id to alt text when i add alt text i can find any node</p>\n\n<p>2.1) when shearch</p>\n\n<pre><code> nod.TextFrame2.TextRange.Text = str\n nod.Shapes(1).AlternativeText = index\n</code></pre>\n\n<p>2.2) when check for search</p>\n\n<pre><code>  If oShape.SmartArt.AllNodes(i).Shapes(1).AlternativeText = index\n</code></pre>\n\n<p>and the imge will show where alt store</p>\n\n<p><a href=\"https://i.stack.imgur.com/SHedw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SHedw.png\" alt=\"alt text in excel\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BlbBh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BlbBh.png\" alt=\"\"></a></p>\n\n<p>that i think will help you in some way for do what you need but you must understand how smart art tree change after item delete</p>\n\n<p><a href=\"/questions/tagged/smartart\" class=\"post-tag\" title=\"show questions tagged &#39;smartart&#39;\" rel=\"tag\">smartart</a></p>\n"}], "owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1392, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516500310, "creation_date": 1441205561, "question_id": 32356475, "link": "https://stackoverflow.com/questions/32356475/vba-word-smartarts-and-range", "title": "VBA Word : SmartArts and range", "body": "<p>I'm currently working with SmartArts in Word.<br />\nThe SmartArt already exists, and I would like to find a way to access a SmartArt value from a range, Office cursor (so Selection) or something akin to it.</p>\n\n<p>Here's my SmartArt.<br/>\nTo be exact, the SmartArtLayout is Application.SmartArtLayouts(88)</p>\n\n<p><a href=\"https://i.stack.imgur.com/F5UyE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F5UyE.png\" alt=\"SmartArt tree\"></a></p>\n\n<p>What I can do already :</p>\n\n<ul>\n<li>Create a SmartArt on my Document, keep it as a Shape to work on it.</li>\n<li>Looping on all the Nodes of my SmartArt, selecting the ones I want to keep, and inserting the ones I want to keep in a database, with a link to their parent.</li>\n</ul>\n\n<p>Now I'm blocked on something.\nI want to find a Way to edit/delete a particular node, both in DB and in the SmartArt.<br/>\nIt would be possible if I made a Userform that put every Shape Text in a drop-down list, and I then looped on all shapes to find the shape with the chosen text in it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/r3eHI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r3eHI.png\" alt=\"Userform\"></a></p>\n\n<p>If noone answers, that'll probably be what I am going to do. <br/>\nBut I don't find this way natural or practical.</p>\n\n<p>So I'm looking for a method to be able to find the Node that have the cursor on it. I would've done something like that :</p>\n\n<pre><code>'Putting my SmartArt in SAShape\nFor Each Node In SAShape.SmartArt.AllNodes\n    If (Selection.Range.InRange(Node.Range)) Then\n        'my code\n    End If\nNext Node\n</code></pre>\n\n<p>But It'd have been too easy... The shapes don't seem to have a range.</p>\n\n<p>Is there a way to get the Node with focus, or to get the node we clicked on?\nThanks in advance!</p>\n\n<p>Cordially, </p>\n"}, {"tags": ["arrays", "string", "vba", "excel", "comparison"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1441205021, "post_id": 32356168, "comment_id": 52585359, "body": "<code>Not 0</code> equals -1. You should use <code>&lt;&gt; 0</code> instead."}, {"owner": {"reputation": 99, "user_id": 2448416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fee20ce92ee47e2abf893e9909365765?s=128&d=identicon&r=PG", "display_name": "user2448416", "link": "https://stackoverflow.com/users/2448416/user2448416"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441205497, "post_id": 32356168, "comment_id": 52585750, "body": "That worked perfectly, thank you for the explanation!"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 2448416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fee20ce92ee47e2abf893e9909365765?s=128&d=identicon&r=PG", "display_name": "user2448416", "link": "https://stackoverflow.com/users/2448416/user2448416"}, "edited": false, "score": 1, "creation_date": 1441205550, "post_id": 32356256, "comment_id": 52585786, "body": "That worked! Thanks! Rory explained above that <code>not 0</code> equals -1, which caused the calculations to be wrong."}], "tags": [], "owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "is_accepted": false, "score": 2, "last_activity_date": 1441204989, "creation_date": 1441204989, "answer_id": 32356256, "question_id": 32356168, "link": "https://stackoverflow.com/questions/32356168/instr-doesnt-appear-to-be-working-in-this-validation-sub-does-anyone-have-any/32356256#32356256", "title": "InStr doesn&#39;t appear to be working in this validation sub. Does anyone have any idea why?", "body": "<p>Use <code>If InStr(outputFolder, char) &lt;&gt; 0 Then</code> instead</p>\n"}], "owner": {"reputation": 99, "user_id": 2448416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fee20ce92ee47e2abf893e9909365765?s=128&d=identicon&r=PG", "display_name": "user2448416", "link": "https://stackoverflow.com/users/2448416/user2448416"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1441204989, "creation_date": 1441204746, "question_id": 32356168, "link": "https://stackoverflow.com/questions/32356168/instr-doesnt-appear-to-be-working-in-this-validation-sub-does-anyone-have-any", "title": "InStr doesn&#39;t appear to be working in this validation sub. Does anyone have any idea why?", "body": "<p>I am checking two different directories that the user enters to make sure they don't contain any of the symbols that windows doesn't allow for folder names. The two directories are strings named outputFolder and dirName, and the forbidden characters are stored in an array named msWinFolderChars. I have a for loop checking the two directories for each character one at a time and (ideally) alerting the user and killing the sub if one is found. What actually happens though is that if I enter an invalid character the program doesn't find it and runs through until it actually opens that directory, at which point it crashes because it won't find a folder with an invalid character. Does anyone see where this went wrong?</p>\n\n<pre><code>For Each char In msWinFolderChars\nIf InStr(outputFolder, char) = Not 0 Then\n    MsgBox (\"You have entered an invalid output folder name. Please try again without using \" &amp; char)\n    Exit Sub\nElseIf InStr(dirName, char) = Not 0 Then\n    MsgBox (\"You have entered an invalid CSV directory. Please try again without using \" &amp; char)\n    Exit Sub\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "reply_to_user": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "edited": false, "score": 0, "creation_date": 1441205079, "post_id": 32356065, "comment_id": 52585417, "body": "have you selected both of the coulmns?I tried this again and it worked."}], "tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": true, "score": 1, "last_activity_date": 1441204485, "creation_date": 1441204485, "answer_id": 32356065, "question_id": 32355660, "link": "https://stackoverflow.com/questions/32355660/delete-entire-row-if-consequent-data-is-matching-in-excel-2007/32356065#32356065", "title": "Delete entire row if Consequent Data is Matching in Excel 2007", "body": "<p>Select all the data in column a and b and then on the data ribbon select remove duplicates.</p>\n"}], "owner": {"reputation": 199, "user_id": 5015405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-ktllEBSgH4g/AAAAAAAAAAI/AAAAAAAAABE/aYn5TbR75DU/photo.jpg?sz=128", "display_name": "Shantanu Mahajan", "link": "https://stackoverflow.com/users/5015405/shantanu-mahajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 32356065, "answer_count": 1, "score": 1, "last_activity_date": 1441204485, "creation_date": 1441203455, "last_edit_date": 1531161705, "question_id": 32355660, "link": "https://stackoverflow.com/questions/32355660/delete-entire-row-if-consequent-data-is-matching-in-excel-2007", "title": "Delete entire row if Consequent Data is Matching in Excel 2007", "body": "<p>I have a problem is if my columns Consequent Data is Matching then it should Delete row.</p>\n\n<p>for e.g.\n<strong>Before</strong>\ncolumn A   column B</p>\n\n<p>aaa          10</p>\n\n<p>aaa          10</p>\n\n<p>aaa          5</p>\n\n<p>bbb          6</p>\n\n<p>aaa          10</p>\n\n<p>bbb          5</p>\n\n<p><strong>After</strong>\ncolumn A   column B</p>\n\n<p>aaa          10</p>\n\n<p>aaa          5</p>\n\n<p>bbb          6</p>\n\n<p>bbb          5</p>\n"}, {"tags": ["excel", "currency", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": false, "score": 0, "last_activity_date": 1441204144, "creation_date": 1441204144, "answer_id": 32355926, "question_id": 32355545, "link": "https://stackoverflow.com/questions/32355545/currency-in-excel/32355926#32355926", "title": "Currency in Excel", "body": "<p>If it only for one cell then a very short macro will do it.\njust change for custom format as within the code: \n Sub Macro2()</p>\n\n<pre><code>   If Range(\"a1\").Value = \"EU\" Then Range(\"A2\").Select: Selection.NumberFormat = \"\"\"\u20ac\"\"#,##0\"\nIf Range(\"a1\").Value = \"GB\" Then Range(\"A2\").Select: Selection.NumberFormat = \"\"\"\u00a3\"\"#,##0\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1441204228, "creation_date": 1441204228, "answer_id": 32355961, "question_id": 32355545, "link": "https://stackoverflow.com/questions/32355545/currency-in-excel/32355961#32355961", "title": "Currency in Excel", "body": "<p>You don't need VBA for this - just good 'ol conditional formatting.  With your A2 cell selected, go to Home --> Conditional Formatting.  Then click \"New Rule\" --> \"Use a Formula to determine which cells to format\".</p>\n\n<p>For the GBP formatting, use the formula <code>=$A$1=\"GB\"</code>, then click \"Format\", go to \"Number\" along the top, choose \"Currency\", then just find the GBP symbol.  Click \"OK\" all the way out.  There you go!</p>\n\n<p>For the EUR part, repeat the above, but instead use <code>=$A$1=\"EU\"</code> and find EUR symbol in Currency.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1441204289, "post_id": 32355971, "comment_id": 52584779, "body": "Nice screenshots - doesn&#39;t matter, but he can also just use the formula <code>=$A$1=&quot;EU&quot;</code>, which will either return <code>TRUE</code> or <code>FALSE</code>."}, {"owner": {"reputation": 1034, "user_id": 2682481, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac2fe7867c502a291285fc566725318b?s=128&d=identicon&r=PG&f=1", "display_name": "rwking", "link": "https://stackoverflow.com/users/2682481/rwking"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441204356, "post_id": 32355971, "comment_id": 52584835, "body": "More than one way to skin a cat."}], "tags": [], "owner": {"reputation": 1034, "user_id": 2682481, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac2fe7867c502a291285fc566725318b?s=128&d=identicon&r=PG&f=1", "display_name": "rwking", "link": "https://stackoverflow.com/users/2682481/rwking"}, "is_accepted": true, "score": 4, "last_activity_date": 1441204250, "creation_date": 1441204250, "answer_id": 32355971, "question_id": 32355545, "link": "https://stackoverflow.com/questions/32355545/currency-in-excel/32355971#32355971", "title": "Currency in Excel", "body": "<p>You most certainly can! Utilize conditional formatting on your range with the currency value. Here is how I accomplished this in a test...</p>\n\n<ol>\n<li><p>Select the first cell in your \"amount\" range and then click Conditional Formatting -> New Rule. </p></li>\n<li><p>Select \"Use a formula to determine which cells to format\"</p></li>\n<li><p>In the box, type <code>=if([Cell w/ Country] = \"USA\", 1, 0 )</code>. Note, [Cell w/ Country] is whatever cell that indicates the type of currency. In my example, the formula is <code>=if($A6=\"USA\", 1, 0)</code>.  [Pay close attention to the cell reference <code>$A6</code> - you want the formula to work for the entire column (in this example), so don't enter <code>$A$6</code>.]</p></li>\n<li><p>After typing the formula, click the \"Format\" button.</p></li>\n<li><p>Click on the \"Number\" tab and choose \"Currency\" in the Category list</p></li>\n<li><p>Using the Symbol dropdown, select the symbol corresponding to the rule you just created - in this case, <code>$</code>, then click OK.</p></li>\n<li><p>Finally, you're left with the Rules Manager window. You'll want to select the range that the rule will apply to. Enter the range, or click the range selector button and highlight the range. Then, click OK.</p></li>\n</ol>\n\n<p>Here are some screenshots that might be helpful:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M08Vq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M08Vq.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YKeSu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YKeSu.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2Wtju.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Wtju.png\" alt=\"enter image description here\"></a></p>\n\n<p>Swap around the Country, and the symbol changes.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NuQBL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NuQBL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 32355971, "answer_count": 3, "score": 0, "last_activity_date": 1441204250, "creation_date": 1441203190, "last_edit_date": 1531161705, "question_id": 32355545, "link": "https://stackoverflow.com/questions/32355545/currency-in-excel", "title": "Currency in Excel", "body": "<p>I would like to change the currency symbol in a cell depending on the value in another cell, in the row.</p>\n\n<p>For example if cell A1 contains <code>\"EU\"</code> then cell A2 will be <code>\"\u20ac 5.00\"</code> (If the calculation was 3+2), and if the content in cell A1 were to be changed to <code>\"GB\"</code> then <code>\u00a3 5.00</code> will display in A2.</p>\n\n<p>Is is possible to do this in VBA? I would prefer NOT to do a simple IF statement.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1441204258, "post_id": 32355534, "comment_id": 52584755, "body": "Where&#39;s this separate location? You have sample of current sheet names and what it needs to be changed to?"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1441204626, "post_id": 32355534, "comment_id": 52585051, "body": "@findwindow the separate location will be within another sheet in the same book. The example is as above, in the sheet names"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1441204748, "post_id": 32355534, "comment_id": 52585157, "body": "Load all those name in array and then inside your while condition run a loop on on that array."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1441204794, "post_id": 32355534, "comment_id": 52585192, "body": "Uh need more samples. How do you know how to rename each sheet?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1441205008, "post_id": 32355534, "comment_id": 52585352, "body": "@Nelly27281 You presume the names are in order/ignore the if condition inside while loop..."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1441206110, "post_id": 32355534, "comment_id": 52586217, "body": "@Nelly27281 Interesting idea, but how would the array work, considering that I might have to completely rename the file? I had originally being thinking about something along the lines of relooping through the file names to check if any correspond to the files names that need to be changes, and change them accordingly. If they don&#39;t match the name, skip them."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1441211011, "post_id": 32356956, "comment_id": 52589513, "body": "lol in the time it takes to build the key, you might as well rename the sheets manually @Clauric"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": true, "score": 1, "last_activity_date": 1441206926, "creation_date": 1441206926, "answer_id": 32356956, "question_id": 32355534, "link": "https://stackoverflow.com/questions/32355534/rename-multiple-spreadsheets-macro/32356956#32356956", "title": "Rename multiple spreadsheets macro", "body": "<p><strong>Assuming you have your old sheet names in <code>column A</code> and new sheet names in <code>column B</code> on <code>Sheet4</code>,</strong> like this:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/EZUYj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EZUYj.jpg\" alt=\"enter image description here\"></a>  </p>\n\n<p>And here is the code:  </p>\n\n<pre><code>Sub Rename_Files()\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.DisplayStatusBar = False\n\n    Dim k As Integer\n    Dim t As String\n    Dim x As Integer\n    Dim arrOldNames As Variant\n    Dim arrNewNames As Variant\n\n    'GETTING THE LAST ROW FROM SHEET4\n    With Sheets(\"Sheet4\")\n        LRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n\n    'ASSUMING COL-A HOLDS OLD SHEET NAMES AND COL-B HOLDS NEW SHEET NAMES ON SHEET4\n    arrOldNames = Sheets(\"Sheet4\").Range(\"A2:A\" &amp; LRow).Value\n    arrNewNames = Sheets(\"Sheet4\").Range(\"B2:B\" &amp; LRow).Value\n\n    k = Sheets.Count\n    x = 1\n\n    While x &lt;= k\n        t = Sheets(x).Name\n        x = x + 1\n\n        'HERE WE'LL RUN A LOOP ON ALL THE NAMES AND CHANGE THE NAME IF MATCHES\n        For i = 1 To UBound(arrOldNames)\n            If arrOldNames(i, 1) = t Then\n                Sheets(x - 1).Name = arrNewNames(i, 1)\n                Exit For\n            End If\n        Next\n\n    Wend\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.DisplayStatusBar = True\n\nEnd Sub\n</code></pre>\n\n<p>This sub will create two arrays, one holding old names and another holding new names. It'll run a loop on each names and if name matches, it will changes the name.  </p>\n\n<p><strong>-></strong> Make sure you have same number of names (old and new).</p>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 32356956, "answer_count": 1, "score": 0, "last_activity_date": 1441206926, "creation_date": 1441203140, "question_id": 32355534, "link": "https://stackoverflow.com/questions/32355534/rename-multiple-spreadsheets-macro", "title": "Rename multiple spreadsheets macro", "body": "<p>I have an Excel VBA macro that takes in multiple text files (50+), and converts them into .xlsx spreadsheets. I would like to rename these according to the original name of the file.</p>\n\n<p>I've tried to use the following code, but it would only work for 1 name.</p>\n\n<pre><code>    Sub Rename_Files()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.DisplayStatusBar = False\n\nDim k As Integer\nDim t As String\nDim x As Integer\n\nk = Sheets.Count\nx = 1\n\n    While x &lt;= k\n        t = Sheets(x).Name\n        If t = \"validated_deals\" Then\n\n            Sheets(x).Name = \"Clauric - Validated Deals\"\n            x = x + 1\n\n        Else\n\n            x = x + 1\n        End If\n\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p>Obviously I could redo the While loop for each name, but is there a quicker way to do it, using a loop. I have the names of all the files stored in a separate location, if that helps.</p>\n"}, {"tags": ["vba", "excel", "callbyname"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441202844, "post_id": 32355339, "comment_id": 52583741, "body": "How/where is <code>temp</code> declared?"}, {"owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441202929, "post_id": 32355339, "comment_id": 52583812, "body": "In the sub just above this code, just edited to show that"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441204917, "post_id": 32355339, "comment_id": 52585282, "body": "I can&#39;t think of any reason for it to work without <code>temp</code> but not with. Can you put an actual file somewhere that shows this problem?"}, {"owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441205174, "post_id": 32355339, "comment_id": 52585490, "body": "It doesn&#39;t work either with or without <code>temp</code> if the type isn&#39;t string. I&#39;ll have to edit it first, got a bit of sensitive info on, but should be okay. A link on Dropbox okay?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441205444, "post_id": 32355339, "comment_id": 52585719, "body": "Yes, that should be fine. <code>CallByName</code> does work with properties that return Doubles."}, {"owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441205991, "post_id": 32355339, "comment_id": 52586122, "body": "Here&#39;s the link: <a href=\"https://www.dropbox.com/s/70627iz4cj94n4y/stackoverflow_version.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/70627iz4cj94n4y/stackoverflow_version.xlsm?dl=&zwnj;&#8203;0</a> Only started using VBA a couple of weeks ago so excuse the shoddy programming"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441206656, "post_id": 32355339, "comment_id": 52586626, "body": "Code works as expected here (though what you posted is not actually in that file). Where specifically are you seeing the problem?"}, {"owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1441370496, "post_id": 32355339, "comment_id": 52664689, "body": "Fixed it! Found out that the values in the array were being stored as strings somehow (even though they were being called by <code>CallByName</code> as well) so when you evaluated <code>If temp = arr(i, 1)</code> it always returned <code>False</code> because <code>temp</code> was a double. Thanks for your help @Rory!"}], "owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441202900, "creation_date": 1441202584, "last_edit_date": 1531164843, "question_id": 32355339, "link": "https://stackoverflow.com/questions/32355339/callbyname-not-returning-value-for-certain-types", "title": "CallByName not returning value for certain types", "body": "<p>I am having a problem with the CallByName function. I am trying to split up a collection into smaller collections depending on the value of a property, and then assigning those smaller collections to an array.</p>\n\n<p>The section of code works below is the bit that is causing the problem. Whenever X refers to a property that contains a string value the code works fine, but whenever I try and pass CallByName a property with the type double it doesn't fetch it properly (I think).</p>\n\n<pre><code>Dim temp as Variant\n\nFor i = 1 To UBound(arr, 1)\n    Set collSplit = New Collection\n    For Each v In collTruck\n        temp = CallByName(v, X, VbGet)    ''''''''\n        If temp = arr(i, 1) Then          ''''''''\n            collSplit.Add v\n            arr(i, 2) = arr(i, 2) + 1\n        End If\n    Next v\n    Set arr(i, 3) = collSplit\nNext i\n</code></pre>\n\n<p>Originally I just had <code>If CallByName(v, X, VbGet) = arr(i, 1) Then</code> but I added the <code>temp</code> line to help with debugging. </p>\n\n<p>Putting break points on the two commented lines shows that when X refers to a property with type double temp is always kept empty. But in the Immediate window if I try <code>? CallByName(v, X, VbGet)</code> it gives me the value I am looking for. Why is the value for <code>CallByName(v, X, VbGet)</code> only being received in the Immediate window? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user844705"}, "is_accepted": false, "score": 1, "last_activity_date": 1441203394, "last_edit_date": 1441203394, "creation_date": 1441202824, "answer_id": 32355429, "question_id": 32355171, "link": "https://stackoverflow.com/questions/32355171/resolving-excel-vba-time-millisecond-inaccuracy/32355429#32355429", "title": "Resolving Excel VBA time millisecond inaccuracy", "body": "<p>You need to round your date value after you have done the addition. Excel dates are stored as numbers under the hood and time is represented by a decimal. For example, 42249.6282730324 is 02/09/2015 (&lt; to the left of the decimal) 15:04:43.550 (&lt; to the right of the decimal) So you need to round this number. Here is a good post showing how you can do this using the INT, CEILING and MOD functions. <a href=\"http://exceluser.com/formulas/roundtime.htm\" rel=\"nofollow\">http://exceluser.com/formulas/roundtime.htm</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 1, "last_activity_date": 1441212232, "last_edit_date": 1441212232, "creation_date": 1441209182, "answer_id": 32357717, "question_id": 32355171, "link": "https://stackoverflow.com/questions/32355171/resolving-excel-vba-time-millisecond-inaccuracy/32357717#32357717", "title": "Resolving Excel VBA time millisecond inaccuracy", "body": "<p>This should do the trick.  Note that I removed your \"selection\" reference and am instead using \"Now()\" as the time stamp and placing values in cells A2 through A20000.  Functionally, you could combine all the time helper stuff into a single rounding function, but I designed it the way it is to feel more object oriented and to demonstrate a paradigm that's more adaptable. Hope this helps.</p>\n\n<pre><code>'A type used to store time data\nType TimeHelper\n    MS As Double\n    BaseTime As Double\nEnd Type\n'Value to use as millisecond\nConst MilSec = 1 / 86400000\nSub Test()\n    Dim t As Double\n    t = Now()\n    Dim step As Double\n    step = 75\n    Dim TH As TimeHelper\n\n    For i = 2 To 200000\n        t = t + step * MilSec\n        TH = GetTimeHelper(t)\n        t = RoundMS(TH, step)\n        Cells(i, 1).Value2 = t\n    Next i\n\nEnd Sub\nFunction GetTimeHelper(t As Double) As TimeHelper\n    x = t\n    'Unrounded Hours\n    x = (x - Round(x, 0)) * 24\n    'Unrounded Minutes\n    x = (x - Round(x, 0)) * 60\n    'Seconds as Milliseconds\n    GetTimeHelper.MS = (x - Round(x, 0)) * 60000\n    'Time rounded down to nearest minute by removing millisecond value\n    GetTimeHelper.BaseTime = t - (GetTimeHelper.MS * MilSec)\nEnd Function\nFunction RoundMS(TH As TimeHelper, m As Double)\n    'Construct a time from basetime and milliseconds\n    'with milliseconds rounded to nearest multiple of m\n    RoundMS = TH.BaseTime + (Round(TH.MS / m, 0) * m) * MilSec\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3165, "user_id": 87464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9156d0b855e89ec91870d67d4df1b499?s=128&d=identicon&r=PG", "display_name": "nvuono", "link": "https://stackoverflow.com/users/87464/nvuono"}, "is_accepted": false, "score": 0, "last_activity_date": 1441391986, "creation_date": 1441391986, "answer_id": 32404618, "question_id": 32355171, "link": "https://stackoverflow.com/questions/32355171/resolving-excel-vba-time-millisecond-inaccuracy/32404618#32404618", "title": "Resolving Excel VBA time millisecond inaccuracy", "body": "<p>I actually just decided to check the text value after every row to see if it ended in a 9 and then add a millisecond if necessary:</p>\n\n<pre><code>Dim dblTimestamp As Double\ndblTimestamp = Selection.Value ' origin timestamp\n' Setup base time increment of 50ms over 20 minutes\n\n For i = 1 To Selection.Rows.Count\n    Selection.Rows(i).Value2 = dblTimestamp + (2# / (864000# * 4#))\n    dblTimestamp = dblTimestamp + (2# / (864000# * 4#))\n\n    ' check to see if previous value ended in 9 indicating loss of precision\n    ' e.g. 05:30:00.999 instead of 05:30:01.000\n    If Right(Selection.Rows(i).Cells(1).Text,1)=\"9\") Then\n      dblTimestamp = dblTimestamp + (1#/86400000#) ' add 1 ms\n      Selection.Rows(i).Value2 = dblTimestamp\n    End If\n Next i\n</code></pre>\n\n<p>This was good enough for my situation but P57's answer should still be good enough for other situations.</p>\n"}], "owner": {"reputation": 3165, "user_id": 87464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9156d0b855e89ec91870d67d4df1b499?s=128&d=identicon&r=PG", "display_name": "nvuono", "link": "https://stackoverflow.com/users/87464/nvuono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 32357717, "answer_count": 3, "score": 0, "last_activity_date": 1441392633, "creation_date": 1441202134, "last_edit_date": 1441392633, "question_id": 32355171, "link": "https://stackoverflow.com/questions/32355171/resolving-excel-vba-time-millisecond-inaccuracy", "title": "Resolving Excel VBA time millisecond inaccuracy", "body": "<p>I'm using excel time format \"hh:mm:ss.000\" and adding 50ms at a time to cells in consecutive rows via VBA:</p>\n\n<pre><code>Dim dblTimestamp As Double\ndblTimestamp = Selection.Value ' origin timestamp\n' Setup base time increment of 50ms over 20 minutes\n\n For i = 1 To Selection.Rows.Count\n    Selection.Rows(i).Value2 = dblTimestamp + (2# / (864000# * 4#))\n    dblTimestamp = dblTimestamp + (2# / (864000# * 4#))\n Next i\n</code></pre>\n\n<p>So you see the origin time below on 5/23/2015 and things start out fine:</p>\n\n<pre><code>5/23/2015 05:30:00.000\n05:30:00.050\n05:30:00.100\n05:30:00.150\n05:30:00.200\n05:30:00.250\n</code></pre>\n\n<p>The problem is that the precision/rounding errors start to show up after a couple minutes (~1840 rows):</p>\n\n<pre><code>05:31:32.100\n05:31:32.149\n05:31:32.199\n05:31:32.249\n</code></pre>\n\n<p>And then after 20 minutes it's more pronounced:</p>\n\n<pre><code>05:49:59.793\n05:49:59.843\n05:49:59.893\n05:49:59.943\n05:49:59.993\n</code></pre>\n\n<p>Can I use some other datatype for my calculations or do I have to brute force and add an extra millisecond every ~1840 rows?\nI'd prefer a solution that would also apply when I change the time step to 200ms</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1441203199, "post_id": 32355030, "comment_id": 52584016, "body": "You are filtering in Sheet1 and then copying the visible rows to the new sheet.  Sheet1 will show the filtered data until you cancel the filter."}, {"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1441204510, "post_id": 32355030, "comment_id": 52584946, "body": "@TonyDallimore so what should i need to change in my code. could you please post your code."}], "answers": [{"tags": [], "owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "is_accepted": false, "score": 0, "last_activity_date": 1441267229, "last_edit_date": 1441267229, "creation_date": 1441203896, "answer_id": 32355830, "question_id": 32355030, "link": "https://stackoverflow.com/questions/32355030/how-to-display-result-in-another-sheet-rather-showing-in-the-same-sheet-in-excel/32355830#32355830", "title": "How to display result in another sheet rather showing in the same sheet in excel using vba?", "body": "<p>if i understood your problem correctly , making the below changes will help,</p>\n\n<p>as per you r code, your r looping thru ur filter criteria and pasting again in sheet1 , instead of giving it to sheet1, specify the sheet2 here </p>\n\n<p>'if u have column headers, increment introw by another 1</p>\n\n<pre><code>introw = 1\n\nintcol = 1\n\n\nFor Each cell In filterrange.CurrentRegion.SpecialCells(xlCellTypeVisible).Rows\n\n\nIf Cells(cell.Row, 24) = \"\" Then\n\n   Select Case Cells(cell.Row, 11).Value\n\n\n      Case \"NCE\"\n        ws2.Cells(introw, intcol ) = \"ncew.net\"\n      Case \"MAD\"\n         ws2.Cells(introw, intcol ) = \"muc.net\"\n     End Select\nEnd If\nintrow = introw + 1\nNext cell\n</code></pre>\n\n<p>u can comment the copy and pastespecial line of code</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1441264778, "post_id": 32362352, "comment_id": 52610240, "body": "may I know where to put autofilter code in your code. could you please let me know."}, {"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1441268173, "post_id": 32362352, "comment_id": 52612288, "body": "I have included my code in your code in the autofilter specification its working fine but expect, the <code>if clasue</code>(in my code) is not working not showing the result in that particular column. could you please help me"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1441271151, "post_id": 32362352, "comment_id": 52614179, "body": "Which If statement is not working?  What do you mean by not working?"}, {"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1441272030, "post_id": 32362352, "comment_id": 52614735, "body": "please look into my code  in that i have written a IF statement, I have included the entire logic in your code with replacing  the statement <code>.AutoFilter Field:=1, Criteria1:=&quot;D&quot; </code> everything goes fine but the If statement is not showing the result in the corresponding column. Hope you understood the problem `"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1441277263, "post_id": 32362352, "comment_id": 52618029, "body": "I have added some extra code to my answer which I think replaces the <code>If statement</code> that no longer works.  I have not used an <code>If statement</code> because I believe <code>Replace</code> will be faster and clearer."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1441277121, "last_edit_date": 1441277121, "creation_date": 1441225035, "answer_id": 32362352, "question_id": 32355030, "link": "https://stackoverflow.com/questions/32355030/how-to-display-result-in-another-sheet-rather-showing-in-the-same-sheet-in-excel/32362352#32362352", "title": "How to display result in another sheet rather showing in the same sheet in excel using vba?", "body": "<p>In response to your comment, the following code shows how would achieve the effect you seek.  I have made a few suggestions/points at the same time.</p>\n\n<pre><code>Option Explicit\nSub Demo()\n\n  Dim colWs1Last As Long\n  Dim rngFilter As Range\n  Dim rngCopy As Range\n  Dim rowWs1Last As Long\n\n  Dim ws1 As Worksheet\n  Dim ws2 As Worksheet\n\n  ' ThisWorkbook references the workbook containing the macro.\n  ' Unless you are executing macros in another workbook you\n  ' do not need to specifiy the workbook\n  Set ws1 = Worksheets(\"Sheet1\")\n  ' I do not reference the ActiveSheet unless the workbook has several\n  ' similar worksheets and the user can run the macro against any of them.\n  ' In other situations, use of ActiveSheet relies on the user having the\n  ' correct worksheet active when the macro is started.\n\n  On Error Resume Next          ' Switch off error handling\n  Set ws2 = Worksheets(\"abc\")\n  On Error GoTo 0               ' Restore error handling\n\n  If ws2 Is Nothing Then\n    ' Worksheet abc does not exist\n    Set ws2 = Worksheets.Add(After:=ws1)\n    ws2.Name = \"abc\"\n  Else\n    ' abc already exists.  Clear it of existing data and make it the\n    ' active worksheet to match state after it has been created.\n    With ws2\n      .Cells.EntireRow.Delete\n      .Activate\n    End With\n  End If\n\n  With ws1\n\n    ' I do not like statements where I have to carefully work along it before I know\n    ' what it does. The problem is not that such statements do not work reliably but\n    ' that anyone who has update the macro in 6 or 12 months will have to spend time\n    '  decoding the statement.  I believe the function of each of these statements\n    ' will be obvious to any maintenance programmer and so will not waste their time\n    rowWs1Last = .Cells.Find(\"*\", .Range(\"A1\"), xlFormulas, , xlByRows, xlPrevious).Row\n    colWs1Last = .Cells.Find(\"*\", .Range(\"A1\"), xlFormulas, , xlByColumns, xlPrevious).Column\n    Set rngFilter = .Range(.Cells(1, 1), .Cells(rowWs1Last, colWs1Last))\n\n    ' Switch off AutoFilter if it is on\n    If .AutoFilterMode Then\n      .AutoFilter.Range.AutoFilter\n    End If\n\n  End With\n\n  With rngFilter\n\n    ' I do not have your data so have not used your AutoFilter specification\n    ' Replace with your specification.\n   .AutoFilter Field:=1, Criteria1:=\"D\"\n\n   Set rngCopy = .SpecialCells(xlCellTypeVisible)\n    .AutoFilter   ' Switch off AutoFilter\n\n  End With\n\n  ' Copy rows left visible by filter to worksheet abc\n  rngCopy.Copy ws2.Cells(1, 1)\n\n  ' Extra code in response to request for further help\n  ' ==================================================\n\n  ' Avoid the use of literals for column numbers.  If a new column is\n  ' added or if the columns are resequenced, you will have to work\n  ' through your code line by line to identify which literals are\n  ' column numbers to be changed and which literals are something else\n  ' and are to be left alone.  Probably not too difficult with column\n  ' 24 but a nightmare when a low numbered column moves.  Constants\n  ' make your code easier to read and if the column does move,\n  ' one change completes the update of your code.\n  Const ColCusterName As Long = 24\n\n  ' I could calculate the number of rows from rngCopy but I prefer to\n  ' treat the fixing of values in the new worksheet as a new problem.\n\n  Dim rngToUpdate As Range\n  Dim rowWs2Last As Long\n\n  With ws2\n\n    rowWs2Last = .Cells(Rows.Count, ColCusterName).End(xlUp).Row\n\n    Set rngToUpdate = .Range(.Cells(2, ColCusterName), _\n                             .Cells(rowWs2Last, ColCusterName))\n\n  End With\n\n  With rngToUpdate\n    .Replace What:=\"NCE\", Replacement:=\"ncew.net\", LookAt:=xlWhole, MatchCase:=False\n    .Replace What:=\"MAD\", Replacement:=\"muc.net\", LookAt:=xlWhole, MatchCase:=False\n  End With\n\n  ' Copy column widths from Sheet1 to sheet abc\n  ws1.Range(ws1.Cells(1, 1), ws1.Cells(1, colWs1Last)).Copy\n  ws2.Cells(1, 1).PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n                              SkipBlanks:=False, Transpose:=False\n\n  ' Keep header row on scrren when scroll down\n  ws2.Cells(2, 1).Select\n  ActiveWindow.FreezePanes = True    \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1441270876, "post_id": 32370957, "comment_id": 52614014, "body": "if you dont mind could you please check the code of @tony Dallimore and comments too. because its giving expected result expect for one column. and insert my code after the <code>autofilter specification comment</code>"}], "tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 0, "last_activity_date": 1441269909, "creation_date": 1441269909, "answer_id": 32370957, "question_id": 32355030, "link": "https://stackoverflow.com/questions/32355030/how-to-display-result-in-another-sheet-rather-showing-in-the-same-sheet-in-excel/32370957#32370957", "title": "How to display result in another sheet rather showing in the same sheet in excel using vba?", "body": "<p>If possible add a second sheet to your workbook per hand once and select it every time. try this out and let met know, if it's sufficient for you</p>\n\n<pre><code>Sub stack()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nDim filterrange As Range\n\nSet ws1 = ThisWorkbook.Sheets(\"sheet1\")\nSet ws2 = ThisWorkbook.Sheets(2)\nws2.Name = \"abc\"\n\nSet filterrange = ThisWorkbook.Sheets(\"sheet1\").Cells(2, ThisWorkbook.Sheets(\"sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column)  ' get columns e.g. name, state, etc.\n\nfilterrange.AutoFilter Field:=11, Criteria1:=Array(\"GBR\" _\n        , \"MAD\", \"NCE\", \"=\"), Operator:=xlFilterValues\nfilterrange.AutoFilter Field:=21, Criteria1:=\"Yes\" ' activeconnect\nfilterrange.AutoFilter Field:=24, Criteria1:=\"=\" ' clustername\nfilterrange.AutoFilter Field:=6, Criteria1:= _\n        \"&lt;&gt;*@sca.com*\", Operator:=xlAnd ' e-mail\nfilterrange.AutoFilter Field:=10, Criteria1:=Array( _\n         \"Madrid\", \"Sophia-antipolis\"), Operator:=xlFilterValues\n\n\n\nfilterrange.SpecialCells(xlCellTypeVisible).Copy\nws2.Activate\nws2.Range(\"a1\").PasteSpecial (xlPasteValues)\n\nfor each cell in ws2.Cells.Find(What:=\"*\", After:=.Cells(1, 1), LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False)\nIf Cells(cell.Row, 24) = \"\" Then\n   Select Case Cells(cell.Row, 11).Value\n      Case \"NCE\"\n        Cells(cell.Row, 24) = \"ncew.net\"\n      Case \"MAD\"\n        Cells(cell.Row, 24) = \"muc.net\"\n     End Select\nEnd If\nNext cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2536, "favorite_count": 0, "accepted_answer_id": 32362352, "answer_count": 3, "score": 0, "last_activity_date": 1441277121, "creation_date": 1441201743, "question_id": 32355030, "link": "https://stackoverflow.com/questions/32355030/how-to-display-result-in-another-sheet-rather-showing-in-the-same-sheet-in-excel", "title": "How to display result in another sheet rather showing in the same sheet in excel using vba?", "body": "<p>Hi Im beginner to VBA excel</p>\n\n<p>I have written a code which autofilter all the columns to my requirement. My requirement is , </p>\n\n<ol>\n<li>the result has to be displayed in new sheet(say sheet2) rather showing in the same sheet(say sheet1). </li>\n<li>Suppose, if i excute the code mutiple times, it always open only one sheet( i.e sheet2) not many sheets as well as it auto refresh\nthe sheet2 if i excute the code again and must display the expected\nresult.</li>\n</ol>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub stack()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nDim filterrange As Range\n\nSet ws1 = ThisWorkbook.Sheets(\"sheet1\")\nSet ws2 = ThisWorkbook.Worksheets.Add(after:=ActiveSheet)\nws2.Name = \"abc\"\n\nSet filterrange = ThisWorkbook.Sheets(\"sheet1\").Cells(2, ThisWorkbook.Sheets(\"sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column)  ' get columns e.g. name, state, etc.\n\nfilterrange.AutoFilter Field:=11, Criteria1:=Array(\"GBR\" _\n        , \"MAD\", \"NCE\", \"=\"), Operator:=xlFilterValues\nfilterrange.AutoFilter Field:=21, Criteria1:=\"Yes\" ' activeconnect\nfilterrange.AutoFilter Field:=24, Criteria1:=\"=\" ' clustername\nfilterrange.AutoFilter Field:=6, Criteria1:= _\n        \"&lt;&gt;*@sca.com*\", Operator:=xlAnd ' e-mail\nfilterrange.AutoFilter Field:=10, Criteria1:=Array( _\n         \"Madrid\", \"Sophia-antipolis\"), Operator:=xlFilterValues\n\n\nFor Each cell In filterrange.CurrentRegion.SpecialCells(xlCellTypeVisible).Rows\n\nIf Cells(cell.Row, 24) = \"\" Then\n   Select Case Cells(cell.Row, 11).Value\n      Case \"NCE\"\n        Cells(cell.Row, 24) = \"ncew.net\"\n      Case \"MAD\"\n        Cells(cell.Row, 24) = \"muc.net\"\n     End Select\nEnd If\nNext cell\n\nfilterrange.SpecialCells(xlCellTypeVisible).Copy\nws2.Activate\nws2.Range(\"a1\").PasteSpecial (xlPasteValues)\n\nEnd Sub\n</code></pre>\n\n<p>My code is showing same result in two different sheets( i.e sheet1 and sheet2). The actual data must remain unchanged in sheet1 and the result should be displayed in sheet2. can anyone please help me out.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "edited": false, "score": 0, "creation_date": 1441206943, "post_id": 32356154, "comment_id": 52586869, "body": "That was so simple, I already tried <code>txt.fireevent &quot;Onfocus&quot;</code> but it didn&#39;t worked. But the <code>txt.fireevent &quot;onblur&quot;</code> worked perfectly. The text is now getting updated. Thanks a lot for your support."}], "tags": [], "owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "is_accepted": true, "score": 0, "last_activity_date": 1441204716, "creation_date": 1441204716, "answer_id": 32356154, "question_id": 32354976, "link": "https://stackoverflow.com/questions/32354976/vba-code-to-update-textarea/32356154#32356154", "title": "VBA code to update textarea", "body": "<p>i think the issue is with onfocus event not run when you set the value thru code.</p>\n\n<p>can you add this code after setting the value </p>\n\n<p>If txt.Name = Module Then</p>\n\n<pre><code>txt.innerText = Mark_Text\n</code></pre>\n\n<p>'add this part</p>\n\n<pre><code>txt.fireevent \"Onfocus\"\ntxt.fireevent \"onblur\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 1, "accepted_answer_id": 32356154, "answer_count": 1, "score": 0, "last_activity_date": 1441204716, "creation_date": 1441201588, "last_edit_date": 1531164843, "question_id": 32354976, "link": "https://stackoverflow.com/questions/32354976/vba-code-to-update-textarea", "title": "VBA code to update textarea", "body": "<p>I need to update a text area of an HTML page. I am using below code.</p>\n\n<pre><code>Set hcol = doc.getElementsByTagName(\"textarea\")\n    For Each txt In hcol\n        If txt.Name = Module Then\n            txt.innerText = Mark_Text\n            Sheets(\"Sheet1\").Range(\"E\" &amp; i).Value = \"Done\"\n            Exit For\n        Else\n            Sheets(\"Sheet1\").Range(\"E\" &amp; i).Value = \"Module not found\"\n        End If\n    Next\n</code></pre>\n\n<p>After the above code is successfully completed, I use below code to update the webpage.</p>\n\n<pre><code>Set hcol = doc.getElementsByTagName(\"input\")\n        For Each inp In hcol\n            If inp.Value = \"Update Configuration\" Then\n                inp.Click\n                Delay 3\n                Exit For\n            End If\n        Next\n</code></pre>\n\n<p>Once the update is done, when I go back to the webpage the text is not getting updated. Below is the view source details for the webpage</p>\n\n<pre><code>&lt;td class=\"InputTitle\" rowspan=\"3\"&gt;Marketing Text&lt;/td&gt;\n&lt;td class=\"InputCell\" colspan=\"3\" rowspan=\"3\"&gt;\n&lt;textarea name=\"MarketingText;;1\" id=\"MarketingText;;1\" onfocus=\"workingText = this.value\" \n  onblur=\"updateTextValue(this, &amp;#39;MarketingText&amp;#39;);\" \n  style=\"font:normal 11px Arial;width:300px;\" rows=\"4\"&gt;\n&lt;/textarea&gt;&lt;/td&gt;\n</code></pre>\n\n<p>My problem seems to be similar to the one mentioned in the this link:\n<a href=\"https://stackoverflow.com/questions/25398036/update-text-in-textarea-on-webpage-using-vba\">please help me to write vba/vb6 code to update rich textbox</a></p>\n\n<p>I've already tried both the solutions provided in the above link but still it doesn't work.</p>\n\n<p>Please help</p>\n"}, {"tags": ["c++", "excel", "vba", "types"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441201788, "post_id": 32354547, "comment_id": 52582992, "body": "Have you tried changing the Declare to ...Declare PtrSafe Sub. The Prtsafe is required for VBA7"}], "answers": [{"comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441203768, "post_id": 32355393, "comment_id": 52584391, "body": "Its a foible of VBA. Only the first Dim is set as the datatype if you separate other items with commas. The other items become variants."}, {"owner": {"reputation": 59, "user_id": 5126860, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c0d0731e0b8ceb889ee7b59f4d8356b5?s=128&d=identicon&r=PG&f=1", "display_name": "PublicUserName", "link": "https://stackoverflow.com/users/5126860/publicusername"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441262835, "post_id": 32355393, "comment_id": 52609139, "body": "I was explicitly looking for that before. See here: <a href=\"https://msdn.microsoft.com/en-us/library/7ee5a7s1.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/7ee5a7s1.aspx</a> <b>Declaring Multiple Variables You can declare several variables in one declaration statement, specifying the variable name for each one, and following each array name with parentheses. Multiple variables are separated by commas.</b> That seems odd to me."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441266367, "post_id": 32355393, "comment_id": 52611143, "body": "That refers to Visual Basic. Excel VBA is more of a Visual Basic Lite!"}], "tags": [], "owner": {"reputation": 59, "user_id": 5126860, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c0d0731e0b8ceb889ee7b59f4d8356b5?s=128&d=identicon&r=PG&f=1", "display_name": "PublicUserName", "link": "https://stackoverflow.com/users/5126860/publicusername"}, "is_accepted": true, "score": 0, "last_activity_date": 1441202723, "creation_date": 1441202723, "answer_id": 32355393, "question_id": 32354547, "link": "https://stackoverflow.com/questions/32354547/mismatch-of-data-type-when-passing-argument/32355393#32355393", "title": "Mismatch of data type when passing argument", "body": "<p>I think I solved my problem.</p>\n\n<p>Looking at the VBA code</p>\n\n<pre><code>Dim typeOfPump, RV, monthIN, yearIN as Integer\n</code></pre>\n\n<p>for any reason declared only typeOfPump as integer, the rest were (when monitoring with implemented watching function of Excel) still variant. Writing</p>\n\n<pre><code>Dim typeOfPump as Integer\nDim RV as Integer\n...\n</code></pre>\n\n<p>seems to solve the problem. Unfortunately, I cannot explain what is wrong with the first line.</p>\n"}], "owner": {"reputation": 59, "user_id": 5126860, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c0d0731e0b8ceb889ee7b59f4d8356b5?s=128&d=identicon&r=PG&f=1", "display_name": "PublicUserName", "link": "https://stackoverflow.com/users/5126860/publicusername"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 32355393, "answer_count": 1, "score": 0, "last_activity_date": 1441202723, "creation_date": 1441200491, "last_edit_date": 1441201558, "question_id": 32354547, "link": "https://stackoverflow.com/questions/32354547/mismatch-of-data-type-when-passing-argument", "title": "Mismatch of data type when passing argument", "body": "<p>I am currently facing following problem. I have searched for any solution but could not find anything useful related to my problem.</p>\n\n<p>I want to use VBA to provide some parameters to a self-written DLL which is going to calculate a result for me.</p>\n\n<p>My problem: As soon as I try to process the values passed to the function <strong>setCEPCI</strong> I get an \"Microsoft Excel has stopped working\"- error(no further details). If I put those three lines (see my copied code) in comments, however, everything is working fine. I tried a lot of workarounds but it all came down to those lines.\nSurprisingly, I can use the passed arguments in the first function <strong>getPEC</strong>, where e.g. <strong>x</strong> is my <strong>outflow</strong>.</p>\n\n<p>For the record I am using a def file for exporting the function, though, IMHO the error seems to be some mismatch of data types.</p>\n\n<p><strong>EDIT: For clarification: If my DLL is not found e.g. I get the same Microsoft-Excel-error due to the RV assignment. If I try to assign any value to RV in the first function, I also get that error. On the other hand I can assign any value to PEC without problems.</strong></p>\n\n<p>My DLL looks like:</p>\n\n<pre><code>extern \"C\" {\n\n\n\ntypedef void(CALLBACK * FncPtrClssGetCEPCI)(CEPCIvalues &amp;, int, int, int &amp;);\n\ndouble PEC_backUp;\nconst int numbMaxCEPCIlistMembers = 3;\nCEPCIvalues cepcilist_backUp[numbMaxCEPCIlistMembers];\n\nvoid __stdcall getPEC(int typeOfPump, double outflow, double &amp;PEC, int &amp;RV)\n{\n    //y = a x^6 + b x^5 + c x^4 + d x^3 + e x^2 + f x^1 + g x^0\n    if ((typeOfPump &lt; 1) || (10 &lt; typeOfPump)) {\n        RV = -1;\n        return;\n    }\n    double a, b, c, d, e, f, g;\n//...\n    PEC_backUp = a * pow(outflow, 6.0) +\n        b * pow(outflow, 5.0) +\n        c * pow(outflow, 4.0) +\n        d * pow(outflow, 3.0) +\n        e * pow(outflow, 2.0) +\n        f * pow(outflow, 1.0) +\n        g * pow(outflow, 0.0);\n\n\n    double EUR_USD_07_2000 = 0.939082609;\n    PEC_backUp = PEC_backUp / EUR_USD_07_2000;\n    PEC = PEC_backUp;\n}\n\nvoid __stdcall setCEPCI(int monthIN, int yearIN, int &amp;RV)\n{\n    //HINSTANCE hinstCEPCI = LoadLibraryEx(\"CEPCI.dll\", NULL, LOAD_LIBRARY_SEARCH_APPLICATION_DIR);\n    HINSTANCE hinstCEPCI = LoadLibrary(\"C:\\\\Users\\\\...somePath...\\\\CEPCI.dll\");\n    if (!hinstCEPCI)\n    {\n        RV = -11;\n        return;\n    }\n    FncPtrClssGetCEPCI ptrGetCEPCI = (FncPtrClssGetCEPCI)GetProcAddress(hinstCEPCI, \"getCEPCI\");\n    if (!ptrGetCEPCI)\n    {\n        RV = -22;\n        return;\n    }\n    //CEPCI values of 13/1970 and 07/2000 are automatically extracted\n    //due to less interaction and, thus, risk of errors in user input\n\n    int monthIN_auto = 13;\n    int yearIN_auto = 1970;\n    ptrGetCEPCI(cepcilist_backUp[0], monthIN_auto, yearIN_auto, RV);\n    monthIN_auto = 7;\n    yearIN_auto = 2000;\n    ptrGetCEPCI(cepcilist_backUp[1], monthIN_auto, yearIN_auto, RV);\n    //now extract CEPCI value of user specific input\n\n\n\n\n  //  monthIN_auto = monthIN;\n\n  //  yearIN_auto = yearIN;\n\n\n    ptrGetCEPCI(cepcilist_backUp[2], monthIN_auto, yearIN_auto, RV);\n        CEPCIvalues cepcilist;\n        cepcilist = cepcilist_backUp[2];\n\n\n\n\n\n// RV = monthIN + yearIN;\n\n    ptrGetCEPCI = 0;\n    FreeLibrary(hinstCEPCI);\n    hinstCEPCI = 0;\n    return;\n}\n</code></pre>\n\n<p>My VBA code looks like:</p>\n\n<pre><code>Public Declare Sub getPEC _\nLib \"C:\\Users\\...somePath...\\OPunit0011PUMP.dll\" _\n(ByVal typeOfPump As Integer, ByVal outflow As Double, ByRef PEC As Double, ByRef RV As Integer)\n\nPublic Declare Sub setCEPCI _\nLib \"C:\\Users\\...somePath...\\OPunit0011PUMP.dll\" _\n(ByVal monthIN As Integer, ByVal yearIN As Integer, ByRef RV As Integer)\n\n\nFunction CallPump()\n\nDim typeOfPump, RV, monthIN, yearIN As Integer\ntypeOfPump = 9\nDim outlfow, PEC As Double\noutflow = 100\nmonthIN = 5\nyearIN = 2008\n\nCall getPEC(typeOfPump, outflow, PEC, RV)\n\nCall setCEPCI(monthIN, yearIN, RV)\n\n\n\n\nEnd Function\n</code></pre>\n\n<p>Any help is appreciated. Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1441199273, "post_id": 32354016, "comment_id": 52581115, "body": "Merged workbook has references to other workbooks.  Delete code in merged workbook and copy the code behind the button in from another workbook."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1441210225, "post_id": 32354016, "comment_id": 52589064, "body": "Can you show the on button click code for one of the original workbooks?"}, {"owner": {"reputation": 43, "user_id": 2263615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efbbaf933de78d040e73e4a148e42f00?s=128&d=identicon&r=PG", "display_name": "Ravi Sahu", "link": "https://stackoverflow.com/users/2263615/ravi-sahu"}, "edited": false, "score": 0, "creation_date": 1441262801, "post_id": 32354016, "comment_id": 52609122, "body": "I have updated button code in description."}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 1660027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a04268f3fb9fb90819e2e00222d571?s=128&d=identicon&r=PG", "display_name": "Dobbes", "link": "https://stackoverflow.com/users/1660027/dobbes"}, "is_accepted": false, "score": 0, "last_activity_date": 1441214570, "creation_date": 1441214570, "answer_id": 32359452, "question_id": 32354016, "link": "https://stackoverflow.com/questions/32354016/macro-link-update-in-new-combined-workbook-from-multiple-excel-workbook/32359452#32359452", "title": "Macro link update in new combined workbook from multiple excel workbook", "body": "<p>If you want to run the macro specific to the merged file you are executing from, preface:</p>\n\n<pre><code>Call Thisworkbook.MacroName\n</code></pre>\n\n<p>Be sure you initialize to the proper page in the workbook before executing.  You can also control that with Thisworkbook.</p>\n\n<pre><code>Thisworkbook.Sheetname\n</code></pre>\n\n<p>That will keep your execution from running in the original books.</p>\n"}, {"tags": [], "owner": {"reputation": 469, "user_id": 4556029, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-KlpZkYlt--g/AAAAAAAAAAI/AAAAAAAABJA/Snpzl2ecDp8/photo.jpg?sz=128", "display_name": "manpreet singh", "link": "https://stackoverflow.com/users/4556029/manpreet-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1441275908, "creation_date": 1441275908, "answer_id": 32373067, "question_id": 32354016, "link": "https://stackoverflow.com/questions/32354016/macro-link-update-in-new-combined-workbook-from-multiple-excel-workbook/32373067#32373067", "title": "Macro link update in new combined workbook from multiple excel workbook", "body": "<p>I tested the code and problem seems to be limited to Form Buttons only. Try Using ActiveX buttons<br/></p>\n\n<p>In The <strong>Developer</strong> Tab, In <strong>Controls</strong> Group, On clicking the Insert dropdown button, You will notice that there are 2 groupings, upper one with heading <strong>Form Controls</strong> and lower one having heading <strong>ActiveX Controls</strong>. Insert buttons from the ActiveX Controls.</p>\n"}], "owner": {"reputation": 43, "user_id": 2263615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efbbaf933de78d040e73e4a148e42f00?s=128&d=identicon&r=PG", "display_name": "Ravi Sahu", "link": "https://stackoverflow.com/users/2263615/ravi-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 32373067, "answer_count": 2, "score": 4, "last_activity_date": 1441275908, "creation_date": 1441199162, "last_edit_date": 1441263022, "question_id": 32354016, "link": "https://stackoverflow.com/questions/32354016/macro-link-update-in-new-combined-workbook-from-multiple-excel-workbook", "title": "Macro link update in new combined workbook from multiple excel workbook", "body": "<p>I have merged the workbook data as per the below code:</p>\n\n<pre><code>Sub Merge2MultiSheets()\n    Dim wbDst As Workbook\n    Dim wbSrc As Workbook\n    Dim wsSrc As Worksheet\n    Dim MyPath As String\n    Dim strFilename As String\n    Dim CurrentRow As Integer\n    Dim CurrentColumn As Integer\n    Dim Index As Integer\n\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    MyPath = \"D:\\Excels\" ' change to suit\n\n    CurrentRow = 1\n    CurrentColumn = 1\n    Index = 0\n    Set wbSource = ActiveWorkbook\n    strFilename = wbSource.Worksheets(\"Test\").Cells(CurrentRow, Index + 1)\n\n    Set wbDst = Workbooks.Add(xlWBATWorksheet)\n    'strFilename = Dir(MyPath &amp; \"\\*.xlsx\", vbNormal)\n\n    If Len(strFilename) = 0 Then Exit Sub\n\n    Do Until strFilename = \"\"\n\n       Set wbSrc = Workbooks.Open(fileName:=MyPath &amp; \"\\\" &amp; strFilename)\n\n       Set wsSrc = wbSrc.Worksheets(1)\n\n       wsSrc.Copy after:=wbDst.Worksheets(wbDst.Worksheets.Count)\n\n       Set wsSrc = wbSrc.Worksheets(2)\n\n       wsSrc.Copy after:=wbDst.Worksheets(wbDst.Worksheets.Count)\n\n       wbSrc.Close False\n\n       Index = Index + 1\n       strFilename = wbSource.Worksheets(\"Test\").Cells(CurrentRow, Index + 1)\n\n    Loop\n    wbDst.Worksheets(1).Delete\n\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Now the problem is that, each individual workbook has a button with macro and some code on button click which work fine in individual file but in merged file when I click on the button then it opens that original file to run the code on button click, it is not using the code which is copied in merged file.<br/><br/>\nLet me know how can I make sure that the merged file doesn't depend on original file for running the button click code and should be independent.</p>\n\n<p>Individual button click code as asked in comment:</p>\n\n<pre><code>Sub Calculate_Click()\n    Dim sum As Integer\n    Dim mult As Integer\n\n    Dim input1 As Integer\n    Dim input2 As Integer\n\n    input1 = Worksheets(\"test1_input\").Cells(1, 2)\n    input2 = Worksheets(\"test1_input\").Cells(2, 2)\n\n\n    sum = input1 + input2\n    mult = input1 * input2\n\n    Worksheets(\"test1_output\").Cells(1, 2) = sum\n    Worksheets(\"test1_output\").Cells(2, 2) = mult\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1441198934, "post_id": 32353742, "comment_id": 52580849, "body": "What line throws the error? I&#39;m guessing that it is <code>DoCmd.SetWarnings False</code>. If not,  you might want to turn the error handling off and find the actual point of failure.  Where does that variable get its value from? I&#39;m guessing that some initialization code needs to be rerun before you invoke this sub."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1441199825, "post_id": 32353742, "comment_id": 52581514, "body": "Please get rid of setwarnings altogether, they are fatal and system wide <a href=\"http://stackoverflow.com/questions/11213892/whats-the-difference-between-docmd-setwarnings-and-currentdb-execute/11213943#11213943\" title=\"whats the difference between docmd setwarnings and currentdb execute\">stackoverflow.com/questions/11213892/&hellip;</a>"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441199944, "post_id": 32353742, "comment_id": 52581608, "body": "BTW that error is nearly always due to missing set with a object variable."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441200930, "post_id": 32353742, "comment_id": 52582342, "body": "Yes I started getting it , once I added DoCmd.SetWarnings False, But what else I can use to, I don&#39;t want the user to click &quot;Ok&quot;  10-12 times"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441201050, "post_id": 32353742, "comment_id": 52582440, "body": "Check out my link above. You can use Execute: <code>Set db = CurrentDB db.Execute sSQL, dbFailOnError</code>"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441201331, "post_id": 32353742, "comment_id": 52582650, "body": "so something like this: Set db = CurrebtDB db.Execute sSQL &quot;UPDATE [tbl_IdeasITAssumptions] set [Load_Date] = #&quot; &amp; dt &amp; &quot;# where [Load_Date]  &gt; #&quot; &amp; dt &amp; &quot;#&quot;          dbFailOnError"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441201364, "post_id": 32353742, "comment_id": 52582671, "body": "You might like to look at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834805.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff834805.aspx</a>"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441201468, "post_id": 32353742, "comment_id": 52582744, "body": "Yes, if there are a few commas in there. You only need to set db once, and you can get records affected if you want. sSQL is a reference to the sql statement, so skip it if you are giving the statement itself."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441201685, "post_id": 32353742, "comment_id": 52582911, "body": "See also <a href=\"https://msdn.microsoft.com/en-us/library/bb243015(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb243015(v=office.12).aspx</a>"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441202260, "post_id": 32353742, "comment_id": 52583321, "body": "Ok I am getting different error now I tried this Set db = CurrentDB Db.Execute &quot;UPDATE [tbl_IdeasITAssumptions] set [Load_Date] = #&quot; &amp; dt &amp; &quot;# where [Load_Date]  &gt; #&quot; &amp; dt &amp; &quot;#&quot;       tHE ERROR says Invalid use of property"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441202601, "post_id": 32353742, "comment_id": 52583561, "body": "Perhaps you would like to edit your post to include your current code? Comments are a little limited."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441203137, "post_id": 32353742, "comment_id": 52583965, "body": "I updated the code, thanks!"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441203397, "post_id": 32353742, "comment_id": 52584151, "body": "dbFailOnError goes after each statement, not where you have it. So: <code>db.Execute sqlstatementhere, dbFailOnError</code>"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441203627, "post_id": 32353742, "comment_id": 52584317, "body": "Thanks that worked,  sorry to keep bothering you, but I still have to press &quot;yes&quot; for all my Call LoadData(&quot;C:\\Idea Attributes\\tbl_IdeasDat..... anyway I can have system skip those, or is it possible to chage those into sql execute statements too?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441204278, "post_id": 32353742, "comment_id": 52584773, "body": "What does loaddata do? Please post the code."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441204505, "post_id": 32353742, "comment_id": 52584945, "body": "Done! I have updated the code"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441204672, "post_id": 32353742, "comment_id": 52585091, "body": "It was not a good idea to delete your original question. The problem is here <code>DoCmd.OpenQuery Qry_Append, acViewNormal</code>. You can convert this query to an Execute. Queries can be executed."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441205523, "post_id": 32353742, "comment_id": 52585764, "body": "Sure I have the original question and I will place that back: So to change this DoCmd.OpenQuery Qry_Append, acViewNormal Should I write  Db.Execute \u201cOpenQuery Qry_Append, acViewNormal\u201d"}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441206060, "post_id": 32353742, "comment_id": 52586171, "body": "n/m I fixed it : Db.Execute Qry_Append, acViewNormal........Thanks  a LOT FOR YOUR HELP!!!"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441206360, "post_id": 32353742, "comment_id": 52586407, "body": "Replace acViewNormal, with dbFailOnError. What you have is not safe. acViewNormal = 0; dbfailonerror = 128. These are built-in constants, do not mess with them."}, {"owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "edited": false, "score": 0, "creation_date": 1441207381, "post_id": 32353742, "comment_id": 52587182, "body": "Got it thanks I changed it to  Db.Execute Qry_Append, dbFailOnError"}], "owner": {"reputation": 101, "user_id": 3860954, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/add40aded083dd0ee8b620ae91ecf687?s=128&d=identicon&r=PG&f=1", "display_name": "user3860954", "link": "https://stackoverflow.com/users/3860954/user3860954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594643747, "creation_date": 1441198408, "last_edit_date": 1594643747, "question_id": 32353742, "link": "https://stackoverflow.com/questions/32353742/run-time-error-91-object-variable-not-set", "title": "Run-time error &#39;91&#39; Object variable not set", "body": "<p>My code works well, but when I reopen the database I am getting the following error; anybody know how may I fix this issue? Once I open the database, and run the code few times I no longer get the error.</p>\n\n<p><strong>Run-time error '91' Object variable not set</strong></p>\n\n<pre><code>Sub ImportAllTables_New_Click()\nDim dt As Date\n    dt = Now() 'save current single timestamp for later use\n\n DoCmd.SetWarnings False\n\nOn Error GoTo errHandler\n\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasITAssumptions.xlsm\", \"TempIdeasITAssumptions\", \"Qry_IdeasITAssumptions\", \"Qry_AppendIdeasITAssumptions\")\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasDependencies.xlsm\", \"TempIdeasDependencies\", \"Qry_IdeasDependencies\", \"Qry_AppendIdeasDependencies\")\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasImpactedPlan.xlsm\", \"TempIdeasImpactedPlan\", \"Qry_IdeasImpactedPlan\", \"Qry_AppendIdeasImpactedPlan\")\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasImpactedSubsidiaries.xlsm\", \"TempIdeasImpactedSubsidiaries\", \"Qry_IdeasImpactedSubsidiaries\", \"Qry_AppendIdeasImpactedSubsidiaries\")\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasLOB.xlsm\", \"TempIdeasLOB\", \"Qry_IdeasLOB\", \"Qry_AppendIdeasLOB\")\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasPhaseGate.xlsm\", \"TempIdeasPhaseGate\", \"Qry_IdeasPhaseGate\", \"Qry_AppendIdeasPhaseGate\")\nCall LoadData(\"C:\\Idea Attributes\\tbl_IdeasDataExtractMain.xlsm\", \"TempIdeasDataExtractMain\", \"Qry_IdeasDataExtractMain\", \"Qry_AppendIdeasDataExtractMain\")\n\n 'update all [Load_date] that are greater than  the timestamp captured before you started import\n\n\n\n\nDoCmd.RunSQL \"UPDATE [tbl_IdeasITAssumptions] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date]  &gt; #\" &amp; dt &amp; \"#\"\nDoCmd.RunSQL \"UPDATE [tbl_IdeasDependencies] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date]  &gt; #\" &amp; dt &amp; \"#\"\nDoCmd.RunSQL \"UPDATE [tbl_IdeasImpactedPlan] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date]  &gt; #\" &amp; dt &amp; \"#\"\nDoCmd.RunSQL \"UPDATE [tbl_IdeasImpactedSubsidiaries] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date]  &gt; #\" &amp; dt &amp; \"#\"\nDoCmd.RunSQL \"UPDATE [tbl_IdeasLOB] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date] &gt; #\" &amp; dt &amp; \"#\"\nDoCmd.RunSQL \"UPDATE [tbl_IdeasPhaseGate] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date]  &gt; #\" &amp; dt &amp; \"#\"\nDoCmd.RunSQL \"UPDATE [tbl_IdeasDataExtractMain] set [Load_Date] = #\" &amp; dt &amp; \"# where [Load_Date]  &gt; #\" &amp; dt &amp; \"#\"\n\nDoCmd.SetWarnings True\n\nMsgBox (\"All Tables has been Imported\")\n\nerrHandler:\n  MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description &amp; \" in \" &amp; _\n   VBE.ActiveCodePane.CodeModule, vbOKOnly, \"Error\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "reference", "jquery-ui-sortable", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1441198480, "post_id": 32353629, "comment_id": 52580483, "body": "You can&#39;t sort per se, but you can move table columns around. If there are too many to do manually, you could write code to do that - it&#39;s probably simpler than code to reapply structured references."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1441199641, "post_id": 32353629, "comment_id": 52581392, "body": "If the desired structured references are exactly the same (e.g. they don&#39;t contain any column indices that need to be changed after the columns are sorted) then you could covert the formulas to text and then reconvert to formulas afterwards. You could also experiment with e.g. turning off worksheet calculation for the duration of the sorting. I have no idea if it will work, but maybe if Excel isn&#39;t going to calculate the cells it will leave the formulas alone. <i>Something</i> must trigger the replacement of the structured references by the raw ranges -- perhaps it can be suppressed."}, {"owner": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "edited": false, "score": 0, "creation_date": 1441285876, "post_id": 32353629, "comment_id": 52623993, "body": "The table itself has 65 columns, and about 120 rows. The user I have the table for enters dates in 40 of those columns. So manual reordering is in no way an option. I already tried turning off calculations, that didn&#39;t work. I suppose i can always do a formula fill down after i convert the range back to a table, but that takes up calculation time and I would like to avoid that."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "edited": false, "score": 0, "creation_date": 1441285766, "post_id": 32363286, "comment_id": 52623885, "body": "I don&#39;t want to sort columns. I want to sort LEFT TO RIGHT.  Also. I&#39;m not sorting by &quot;Predicted Total&quot; I was just giving an example of one of the formulas in my table so no one got confused with Absolute or Relative references."}, {"owner": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "edited": false, "score": 0, "creation_date": 1441286168, "post_id": 32363286, "comment_id": 52624246, "body": "I&#39;m trying to sort 120 rows containing 40 columns of dates. The dates are different in each row."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "edited": false, "score": 0, "creation_date": 1441292219, "post_id": 32363286, "comment_id": 52628764, "body": "My apologies for missing the left to right part (so much for tossing off code too quickly!).So each row sorts left to right individually without changing the column headers? Or is there a &quot;master&quot; row that dictates the sort? Within the 40 columns, you&#39;ve implied that some of the columns are fixed in place as well."}, {"owner": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "edited": false, "score": 0, "creation_date": 1441306252, "post_id": 32363286, "comment_id": 52637139, "body": "Each row in the table represents a different employee, there are a few columns with other details about them, then there are 40 columns for entering  the dates of their vacation days, (I know there are much more efficient ways to do this, but the table is not for me and this is the way the user insists) My goal is to get the table to auto sort by oldest to newest date when the workbook is loaded without losing my structured formulas."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1441228751, "creation_date": 1441228751, "answer_id": 32363286, "question_id": 32353629, "link": "https://stackoverflow.com/questions/32353629/can-you-turn-unstructured-references-to-structured-using-vba-excel-2010/32363286#32363286", "title": "Can You Turn Unstructured References to Structured Using VBA? (Excel 2010)", "body": "<p>I was able to sort columns using the structured references in Excel 2010 with no issues. Formulas within the table using structured references to other columns and data were sorted. No converting formulas back and forth.</p>\n\n\n\n<pre><code>Option Explicit\n\nSub SortTable()\n    Dim ws As Worksheet\n    Dim tbl As ListObject\n\n    Set ws = ActiveSheet\n    Set tbl = ws.ListObjects(\"MyTable\")\n\n    With tbl.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=ws.Range(tbl.Name &amp; \"[PredictedTotal]\"), _\n                        SortOn:=xlSortOnValues, Order:=xlDescending, _\n                        DataOption:=xlSortNormal\n        .SortFields.Add Key:=ws.Range(tbl.Name &amp; \"[AllDepartments]\"), _\n                        SortOn:=xlSortOnValues, Order:=xlAscending, _\n                        DataOption:=xlSortNormal\n        .header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "is_accepted": true, "score": 0, "last_activity_date": 1441989332, "creation_date": 1441989332, "answer_id": 32528200, "question_id": 32353629, "link": "https://stackoverflow.com/questions/32353629/can-you-turn-unstructured-references-to-structured-using-vba-excel-2010/32528200#32528200", "title": "Can You Turn Unstructured References to Structured Using VBA? (Excel 2010)", "body": "<p>I figured out a way around converting my table to a range. In case anyone was curious I decided to post my solution.</p>\n\n<p>It's now set up to copy the entire table, Paste it as transposed values into a destination worksheet, where it then does a loop sorting each column's dates from oldest to newest, and then it takes those sorted dates and pastes them as transposed values back into the original table.</p>\n\n<p>Yay to figuring out my own solution! =D</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nApplication.ScreenUpdating = False\n\nDim SourceWS As Worksheet\nDim DestWS As Worksheet\nDim TblRange As Range\nDim DataRange As Range\nDim LastRow As Long\n\nSet SourceWS = Worksheets(\"For HR Use ONLY\")\nSet DestWS = Worksheets(\"Transposed Table\")\n\nDestWS.Visible = xlSheetVisible\nDestWS.Cells.ClearContents\n\nSourceWS.Activate\n\nLastRow = SourceWS.Range(\"A1\").CurrentRegion.Rows.Count\nSet TblRange = SourceWS.Range(\"A1:BM\" &amp; LastRow)\n\nTblRange.Copy\nDestWS.Range(\"A1\").PasteSpecial xlPasteValues, xlPasteSpecialOperationNone, True, True\nApplication.CutCopyMode = False\n\nSet DataRange = SourceWS.Range(\"O2:BB\" &amp; LastRow)\nDataRange.ClearContents\n\nDestWS.Activate\nDim x As Long, LastCol As Long\nLastCol = SourceWS.Range(\"A1\").CurrentRegion.Rows.Count\nFor x = 2 To LastCol\nRange(Cells(15, x), Cells(54, x)).Sort Key1:=Cells(15, x), Order1:=xlAscending, Header:=xlGuess\nNext x\n\nDestWS.Range(Cells(15, 2), Cells(54, LastCol)).Copy\n\nSourceWS.Range(\"O2\").PasteSpecial xlPasteValues, lPasteSpecialOperationNone, True, True\nApplication.CutCopyMode = False\n\nDestWS.Visible = xlSheetHidden\n\nSourceWS.Activate\nSourceWS.Range(\"A1\").Select\n\nSet SourceWS = Nothing\nSet DestWS = Nothing\nSet TblRange = Nothing\nSet DataRange = Nothing\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6753249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7affa9fd403436da743852b0c32c44d3?s=128&d=identicon&r=PG&f=1", "display_name": "UniMord", "link": "https://stackoverflow.com/users/6753249/unimord"}, "is_accepted": false, "score": 0, "last_activity_date": 1472052743, "creation_date": 1472052743, "answer_id": 39127484, "question_id": 32353629, "link": "https://stackoverflow.com/questions/32353629/can-you-turn-unstructured-references-to-structured-using-vba-excel-2010/39127484#39127484", "title": "Can You Turn Unstructured References to Structured Using VBA? (Excel 2010)", "body": "<p>I was confronted by the same problem. Use the following recipe:</p>\n\n<ol>\n<li>CTRL+A  // Select entire table.</li>\n<li>CTRL+H  // Replace all equal signs with | or character of your choice.</li>\n<li>ALT+J+G // Convert to range.</li>\n<li>ALT+H+S+U+O+L // Special Sort from left-to-right. Choose sorting row.</li>\n<li>CTRL+T  // Convert back to Table. Remember to rename it!</li>\n<li>CTRL+H  // Put back all your equal signs.</li>\n</ol>\n\n<p>You're done. Caveat: if you have any array formulas, you'll have to recommit them with CTRL+SHIFT+ENTER</p>\n"}], "owner": {"reputation": 11, "user_id": 5292572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e8d3799b21b0c6051bd70bb9293bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca", "link": "https://stackoverflow.com/users/5292572/rebecca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 1, "accepted_answer_id": 32528200, "answer_count": 3, "score": 1, "last_activity_date": 1472052743, "creation_date": 1441198134, "last_edit_date": 1531164843, "question_id": 32353629, "link": "https://stackoverflow.com/questions/32353629/can-you-turn-unstructured-references-to-structured-using-vba-excel-2010", "title": "Can You Turn Unstructured References to Structured Using VBA? (Excel 2010)", "body": "<p>I have an excel table (an actual table ie Insert > Table) that uses structured references in all of the formulas. Example: <code>=[@[Predicted Total 2015 Days]]-COUNTA(All.Departments[@[1]:[40]])</code></p>\n\n<p>The problem I'm having is I want to sort several of the columns from Left to Right. Excel doesn't let you do this with tables, only ranges (at least from what I've found on the subject) So it seems that my only option is to unlist the table (convert it to a range) and then convert it back. However after converting it back to a table my formulas lose their structured references Example : <code>=Sheet2!$V2-COUNTA(Sheet2!$X2:$BK2)</code></p>\n\n<p>Is there any way to convert these formulas back to structured? Or even better yet, a way to sort left to right without having to convert my table back and forth?</p>\n"}, {"tags": ["vba", "if-statement", "goto", "contain", "redo"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441198709, "post_id": 32353412, "comment_id": 52580674, "body": "Are you looking for \u4e2d\u62a5 in cells on the activesheet or in the sheet name?"}, {"owner": {"reputation": 119, "user_id": 4844996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8926a42c8c5b0d1e00c53452cfd82186?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kan", "link": "https://stackoverflow.com/users/4844996/nicholas-kan"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441199434, "post_id": 32353412, "comment_id": 52581246, "body": "@MatthewD, Hi MattewD, I am looking for &quot;\u4e2d\u62a5&quot; in cells on the activesheet, if it is found, then re-do from selecting the report type, actually, &quot;\u4e2d\u62a5&quot; means interim report, but what I want is annual report, hope it is clear. Thanks very much for your quick answer, could you please give me a hand?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441199941, "post_id": 32353412, "comment_id": 52581605, "body": "I am unclear as to where you want to search, but look into the range find. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839746.aspx</a>  If you find it call SelectReportType shown in my answer."}, {"owner": {"reputation": 119, "user_id": 4844996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8926a42c8c5b0d1e00c53452cfd82186?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kan", "link": "https://stackoverflow.com/users/4844996/nicholas-kan"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441204590, "post_id": 32353412, "comment_id": 52585020, "body": "@MatthewD Hi Matthew, I got an error &#39;Type Mis-match&#39; for below line tblNameArr = Array(Worksheets(&quot;Stocks&quot;).Cells(2, 4), Worksheets(&quot;Stocks&quot;).Cells(3, 4), Worksheets(&quot;Stocks&quot;).Cells(4, 4), Worksheets(&quot;Stocks&quot;).Cells(5, 4))"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441205413, "post_id": 32353412, "comment_id": 52585695, "body": "try tblNameArr = str(Array(Worksheets(&quot;Stocks&quot;).Cells(2, 4), Worksheets(&quot;Stocks&quot;).Cells(3, 4), Worksheets(&quot;Stocks&quot;).Cells(4, 4), Worksheets(&quot;Stocks&quot;).Cells(5, 4)))"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1441199048, "creation_date": 1441199048, "answer_id": 32353973, "question_id": 32353412, "link": "https://stackoverflow.com/questions/32353412/vba-if-used-range-contains-a-word-text-value-go-back-to-previous-step/32353973#32353973", "title": "VBA If used range contains a word/text/value, go back to previous step", "body": "<p>This is cleaned up quite a bit.</p>\n\n<p>I added a SelectReportType: line label. Whenever you want to go back to that condition, use insert the line </p>\n\n<pre><code>Goto SelectReportType\n</code></pre>\n\n<p>And it will take you to that spot. The better way to do it would be to place that code in a separate function so you can call it anytime your test for \"\u4e2d\u62a5\" is true. But I'm not following your code well enough to understand what you are doing to assist you with that.</p>\n\n<pre><code>Sub GetFinanceData()\n\n    Dim x As Variant\n    Dim IE As Object\n    Dim URL As String, elemCollection As Object\n    Dim t As Integer, r As Integer, c As Integer\n    Dim selectItems As Variant, i As Variant\n    Dim tblNameArr() As String\n    Dim tblStartRow As Long\n\n    Worksheets(\"Stocks\").Select\n    Worksheets(\"Stocks\").Activate\n\n    For x = 1 To 1584\n\n        'Open IE and Go to the Website\n\n        'URL = \"http://stock.finance.sina.com.cn/hkstock/finance/00001.html\"\n        URL = Cells(x, 1)\n\n        Set IE = CreateObject(\"InternetExplorer.Application\")\n        With IE\n            .Navigate URL\n            .Visible = False\n\n            Do While .Busy = True Or .ReadyState &lt;&gt; 4\n                Loop\n            DoEvents\n\n            Worksheets.Add(After:=Worksheets(Worksheets.count)).name = _\n            ThisWorkbook.Worksheets(\"Stocks\").Range(\"B\" &amp; x).Value     'You could even simplify it and just state the name as Cells(x,2)\n\nSelectReportType:\n            'Select the Report Type\n\n            Set selectItems = IE.Document.getElementsByTagName(\"select\")\n                For Each i In selectItems\n                    i.Value = \"zero\"\n                    i.FireEvent (\"onchange\")\n                    Application.Wait (Now + TimeValue(\"0:00:05\"))\n                Next i\n\n                Do While .Busy: DoEvents: Loop\n\n                ActiveSheet.Range(\"A1:K2000\").ClearContents\n\n                ActiveSheet.Range(\"A1\").Value = .Document.getElementsByTagName(\"h1\")(0).innerText\n                ActiveSheet.Range(\"B1\").Value = .Document.getElementsByTagName(\"em\")(0).innerText\n                ActiveSheet.Range(\"A4\").Value = Worksheets(\"Stocks\").Cells(1, 4)\n\n                'Find and Get Table Data\n\n                tblNameArr = Array(Worksheets(\"Stocks\").Cells(2, 4), Worksheets(\"Stocks\").Cells(3, 4), Worksheets(\"Stocks\").Cells(4, 4), Worksheets(\"Stocks\").Cells(5, 4))\n                tblStartRow = 6\n                Set elemCollection = .Document.getElementsByTagName(\"TABLE\")\n                For t = 0 To elemCollection.Length - 1\n                    For r = 0 To (elemCollection(t).Rows.Length - 1)\n                        For c = 0 To (elemCollection(t).Rows(r).Cells.Length - 1)\n                            ActiveSheet.Cells(r + tblStartRow, c + 1) = elemCollection(t).Rows(r).Cells(c).innerText\n                        Next c\n                    Next r\n\n                    ActiveSheet.Cells(r + tblStartRow + 2, 1) = tblNameArr(t)\n                    tblStartRow = tblStartRow + r + 4\n\n                Next t\n\n        End With\n\n        ' cleaning up memory\n\n        IE.Quit\n\n    Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4844996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8926a42c8c5b0d1e00c53452cfd82186?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kan", "link": "https://stackoverflow.com/users/4844996/nicholas-kan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 32353973, "answer_count": 1, "score": 1, "last_activity_date": 1441199048, "creation_date": 1441197527, "last_edit_date": 1441198376, "question_id": 32353412, "link": "https://stackoverflow.com/questions/32353412/vba-if-used-range-contains-a-word-text-value-go-back-to-previous-step", "title": "VBA If used range contains a word/text/value, go back to previous step", "body": "<p>I wrote a macro to download data from a website, after the website is fully loaded, it will scrap the data by the html tag, however, sometimes the data is incorrectly scraped due to unknown error, I want to add a checking after each variant 'x' completed, e.g. If the activesheet contains the word \"\u4e2d\u62a5\"\uff0cthen go back to the step \"'Select the Report Type\" to re-do the scraping. Also, I know some of the variables/data types are not set at the very beginning. Could anyone help to solve this? Thanks in advance!</p>\n\n<pre><code>Sub GetFinanceData()\n\n    Dim x As Variant\n    Dim IE As Object\n    For x = 1 To 1584\n    Dim URL As String, elemCollection As Object\n    Dim t As Integer, r As Integer, c As Integer\n\n    Worksheets(\"Stocks\").Select\n    Worksheets(\"Stocks\").Activate\n\n    'Open IE and Go to the Website\n\n    'URL = \"http://stock.finance.sina.com.cn/hkstock/finance/00001.html\"\n    URL = Cells(x, 1)\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .navigate URL\n        .Visible = False\n\n        Do While .Busy = True Or .readyState &lt;&gt; 4\n            Loop\n        DoEvents\n\n    Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = _\n    ThisWorkbook.Worksheets(\"Stocks\").Range(\"B\" &amp; x).Value     'You could even simplify it and just state the name as Cells(x,2)\n\n\n    'Select the Report Type\n\n    Set selectItems = IE.Document.getElementsByTagName(\"select\")\n        For Each i In selectItems\n            i.Value = \"zero\"\n            i.FireEvent (\"onchange\")\n            Application.Wait (Now + TimeValue(\"0:00:05\"))\n        Next i\n\n        Do While .Busy: DoEvents: Loop\n\n    ActiveSheet.Range(\"A1:K2000\").ClearContents\n\n    ActiveSheet.Range(\"A1\").Value = .Document.getElementsByTagName(\"h1\")(0).innerText\n    ActiveSheet.Range(\"B1\").Value = .Document.getElementsByTagName(\"em\")(0).innerText\n    ActiveSheet.Range(\"A4\").Value = Worksheets(\"Stocks\").Cells(1, 4)\n\n    'Find and Get Table Data\n\n    tblNameArr = Array(Worksheets(\"Stocks\").Cells(2, 4), Worksheets(\"Stocks\").Cells(3, 4), Worksheets(\"Stocks\").Cells(4, 4), Worksheets(\"Stocks\").Cells(5, 4))\n    tblStartRow = 6\n    Set elemCollection = .Document.getElementsByTagName(\"TABLE\")\n    For t = 0 To elemCollection.Length - 1\n        For r = 0 To (elemCollection(t).Rows.Length - 1)\n            For c = 0 To (elemCollection(t).Rows(r).Cells.Length - 1)\n                ActiveSheet.Cells(r + tblStartRow, c + 1) = elemCollection(t).Rows(r).Cells(c).innerText\n            Next c\n        Next r\n\n        ActiveSheet.Cells(r + tblStartRow + 2, 1) = tblNameArr(t)\n        tblStartRow = tblStartRow + r + 4\n\n    Next t\n\n        End With\n\n        ' cleaning up memory\n\n        IE.Quit\n\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "batch-file", "ftp", "command-prompt"], "answers": [{"tags": [], "owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "is_accepted": false, "score": 3, "last_activity_date": 1488269465, "last_edit_date": 1495541357, "creation_date": 1441199821, "answer_id": 32354293, "question_id": 32353408, "link": "https://stackoverflow.com/questions/32353408/batch-macro-code-to-get-latest-file-from-ftp-site/32354293#32354293", "title": "Batch/Macro code to get latest file from FTP site", "body": "<p>There's no easy way to select the most recent file with the <code>ftp.exe</code>.</p>\n\n<ul>\n<li><p>If you know that the file has today's timestamp, you can generate the script dynamically with the today's timestamp. You can use the <code>DATE</code> environment variable, though it has its caveats. A more reliable (and complex) way is to use the <code>wmic os get LocalDateTime</code>.</p>\n\n<p>See <a href=\"https://stackoverflow.com/q/203090/850848\">How to get current datetime on Windows command line, in a suitable format for using in a filename?</a></p></li>\n<li><p>If you can determine the latest file alphabetically, you can:</p>\n\n<ul>\n<li>run the <code>ftp.exe</code> with the <code>ls</code> command redirected to a file</li>\n<li>sort the files by alphabet in a descending order</li>\n<li>read the first line</li>\n<li>generate a download script for the second <code>ftp.exe</code> run</li>\n</ul></li>\n</ul>\n\n\n\n<ul>\n<li><p><a href=\"https://winscp.net/\" rel=\"nofollow noreferrer\">WinSCP</a> can download the files created within the last 24-hours (1 day):</p>\n\n<pre><code>winscp.com /command ^\n    \"open ftp://user:pass@ftp.site.com/\" ^\n    \"lcd c:\\my\\local\\direc\" ^\n    \"get *&gt;=1D\" ^\n    \"exit\"\n</code></pre></li>\n<li><p>If you really need to download the latest file (by timestamp), you probably need some more advanced scripting.</p>\n\n<p>For example there's a guide available for <a href=\"https://winscp.net/eng/docs/script_download_most_recent_file\" rel=\"nofollow noreferrer\">downloading the most recent file with WinSCP</a>.</p>\n\n<p><em>(I'm the author of WinSCP)</em></p></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 5289883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pSrji8M4iiI/AAAAAAAAAAI/AAAAAAAABc0/kZgkLpWuRrQ/photo.jpg?sz=128", "display_name": "tpayne2345", "link": "https://stackoverflow.com/users/5289883/tpayne2345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1488269465, "creation_date": 1441197515, "last_edit_date": 1441224796, "question_id": 32353408, "link": "https://stackoverflow.com/questions/32353408/batch-macro-code-to-get-latest-file-from-ftp-site", "title": "Batch/Macro code to get latest file from FTP site", "body": "<p>We have a shared FTP site with a daily file upload which I need to download and run checks over. I'm simply trying to automate the process. The FTP file is something like <code>name_20150901.xml</code>.</p>\n\n<p>So far I have a batch file to get the file but I can't figure out how to get the latest. Here is my code:</p>\n\n<pre><code>@ftp -i -s:\"%~f0\"&amp;GOTO:EOF\nopen ftp.site.com\n&lt;user&gt;\n&lt;pass&gt;\nlcd my local direc\nbinary\nget todaysfile_20150901.xml\n</code></pre>\n\n<p>What changes do I need to read the files and get the newest one? My end goal is to have a macro that calls this and then reads the file that's grabbed from the FTP and runs my checks. </p>\n"}, {"tags": ["javascript", "html", "vba", "triggers", "internet-explorer-8"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "edited": false, "score": 0, "creation_date": 1441205636, "post_id": 32356305, "comment_id": 52585849, "body": "I tried this but nothing happens. The dropdown menu doesn&#39;t change. I saw someone on stackoverflow.com <a href=\"http://stackoverflow.com/questions/26649727/vba-html-jquery-chosen-autocomplete-select-in-a-list/32355026#32355026\">link</a> who has the same issue and solved it by this: <code>IEDoc.parentWindow.execScript (&quot;jQuery(&#39;#type&#39;).val(&#39;2&#39;);jQuery(&#39;#type&#39;).trigger(&#39;chosen:u&zwnj;&#8203;pdated&#39;);&quot;)</code> But I don&#39;t know how I can modify this to help my case actually."}, {"owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "reply_to_user": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "edited": false, "score": 0, "creation_date": 1441208406, "post_id": 32356305, "comment_id": 52587909, "body": "just use this line of code after your code where u set the value, IEDoc.getElementById(&quot;PROGRAMME-select&quot;).fireevent &quot;Onchange&quot;"}, {"owner": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "edited": false, "score": 0, "creation_date": 1441209656, "post_id": 32356305, "comment_id": 52588703, "body": "I have tried it already but nothing happends. The index doesn&#39;t change, whatever I set it to. Is it maybe bcs there is no &quot;onchange&quot; event in the HTML?"}, {"owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "reply_to_user": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "edited": false, "score": 0, "creation_date": 1441291153, "post_id": 32356305, "comment_id": 52627987, "body": "instead of selection by the index, can you try to select by the text displayed? something like this below, &#39;Set weblist = objDocument.getElementsByTagName(&quot;Select&quot;) For Each btnSelect In weblist If Trim(btnSelect.Name) = &quot;FORMAT-select&quot; Then  Set listoption = btnSelect.getElementsByTagName(&quot;Option&quot;) For Each btnOption In listoption  If UCase(Trim(btnOption.Text)) = UCase(&quot;Non-Standard&quot;) Then btnOption.Selected = True btnSelect.fireevent &quot;Onchange&quot; Exit For End If Next end if Next&#39;"}, {"owner": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "edited": false, "score": 0, "creation_date": 1441560876, "post_id": 32356305, "comment_id": 52717954, "body": "hm no :/ doesn&#39;t seem to get it going. It runs through but doesn&#39;t change value. Do you think the jQuery needs to be triggered somehow?"}, {"owner": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "edited": false, "score": 0, "creation_date": 1441715305, "post_id": 32356305, "comment_id": 52777595, "body": "Just to revamp this thread, do you have an idea how else this could work? :("}], "tags": [], "owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "is_accepted": false, "score": 1, "last_activity_date": 1441205119, "creation_date": 1441205119, "answer_id": 32356305, "question_id": 32353091, "link": "https://stackoverflow.com/questions/32353091/vba-ie-navigation-trigger-javascript/32356305#32356305", "title": "VBA IE navigation trigger Javascript", "body": "<p>can you try using the fireevent method for the listbox and try once ?</p>\n\n<p>eg code:</p>\n\n<pre><code>IEDoc.getElementById(\"PROGRAMME-select\").selectedindex = 2\n\nIEDoc.getElementById(\"PROGRAMME-select\").fireevent \"Onchange\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1484662163, "creation_date": 1484662163, "answer_id": 41699280, "question_id": 32353091, "link": "https://stackoverflow.com/questions/32353091/vba-ie-navigation-trigger-javascript/41699280#41699280", "title": "VBA IE navigation trigger Javascript", "body": "<p>After the form changes it has new html on the document.  Instead of using IEDoc - which you probably set before the change -  just use ie.document.getElementById(\"NEW NAME HERE\").selectedindex = 1</p>\n\n<p>(This assumes that you set your instance of msie to ie.  Just use whatever variable you gave to this instance and .document will always give you the most recent version after any javascript changes.  The form ID's might have changed also so you might try listing all ID's in the form again just to see.)</p>\n"}], "owner": {"reputation": 11, "user_id": 4825374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5586b7196563eb1dedc21ec2395b87?s=128&d=identicon&r=PG&f=1", "display_name": "maria", "link": "https://stackoverflow.com/users/4825374/maria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 985, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1484662163, "creation_date": 1441196687, "question_id": 32353091, "link": "https://stackoverflow.com/questions/32353091/vba-ie-navigation-trigger-javascript", "title": "VBA IE navigation trigger Javascript", "body": "<p>I am trying to navigate through a from in internet explorer via Excel VBA.</p>\n\n<p>This is the VBA code I use to do it, which works fine:</p>\n\n<p><code>IEDoc.getElementById(\"PROGRAMME-select\").selectedindex = 1</code></p>\n\n<p>However, for another dropdown menu, which after a selection dynamically changes the rest of the form, the code from above doesn't work. I assume it's due to the javascript of the webpage. This is the HTML code of it:</p>\n\n<pre><code>&lt;DIV id=Q_FORMAT jQuery1441195683481=\"347\"&gt;\n&lt;INPUT id=Q_FORMAT_data value='{\"name\":\"FORMAT\",\"inputType\":\"select\"}' type=hidden name=Q_FORMAT_data&gt; \n&lt;DIV style=\"DISPLAY: block\" id=FORMAT-label&gt;\n&lt;LABEL&gt;&lt;B&gt;Format :&lt;/B&gt; &lt;/LABEL&gt;&lt;/DIV&gt;&lt;SELECT id=FORMAT-select name=FORMAT-select&gt;\n&lt;OPTION id=FORMAT_EMPTY_OPTION value=EMPTY_OPTION&gt;&lt;/OPTION&gt;\n&lt;OPTION id=FORMAT_YES value=FORMAT_YES name=\"FORMAT_YES\"&gt;Non-Standard&lt;/OPTION&gt;\n&lt;OPTION id=FORMAT_NO selected value=FORMAT_NO name=\"FORMAT_NO\"&gt;Standard&lt;/OPTION&gt;&lt;/SELECT&gt; &lt;/DIV&gt;\n</code></pre>\n\n<p>Does anyone know how to trigger the javascript in order to have the rest of the form be updated by the selection I am trying to do? Or possibly it's a completely different issue I am facing here?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1441193446, "creation_date": 1441193446, "answer_id": 32351961, "question_id": 32351822, "link": "https://stackoverflow.com/questions/32351822/skip-one-worksheet-and-process-the-remaining-worksheets/32351961#32351961", "title": "Skip one worksheet and process the remaining worksheets", "body": "<p>Just tell it to ignore the sheet by checking each sheet name:</p>\n\n<pre><code>Sub doit()\n\n    Application.DisplayAlerts = False\n\n    Dim r As Long, lr As Long\n    Dim sh As Worksheet\n\n    For Each sh In Sheets\n        If sh.Name &lt;&gt; \"IgnoreThisSheet\" Then\n            lr = sh.Cells(sh.Rows.Count, 1).End(xlUp).Row\n            For r = lr To 1 Step -1\n                If InStr(sh.Cells(r, 1), \"Statement No\") = 0 Then sh.Rows(r).Delete\n            Next r\n        End If\n    Next\n\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Edit:  You may also want to change Sheets to WorkSheets in your For Each loop.  A worksheet contains rows, columns, etc.  A sheet can be a chart sheet, macro sheet or dialog sheet.\n<a href=\"http://blogs.msdn.com/b/frice/archive/2007/12/05/excel-s-worksheets-and-sheets-collection-what-s-the-difference.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/frice/archive/2007/12/05/excel-s-worksheets-and-sheets-collection-what-s-the-difference.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1441193455, "creation_date": 1441193455, "answer_id": 32351963, "question_id": 32351822, "link": "https://stackoverflow.com/questions/32351822/skip-one-worksheet-and-process-the-remaining-worksheets/32351963#32351963", "title": "Skip one worksheet and process the remaining worksheets", "body": "<p>If the sheet name is always going to be the same then you could use this ..</p>\n\n<pre><code>If sh.Name &lt;&gt; \"Sheet 1\" Then ' Or whatever the sheet is called\n   .. more code\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4494, "favorite_count": 0, "accepted_answer_id": 32351961, "answer_count": 2, "score": 1, "last_activity_date": 1441193455, "creation_date": 1441193020, "last_edit_date": 1531164843, "question_id": 32351822, "link": "https://stackoverflow.com/questions/32351822/skip-one-worksheet-and-process-the-remaining-worksheets", "title": "Skip one worksheet and process the remaining worksheets", "body": "<p>I was working with a vba code which remove all the rows which dont have word \"Statement No\" in it from all available worksheets. But anyhow i want it to skip the first worksheet and continue removing the rows from all other worksheets.</p>\n\n<p>If you can help me with the below code so that it skips the first worksheet.</p>\n\n<pre><code>Sub doit()\n\nApplication.DisplayAlerts = False\n\nDim r As Long, lr As Long\nDim sh As Worksheet\n\n\n\nFor Each sh In Sheets\n\nlr = sh.Cells(sh.Rows.Count, 1).End(xlUp).row\nFor r = lr To 1 Step -1\n    If InStr(sh.Cells(r, 1), \"Statement No\") = 0 Then sh.Rows(r).Delete\nNext r\nNext\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Thank you All!</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441190160, "post_id": 32350765, "comment_id": 52574764, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/3135046/excel-formula-to-strip-html\">excel formula to strip html</a>"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441190565, "post_id": 32350765, "comment_id": 52575003, "body": "There&#39;s also the ability to use regular expressions in vba. See <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1441190606, "post_id": 32350765, "comment_id": 52575033, "body": "If you would have recorded a macro, you would have got your answer... ;)"}], "answers": [{"comments": [{"owner": {"reputation": 892, "user_id": 4663351, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/e37e9b3749597d90e9a021c708dfa786?s=128&d=identicon&r=PG&f=1", "display_name": "Eternal_Sunshine", "link": "https://stackoverflow.com/users/4663351/eternal-sunshine"}, "edited": false, "score": 0, "creation_date": 1441191512, "post_id": 32350899, "comment_id": 52575611, "body": "yes thumb up ;) problem is my question is marked as dublicat but the other similiar question doesn&#39;t have your good answere ;)"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 892, "user_id": 4663351, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/e37e9b3749597d90e9a021c708dfa786?s=128&d=identicon&r=PG&f=1", "display_name": "Eternal_Sunshine", "link": "https://stackoverflow.com/users/4663351/eternal-sunshine"}, "edited": false, "score": 0, "creation_date": 1441191568, "post_id": 32350899, "comment_id": 52575639, "body": "Your question is not marked as a duplicate. At least at this moment."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1441190221, "creation_date": 1441190221, "answer_id": 32350899, "question_id": 32350765, "link": "https://stackoverflow.com/questions/32350765/how-can-i-use-excel-replace-in-excel-vba-like-in-excel-regular-expressions/32350899#32350899", "title": "How can I use excel Replace &lt;*&gt; in excel vba like in excel? (regular expressions)", "body": "<p>To search and replace all cells in the active sheet, you need to use something like:</p>\n\n<pre><code>Cells.Replace What:=\"&lt;*&gt;\", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>Note that you can indicate the cell directly in the beginning: <code>Cells(2,1).</code> (to only replace in the A2 cell.</p>\n"}], "owner": {"reputation": 892, "user_id": 4663351, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/e37e9b3749597d90e9a021c708dfa786?s=128&d=identicon&r=PG&f=1", "display_name": "Eternal_Sunshine", "link": "https://stackoverflow.com/users/4663351/eternal-sunshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 32350899, "answer_count": 1, "score": 2, "last_activity_date": 1441190440, "creation_date": 1441189876, "question_id": 32350765, "link": "https://stackoverflow.com/questions/32350765/how-can-i-use-excel-replace-in-excel-vba-like-in-excel-regular-expressions", "title": "How can I use excel Replace &lt;*&gt; in excel vba like in excel? (regular expressions)", "body": "<p>If you want to delete html tags in excel one way is to use the replace function. I search for \"&lt;*>\" and replace it by \"\". So I just delete every html tag. Excel VBA also has a replace function but it is far more stupid. If I write:</p>\n\n<pre><code>temp2 = Replace(temp2, \"&lt;*&gt;\", \"\")\n</code></pre>\n\n<p>It doesn't interpret \"&lt; * >\" as a regular expression. It only replace 1:1 the string \"&lt;*>\". How can I use the replace function in VBA like I do in Excel?</p>\n"}, {"tags": ["forms", "ms-access", "vba", "transfer"], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1442859149, "creation_date": 1442859149, "answer_id": 32701959, "question_id": 32350497, "link": "https://stackoverflow.com/questions/32350497/form-to-table-using-vba-macros-in-microsoft-access/32701959#32701959", "title": "Form to Table using VBA Macro&#39;s in Microsoft Access", "body": "<p>Simply place a button on the form, and use this code:</p>\n\n<pre><code>If me.Dirty = true then\n   Me.Dirty = false\nEnd if\n</code></pre>\n\n<p>The above will send the values in textboxes to the table that the form is based on. </p>\n"}], "owner": {"reputation": 1, "user_id": 5292067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e5d0e5a4ba8b6565b8daab34f62475?s=128&d=identicon&r=PG&f=1", "display_name": "chessmaster02", "link": "https://stackoverflow.com/users/5292067/chessmaster02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442859149, "creation_date": 1441189084, "last_edit_date": 1442823905, "question_id": 32350497, "link": "https://stackoverflow.com/questions/32350497/form-to-table-using-vba-macros-in-microsoft-access", "title": "Form to Table using VBA Macro&#39;s in Microsoft Access", "body": "<p>I am trying to fill in a form and when I click the add button it goes and inserts it into my table. </p>\n\n<p>The form is called <code>frmClients</code> and the table is called <code>Clients</code>. I have several fields that I need to transfer from the form to the table.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441192702, "post_id": 32351358, "comment_id": 52576376, "body": "Your answer is good but it would be better if you explain why and how"}, {"owner": {"reputation": 21, "user_id": 5291991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iMIdaFIohwQ/AAAAAAAAAAI/AAAAAAAAAaU/ndBGWnYKMEk/photo.jpg?sz=128", "display_name": "maryam fayaz torshizi", "link": "https://stackoverflow.com/users/5291991/maryam-fayaz-torshizi"}, "edited": false, "score": 0, "creation_date": 1441640093, "post_id": 32351358, "comment_id": 52747942, "body": "Hi thank you for your reply.this is giving me type mismatch error."}, {"owner": {"reputation": 21, "user_id": 5291991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iMIdaFIohwQ/AAAAAAAAAAI/AAAAAAAAAaU/ndBGWnYKMEk/photo.jpg?sz=128", "display_name": "maryam fayaz torshizi", "link": "https://stackoverflow.com/users/5291991/maryam-fayaz-torshizi"}, "edited": false, "score": 0, "creation_date": 1441640532, "post_id": 32351358, "comment_id": 52748146, "body": "This is the data I have on Sheet linkslist: \t Worksheet\tCell\t       Formula\t Austria\t      AY186       =&#39;Yearly inputs&#39;!puff"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1441191647, "creation_date": 1441191647, "answer_id": 32351358, "question_id": 32350278, "link": "https://stackoverflow.com/questions/32350278/vba-reference-taken-from-a-sheet-stored-in-array-used-for-cell-selection-in-diff/32351358#32351358", "title": "VBA reference taken from a sheet stored in array used for cell selection in different sheet", "body": "<p>All you need is this:</p>\n\n<pre><code>Dim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Linkslist\")\nn = sh.Range(\"C2\", sh.Range(\"C2\").End(xlDown)).Rows.Count\n\nFor i = 2 To n\n    Worksheets(sh.Range(\"A\" &amp; i)).Range(sh.Range(\"C\" &amp; i)).Formula = \"=\" &amp; sh.Range(\"B\" &amp; i)\nNexti \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5291991, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iMIdaFIohwQ/AAAAAAAAAAI/AAAAAAAAAaU/ndBGWnYKMEk/photo.jpg?sz=128", "display_name": "maryam fayaz torshizi", "link": "https://stackoverflow.com/users/5291991/maryam-fayaz-torshizi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1441224576, "creation_date": 1441188407, "last_edit_date": 1441224576, "question_id": 32350278, "link": "https://stackoverflow.com/questions/32350278/vba-reference-taken-from-a-sheet-stored-in-array-used-for-cell-selection-in-diff", "title": "VBA reference taken from a sheet stored in array used for cell selection in different sheet", "body": "<p>In a sheet I have stored references to cells addresses in column C and formulas in column B and sheet name in column A. I have found a way to trim the formulas, now I would like to use the cell addresses in column C to replace the formula I have trimmed in column B in different sheets in addresses given,using the sheet reference names given in column A. So if A1 says sheet Austria, B1 has formula Sum(A1:D1), C1 has cell reference A345, I would like to be able to paste B1 in A345 in sheet Austria. </p>\n\n<p>Here is the code, it stops at using cell reference to refer to the cells in a specific sheet. for some reason VBA doesn't like the fact that I am doing it this way. I have been researching and since I am a beginner, I am not sure how to do it. Your help would be appreciated. I would appreciate if you could make changes to the code when trying to explain. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim arr() As Variant\nDim puff As String\nDim puff1 As String\nDim n As Long\nDim i As Long\nDim str As String\nDim strjn As String\nDim Rng As Range\n\n\nWith Columns(\"C:C\")\n .Replace What:=\"[Lisbon.xlsx.xlsm]\", Replacement:=\"\"\nEnd With\n\nWith Columns(\"C:C\")\n .Replace What:=\"'='\", Replacement:=\"='\"\nEnd With\n\nWith Columns(\"B:B\")\n .Replace What:=\"$\", Replacement:=\"\"\nEnd With\n\nDim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Linkslist\")\nn = sh.Range(\"C2\", sh.Range(\"C2\").End(xlDown)).Rows.Count\n\narr = WorksheetFunction.Transpose(Range(\"B2:B\" &amp; n).Value)\n\nFor i = 2 To n\nj = i - 1\nWorksheets(\"LinksList\").Activate\npuff = Chr(34) &amp; arr(j) &amp; Chr(34)\nRange(\"C\" &amp; i).Select\nSelection.Copy\nWorksheets(Range(\"A\" &amp; i).Value).Select\nRange(Range(puff)).Select\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 5291949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a7eecd8d1778d917dc68dca96b01cf?s=128&d=identicon&r=PG&f=1", "display_name": " awale", "link": "https://stackoverflow.com/users/5291949/awale"}, "edited": false, "score": 0, "creation_date": 1441195265, "post_id": 32350001, "comment_id": 52578108, "body": "This is what i have so far also the numbers and the cells are a bit different. this code used cell locations rather than column name."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5291949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a7eecd8d1778d917dc68dca96b01cf?s=128&d=identicon&r=PG&f=1", "display_name": " awale", "link": "https://stackoverflow.com/users/5291949/awale"}, "edited": false, "score": 0, "creation_date": 1441266045, "post_id": 32353589, "comment_id": 52610948, "body": "This is great but I want to be able to search for three three diffeent name and set the criteria( a message box that asks me whether I want it to be 1 or 0 ). so search name 1  ask me for criteria , 1 or 0 then name 2 then name 3."}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 1, "user_id": 5291949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a7eecd8d1778d917dc68dca96b01cf?s=128&d=identicon&r=PG&f=1", "display_name": " awale", "link": "https://stackoverflow.com/users/5291949/awale"}, "edited": false, "score": 0, "creation_date": 1441268214, "post_id": 32353589, "comment_id": 52612316, "body": "Bearing that in mind, why not have a look at creating a custom form? You could have 3 text boxes and 3 toggle boxes to choose your criteria. Its not great coding practice to have lots of things popping up one after another - when one thing would do"}, {"owner": {"reputation": 1, "user_id": 5291949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a7eecd8d1778d917dc68dca96b01cf?s=128&d=identicon&r=PG&f=1", "display_name": " awale", "link": "https://stackoverflow.com/users/5291949/awale"}, "edited": false, "score": 0, "creation_date": 1441272290, "post_id": 32353589, "comment_id": 52614888, "body": "Any idea how I could do that, sorry very new to this. Thanks"}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 1, "user_id": 5291949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a7eecd8d1778d917dc68dca96b01cf?s=128&d=identicon&r=PG&f=1", "display_name": " awale", "link": "https://stackoverflow.com/users/5291949/awale"}, "edited": false, "score": 0, "creation_date": 1441272409, "post_id": 32353589, "comment_id": 52614962, "body": "To start with, press Alt + F11 to get you to the VBA editor - then right click on your project and add a userform. There&#39;s loads of tutorials online to get you on the right track."}], "tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": false, "score": 0, "last_activity_date": 1441198018, "creation_date": 1441198018, "answer_id": 32353589, "question_id": 32350001, "link": "https://stackoverflow.com/questions/32350001/creaing-user-input-to-manipulate-data-with-a-set-of-criterias/32353589#32353589", "title": "Creaing user input to manipulate data with a set of criterias", "body": "<p>If I'm reading right what you want, you could try this. This will ask you to input the name and will then go through your motions on that particular column as a range for the loops. Is that what you are after?</p>\n\n<p>Also, I've changed     </p>\n\n<pre><code>If Application.Sum(rw.Resize(, 4)) = 0 Then \n        cll.Interior.ColorIndex = 3 \n</code></pre>\n\n<p>To rw.Interior.Colorindex = 3 - as I'm guessing this was an error (as you can't use a variable outside of its loop</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nsearchstring = InputBox(\"Input name?\")\n\nSet coll = Rows(1).Find(What:=searchstring, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n\nIf coll Is Nothing Then\n    MsgBox \"Name not found\"\n    Exit Sub\nElse\n    coll = coll.Column\n    Lrow = Range(Cells(2, coll), Cells(2, coll)).CurrentRegion.Rows.Count\nEnd If\n\n    Cells.Interior.ColorIndex = 0\n    For Each rw In Range(Cells(2, coll), Cells(Lrow, coll))\n\n        If Application.Sum(rw.Resize(, 4)) = 0 Then\n            rw.Interior.ColorIndex = 3\n            For Each cll In rw.offset(, 4).Resize(, 18).Cells\n                If cll.Value &gt; 50 Then cll.Interior.ColorIndex = 3\n            Next cll\n        End If\n    Next rw\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5291949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a7eecd8d1778d917dc68dca96b01cf?s=128&d=identicon&r=PG&f=1", "display_name": " awale", "link": "https://stackoverflow.com/users/5291949/awale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1441198018, "creation_date": 1441187631, "last_edit_date": 1441195079, "question_id": 32350001, "link": "https://stackoverflow.com/questions/32350001/creaing-user-input-to-manipulate-data-with-a-set-of-criterias", "title": "Creaing user input to manipulate data with a set of criterias", "body": "<p>I am having problems with a VBA Excel 2010 program code.</p>\n\n<p>I am trying to read data from a spreadsheet on excel 2010. what I have is a set of data (see below) and I am trying to write a code that will let me use a msg box and ask me to write down the name I am looking for e.g. \"Name 1\" from the list of names in the column and then I want to set a criteria where if the number in the columns are equal to zero and again for a different column = 0 (\"name 5\"), then highlight red any number in column \"Name 8 and Name 9\" that is greater than let say 30 (just a random example). the important thing is, the red highlight of column \"Name 8/9\" must only occur if the numbers is row \"Name 1\" and \"Name 5\" are equal to zero.</p>\n\n<p>I have already done this but I only used the column numbers e.g. A1:A5. now I need to use the name of the column because I want to use the code for a different excel spreadsheets but the names of columns are in different positions for each excel sheet, but if I use the names, no matter which column along excel they are I will always find the right column I am looking for and set the criteria.</p>\n\n<p>the criteria for \"Name 1/5\" will always be = 0 or =1 but the program has to ask me to choose that when I search for it.</p>\n\n<p>if you look below at the example, you can see the red highlight are when criteria of =0 is met for Name 1 and Name 5 and the number in Name8/9 are greater than 30. when it is not greater than 30 and it still meets the criteria it is highlighted blue in the excel spreadsheet example. ALL OTHER NAMES MUST BE IGNORED.</p>\n\n<p>SEE EXAMPLE BELOW</p>\n\n<pre><code>Name 1  Name 2  Name 3  Name 4  Name 5  Name 6  Name 7  Name 8  Name 9  Name 10\n0       0       1       0       0       1       58      35      14      19\n0       0       0       0       0       1       41      45      68      74\n1       0       1       0       1       0       23      18      98      87\n0       0       1       0       0       1       65      36      52      89\n0       0       0       0       1       1       24      95      47      75\n1       1       1       0       1       0       58      87      59      14\n0       1       0       0       0       0       74      41      84      32\n1       1       0       0       1       0       96      25      74      96\n0       0       0       0       0       0       87      35      15      53\n0       0       1       0       0       1       57      49      48      47\n1       0       1       0       1       1       63      84      23      65\n0       1       0       0       0       0       21      54      69      12\n0       0       1       0       0       0       54      23      54      54\n1       1       0       0       1       1       88      34      77      88\n0       0       1       0       0       0       78      48      68      69\n1       0       1       0       0       1       96      87      14      65\n1       0       0       0       1       0       21      96      54      25\n0       1       0       0       0       0       54      72      78      29\n0       1       1       0       0       1       62      38      22      78\n0       0       0       0       0       0       21      49      65      54\n1       0       1       0       1       1       17      65      98      99\n0       0       0       0       0       0       59      15      56      70\n0       1       1       0       0       0       36      12      29      54\n1       0       0       0       1       0       29      49      55      54\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Private Sub CommandButton21_Click() \n    Cells.Interior.ColorIndex = 0 \n    For Each rw In Range(\"A1:V22\").Rows \n        If Application.Sum(rw.Resize(, 4)) = 0 Then \n            cll.Interior.ColorIndex = 3 \n            For Each cll In rw.Offset(, 4).Resize(, 18).Cells \n                If cll.Value &gt; 50 Then cll.Interior.ColorIndex = 3 \n            Next cll \n        End If \n    Next rw \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1441191364, "post_id": 32350623, "comment_id": 52575512, "body": "that&#39;s it! thanks. couldn&#39;t come up with this trick b myself :)  is there any chance to add horizontal scrollbar to the 1-column-ListBox?"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1441192864, "post_id": 32350623, "comment_id": 52576491, "body": "Vertical scrollbars are automatic. For the horizontal scrollbar you will need to specify a ColumnWidth property that is greater than the width of the listbox."}, {"owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1441193885, "post_id": 32350623, "comment_id": 52577180, "body": "It worked, thanks! But as I understand, it will be fixed width - even if all the lines are shorter. Is it possible to make a scroll-bar to adjust its width?"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1441194858, "post_id": 32350623, "comment_id": 52577797, "body": "I suppose you could loop through the array and find the max length of the lines you have and use this to set the width e.g. Lst_Detail.Width = 72 prior to filling the listbox. The number refers to points. There are 72 points to the inch! You would need to play around with this to see what fits best with your line length"}, {"owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "edited": false, "score": 0, "creation_date": 1441196009, "post_id": 32350623, "comment_id": 52578591, "body": "yeah, again, you are right, thanks. Hoped, there would be some native solution and didn&#39;t think out of the box to create such workaroud :)"}], "tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": true, "score": 1, "last_activity_date": 1441189452, "creation_date": 1441189452, "answer_id": 32350623, "question_id": 32349996, "link": "https://stackoverflow.com/questions/32349996/vba-listbox-crashes-when-adding-too-long-line/32350623#32350623", "title": "VBA ListBox crashes when adding too long line", "body": "<p>I think there is a 1,024 character limit on a listbox line. Could you populate an array where the input is chunked down to 1024 characters and then populate the listbox from the array?</p>\n"}], "owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 32350623, "answer_count": 1, "score": 0, "last_activity_date": 1441189452, "creation_date": 1441187621, "question_id": 32349996, "link": "https://stackoverflow.com/questions/32349996/vba-listbox-crashes-when-adding-too-long-line", "title": "VBA ListBox crashes when adding too long line", "body": "<p>I need to populate ListBox with lines (so I'm using 1 column without specified column width) by ListBox1.AddItem command. When the line is too long (about 10k characters :) ), Excel returns a runtime error '-2147352571 (80020005)': Type Mismatch.</p>\n\n<p>When I was using TextBox, it worked correctly.</p>\n\n<p>Moreover, how can I add horizontal scrollbar to the ListBox?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1441187235, "post_id": 32349801, "comment_id": 52572881, "body": "What happens when you try to run the code in your sample? Any error messages? You learn faster by doing it yourself and then asking questions about the problems you run into. :)"}, {"owner": {"reputation": 6170, "user_id": 214792, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/95ac5dea32c1b802e8b95f9d4b902f05?s=128&d=identicon&r=PG", "display_name": "Martin Milan", "link": "https://stackoverflow.com/users/214792/martin-milan"}, "edited": false, "score": 0, "creation_date": 1441187291, "post_id": 32349801, "comment_id": 52572917, "body": "Think about iterating through the cells in a given range..."}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1441191522, "post_id": 32349801, "comment_id": 52575614, "body": "Thanks for the advice. I&#39;m going to test telyln&#39;s answer a little bit and try figure out myself what&#39;s going on. I&#39;ll get back if I&#39;m still stuck"}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1441191763, "post_id": 32349990, "comment_id": 52575777, "body": "Excellent. This worked. I just had to change the Delete line to <code>Delete Shift:=xlToLeft</code>  Thanks a million!"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 3, "last_activity_date": 1441187602, "creation_date": 1441187602, "answer_id": 32349990, "question_id": 32349801, "link": "https://stackoverflow.com/questions/32349801/how-can-you-write-a-vba-script-to-delete-all-cells-in-a-range-containing-a-certa/32349990#32349990", "title": "How can you write a VBA script to delete all cells in a range containing a certain string?", "body": "<p>conceptually (not in front of Excel right now)</p>\n\n<pre><code>dim cel as range\nfor each cel in Range(\"C1:C100\")\n   if cel.Value = \",\" Then\n      cel.Delete Shift:=xlRight \n   end if\nnext cel\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 32349990, "answer_count": 1, "score": 1, "last_activity_date": 1441274266, "creation_date": 1441187036, "question_id": 32349801, "link": "https://stackoverflow.com/questions/32349801/how-can-you-write-a-vba-script-to-delete-all-cells-in-a-range-containing-a-certa", "title": "How can you write a VBA script to delete all cells in a range containing a certain string?", "body": "<p>If I have a large range of cells, and I want to delete all cells containing just a \",\" or similar, how can I express this in code? I was thinking something along the lines of </p>\n\n<pre><code>If Range(\"C1:C100\").Value = \",\" Then \nActive.Cell.Delete Shift:=xlRight \n</code></pre>\n\n<p>I know this is terrible, but hopefully it gets my point across. </p>\n\n<p>Thanks! </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441193726, "post_id": 32349708, "comment_id": 52577081, "body": "You ask to select just one row so why is this &quot;not suppose to happen&quot;?"}, {"owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441197195, "post_id": 32349708, "comment_id": 52579496, "body": "I need help on how to prevent a record to be selected/edited if someone is already in transaction to that specific record."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441198826, "post_id": 32349708, "comment_id": 52580769, "body": "The simplest method is to catch the error. Then decide if to skip or to reread the record and try again."}, {"owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441203999, "post_id": 32349708, "comment_id": 52584558, "body": "Hi Gustav, thank you for taking time to help me with this. I actually do not receive any error. My query updates assignedto column with the userid where the record id is in select top1 from table 1 where assignedto is null"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441205269, "post_id": 32349708, "comment_id": 52585575, "body": "But then everything seems fine. So what&#39;s the issue? Perhaps you should rephrase your question."}, {"owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441205579, "post_id": 32349708, "comment_id": 52585810, "body": "Multiple users were still able to pull the same record. Even if I set the sql query the way I wanted to. and the update query(that was mentioned on my earlier comment) overwrites the assignedto column to the last one who pulled the claim. Sorry Im currently only using my phone as I cannot connect thru fb on the current connection available on the area"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441206191, "post_id": 32349708, "comment_id": 52586282, "body": "Well, the last edit wins. If you don&#39;t want this, you will have to introduce a reservation system or apply brute-force locking of the records."}, {"owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441209322, "post_id": 32349708, "comment_id": 52588468, "body": "Umm that I do not know... Can you give me a hint how?"}, {"owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441209566, "post_id": 32349708, "comment_id": 52588642, "body": "What I know is that if I use aduseserver as curserlocation the file that is being edited will be locked and will not be updated."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441213614, "post_id": 32349708, "comment_id": 52591078, "body": "It&#39;s a little up to you what could be done in your application. There is no right or wrong solution on how to solve concurrent updates."}, {"owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441213852, "post_id": 32349708, "comment_id": 52591248, "body": "Got it. Thanks Gustav for clearing something im confused to. I was under the impression that first in first out is applied in the database given that an execution of the query will only be performed once it the server is free. Or should i say not executing anything at all. So given my query to update select where should have worked given that mindset. I think ill just place a primary to the table assigned to not insert anything that is already in their to prompt an error and goto extract again.  Thanks"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441215342, "post_id": 32349708, "comment_id": 52592138, "body": "OK, that makes sense."}], "owner": {"reputation": 1, "user_id": 5291900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1140277939332912/picture?type=large", "display_name": "Vhiz", "link": "https://stackoverflow.com/users/5291900/vhiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594643735, "creation_date": 1441186794, "last_edit_date": 1594643735, "question_id": 32349708, "link": "https://stackoverflow.com/questions/32349708/record-locking-issue", "title": "Record locking issue", "body": "<p>I'm new in stackoverflow and I'm in serious problem right now.</p>\n\n<p>On the tool that I created multiple users were pulling 1 records which was not suppose to happen.</p>\n\n<p>Code I'm currently using is <em>VBA</em> in <em>Access 2010</em></p>\n\n<pre><code>Dim objcon as adodb.connection\nDim rs as adodb.recordset\n\nObjcon.cursorlocation = aduseclient\n</code></pre>\n\n<p>This is how I do the connection </p>\n\n<pre><code>using .open \"Provider=SQLNCLI10;Server=dbsed2231;Database=UHCPI_Manila;Integrated Security=SSPI;\" _\n                        &amp; \"DataTypeCompatibility=80;MARS Connection=True;Persist Security Info=False;\"\n</code></pre>\n\n<p>Query when pulling transactions.</p>\n\n<pre><code>Select top 1 from table 1 order by receivedate\n</code></pre>\n\n<p>Please advise.</p>\n"}, {"tags": ["excel", "selenium", "selenium-webdriver", "vba"], "comments": [{"owner": {"reputation": 5923, "user_id": 1943133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wAuRI.jpg?s=128&g=1", "display_name": "drkthng", "link": "https://stackoverflow.com/users/1943133/drkthng"}, "edited": false, "score": 0, "creation_date": 1441184314, "post_id": 32348486, "comment_id": 52570990, "body": "what do you mean by &quot;fully load&quot;? Do you mean the accessibility of a certain element (element is displayed)?"}, {"owner": {"reputation": 51, "user_id": 5286717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439ab2a401869cced0573e951776800e?s=128&d=identicon&r=PG&f=1", "display_name": "MackyMac", "link": "https://stackoverflow.com/users/5286717/mackymac"}, "reply_to_user": {"reputation": 5923, "user_id": 1943133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wAuRI.jpg?s=128&g=1", "display_name": "drkthng", "link": "https://stackoverflow.com/users/1943133/drkthng"}, "edited": false, "score": 0, "creation_date": 1441184636, "post_id": 32348486, "comment_id": 52571171, "body": "i meant that all the elements are displayed and editable. In the case of firefox, if you look on the Tab of the page you are viewing, the circulating thing is no longer visible."}, {"owner": {"reputation": 5923, "user_id": 1943133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wAuRI.jpg?s=128&g=1", "display_name": "drkthng", "link": "https://stackoverflow.com/users/1943133/drkthng"}, "edited": false, "score": 0, "creation_date": 1441185183, "post_id": 32348486, "comment_id": 52571492, "body": "As I wrote in my answer this waiting for the &quot;circulating thing&quot; is done already natively by Selenium. What exactly do you want to achieve later down the road. I guess your problem is actually a different one."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5286717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439ab2a401869cced0573e951776800e?s=128&d=identicon&r=PG&f=1", "display_name": "MackyMac", "link": "https://stackoverflow.com/users/5286717/mackymac"}, "edited": false, "score": 0, "creation_date": 1441185411, "post_id": 32348929, "comment_id": 52571647, "body": "Thank you for your reply. Basically my problem is that i loaded a URL then it takes about a minute to load completely. By the time it loads completely, I already received an error saying  &quot;Run-time error &#39;101&#39;: WebRequestTimeout: No Response from the server within 30000 seconds...&quot; the code i used was   driver.Start &quot;firefox&quot;   driver.Get url, 240000, False driver.FindElementById(&quot;login_form&quot;).WaitDisplayed"}, {"owner": {"reputation": 5923, "user_id": 1943133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wAuRI.jpg?s=128&g=1", "display_name": "drkthng", "link": "https://stackoverflow.com/users/1943133/drkthng"}, "reply_to_user": {"reputation": 51, "user_id": 5286717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439ab2a401869cced0573e951776800e?s=128&d=identicon&r=PG&f=1", "display_name": "MackyMac", "link": "https://stackoverflow.com/users/5286717/mackymac"}, "edited": false, "score": 0, "creation_date": 1441185818, "post_id": 32348929, "comment_id": 52571948, "body": "have you tried: driver.start &quot;firefox&quot;, url   ? Have you debugged when exactly your code times out? I mean if he passes the &quot;get url&quot; part or if he times out there already?"}, {"owner": {"reputation": 51, "user_id": 5286717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439ab2a401869cced0573e951776800e?s=128&d=identicon&r=PG&f=1", "display_name": "MackyMac", "link": "https://stackoverflow.com/users/5286717/mackymac"}, "edited": false, "score": 0, "creation_date": 1441186137, "post_id": 32348929, "comment_id": 52572176, "body": "it passes the Get URL then he times out already indicating this error &quot; Run-time error &#39;101&#39;: WebRequestTimeout: No Response from the server within 30000 seconds..&quot;"}], "tags": [], "owner": {"reputation": 5923, "user_id": 1943133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wAuRI.jpg?s=128&g=1", "display_name": "drkthng", "link": "https://stackoverflow.com/users/1943133/drkthng"}, "is_accepted": false, "score": 0, "last_activity_date": 1441185099, "last_edit_date": 1592644375, "creation_date": 1441184723, "answer_id": 32348929, "question_id": 32348486, "link": "https://stackoverflow.com/questions/32348486/how-to-make-selenium-wait-for-the-page-to-fully-load-in-selenium-wrapper-for-e/32348929#32348929", "title": "How to make selenium wait for the page to fully load in Selenium - wrapper for Excel VBA?", "body": "<h1>Short Answer</h1>\n<p>Selenium  (also the ExcelVBA wrapper) does this for you. It waits for the <a href=\"https://developer.mozilla.org/en-US/docs/DOM/document.readyState\" rel=\"nofollow noreferrer\">DOM <code>readyState</code></a> to signal that it is complete.</p>\n<p>In case of the Excel-Wrapper this will be done when calling <code>driver.start</code></p>\n<h1>BUT</h1>\n<p>This won't help you if you have AJAX-calls or Elements that load via JavaScript and so forth.</p>\n<p>There you will need to implement <strong>implicit and explicit waits</strong> to check if the element you are trying to interact with is already existent or even displayed.</p>\n<p>It makes no sense to wait for ALL elements to be visible if you want to interact with a certain element. In this case you should just wait for this element to be displayed and then interact with this element.</p>\n<p><em>If you would elaborate more on your actual problem, we could give you much more detailed advice.</em></p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 5216265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QVivV.jpg?s=128&g=1", "display_name": "jlookup", "link": "https://stackoverflow.com/users/5216265/jlookup"}, "is_accepted": false, "score": 0, "last_activity_date": 1442439987, "creation_date": 1442439987, "answer_id": 32619311, "question_id": 32348486, "link": "https://stackoverflow.com/questions/32348486/how-to-make-selenium-wait-for-the-page-to-fully-load-in-selenium-wrapper-for-e/32619311#32619311", "title": "How to make selenium wait for the page to fully load in Selenium - wrapper for Excel VBA?", "body": "<p>I have this problem as well. I have tried both implicit and explicit waits, but have not been able to get the timeout to hold off longer than 30 seconds. I use two workarounds. </p>\n\n<p>The first is klunky but simple: after my <code>.get</code> or <code>.click</code> event that initiates the page load I pause the code using a messagebox: <code>msgBox \"Wait for page to load then click OK.\"</code> </p>\n\n<p>The second is a bit more refined. If I know my page usually takes 50 seconds to load I will put in a set wait period of say, 45 seconds, then have the script verify that a certain element has loaded before continuing:</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n\nsub LongLoad()\nDim driver As New SeleniumWrapper.WebDriver\nDim By As New By, Assert As New Assert, Verify As New Verify, Waiter As New Waiter\ndim YesNo as boolean\n\ndriver.Start \"chrome\", \"https://super.secret.com/\"\ndriver.setImplicitWait 5000\ndriver.setTimeout 120000\n\ndriver.Get \"/heroLogin\"\ndriver.findElementByName(\"USER\").Clear\ndriver.findElementByName(\"USER\").SendKeys \"user\"\ndriver.findElementByName(\"PASSWORD\").Clear\ndriver.findElementByName(\"PASSWORD\").SendKeys \"pass\"\ndriver.findElementById(\"Button\").Click\n\n'pause for 45 seconds (see if you can hold your breath)\nSleep 45000\n\n'poll for the presence of an element. In my case a certain string of    \n'text is good enough. \ndriver.verifyTextPresent (\"Enterprise Reporting\")\n\n'now you're ready to go.\n</code></pre>\n\n<p><code>.verifyTextPresent</code> also has a timeout of 30 seconds, so you still have to use the sleep function first for slow page loads.</p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 4, "last_activity_date": 1453451093, "creation_date": 1453451093, "answer_id": 34942084, "question_id": 32348486, "link": "https://stackoverflow.com/questions/32348486/how-to-make-selenium-wait-for-the-page-to-fully-load-in-selenium-wrapper-for-e/34942084#34942084", "title": "How to make selenium wait for the page to fully load in Selenium - wrapper for Excel VBA?", "body": "<p>The latest version waits implicitly that the targeted element is present before executing the required action. For instance, driver.FindElementById(\"...\").Click will by default try to find the element during 3 seconds before throwing an error.</p>\n\n<p>This implicit waiting can be defined globally:</p>\n\n<pre><code>driver.Timeouts.ImplicitWait = 5000 ' 5 seconds\n</code></pre>\n\n<p>As well as individually :</p>\n\n<pre><code>driver.FindElementById(\"id\", timeout:=10000).Click  ' implicitly wait of 10sec\ndriver.FindElementById(\"id\", timeout:=0).Click  ' no implicit waiting\n</code></pre>\n\n<p>To set the timeout for the server that runs the browser:</p>\n\n<pre><code>driver.Timeouts.Server = 120000 ' 2 mins\n</code></pre>\n\n<p>To get the latest version in date working with the above example: <a href=\"https://github.com/florentbr/SeleniumBasic/releases/latest\" rel=\"nofollow\">https://github.com/florentbr/SeleniumBasic/releases/latest</a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6437257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/490c0a5bb7e9cdc9c4483c6715b22dca?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Torrez", "link": "https://stackoverflow.com/users/6437257/christian-torrez"}, "is_accepted": false, "score": 0, "last_activity_date": 1465332943, "last_edit_date": 1495535648, "creation_date": 1465332943, "answer_id": 37689197, "question_id": 32348486, "link": "https://stackoverflow.com/questions/32348486/how-to-make-selenium-wait-for-the-page-to-fully-load-in-selenium-wrapper-for-e/37689197#37689197", "title": "How to make selenium wait for the page to fully load in Selenium - wrapper for Excel VBA?", "body": "<p>Hi using this Reference <a href=\"https://stackoverflow.com/questions/5868439/wait-for-page-load-in-selenium\">wait-for-page-load-in-selenium</a></p>\n\n<p>I developed this code:</p>\n\n<pre><code>While Selenium.ExecuteScript(\"return document.readyState\") &lt;&gt; \"complete\"\n    Selenium.Wait (5000)\nWend\n</code></pre>\n\n<p>It looks that the best way is pseudocode: <code>Wait until a specific FindElementbyId appears</code>. The solution presented is a general approach.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6877620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22410593ae056a3c5fcc4fd1f85b21a2?s=128&d=identicon&r=PG&f=1", "display_name": "pranjalk", "link": "https://stackoverflow.com/users/6877620/pranjalk"}, "is_accepted": false, "score": 1, "last_activity_date": 1576925426, "creation_date": 1576925426, "answer_id": 59435516, "question_id": 32348486, "link": "https://stackoverflow.com/questions/32348486/how-to-make-selenium-wait-for-the-page-to-fully-load-in-selenium-wrapper-for-e/59435516#59435516", "title": "How to make selenium wait for the page to fully load in Selenium - wrapper for Excel VBA?", "body": "<p>While Florent B's answer is as usual correct what I'd like to add further to that is that there is another piece of code that you might want to add to directly address the problem of increasing the PageLoad in addition to setting the Server Timeouts of the selenium browser:</p>\n\n<pre><code>'At the beginning of the code\nApplication.DisplayAlerts = False\n\ndriver.Timeouts.PageLoad = 500000 'this is the piece of code that worked for me\ndriver.Timeouts.Server = 500000\n\n'At the end of the code\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>The pageload code makes sure that the browser continues to wait until the page is fully loaded with all the data that needs to get loaded in it.</p>\n\n<p>Further, if you would need to increase the time to as much as 500 seconds as highlighted in the code you may also want to disable alerts in Excel as highlighted in code above</p>\n"}], "owner": {"reputation": 51, "user_id": 5286717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439ab2a401869cced0573e951776800e?s=128&d=identicon&r=PG&f=1", "display_name": "MackyMac", "link": "https://stackoverflow.com/users/5286717/mackymac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15045, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1595436754, "creation_date": 1441183438, "last_edit_date": 1531161705, "question_id": 32348486, "link": "https://stackoverflow.com/questions/32348486/how-to-make-selenium-wait-for-the-page-to-fully-load-in-selenium-wrapper-for-e", "title": "How to make selenium wait for the page to fully load in Selenium - wrapper for Excel VBA?", "body": "<p>What code or function for Selenium - wrapper for Excel VBA to be used so that the program will wait for the page to fully load then execute other commands?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441183732, "post_id": 32348128, "comment_id": 52570668, "body": "It would help if you had some code to work from. Finding shaded cells can be a problem. See this article which might help <a href=\"http://answers.microsoft.com/en-us/mac/forum/macoffice2011-macword/find-and-change-on-table-cell-shading/5eab329e-55f0-4f00-b477-a5bc05a0faee\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/mac/forum/macoffice2011-macword/&zwnj;&#8203;&hellip;</a>   This demonstrates how to change the cell shading. Instead of this you could change the text colour to be the same as the background."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 1312620, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5807b6819a0fd2e0756d670db99da68a?s=128&d=identicon&r=PG", "display_name": "DeeGo", "link": "https://stackoverflow.com/users/1312620/deego"}, "is_accepted": false, "score": 0, "last_activity_date": 1441612852, "creation_date": 1441612852, "answer_id": 32433775, "question_id": 32348128, "link": "https://stackoverflow.com/questions/32348128/word-vba-script/32433775#32433775", "title": "Word VBA script", "body": "<pre><code>selection.homekey wdstory \n    With Selection.find\n        .ClearFormatting\n        .Highlight = True\n        .Wrap = wdFindStop\n        Do While .Execute = True\n            If selection.range.HighlightColorIndex = wdgray25 and Selection.Information(wdWithInTable) = False Then\n                Selection.RANGE.font.Hidden = True\n                ''Selection.RANGE.font.ColorIndex = wdWhite   ''to hide the text content\n                ''Selection.RANGE.HighlightColorIndex = wdAuto ''to remove the highlight\n            End If\n            selection.Collapse wdCollapseEnd\n        Loop\n    End With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5291593, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VxUiNfbPcLY/AAAAAAAAAAI/AAAAAAAAAfE/Nz0MZpQqe_Y/photo.jpg?sz=128", "display_name": "Firoz Hasolkar", "link": "https://stackoverflow.com/users/5291593/firoz-hasolkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1441612852, "creation_date": 1441182333, "last_edit_date": 1441192418, "question_id": 32348128, "link": "https://stackoverflow.com/questions/32348128/word-vba-script", "title": "Word VBA script", "body": "<p>I am looking for word VBA script to hide table cell with grey background.\nI have files which have lots of table, in that there are some cells with background color, I need to hide the content of this cells... can anyone help me out?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1441181714, "post_id": 32347722, "comment_id": 52569396, "body": "Definitely you need to use VBA, so at first add also VBA tag to your question:). As you didn&#39;t write whether you know VBA or not I don&#39;t know whether you need link to good VBA tutorials, or really some hints on the ways to write the code."}, {"owner": {"reputation": 3, "user_id": 5291487, "user_type": "registered", "profile_image": "https://graph.facebook.com/1103618926318045/picture?type=large", "display_name": "Johannes Piontkowitz", "link": "https://stackoverflow.com/users/5291487/johannes-piontkowitz"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1441182735, "post_id": 32347722, "comment_id": 52570018, "body": "You&#39;re right, i&#39;ll add that right away. I have some basic knowledge in VBA, but nothing too crazy. So what i&#39;d need would be how to set up the code correctly. And i could need some help with adding and filling a column, also by script?"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1441187075, "post_id": 32347722, "comment_id": 52572782, "body": "First step probably would be to search for Workbook.BeforeSave, that&#39;s the location where you need to add your code. Adding and filling the column can be done through VBA too."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1441193536, "post_id": 32347722, "comment_id": 52576954, "body": "@M&#225;t&#233;Juh&#225;sz: VBA is not strictly required. You could also automate Excel from a PowerShell script, or write a .NET (or even native) application to implement the modifications. These options can provide a solution, if the operations are part of a larger workflow, or if you cannot deploy the VBA module to every machine where the functionality is required."}, {"owner": {"reputation": 3, "user_id": 5291487, "user_type": "registered", "profile_image": "https://graph.facebook.com/1103618926318045/picture?type=large", "display_name": "Johannes Piontkowitz", "link": "https://stackoverflow.com/users/5291487/johannes-piontkowitz"}, "edited": false, "score": 0, "creation_date": 1441195365, "post_id": 32347722, "comment_id": 52578178, "body": "Okay so basically what i need. I get a daily report attached to an e-mail. I already made a script so it saves the attachement automatically in a specific folder. After that, one column from the excel needs to be deleted while another one is created and has the current date in every line. Then the excel should be saved and imported to a database which i manage via Microsoft SQL Server Management Studio. EDIT: I have a deticated pc which only runs to do this single task. So this is my setup, what would you guys recommend?"}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 4982078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01b0e059e9c17a50efa5c12ab7633c93?s=128&d=identicon&r=PG&f=1", "display_name": "bloxx", "link": "https://stackoverflow.com/users/4982078/bloxx"}, "is_accepted": false, "score": 0, "last_activity_date": 1441181638, "creation_date": 1441181638, "answer_id": 32347914, "question_id": 32347722, "link": "https://stackoverflow.com/questions/32347722/delete-excel-column-with-specific-name-via-script/32347914#32347914", "title": "Delete Excel Column with specific name via script", "body": "<p>-Create a macro to save the file to a specific folder.</p>\n\n<p>-When the macro is called, delete the column before saving <code>Columns([Column Number]).EntireColumn.Delete</code></p>\n\n<p>Check Excel forums for help</p>\n"}], "owner": {"reputation": 3, "user_id": 5291487, "user_type": "registered", "profile_image": "https://graph.facebook.com/1103618926318045/picture?type=large", "display_name": "Johannes Piontkowitz", "link": "https://stackoverflow.com/users/5291487/johannes-piontkowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441182782, "creation_date": 1441181012, "last_edit_date": 1441182782, "question_id": 32347722, "link": "https://stackoverflow.com/questions/32347722/delete-excel-column-with-specific-name-via-script", "title": "Delete Excel Column with specific name via script", "body": "<p>I need to delete a column in different exports (column is always the same) before importing it into a database. I want it to be automatically done when the excel file is saved in a specific folder. Can anyone give advice on how to start and/or do it? </p>\n\n<p>Jo</p>\n"}, {"tags": ["excel", "vba", "office365", "last-modified"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 2, "creation_date": 1441182370, "post_id": 32347515, "comment_id": 52569773, "body": "Welcome at stackoverflow, unfortunately it&#39;s not a free code writing service. You need to start learning to write code and we&#39;re happy to help you during that. If you don&#39;t wish to learn it then best option is probably to hire somebody to do it for you."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4849799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KQLAKyN_Scs/AAAAAAAAAAI/AAAAAAAAAJQ/97mpBkcpzP0/photo.jpg?sz=128", "display_name": "Riccardo Dell&#39;Omo", "link": "https://stackoverflow.com/users/4849799/riccardo-dellomo"}, "edited": false, "score": 0, "creation_date": 1441189345, "post_id": 32348193, "comment_id": 52574313, "body": "Unfortunately it doesn&#39;t work ! The file path is not taken and appears #VALUE !"}, {"owner": {"reputation": 129, "user_id": 5233492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qo4SH.jpg?s=128&g=1", "display_name": "SY Chen", "link": "https://stackoverflow.com/users/5233492/sy-chen"}, "reply_to_user": {"reputation": 37, "user_id": 4849799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KQLAKyN_Scs/AAAAAAAAAAI/AAAAAAAAAJQ/97mpBkcpzP0/photo.jpg?sz=128", "display_name": "Riccardo Dell&#39;Omo", "link": "https://stackoverflow.com/users/4849799/riccardo-dellomo"}, "edited": false, "score": 0, "creation_date": 1441254082, "post_id": 32348193, "comment_id": 52605800, "body": "Any more detail information? Please check the file path like this D:\\QueyTable.xlsm."}], "tags": [], "owner": {"reputation": 129, "user_id": 5233492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qo4SH.jpg?s=128&g=1", "display_name": "SY Chen", "link": "https://stackoverflow.com/users/5233492/sy-chen"}, "is_accepted": false, "score": 3, "last_activity_date": 1536518008, "last_edit_date": 1536518008, "creation_date": 1441182504, "answer_id": 32348193, "question_id": 32347515, "link": "https://stackoverflow.com/questions/32347515/get-last-modified-date-of-file-excel/32348193#32348193", "title": "Get last modified date of file excel", "body": "<p>That's easy! You can apply <code>FileDateTime ( file_path )</code>. If you have file patch &amp; name list in column A, and this macro will return the date &amp; time of when a file was created or last modified in column B.</p>\n\n<pre><code>Sub LastFileDateTime()\nCNT = Range(\"A65536\").End(xlUp).Row\nFor i = 1 To CNT\n    Cells(i, \"B\").Value = FileDateTime(Cells(i, \"A\"))\n    'FileDateTime(\"D:\\QueryTable.xlsm\")\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7495479, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2725baffa2afa360e7f9b89d4ccc73bc?s=128&d=identicon&r=PG", "display_name": "Charlie Job", "link": "https://stackoverflow.com/users/7495479/charlie-job"}, "is_accepted": false, "score": 0, "last_activity_date": 1536518001, "last_edit_date": 1536518001, "creation_date": 1485872467, "answer_id": 41959915, "question_id": 32347515, "link": "https://stackoverflow.com/questions/32347515/get-last-modified-date-of-file-excel/41959915#41959915", "title": "Get last modified date of file excel", "body": "<p>You have to replace \"A\" and \"B\" with the number for the column, and you can simplify if you know how many rows you have. I was able to get it to work with the code below.</p>\n\n<pre><code>Sub LastFileDateTime()\nFor i = 2 To 45\n    Cells(i, 2).Value = FileDateTime(Cells(i, 1))\n    'FileDateTime(\"D:\\QueryTable.xlsm\")\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4849799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KQLAKyN_Scs/AAAAAAAAAAI/AAAAAAAAAJQ/97mpBkcpzP0/photo.jpg?sz=128", "display_name": "Riccardo Dell&#39;Omo", "link": "https://stackoverflow.com/users/4849799/riccardo-dellomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5143, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1536518008, "creation_date": 1441180396, "question_id": 32347515, "link": "https://stackoverflow.com/questions/32347515/get-last-modified-date-of-file-excel", "title": "Get last modified date of file excel", "body": "<p>I would like to get the last modified date of a given list of files that I need to enter in column A of Excel . How can I fix this ? For each file , I want to get the last modified date. Unfortunately I haven't many skills in VBA .</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1441180569, "creation_date": 1441180569, "answer_id": 32347569, "question_id": 32347149, "link": "https://stackoverflow.com/questions/32347149/entering-a-cellvalue-if-one-of-the-cells-in-a-range-is-changed-and-deleting-it-i/32347569#32347569", "title": "Entering a cellvalue if one of the cells in a range is changed and deleting it if range is empty", "body": "<p>You got <code>Type mismatch</code> error for wrong syntax in this line:</p>\n\n<pre><code>If Range(\"B\" &amp; cell.Row, \"G\" &amp; cell.Row).Value = \"\" Then\n</code></pre>\n\n<p>So, I modified it and it work well. I also reduce one looping because both condition can set in only one looping.</p>\n\n<p>Here, the full code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng As Range, cell As Range\n\n    On Error GoTo haveError\n\n    Set rng = Application.Intersect(Target, Me.Range(\"B1:G100\"))\n\n    If Not rng Is Nothing Then\n\n        Application.EnableEvents = False\n\n        For Each cell In rng.Cells\n\n            If cell.Value = \"blah\" Then\n                Me.Range(\"A\" &amp; cell.Row).Value = \"derp\"\n            End If\n\n            If WorksheetFunction.CountA(Me.Range(\"B\" &amp; cell.Row &amp; \":\" &amp; \"G\" &amp; cell.Row)) = 0 Then\n                Me.Range(\"A\" &amp; cell.Row).ClearContents\n            End If\n\n        Next\n\n        Application.EnableEvents = True\n\n    End If\n\n    Exit Sub\n\nhaveError:\n    MsgBox Err.Description\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1441180622, "creation_date": 1441180622, "answer_id": 32347587, "question_id": 32347149, "link": "https://stackoverflow.com/questions/32347149/entering-a-cellvalue-if-one-of-the-cells-in-a-range-is-changed-and-deleting-it-i/32347587#32347587", "title": "Entering a cellvalue if one of the cells in a range is changed and deleting it if range is empty", "body": "<p>I've reorganized some commands and only performed actions when they are necessary.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    'don't do anything unless there is something to do\n    If Not Intersect(Target, Me.Range(\"B1:G100\")) Is Nothing Then\n        On Error GoTo haveError\n        'don't declare vars until you kow you will need them\n        Dim rng As Range, cell As Range\n        Application.EnableEvents = False\n\n        Set rng = Application.Intersect(Target, Me.Range(\"B1:G100\"))\n        For Each cell In rng.Cells\n            If cell.Value = \"blah\" Then\n                Range(\"A\" &amp; cell.Row).Value = \"derp\"\n            ElseIf Application.CountBlank(Cells(cell.Row, \"B\").Resize(1, 6)) = 6 Then\n                Cells(cell.Row, \"A\").ClearContents\n            End If\n    End If\n    GoTo safeExit\n\nhaveError:\n    If CBool(Err.Number) Then\n        'Debug.Print Err.Number &amp; \": \" &amp; Err.Description\n        MsgBox Err.Number &amp; \": \" &amp; Err.Description\n        Err.Clear\n    End If\nsafeExit:\n    Set rng = Nothing\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Rather than having two <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow\">For Each...Next Statement</a>, I've used an <code>If ... ElseIf ... End If</code> since the conditions are mutually exclusive (i.e. if one is true, the other cannot be true).</p>\n"}], "owner": {"reputation": 3, "user_id": 5291412, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M2g2MwvuLo8/AAAAAAAAAAI/AAAAAAAABlA/-T0FeCBSz3s/photo.jpg?sz=128", "display_name": "Joost Beekman", "link": "https://stackoverflow.com/users/5291412/joost-beekman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441180622, "creation_date": 1441179333, "question_id": 32347149, "link": "https://stackoverflow.com/questions/32347149/entering-a-cellvalue-if-one-of-the-cells-in-a-range-is-changed-and-deleting-it-i", "title": "Entering a cellvalue if one of the cells in a range is changed and deleting it if range is empty", "body": "<p>I want to make a code that adds a certain value to the first column if values are added to a certain range. And delete that value if that range is empty.\nThis is what I have so far, but I keep getting errors and I can't seem to figure out what I'm doing wrong.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rng As Range, cell As Range\n\nOn Error GoTo haveError\n\nSet rng = Application.Intersect(Target, Me.Range(\"B1:G100\"))\n\nIf Not rng Is Nothing Then\nApplication.EnableEvents = False\nFor Each cell In rng.Cells\n    If cell.Value = \"blah\" Then\n        Range(\"A\" &amp; cell.Row).Value = \"derp\"\n    End If\n    Next\nFor Each cell In rng.Cells\n    If Range(\"B\" &amp; cell.Row, \"G\" &amp; cell.Row).Value = \"\" Then\n        Range(\"A\" &amp; cell.Row).ClearContents\n    End If\n    Next\nApplication.EnableEvents = True\n\nEnd If\nExit Sub\n\nhaveError:\nMsgBox Err.Description\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5291265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440f3269ff5273fbcb48eac8a0518ed4?s=128&d=identicon&r=PG&f=1", "display_name": "trihandoko", "link": "https://stackoverflow.com/users/5291265/trihandoko"}, "edited": false, "score": 0, "creation_date": 1441305656, "post_id": 32349088, "comment_id": 52636800, "body": "I am a newbie, please inform me if I have to make new form name Frm_PivotDetail.show."}, {"owner": {"reputation": 1, "user_id": 5291265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440f3269ff5273fbcb48eac8a0518ed4?s=128&d=identicon&r=PG&f=1", "display_name": "trihandoko", "link": "https://stackoverflow.com/users/5291265/trihandoko"}, "edited": false, "score": 0, "creation_date": 1441306968, "post_id": 32349088, "comment_id": 52637564, "body": "I have run the program but &#39;OK&#39; sign alway appear on the most top record, it is not enter itu a record which DocOrderID is 3."}, {"owner": {"reputation": 1, "user_id": 5291265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440f3269ff5273fbcb48eac8a0518ed4?s=128&d=identicon&r=PG&f=1", "display_name": "trihandoko", "link": "https://stackoverflow.com/users/5291265/trihandoko"}, "edited": false, "score": 0, "creation_date": 1441308653, "post_id": 32349088, "comment_id": 52638499, "body": "I have run the program but &#39;OK&#39; sign always appear on the most top record, it is not enter into a record which DocOrderID is 3."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 1, "user_id": 5291265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440f3269ff5273fbcb48eac8a0518ed4?s=128&d=identicon&r=PG&f=1", "display_name": "trihandoko", "link": "https://stackoverflow.com/users/5291265/trihandoko"}, "edited": false, "score": 0, "creation_date": 1441351526, "post_id": 32349088, "comment_id": 52653416, "body": "Can you post some more of the code you have developed and provide some more detail regarding what you want to achieve?"}], "tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1441185143, "creation_date": 1441185143, "answer_id": 32349088, "question_id": 32346939, "link": "https://stackoverflow.com/questions/32346939/fiil-a-data-on-a-certain-field-of-record-from-another-form/32349088#32349088", "title": "Fiil a data on a certain field of record from another form", "body": "<p>I'm not sure I fully understand what you want, but if you simply want to populate a text box in another form then you could try this. Note: You need the following code in \"DocSTock\" form</p>\n\n<pre><code>if DocOrderID.value = \"3\"\n   AccDocOrder.txtProcessed.value = \"OK\"\n   Frm_PivotDetail.Show\nend if\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5291265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440f3269ff5273fbcb48eac8a0518ed4?s=128&d=identicon&r=PG&f=1", "display_name": "trihandoko", "link": "https://stackoverflow.com/users/5291265/trihandoko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643751, "creation_date": 1441178634, "last_edit_date": 1594643751, "question_id": 32346939, "link": "https://stackoverflow.com/questions/32346939/fiil-a-data-on-a-certain-field-of-record-from-another-form", "title": "Fiil a data on a certain field of record from another form", "body": "<p>I have to fill text data \"OK\" on 'txtProcessed' (a texbox) of 'AccDocOrder\" form where 'txtDocOrderID' (also a text box, and it contains the Primary Key ) has a value = 3 from another form named 'DocStock' form. \nOther words;\nI have to fill text data \"OK\" on 'Processed' column of 'AccDocOrder' table where 'DocOrderID' = 3 ('DocOrderID' is Primary Key of 'AccDocOrder' table)from another form named 'DocStock'form.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1746, "user_id": 904375, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/ebTfV.jpg?s=128&g=1", "display_name": "Zeeshan Siddiqui", "link": "https://stackoverflow.com/users/904375/zeeshan-siddiqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1441180769, "creation_date": 1441180769, "answer_id": 32347629, "question_id": 32346391, "link": "https://stackoverflow.com/questions/32346391/dynamic-row-print-area-excel-vba/32347629#32347629", "title": "dynamic row print area excel VBA", "body": "<p>I'm not sure why you want to use VBA to do this when you can just use 'Filter' on the data you have. On the date column you can then use the in-built 'Date Filters' to filter out any range of data. Once you specify the filter, print command will only print the filtered data set and not the complete data set.</p>\n\n<p>Anyways if you want the row it can also be achieved via Excel Formula:</p>\n\n<pre><code>=ADDRESS([dataset_first_row]+MATCH([set_print_area_date_cell],[dataset_date_range],-1)-1,2,4,1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aFeeN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aFeeN.jpg\" alt=\"Formula to determine row of matching data\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 4873762, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4ca458492af5adea1e6b5eae6a53c048?s=128&d=identicon&r=PG&f=1", "display_name": "loesbrown", "link": "https://stackoverflow.com/users/4873762/loesbrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441180769, "creation_date": 1441176859, "last_edit_date": 1441179113, "question_id": 32346391, "link": "https://stackoverflow.com/questions/32346391/dynamic-row-print-area-excel-vba", "title": "dynamic row print area excel VBA", "body": "<p>I want to give the user the option to press \"<code>set print area</code>\" and the area printed is determined by which date they fill in. </p>\n\n<p>The 2nd row always contains <code>today's date.</code> and then there is 2 years of data after that. Maybe the user only wants to print for first 3 months. </p>\n\n<p>So the set print area code should be written something like.</p>\n\n<pre><code>row = len(date max - len today)\n</code></pre>\n\n<p>I am very new to VBA, so have no clue how to write this. </p>\n\n<p>thank you!</p>\n"}, {"tags": ["vba", "outlook", "copy"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3487874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7fdc09a4853c8aa50a0f31b1ec0861?s=128&d=identicon&r=PG&f=1", "display_name": "user3487874", "link": "https://stackoverflow.com/users/3487874/user3487874"}, "edited": false, "score": 0, "creation_date": 1441235327, "post_id": 32359340, "comment_id": 52601558, "body": "Ah, that did it. Thanks"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1441214236, "creation_date": 1441214236, "answer_id": 32359340, "question_id": 32346311, "link": "https://stackoverflow.com/questions/32346311/item-move-in-outlook-not-moving/32359340#32359340", "title": "Item.Move in outlook not &quot;Moving&quot;", "body": "<p>MailItem.Copy does not take any arguments. It is a function that returns the copy of the given message. You can then move it to any folder</p>\n\n<pre><code>set NewItem = Item.Copy \nNewItem.Move targetFolder\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3487874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7fdc09a4853c8aa50a0f31b1ec0861?s=128&d=identicon&r=PG&f=1", "display_name": "user3487874", "link": "https://stackoverflow.com/users/3487874/user3487874"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 32359340, "answer_count": 1, "score": 0, "last_activity_date": 1441214236, "creation_date": 1441176473, "question_id": 32346311, "link": "https://stackoverflow.com/questions/32346311/item-move-in-outlook-not-moving", "title": "Item.Move in outlook not &quot;Moving&quot;", "body": "<p>I have the below VBA that works fine.</p>\n\n<pre><code>Private Sub Application_Startup()\nSet MySents = Session.GetDefaultFolder(olFolderSentMail).Items\nEnd Sub\n\n\nPrivate Sub MySents_ItemAdd(ByVal Item As Object)\nDim objNS As Outlook.NameSpace\nDim targetFolder As Outlook.MAPIFolder\n\nSet objNS = Outlook.GetNamespace(\"MAPI\")\n\nSelect Case Item.SenderName\n    Case \"Sender1\"\n        Set targetFolder = objNS.Folders(\"Folder1\").Folders(\"Sent Items\")\n    Case \"Sender2\"\n      Set targetFolder = objNS.Folders(\"Folder2\").Folders(\"Sent Items\")\nEnd Select\n\nItem.Move targetFolder\n\nEnd Sub\n</code></pre>\n\n<p>If I, however, change just the last line to </p>\n\n<pre><code>Item.Copy targetFolder\n</code></pre>\n\n<p>I get a \"Error 450: Wrong number of arguments or invalid property assignment.\"\nCan anyone shed any light on what I am doing wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441174642, "post_id": 32345499, "comment_id": 52565556, "body": "Is the column called <code>Project ID</code> (exactly) and is it in the\\ first row of the target worksheet?"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441179453, "post_id": 32345499, "comment_id": 52568065, "body": "Yes  the column is called Project ID and it is on the first column. The row starts on the 2nd row of the Project ID. @Jeeped"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441186393, "post_id": 32345972, "comment_id": 52572348, "body": "Hi may i know what does firstAddress and c.Address means? @user2782664"}], "tags": [], "owner": {"reputation": 25, "user_id": 2782664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e266338a90964ab90991838bab8a2c8?s=128&d=identicon&r=PG&f=1", "display_name": "user2782664", "link": "https://stackoverflow.com/users/2782664/user2782664"}, "is_accepted": false, "score": 0, "last_activity_date": 1441175128, "creation_date": 1441175128, "answer_id": 32345972, "question_id": 32345499, "link": "https://stackoverflow.com/questions/32345499/copy-information-from-one-workbook-to-another-with-a-specific-condition/32345972#32345972", "title": "Copy information from one workbook to another with a specific condition", "body": "<p>If I understand your question correctly, I think what's going on here is that your for loop is running the find command once for each cell, but it runs the same find command, only returning the first match, each time. If you are using the find command, I think you can use a do...while loop more appropriately, then use \"findnext.\" The msdn help gives an example of this which I think is exactly what you want to do:</p>\n\n<pre><code>With Worksheets(1).Range(\"a1:a500\") \nSet c = .Find(2, lookin:=xlValues) \nIf Not c Is Nothing Then \n    firstAddress = c.Address \n    Do \n        c.Value = 5 \n        Set c = .FindNext(c) \n    Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress \nEnd If \nEnd With\n</code></pre>\n\n<p>The other option would be to check if each cell you get to in your for loop matches.</p>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441180015, "post_id": 32346164, "comment_id": 52568407, "body": "Hi, how does the code will look like if it is hard coded? because i would prefer to use a hard code such as setting the project ID in the code so that it would search only the specific project ID that i wanted. @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441180782, "post_id": 32346164, "comment_id": 52568861, "body": "You would just need to remove the <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow noreferrer\">For Each...Next Statement</a> and hard-code the string you are looking for into the <code>pidStr</code> var. The rw it is on can be retrieved with <code>Application.Match</code>."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441181166, "post_id": 32346164, "comment_id": 52569098, "body": "But there is an error which keep saying type mismatch when i use the codes you gave. @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441181399, "post_id": 32346164, "comment_id": 52569237, "body": "I did not error control the Application.Match for the source as it should not be asked for if it doesn&#39;t exist. I&#39;ve added that error control now."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441181750, "post_id": 32346164, "comment_id": 52569428, "body": "Hi I used the code and it still give type mismatch on the &quot;rw = Application.Match(pidStr, .Columns(1), 0)&quot; line which i don&#39;t understand why there is still error. @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441182007, "post_id": 32346164, "comment_id": 52569591, "body": "You have been using <code>&quot;10000327&quot;</code> up to this point but if that iust throwing a mismatch error then those pid numbers must be true numbers not text that look like numbers. Use <code>CLng(pidStr)</code> in that match statement."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1441185970, "post_id": 32346164, "comment_id": 52572054, "body": "Hi, im sorry i dont really understand what you are saying in terms of using the CLng(pidStr) in the match statement. Where exactly it is? @Jeeped"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1441181385, "last_edit_date": 1441181385, "creation_date": 1441175879, "answer_id": 32346164, "question_id": 32345499, "link": "https://stackoverflow.com/questions/32345499/copy-information-from-one-workbook-to-another-with-a-specific-condition/32346164#32346164", "title": "Copy information from one workbook to another with a specific condition", "body": "<p>I've changed the hard-coded search term to a var that gets it's pid on successive loops.</p>\n\n<pre><code>Sub AAB()\n    Dim sWS As Worksheet, tWS As Worksheet\n    Dim pidCol As Long, pidRow As Long, pidStr As String, rw as long\n\n    Set tWS = Workbooks(\"Target.xlsm\").Sheets(\"Sheet1\")\n    Set sWS = Workbooks(\"Source.xlsm\").Sheets(\"Sheet2\")\n\n    With sWS\n        With .Cells(1, 1).CurrentRegion\n            pidCol = 1\n            pidStr = \"10000327\"  '.Cells(rw, pidCol).Value\n            If CBool(Application.CountIf(.Columns(1), pidStr)) Then\n                rw = Application.Match(pidStr, .Columns(1), 0)\n                With .Cells(rw, 2).Resize(1, .Columns.Count - 1)\n                    If CBool(Application.CountIf(tWS.Columns(1), pidStr)) Then\n                        pidRow = Application.Match(pidStr, tWS.Columns(1), 0)\n                        .Copy Destination:=tWS.Cells(pidRow, 2)\n                    End If\n                End With\n            End If\n        End With\n    End With\n\n    Set sWS = Nothing\n    Set tWS = Nothing\nEnd Sub\n</code></pre>\n\n<p>This loops through all the values in column A (<code>pidCol = 1</code>) on the source worksheet and copies the data to the target worksheet if the associated PID is found on the target worksheet.</p>\n"}], "owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441181385, "creation_date": 1441173068, "last_edit_date": 1441173255, "question_id": 32345499, "link": "https://stackoverflow.com/questions/32345499/copy-information-from-one-workbook-to-another-with-a-specific-condition", "title": "Copy information from one workbook to another with a specific condition", "body": "<p>Hi I would need a code to allow me to copy paste the information from a workbook called \"Target\" to another workbook called \"Source\" based on a specific condition. </p>\n\n<p>This condition is based on the unique Project ID found in the code. </p>\n\n<p>I tried doing some coding but it does not seems to allow me to get the result that I wanted. </p>\n\n<p>The code would only read the first row and copy the information to the other workbook instead of looking through the project ID \"10000327\" in the \"Project ID\" column in the Target workbook and copy the information to the Source workbook. </p>\n\n<p>Below is the code that I have tried and gave the result that I mentioned earlier. </p>\n\n<p>Really hope that anyone could help me as I am very new to VBA. Thank you:)</p>\n\n<pre><code>Sub AAA()    \nDim source As Worksheet\nDim target As Worksheet\n    Dim cellFound As Range\n\n\n\n    Set target = Workbooks(\"Target.xlsm\").Sheets(\"Sheet1\")\n    Set source = Workbooks(\"Source.xlsm\").Sheets(\"Sheet2\")\n    lastrow = source.Range(\"A\" &amp; target.Rows.Count).End(xlUp).Row\n    lastcol = target.Cells(2, target.Columns.Count).Column\n\n    target.Activate\n\n'For a = 2 To 50\nFor Each cell In target.Range(\"A2:A500\")\n        ' Try to find this value in the source sheet\n\n        Set cellFound = source.Range(\"A:A\").Find(What:=\"10000327\", LookIn:=xlValues, LookAt:=xlWhole)\n        If Not cellFound Is Nothing Then\n\n            cell.Offset(ColumnOffset:=1).Copy\n            cellFound.Offset(ColumnOffset:=1).PasteSpecial xlPasteValues\n\n     Else\n     Exit Sub\n\n\n     End If\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "registry", "registrykey"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1441186673, "post_id": 32345238, "comment_id": 52572542, "body": "The VBA equivalent should be <code>.RegWrite &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTO&zwnj;&#8203;R\\Start&quot;, 4, &quot;REG_DWORD&quot;</code>. But this will only work if the user which runs the VBA has rights to change the registry at <code>HKEY_LOCAL_MACHINE</code>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1441192980, "post_id": 32345238, "comment_id": 52576577, "body": "<a href=\"http://www.vbforums.com/showthread.php?563162-Working-with-Windows-Registry-using-Visual-Basic-6-A-complete-Tutorial\" rel=\"nofollow noreferrer\">Interesting read</a> for you...."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441236110, "post_id": 32345238, "comment_id": 52601777, "body": "Alex: I changed my code to reflect your input on the matter. But I&#39;m still getting the -2147024891[80070005] invalid root error. Is this because the VBA script is not running elevated? As a user I have the rights to change the registry. Maybe I should instead use ShellExecute to send the command....  ...I&#39;m out of my league here, so pardon me if I&#39;m saying silly things."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441237179, "post_id": 32345238, "comment_id": 52602045, "body": "Siddarth: I read it and it gave me some insight on what I&#39;m actually doing."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441238650, "post_id": 32345238, "comment_id": 52602440, "body": "Siddarth &amp; Axel: I think I now undertand why I am getting that error. There is no registry entry in USBSTOR named Start, only one named Count."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441243730, "post_id": 32345238, "comment_id": 52603478, "body": "Using count I still get the same error..."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441263723, "post_id": 32345238, "comment_id": 52609657, "body": "Update: Nevermind that count thing... I got it: start is a NameValue in the  USBSTOR folder. So using cmd I typed in  &gt; /k %windir%\\System32\\reg.exe ADD HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR /f /v Start /t REG_DWORD /d 4 /f&quot;, &quot;C:\\&quot;, 1 And, cutting the story short: I&#39;m still getting an error...."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441266587, "post_id": 32345238, "comment_id": 52611277, "body": "Axel: Your answer seems to be correct (I think the macro simply lacks the necessary permissions)."}, {"owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "edited": false, "score": 0, "creation_date": 1441266644, "post_id": 32345238, "comment_id": 52611315, "body": "Axel and Siddarth, Thank you both for your help. This question is now solved."}], "answers": [{"tags": [], "owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "is_accepted": false, "score": 9, "last_activity_date": 1441273479, "last_edit_date": 1441273479, "creation_date": 1441266475, "answer_id": 32369847, "question_id": 32345238, "link": "https://stackoverflow.com/questions/32345238/read-and-write-from-to-registry-in-vba/32369847#32369847", "title": "Read and write from/to registry in VBA", "body": "<p>I think the problem here was that the macro did not have permission to write to the registry.</p>\n\n<p>More information in <a href=\"https://msdn.microsoft.com/en-us/library/yfdfhz1b(v=vs.84).aspx\" rel=\"noreferrer\">this page</a>.\nI could read the key's value using the WScript object just fine:</p>\n\n    \n\n<pre><code>Debug.Print CreateObject(\"WScript.Shell\").RegRead(\"HKLM\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\Start\")\n</code></pre>\n\n<p>To write (it should work if you have permissions):</p>\n\n<pre><code>CreateObject(\"WScript.Shell\").RegWrite \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\Start\", 4, \"REG_DWORD\"\n</code></pre>\n\n<p>How I got it to work (since my script does not seem to have the necessary permissions):</p>\n\n<pre><code>ShellExecute 0, \"runas\", \"C:\\Windows\\System32\\cmd.exe\", \"/k %windir%\\System32\\reg.exe ADD HKLM\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR /f /v Start /t REG_DWORD /d 4\", \"C:\\\", 0\n</code></pre>\n\n<p>In this last example the user will be prompted to provide the necessary permission.</p>\n\n<p>PS: HKLM is an abreviation for HKEY_LOCAL_MACHINE. All other root key names have similar abreviations that can be consulted in the <a href=\"https://msdn.microsoft.com/en-us/library/yfdfhz1b(v=vs.84).aspx\" rel=\"noreferrer\">page mentioned at the top</a>.</p>\n\n<p>As a practical example I will post my usage of these expressions to enable/disable USB mass storage (when on disable, when off enable):</p>\n\n<pre><code>Sub DoUSB_Control()\n    If CreateObject(\"WScript.Shell\").RegRead(\"HKLM\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\Start\") = 3 Then\n        ShellExecute 0, \"runas\", \"C:\\Windows\\System32\\cmd.exe\", \"/k %windir%\\System32\\reg.exe ADD HKLM\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR /f /v Start /t REG_DWORD /d 4\", \"C:\\\", 0\n    Else\n        ShellExecute 0, \"runas\", \"C:\\Windows\\System32\\cmd.exe\", \"/k %windir%\\System32\\reg.exe ADD HKLM\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR /f /v Start /t REG_DWORD /d 3\", \"C:\\\", 0\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12384635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91a777118cc439c181f9824e1037de49?s=128&d=identicon&r=PG&f=1", "display_name": "mccordscvs", "link": "https://stackoverflow.com/users/12384635/mccordscvs"}, "is_accepted": false, "score": 0, "last_activity_date": 1616417034, "creation_date": 1616417034, "answer_id": 66746313, "question_id": 32345238, "link": "https://stackoverflow.com/questions/32345238/read-and-write-from-to-registry-in-vba/66746313#66746313", "title": "Read and write from/to registry in VBA", "body": "<p>There must be a &quot;\\&quot; after the word Start in the registry key.</p>\n"}], "owner": {"reputation": 1370, "user_id": 961546, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/54a96daba4bd7453d8080ffacff04826?s=128&d=identicon&r=PG", "display_name": "jony", "link": "https://stackoverflow.com/users/961546/jony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16790, "favorite_count": 2, "answer_count": 2, "score": 6, "last_activity_date": 1616417034, "creation_date": 1441171725, "last_edit_date": 1441235638, "question_id": 32345238, "link": "https://stackoverflow.com/questions/32345238/read-and-write-from-to-registry-in-vba", "title": "Read and write from/to registry in VBA", "body": "<p>I saw this line in C# and I am trying to adapt it to VBA:</p>\n\n<pre><code>Microsoft.Win32.Registry.SetValue(@\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\", \"Start\", 4,Microsoft.Win32.RegistryValueKind.DWord);\n</code></pre>\n\n<p>I'm quite lost here with some error:</p>\n\n<blockquote>\n  <p>Runtime: 5 - invalid procedure call)</p>\n</blockquote>\n\n<p>When I use the default i_Type string \"REG_SZ\" instead of \"Start\", then I get a regkey related error: </p>\n\n<blockquote>\n  <p>Runtime - -2147024891[80070005] invalid root</p>\n</blockquote>\n\n<p>My code:</p>\n\n<pre><code>Dim i_RegKey As String, i_Value As String, i_Type As String\nDim myWS As Object\ni_Type = \"REG_SZ\"  ' Optional\n'access Windows scripting\nSet myWS = CreateObject(\"WScript.Shell\")\n'write registry key\ni_RegKey = \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\Start\"\ni_Value = \"4\"\ni_Type = \"REG_DWORD\"\nmyWS.RegWrite i_RegKey, i_Value, i_Type\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441164450, "post_id": 32344100, "comment_id": 52562435, "body": "Is <code>clockOn</code> set to <code>False</code> anywhere else in the code (other running subs)?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441165075, "post_id": 32344100, "comment_id": 52562564, "body": "So you stop the clock by calling stopclock()? If that&#39;s the case why is <code>clockOn</code> Global?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441166376, "post_id": 32344100, "comment_id": 52562898, "body": "@paulbica - Because in the next iteration <code>runClock</code> will not schedule another occurrence of itself to occur thus halting the continuous loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1441166493, "post_id": 32344100, "comment_id": 52562928, "body": "@Niva - Do any of your &#39;other codes&#39; use <code>On Error Resume Next</code>? This will halt the Application.OnTime&#39;s indefinite wait."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1441169315, "post_id": 32344100, "comment_id": 52563612, "body": "@Jeeped: <code>clockOn</code> doesn&#39;t need to be visible to all modules for this logic; it can be a private member of the module (global at module level only)"}], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441172798, "post_id": 32344548, "comment_id": 52564811, "body": "Thanks ill try this as well:-)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1441167345, "creation_date": 1441167345, "answer_id": 32344548, "question_id": 32344100, "link": "https://stackoverflow.com/questions/32344100/running-clock-in-excel-workbook-stops-when-other-modules-run-in-the-vba-project/32344548#32344548", "title": "Running clock in excel workbook stops when other modules run in the VBA project", "body": "<p>Rather than attempting to use the default indefinite wait when the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx\" rel=\"nofollow\">Application.OnTime method</a>'s optional <em>LatestTime</em> parameter is left blank, why not consolidate several Application events that you likely use in your 'other codes' anyways?</p>\n\n<pre><code>Public Sub appTGGL(Optional bTGGL As Boolean = True)\n    Application.ScreenUpdating = bTGGL\n    Application.EnableEvents = bTGGL\n    Application.DisplayAlerts = bTGGL\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    If bTGGL Then\n        startClock\n    Else\n        stopClock\n    End If\nEnd Sub\n</code></pre>\n\n<p>At the beginning of your 'other codes', use <code>appTGGL bTGGL:=False</code> and at the end of your other sub procedures more simply as <code>appTGGL</code>.</p>\n\n<p>The clock will be halted during operation. It sounds like <code>On Error Resume Next</code> to get over a <code>.Find</code> or something was going to break it anyways. As long as your procedure finishes, the clock will be restarted. If the other procedure(s) doesn't finish you've got bigger problems than a clock that is only right twice a day.</p>\n\n<p>Remember to get rid of all the superfluous code in your other procedures like,</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual \n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441171154, "post_id": 32344820, "comment_id": 52564205, "body": "Do you require the call to <code>runClock</code> in <code>stopClock</code>?"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441172787, "post_id": 32344820, "comment_id": 52564805, "body": "Okay I will try it! Nope i dont need to call it.  Thank you"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441173035, "post_id": 32344820, "comment_id": 52564920, "body": "Sorry but what does this part of the code means ?  functionWithParam = &quot;&#39;runClock&quot; &amp; Chr(34) &amp; flag &amp; Chr(34) &amp; &quot;&#39;&quot;     If clockStart Then Application.OnTime Now + TimeSerial(0, 0, 1), functionWithParam"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441197596, "post_id": 32344820, "comment_id": 52579809, "body": "I removed the call <code>runClock</code> in <code>stopClock()</code> as tested by @Niva. The <code>functionWithParam</code> is a way to execute a function with parameters from <code>OnTime</code>"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1441197418, "last_edit_date": 1441197418, "creation_date": 1441169383, "answer_id": 32344820, "question_id": 32344100, "link": "https://stackoverflow.com/questions/32344100/running-clock-in-excel-workbook-stops-when-other-modules-run-in-the-vba-project/32344820#32344820", "title": "Running clock in excel workbook stops when other modules run in the VBA project", "body": "<p>Maybe this will help:</p>\n\n<pre><code>Option Explicit\n\nPrivate clockStart As Boolean\n\nSub runClock(ByVal flag As Boolean)\n    Dim functionWithParam As String\n    Range(\"A1\").Value = Now():  DoEvents\n    functionWithParam = \"'runClock \" &amp; Chr(34) &amp; flag &amp; Chr(34) &amp; \"'\"\n    If clockStart Then Application.OnTime Now + TimeSerial(0, 0, 1), functionWithParam\nEnd Sub\n\nSub startClock()\n    clockStart = True\n    runClock True\nEnd Sub\n\nSub stopClock()\n    clockStart = False\nEnd Sub\n</code></pre>\n\n<p>or this version:</p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then   '64 Bit Systems\n    Public Declare PtrSafe Sub Sleep Lib \"Kernel32\" (ByVal dwMilliseconds As LongPtr)\n#Else           '32 Bit Systems\n    Public Declare Sub Sleep Lib \"Kernel32\" (ByVal dwMilliseconds as Long)\n#End If\n\nPrivate clockStart As Boolean\n\nSub runClock()\n    While clockStart\n        Range(\"A1\").Value = Now()\n        Sleep 1000\n        DoEvents\n    Wend\nEnd Sub\n\nSub startClock()\n    clockStart = True\n    runClock\nEnd Sub\n\nSub stopClock()\n    clockStart = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 32344820, "answer_count": 2, "score": 2, "last_activity_date": 1442461246, "creation_date": 1441163790, "last_edit_date": 1531161705, "question_id": 32344100, "link": "https://stackoverflow.com/questions/32344100/running-clock-in-excel-workbook-stops-when-other-modules-run-in-the-vba-project", "title": "Running clock in excel workbook stops when other modules run in the VBA project", "body": "<p>I have a running  clock on my excel workbook and whenever i run other codes in the workbook,the clock tends to stop . I have to always start the clock back whenever this happens. Is there anyways for the clock to auto run instead of me having to realise it and click it?</p>\n"}, {"tags": ["vb.net", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3633586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLIRo.jpg?s=128&g=1", "display_name": "Christopher S. Atkins", "link": "https://stackoverflow.com/users/3633586/christopher-s-atkins"}, "edited": false, "score": 0, "creation_date": 1441211014, "post_id": 32344067, "comment_id": 52589517, "body": "Unexplainably, your suggestion is still resulting in an invalid message."}, {"owner": {"reputation": 2413, "user_id": 4779472, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh5.googleusercontent.com/-918sSljPOLU/AAAAAAAAAAI/AAAAAAAAABA/JrpaeNI9JiM/photo.jpg?sz=128", "display_name": "Rohit Gupta", "link": "https://stackoverflow.com/users/4779472/rohit-gupta"}, "reply_to_user": {"reputation": 31, "user_id": 3633586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLIRo.jpg?s=128&g=1", "display_name": "Christopher S. Atkins", "link": "https://stackoverflow.com/users/3633586/christopher-s-atkins"}, "edited": false, "score": 0, "creation_date": 1441228723, "post_id": 32344067, "comment_id": 52599227, "body": "Then you need to display the value you are getting in another control; maybe it is not what you think it should be."}], "tags": [], "owner": {"reputation": 2413, "user_id": 4779472, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh5.googleusercontent.com/-918sSljPOLU/AAAAAAAAAAI/AAAAAAAAABA/JrpaeNI9JiM/photo.jpg?sz=128", "display_name": "Rohit Gupta", "link": "https://stackoverflow.com/users/4779472/rohit-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1441163472, "creation_date": 1441163472, "answer_id": 32344067, "question_id": 32343980, "link": "https://stackoverflow.com/questions/32343980/invalid-input-when-integer-is-within-valid-means/32344067#32344067", "title": "Invalid input when integer is within valid means?", "body": "<p>Try the brackets and the 'or'</p>\n\n<pre><code>1. Dim intNum As Integer\n2.    If (intNum &lt; 1) or (intNum &gt; 10) Then\n3.        txtBox1.Text = \"That number is invalid.\"\n4.    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 3633586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLIRo.jpg?s=128&g=1", "display_name": "Christopher S. Atkins", "link": "https://stackoverflow.com/users/3633586/christopher-s-atkins"}, "edited": false, "score": 0, "creation_date": 1441211026, "post_id": 32344556, "comment_id": 52589528, "body": "Unexplainably, your suggestion is still resulting in an invalid message also."}, {"owner": {"reputation": 902, "user_id": 1068538, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/60971261aef1efa00134a439a0441002?s=128&d=identicon&r=PG", "display_name": "Dush", "link": "https://stackoverflow.com/users/1068538/dush"}, "reply_to_user": {"reputation": 31, "user_id": 3633586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLIRo.jpg?s=128&g=1", "display_name": "Christopher S. Atkins", "link": "https://stackoverflow.com/users/3633586/christopher-s-atkins"}, "edited": false, "score": 0, "creation_date": 1441236686, "post_id": 32344556, "comment_id": 52601923, "body": "You have changed the question.  <code>Dim intNum As Integer</code>  is the declaration, <code>intNum</code> it is always 0. So the code works as expected."}], "tags": [], "owner": {"reputation": 902, "user_id": 1068538, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/60971261aef1efa00134a439a0441002?s=128&d=identicon&r=PG", "display_name": "Dush", "link": "https://stackoverflow.com/users/1068538/dush"}, "is_accepted": false, "score": 0, "last_activity_date": 1441167390, "creation_date": 1441167390, "answer_id": 32344556, "question_id": 32343980, "link": "https://stackoverflow.com/questions/32343980/invalid-input-when-integer-is-within-valid-means/32344556#32344556", "title": "Invalid input when integer is within valid means?", "body": "<p>Your code perfectly worked for me in Visual Studio 2013 with .NET Framework 4.5.1. Try deleting entire block and re-type the code.\nOr you can try this code as well</p>\n\n<pre><code> If intNum &lt; 1 OrElse intNum &gt; 10 Then\n    TextBox1.Text = \"That number is invalid.\"\n End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3633586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLIRo.jpg?s=128&g=1", "display_name": "Christopher S. Atkins", "link": "https://stackoverflow.com/users/3633586/christopher-s-atkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1441219595, "creation_date": 1441219595, "answer_id": 32360874, "question_id": 32343980, "link": "https://stackoverflow.com/questions/32343980/invalid-input-when-integer-is-within-valid-means/32360874#32360874", "title": "Invalid input when integer is within valid means?", "body": "<p>Needed to add...</p>\n\n<pre><code> Integer.TryParse(txtBox1.Text, i) \n</code></pre>\n\n<p>...directly under my variable declaration. </p>\n"}], "owner": {"reputation": 31, "user_id": 3633586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLIRo.jpg?s=128&g=1", "display_name": "Christopher S. Atkins", "link": "https://stackoverflow.com/users/3633586/christopher-s-atkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1441219595, "creation_date": 1441162860, "last_edit_date": 1441211156, "question_id": 32343980, "link": "https://stackoverflow.com/questions/32343980/invalid-input-when-integer-is-within-valid-means", "title": "Invalid input when integer is within valid means?", "body": "<p>I'm working on a VB program, rather basic (no pun intended), in which I need to convert basic integers to Roman numerals.  I have the conversion part working perfectly with my Select Case.  I also need to add validation input so if an invalid number is entered, the text box displays as such.  Any number between 1 and 10 should result in the ability to click the convert button.  Currently, any number I enter between 1 and 10 immediately displays, \"That number is invalid.\"</p>\n\n<p>This is my current code, which fails:</p>\n\n<pre><code>Public Class Form1\n\nPrivate Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n\nEnd Sub\n\nPrivate Sub lblRomanNum_Click(sender As Object, e As EventArgs)\n\nEnd Sub\n\nPrivate Sub txtBox1_TextChanged(sender As Object, e As EventArgs) Handles txtBox1.TextChanged\n    Dim intNum As Integer\n    If intNum &lt; 1 Or intNum &gt; 10 Then\n        txtBox1.Text = \"That number is invalid.\"\n        'ElseIf intNum &gt; 10 Then\n        'txtBox1.Text = \"That number is invalid\"\n    End If\n\nEnd Sub\n\nPrivate Sub txtBox2_TextChanged(sender As Object, e As EventArgs) Handles txtBox2.TextChanged\n\nEnd Sub\n\nPrivate Sub btnConvert_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnConvert.Click\nSelect CInt(txtBox1.Text)\n        Case 1                      ' numerical 1\n            txtBox2.Text = \"I\"\n        Case 2                      ' numerical 2\n            txtBox2.Text = \"II\"\n        Case 3                      ' numerical 3\n            txtBox2.Text = \"III\"\n        Case 4                      ' numerical 4\n            txtBox2.Text = \"IV\"\n        Case 5                      ' numerical 5\n            txtBox2.Text = \"V\"\n        Case 6                      ' numerical 6\n            txtBox2.Text = \"VI\"\n        Case 7                      ' numerical 7\n            txtBox2.Text = \"VII\"\n        Case 8                      ' numerical 8\n            txtBox2.Text = \"VIII\"\n        Case 9                      ' numerical 9\n            txtBox2.Text = \"IX\"\n        Case 10                     ' numerical 10\n            txtBox2.Text = \"X\"\n            'Case Else\n            'If a user enters an invalid value, this message is displayed and no conversion is attempted, according to instructions.\n            'txtBox2.Text = \"That value is invalid.\"\n    End Select\n\nEnd Sub\n\nPrivate Sub btnExit_Click(sender As Object, e As EventArgs) Handles btnExit.Click\n    Me.Close()\nEnd Sub\n\nPrivate Sub lblRomanNum_Click_1(sender As Object, e As EventArgs)\n\nEnd Sub\nEnd Class\n</code></pre>\n\n<p>Any intNum less than 1 should display the invalid message.</p>\n\n<p>Any intNum greater than 10 should display the invalid message.  </p>\n\n<p>If I'm reading what I currently have correctly, this should work and allow me to enter a number between 1 and 10 without the invalid message appearing.  Am I missing something here?</p>\n"}, {"tags": ["excel", "vba", "outlook", "html-email", "html-formatting"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3669807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d8baf0c5dcc906da18d5861c1175a898?s=128&d=identicon&r=PG&f=1", "display_name": "proudestWarehouse89", "link": "https://stackoverflow.com/users/3669807/proudestwarehouse89"}, "edited": false, "score": 0, "creation_date": 1507139448, "post_id": 46548210, "comment_id": 80095862, "body": "thanks for suggestion. I have to set an Inspector object = <code>MailIItem.GetInspector</code> to get the property. Once I have this Inspector object, it has an <code>.Activate</code> method, but this also displays the MailItem like the <code>MailItem.Display</code> method."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 29, "user_id": 3669807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d8baf0c5dcc906da18d5861c1175a898?s=128&d=identicon&r=PG&f=1", "display_name": "proudestWarehouse89", "link": "https://stackoverflow.com/users/3669807/proudestwarehouse89"}, "edited": false, "score": 0, "creation_date": 1507145375, "post_id": 46548210, "comment_id": 80099084, "body": "The point is to not use any code that displays then see if you get what you need. Why have you introduced .Activate into this question? <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1507044508, "creation_date": 1507044508, "answer_id": 46548210, "question_id": 32343936, "link": "https://stackoverflow.com/questions/32343936/emailitem-display-formatting-before-emailitem-send/46548210#46548210", "title": "EmailItem.Display Formatting before EmailItem.Send", "body": "<p><code>.GetInspector</code> should replicate what <code>.Display</code> does, if viewing is not needed.</p>\n"}], "owner": {"reputation": 29, "user_id": 3669807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d8baf0c5dcc906da18d5861c1175a898?s=128&d=identicon&r=PG&f=1", "display_name": "proudestWarehouse89", "link": "https://stackoverflow.com/users/3669807/proudestwarehouse89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593247969, "creation_date": 1441162481, "last_edit_date": 1593247969, "question_id": 32343936, "link": "https://stackoverflow.com/questions/32343936/emailitem-display-formatting-before-emailitem-send", "title": "EmailItem.Display Formatting before EmailItem.Send", "body": "<p>When I send an HTML email from VBA the formatting appears differently in a mobile email/plain text format if I don't have <code>MailItem.Display</code> before <code>MailItem.Send</code>, as opposed to just <code>MailItem.Send</code> </p>\n\n<p>I specify <code>MailItem.BodyFormat = olFormatHTML</code> and <code>MailItem.HTMLBody = \"Some string\"</code> in the code.</p>\n\n<p>If I use <code>MailItem.Display</code> before <code>MailItem.Send</code>, the mobile/plain text email looks great and the body format looks just as it does in Outlook. I also have an embedded image that I grab from a website that downloads automatically and is present in both mobile/plain text and Outlook. </p>\n\n<ol>\n<li>Mobile/Plain Text with <code>MailItem.Display</code> before <code>MailItem.Send</code></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/tGp9H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tGp9H.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I don't use <code>MailItem.Display</code> before <code>MailItem.Send</code>, the mobile email in plain text gets a little jacked up and loses the table structure/formatting of the HTML email, while the Outlook still looks normal. The embedded image is automatically downloaded, but disproportionate in the mobile/plain text email but not automatically downloaded in Outlook (have to right click to download).</p>\n\n<p><a href=\"https://i.stack.imgur.com/c9yOs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c9yOs.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li>Mobile/Plain Text <strong>without</strong> <code>MailItem.Display</code> before <code>MailItem.Send</code></li>\n</ol>\n\n<p>Does anyone know why <code>MailItem.Display</code> causes this behavior?</p>\n\n<p>I blast hundreds of emails at a time and using <code>MailItem.Display</code> crushes my CPU's memory and cause a significant decrease in CPU and macro speed/performance.<br>\nIs there an alternative solution to get these results without using <code>MailItem.Display</code>?</p>\n"}, {"tags": ["vba", "optimization", "user-defined-functions"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1441162150, "post_id": 32343858, "comment_id": 52561919, "body": "Why would you create a UDF that offers less functionality than either the worksheet <a href=\"https://support.office.com/en-us/article/Weekday-Function-05D360D7-2C3F-4691-9448-C96EA0351940\" rel=\"nofollow noreferrer\">WEEKDAY function</a> or the VBA <a href=\"https://msdn.microsoft.com/en-us/library/82yfs2zh%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">Weekday function</a>?"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 1, "creation_date": 1441164352, "post_id": 32343858, "comment_id": 52562411, "body": "@Jeeped My only guess is that Alex eventually wants to make the UDF more complex, but is seeing if it&#39;s even possible to get the UDF speed where they want it to be on something very basic."}, {"owner": {"reputation": 167, "user_id": 4877640, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155546539710383/picture?type=large", "display_name": "Alex Wilding", "link": "https://stackoverflow.com/users/4877640/alex-wilding"}, "edited": false, "score": 1, "creation_date": 1441165665, "post_id": 32343858, "comment_id": 52562707, "body": "@Jeeped Yes, rwilson is right on the mark. The UDF is pointless of course, but I want to see if something even as simple as that can run at a decent speed."}], "answers": [{"tags": [], "owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "is_accepted": true, "score": 4, "last_activity_date": 1441164382, "last_edit_date": 1441164382, "creation_date": 1441163892, "answer_id": 32344112, "question_id": 32343858, "link": "https://stackoverflow.com/questions/32343858/speed-up-simple-user-defined-functions/32344112#32344112", "title": "Speed up simple user defined functions", "body": "<p>You can instead pass in the values as a range and have it return all the values at once in an array. I just tried this on 50,000 rows and it returned all the values instantly. You will need to enter the UDF with <strong>CTRL + SHIFT + ENTER</strong>.</p>\n\n<pre><code>Function myweekday(mydate As Range) As Variant\n\nDim vMydate As Variant\nDim vMyWeekDay As Variant\nDim i As Long\n\nvMydate = mydate.Value2\nReDim vMyWeekDay(1 To UBound(vMydate), 1 To 1)\n\n    For i = 1 To UBound(vMydate)\n        vMyWeekDay(i, 1) = Weekday(vMydate(i, 1))\n    Next i\n\nmyweekday = vMyWeekDay\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/608zy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/608zy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 167, "user_id": 4877640, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155546539710383/picture?type=large", "display_name": "Alex Wilding", "link": "https://stackoverflow.com/users/4877640/alex-wilding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 0, "accepted_answer_id": 32344112, "answer_count": 1, "score": 1, "last_activity_date": 1441166131, "creation_date": 1441161877, "last_edit_date": 1441166131, "question_id": 32343858, "link": "https://stackoverflow.com/questions/32343858/speed-up-simple-user-defined-functions", "title": "Speed up simple user defined functions", "body": "<p>User defined functions writen in Excel VBA seem to run much slower than functions simply written in the worksheet cells. Is there a way to run them faster? As an example I have a very simple user defined function:</p>\n\n<pre><code>Function myweekday(mydate As Double)\n    myweekday = Weekday(mydate)\nEnd Function\n</code></pre>\n\n<p>Basically it does the same thing as the built in =weekday() function. However running this on 50,000 cells takes about 5 seconds to calculate, whereas simply using the built in function takes a fraction of a second.</p>\n\n<p>What can I do to make user defined functions like this run faster?</p>\n"}, {"tags": ["vba", "com", "visio"], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1496344521, "creation_date": 1441161715, "question_id": 32343840, "link": "https://stackoverflow.com/questions/32343840/visio-shape-id-overflow", "title": "Visio Shape ID Overflow", "body": "<p>The Visio Page object's SetFormulas and GetResults methods requires an array containing ShapeID,Section,Row,Column, in order to batch read/write from/to the shapesheet.</p>\n\n<p>However, I find that in drawings with a lot of shapes, after adding and deleting shapes, Visio's shape ID's cross over the short integer limit of 32768.  It seems Visio keeps a short integer ID property on shapes called ID16, but passing the ID16 into that ShapeID,Section,Row,Column array does not seem to work, and raises an 'Unexpected End of File' error.</p>\n\n<p>Is it possible somehow to use the SetFormulas and GetResults methods on drawings where shape ID's have crossed over the short integer limit?  Or is there a way to 'restack' shape ID's in a drawing such that, as long as there are less than 32768 shapes in the page, then all the ID's will be below the limit?  I know that copying all the shapes into a new drawing will buy some time, but the issue could quickly recur after adding/removing shapes from the page, which my software does a lot of.</p>\n\n<p>The only other alternative I can think of is to capture cases where the shape ID has exceeded the short integer limit, and revert to routines that do operations cell by cell and shape by shape, rather than in a single batch.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2017, "user_id": 1698517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366044619e6cb2094c95d889cb75a827?s=128&d=identicon&r=PG", "display_name": "Jaycal", "link": "https://stackoverflow.com/users/1698517/jaycal"}, "edited": false, "score": 2, "creation_date": 1441161419, "post_id": 32343777, "comment_id": 52561775, "body": "you&#39;ll improve you chances of getting help if you try something on your own first and/or show what you&#39;ve done so far"}], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "is_accepted": false, "score": 0, "last_activity_date": 1484909019, "creation_date": 1484909019, "answer_id": 41761708, "question_id": 32343777, "link": "https://stackoverflow.com/questions/32343777/vba-to-look-up-a-string-in-a-cell-based-on-font-size-and-add-text-to-it/41761708#41761708", "title": "VBA to look up a string in a cell based on font size and add text to it", "body": "<p>How about this:</p>\n\n<pre><code>Sub Macro1()\n\nDim myFontSize As Long\nDim myText As String\nDim myRange, myCell As Range\n\nSet myRange = Worksheets(\"Test\").Range(\"A1:A10\")    'define your lookup Range\nmyFontSize = 11                                     'define your lookup Font size\nmyText = \"AABBCCC123\"                               'define your lookup text\n\nFor Each myCell In myRange                                          ' check all cells in your Range\n    If myCell.Font.Size = myFontSize And myCell.Text = myText Then  ' look for your font size and text\n        myCell.Offset(0, 1).Value = \"B222\" &amp; myCell.Text            ' update a cell to the right by adding B222 before your text\n        'myCell.Value = \"B222\" &amp; myCell.Text                        ' update your cell by adding B222 before your text\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5270323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c03ff91cbaa38f38b3826cf464ab5391?s=128&d=identicon&r=PG&f=1", "display_name": "abe", "link": "https://stackoverflow.com/users/5270323/abe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 895, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1484909019, "creation_date": 1441161185, "question_id": 32343777, "link": "https://stackoverflow.com/questions/32343777/vba-to-look-up-a-string-in-a-cell-based-on-font-size-and-add-text-to-it", "title": "VBA to look up a string in a cell based on font size and add text to it", "body": "<p>I need a VBA code that will search for a string that might appear multiple times in a spreadsheet but in different font sizes. </p>\n\n<p>-First look up the string based on specific font size (ex: \"AABBCCC123\", font 11)</p>\n\n<p>-Second add text to the end of the string (B222)</p>\n\n<p>The idea is to create a unique ID</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1441161430, "post_id": 32343738, "comment_id": 52561779, "body": "Where in your code that relates to the Invoice Number?"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441169460, "post_id": 32343738, "comment_id": 52563650, "body": "can you confirm that you put <code>FileFormat:=51</code> on the next line in your code? or is that a typo in your question?"}, {"owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "edited": false, "score": 0, "creation_date": 1441240344, "post_id": 32343738, "comment_id": 52602837, "body": "yes I put it.. as an extension shortcut for &quot;Microsoft Excel Worksheet&quot;.."}, {"owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "edited": false, "score": 0, "creation_date": 1441241161, "post_id": 32343738, "comment_id": 52602996, "body": "The following code was also entered in the &quot;Thisworkbook&quot; section and the invoice number is Cell (J8)  Private Sub Workbook_Open() (    Range(&quot;J8&quot;).Value = Range(&quot;J8&quot;).Value + 1    ) Invoice.Show End Sub"}, {"owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1441276134, "post_id": 32343738, "comment_id": 52617357, "body": "@PatricK previous comment"}, {"owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441276185, "post_id": 32343738, "comment_id": 52617396, "body": "@DragonSamu Question Answered"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441276836, "post_id": 32343738, "comment_id": 52617776, "body": "Are you getting an error from your the Workbook_Open()?"}, {"owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "edited": false, "score": 0, "creation_date": 1441378278, "post_id": 32343738, "comment_id": 52670107, "body": "no, I&#39;m getting no errors"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "edited": false, "score": 0, "creation_date": 1441376169, "post_id": 32376556, "comment_id": 52668736, "body": "Thanks a lot for your help.. The code example you gave solved the problem. Hope you have a great day.."}], "tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": true, "score": 0, "last_activity_date": 1441285684, "creation_date": 1441285684, "answer_id": 32376556, "question_id": 32343738, "link": "https://stackoverflow.com/questions/32343738/ive-written-a-code-in-vba-for-an-invoice-problemo-no-increase-in-invoice-numb/32376556#32376556", "title": "I&#39;ve written a code in VBA for an invoice. Problemo: No Increase in invoice number when opening.", "body": "<p>if you continue your code on the next line you need to do the following: </p>\n\n<pre><code>ThisWorkbook.SaveAs Filename:=path &amp; Range(\"J8\").Value &amp; \"-\" &amp; mydate _\nFileFormat:=51\n</code></pre>\n\n<p>Your actual problem is however that you <code>.SaveAs</code> your main workbook thus your main workbook is never saved but only the Invoice workbook.</p>\n\n<p>My advice would be to always make a <code>.Copy</code> of the <code>Sheet</code> you want (if multiple copy them all over) to a new <code>Workbook</code> and <code>.Save</code> that <code>Workbook</code>.</p>\n\n<p>Code example:</p>\n\n<pre><code>dim wb as Workbook\n\nSet wb = Workbooks(\"name here.xlsm\")\nwb.Worksheets(\"Name Here\").Copy\nActiveworkbook.SaveAs Filename:=path &amp; Range(\"J8\").Value &amp; \"-\" &amp; mydate _\nFileFormat:=51\n'Close Invoice wb\nActiveWorkbook.Close SaveChanges:=False\n'Close main wb\nwb.Close SaveChanges:=True\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5284811, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dCBuF9_DgDA/AAAAAAAAAAI/AAAAAAAAAIU/90Yn_c9ftWc/photo.jpg?sz=128", "display_name": "A.Hamoui", "link": "https://stackoverflow.com/users/5284811/a-hamoui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 32376556, "answer_count": 1, "score": 1, "last_activity_date": 1441285684, "creation_date": 1441160842, "last_edit_date": 1531164843, "question_id": 32343738, "link": "https://stackoverflow.com/questions/32343738/ive-written-a-code-in-vba-for-an-invoice-problemo-no-increase-in-invoice-numb", "title": "I&#39;ve written a code in VBA for an invoice. Problemo: No Increase in invoice number when opening.", "body": "<pre><code> Private Sub CreateInvoice_Click()\n</code></pre>\n\n<p>1. This here is to empty all the cells of the invoice which needs to be filled out.</p>\n\n<pre><code> Range(\"B10\").Value = TextBox1.Text\n Range(\"B11\").Value = TextBox2.Text\n Range(\"B12\").Value = TextBox3.Text\n Range(\"A15\").Value = TextBox4.Text\n Range(\"E15\").Value = TextBox5.Text\n Range(\"I15\").Value = TextBox6.Text\n Range(\"G15\").Value = TextBox7.Text\n Range(\"D20\").Value = TextBox8.Text\n Range(\"C20\").Value = TextBox9.Text\n Range(\"H20\").Value = TextBox10.Text\n Range(\"C32\").Value = TextBox11.Text\n Range(\"I32\").Value = TextBox12.Text\n Range(\"I40\").Value = TextBox13.Text\n Range(\"J7\") = Date\n\n\nDim reply As String\nreply = \"yes\"\nDim row As Long\nrow = 21\n\nDim path As String\npath = \"C:\\Invoices\\\"\nDim mydate As String\nmydate = Date\nmydate = Format(mydate, \"dd_mm_yyyy\")\n\nDo While reply = \"yes\" Or reply = \"y\"\nreply = InputBox(\"Do you wish to add another item to the invoice? yes/y for \nyes and no/n for no\", \"Add more items?\")\nIf reply = \"no\" Or reply = \"n\" Then\n</code></pre>\n\n<p>2. Here is the saving code (I'm not sure if it's correct cause I'm new at this, but what I assume is that the micro-enabled excel which is the default excel which I input data into, doesn't save the invoice number when exiting) I've tried to put \"ActiveWorkbook.Close savechanges:=True\" here but still doesn't work.</p>\n\n<pre><code>Application.DisplayAlerts = False\nThisWorkbook.SaveAs Filename:=path &amp; Range(\"J8\").Value &amp; \"-\" &amp; mydate,\nFileFormat:=51\nApplication.DisplayAlerts = True\nActiveWorkbook.Close savechanges:=False\n\nElse\nQTY = InputBox(\"Please enter the quantity of next item ya habeeb.\", \"Enter\nQuantity\")\nCells(row, 3) = QTY\nItemName = InputBox(\"Please Enter the Name of this item habeeb\", \"Enter Item\nName\")\nCells(row, 4) = ItemName\nItemPrice = InputBox(\"Please Enter the price of the item.\", \"Enter Item \nPrice\")\nCells(row, 8) = ItemPrice\nServiceDescription = InputBox(\"Please enter the next service\ndescription.\", \"Enter Service Description\")\nCells(33, 3) = ServiceDescription\nServicePrice = InputBox(\"Please Enter the service price habeeb\", \"Enter \nService Price\")\nCells(33, 9) = ServicePrice\n\nEnd If\nrow = row + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform", "office-addins"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1441160106, "post_id": 32343423, "comment_id": 52561503, "body": "Use <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells(2, &quot;A&quot;).Value</code>, <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Value</code> and <code>ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Value</code>. If you are to store the Date of Username change, you should remove the formula and set the value within <code>Private Sub UserName_Change()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5285792, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/908255375917325/picture?type=large", "display_name": "Veronika Rosales", "link": "https://stackoverflow.com/users/5285792/veronika-rosales"}, "edited": false, "score": 0, "creation_date": 1441205323, "post_id": 32344595, "comment_id": 52585616, "body": "Still does not work, Well, I think I will have to find another way."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 35, "user_id": 5285792, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/908255375917325/picture?type=large", "display_name": "Veronika Rosales", "link": "https://stackoverflow.com/users/5285792/veronika-rosales"}, "edited": false, "score": 0, "creation_date": 1441237523, "post_id": 32344595, "comment_id": 52602132, "body": "It works on my Excel 2010 on Win7x64, unless you are storing this data on a different workbook other than the AddIn file."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1441167612, "creation_date": 1441167612, "answer_id": 32344595, "question_id": 32343423, "link": "https://stackoverflow.com/questions/32343423/excel-add-in-with-some-info-stored/32344595#32344595", "title": "Excel Add-in with some info stored", "body": "<p>Can you try this?</p>\n\n<p>UserForm <strong>UserForm1</strong>:</p>\n\n<pre><code>Private Sub UserForm1_Initialize()\n    Me.DocumentName.Text = ActiveWorkbook.FullName\n    DocumentName.Visible = False\n\n    TextBoxDate.Value = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\").Value\n    'TextBoxDate.Value = CDate(TextBoxDate.Value)\n\n    UserName.Visible = False\n    UserForm1.UserName.Text = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value\n\n    'If A1 is empty pops up a UserRegister form\n    If Len(UserName.Text) = 0 Then\n        UserRegister.Show\n    End If\n    Debug.Print \"Name: \" &amp; ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value\n    Debug.Print \"Date: \" &amp; ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\").Value\nEnd Sub\n</code></pre>\n\n<p>UserForm <strong>UserRegister</strong>:</p>\n\n<pre><code>Private Sub UserName_Change()\n    CommandButtonGO.Enabled = Not (UserName.Text = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value)\nEnd Sub\n\n' I want to store the UserName, so the user does not have to enter it every single time\nPrivate Sub CommandButtonGO_Click()\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = Trim(UserName.Text)\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\").Value = Now\n    ThisWorkbook.Save\n    Unload Me\nEnd Sub\n\nPrivate Sub UserRegister_Initialize()\n    UserName.Text = UCase(Environ(\"USERNAME\"))\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441358366, "post_id": 32360293, "comment_id": 52657386, "body": "To simply get the Username there is a simpler code: <code>Application.UserName</code>"}], "tags": [], "owner": {"reputation": 35, "user_id": 5285792, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/908255375917325/picture?type=large", "display_name": "Veronika Rosales", "link": "https://stackoverflow.com/users/5285792/veronika-rosales"}, "is_accepted": false, "score": 0, "last_activity_date": 1441217492, "last_edit_date": 1495539868, "creation_date": 1441217492, "answer_id": 32360293, "question_id": 32343423, "link": "https://stackoverflow.com/questions/32343423/excel-add-in-with-some-info-stored/32360293#32360293", "title": "Excel Add-in with some info stored", "body": "<p>Well, I figured out how I can do it.</p>\n\n<p>To get a user name i used a code from here : <a href=\"https://stackoverflow.com/questions/3551055/getting-computer-name-using-vba\">Getting computer name using VBA</a> (It also says how to get User Name there)</p>\n\n<p>To get current date of entry I just changed the code for output to:</p>\n\n<pre><code> ActiveCell.Offset(1, 0).Select 'Date column A\n ActiveCell.Value = Date\n</code></pre>\n\n<p>And it outputs the current date in my LOGfile excel.</p>\n\n<p>Thanks a lot for your help =)</p>\n"}], "owner": {"reputation": 35, "user_id": 5285792, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/908255375917325/picture?type=large", "display_name": "Veronika Rosales", "link": "https://stackoverflow.com/users/5285792/veronika-rosales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 32344595, "answer_count": 2, "score": -1, "last_activity_date": 1441217492, "creation_date": 1441158291, "question_id": 32343423, "link": "https://stackoverflow.com/questions/32343423/excel-add-in-with-some-info-stored", "title": "Excel Add-in with some info stored", "body": "<p>I have created a UserForm1 in Excel and saved it as an add-in. This add-in works fine but it does not store some data that I need (does not store it in itself not in the opened excel). I have to store some information in cells A1 and A2 (in A1 Username, in A2 today's date).</p>\n\n<p>When I run this add-in the UserForm1 does not contain these values.</p>\n\n<p>Is there a way how I can store the UserName and get the updated date?</p>\n\n<p>Here is the code for UserForm1:</p>\n\n<pre><code>Private Sub UserForm1_Initialize()    \nMe.DocumentName.Text = ActiveWorkbook.FullName\nDocumentName.Visible = False\n\nTextBoxDate.Value = Worksheets(\"Sheet1\").Cells(2, \"A\").Value\nTextBoxDate.Value = CDate(TextBoxDate.Value)\n\nUserName.Visible = False\nUserform1.UserName.Text = CStr(Range(\"A1\").Value)\n\n'If A1 is empty pops up a UserRegister form\nIf UserName = \"\" Then \nUserRegister.Show\nEnd If    \nEnd Sub\n</code></pre>\n\n<p>UserRegister form code:</p>\n\n<pre><code>Private Sub UserName_Change()\nSheets(\"Sheet1\").Range(\"A1\") = UserName.Text\nEnd Sub\n\n' I want to store the UserName, so the user does not have to enter it every single time\nPrivate Sub CommandButtonGO_Click()\nThisWorkbook.Save \nUnload Me\nEnd Sub\n</code></pre>\n\n<p>To get the date I just use the formula =TODAY() in Cell A2. I know there are other ways, but I found this one very simple.</p>\n"}, {"tags": ["vba", "ms-access", "chm", "html-help"], "comments": [{"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 0, "creation_date": 1441168781, "post_id": 32343392, "comment_id": 52563482, "body": "Are there any weird problems with other windows on the desktop? (If there are, try restarting PC first.)"}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1441362366, "post_id": 32343392, "comment_id": 52659941, "body": "@maxhugen : Are there any options changed in the CHM file compiling process e.g. like Extended Styles &gt; TopMost after your first testing?"}], "answers": [{"comments": [{"owner": {"reputation": 1349, "user_id": 190925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mCmJc.jpg?s=128&g=1", "display_name": "maxhugen", "link": "https://stackoverflow.com/users/190925/maxhugen"}, "edited": false, "score": 0, "creation_date": 1441179838, "post_id": 32344751, "comment_id": 52568301, "body": "I&#39;ve tried SetForegroundWindow(). I see the Help file briefly then it disappears behind Access. I&#39;ve found that if I click into Access, the Help will re-appear!   If I then click the the Help windows Title Bar, it disappears, but if I click in the &#39;body&#39; of the window, the Help screen doesn&#39;t disappear, and I can navigate etc in Help.  Very weird. :("}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": false, "score": 0, "last_activity_date": 1441182206, "last_edit_date": 1495540392, "creation_date": 1441169005, "answer_id": 32344751, "question_id": 32343392, "link": "https://stackoverflow.com/questions/32343392/ms-access-chm-help-file-cant-get-focus/32344751#32344751", "title": "Ms Access CHM Help File Can&#39;t Get Focus", "body": "<p>I see you have <code>hWnd</code> \u2013 do you think you can add a code to send the help window to the foreground programmatically?</p>\n\n<p>You can call <code>SetForegroundWindow()</code> to do the job. <a href=\"https://stackoverflow.com/a/3787106/2392157\">Someone has solved similar problem already</a>, you just need to port call to <code>SetForegroundWindow()</code> or <code>SetForegroundWindowNative()</code> into the VBA.</p>\n\n<hr>\n\n<p>EDIT: You report weird behavior that <code>SetForegroundWindow()</code> makes help window to flash only briefly.</p>\n\n<p><strong>Try issuing VBA's <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278643.aspx\" rel=\"nofollow noreferrer\">AppActivate command</a></strong> \u2013 it has <a href=\"https://stackoverflow.com/questions/26058567/vba-open-xls-app-on-top-of-msaccess-solved\">helped someone else</a>.</p>\n\n<p>If this problem persists, you can try some workaround like resizing your app and help window to show them side-by-side.</p>\n"}, {"comments": [{"owner": {"reputation": 1349, "user_id": 190925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mCmJc.jpg?s=128&g=1", "display_name": "maxhugen", "link": "https://stackoverflow.com/users/190925/maxhugen"}, "edited": false, "score": 0, "creation_date": 1441422693, "post_id": 32396118, "comment_id": 52686101, "body": "I renamed the hh.dat file as you suggested, and it appears to have fixed the probs. The Help file is behaving as expected now. Cheers!"}], "tags": [], "owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "is_accepted": true, "score": 2, "last_activity_date": 1484486710, "last_edit_date": 1484486710, "creation_date": 1441363418, "answer_id": 32396118, "question_id": 32343392, "link": "https://stackoverflow.com/questions/32343392/ms-access-chm-help-file-cant-get-focus/32396118#32396118", "title": "Ms Access CHM Help File Can&#39;t Get Focus", "body": "<p>Some thoughts only - but be careful with the first hint:</p>\n\n<hr>\n\n<p>Which purpose does the file hh.dat serve?</p>\n\n<p>The hh.dat file stores user-specific information on all the HTMLHelp files (*.CHM) on your system (position, favourite topics, search history, etc.), and can cause a error if it has somehow been corrupted.\n Delete or rename the file hh.dat to reset all (!) CHM windows on your system to their default settings.\n You should find hh.dat in this directory:</p>\n\n<blockquote>\n  <p>\\Documents and Settings\\%username%\\Application Data\\Microsoft\\HTML Help</p>\n</blockquote>\n\n<p>Windows will create a new version of hh.dat when you next open any .chm file. </p>\n\n<hr>\n\n<p>According to Microsoft's HTML Help API documentation (<a href=\"http://msdn2.microsoft.com/en-us/library/ms644703(VS.85).aspx\" rel=\"nofollow noreferrer\">http://msdn2.microsoft.com/en-us/library/ms644703(VS.85).aspx</a>):</p>\n\n<p>Any help window that you create through the HTML Help API is owned by the calling, or parent, program. This allows the help window to stay on top of its parent, yet not be on top of any other program that has focus.</p>\n\n<p>So the fact that the help window retains focus is actually the standard behaviour.</p>\n\n<p>If you look at a typical HTML Help API call, you'll see that the first parameter specifies the \"handle\" of the window from which help is called:</p>\n\n<pre><code> HtmlHelp(hwndCaller,\"YourHelpFile.chm\",HH_HELP_CONTEXT,1001); \n</code></pre>\n\n<p>If the developer passes \"null\" rather than the window handle as the first parameter of the call, the help window is no longer owned by the calling program, and so does not retain focus. Here is an example of a modified call:</p>\n\n<pre><code>HtmlHelp(0,\"YourHelpFile.chm\",HH_HELP_CONTEXT,1001);\n</code></pre>\n\n<p>There's a drawback to this, though: when called in this way, the help window is no longer bound by the actions of the calling program. So if the user closes or minimises the program, the help window isn't closed or minimised as well.</p>\n"}], "owner": {"reputation": 1349, "user_id": 190925, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mCmJc.jpg?s=128&g=1", "display_name": "maxhugen", "link": "https://stackoverflow.com/users/190925/maxhugen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 32396118, "answer_count": 2, "score": 0, "last_activity_date": 1484486710, "creation_date": 1441158060, "last_edit_date": 1441365696, "question_id": 32343392, "link": "https://stackoverflow.com/questions/32343392/ms-access-chm-help-file-cant-get-focus", "title": "Ms Access CHM Help File Can&#39;t Get Focus", "body": "<p>I'm opening a custom help file (CHM) using VBA and the api 'HtmlHelp', eg:</p>\n\n<pre><code>hWnd = HtmlHelp(Application.hWndAccessApp, sFile, HH_HELP_CONTEXT, context_id)\n</code></pre>\n\n<p>The Help file opens, but it's hidden behind the Access window, and although it's icon is displayed in the Taskbar, clicking the icon still does not bring it to the foreground - it remains hidden behind Access.</p>\n\n<p>When I first started testing the Help file (on a Win8.1 machine), it opened correctly in front of the Access window, but now it won't. Does anyone have any suggestions as to what is causing this behaviour?</p>\n"}, {"tags": ["vba", "excel", "number-formatting", "code-formatting"], "comments": [{"owner": {"reputation": 27, "user_id": 3721000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cedb87019cb72e9f0356a9a7bc99895a?s=128&d=identicon&r=PG&f=1", "display_name": "svenr", "link": "https://stackoverflow.com/users/3721000/svenr"}, "edited": false, "score": 0, "creation_date": 1441158427, "post_id": 32343155, "comment_id": 52561146, "body": "It does, but it also worsens readability."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1441161944, "post_id": 32343155, "comment_id": 52561875, "body": "try adding a 0 at the end: <code>e = 3.472E-40 * d + 2.156E-70</code>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1441162592, "post_id": 32343155, "comment_id": 52561999, "body": "@PortlandRunner: The Help for &quot;Format Function&quot;: <b>(E- E+ e- e+)</b>: <i>Scientific format. If the format expression contains at least one digit placeholder (0 or #) to the right of E-, E+, e-, or e+, the number is displayed in scientific format and E or e is inserted between the number and its exponent. The number of digit placeholders to the right determines the number of digits in the exponent. Use E- or e- to place a minus sign next to negative exponents. Use E+ or e+ to place a minus sign next to negative exponents and a plus sign next to positive exponents</i> (but I need confirmation)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1441163660, "post_id": 32343155, "comment_id": 52562253, "body": "@portland - I know, I also tried a couple of calculations and it&#39;s not the same result (increases the exponent). I also tried with # and that doesn&#39;t help either"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3721000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cedb87019cb72e9f0356a9a7bc99895a?s=128&d=identicon&r=PG&f=1", "display_name": "svenr", "link": "https://stackoverflow.com/users/3721000/svenr"}, "edited": false, "score": 0, "creation_date": 1441160590, "post_id": 32343603, "comment_id": 52561615, "body": "that&#39;s a reasonable way of doing things @John Coleman.  I&#39;m just puzzled that this is such a big problem - Matlab, MathCad or Maple simply won&#39;t change the input file formatting before compiling, so I never encountered any of these problems."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1441161303, "last_edit_date": 1441161303, "creation_date": 1441159714, "answer_id": 32343603, "question_id": 32343155, "link": "https://stackoverflow.com/questions/32343155/excel-vba-how-to-stop-auto-formatting-of-scientific-numbers-to-floating-in-vba/32343603#32343603", "title": "Excel VBA - How to stop auto formatting of scientific numbers to floating in VBA editor", "body": "<p>You could make a 1-character wrapper for <code>val</code> like:</p>\n\n<pre><code>Function v(s As String) As Double\n    v = Val(s)\nEnd Function\n</code></pre>\n\n<p>and then use expressions like:</p>\n\n<pre><code>e = v(\"3.472e-4\") * d + v(\"2.156e-7\")\n</code></pre>\n\n<p>that might minimize the impact on readability</p>\n\n<p>alternatively -- why not just accept what the editor does but have comments that explain the background formula?</p>\n\n<p>Another approach -- use another editor like <a href=\"http://textpad.com/index.html\" rel=\"nofollow\">Textpad</a> for which VBA syntax highlighting is available (in Textpad's case you need to download a VBA syntax definition file from their website to enable highlighting). You'll lose intellisence but it still has some nice features. I haven't used Textpad for VBA since the built-in editor in Excel is adequate for me, but I have used Textpad extensively for some other languages and find it easy to work with. You could edit code in Textpad (or maybe Notepad++) and copy it over to the VBA editor when you want to test. </p>\n"}], "owner": {"reputation": 27, "user_id": 3721000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cedb87019cb72e9f0356a9a7bc99895a?s=128&d=identicon&r=PG&f=1", "display_name": "svenr", "link": "https://stackoverflow.com/users/3721000/svenr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1502, "favorite_count": 0, "accepted_answer_id": 32343603, "answer_count": 1, "score": 2, "last_activity_date": 1441161303, "creation_date": 1441155998, "last_edit_date": 1441158314, "question_id": 32343155, "link": "https://stackoverflow.com/questions/32343155/excel-vba-how-to-stop-auto-formatting-of-scientific-numbers-to-floating-in-vba", "title": "Excel VBA - How to stop auto formatting of scientific numbers to floating in VBA editor", "body": "<p>I need to enter a series of equations into a VBA function.  The equations contain coefficients in scientific notation and I need to keep this notation to allow easy checking of the VBA script.</p>\n\n<p>However, as soon as I enter a scientific number in the VBA editor and hit Return, the number is automatically converted to a floating number.  Although accuracy is not effected, readability suffers tremendously and makes checking very hard.</p>\n\n<p>How can I suppress auto formatting in the VBA 7.0 editor?</p>\n\n<p>For example, if I enter the following line in the VBA editor:</p>\n\n<pre><code>e = 3.472e-4 * d + 2.156e-7\n</code></pre>\n\n<p>and hit Return I end up seeing the following line</p>\n\n<pre><code>e = 0.0003472 * d + 0.0000002156\n</code></pre>\n\n<p>I need to somehow stop this auto-formatting nightmare.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441155590, "post_id": 32342988, "comment_id": 52560527, "body": "Try it with <code>MyFiles = &quot;C:\\Users\\Temp\\*.xlsx&quot;</code> ."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1441155760, "post_id": 32342988, "comment_id": 52560561, "body": "Welcome to SO. You haven&#39;t run the loop to go through all the files. You need to tell what is working and what not."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1441156502, "post_id": 32342988, "comment_id": 52560714, "body": "Take a look at this and see if you can make sense of it: <a href=\"http://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\" title=\"loop through files in a folder using vba\">stackoverflow.com/questions/10380312/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 5290499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea89f30625ae3f2cb2eecb818f82e091?s=128&d=identicon&r=PG&f=1", "display_name": "H Spiegel", "link": "https://stackoverflow.com/users/5290499/h-spiegel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441239543, "creation_date": 1441154532, "last_edit_date": 1441239543, "question_id": 32342988, "link": "https://stackoverflow.com/questions/32342988/vba-script-to-rollup-data-to-a-master-workbook", "title": "VBA Script to Rollup Data to a Master WorkBook", "body": "<p>I need to write a VBA script to loop through a specified directory containing a number of workbooks and copy a set range from different numbers of worksheets to a Master File that updates with new values. </p>\n\n<p>I am fairly new to VBA and have searched for hours on a number of sites to try to find out what I am doing wrong.  After all this time on StackOverflow, I figured I would just pose the question (hopefully with the push of a button once I get the code working).  </p>\n\n<p>I have attached my code so far.  </p>\n\n<p>It only includes code to pull data from the first workbook, but I am having trouble getting the code to perform the expected behavior.  </p>\n\n<p>I can get it to compile, but it doesn't get new values.  </p>\n\n<pre><code> Sub MasterRollup()\n\n    Dim MyFile As String, MyFiles As String, FilePath As String\n    Dim wbMaster As Workbook, wbTemp As Workbook\n    Dim wsMaster As Worksheet, wsTemp As Worksheet\n    Dim DataRange As Range, OutRange As Range\n    Dim OutBook As Workbook, OutSheet As Worksheet\n    Dim ctr As Integer\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n    End With\n\n    FilePath = \"C:\\Users\\Temp\"\n    MyFiles = \"C:\\Users\\Temp\"\n    MyFile = Dir(MyFiles)\n    Set OutBook = Workbooks.Open(\"C:\\Users\\Temp\\OutputWorkbook.xlsx\")\n    Set OutSheet = OutBook.Sheets(1)\n    ctr = 1\n\n         Set wbMaster = OutBook\n         Set wsMaster = OutBook.Sheets(1)\n\n\n        If MyFile = \"FileName1.xlxs\" Then\n            '~~&gt; Open the file and set variable\n            Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, True)\n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G18:S18\")\n            Set OutRange = OutSheet.Range(\"B5:N5\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Close the opened file\n            wbTemp.Close False 'set to false, because opened as read-only\n            Set wsTemp = Nothing\n            Set wbTemp = Nothing\n            ctr = ctr + 1\n        End If\n\n\n    With Application\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n    End With\n\n    OutBook.SaveAs\n\n    End Sub\n</code></pre>\n\n<p>Edit:</p>\n\n<p>I have tried to incorporate some of the feedback I received and checked out the link that was posted.  I have tried to modify my code and am still not seeing the expected behavior.  The code compiles, but no data appears in the Output workbook.  Any help would be much appreciated.  In the meantime, I'll keep searching :)</p>\n\n<pre><code>   Sub MasterRollup()\n\n  Dim MyFile As String, MyFiles As String, FilePath As String\n  Dim wbMaster As Workbook, wbTemp As Workbook\n  Dim wsMaster As Worksheet, wsTemp As Worksheet\n  Dim DataRange As Range, OutRange As Range\n  Dim OutBook As Workbook, OutSheet As Worksheet\n  Dim ctr As Integer, myExtension As String\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\nEnd With\n\nFilePath = \"C:\\Users\\Test\"\nMyFiles = \"C:\\Users\\Test\"\nmyExtension = \"*.xlsx\"\nSet OutBook = Workbooks.Open(\"C:\\Users\\Test.xlsx\")\nSet OutSheet = OutBook.Sheets(1)\nctr = 1\n\n     Set wbMaster = OutBook\n     Set wsMaster = OutBook.Sheets(1)\n\nMyFile = Dir(FilePath &amp; myExtension)\n\nDo While MyFile &lt;&gt; \"\"\n    If MyFile = \"File 1.xlsx\" Then\n        '~~&gt; Open the file and set variable\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n        '~~&gt; Sheet 1\n        Set wsTemp = wbTemp.Sheets(1)\n        Set DataRange = wsTemp.Range(\"G18:S18\")\n        Set OutRange = OutSheet.Range(\"B5:N5\")\n        DataRange.Copy\n        OutRange.PasteSpecial xlPasteValues\n        '~~&gt; Close the opened file\n        wbTemp.Close False 'set to false, because opened as read-only\n        Set wsTemp = Nothing\n        Set wbTemp = Nothing\n        ctr = ctr + 1\n    End If\n    MyFile = Dir(FilePath &amp; myExtension)\n    If MyFile = \"File 2.xlsx\" Then\n        '~~&gt; Open the file and set variable\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n            '~~&gt; Sheet 1 \n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G17:S17\")\n            Set OutRange = OutSheet.Range(\"B6:N6\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 2 \n            Set wsTemp = wbTemp.Sheets(2)\n            Set DataRange = wsTemp.Range(\"G10:S10\")\n            Set OutRange = OutSheet.Range(\"B7:N7\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 3 \n            Set wsTemp = wbTemp.Sheets(3)\n            Set DataRange = wsTemp.Range(\"G9:S9\")\n            Set OutRange = OutSheet.Range(\"B8:N8\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 4 \n            Set ws.Temp = wbTemp.Sheets(4)\n            Set DataRange = wsTemp.Range(\"G9:S9\")\n            Set OutRange = OutSheet.Range(\"B9:N9\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 5 \n            Set ws.Temp = wbTemp.Sheets(5)\n            Set DataRange = wsTemp.Range(\"G9:S9\")\n            Set OutRange = OutSheet.Range(\"B10:N10\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 6 \n            Set ws.Temp = wbTemp.Sheets(6)\n            Set DataRange = wsTemp.Range(\"G9:S9\")\n            Set OutRange = OutSheet.Range(\"B11:N11\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 7 \n            Set ws.Temp = wbTemp.Sheets(7)\n            Set DataRange = wsTemp.Range(\"G9:S9\")\n            Set OutRange = OutSheet.Range(\"B12:N12\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 8 \n            Set ws.Temp = wbTemp.Sheets(8)\n            Set DataRange = wsTemp.Range(\"G9:S9\")\n            Set OutRange = OutSheet.Range(\"B13:N13\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n        wbTemp.Close False 'set to false, because opened as read-only\n        Set wbTemp = Nothing\n        Set wsTemp = Nothing\n        ctr = ctr + 1\n    End If\n    MyFile = Dir(FilePath &amp; myExtension)\n    If MyFile = \"File 3.xlsx\" Then\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n            '~~&gt; Sheet 1 \n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B14:N14\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n        wbTemp.Close False 'set to false, because opened as read-only\n        Set wbTemp = Nothing\n        Set wsTemp = Nothing\n        ctr = ctr + 1\n    End If\n    MyFile = Dir(FilePath &amp; myExtension)\n    If MyFile = \"File 4.xlsx\" Then\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n            '~~&gt; Sheet 1\n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B15:N15\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n        wbTemp.Close False 'set to false, because opened as read-only\n        Set wbTemp = Nothing\n        Set wsTemp = Nothing\n        ctr = ctr + 1\n    End If\n    MyFile = Dir(FilePath &amp; myExtension)\n    If MyFile = \"File 5.xlsx\" Then\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n            '~~&gt; Sheet 1 \n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B16:N16\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n        Set wbTemp = Nothing\n        Set wsTemp = Nothing\n        ctr = ctr + 1\n        wbTemp.Close False 'set to false, because opened as read-only\n    End If\n    MyFile = Dir(FilePath &amp; myExtension)\n    If MyFile = \"File 6.xlsx\" Then\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n            '~~&gt; Sheet 1 \n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B17:N17\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 2 \n            Set wsTemp = wbTemp.Sheets(2)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B18:N18\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 3 \n            Set wsTemp = wbTemp.Sheets(3)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B19:N19\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 4 \n            Set wsTemp = wbTemp.Sheets(4)\n            Set DataRange = wsTemp.Range(\"G22:S22\")\n            Set OutRange = OutSheet.Range(\"B20:N20\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n        wbTemp.Close False 'set to false, because opened as read-only\n        Set wbTemp = Nothing\n        Set wsTemp = Nothing\n        ctr = ctr + 1\n    End If\n    MyFile = Dir(FilePath &amp; myExtension)\n    If MyFile = \"File 7.xlsx\" Then\n        Set wbTemp = Workbooks.Open(FilePath &amp; MyFile, ReadOnly:=True)\n            '~~&gt; Sheet 1 \n            Set wsTemp = wbTemp.Sheets(1)\n            Set DataRange = wsTemp.Range(\"G18:S18\")\n            Set OutRange = OutSheet.Range(\"B21:N21\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n            '~~&gt; Sheet 2 \n            Set wsTemp = wbTemp.Sheets(2)\n            Set DataRange = wsTemp.Range(\"G19:S19\")\n            Set OutRange = OutSheet.Range(\"B22:N22\")\n            DataRange.Copy\n            OutRange.PasteSpecial xlPasteValues\n        wbTemp.Close False 'set to false, because opened as read-only\n        Set wsTemp = Nothing\n        Set wbTemp = Nothing\n    End If\n\n    Loop\n\nMsgBox (\"Task Completed!\")\n\nWith Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\nEnd With\n\nOutBook.Close SaveChanges:=True\n\nWorkbooks.Open (\"C:\\Users\\Test.xlsx\")\n\nEnd Sub\n</code></pre>\n\n<p>Thanks again!</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1441156744, "post_id": 32342792, "comment_id": 52560760, "body": "I&#39;m not familiar with the <code>IN</code> part of your insert statement. It looks like its ignoring it and just inserting <code>SELECT * FROM [PurchasedInventory]</code> instead, which is of course the same table."}, {"owner": {"reputation": 11, "user_id": 5290457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9a24e33e4d3b279fad43289b530f78?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Sloane", "link": "https://stackoverflow.com/users/5290457/marc-sloane"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1441156868, "post_id": 32342792, "comment_id": 52560790, "body": "That is what is happening. But how do i get the named range from Excel to populate the access table? There has to be some way to show it the correct table."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1441157338, "post_id": 32342792, "comment_id": 52560907, "body": "This one shows one method using <code>transferspreadsheet</code> <a href=\"http://stackoverflow.com/questions/21578518/import-different-excel-files-into-ms-access-2010-tables-automatically\" title=\"import different excel files into ms access 2010 tables automatically\">stackoverflow.com/questions/21578518/&hellip;</a>. This one shows with ADO: <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=173:import-export-data-from-access-to-excel-using-ado&amp;catid=79&amp;Itemid=475\" rel=\"nofollow noreferrer\">globaliconnect.com/excel/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 5290457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9a24e33e4d3b279fad43289b530f78?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Sloane", "link": "https://stackoverflow.com/users/5290457/marc-sloane"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1441158062, "post_id": 32342792, "comment_id": 52561066, "body": "I see those links, but that is using loops, there should be an elegant way to use an insert into statement that references excel range to solve the issue. ty"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441168435, "post_id": 32342792, "comment_id": 52563398, "body": "Your connection string builds a path to the Access database but there is no ADO connection to the Excel table (or rows or columns). The connection to the Excel object is not implicit like the <code>CurrentDb</code> object in Access VBA."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1441178825, "post_id": 32342792, "comment_id": 52567673, "body": "You could create the excel range as a linked table and insert it that way."}], "owner": {"reputation": 11, "user_id": 5290457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc9a24e33e4d3b279fad43289b530f78?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Sloane", "link": "https://stackoverflow.com/users/5290457/marc-sloane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441154373, "creation_date": 1441152906, "last_edit_date": 1531161705, "question_id": 32342792, "link": "https://stackoverflow.com/questions/32342792/inserting-data-from-excel-to-acess-with-vba", "title": "Inserting Data from Excel to Acess with VBA", "body": "<p>I am trying to run code to connect to a database and insert into a table in that database. The connection works fine, but when I run the code it just copies the data table in access into itself. So if nothing is there I get nothing in return. But if one line of data is there I will get two, then 4, then 8, etc on each consecutive time I run the code.</p>\n\n<p>Table I am inserting into is called <code>PurchasedInventory</code>. Named range in Excel is also called <code>PurchasedInventory</code>, which is a dynamic range.  Changing the named range to be something other than <code>PurchasedInventory</code> does not solve the problem.</p>\n\n<pre><code>Public Function connectdatabase()\nSet DBCONT = CreateObject(\"ADODB.connection\")\nDim strDBpath As String\nstrDBpath = \"C:\\Documents and Settings\\Brett\\Desktop\\LupeProject\\LupeProject.accdb\"\nDim sConn As String\nsConn = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source=\" &amp; strDBpath &amp; \";\" &amp; _\n        \"JET OLEDB:Engine Type=5;\" &amp; _\n        \"Persist Security Info=False;\"\n\nDBCONT.Open sConn\n\nDBCONT.Execute \"INSERT INTO PurchasedInventory IN 'C:\\Documents and Settings\\Brett\\Desktop\\LupeProject\\LupeProject.accdb' SELECT * FROM[PurchasedInventory]\"\n\nEnd Function\n</code></pre>\n"}, {"tags": ["matlab", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1444568542, "post_id": 32345700, "comment_id": 53949338, "body": "Aren&#39;t you simply writing to a specific range, or did I miss something?  This should do it for you.  xlswrite(filename,A,sheet,xlRange)  Please see the below link for all details. <a href=\"http://www.mathworks.com/help/matlab/ref/xlswrite.html?refresh=true\" rel=\"nofollow noreferrer\">mathworks.com/help/matlab/ref/xlswrite.html?refresh=true</a>"}, {"owner": {"reputation": 757, "user_id": 1139661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7329d2015e94ec191f4140090588cbaf?s=128&d=identicon&r=PG", "display_name": "Teddy Ort", "link": "https://stackoverflow.com/users/1139661/teddy-ort"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1445495836, "post_id": 32345700, "comment_id": 54350074, "body": "The question was to make a selection based on the values, not write the values. The goal was to automate formatting some cells where the references are contained in matlab variables."}], "tags": [], "owner": {"reputation": 757, "user_id": 1139661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7329d2015e94ec191f4140090588cbaf?s=128&d=identicon&r=PG", "display_name": "Teddy Ort", "link": "https://stackoverflow.com/users/1139661/teddy-ort"}, "is_accepted": true, "score": 0, "last_activity_date": 1441173919, "creation_date": 1441173919, "answer_id": 32345700, "question_id": 32342699, "link": "https://stackoverflow.com/questions/32342699/specify-a-range-in-vba-using-matlab-variables/32345700#32345700", "title": "Specify a range in VBA using MATLAB Variables", "body": "<p>MLGetVar will take the Matlab variable and store it in an array of Variant type in VBA. To access the elements you must either index them using code like:</p>\n\n<pre><code>example(1,1)\n</code></pre>\n\n<p>or iterate through the array using a For loop.</p>\n\n<p>The Range function takes a string to specify the range, so you could iterate over the array and use it to build the string which describes the Range you want.</p>\n\n<p>Here is an example that does what you describe:</p>\n\n<pre><code>Sub test()\n    Dim vec As Variant\n    Dim r As String\n\n    MLGetVar \"example\", vec\n    r = \"\"\n    For Each Row In vec\n        r = r &amp; Row &amp; \":\" &amp; Row &amp; \",\"\n    Next\n    Range(Left(r, Len(r) - 1)).Select\nEnd Sub\n</code></pre>\n\n<p>Note that the variable example must exist in the matlab workspace as described in the question: <code>example = [12,24,60]</code></p>\n"}], "owner": {"reputation": 3, "user_id": 5290426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73241e4cedcc1d7bae8e4573b73ae7bf?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5290426/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 32345700, "answer_count": 1, "score": 0, "last_activity_date": 1441173919, "creation_date": 1441152188, "last_edit_date": 1531164843, "question_id": 32342699, "link": "https://stackoverflow.com/questions/32342699/specify-a-range-in-vba-using-matlab-variables", "title": "Specify a range in VBA using MATLAB Variables", "body": "<p>I have a MATLAB code that creates a large cell array that I am entering into Excel using VBA's MLGetVar function.  The MATLAB code also gives me a list of the rows that are titles/headers.  I would like to be able to take the list of rows generated in MATLAB and use them to specify rows in Excel so I can change the formatting of the entire row (say, to Heading 2).</p>\n\n<p>I have tried several ways of getting the MATLAB values into VBA but haven't had any success:</p>\n\n<p>In MATLAB I have a series of numbers: <code>example = [12,24,60]</code></p>\n\n<p>I am trying to do take these numbers and use them to specify a VBA Range:<br>\n<code>MLGetVar \"example\", VBAVariable</code></p>\n\n<p><code>Dim variable As String</code></p>\n\n<p><code>Let variable = VBAVariable &amp; \":\" &amp; VBAVariable</code></p>\n\n<p><code>Range(Var).Select</code></p>\n\n<p>I could then use the selection to do whatever I need, unfortunately I get a type mismatch.</p>\n\n<p>I have also tried formatting the values in MATLAB so I would have: <code>example = ' \"12:12, 24:24, 60:60\" '</code>\nThen I used <code>MLGetVar</code> to try and use <code>Range()</code> to select, but that also gives a type mismatch.</p>\n\n<p>I know that I'll need to use a For loop to iterate through the list, currently I am only testing a single variable just so I know how to implement my code.</p>\n\n<p>Hope this question isn't too basic, I only started trying to use VBA today.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "formula"], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 2782664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e266338a90964ab90991838bab8a2c8?s=128&d=identicon&r=PG&f=1", "display_name": "user2782664", "link": "https://stackoverflow.com/users/2782664/user2782664"}, "is_accepted": false, "score": 0, "last_activity_date": 1441152929, "creation_date": 1441152929, "answer_id": 32342801, "question_id": 32342593, "link": "https://stackoverflow.com/questions/32342593/formula-to-value-when-saving-excel/32342801#32342801", "title": "Formula to value when saving excel", "body": "<p>You can do this quite easily with VBA:</p>\n\n<p>ActiveSheet.Cells(Row, Column).Value = Date</p>\n"}, {"tags": [], "owner": {"reputation": 1394, "user_id": 3218398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3AML.jpg?s=128&g=1", "display_name": "hstay", "link": "https://stackoverflow.com/users/3218398/hstay"}, "is_accepted": false, "score": 0, "last_activity_date": 1470515449, "creation_date": 1470515449, "answer_id": 38808447, "question_id": 32342593, "link": "https://stackoverflow.com/questions/32342593/formula-to-value-when-saving-excel/38808447#38808447", "title": "Formula to value when saving excel", "body": "<p>You can trigger a Workbook_BeforeClose <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook_events.aspx\" rel=\"nofollow\">event</a> that will replace your formula by its value:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n     Range(\"C2:E2\").Value = Range(\"C2:E2\").Value\n     ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>This code has to be placed in <code>ThisWorkbook</code> object not as a <code>Module</code> macro.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Sorry I misread. If you want the replacement to be done when you save your workbook then the same applies but the code is:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n     Range(\"C2:E2\").Value = Range(\"C2:E2\").Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5290429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19cafca12e4db1cbf3b96968d718b57f?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor Freeman", "link": "https://stackoverflow.com/users/5290429/taylor-freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470515449, "creation_date": 1441151443, "last_edit_date": 1470514725, "question_id": 32342593, "link": "https://stackoverflow.com/questions/32342593/formula-to-value-when-saving-excel", "title": "Formula to value when saving excel", "body": "<p>I need a formula to copy and replace a cell's formula to values, when the sheet is saved.</p>\n\n<p>I have a <code>=today()</code> formula in cells C2:E2. It works, but the problem is when I reopen the file it will show that day, instead of showing the day the sheet was saved.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5258352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ed4d2cda0b992a1933589c99056b1c?s=128&d=identicon&r=PG&f=1", "display_name": "musasi", "link": "https://stackoverflow.com/users/5258352/musasi"}, "edited": false, "score": 1, "creation_date": 1441152552, "post_id": 32342688, "comment_id": 52559817, "body": "Hi Xeper Caz.  Its perfect!"}], "tags": [], "owner": {"reputation": 48, "user_id": 1666890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d446acbd05fe401c4b5d3d1d6fb866b9?s=128&d=identicon&r=PG", "display_name": "Xeper Caz", "link": "https://stackoverflow.com/users/1666890/xeper-caz"}, "is_accepted": true, "score": 1, "last_activity_date": 1441152085, "creation_date": 1441152085, "answer_id": 32342688, "question_id": 32342563, "link": "https://stackoverflow.com/questions/32342563/adding-string-to-parts-of-a-string-in-excel/32342688#32342688", "title": "Adding string to parts of a string in Excel", "body": "<p>If the delimiter is always a semicolon, and the cell's data never ends in a semicolon, a simple way would be to use Excel's Substitute function inline with your concatenation.</p>\n\n<pre><code>=\"I eat \"&amp;SUBSTITUTE([CellNumber], \";\", \" every day. I eat \")&amp;\" every day.\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5258352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ed4d2cda0b992a1933589c99056b1c?s=128&d=identicon&r=PG&f=1", "display_name": "musasi", "link": "https://stackoverflow.com/users/5258352/musasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 32342688, "answer_count": 1, "score": 1, "last_activity_date": 1441328080, "creation_date": 1441151293, "last_edit_date": 1531161705, "question_id": 32342563, "link": "https://stackoverflow.com/questions/32342563/adding-string-to-parts-of-a-string-in-excel", "title": "Adding string to parts of a string in Excel", "body": "<p>In column A, I have a list of random words, separated by \"; \"(semicolon &amp; space),\nand randomly having 1 to 3 words in each cell.</p>\n\n<p>For example, A1 - A5 would contain the following:</p>\n\n<pre><code>apple\nbanana; carrot\ndurian; eggplant\nfig\ngrape; honeydew; icecream\n</code></pre>\n\n<p>I am trying to surround each word with a specified string.  For example, \"I eat \" before the word,<br>\n\" everyday.\", after the word, which should look like the following in column B.</p>\n\n<pre><code>I eat apple everday.\nI eat banana everday.;I eat carrot everday.\nI eat durian everday.; I eat eggplant everday.\nI eat fig everday.\nI eat grape everday.; I eat honeydew everday.; I eat icecream everday.\n</code></pre>\n\n<p>If each cell contains only one word, it would be a simple process of just concatenating:</p>\n\n<pre><code>=CONCATENATE(\"I eat \",A1,\" everyday.\")\n</code></pre>\n\n<p>But then when the number of words are random, it starts to get confusing.  Of course there is a solution by separating by the semicolons into different columns, add the new string, and add everything together, but I was going for doing it in a single cell.</p>\n"}, {"tags": ["vba", "excel", "formula"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1441155018, "post_id": 32342547, "comment_id": 52560397, "body": "If it&#39;s always the right-most 15 digits you&#39;re interested in you could use: <code>=RIGHT(Raw_Number, 15)</code>"}, {"owner": {"reputation": 51, "user_id": 4276726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-niKuNM-Qy3s/AAAAAAAAAAI/AAAAAAAAE4s/vqs4TbduXLY/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4276726/nick"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1441156237, "post_id": 32342547, "comment_id": 52560647, "body": "Thanks for the reply, the 15 digit order number could be anywhere, left right or center, I added that to the main question just now"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4276726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-niKuNM-Qy3s/AAAAAAAAAAI/AAAAAAAAE4s/vqs4TbduXLY/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4276726/nick"}, "edited": false, "score": 0, "creation_date": 1441156874, "post_id": 32343073, "comment_id": 52560793, "body": "Thanks for the reply, Is there any way to get the entire 15 digit PO in column B assuming the next 10 digits to the right are the correct numbers?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 4276726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-niKuNM-Qy3s/AAAAAAAAAAI/AAAAAAAAE4s/vqs4TbduXLY/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4276726/nick"}, "edited": false, "score": 1, "creation_date": 1441157494, "post_id": 32343073, "comment_id": 52560950, "body": "<i>&lt;sigh&gt;</i> Sure. I thought you would have been able to handle that."}, {"owner": {"reputation": 51, "user_id": 4276726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-niKuNM-Qy3s/AAAAAAAAAAI/AAAAAAAAE4s/vqs4TbduXLY/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4276726/nick"}, "edited": false, "score": 0, "creation_date": 1441160075, "post_id": 32343073, "comment_id": 52561492, "body": "I might have been able to I am unable to test anything until work tomorrow and was eager to be done after frustrating attempts today and a newborn keeps me busy at home, thank you for your time"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1441157473, "last_edit_date": 1592644375, "creation_date": 1441155224, "answer_id": 32343073, "question_id": 32342547, "link": "https://stackoverflow.com/questions/32342547/pull-15-digit-order-number-to-new-column-using-the-beginning-5-digit-order-id/32343073#32343073", "title": "Pull 15 digit order number to new column using the beginning 5 digit order ID", "body": "<p>With the '5 digit identifiers' in column Z (starting in row 2) and the 'full 15 digit order ID' in column A starting in row 2 with an unused column in column B, open the VBE and paste hte following into a new module code sheet.</p>\n<pre><code>Sub digit_identifiers()\n    Dim r As Long, v As Long, vDIDs As Variant, vDOIDs As Variant\n    \n    With Worksheets(&quot;Sheet1&quot;)  '&lt;~~set this worksheet properly!!\n        vDIDs = .Range(.Cells(2, &quot;Z&quot;), .Cells(Rows.Count, &quot;Z&quot;).End(xlUp)).Value2\n        vDOIDs = .Range(.Cells(2, &quot;A&quot;), .Cells(Rows.Count, &quot;A&quot;).End(xlUp)).Value2\n        .Range(.Cells(2, &quot;B&quot;), .Cells(Rows.Count, &quot;B&quot;).End(xlUp)).NumberFormat = &quot;[color13]@&quot;\n        \n        For r = LBound(vDOIDs, 1) To UBound(vDOIDs, 1)\n            For v = LBound(vDIDs, 1) To UBound(vDIDs, 1)\n                If CStr(vDOIDs(r, 1)) Like Chr(42) &amp; CStr(vDIDs(v, 1)) &amp; Chr(42) Then\n                    'full 15 digit order ID\n                    .Cells(1 + r, &quot;B&quot;) = CStr(Mid(CStr(vDOIDs(r, 1)), InStr(1, CStr(vDOIDs(r, 1)), CStr(vDIDs(v, 1)), vbTextCompare), 15))\n                    'alternate for just the 5 digit identifier\n                    '.Cells(1 + r, &quot;B&quot;) = CStr(vDIDs(v, 1))\n                    Exit For\n                End If\n            Next v\n        Next r\n    End With\nEnd Sub\n</code></pre>\n<p>Tap <kbd>Alt</kbd>+<kbd>Q</kbd> to return to the worksheet then <kbd>Alt</kbd>+<kbd>F8</kbd> to Run the macro. Your results should resemble the following.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/2TgjS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2TgjS.png\" alt=\"Pattern matching variant strings\" /></a></p>\n<p>The order that you place the '5 digit identifiers' into column Z as may have an effect on the results. If '38003` is likely to produce a false positive match when the result should have been 'C0009', make sure that 'C0009' comes before '38003' in the order.</p>\n"}], "owner": {"reputation": 51, "user_id": 4276726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-niKuNM-Qy3s/AAAAAAAAAAI/AAAAAAAAE4s/vqs4TbduXLY/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4276726/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 32343073, "answer_count": 1, "score": -1, "last_activity_date": 1441225888, "creation_date": 1441151208, "last_edit_date": 1441225888, "question_id": 32342547, "link": "https://stackoverflow.com/questions/32342547/pull-15-digit-order-number-to-new-column-using-the-beginning-5-digit-order-id", "title": "Pull 15 digit order number to new column using the beginning 5 digit order ID", "body": "<p>I have two columns(B&amp;C) of order data that contain a diverse mix of letters and numbers and may or may not contain a specific 15 digit order number mixed in the cell in many different ways. The order number could be to the left middle or the right of the cell. All the order numbers have a specific 5 digit identifier(75 unique in total) that start each order number. \nExample of the 5 digit identifiers and a full 15 digit order ID</p>\n\n<ul>\n<li>12018   <strong>12018</strong>0000000852</li>\n<li>38003   <strong>38003</strong>0000003456</li>\n<li>C0009   <strong>C0009</strong>0000087652</li>\n<li>P0009   <strong>P0009</strong>0000378464</li>\n<li>A0010   <strong>A0010</strong>0000456321</li>\n</ul>\n\n<p>Example of cell values that make getting the PO number difficult, some cells contain partial order numbers that are not usable and random text or number strings that can be smaller or shorter than 15 digits</p>\n\n<ul>\n<li>540501/<strong>12018</strong>0000000852</li>\n<li>BO<strong>A0010</strong>0000456321 8054960602</li>\n<li>86790865 /  /<strong>38003</strong>0000003456</li>\n<li>DSA1491799-000</li>\n<li><strong>38003</strong>0000056</li>\n</ul>\n\n<p>My end goal is to have a single column that lists just the 15 digit order numbers pulled from both B and C, anything more or less would just be blank. Would using a column of all 75 unique 5 digit order IDs help extract that order data.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1441581906, "creation_date": 1441581906, "answer_id": 32429266, "question_id": 32342489, "link": "https://stackoverflow.com/questions/32342489/ms-access-rolling-12-month/32429266#32429266", "title": "MS Access: Rolling 12 Month", "body": "<p>Normalization is always recommended in database design, so I would go for Table Format 1 - <code>[CapacityMonth]</code> option. But for your situation, here are a few reasons for first approach:</p>\n\n<ul>\n<li><p><strong>STRUCTURE:</strong> It is always better to have long than wide format tables. In Access, rows are inexpensive as columns involve table structural design (e.g., Access has no limit on rows but 255 limit on columns). Think BackEnd changes vs FrontEnd application design changes. Plus, indexing, querying, aggregation, merging, and reshaping is much easier with long than wide formats (even less form/report controls), especially as your application grows over time and needed requirements may grow in complexity. Hence, design for best practices in efficiency and scalability from the beginning.</p></li>\n<li><p><strong>QUERIES</strong>: Being the backbone of reports and data processing, you want to build for query optimization. With a <code>[CapacityMonth]</code> column, querying involves less scripting, better maintainability, clear readability, and efficiency than if table had separated Month columns. </p>\n\n<p>For instance, compare readability (recall SQL statements read like a declarative sentences):</p>\n\n<p><code>SELECT [January] FROM Format2Table</code></p>\n\n<p><code>SELECT [Percent] FROM Format1Table WHERE [CapacityMonth] = 'January'</code></p>\n\n<p>Additionally, compare aggregate queries for quarterly/yearly totals:</p>\n\n<p><code>SELECT Sum([January]) + Sum([February]) + ... +  Sum([December]) As [YearTotal] GROUP BY [Year]</code>  </p>\n\n<p><code>SELECT Sum([Percent]) As [YearTotal] GROUP BY [Year]</code>. </p>\n\n<p>Finally, to retrieve reports of monthly totals in a column, the first format requires one group by query while second format requires stacked union queries. And still other examples.</p></li>\n<li><p><strong>TRANSFORM:</strong> Not to worry, the beauty of the <code>[CapacityMonth]</code> approach is you can run a crosstab query to achieve month columns in any specified order for read-only tables, reports, or spreadsheet exports.</p>\n\n<p><code>TRANSFORM Sum(Percent) AS SumOfPercent\n SELECT ContactID, ProjectID\n FROM Format1Table\n GROUP BY ContactID, ProjectID\n PIVOT Capacity IN ('September', 'October', 'November', 'December', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August');</code></p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 5286661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98796f286665f07fe205c0ab452f8f50?s=128&d=identicon&r=PG&f=1", "display_name": "chopper88", "link": "https://stackoverflow.com/users/5286661/chopper88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1308, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480002033, "creation_date": 1441150713, "last_edit_date": 1480002033, "question_id": 32342489, "link": "https://stackoverflow.com/questions/32342489/ms-access-rolling-12-month", "title": "MS Access: Rolling 12 Month", "body": "<p>I'm working on a database enhancement, which would add resource tracking, for a 12 month roll forward (forecast).  In other words, how much time does a person expect to spend on a project this month, next month, and 12 months from now; all on every project they are currently working on.</p>\n\n<p>I'm trying to think of the best way to do it, and come up with the follow table formats (keep in mind this is an existing database, so some fields map to fields on other tables)</p>\n\n<p>Table Format 1:</p>\n\n<ul>\n<li>ProjectID</li>\n<li>ContactID</li>\n<li>Classification (current/history)</li>\n<li>Reporting Period  (as of date)</li>\n<li>CapacityMonth</li>\n<li><p>Percent  (this is the amount of time a month a person expects to spend on a project)</p></li>\n<li><p>Essentially, this creates one record, per project, for each month (12 months), for contact.  My reservation with this is that the table could get get a lot of records very quickly.  Not a huge deal at all, but something I personally try to avoid.</p></li>\n</ul>\n\n<p>Table Format 2:</p>\n\n<ul>\n<li>ProjectID</li>\n<li>ContactID</li>\n<li>Classification (current/history)</li>\n<li>Reporting Period  (as of date)</li>\n<li>January</li>\n<li>February...</li>\n<li>December</li>\n<li><p>Percent</p></li>\n<li><p>I also was thinking of using M0, M1...M11 instead of the month names, for my second point:</p>\n\n<hr></li>\n</ul>\n\n<p>Now, aside from the above two options, I need to think of the best way to design a form to input the data.  I would love to have the months in order, with the first month being the current month, like this:</p>\n\n<p>September | October |...|August</p>\n\n<p>But I can't think of a way to have Access organize the months this way on the form.  To solve this, I thought of using M0 | M1 |...|M11, but then end users might not know which month equates to another.  </p>\n\n<p>I'm sure I'm missing information, so I'll add as needed.  I won't be able to upload a copy, since it is proprietary information.  I'm more or less looking for second opinions on the best way to do these tables.  Any advice or devils advocate is appreciated.   </p>\n"}, {"tags": ["vba", "excel", "copy", "paste"], "comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1441216128, "post_id": 32342393, "comment_id": 52592572, "body": "Still not working if anyone wants the credit for helping me with this.."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1441218553, "post_id": 32342393, "comment_id": 52593896, "body": "I have figured out that it won&#39;t copy objects on some peoples computers because the new workbook that is being made opens in &quot;compatibility&quot; mode&quot; for some reason. No idea how to prevent that."}], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1441206914, "post_id": 32342463, "comment_id": 52586840, "body": "added your line. Objects seem to copy using my computer but when I run the macro from my co-workers computer the objects don&#39;t copy over.. :("}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1441209703, "post_id": 32342463, "comment_id": 52588731, "body": "Does the workbook you&#39;re pasting into have any kind of event handlers?"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1441214156, "post_id": 32342463, "comment_id": 52591474, "body": "I don&#39;t think so, it&#39;s just a new workbook with a new sheet created and this stuff pasted into it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1441219910, "post_id": 32342463, "comment_id": 52594681, "body": "Sorry - I don&#39;t know what else to suggest: adding that line always resolved that problem for me."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1441209802, "last_edit_date": 1441209802, "creation_date": 1441150479, "answer_id": 32342463, "question_id": 32342393, "link": "https://stackoverflow.com/questions/32342393/vba-cells-select-copy-paste-not-bringing-images-over-consistantly/32342463#32342463", "title": "VBA Cells.select copy paste not bringing images over consistantly", "body": "<p>Set</p>\n\n<pre><code>Application.CopyObjectsWithCells = True\n</code></pre>\n\n<p>Before copying</p>\n\n<p>BTW your code</p>\n\n<pre><code>wb.Sheets(form).Activate\nwb.Sheets(form).Cells.Select\nSelection.Copy\nobjwbk.Activate\nws.Range(\"A1\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>will reduce to:</p>\n\n<pre><code>Application.CopyObjectsWithCells = True\nwb.Sheets(form).Cells.Copy ws.Range(\"A1\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "is_accepted": false, "score": 1, "last_activity_date": 1441225653, "creation_date": 1441225653, "answer_id": 32362501, "question_id": 32342393, "link": "https://stackoverflow.com/questions/32342393/vba-cells-select-copy-paste-not-bringing-images-over-consistantly/32362501#32362501", "title": "VBA Cells.select copy paste not bringing images over consistantly", "body": "<p>I found the answer. I am creating a new book and pasting to the new book but it's in compatibility modes solve below</p>\n\n<pre><code>'Remember the users setting which currently is 97-2003 file format\nSaveFormat = Application.DefaultSaveFormat\n 'Set it to the 2007-2010 file format xlsm\nApplication.DefaultSaveFormat = 52\n\n'MAKE NEW BOOK HERE\n\n 'Set DefaultSaveFormat back to the users setting\nApplication.DefaultSaveFormat = SaveFormat\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8434879, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0d220da5e8e412532e3a1a06c2f8c576?s=128&d=identicon&r=PG", "display_name": "Bla2", "link": "https://stackoverflow.com/users/8434879/bla2"}, "is_accepted": false, "score": 0, "last_activity_date": 1502202852, "creation_date": 1502202852, "answer_id": 45571189, "question_id": 32342393, "link": "https://stackoverflow.com/questions/32342393/vba-cells-select-copy-paste-not-bringing-images-over-consistantly/45571189#45571189", "title": "VBA Cells.select copy paste not bringing images over consistantly", "body": "<p>late (ok.. very late ..) answer but i've got the same problem today.</p>\n\n<p>I've try to open the source workbook in read-only mode and it works for for me \u2122.</p>\n\n<p>So, when you set your objwbk (somethink like set objwbk = open(\"c:\\path\\wbk.xls\",,true) ) put the third argument to true.</p>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5543, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1502202852, "creation_date": 1441149975, "last_edit_date": 1441161537, "question_id": 32342393, "link": "https://stackoverflow.com/questions/32342393/vba-cells-select-copy-paste-not-bringing-images-over-consistantly", "title": "VBA Cells.select copy paste not bringing images over consistantly", "body": "<p>I have some data and some images on a sheet.\nI have some code that copies the data &amp; images from this sheet in one workbook to a sheet in another workbook. </p>\n\n<p>The problem:  it seems to be hit or miss if it will bring over the images. Sometimes they copy, sometimes they don't WTF?</p>\n\n<pre><code>            wb.Sheets(form).Activate\n            wb.Sheets(form).Cells.Select\n            Selection.Copy\n            objwbk.Activate\n            ws.Range(\"A1\").Select\n            ActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "intersection"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441150911, "post_id": 32342178, "comment_id": 52559446, "body": "Are the values you&#39;re working with always going to be coming from ranges?"}], "answers": [{"tags": [], "owner": {"reputation": 404, "user_id": 2878986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7p2l0.jpg?s=128&g=1", "display_name": "Russell Harkins", "link": "https://stackoverflow.com/users/2878986/russell-harkins"}, "is_accepted": false, "score": -2, "last_activity_date": 1441151205, "creation_date": 1441151205, "answer_id": 32342546, "question_id": 32342178, "link": "https://stackoverflow.com/questions/32342178/matching-arrays-with-identical-unique-values-vba-excel/32342546#32342546", "title": "Matching arrays with identical unique values VBA (Excel)", "body": "<p>There's a formula you can enter into a cell called VLOOKUP. It takes several parameters. It looks up the value of one cell in a list of cells and returns the value of the cell next to the matching cell in the list of cells.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1441258912, "creation_date": 1441258912, "answer_id": 32367761, "question_id": 32342178, "link": "https://stackoverflow.com/questions/32342178/matching-arrays-with-identical-unique-values-vba-excel/32367761#32367761", "title": "Matching arrays with identical unique values VBA (Excel)", "body": "<p>This will return True if the two ranges passed in have the same set of unique values (in any order or frequency)</p>\n\n<pre><code>Function HaveSameValues(rng1 As Range, rng2 As Range)\nDim c As Range\n\n    For Each c In rng1.Cells\n        If Len(c.Value) &gt; 0 And IsError(Application.Match(c.Value, rng2, 0)) Then\n            SameValues = False\n            Exit Function\n        End If\n    Next c\n    For Each c In rng2.Cells\n        If Len(c.Value) &gt; 0 And IsError(Application.Match(c.Value, rng1, 0)) Then\n            SameValues = False\n            Exit Function\n        End If\n    Next c\n\n    SameValues = True\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441258912, "creation_date": 1441148408, "question_id": 32342178, "link": "https://stackoverflow.com/questions/32342178/matching-arrays-with-identical-unique-values-vba-excel", "title": "Matching arrays with identical unique values VBA (Excel)", "body": "<p>I have been trying to figure this out for some time now. Originally I had searched Google and found some examples of (more or less) what I am trying to do, but seem to be stuck on the code I have thus far. Essentially I am trying to compare the unique variables between two arrays and return a result when there is a perfect match (if one possesses unique values there represent a subset of the other, this would not be a perfect match, all values and number of values would have to be identical. </p>\n\n<p>From the code I have included below; if I compare one array [range(\"B2:b6\") with values {1, 2, 3}] to a second array [(range(\"D10:D11\") with values {1, 2}], I receive a positive match. Per what I am trying to do however (and value order doesn't matter) the only perfect match within an array of {1, 2, 3} would be a second array with values {1, 2, 3} also (or {3, 2, 1} as order doesn't matter).</p>\n\n<p>I am guessing it is due to the type of array I am using and the fact that the lowerbound starts at 0. I could also be completely wrong. I have tried playing around with it without success.</p>\n\n<p>Any Thoughts? Any suggestions are welcome. Thanks! (included pics with different values below)</p>\n\n<p><a href=\"https://i.stack.imgur.com/QBnFB.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QBnFB.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Function UniqueVal(ByRef Arr1, ByRef Arr2)\n\n    If TypeOf Arr1 Is Range Then Arr1 = Arr1.Value2\n    If TypeOf Arr2 Is Range Then Arr2 = Arr2.Value2\n\n    Dim e, x, i As Long\n\n     With CreateObject(\"scripting.dictionary\")\n        .CompareMode = 1\n        For Each e In Arr1\n            If Len(e) Then .Item(e) = Empty\n        Next\n        For Each e In Arr2\n            If .Exists(e) Then\n                .Item(e) = 1\n            Else\n                .RemoveAll\n                UniqueVal = .Keys\n                Exit Function\n            End If\n        Next\n\n        x = Array(.Keys, .Items)\n        .RemoveAll\n        For i = 0 To UBound(x(0))\n            If x(1)(i) = 1 Then .Item(x(0)(i)) = Empty\n        Next\n        If .Count Then UniqueVal = .Keys\n    End With\n\nEnd Function\n\n'and the below sub which calls the above function\n\nSub iTestIntersectionX()\n\narray4 = Join(UniqueVal(Worksheets(\"arrayTest2\").Range(\"B2:B6\"), Worksheets(\"arrayTest2\").Range(\"D10:D11\")), vbLf)\nWorksheets(\"arrayTest2\").Range(\"H20\").value = array4\n\nIf Worksheets(\"arrayTest2\").Range(\"H20\").value &lt;&gt; \"\" Then\n   MsgBox \"Match Found!\"\n  Else\n   MsgBox \"No Match Found!\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 0, "creation_date": 1441148141, "post_id": 32342061, "comment_id": 52558750, "body": "Please switch to the SQL View and show us the SQL Query"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "reply_to_user": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 0, "creation_date": 1441148420, "post_id": 32342061, "comment_id": 52558829, "body": "Added SQL view to post."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1441154207, "post_id": 32342280, "comment_id": 52560214, "body": "Cha, getting an error when I try to do the work around, see answer 2."}, {"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "reply_to_user": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1441155450, "post_id": 32342280, "comment_id": 52560504, "body": "Sorry, made a typo. You should have used the tbl_FuelType in the allDatesFuels query. I have corrected the answer. BTW, do not make answers if you want to comment, just use the comments section here"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1441158078, "post_id": 32342280, "comment_id": 52561071, "body": "No worries, I tried the first query you mentioned above, but I&#39;m getting a prompt to &quot;Enter Parameter Value&quot; for DateLog.  Then when I press Ok or even input a value, I get this error: &quot;This expression is typed incorrectly, or it is too complex to be evaluated.  For example, a numeric expression may contain too many complicated elements.  Try simplifying the expression by assigning parts of the expression to variables.&quot;"}, {"owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "edited": false, "score": 0, "creation_date": 1441159913, "post_id": 32342280, "comment_id": 52561457, "body": "awesome, It&#39;s working now.  I&#39;ve never used that SELECT DISTINCT syntax.  Thanks so much!"}], "tags": [], "owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "is_accepted": true, "score": 2, "last_activity_date": 1441158535, "last_edit_date": 1441158535, "creation_date": 1441149172, "answer_id": 32342280, "question_id": 32342061, "link": "https://stackoverflow.com/questions/32342061/ms-access-query-to-output-all-values-and-treat-unavailable-values-as-zero/32342280#32342280", "title": "MS Access Query to output all values and treat unavailable values as zero", "body": "<p>What you need to add to your query is a table with all dates. You can have a separate table where all dates are entered, such a calendar table or have it derived from your <code>tbl_FuelDelivery</code> like this:</p>\n\n<pre><code>SELECT DISTINCT tbl_FuelDelivery.DateLog \nFROM tbl_FuelDelivery;\n</code></pre>\n\n<p>Now, you need to CROSS JOIN this table with tbl_FuelType. Access does not natively support cross joins, so you'll have to use a workaround: just add the cross join as a comma separated table to your FROM clause:</p>\n\n<pre><code>SELECT a.DateLog, tbl_FuelType.FuelType, tbl_FuelType.ID\nFROM (SELECT DISTINCT tbl_FuelDelivery.DateLog FROM tbl_FuelDelivery) a, \ntbl_FuelType;\n</code></pre>\n\n<p>The query above will give you the all fuel types for all dates. You can save it as a new query (let's call it allDatesFuels). Now, all you need to do is to join it with your query:</p>\n\n<pre><code>SELECT \nallDatesFuels.DateLog, \nSum(Nz([tbl_FuelDelivery].[F_FO_gal_Gross],0)) AS Fuel_Delivery_Gross, \nSum(Nz([tbl_FuelDelivery].[F_FO_gal_Net],0)) AS Fuel_Delivery_Net, \nallDatesFuels.FuelType\nFROM allDatesFuels LEFT JOIN tbl_FuelDelivery ON allDatesFuels.ID = tbl_FuelDelivery.FuelType And allDatesFuels.DateLog = tbl_FuelDelivery.DateLog\nGROUP BY allDatesFuels.DateLog, allDatesFuels.FuelType\nORDER BY allDatesFuels.DateLog;\n\u200b\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4946383, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/F8CZV.jpg?s=128&g=1", "display_name": "lunar8nrg", "link": "https://stackoverflow.com/users/4946383/lunar8nrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 32342280, "answer_count": 1, "score": 1, "last_activity_date": 1441158535, "creation_date": 1441147745, "last_edit_date": 1441148272, "question_id": 32342061, "link": "https://stackoverflow.com/questions/32342061/ms-access-query-to-output-all-values-and-treat-unavailable-values-as-zero", "title": "MS Access Query to output all values and treat unavailable values as zero", "body": "<p>I've created a query MS Access 2010 that is intended to take all fuel types (all values) for each date.  I have the query relationship below: <a href=\"https://i.stack.imgur.com/s93k4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s93k4.png\" alt=\"Figure1\"></a>) and have the following 6 values for fuel type: Diesel #2, MSFO, ULSD, Biodiesel, Used Oil, Heat Recovery.</p>\n\n<p>I'm trying to output the fuel delivery for each fuel type for each date regardless if there's any fuel delivered that date \n<a href=\"https://i.stack.imgur.com/1trKR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1trKR.png\" alt=\"(Figure2\"></a> \nand \n<a href=\"https://i.stack.imgur.com/0LnVP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0LnVP.png\" alt=\"Figure3)\"></a>.  What I'm getting as my output is below\n<a href=\"https://i.stack.imgur.com/YhLmm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YhLmm.png\" alt=\"Figure4\"></a>.</p>\n\n<p>I have tried to change the relationships such that all values on tbl_FuelType would output.  This gave me the output on the figure above.  I've tried entering a criteria to look for the specific fuel type (e.g. \"ULSD\") but if there's no data for that day, it will output with Null values, which I don't want. See criteria below\n<a href=\"https://i.stack.imgur.com/35xTP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/35xTP.png\" alt=\"Figure5\"></a>\nI've tried some program flow functions such as IIF and Switch but still getting null values.  Is there an easy way to do this without having to go into the table and filling out values as zero's for all the different fuel types on the tbl_FuelDelivery?  The SQL view is as follows: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>SELECT tbl_FuelDelivery.DateLog, Sum(Nz([tbl_FuelDelivery].[F_FO_gal_Gross],0)) AS Fuel_Delivery_Gross, Sum(Nz([tbl_FuelDelivery].[F_FO_gal_Net],0)) AS Fuel_Delivery_Net, tbl_FuelType.FuelType\r\nFROM tbl_FuelType LEFT JOIN tbl_FuelDelivery ON tbl_FuelType.ID = tbl_FuelDelivery.FuelType\r\nGROUP BY tbl_FuelDelivery.DateLog, tbl_FuelType.FuelType\r\nORDER BY tbl_FuelDelivery.DateLog;\r\n\u200b</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1441150395, "post_id": 32341824, "comment_id": 52559314, "body": "Have you tried setting the value directly in the FoundThem click event?  <code>Forms!Attendance!employeeID = Me.EmpID</code> or something like that."}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1441151823, "creation_date": 1441151823, "answer_id": 32342647, "question_id": 32341824, "link": "https://stackoverflow.com/questions/32341824/how-to-launch-a-look-up-form-and-return-the-value-from-a-combo-box/32342647#32342647", "title": "How to launch a Look up form, and return the value from a combo box", "body": "<p>The way to do this to launch your little dialog form as \u201cacDialog\u201d. This will cause the calling code to WAIT.</p>\n\n<p>And then the \u201cmagic\u201d part is when they click on \u201cFound Them\u201d you do NOT close the popup form, but simply set the form\u2019s visible = false. This has the effect of the calling code that popped up this form that halted to continue (the form is kicked out of dialog mode when you do this). So now your calling code continues.</p>\n\n<p>So your code will look like this:</p>\n\n<pre><code>  Dim strF       As String      ' name of popup form\n\n  strF = \"frmPopUp\"\n\n  ' open form, wait for user selection\n\n  DoCmd.OpenForm strF, , , , , acDialog\n\n  ' if for is NOT open, then assume user hit cancel buttion\n  ' (you should likly have a cancel button on the form - that cancel buttion will\n  ' execute a docmd.close\n\n  If CurrentProject.AllForms(strF).IsLoaded = True Then\n     ' grab the value of thee combbo box\n\n     strComboBoxValue = Forms(strF)!NameOfComboBox\n\n     DoCmd.Close acForm, strF\n\n  End If\n</code></pre>\n\n<p>As noted, the code behind the Found Them button DOES NOT do a close form, but sets forms visible = false (me.Visible = false), and this trick allows the calling code to continue at which point you can examine any value on the form. Remember to then close the form after you grab the value.</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 5264707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ba128d9d7f043a816a42f968abceb?s=128&d=identicon&r=PG&f=1", "display_name": "The Gambill", "link": "https://stackoverflow.com/users/5264707/the-gambill"}, "is_accepted": true, "score": 1, "last_activity_date": 1441168575, "creation_date": 1441168575, "answer_id": 32344706, "question_id": 32341824, "link": "https://stackoverflow.com/questions/32341824/how-to-launch-a-look-up-form-and-return-the-value-from-a-combo-box/32344706#32344706", "title": "How to launch a Look up form, and return the value from a combo box", "body": "<p>It looks like your data table is in a subform so there is a little more work but it does not have to be as complex as the above solution if you don't want it to be. @Andre451 was close but you need the extra step of identifying the form and subform.  For the purpose of demonstration let's call the form Attendance and subform Entry then I'll call the second form LookUp. So the code for your double click in the subform field will of course look something like this :</p>\n\n<pre><code>Private Sub Student_DblClick(Cancel As Integer)\n DoCmd.OpenForm \"LookUp\" \nEnd Sub\n</code></pre>\n\n<p>You really don't need anything else fancy there. For the button on \"LookUp\" you will put this:</p>\n\n<pre><code>Private Sub Command2_Click()\n\nForms![Attendance]![Entry].Form![Student] = Forms!Lookup!Student\nDoCmd.Close acForm, \"LookUp\"\n\nEnd Sub\n</code></pre>\n\n<p>And that should get you what you want without any overhead or having to leave any ghosts open. </p>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 0, "accepted_answer_id": 32344706, "answer_count": 2, "score": 0, "last_activity_date": 1593677065, "creation_date": 1441146308, "last_edit_date": 1593677065, "question_id": 32341824, "link": "https://stackoverflow.com/questions/32341824/how-to-launch-a-look-up-form-and-return-the-value-from-a-combo-box", "title": "How to launch a Look up form, and return the value from a combo box", "body": "<p>Hopefully I can explain what I want to do well enough...here it goes...</p>\n\n<p>I have a data entry form...the user will be entering employeeIDs.  Once in normal operation, most people will be entering only their own EmpID, and they should know it, so this won't be a big problem 99% of the time once this DB goes live.</p>\n\n<p>However, I need some temps to enter historical data from paper sheets into the DB.  These people will not know anyone else's EmpID.  I'd like to set the Student field's OnDblClick event in the subform's datasheet to open a small form with a combo box.  The combo box has a list of all Employee Names, and is bound to the EmpID.  Once this user enters the name, and selects the person, I have a button they can click to return to the datasheet.</p>\n\n<p>I can use a function to launch the form, no problem there.  But how do I return the EmpID to the field in the datasheet that was double clicked?</p>\n\n<p><a href=\"https://i.stack.imgur.com/8eQU8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8eQU8.jpg\" alt=\"enter image description here\"></a>\nWhen user double clicks in the Student field...I want the next form to appear, and then once they type in the name and select the correct person...and then click Found Them!...I need that bound value to return.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xkplE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xkplE.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I'd love to say I have code to share right now...but the only code I have is to launch the look up form.  I'm brain farting on how to pull the value back down.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1441146308, "post_id": 32341263, "comment_id": 52558174, "body": "If you want to test a cell for emptiness, use <code>IsEmpty()</code>. Don&#39;t compare it to <code>vbNullString</code>."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1441245253, "post_id": 32341263, "comment_id": 52603853, "body": "If you have 0 entered into the cell, then <code>vbNullString</code> wont be returning true."}], "answers": [{"comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1441146020, "post_id": 32341433, "comment_id": 52558075, "body": "<code>vbNullString</code> is not the same as a zero length string (<code>&quot;&quot;</code>). <code>vbNullString</code> is a string having the value <code>0</code>. A zero-length string takes up storage (a BSTR header, essentially). <code>vbNullString</code> is essentially just a null string pointer."}, {"owner": {"reputation": 327, "user_id": 3470049, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/1053002291/picture?type=large", "display_name": "user3470049", "link": "https://stackoverflow.com/users/3470049/user3470049"}, "edited": false, "score": 0, "creation_date": 1441188996, "post_id": 32341433, "comment_id": 52574086, "body": "I tried to change the format of the cells that are worked on to e.g. &#39;0.00&#39; and I tried to rearrange the NumberFormat Property of the Range-Object. Both brought no success, when I try to use IsEmpty() or the comparison with vbNullString the cell is detected empty. This is because the Range.Value is empty even when there is 0.00 in the cell. What to do? :("}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1441144086, "creation_date": 1441144086, "answer_id": 32341433, "question_id": 32341263, "link": "https://stackoverflow.com/questions/32341263/range-value-vbnullstring-is-true-when-value-is-the-number-0/32341433#32341433", "title": "Range(...).Value = vbNullString is true when Value is the number 0?", "body": "<p>This happens because if the cell contains the number zero, then <strong>it's not empty</strong>.</p>\n\n<p>The <code>.Value</code> property of a <code>Range</code> object in Excel is not typed <em>if nothing is written yet</em>. In other words, when the cell contains nothing, it's comparable with both string and numeric \"empty\" values: </p>\n\n<pre><code>Empty cell value = vbNullString --&gt; True\n</code></pre>\n\n<p>because literally talking its value is <code>\"\"</code></p>\n\n<pre><code>Empty cell value = 0 --&gt; True\n</code></pre>\n\n<p>because numerically talking its value is <code>0</code></p>\n\n<p>...and this happen because you still didn't type the value of that range object, so at run time the cell is still considered as containing a <code>Variant</code> type (which means that the type is not defined, so it's like a zero if that was numerical and like an empty string if that was a string). </p>\n\n<p>However, when you type <code>0</code> (or this is the output of a formula, such as <code>=2-2</code>), you're assigning the type \"Numeric\" to that range. The cell becomes <em>Numeric</em> Which means: </p>\n\n<p><em>Is the numerical null type (<code>0</code>) equal to a null string? <code>False</code></em></p>\n\n<p><em>Is the numerical null type (<code>0</code>) equal to zero? <code>True</code></em></p>\n\n<p>If you want zero to be considered as the <code>Null</code> alternative to the string <code>\"\"</code> (i.e. the constant <code>vbNullString</code>), then you should enrich your condition with the numerical check <code>.Value = 0</code>.</p>\n"}], "owner": {"reputation": 327, "user_id": 3470049, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/1053002291/picture?type=large", "display_name": "user3470049", "link": "https://stackoverflow.com/users/3470049/user3470049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441144086, "creation_date": 1441143278, "question_id": 32341263, "link": "https://stackoverflow.com/questions/32341263/range-value-vbnullstring-is-true-when-value-is-the-number-0", "title": "Range(...).Value = vbNullString is true when Value is the number 0?", "body": "<p>I want to check if some cells in  excel are empty. So I do a comparison with vbNullString, which worked fine. But now, it seems as if the comparison is true when the cells contain the number zero? How can this be?</p>\n\n<p>Thanks for advices,\nFlorian</p>\n"}, {"tags": ["forms", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 5186, "user_id": 3962636, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c30d90a87f337bdfe5d28e3212ff087?s=128&d=identicon&r=PG", "display_name": "Steven Kanberg", "link": "https://stackoverflow.com/users/3962636/steven-kanberg"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1441160796, "post_id": 32341120, "comment_id": 52561662, "body": "Yes, I see that now.  Do you have a suggestion on how I can make this work?  For that matter, is it an event on the embedded query that I am applying the event to, or is it to one of the fields in the query (i.e. the person field) or somewhere else, for that matter?"}, {"owner": {"reputation": 5186, "user_id": 3962636, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c30d90a87f337bdfe5d28e3212ff087?s=128&d=identicon&r=PG", "display_name": "Steven Kanberg", "link": "https://stackoverflow.com/users/3962636/steven-kanberg"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1441167085, "post_id": 32341120, "comment_id": 52563074, "body": "Wow.  I must have done a terrible job at explaining myself.  Here it is in short:  I want to select a name from the combo box, pass that name into the query, and the query then list only the tasks that belong to that name.  How can I do that?  I&#39;ll provide any details you ask for."}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 1, "creation_date": 1441191618, "post_id": 32341120, "comment_id": 52575667, "body": "What is the record source for your combo box?  how many columns does it have? which column is the bound column? When you say your first attempt &quot;didn&#39;t work&quot; what does that mean?  what result did you get vs the result you expected?  did it produce an error?  Can you show the SQL for your query that didn&#39;t work, and the SQL for the recordsource of the combo box (if available) along with indicating which column is the bound column?"}], "answers": [{"comments": [{"owner": {"reputation": 5186, "user_id": 3962636, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c30d90a87f337bdfe5d28e3212ff087?s=128&d=identicon&r=PG", "display_name": "Steven Kanberg", "link": "https://stackoverflow.com/users/3962636/steven-kanberg"}, "edited": false, "score": 0, "creation_date": 1441233030, "post_id": 32356192, "comment_id": 52600869, "body": "Andre, I&#39;ve had moderate success which I appreciate.  I used the first solution being sure not to include the &#39; marks.  However, it is still not grabbing the text from the combo box.  If I simply type in a person&#39;s name in the criteria, it filters the data.  But, if I enter in the Forms![Task Form]![Combo11] then it doesn&#39;t.  Thoughts on why?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 5186, "user_id": 3962636, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c30d90a87f337bdfe5d28e3212ff087?s=128&d=identicon&r=PG", "display_name": "Steven Kanberg", "link": "https://stackoverflow.com/users/3962636/steven-kanberg"}, "edited": false, "score": 1, "creation_date": 1441256854, "post_id": 32356192, "comment_id": 52606606, "body": "Then we come back to Gene&#39;s questions: What is the record source for your combo box? how many columns does it have? which column is the bound column? And please show the SQL of the query that is the recordsource of the form."}, {"owner": {"reputation": 5186, "user_id": 3962636, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c30d90a87f337bdfe5d28e3212ff087?s=128&d=identicon&r=PG", "display_name": "Steven Kanberg", "link": "https://stackoverflow.com/users/3962636/steven-kanberg"}, "edited": false, "score": 0, "creation_date": 1441296362, "post_id": 32356192, "comment_id": 52631473, "body": "Hi Andre &amp; Gene, I figured out the issue.  Turns out I needed to match the criteria to the PersonId as that is what was used for the lookup and displayed on the form.  Once I matched to that, it worked like a charm.  Thank you for all your help!!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1441204800, "last_edit_date": 1495541318, "creation_date": 1441204800, "answer_id": 32356192, "question_id": 32341120, "link": "https://stackoverflow.com/questions/32341120/access-2013-embedded-query-filtered-by-combo-box-on-form/32356192#32356192", "title": "Access 2013 - Embedded query filtered by combo box on form", "body": "<p>The first method is the easier one.<br>\nIn the query you have</p>\n\n<pre><code>WHERE TaskPerson = Forms![Task Form]![Combo11]\n</code></pre>\n\n<p>Note that there are <strong>no</strong> ' around the combo reference. With <code>'Forms![Task Form]![Combo11]'</code> the whole thing is interpreted as string, so it doesn't work.</p>\n\n<p>Then in <code>Combo11_AfterUpdate</code> you simply have</p>\n\n<pre><code>Me.Requery\n</code></pre>\n\n<p>Disadvantage of this method: you always have to select a person, or the form will be empty.</p>\n\n<hr>\n\n<p>The second method:</p>\n\n<p>Your query lists all record, the combobox applies a filter. Or removes it, if the user clears the combobox.</p>\n\n<p>I suggest going back to the <a href=\"https://stackoverflow.com/a/20849159/3820271\">answer</a> you used, and only replace<br>\n<code>Combo_Reported_LOB_Selection</code> by <code>Combo11</code><br>\nand<br>\n<code>[ReportedLOB]</code> by <code>[TaskPerson]</code></p>\n\n<p>And the code doesn't go into <code>Form_SelectionChange()</code>, but into <code>Combo11_AfterUpdate()</code></p>\n"}], "owner": {"reputation": 5186, "user_id": 3962636, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c30d90a87f337bdfe5d28e3212ff087?s=128&d=identicon&r=PG", "display_name": "Steven Kanberg", "link": "https://stackoverflow.com/users/3962636/steven-kanberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1929, "favorite_count": 0, "accepted_answer_id": 32356192, "answer_count": 1, "score": 1, "last_activity_date": 1441204800, "creation_date": 1441142567, "last_edit_date": 1495541632, "question_id": 32341120, "link": "https://stackoverflow.com/questions/32341120/access-2013-embedded-query-filtered-by-combo-box-on-form", "title": "Access 2013 - Embedded query filtered by combo box on form", "body": "<p>I'm new to Access and this is the problem I'm suffering: I have four tables - Task, Person, Role, and TaskPerson (mapping table).  I have a form that at the top has a unbound combo box displaying a list of people from Person.  In the body of the form I have a query pulling from the Task and TaskPerson tables that is embedded as a datasheet.  The fields from TaskPerson perform a lookup on Person and Role to display the actual values.  Each task can have multiple people assigned to it and each person can have multiple roles.  I am looking to pick a name from the combo box with the datasheet updating to only show the tasks associated with that person (i.e. matching the name from the combo box to the name in the person field (which is a lookup) on the form and only showing those tasks).</p>\n\n<p>I have tried adjusting the Record Source for the query so the person field criteria would pull from the combo box using</p>\n\n<pre><code>'Forms![Task Form]![Combo11]'\n</code></pre>\n\n<p>but that hasn't worked.  I have also tried a version of this <a href=\"https://stackoverflow.com/questions/20847431/using-combo-boxes-to-filter-a-split-form\">answer</a>:</p>\n\n<pre><code>Private Sub Form_SelectionChange()\n\n' If the combo box is cleared, clear the form filter.\n  If Nz(Form) = \"\" Then\n  Me.Form.Filter = \"\"\n  Me.FilterOn = False\n\n' If a combo box item is selected, filter for an exact match.\n' Use the ListIndex property to check if the value is an item in the list.\n  ElseIf Me.Combo11.ListIndex &lt;&gt; -1 Then\n  Me.Form.Filter = \"[Combo11] = '\" &amp; _\n             Replace(Me.Combo11.Text, \"'\", \"''\") &amp; \"'\"\n  Me.FilterOn = True\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>While the code is not balking, it also isn't grabbing the selected name from the combo box, so it doesn't update.  A likely factor is when I type Me.Combo11.Text, it doesn't actually display Combo11 as an option.  I tried typing it in, in hopes of working, but I know that is a bit foolish.</p>\n\n<p>Any <em>detailed</em> answers would be appreciated.  I'm still learning my way around and I get lost a bit easily.</p>\n\n<p>Steve.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5174, "user_id": 1842939, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c0792ed73c45c637ab251325b6986442?s=128&d=identicon&r=PG", "display_name": "RGriffiths", "link": "https://stackoverflow.com/users/1842939/rgriffiths"}, "edited": false, "score": 0, "creation_date": 1441140981, "post_id": 32340440, "comment_id": 52556058, "body": "Did as soon as it would let me :)"}], "tags": [], "owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "is_accepted": true, "score": 3, "last_activity_date": 1441139784, "creation_date": 1441139784, "answer_id": 32340440, "question_id": 32340411, "link": "https://stackoverflow.com/questions/32340411/decimal-place-issue-in-excel/32340440#32340440", "title": "Decimal place issue in Excel", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251755.aspx\" rel=\"nofollow\"><code>Format()</code> function</a>:</p>\n\n<pre><code>Cells(1,2) = Format(Cells(1,1), \"0.00\") &amp; \"(text)\"\n</code></pre>\n\n<p>Or maybe you can apply a number format to the cell directly, instead of converting it into a text value. In the cell number format properties, use this format:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>0.00\" (text)\";-0.00\" (other text);\"0.00\"\n</code></pre>\n"}], "owner": {"reputation": 5174, "user_id": 1842939, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c0792ed73c45c637ab251325b6986442?s=128&d=identicon&r=PG", "display_name": "RGriffiths", "link": "https://stackoverflow.com/users/1842939/rgriffiths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 32340440, "answer_count": 1, "score": 1, "last_activity_date": 1441147968, "creation_date": 1441139666, "last_edit_date": 1441147968, "question_id": 32340411, "link": "https://stackoverflow.com/questions/32340411/decimal-place-issue-in-excel", "title": "Decimal place issue in Excel", "body": "<p>I am trying to use VBA to place into a cell a number to two decimal places followed by text in brackets in a cell such as:</p>\n\n<blockquote>\n  <p>1.23 (text)</p>\n</blockquote>\n\n<p>An example of how I am acheiving this is as follows:</p>\n\n<pre><code>Cells(1, 1) = 1.23\nCells(1, 2) = Cells(1, 1) &amp; \" (text)\"\n</code></pre>\n\n<p>The format of Cells(1, 1) is to two decimal places on the worksheet but if this number is 1.20 or 1.00 for example the result is:</p>\n\n<blockquote>\n  <p>1.2 (text) or 1 (text)</p>\n</blockquote>\n\n<p>How can I force the two decimal places to be maintained in Cells(1, 2) to be to two decimal places? I have tried:</p>\n\n<pre><code>Cells(1, 2) = Round(Cells(1, 1), 2) &amp; \" (text)\"\n\nCells(1, 1).NumberFormat = \"0.00\"\nCells(1, 2) = Cells(1, 1) &amp; \" (text)\"\n</code></pre>\n\n<p>but neither of these work. Any suggestions?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1441139425, "post_id": 32340244, "comment_id": 52555289, "body": "You can&#39;t set <code>Flag</code> to a string.  However it looks like Flag might be a Boolean?  Hard to tell with so little code"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 1, "creation_date": 1441139543, "post_id": 32340244, "comment_id": 52555353, "body": "What are you trying to do here? What is <code>Flag</code> defined as? Why not use VBA to handle the if statement and search?"}, {"owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1441140017, "post_id": 32340244, "comment_id": 52555569, "body": "@Gareth is right. If you start doing work in VBA, you should soon refrain from using the WorksheetFunction and use the VBA functions instead.See <a href=\"http://www.rondebruin.nl/win/s9/win006.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win006.htm</a> for finding values in ranges"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4987516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52bd2ff4ca89980d5de474db88d1e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Steven8322", "link": "https://stackoverflow.com/users/4987516/steven8322"}, "is_accepted": false, "score": 0, "last_activity_date": 1441139567, "last_edit_date": 1441139567, "creation_date": 1441139494, "answer_id": 32340376, "question_id": 32340244, "link": "https://stackoverflow.com/questions/32340244/object-required-error-vba-iserror-and-vlookup/32340376#32340376", "title": "Object required error VBA Iserror and vlookup", "body": "<p>I have some qualms about the vlookup function.  I don't understand everything you're trying to do, but</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(ActiveCell.Offset(0, Offset1).Value, abcd.Value, 1, False)\n</code></pre>\n\n<p>looks wonky.</p>\n\n<ol>\n<li>Your second term is abcd.Value.  This needs to be a range of cells.</li>\n<li>Your third value is 1. The first column of a vlookup is reserved for the index, not retrievable values, so I don't think you can have the value 1 here. </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1441139732, "creation_date": 1441139732, "answer_id": 32340426, "question_id": 32340244, "link": "https://stackoverflow.com/questions/32340244/object-required-error-vba-iserror-and-vlookup/32340426#32340426", "title": "Object required error VBA Iserror and vlookup", "body": "<p>If you use <code>Application.WorksheetFunction.VLookup()</code> then a non-match will result in a run-time error which you will need to trap using <code>On Error</code>.</p>\n\n<p>If you instead use <code>Application.VLookup()</code> then an error value is returned in the event no match is made - you can test for this using <code>IsError()</code></p>\n\n<pre><code>If IsError(Application.VLookup(ActiveCell.Offset(0, Offset1).Value, _\n                                           Range(\"abcd\"), 1, False)) Then\n\n    ActiveCell.Value = \"abc\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5284164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8748eac0dd3db65ba97ba22362b19?s=128&d=identicon&r=PG&f=1", "display_name": "richasingh178", "link": "https://stackoverflow.com/users/5284164/richasingh178"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441139732, "creation_date": 1441138909, "last_edit_date": 1441138977, "question_id": 32340244, "link": "https://stackoverflow.com/questions/32340244/object-required-error-vba-iserror-and-vlookup", "title": "Object required error VBA Iserror and vlookup", "body": "<p>I am getting object required error in following line of code</p>\n\n<pre><code>Set Flag = \"If(Application.WorksheetFunction.IsError(Application.WorksheetFunction.VLookup(ActiveCell.Offset(0, Offset1).Value, abcd.Value, 1, False)),False,True)\"\n\n    If (Flag = True) Then\n     ActiveCell.Value = \"abc\"\n</code></pre>\n\n<p>where abcd is a named range.\nCan someone please suggest way to rectify this error?</p>\n"}, {"tags": ["excel", "date", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1441138808, "post_id": 32340077, "comment_id": 52554981, "body": "If you just want to highlight a start date and end date, I suggest look into Conditional Formatting.  What determines start and end dates?"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 2782664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e266338a90964ab90991838bab8a2c8?s=128&d=identicon&r=PG&f=1", "display_name": "user2782664", "link": "https://stackoverflow.com/users/2782664/user2782664"}, "is_accepted": false, "score": 1, "last_activity_date": 1441153725, "creation_date": 1441153725, "answer_id": 32342898, "question_id": 32340077, "link": "https://stackoverflow.com/questions/32340077/fill-a-cell-range-based-on-start-and-end-date-which-will-change/32342898#32342898", "title": "Fill a cell range based on start and end date (which will change)", "body": "<p>Just to clarify the question, you want to put in one heading for each month between the start and end date?</p>\n\n<p>You can use the MONTH() function to extract the month from a date. So using VBA, you could do something like</p>\n\n<p>for index = 0 to (month(enddate) - month(startdate))\n'Insert a header\nnext index</p>\n\n<p>You can do the same with year if they are not all in the same year. </p>\n"}], "owner": {"reputation": 11, "user_id": 5289924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9db261d8f95b48d3ad82c606436c60a?s=128&d=identicon&r=PG&f=1", "display_name": "MECGURU", "link": "https://stackoverflow.com/users/5289924/mecguru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1485, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441153725, "creation_date": 1441138206, "last_edit_date": 1531161705, "question_id": 32340077, "link": "https://stackoverflow.com/questions/32340077/fill-a-cell-range-based-on-start-and-end-date-which-will-change", "title": "Fill a cell range based on start and end date (which will change)", "body": "<p>My start and end dates will continually change. I need the appropriate cells to highlight the appropriate range between the start and end dates. Each column will have a date heading. The dates will be a month and year and run for a year. For example, Jan 15, Feb 15, Mar 15......Jan 16. How should I write this formula?</p>\n\n<p>Thanks for your help in advance. </p>\n\n<p>If my image does not post, the excel sheet will look like:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>|Supervisors|Job Number|Start date|End Date|Jan-15|Feb-15|Mar-15...\n| John Doe  |12345-67  | Jan 15   |June 15 |xxxxx |xxxxx |xxxxx \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5289881, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203387387084715/picture?type=large", "display_name": "Dan Thorstad", "link": "https://stackoverflow.com/users/5289881/dan-thorstad"}, "edited": false, "score": 0, "creation_date": 1441403998, "post_id": 32341880, "comment_id": 52682433, "body": "Hi Peter.  The code works great, had to make a few minor tweaks but nothing crazy.  I have one question though.  Is there a way to have the date with accumulated time populate the cell directly below the previous day?  Right now it doesn&#39;t seem to do that.  Thanks again!"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1441146626, "creation_date": 1441146626, "answer_id": 32341880, "question_id": 32339911, "link": "https://stackoverflow.com/questions/32339911/auto-populate-accumulated-time-data-in-excel-into-a-calendar/32341880#32341880", "title": "Auto-populate accumulated time data in Excel into a calendar", "body": "<p>You haven't specified how you are storing the total elapsed time. I've created an example below, but please change it to suit your needs.</p>\n\n<p>The key to solving your problem is in using the <code>Workbook_BeforeClose</code> event in the <code>ThisWorkbook</code> object. (Using the <code>Workbook_Open</code> event helps too, as you see below in my example.)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim todaysDate As Date\n    Dim todaysRange As Range\n    Dim dateRange As Range\n    Dim ws As Worksheet\n    Dim lastRow As Long\n\n    Set ws = ActiveSheet\n\n    If Not StopTimer Then\n        '--- turn off the timer if it's still running\n        StopTimer = True\n    End If\n\n    todaysDate = Date\n\n    '--- you'll have declare how and where you're storing the\n    '    \"hours on date\" information. the example here is that\n    '    you have a list of dates in column D. If you find the\n    '    date then add the current timer value to it, if you\n    '    don't find the date then create a new line for the\n    '    date and hours\n    Set dateRange = ws.Range(\"D:D\")\n    Set todaysRange = dateRange.Find(What:=todaysDate, _\n                                     After:=dateRange.Cells(1, 1), _\n                                     LookAt:=xlWhole, _\n                                     SearchDirection:=xlNext, _\n                                     SearchFormat:=False)\n    If todaysRange Is Nothing Then\n        '--- not found, create a new row at the end\n        lastRow = ws.Cells(ws.Rows.Count, 4).End(xlUp).Offset(Abs( _\n                           ws.Cells(ws.Rows.Count, 4).End(xlUp).Value &lt;&gt; \"\"), 0).Row\n        Set todaysRange = dateRange.Cells(lastRow, 1)\n        todaysRange.Offset(0, 0).Value = todaysDate\n        todaysRange.Offset(0, 1).Value = 0\n    End If\n    todaysRange.Offset(0, 1).Value = todaysRange.Offset(0, 1).Value + _\n                                     ws.Range(\"B3\").Value\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n    '--- resets the timer value each time you open the\n    '    workbook, so it appropriately starts from zero\n    ws.Range(\"B3\").Value = 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5289881, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203387387084715/picture?type=large", "display_name": "Dan Thorstad", "link": "https://stackoverflow.com/users/5289881/dan-thorstad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441146626, "creation_date": 1441137412, "last_edit_date": 1531164843, "question_id": 32339911, "link": "https://stackoverflow.com/questions/32339911/auto-populate-accumulated-time-data-in-excel-into-a-calendar", "title": "Auto-populate accumulated time data in Excel into a calendar", "body": "<p>I'm trying to create an Excel tool that will help measure the amount of time our reps interact with clients, are on the phone, or doing claims research.  I have a functioning stopwatch that accumulates time each time you hit start.  However, I would like that accumulated time to be populated into a calendar on the current date each time the application is closed.  For example, rep has a total of 1:14:29 of client interaction on September 1st.  When she closes Excel, I would like that time data put into the cell representing September 1st.  Any ideas?  I've included the code for the stopwatch.</p>\n\n<pre><code>Dim StopTimer           As Boolean\nDim SchdTime            As Date\nDim Etime               As Date\nConst OneSec            As Date = 1 / 86400#\n\nSub ResetBtn_Click()\n    StopTimer = True\n    Etime = 0\n    [B3].Value = \"00:00:00\"\nEnd Sub\n\nSub StartBtn_Click()\n   StopTimer = False\n   SchdTime = Now()\n   [B3].Value = Format(Etime, \"hh:mm:ss\")\n   Application.OnTime SchdTime + OneSec, \"Sheet1.NextTick\"\nEnd Sub\n\nSub StopBtn_Click()\n    StopTimer = True\n    Beep\nEnd Sub\n\nSub NextTick()\n   If StopTimer Then\n      'Don't reschedule update\n   Else\n      [B3].Value = Format(Etime, \"hh:mm:ss\")\n      SchdTime = SchdTime + OneSec\n      Application.OnTime SchdTime, \"Sheet1.NextTick\"\n      Etime = Etime + OneSec\n   End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1441137259, "post_id": 32339790, "comment_id": 52554139, "body": "Are the cells in <code>Sheet2</code> held as <code>Text</code> or are they dates too?"}, {"owner": {"reputation": 47, "user_id": 5226148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac5814d2cee944dfe716b43a2ff0886f?s=128&d=identicon&r=PG&f=1", "display_name": "account can&#39;t delete", "link": "https://stackoverflow.com/users/5226148/account-cant-delete"}, "reply_to_user": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1441137397, "post_id": 32339790, "comment_id": 52554210, "body": "They are dates... I formatted it as dd-mmm"}, {"owner": {"reputation": 47, "user_id": 5226148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac5814d2cee944dfe716b43a2ff0886f?s=128&d=identicon&r=PG&f=1", "display_name": "account can&#39;t delete", "link": "https://stackoverflow.com/users/5226148/account-cant-delete"}, "reply_to_user": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1441139040, "post_id": 32339790, "comment_id": 52555105, "body": "Also I need if in sheet1 I use =today() instead of full date to update today&#39;s value"}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1441139273, "post_id": 32339790, "comment_id": 52555208, "body": "I don&#39;t understand your last comment.  Do you mean <code>A1</code> will contain the formula <code>=TODAY()</code>?  If so, then this will not impact my answer."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 47, "user_id": 5226148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac5814d2cee944dfe716b43a2ff0886f?s=128&d=identicon&r=PG&f=1", "display_name": "account can&#39;t delete", "link": "https://stackoverflow.com/users/5226148/account-cant-delete"}, "edited": false, "score": 0, "creation_date": 1441140884, "post_id": 32340303, "comment_id": 52556012, "body": "Glad to help.  If it solved your problem, please considering marking it as accepted and upvoting it."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 47, "user_id": 5226148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac5814d2cee944dfe716b43a2ff0886f?s=128&d=identicon&r=PG&f=1", "display_name": "account can&#39;t delete", "link": "https://stackoverflow.com/users/5226148/account-cant-delete"}, "edited": false, "score": 0, "creation_date": 1441173143, "post_id": 32340303, "comment_id": 52564953, "body": "This StackOverflow help article will tell you: <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> :)"}], "tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": true, "score": 0, "last_activity_date": 1441139189, "creation_date": 1441139189, "answer_id": 32340303, "question_id": 32339790, "link": "https://stackoverflow.com/questions/32339790/vba-code-for-find-the-date/32340303#32340303", "title": "vba code for Find the date", "body": "<p>There are a few issues:</p>\n\n<ol>\n<li>Unless you think it's absolutely necessary, I would remove the notion of searching on the format.  Adding the format into the search is only complicating it. I would remove the formatting criteria and simply change the <code>LookIn</code> parameter to the <code>Find</code> method from <code>xlValues</code> to be <code>xlFormulas</code> so that the formatting does not matter at all.</li>\n<li>You need to define <code>x</code> as <code>Date</code> to hold the true value as it is stored in all of the cells.</li>\n<li>Your code will only find the first cell with the same date and there could be many.  Not sure if this was your intention.</li>\n<li>You can't <code>Activate</code> at the same time as assigning the <code>Cell</code> variable. You need to do this in two steps.</li>\n</ol>\n\n<p>I would update your code to look like this:-</p>\n\n<pre><code>Sub UpdateToday()\n\n  Dim x As Date\n  Dim Cell As Range\n  x = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1\").Value\n  Sheets(\"Sheet2\").Activate\n  Range(\"N10:NC10\").Select 'All 360 days\n  Set Cell = Selection.Find(What:=x, After:=ActiveCell, LookIn:=xlFormulas, _\n                            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                            MatchCase:=False, SearchFormat:=False)\n  If Not Cell Is Nothing Then\n    Cell.Activate\n  End If\n\n  Sheets(\"Sheet2\").Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5226148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac5814d2cee944dfe716b43a2ff0886f?s=128&d=identicon&r=PG&f=1", "display_name": "account can&#39;t delete", "link": "https://stackoverflow.com/users/5226148/account-cant-delete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1225, "favorite_count": 0, "accepted_answer_id": 32340303, "answer_count": 1, "score": 0, "last_activity_date": 1441139189, "creation_date": 1441136937, "last_edit_date": 1531164843, "question_id": 32339790, "link": "https://stackoverflow.com/questions/32339790/vba-code-for-find-the-date", "title": "vba code for Find the date", "body": "<p>Sheet 1:- I mentioned the date in Range A1 with dd-mmm format (i.e., 01-Sep)</p>\n\n<p>Sheet 2:- I updated all the date (from Jan to Dec) with same format (dd-mmm)</p>\n\n<p>But I'm unable to find (select the cell) the date.\nI wrote as below:</p>\n\n<pre><code>Sub UpdateToday()\nDim x As String\nDim Cell As Range\nx = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1\").Value\nSheets(\"Sheet2\").Activate\nRange(\"C10:NC10\").Select'All 360 days\nApplication.FindFormat.NumberFormat = \"dd-mmm\"\nSet Cell = Selection.Find(What:=x, After:=ActiveCell, LookIn:=xlValues, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=True).Activate\nSheets(\"Sheet2\").Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441138783, "post_id": 32339707, "comment_id": 52554962, "body": "How do you distinguish between page break between pages of the same dataset, and a break between two different datasets?"}, {"owner": {"reputation": 1, "user_id": 5289818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d246593e2f884aff4d2d086e80e902?s=128&d=identicon&r=PG&f=1", "display_name": "wired", "link": "https://stackoverflow.com/users/5289818/wired"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441147431, "post_id": 32339707, "comment_id": 52558529, "body": "That is a good question. I am not sure how to. Does excel know when the manual page break is entered vs a regular page break? It would be great just to get the pdfs to print by page break to multiple pdfs. I could use adobe to combine."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5289818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d246593e2f884aff4d2d086e80e902?s=128&d=identicon&r=PG&f=1", "display_name": "wired", "link": "https://stackoverflow.com/users/5289818/wired"}, "edited": false, "score": 0, "creation_date": 1441197115, "post_id": 32342635, "comment_id": 52579429, "body": "One workbook. One worksheet (Sheet1). Within Sheet 1 there is 160 pages."}], "tags": [], "owner": {"reputation": 25, "user_id": 5285713, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bABoP2kKV0g/AAAAAAAAAAI/AAAAAAAAAD4/G-LVd2frFIA/photo.jpg?sz=128", "display_name": "Jerry Beaucaire", "link": "https://stackoverflow.com/users/5285713/jerry-beaucaire"}, "is_accepted": false, "score": 0, "last_activity_date": 1441151735, "creation_date": 1441151735, "answer_id": 32342635, "question_id": 32339707, "link": "https://stackoverflow.com/questions/32339707/excel-vba-pdf-print-eparating-with-horizontal-page-breaks/32342635#32342635", "title": "excel VBA PDF print eparating with horizontal page breaks", "body": "<p>Are you saying you have a workbook with 160 worksheets in it? Or a workbook with 1 worksheet in it with 160 sets of data on the one sheet?</p>\n"}], "owner": {"reputation": 1, "user_id": 5289818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d246593e2f884aff4d2d086e80e902?s=128&d=identicon&r=PG&f=1", "display_name": "wired", "link": "https://stackoverflow.com/users/5289818/wired"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 524, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441151735, "creation_date": 1441136594, "question_id": 32339707, "link": "https://stackoverflow.com/questions/32339707/excel-vba-pdf-print-eparating-with-horizontal-page-breaks", "title": "excel VBA PDF print eparating with horizontal page breaks", "body": "<p>I have a worksheet that has 160 pages in it. One set of data could have 3 pages followed by a horizontal page breaks. I am trying to figure out how to make a separate PDF after each horizontal page break and name it as the string in cell A (it is the same name down) of that page break.</p>\n\n<p>This is where I am at with the export to pdf, missing the above.</p>\n\n<pre><code>Sub Print_PDF()\nDim Awb As Workbook\nDim Snr As Integer\nDim ws As Worksheet\nSet Awb = ActiveWorkbook\n\n\nFor Each ws In Awb.Sheets\n    If ws.Visible = xlSheetVisible Then\n\n    'Sheets(ws.Name).Copy\n    Awb.Sheets(ws.Name).Copy\n    'Sheets(ws.Name).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, filename:= _\n    Awb.Path &amp; \"\\\" &amp; Awb.Sheets(ws.Name).Name &amp; \".pdf\", _\n    Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, OpenAfterPublish:=False\n\n    ActiveWindow.Close False\nEnd If\n</code></pre>\n\n<p>Next ws</p>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "rows"], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 2151300, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86f86db776f8ba26e8cd35254c317490?s=128&d=identicon&r=PG", "display_name": "H&#252;seyin Dursun", "link": "https://stackoverflow.com/users/2151300/h%c3%bcseyin-dursun"}, "edited": false, "score": 0, "creation_date": 1441137344, "post_id": 32339611, "comment_id": 52554183, "body": "If I would know this code, of course I would show :) I am trying to make something by searching on the net. By the way, thank you so much... This is awesome..."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "reply_to_user": {"reputation": 429, "user_id": 2151300, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86f86db776f8ba26e8cd35254c317490?s=128&d=identicon&r=PG", "display_name": "H&#252;seyin Dursun", "link": "https://stackoverflow.com/users/2151300/h%c3%bcseyin-dursun"}, "edited": false, "score": 0, "creation_date": 1441150295, "post_id": 32339611, "comment_id": 52559298, "body": "What I meant by that is you call this code from a workbook event, and you showed it as a manually started sub (which wouldn&#39;t loop) basically you didn&#39;t give us the info to recreate the problem.  Anyway glad I could help."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": true, "score": 2, "last_activity_date": 1441136301, "creation_date": 1441136301, "answer_id": 32339611, "question_id": 32339263, "link": "https://stackoverflow.com/questions/32339263/excel-vba-macro-code-inserting-unlimited-rows-without-stopping/32339611#32339611", "title": "Excel VBA Macro Code Inserting Unlimited Rows Without Stopping", "body": "<p>I don't think you are showing us the important part of the code (that sets this one off).</p>\n\n<p>I would try disabling events since the macro is likely changing a cell and seeing that a cell is changed (inserted, whatever) starting your event again.</p>\n\n<p>Try adding these at the beginning and ending of your macro.</p>\n\n<pre><code>Application.EnableEvents = False  \n\n\nApplication.EnableEvents = True \n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 2151300, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86f86db776f8ba26e8cd35254c317490?s=128&d=identicon&r=PG", "display_name": "H&#252;seyin Dursun", "link": "https://stackoverflow.com/users/2151300/h%c3%bcseyin-dursun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 32339611, "answer_count": 1, "score": 2, "last_activity_date": 1441147763, "creation_date": 1441134912, "last_edit_date": 1441147763, "question_id": 32339263, "link": "https://stackoverflow.com/questions/32339263/excel-vba-macro-code-inserting-unlimited-rows-without-stopping", "title": "Excel VBA Macro Code Inserting Unlimited Rows Without Stopping", "body": "<p>The below code is automatically runs when a cell in a specified column changes and if it is not empty.</p>\n\n<pre><code>Sub mergeCells()\n    Dim num As Integer\n    Dim countmerged As Integer\n    If IsEmpty(ActiveCell.Value) Then\n        Exit Sub\n    Else\n        countmerged = -1\n        If ActiveCell.Offset(-1, 0).mergeCells Then\n            countmerged = ActiveCell.Offset(-1, 0).MergeArea.Cells.Count * -1\n        End If\n        num = ActiveCell.Offset(countmerged, -1).Value\n        If ActiveCell.Offset(countmerged, 0).Value = ActiveCell.Value Then\n            ActiveCell.ClearContents\n            ActiveCell.Offset(0, 1).ClearContents\n            ActiveCell.Offset(0, 37).ClearContents\n            ActiveCell.Offset(0, 36).ClearContents\n            ActiveCell.Offset(0, -1).ClearContents\n            ActiveCell.Offset(1, 0).EntireRow.Insert\n            ActiveCell.Offset(2, 0).EntireRow.Copy ActiveCell.Offset(1, 0).EntireRow\n            Range(ActiveCell.Offset(countmerged, 37), ActiveCell.Offset(0, 37)).Merge\n            Range(ActiveCell.Offset(countmerged, 36), ActiveCell.Offset(0, 36)).Merge\n            Range(ActiveCell.Offset(0, 1), ActiveCell.Offset(countmerged, 1)).Merge\n            Range(ActiveCell.Offset(countmerged, -1), ActiveCell.Offset(0, -1)).Merge\n            Range(ActiveCell, ActiveCell.Offset(countmerged, 0)).Merge\n            ActiveCell.Offset(1, -1).Value = num + 1\n            ActiveCell.Offset(2, -1).Value = num + 2\n        Else\n            ActiveCell.Offset(1, 0).EntireRow.Insert\n            ActiveCell.Offset(2, 0).EntireRow.Copy ActiveCell.Offset(1, 0).EntireRow\n            Selection.Offset(1, -1).Value = num + 2\n            Selection.Offset(2, -1).Value = num + 3\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>if the value is the same value with the above cell, they are being merged and another row with the same formulas is inserted. This works without problem.</p>\n\n<p>But if the value is not the same as the above cell, only a row must be inserted with the same formulas but it adds rows without stopping.</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1441133130, "post_id": 32338443, "comment_id": 52551878, "body": "I <b>highly</b> recommend changing <code>cell as Range</code> to something other than <code>cell</code>.  That&#39;s because <code>Cell</code> has its own, built in meaning for VBA, and using <code>cell</code> as a variable could cause confusion for you and/or VBA. For exactly what you&#39;re doing, I just use <code>cel as Range</code> instead (then it&#39;d be <code>For Each cel in SrchRng</code>)."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441133252, "post_id": 32338443, "comment_id": 52551941, "body": "Unfortunately, these changes (changing A1 to A3) did not correct the issue. The &quot;RES&quot; column is still starts at A1 and the &quot;B&quot; columns are not transferred."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441134577, "post_id": 32338443, "comment_id": 52552637, "body": "The issue was that I didn&#39;t specify my search range correctly. Thanks for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441133242, "post_id": 32338560, "comment_id": 52551932, "body": "Unfortunately, these changes did not correct the issue. The &quot;RES&quot; column is still starts at A1 and the &quot;B&quot; columns are not transferred."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441134561, "post_id": 32338560, "comment_id": 52552625, "body": "The issue was that I didn&#39;t specify my search range correctly. Thanks for your help!"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1441132064, "creation_date": 1441132064, "answer_id": 32338560, "question_id": 32338443, "link": "https://stackoverflow.com/questions/32338443/transfer-data-using-if-then-statements-from-sheet-1-to-2/32338560#32338560", "title": "Transfer Data using IF THEN statements from sheet 1 to 2", "body": "<p>Change <code>A1</code> to <code>A3</code>.<br>\n<strong>From</strong>  </p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A1\").End(xlToLeft).Offset(3, 0).EntireColumn.Value = cell.EntireColumn.Value  \n</code></pre>\n\n<p><strong>To</strong></p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A3\").End(xlToLeft).Offset(3, 0).EntireColumn.Value = cell.EntireColumn.Value  \n</code></pre>\n\n<p>Similarly <strong>from</strong>  </p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A1\").End(xlToLeft).Offset(0, 2).EntireColumn.Value = cell.EntireColumn.Value  \n</code></pre>\n\n<p><strong>To</strong>  </p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A3\").End(xlToLeft).Offset(0, 2).EntireColumn.Value = cell.EntireColumn.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441134503, "post_id": 32338890, "comment_id": 52552603, "body": "Wow, cannot believe I missed setting the search range correctly. Thanks. I haven&#39;t seen <code>Resize</code> before. I&#39;ll have to look it up. I will take care of inserting rows at the end. The only part I don&#39;t quite get is <code>pasteColOffset = pasteColOffset + 2</code>. I ran the code without it and the &quot;RES&quot; column didn&#39;t appear on sheet2."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441134759, "post_id": 32338890, "comment_id": 52552745, "body": "I&#39;m just using pasteColOffset to determine which column to paste in (offsetting from Column A)  if you leave out the ...+2 pasteColOffset remains 0 so the first column with B in it would overwrite it.  The way you had it previously would always paste in column C so I needed to add the variable.  The plus 2 gives the gap after the first column."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": true, "score": 0, "last_activity_date": 1441133409, "creation_date": 1441133409, "answer_id": 32338890, "question_id": 32338443, "link": "https://stackoverflow.com/questions/32338443/transfer-data-using-if-then-statements-from-sheet-1-to-2/32338890#32338890", "title": "Transfer Data using IF THEN statements from sheet 1 to 2", "body": "<p>I added some notes and adjustments in the code.</p>\n\n<ol>\n<li>You set the search range to A1:A4 not A1:D1</li>\n<li>You are searching for A in your code not B</li>\n<li><p>The offset you use will put any columns with B in sheet2 column C so I added a counter for the row.</p>\n\n<pre><code>Sub TransferValues()\n'Added counter\nDim pasteColOffset As Long\n\npasteColOffset = 0\n'If statement\n\nDim SrchRng As Range, cell As Range\nDim lc As Long\nlc = Sheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column\n\n'This will set the seach range to A1:A4\n'Set SrchRng = Sheets(\"Sheet1\").Range(\"A1:A\" &amp; lc &amp; \"\")\n\nSet SrchRng = Sheets(\"Sheet1\").Range(\"A1\").Resize(1, lc)\n\nFor Each cell In SrchRng\n    If InStr(1, cell.Value, \"RES\") &gt; 0 Then 'works\n        Sheets(\"Sheet2\").Range(\"A3\").End(xlToLeft).Offset(3, 0).EntireColumn.Value = cell.EntireColumn.Value\n        pasteColOffset = pasteColOffset + 2\n'This is looking for String \"A\" not String \"B\"\n'ElseIf InStr(1, cell.Value, \"A\", vbTextCompare) &gt; 0 Then 'does not work\n\n    ElseIf InStr(1, cell.Value, \"B\", vbTextCompare) &gt; 0 Then\n\n'This will always place the data in column 3 maybe add a counter\n'Sheets(\"Sheet2\").Range(\"A1\").End(xlToLeft).Offset(0, 2).EntireColumn.Value = cell.EntireColumn.Value\n\n        Sheets(\"Sheet2\").Range(\"A3\").Offset(0, pasteColOffset).EntireColumn.Value = cell.EntireColumn.Value\n        pasteColOffset = pasteColOffset + 1\n    End If\nNext cell\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>I didn't tackle the pasting in row 3 since I'm out of time but its happening because you are using the entirecolumn property.  You can't use entire column if you don't want to paste the entire column you will need to get the actual ranges (highly preferable) or insert cells above after pasting.</p>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441135852, "post_id": 32338940, "comment_id": 52553361, "body": "Thank you. Could you please explain what the <code>Do While Loop</code> is doing?"}, {"owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441136231, "post_id": 32338940, "comment_id": 52553548, "body": "len() is the length of the contents of the cell.  So it is moving over one cell on a loop until the length of the contents is 0.  It just keeps adding 1 to xCol until it gets to an empty column."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441136731, "post_id": 32338940, "comment_id": 52553847, "body": "Thanks again! Very clever."}], "tags": [], "owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "is_accepted": false, "score": 0, "last_activity_date": 1441133620, "creation_date": 1441133620, "answer_id": 32338940, "question_id": 32338443, "link": "https://stackoverflow.com/questions/32338443/transfer-data-using-if-then-statements-from-sheet-1-to-2/32338940#32338940", "title": "Transfer Data using IF THEN statements from sheet 1 to 2", "body": "<pre><code>Sub TransferValues()\n\nDim SrchRng As Range, cell As Range\nDim cRange As Range, vRange As Range\nDim xCol As Integer\n\nDim lc As Long\nlc = Sheets(\"Sheet1\").Range(\"a1\").End(xlToRight).Column\nSet SrchRng = Sheets(\"Sheet1\").Range(\"A1\").Resize(1, lc)\n\n\n\nFor Each cell In SrchRng\n    If InStr(1, cell.Value, \"RES\") &gt; 0 Then\n        Set cRange = Range(cell, cell.End(xlDown))\n        Set vRange = Sheets(\"Sheet2\").Range(\"A1\").Offset(2, 0).Resize(cRange.Rows.Count, 1)\n        vRange.Value = cRange.Value\n    ElseIf InStr(1, cell.Value, \"B\", vbTextCompare) &gt; 0 Then\n        Set cRange = Range(cell, cell.End(xlDown))\n        xCol = 1\n        Do While Len(Sheets(\"sheet2\").Range(\"A1\").Offset(2, xCol)) &gt; 0\n            xCol = xCol + 1\n        Loop\n        Set vRange = Sheets(\"Sheet2\").Range(\"A1\").Offset(2, xCol).Resize(cRange.Rows.Count, 1)\n        vRange.Value = cRange.Value\n    End If\n\n    Set cRange = Nothing\n    Set vRange = Nothing\n\nNext cell\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 32338890, "answer_count": 3, "score": 1, "last_activity_date": 1441133620, "creation_date": 1441131648, "question_id": 32338443, "link": "https://stackoverflow.com/questions/32338443/transfer-data-using-if-then-statements-from-sheet-1-to-2", "title": "Transfer Data using IF THEN statements from sheet 1 to 2", "body": "<p>I would like to transfer data from sheet1 to sheet2 as indicated in the below pictures. I thought it best to use an <code>if</code> statement. For example, <code>if</code> a cell in the search range equals \"RES\", <code>then</code> place entire column containing \"RES\" on sheet2 starting at row 3 of the first empty column. <code>ElseIF</code> the next cell in the search range has a \"B\" in it, then place that entire column containing the cell with a \"B\" in it two columns from the \"RES\" column on sheet2, but place any other column with a \"B\" in it after the last column with a \"B\" in it on sheet2.</p>\n\n<p>The code below will place the \"RES\" column starting at \"A1\" on sheet2 (I cannot figure out how to place it starting at row three). It will not transfer any columns with \"B\" in the header. It should be noted that the letter \"B\" need not always be in the first position of the string. Any help is much appreciated.   </p>\n\n<p><a href=\"https://i.stack.imgur.com/s3fND.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s3fND.png\" alt=\"Pic1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bKUvC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bKUvC.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>Sub TransferValues()\n\n'If statement\n\nDim SrchRng As Range, cell As Range\nDim lc As Long\nlc = Sheets(\"Sheet1\").Cells(1, Columns.count).End(xlToLeft).Column\nSet SrchRng = Sheets(\"Sheet1\").Range(\"A1:A\" &amp; lc &amp; \"\")\n\nFor Each cell In SrchRng\n    If InStr(1, cell.Value, \"RES\") &gt; 0 Then 'works\n        Sheets(\"Sheet2\").Range(\"A1\").End(xlToLeft).Offset(3, 0).EntireColumn.Value = cell.EntireColumn.Value\n\n    ElseIf InStr(1, cell.Value, \"A\", vbTextCompare) &gt; 0 Then 'does not work\n    Sheets(\"Sheet2\").Range(\"A1\").End(xlToLeft).Offset(0, 2).EntireColumn.Value = cell.EntireColumn.Value\n    End If\nNext cell\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "xlwings"], "answers": [{"comments": [{"owner": {"reputation": 1549, "user_id": 4236984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/fKrEh.jpg?s=128&g=1", "display_name": "ursan", "link": "https://stackoverflow.com/users/4236984/ursan"}, "edited": false, "score": 0, "creation_date": 1441152180, "post_id": 32339754, "comment_id": 52559741, "body": "Great! Any idea when the next version is coming up?"}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "reply_to_user": {"reputation": 1549, "user_id": 4236984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/fKrEh.jpg?s=128&g=1", "display_name": "ursan", "link": "https://stackoverflow.com/users/4236984/ursan"}, "edited": false, "score": 0, "creation_date": 1441180547, "post_id": 32339754, "comment_id": 52568715, "body": "A few weeks? But you could in theory already install it from github directly: see <a href=\"https://pip.pypa.io/en/latest/reference/pip_install.html#git\" rel=\"nofollow noreferrer\">pip.pypa.io/en/latest/reference/pip_install.html#git</a>"}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "reply_to_user": {"reputation": 1549, "user_id": 4236984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/fKrEh.jpg?s=128&g=1", "display_name": "ursan", "link": "https://stackoverflow.com/users/4236984/ursan"}, "edited": false, "score": 1, "creation_date": 1443449770, "post_id": 32339754, "comment_id": 53486004, "body": "This has been now been released with v0.4.0."}], "tags": [], "owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "is_accepted": true, "score": 2, "last_activity_date": 1443449739, "last_edit_date": 1443449739, "creation_date": 1441136756, "answer_id": 32339754, "question_id": 32338434, "link": "https://stackoverflow.com/questions/32338434/xlwings-get-and-set-named-ranges/32339754#32339754", "title": "xlwings - Get and set named ranges", "body": "<p>The version currently under development (v0.4.0) will have a <code>Range.name</code> property which will allow you to get and set named ranges: <a href=\"https://github.com/ZoomerAnalytics/xlwings/issues/210\" rel=\"nofollow\">https://github.com/ZoomerAnalytics/xlwings/issues/210</a></p>\n"}], "owner": {"reputation": 1549, "user_id": 4236984, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/fKrEh.jpg?s=128&g=1", "display_name": "ursan", "link": "https://stackoverflow.com/users/4236984/ursan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2030, "favorite_count": 0, "accepted_answer_id": 32339754, "answer_count": 1, "score": 1, "last_activity_date": 1443449739, "creation_date": 1441131622, "question_id": 32338434, "link": "https://stackoverflow.com/questions/32338434/xlwings-get-and-set-named-ranges", "title": "xlwings - Get and set named ranges", "body": "<p>I am working on a new project with xlwings and I was wondering if and how it was possible to access and/or set the named ranges' names of a workbook. </p>\n\n<p>I know we can access a named range with the <code>Range()</code> function, but is it possible to get a list of names for a specific workbook (say the caller) and create a named range from python?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1441130321, "post_id": 32338059, "comment_id": 52550324, "body": "I just tried pasting a number + comas + spaces ... if the format is set to general, it&#39;ll figure out it&#39;s a number just fine. The only way it treats it as text, is if the format for the cells is set to text. Change that first, then try repasting ..."}], "answers": [{"comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "reply_to_user": {"reputation": 3, "user_id": 5289521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea209beeead8005ef2f972e986d89fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Y.S", "link": "https://stackoverflow.com/users/5289521/y-s"}, "edited": false, "score": 0, "creation_date": 1441133235, "post_id": 32338348, "comment_id": 52551929, "body": "After you receive answers, please always make sure to close out your question by check marking one that worked best for your solution."}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 0, "last_activity_date": 1441131296, "creation_date": 1441131296, "answer_id": 32338348, "question_id": 32338059, "link": "https://stackoverflow.com/questions/32338059/how-to-remove-whitespace-following-numbers-in-excel/32338348#32338348", "title": "How to remove whitespace following numbers in EXCEL?", "body": "<p>Try converting them with either of the two formulas below:</p>\n\n<pre><code>In E5, type this:\n=VALUE(SUBSTITUTE((SUBSTITUTE(B5, \",\", \"\")), CHAR(160), \"\"))\n</code></pre>\n\n<p>It appears that the last 2 characters have a code of 160 as determined by <code>=CODE(RIGHT(B5,1))</code> and <code>=CODE(RIGHT(B5,2))</code>. So we just simply replace them with blanks.</p>\n\n<p>or </p>\n\n<pre><code>In E5, type this:\n=VALUE(SUBSTITUTE(MID(B5, 1, LEN(B5)-2), \",\", \"\"))\n</code></pre>\n\n<p>In the above case, we strip off the last 2 characters and then do substitution on it.</p>\n"}, {"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1441131700, "creation_date": 1441131700, "answer_id": 32338455, "question_id": 32338059, "link": "https://stackoverflow.com/questions/32338059/how-to-remove-whitespace-following-numbers-in-excel/32338455#32338455", "title": "How to remove whitespace following numbers in EXCEL?", "body": "<p>Optionally, you may use this small VBA code whenever you want:  </p>\n\n<p>Sub test()</p>\n\n<pre><code>For i = 3 To 49\n    For j = 2 To 5\n        If Cells(i, j).Value &lt;&gt; \"\" Then\n            Cells(i, j).Value = Trim(Cells(i, j).Value)\n            Cells(i, j).Value = Left(Cells(i, j).Value, Len(Cells(i, j).Value) - 2)\n        End If\n    Next\nNext\n</code></pre>\n\n<p>End Sub  </p>\n\n<p>It will iterate through all the cells from <code>B3</code> to <code>D49</code> and will remove two blank spaces. This will convert the format to number automatically.</p>\n"}], "owner": {"reputation": 3, "user_id": 5289521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea209beeead8005ef2f972e986d89fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Y.S", "link": "https://stackoverflow.com/users/5289521/y-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 32338348, "answer_count": 2, "score": 0, "last_activity_date": 1441245286, "creation_date": 1441130177, "last_edit_date": 1531161705, "question_id": 32338059, "link": "https://stackoverflow.com/questions/32338059/how-to-remove-whitespace-following-numbers-in-excel", "title": "How to remove whitespace following numbers in EXCEL?", "body": "<p>I copy and paste the following data from Yahoo Finance. However, the numbers(with commas) in the table are recognized as texts. Also, in each cell with numbers, two whitespace are followed. I am trying to remove the whitespace and convert all \"numbers\" to numbers so that I can do some data analysis.</p>\n\n<p><a href=\"https://drive.google.com/file/d/0B9LkX6MnC9XPcjYwTmVFQUV0NG8/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B9LkX6MnC9XPcjYwTmVFQUV0NG8/view?usp=sharing</a></p>\n\n<p>I tried the trim function in EXCEL, but I failed. Is there some quick way to remove the white space following the numbers?</p>\n"}]