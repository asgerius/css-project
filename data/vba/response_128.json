[{"tags": ["c#", "vba", "events", "vsto"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 2, "creation_date": 1498088684, "post_id": 44687837, "comment_id": 76359798, "body": "Isn&#39;t this what active directory and file system security are meant to do? Why are you reinventing the wheel with your own (not overly secure) methods?"}, {"owner": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1498090113, "post_id": 44687837, "comment_id": 76360103, "body": "Because the file has to be distributed to users that are not always connected to a network, therefore they could potentially save a copy onto a USB stick and give it to a competitor so I am simply trying to ensure that it will only run on a company computer."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498091056, "post_id": 44687837, "comment_id": 76360325, "body": "If the security check hasn&#39;t run then why not just have the add-in disable itself?"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1498091119, "post_id": 44687837, "comment_id": 76360345, "body": "So if they are not connected to a network, how pretel do you expect to perform a security check?"}, {"owner": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "edited": false, "score": 0, "creation_date": 1498091268, "post_id": 44687837, "comment_id": 76360389, "body": "Hi Tim, it&#39;s a workbook not an add in so cannot just disable it unfortunately."}, {"owner": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "edited": false, "score": 0, "creation_date": 1498091400, "post_id": 44687837, "comment_id": 76360421, "body": "Hi Micky, because all of the company laptops have set policies on their computer which are company specific. So checking a couple of policies ensures it&#39;s a company laptop."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1498093060, "post_id": 44687837, "comment_id": 76360735, "body": "@JosephSargeant - Use the <code>@</code> notation when responding to someone then they get a notification and it makes the comments easier to follow."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1498093138, "post_id": 44687837, "comment_id": 76360755, "body": "@JosephSargeant - Does this help? <a href=\"https://support.office.com/en-us/article/Information-Rights-Management-in-Office-2010-c7a70797-6b1e-493f-acf7-92a39b85e30c\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1498093213, "post_id": 44687837, "comment_id": 76360776, "body": "@JosephSargeant - Or this? <a href=\"https://support.office.com/en-US/article/Activate-Rights-Management-RMS-in-the-Office-365-admin-center-5b6d3ac7-b1ac-428e-b03e-50e882f85a6e\" rel=\"nofollow noreferrer\">support.office.com/en-US/article/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498093896, "post_id": 44687837, "comment_id": 76360947, "body": "<i>So checking a couple of policies ensures it&#39;s a company laptop</i> - nope."}, {"owner": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1498113030, "post_id": 44687837, "comment_id": 76366789, "body": "@enigmativity thank you for the suggestions I will have a look into them. Thanks again"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "edited": false, "score": 0, "creation_date": 1498091566, "post_id": 44688209, "comment_id": 76360457, "body": "Hi Thunder, yes I know that and I know it will never be 100% secure but just wanted to make it as secure as I could. If my original question isn&#39;t possible then that&#39;s ok."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "edited": false, "score": 2, "creation_date": 1498093820, "post_id": 44688209, "comment_id": 76360932, "body": "@JosephSargeant Someone that&#39;s not supposed to have the file, that has the file, <b>will</b> be able to read its contents, regardless of what pseudo-security annoyances you put in... especially if that &quot;security&quot; is implemented with VBA code, which doesn&#39;t even run if macros are disabled... and Excel disables macros by default on any workbook that came from an email, thwarting anything you might have done in VBA to &quot;secure&quot; your workbook. Delete that code, it&#39;s useless."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1498091215, "creation_date": 1498091215, "answer_id": 44688209, "question_id": 44687837, "link": "https://stackoverflow.com/questions/44687837/enabling-events-c-vsto-workbook/44688209#44688209", "title": "Enabling events C# VSTO Workbook", "body": "<p>Excel workbooks are not secure. Period.</p>\n\n<p>Embedded code can always be viewed, changed, removed and/or disabled.</p>\n\n<p>The data can be typically be accessed without even opening Excel.</p>\n"}], "owner": {"reputation": 1, "user_id": 8196901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cd0d4e410e0427e1fca6ae596b500?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Sargeant", "link": "https://stackoverflow.com/users/8196901/joseph-sargeant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1498091215, "creation_date": 1498088334, "last_edit_date": 1498089126, "question_id": 44687837, "link": "https://stackoverflow.com/questions/44687837/enabling-events-c-vsto-workbook", "title": "Enabling events C# VSTO Workbook", "body": "<p>I have a VSTO workbook. I have a set of security measures that check the users credentials when opening the file (checks e-mail account exchange and other company security policies) which ensures that only someone within the company can open the file.</p>\n\n<p>I do this in the startup property; however, I know a simple way to get round this is to simply have another workbook open and set <code>enableevents</code> to <code>false</code> in VBA. This will stop the security check from firing. </p>\n\n<p>Is there a way to always ensure that events are active?</p>\n\n<p>I have tried checking if the events are turned on but I cannot get it to work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1498087910, "post_id": 44687742, "comment_id": 76359594, "body": "When you click on where &quot;k12&quot; is, what is the cell name in the top left hand corner? My guess is that it&#39;s not actually k12 anymore after the merge."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498122168, "post_id": 44687742, "comment_id": 76372790, "body": "@dwirony That goes off in a completely wrong direction and I don&#39;t understand how people can push the &quot;useful&quot; button for this. The reason the code does not run is the <code>Selection.count</code>, which is greater than 1 on a merged cell."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1498090577, "creation_date": 1498090577, "answer_id": 44688126, "question_id": 44687742, "link": "https://stackoverflow.com/questions/44687742/exel-how-to-run-a-macro-from-a-merged-cell/44688126#44688126", "title": "Exel How to run a Macro from a MERGED cell", "body": "<p><code>Selection.count</code> will return a count of all the cells in the merged cell, so it will be greater than 1 for a merged cell. Remove that count condition and the code will run fine. </p>\n\n<p>Merged cells cause all kinds of headaches and should be avoided. If the cells are merged across several columns, consider using the formatting setting \"center across selection\" instead. </p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1498100210, "creation_date": 1498100210, "answer_id": 44689392, "question_id": 44687742, "link": "https://stackoverflow.com/questions/44687742/exel-how-to-run-a-macro-from-a-merged-cell/44689392#44689392", "title": "Exel How to run a Macro from a MERGED cell", "body": "<p>Or you can simply try this...</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Cells(1).Address(0, 0) = \"K12\" Then\n    Call SHOWCALENDAR\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8196886, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206261815495066/picture?type=large", "display_name": "Joan Mendoza", "link": "https://stackoverflow.com/users/8196886/joan-mendoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498115025, "creation_date": 1498087681, "last_edit_date": 1498115025, "question_id": 44687742, "link": "https://stackoverflow.com/questions/44687742/exel-how-to-run-a-macro-from-a-merged-cell", "title": "Exel How to run a Macro from a MERGED cell", "body": "<p>I have a macro that displays a calendar when a cell is clicked. My problem is that I can't run the same macro when this cell is merged with other one. I tried makinkg the selection individual for each cell or making a range of cells. Neither of the two options worked. </p>\n\n<p>My question is how to code merged cells in vba in order to run a macro. \nMy code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Selection.Count = 1 Then\n        If Not Intersect(Target, Range(\"K12\")) Is Nothing Then\n            Call SHOWCALENDAR\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 67098, "user_id": 1235698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90fd9ad4efef8eb93209f42183c48f3e?s=128&d=identicon&r=PG", "display_name": "Marcin Orlowski", "link": "https://stackoverflow.com/users/1235698/marcin-orlowski"}, "edited": false, "score": 0, "creation_date": 1498084511, "post_id": 44687257, "comment_id": 76358636, "body": "I suggest you read <b><a href=\"https://stackoverflow.com/help/on-topic\">what topics you can ask about here</a></b> and <b><a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">how to ask perfect question</a></b> and then edit your question accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 756, "user_id": 6549541, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YsVtB.jpg?s=128&g=1", "display_name": "atclaus", "link": "https://stackoverflow.com/users/6549541/atclaus"}, "is_accepted": true, "score": 1, "last_activity_date": 1498086153, "creation_date": 1498086153, "answer_id": 44687535, "question_id": 44687257, "link": "https://stackoverflow.com/questions/44687257/hide-all-duplicate-columns-in-excel/44687535#44687535", "title": "hide all duplicate columns in excel", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\nDim last_col, col, a As Integer\nDim unique_materials(100), material As String\n\n\nSub show_all_columns()\n    last_col = Range(\"XFD8\").End(xlToLeft).Column\n    For col = 1 To last_col\n        Columns(col).Hidden = False\n    Next col\nEnd Sub\n\nSub hide_duplicates()\n    Erase unique_materials\n    last_col = Range(\"A8\").End(xlToRight).Column\n    a = 0\n    For col = 1 To last_col\n        material = Cells(8, col)\n        If UBound(Filter(unique_materials, material)) &gt; -1 Then\n            Columns(col).Hidden = True\n        Else\n            unique_materials(a) = material\n            a = a + 1\n        End If\n    Next col\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 44687535, "answer_count": 1, "score": 0, "last_activity_date": 1498086153, "creation_date": 1498084194, "question_id": 44687257, "link": "https://stackoverflow.com/questions/44687257/hide-all-duplicate-columns-in-excel", "title": "hide all duplicate columns in excel", "body": "<p><strong>How can I hide all duplicate columns if text in row 8 is the same.</strong> </p>\n\n<p>I have a drop down of materials. Multiple columns with the same number are used for a BOM. Would like to show only unique values from row 8 with a macro but also have an unhide all columns with another macro.</p>\n\n<p>Im sure this is pretty simple but not sure where to start.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8196666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f92a1532962a4250092b0216cc1820?s=128&d=identicon&r=PG&f=1", "display_name": "hagamablabla", "link": "https://stackoverflow.com/users/8196666/hagamablabla"}, "edited": false, "score": 1, "creation_date": 1498084901, "post_id": 44687196, "comment_id": 76358746, "body": "Didn&#39;t know multi-line statements were possible in VBA. Thanks."}, {"owner": {"reputation": 75, "user_id": 8196666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f92a1532962a4250092b0216cc1820?s=128&d=identicon&r=PG&f=1", "display_name": "hagamablabla", "link": "https://stackoverflow.com/users/8196666/hagamablabla"}, "edited": false, "score": 0, "creation_date": 1498090146, "post_id": 44687196, "comment_id": 76360113, "body": "I&#39;m a new user, so my upvotes aren&#39;t visible yet. :/"}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 1, "last_activity_date": 1498083858, "creation_date": 1498083858, "answer_id": 44687196, "question_id": 44687113, "link": "https://stackoverflow.com/questions/44687113/application-vlookup-function-always-returns-n-a/44687196#44687196", "title": "Application.VLookup function always returns #N/A", "body": "<p>Combine the two approaches:</p>\n\n<pre><code>Range(\"H\" &amp; ind).FormulaR1C1 = _\n            &amp; \"=VLOOKUP(RC[-6],'[\" &amp; Workbooks(SHORTAGE_SBT)  _\n            &amp; \"]Sheet1'!R14C1:R2382C130, COLUMN(R[-3]C[122]), FALSE)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 8196666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f92a1532962a4250092b0216cc1820?s=128&d=identicon&r=PG&f=1", "display_name": "hagamablabla", "link": "https://stackoverflow.com/users/8196666/hagamablabla"}, "edited": false, "score": 1, "creation_date": 1498084862, "post_id": 44687224, "comment_id": 76358727, "body": "It&#39;s always the little things that screw you over. Thanks a bunch."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1498083963, "creation_date": 1498083963, "answer_id": 44687224, "question_id": 44687113, "link": "https://stackoverflow.com/questions/44687113/application-vlookup-function-always-returns-n-a/44687224#44687224", "title": "Application.VLookup function always returns #N/A", "body": "<blockquote>\n<pre><code>Application.VLookup(\"B\" &amp; ind, Workbooks(SHORTAGE_SBT).Sheets(1).Range(\"A14:DZ\" &amp; SBT_Last), Range(\"DZ1\").Column, False)\n</code></pre>\n</blockquote>\n\n<p><code>\"B\" &amp; ind</code> will be searched for \"literally\"; it will not be transformed into a range address because it is interpreted here by <em>VBA</em>, not by <em>Excel</em>. Try:</p>\n\n<pre><code>Application.VLookup(Range(\"B\" &amp; ind), Workbooks(SHORTAGE_SBT).Sheets(1).Range(\"A14:DZ\" &amp; SBT_Last),  Range(\"DZ1\").Column, False)\n'                   ^^^^^^^^^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8196666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f92a1532962a4250092b0216cc1820?s=128&d=identicon&r=PG&f=1", "display_name": "hagamablabla", "link": "https://stackoverflow.com/users/8196666/hagamablabla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 44687224, "answer_count": 2, "score": 2, "last_activity_date": 1498083963, "creation_date": 1498083307, "last_edit_date": 1531164843, "question_id": 44687113, "link": "https://stackoverflow.com/questions/44687113/application-vlookup-function-always-returns-n-a", "title": "Application.VLookup function always returns #N/A", "body": "<p>I am trying to use the Application.VLookup function in Visual Basic to find a value in a different workbook. However, whenever I use it, it always returns #N/A.</p>\n\n<p>This is the layout of my function. LastRow() just returns the row number of the last row. SHORTAGE_SBT is a variable containing the source workbook name. SBT_Last is the last row of SHORTAGE_SBT. The ID that I'm searching with in in the B column, hence why I use \"B\" &amp; ind to refer to it. </p>\n\n<pre><code>For ind = 4 To LastRow()\n    Range(\"H\" &amp; ind).Select\n    ActiveCell.Value = Application.VLookup(\"B\" &amp; ind, Workbooks(SHORTAGE_SBT).Sheets(1).Range(\"A14:DZ\" &amp; SBT_Last), Range(\"DZ1\").Column, False)\nNext\n</code></pre>\n\n<p>I have tried recording a macro for VLookup to see if it would help me understand the problem. The macro gave me this function, which worked but could not be used because it contains the hardcoded file name instead of using the variable.</p>\n\n<pre><code>Range(\"H\" &amp; ind).FormulaR1C1 = \"=VLOOKUP(RC[-6],'[filename.xls]Sheet1'!R14C1:R2382C130, COLUMN(R[-3]C[122]), FALSE)\"\n</code></pre>\n\n<p>I cannot see any significant difference between the way the macro lays out the arguments of the function as opposed to mine, other than using more direct references. I have tried using direct numbers in my code but doing so hasn't helped either.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1498085112, "creation_date": 1498085112, "answer_id": 44687388, "question_id": 44687107, "link": "https://stackoverflow.com/questions/44687107/excel-vba-moving-a-column-down/44687388#44687388", "title": "Excel VBA - Moving a column down", "body": "<p>Because you are cutting the last cell only, not the whole populated column. You can try this:</p>\n\n<pre><code>Range(\"I1:I\" &amp; Q).Cut Range(\"I\" &amp; O + 1)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8196655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/36c41d71429a84d1fc9d9a6a78d94023?s=128&d=identicon&r=PG&f=1", "display_name": "unclass123", "link": "https://stackoverflow.com/users/8196655/unclass123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 44687388, "answer_count": 1, "score": 1, "last_activity_date": 1498085112, "creation_date": 1498083268, "question_id": 44687107, "link": "https://stackoverflow.com/questions/44687107/excel-vba-moving-a-column-down", "title": "Excel VBA - Moving a column down", "body": "<p>I have a portion of my script that needs to move a column down, so that the start of the new column is at the end of the column next to it. For example, if column \"A\" is 229 Lines, Column \"B\" would start at line 230.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code> O = Range(\"H\" &amp; Rows.count).End(xlUp).Row\n Q = Range(\"I\" &amp; Rows.count).End(xlUp).Row\n\n Range(\"I\" &amp; Q).Cut Range(\"I\" &amp; O + 1)\n</code></pre>\n\n<p>Where O and Q are both longs. I have tested that O and Q are getting the correct number of lines. But when I try to move it down, it does not move anything. Does anyone know why this might be happening?</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1498086160, "creation_date": 1498086160, "answer_id": 44687536, "question_id": 44686968, "link": "https://stackoverflow.com/questions/44686968/rename-excel-worksheet-if-sheet-already-exist/44687536#44687536", "title": "Rename excel worksheet if sheet already exist", "body": "<p>Here's a quick sub you can modify to fit your needs:</p>\n\n<pre><code>Sub setSheets()\nDim ws As Worksheet, wsReport\nDim i As Long\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name Like \"Summary*\" Then\n        i = i + 1\n    End If\nNext ws\n\nSet wsReport = ThisWorkbook.Sheets.Add\nIf i &gt; 0 Then\n    wsReport.Name = \"Summary\" &amp; i + 1\nElse\n    wsReport.Name = \"Summary\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 300, "user_id": 3330347, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/82071575c13df623a9a722612c388cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/3330347/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 44687536, "answer_count": 1, "score": 0, "last_activity_date": 1498086160, "creation_date": 1498082484, "last_edit_date": 1531161705, "question_id": 44686968, "link": "https://stackoverflow.com/questions/44686968/rename-excel-worksheet-if-sheet-already-exist", "title": "Rename excel worksheet if sheet already exist", "body": "<p>In the code below, I am attempting to create a new sheet called \"Summary\".  However, if the \"Summary\" sheet already exists, I get an error.  How do I simply add a new sheet, called \"Summary X\" (where X is 1, or 2, or 3, or...), if a \"Summary\" sheet already exists.  That is, each time I run the code, a new \"Summary X\" sheet will be added with no errors.  In this case, if the code is run the second time, there will be a Summary and Summary 1 tab and so on....</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub SearchFolders()\n'UpdatebySUPERtoolsforExcel2016\n    Dim xFso As Object\n    Dim xFld As Object\n    Dim xStrSearch As String\n    Dim xStrPath As String\n    Dim xStrFile As String\n    Dim xOut As Worksheet\n    Dim xWb As Workbook\n    Dim xWk As Worksheet\n    Dim xRow As Long\n    Dim xFound As Range\n    Dim xStrAddress As String\n    Dim xFileDialog As FileDialog\n    Dim xUpdate As Boolean\n    Dim xCount As Long\n    On Error GoTo ErrHandler\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    xFileDialog.AllowMultiSelect = False\n    xFileDialog.Title = \"Select a forlder\"\n    If xFileDialog.Show = -1 Then\n        xStrPath = xFileDialog.SelectedItems(1)\n    End If\n    If xStrPath = \"\" Then Exit Sub\n    xStrSearch = \"failed\"\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  ' Create the report sheet at first position then name it \"Summary\"\n  Dim wsReport As Worksheet, rCellwsReport As Range\n  Set wsReport = ThisWorkbook.Sheets.Add(Before:=ThisWorkbook.Sheets(1))\n  wsReport.Name = \"Summary\"\n  Set rCellwsReport = wsReport.Cells(2, 2)\n  ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    xUpdate = Application.ScreenUpdating\n    Application.ScreenUpdating = False\n    Set xOut = wsReport\n    xRow = 1\n    With xOut\n        .Cells(xRow, 1) = \"Workbook\"\n        .Cells(xRow, 2) = \"Worksheet\"\n        .Cells(xRow, 3) = \"Cell\"\n        .Cells(xRow, 4) = \"Test\"\n        .Cells(xRow, 5) = \"Limit Low\"\n        .Cells(xRow, 6) = \"Limit High\"\n        .Cells(xRow, 7) = \"Measured\"\n        .Cells(xRow, 8) = \"Unit\"\n        .Cells(xRow, 9) = \"Status\"\n    End With\n\n    MsgBox xCount &amp; \"cells have been found\", , \"SUPERtools for Excel\"\nExitHandler:\n    Set xOut = Nothing\n    Set xWk = Nothing\n    Set xWb = Nothing\n    Set xFld = Nothing\n    Set xFso = Nothing\n    Application.ScreenUpdating = xUpdate\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description, vbExclamation\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 0, "last_activity_date": 1498081516, "last_edit_date": 1498081516, "creation_date": 1498081018, "answer_id": 44686677, "question_id": 44686651, "link": "https://stackoverflow.com/questions/44686651/can-a-called-sub-function-end-the-execution-of-the-caller-sub-function/44686677#44686677", "title": "Can a called Sub/Function end the execution of the caller Sub/Function?", "body": "<p>You can just use <code>End</code> to stop all VBA code running completely e.g.:</p>\n\n<pre><code>Sub B\n    If disastrousCalamity Then End\nExit Sub\n</code></pre>\n\n<p>The only other ways I can think are two that I use:</p>\n\n<p>1) You have a Public boolean e.g. <code>CancelBool</code> and set it to True when disaster strikes in B, then check this at your choke points in Sub A and exit A ... OR ...</p>\n\n<p>2) Sub B is actually converted to a Function that returns a boolean so</p>\n\n<pre><code>Function B() As Boolean\nIf disaster then\n    B = True\nElse\n    B = False\nEnd If\nEnd B\n</code></pre>\n\n<p>that way, when you call B from A you can use it like this: <code>If B = True Then Exit Sub</code> and A will cease also?!</p>\n"}, {"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1498081872, "creation_date": 1498081872, "answer_id": 44686847, "question_id": 44686651, "link": "https://stackoverflow.com/questions/44686651/can-a-called-sub-function-end-the-execution-of-the-caller-sub-function/44686847#44686847", "title": "Can a called Sub/Function end the execution of the caller Sub/Function?", "body": "<pre><code>Global SubBReturnedError As Boolean\n\nSub A\n    ' Some code\n    Call B\n    If SubBReturnedError = True Then End Sub\n    ' Some code that may or may not get executed\nEnd Sub\n\nSub B\n    ' Some code\n    ' Fudge happened\n    If someError = True Then SubBReturnedError = True\n    If SubBReturnedError = True Then End Sub\n    ' Some code that won't get executed\nEnd Sub\n</code></pre>\n\n<p>Personally I favor this solution over just <code>End</code>-ing it all, simply because it leaves you with more easily accessible options for when you almost inevitably go back to add to or refine the code.</p>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 44686677, "answer_count": 2, "score": 0, "last_activity_date": 1498081872, "creation_date": 1498080923, "last_edit_date": 1531164843, "question_id": 44686651, "link": "https://stackoverflow.com/questions/44686651/can-a-called-sub-function-end-the-execution-of-the-caller-sub-function", "title": "Can a called Sub/Function end the execution of the caller Sub/Function?", "body": "<p>I have a <code>Sub A</code> that at some point calls a <code>Sub B</code>:</p>\n\n<pre><code>Sub A()\n    ...\n    B\n    ...\nEnd Sub\n\nSub B()\n    ...\nEnd Sub\n</code></pre>\n\n<p>Is there any way I say to the Sub <code>B</code> (given some conditions) to terminate the execution entirely? \nIf I would say something like <code>If True Then Exit Sub</code>, the <code>Sub B</code> would terminate but would passed the thread back to the <code>Sub A</code>. What I want, instead, is to figure out how (if possible) completely end the execution thread.</p>\n\n<p><strong>BACKGROUND</strong></p>\n\n<p><code>Sub B</code> is supposed to be general method that raises an exception and then terminates the execution, to be used for all the too-complex cases where it's more worth the user provides the proper inputs instead of writing tons of lines of code to handle that kind of exception.  </p>\n"}, {"tags": ["excel", "events", "right-click", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1498080777, "creation_date": 1498080777, "answer_id": 44686622, "question_id": 44686530, "link": "https://stackoverflow.com/questions/44686530/right-click-event-error/44686622#44686622", "title": "Right Click event error", "body": "<p>The error message is pretty clear. Your event handler's prototype does not equal what Excel wants it to be. change it into:</p>\n\n<pre><code>Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)\n</code></pre>\n\n<p>You cannot change the signature of event handlers.</p>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 44686622, "answer_count": 1, "score": 1, "last_activity_date": 1498080777, "creation_date": 1498080303, "last_edit_date": 1531164843, "question_id": 44686530, "link": "https://stackoverflow.com/questions/44686530/right-click-event-error", "title": "Right Click event error", "body": "<p>The right click event I have created displays an error message \"Procedure declaration does not match description of event or procedure having the same name\".</p>\n\n<p>My goal is to right click on a cell and have the count of a column from another sheet input into the target cell.</p>\n\n<p>What is my error that I am missing?</p>\n\n<pre><code>Sub Worksheet_BeforeRightClick(ByVal Target As Range)\nDim wb As Workbook\nDim i As Long\n\nSet wb = Workbooks(\"Calc.xlsm\")\n\nEventState = Application.EnableEvents\nApplication.EnableEvents = True\n\nTarget.Address = Application.count(wb.Sheets(\"Carrier\").Range(\"O:O\"))\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498091882, "post_id": 44686444, "comment_id": 76360510, "body": "Nothing like this ?: <a href=\"https://www.extendoffice.com/documents/excel/2403-excel-change-default-template.html#sheet\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498091970, "post_id": 44686444, "comment_id": 76360528, "body": "It would help if you could share a workbook which replicates the problem (just needs the code above and some dummy data)"}, {"owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498148492, "post_id": 44686444, "comment_id": 76392376, "body": "Thanks for this. I got home from work, plopped the workbook onto my personal computer, and kicked off the macro, and it still works like a charm. So that means something happened in my companies network 2 days ago that gimped VBA. Your link gives me a first lead to try to trace down what is causing the problem."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "edited": false, "score": 0, "creation_date": 1498080332, "post_id": 44686494, "comment_id": 76357109, "body": "While you arent wrong, I dont understand how a paste values of an empty cell is introducing a null. Isn&#39;t one of the purposes of Paste Values to not do that? Also, I cannot for the life of me figure out what I could have done to take it from working fine 2 days ago to not working now on a copy of the file that I&#39;m pulling from an email and was working when I sent it. Really trying to find a way to not need to functionally rewrite it all to factor for this error out of nowhere."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "edited": false, "score": 0, "creation_date": 1498081131, "post_id": 44686494, "comment_id": 76357408, "body": "If there is &quot;something&quot; in your sheet that causes this, there is a risk that you&#39;ll copy that something if you create a copy of your workbook. If you instead recreate your workbook by copying chunks it might work. Also, you mention &quot;introducing a null&quot; in your reply, but I can see anything related to that in your original question"}, {"owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "edited": false, "score": 0, "creation_date": 1498081500, "post_id": 44686494, "comment_id": 76357556, "body": "Either an Excel update came out and changed something, or im just going insane. I didnt say &quot;Introducing a null&quot;, but what else has a len of 0, identifies as &quot;&quot;, and has a CountA return of 1?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "edited": false, "score": 0, "creation_date": 1498081968, "post_id": 44686494, "comment_id": 76357736, "body": "I read you. One last idea. Select all data to the right of your dataset and remove all formatting. Then do the same for all data below your dataset and do the same."}, {"owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "edited": false, "score": 0, "creation_date": 1498082437, "post_id": 44686494, "comment_id": 76357927, "body": "Just commented out what is before the insert command, deleted the entire columns and the entire rows to the right of and below AA3086, ran the insert, same error. This makes no sense to me."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1498080109, "creation_date": 1498080109, "answer_id": 44686494, "question_id": 44686444, "link": "https://stackoverflow.com/questions/44686444/vba-spontaneous-excel-cant-insert-new-cells-error/44686494#44686494", "title": "VBA - spontaneous &#39;Excel cant insert new cells&#39; error", "body": "<p>I think the error message means exactly what it says. As long as your macro inserts rows, it'll trigger that message.  If you try it on a brand new sheet, it won't give you any problems, will it?</p>\n"}], "owner": {"reputation": 5, "user_id": 7263754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74b4cd3a84d5d674b0d9f8cb98301a01?s=128&d=identicon&r=PG&f=1", "display_name": "Veebeah", "link": "https://stackoverflow.com/users/7263754/veebeah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 933, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498080109, "creation_date": 1498079884, "last_edit_date": 1531164843, "question_id": 44686444, "link": "https://stackoverflow.com/questions/44686444/vba-spontaneous-excel-cant-insert-new-cells-error", "title": "VBA - spontaneous &#39;Excel cant insert new cells&#39; error", "body": "<p>I have been working on a very large macro.</p>\n\n<p>I put the project down for 2 days to work on other things.</p>\n\n<p>I picked it back up, and now I get a 1004 runtime error:</p>\n\n<blockquote>\n  <p>Microsoft Excel can't insert new cells because it would push non-empty\n  cells off the end of the worksheet. These cells might appear empty but\n  have blank values, some formatting, or a formula. Delete enough rows\n  or columns to make room for what you want to insert and try again.</p>\n</blockquote>\n\n<p>The error presents here in the code:</p>\n\n<pre><code>    Sub Initial_Setup()\n\n    'Create Transform Tab\n\n        Sheets.Add Before:=Worksheets(\"Lists\")\n        ActiveSheet.Name = \"Transform\"\n\n    'Copy Raw Data Over\n\n        Sheets(\"Sitedata\").Select\n        Cells.Select\n        Selection.Copy\n        Sheets(\"Transform\").Select\n        Range(\"A1\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n\n    Columns(\"A\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>Ive researched this and causes range from hidden characters to autofills to freeze panes any more.</p>\n\n<p>Here is the kicker, this isn't the only place im now getting this error. It doesn't matter the method of moving the data. Paste Special, VBA treats all pasted cells as non-empty cells. Range(\"A1\").Value = Range(\"A1\").Value, VBA treats all pasted cells as non-empty cells.</p>\n\n<p>If I do a =Len() test, its 0 characters. If I do a =IF(a1=\"\",\"x\",\"\") test its \"x\". If I do =CountA(), I get a 1. Ctrl+end takes me to AA3086, the end of the actual dataset and not by far the furthest column to the right.</p>\n\n<p>The workaround is to try to change \"Cells.Select\" to a more targeted reference, but that will be the start of a ton of patching in different places.</p>\n\n<p>Has anyone else experienced something like this, or have they been experiencing it in the past couple days?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498079684, "post_id": 44686371, "comment_id": 76356840, "body": "<code>columns(index) &amp; counter + 11</code> is not producing the xlA1 style of range address (e.g. A5:A627) that you think it is."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498080403, "post_id": 44686371, "comment_id": 76357141, "body": "Where did you copy and paste it from? Are the originaldata workbooks set? Same sheet names? The error is a type mismatch so it looks like it can&#39;t 1) get a value from <code>originaldata.worksheets(&quot;Top Visitors&quot;).Range(columns(index) &amp; counter + 11)</code> (Is the &quot;columns&quot; array set publicly where you pasted it... either that or it can&#39;t fathom originaldata.Worksheets(&quot;Daily Visitors&quot;).Range(&quot;A5:A627&quot;)`"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498080525, "post_id": 44686371, "comment_id": 76357181, "body": "I don&#39;t know what Jeeped means either, looks fine to me, I take it you&#39;re looping with <code>index</code> and <code>counter</code> these values change one by one to give you a single cell range and therefore the value"}, {"owner": {"reputation": 305, "user_id": 6317652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036004296437081/picture?type=large", "display_name": "PedroMVM", "link": "https://stackoverflow.com/users/6317652/pedromvm"}, "edited": false, "score": 0, "creation_date": 1498080987, "post_id": 44686371, "comment_id": 76357358, "body": "As Jeeped wrote, <code>columns(index) &amp; counter + 11</code> is not giving an address like <code>A1</code>. Well, you wrote that <code>columns(index)</code> have string values, so I think you should convert the calculation to string before joining it to column variable. Try <code>columns(index) &amp; CStr(counter + 11)</code>, I think it will solve your problem."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498081184, "post_id": 44686371, "comment_id": 76357435, "body": "If <code>columns</code> is a local variable, it&#39;s hiding/shadowing the global-scope <code>Columns</code> member, which returns a <code>Range</code> object. This is making your code confusing. Consider making an <a href=\"https://stackoverflow.com/posts/44686371/edit\">edit</a> to include the declarations for all relevant variables. That said you very very very likely don&#39;t need that <code>columns</code> string array."}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1498083206, "post_id": 44687019, "comment_id": 76358218, "body": "<code>Excuse my sub-par hand-drawing skills:</code> just gonna leave this here... <a href=\"https://meta.stackexchange.com/questions/138031/is-there-a-joke-about-freehand-circles-that-im-oblivious-to/138032#138032\" title=\"is there a joke about freehand circles that im oblivious to\">meta.stackexchange.com/questions/138031/&hellip;</a>"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1498083499, "post_id": 44687019, "comment_id": 76358314, "body": "@MacroMan The meme wouldn&#39;t be funny if it weren&#39;t true, I suppose? ;)"}, {"owner": {"reputation": 3, "user_id": 8196544, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211525621115235/picture?type=large", "display_name": "Cindy Ni", "link": "https://stackoverflow.com/users/8196544/cindy-ni"}, "edited": false, "score": 0, "creation_date": 1498162981, "post_id": 44687019, "comment_id": 76400393, "body": "Thank you guys!! I was able to fix it."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 2, "last_activity_date": 1498082747, "creation_date": 1498082747, "answer_id": 44687019, "question_id": 44686371, "link": "https://stackoverflow.com/questions/44686371/type-mismatch-error-13-in-vba/44687019#44687019", "title": "Type mismatch error 13 in VBA", "body": "<p>If <code>Application.Match</code> doesn't find anything, <a href=\"https://stackoverflow.com/a/27302888/4604845\">it returns a <code>Variant/Error</code></a> to the caller - and you're trying to assign that error to an integer-only variable ==> type mismatch. Betting good money this is your problem since the code works occasionally.</p>\n\n<p>Excuse my sub-par hand-drawing skills:<a href=\"https://i.stack.imgur.com/AvQKc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AvQKc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Modify your code thusly:</p>\n\n<pre><code>If Not IsError(Application.Match(originaldata.Worksheets(\"Top Visitors Chart\").Range(columns(index) &amp; counter + 11), originaldata.Worksheets(\"Daily Visitors\").Range(\"A5:A627\"), 0)) Then &amp; _\n   positioninDailyVisitors = Application.Match(originaldata.Worksheets(\"Top Visitors Chart\").Range(columns(index) &amp; counter + 11), originaldata.Worksheets(\"Daily Visitors\").Range(\"A5:A627\"), 0)\n</code></pre>\n\n<p>Or perhaps more workable/readable:</p>\n\n<pre><code>Dim errVar As Variant\nerrVar = Application.Match(originaldata.Worksheets(\"Top Visitors Chart\").Range(columns(index) &amp; counter + 11), originaldata.Worksheets(\"Daily Visitors\").Range(\"A5:A627\"), 0)\nIf Not IsError(errVar) Then positioninDailyVisitors = CInt(errVar)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8196544, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211525621115235/picture?type=large", "display_name": "Cindy Ni", "link": "https://stackoverflow.com/users/8196544/cindy-ni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 44687019, "answer_count": 1, "score": 0, "last_activity_date": 1498082747, "creation_date": 1498079510, "last_edit_date": 1498081079, "question_id": 44686371, "link": "https://stackoverflow.com/questions/44686371/type-mismatch-error-13-in-vba", "title": "Type mismatch error 13 in VBA", "body": "<p>so I am writing code for a macro in VBA, and whenever I try to run it, I always get the same error on one line. What is strange about this is that the line works earlier in the program, but it stops working the second time I use it (I did not change any code; I literally copied and pasted it). This is the code: </p>\n\n<pre><code>positioninDailyVisitors = Application.Match(originaldata.Worksheets(\"Top Visitors Chart\").Range(columns(index) &amp; counter + 11), originaldata.Worksheets(\"Daily Visitors\").Range(\"A5:A627\"), 0)\n</code></pre>\n\n<p>A bit of background: <code>positioninDailyVisitors</code> is an integer variable, <code>columns(index)</code> is an array of type <code>String</code> that lists values like \"A\", \"B\", etc. Also, I already tried to use <code>Application.WorksheetFunction.Match</code> and it still does not work. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1498080294, "post_id": 44686325, "comment_id": 76357087, "body": "Thanks, that&#39;s what I needed. I was already using &quot;Option Private Module&quot;, but still not declaring the function as Public (so the other module wasn&#39;t seeing it and I thought it wasn&#39;t the solution)."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1498139713, "post_id": 44686325, "comment_id": 76385736, "body": "it also works if you make an optional argument to the macro. Wont appear in the macro list, but can launch it throuh vba, immediate window"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1498140057, "post_id": 44686325, "comment_id": 76386023, "body": "@PatrickLepelletier sure, except I&#39;d tend to remove a bogus unused parameter that&#39;s there just to do <code>Option Private Module</code>&#39;s job... as would probably be &quot;future self&quot; OP, or anyone inheriting that code ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 7, "last_activity_date": 1498079320, "creation_date": 1498079320, "answer_id": 44686325, "question_id": 44686224, "link": "https://stackoverflow.com/questions/44686224/declaring-a-sub-function-in-another-module-accessible-by-other-modules-but-not-b/44686325#44686325", "title": "Declaring a Sub/Function in another module accessible by other modules but not by user", "body": "<p>Specify <code>Option Private Module</code> at the top of <code>ModuleB</code>; public members won't be (visibly) exposed to the user, but will be readily available from anywhere inside the VBA project.</p>\n\n<p>Your <code>Private</code>+<code>Application.Run</code> hack is.. well, a hack. Don't do that - make/leave public members <code>Public</code>, and hide the module from the macros list with <code>Option Private Module</code>.</p>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 44686325, "answer_count": 1, "score": 2, "last_activity_date": 1498079320, "creation_date": 1498078933, "last_edit_date": 1531164843, "question_id": 44686224, "link": "https://stackoverflow.com/questions/44686224/declaring-a-sub-function-in-another-module-accessible-by-other-modules-but-not-b", "title": "Declaring a Sub/Function in another module accessible by other modules but not by user", "body": "<p>I have a module <code>ModuleA</code> containing a <code>Public</code> function that the user will use on the spreadsheet: </p>\n\n<pre><code>Public Function UserCanSeeThis() As String\n    UserCanSeeThis = \"Hello, \" &amp; UserCannotSeeThisButModuleACan() &amp; \" user\"\nEnd Function\n</code></pre>\n\n<p>I have a module <code>ModuleB</code> which contains a function that I want to use in <code>ModuleA</code>, but I don't want the user to see in the list of available functions when writing <code>=</code> into a cell or when reading the formulae dictionary: </p>\n\n<pre><code>Function UserCannotSeeThisButModuleACan() As String\n    UserCannotSeeThisButModuleACan = \"my dear\"\nEnd Function\n</code></pre>\n\n<p>How should I declare the function in <code>ModuleB</code> so that <code>ModuleA</code> can see it, but the user cannot? </p>\n\n<p><strong>p.s.</strong> I've searched the site and only found the \"solution\" for <code>Sub</code>, I can declare the <code>Sub</code> as <code>Private</code> and then call it from the other module with <code>Application.Run \"mySub\"</code>. \nBut I was hoping there was some more developed concept of \"friendship\" in VBA though. </p>\n"}, {"tags": ["vba", "excel", "runtime"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498078989, "post_id": 44686188, "comment_id": 76356532, "body": "Try simplifying the code to <code>Rows(&quot;5:5&quot;).Insert Shift:=xlDown</code> on one line instead of your two. You don&#39;t need to &quot;select&quot; a range and then apply the operation to the selection, you can just apply an operation to a range directly!"}, {"owner": {"reputation": 11, "user_id": 7969747, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212309137820837/picture?type=large", "display_name": "Junior Nunes", "link": "https://stackoverflow.com/users/7969747/junior-nunes"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498091804, "post_id": 44686188, "comment_id": 76360492, "body": "I mean, I would like to know if anyone else is having the same problem or if microsoft has released some correction.  It is absolutely impossible the code just stop working overnight :(  We have like more than 50 vba tools  that use the same code.."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498102436, "post_id": 44686188, "comment_id": 76362965, "body": "WIth 365 there were lots of updates that affect VBA. Where I work, there was an MS service for getting code inspected and rewrote to be compatible with 365. Most people used it. I guess you guys didn&#39;t..."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498105141, "post_id": 44686188, "comment_id": 76363630, "body": "Rows(5).Insert  is gerneral method."}, {"owner": {"reputation": 11, "user_id": 7969747, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212309137820837/picture?type=large", "display_name": "Junior Nunes", "link": "https://stackoverflow.com/users/7969747/junior-nunes"}, "edited": false, "score": 0, "creation_date": 1498145101, "post_id": 44686188, "comment_id": 76390061, "body": "I found the problem : Excel: Feature updates This channel release contains the following feature updates: \u2022\tRetain copy: Copy your cells, and before you paste, you can still do other tasks like typing or inserting cells."}], "owner": {"reputation": 11, "user_id": 7969747, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212309137820837/picture?type=large", "display_name": "Junior Nunes", "link": "https://stackoverflow.com/users/7969747/junior-nunes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501171439, "creation_date": 1498078814, "last_edit_date": 1531164843, "question_id": 44686188, "link": "https://stackoverflow.com/questions/44686188/run-time-error-1004-office-update", "title": "Run-time error &#39;1004&#39; - OFFICE UPDATE", "body": "<p>I updated my office 365 and I am trying to run the simple code below but Im getting an error:</p>\n\n<hr>\n\n<p>Rows(\"5:5\").Select</p>\n\n<p>Selection.Insert Shift:=xlDown</p>\n\n<hr>\n\n<p>Error message: </p>\n\n<p>Run-time error '1004' </p>\n\n<p>This selection isn't valid. Make sure the copy and paste areas don't overlap unless they are the same size and shape</p>\n\n<p>Surprisingly, if I record the same code and run the code is fine.</p>\n\n<p>Does anyone know how to fix it? </p>\n"}, {"tags": ["excel", "ms-word", "excel-2010", "excel-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1498077253, "creation_date": 1498077253, "answer_id": 44685796, "question_id": 44685641, "link": "https://stackoverflow.com/questions/44685641/delete-row-of-a-word-table-if-specific-value-exists-using-excel-vba/44685796#44685796", "title": "Delete Row of a Word Table if Specific Value Exists using Excel VBA", "body": "<p>You mean like this?</p>\n\n<pre><code>Set wdTable = wdDoc.Tables(1)\n\nFor i = wdTable.Rows.Count To 2 Step -1\n    If wdTable.Cell(i, 1).Range.Text = Chr(13) &amp; Chr(7) Then wdTable.Rows(i).Delete\nNext i\n</code></pre>\n\n<p><strong>Note</strong>: </p>\n\n<ol>\n<li>You have to loop through the rows in reverse</li>\n<li>Even when the cell looks empty it is not, it has <code>Chr(13) &amp; Chr(7)</code> and hence you cannot use <code>=\"\"</code></li>\n<li>You cannot use <code>.Cells</code>. It is <code>.Cell</code></li>\n<li>There is no property as <code>.Value</code>. It is <code>.Range.Text</code></li>\n</ol>\n\n<p><strong>Screenshot</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/tJ3OD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tJ3OD.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 93, "user_id": 8162415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CuogE.jpg?s=128&g=1", "display_name": "Jack Henderson", "link": "https://stackoverflow.com/users/8162415/jack-henderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1973, "favorite_count": 0, "accepted_answer_id": 44685796, "answer_count": 1, "score": 1, "last_activity_date": 1498077292, "creation_date": 1498076654, "last_edit_date": 1531161705, "question_id": 44685641, "link": "https://stackoverflow.com/questions/44685641/delete-row-of-a-word-table-if-specific-value-exists-using-excel-vba", "title": "Delete Row of a Word Table if Specific Value Exists using Excel VBA", "body": "<p>So I have a table on a word document and was wondering how I could rewrite this in order to delete the entire row of the table (the text existing in all the cells in the row as well as the existence of the row itself) if the value in the first column is an empty cell:</p>\n\n<pre><code>Set wdTable = wdDoc.Tables(1)\nWith wdTable.Cells(i,1)\n    For i = 2 To wdTable.Rows.Count\n        If .Value = \"\" Then\n           .EntireRow.Delete\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["html", "excel", "internet-explorer", "vba"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498076537, "post_id": 44685553, "comment_id": 76355326, "body": "It may be easier to see what is being sent as a package when you click on the button, e.g. a POST or a GET request. Instead of making an IE explorer instance you can just make a connection and send data without all the loading html elements and blah blah. Use F12 in IE to monitor your traffic and emulate it? It also means you don&#39;t have to do &quot;waiting&quot; cycles, requests get sent asynchronously and code carries on when you get a valid response."}, {"owner": {"reputation": 65, "user_id": 4761399, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53473bdbc239b59e4933931371c495d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn007", "link": "https://stackoverflow.com/users/4761399/shawn007"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498076867, "post_id": 44685553, "comment_id": 76355471, "body": "I got the button to work. I need to use the IE object for this due to Adobe PDF requirements. Do I have the incorrect ID for where I need to copy the info?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498077451, "post_id": 44685553, "comment_id": 76355733, "body": "It looks right, did you try the one above - displayTable"}, {"owner": {"reputation": 65, "user_id": 4761399, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53473bdbc239b59e4933931371c495d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn007", "link": "https://stackoverflow.com/users/4761399/shawn007"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498077747, "post_id": 44685553, "comment_id": 76355876, "body": "Just tried that still nothing. Think ID it wrong, am I using the operations correctly? I took out the s on getElement(s)"}, {"owner": {"reputation": 65, "user_id": 4761399, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53473bdbc239b59e4933931371c495d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn007", "link": "https://stackoverflow.com/users/4761399/shawn007"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498077927, "post_id": 44685553, "comment_id": 76355977, "body": "I think the issue is with the  Address.Value = AddressGrid line"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498078433, "post_id": 44685553, "comment_id": 76356246, "body": "I just got it working with <code>IE.Document.getElementById(&quot;sourceData&quot;).Value = AddressGrid</code> note taking out the &#39;s&#39; in Element(s) was correct, you just don&#39;t need to do <code>Set Address = </code> ... skip that and do it directly as above"}], "answers": [{"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498079486, "post_id": 44686114, "comment_id": 76356751, "body": "Try copying the range: <code>Range(&quot;A1:D4&quot;).Copy</code> and then instead of using <code>AddressGrid</code> you could now get the data straight from the clipboard into the &quot;sourceData&quot; element. I&#39;ll edit my answer. Please upvote if it helps!!"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1498079650, "last_edit_date": 1498079650, "creation_date": 1498078526, "answer_id": 44686114, "question_id": 44685553, "link": "https://stackoverflow.com/questions/44685553/navigating-in-ie-using-excel-vba-by-id/44686114#44686114", "title": "Navigating In IE Using Excel VBA By ID", "body": "<p>TO clarify, I got this working by changing the lines:</p>\n\n<pre><code>Set Address = IE.Document.getElementsByID(\"sourceData\")\nAddress.Value = AddressGrid\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>IE.Document.getElementByID(\"sourceData\").Value = AddressGrid\n</code></pre>\n\n<p>Now, since AddressGrid is only referring to one cell but you want a range, say \"A1:D4\" you could try this method:</p>\n\n<pre><code>Dim clipTXT As MSForms.DataObject\nRange(\"A1:D4\").Copy\n\nSet clipTXT = New MSForms.DataObject\n    clipTXT.GetFromClipboard\nIE.Document.getElementByID(\"sourceData\").Value = clipTXT.GetTxt\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4761399, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53473bdbc239b59e4933931371c495d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn007", "link": "https://stackoverflow.com/users/4761399/shawn007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 988, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498079650, "creation_date": 1498076338, "last_edit_date": 1531164843, "question_id": 44685553, "link": "https://stackoverflow.com/questions/44685553/navigating-in-ie-using-excel-vba-by-id", "title": "Navigating In IE Using Excel VBA By ID", "body": "<p>Problem: Attempting to copy/paste information from Excel into a webpage and then push button. Will eventually need to get this all the way to having it print a PDF into a folder. I attempted the code below, but am completely unsure why it is not working. Google didn't resolve.</p>\n\n<p>Website: <a href=\"https://www.easymapmaker.com/advanced\" rel=\"nofollow noreferrer\">https://www.easymapmaker.com/advanced</a></p>\n\n<p>Attempted Code:</p>\n\n<pre><code>    Sub MapMacro()\n\n    AddressGrid = Range(\"A1\").Value\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    WebSite = \"https://www.easymapmaker.com/advanced\"\n    With IE\n      .Visible = True\n      .navigate WebSite\n\n    Do While IE.Busy Or IE.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n    On Error Resume Next 'This is here in case fields cant be found.\n\n    Set Address = IE.Document.getElementsByID(\"sourceData\")\n    Address.Value = AddressGrid\n\n\n    Set Element = IE.Document.getElementsByID(\"optionButton\")\n    Element.Click\n\n    Do While IE.Busy Or IE.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n  End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498075410, "post_id": 44685180, "comment_id": 76354726, "body": "What is the exact range address?"}, {"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498075585, "post_id": 44685180, "comment_id": 76354814, "body": "in a particular row it has to go from column B to E in Sheets 2:5 and dump the summation in sheet1 . And the same has to be repeated for rows 2 to 5."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498075807, "post_id": 44685180, "comment_id": 76354947, "body": "So it is a 4 X 4"}, {"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498075903, "post_id": 44685180, "comment_id": 76355011, "body": "Yes.. It is a 4x4 table.. let me edit the comment"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498076409, "post_id": 44685180, "comment_id": 76355262, "body": "If all you are doing is a <code>Sum</code> have you considered just using a formula in Excel, e.g. <code>=SUM(Sheet2:Sheet5!E6)</code>?"}, {"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498078318, "post_id": 44685180, "comment_id": 76356190, "body": "@YowE3K: I need to do that for tens of sheets and hundreds of rows and columns.. hence the macro part.."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498102327, "post_id": 44685180, "comment_id": 76362945, "body": "@ArunKumarNarasimhan I was basing my suggestion on your code which is just writing to <b>one</b> sheet (and the now accepted answer, which is also only processing one sheet), and you mentioned 5 rows and 5 columns, so it seems it would be easy enough to just write the formula in cell Summation!E6 and copy it to the other 5 x 5 cells."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "edited": false, "score": 0, "creation_date": 1498076213, "post_id": 44685491, "comment_id": 76355168, "body": "I&#39;m checking if it solves my problem.. will get back to you in a bit.. thanks."}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1498076070, "creation_date": 1498076070, "answer_id": 44685491, "question_id": 44685180, "link": "https://stackoverflow.com/questions/44685180/loop-through-adding-values-in-a-range-5x5-for-example-of-row-and-columns-in-mu/44685491#44685491", "title": "loop through adding values in a range (5x5 for example) of row and columns in multiple sheets and dump in one particular sheet", "body": "<p>You can use Copy and Add technique, cycling through each sheet that isn't the summisary sheet and then pasting its values in to the final sheet (while adding them) - something like:</p>\n\n<pre><code>Dim b As Worksheet\nSet b = ThisWorkbook.Worksheets(\"Sheet4\")\n    b.range(\"A1:A2\").clear\n\nFor Each a In ThisWorkbook.Sheets\n    If Not a.Name = b.Name Then\n        a.Range(\"A1:A2\").Copy\n        b.Range(\"A1:A2\").PasteSpecial operation:=xlAdd\n    End If\nNext\n</code></pre>\n\n<p>Obviously your range can be defined in place of \"A1:A2\"</p>\n\n<p>I'm sure there's a more \"code\" way of adding arrays together but in Excel this might prove good for you.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "edited": false, "score": 0, "creation_date": 1498076511, "post_id": 44685557, "comment_id": 76355314, "body": "this is more like I what I was looking for. I will look into what the nested loop does and if it achieves the purpose.."}, {"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "edited": false, "score": 0, "creation_date": 1498079492, "post_id": 44685557, "comment_id": 76356753, "body": "I modified your code to run for my problem for a larger data.. These are the modifications I did.. It&#39;s giving an error 91.. @SiddharthRout"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "edited": false, "score": 0, "creation_date": 1498106500, "post_id": 44685557, "comment_id": 76364027, "body": "What modifications?"}, {"owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "edited": false, "score": 0, "creation_date": 1498838287, "post_id": 44685557, "comment_id": 76681826, "body": "I&#39;m sorry I was traveling on a business trip and couldn&#39;t put time on this. The sheet, row and column ranges are modified. Sheets go from 7 to Sheets.Count, Row goes from 6 to 80, column goes from 4 to 23. I still want the same sort of addition as you mentioned earlier but the data has to be dumped in sheet5.     For x = 7 To myTotal         If ws.Name &lt;&gt; wsSummation.Name Then             For i = startRow To endRow                 For j = StartCol To endCol                   ar(i, j) = ar(i, j) + ws.Cells(i, j) @SiddhartRout"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1498076763, "last_edit_date": 1498076763, "creation_date": 1498076349, "answer_id": 44685557, "question_id": 44685180, "link": "https://stackoverflow.com/questions/44685180/loop-through-adding-values-in-a-range-5x5-for-example-of-row-and-columns-in-mu/44685557#44685557", "title": "loop through adding values in a range (5x5 for example) of row and columns in multiple sheets and dump in one particular sheet", "body": "<p>Is this what you want?</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet, wsSumry As Worksheet\n    Dim startRow As Long, StartCol As Long\n    Dim i As Long, j As Long\n    Dim ar(1 To 4, 1 To 4) As Variant\n\n    '~~&gt; Start row and start column\n    startRow = 2: StartCol = 2\n\n    '~~&gt; Summary sheet\n    Set wsSumry = Sheet1\n\n    '~~&gt; Looping through each worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        '~~&gt; Check if it is not the summary sheet\n        If ws.Name &lt;&gt; wsSumry.Name Then\n            '~~&gt; Loop through the row and columns and\n            '~~&gt; Store it in an array\n            For i = startRow To (startRow + 3)\n                For j = StartCol To (StartCol + 3)\n                   ar(i - 1, j - 1) = ar(i - 1, j - 1) + ws.Cells(i, j)\n                Next j\n            Next i\n        End If\n    Next\n\n    '~~&gt; Write array to summary sheet\n    wsSumry.Range(\"B2\").Resize(UBound(ar), UBound(ar)).Value = ar\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshot</strong><a href=\"https://i.stack.imgur.com/owEqg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/owEqg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 8196281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098649fd9fc8038602caf7be0ad53663?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar Narasimhan", "link": "https://stackoverflow.com/users/8196281/arun-kumar-narasimhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44685557, "answer_count": 2, "score": 0, "last_activity_date": 1498076763, "creation_date": 1498074885, "last_edit_date": 1498074997, "question_id": 44685180, "link": "https://stackoverflow.com/questions/44685180/loop-through-adding-values-in-a-range-5x5-for-example-of-row-and-columns-in-mu", "title": "loop through adding values in a range (5x5 for example) of row and columns in multiple sheets and dump in one particular sheet", "body": "<p>I have multiple sheets in a single workbook with values in 5 rows and 5 columns in each sheet. I need to add the corresponding cell values (eg: D5) in each sheet and dump it in a new sheet in its D5. I could do it for one particular cell, but I'm confused on how to do it in nested for loops. I've only been doing vba for a day.. so please help. Thanks.</p>\n\n<pre><code>Sub Macro1()\n\n    Dim i, val\n    'Select worksheets\n    For i = 7 To Sheets.Count\n        val = val + Sheets(i).Range(\"e6\")\n    Next\n    Sheets(\"Summation\").Range(\"e6\") = val\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498074408, "post_id": 44685016, "comment_id": 76354173, "body": "Where is the rest of your code? I don&#39;t see where you define <code>ChngList</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1498074735, "post_id": 44685016, "comment_id": 76354355, "body": "Please see if <a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">this</a> answers your question"}, {"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498134785, "post_id": 44685016, "comment_id": 76381854, "body": "@dwirony Sorry, that is supposed to say <code>Set vtList</code> as it is shown in the last line of the code I posted."}, {"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1498136392, "post_id": 44685016, "comment_id": 76383046, "body": "@SiddharthRout this pointed me in the right direction. I will post the solution momentarily."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "is_accepted": false, "score": 1, "last_activity_date": 1498136651, "creation_date": 1498136651, "answer_id": 44700247, "question_id": 44685016, "link": "https://stackoverflow.com/questions/44685016/run-time-error-1004-application-defined-or-object-defined-error/44700247#44700247", "title": "Run-time Error: 1004 Application-defined or Object-defined error", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/users/1140579/siddharth-rout\">Siddharth Rout</a> for pointing my in the right direction for this one.</p>\n\n<p>The answer involves two issues that I was not noticing. The first is that the error was actually occurring at the <code>Set OrgList</code> line instead of the <code>Set vtList</code> line. The error was being caused because even though I referenced the correct sheet, without a <code>With</code> line, I have to reference that sheet at every point in that line. The corrected code is below:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationAutomatic\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\n\nDim c, OrgList, vtList, FndRng As Range\nDim Tbl As ListObject\nDim NewRow As ListRow\nDim Org, Track As Worksheet\n\nSet Org = ActiveWorkbook.Worksheets(\"Org List\")\nSet Track = ActiveWorkbook.Worksheets(\"Visit Tracking Sheet\")\nSet Tbl = Track.ListObjects(\"TrackTbl\")\nSet OrgList = Org.Range(Org.Cells(2, 1), Org.Cells(Org.UsedRange.Rows.Count, 1))\nSet vtList = Track.Range(\"TrackTbl[Org ID]\")\n</code></pre>\n\n<p>I could have used <code>With</code> to eliminate the need to reference the sheet for each Range.Cells in the line, but it would have been the same amount of code and the sheet name is short. Either way should work for anyone running into this problem.</p>\n"}], "owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498136651, "creation_date": 1498074250, "question_id": 44685016, "link": "https://stackoverflow.com/questions/44685016/run-time-error-1004-application-defined-or-object-defined-error", "title": "Run-time Error: 1004 Application-defined or Object-defined error", "body": "<p>I'm getting a run-time error when I run the following code:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationAutomatic\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\n\nDim c, OrgList, vtList, FndRng As Range\nDim Tbl As ListObject\nDim NewRow As ListRow\nDim Org, Track As Worksheet\n\nSet Org = ActiveWorkbook.Worksheets(\"Org List\")\nSet Track = ActiveWorkbook.Worksheets(\"Visit Tracking Sheet\")\nSet Tbl = Track.ListObjects(\"TrackTbl\")\nSet OrgList = Org.Range(Cells(2, 1), Cells(Org.UsedRange.Rows.Count, 1))\nSet vtList = Track.Range(\"TrackTbl[Org ID]\")\n</code></pre>\n\n<p>Everything runs fine until I get to <code>Set ChngList = Track.Range(\"TrackTbl[Org ID]\")</code> which throws the <code>Run-time Error: 1004</code>. I have tried also the following replacement lines, all of which throw the same error:</p>\n\n<ul>\n<li><code>Set vtList = Tbl.Range(Cells(2, 1), Cells(ListRows.Count, 1))</code></li>\n<li><code>Set vtList = Track.Range(Cells(2, 1), Cells(Track.UsedRange.Rows.Count, 1))</code></li>\n<li><code>Set vtList = Track.Tbl.Range(Cells(2, 1), Cells(ListRows.Count, 1))</code></li>\n<li><code>Set vtList = Tbl.Range</code></li>\n</ul>\n\n<p>I'm at a loss on this one and have had trouble finding a solution for this. I assume it is an issue with setting the Range referencing cells in a Table but am not sure.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498508597, "post_id": 44684892, "comment_id": 76517165, "body": "Please let me know if you need any extra information or details, I tried to give a minimum viable example, and then the code I have currently in its most simple form."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1498508738, "post_id": 44684892, "comment_id": 76517228, "body": "Which part isn&#39;t working?"}, {"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "edited": false, "score": 1, "creation_date": 1498509837, "post_id": 44684892, "comment_id": 76517783, "body": "In VBA, string plus number, such as <code>myCell.Text = &quot;Thing #&quot; + t</code>, will try to make the string into a number, and then do number plus number. Hence, <code>&quot;Thing #&quot; + t</code> will result in &#39;type mismatch&#39; error. Do instead: <code>myCell.Text = &quot;Thing #&quot; &amp; t</code>  (i.e. use ampersand)."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1498511414, "post_id": 44684892, "comment_id": 76518504, "body": "I agree with rskar and also believe these lines may also be slightly off:  <code>Set myCell = .Tables(t).Cell(1,1).Range             myCell.Text = &quot;Thing #&quot; + t</code>  Probably should be:  <code>Set myCell = .Tables(t).Cell(1,1)             myCell.Range.Text = &quot;Thing #&quot; &amp; t</code>  <code>myCell</code> should also be declared as a range"}, {"owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498511933, "post_id": 44684892, "comment_id": 76518699, "body": "How can I get the table of tables to work on only those tables below my cursor, and insert the table at my cursor? (I&#39;ve tried googling, not much to be found. I suspect I&#39;m not using the right language in my question)"}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1498513231, "post_id": 44684892, "comment_id": 76519184, "body": "<code>dim tbl as Table: for each tbl in myRange.Tables: &#39;do stuff with the table: Next tbl</code>.  Or something like that?"}, {"owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498515177, "post_id": 44684892, "comment_id": 76519850, "body": "Well, it seems there is enough info here to reward the bounty - but nobody has posted an answer - just comments.   So, I guess the first person to put it all together into a working solution gets it. I&#39;d do it - I have enough info to now - but, well, Credit where credit is due - right?"}], "answers": [{"tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": false, "score": 1, "last_activity_date": 1498518568, "creation_date": 1498518568, "answer_id": 44769943, "question_id": 44684892, "link": "https://stackoverflow.com/questions/44684892/word-vba-macro-to-change-cells-in-selection-and-create-a-summary-table-of-the/44769943#44769943", "title": "Word VBA: Macro to change cells in selection, and create a summary table of the tables?", "body": "<p>Here's a solution based on the comments.  It's just based on reading your code without testing so hopefully this works.  If it needs some tweaks, please feel free to edit.</p>\n\n<pre><code>Sub NumberTablesSelection()\n    Dim t As Integer\n\n    Dim myRange as Range\n    Set myRange = Selection.Range\n\n    With myRange\n        For t = 1 To .Tables.Count\n            Set myCell = .Tables(t).Cell(1,1)\n            myCell.Range.Text = \"Thing #\" &amp; t\n            Next t\n        End With\nEnd Sub\n</code></pre>\n\n<p>Table of Tables (with info):</p>\n\n<pre><code>Sub TableOfThings()\n    Dim t As Integer\n    Dim tbl as Table\n    Dim myRange as Range\n    Set myRange = Selection.Range\n\n    myTable = Tables.Add(Range:=tableLocation, NumRows:=1, NumColumns:=4)\n    myTable.Cell(1,1).Range.Text = \"Number\"\n    myTable.Cell(1,2).Range.Text = \"Title\"\n    myTable.Cell(1,3).Range.Text = \"Score\"\n    myTable.Cell(1,4).Range.Text = \"Instances\"\n\n    t = 1\n    For each tbl in myRange.Tables\n        With tbl\n            Set Title = .Cell(1,2).Range \n            Set Instances = .Cell(2,2).Range\n            Set Score = .Cell(3,2).Range\n        End With\n\n       Set NewRow = myTable.Rows.Add\n       With NewRow\n           .Cells(1).Range.Text = t\n           .Cells(2).Range.Text = Title\n           .Cells(3).Range.Text = Score\n           .Cells(4).Range.Text = Instances\n      End With\n      t = t + 1\n    Next tbl\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498608833, "post_id": 44791762, "comment_id": 76564335, "body": "The only thing I haven&#39;t quiet figured out is how to have score be the number of values in the table, and not just the values themselves."}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "reply_to_user": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498609704, "post_id": 44791762, "comment_id": 76564499, "body": "Can u give an example like what&#39;s the score in table 1, and table 2 is, and how it should be displayed in the summary?"}, {"owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498609809, "post_id": 44791762, "comment_id": 76564527, "body": "the example is in the question, a simple CSV list. If the cell contains A, B, C, you can see in the question in the summary I have 3. As in, 3 values."}, {"owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498609858, "post_id": 44791762, "comment_id": 76564537, "body": "I also misspoke, I meant the info cell, and not the score. In the code I have it as instances"}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "reply_to_user": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "edited": false, "score": 0, "creation_date": 1498613670, "post_id": 44791762, "comment_id": 76565414, "body": "this can be attained by the Split function. i have updated the code accordingly"}], "tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": true, "score": 4, "last_activity_date": 1498614049, "last_edit_date": 1498614049, "creation_date": 1498608283, "answer_id": 44791762, "question_id": 44684892, "link": "https://stackoverflow.com/questions/44684892/word-vba-macro-to-change-cells-in-selection-and-create-a-summary-table-of-the/44791762#44791762", "title": "Word VBA: Macro to change cells in selection, and create a summary table of the tables?", "body": "<p>We need to consider the following aspects for the macro to function as desired:</p>\n\n<ul>\n<li>A button or other object can\u2019t be used to invoke the macro, as that\u2019ll effectively change the selection. Instead, it can be run by either <kbd>Alt + F8</kbd> or a short cut key assigned to the macro</li>\n<li>The selection must be continuous. So, if there are 4 tables, selection of just table# 1, &amp; 3 won\u2019t work. It should rather be like table# 1 to 3.</li>\n</ul>\n\n<p>With that and a few minor tweaks, the modified code as reproduced below should work.</p>\n\n<pre><code>Option Explicit\nSub NumberTablesSelection()\n    Dim t As Integer, myRange, myCell As Range\n    Set myRange = Selection.Range\n    With myRange\n        For t = 1 To .Tables.Count\n            Set myCell = .Tables(t).Cell(1, 1).Range\n            myCell.Text = \"Thing #\" &amp; t\n        Next t\n    End With\nEnd Sub\nSub TableOfThings()\n    Dim t As Integer, myRange As Range, myTable As Table, NewRow As Row, Title As String, Instances As Integer, Score As String\n    Set myRange = Selection.Range\n    Selection.EndKey Unit:=wdStory\n    Set myTable = ActiveDocument.Tables.Add(Range:=Selection.Range, NumRows:=1, NumColumns:=4)\n    With myTable\n        .Style = \"Table Grid\"\n        .Rows(1).Shading.BackgroundPatternColor = -603917569\n        .Cell(1, 1).Range.Text = \"Number\"\n        .Cell(1, 2).Range.Text = \"Title\"\n        .Cell(1, 3).Range.Text = \"Score\"\n        .Cell(1, 4).Range.Text = \"Instances\"\n    End With\n    With myRange\n        For t = 1 To .Tables.Count\n            Title = .Tables(t).Cell(1, 2).Range\n            Instances = UBound(Split(.Tables(t).Cell(2, 2).Range, \",\")) + 1\n            Score = .Tables(t).Cell(3, 2).Range\n            Set NewRow = myTable.Rows.Add\n            With NewRow\n                .Shading.BackgroundPatternColor = wdColorAutomatic\n                .Cells(1).Range.Text = t\n                .Cells(2).Range.Text = txtClean(Title)\n                .Cells(3).Range.Text = txtClean(Score)\n                .Cells(4).Range.Text = Instances\n            End With\n        Next t\n    End With\nEnd Sub\nFunction txtClean(txt As String) As String\n    txt = Replace(txt, Chr(7), \"\")\n    txt = Replace(txt, Chr(13), \"\")\n    txt = Replace(txt, Chr(11), \"\")\n    txtClean = txt\nEnd Function\n</code></pre>\n\n<p>Edit: the result for column <code>Instances</code> has been changed to \"number of instances\", rather than displaying the original values.</p>\n"}], "owner": {"reputation": 467, "user_id": 2924526, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/14d532b1d62ddabc357af37f2c1b3cfe?s=128&d=identicon&r=PG", "display_name": "NictraSavios", "link": "https://stackoverflow.com/users/2924526/nictrasavios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2072, "favorite_count": 0, "accepted_answer_id": 44791762, "answer_count": 2, "score": 8, "last_activity_date": 1499062016, "creation_date": 1498073807, "last_edit_date": 1499062016, "question_id": 44684892, "link": "https://stackoverflow.com/questions/44684892/word-vba-macro-to-change-cells-in-selection-and-create-a-summary-table-of-the", "title": "Word VBA: Macro to change cells in selection, and create a summary table of the tables?", "body": "<p>I have a bunch of tables in a document that look roughly like this:</p>\n\n<pre><code>| Thing     |   Title   |\n|-----------|:---------:|\n| Info      | A, B, C.  |\n| Score     | Foo       |\n| More Info | Long Text |\n| Proof     | Blah      |\n\nFigure 1\n&lt;Screenshot of Proof&gt;\n</code></pre>\n\n<p>I'd like to make it look like this (Number in the upper left cell):</p>\n\n<pre><code>| Thing #1  |       Title       |\n|-----------|:-----------------:|\n| Info      | A, B, C.          |\n| Score     | Foo               |\n| More Info | Long Text         |\n| Proof     | Blah &lt;Screenshot&gt; |\n</code></pre>\n\n<p>But, the there are many tables in the document, and I'd only like to use the ones \"within selection\".</p>\n\n<p>In short: I have to take all tables within a selection and number them sequentially. \nI'd also like to make a table of these tables that looks like this:</p>\n\n<pre><code>| Number | Title | Score | Number of CSV's in Info |\n|--------|:-----:|-------|-------------------------|\n| 1      | Thing | Foo   | 3                       |\n| ...    | ...   | ...   | ...                     |\n| ...    | ...   | ...   | ...                     |\n| ...    | ...   | ...   | ...                     |    \n</code></pre>\n\n<p>Here is what I have so far:</p>\n\n<p>Numbering Tables:</p>\n\n<pre><code>Sub NumberTablesSelection()\n    Dim t As Integer\n\n    Dim myRange as Range\n    Set myRange = Selection.Range\n\n    With myRange\n        For t = 1 To .Tables.Count\n            Set myCell = .Tables(t).Cell(1,1).Range\n            myCell.Text = \"Thing #\" + t\n            Next t\n        End With\nEnd Sub\n</code></pre>\n\n<p>Table of Tables (with info):</p>\n\n<pre><code>Sub TableOfThings()\n    Dim t As Integer\n\n    Dim myRange as Range\n    Set myRange = Selection.Range\n\n    myTable = Tables.Add(Range:=tableLocation, NumRows:=1, NumColumns:=4)\n    myTable.Cell(1,1).Range.Text = \"Number\"\n    myTable.Cell(1,2).Range.Text = \"Title\"\n    myTable.Cell(1,3).Range.Text = \"Score\"\n    myTable.Cell(1,4).Range.Text = \"Instances\"\n\n    With myRange\n        For t = 1 To .Tables.Count\n\n            Set Title = .Tables(t).Cell(1,2).Range \n            Set Instances = .Tables(t).Cell(2,2).Range\n            Set Score = .Tables(t).Cell(3,2).Range\n\n            Set NewRow = myTable.Rows.Add\n            NewRow.Cells(1).Range.Text = t\n            NewRow.Cells(2).Range.Text = Title\n            NewRow.Cells(3).Range.Text = Score\n            NewRow.Cells(4).Range.Text = Instances\n        End With\nEnd Sub\n</code></pre>\n\n<p>But they flat out don't work the way I want them to, and I can't seem to manage to get them to work.</p>\n\n<p>Could someone provide me with a solution?</p>\n"}, {"tags": ["vba", "excel", "indexing", "match"], "comments": [{"owner": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 0, "creation_date": 1498074240, "post_id": 44684656, "comment_id": 76354090, "body": "Try this site and use the example as a model: <a href=\"https://www.deskbright.com/excel/using-index-match/\" rel=\"nofollow noreferrer\">deskbright.com/excel/using-index-match</a>"}, {"owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "reply_to_user": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 0, "creation_date": 1498074450, "post_id": 44684656, "comment_id": 76354203, "body": "I have the correct index/match formula in my excel, I was trying to put it into VBA so I that I can just add the macro to other workbooks rather than having to go through the process of copy/paste formatting etxc."}, {"owner": {"reputation": 679, "user_id": 7777877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24c242cbeb9a19b58d59d6a59a44bd15?s=128&d=identicon&r=PG&f=1", "display_name": "Jsleshem", "link": "https://stackoverflow.com/users/7777877/jsleshem"}, "edited": false, "score": 0, "creation_date": 1498074505, "post_id": 44684656, "comment_id": 76354234, "body": "Also, make sure your calculations are done in the code. Type <code>calculate</code> before <code>end sub</code> to make sure your workbooks calculate"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1498074752, "post_id": 44684656, "comment_id": 76354369, "body": "One issue is that you <code>MATCH()</code> on <code>DB_Cov</code> which is fixed going into your loop."}, {"owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "edited": false, "score": 0, "creation_date": 1498076027, "post_id": 44684656, "comment_id": 76355074, "body": "How would you make DB_Cov move after each calculation. I.e. for the output that is in O76 I want it based off L76 but for O77 I want L77"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498077881, "post_id": 44684656, "comment_id": 76355950, "body": "<code>DB_Cov</code> is a range of five cells. Which are you trying to match?"}, {"owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "edited": false, "score": 0, "creation_date": 1498078469, "post_id": 44684656, "comment_id": 76356268, "body": "In the Table below you will see what the output table looks like. Right now it calculates the Index Match only off of &quot;Total Leverage, which is correct for the first row but for the next row I want the index match to run off of FCCR. L76=Total Leverage and L77=FCCR                                                                                Covenants - Select\t\tCovenent \tCurrent\tPass Total Leverage\t\t 3.75 \t 3.15 \tY FCCR\t\t                 3.75 \t 1.84 \tN Max Capex\t\t         3.75 \t\t Min. EBITDA\t\t         3.75 \t\t Min. Liquidity\t\t         3.75"}, {"owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "edited": false, "score": 0, "creation_date": 1498078703, "post_id": 44684656, "comment_id": 76356395, "body": "Table didnt work....I want row 76 to match off L76 and row 77 to match of L77 ect ect, right now the index match is static and I want it to be dynamic"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1498084207, "post_id": 44684656, "comment_id": 76358554, "body": "<code>Match</code> doesn&#39;t do that in VBA, you&#39;ll have to code the loop yourself."}, {"owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "edited": false, "score": 0, "creation_date": 1498145563, "post_id": 44684656, "comment_id": 76390359, "body": "Got it. Thanks for everyone&#39;s help."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "is_accepted": false, "score": 0, "last_activity_date": 1498238418, "creation_date": 1498238418, "answer_id": 44726877, "question_id": 44684656, "link": "https://stackoverflow.com/questions/44684656/vba-index-match-does-not-loop-gives-same-answer/44726877#44726877", "title": "VBA Index Match Does not Loop, gives same answer", "body": "<p>I don't think I explained my question very well, but below is the answer. I needed to add an x variable to run the loop. There have been a few other additions but below should work to run a Index/match loop.</p>\n\n<pre><code>Sub Covenant()\n\nDim Covenant_1 As Integer\nDim Dashboard As Worksheet\nDim Covenant_Sheet As Worksheet\nDim Cov_Date As Range\nDim Cov_Dates As Range\nDim Cov_Type As Variant\nDim DB_Cov As Variant\nDim Cov_Type2 As Variant\nDim Cov_Next As Range\n\n\n\nSet Dashboard = Sheets(\"Dashboard\")\nSet Covenant_Sheet = Sheets(\"Covenants\")\nSet Cov_Date = Dashboard.Range(\"M74\")\nSet Cov_Dates = Covenant_Sheet.Range(\"B4:AB4\")\nSet Cov_Type = Covenant_Sheet.Range(\"B6:AB13\")\nSet DB_Cov = Dashboard.Range(\"K75\")\nSet Cov_Type2 = Covenant_Sheet.Range(\"B6:B13\")\nSet Cov_Next = Dashboard.Range(\"P74\")\n\nFor x = 1 To 5\n    For y = 1 To 5\nCells(x + 75, 13) = Application.IfError(Application.Index(Cov_Type, Application.Match(DB_Cov.Offset(x, 0), Cov_Type2, 0), Application.Match(Cov_Date, Cov_Dates, 0)), \"\")\n\n    Cells(y + 75, 16) = Application.IfError(Application.Index(Cov_Type, Application.Match(DB_Cov.Offset(y, 0), Cov_Type2, 0), Application.Match(Cov_Next, Cov_Dates, 0)), \"\")\n    Next y\nNext x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8196170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110b87824c1231d9eded065e2fd1835e?s=128&d=identicon&r=PG&f=1", "display_name": "kwmoore1218", "link": "https://stackoverflow.com/users/8196170/kwmoore1218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498238418, "creation_date": 1498073066, "question_id": 44684656, "link": "https://stackoverflow.com/questions/44684656/vba-index-match-does-not-loop-gives-same-answer", "title": "VBA Index Match Does not Loop, gives same answer", "body": "<p>I have an Index match Function that I am trying to save as VBA so that I can add it to multiple workbooks. The way I have it coded it keeps giving me the same answer and does not loop to the next cell to find a different keyword. I want it to look at what is in N76 and put answer in O76 which works but for N77 it gives me the same answer as O76, even though the keyword in N77 is different.</p>\n\n<p>Sub Covenant()</p>\n\n<pre><code>Dim Covenant_1 As Integer\nDim Dashboard As Worksheet\nDim Covenant_Sheet As Worksheet\nDim Cov_Date As Range\nDim Cov_Dates As Range\nDim Cov_Type As Variant\nDim DB_Cov As Variant\nDim Cov_Type2 As Variant\n\n\n\n\nSet Dashboard = Sheets(\"Dashboard\")\nSet Covenant_Sheet = Sheets(\"Covenants\")\nSet Cov_Date = Dashboard.Range(\"N74\")\nSet Cov_Dates = Covenant_Sheet.Range(\"B4:AB4\")\nSet Cov_Type = Covenant_Sheet.Range(\"B6:AB13\")\nSet DB_Cov = Dashboard.Range(\"L76:L80\")\nSet Cov_Type2 = Covenant_Sheet.Range(\"B6:B13\")\n\n\n\nFor Each Cell In Dashboard.Range(\"N76:N80\")\nCell.Value = Application.Index(Cov_Type, Application.Match(DB_Cov, Cov_Type2, 0), Application.Match(Cov_Date, Cov_Dates, 0))\n\n\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1498072890, "post_id": 44684553, "comment_id": 76353319, "body": "What calls this function?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1498072899, "post_id": 44684553, "comment_id": 76353326, "body": "I suspect your problem is with this <code>Set ch = ActiveSheet.ChartObjects(1).Chart</code>. If the active sheet is not what you expect it to be when calling from a separate sub and the 1st chart on that sheet has no trendline, t will fail. One solution is pass the chart object into the function itself to ensure that it works on the chart you expect it to."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 2, "creation_date": 1498073024, "post_id": 44684553, "comment_id": 76353400, "body": "If it has worked sometimes but not when you call from another sub then the ActiveSheet is probably the issue. You need to specify the sheet rather than just saying &quot;whatever sheet is active at the minute&quot; because if the sub is called from another sheet then your activesheet is not the one with the chart on it?! Try <code>Set ch = thisworkbook.worksheets(&quot;NAME OF SHEET WITH CHART ON IN HERE&quot;).ChartObjects(1).Chart</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498073326, "post_id": 44684553, "comment_id": 76353569, "body": "What isthe value of <code>t.DataLabel.Text</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1498073501, "post_id": 44684553, "comment_id": 76353666, "body": "This error will only be expected if <code>t.DataLabel.Text</code> is an empty string. Any other value should return a <code>String()</code> array, which will always have at least 1 element, so index <code>0</code> should not fail."}, {"owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "edited": false, "score": 0, "creation_date": 1498151783, "post_id": 44684553, "comment_id": 76394223, "body": "I tried adding the creation of the chart and trendline to the function, but I&#39;m still having the same problem. When I click debug and highlight t.DataLabel.Text, it gives me the value, but for some reason, s is not saving the string.  In the Locals window, t has a value, but s remains blank"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499356679, "post_id": 44684553, "comment_id": 76882748, "body": "<i>However, when I call the function from another sub, it gives me an error</i> - please include the code for that <code>Sub</code>, or at least tell us if that <code>Sub</code> is changing the <code>ActiveSheet</code>."}, {"owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "edited": false, "score": 0, "creation_date": 1499357446, "post_id": 44684553, "comment_id": 76883281, "body": "I made sure that the original sub did not change the active sheet before calling the function. I tried activating the correct sheet exactly one line before calling the function, and I tried activating the correct sheet in the function itself. Still nothing"}, {"owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "edited": false, "score": 0, "creation_date": 1499357937, "post_id": 44684553, "comment_id": 76883632, "body": "I added the sub code around calling the function."}, {"owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "edited": false, "score": 0, "creation_date": 1499358218, "post_id": 44684553, "comment_id": 76883817, "body": "The value of t.DataLabel.text in my test case (which produces error) is &quot;y = 6.38ln(x) + 3.03&quot; but for whatever reason, s = &quot; &quot;"}, {"owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499358581, "post_id": 44684553, "comment_id": 76884051, "body": "@Mat&#39;sMug I added MsgBox t.DataLabel.text before the line s=t.DataLabel.text and it is blank"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499358732, "post_id": 44684553, "comment_id": 76884146, "body": "Good. So the value of <code>t.DataLabel.Text</code> is <code>&quot;&quot;</code>, not <code>&quot;y = 6.38ln(x) + 3.03&quot;</code>. Your code relies heavily on <code>Select</code> and <code>Activate</code>, which makes it very frail / bug-prone. <a href=\"https://stackoverflow.com/q/10714251/1188513\">Start with fixing that</a>."}, {"owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "edited": false, "score": 0, "creation_date": 1499358868, "post_id": 44684553, "comment_id": 76884250, "body": "Thank you. I&#39;ll work on that and edit this post if I still can&#39;t figure it out"}], "owner": {"reputation": 1, "user_id": 8196133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca671dd4f7cd519ca53299fa27b3604?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Cozzone", "link": "https://stackoverflow.com/users/8196133/eric-cozzone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499357913, "creation_date": 1498072701, "last_edit_date": 1499357913, "question_id": 44684553, "link": "https://stackoverflow.com/questions/44684553/vba-function-not-storing-variable", "title": "VBA Function not storing variable", "body": "<p>I have included the code of my function. I mostly scrapped this together from things I found online, because I am very much an amateur coder. I am trying to take the trendline of a graph and use it for a mathematical calculation. When I step through this code, it works great. However, when I call the function from another sub, it gives me an error. Error 9: Subscript out of range. When I debug, it shows me the line a = spl(0). The real problem is that the variable \"s\" remains empty. Why?</p>\n\n<p>I have tried adding the creation of the chart to the function to avoid an error with \"Active Sheet\". I also tried pasting this code into my sub instead of calling a separate function. Still nothing. When I debug and highlight the t.DataLabel.Text, it shows me the correct value, but for some reason s is not saving that value. In the Locals window, t has value, but s is blank (\" \").</p>\n\n<pre><code>Function TrendLineLog() As Double\nDim ch As Chart\n    Dim t As Trendline\n    Dim s As String\n    Dim Value As Double\n\n    ' Get the trend line object\n    Set ch = ActiveSheet.ChartObjects(1).Chart\n    Set t = ch.SeriesCollection(1).Trendlines(1)\n\n    ' make sure equation is displayed\n    t.DisplayRSquared = False\n    t.DisplayEquation = True\n\n    ' set number format to ensure accuracy\n    t.DataLabel.NumberFormat = \"0.000000E+00\"\n\n    ' get the equation\n    s = t.DataLabel.Text '&lt;--------- HERE\n\n\n    ' massage the equation string into form that will evaluate\n\n    s = Replace(s, \"y = \", \"\")\n    s = Replace(s, \"ln\", \" *LOG\")\n    s = Replace(s, \" +\", \"\")\n    s = Replace(s, \" - \", \" -\")\n    spl = Split(s, \" \")\n    a = spl(0) '&lt;----------- HERE\n    b = spl(1)\n    c = spl(2)\n    y = 0.5\n\n..... Math stuff\n\nEnd Function\n</code></pre>\n\n<p>Here is the code section calling the function:</p>\n\n<pre><code>For rowx = 41 To 46 Step 1\nCells(rowx, 4).Select\nva = Cells(rowx, 4).Value\nvb = Cells(rowx, 5).Value\nvc = Cells(rowx, 6).Value\nvd = Cells(rowx, 7).Value\nlocb = ActiveCell.Address\nCells(rowx, 7).Select\nloce = ActiveCell.Address\nrang = locb &amp; \":\" &amp; loce\nIf va &lt; 0.8 Then    \nIf va &lt; vb And vb &lt; vc And vc &lt; vd Then\n    Range(rang).Select\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatter).Select\n    ActiveChart.SetSourceData Source:=Range(rang)\n    ActiveChart.FullSeriesCollection(1).Trendlines.Add\n    ActiveChart.FullSeriesCollection(1).Trendlines(1).Select\n    Selection.DisplayEquation = True\n    Selection.Type = xlLinear\n    ans = TrendLineLin()\n    Sheets(\"Results\").Activate\n    Cells(rowx - 39, 3).Value = ans\n    Sheets(nam).Activate\n\n\nElseIf va &lt; vb And vb &lt; vc And vc &gt; vd Then\n    Range(rang).Select\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatter).Select\n    ActiveChart.SetSourceData Source:=Range(rang)\n    ActiveChart.FullSeriesCollection(1).Trendlines.Add\n    ActiveChart.FullSeriesCollection(1).Trendlines(1).Select\n    Selection.DisplayEquation = True\n    Selection.Type = xlLogarithmic\n    ans = TrendLineLog()\n    Sheets(\"Results\").Activate\n    Cells(rowx - 39, 3).Value = ans\n    Sheets(nam).Activate\nElseIf va &lt; vb And vb &lt; vc And vc &gt; vd Then\n    Range(rang).Select\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatter).Select\n    ActiveChart.SetSourceData Source:=Range(rang)\n    ActiveChart.FullSeriesCollection(1).Trendlines.Add\n    ActiveChart.FullSeriesCollection(1).Trendlines(1).Select\n    Selection.DisplayEquation = True\n    Selection.Type = xlLogarithmic\n    Windows(nam1).Activate\n    ans = TrendLineLog(rang)\n    Windows(nam1).Activate\n    Sheets(\"Results\").Activate\n    Cells(rowx - 39, 3).Value = ans\n    Sheets(nam).Activate\n</code></pre>\n\n<p>I have a function for exponential, logarithmic, and linear trendlines. My test case is a log, which is the function that is posted. The code is nearly identical. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498072661, "post_id": 44684373, "comment_id": 76353175, "body": "The code works fine for me. Is the button on the same sheet you&#39;re clearing? Have you actually deselected the design mode? Do you get the pop up box confirmation at all?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1498072751, "post_id": 44684373, "comment_id": 76353231, "body": "Having the code window closed is not the same as being out of design mode... if you&#39;re clicking the Button and it&#39;s just selecting the outside of it (like to resize etc.) then you&#39;re still in design mode..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058123de54bb89c8e3d9635fbe449fb3?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Gonzales", "link": "https://stackoverflow.com/users/8196101/gabriel-gonzales"}, "edited": false, "score": 0, "creation_date": 1498077697, "post_id": 44684430, "comment_id": 76355851, "body": "This cleaned it up. I also found that I had multiple buttons and had the code running under the wrong button. Everything is working now, thank you!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1498072607, "last_edit_date": 1498072607, "creation_date": 1498072253, "answer_id": 44684430, "question_id": 44684373, "link": "https://stackoverflow.com/questions/44684373/vba-button-to-clear-a-range-of-cells/44684430#44684430", "title": "VBA Button to Clear a Range of Cells", "body": "<p>Your code looks a little incomplete. Try this instead:    </p>\n\n<p>EDIT: Cleaned it up a little more. No need for a <code>vbNo</code>, as if you don't select yes, the subroutine will simply end.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf MsgBox(\"THIS WILL CLEAR EVERYTHING IN THE CART! Are you sure?\", vbYesNo) = vbYes Then\n    Range(\"A28:AA47\").ClearContents\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058123de54bb89c8e3d9635fbe449fb3?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Gonzales", "link": "https://stackoverflow.com/users/8196101/gabriel-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1927, "favorite_count": 0, "accepted_answer_id": 44684430, "answer_count": 1, "score": 0, "last_activity_date": 1498081081, "creation_date": 1498072059, "last_edit_date": 1498081081, "question_id": 44684373, "link": "https://stackoverflow.com/questions/44684373/vba-button-to-clear-a-range-of-cells", "title": "VBA Button to Clear a Range of Cells", "body": "<p>As the title states, I am trying to create a button to clear a range of cells. Prior to clearing the cells, I have a dialog box pop up to confirm the selection. Here is my code: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    If MsgBox(\"THIS WILL CLEAR EVERYTHING IN THE CART! Are you sure?\", vbYesNo) = vbNo Then Exit Sub\n\n    Range(\"A28:AA47\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>The code works when I'm in Design Mode and press \"Play\" but the button won't work on my sheet when I'm out of Design Mode.</p>\n\n<p>Is the code completely ending itself when I select \"No\", to the point where it will not run again even if I hit the button again?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498072433, "post_id": 44684053, "comment_id": 76353052, "body": "So is this code that you use across different workbooks, but they have a different amount of worksheets?"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498072759, "post_id": 44684053, "comment_id": 76353236, "body": "Yes. It is only being applied to one workbook at a time to combine sheets in that workbook, but I want it to be able to work on different workbooks with the slight possible variations I mentioned above."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498072809, "post_id": 44684053, "comment_id": 76353265, "body": "So do you want it to be able to run for more than 12 worksheets/less than 12 worksheets, or do you want this to skip certain worksheets?"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498073129, "post_id": 44684053, "comment_id": 76353459, "body": "Yes. more than 12 and possibly less than 12. And I want it to be able to skip worksheets in the beginning or end. The first sheet that it will copy will always be the same name as well  as the last sheet it will copy. But there is a chance that there are different named sheets before it and there are almost always sheets after it that I don&#39;t want to include"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498076845, "post_id": 44684053, "comment_id": 76355458, "body": "I&#39;ve edited my post with your new block of code, I think I&#39;ve edited it correctly, however I&#39;m a little thrown off now because of the whole new revamp of code so please excuse any erroneous compile errors..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1498074616, "post_id": 44684929, "comment_id": 76354292, "body": "looks like it would work to me but am getting an error. Compile error: For control variable already in use. can you not nest for-loops in VBA?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1498074846, "post_id": 44684929, "comment_id": 76354428, "body": "Oops you can, I was using k twice by accident. Switched in j, try it now-"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1498075770, "post_id": 44684929, "comment_id": 76354918, "body": "My apologies, I think i copied the wrong block of code. I just edited the post to include the accurate block that selects the tables and pastes them to a new sheet. will your solution in its form still work for that code? Again, sorry!! and thank you so much for your replies."}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1498075840, "post_id": 44684929, "comment_id": 76354969, "body": "the code I initially presented ran through each sheet and added two columns. the part that is now posted copies each sheet&#39;s list over to a master list."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1498076177, "post_id": 44684929, "comment_id": 76355152, "body": "So is Sheets(1) still going to remain the master sheet or does that need to be changed now too?"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1498076476, "post_id": 44684929, "comment_id": 76355300, "body": "right after I create it, I think Sheets(1) should remain the master sheet as I am not adding any more sheets"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499270306, "post_id": 44684929, "comment_id": 76837730, "body": "dwirony, I need your help again!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499284356, "post_id": 44684929, "comment_id": 76845795, "body": "@AnthonyRichards What&#39;s up Anthony?"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499285915, "post_id": 44684929, "comment_id": 76846710, "body": "(aside from my item lvl :P)  I have added two columns two my varying amount of worksheets, and would like to add a formula to the top or bottom of each new column (whichever is easiest), and then autofill the rest of the column with that formula as well. I can provide what I have so far as well as an example if it would help.. The trick is that just like there are a varying amount of worksheets, the lists I am adding to vary in size as well"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499292864, "post_id": 44684929, "comment_id": 76849948, "body": "So we&#39;ll have to devise a dynamic solution. Let me get back to you tomorrow, I was busy today with some quarter end work."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499355050, "post_id": 44684929, "comment_id": 76881596, "body": "Okay, so what are your formulas, what are your columns, and what is the first cell of each column (where you&#39;re putting the formulas?). All you have to do is have the macro place the formula in the cell, then get the <code>lastrow</code> of the column and use <code>.Autofill</code> the formula the whole way down."}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499356587, "post_id": 44684929, "comment_id": 76882683, "body": "Formulas are two simple subtraction formulas. Qty remaining and Wt remaining.. So just Qty column minus the Qty ship column and Weight minus Weight shipped column. The &quot;Qty remaining&quot; and &quot;wt remaining columns are always located in Column K and L. the first cell is located in the 9th row. I guess the biggest challenge (and apologies for probably not being clear on this) is that the Qty, Qty ship, Wt, and Wt shipped columns are in varying locations depending on the sheet"}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499356636, "post_id": 44684929, "comment_id": 76882710, "body": "I was thinking I could use case statements for each sheet if finding the Qty, Qty, shipped, Weight, and Wt shipped columns dynamically would be a pain in the butt."}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499356673, "post_id": 44684929, "comment_id": 76882744, "body": "I can provide screenshots, files ,and how I currently parse through to find certain column headings now for a different macro."}, {"owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "edited": false, "score": 0, "creation_date": 1499434420, "post_id": 44684929, "comment_id": 76918933, "body": "I know I asked too much lol. I appreciate you pointing me in the right direction... good luck with your quarter end work... FOR THE HORDE!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1498076793, "last_edit_date": 1498076793, "creation_date": 1498073953, "answer_id": 44684929, "question_id": 44684053, "link": "https://stackoverflow.com/questions/44684053/copying-dynamic-range-of-sheets-to-a-single-sheet/44684929#44684929", "title": "Copying Dynamic Range of Sheets to a Single Sheet", "body": "<p>Try this. This will cycle through the sheets until it sees the first sheet, then begin looping through all your sheets until it does the last sheet, to which it will stop running after. Just put the sheet names in there.</p>\n\n<pre><code>Dim ws_count As Integer\nDim j as integer\nDim k as integer\nws_count = ActiveWorkbook.Worksheets.Count\n\nFor k = 1 to ws_count\n    If Sheets(k).Name = \"FirstSheet\" Then\n        For j = k to ws_count\n            Sheets(j).Activate\n            Range(\"A6\").Select\n            Selection.CurrentRegion.Select\n\n            ' Adjust here to eliminate header but include 2 rows below it\n            Selection.Offset(5, 0).Resize(Selection.Rows.Count - 5).Select\n            Selection.Copy Destination:=Sheets(1).Range(\"A65536\").End(xlUp)(6)\n            If Sheets(j).Name = \"LastSheet\" Then\n                Exit For \n            End If\n        Next j\n    Exit For\n    End If\nNext k\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8126314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6df68792e551bfe8aff2a11c208a0241?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Richards", "link": "https://stackoverflow.com/users/8126314/anthony-richards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 44684929, "answer_count": 1, "score": 0, "last_activity_date": 1498076793, "creation_date": 1498071147, "last_edit_date": 1498075761, "question_id": 44684053, "link": "https://stackoverflow.com/questions/44684053/copying-dynamic-range-of-sheets-to-a-single-sheet", "title": "Copying Dynamic Range of Sheets to a Single Sheet", "body": "<p>I am trying to consolidate several different parts lists on different sheets into one master list. </p>\n\n<p>The problem is that sometimes, for example, the main frame parts or trim parts will have multiple sheets (e.g. Main frame, Main frame (2), Trim, Trim (2), Trim (3), etc.) for different sections. </p>\n\n<p>So I can't hardcode values like I previously thought because the number of sheets vary for each workbook. The first sheet I copy from and the last sheet I copy from are the same, but depending on the workbook, their could be sheets before and are ALWAYS sheets after it that I don't want to include so I can't count back from the last sheet or always start with the first sheet. </p>\n\n<p>I am no VBA expert and it is seemingly robust enough to handle my problem, I just don't know how to specifically go about it.</p>\n\n<p>I've attached the logic to my code that I currently use to concatenate all the sheets into one, but it isn't dynamic enough to work for each case. (Also sorry for the poor style)</p>\n\n<p>Any help or just a point in the right direction would be greatly appreciated.</p>\n\n<pre><code>    On Error Resume Next\nSheets(1).Select\nWorksheets.Add\nSheets(1).Name = \"Master\"\nSheets(2).Activate\n' Add copy logo once here.\n\nRange(\"A6\").EntireRow.Select\nSelection.Copy Destination:=Sheets(1).Range(\"A1\").End(xlUp)(1)\nFor j = 2 To 13 ' Range of sheets\nSheets(j).Activate\nRange(\"A6\").Select\nSelection.CurrentRegion.Select\n\n' Adjust here to eliminate header but include 2 rows below it\nSelection.Offset(5, 0).Resize(Selection.Rows.Count - 5).Select\nSelection.Copy Destination:=Sheets(1).Range(\"A65536\").End(xlUp)(6)\nNext\n\nSheets(1).Activate\nRange(\"A1:O1\").Select\nRange(\"O1\").Activate\nSelection.Delete Shift:=xlUp\nRange(\"O10\").Select\n\nRange(\"A1:O4\").Select\nRange(\"O4\").Activate\nSelection.Delete Shift:=xlUp\n</code></pre>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1498076640, "post_id": 44684010, "comment_id": 76355376, "body": "I&#39;m forced to make some assumptions here: Is &#39;List1&#39; a listbox and you select ONE of the values in the list (i.e. &#39;Ball&#39;)? And is your ONLY issue that the strings &#39;Ball&#39; and &#39;Balla&#39; in &#39;Text1&#39;  are being replaced, or is there some other issue in addition to that? For &#39;Ball/Balla&#39; you will need to delimit the search string. You say &#39;multilinje&#39; so does that mean either a Line Feed or CRLF is at the end of each word? Will you want to replace a partial word (i.e. change nighttime to daytime)?"}, {"owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1498080854, "post_id": 44684010, "comment_id": 76357305, "body": "i have list1 which is listbox with the string Ball selected now i do simple replace method on text1,  it replaces the string in text1 but other similar string Ball Balla also gets replaced, i strictly want to replace selected value only"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1498081295, "post_id": 44684010, "comment_id": 76357481, "body": "As I stated earlier, you need to delimit the search. You did not answer my question re CRLF or how your multiline is delimited."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1498081833, "post_id": 44684010, "comment_id": 76357689, "body": "You <i>may</i> be able to use REPLACE, but depending on how your delimiters work, you may need to write your own routine. For example, if &#39;Text1&#39; only has one word per line, AND there is a CRLF (or similar) to delimit, you can change the REPLACE to look like: Text1 = Replace(Text1.Text, list1.Text &amp; vbcrlf, Text9.Text &amp; vbcrlf)  However, if the last line has no CRLF, that will not work."}, {"owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1498082090, "post_id": 44684010, "comment_id": 76357777, "body": "i am loading the text1 from a .htm file , the text1 gets populated with html code so thier is alot of space and vbcrlf in it"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498088993, "post_id": 44687032, "comment_id": 76359869, "body": "debug.print shows output as footbar now sure what this is doing , is it replacing Ball with footbar ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498089313, "post_id": 44687032, "comment_id": 76359940, "body": "@RobRob it replaces whole word &quot;Ball&quot; with &quot;Crystal&quot;. &quot;foobar&quot; is just the last line and it stays the same. Only the two occurrences of the word <code>&quot;Ball&quot;</code> are replaced. It is tested :)"}, {"owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498091207, "post_id": 44687032, "comment_id": 76360373, "body": "can i use this on text1 with lots of html code loaded onto it and then using this code to find and replace , will i se the changs."}, {"owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498091261, "post_id": 44687032, "comment_id": 76360387, "body": "i think this is not what i want, i want find and replace , i have string Ball Balling , i want to replace Ball Only , but it replaces all Ball strings instead"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498091372, "post_id": 44687032, "comment_id": 76360413, "body": "@RobRob Try <code>text1 = ReplaceWholeWord(text1, text2, text3)</code>."}, {"owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498091445, "post_id": 44687032, "comment_id": 76360429, "body": "i think this is not what i want, i want find and replace , i have string Ball Balling , i want to replace Ball Only , but it replaces all Ball strings instead   text1.text is loaded from file its html code so i have to find and replace"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "edited": false, "score": 0, "creation_date": 1498092107, "post_id": 44687032, "comment_id": 76360554, "body": "@RobRob it does <b>not</b> replace Balling. Idk what is actually in your html text but the pattern replace only <i>whole words</i>. If that&#39;s not what you want then I misunderstood the question."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1498091525, "last_edit_date": 1498091525, "creation_date": 1498082812, "answer_id": 44687032, "question_id": 44684010, "link": "https://stackoverflow.com/questions/44684010/vb6-find-replace-code/44687032#44687032", "title": "Vb6 find replace code", "body": "<p><code>RegExp</code> is excellent to catch <em>whole word</em>, without the need to specify any specific boundaries. If you want to use this feature, try this:</p>\n\n<pre><code>Function ReplaceWholeWord(sText As String, sFind As String, sReplace As String)\n  With CreateObject(\"VBScript.Regexp\")\n     .MultiLine = True: .Global = True\n     .Pattern = \"\\b\" &amp; sFind &amp; \"\\b\"\n     ReplaceWholeWord = .Replace(s, sReplace)\n  End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Test()\n  Dim s As String\n  s = \"hiker \" &amp; vbCrLf &amp; \"Ball 123\" &amp; vbCrLf &amp; \"Balla\" &amp; vbCrLf &amp; \"Ball\" &amp; vbCrLf &amp; \"foobar\"\n  Debug.Print ReplaceWholeWord(s, \"Ball\", \"Crystal\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8180572, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213439681731058/picture?type=large", "display_name": "Rob Rob", "link": "https://stackoverflow.com/users/8180572/rob-rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 603, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498091525, "creation_date": 1498071046, "last_edit_date": 1498080775, "question_id": 44684010, "link": "https://stackoverflow.com/questions/44684010/vb6-find-replace-code", "title": "Vb6 find replace code", "body": "<p>i want to replace only 1 string but what happens is it replaces all matching strings.</p>\n\n<p>i selected Ball from list1(listbox ) and find and replace that on text1 , it finders the value in text1 but other strings similar to the name ball gets changed also.</p>\n\n<p>i have a list1<br >\ni have text1.text  multiline</p>\n\n<p><strong>list1 keywords</strong><br >\nground<br >\nswimming<br >\nsnooker<br >\nBall<br >\njames</p>\n\n<p><strong>text1.text</strong><br >\nhiker<br >\nBall<br >\nBalla<br >\njeans</p>\n\n<p>am using</p>\n\n<pre><code>If Text1.Text = list1.Text Then\nText1 = Replace(Text1.Text, list1.Text, Text9.Text)\nend if\n</code></pre>\n\n<p>am trying to do exact keyword replace here but am failing to do so.</p>\n\n<p>am trying to <strong>replace Ball</strong> only but it replaces all matching keywords all together</p>\n\n<p>Ball should be replaced only but Balla also geting replaced</p>\n"}, {"tags": ["html", "css", "vba"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 2163, "user_id": 3586768, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/9im8U.jpg?s=128&g=1", "display_name": "Gustaf Gun&#233;r", "link": "https://stackoverflow.com/users/3586768/gustaf-gun%c3%a9r"}, "edited": false, "score": 0, "creation_date": 1498074658, "post_id": 44683935, "comment_id": 76354314, "body": "@GustafGun&#233;r No JS being used, this is a VBA application (which I&#39;m guessing uses some methods universal to object orientated languages). As a summary, I navigate an <code>InternetExplorer.Application</code> called <code>objIE</code> to a google images page, wait for it to load, then: <code>Set elem = objIE.document.getElementById(&quot;rg_s&quot;).getElementsByTagName(&quot;&zwnj;&#8203;IMG&quot;)(0).ParentEleme&zwnj;&#8203;nt</code> where <code>elem</code> is the <code>IHTMLElement</code> I refer to in my question (I spread it out over more lines, but that&#39;s the idea)"}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498329206, "post_id": 44736293, "comment_id": 76460667, "body": "Hmmm, returning &quot;&quot; for the <code>style.backgroundColor</code> when using <a href=\"https://www.google.co.uk/search?q=stack+overflow&amp;tbm=isch\" rel=\"nofollow noreferrer\">this</a> images search - even though <code>anchor</code> does point to the correct element on the page. I have used the IE inspector instead of the Chrome one, and have found no trace of the <code>background</code> property. This leads to 2 guesses; first that this property is unique to chrome, second that some ajax script removes the property in IE once the images are loaded. I may have to use Selenium unless you can think of how to get the data in IE?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498332056, "post_id": 44736293, "comment_id": 76461450, "body": "@Greedo well now with the link provided I can fully undestand your problem :). But as you wrote, in IE there is no such inline style present. So the result of the <code>style.backgroundColor</code> is correct, I can&#39;t do anything with it :(."}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1498306736, "creation_date": 1498306736, "answer_id": 44736293, "question_id": 44683935, "link": "https://stackoverflow.com/questions/44683935/parse-style-from-html-element-background-missing/44736293#44736293", "title": "Parse Style from HTML element background missing", "body": "<p>For this purpose the <code>getAttribute(\"style\")</code> method of the target <code>anchor</code> element can be used. Then the <code>style</code> is of type <code>IHTMLStyle</code> which has string property for <em>background</em> color. HTH</p>\n\n<pre><code>Option Explicit\n\n' Add reference to Microsoft Internet Controls (SHDocVw)\n' Add reference to Microsoft HTML Object Library\n\nConst url As String = \"your-url-here\"\n\nSub GetInlineStyle()\n    Dim ie As SHDocVw.InternetExplorer\n    Dim doc As MSHTML.HTMLDocument\n\n    Debug.Assert Trim(url) &lt;&gt; \"\"\n    Set ie = New SHDocVw.InternetExplorer\n    ie.Visible = True\n    ie.navigate url\n\n    While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Wend\n\n    Set doc = ie.document\n\n    ' Get target anchor element which contains the background color\n    Dim anchor As HTMLAnchorElement\n    Set anchor = doc.querySelector(\"a[class=rg_l]\")\n\n    ' Use getAttribute(\"style\") to get style of anchor\n    Dim style As IHTMLStyle\n    Set style = anchor.getAttribute(\"style\")\n\n    ' IHTMLStyle has string property backgroundColor\n    Dim bgrColor As String\n    bgrColor = style.backgroundColor\n    Debug.Print bgrColor\n\n    ie.Quit\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Output</p>\n</blockquote>\n\n<pre><code>rgb(200, 190, 194)\n</code></pre>\n\n<blockquote>\n  <p>HTML used</p>\n</blockquote>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n\n&lt;head&gt;\n&lt;!-- saved from url=(0016)http://localhost --&gt;\n&lt;meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" /&gt;\n&lt;title&gt;Stackoverflow Greedo&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;div class=\"content\"&gt;\n        &lt;a href=\"https://stackoverflow.com\" class=\"rg_l\" rel=\"noopener\" \n            style=\"background: rgb(200, 190, 194); width: 270px; height: 168px; left: 0px\"&gt;\n            Stackoverflow Greedo    \n        &lt;/a&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498306736, "creation_date": 1498070762, "question_id": 44683935, "link": "https://stackoverflow.com/questions/44683935/parse-style-from-html-element-background-missing", "title": "Parse Style from HTML element background missing", "body": "<p>I am completely stumped. I'm parsing the HTML of a google images search using VBA's Internet explorer object. When I inspect the element with Chrome's built in tool, I get the HTML as something like this:</p>\n\n<pre><code>&lt;a href=\"/imgres?imgurl=...&amp;amp;imgrefurl=...&amp;amp;docid=...&amp;amp;tbnid=...&amp;amp;vet=...&amp;amp;w=1366&amp;amp;h=768&amp;amp;bih=638&amp;amp;biw=1366&amp;amp;q=cats&amp;amp;ved=...;iact=mrc&amp;amp;uact=8\" jsaction=\"fire.ivg_o;mouseover:str.hmov;mouseout:str.hmou\" class=\"rg_l\" rel=\"noopener\" style=\"background: rgb(200, 190, 194); width: 270px; height: 168px; left: 0px;\"&gt;&lt;img class=\"rg_ic rg_i\" data-sz=\"f\" name=\"z7O-qKoPKHzyaM:\" alt=\"Image result for cat's\" jsaction=\"load:str.tbn\" onload=\"google.aft&amp;amp;&amp;amp;google.aft(this)\" src=\"data:image/jpeg;base64,/9j/4AAQ...\" style=\"width: 300px; height: 168px; margin-left: -15px; margin-right: -15px; margin-top: 0px;\"&gt;&lt;div class=\"_aOd rg_ilm\"&gt;&lt;div class=\"rg_ilmbg\"&gt;&lt;span class=\"rg_ilmn\"&gt; 1366&amp;nbsp;\u00d7&amp;nbsp;768 - wallpapercave.com &lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;\n</code></pre>\n\n<p>Or as a picture (Sorry, not sure how to format)</p>\n\n<p><a href=\"https://i.stack.imgur.com/1XYyJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1XYyJ.png\" alt=\"HTML image\"></a></p>\n\n<p>There's a \"background\" value within the style set and I'd like to get this. However I can't seem to find it anywhere. When I go through the Properties with Chrome's inspection tool, there's no \"Style\" option available to look at. The <code>InnerHTML</code> does not contains some of the Style elements, but not \"background\".\nAnd going through VBA</p>\n\n<pre><code>HTMLelement.getAttribute(\"Background\") = \"\"\nHTMLelement.Style.Background = \"\"\nHTMLelement.Style.BackgroundColor = \"\"\n</code></pre>\n\n<p>What's going on, why can I see a background property when using the webpage inspector, but not access it through the above means?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498071125, "post_id": 44683833, "comment_id": 76352229, "body": "Please STOP posting multiple questions on the same topic - stick with the original until it&#39;s clear things are not going to work out.  You now have 8 questions all on this same problem."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1498071148, "post_id": 44683911, "comment_id": 76352240, "body": "I Implemented this code but when I double-click on a code, it populates the cell C448 as the first cell,  not C7 (which is the first cell)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1498071195, "post_id": 44683911, "comment_id": 76352267, "body": "Are there values already in the cells C7:C447 that you&#39;re just trying to overwrite?"}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1498071423, "post_id": 44683911, "comment_id": 76352411, "body": "No, those cells do not have any values in them. I would just like the first value to be in the first cell C7, then the second on cell C8, and so on."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 1, "creation_date": 1498071511, "post_id": 44683911, "comment_id": 76352485, "body": "<code>lastrow = sht.Cells(sht.Rows.Count, &quot;C&quot;).End(xlUp).Row + 1</code> finds the last cell in column C with text in it and marks the next available cell for data entry. According to what you&#39;ve told me, nothings in cell 447, but something must be there since it tried to start placing code in C448. But you&#39;re saying C447 is empty?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1498071769, "post_id": 44683911, "comment_id": 76352652, "body": "Try my new solution. It&#39;ll loop through all cells in C7 - C447 until it finds an empty one, then place you value in it."}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1498071775, "post_id": 44683911, "comment_id": 76352655, "body": "You&#39;re right there is text in cell C447, it is the last row in the form and it is text that reads &quot;Total&quot;. I believe I need that there. Is there a way to specify a cell range in the C column to be C7:C446 rather than the entire column? Thanks!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "edited": false, "score": 0, "creation_date": 1498072104, "post_id": 44683911, "comment_id": 76352850, "body": "Glad to help. If you feel this answer solved your issue, please go ahead and mark it as accepted."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1498071814, "last_edit_date": 1498071814, "creation_date": 1498070680, "answer_id": 44683911, "question_id": 44683833, "link": "https://stackoverflow.com/questions/44683833/ability-to-double-click-multiple-values-and-populate-multiple-rows-in-a-column/44683911#44683911", "title": "Ability to double-click multiple values and populate multiple rows in a column", "body": "<p>Give this a shot:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nIf Target.Column = 1 Then\n    For j = 7 to 446\n        If Worksheets(\"JE\").Range(\"C\" &amp; j).Value = \"\" Then\n             Worksheets(\"JE\").Range(\"C\" &amp; j).Value = ActiveCell.Value    \n             Worksheets(\"JE\").Activate\n             Exit For\n        End If\n     Next j\nEnd If\n\nCancel = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 44683911, "answer_count": 1, "score": -1, "last_activity_date": 1498071814, "creation_date": 1498070385, "question_id": 44683833, "link": "https://stackoverflow.com/questions/44683833/ability-to-double-click-multiple-values-and-populate-multiple-rows-in-a-column", "title": "Ability to double-click multiple values and populate multiple rows in a column", "body": "<p>I have a main sheet/form and a separate sheet that lists different codes. Right now, when I already have a code in the first cell of the column (C7) and want to double-click a second code to populate the next row (C8) the second code overwrites the first code in cell C7 rather than going down to the next available row, C8. Is there a way, after double-clicking a code in a separate sheet, to get it to go the next available row in the C column, Range C7:C446? </p>\n\n<p>The issue I am having is, when I try to populate multipe rows within the C column I can only populate the first cell C7 and not the other cells in the range C7:C446. \nHere is the code for the main sheet:</p>\n\n<pre><code>Option Explicit\nPublic sourceRange As Range\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n'  If Not Intersect(Target, Range(\"C7:D446\")) Is Nothing Then\n      Dim c As Range: Set c = Range(\"D7:D446\")\n'     For Each c In Target\n For Each c In c.Cells\n          Select Case c.Value\n              Case \"1000GP\", \"1000MM\", \"19FEST\", \"20IEDU\", \"20ONLC\", \"20PART\", \"20PRDV\", \"20SPPR\", \"22DANC\", \"22LFLC\", \"22MEDA\", \"530CCH\", \"60POUBL\", \"74GA01\", \"74GA17\", \"74GA99\", \"78REDV\"\n                  Cells(c.Row, \"F\").Interior.ColorIndex = 3\n              Case Else\n                 Cells(c.Row, \"F\").Interior.ColorIndex = 0\n          End Select\n      Next c\n\n' End If\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Set sourceRange = Nothing ' Set it to nothing to avoid too long remembering\n  If Target.Column = 6 And Target.Cells.Count = 1 And Target.Interior.ColorIndex = 3 Then\n      Set sourceRange = Target ' Remember source cell\n      'Cancel = True\n      Select Case Target.Offset(0, -2).Value2\n        Case \"1000GP\": gotoref1\n        Case \"1000MM\": gotoref2\n        Case \"19FEST\": gotoref3\n        Case \"20IEDU\": gotoref4\n        Case \"20ONLC\": gotoref5\n        Case \"20PART\": gotoref6\n        Case \"20PRDV\": gotoref7\n        Case \"20SPPR\": gotoref8\n        Case \"22DANC\": gotoref9\n        Case \"22LFLC\": gotoref10\n        Case \"22MEDA\": gotoref11\n        Case \"530CCH\": gotoref12\n        Case \"60PUBL\": gotoref13\n        Case \"74GA01\": gotoref14\n        Case \"74GA17\": gotoref15\n        Case \"74GA99\": gotoref16\n        Case \"78REDV\": gotoref17\n      End Select\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Here is the code for the sheet with the codes listed below. I know the issue is probabl becuase I have the code set to <code>.Range(\"C7\")</code> but I tried doing <code>.Range(\"C7:C446)</code> but that didn't work : </p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nIf Target.Column = 1 Then\nWorksheets(\"JE\").Range(\"C7\").Value = ActiveCell.Value    \nWorksheets(\"JE\").Activate\n\nCancel = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1498069585, "post_id": 44683516, "comment_id": 76351278, "body": "place the 1000 numbers into a separate table and do a left join."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498069679, "post_id": 44683516, "comment_id": 76351341, "body": "@ScottHoltzman i.e. a temp table more than likely as suggested here in the last paragraph: <a href=\"https://stackoverflow.com/a/19788459/5224021\">stackoverflow.com/a/19788459/5224021</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8015232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e83b2ba8bef3c6b1fc80510d89a407?s=128&d=identicon&r=PG&f=1", "display_name": "Katiankia", "link": "https://stackoverflow.com/users/8015232/katiankia"}, "edited": false, "score": 0, "creation_date": 1498070947, "post_id": 44683631, "comment_id": 76352132, "body": "I try put this WHERE OZATI_Ticket.Number IN (SELECT * FROM [data!A1:A1000]) but I see error &lt;identifier&gt;"}, {"owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "reply_to_user": {"reputation": 11, "user_id": 8015232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e83b2ba8bef3c6b1fc80510d89a407?s=128&d=identicon&r=PG&f=1", "display_name": "Katiankia", "link": "https://stackoverflow.com/users/8015232/katiankia"}, "edited": false, "score": 0, "creation_date": 1498075556, "post_id": 44683631, "comment_id": 76354802, "body": "You will not be able to join in a list directly in Excel, if you want to do it like that, you need to output the result in a Sting before. I&#39;ll add an exemple in the answer."}], "tags": [], "owner": {"reputation": 358, "user_id": 8082322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IcBiiz5VAsc/AAAAAAAAAAI/AAAAAAAAADo/X9NaMDztyFQ/photo.jpg?sz=128", "display_name": "Alex Dupuis", "link": "https://stackoverflow.com/users/8082322/alex-dupuis"}, "is_accepted": false, "score": 0, "last_activity_date": 1498075629, "last_edit_date": 1498075629, "creation_date": 1498069710, "answer_id": 44683631, "question_id": 44683516, "link": "https://stackoverflow.com/questions/44683516/too-many-characters-in-excel-sql-query/44683631#44683631", "title": "Too many characters in Excel SQL Query", "body": "<p>If you need to enter that much information, the best would be to create a table listing all the tickets you want. Is it's not a possibility, you can do it like that:</p>\n\n<pre><code>WHERE OZATI_Ticket.Number IN = ('1234','4321','6662')\n</code></pre>\n\n<p>I hope that you will give you enough characters in that way. There is a way to get the list of ids</p>\n\n<pre><code>Dim currentRow As Integer\nDim str As String\ncurrentRow = 1\nDo While (sheets(\"data\").Range(\"A\" &amp; currentRow).Value &lt;&gt; \"\")\n    str = str &amp; \",'\" &amp; sheets(\"data\").Range(\"A\" &amp; currentRow).Value &amp; \"'\"\n    currentRow = currentRow + 1\nLoop\nstr = Mid(str, 2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8015232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e83b2ba8bef3c6b1fc80510d89a407?s=128&d=identicon&r=PG&f=1", "display_name": "Katiankia", "link": "https://stackoverflow.com/users/8015232/katiankia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1498082298, "creation_date": 1498069337, "last_edit_date": 1531161705, "question_id": 44683516, "link": "https://stackoverflow.com/questions/44683516/too-many-characters-in-excel-sql-query", "title": "Too many characters in Excel SQL Query", "body": "<p>I'm trying to find all <code>Names</code> for the <code>Ticket</code> number by Excel SQL Query. The problem is that I have above 10,000 numbers and SQL does not allow you to type as many characters. How could I make this possible?</p>\n\n<pre><code>    SELECT \n    OZATI_Ticket.Name, \n    OZATI_Ticlet.Number\n    FROM \n    OZATI_Ticket\n    WHERE \n    (OZATI_Ticket.Number='1234' Or \n    OZATI_Ticket.Number='4321' Or \n    OZATI_Ticket.Number='6662' Or\n/*next 9997 ticket numbers*/)\n    ORDER BY \n    OZATI_Ticket.Name\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "edited": false, "score": 0, "creation_date": 1498071412, "post_id": 44683650, "comment_id": 76352405, "body": "I am not using a password to protect .... I am just using the following:ActiveSheet.Unprotect         ActiveSheet.Range(ActiveSheet.Cells(S, 1), ActiveSheet.Cells(S + 9, lColumn)).Locked = True         ActiveSheet.Protect .. Please do let me know how to do using this approach.."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "edited": false, "score": 0, "creation_date": 1498072265, "post_id": 44683650, "comment_id": 76352944, "body": "@sid - Just take the password out and pass <code>&quot;&quot;</code>. Otherwise, I am confused. You can just set the format (or cell value) in between protection and unprotection. Because locking a cell is meaningless when worksheet is unprotected state."}, {"owner": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "edited": false, "score": 0, "creation_date": 1498111195, "post_id": 44683650, "comment_id": 76365828, "body": "This is not working ... I am setting the ActiveSheet.Range().locked = False and then setting the value and then setting ActiveSheet.Range().Locked = True ... This is how the code looks like                ActiveSheet.Range(ActiveSheet.Cells(rps + 3, cps)).Locked = False Cells(rps + 3, cps).Value = Format(Date, &quot;mm-dd-yyyy&quot;) ActiveSheet.Range(ActiveSheet.Cells(rps + 3, cps)).Locked = True"}, {"owner": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "edited": false, "score": 0, "creation_date": 1498113769, "post_id": 44683650, "comment_id": 76367208, "body": "What I also found out is that when I click on the drop-down and select and option 2 things are happening: 1) A String in a cell is populated and 2) A date in a cell is populated ... Both the cells are locked .. .while it is able to write String to a locked cell BUT its giving&quot;Application-defined OR Object-defined&quot; Error while entering date. ??? What could be the reason...... Why excel vba is able to enter string in a locked cell but unable to enter date in a locked cell ?? Please help"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1498069778, "creation_date": 1498069778, "answer_id": 44683650, "question_id": 44683300, "link": "https://stackoverflow.com/questions/44683300/application-defined-or-object-defined-error-with-format-function/44683650#44683650", "title": "Application-defined or object-defined error with Format function", "body": "<p>Unlock the sheet, then make changes as needed, then lock again.</p>\n\n<pre><code>Me.Unprotect \"pwd\"\nMe.Range(\"A1\").Value = Format(Date,\"mm-dd-yyyy\")\nMe.Protect \"pwd\"\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 44683650, "answer_count": 1, "score": 0, "last_activity_date": 1498069778, "creation_date": 1498068551, "last_edit_date": 1531164843, "question_id": 44683300, "link": "https://stackoverflow.com/questions/44683300/application-defined-or-object-defined-error-with-format-function", "title": "Application-defined or object-defined error with Format function", "body": "<p>My cell is locked and I am filling the cell with data on Worksheet_Change event of a drop-down: <code>Format(Date, \"mm-dd-yyyy\").</code></p>\n\n<p>I am getting following error ::\n<em>Run-time error '1004':\nApplication-defined or object-defined error</em></p>\n\n<p>I do not want to unlock the field as it is to be non-editable. </p>\n\n<p>I also do understand that it is giving the error just because the cell is locked and it needs to perform the operation: <code>Format(Date, \"mm-dd-yyyy\").</code>. </p>\n\n<p>What options do I have to make it working without unlocking the cell? </p>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1498071434, "post_id": 44683154, "comment_id": 76352425, "body": "Does you give an error message?  what happens when you try?"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1498071502, "post_id": 44683154, "comment_id": 76352476, "body": "That is not VB.NET code"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1498071507, "post_id": 44683154, "comment_id": 76352480, "body": "also, quotes are correct, but I believe User ID should be uid or UserID (all together).  <a href=\"https://www.connectionstrings.com/sql-server-native-client-11-0-oledb-provider/standard-security/\" rel=\"nofollow noreferrer\">Check this out</a>"}, {"owner": {"reputation": 697, "user_id": 1777929, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/048cd7dcc33d07e3d91c4048a81c51c2?s=128&d=identicon&r=PG", "display_name": "user1777929", "link": "https://stackoverflow.com/users/1777929/user1777929"}, "edited": false, "score": 0, "creation_date": 1498084016, "post_id": 44683154, "comment_id": 76358490, "body": "No error message. I get a prompt that it connected successfully. It just doesn&#39;t show up in the database when I run a search query with those details. I think it still stores the info locally."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1498140460, "post_id": 44683154, "comment_id": 76386355, "body": "I wonder if the form itself has a connection to the other source then.  You&#39;re saying the user you add does not make it to the SQL database you&#39;re connected to, but no errors occur?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1505744660, "post_id": 44683154, "comment_id": 79526299, "body": "Why don&#39;t you just <code>link</code> the table in Access ? Simple and efficient. You can also use Passthru queries."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1505744394, "creation_date": 1505744394, "answer_id": 46281658, "question_id": 44683154, "link": "https://stackoverflow.com/questions/44683154/how-do-i-connect-to-a-new-datasource-in-access-2016-vba/46281658#46281658", "title": "How do I connect to a new Datasource in Access 2016 VBA?", "body": "<p>Basically, you have a version confusion of same named table between local Access frontend database and backend SQL Server database. Currently, your code updates the <em>tblUserLog</em> on the SQL Server backend side and is not the same <em>tblUserLog</em> on the Access frontend side which likely is the one bound to your form. Hence, why you cannot see any update as the server table is never shown.</p>\n\n<p>Simply do one of two things:</p>\n\n<ol>\n<li><p><strong>Use SQL Server Version</strong>: Delete or archive the Access' version and add <em>tblUserLog</em> as an <a href=\"https://support.office.com/en-us/article/Link-to-or-import-from-an-SQL-Server-database-a5a3b4eb-57b9-45a0-b732-77bc6089b84e\" rel=\"nofollow noreferrer\">ODBC linked table</a>. Be sure to remove the <em>dbo_</em> or other schema prefix and keep same name <em>tblUserLog</em>. And since table names do not change, everything such as forms and VBA code should not need to change.</p></li>\n<li><p><strong>Use Access Version</strong>: Keep the local Access table, <em>tblUserLog</em>, and update this one in VBA which requires adding another connection object and running a recordset update on that connection. See below with prefixes of <em>server_</em> and <em>local_</em> on ADO objects:</p>\n\n   <pre class=\"lang-vb prettyprint-override\"><code>' OPEN SERVER CONNECTION AND SERVER TABLE RECORDSET\nSet server_conn = New ADODB.Connection\n\nWith server_conn\n    .ConnectionString = \"Provider=SQLNCLI11;Data Source=(My Server Name);Initial Catalog=(My Database Name);User ID=(Username);Password=(Password)\"\n    .Open\n    If .State = adStateClosed Then\n        MsgBox \"Connection unsuccessful. Could not open connection.\", vbInformation, \"Error:\"\n    End If\nEnd With\n\nSet server_rst = New ADODB.Recordset\nWith server_rst\n    .ActiveConnection = conn\n    .CursorLocation = adUseClient\n    .CursorType = adOpenStatic\n    .LockType = adLockOptimistic\n    .Open \"tbl_Users\"\nEnd With\n\n' OPEN LOCAL CONNECTION AND UPDATE LOCAL TABLE RECORDSET\nSet local_conn = CurrentProject.Connection\n\nSet local_rstLog = New ADODB.Recordset\nlocal_rstLog.Open \"tblUserLog\", local_conn, adOpenStatic, adLockOptimistic\nlocal_rstLog.AddNew\n    local_rstLog!UserID = server_rst!UserID     ' NOTICE SERVER DATA USED HERE\n    local_rstLog!TimeIn = DateTime.Now()\nlocal_rstLog.Update\n\n...\n' RELEASE RESOURCES\nSet server_rst = Nothing: Set local_rstLog = Nothing\nSet server_conn = Nothing: Set local_conn = Nothing\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 697, "user_id": 1777929, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/048cd7dcc33d07e3d91c4048a81c51c2?s=128&d=identicon&r=PG", "display_name": "user1777929", "link": "https://stackoverflow.com/users/1777929/user1777929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505744394, "creation_date": 1498068039, "last_edit_date": 1505743044, "question_id": 44683154, "link": "https://stackoverflow.com/questions/44683154/how-do-i-connect-to-a-new-datasource-in-access-2016-vba", "title": "How do I connect to a new Datasource in Access 2016 VBA?", "body": "<p>My department uses an application created using VBA and Access 2016. It originally pointed to an Access database on one of our servers. After migrating the data to a different server, I now need it pointing to the other SQL Server database on that different server. But I can't seem to make the connection.</p>\n\n<p>I have <em>dbowner</em> permissions on the server in question.</p>\n\n<p>The original code for connection string was as follows:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Remove the filter, close the log on form, and open the Switchboard\nrst.Filter = 0\nDoCmd.Close acForm, \"frmUserLogOn\"\n\n'Open the Main Switchboard\nDoCmd.OpenForm \"frmMain\", acNormal\n\n'Open the InactiveShutDown form in Hidden mode\nDoCmd.OpenForm \"frmInactiveShutDown\", acNormal, , , , acHidden\n...\n\nSet conn = CurrentProject.Connection\n...\n\nrstLog.Open \"tblUserLog\", conn, adOpenKeyset, adLockOptimistic\nrstLog.AddNew\n    rstLog!UserID = rst!UserID\n    rstLog!TimeIn = Now()\nrstLog.Update\n</code></pre>\n\n<p>My new code is as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'DoCmd.OpenForm \"frmInactiveShutDown\", acNormal, , , , acHidden\n'Commented out the above statement\n...    \n'Set conn = CurrentProject.Connection\n'==================================================================\n'Start of Added Code for SQL Migration\nSet conn = New ADODB.Connection\nWith conn\n    .ConnectionString = \"Provider=SQLNCLI11;Data Source=(My Server Name);Initial Catalog=(My Database Name);User ID=(Username);Password=(Password)\"\n    .Open\n    If .State = adStateClosed Then\n        MsgBox \"Connection unsuccessful. Could not open connection.\", vbInformation, \"Error:\"\n    End If\nEnd With\n\nSet rst = New ADODB.Recordset\nWith rst\n    .ActiveConnection = conn\n    .CursorLocation = adUseClient\n    .CursorType = adOpenStatic\n    .LockType = adLockOptimistic\n    .Open \"tbl_Users\"\nEnd With\n'End of Added Code for SQL Migration - See Section 2 for rest of code.\n'==================================================================\n...\n\n'Section 2 of Code\n'==================================================================\n'Start of added code for SQL Migration\nrstLog.Open \"tblUserLog\", conn, adOpenStatic, adLockOptimistic\nrstLog.AddNew\n    rstLog!UserID = rst!UserID\n    rstLog!TimeIn = DateTime.Now()\nrstLog.Update\nMsgBox \"Success! Connection was made successfully.\", vbInformation\n'End of added code for SQL Migration\n'===================================================================\n</code></pre>\n\n<p>My form has a drop down to select list of users form a table. I added a test user in that table but that test user doesn't show up in the drop down list. Hence, I think the connection is not being made.  </p>\n\n<p>Do I have to enter the names for Data Source, Initial Catalog, User ID and Password in quotes? So <code>UserID='Admin'; Password='Test'</code>?</p>\n\n<p>Anyone know what I'm doing wrong?</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1498067675, "post_id": 44682965, "comment_id": 76350214, "body": "First, you should avoid using Select: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>  Second, You could use lastRows to make a for loop, like: <a href=\"https://stackoverflow.com/questions/29653616/how-to-know-the-last-row-filled-in-vba-excel\" title=\"how to know the last row filled in vba excel\">stackoverflow.com/questions/29653616/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498068208, "post_id": 44682965, "comment_id": 76350500, "body": "You should also learn to <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indent your code</a> to make it (much) easier to read."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498068972, "post_id": 44682965, "comment_id": 76350940, "body": "<code>Sub MigrateToTemplate()  Dim EAP, TTest As Worksheet Dim i As Integer Dim a2 As String  Set EAP = ThisWorkbook.Worksheets(&quot;EAPData&quot;) Set TTest = ThisWorkbook.Worksheets(&quot;TemplateTest&quot;) lastRow = Range(&quot;A65536&quot;).End(xlUp).Row  &#39;Copy from Sheet1 to Sheet2 a2 = EAP.Cells(2, 1).Value TTest.Cells(2, 1).Value = a2 &#39;Insert Titles TTest.Cells(2, 2).Value = &quot;Description&quot;   For i = 1 To lastRow  If EAP.Cells(2, 4).Value &lt;&gt; &quot;&quot; Then  &#39;Make something  End If  Next i  End Sub</code> Example to help"}], "answers": [{"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1498068212, "creation_date": 1498068212, "answer_id": 44683221, "question_id": 44682965, "link": "https://stackoverflow.com/questions/44682965/excel-vba-loop-bug/44683221#44683221", "title": "Excel VBA Loop Bug", "body": "<p>Of course your loop will go on forever. Please be sure to try debugging your code before putting it up on SO. Note that I have only removed lines that are working with the sheet, and range. See below:</p>\n\n<pre><code>Do\n    ' Copy cell, then write some values\n\n    If NextSKU.Offset(0, 3) &lt;&gt; \"\" Then\n        ' Copy some more cells and write values\n    Else\n        ' Change the selection\n    End If\n\n    If NextSKU.Offset(0, 5) &lt;&gt; \"\" Then\n        ' Copy and Write\n    Else\n        ' Change Sheet selection\n    End If\n\n    ' Change Range and Sheet Selection\n\n' And right here is the key to your problem.\n' Notice that you have only changed values on the sheet,\n' as well as the selection, but never 'NextSKU'\nLoop While NextSKU.Offset(1, 0) &lt;&gt; \"\"\n</code></pre>\n\n<p>This problem is easy to avoid in two ways. First, make sure you have some kind of control variable that allows for iteration. By this I mean, you should either use a counter (for i = X to Y) or you should use a collection (for each X in Y). You can use a while loop for this, but you must change the variable that the while is pointed at.</p>\n\n<p>I strongly encourage you to learn how to avoid using <code>Select</code>, <code>Activate</code>, Etc. This code will be inefficient and error prone.</p>\n"}], "owner": {"reputation": 33, "user_id": 6836766, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208643243731580/picture?type=large", "display_name": "Gary Nolan", "link": "https://stackoverflow.com/users/6836766/gary-nolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498068212, "creation_date": 1498067387, "question_id": 44682965, "link": "https://stackoverflow.com/questions/44682965/excel-vba-loop-bug", "title": "Excel VBA Loop Bug", "body": "<p>I have a sheet that is being used to create what is eventually a text doc for HTML, but that starts in Excel. It could have anywhere from 1 - hundreds of items on it, then each item must have three fields (SKU, Description, Category), then two optional (Bullet, Image).</p>\n\n<p>It will go like this.\nSheet1 A2 copies to Sheet2 A2\nSheet2 B2 = \"Description\"\nSheet1 B2 (The description data) copies to Sheet2 C2\nSheet1 A2 recopies to a new line on Sheet2 A3\nSheet2 B3 = \"Category\"\nSheet1 C2 (Category data) copies to Sheet2 C3</p>\n\n<p>Those are the mandatory fields.\nFrom there.</p>\n\n<p>If Sheet 1 D2 (Bullet data) is populated then Sheet1 A2 copies to Sheet2 A4\nSheet2 B4 = \"Bullet\"\nSheet1 D2 copies to Sheet2 C4</p>\n\n<p>If Sheet 1 E2 (Image data) is populated, then Sheet1 A2 Copies to Sheet2 A5\nSheet2 B5 = \"IMAGE\"\nSheet1 E2 copies to Sheet2 C5</p>\n\n<p>That takes care of first line of Sheet 1. From there, I want it to loop through each row in sheet 1 column A until it gets to an empty cell in A.</p>\n\n<p>Here is what I wrote. The first part works. But it's the loop (Commented block portion) that stumps me. I'm horrible at loops. Currently, it goes into a never-ending loop until I stop it.</p>\n\n<p>Any guidance will be hugely appreciated. Thanks.</p>\n\n<pre><code>Sub MigrateToTemplate()\n\nDim NextSKU As Range\nSet NextSKU = Worksheets(\"EAPData\").Range(\"A2\").Offset(1, 0)\n\nSheets(\"EAPData\").Select\nRange(\"A2\").Select\nActiveCell.Copy\nSheets(\"TemplateTest\").Select\nRange(\"A2\").Select\nActiveCell.PasteSpecial xlPasteValues\nActiveCell.Offset(0, 1).Value = \"DESCRIPTION\"\nActiveCell.Offset(0, 2).Value = Sheets(\"EAPData\").Range(\"C2\").Value\nActiveCell.Offset(1, 0).Value = Sheets(\"EAPData\").Range(\"A2\").Value\nActiveCell.Offset(1, 1).Value = \"CATEGORY\"\nActiveCell.Offset(1, 2).Value = Sheets(\"EAPData\").Range(\"E2\").Value\n    If Sheets(\"EAPData\").Range(\"A2\").Offset(0, 3) &lt;&gt; \"\" Then\n    Sheets(\"EAPData\").Range(\"A2\").Offset(0, 3).Copy\n    Range(\"A1\").End(xlDown).Offset(1, 0).Select\n    ActiveCell.Value = Range(\"A2\").Value\n    ActiveCell.Offset(0, 1).Value = \"BULLET\"\n    ActiveCell.Offset(0, 2).PasteSpecial xlPasteValues\n    ActiveCell = WorksheetFunction.Substitute(Selection, Chr(10), \" \")\n    Else\n    Range(\"A1\").End(xlDown).Select\n    End If\nIf Sheets(\"EAPData\").Range(\"A2\").Offset(0, 5) &lt;&gt; \"\" Then\n    Sheets(\"EAPData\").Range(\"A2\").Offset(0, 5).Copy\n    Range(\"A1\").End(xlDown).Offset(1, 0).Select\n    ActiveCell.Value = Range(\"A2\").Value\n    ActiveCell.Offset(0, 1).Value = \"IMAGE\"\n    ActiveCell.Offset(0, 2).PasteSpecial xlPasteValues\n    Application.CutCopyMode = False\n    Else\n    Sheets(\"EAPData\").Select\n    End If\nSheets(\"EAPData\").Select\nNextSKU.Select\n\n'Do\n'ActiveCell.Copy\n'Sheets(\"TemplateTest\").Select\n'Range(\"A1\").End(xlDown).Offset(1, 0).Select\n'ActiveCell.PasteSpecial xlPasteValues\n'ActiveCell.Offset(0, 1).Value = \"DESCRIPTION\"\n'ActiveCell.Offset(0, 2).Value = NextSKU.Offset(0, 2).Value\n'ActiveCell.Offset(1, 0).Value = NextSKU.Value\n'ActiveCell.Offset(1, 1).Value = \"CATEGORY\"\n'ActiveCell.Offset(1, 2).Value = NextSKU.Offset(0, 4).Value\n'If NextSKU.Offset(0, 3) &lt;&gt; \"\" Then\n'    NextSKU.Offset(0, 3).Copy\n'    Range(\"A1\").End(xlDown).Offset(1, 0).Select\n'    ActiveCell.Value = NextSKU.Value\n'    ActiveCell.Offset(0, 1).Value = \"BULLET\"\n'    ActiveCell.Offset(0, 2).PasteSpecial xlPasteValues\n'    ActiveCell = WorksheetFunction.Substitute(Selection, Chr(10), \" \")\n'    Else\n'    Range(\"A1\").End(xlDown).Select\n'    End If\n'If NextSKU.Offset(0, 5) &lt;&gt; \"\" Then\n'    NextSKU.Offset(0, 5).Copy\n'    Range(\"A1\").End(xlDown).Offset(1, 0).Select\n'    ActiveCell.Value = NextSKU.Value\n'    ActiveCell.Offset(0, 1).Value = \"IMAGE\"\n'    ActiveCell.Offset(0, 2).PasteSpecial xlPasteValues\n'    Application.CutCopyMode = False\n'    Else\n'    Sheets(\"EAPData\").Select\n'    End If\n'Sheets(\"EAPData\").Select\n'NextSKU.Offset(1, 0).Select\n'Loop While NextSKU.Offset(1, 0) &lt;&gt; \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498075728, "post_id": 44682924, "comment_id": 76354897, "body": "Changing the date would be just setting the cell value to whatever date you have calculated, e.g. <code>Cells(10,&quot;X&quot;).Value = myDate</code>.  The loop would be just writing code such as <code>For i = 1 To 15</code> <code>...</code> <code>Next</code>."}, {"owner": {"reputation": 1, "user_id": 7064879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c656b9a407873e3950c86af291fbc571?s=128&d=identicon&r=PG&f=1", "display_name": "D. Cantrell", "link": "https://stackoverflow.com/users/7064879/d-cantrell"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498133159, "post_id": 44682924, "comment_id": 76380573, "body": "For each of the 15 rows the date will increase by one week. The date part is the part that is really hanging me up."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498161419, "post_id": 44682924, "comment_id": 76399538, "body": "<code>myDate = myDate + 7</code> will increase the date variable by one week.  (7 days = 1 week is the current exchange rate.)"}], "owner": {"reputation": 1, "user_id": 7064879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c656b9a407873e3950c86af291fbc571?s=128&d=identicon&r=PG&f=1", "display_name": "D. Cantrell", "link": "https://stackoverflow.com/users/7064879/d-cantrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498075626, "creation_date": 1498067253, "last_edit_date": 1531161705, "question_id": 44682924, "link": "https://stackoverflow.com/questions/44682924/i-need-to-copy-a-row-and-paste-it-into-worksheet-15x-while-changing-the-date", "title": "I need to copy a row and paste it into worksheet 15x while changing the date", "body": "<p>I receive a report in excel that has over 200 rows.  Each row needs 15 rows added with the same information but with a different date starting two weeks in the future.  There are six columns (two are blank).  </p>\n\n<p>IZU072E11NN1DTT \"\" EA 12/3/2012 \"\" 1.5</p>\n\n<p>This is currently being done manually. I want to create a macro but am unsure how to do the loop and change the date.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1498067419, "post_id": 44682880, "comment_id": 76350075, "body": "When you say <i>&quot;fails&quot;</i> do you mean it does nothing or it throws an error <b>??</b>"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "edited": false, "score": 0, "creation_date": 1498067588, "post_id": 44682880, "comment_id": 76350161, "body": "What is the formula in the cell, is it correct? if not what should the correct formula be?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498067845, "post_id": 44682880, "comment_id": 76350303, "body": "Are the years across row 2 actual dates formatted as <code>yyyy</code> or integers from 2012 to 2021?"}, {"owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "edited": false, "score": 0, "creation_date": 1498067893, "post_id": 44682880, "comment_id": 76350326, "body": "The cells that have #N/A should not be ignored. In those cells the parameter that is suppose to initiate the formula (TIES MATERIAL ) is missing so those rows should be skipped or ignored. They would then have the original value. The second image from above is what it should look like. In both cases they are numbers and not formatted as dates."}], "answers": [{"comments": [{"owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "edited": false, "score": 0, "creation_date": 1498078933, "post_id": 44683740, "comment_id": 76356511, "body": "Thanks @Brandon! Sorry for the misunderstanding the numbered subroutines were not their actual names they were for pseudo code illustration purposes. I eventually got it to work by adding a reference to the active workbook page that the material formulas are referencing."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 1, "last_activity_date": 1498070047, "creation_date": 1498070047, "answer_id": 44683740, "question_id": 44682880, "link": "https://stackoverflow.com/questions/44682880/calling-vba-subroutine-does-not-work-when-it-is-called-from-inside-of-another-su/44683740#44683740", "title": "Calling VBA subroutine does not work when it is called from inside of another subroutine", "body": "<p>Before anything else you need to improve your code. I can pretty much guarantee that this is likely happening because of poorly written code. For example:</p>\n\n<pre><code>materialID = Sheets(\"Material\").Cells(r, \"CQ\").Address(False, False)\nmaterialYear = Sheets(\"Material\").Cells(2, c).Address(False, False)\n</code></pre>\n\n<p>Note that <code>materialID</code> and <code>materialYear</code> are never declared. This means they are of the type Variant (you need to add <code>Option Explicit</code> to the top of your code modules for this exact reason). The funny thing about Variants is they, you guessed it, vary. <code>MaterialID</code> could be a <code>string</code>, an <code>int</code>, a <code>long</code>, a <code>decimal</code>, a <code>date</code>, an <code>array</code>, a <code>range</code>, etc. We can assume that the address of the range is going into <code>materialID</code>, but we can't be certain.</p>\n\n<p>Additionally, notice the pesky <code>Sheets(\"Material\")</code>. What this actually is saying is ActiveWorkboook.Sheets(\"Material\")`. Qualify your references otherwise you have pretty much no clue what is <em>actually</em> happening.</p>\n\n<p>What can easily be happening in the case of your code is that the address is correctly going into <code>materialID</code> as a <code>string</code>, but it is the address from another workbook with a sheet named \"Material\". Unlikely, but possible.</p>\n\n<p>What we do know is quite likely is that the <code>ActiveWorkbook</code> is changing in some capacity, likely in <code>Sub_Routine7</code> (sidenote here, you must descriptively name subroutines otherwise your code is nowhere near maintainability).</p>\n\n<p>Good luck with this, but I highly suggest not bothering to try to debug the situation until you have qualified your ranges, declared all your variables, and added <code>Option Explicit</code>.</p>\n"}], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "accepted_answer_id": 44683740, "answer_count": 1, "score": 0, "last_activity_date": 1498070047, "creation_date": 1498067130, "question_id": 44682880, "link": "https://stackoverflow.com/questions/44682880/calling-vba-subroutine-does-not-work-when-it-is-called-from-inside-of-another-su", "title": "Calling VBA subroutine does not work when it is called from inside of another subroutine", "body": "<p>I am using VBA to try and call a series of sub routines from the main sub routine. When I combine all of the subroutines with code similar to the following, I get #N/A for the cells that the formula is suppose to be ignoring.</p>\n\n<pre><code>Sub Main()\n\n'Turn off autocalculation\n    Application.Calculation = xlCalculationManual\n    Application.DisplayStatusBar = False\n'*********************************************************\n'A bunch of other code\n'*********************************************************\n\nCall Sub_Routine1\nCall Sub_Routine2\nCall Sub_Routine3\nCall Sub_Routine4\nCall Sub_Routine5\nCall Sub_Routine6\nCall Sub_Routine7\n\n'This is the sub routine that is not working correctly\nCall Material_Formulas\n\n'Turn back on the autocalculation function\n    Application.Calculation = xlAutomatic\n\n'*********************************************************\n'A bunch of other code\n'*********************************************************  \n    Application.DisplayStatusBar = True\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7BQZE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7BQZE.jpg\" alt=\"Combined_Call\"></a></p>\n\n<p>When I remove the Material_Formulas subroutine from the Main sub routine and run it separately using the following script, it executes as it is suppose to and looks like the image bellow.</p>\n\n<pre><code>Private Sub Material_Formulas()\n\n'Turn on manual calculation\nApplication.Calculation = xlCalculationManual\nDim lRow As Integer\nDim tiesMaterial As String\nDim result As String\nlRow = Sheets(\"Material\").Range(\"A2\").End(xlDown).Row\nlCol = Sheets(\"Material\").Range(\"A2\").End(xlToRight).Column\n\n'Starts the count at column CU\nendCount = lCol - 1    \n    For c = 99 To endCount\n        For r = 3 To lRow        \n        tiesMaterial = Cells(r, 87).Value\n\n        'Looks to see if the cells starting at CU2 contains a number and then iterates through each cell in row 3 to add a formula\n        If tiesMaterial = \"TIES MATERIAL\" Then\n\n            'Defines the unique ID and calendar year cells for the index-match-match function\n            materialID = Sheets(\"Material\").Cells(r, \"CQ\").Address(False, False)\n            materialYear = Sheets(\"Material\").Cells(2, c).Address(False, False)\n\n            'Starting in cell CU3 it adds the formula =INDEX(BOM_Summary_Array,MATCH(CQ3,BOM_Summary_ID,0),MATCH(CU2,BOM_Summary_Head,0))\n            Sheets(\"Material\").Cells(r, c).Formula = \"=INDEX(BOM_Summary_Array,MATCH(Material!\" &amp; materialID &amp; \",BOM_Summary_ID,0),MATCH(Material!\" &amp; materialYear &amp; \",BOM_Summary_Head,0))\"                 \n        End If\n\n        Next r\n    Next c     \n'Turn on the auto calculation function\nApplication.Calculation = xlAutomatic\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tJGwp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tJGwp.jpg\" alt=\"Separate_Call\"></a></p>\n\n<p>What am I doing wrong? How does it run fine when I manually and independently select it but it fails when I combine it with the other sub routines?</p>\n"}, {"tags": ["vba", "loops", "iif-function"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1498066489, "post_id": 44682669, "comment_id": 76349593, "body": "This is unreadable, please format your code so it is easier to comprehend."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1498066933, "post_id": 44682669, "comment_id": 76349821, "body": "I was going to attempt to format your code for you, until I saw the unformatted mess you decided to paste in here. Please <a href=\"https://stackoverflow.com/posts/44682669/edit\">edit</a> your post and at least <b>make an effort</b> to format it properly. As is, it&#39;s nothing but a code dump mess."}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1498067168, "post_id": 44682669, "comment_id": 76349948, "body": "Sorry, I have trouble posting the code. Rejected continuously. Code I wrote in notepad ++ then I paste it in browser. Somehow rejected every time I edit .."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1498067613, "post_id": 44682669, "comment_id": 76350180, "body": "I&#39;m going to go out on a limb here and suggest that if you have a form with 660 checkboxes (and presumably as many textboxes) you probably need to redesign the application entirely. It&#39;s <i>possible</i> to do this (e.g., via parameterized function or subroutine, etc) but it&#39;s not very clear what you&#39;re trying to do here..."}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1498068277, "post_id": 44682669, "comment_id": 76350542, "body": "I created a mapping that in 1 row represented 1 main checkbox. Each row has 22 checkboxes. Overall there are 30 rows of main checkboxes. And when I try, it turns out the application runs smoothly. Then I make another form that serves to take the value from the form earlier. It&#39;s just a checkbox I replace with a text box that will fill in the written value of the mapping. So if the form that contains the checkbox is true, then the text box on the following form is available for the contents of the value ..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498069061, "post_id": 44682669, "comment_id": 76350982, "body": "&quot;form&quot; means UserForm object? It looks like these textboxes are <i>always</i> enabled, but you only toggle the BackgroundColor based on the checkbox, is that right?  (NB: it&#39;s still not clear what you&#39;re trying to do)"}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1498069988, "post_id": 44682669, "comment_id": 76351518, "body": "I simplify it. I created two userforms and named userform1 and userform2. On userform1 I create checkboxes, say 100 pieces. Which consists of 10 parent check boxes and 90 sub checkboxes. Then on userform2, I created 100 text boxes, the same as userform1. Function of the text box here, will be active if the check box from userform1 is true, and the text box can be edited"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498071730, "post_id": 44682669, "comment_id": 76352627, "body": "Please EDIT your question with these details. Doing so bumps it on the front page so that the question gains visibility. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, take the <a href=\"https://stackoverflow.com/tour\">tour</a> and consider providing an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1498158120, "post_id": 44685223, "comment_id": 76397720, "body": "Oh sorry, i mistakenly wrote the vba code, it should be:  If UserForm1.checkbox15.Value = True Then UserForm2.textbox1.Locked = False UserForm2.textbox1.BackColor = RGB(255, 255, 255) Else UserForm2.textbox1.Locked = True UserForm2.textbox1.BackColor = RGB(200, 200, 200) End If  ... etc  I have tested it and succeeded. It&#39;s just that you forgot to add a command to enable the textbox function.  But your advice is very bright and I can apply. thank you for all"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1498078159, "last_edit_date": 1498078159, "creation_date": 1498075063, "answer_id": 44685223, "question_id": 44682669, "link": "https://stackoverflow.com/questions/44682669/how-loop-if-function-in-vba/44685223#44685223", "title": "how loop if function in VBA", "body": "<p>Define your color long values as <code>Const</code> outside of the subroutines, at the top of the module.</p>\n\n<pre><code>Public Const bgColorTrue As Long = 13158600  '## RGB(200,200,200)\nPublic Const bgColorFalse As Long = 16777215 '## RGB(255,255,255)\n</code></pre>\n\n<p>Then you can do something like this, which is somewhat more simplified, but still requires enumerating all of the pair of TextBox + CheckBox.</p>\n\n<pre><code>UserForm2.textbox1.BackColor = IIF(UserForm1.checkbox15.Value = True, bgColorTrue, bgColorFalse)\nUserForm2.textbox2.BackColor = IIF(UserForm1.checkbox16.Value = True, bgColorTrue, bgColorFalse)\nUserForm2.textbox3.BackColor = IIF(UserForm1.checkbox17.Value = True, bgColorTrue, bgColorFalse)\nUserForm2.textbox4.BackColor = IIF(UserForm1.checkbox18.Value = True, bgColorTrue, bgColorFalse)\nUserForm2.textbox5.BackColor = IIF(UserForm1.checkbox19.Value = True, bgColorTrue, bgColorFalse)\n' etc...\n</code></pre>\n\n<p>Or (assuming the arithmetic relationship between the indexes of the checkboxes and textboxes is constant), you can do a loop and create a subroutine to identify which TextBox pairs with which CheckBox:</p>\n\n<pre><code>Dim cb as MSForms.CheckBox, ctrl as Control\nFor Each ctrl in UserForm1.Controls\n    If TypeName(cb) = \"CheckBox\" Then\n        Call UpdateForm2(cb, UserForm2)\n    End If\nNext\n</code></pre>\n\n<p>Using a sub like:</p>\n\n<pre><code>Sub UpdateForm2(ByRef cb as MSForms.CheckBox, byRef Uf as UserForm)\n    Dim tb as MSForms.TextBox\n    Dim iCB as Long, iTB as Long\n    '## Get the index of this CheckBox name:\n    iCB = CLng(Replace(cb.Name, \"checkbox\", vbNullString))\n    '## Compute the index of corresponding TextBox name\n    iTB = iCB - 14\n    '## Handle the TextBox on the other UserForm\n    Set tb = Uf.Controls(\"TextBox\" &amp; iTB)\n    tb.BackColor = IIF(cb.Value = True, bgColorTrue, bgColorFalse)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 44685223, "answer_count": 1, "score": -2, "last_activity_date": 1498135962, "creation_date": 1498066366, "last_edit_date": 1498135962, "question_id": 44682669, "link": "https://stackoverflow.com/questions/44682669/how-loop-if-function-in-vba", "title": "how loop if function in VBA", "body": "<p>How to repeat the if function in a vba code Hello, all I create a command line using if on a form. But I have trouble writing it over and over again. Is there a proper way to simplify this writing?  </p>\n\n<pre><code>If UserForm1.checkbox15.Value = True Then\nUserForm2.textbox1.enable = True\nUserForm2.textbox1.BackColor = RGB(200, 200, 200)\nElse\nUserForm2.textbox1.enable = True\nUserForm2.textbox1.BackColor = RGB(255, 255, 255)\nEnd If\n\nIf UserForm1.checkbox16.Value = True Then\nUserForm2.textbox2.enable = True\nUserForm2.textbox2.BackColor = RGB(200, 200, 200)\nElse\nUserForm2.textbox2.enable = True\nUserForm2.textbox2.BackColor = RGB(255, 255, 255)\nEnd If\n\nIf UserForm1.checkbox17.Value = True Then\nUserForm2.textbox3.enable = True\nUserForm2.textbox3.BackColor = RGB(200, 200, 200)\nElse\nUserForm2.textbox3.enable = True\nUserForm2.textbox3.BackColor = RGB(255, 255, 255)\nEnd If\n\nIf UserForm1.checkbox18.Value = True Then\nUserForm2.textbox4.enable = True\nUserForm2.textbox4.BackColor = RGB(200, 200, 200)\nElse\nUserForm2.textbox4.enable = True\nUserForm2.textbox4.BackColor = RGB(255, 255, 255)\nEnd If\n</code></pre>\n\n<p>.... .... .... to textbox660 ...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1498066432, "post_id": 44682637, "comment_id": 76349566, "body": "<code>txtTotalEarnings.Value = txtCostofProduct.Value * txtUnitsSold.Value</code> and so on.  Note that I&#39;m just guessing the textbox names. What have you tried?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1498066926, "post_id": 44682637, "comment_id": 76349817, "body": "@tigeravatar you&#39;ll want to convert these strings to numerics before you perform arithmetics on them. Otherwise you let VBA decide, <a href=\"https://stackoverflow.com/q/44680791/1188513\">and it may not do what you want it to</a>."}], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "is_accepted": true, "score": 0, "last_activity_date": 1498078949, "creation_date": 1498078949, "answer_id": 44686230, "question_id": 44682637, "link": "https://stackoverflow.com/questions/44682637/arithmetic-operations-in-a-userform/44686230#44686230", "title": "Arithmetic Operations in a Userform", "body": "<p>So, here is my take on this solution. It isn't a very complicated program to create. Overall, it is one UserForm, following the design of yours in the image with one section of code doing the calculations and one section of code that ensures the values input in the textboxes are numeric. The interface is a combination of labels and textboxes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uhoow.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uhoow.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is a code for each textbox that evaluates whether the value entered is numerica and alerts you if it is not. Each routine uses the IsNumeric function for the purpose and also sees if there is a value in the textbox at all. The AfterUpdate event ensures that the routine only runs after you input something. You have the option of either having a routine for each textbox separately, or write a more integrated routine in a module that each textbox references. For the sake of the example: </p>\n\n<pre><code>Private Sub txtCost_AfterUpdate()\n\n        With UserForm1\n            With .txtCost\n\n                If Not IsNumeric(.Value) Or .Value = \"\" Then\n                    MsgBox \"Please enter a numeric value only!\"\n                End If\n\n            End With\n        End With\n</code></pre>\n\n<p>End Sub</p>\n\n<pre><code>    Private Sub txtReturned_AfterUpdate()\n\n        With UserForm1\n            With .txtReturned\n                If Not IsNumeric(.Value) Or .Value = \"\" Then\n                    MsgBox \"Please ensure you enter only numeric values\"\n\n                End If\n\n            End With\n        End With\n    End Sub\n\n    Private Sub txtTotalFix_AfterUpdate()\n        With UserForm1\n            With .txtTotalFix\n\n                If Not IsNumeric(.Value) Or .Value = \"\" Then\n                    MsgBox \"Please ensure you enter only numeric values\"\n                End If\n\n            End With\n        End With\n    End Sub\n\n    Private Sub txtUnits_AfterUpdate()\n\n        With UserForm1\n            With .txtUnits\n\n                If Not IsNumeric(.Value) Or .Value = \"\" Then\n                    MsgBox \"Please ensure you enter only numeric values\"\n                End If\n\n            End With\n\n        End With\n    End Sub\n</code></pre>\n\n<p>The meat and potatoes of the routine are also not complicated. I've directly used the values of each textbox to spit out the values of the computations. Alternatively, you might choose to use variables (I've decalred x As Double, because you could be dealing with quite large numbers, but it isn't used in this example). The routine lives in Module1 and checks that all the values are numbers with the same IsNumeric function and runs through the formulas, alerting you if any of them are empty or not a number. I wasn't positive of how you calculated savings or your criteria of YES or NO, so you may have to adjust that. </p>\n\n<pre><code>Sub QA_prog()\n\nDim x As Double\n\nWith UserForm1\n\n    If IsNumeric(.txtCost.Value) And IsNumeric(.txtUnits.Value) _\n        And IsNumeric(.txtReturned.Value) And IsNumeric(.txtTotalFix.Value) Then\n\n             .lblEarn.Caption = .txtCost.Value * .txtUnits.Value\n             .lblTRC.Caption = .txtCost * .txtTotalFix\n             .lblProfit = .lblEarn.Caption - .lblTRC.Caption\n             .lblCostFix = .txtReturned * .txtTotalFix\n             .lblTE.Caption = .lblProfit - .lblCostFix\n             .lblSave.Caption = .lblTRC + .lblCostFix\n\n            If .lblSave.Caption &gt; 5000 Then\n                .txtYorN.Text = \"NO\"\n            Else\n                .txtYorN.Text = \"YES\"\n            End If\n\n    Else\n\n        MsgBox \"Double check your values!\"\n\n    End If\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Finally, the buttons. Exit button closes the program using Unload:</p>\n\n<pre><code>Private Sub cmdExit_Click()\nUnload UserForm1\nEnd Sub\n</code></pre>\n\n<p>Calculate button calls the QA Sub routine:</p>\n\n<pre><code>Private Sub cmdCalc_Click()\nModule1.QA_prog\nEnd Sub\n</code></pre>\n\n<p>To trigger the program, you just need to add a button to the spreadsheet and type \"<code>UserForm1.show</code>\" in its code window to activate the program.</p>\n"}], "owner": {"reputation": 23, "user_id": 8195618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2T-uigfnIkg/AAAAAAAAAAI/AAAAAAAAEhc/rEBZnW3x_jQ/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/8195618/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 44686230, "answer_count": 1, "score": -2, "last_activity_date": 1499676930, "creation_date": 1498066287, "last_edit_date": 1499676930, "question_id": 44682637, "link": "https://stackoverflow.com/questions/44682637/arithmetic-operations-in-a-userform", "title": "Arithmetic Operations in a Userform", "body": "<p>I have made the userform so I will use that to describe my problem.</p>\n\n<p>I want to take four user inputs (cost of product, number of units sold, number of units returned, and cost of fix per unit) and calculate 6 things from it such as total earnings (cost of product x number of units sold) and total returned cost (cost of product x number of units returned).</p>\n\n<p>How would I go about writing the code?</p>\n\n<p>Userform image here: <a href=\"https://imgur.com/a/qc3Kk\" rel=\"nofollow noreferrer\">http://imgur.com/a/qc3Kk</a></p>\n"}, {"tags": ["vba", "excel", "indexing", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498065974, "post_id": 44682448, "comment_id": 76349303, "body": "Beat me to it. except i had <code>&quot;&quot;</code> instead :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498066108, "post_id": 44682448, "comment_id": 76349391, "body": "Yeah, I&#39;ve been proselytizing the use of <code>text(,)</code> instead of <code>&quot;&quot;</code> for a few weeks now (especially on <a href=\"https://stackoverflow.com/questions/tagged/excel-vba\">excel-vba</a> questions)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498066190, "post_id": 44682448, "comment_id": 76349434, "body": "@Jeeped - Any advantage to using <code>text(,)</code> over <code>&quot;&quot;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1498066527, "post_id": 44682448, "comment_id": 76349606, "body": "You don&#39;t have to double-up double quotes within a quoted string when trying to apply a formula to a range in <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>. In the above, <code>&quot;x&quot;</code> will have to be changed to <code>&quot;&quot;x&quot;&quot;</code> but <code>text(,)</code> is left alone and not changed from <code>&quot;&quot;</code> to <code>&quot;&quot;&quot;&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1498066960, "post_id": 44682448, "comment_id": 76349833, "body": "Of course, <code>&quot;x&quot;</code> could be replaced with <code>char(120)</code> to avoid that double-up as well."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1498065555, "creation_date": 1498065555, "answer_id": 44682448, "question_id": 44682341, "link": "https://stackoverflow.com/questions/44682341/excel-checking-multiple-vlookup-instances-for-equality-to-a-cell/44682448#44682448", "title": "Excel: checking multiple vlookup instances for equality to a cell", "body": "<p>Try,</p>\n\n<pre><code>=if(countifs(Sheet1!$A$2:$A$362, A2, Sheet1!$E$2:$E$362, B1), \"x\", text(,))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8195357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7daf62a413fe9e7c4cb73defbd7bfea3?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/8195357/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498065555, "creation_date": 1498065196, "question_id": 44682341, "link": "https://stackoverflow.com/questions/44682341/excel-checking-multiple-vlookup-instances-for-equality-to-a-cell", "title": "Excel: checking multiple vlookup instances for equality to a cell", "body": "<p>I have an excel formula that looks like this in psuedocode:</p>\n\n<p>if\n   vlookup = column name\nthen\n   change value of cell to x\n...</p>\n\n<p>I need to make it something like:</p>\n\n<p>if\n   ANY INSTANCE OF vlookup = column name\nthen\n   change value of cell to x</p>\n\n<p>...\nMy code at the moment is :\n=IF(VLOOKUP(A2,Sheet1!$A$2:$K$362,5,FALSE)=$B$1,\"x\",\"\")</p>\n\n<p>How can I make it so that it compares multiple instances of vlookup to the string in B1 and not just the first instance? In other words, the A2 value repeats in the range but the value at each index 5 is different. I need to compare those all to the value of B1 independently.</p>\n"}, {"tags": ["vba", "outlook"], "owner": {"reputation": 1069, "user_id": 1570210, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/2e79ce535bafbee3659742bc7e17f695?s=128&d=identicon&r=PG", "display_name": "user1570210", "link": "https://stackoverflow.com/users/1570210/user1570210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1593075434, "creation_date": 1498064318, "last_edit_date": 1593075434, "question_id": 44682088, "link": "https://stackoverflow.com/questions/44682088/clickable-embed-pdf", "title": "Clickable embed PDF", "body": "<p>I am trying to embed a clickable PDF in the body of email. </p>\n\n<p>This code does embed PDF on the body of email but when I double click on image PDF file does not open. </p>\n\n<p>Is there anyway I can have clickable image?</p>\n\n<pre><code>Public Sub InsetObject()\n    Dim Inspector As Outlook.Inspector\n    Dim wdDoc As Word.Document\n    Dim Selection As Word.Selection\n    Dim Email As Outlook.MailItem\n    Dim LinkToFile As Object\n\n\n    Set Email = Application.CreateItem(olMailItem)\n\n    With Email\n        .To = \"XXX@XXXXX.com\"\n        .Subject = \"XXX Dashboard\"\n        .Attachments.Add (\"C:\\Work\\Daily Dashboard.pdf\")\n        .Display\n\n         Set Inspector = Application.ActiveInspector()\n         Set wdDoc = Inspector.WordEditor\n         Set Selection = wdDoc.Application.Selection\n\n         Selection.InlineShapes.AddOLEObject ClassType:=\"AcroExch.Document.11\", _\n                   FileName:=\"C:\\Work\\Daily Dashboard.pdf\", _\n                   LinkToFile:=False, DisplayAsIcon:=False\n\n        .Send\n\n    End With\n\n    Set Inspector = Nothing\n    Set wdDoc = Nothing\n    Set Selection = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1498065105, "creation_date": 1498065105, "answer_id": 44682315, "question_id": 44681976, "link": "https://stackoverflow.com/questions/44681976/how-can-i-get-this-vba-code-to-work-with-any-selected-columns/44682315#44682315", "title": "How can I get this VBA code to work with any selected columns?", "body": "<p>May be this:</p>\n\n<pre><code>With Selection\n  .FormulaR1C1 = \"=MIN(RC[-12]:RC[-8],RC[-6]:RC[-2])\"\n  .Offset(,1).FormulaR1C1 = \"=MAX(RC[-13]:RC[-9],RC[-7]:RC[-3])\"\n  .Offset(,2).FormulaR1C1 = \"=AVERAGE(RC[-14]:RC[-10],RC[-8]:RC[-4])\"\n  .Offset(,3).FormulaR1C1 = \"=STDEV.S(RC[-15]:RC[-11],RC[-9]:RC[-5])\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8195547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a7b720fe47231c652979b21c767dc6c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Byers", "link": "https://stackoverflow.com/users/8195547/brandon-byers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498065105, "creation_date": 1498063941, "question_id": 44681976, "link": "https://stackoverflow.com/questions/44681976/how-can-i-get-this-vba-code-to-work-with-any-selected-columns", "title": "How can I get this VBA code to work with any selected columns?", "body": "<p>Currently I'm trying to get the min, max, average, and standard deviation for a set of numbers. I want to be able to select any columns and be able to find this data. Even if I had to conduct the selections seperatly. How can I get this to work? Look below:</p>\n\n<pre><code>Range(\"P4\").Select\nActiveCell.FormulaR1C1 = \"=MIN(RC[-12]:RC[-8],RC[-6]:RC[-2])\"\nRange(\"Q4\").Select\nActiveCell.FormulaR1C1 = \"=MAX(RC[-13]:RC[-9],RC[-7]:RC[-3])\"\nRange(\"R4\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(RC[-14]:RC[-10],RC[-8]:RC[-4])\"\nRange(\"S4\").Select\nActiveCell.FormulaR1C1 = \"=STDEV.S(RC[-15]:RC[-11],RC[-9]:RC[-5])\"\nRange(\"P4:S4\").Select\nSelection.AutoFill Destination:=Range(\"P4:S68\"), Type:=xlFillDefault\nRange(\"P4:S68\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba", "format"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1498062958, "post_id": 44681621, "comment_id": 76347570, "body": "The row number is missing in the range being copied ws.Range(&quot;A2:AJ?&quot;).Copy..... replace ? with row number and it will work."}, {"owner": {"reputation": 39, "user_id": 7547064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b28245821609645813f987bc49a949?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/7547064/matt"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1498065389, "post_id": 44681621, "comment_id": 76348936, "body": "Wow. I can&#39;t believe I missed that. Thanks."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1498065615, "post_id": 44681621, "comment_id": 76349098, "body": "You&#39;re welcome!"}], "owner": {"reputation": 39, "user_id": 7547064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b28245821609645813f987bc49a949?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/7547064/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498062706, "creation_date": 1498062706, "question_id": 44681621, "link": "https://stackoverflow.com/questions/44681621/paste-formatting-from-one-range-to-another-in-a-loop", "title": "Paste formatting from one range to another in a loop", "body": "<p>I'm using the following code to compare two worksheets. If a record doesn't exist in the second worksheet I copy certain columns from the first worksheet to the second. </p>\n\n<p>The problem I'm having is that I need the formatting on the new lines in Sheet2 to match the formatting in the rest of the worksheet. I added the code between the \"New Code\" comment block but I keep getting the error message: Run-time error '1004': Method 'Range' of object'_Worksheet' failed. </p>\n\n<p>The error is occurring on this line: ws.Range(\"A2:AJ\").Copy</p>\n\n<p>I'm using Excel 2013 if that helps. </p>\n\n<p>Thanks for your help. </p>\n\n<pre><code>    Option Explicit\n\n    Sub CheckData()\n\n        Dim Lastrow, Newrow As Long\n        Dim i As Long\n        Dim ws As Worksheet\n        Dim rng As Range\n\n    ' Turn off notifications\n        Application.ScreenUpdating = False\n\n        Set ws = Worksheets(\"Sheet1\")\n        Set rng = ws.Range(\"A2:AJ2\")\n\n        Workbooks.OpenText Filename:=\"C:\\Test.xlsx\"\n        With Workbooks(\"Test.xlsx\").Worksheets(\"Sheet1\")\n\n            Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            For i = 2 To Lastrow\n\n                If IsError(Application.Match(.Cells(i, \"A\").Value, ws.Columns(\"A\"), 0)) Then\n\n                   Newrow = ws.Range(\"A1\").End(xlDown).Row + 1\n                   .Cells(i, \"A\").Copy ws.Cells(Newrow, \"A\")\n                   .Cells(i, \"B\").Copy ws.Cells(Newrow, \"E\")\n                   .Cells(i, \"C\").Copy ws.Cells(Newrow, \"F\")\n                   .Cells(i, \"D\").Copy ws.Cells(Newrow, \"G\")\n                   .Cells(i, \"E\").Copy ws.Cells(Newrow, \"H\")\n                   ws.Cells(Newrow, \"I\") = \"New submission created on\" &amp; \" \" &amp; .Cells(i, \"L\")\n                   .Cells(i, \"F\").Copy ws.Cells(Newrow, \"J\")\n                   .Cells(i, \"G\").Copy ws.Cells(Newrow, \"K\")\n                   .Cells(i, \"H\").Copy ws.Cells(Newrow, \"L\")\n                   .Cells(i, \"I\").Copy ws.Cells(Newrow, \"M\")\n                   .Cells(i, \"J\").Copy ws.Cells(Newrow, \"N\")\n                   ws.Cells(Newrow, \"AJ\") = Format(Date, \"yyyy-mm-dd\")\n\n                   'New Code\n\n                   ws.Range(\"A2:AJ\").Copy\n                   ws.Cells(Newrow, \"A\").PasteSpecial _\n                   Paste:=xlPasteFormats, Operation:=xlNone, _\n                   SkipBlanks:=False, Transpose:=False\n                   Application.CutCopyMode = False\n\n                   'End New Code\n\n                End If\n\n            Next i\n\n        End With\n\n        Workbooks(\"Test.xlsx\").Close savechanges:=False\n\n    ' Turn on notifications\n        Application.ScreenUpdating = True\n\n    ' Message Box showing that process is complete.\n\n        MsgBox \"Done!\"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "vsto", "outlook-addin", "outlook-2010"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1498063498, "creation_date": 1498063498, "answer_id": 44681850, "question_id": 44681317, "link": "https://stackoverflow.com/questions/44681317/custom-extended-properties-on-appointmentitem-is-not-available-for-recipients/44681850#44681850", "title": "Custom Extended Properties on AppointmentItem is not available for Recipients", "body": "<p>Keep in mind that ApointmentItem object is never sent - Outlook creates a MeetingItem object and sends. The original ApointmentItem remains in the Calendar folder. </p>\n\n<p>You can try to use Application.ItemSend event - Outlook will pass MeetingItem as the parameter, and you should be able to set the extra properties. Now where these properties will be copied by Outlook from MeetingItem in the Inbox to the new ApointmentItem is a different question... </p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1498144756, "creation_date": 1498144756, "answer_id": 44703458, "question_id": 44681317, "link": "https://stackoverflow.com/questions/44681317/custom-extended-properties-on-appointmentitem-is-not-available-for-recipients/44703458#44703458", "title": "Custom Extended Properties on AppointmentItem is not available for Recipients", "body": "<p>I have already replied to your post on <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/5797927c-b771-40c4-8502-87c346e8b22c/how-to-added-named-property-into-a-meeting-item?forum=outlookdev\" rel=\"nofollow noreferrer\">MSDN forums</a> two days ago:</p>\n\n<blockquote>\n  <p>The fact is that a meeting item is not sent to a recipient. Instead, a corresponding meeting request is created and sent to the recipient. Just check the message class of the item when the item is sent. You can handle the ItemSend event of the Application class which is fired whenever an Microsoft Outlook item is sent, either by the user through an  Inspector (before the inspector is closed, but after the user clicks the Send button) or when the Send method for an Outlook item.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 8195398, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UtU1kkSElDE/AAAAAAAAAAI/AAAAAAAAUh8/EmLPlnrArZY/photo.jpg?sz=128", "display_name": "Ravikumar Maikandan", "link": "https://stackoverflow.com/users/8195398/ravikumar-maikandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593070423, "creation_date": 1498061678, "last_edit_date": 1593070423, "question_id": 44681317, "link": "https://stackoverflow.com/questions/44681317/custom-extended-properties-on-appointmentitem-is-not-available-for-recipients", "title": "Custom Extended Properties on AppointmentItem is not available for Recipients", "body": "<p>Before sending the appointmentItem in outlook 2010 I have created an extended property and set some values. The property is not available for the recipient (recipients are using outlook and they are from the same domain). </p>\n\n<p>However, the property is available in the owner's calendar item. </p>\n\n<p>Any inputs about this issue is much appreciated.</p>\n"}, {"tags": ["vba", "excel", "automation", "runtime-error"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498060614, "post_id": 44680883, "comment_id": 76346215, "body": "See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid Select</a> and probably that will solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1498060803, "creation_date": 1498060803, "answer_id": 44681027, "question_id": 44680883, "link": "https://stackoverflow.com/questions/44680883/excel-vba-automation-error-second-time-code-runs/44681027#44681027", "title": "Excel VBA Automation Error second time code runs", "body": "<p>Without using <code>Select</code>, this should solve it I think:</p>\n\n<pre><code>With Sheets(\"Panel Resumen\")\n    .Rows(\"55:69\").Copy\n    .Rows(\"55:55\").Insert Shift:=xlDown\nEnd With\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7431581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4522ca4d048da449341ef623ea1c1aec?s=128&d=identicon&r=PG&f=1", "display_name": "Alvatroc", "link": "https://stackoverflow.com/users/7431581/alvatroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498060803, "creation_date": 1498060281, "question_id": 44680883, "link": "https://stackoverflow.com/questions/44680883/excel-vba-automation-error-second-time-code-runs", "title": "Excel VBA Automation Error second time code runs", "body": "<p>In VBA Excel I get an Automation Error the second time I run my code.\nIt is as follows:</p>\n\n<pre><code>Sheets(\"Panel Resumen\").Select\nRows(\"55:69\").Select\nSelection.Copy\nRows(\"55:55\").Select\nSelection.Insert Shift:=xlDown\nRange(\"D25\").Select\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>And it triggers the error in the line</p>\n\n<pre><code>Selection.Insert Shift:=xlDown\n</code></pre>\n\n<p>I researched and got to this link <a href=\"https://support.microsoft.com/en-us/help/178510/excel-automation-fails-second-time-code-runs\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/178510/excel-automation-fails-second-time-code-runs</a>\nbut I don't get which is the object I am failing to call</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "userform", "calculated-field"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1498060215, "post_id": 44680791, "comment_id": 76345944, "body": "You need to cast your strings as numeric e.g. try <code>CINT(ME.VALUE)</code> if these are integers or <code>CLNG(ME.VALUE)</code> if they have decimal places"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1498060474, "post_id": 44680791, "comment_id": 76346125, "body": "@MiguelH Thanks, not sure why I didn&#39;t think of that. Excellent thanks for the answer"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1498060615, "post_id": 44680791, "comment_id": 76346217, "body": "You might also be interested in this ..<a href=\"http://www.ozgrid.com/VBA/validate-numbers.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/validate-numbers.htm</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1498061312, "post_id": 44680791, "comment_id": 76346652, "body": "@MiguelH <code>CLng</code> converts to a <code>Long</code>, which is a 32-bit integer type (i.e. doesn&#39;t have decimals). If you need decimals you use <code>CDec</code> to get a <code>Decimal</code>, <code>CDbl</code> to get a <code>Double</code>, or <code>CSng</code> to get a <code>Single</code>, keeping in mind that floating-point rounding errors are more likely on <code>Single</code> and <code>Double</code> types, depending on what you end up doing with the converted numbers."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498117171, "post_id": 44680791, "comment_id": 76369282, "body": "@Mat&#39;sMug oops! .. a little a bit of PEBCAK on my part! Of course it is &#39;CDec&#39; :-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498065994, "post_id": 44681576, "comment_id": 76349323, "body": "@A.S.H that&#39;s probably correct, too lazy to check, edited... damn implicit type conversions all over the place..."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1506017130, "last_edit_date": 1506017130, "creation_date": 1498062565, "answer_id": 44681576, "question_id": 44680791, "link": "https://stackoverflow.com/questions/44680791/values-not-calculating-in-userform/44681576#44681576", "title": "Values not calculating in Userform", "body": "<p>You have:</p>\n\n<pre><code>totalBox.Text = box1.Text + box2.Text\n</code></pre>\n\n<p>When the two operands are <code>String</code>, the <code>+</code> operator works as a string concatenation operator, meaning it works exactly like the <code>&amp;</code> operator. That's how you get <code>1010</code> instead of <code>20</code>: VBA thinks you're asking it to <em>concatenate</em> strings.</p>\n\n<p>VBA cannot do arithmetics on strings, so if your strings <em>represent</em> numeric values, you need to convert them first.</p>\n\n<p>If you're only working with integers then you can do this with the <code>CLng</code> type conversion function:</p>\n\n<pre><code>totalBox.Text = CStr(CLng(box1.Text) + CLng(box2.Text))\n</code></pre>\n\n<p>Notice this makes the back-to-string conversion explicit (<code>CStr</code>); leave it out and VBA will perform that type conversion implicitly.</p>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1506017130, "creation_date": 1498060018, "question_id": 44680791, "link": "https://stackoverflow.com/questions/44680791/values-not-calculating-in-userform", "title": "Values not calculating in Userform", "body": "<p>Can someone please help me.</p>\n\n<p>I have a userform which has a number of numeric fields. The issue is that my Total box will not calculate them as it is recognising a number as text. So for example if I was to say HE.Value (10) + ME.Value (10) for example should = 20 however is the Total is coming to 1010. and if I * it instead I am receiving an error to debug as it recognises the value as text format.</p>\n\n<p>I have never had this issue in a userform before. Is someone able to assist please?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498060399, "post_id": 44680757, "comment_id": 76346076, "body": "<code>LookAt:=xlWhole</code> is sensitive to extra spaces in the cell. Try with <code>LookAt:=xlPart</code> to see if that&#39;s the cause of failue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498064822, "post_id": 44680757, "comment_id": 76348608, "body": "Are any of your columns hidden?"}, {"owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498068935, "post_id": 44680757, "comment_id": 76350918, "body": "@A.S.H that did not work :("}, {"owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498068949, "post_id": 44680757, "comment_id": 76350926, "body": "@TimWilliams no they are not"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "edited": false, "score": 0, "creation_date": 1498068857, "post_id": 44680864, "comment_id": 76350873, "body": "Thanks this works perfectly! However, I forgot to mention that I wanted to also copy and paste the values from another specific column (column AI) into this newly inserted column. How would I refer to this?  With my previous code this is how it was defined:      lr = Cells(Rows.Count, &quot;AI&quot;).End(xlUp).Row     Range(Cells(5, ColHeaders.Column - 1), Cells(lr, ColHeaders.Column - 1)) = Range(Cells(5, &quot;AI&quot;), Cells(lr, &quot;AI&quot;)).Value"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1498060232, "creation_date": 1498060232, "answer_id": 44680864, "question_id": 44680757, "link": "https://stackoverflow.com/questions/44680757/why-is-the-range-find-working-for-only-certain-column-names-vba/44680864#44680864", "title": "Why is the Range.Find working for only certain column names? VBA", "body": "<p>Use <code>application.match</code> instead for a more reliable string location.</p>\n\n<pre><code>dim var as variant\nwith workSheets(NewSheet)\n    var = application.match(\"Paid to Date\", .rows(4), 0)\n    if not iserror(var) then\n         .columns(var).entirecolumn.insert\n         .cells(4, var) = format(.cells(2, \"D\"), \"\\P\\a\\i\\d \\O\\n mm/dd\")\n    end if\nend with\n</code></pre>\n\n<p>In your original code you are not supplying enough parameters to the .Find operation to overcome settings that the user may have changed (and are being inherited into the VBA operation.</p>\n"}], "owner": {"reputation": 73, "user_id": 8103916, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10155670569059245/picture?type=large", "display_name": "Ritu Mishra", "link": "https://stackoverflow.com/users/8103916/ritu-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 44680864, "answer_count": 1, "score": 0, "last_activity_date": 1498060232, "creation_date": 1498059940, "question_id": 44680757, "link": "https://stackoverflow.com/questions/44680757/why-is-the-range-find-working-for-only-certain-column-names-vba", "title": "Why is the Range.Find working for only certain column names? VBA", "body": "<p>The goal is to search for a specific column header..in this case \"Paid to Date\" (exact match only) and insert a new column right before it and name it. \nThis formula does not pick up the column even though it is there..but if i change the find(what:=\"Paid to Date\") to another column such as \"Close Date\"..it works..but then i tried other columns and some work and some don't ..trying to figure out what is the reason for this?   </p>\n\n<pre><code> Sheets(NewSheet).Select\n    Set ColHeaders = Range(\"A4:CD4\").Find(What:=\"Paid to Date\", LookIn:=xlValues, LookAt:=xlWhole)\n    If ColHeaders Is Nothing Then\n    MsgBox \"Paid to Date Column was not found.\"\n    Exit Sub\n    Else\n    Columns(ColHeaders.Column).Insert\n    Cells(4, ColHeaders.Column - 1).Value = \"Paid On \" &amp; Month(Range(\"D2\")) &amp; \"/\" &amp; Day(Range(\"D2\"))\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1498060131, "post_id": 44680726, "comment_id": 76345871, "body": "Change the <code>Debug.Print</code> line to <code>debug.print err.description</code> to ensure the error is what you think it is."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1498060675, "post_id": 44680726, "comment_id": 76346260, "body": "Also, Gord Thompson has written <b>a lot</b> of code on Stack Overflow. It might be helpful if you add the link to the answer you are referring to."}], "owner": {"reputation": 1, "user_id": 8195085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604001961ba834970c6b2ee87603cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "Walt Elliott", "link": "https://stackoverflow.com/users/8195085/walt-elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498059969, "creation_date": 1498059886, "last_edit_date": 1498059969, "question_id": 44680726, "link": "https://stackoverflow.com/questions/44680726/i-get-an-exclusive-open-failure-when-running-code-provided-by-gord-thompson", "title": "I get an Exclusive Open failure when running code provided by Gord Thompson", "body": "<p>I'm trying to use Gord's code to open and update a database.  I have modified the database path to my location.  The database to be updated is closed and no other users.  Any assistance will be greatly appreciated.  This is what I have:</p>\n\n<pre><code>Sub UpdatePublicDatabase()\nDim con As Object\nSet con = CreateObject(\"ADODB.Connection\")\nOn Error GoTo UpdatePublicDatabase_OpenError\ncon.Open _\n        \"Driver={Microsoft Access Driver (*.mdb, *.accdb)};\" &amp; _\n        \"Dbq=C:\\Users\\wfejr\\Desktop\\Sean's Program Files\\Access Sales Tax Database.accdb;\" &amp; _\n        \"Exclusive=1;\" &amp; _\n        \"Uid=admin;\" &amp; _\n        \"Pwd=;\"\nOn Error GoTo 0\ncon.Execute \"DELETE FROM UpdateInfo\"\ncon.Execute \"INSERT INTO UpdateInfo SELECT * FROM [MS Access;DATABASE=\" &amp; Updater.accdb &amp; \";].[UpdateInfo]\"\ncon.Close\nDebug.Print \"Done.\"\nExit Sub\n\nUpdatePublicDatabase_OpenError:\nDebug.Print \"Exclusive 'Open' failed. Quitting.\"\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "delete-row"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498059789, "post_id": 44680633, "comment_id": 76345621, "body": "Take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823.aspx\" rel=\"nofollow noreferrer\">RemoveDuplcates method</a>"}, {"owner": {"reputation": 13, "user_id": 8195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41680c295b68dca740a40a02ac560c96?s=128&d=identicon&r=PG&f=1", "display_name": "SomeUser", "link": "https://stackoverflow.com/users/8195189/someuser"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498061391, "post_id": 44680633, "comment_id": 76346698, "body": "Thanks! I actually was using that method at first but I also only want the row to be deleted if it doesn&#39;t say &quot;Shipping Notification&quot;, which I couldn&#39;t figure out how to do with the RemoveDuplicates method"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498062188, "post_id": 44680633, "comment_id": 76347191, "body": "I guess <code>colPO</code> should be <code>colPO.Column</code> in the line that raises the error (in both places)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1498071454, "post_id": 44680633, "comment_id": 76352436, "body": "What does colReq contain at the time you are trying to execute that line?  Hint: when you stop in debug mode, in the immediate window enter <code>?colReq.Address</code> and see if you get a cell address.  If not, then the problem is in your <code>.Find</code> statement"}], "owner": {"reputation": 13, "user_id": 8195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41680c295b68dca740a40a02ac560c96?s=128&d=identicon&r=PG&f=1", "display_name": "SomeUser", "link": "https://stackoverflow.com/users/8195189/someuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498064499, "creation_date": 1498059638, "last_edit_date": 1498064499, "question_id": 44680633, "link": "https://stackoverflow.com/questions/44680633/vba-error-object-variable-or-with-block-variable-not-set", "title": "VBA Error: Object Variable or With Block variable not set", "body": "<p>I am new to VBA and am working on a Macro that will delete duplicate lines in a material tracking spreadsheet based off matching elements in 3 specific columns labeled: \"Requisition Number\", \"Item\", and \"PO #\". </p>\n\n<p>However, when I try to set activate the first element in my requisition number using <code>ActiveSheet.Range(Cells(1, colReq.Column).Address()).Activate</code> I'm given the Error: Object Variable or With Block variable not set </p>\n\n<p>The following is my full code:</p>\n\n<pre><code>Sub DeleteDuplicates()\n\n\n\n    Dim sh As Worksheet\n        Set sh = ThisWorkbook.Sheets(\"Sheet1\")\n\n    Dim lastRow As Long\n\n        lastRow = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n\n\n\n    Dim colReq As Range\n    Dim colItemReq As Range\n    Dim colPO As Range\n    Dim colType As Range\n\n    With ActiveSheet.UsedRange.Rows(1)\n        Set colReq = .Find(What:=\"Requisition Number\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        Set colItemReq = .Find(What:=\"Item\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        Set colPO = .Find(What:=\"PO #\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        Set colType = .Find(What:=\"PO #\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    End With\n\n\n    Dim current As String\n    ActiveSheet.Range(Cells(1, colReq.Column).Address()).Activate\n    Do While ActiveCell.Value &lt;&gt; \"\"\n        current = ActiveCell.Address\n        ActiveCell.Offset(1, 0).Activate\n        Do While ActiveCell.Value &lt;&gt; \"\"\n            If (ActiveSheet.Range(current).Value = ActiveCell.Value) And _\n            ((ActiveSheet.Range(Cells(ActiveCell.Row - 1, colItemReq.Column).Address).Value) = ActiveSheet.Range(Cells(ActiveCell.Row, colItemNumber).Value)) And _\n            ((ActiveSheet.Range(Cells(ActiveCell.Row - 1, colPO).Address).Value) = ActiveSheet.Range(Cells(ActiveCell.Row, colPO).Value)) And (ActiveCell.Value &lt;&gt; \"Shipping Notification\") Then\n                ActiveSheet.Rows(ActiveCell.Row).Delete\n            Else\n            ActiveCell.Offset(1, 0).Activate\n            End If\n        Loop\n        ActiveSheet.Range(current).Offset(1, 0).Activate\n    Loop\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "is_accepted": true, "score": 0, "last_activity_date": 1498507926, "last_edit_date": 1498507926, "creation_date": 1498158037, "answer_id": 44707418, "question_id": 44680342, "link": "https://stackoverflow.com/questions/44680342/how-to-schedule-an-async-macro-from-word/44707418#44707418", "title": "How to schedule an async macro from WORD", "body": "<p>Your newly created Word application, represented by a <code>Word.Application</code> object, doesn't have the document open. Thus there's no \"Module1\" as far as he's aware. The fact that you want to run code from the same document is immaterial. It's a different instance of Word.</p>\n\n<p>Something like this works:</p>\n\n<pre><code>'''''''' ThisDocument\nOption Explicit\n\nPrivate Sub Document_Open()\n    Dim res As VbMsgBoxResult\n    Dim Obj As Word.Application\n\n    If Application.Visible Then\n        res = MsgBox(\"Hello\", vbOKCancel, \"Hi!\")\n    Else\n        Exit Sub\n    End If\n\n    If res = vbOK Then\n        Set Obj = New Word.Application\n        Obj.Documents.Open \"C:\\Users\\conio\\Desktop\\Hello.docm\", , True\n        Obj.OnTime Now + TimeValue(\"00:00:01\"), \"Module1.Foo\"\n    End If\nEnd Sub\n\n'''''''' Module1\nPublic Sub Foo()\n    If Not Application.Visible Then\n        MsgBox \"Foo\"\n        Application.Quit\n    End If\nEnd Sub\n</code></pre>\n\n<p>Maybe you'd want to use a different check to differentiate between the interactive run and the unattended run.</p>\n"}], "owner": {"reputation": 1751, "user_id": 1025124, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/66cd3dc00b09bf9504c0aebe06202d9f?s=128&d=identicon&r=PG", "display_name": "igal k", "link": "https://stackoverflow.com/users/1025124/igal-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 44707418, "answer_count": 1, "score": 1, "last_activity_date": 1498507926, "creation_date": 1498058851, "last_edit_date": 1498112539, "question_id": 44680342, "link": "https://stackoverflow.com/questions/44680342/how-to-schedule-an-async-macro-from-word", "title": "How to schedule an async macro from WORD", "body": "<p>I'm facing an annoying issue where I simply want to schedule an asynchronous macro from another instance of Word, which happens to be the same .doc file.</p>\n\n<p>Meaning, in the <code>ThisDocument</code> namespace I have the following code snippet:</p>\n\n<pre><code>Public Sub Document_Open()\n    Set Obj = New Word.Application\n    Obj.OnTime Now + TimeValue(\"00:00:01\"), \"Module1.Test\"\nEnd Sub\n</code></pre>\n\n<p>I've declared a new object of Word due to the following reasons:</p>\n\n<ol>\n<li>My macro may block user's I\\O</li>\n<li>The user may close the document before the macro finishes its task</li>\n</ol>\n\n<p>And declared a module named <code>Module1</code> with a simple <code>MsgBox</code></p>\n\n<pre><code>Public Sub Test()\n    MsgBox \"hhh\"\nEnd Sub\n</code></pre>\n\n<p>Needless to say, nothing happened, and I'm unable to check what <code>OnTime</code> function returns.</p>\n\n<p>I've also tried the following combinations:</p>\n\n<pre><code>\"!Module1.Test\"\n\"c:\\\\....\\\\file.doc!Module1.Test\"\n</code></pre>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498067350, "post_id": 44680177, "comment_id": 76350030, "body": "Edit your question and make the problem clear. You are creating an input box that search for what and on what rows or lines?"}, {"owner": {"reputation": 1, "user_id": 8194485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a32d6c4391c4ae61fb9867ba49facfe?s=128&d=identicon&r=PG&f=1", "display_name": "Ryland99", "link": "https://stackoverflow.com/users/8194485/ryland99"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498068949, "post_id": 44680177, "comment_id": 76350924, "body": "I am creating an input box to search for data in column A.   If for example the data is found in column A row 243, I want to copy that cell(a range in my case) to another spreadsheet starting Column A row 2."}], "answers": [{"tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1498071946, "last_edit_date": 1498071946, "creation_date": 1498069912, "answer_id": 44683700, "question_id": 44680177, "link": "https://stackoverflow.com/questions/44680177/copy-dynamic-cells-from-one-sheet-to-another-starting-from-the-top/44683700#44683700", "title": "Copy dynamic cells from one sheet to another starting from the top", "body": "<pre><code>Dim ol, nw As Worksheet\n\nSet ol = ThisWorkbook.Worksheets(\"Old\")\nSet nw = ThisWorkbook.Worksheets(\"New\")\n\n\n    ncell = ol.Range(\"A65536\").End(xlUp).Row\n\nWith ol.Range(Cells(1, 1), Cells(ncell, 1))\n Set dist = .Find(X, LookIn:=xlValues)\n    If Not dist Is Nothing Then\n        firstAddress = dist.Address\n        Do\n            ncellnw = nw.Range(\"A65536\").End(xlUp).Row\n            nw.Cells(ncellnw,1).Value = firstAddress\n            Set dist = .FindNext(dist)\n        Loop While Not dist Is Nothing And dist.Address &lt;&gt; firstAddress\n    End If\nEnd With\n</code></pre>\n\n<p>It should work, where you declare Worksheets, then Search for the value in X (String on inputbox).</p>\n\n<p>Where ncell and ncellnw gives the last row with something written on column A</p>\n"}], "owner": {"reputation": 1, "user_id": 8194485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a32d6c4391c4ae61fb9867ba49facfe?s=128&d=identicon&r=PG&f=1", "display_name": "Ryland99", "link": "https://stackoverflow.com/users/8194485/ryland99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498071946, "creation_date": 1498058451, "last_edit_date": 1498068941, "question_id": 44680177, "link": "https://stackoverflow.com/questions/44680177/copy-dynamic-cells-from-one-sheet-to-another-starting-from-the-top", "title": "Copy dynamic cells from one sheet to another starting from the top", "body": "<p>I am creating an input box to search for data in column A. </p>\n\n<p>If for example the data is found in column A row 243, I want to copy that cell(a range in my case) to another spreadsheet starting Column A row 2.</p>\n\n<p>Could anyone help me with this issue? Would be much appreciated. </p>\n\n<p>Thank you </p>\n\n<pre><code>Sub Sales_Rep()\n\n\nDim r As Integer\nDim c As Integer\n\nDim X As String\nDim i As Integer\nDim j As Range\n\n\n' Deteling the extra sheets of previous Sales representatives\n\nIf Worksheets.Count &gt; 4 Then\n\nWorksheets(\"Sales Rep\").Delete\n\nEnd If\n\nX = Application.InputBox(\"Please insert the Sales Rep Code\")\n\n\n' Calculating the number of rows and Columns\n\nWorksheets(\"Data Set Macro\").Activate\n\nr = ActiveSheet.UsedRange.Rows.Count\nc = ActiveSheet.UsedRange.Columns.Count\n\nDebug.Print r\nDebug.Print c\n\n' Add another tab where we can see all the details of the selected sales representative\n\nWorksheets.Add.Name = \"Sales Rep\"\n\n' Copy of the header from the original tab to the new tab\n\nWorksheets(\"Data Set Macro\").Range(\"A1:D1\").Copy _\n    Worksheets(\"Sales Rep\").Range(\"A1:D1\")\n\n\n'Worksheets(\"Data Set Macro\").Activate\n\n\n For i = 2 To r\n 'For j = 2 To 5\n\n\n   Worksheets(\"Data Set Macro\").Activate\n\n    If Cells(i, 1) = X Then\n\n            Worksheets(\"Data Set Macro\").Range(Cells(i, 1), Cells(i, c)).Select\n                 Selection.Copy\n\n        Worksheets(\"Sales Rep\").Activate\n            Worksheets(\"Sales Rep\").Range(Cells(i, 1), Cells(i, c)).Select\n                ActiveSheet.Paste\n\n\n    End If\n\n'Next j\nNext i\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498058423, "post_id": 44679989, "comment_id": 76344627, "body": "Why won&#39;t sumifs work?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498060513, "post_id": 44679989, "comment_id": 76346156, "body": "So the part in the for loop actually makes 0 sense. Are there more than one workbook and more than one sheet in each workbook that you want to go trough? Also i dont understand how the example matches? does only the from need to match?"}, {"owner": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "edited": false, "score": 0, "creation_date": 1498062240, "post_id": 44679989, "comment_id": 76347216, "body": "There are two workbooks involved and each workbook has one sheet. The example basically means xl2.from&lt;xl1.from&lt;xl2.to and xl2.from&lt;xl1.to&lt;xl2.to"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498063632, "post_id": 44679989, "comment_id": 76347964, "body": "You only need a formula for this. Tell us of you&#39;re interested."}, {"owner": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498064051, "post_id": 44679989, "comment_id": 76348198, "body": "@A.S.H I&#39;m interested."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498064488, "post_id": 44679989, "comment_id": 76348418, "body": "What are the names (and paths) of the workbooks and the worksheets? I&#39;m tired of starting my answers with <i>&quot;suppose your data is like this and your sheet names are like that...&quot;</i>"}, {"owner": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "edited": false, "score": 0, "creation_date": 1498065089, "post_id": 44679989, "comment_id": 76348763, "body": "studentperf.xlsx is xl1(where i would use the formula to create ID field)- path is Desktop"}], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1498065177, "creation_date": 1498065177, "answer_id": 44682335, "question_id": 44679989, "link": "https://stackoverflow.com/questions/44679989/looking-up-range-condition-on-a-another-range/44682335#44682335", "title": "Looking up range condition on a another range", "body": "<p>So this compares every Dataset in the first file with the second file. And give out the matching ID in Column D. You did not say anything about multiple matches, so it will put all matches in the cell and seperate them with a \";\".</p>\n\n<pre><code>Sub getID()\nDim wb As Workbook\nDim sht As Worksheet, sht2 As Worksheet\nDim fd As FileDialog\nDim lRow As Long, lRow2 as Long\nDim i as Integer, j as Integer\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nSet sht = ActiveWorkbook.ActiveSheet\n\nWith fd\n    .AllowMultiSelect = False\n    .Filters.Add \"Excel\", \"*.xl*\"\nEnd With\n\nIf fd.Show = -1 Then\n\n    Set wb = Workbooks.Open(fd.SelectedItems(1))\n    Set sht2 = wb.Worksheets(1) 'First Sheet in File\n\n    lRow = sht.Cells(sht.Rows.Count, 2).End(xlUp).Row\n    LRow2 = sht2.Cells(sht2.Rows.Count, 1).End(xlUp).Row\n\n    sht.Columns(4).ClearContents 'Clear Old Data in Column \"D\"\n    sht.Cells(1, 4).Value = \"ID\" 'Title of Col\n\n    For i = 2 To lRow\n        For j = 2 To LRow2\n            If sht.Cells(i, 2).Value &gt;= sht2.Cells(j, 1).Value _\n            And sht.Cells(i, 3).Value &lt;= sht2.Cells(j, 2).Value Then 'Checks if From and To are in Range\n               If sht.Cells(i, 4).Value &lt;&gt; \"\" Then 'if more than one ID\n                    sht.Cells(i, 4).Value = sht.Cells(i, 4).Value &amp; \";\" &amp; j - 1  'Seperate ID with \";\" ID\n                Else\n                    sht.Cells(i, 4).Value = j - 1 'ID\n                End If\n            End If\n        Next j\n    Next i\n\n    wb.Close\nEnd If\nEnd Sub\n</code></pre>\n\n<p>First File looks like this with the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/piOSu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/piOSu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Second File looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ig9u4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ig9u4.png\" alt=\"enter image description here\"></a></p>\n\n<p>(Note: I use the german version so there are \",\" for decimals instead of \".\")</p>\n"}], "owner": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 44682335, "answer_count": 1, "score": 0, "last_activity_date": 1498065177, "creation_date": 1498057993, "last_edit_date": 1531164843, "question_id": 44679989, "link": "https://stackoverflow.com/questions/44679989/looking-up-range-condition-on-a-another-range", "title": "Looking up range condition on a another range", "body": "<p>I am working between two workbooks.<br>\nxl1 is a routine workbook like this  </p>\n\n<pre><code>StudentID |From |To  \n1         |2    |9  \n2         |20   |50  \n3         |0    |1 \n</code></pre>\n\n<p>xl2 is the other workbook which is like this:  </p>\n\n<pre><code>From| To     \n0   | 1.5  'Associate 1 with this as an ID\n2   | 15   'Associate 2 with this as an ID and so on\n</code></pre>\n\n<p>I am trying to write a code in xl1 that would let me </p>\n\n<blockquote>\n  <ol>\n  <li><p>select xl2 workbook</p></li>\n  <li><p>Look for columns From and To</p></li>\n  <li><p>Check in xl1 workbook to see if the From and To for each student falls within the From and To range of xl2 and then associate an ID to\n  it. To make it clear (something like this):  </p></li>\n  </ol>\n</blockquote>\n\n<pre><code>StudentID |From |To  |ID  \n1         |2    |9   |2  \n2         |20   |50  |  \n3         |0    |1   |1  \n</code></pre>\n\n<p>So far I have written this code, but I cant seem to figure how to get the logic in:  </p>\n\n<pre><code>Sub getID()\nDim wb As Workbook\nDim ws As Worksheet\nDim fd As FileDialog\nDim filename As String\nDim rng As Integer\nDim counter As Integer\nDim frm As Range\nDim too As Range\nDim lngCount As Integer\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n\nWith fd\n\nIf .Show Then\n       FileName = .SelectedItems(1)\n    Else\n       'if user pressed CANCEL - exit sub\n       MsgBox \"User pressed CANCEL\"\n       Exit Sub\n    End If\n                On Error Resume Next\n                Set wb = Workbooks.Open(FileName)\n                rng = ActiveSheet.UsedRange.Rows.Count \n                frm = ActiveSheet.Range(\"AA\" &amp; rng).Select   'copy from col\n                too = ActiveSheet.Rang(\"AC\" &amp; rng).Select    'copy to col\n                For Each Cell In frm\n                    if()\n                Next Cell\n\n            Next\nEnd If\nEnd With\n\n\nEnd Sub  \n</code></pre>\n\n<p>The example basically means  </p>\n\n<pre><code>xl2.from&lt;xl1.from&lt;xl2.to \n</code></pre>\n\n<p>and   </p>\n\n<pre><code>xl2.from&lt;xl1.to&lt;xl2.to\n</code></pre>\n\n<p>I would appreciate help in getting this to work</p>\n"}, {"tags": ["excel", "loops", "subset", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498057954, "post_id": 44679924, "comment_id": 76344255, "body": "Did you even read about <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">For Loops</a> in VBA?"}, {"owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498058314, "post_id": 44679924, "comment_id": 76344543, "body": "that&#39;s the page I was looking at before posting here actually"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498061653, "post_id": 44679924, "comment_id": 76346845, "body": "If you post the VBA code you&#39;ve actually and tell us what is not working, you&#39;ll get much more response. Not many people will write the entire code for you based on psuedo-code from another language."}], "owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498057815, "creation_date": 1498057815, "last_edit_date": 1531164843, "question_id": 44679924, "link": "https://stackoverflow.com/questions/44679924/loop-through-list-and-perform-calculations-on-each-unique-value-in-excel-vba", "title": "loop through list and perform calculations on each unique value in excel VBA", "body": "<p>I have some excel data:</p>\n\n<pre><code>apple   7.00    30/05/2017\napple   3.00    05/05/2017\napple   3.00    11/05/2017\napple   7.00    12/05/2017\napple   7.00    16/05/2017\napple   7.00    17/05/2017\nbanana  7.00    18/05/2017\norange  7.00    19/05/2017\norange  7.00    22/05/2017\norange  7.00    23/05/2017\norange  7.00    24/05/2017\norange  7.00    25/05/2017\norange  7.00    26/05/2017\norange  7.00    05/06/2017\norange  7.00    06/06/2017\norange  7.00    08/06/2017\norange  7.00    09/06/2017\norange  7.00    12/06/2017\n</code></pre>\n\n<p>And would like to cycle through each entry and perform some calculations. I am new and trying to learn VBA, and in R would do the following:</p>\n\n<pre><code>df=NULL\nfor(i in unique(col1)){\n    a=subset of data\n    perform some calculation of the data a\n    append results to a df\n}\n</code></pre>\n\n<p>My question is, how can I do this in VBA</p>\n\n<p>in the above section, the result I am interested in is:</p>\n\n<pre><code>fruit   number of 5d weeks at same price\napple   0 \nbanana  0\norange  1\n</code></pre>\n\n<p>My data is ~10k rows</p>\n"}, {"tags": ["excel", "vba", "button", "timer", "pause"], "answers": [{"tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1498060029, "creation_date": 1498060029, "answer_id": 44680794, "question_id": 44679789, "link": "https://stackoverflow.com/questions/44679789/cant-get-pause-button-to-resume-time-properly-excel-vba/44680794#44680794", "title": "Can&#39;t get Pause Button to resume time properly - Excel VBA", "body": "<p>Your code does not reset the start time when paused.  But resetting the start time would lose previous elapsed periods.  One approach to this problem is to record the number of elapsed seconds each time the clock stops.  Subsequence start/stops are added to the running elapsed counter.  There is a reset method so you can begin again from zero.</p>\n\n<pre><code>Private StartTime As Date           ' Stores timer start time.\nPrivate StopTime As Date            ' Stores timer end time.\nPrivate ElapsedTime As Integer      ' Store number of seconds between start and end time.\nPrivate TimerRunning As Boolean     ' True when the timer is running.\n\n\n' Resets ElapsedTime and running status.\nPublic Sub ResetTimer()\n\n    ElapsedTime = 0\n    If TimerRunning Then TimerRunning = False\nEnd Sub\n\n' Starts the timer.\nPublic Sub StartTimer()\n\n    ' Record start time.\n    StartTime = Time\n    TimerRunning = True\nEnd Sub\n\n' Stops the timer.\n' Displays elapsed seconds.\nPublic Sub StopTimer()\n\n    ' Record end time.\n    StopTime = Time\n    TimerRunning = False\n\n    ' Calculate numebr of seconds clock was running for.\n    ' Add total to any previous runs.\n    ElapsedTime = ElapsedTime + DateDiff(\"S\", StartTime, StopTime)\n    MsgBox \"Clock ran for \" &amp; ElapsedTime &amp; \" seconds\", vbInformation, \"Clock Stopped\"\nEnd Sub\n\n' Pause the timer.\nPublic Sub PauseTimer()\n\n    ' Check current status.\n    If TimerRunning Then\n\n        ' Stop the clock, capture the end time\n        ' but do not reset the timer.\n        StopTimer\n    Else\n\n        ' Restart the timer.\n        StartTimer\n    End If\nEnd Sub\n</code></pre>\n\n<p>Users only really need access to the pause and reset functions.  You could make the start and stop functions internal <a href=\"https://en.wikipedia.org/wiki/Private_class_data_pattern\" rel=\"nofollow noreferrer\">private methods</a>.</p>\n\n<p>I've stored the elapsed time in an integer.  Date and time variables should be used to record when an event occurred, rather than the duration.  Why?  Because a time variable supports values from <code>00:00:00</code> -> <code>23:59:59</code> (times of the day).  This leaves no room to record events that lasted longer than a day.  You can always format the int when displaying.</p>\n"}, {"tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1498062564, "creation_date": 1498062564, "answer_id": 44681574, "question_id": 44679789, "link": "https://stackoverflow.com/questions/44679789/cant-get-pause-button-to-resume-time-properly-excel-vba/44681574#44681574", "title": "Can&#39;t get Pause Button to resume time properly - Excel VBA", "body": "<p>I havn't understood how exactly your code works and I tried a couple of things but its not working. Basically what I was trying to to was to take the time from the cell M1 itself the next time it starts and then continue from there itself. Look at this code, maybe it will help.</p>\n\n<pre><code>Dim NextTick As Date, t As Date, continue_time As Date\nSub StartStopWatch()\nIf Range(\"L2\").Value = \"\" Then\n    t = Time\n    Range(\"L2\").ClearContents\nElse\n    t = TimeValue(Range(\"M1\").Text) - Time\nEnd If\n't = Time\nCall StartTimer\nEnd Sub\n\nSub StartTimer()\n'If Range(\"L2\").Value = \"\" Then\n'    continue_time = Time\n'Else\n'    continue_time = TimeValue(Range(\"M1\").Text)\n'End If\n\nNextTick = Time + TimeValue(\"00:00:01\")\nRange(\"M1\").Value = Format(NextTick - t - TimeValue(\"00:00:01\"), \"hh:mm:ss\")\nApplication.OnTime NextTick, \"StartTimer\"\nEnd Sub\n\nSub StopTimer()\n\nOn Error Resume Next\nApplication.OnTime EarliestTime:=NextTick, Procedure:=\"StartTimer\", Schedule:=False\n\nEnd Sub\n\nSub ResetTimer()\nRange(\"M1\").ClearContents\nRange(\"N1\").ClearContents\nRange(\"L2\").ClearContents\nEnd Sub\n\nSub PauseButton()\n\nIf Range(\"L2\").Value = \"\" Then\n\nRange(\"L2\").Value = \"Paused\"\n\nApplication.OnTime EarliestTime:=NextTick, Procedure:=\"StartTimer\", Schedule:=False\n\nElse\n\nCall StartStopWatch\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8194859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8c931a9e4b06718a39886871efc3b3?s=128&d=identicon&r=PG&f=1", "display_name": "phillosophy", "link": "https://stackoverflow.com/users/8194859/phillosophy"}, "is_accepted": false, "score": 0, "last_activity_date": 1498072691, "creation_date": 1498072691, "answer_id": 44684549, "question_id": 44679789, "link": "https://stackoverflow.com/questions/44679789/cant-get-pause-button-to-resume-time-properly-excel-vba/44684549#44684549", "title": "Can&#39;t get Pause Button to resume time properly - Excel VBA", "body": "<p>I actually just figured it out using a code that counts integers and then changed the formatting to mm:ss.</p>\n\n<p><strong>Solution: <a href=\"http://www.ozgrid.com/forum/showthread.php?t=153966\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=153966</a></strong> </p>\n"}], "owner": {"reputation": 1, "user_id": 8194859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8c931a9e4b06718a39886871efc3b3?s=128&d=identicon&r=PG&f=1", "display_name": "phillosophy", "link": "https://stackoverflow.com/users/8194859/phillosophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 730, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1498072691, "creation_date": 1498057434, "question_id": 44679789, "link": "https://stackoverflow.com/questions/44679789/cant-get-pause-button-to-resume-time-properly-excel-vba", "title": "Can&#39;t get Pause Button to resume time properly - Excel VBA", "body": "<p>I am coding a Stopwatch Timer in Excel, and I am trying to add a pause button that will stop the timer, also resume when clicked the 2nd time. I have it almost working, but when it resumes it does not continue the stopwatch at the same time, but rather includes all of the elapsed time. The way I have it working is that when you click the pause button it adds the value of \"Paused\" to a cell and sets the application to \"False\". If the button is clicked and the cell already says \"Paused\" it will empty the cell value and call the StartTimer sub and start the timer again.</p>\n\n<p><em>Example of problem: If I press the button at 1min and 3secs, wait 3mins and resume the timer, it starts counting again at 4min and 3secs.</em></p>\n\n<p><strong>Example of goal: If I press the button at 1min and 3secs, wait 3mins and resume the timer, it should start counting again at 1min and 4secs.</strong></p>\n\n<p>Here is my current code that i've been working on:</p>\n\n<pre><code>Dim NextTick As Date, t As Date\nSub StartStopWatch()\nt = Time\nCall StartTimer\nEnd Sub\n\nSub StartTimer()\nNextTick = Time + TimeValue(\"00:00:01\")\nRange(\"M1\").Value = Format(NextTick - t - TimeValue(\"00:00:01\"), \"hh:mm:ss\")\nApplication.OnTime NextTick, \"StartTimer\"\nEnd Sub\n\nSub StopTimer()\n\nOn Error Resume Next\nApplication.OnTime EarliestTime:=NextTick, Procedure:=\"StartTimer\", Schedule:=False\n\nEnd Sub\n\nSub ResetTimer()\nRange(\"M1\").ClearContents\nRange(\"N1\").ClearContents\nRange(\"L2\").ClearContents\nEnd Sub\n\nSub PauseButton()\n\nIf Range(\"L2\").Value = \"\" Then\n\nRange(\"L2\").Value = \"Paused\"\n\nApplication.OnTime EarliestTime:=NextTick, Procedure:=\"StartTimer\", Schedule:=False\n\nElse\nRange(\"L2\").ClearContents\nCall StartTimer\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498058614, "post_id": 44679689, "comment_id": 76344775, "body": "Unrelated, but notice that whitespace between the <code>MsgBox</code> function call and the opening <code>(</code> parenthese: that&#39;s the VBE telling you that the parens are superfluous and that whatever is inside them is going to be evaluated as a value and passed <code>ByVal</code>. Not a problem <i>here/now</i>, but can definitely bite you in the rear end in other circumstances."}], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1498057457, "post_id": 44679742, "comment_id": 76343844, "body": "Thanks Doug, small change made....thanks again  MsgBox (&quot;your date is &quot; &amp; FORMAT(DateAdd(&quot;m&quot;, -6, Date()),&quot;MMMM&quot;))"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1498057305, "creation_date": 1498057305, "answer_id": 44679742, "question_id": 44679689, "link": "https://stackoverflow.com/questions/44679689/get-past-6-months-month-in-ref-to-today/44679742#44679742", "title": "Get past 6 months MONTH in ref to TODAY", "body": "<pre><code> MsgBox (\"your date is \" &amp; DateAdd(\"m\", -6, Date()))\n</code></pre>\n"}], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 44679742, "answer_count": 1, "score": 0, "last_activity_date": 1498057305, "creation_date": 1498057185, "question_id": 44679689, "link": "https://stackoverflow.com/questions/44679689/get-past-6-months-month-in-ref-to-today", "title": "Get past 6 months MONTH in ref to TODAY", "body": "<p>Need help in displaying 6 month past month in refrence to todays date. E.g current month is June. below is the code, but is giving the as 1,I need to get January.</p>\n\n<pre><code>MsgBox (\"Cheques would be checked for issue Month of  \" &amp; (Month(Date)-5))\n</code></pre>\n"}, {"tags": ["excel", "object", "required", "vba"], "comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 1, "creation_date": 1498056904, "post_id": 44679545, "comment_id": 76343375, "body": "What programming language is this?  You need to tag your question with the name of the language you&#39;re using."}, {"owner": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "reply_to_user": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 0, "creation_date": 1498057298, "post_id": 44679545, "comment_id": 76343729, "body": "Excel VBA. Thank you for helping me clarify."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498057835, "post_id": 44679545, "comment_id": 76344165, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid Select</a> and qualify all your ranges to parent worksheets and you will probably solve the issue. <code>Worksheets(&quot;mySheet&quot;).Range(&quot;R3&quot;).Value = remainder</code>"}, {"owner": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498059492, "post_id": 44679545, "comment_id": 76345377, "body": "I added &quot;ActiveSheet.Range(&quot;R3&quot;).Value = remainder&quot; at the end of my code (thanks Scott), but I don&#39;t know if it is working because I am still getting the object error. I read the link about avoiding select, but I could not find how to copy/paste cells after setting a value in that way."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1498060250, "post_id": 44679545, "comment_id": 76345977, "body": "Fix the statement <code>LastRowQ = .Range(&quot;Q&quot; &amp; .Rows.Count).End(xlUp).Row</code> by putting a <code>Set </code> on the front of it.  You need to use <code>Set</code> when assigning objects or bad/weird things can happen.  Alternatively, use <code>OPTION EXPLICIT</code> and with explicit data-typing the compiler can often figure out when you should&#39;ve used a <code>Set</code>."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498060357, "post_id": 44680640, "comment_id": 76346048, "body": "Jeeped - I have simplified my code a bit for the sake of clarity, which is why you may be confused about the formatting in the beginning of the code. I took your advice and made the #2 change and now that line seems to be working, and now I am getting a &quot;Application-defined or object-defined error&quot; on the next line (remainder = etc etc).   With ActiveSheet LastRowQ = .Range(&quot;Q&quot; &amp; .Rows.Count).End(xlUp).Row End With If Cells(LastRowQ - 1, &quot;Q&quot;).Value &gt; 0 Then remainder = Cells(LastRowQ - 1, &quot;Q&quot;).Value / Cells(LastRowQ, -9).Value ActiveSheet.Range(&quot;R3&quot;).Value = remainder"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498060483, "post_id": 44680640, "comment_id": 76346127, "body": "The change described in step 2 should be done in at least three places."}, {"owner": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498060694, "post_id": 44680640, "comment_id": 76346277, "body": "Yes, I made those changes in three places: the error row and twice in the following row. The row where I made the two additional changes is now the current error row."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498060817, "post_id": 44680640, "comment_id": 76346359, "body": "Then I can only assume that <code>Cells(LastRowQ - 1, &quot;H&quot;).Value</code> is zero and you cannot divide by zero. You check the numerator of the division operation, not the denomonator."}, {"owner": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498061132, "post_id": 44680640, "comment_id": 76346535, "body": "That is a good guess, but that cell is not a 0 (I even tested the adjacent columns to make sure I did not put in the wrong column and still got the same error)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "edited": false, "score": 0, "creation_date": 1498061344, "post_id": 44680640, "comment_id": 76346671, "body": "OK, that code is going to try to fill column Q all the way to the bottom. You are looping a while... wend inside a for ... next as well as iterating the for ... next loop&#39;s r variable. Get rid of the while ... wend and just use <code>if Cells(r, &quot;Q&quot;).Value &lt;= 0 then exit for</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1506007781, "last_edit_date": 1506007781, "creation_date": 1498059664, "answer_id": 44680640, "question_id": 44679545, "link": "https://stackoverflow.com/questions/44679545/basic-division-and-object-required-error/44680640#44680640", "title": "basic division and object required error", "body": "<ol>\n<li><p>After seeing <code>Range(\"B2\").Select ' Today's inventory</code> should the <strong>8</strong> in <code>Cells(r + 1, \"Q\") = Cells(r, \"Q\").Value - Cells(r, 8).Value</code> be a <strong>B</strong> like <code>Cells(r + 1, \"Q\") = Cells(r, \"Q\").Value - Cells(r, \"B\").Value</code> ?</p></li>\n<li><p><code>LastRowQ = .Range(\"Q\" &amp; .Rows.Count).End(xlUp).Row</code> does not set a range object; it assigns a number to LastRowQ. You cannot use use LastRowQ as a range object like <code>LastRowQ.Offset(-1, 0).Value</code>. Perhaps you meant <code>Cells(LastRowQ - 1, \"Q\").Value</code>.</p></li>\n<li><p>Use Option Explicit to avoid variable declaration errors and typos.</p></li>\n<li><p>Explicitly qualify all parent worksheets.</p></li>\n</ol>\n"}], "owner": {"reputation": 35, "user_id": 5822871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac67dbcbbdb8ba10bde92ef9217dd31e?s=128&d=identicon&r=PG&f=1", "display_name": "ShNBl84", "link": "https://stackoverflow.com/users/5822871/shnbl84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509656538, "creation_date": 1498056821, "last_edit_date": 1531164843, "question_id": 44679545, "link": "https://stackoverflow.com/questions/44679545/basic-division-and-object-required-error", "title": "basic division and object required error", "body": "<p>I put in my 5 hours trying to figure this out, and now it's time to ask for help.</p>\n\n<p>I am creating an \"Inventory calendar\" where each day we produce and sell a number of items. I want to see how many day's worth of an item I have on a particular day. The number of items we sell each day is different. Everything works until the If LastRowQ.Offset(-1,0).Value line where I get an \"Object required\" error. I want to divide the number of items that are left the second to last cell (the last cell is offset(-1,0) because the last cell results in a negative if it is not a 0) by the number of items sold that day (column H) so I get a decimal of how much of that day will be covered by the inventory we already have. Also, how do I get that value (remainder) to be put in cell R3?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub test()\nDim r As Integer, a As Integer, remainder As Single\nremainder = 0\n  Range(\"B2\").Select ' Today's inventory\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"Q2\").Select ' Helper column to paste the remaining inventory for each day\nActiveSheet.Paste\nFor r = 2 To 10\n  While Cells(r, \"Q\").Value &gt; 0\n        Cells(r + 1, \"Q\") = Cells(r, \"Q\").Value - Cells(r, 8).Value\n        r = r + 1\n  Wend\nNext r\nWith ActiveSheet\nLastRowQ = .Range(\"Q\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\nIf LastRowQ.Offset(-1, 0).Value &gt; 0 Then\nremainder = LastRowQ.Offset(-1, 0).Value / LastRowQ.Offset(0, -9).Value\n' How do I put the value of \"remainder\" into cell R3?\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vb.net", "sharepoint", "outlook", "sharepoint-2010"], "answers": [{"tags": [], "owner": {"reputation": 709, "user_id": 5045691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02908cf49b689b00aad13b0590411aff?s=128&d=identicon&r=PG", "display_name": "EJD", "link": "https://stackoverflow.com/users/5045691/ejd"}, "is_accepted": true, "score": 2, "last_activity_date": 1498080194, "creation_date": 1498080194, "answer_id": 44686511, "question_id": 44679448, "link": "https://stackoverflow.com/questions/44679448/how-to-download-a-pdf-that-is-in-a-hyperlink-using-vb-in-outlook-2016/44686511#44686511", "title": "How to download a PDF that is in a hyperlink using VB in Outlook 2016", "body": "<p>Start with enabling the <a href=\"https://msdn.microsoft.com/en-us/library/bb608625.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Developer Tab in OutLook</a>.</p>\n\n<p>Then <a href=\"https://www.youtube.com/watch?v=IFGR7iEO9-o\" rel=\"nofollow noreferrer\">how to create a Macro in OutLook</a></p>\n\n<p>Copy the code below into a new Module.</p>\n\n<p>Finally, edit your rule to move the emails and add another step to run a script.  Click in the rule your new Module should show up.</p>\n\n<p>Done.</p>\n\n<pre><code>Sub SavePDFLinkAction(item As Outlook.MailItem)\n\n    Dim subject As String\n    Dim linkName As String\n\n    '*******************************\n    ' Intitial setup\n    '*******************************\n    subject = \"Criteria\" ' Subject of the email\n    linkName = \"Open the document\" ' link name in the email body\n    '*******************************\n\n    Dim link As String\n\n    link = ParseTextLinePair(item.body, \"HYPERLINK\")\n    link = Replace(link, linkName, \"\")\n    link = Replace(link, \"\"\"\", \"\")\n    'Download the file - Intitial settings need to be set\n    DownloadFile (link)\n\nEnd Sub\n\nSub DownloadFile(myURL As String)\n\n    Dim saveDirectoryPath As String\n\n    '*******************************\n    ' Intitial setup\n    '*******************************\n    saveDirectoryPath = \"C:\\temp\\\" 'where your files will be stored\n    '*******************************\n\n    Dim fileNameArray() As String\n    Dim fileName As String\n    Dim arrayLength As Integer\n    Dim DateString As String\n    DateString = Format(Now, \"yyyy-mm-dd hh-mm-ss\")\n\n    fileNameArray = Split(myURL, \"/\")\n    arrayLength = UBound(fileNameArray)\n    fileName = fileNameArray(arrayLength)\n\n    'Add date to the file incase there are duplicates comment out these lines if you do not want the date added\n    fileName = Replace(fileName, \".pdf\", \"_\" &amp; DateString &amp; \".pdf\")\n    fileName = Replace(fileName, \".PDF\", \"_\" &amp; DateString &amp; \".PDF\")\n\n    Dim WinHttpReq As Object\n    Set WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\n    WinHttpReq.Open \"GET\", myURL, False, \"username\", \"password\"\n    WinHttpReq.Send\n\n    myURL = WinHttpReq.responseBody\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.SaveToFile saveDirectoryPath &amp; fileName, 2 ' 1 = no overwrite, 2 = overwrite\n        oStream.Close\n    End If\n\nEnd Sub\n\nFunction ParseTextLinePair(strSource As String, strLabel As String)\n    Dim intLocLabel As Integer\n    Dim intLocCRLF As Integer\n    Dim intLenLabel As Integer\n    Dim strText As String\n\n    intLocLabel = InStr(strSource, strLabel)\n    intLenLabel = Len(strLabel)\n    If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, strSource, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            strText = Mid(strSource, _\n                            intLocLabel, _\n                            intLocCRLF - intLocLabel)\n        Else\n            intLocLabel = Mid(strSource, intLocLabel + intLenLabel)\n        End If\n    End If\n    ParseTextLinePair = Trim(strText)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8194069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f157989bd891e1b1bafd92e1a45ddd7?s=128&d=identicon&r=PG&f=1", "display_name": "Roger Rivas", "link": "https://stackoverflow.com/users/8194069/roger-rivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 2, "closed_date": 1503646962, "accepted_answer_id": 44686511, "answer_count": 1, "score": 0, "last_activity_date": 1593358048, "creation_date": 1498056568, "last_edit_date": 1593358048, "question_id": 44679448, "link": "https://stackoverflow.com/questions/44679448/how-to-download-a-pdf-that-is-in-a-hyperlink-using-vb-in-outlook-2016", "closed_reason": "Needs more focus", "title": "How to download a PDF that is in a hyperlink using VB in Outlook 2016", "body": "<p>I'm looking for some assistance with automating a task I do several times per day.I receive emails from a certain address which I automatically sort (using Rules) into a dedicated folder.</p>\n\n<p>These emails have hyperlinks to different documents to download from the web; however the links are not written as a URL, rather there is a link saying \"Open the document\".</p>\n\n<p>I click on this link, it opens the PDF, then I save this <code>PDF</code> file on my desktop before I upload it to a document library</p>\n\n<p>I'm looking to automate this process. It's a fiddly task doing it manually because I receive so many emails, and downloading each one separately to a folder on my machine and then uploading them to my document library takes a long time.</p>\n\n<p>I don't have much programming experience with <code>VBA</code> but I'm willing to learn.</p>\n\n<p>Could anyone help me?</p>\n"}, {"tags": ["excel", "vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498133668, "post_id": 44682585, "comment_id": 76380955, "body": "To make this whole process easier, the dates from excel are already in their own columns under &quot;Actual Start&quot; and &quot;Actual Finish.&quot; Many of the actual start and end dates are &quot;NA&quot; will this make the DateDifference not work? If it will work would I be able to keep this same For To function and change the date variables to equal the cells in MS Project? for example:      <code>date1 = .Cells(i, &quot;Actual Start&quot;)</code>"}, {"owner": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498134044, "post_id": 44682585, "comment_id": 76381244, "body": "Also where would the result be printed? Do I need to Make a column before hand?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498140336, "post_id": 44682585, "comment_id": 76386245, "body": "Are you actually needing to update the Actual Start and Actual Finish dates rather than the duration? You can store the TotalMinutes or WorkingMinutes variables in Excel if you want; I&#39;ll update the code for that."}, {"owner": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498140831, "post_id": 44682585, "comment_id": 76386632, "body": "There is currently not an Actual Duration in minutes column and the Actual Duration Column in MS Project doesn&#39;t put out the right output. So originally I exported the data to excel and did the DateDiff calculation there then tried to output that back into MS Project using the ID because copy and pasting the column won&#39;t attach the Durations to the correct ID number."}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498143823, "post_id": 44682585, "comment_id": 76389103, "body": "If you are trying to status your schedule with actuals data from Excel, set the Actual Start, Actual Finish, and/or Percent Complete fields. It is uncommon to directly set the Actual Duration column."}, {"owner": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498144544, "post_id": 44682585, "comment_id": 76389662, "body": "is there a command in vba that allows me to use the ID in Excel to look up the task in project then a different command to write the duration to &quot;Duration1&quot; using the ID to identify the row and select the Duration 1 field? Or should this idea be scrapped all together?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498152889, "post_id": 44682585, "comment_id": 76394824, "body": "Yes, the code gets a reference to the task object so that field values can be set (e.g. Duration, Duration1, Actual Start, Actual Finish, etc.). I updated the code to clarify the task object by using a MSProject.Task variable (tsk). FYI: it is not necessary to &quot;select&quot; the Duration1 field.  You should run this code and step through it so that you can see how it works."}, {"owner": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "edited": false, "score": 0, "creation_date": 1498158731, "post_id": 44682585, "comment_id": 76398010, "body": "Thank you so much for your continued help Rachel!"}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1498152942, "last_edit_date": 1498152942, "creation_date": 1498066054, "answer_id": 44682585, "question_id": 44679428, "link": "https://stackoverflow.com/questions/44679428/using-tasks-to-add-excel-data-with-same-id-to-ms-project-vba/44682585#44682585", "title": "Using Tasks to Add Excel Data with Same ID to MS Project - VBA", "body": "<p>Instead of copying the duration into the user-interface, assign the duration directly to the task object. Alternatively (based on the comment below), update the Actual Start and Actual Finish date. Code to do both is included, but it doesn't make sense to update the duration if you are going to also update Actual Start and Actual Finish.</p>\n\n<pre><code>'Open MS Project\nSet appProj = CreateObject(\"MSProject.Application\")\nappProj.FileOpen \"File1.mpp\"\nSet aProg = appProj.ActiveProject\nappProj.Visible = True\n\n'Find duration and assign to task\nDim Duration As Long\nDim tsk as MSProject.Task\nWith ws\n    For i = 2 To lastRow\n        date1 = .Cells(i, 15)\n        date2 = .Cells(i, 16)\n        ' get a reference to the task object using the ID stored in Column A\n        Set tsk = aProg.Tasks(.Cells(i, 1).Value)\n        ' Update duration \n        If .Cells(i, 18).Value = \"No\" And IsDate(date1) And IsDate(date2) Then\n            TotalMinutes = DateDiff(\"n\", date1, date2)\n            WorkingMinutes = appProj.DateDifference(date1, date2)\n            .Cells(i, 20) = WorkingMinutes \n            tsk.Duration = WorkingMinutes\n        End If\n        ' update Actual Start and/or Actual Finish\n        If IsDate(date1) Then\n            tsk.ActualStart = date1\n        End If\n        If IsDate(date2) Then\n            tsk.ActualFinish = date2\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>Note that there are two calculations included for the duration. The VBA <code>DateDiff</code> function returns the total number of minutes between two dates, whereas the MS Project <code>DateDifference</code> function returns the number of working minutes between two dates. The latter is likely what you want to use. Otherwise a 1 day duration (1440 total minutes) will turn into a 3 day task (1440 = 3 days * 8 hours * 60 minutes/hour).</p>\n"}], "owner": {"reputation": 31, "user_id": 8131364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a68409080c5abd7cf5d25d8c3ae172e0?s=128&d=identicon&r=PG&f=1", "display_name": "Peel", "link": "https://stackoverflow.com/users/8131364/peel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1715, "favorite_count": 0, "accepted_answer_id": 44682585, "answer_count": 1, "score": 1, "last_activity_date": 1593559305, "creation_date": 1498056519, "last_edit_date": 1593559305, "question_id": 44679428, "link": "https://stackoverflow.com/questions/44679428/using-tasks-to-add-excel-data-with-same-id-to-ms-project-vba", "title": "Using Tasks to Add Excel Data with Same ID to MS Project - VBA", "body": "<p>In excel I have the ID' numbers in column \"A\" starting on the second row (first row=header). In column \"T\" I have a duration for that ID on the same row.</p>\n\n<p>In MS Project I have an ID column and an empty duration column. I want to add the duration from excel to MS Project on the correct ID row.</p>\n\n<p>I think I can do this by using tasks and a For..To loop. I will need to use the ID in excel to look up the task in MS Project then write the duration from excel in the appropriate task in MS Project. So far, with some help, the code I have is: </p>\n\n<pre><code>'Find duration and assign to ID in Excel\nFor i = 2 To lastRow\ndate1 = .Cells(i, 15)\ndate2 = .Cells(i, 16)\n    If .Cells(i, 18).Value = \"No\" Then\n    answer = DateDiff(\"n\", date1, date2)\n    .Cells(i, 20) = answer\n    End If\ndurationID = .Cells(i,1).Value\nNext i\n\n'Open MS Project and add Duration column\nset wb = ActiveWorkBook\nSet ws = wb.Sheets(\"Task_Table1\")\nSet appProj = CreateObject(\"Msproject.Application\")\nappProj.FileOpen \"File1.mpp\"\nSet aProg = appProj.ActiveProject\nappProj.Visible = True\n\n\nlastTask = ActiveProject.Tasks.Count\ntaskID = ActiveProject.Tasks.ID\n\n'Load Durations into MS Project to appropriate ID task\nlastTask = ActiveProject.Tasks.Count\nFor i = 1 to lastTask\n    If taskID = Application.Workbooks(\"File1\").Sheets(\"Task_Table1\").Cells(i, 1).Value Then\n    answer.Copy\n    appProj.SelectCell.ActiveCell\n    end if\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498056902, "post_id": 44679392, "comment_id": 76343370, "body": "Well, I thought of that, but I&#39;m not sure what it would look like.  If it is empty, the opportunity to capture the value is gone.  If it&#39;s not empty, there is nothing to do, right.  If you have a working solution, please post the code."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498057052, "post_id": 44679392, "comment_id": 76343506, "body": "You haven&#39;t described precisly what your chain of events needs to do."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1498060918, "post_id": 44679662, "comment_id": 76346410, "body": "Now it makes sense.  Thanks everyone!!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 4, "last_activity_date": 1498057132, "creation_date": 1498057132, "answer_id": 44679662, "question_id": 44679392, "link": "https://stackoverflow.com/questions/44679392/how-can-i-fire-a-macro-only-if-someone-deletes-a-value-from-a-certain-range/44679662#44679662", "title": "How can I fire a Macro ONLY if someone deletes a value from a certain Range?", "body": "<p>Save the data in the <code>Worksheet_SelectionChange</code>-Event in a global var and access it in the <code>Worksheet_Change</code>-Event. See <a href=\"https://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba\">this example</a>  on StackOverflow</p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1498057618, "creation_date": 1498057618, "answer_id": 44679854, "question_id": 44679392, "link": "https://stackoverflow.com/questions/44679392/how-can-i-fire-a-macro-only-if-someone-deletes-a-value-from-a-certain-range/44679854#44679854", "title": "How can I fire a Macro ONLY if someone deletes a value from a certain Range?", "body": "<p>Sorry, don't have time to write the code but I'm sure someone else can help there.. </p>\n\n<p>Create a mirror copy of the sheet on a hidden sheet by using Worksheet_Change. you only need to mirror the range you're worried about.</p>\n\n<p>Each time a change is made perform the following in the event:</p>\n\n<ol>\n<li><p>Check if the Target becomes blank. If it does, store the value of the same cell <em>from the mirror</em>. </p></li>\n<li><p>Copy the value of the Target cell to the same cell on the mirror. </p></li>\n<li><p>If the store has a value, then act upon it as you see fit.</p></li>\n</ol>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1498057787, "answer_count": 2, "score": 0, "last_activity_date": 1498057618, "creation_date": 1498056408, "last_edit_date": 1531164843, "question_id": 44679392, "link": "https://stackoverflow.com/questions/44679392/how-can-i-fire-a-macro-only-if-someone-deletes-a-value-from-a-certain-range", "closed_reason": "Duplicate", "title": "How can I fire a Macro ONLY if someone deletes a value from a certain Range?", "body": "<p>I have the script below that pretty much does what I want, but I need it to fire off ONLY if someone deletes a value from the Range E9:E17.  It is not really a SelectionEvent, it is more of a Change_Event, but if the change is the delete, the value is gone from the cell before I can capture it.  I think the SelectionEvent has to call the change event.  Does it make sense?  Let me know if you need clarification.  Thanks!!</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n\nApplication.EnableEvents = True\n\nIf Not Intersect(Target, Range(\"E9:E17\")) Is Nothing Then\n\n    GetValue = ActiveCell.Value\n    GetCustomer = ActiveCell.Offset(0, -1).Value\n\n    With Sheets(\"LargeCustomerOP\").Range(\"D2:D6\") 'searches range in Col D\n        Set Rng = .Find(What:=GetCustomer, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n            Rng.Offset(0, 1).Value = Rng.Offset(0, 1).Value + GetValue\n        Else\n            'value not found\n        End If\n    End With\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498056758, "post_id": 44679304, "comment_id": 76343233, "body": "The first potential problem I notice is that you set counter to 1 each time you loop, do you want it to do that? At the same time, you don&#39;t <i>need</i> to <code>Dim</code> each variable every time you loop"}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "reply_to_user": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498056989, "post_id": 44679304, "comment_id": 76343455, "body": "No i realize that that could be moved out of the loop, thanks!"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498057389, "post_id": 44679304, "comment_id": 76343803, "body": "You could use a simple =COUNTIF($A$1:$A$1000,A1) perhaps?"}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "edited": false, "score": 0, "creation_date": 1498057457, "post_id": 44679304, "comment_id": 76343845, "body": "Okay Dexloft so that seems to have fixed it. It is a huge file so it is taking a long time to finish, I will let you know if i have any other issues. Thanks again!"}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "edited": false, "score": 0, "creation_date": 1498057568, "post_id": 44679304, "comment_id": 76343940, "body": "jkpieterse, that might work, but the file im going to run this in changes length and i prefer to not have to edit the function every file i need to run the macro in. that is if i understand what you posted..."}], "answers": [{"comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498058363, "post_id": 44679793, "comment_id": 76344582, "body": "Yes <code>Sheet1</code> is not defined and gives <code>Object Required</code> Error. I would also set a variable as worksheet. with <code>Dim sht as Worksheet</code> and <code>Set sht = Worksheets(&quot;Sheet1&quot;)</code>. Now you can use <code>sht</code> instead of <code>Worksheets(&quot;Sheet1&quot;)</code> , which makes the code more handy. To even make this shorter you could use a <code>With sht</code> for the entire code after the <code>Dim</code> Mehtods."}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "edited": false, "score": 0, "creation_date": 1498058369, "post_id": 44679793, "comment_id": 76344587, "body": "What is the L65536 for?"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498058585, "post_id": 44679793, "comment_id": 76344752, "body": "On Excel 2003 and old versions like that, it&#39;s the maximum row value possible. Since you got an error and I didn&#39;t (I&#39;m using Excel 2007), I figured you might have an older version so I just used that in case. Basically, it goes to the very last row in column L and then uses <code>.End(xlUp)</code> from there to get the last used row in L. But I noticed an error in my method, it doesn&#39;t do the last row in the column because my loop goes to LastRow - 1"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498058710, "post_id": 44679793, "comment_id": 76344839, "body": "@UGP, yeah I always see people doing that but I never really liked the way it looked and sometimes I even found it hard to follow, personally. Do you think those are things I should start doing or do you think it&#39;s more of a personal preference thing?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498058992, "post_id": 44679793, "comment_id": 76345038, "body": "On a short code like this, it not really necessary to use a <code>with</code> but i would definitly use a variable for the worksheet. It helps, if you need to adjust anything and writing a lot easier and short. I would recommend using it every time."}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "edited": false, "score": 0, "creation_date": 1498059134, "post_id": 44679793, "comment_id": 76345154, "body": "So i got the code running i believe, but it crashes every time:run-time error &#39;-2147417848 (80010108)&#39;: Method &#39;_Default&quot; of object &quot;Range&quot; failed. Any idea what that means?"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498059242, "post_id": 44679793, "comment_id": 76345220, "body": "@UGP Ok, I&#39;ll for sure start trying to use it. I definitely agree that it would be easier to make changes, and anything that would confuse me is just bad variable naming on my part. Thanks!"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498059848, "post_id": 44679793, "comment_id": 76345671, "body": "Ok I just like triple checked everything and I have no clue where that error could come from. Did you change anything? Also 2 questions, what version of excel are you using and do you know how to step through code?"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498060066, "post_id": 44679793, "comment_id": 76345829, "body": "I made another edit to the code, this works for the last row and hopefully gets rid of that error even though I don&#39;t know which part could be giving it to you"}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "edited": false, "score": 0, "creation_date": 1498060233, "post_id": 44679793, "comment_id": 76345962, "body": "The code looks the same as the second block on the original question, and i am running excel 2013. I am currently stepping through the code, the problem is that it will run until the counter reaches around 734 then crashes, so stepping that far takes some time"}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498060402, "post_id": 44679793, "comment_id": 76346078, "body": "Well that is definitely really random then, try to make the for loop condition be <code>For i = 1 to 733</code> and see if that works just fine. Then, try <code>For i = 734 To LastRow - 1</code> and that&#39;ll be easier to step through. Is there something weird about row 734?"}, {"owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "edited": false, "score": 0, "creation_date": 1498060868, "post_id": 44679793, "comment_id": 76346382, "body": "So i just set the for loop to go to row 1000 and it worked fine, so im wondering if the problem is that it takes a while, as it is usually going through to 114,623. So im going to just let it run, and see if in a couple of minutes it has finished."}, {"owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "edited": false, "score": 0, "creation_date": 1498061263, "post_id": 44679793, "comment_id": 76346623, "body": "If that still doesn&#39;t work, try changing the 65536 to 1048576 and <code>Dim counter as Integer</code> to <code>Dim counter as Long</code>, I didn&#39;t realize you had so many rows"}], "tags": [], "owner": {"reputation": 63, "user_id": 8116312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b24d00145db14cbd142821f9d68e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Dexloft", "link": "https://stackoverflow.com/users/8116312/dexloft"}, "is_accepted": false, "score": 0, "last_activity_date": 1498060023, "last_edit_date": 1498060023, "creation_date": 1498057446, "answer_id": 44679793, "question_id": 44679304, "link": "https://stackoverflow.com/questions/44679304/excel-vba-a-lot-of-problems/44679793#44679793", "title": "Excel VBA a lot of problems", "body": "<p>I don't get an error when I run your code, but I made some changes I think might fix it. Try this and let me know what happens!</p>\n\n<pre><code> Sub TommysMacro()\n    'Find the last used row in a Column: column A in this example\n    Dim LastRow As Long\n    Dim counter As Integer\n\n    LastRow = Sheets(\"Sheet1\").Cells(65536, \"L\").End(xlUp).Row + 1\n\n    'Sets values to be compared\n    ReDim cellValue(1 To LastRow) As String\n    For i = 1 To LastRow\n        cellValue(i) = Worksheets(\"Sheet1\").Cells(i, \"L\").Value\n    Next i\n\n    'Search down row for duplicates\n    For i = 1 To LastRow - 1\n\n        'If values are not diferent then counter will not increment\n        If cellValue(i) &lt;&gt; cellValue(i + 1) Then\n            counter = counter + 1\n        End If\n\n        'Sets the n column to count, duplicates should not increment the counter\n        Sheets(\"Sheet1\").Cells(i, \"N\").Value = counter\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I just changed it after I saw your comment about it being a large column, I think this should be much faster!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "is_accepted": true, "score": 0, "last_activity_date": 1498063389, "creation_date": 1498063389, "answer_id": 44681820, "question_id": 44679304, "link": "https://stackoverflow.com/questions/44679304/excel-vba-a-lot-of-problems/44681820#44681820", "title": "Excel VBA a lot of problems", "body": "<p>Alrighty this is the code I finished with:</p>\n\n<p>Sub Duplicate_Count()</p>\n\n<pre><code>Dim LastRow As Long\nDim value1 As String\nDim value2 As String\nDim counter As Long\ncounter = 0\nDim sht As Worksheet\nSet sht = Worksheets(\"Sheet1\")\n\n'Find the last used row in Column L\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"L\").End(xlUp).Row\nEnd With\n\n'Search down row for duplicates\nDim i As Long\n\nFor i = 1 To LastRow - 1\n\n\n    'Sets value1 and value2 to be compared\n    value1 = Worksheets(\"Sheet1\").Cells(i, \"L\").Value\n    value2 = Worksheets(\"Sheet1\").Cells(i + 1, \"L\").Value\n\n    'If values are not diferent then counter will not increment\n    If value1 &lt;&gt; value2 Then\n        counter = counter + 1\n    End If\n\n    'Sets the n colom to count, duplicates should not increment the counter\n    sht.Cells(i + 1, \"N\") = counter\n\nNext i\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Thank you so much everyone for your help! Turns out that the values are strings because I had some headers being looked at, and setting the worksheet was one of my biggest problems, as to it having the run time error, i believe that is just because the document is so long. I let it sit for 30 min and it completed just fine. \nThanks again for the help everyone !</p>\n"}], "owner": {"reputation": 1, "user_id": 8194917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEUHJ.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8194917/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 44681820, "answer_count": 2, "score": 0, "last_activity_date": 1532371151, "creation_date": 1498056158, "last_edit_date": 1532371151, "question_id": 44679304, "link": "https://stackoverflow.com/questions/44679304/excel-vba-a-lot-of-problems", "title": "Excel VBA a lot of problems", "body": "<p>So I'm new to VBA, and I am trying to get a macro to compare cells, and output a counter in the column next to it. Here is my code: </p>\n\n<pre><code>Sub Duplicate_Count()\n\n'Find the last used row in a Column: column A in this example\n\nDim LastRow As Long\nDim value1 As String\nDim value2 As String\nDim counter As Integer\ncounter = 1\n\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"L\").End(xlUp).Row\nEnd With\n\n'Search down row for duplicates\nDim i As Long\n\nFor i = 1 To LastRow\n\n    'Sets value1 and value2 to be compared\n    value1 = Worksheets(\"Sheet1\").Cells(i, \"L\").Value\n    value2 = Worksheets(\"Sheet1\").Cells(i + 1, \"L\").Value\n\n    'If values are not diferent then counter will not increment\n    If value1 &lt;&gt; value2 Then\n        counter = counter + 1\n    End If\n\n    'Sets the n colom to count, duplicates should not increment the counter\n    Sheet1.Cells(i, \"N\") = counter\n\nNext i\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Okay so this code runs, and it looks it works, column \"N\" starts to populate, but the program freezes up, and I do not know if it is just because the file is so large that it takes a lot of time, or if something is wrong. If i restart the program i get run-time error '-2147417848 (80010108)': Method '_Default\" of object \"Range\" failed. Any idea what that means?</p>\n\n<p>Any help would be greatly appreciated, hopefully, I'm not just making dumb mistakes.</p>\n\n<p>EDIT:\nSub Duplicate_Count()\n    'Find the last used row in a Column: column A in this example</p>\n\n<pre><code>Dim LastRow As Long\nDim value1 As String\nDim value2 As String\nDim counter As Long\ncounter = 0\nDim sht As Worksheet\nSet sht = Worksheets(\"Sheet1\")\n\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"L\").End(xlUp).Row\nEnd With\n\n'Search down row for duplicates\nDim i As Long\n\nFor i = 1 To LastRow\n\n    'Sets value1 and value2 to be compared\n    value1 = Worksheets(\"Sheet1\").Cells(i, \"L\").Value\n    value2 = Worksheets(\"Sheet1\").Cells(i + 1, \"L\").Value\n\n    'If values are not diferent then counter will not increment\n    If value1 &lt;&gt; value2 Then\n        counter = counter + 1\n    End If\n\n    'Sets the n colom to count, duplicates should not increment the counter\n    sht.Cells(i, \"N\") = counter\n\nNext i\n</code></pre>\n\n<p>End Sub</p>\n\n<p>This code crashes every time, and will occasionally give me an error of run-time error '-2147417848 (80010108)': Method '_Default\" of object \"Range\" failed. I have no idea how to fix that... or what it even means.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498056872, "post_id": 44679252, "comment_id": 76343343, "body": "What do you mean by <i>&quot;if I send file to another add-in user&quot;</i>?"}, {"owner": {"reputation": 1, "user_id": 8194776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23080727981d6a2aa0454a64e75fb0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Gu\u0142aj", "link": "https://stackoverflow.com/users/8194776/maciej-gu%c5%82aj"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498058417, "post_id": 44679252, "comment_id": 76344623, "body": "I work for corporation - when I&#39;m opening file where someone used my function (enterd on other computer) I see <i>=&#39;C:\\TrustedVBA\\AddRates_1.2.xlam&#39;!ExRate(Q2,L2)</i> instead <i>=ExRate(Q2,L2)</i>"}], "owner": {"reputation": 1, "user_id": 8194776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23080727981d6a2aa0454a64e75fb0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Gu\u0142aj", "link": "https://stackoverflow.com/users/8194776/maciej-gu%c5%82aj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498056538, "creation_date": 1498056052, "last_edit_date": 1498056538, "question_id": 44679252, "link": "https://stackoverflow.com/questions/44679252/link-display-function-connected-to-added-worksheet-from-particular-location", "title": "Link display: function connected to added worksheet from particular location", "body": "<p>I created add-in with a few options, e.g.:  </p>\n\n<ul>\n<li>Add sheet with exchange rates(\"TPD value\")   </li>\n<li>Function for assign date to currency based on mentioned sheet.</li>\n</ul>\n\n<p>It works very well during use but if I send file to another add-in user the functions looks like:\n<code>='C:\\TrustedVBA\\AddRates_1.2.xlam'!ExRate(Q2,L2)</code>  (link to added sheet) instead of <code>=ExRate(Q2,L2)</code></p>\n\n<p>Any idea how to get expected format (<code>=ExRate(Q2,L2)</code>) on each computer?</p>\n\n<p>Full function code:</p>\n\n<pre><code>Function ExRate(TCurr, TPD As Range) As Variant\n\nDim TPD_Value As Worksheet\n\nSet TPD_Value = ActiveWorkbook.Worksheets(\"TPD value\")\n\nDim RateTable As Range\n\nDim Location1 As Range\n\nDim ColumnNo As Integer\n\nSelect Case TCurr\n\n            Case Is = \"EUR\": ExRate = 1\n\nCase Else\n\n        On Error Resume Next\n\n            Set RateTable = TPD_Value.Columns(\"A:AP\")\n\n            Set Location1 = TPD_Value.Cells.Find(What:=TCurr, LookAt:=xlWhole,\n\n            MatchCase:=False, SearchFormat:=False)\n\n                ColumnNo = Location1.Column\n\n       On Error Resume Next\n\n            ExRate = Application.VLookup(TPD, RateTable, ColumnNo, False)\n\nEnd Select\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1498057839, "post_id": 44679071, "comment_id": 76344170, "body": "You have just posted a question tagged with excel-vba to ask if there&#39;s a way to do something without vba?  Also take a look at these guidelines for writing a good SO question: <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">codeblog.jonskeet.uk/2012/11/24/&hellip;</a>"}, {"owner": {"reputation": 131, "user_id": 8193907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83ae2defabc43cb43aece025c7cd94e?s=128&d=identicon&r=PG&f=1", "display_name": "Frans Bstrom", "link": "https://stackoverflow.com/users/8193907/frans-bstrom"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1498058358, "post_id": 44679071, "comment_id": 76344573, "body": "Well its still in VBA but using SQL queries with ADODB"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 10883689, "user_type": "registered", "profile_image": "https://graph.facebook.com/2013101115406448/picture?type=large", "display_name": "Felix Exner", "link": "https://stackoverflow.com/users/10883689/felix-exner"}, "is_accepted": true, "score": 1, "last_activity_date": 1562165326, "creation_date": 1562165326, "answer_id": 56872771, "question_id": 44679071, "link": "https://stackoverflow.com/questions/44679071/copy-and-add-a-sheet-to-a-closed-workbook/56872771#56872771", "title": "Copy and add a sheet to a closed workbook", "body": "<p>I got the same problem and searched for hours until found this one using ADODB-Connection Object: </p>\n\n<pre><code>path= &lt;yourFilePath&gt;\nset cn = new ADODB.connection\n\n'create connection String\nconnStr=\"Provider=Microsoft.ACE.OLEDB.12.0; &amp; _\n        \"Data Source=\" &amp; path &amp; \";\" &amp; _\n        \"Extended Properties='Excel 12.0;HDR=YES;\"\";ReadOnly=0'\"\n\ncn.Open connStr\nset cmd = new adodb.command\ncmd.ActiveConnection = cn\n\n'create sql-string\ncmd.CommandText = \"CREATE TABLE [&lt;TableName&gt;] (&lt;anyString&gt; char(255))\"\ncmd.Execute\n</code></pre>\n\n<p>see: <a href=\"https://stackoverflow.com/a/11473356/10883689\">VBA to add new sheet in a closed excel without opening &amp; get the sheet name added?\n</a></p>\n\n<p>I think that's what you and everyone else who stumble about this post is looking for. </p>\n\n<p>Further you can create a String <code>INSERT INTO [&lt;TableName&gt;$] VALUES('&lt;values&gt;')</code> to add some data to the sheet.</p>\n"}], "owner": {"reputation": 131, "user_id": 8193907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83ae2defabc43cb43aece025c7cd94e?s=128&d=identicon&r=PG&f=1", "display_name": "Frans Bstrom", "link": "https://stackoverflow.com/users/8193907/frans-bstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56872771, "answer_count": 1, "score": 0, "last_activity_date": 1562165326, "creation_date": 1498055649, "last_edit_date": 1531164843, "question_id": 44679071, "link": "https://stackoverflow.com/questions/44679071/copy-and-add-a-sheet-to-a-closed-workbook", "title": "Copy and add a sheet to a closed workbook", "body": "<p>Using SQL I can access and edit cells in Excel workbooks without opening them in a vba script. However I have not yet found a way to copy or add a sheet in a similar way. Atm I use Workbook.Open and Copy to accomplish it. Is this possible? </p>\n"}, {"tags": ["excel", "vba", "for-loop", "compiler-errors", "type-mismatch"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498055819, "post_id": 44679060, "comment_id": 76342414, "body": "You need to declare the variables correctly, if you are getting a Type mismatch"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1498055826, "post_id": 44679060, "comment_id": 76342419, "body": "Change this line of code from:  Sum = SumEIP + EIP(p, t)  to:  Sum = Sum + EIP(p, t)."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1498055835, "post_id": 44679060, "comment_id": 76342429, "body": "Hi, could you add a little more detail, I&#39;m not sure I&#39;m following"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498056488, "post_id": 44679060, "comment_id": 76342985, "body": "When you get the type mismatch, what content do the variables have? IP is declared as variant so can contain anything whereas EIP is Integer and SUMEIP is Long. If those are all supposed to be whole numbers, declare all as Long."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1498057000, "post_id": 44679060, "comment_id": 76343466, "body": "Where are <code>I</code>, <code>p</code> and <code>t</code> declared?"}, {"owner": {"reputation": 11, "user_id": 7951992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/455bd68bb124a0ff1a2e06b46f2e6759?s=128&d=identicon&r=PG&f=1", "display_name": "user7951992", "link": "https://stackoverflow.com/users/7951992/user7951992"}, "edited": false, "score": 0, "creation_date": 1498057047, "post_id": 44679060, "comment_id": 76343501, "body": "Brian M Stafford, that solved my problem, thank you very much for your quick response! Same goes for the other repliers, Thanks!"}], "owner": {"reputation": 11, "user_id": 7951992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/455bd68bb124a0ff1a2e06b46f2e6759?s=128&d=identicon&r=PG&f=1", "display_name": "user7951992", "link": "https://stackoverflow.com/users/7951992/user7951992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498055620, "creation_date": 1498055620, "question_id": 44679060, "link": "https://stackoverflow.com/questions/44679060/compile-error-type-mismatch-in-sum-loop-excel-vba", "title": "Compile error: type mismatch in sum loop, excel VBA", "body": "<pre><code>   Dim SumEIP(1 To 708, 1 To 200) As Long\n   Dim EIP(1 To 708, 1 To 200) As Integer\n   Dim IP(1 To 708, 1 To 200) As Variant\n   Dim LeadTime(1 To 708) As Integer\n   Dim SR(1 To 708, 1 To 200) As Integer\n   Dim CumReceipt(1 To 708, 1 To 200) As Integer  \n\n\nSub test()\n\n  For i = 1 To 708\n\n  LeadTime(i) = 5\n\n  Next i\n\n                For i = 1 To 708\n                    For t = 1 To 60\n                        For p = 1 To 2\n                                Sum = SumEIP + EIP(p, t)\n                        Next p\n                                SumEIP(i, t) = Sum\n                                Sum = 0\n                                EIP(i, t) = IP(i, t) + SumEIP(i, t)\n\n                         ''For C = 1 To LeadTime(i) - 1\n                         ''   SumReceipts = SumReceipts + SR(i, t + C)\n                         ''Next C\n                         ''       CumReceipt(i, t) = SumReceipts\n                         ''       SumReceipts = 0\n\n                    Next t\n                Next i\n End Sub\n</code></pre>\n\n<p>Whenever I run the uncommented piece of code I get a compile error: type mismatch  and Excel highlights the + sign before EIP(p,t).</p>\n\n<p>However, when I run the commented part of code, I do not get this error. I cannot find the difference between the two explaining the difference in errors. What am I missing?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1498055963, "post_id": 44679012, "comment_id": 76342532, "body": "I&#39;m  confused by your example.  You list your column data as <code>C B A F E D I G H</code> and then state that you want the first output to be <code>ADG</code>, which is the third, sixth, and eigth columns, not 3, 6, and 9 as I would expect from your description.  Then you state the second output should be <code>BEH</code> which are the second, fifth, and ninth columns, not the 2, 5, 8 expected from your description.  And <code>CFI</code> is 1st, 4th, and 7th so it&#39;s the only one that <i>does</i> match your description.  Can you please clarify??"}, {"owner": {"reputation": 109, "user_id": 7762563, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69f7a5d9bf3b242ce449f4d1bc6d8240?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/7762563/john-d"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1498056223, "post_id": 44679012, "comment_id": 76342782, "body": "Column output would be ADG with column A now having  columns B and C under it, then Column B would have E and H under it and so fourth. I hope that helps."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1498057524, "post_id": 44679012, "comment_id": 76343894, "body": "But why is it ADG instead of ADH?  Per your description, it <i>should</i> be ADH, not ADG"}, {"owner": {"reputation": 109, "user_id": 7762563, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69f7a5d9bf3b242ce449f4d1bc6d8240?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/7762563/john-d"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1498057799, "post_id": 44679012, "comment_id": 76344135, "body": "I am going to reference columns with numbers. So Column 1 -  A, B, C; Column 2 - D, E, F; Column 3 - G, H, I. I am hoping that this makes a little more sense."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 7762563, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69f7a5d9bf3b242ce449f4d1bc6d8240?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/7762563/john-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1498068346, "creation_date": 1498068346, "answer_id": 44683260, "question_id": 44679012, "link": "https://stackoverflow.com/questions/44679012/copy-column-b-and-c-under-column-a-and-repeat-every-3-columns/44683260#44683260", "title": "Copy Column B and C under Column A and Repeat every 3 Columns", "body": "<p>I was able to get the columns to process properly with the below code</p>\n\n<pre><code>Option Explicit\n\nSub ColMerge()\n    Dim lr As Long\n    Dim lrX As Long\n    lrX = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Dim i As Long\n    Dim j As Long\n    Dim lc As Long\n    Dim ws As Worksheet\n    lc = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Application.ScreenUpdating = False\n    For i = 2 To lc Step 3\n\n    Range(Cells(2, i), Cells(31, i)).Cut Range(Cells(32, i - 1), Cells(61, i - 1))\n    Range(Cells(2, i + 1), Cells(31, i + 1)).Cut Range(Cells(62, i - 1), Cells(91, i - 1))\n\n    Next i\n\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\n    MsgBox (\"Completed\")\n\nEnd Sub\n</code></pre>\n\n<p>I was able to get the sort by using the following code:</p>\n\n<pre><code>Option Explicit\n\nSub ReSort_LtoR()\n    Dim lr As Long\n    Dim lrX As Long\n    lrX = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Dim i As Long\n    Dim j As Long\n    Dim lc As Long\n    Dim ws As Worksheet\n    lc = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Application.ScreenUpdating = False\n    For i = 1 To lc Step 3\n\n    Range(Cells(1, i), Cells(31, i + 2)).Select\n    ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add Key:=Range(Cells(1, i), Cells(1, i + 2)), _\n        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet2\").Sort\n        .SetRange Range(Cells(1, i), Cells(31, i + 2))\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlLeftToRight\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Next i\n\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\n    MsgBox (\"Completed\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 7762563, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/69f7a5d9bf3b242ce449f4d1bc6d8240?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/7762563/john-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44683260, "answer_count": 1, "score": 0, "last_activity_date": 1498068346, "creation_date": 1498055482, "last_edit_date": 1498056109, "question_id": 44679012, "link": "https://stackoverflow.com/questions/44679012/copy-column-b-and-c-under-column-a-and-repeat-every-3-columns", "title": "Copy Column B and C under Column A and Repeat every 3 Columns", "body": "<p>I need to be able to convert every 3 Columns into 1 column while also selecting the three columns and sorting left to right based on header name. </p>\n\n<p>Original</p>\n\n<p>CBAFEDIGH</p>\n\n<p>Output</p>\n\n<p>ADG</p>\n\n<p>BEH</p>\n\n<p>CFI</p>\n\n<p>I have the following code to allow me to be able to convert into one column, but it doesn't limit it to the three columns and repeat every three. I am still trying to figure out the i = and Step 3</p>\n\n<p>I know the sort can be setup via a script when processing the 3 columns. Just need a little help on this one. </p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub COLMERGE()\n    Dim lr As Long\n    Dim lrX As Long\n    lrX = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Dim i As Long\n    Dim lc As Long\n    lc = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    Application.ScreenUpdating = False\n    For i = 2 To lc\n    lr = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Range(Cells(2, i), Cells(lrX, i)).Cut Range(\"A\" &amp; lr + 1)\n    Next i\n    Range(Cells(1, 2), Cells(1, lc)).ClearContents\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1498055664, "creation_date": 1498055664, "answer_id": 44679076, "question_id": 44678927, "link": "https://stackoverflow.com/questions/44678927/selecting-every-second-cell-in-excel-vba/44679076#44679076", "title": "Selecting every second cell in excel vba", "body": "<p>Something like this should assist, might not be the easiest way..</p>\n\n<pre><code>Sub sel()\n\nDim l As Long\nDim r As Range\n\nFor l = 2 To 22 Step 2\n    If r Is Nothing Then\n        Set r = Cells(2, l)\n    Else\n        Set r = Union(r, Cells(2, l))\n    End If\nNext l\n\nr.Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1498055956, "creation_date": 1498055956, "answer_id": 44679202, "question_id": 44678927, "link": "https://stackoverflow.com/questions/44678927/selecting-every-second-cell-in-excel-vba/44679202#44679202", "title": "Selecting every second cell in excel vba", "body": "<p>This would work:</p>\n\n<pre><code>Dim rng_exp As Range, x As Integer\nSet rng_exp = Cells(2, 2)\n\nFor x = 2 To 72\n    Set rng_exp = Application.Union(rng_exp, Cells(2, 2 * (x)))\nNext\n\nrng_exp.Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1498055999, "creation_date": 1498055999, "answer_id": 44679221, "question_id": 44678927, "link": "https://stackoverflow.com/questions/44678927/selecting-every-second-cell-in-excel-vba/44679221#44679221", "title": "Selecting every second cell in excel vba", "body": "<p>In simple terms, use a loop:</p>\n\n<pre><code>Sub dural()\n    Dim r As Range\n\n    Set r = Range(\"B2\")\n    For i = 4 To 142 Step 2\n        Set r = Union(r, Cells(2, i))\n    Next i\n    r.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8071512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c575a136c4f92509d3014192012596dd?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8071512/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 44679076, "answer_count": 3, "score": 0, "last_activity_date": 1498061930, "creation_date": 1498055227, "last_edit_date": 1531164843, "question_id": 44678927, "link": "https://stackoverflow.com/questions/44678927/selecting-every-second-cell-in-excel-vba", "title": "Selecting every second cell in excel vba", "body": "<p>I'm trying to select the highlighted cells </p>\n\n<p><img src=\"https://i.stack.imgur.com/OVqro.png\" alt=\"shown here\">. </p>\n\n<p>The range extends from A2 to EL2 so 72 in total. <br/></p>\n\n<p>I think I need to create a vector that is [2,4,6...] then use that result to select the cells. </p>\n\n<p>Currently my code is not working and is...</p>\n\n<pre><code>range(cells(2, 2*(1 To 72))).select\n</code></pre>\n\n<p>I'm stuck and need some help please.</p>\n"}, {"tags": ["vba", "logging", "soap", "jedox"], "answers": [{"comments": [{"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 0, "creation_date": 1498336547, "post_id": 44717717, "comment_id": 76462661, "body": "Starting an answer with a question is a good way to get it downvoted and deleted. I removed that part since it seems like the answer might be otherwise valid. If that information is relevant to your answer, you may want to try to avoid phrasing it as a question (e.g. state your assumptions - &quot;on the assumption..., you can...&quot;). Alternatively, a better option might be to post a comment on your own answer mentioning these issues in a &quot;I&#39;m not sure my answer is correct&quot; kind of way (if that&#39;s what it was). Getting that 50 reputation and then asking and waiting for clarification is best though."}], "tags": [], "owner": {"reputation": 1, "user_id": 8204210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64de1f36d7d921efc452ba946b8fb03f?s=128&d=identicon&r=PG&f=1", "display_name": "Erwin Zeiter", "link": "https://stackoverflow.com/users/8204210/erwin-zeiter"}, "is_accepted": false, "score": 0, "last_activity_date": 1498336160, "last_edit_date": 1498336160, "creation_date": 1498209617, "answer_id": 44717717, "question_id": 44678269, "link": "https://stackoverflow.com/questions/44678269/jedox-how-to-export-soap-log-into-excel-file/44717717#44717717", "title": "Jedox - How to export SOAP Log into Excel file", "body": "<p>The easiest way to get these information is to use the <strong>Integrator</strong> in Jedox.\nThere you have the possibility to use a File Extract and then you can filter the information you are searching for.\nAfter that it's possible to load these filtered information into a File.\nThe minimum steps you'll need are Connection -> Extract -> Transform -> Load.\nPlease take a look at the sample projects that are delivered with the Jedox software. In the example \"sampleBiker\", there are also file connections, extracts etc.\nYou can find more samples in:</p>\n\n<pre><code>&lt;Install_path&gt;\\tomcat\\webapps\\etlserver\\data\\samples\n</code></pre>\n\n<p>I recommend to check the <a href=\"http://knowledgebase.jedox.com\" rel=\"nofollow noreferrer\">Jedox Knowledgebase</a>.</p>\n\n<p>The other way (and maybe more flexible way) would be to use, for example, a PHP macro inside of a Jedox Web report and read the log file you're trying to display.\nIf you've got a more specific idea what you'd like to do, please let me know and I'll try to give you an example how to do so.</p>\n"}], "owner": {"reputation": 1, "user_id": 7199813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358d47fe3a2269aa8e8f974777585d95?s=128&d=identicon&r=PG&f=1", "display_name": "usikbyr", "link": "https://stackoverflow.com/users/7199813/usikbyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554392435, "creation_date": 1498053546, "last_edit_date": 1554392435, "question_id": 44678269, "link": "https://stackoverflow.com/questions/44678269/jedox-how-to-export-soap-log-into-excel-file", "title": "Jedox - How to export SOAP Log into Excel file", "body": "<p>I'm pretty new on Jedox, and I'm trying for internal use to export some specific \"warning logs\" (eg. \"(<em>Mapping missing</em>)\" ) into an excel/wss file.</p>\n\n<p>And I don't how to do that...</p>\n\n<p>Can you help me please.</p>\n\n<p>Regards,\nUsik</p>\n"}, {"tags": ["excel", "vba", "api"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8194491, "user_type": "registered", "profile_image": "https://graph.facebook.com/1449008085190695/picture?type=large", "display_name": "Nico Ditu", "link": "https://stackoverflow.com/users/8194491/nico-ditu"}, "edited": false, "score": 0, "creation_date": 1498080620, "post_id": 44678149, "comment_id": 76357223, "body": "+1 In first place you are a genius! Thank you very much. I tried hard but i couldn&#39;t achieve it whitout your assistence. Now I gonna try to get data :) I hope have success"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1498053270, "creation_date": 1498053270, "answer_id": 44678149, "question_id": 44677873, "link": "https://stackoverflow.com/questions/44677873/access-api-through-vba-in-excel/44678149#44678149", "title": "Access API through VBA in Excel", "body": "<ol>\n<li>You need to call <code>SetRequestHeader</code> for <em>each</em> header and value, you cant combine them</li>\n<li>The request is JSON but you omit the <code>{}</code></li>\n</ol>\n\n<hr>\n\n<pre><code>oRequest.Open \"POST\", \"http://demo-api.primary.com.ar:8081/pbcp/rest/users/login\"\noRequest.SetRequestHeader \"Content-Type\", \"application/json\"\noRequest.SetRequestHeader \"Accept\", \"application/json\"\n\nDim s As String\ns = \"{\" &amp; Chr(34) &amp; \"username\" &amp; Chr(34) &amp; \":\" &amp; Chr(34) &amp; \"Demo-User\" &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; \"password\" &amp; Chr(34) &amp; \":\" &amp; Chr(34) &amp; \"ApiEx@mpl3\" &amp; Chr(34) &amp; \"}\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8194491, "user_type": "registered", "profile_image": "https://graph.facebook.com/1449008085190695/picture?type=large", "display_name": "Nico Ditu", "link": "https://stackoverflow.com/users/8194491/nico-ditu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7580, "favorite_count": 0, "accepted_answer_id": 44678149, "answer_count": 1, "score": 0, "last_activity_date": 1498055220, "creation_date": 1498052513, "last_edit_date": 1498055220, "question_id": 44677873, "link": "https://stackoverflow.com/questions/44677873/access-api-through-vba-in-excel", "title": "Access API through VBA in Excel", "body": "<p>I need log in to this API: <a href=\"http://demo-api.primary.com.ar:8081/pbcp/rest/users/login\" rel=\"nofollow noreferrer\">http://demo-api.primary.com.ar:8081/pbcp/rest/users/login</a></p>\n\n<p>There is a <a href=\"http://api.primary.com.ar/api-quickstart.html\" rel=\"nofollow noreferrer\">quickstart guide</a> with all information, but I never used those instructions and I don't know how perform a macro in Excel to connect and then get market data</p>\n\n<p>I tried different methods in Excel but I can't make it work. My last attempt was to send through <code>WinHttp.WinHttpRequest.5.1</code> headers like express in cUrl but the errors are systematical. </p>\n\n<p>Here is my code, which is a compilation of different bits of code extracted from the web.</p>\n\n<pre><code>curl -X POST --header 'Content-Type: application/json' --header 'Accept: application/json' -d '{\n  \"username\": \"Demo-User\",\n  \"password\": \"ApiEx@mpl3\"\n}' 'http://demo-api.primary.com.ar:8081/pbcp/rest/users/login'\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Sub prueba()\n\nDim oRequest As Object\nSet oRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\nDim h1 As String\nDim h2 As String\n\noRequest.Open \"POST\", \"http://demo-api.primary.com.ar:8081/pbcp/rest/users/login\"\noRequest.SetRequestHeader \"Content-Type\", \"application/json\", \"Accept\", \"application/json\" ''Content-Type: application/json'\n\nDim s As String\ns = Chr(34) &amp; \"username\" &amp; Chr(34) &amp; \":\" &amp; Chr(34) &amp; \"Demo-User\" &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; \"password\" &amp; Chr(34) &amp; \":\" &amp; Chr(34) &amp; \"ApiEx@mpl3\" &amp; Chr(34)\n\noRequest.Send s\nMsgBox oRequest.ResponseText\nEnd Sub\n\n\n'Dim oRequest As Object\n'Set oRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n'oRequest.Open \"POST\", \"http://demo-api.primary.com.ar:8081/pbcp/rest/users/login\"\n'oRequest.SetRequestHeader \"Content-Typ\", \"application/x-www-form-urlencoded\"\n'oRequest.Send \"var1=123&amp;anothervar=test\"\n'MsgBox oRequest.ResponseText\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6423962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/513b0a075f634e3bdd9454fa071b3c8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Kaczynski", "link": "https://stackoverflow.com/users/6423962/alex-kaczynski"}, "edited": false, "score": 0, "creation_date": 1498057987, "post_id": 44678371, "comment_id": 76344281, "body": "Added that line to the VBA and it gave me a run time error that the item with the specified name wasn&#39;t found. It highlights the   With ActiveSheet.Shapes(&quot;Chart1&quot;) as the error line."}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1498053810, "creation_date": 1498053810, "answer_id": 44678371, "question_id": 44677832, "link": "https://stackoverflow.com/questions/44677832/change-location-of-chart-using-vba/44678371#44678371", "title": "Change location of chart using VBA", "body": "<p>You can change Name of active Chart and then assign the properties to it.</p>\n\n<p>Try This...</p>\n\n<pre><code>    reportsheet.Select\n    ActiveSheet.Range(\"A4\", ActiveSheet.Range(\"A4\").End(xlDown)).Select\n    ActiveSheet.Shapes.AddChart.Select\n\n    ActiveChart.Parent.Name = \"Chart1\"\n\n    With ActiveSheet.Shapes(\"Chart1\")\n       .Left = Range(\"A40\").Left\n       .Top = Range(\"A40\").Top\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1498054115, "creation_date": 1498054115, "answer_id": 44678482, "question_id": 44677832, "link": "https://stackoverflow.com/questions/44677832/change-location-of-chart-using-vba/44678482#44678482", "title": "Change location of chart using VBA", "body": "<p>I use make chart like this. Please refer to bellows.</p>\n\n<pre><code>Sub test()\n    Dim Ws As Worksheet\n    Set Ws = ActiveSheet\n\n    InsertCharts 20, Ws\n    InsertCharts 30, Sheets(\"Sheet1\")\nEnd Sub\n\nSub InsertCharts(n As Integer, Ws As Worksheet)\n\n    Dim Cht As Shape\n    Dim t As Single, w As Integer, h As Integer, x As Integer\n    Dim i As Integer\n\n    With Ws\n        If .ChartObjects.Count &gt; 0 Then\n            .ChartObjects.Delete\n        End If\n\n        x = 0\n        t = .Range(\"a26\").Top\n        w = 217.1338582677\n        h = 203.5275590551\n        For i = 1 To n\n\n                Set Cht = .Shapes.AddChart(, x, t, w, h)\n            If i Mod 5 = 0 Then\n                t = .Range(\"a26\").Top\n                x = x + w + 20\n            Else\n                t = t + h + 20\n            End If\n\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6423962, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/513b0a075f634e3bdd9454fa071b3c8c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Kaczynski", "link": "https://stackoverflow.com/users/6423962/alex-kaczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2077, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498054115, "creation_date": 1498052418, "last_edit_date": 1498052935, "question_id": 44677832, "link": "https://stackoverflow.com/questions/44677832/change-location-of-chart-using-vba", "title": "Change location of chart using VBA", "body": "<p>I am trying to change the location of the graph that I generate with my vba. For now, it is just taking data from a column that may or may not change size. I understand I do not have 'Chart1' identified ion my code but I can not figure out where to declare it where it doesn't create another sheet for the chart as well.</p>\n\n<pre><code>reportsheet.Select\nActiveSheet.Range(\"a4\", ActiveSheet.Range(\"a4\").End(xlDown)).Select\nActiveSheet.Shapes.AddChart.Select\n\nWith ActiveSheet.Shapes(\"Chart1\")\n   .Left = Range(\"A40\").Left\n   .Top = Range(\"A40\").Top\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 1447264, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/160c5037d37bcaed10f39c3b358387a6?s=128&d=identicon&r=PG", "display_name": "fourgood", "link": "https://stackoverflow.com/users/1447264/fourgood"}, "edited": false, "score": 0, "creation_date": 1498065784, "post_id": 44678218, "comment_id": 76349186, "body": "Great, definately the right answer! Now I have about 20,000 rows, how can I make this variable to work with several lines at once?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 177, "user_id": 1447264, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/160c5037d37bcaed10f39c3b358387a6?s=128&d=identicon&r=PG", "display_name": "fourgood", "link": "https://stackoverflow.com/users/1447264/fourgood"}, "edited": false, "score": 0, "creation_date": 1498065963, "post_id": 44678218, "comment_id": 76349293, "body": "Each combination pair of cells will have to be dealt with individually. Either <code>for each x in ... next x</code> or <code>for i=2 to ... Next i</code>."}, {"owner": {"reputation": 177, "user_id": 1447264, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/160c5037d37bcaed10f39c3b358387a6?s=128&d=identicon&r=PG", "display_name": "fourgood", "link": "https://stackoverflow.com/users/1447264/fourgood"}, "edited": false, "score": 0, "creation_date": 1498115974, "post_id": 44678218, "comment_id": 76368524, "body": "Actually im not very familiar with VBA scripting. Would you mind updating your original answer with the foreach loop applied?"}, {"owner": {"reputation": 177, "user_id": 1447264, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/160c5037d37bcaed10f39c3b358387a6?s=128&d=identicon&r=PG", "display_name": "fourgood", "link": "https://stackoverflow.com/users/1447264/fourgood"}, "edited": false, "score": 0, "creation_date": 1498124302, "post_id": 44678218, "comment_id": 76374375, "body": "Ok, got it working by myself - updated my question accordingly"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1498053448, "creation_date": 1498053448, "answer_id": 44678218, "question_id": 44677764, "link": "https://stackoverflow.com/questions/44677764/combining-two-cells-in-excel-but-keeping-the-font/44678218#44678218", "title": "Combining two cells in excel but keeping the font", "body": "<p>Manipulate the .Characters property.</p>\n\n<pre><code>With Worksheets(\"sheet4\")\n    With .Cells(6, \"F\")\n        .Value = .Offset(0, -2).Value2 &amp; Chr(10) &amp; .Offset(0, -1).Value2\n        .Characters(Start:=Len(.Offset(0, -2).Value2) + 1, _\n                    Length:=Len(.Offset(0, -1).Value2)).Font.Name = .Offset(0, -1).Font.Name\n    End With\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9xeGD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9xeGD.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 177, "user_id": 1447264, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/160c5037d37bcaed10f39c3b358387a6?s=128&d=identicon&r=PG", "display_name": "fourgood", "link": "https://stackoverflow.com/users/1447264/fourgood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 44678218, "answer_count": 1, "score": 0, "last_activity_date": 1498124364, "creation_date": 1498052244, "last_edit_date": 1498124364, "question_id": 44677764, "link": "https://stackoverflow.com/questions/44677764/combining-two-cells-in-excel-but-keeping-the-font", "title": "Combining two cells in excel but keeping the font", "body": "<p>I am trying to merge two cells into one multiline cell. The first cell consists of an address, the second cell holds a number that gets converted into a barcode by using a special font.</p>\n\n<p>The content of the second cell should keep the font that is assigned to it(barcode font), after merging it with the first cell.</p>\n\n<p>Can anyone point me in the right direction?</p>\n\n<p>UPDATE:</p>\n\n<p>Here is my working solution</p>\n\n<pre><code>Sub barcode()\nDim i As Integer\nWith Worksheets(\"sheet4\")\n    For i = 2 To 19539\n        With .Cells(i, \"J\")\n            .Value = .Offset(0, -2).Value2 &amp; Chr(10) &amp; .Offset(0, -1).Value2\n            .Characters(Start:=Len(.Offset(0, -2).Value2) + 2, _\n                        Length:=Len(.Offset(0, -1).Value2)).Font.Name = .Offset(0, -1).Font.Name\n        End With\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1498052395, "post_id": 44677755, "comment_id": 76339748, "body": "You can use <code>Instr</code> to find the position of the first occurrence of &quot;A10&quot; and then use it again to find the first &quot;space&quot;  after that position."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498052659, "post_id": 44677755, "comment_id": 76339943, "body": "Also, will there ever be a case of a string <code>A100</code>, or <code>A10299A1000</code>?  Can you show an example of the output? From <code>A1038537500</code>, do you want to extract <code>A103853750</code>?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498053305, "post_id": 44677755, "comment_id": 76340391, "body": "I will post an Picture of how i want my Output."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498053866, "post_id": 44677755, "comment_id": 76340806, "body": "@BruceWayne i have posted an Image. if it is not clear, Please let me know"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498054030, "post_id": 44677755, "comment_id": 76340898, "body": "<i>&quot;always starts with A1O and ends with 0. This can be 11 to 13 digits long&quot;</i>... Your example does not conform to this. I&#39;m lost."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498054125, "post_id": 44677755, "comment_id": 76340983, "body": "@A.S.H it was just to clarify that there are charchters only in the begining and not at the end. If it is confusing,then i am sorry, i will post an another one."}, {"owner": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "edited": false, "score": 0, "creation_date": 1498054427, "post_id": 44677755, "comment_id": 76341273, "body": "@Mikz, so <code>0</code> at the end is optional?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "edited": false, "score": 0, "creation_date": 1498054507, "post_id": 44677755, "comment_id": 76341343, "body": "optional in the sense.  it should be considered @Rushikumar"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498054726, "post_id": 44678623, "comment_id": 76341491, "body": "there is an runtime error &quot;invalid procedure call or Argument&quot; in the line      lLastChr = InStr(lFirstChr, Cells(i, 7), &quot; &quot;)"}, {"owner": {"reputation": 1, "user_id": 8142552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc38865fc8e5e70910237baa68ae482?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Reif", "link": "https://stackoverflow.com/users/8142552/m%c3%a1rk-reif"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055380, "post_id": 44678623, "comment_id": 76342044, "body": "Sorry, I edited the code I had &quot;A1O&quot; instead of &quot;A10&quot;, also do you have any data other than the comments in the column?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055662, "post_id": 44678623, "comment_id": 76342289, "body": "Still the error exist. Could you Please comment the Explanation, near the code . It would be easy to understand"}, {"owner": {"reputation": 1, "user_id": 8142552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc38865fc8e5e70910237baa68ae482?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Reif", "link": "https://stackoverflow.com/users/8142552/m%c3%a1rk-reif"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055993, "post_id": 44678623, "comment_id": 76342561, "body": "It seems like Rushikumar&#39;s solution is much more sophisticated, but I realized the problem might be in the lastrow = worksheet(&quot;munka1&quot;.Range(&quot;c&quot; &amp; Rows.Count).End(xlUp).Row which was referencing the sheet I worked on, I changed it to the activesheet."}], "tags": [], "owner": {"reputation": 1, "user_id": 8142552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc38865fc8e5e70910237baa68ae482?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;rk Reif", "link": "https://stackoverflow.com/users/8142552/m%c3%a1rk-reif"}, "is_accepted": false, "score": 0, "last_activity_date": 1498119187, "last_edit_date": 1498119187, "creation_date": 1498054456, "answer_id": 44678623, "question_id": 44677755, "link": "https://stackoverflow.com/questions/44677755/extract-an-alphanumeric-from-sentence/44678623#44678623", "title": "Extract an alphanumeric from sentence", "body": "<p>can you give this a try? I think it should do the job, also you should ammend the code with the column values, I tested it with the comments being in column C, while the code will be written in column D.  </p>\n\n<pre><code>Option Explicit\n\n    Sub FindValue()\n    Dim i As Long\n    Dim lastrow As Long\n    Dim lFirstChr As Long\n    Dim lLastChr As Long\n    Dim CodeName As String\n\n    lastrow = activesheet.Range(\"c\" &amp; Rows.Count).End(xlUp).Row\n    ' gets the last row with data in it\n\n    For i = 1 To lastrow\n    ' shuffles through all cell in data\n\n    lFirstChr = InStr(1, Cells(i, 3), \"A10\") ' gets the coordinate of the first instance of \"A10\"\n\n    If lFirstChr = 0 Then GoTo NextIteration\n\n    lLastChr = InStr(lFirstChr, Cells(i, 3), \" \") ' gets the coordinate of the first instansce of space after \"A10\"\n\n      If lLastChr = 0 Then 'if there is no space after A10 then sets lastchr to the lenght of the string\n\n            lLastChr = Len(Cells(i, 3))\n\n        End If\n\n    CodeName = Mid(Cells(i, 3).Value, lFirstChr, lLastChr - lFirstChr) ' extracts the codename from the string value\n\n    Range(\"d\" &amp; i).Value = CodeName\n\n    Goto NextTteration\n\n\n    NextIteration:\n       Next i\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055033, "post_id": 44678696, "comment_id": 76341751, "body": "@ rushikumar i get an userdefined type not defined error there."}, {"owner": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055562, "post_id": 44678696, "comment_id": 76342205, "body": "@Mikz, updated the code to take into consideration your requirements of 13 characters and I was not matching the pattern... you will still need to tweak that while I try and come up with the correct match"}, {"owner": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055621, "post_id": 44678696, "comment_id": 76342252, "body": "@Mikz, you are missing the reference, most likely... so go to <code>Tools --&gt; References</code> and check the checkbox for <code>Microsoft VBScript Regular Expressions 1.0</code>"}, {"owner": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498055792, "post_id": 44678696, "comment_id": 76342392, "body": "@Mikz, okay... yet another update to the code... simply changed <code>Like &quot;A10&quot;</code> to <code>Like &quot;A10*?#&quot;</code> That should do it!"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498056220, "post_id": 44678696, "comment_id": 76342778, "body": "I added the reference, and the code is running. But  i dont &#180;find any result. It is just running without Errors. also, i want to print the value in another column if it is found in comment."}, {"owner": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498056584, "post_id": 44678696, "comment_id": 76343081, "body": "@Mikz, are you sure your data is in G column? The code runs just fine on my end... the only thing it is missing is extracting that value... which I am in the process of updating the code"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498056699, "post_id": 44678696, "comment_id": 76343180, "body": "Ya ,I am sure that the data is in column G."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "edited": false, "score": 0, "creation_date": 1498056711, "post_id": 44678696, "comment_id": 76343189, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147285/discussion-between-mikz-and-rushikumar\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1632, "user_id": 7019742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59d51b29b3a38aee844d4bcf4155709?s=128&d=identicon&r=PG&f=1", "display_name": "Rushikumar", "link": "https://stackoverflow.com/users/7019742/rushikumar"}, "is_accepted": true, "score": 1, "last_activity_date": 1498058960, "last_edit_date": 1498058960, "creation_date": 1498054637, "answer_id": 44678696, "question_id": 44677755, "link": "https://stackoverflow.com/questions/44677755/extract-an-alphanumeric-from-sentence/44678696#44678696", "title": "Extract an alphanumeric from sentence", "body": "<p>Why not give something like the following a try?</p>\n\n<pre><code>Sub findMatches()\n\n    Dim strLength As Integer\n    Dim i As Long\n\n    For i = 1 To Rows.Count\n\n        Dim AllWords As Variant\n        AllWords = Split(Cells(i, 7).Value, \" \")\n\n        For Each Item In AllWords\n\n\n            strLength = Len(Item)\n            If strLength &gt; 0 And strLength &lt;= 13 And Item Like \"A10*?#\" Then\n                Cells(i, 8) = Item\n            End If\n\n        Next\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>Test Cases:</strong></p>\n\n<ol>\n<li>I am apple and my batch number is: A10545440 so incase you needed to know    </li>\n</ol>\n\n<p><strong>Result:</strong> A10545440</p>\n\n<ol start=\"2\">\n<li>Some random comment\u2026 A20548650   </li>\n</ol>\n\n<p><strong>Result:</strong> <em>NO RESULT</em></p>\n\n<ol start=\"3\">\n<li>A101234567891 is an awesome alphanumeric combo   </li>\n</ol>\n\n<p><strong>Result:</strong> A101234567891</p>\n\n<ol start=\"4\">\n<li>Another random comment\u2026 A10555   </li>\n</ol>\n\n<p><strong>Result:</strong> A10555</p>\n\n<p>Notice: The above example covers cases where the alphanumeric combo, starting with <code>A10</code> is either:</p>\n\n<ul>\n<li>In the middle of a sentence, or</li>\n<li>Beginning of a sentence, or</li>\n<li>At the end of a sentence</li>\n</ul>\n\n<p>Also note: right now it is set to go through ALL the rows... so if you want to limit that, change the <code>Rows.Count</code> in the <code>For</code> statement to whatever your set limit is.</p>\n\n<p><strong>EDIT:</strong>\nIn the above code, I am explicitly asking it to look in column G</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1498055995, "creation_date": 1498055995, "answer_id": 44679217, "question_id": 44677755, "link": "https://stackoverflow.com/questions/44677755/extract-an-alphanumeric-from-sentence/44679217#44679217", "title": "Extract an alphanumeric from sentence", "body": "<p>You may try something like this...</p>\n\n<p>Place the following User Defined Function on a Standard Module and then use it on the sheet like</p>\n\n<pre><code>=GetAlphaNumericCode(A1)\n</code></pre>\n\n<p><strong>UDF:</strong></p>\n\n<pre><code>Function GetAlphaNumericCode(rng As Range)\nDim Num As Long\nDim RE As Object, Matches As Object\nSet RE = CreateObject(\"VBScript.RegExp\")\nWith RE\n   .Global = False\n   .Pattern = \"AI\\d{9,}0\"\nEnd With\nIf RE.Test(rng.Value) Then\n   Set Matches = RE.Execute(rng.Value)\n   GetAlphaNumericCode = Matches(0)\nElse\n   GetAlphaNumericCode = \"-\"\nEnd If\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/10SC6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/10SC6.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 44678696, "answer_count": 3, "score": 1, "last_activity_date": 1498119187, "creation_date": 1498052228, "last_edit_date": 1498054469, "question_id": 44677755, "link": "https://stackoverflow.com/questions/44677755/extract-an-alphanumeric-from-sentence", "title": "Extract an alphanumeric from sentence", "body": "<p>I would like to have an VBA to extract an alphanumeric value from a column G which is a sentence. </p>\n\n<p>This sentence is generally a comment. So it includes characters and numbers.  </p>\n\n<p>The value always starts with <code>AI0</code> and ends with <code>0</code>. This can be 11 to 13 digits long. Sometimes the number is mentioned in the comment as <code>AI038537500</code>, also sometimes as <code>AI038593790000</code>. </p>\n\n<p>I have researched through almost all the websites, but have not found any case like this. I know about the formulas, <code>left</code>, <code>right</code>, <code>mid</code> but in my case, it doesn't apply. </p>\n\n<p><a href=\"https://i.stack.imgur.com/vvIGv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vvIGv.png\" alt=\"If you notice, here i have in comment section the Id with AI0 and Ends with 0. I want to extract this ID to result column.  \"></a></p>\n\n<p>Any lead would be appreciable. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1498052172, "post_id": 44677447, "comment_id": 76339575, "body": "<code>application.rank</code> or/ <code>worksheetfunction.rank</code> or even a countif should do this."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1498052416, "post_id": 44677447, "comment_id": 76339769, "body": "What&#39;s the rank of the empty rows? 0, 7?  The Rank function would look something like <code>=RANK(A2,$A$2:$A$12)</code> - this will give #N/A errors on the blank rows though."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "edited": false, "score": 0, "creation_date": 1498052690, "post_id": 44677894, "comment_id": 76339970, "body": "Unfortunately, I do in fact need it in VBA due to the concept i&#39;m attempting. Thankfully, I did find the answer, and added as an answer"}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 0, "last_activity_date": 1498052567, "creation_date": 1498052567, "answer_id": 44677894, "question_id": 44677447, "link": "https://stackoverflow.com/questions/44677447/how-to-allocate-order-to-cells-in-excel/44677894#44677894", "title": "How to allocate order to cells in excel", "body": "<p>You don't need VBA to do this.  Assuming your values are in <code>A2:A10</code>, placing this formula in <code>B2</code> and filling down will give you the rank:</p>\n\n<pre><code>=RANK.EQ(A2,$A$2:$A$10)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1498052740, "creation_date": 1498052740, "answer_id": 44677952, "question_id": 44677447, "link": "https://stackoverflow.com/questions/44677447/how-to-allocate-order-to-cells-in-excel/44677952#44677952", "title": "How to allocate order to cells in excel", "body": "<p>With a bit more useful digging (thank you all for suggesting Rank, as this function was unknown to me), i've managed to come up with the following, which resolves my issue:</p>\n\n<pre><code>Sub RankBusinessValue()\n\n    Dim DataSum As Worksheet\n    Set DataSum = ActiveWorkbook.Sheets(\"Summary\")\n\n    Dim i As Long\n    Dim j As Long\n\n    i = WorksheetFunction.CountIfs(DataSum.Range(\"B:B\"), \"&gt;0\")\n    For j = 6 To i + 6\n        If DataSum.Cells(j, \"H\").Value &gt; 0 Then\n            Range(\"I\" &amp; j).Value = WorksheetFunction.Rank(DataSum.Range(\"H\" &amp; j), DataSum.Range(\"H6\" &amp; \":H\" &amp; i + 6), 0)\n        End If\n    Next j\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1498062942, "creation_date": 1498062942, "answer_id": 44681686, "question_id": 44677447, "link": "https://stackoverflow.com/questions/44677447/how-to-allocate-order-to-cells-in-excel/44681686#44681686", "title": "How to allocate order to cells in excel", "body": "<p>You can <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/application-evaluate-method-excel\" rel=\"nofollow noreferrer\">Evaluate</a> them all at once (<code>Summary!</code> is not needed if used in the VBAProject Sheet Object):</p>\n\n<pre><code>Sub RankBusinessValue()\n    [Summary!i6:i999] = [if(Summary!j6:j999, Rank(Summary!j6:j999, Summary!j6:j999), \"\")]\nEnd Sub\n</code></pre>\n\n<p>or to limit the range to the last row:</p>\n\n<pre><code>Dim ws As Worksheet, r As Long\nSet ws = Sheets(\"Summary\")\nr = ws.Cells(ws.Rows.Count, \"J\").End(xlUp).Row        ' last non-empty row in column J\n\nws.Range(\"i6:i\" &amp; r) = ws.Evaluate(Replace(\"if(j6:j9, Rank(j6:j9, j6:j9), \"\"\"\")\", 9, r))\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 2531448, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/db646201976f8a6c7bda45ede27473ab?s=128&d=identicon&r=PG", "display_name": "Jay C", "link": "https://stackoverflow.com/users/2531448/jay-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1498062942, "creation_date": 1498051424, "last_edit_date": 1498052787, "question_id": 44677447, "link": "https://stackoverflow.com/questions/44677447/how-to-allocate-order-to-cells-in-excel", "title": "How to allocate order to cells in excel", "body": "<p>I have a macro-enabled workbook i've been working on for some time, with the purpose of pulling down TFS items from a server, allocating a business value, then re-ordering the backlog based on what gives the most business value. I've done fine until now, but i've hit a blocker.</p>\n\n<p>I'm trying to allocate a sort order to the adjacent cell for the business value, ordering from highest to lowest. I.e., if the Business Value in that column is highest, the value next to it will be \"1\", and so forth. An example extract of this is below:</p>\n\n<pre><code>BusinessValue (\u00a3)\n10\n17280\n384.6153846\n0.173611111\n\n\n\n\n\n8640\n3846.153846\n</code></pre>\n\n<p>From the above, I'd expect the value of \"17280\" to have an associated rank of \"1\", and the value of \"0.1736\" to have an associated rank of \"6\". It seems a very simple expression, and yet i'm having no luck whatsoever in actually getting VBA to do this. Any help would be extremely appreciated, or just pointers.</p>\n\n<p>Edit: Located the answer thanks to the Rank suggestions</p>\n"}, {"tags": ["vba", "excel", "extract", "yahoo-finance"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1498051424, "post_id": 44677388, "comment_id": 76338913, "body": "<i>Please suggest something what can I do.</i> - You can use IE to choose the quarterly data before writing the elements to your worksheet."}, {"owner": {"reputation": 11, "user_id": 8194409, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LFa17hJgY58/AAAAAAAAAAI/AAAAAAAAABA/satPCWbAvSA/photo.jpg?sz=128", "display_name": "Dream works", "link": "https://stackoverflow.com/users/8194409/dream-works"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498051804, "post_id": 44677388, "comment_id": 76339241, "body": "I did but it is not working always....mostly it is picking up the quarter data"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1498053856, "post_id": 44677388, "comment_id": 76340796, "body": "I thought you wanted it to pick up the quarter data?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498056946, "post_id": 44677388, "comment_id": 76343408, "body": "Assuming this line: <code>doc.getElementsByClassName(&quot;P(0px) M(0px) C($actionBlue) Bd(0px) O(n)&quot;)(2).Click</code> is what clicks the link for quarterly data, place a pause the VBA code for a few seconds to allow the events to catch up. I&#39;ve found I had to do this often when automating IE with VBA."}, {"owner": {"reputation": 11, "user_id": 8194409, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LFa17hJgY58/AAAAAAAAAAI/AAAAAAAAABA/satPCWbAvSA/photo.jpg?sz=128", "display_name": "Dream works", "link": "https://stackoverflow.com/users/8194409/dream-works"}, "edited": false, "score": 0, "creation_date": 1498057917, "post_id": 44677388, "comment_id": 76344225, "body": "I have already put a pause can you please check by running it yourself here are the tickers for url III.L , ABF.L,  ADM.L"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498081809, "creation_date": 1498081809, "answer_id": 44686831, "question_id": 44677388, "link": "https://stackoverflow.com/questions/44677388/extract-data-from-yahoo-finance-using-excel-vba/44686831#44686831", "title": "Extract data from yahoo finance using Excel VBA", "body": "<p>This should be a good start for you to get going.</p>\n\n<pre><code>Sub DownloadData()\n\nSet ie = CreateObject(\"InternetExplorer.application\")\n\n\nWith ie\n    .Visible = True\n    .navigate \"https://finance.yahoo.com/quote/ADM.L/balance-sheet?p=ADM.L\"\n\n' Wait for the page to fully load; you can't do anything if the page is not fully loaded\nDo While .Busy Or _\n    .readyState &lt;&gt; 4\n    DoEvents\nLoop\n\n\nSet e = ie.Document.GetElementsByClassName(\"Fz(s) Fw(500) D(ib) Pend(15px) H(18px) C($finDarkLink):h Mend(15px)\")(1)\ne.Click\n\n    ' Wait for the page to fully load; you can't do anything if the page is not fully loaded\n    Do While .Busy Or _\n        .readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Basically, 'Annual' is the default and you have to click the 'Quarterly' link, to get the quarterly data displayed.  I believe yahoo used to have 2 different URLs for Annual and Quarterly.  Now, apparently, they give you 2 links to click to toggle back and forth between the 2 frequencies of financial statements.  </p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 7023632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e524dc1322d404b13ab1fdcf0fe0383?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertLau14100", "link": "https://stackoverflow.com/users/7023632/albertlau14100"}, "is_accepted": false, "score": 0, "last_activity_date": 1505234473, "creation_date": 1505234473, "answer_id": 46181673, "question_id": 44677388, "link": "https://stackoverflow.com/questions/44677388/extract-data-from-yahoo-finance-using-excel-vba/46181673#46181673", "title": "Extract data from yahoo finance using Excel VBA", "body": "<p>Do find below on the code fix.  Do take note that Yahoo has updated the classname i.e. from \"P(0px) M(0px) C($actionBlue) Bd(0px) O(n)\" ==> \"P(0px) M(0px) C($c-fuji-blue-1-b) Bd(0px) O(n)\". </p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\n    Dim ie As Object\n    Set Rng = Range(\"A2:A50\")\n    Set row = Range(Rng.Offset(1, 0), Rng.Offset(1, 0).End(xlDown))\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n        .Visible = True\n        For Each row In Rng\n            .navigate \"https://finance.yahoo.com/quote/\" &amp; Range(\"A\" &amp; row.row).Value &amp; \"/balance-sheet?p=\" &amp; Range(\"A\" &amp; row.row).Value\n\n            While ie.readyState &lt;&gt; 4\n            Wend\n\n            Do While ie.Busy: DoEvents: Loop\n\n            Dim doc As HTMLDocument\n            Set doc = ie.document\n\n            Set element = doc.getElementsByClassName(\"P(0px) M(0px) C($c-fuji-blue-1-b) Bd(0px) O(n)\")(2)\n            element.Click\n\n            Do While ie.Busy: DoEvents: Loop\n\n            Range(\"D\" &amp; row.row).Value = doc.getElementsByClassName(\"Fw(b) Fz(s) Ta(end)\")(4).innerText\n            Range(\"E\" &amp; row.row).Value = doc.getElementsByClassName(\"Fw(b) Fz(s) Ta(end)\")(12).innerText\n            Range(\"F\" &amp; row.row).Value = doc.getElementsByClassName(\"C($gray) Ta(end)\")(0).innerText\n        Next row\n    End With\n    ie.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8947930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/324700f35d2a5dd7164cdee66322b7c6?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/8947930/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1510781366, "creation_date": 1510781366, "answer_id": 47317566, "question_id": 44677388, "link": "https://stackoverflow.com/questions/44677388/extract-data-from-yahoo-finance-using-excel-vba/47317566#47317566", "title": "Extract data from yahoo finance using Excel VBA", "body": "<p>It is not possible to extract Quarterly data from Yahoo using VBA.\nAnnual data can be extracted, but not quarterly.</p>\n"}], "owner": {"reputation": 11, "user_id": 8194409, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LFa17hJgY58/AAAAAAAAAAI/AAAAAAAAABA/satPCWbAvSA/photo.jpg?sz=128", "display_name": "Dream works", "link": "https://stackoverflow.com/users/8194409/dream-works"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1734, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1510781366, "creation_date": 1498051287, "question_id": 44677388, "link": "https://stackoverflow.com/questions/44677388/extract-data-from-yahoo-finance-using-excel-vba", "title": "Extract data from yahoo finance using Excel VBA", "body": "<p>Hi I need help with this code I'm trying to extract data from this page <a href=\"https://finance.yahoo.com/quote/ADM.L/balance-sheet?p=ADM.L\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/ADM.L/balance-sheet?p=ADM.L</a> ,\nbut the problem is page is by default set to annual but I need quarterly values of total assets and total liabilities.</p>\n\n<p>This code runs but most of the time it is picking annual values. Please suggest something what can I do.</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n'\nDim ie As Object\nSet Rng = Range(\"A2:A50\")\nSet Row = Range(Rng.Offset(1, 0), Rng.Offset(1, 0).End(xlDown))\nSet ie = CreateObject(\"InternetExplorer.Application\")\nWith ie\n'.Visible = False\nFor Each Row In Rng\n.navigate \"https://finance.yahoo.com/quote/\" &amp; Range(\"A\" &amp; Row.Row).Value &amp; \"/balance-sheet?p=\" &amp; Range(\"A\" &amp; Row.Row).Value\n'Application.Wait (Now + TimeValue(\"0:00:02\"))\nWhile ie.readyState &lt;&gt; 4\nWend\n\nDo While ie.Busy: DoEvents: Loop\n\nDim doc As HTMLDocument\nSet doc = ie.document\n\ndoc.getElementsByClassName(\"P(0px) M(0px) C($actionBlue) Bd(0px) O(n)\")(2).Click\n\nDo While ie.Busy: DoEvents: Loop\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\nRange(\"D\" &amp; Row.Row).Value = doc.getElementsByClassName(\"Fw(b) Fz(s) Ta(end)\")(4).innerText\nRange(\"E\" &amp; Row.Row).Value = doc.getElementsByClassName(\"Fw(b) Fz(s) Ta(end)\")(12).innerText\nRange(\"F\" &amp; Row.Row).Value = doc.getElementsByClassName(\"C($gray) Ta(end)\")(0).innerText\n\n\nNext Row\nEnd With\nie.Quit\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498051936, "post_id": 44677332, "comment_id": 76339368, "body": "You say the Url is in column B but in your code you get it from column F and also get the row height from column J... ?"}, {"owner": {"reputation": 720, "user_id": 4589466, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10206525713890034/picture?type=large", "display_name": "FabioEnne", "link": "https://stackoverflow.com/users/4589466/fabioenne"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498052162, "post_id": 44677332, "comment_id": 76339565, "body": "@RobinMackenzie Yeah sorry..it was just for easy writing here.. F=B and J=C.. I&#39;m sorry"}, {"owner": {"reputation": 720, "user_id": 4589466, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10206525713890034/picture?type=large", "display_name": "FabioEnne", "link": "https://stackoverflow.com/users/4589466/fabioenne"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498052269, "post_id": 44677332, "comment_id": 76339662, "body": "@RobinMackenzie edited, thanks for noticed that"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1498052797, "post_id": 44677332, "comment_id": 76340048, "body": "I tested your code and it works, the images are positionned on their corresponding row and not on top of each other like you said. So I dont understand what the problem is"}], "owner": {"reputation": 720, "user_id": 4589466, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10206525713890034/picture?type=large", "display_name": "FabioEnne", "link": "https://stackoverflow.com/users/4589466/fabioenne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1087, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498052222, "creation_date": 1498051169, "last_edit_date": 1498052222, "question_id": 44677332, "link": "https://stackoverflow.com/questions/44677332/excel-vba-how-to-insert-pictures-from-urls", "title": "Excel VBA: How to insert pictures from URLs?", "body": "<p>I have a worksheet structured in this way:</p>\n\n<pre><code>A    |B   |C\n-------------\nItem1|Url |\nItem2|Url |\nItem3|Url |\n</code></pre>\n\n<p>what I need to achieve is to read each URLs and get the image into every cell in the C column. My code right now is the follow:</p>\n\n<pre><code>Sub sg()\nDim i As Integer\nDim urlImg As String\nDim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Sheet1\")\nDim rowCount As Long\nrowCount = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\nMsgBox (rowCount)\n\n\nFor i = 2 To rowCount\n    urlImg = Cells(i, 3).Value\n    Cells(i, 3).RowHeight = Range(\"b\" &amp; i).offset(rowOffset:=0, columnOffset:=0).Top + 5\n    alto = Range(\"b\" &amp; i).offset(rowOffset:=0, columnOffset:=0).Top + 5\n    sinistra = Range(\"b\" &amp; i).offset(rowOffset:=0, columnOffset:=0).Left + 5\n    ridimensionamentoAltezza = Range(\"b\" &amp; i).offset(rowOffset:=0, columnOffset:=0).Height - 10\n    ridimensionamentoLarghezza = Range(\"b\" &amp; i).offset(rowOffset:=0, columnOffset:=0).Width - 10\n\n\n    With ActiveSheet.Pictures.Insert(urlImg)\n        .Top = alto\n        .Left = sinistra\n        .Height = ridimensionamentoAltezza\n        .Width = ridimensionamentoLarghezza\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>And so far is working, I can get the images but of course right now is putting all the pictures on top of each others... I can't find a way to place every images one after anoter... any help?</p>\n"}, {"tags": ["vba", "loops", "date", "rows"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1498051291, "post_id": 44677319, "comment_id": 76338806, "body": "what is it doing that it shouldn&#39;t? <code>Not Working</code> is not descriptive enough.  Also try looping backwards: <code>For i = LastRow to 2 Step -1</code>"}, {"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1498053889, "post_id": 44677319, "comment_id": 76340820, "body": "Not working means the rows with date prior than today were not deleted."}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1498051855, "post_id": 44677463, "comment_id": 76339292, "body": "you also may want to convert the cell to an actual date value...   <code>CVDate(Cells(i, &quot;C&quot;).Value) &lt; Date</code>"}, {"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1498053860, "post_id": 44677463, "comment_id": 76340801, "body": "Thanks for your answer braX. I&#39;ve just put your code and it works. But it&#39;s extremely slow when computing (I have 11 000 rows, maybe why, but strange because faster for bigger file but for other formulas (not if)). I didn&#39;t put the convert code, since the format is date (right click on Excel). Will the conversion make it faster? I didn&#39;t get where to set a breakpoint : in the file or in the code ? Thanks :)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1498054445, "post_id": 44677463, "comment_id": 76341290, "body": "You can disable screen updates while it processes.  <code>Application.ScreenUpdating = False</code>  and then turn it back on when you are done."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1498051452, "creation_date": 1498051452, "answer_id": 44677463, "question_id": 44677319, "link": "https://stackoverflow.com/questions/44677319/removing-rows-when-date-prior-today/44677463#44677463", "title": "Removing rows when date prior today -", "body": "<p>You will want to step backwards when deleting rows and verify that it is actually a date  in the cell. To see what it's doing, set a breakpoint on the first line and use F8 to step through it. Also verify the value of LastRow is getting set to the correct value.</p>\n\n<pre><code>For i = LastRow To 2 Step -1\n    If IsDate(Cells(i, \"C\").Value) then\n        If Cells(i, \"C\").Value &lt; Date Then Rows(i).EntireRow.Delete\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1498054100, "post_id": 44677678, "comment_id": 76340958, "body": "Thanks for your answer! Works really great and fast :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1498052035, "creation_date": 1498052035, "answer_id": 44677678, "question_id": 44677319, "link": "https://stackoverflow.com/questions/44677319/removing-rows-when-date-prior-today/44677678#44677678", "title": "Removing rows when date prior today -", "body": "<p>Use the auto-filter capabilities of Excel in your favor. Filter the range by your criteria to delete the matching rows:</p>\n\n<pre><code>  With Range(\"C1:C\" &amp; lastrow)\n    .AutoFilter 1, \"&lt;\" &amp; CLng(Date)\n    .Offset(1).EntireRow.Delete\n    .AutoFilter\n  End With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498052035, "creation_date": 1498051157, "last_edit_date": 1498051197, "question_id": 44677319, "link": "https://stackoverflow.com/questions/44677319/removing-rows-when-date-prior-today", "title": "Removing rows when date prior today -", "body": "<p>I'm struggling with the following: I want to delete rows for which date (column C) is prior than today. My code should work (according to the web) but it doesn't and moreover, it's super slow.. Here is a part of it:</p>\n\n<pre><code>For i = 2 To LastRow     \n    If Cells(i, \"C\").Value &lt; Date Then Rows(i).EntireRow.Delete    \nNext i\n</code></pre>\n\n<p>Instead of putting \"C\", I could put 3, but doesn't change anything. I've tried to add the End If (before the next i), but not necessary apparently. Maybe the Date is not the right format.. </p>\n\n<p>What's wrong with this code ? </p>\n\n<p>Great thanks for your help :)  </p>\n"}, {"tags": ["vba", "transpose"], "comments": [{"owner": {"reputation": 107, "user_id": 7178871, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d233f8b1f29f66572ce0b38a5c0bf388?s=128&d=identicon&r=PG&f=1", "display_name": "AdMac", "link": "https://stackoverflow.com/users/7178871/admac"}, "edited": false, "score": 0, "creation_date": 1498052149, "post_id": 44677294, "comment_id": 76339552, "body": "I&#39;m thinking of maybe declaring the original data range as a range, and then transposing that range in VBA without pasting it, and then declaring the transposed range as the pivot cache."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1498054159, "post_id": 44677294, "comment_id": 76341019, "body": "maybe create pivot cache from a recordset <a href=\"https://www.pcreview.co.uk/threads/create-a-pivottable-from-a-vba-array-help.3908627/\" rel=\"nofollow noreferrer\">pcreview.co.uk/threads/&hellip;</a>"}], "owner": {"reputation": 107, "user_id": 7178871, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d233f8b1f29f66572ce0b38a5c0bf388?s=128&d=identicon&r=PG&f=1", "display_name": "AdMac", "link": "https://stackoverflow.com/users/7178871/admac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498055207, "creation_date": 1498051088, "last_edit_date": 1498055207, "question_id": 44677294, "link": "https://stackoverflow.com/questions/44677294/excel-vba-macro-to-transpose-a-range-then-turn-it-into-a-pivot-table", "title": "Excel VBA - Macro to transpose a range, then turn it into a pivot table", "body": "<p>I'm attempting to take a range of data, transpose it and then turn it into a pivot table.</p>\n\n<p>I've written the code to grab the data, copy/paste/transpose it.  I would then assume I turn that selection into a Pivot cache.</p>\n\n<p>I'm wondering though, if there's a more efficient way to take the original selection, transpose it directly into a pivot cache in order to create the pivot table.  In a sense, skipping over the paste.</p>\n\n<p>In other words, can I define the Pivot Cache as the range, transposed, without actually copying and pasting it? I'm really just trying to get a sense of whether this is possible or not, or if I should just proceed with the copy, pastespecial transpose = true, and then turn that result into a pivot table.  This option, however, seems a bit long winded, so I'm wondering if there's a more efficient direction to go in.</p>\n\n<pre><code>n = ActiveWorkbook.Sheets.Count\nActiveSheet.Cells(12, 1).Select\nSelection.Resize(38, n + 3).Copy\n\n\nActiveWorkbook.Sheets.Add Before:=Worksheets(1)\nActiveSheet.Name = \"PIVOT\"\nWorksheets(\"Pivot\").Range(\"A1\").PasteSpecial transpose:=True\n</code></pre>\n\n<p>My new approach is to declare the original data as a range, then declare that range as a transposed range, and then attempt to declare that transposed range as the pivot cache.</p>\n\n<pre><code>Dim Trange As Range\nSet Trange = Range(Sheets(\"Control Panel\").Cells(12, 1), Sheets(\"control panel\").Cells(38, n + 3))\n\nRange(Sheets(\"Pivot\").Cells(1, 1), Sheets(\"Pivot\").Cells(n + 3, 38)).Value = Application.transpose(Trange)\n</code></pre>\n\n<p>With this last line of code, I've gotten the data to appear on the Pivot worksheet, transposed.</p>\n\n<p>Ultimately, however, I'm trying to put this data in transposed form, straight into a pivot cache, without having to have it appear on the worksheet.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1498049607, "creation_date": 1498049607, "answer_id": 44676726, "question_id": 44676630, "link": "https://stackoverflow.com/questions/44676630/worksheet-selectionchange-only-if-cell-value-is-1/44676726#44676726", "title": "Worksheet_SelectionChange Only If Cell Value is &gt;= 1", "body": "<p>Check the <code>Value</code> property - the <code>Count</code> property of the <code>Range</code> will tell you how many cells are in the <code>Range</code> - not the <code>Value</code>:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Target.Count &gt; 1 Then Exit Sub\n    If Target.Value = 0 Then Exit Sub '&lt;-- new line to check cell value\n\n    Debug.Print Range(\"A\" &amp; Target.Row) \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 44676726, "answer_count": 1, "score": 1, "last_activity_date": 1498049607, "creation_date": 1498049350, "question_id": 44676630, "link": "https://stackoverflow.com/questions/44676630/worksheet-selectionchange-only-if-cell-value-is-1", "title": "Worksheet_SelectionChange Only If Cell Value is &gt;= 1", "body": "<p>I have been using this syntax to fire off an event to create a worksheet when certain cells are clicked, but now my issue is that a blank worksheet is created bc the cell has few 0 values.  How can I not fire this event if the cell value is 0?  I thought using the Target.Count > 1 would handle this, but it does not.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Count &gt; 1 Then Exit Sub\n    Debug.Print Range(\"A\" &amp; Target.Row) \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498050895, "post_id": 44676620, "comment_id": 76338485, "body": "You are looking for the next empty cell, every time the value of your textbox changes. that means if you are writing the value with every change, the next empty cell will shift one to the left. Also dont use <code>.Select</code>just use <code>Range(&quot;D&quot; &amp; NextFree).Value = Me.TextBox3.Value</code>"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498114597, "post_id": 44676620, "comment_id": 76367702, "body": "is there any other way?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498115485, "post_id": 44676620, "comment_id": 76368232, "body": "Ofc. Depends on what you want to do."}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1498116408, "post_id": 44676620, "comment_id": 76368790, "body": "got it.    Private Sub TextBox3_Change()NextFree = Range(&quot;d6:d&quot; &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row ActiveCell.Offset(0, 1) = Me.TextBox3.Value End Sub"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1500273554, "post_id": 44676620, "comment_id": 77244105, "body": "thanks working fine now"}], "owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498091338, "creation_date": 1498049317, "last_edit_date": 1531164843, "question_id": 44676620, "link": "https://stackoverflow.com/questions/44676620/textbox3-update-to-active-cell", "title": "Textbox3 update to active cell", "body": "<p>I have the following code for textbox3:</p>\n\n<pre><code>Private Sub TextBox3_Change()\nNextFree = Range(\"d6:d\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nRange(\"d\" &amp; NextFree).Select\nActiveCell.Value = Me.TextBox3.Value\n</code></pre>\n\n<p>The output is something like this:<br>\nI cell d7<br>\nIa cell d8<br>\nIam cell d9<br>\nIama cell d10<br>\n where the same should be in cell d7, it should the output as \"Iama\". Any Idea as were I am going wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 2, "creation_date": 1498049261, "post_id": 44676543, "comment_id": 76337117, "body": "can you provide your code?"}, {"owner": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1498051276, "post_id": 44676543, "comment_id": 76338788, "body": "Thank you for your comment Jeeped.  I was actually too embarrassed to show my code because it was a mangled mess that I couldn&#39;t make head nor tail of myself.  It has now been posted below."}], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1498050355, "creation_date": 1498050355, "answer_id": 44677031, "question_id": 44676543, "link": "https://stackoverflow.com/questions/44676543/copy-column-and-paste-in-the-same-worksheet-a-variable-number-of-times/44677031#44677031", "title": "Copy Column and Paste in the same worksheet a variable number of times", "body": "<p>This should work:</p>\n\n<pre><code>Sub CopyPaste()\nDim sht As Worksheet\nSet sht = Worksheets(\"Sheet1\")\nWith sht\n    .Columns(3).Copy .Columns(4)\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "edited": false, "score": 0, "creation_date": 1498052129, "post_id": 44677592, "comment_id": 76339536, "body": "1.Thanks Jeeped, I didn&#39;t know that For...Next can disrupt built-in iteration and progression.  When I repeat the code elsewhere in the workbook, I&#39;ll keep that in mind.  2.  I was using xLToLeft to find the last empty column after Column C once the process began.  Your code will negate its use.  3.  Thanks for the code sample, I will paste it into the Sub and let you know hat happens.  Thanks again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "edited": false, "score": 0, "creation_date": 1498052352, "post_id": 44677592, "comment_id": 76339716, "body": "Without <code>i = i + 1</code> the For ... Next iterates <code>i</code> as 0, 1, 2, 3. With it, <code>i</code> is used as 1, 3 only. If you need to jump by 2 (e.g. 1, 3) then use <code>For i = 1 To AddCol Step 2</code>."}, {"owner": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "edited": false, "score": 0, "creation_date": 1498053165, "post_id": 44677592, "comment_id": 76340300, "body": "Hi Jeeped.  Will using Excel 2010 make any difference to the code as the whole line is being highlighted and an Error 1004 is coming up?  I will add that rangeCopy = sht02AnalysisSummary.Range(&quot;C:C&quot;) and my original code referred to cell C3 because there is nothing in Cells C1 &amp; C2.  If that helps"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "edited": false, "score": 0, "creation_date": 1498053678, "post_id": 44677592, "comment_id": 76340666, "body": "I&#39;ve adjust for the correct source of the copy above. However, you might just want to fill right rather than copy."}, {"owner": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "edited": false, "score": 0, "creation_date": 1498056768, "post_id": 44677592, "comment_id": 76343241, "body": "Thanks Jeeped, that certainly adds columns.  I will need to find a way to stop it from overwriting Column C which it&#39;s doing at the moment.  Also, it&#39;s not copying the formatting of the whole of Column C (Cells C1 &amp; C2 and the Column width are not being copied). I&#39;ll look up FillRight up as I&#39;ve not used it before."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1498053658, "last_edit_date": 1498053658, "creation_date": 1498051799, "answer_id": 44677592, "question_id": 44676543, "link": "https://stackoverflow.com/questions/44676543/copy-column-and-paste-in-the-same-worksheet-a-variable-number-of-times/44677592#44677592", "title": "Copy Column and Paste in the same worksheet a variable number of times", "body": "<ol>\n<li><p>Do not manually code your iteration var in a For ... Next; you will be disrupting the built-in iteration and progression.</p></li>\n<li><p>The <code>xlToLeft</code> leaves me confused about the destination (or is it source...?). Perhaps that should be <code>xlToRight</code> or your should start further right before starting to look to the left ?</p></li>\n<li><p>you should be able to paste a single column into three consecutive destination columns at once.</p>\n\n<pre><code>AddCol = 3\nwith sht02AnalysisSummary\n    set rangeCopy = .range(.cells(3, \"C\"), .cells(.rows.count, \"C\").end(xlup))\n    rangeCopy.Copy destination:=.Cells(3, .columns.count).End(xlToLeft).resize(rangeCopy.rows.count, AddCol)\nend with\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 8193870, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qaSVa.jpg?s=128&g=1", "display_name": "Maccus", "link": "https://stackoverflow.com/users/8193870/maccus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 44677592, "answer_count": 2, "score": 0, "last_activity_date": 1498053658, "creation_date": 1498049104, "last_edit_date": 1498051284, "question_id": 44676543, "link": "https://stackoverflow.com/questions/44676543/copy-column-and-paste-in-the-same-worksheet-a-variable-number-of-times", "title": "Copy Column and Paste in the same worksheet a variable number of times", "body": "<p>I am going mad trying to do the simplest thing in VBA.</p>\n\n<p>I want to automate the copying of Column C on a worksheet a variable number of times to the adjacent columns D, E, F...etc. of the same worksheet.</p>\n\n<p>Stepping through the code, I have it copying the correct column (\"C:C\") but cannot get it to paste via Paste, Offset or Destination to column D etc. for the variable number of instances.</p>\n\n<p>this is the code I'm using.  Assume all the Dim and Set statements are done as it's a small part of larger Sub.</p>\n\n<pre><code>    sht02AnalysisSummary.Activate\n\n    For i = 0 To AddCol\n        i = i + 1\n        lLastCol = sht02AnalysisSummary.Range(\"C3\").End(xlToLeft).Column\n        rangeCopy.Copy\n        Column.Offset(\"0,lLastCol+i\").Paste\n    Next i\n\n    sht01CoverPage.Activate\n</code></pre>\n\n<p>This sort of works now but with AddCol set at 3, the result is skipping Column D and only repeating the pasting once (into Column E) whereas it should be pasting into D,E &amp; F.  Any pointers will be much appreciated.</p>\n"}, {"tags": ["vba", "excel", "clipboard"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1498055275, "post_id": 44677300, "comment_id": 76341952, "body": "Thanks very much for this! Works perfectly :)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1498052041, "last_edit_date": 1498052041, "creation_date": 1498051102, "answer_id": 44677300, "question_id": 44676357, "link": "https://stackoverflow.com/questions/44676357/copy-multiple-lines-from-object-boxes-to-the-clipboard-as-text-bullet-points-vba/44677300#44677300", "title": "Copy multiple lines from object boxes to the clipboard as text/bullet points VBA", "body": "<p>First of all you need to decide if you need</p>\n\n<ul>\n<li><strong>Option Boxes</strong> (only one box can be selected at once) or</li>\n<li><strong>Check Boxes</strong> (multiple boxes can be selected at once)</li>\n</ul>\n\n<p>to fulfill your requirements.</p>\n\n<hr>\n\n<h3>Option Boxes (only one can be selected at once)</h3>\n\n<p>Each of these 3 option buttons has a unique name to access its value:</p>\n\n<pre><code>Worksheets(\"my-sheet-name\").Shapes(\"Option Button 1\").ControlFormat.Value\n</code></pre>\n\n<p><em>Note: The name of a button may be different from its caption/text.</em></p>\n\n<p>So this value is <code>1</code> if an option button is selected. And you can read the caption/text from that button with:</p>\n\n<pre><code>Worksheets(\"my-sheet-name\").Shapes(\"Option Button 1\").AlternativeText\n</code></pre>\n\n<hr>\n\n<p>So we end up with something like that:</p>\n\n<pre><code>Dim clipb As New DataObject\nDim clipbText As String\n\nDim ws As Worksheet\nSet ws = Worksheets(\"my-sheet-name\")\n\nIf ws.Shapes(\"Option Button 1\").ControlFormat.value = 1 Then\n    clipbText = \"\u2022 \" &amp; ws.Shapes(\"Option Button 1\").AlternativeText\n\nElseIf ws.Shapes(\"Option Button 2\").ControlFormat.value = 1 Then\n    clipbText = \"\u2022 \" &amp; ws.Shapes(\"Option Button 2\").AlternativeText\n\nElseIf ws.Shapes(\"Option Button 3\").ControlFormat.value = 1 Then\n    clipbText = \"\u2022 \" &amp; ws.Shapes(\"Option Button 3\").AlternativeText\n\nEnd If\n\nclipb.SetText clipbText\nclipb.PutInClipboard\n</code></pre>\n\n<p><em>Note that you have to adjust your sheet name and option button names.</em></p>\n\n<hr>\n\n<h3>Check Boxes (multiple can be selected at once)</h3>\n\n<p>If you need to select more than one box at the same time you need check boxes instead of option boxes.</p>\n\n<p>Therefore the code would look a bit different:</p>\n\n<pre><code>Dim clipb As New DataObject\nDim clipbText As String\n\nDim ws As Worksheet\nSet ws = Worksheets(\"my-sheet-name\")\n\nIf ws.Shapes(\"Check Box 1\").ControlFormat.value = 1 Then\n    clipbText = clipbText &amp; \"\u2022 \" &amp; ws.Shapes(\"Check Box 1\").AlternativeText &amp; vbNewLine\nEnd If\n\nIf ws.Shapes(\"Check Box 2\").ControlFormat.value = 1 Then\n    clipbText = clipbText &amp; \"\u2022 \" &amp; ws.Shapes(\"Check Box 2\").AlternativeText &amp; vbNewLine\nEnd If\n\nIf ws.Shapes(\"Check Box 3\").ControlFormat.value = 1 Then\n    clipbText = clipbText &amp; \"\u2022 \" &amp; ws.Shapes(\"Check Box 3\").AlternativeText &amp; vbNewLine\nEnd If\n\nclipb.SetText clipbText\nclipb.PutInClipboard\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 44677300, "answer_count": 1, "score": 0, "last_activity_date": 1498052041, "creation_date": 1498048635, "last_edit_date": 1531164843, "question_id": 44676357, "link": "https://stackoverflow.com/questions/44676357/copy-multiple-lines-from-object-boxes-to-the-clipboard-as-text-bullet-points-vba", "title": "Copy multiple lines from object boxes to the clipboard as text/bullet points VBA", "body": "<p>All, </p>\n\n<p>I have the below code which works successfully when selecting a box it copies the adjacent text to the clip board. (Please see pic);</p>\n\n<pre><code>Sub OptionButton4_Click()\n\nDim clipb As New DataObject\nDim clipc As New DataObject\n\nclipb.SetText \"\" &amp; \"Customer XYZ.\"\nclipb.PutInClipboard\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/O5Aby.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O5Aby.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Consequently Customer XYZ would be copied to the clip board. I would adapt / amend the code so which ever boxes are selected (Could be multiple are copied to the clipboard) </p>\n\n<p>For instance if Customer XYZ &amp; Customer YY was selected it would copy</p>\n\n<ul>\n<li>Customer XYZ</li>\n<li>Customer YY </li>\n</ul>\n\n<p>To the clipboard. Etc.</p>\n\n<p>Any advice on how I could adapt / amend the above code would be much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498046519, "post_id": 44675308, "comment_id": 76335007, "body": "Take a look at this Excel VBA code: <a href=\"https://www.extendoffice.com/documents/excel/2219-excel-list-all-folders-and-subfolders.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>  With this you can list all files or folders on a path, and with that data you can filter wathever you want"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498049762, "post_id": 44675308, "comment_id": 76337526, "body": "For i = 1 To 2 is to be changed  For i = 0 To 1"}, {"owner": {"reputation": 262, "user_id": 2106892, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fKoMQ.jpg?s=128&g=1", "display_name": "cinico", "link": "https://stackoverflow.com/users/2106892/cinico"}, "reply_to_user": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498050493, "post_id": 44675308, "comment_id": 76338172, "body": "@Dy.Lee Thanks. Still doesn&#39;t work. I placed a check after I define Filename, but it&#39;s always blank. Something is wrong when I define the Filename I guess."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498051931, "post_id": 44675308, "comment_id": 76339364, "body": "you missed filepathseperater.  Workbooks.Open Filename:=FolderPath &amp; &quot;\\&quot; Filename, ReadOnly:=True"}, {"owner": {"reputation": 262, "user_id": 2106892, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fKoMQ.jpg?s=128&g=1", "display_name": "cinico", "link": "https://stackoverflow.com/users/2106892/cinico"}, "reply_to_user": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498054834, "post_id": 44675308, "comment_id": 76341560, "body": "@Dy.Lee That was the problem! Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 262, "user_id": 2106892, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fKoMQ.jpg?s=128&g=1", "display_name": "cinico", "link": "https://stackoverflow.com/users/2106892/cinico"}, "edited": false, "score": 0, "creation_date": 1498054911, "post_id": 44677843, "comment_id": 76341628, "body": "As stated in the comments above, the problem was the index (should start at zero) and the missing file path separator &quot;\\&quot;."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1498052434, "creation_date": 1498052434, "answer_id": 44677843, "question_id": 44675308, "link": "https://stackoverflow.com/questions/44675308/merge-a-list-of-excel-files-into-a-new-excel-book/44677843#44677843", "title": "Merge a list of excel files into a new excel book", "body": "<p>The code is wouldb be like this.</p>\n\n<pre><code>Sub MergeWorkbooks()\n    Dim FolderPath As String\n    Dim Filename As String\n    Dim ListFilenames As Variant\n    Dim Sheet As Worksheet\n    Application.ScreenUpdating = False\n    FolderPath = CurDir()\n    ListFilenames = Array(\"*02.08.02.01*.xlsx\", \"*02.08.13.01*.xlsx\")\n    For i = 0 To 1\n        Filename = Dir(FolderPath &amp; \"\\\" &amp; ListFilenames(i))\n        Do While Filename &lt;&gt; \"\"\n            Workbooks.Open Filename:=FolderPath &amp; \"\\\" &amp; Filename, ReadOnly:=True\n            For Each Sheet In ActiveWorkbook.Sheets\n            Sheet.Copy After:=ThisWorkbook.Sheets(1)\n            Next Sheet\n            Workbooks(Filename).Close\n            Filename = Dir()\n        Loop\n    Next i\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498227762, "creation_date": 1498227762, "answer_id": 44723757, "question_id": 44675308, "link": "https://stackoverflow.com/questions/44675308/merge-a-list-of-excel-files-into-a-new-excel-book/44723757#44723757", "title": "Merge a list of excel files into a new excel book", "body": "<p>Use the AddIn from the link below.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n\n<p>That will do what you want.</p>\n"}], "owner": {"reputation": 262, "user_id": 2106892, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fKoMQ.jpg?s=128&g=1", "display_name": "cinico", "link": "https://stackoverflow.com/users/2106892/cinico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 44677843, "answer_count": 2, "score": 0, "last_activity_date": 1498227762, "creation_date": 1498045899, "last_edit_date": 1531161705, "question_id": 44675308, "link": "https://stackoverflow.com/questions/44675308/merge-a-list-of-excel-files-into-a-new-excel-book", "title": "Merge a list of excel files into a new excel book", "body": "<p>I need to create a macro that merges a list of excel files in a directory.\nThe folder contains other files that I don't want to pick. So, I need to specify the list of files (such as, selecting all the files which name contains \"<em>02.08</em>.xlsx\").</p>\n\n<p>This is my first time using VBA, so please take that into consideration.\nI've tried some things, but I think I always get problems regarding the files selection.</p>\n\n<p>Here's what I've tried so far, but not working:</p>\n\n<pre><code>Sub MergeWorkbooks()\nDim FolderPath As String\nDim Filename As String\nDim ListFilenames As Variant\nDim Sheet As Worksheet\nApplication.ScreenUpdating = False\nFolderPath = CurDir()\nListFilenames = Array(\"*02.08.02.01*.xlsx\", \"*02.08.13.01*.xlsx\")\nFor i = 1 To 2\n    Filename = Dir(FolderPath &amp; ListFilenames(i))\n    Workbooks.Open Filename:=FolderPath &amp; Filename, ReadOnly:=True\n    For Each Sheet In ActiveWorkbook.Sheets\n    Sheet.Copy After:=ThisWorkbook.Sheets(1)\n    Next Sheet\n    Workbooks(Filename).Close\n    Filename = Dir()\nNext i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498047568, "post_id": 44675617, "comment_id": 76335788, "body": "Issue rectified. I should add the Statement before with. Now it works fine. :) sorry for the wrong comment update."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498047641, "post_id": 44675617, "comment_id": 76335847, "body": "just one more comment... why all my column lables are not seen  ? i could only seen green and red.. Yellow is missing . how can i overcome _"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498049785, "post_id": 44675617, "comment_id": 76337560, "body": "Problems resolved :) thank you for the Support :) thanks a ton"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1498046681, "creation_date": 1498046681, "answer_id": 44675617, "question_id": 44675293, "link": "https://stackoverflow.com/questions/44675293/vba-object-required-error-while-generating-pivottable/44675617#44675617", "title": "VBA - object required error while generating PivotTable", "body": "<p>There's a space between <code>.AddDataField</code> and <code>PivotFields (\"Colour\"), \"count of colour\", xlCount</code> inside the <code>With pt</code> statement.</p>\n\n<p>change your:</p>\n\n<pre><code>.AddDataField.PivotFields (\"Colour\"), \"count of colour\", xlCount \n</code></pre>\n\n<p>to:</p>\n\n<pre><code>.AddDataField .PivotFields(\"Colour\"), \"Count of Colour\", xlCount\n</code></pre>\n\n<p>without the <code>With</code> statement it's:</p>\n\n<pre><code>pt.AddDataField pt.PivotFields(\"Colour\"), \"Count of Colour\", xlCount\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 44675617, "answer_count": 1, "score": 0, "last_activity_date": 1498046795, "creation_date": 1498045870, "last_edit_date": 1498046795, "question_id": 44675293, "link": "https://stackoverflow.com/questions/44675293/vba-object-required-error-while-generating-pivottable", "title": "VBA - object required error while generating PivotTable", "body": "<p>I am creating a Pivot table in vba. </p>\n\n<p>I am almost sucessfull in creating it. below is my code, </p>\n\n<pre><code>Sub Pivot()\n\nDim ws As Worksheet\nDim pc As PivotCache\nDim pt As pivottable\n\nSet ws = Sheets(\"Cat_Pivot\")\n\nSet pc = ActiveWorkbook.PivotCaches.Create(xlDatabase, \"Preparation Sheet!R1C7:R1048576C8\")\n\nSet pt = pc.CreatePivotTable(ws.range(\"B3\"))    \nWith pt    \n    With .PivotFields(\"Category\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    With .PivotFields(\"Colour\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\n   .AddDataField.PivotFields (\"Colour\"), \"count of colour\", xlCount     \nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I get an object required error, when I add the line </p>\n\n<blockquote>\n  <p>.AddDataField.PivotFields (\"Colour\"), \"count of colour\", xlCount </p>\n</blockquote>\n\n<p>Before adding this line I am able to create a Pivottable. How can i rectify this ? </p>\n\n<p>I went through the available resources,as  far i know, I have declared the variables by dim Statement. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "edited": false, "score": 0, "creation_date": 1498045657, "post_id": 44675020, "comment_id": 76334354, "body": "I cannot believe I missed that. Thank you very much!"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1498045066, "creation_date": 1498045066, "answer_id": 44675020, "question_id": 44674961, "link": "https://stackoverflow.com/questions/44674961/vba-accessing-text-value-error/44675020#44675020", "title": "VBA - Accessing Text Value Error", "body": "<p>You define <code>Index</code> but never set it to a value before you use it.</p>\n\n<p>Add <code>Index = 1</code> before the <code>Do While</code> line</p>\n"}], "owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 44675020, "answer_count": 1, "score": 0, "last_activity_date": 1498045066, "creation_date": 1498044913, "question_id": 44674961, "link": "https://stackoverflow.com/questions/44674961/vba-accessing-text-value-error", "title": "VBA - Accessing Text Value Error", "body": "<p>I have written the following code:</p>\n\n<pre><code>Function Find_Index(Gender As String)\n\n   Dim Index As Long\n\n   Do While Gender = Worksheets(\"Source\").Cells(Index, \"A\").Text\n\n       Index = Index + 1\n\n   Loop\n\n   Find_Index = Index\n\nEnd Function\n</code></pre>\n\n<p>I'm getting the following error:</p>\n\n<p>\"Application-defined or object-defined error\"</p>\n\n<p>Due to the following line in the code:</p>\n\n<pre><code>Do While Gender = Worksheets(\"Source\").Cells(Index, \"A\").Text\n</code></pre>\n\n<p>Any ideas why ?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "edited": false, "score": 0, "creation_date": 1498045191, "post_id": 44674939, "comment_id": 76334021, "body": "Thank you for your answer. This solved my problem! Btw, &quot;Item(2)&quot; should be &quot;Item(1)&quot;"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "edited": false, "score": 0, "creation_date": 1498045370, "post_id": 44674939, "comment_id": 76334143, "body": "No problem. I only used <code>Item(2)</code> because I thought you wanted the first row of values, not the headers :)"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1498044840, "creation_date": 1498044840, "answer_id": 44674939, "question_id": 44674746, "link": "https://stackoverflow.com/questions/44674746/how-to-copy-all-values-in-first-row-of-selection-to-new-sheet-with-vba/44674939#44674939", "title": "How to copy all values in first row of selection to new sheet with vba?", "body": "<p>If it's really necessary to use selection, try this:</p>\n\n<pre><code>' Copy the first row of values (not the header)\nSelection.Rows.Item(2).Copy \n\n' Paste our clipboard content into the newly formed sheet\nvacationSheet.Range(\"A1\").PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 44674939, "answer_count": 1, "score": 0, "last_activity_date": 1498044840, "creation_date": 1498044206, "question_id": 44674746, "link": "https://stackoverflow.com/questions/44674746/how-to-copy-all-values-in-first-row-of-selection-to-new-sheet-with-vba", "title": "How to copy all values in first row of selection to new sheet with vba?", "body": "<p>I would like to copy all values 14-22 (first row values of selection) to a new sheet in vba/Excel. How can I do this?</p>\n\n<pre><code>Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"vacation-results\"\nSet vacationSheet = Sheets(\"vacation-results\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4yvIr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4yvIr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "excel-r1c1-notation", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1498046200, "post_id": 44674716, "comment_id": 76334763, "body": "<a href=\"https://stackoverflow.com/questions/18807505/how-to-enter-a-formula-into-a-cell-using-vba\" title=\"how to enter a formula into a cell using vba\">stackoverflow.com/questions/18807505/&hellip;</a>    and     <a href=\"https://stackoverflow.com/questions/18744537/vba-setting-the-formula-for-a-cell\" title=\"vba setting the formula for a cell\">stackoverflow.com/questions/18744537/&hellip;</a>"}, {"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498048461, "post_id": 44674716, "comment_id": 76336517, "body": "<a href=\"https://stackoverflow.com/questions/18807505/how-to-enter-a-formula-into-a-cell-using-vbaCells(i\" title=\"how to enter a formula into a cell using vbaCells(i\">stackoverflow.com/questions/18807505/&hellip;</a>, 2).Formula = &quot;=Date(&quot;&amp;j1&amp;&quot;;&quot;&amp;j2&amp;&quot;;C[-1])&quot;"}, {"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498048554, "post_id": 44674716, "comment_id": 76336584, "body": "based on <a href=\"https://stackoverflow.com/questions/18807505/how-to-enter-a-formula-into-a-cell-using-vba\" title=\"how to enter a formula into a cell using vba\">stackoverflow.com/questions/18807505/&hellip;</a>, I would write Cells(i, 2).Formula = &quot;=Date(&quot;&amp;j1&amp;&quot;;&quot;&amp;j2&amp;&quot;;C[-1])&quot; but <b>it doesn&#39;t work</b>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498049474, "post_id": 44674716, "comment_id": 76337298, "body": "You need to make it on Excel VBA, so you should create somethink like: Worksheets(&quot;Sheet_NAME&quot;).Range(Cells(i,2)).Formula =  &quot;=DATE(J1;J2;C&quot;&amp; i &amp; &quot;)&quot;  ---- and use a For i=1 to Last_Row  ps.: Syntax: DATE(year,month,day) and the formula will be insert on the line &#39;i&#39; and column B  and the DATE fomula will get data from J1;J2; column C line &#39;i&#39;"}, {"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498050769, "post_id": 44674716, "comment_id": 76338393, "body": "it&#39;s exactly what I did. The compilator just says &quot;compilation error: syntax error&quot; and points to &quot;,&quot;"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498051968, "post_id": 44674716, "comment_id": 76339400, "body": "I added an answer"}, {"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1498052882, "post_id": 44674716, "comment_id": 76340119, "body": "I just forgot the spaces: &quot;&amp;i&amp;&quot; instead &quot;&amp; i &amp; &quot;. thanks a lot"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "edited": false, "score": 0, "creation_date": 1498048201, "post_id": 44675733, "comment_id": 76336288, "body": "That&#39;s as far as i was able to go. The trouble s that i need Date(j1,j2,cells(i-1)) where i is another parameter"}, {"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "edited": false, "score": 0, "creation_date": 1498052902, "post_id": 44675733, "comment_id": 76340132, "body": "i just forgot the spaces"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1498047949, "last_edit_date": 1498047949, "creation_date": 1498046981, "answer_id": 44675733, "question_id": 44674716, "link": "https://stackoverflow.com/questions/44674716/cell-formula-using-a-variable/44675733#44675733", "title": "Cell formula using a variable", "body": "<p>Part of the answer.  Say cell <strong>A1</strong> contains the value <em>2</em>.  Running this:</p>\n\n<pre><code>Sub eddie()\n    Dim i As Long, s As String\n    i = Range(\"A1\").Value\n    s = \"=DATE(20,20,20)\"\n    Cells(i, 2).Formula = s\nEnd Sub\n</code></pre>\n\n<p>will place the formula in cell <strong>B2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/h7nny.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h7nny.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "edited": false, "score": 0, "creation_date": 1498052717, "post_id": 44677229, "comment_id": 76339990, "body": "indeed, i had almost your formula. &lt;br&gt;I just didn&#39;t add any spaces and used &quot;&amp;i&amp;&quot; which made the compilator bug. thanks a lot &lt;br&gt;PS: indeed, cells(i,2) is Bi"}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": true, "score": 1, "last_activity_date": 1526910563, "last_edit_date": 1526910563, "creation_date": 1498050887, "answer_id": 44677229, "question_id": 44674716, "link": "https://stackoverflow.com/questions/44674716/cell-formula-using-a-variable/44677229#44677229", "title": "Cell formula using a variable", "body": "<p>Try this:</p>\n\n<pre><code>Sub date_add()\nDim i As Long\nDim dt As Worksheet\n\n Set dt = ThisWorkbook.Worksheets(\"Date\")\n With dt\n lastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n For i = 1 To lastRow\n     .Cells(i, 2).Formula = \"=DATE(J1,J2,C\" &amp; i &amp; \")\"\n Next i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Where you input Year on J1, Month on J2 and the numbers of dates on column C</p>\n\n<p><a href=\"https://i.stack.imgur.com/OXkZo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OXkZo.png\" alt=\"Like this image\"></a></p>\n"}], "owner": {"reputation": 345, "user_id": 8108428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc03288275fbb5b666bc3f6ed4a399a?s=128&d=identicon&r=PG&f=1", "display_name": "eddie", "link": "https://stackoverflow.com/users/8108428/eddie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 44677229, "answer_count": 2, "score": 1, "last_activity_date": 1526910563, "creation_date": 1498044129, "last_edit_date": 1531161705, "question_id": 44674716, "link": "https://stackoverflow.com/questions/44674716/cell-formula-using-a-variable", "title": "Cell formula using a variable", "body": "<p>I'm using the Excel VBA Editor (I have both Excel 2007 and Excel 2016). I have a variable parameter <code>i</code>, all the others are fixed.\nCould you please say me how I can put a formula in a cell <code>Cells(i, 2)</code>?</p>\n\n<ol>\n<li>using variables from my macro (<code>j1</code>, <code>j2</code>, <code>i1</code>) </li>\n<li>using variables from my worksheet (the cells J1, J2, <code>C[-1]</code>)</li>\n</ol>\n\n<p><code>C[-1]</code> being the cell left of <code>Cells(i, 2)</code> eg. <code>Cells(i, 1)</code>?</p>\n\n<p>Thans a lot,\nEduard</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498045360, "post_id": 44674413, "comment_id": 76334131, "body": "Short answer: avoid using <code>ActiveSheet</code> and <code>UsedRange</code>, they&#39;re both unreliable, especially when combined..."}, {"owner": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498047462, "post_id": 44674413, "comment_id": 76335702, "body": "what is the solution then to find that UsedRange rows and columns?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1498048698, "post_id": 44674413, "comment_id": 76336704, "body": "I can&#39;t claim credit for <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=82\" rel=\"nofollow noreferrer\">this answer</a>, but basically <code>UsedRange</code> is not reliable under all conditions. As an example, when data has been cleared from a range, Excel still counts those cells as &quot;used&quot;. The linked example gives a method to determine the current used range."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1498049569, "last_edit_date": 1498049569, "creation_date": 1498048972, "answer_id": 44676489, "question_id": 44674413, "link": "https://stackoverflow.com/questions/44674413/activesheet-usedrange-rows-count-giving-wrong-and-different-result-on-each-run/44676489#44676489", "title": "ActiveSheet.UsedRange.Rows.count giving wrong and different result on each run", "body": "<p>Worksheet layout can affect the .UsedRange and .CurrentRegion properties. For a definitive 'last cell' search backwards from A1 first by rows then by columns using a blanket wildcard.</p>\n\n<pre><code>dim lr as long, lc as long\n\nwith worksheets(\"sheet1\")\n    lr = .cells.find(what:=chr(42), after:=.cells(1), searchdirection:=xlprevious, _\n                     lookat:=xlpart, searchorder:=xlbyrows, lookin:=xlformulas).row\n    lc = .cells.find(what:=chr(42), after:=.cells(1), searchdirection:=xlprevious, _\n                     lookat:=xlpart, searchorder:=xlbycolumns, lookin:=xlformulas).column\n    debug.print .cells(lr, lc).address(0, 0)\n\nend with\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oUKeK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oUKeK.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498049380, "post_id": 44676509, "comment_id": 76337212, "body": "If .UsedRange and/or .CurrentRegion are not providing the desired answer then typically, the data does not follow the familiar pattern of starting in A1 and radiating outwards. Granted the OP did not think it was important enough to provide a quick screenshot of the data layout but this solution will not work in a fair number of circumstances."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 2, "last_activity_date": 1498049009, "creation_date": 1498049009, "answer_id": 44676509, "question_id": 44674413, "link": "https://stackoverflow.com/questions/44674413/activesheet-usedrange-rows-count-giving-wrong-and-different-result-on-each-run/44676509#44676509", "title": "ActiveSheet.UsedRange.Rows.count giving wrong and different result on each run", "body": "<p>For Last Row and Column in Column A: </p>\n\n<pre><code>Dim sht as Worksheets \ndim lRow as Long \nSet sht = Worksheets(\"Field Difference\")\n\nlRow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\nlCol = sht.Cells(1, sht.Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1498050089, "last_edit_date": 1498050089, "creation_date": 1498049628, "answer_id": 44676739, "question_id": 44674413, "link": "https://stackoverflow.com/questions/44674413/activesheet-usedrange-rows-count-giving-wrong-and-different-result-on-each-run/44676739#44676739", "title": "ActiveSheet.UsedRange.Rows.count giving wrong and different result on each run", "body": "<p>Methods for finding the last populated cell for a <em>given</em> column(row) are well know. using <code>End(xlUp)</code> (<code>End(xlToLeft)</code>) from the last cell of that column (row).</p>\n\n<p>To get the last cell of the <em>actually populated region</em> of a worksheet, you can use this custom function which will get it to you reliably:</p>\n\n<pre><code>Public Function getLastCell(sh As Worksheet) As Range\n  Dim lastRow As Long, lastCol As Long\n  lastRow = sh.Cells.Find(\"*\", sh.Cells(1, 1), xlFormulas, xlPart, xlByRows, xlPrevious).Row\n  lastCol = sh.Cells.Find(\"*\", sh.Cells(1, 1), xlFormulas, xlPart, xlByColumns, xlPrevious).Column\n\n  Set getLastCell = sh.Cells(lastRow, lastCol)\nEnd Function\n</code></pre>\n\n<p>By bringing the last cell, you can get the whole range from <code>A1</code> to that cell, using </p>\n\n<pre><code>mysheet.Range(\"A1\", getLastCell(mySheet))\n</code></pre>\n\n<p>Occasionally you might be interested in finding the populated region which is not starting at <code>A1</code>. You can, in this case, find Similarly the \"Topleft\" Cell of the actually populated region, using this custom function:</p>\n\n<pre><code>Public Function getFirstCell(sh As Worksheet) As Range\n  Dim lastRow As Long, lastCol As Long\n  lastRow = sh.Cells.Find(\"*\", sh.Cells(sh.Rows.Count, sh.Columns.Count), xlFormulas, xlPart, xlByRows, xlNext).Row\n  lastCol = sh.Cells.Find(\"*\", sh.Cells(sh.Rows.Count, sh.Columns.Count), xlFormulas, xlPart, xlByColumns, xlNext).Column\n\n  Set getFirstCell = sh.Cells(lastRow, lastCol)\nEnd Function\n</code></pre>\n\n<p>finally, you can <em>join</em> the two cells to get the actually ppulated region, like this:</p>\n\n<pre><code>mysheet.Range(getFirstCell(mySheet), getLastCell(mySheet))\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3648199, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dd5d71635dee74aa754262a48eb99254?s=128&d=identicon&r=PG&f=1", "display_name": "sid", "link": "https://stackoverflow.com/users/3648199/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7445, "favorite_count": 0, "closed_date": 1498049669, "answer_count": 3, "score": 0, "last_activity_date": 1498050089, "creation_date": 1498043341, "last_edit_date": 1531161705, "question_id": 44674413, "link": "https://stackoverflow.com/questions/44674413/activesheet-usedrange-rows-count-giving-wrong-and-different-result-on-each-run", "closed_reason": "Duplicate", "title": "ActiveSheet.UsedRange.Rows.count giving wrong and different result on each run", "body": "<p>My Worksheet has 29 rows and 39 columns. \nCurrently I use </p>\n\n<p><code>lrow = ActiveSheet.UsedRange.Rows.count</code>   --> for getting used rows count<br>\n<code>lColumn = ActiveSheet.UsedRange.Columns.count</code>  --> for getting used columns count </p>\n\n<p>Excel gives wrong count every time it runs. Sometimes it gives:<br>\nRows: 29 Columns: 784<br>\nOn other runs it gives<br>\nRows: 32755 and Columns as: 784<br>\nand on other runs it gives different values. </p>\n\n<p>I have checked there is no junk data after 29 rows and after 39 columns. Also, \nPrevious to filling the data I clear the sheet with: <code>ActiveWorkbook.Worksheets(\"Field Difference\").Cells.Delete</code></p>\n\n<p>I hope <code>ActiveWorkbook.Worksheets(\"Field Difference\").Cells.Delete</code> completely clears the sheet and clears the sheet of the junk data if any on the sheet. How else I can make sure that there is no junk data in the worksheet.  </p>\n\n<p>I do understand that we have other Options such as:<br>\n<code>ActiveWorkbook.Worksheets(\"Field Difference\").UsedRange.ClearContents</code> - to clear only contents<br>\n<code>ActiveWorkbook.Worksheets(\"Field Difference\").UsedRange.Clear</code> - to clear formatting as well. </p>\n\n<p>Please do let me know why I am getting wrong values for the count of rows and columns and what is the way out. Can I use <strong>any other reliable way</strong> to get the <code>UsedRange</code> row count and <code>UsedRange</code> columns count. </p>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1498064876, "post_id": 44674029, "comment_id": 76348639, "body": "What do you do with saved Text5 values?"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498065203, "post_id": 44682245, "comment_id": 76348820, "body": "Following our previous post (which you&#39;ve help solve), I need to loop on selection. and I can&#39;t use <code>SelectAll</code> in the mode I&#39;ve shared in my screen-shot (in my post), I have no problem saving the value into the Dictionary"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498072531, "post_id": 44682245, "comment_id": 76353110, "body": "Save all the values at a different time--not in the Change event--perhaps on project open.  Also, there is no way to disable events in Project like there is in Excel, so be careful not to trigger additional events within the Change event code."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1498064848, "creation_date": 1498064848, "answer_id": 44682245, "question_id": 44674029, "link": "https://stackoverflow.com/questions/44674029/run-time-error-1100-when-trying-to-selectall-in-projapp-projectbeforetaskchang/44682245#44682245", "title": "Run-Time Error 1100 when trying to &quot;SelectAll&quot; in ProjApp_ProjectBeforeTaskChange (inside Class Module)", "body": "<p>If you are looking to just save the value of Text5 before the task is changed (for any field), then try this:</p>\n\n<pre><code>Private Sub ProjApp_ProjectBeforeTaskChange(ByVal tsk As Task, ByVal Field As PjField, _\n    ByVal NewVal As Variant, Cancel As Boolean)\n\n    If Not dict.Exists(tsk.UniqueID) Then\n        dict.Add tsk.UniqueID, tsk.Text5\n    Else\n        dict(tsk.UniqueID) = tsk.Text5\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><code>tsk.UniqueID</code> will be the unique value within the master project (e.g. 8388611, rather than 3).</p>\n"}], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593559043, "creation_date": 1498042258, "last_edit_date": 1593559043, "question_id": 44674029, "link": "https://stackoverflow.com/questions/44674029/run-time-error-1100-when-trying-to-selectall-in-projapp-projectbeforetaskchang", "title": "Run-Time Error 1100 when trying to &quot;SelectAll&quot; in ProjApp_ProjectBeforeTaskChange (inside Class Module)", "body": "<p><strong>Goal</strong>: I am trying to save all the Task's <code>UniqueID</code>, and <code>Text5</code> values before a <code>Change</code> event occurs.</p>\n\n<p>Therefore, I have a Class Module <code>clsTskUpdate</code>, where I try to save all these values inside a <code>Dictionary</code> in <code>ProjApp_ProjectBeforeTaskChange</code> event.</p>\n\n<p><strong>However</strong>, since I have a Master-Project, and several Sub-Projects, I need to <code>SelectAll</code> tasks, and loop through <code>ActiveSelection.Tasks</code> to get their <code>UniqueID</code> inside the Master-Project (thanks to the help of @Rachel Hettinger).</p>\n\n<p>The problem starts, that whenever I modify the value of <code>ActualFinish</code> from the Combo-Box (as shown in the screen-shot Below):</p>\n\n<p><a href=\"https://i.stack.imgur.com/nQ887.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nQ887.png\" alt=\"enter image description here\"></a></p>\n\n<p>I get a Run-time error '1100':</p>\n\n<blockquote>\n  <p>The method is not available in this situation</p>\n</blockquote>\n\n<p>At the following line (inside <code>Sub ProjApp_ProjectBeforeTaskChange</code>)</p>\n\n<pre><code>SelectAll\n</code></pre>\n\n<p>Does anyone here know how to handle it ? How can I use the <code>SelectAll</code> before the task update it's values to save all of the current values in my <code>Dictionary</code> ?</p>\n\n<p><strong><em>Class clsTskUpdate</em> Code</strong></p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents ProjApp   As Application\n\nPrivate Sub ProjApp_ProjectBeforeTaskChange(ByVal Tsk As Task, ByVal Field As PjField, ByVal NewVal As Variant, Cancel As Boolean)\n\nRowIDChanged = Tsk.UniqueID\nMsgBox Application.StatusBar\nSaveStatusforAllTasks ' call SaveStatusforAllTasks Sub, which saves current status of Text5 (\"Status\") of all tasks\n\nEnd Sub\n\n'===================================================================\nSub SaveStatusforAllTasks()\n\nDim AllTasks As Tasks\nDim Tsk As Task\n\n' ****** Get Error 1100 at the line below *****\nSelectAll\nSet AllTasks = ActiveSelection.Tasks\n\n' add existing values of UniqueID and Text5 to Dictionary object\nSet Dict = CreateObject(\"Scripting.Dictionary\")\n\nFor Each Tsk In AllTasks\n    If Not Tsk Is Nothing Then\n        If Not Dict.exists(Tsk.UniqueID) Then\n            Dict.Add Tsk.UniqueID, Tsk.Text5\n        End If\n    End If\nNext Tsk\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>This Project</em> Code</strong></p>\n\n<pre><code>Private Sub Project_Change(ByVal pj As Project)\n\nStatusRYGFieldUpdate\n\nEnd Sub\n</code></pre>\n\n<p><strong>Regular Module Code</strong></p>\n\n<pre><code>Option Explicit\n\nPublic StatusRYGView                As New clsTskUpdate\nPublic RowIDChanged                 As Long\nPublic Const myDateFormat           As String = \"dd/mm/yy\"\nPublic Dict As Object ' use a Dictionary to save previous values of all UniqueID and Text5 values (\"Status\")\n\n\nSub StatusRYGFieldUpdate()\n\nSet StatusRYGView.ProjApp = Application\nPaneClose ' should close the Split window (to make sure run-time error 1100 won't happen\n\nApplication.Calculation = pjManual\nApplication.ScreenUpdating = False\n\nIf UpdateViewFlag Then\n    FormatModifiedTasks ' call FormatModifiedTasks Sub, which updates all tasks that Text5 (\"Status\") were modified\nEnd If\n\nApplication.Calculation = pjAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498042210, "post_id": 44673755, "comment_id": 76331963, "body": "<a href=\"https://en.wikipedia.org/wiki/HTTP_403\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/HTTP_403</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 2, "last_activity_date": 1498043142, "creation_date": 1498043142, "answer_id": 44674347, "question_id": 44673755, "link": "https://stackoverflow.com/questions/44673755/error-http-403-the-website-declined-to-show-this-webpage-in-excel-vba-while-na/44674347#44674347", "title": "Error &quot;HTTP 403 The website declined to show this webpage&quot; in Excel vba while navigating URL", "body": "<p>You're missing the additional ampersand before instrument:</p>\n\n<pre><code>ComboBox1.Value &amp; \"instrument=OPTSTK&amp;strike=\"\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>ComboBox1.Value &amp; \"&amp;instrument=OPTSTK&amp;strike=\"\n</code></pre>\n\n<p>(FYI - you can't \"fix\" a HTTP error, that's generated by the server which you have no control over)</p>\n"}], "owner": {"reputation": 377, "user_id": 3126632, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb054b3acca88dde36d3af8a3bf8b2d1?s=128&d=identicon&r=PG&f=1", "display_name": "user3126632", "link": "https://stackoverflow.com/users/3126632/user3126632"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "closed_date": 1498122642, "accepted_answer_id": 44674347, "answer_count": 1, "score": 0, "last_activity_date": 1498043142, "creation_date": 1498041484, "question_id": 44673755, "link": "https://stackoverflow.com/questions/44673755/error-http-403-the-website-declined-to-show-this-webpage-in-excel-vba-while-na", "closed_reason": "Not suitable for this site", "title": "Error &quot;HTTP 403 The website declined to show this webpage&quot; in Excel vba while navigating URL", "body": "<p>In Excel vba,I am trying to navigate an URL and fetch table data from specified url.</p>\n\n<p>First, I hardcoded the URL </p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\n\nie.navigate \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuoteFO.jsp?underlying=VGUARD&amp;instrument=OPTSTK&amp;strike=195.00&amp;type=CE&amp;expiry=29JUN2017\"\n</code></pre>\n\n<p>This worked fine and I got the table data in excel.</p>\n\n<p>Now I wanted to take <strong>underlying</strong> and <strong>strike</strong> (see url) from 2 seperate comboboxes(ComboBox1 and ComboBox2) in my worksheet.</p>\n\n<p>So I changed the url as </p>\n\n<pre><code>ie.navigate \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuoteFO.jsp?underlying=\" &amp; ComboBox1.Value &amp; \"instrument=OPTSTK&amp;strike=\" &amp; ComboBox2.Value &amp; \".00\" &amp; \"&amp;type=CE&amp;expiry=29JUN2017\"\n</code></pre>\n\n<p>But it is giving me an \n<strong>Error</strong>:::      <strong>HTTP 403 The website declined to show this webpage</strong></p>\n\n<p>How can I fix it ?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1498046160, "last_edit_date": 1498046160, "creation_date": 1498043749, "answer_id": 44674568, "question_id": 44673559, "link": "https://stackoverflow.com/questions/44673559/matching-multiple-occurrences-of-values-in-2-columns-in-excel-using-vba/44674568#44674568", "title": "Matching multiple occurrences of values in 2 columns in excel using VBA", "body": "<p>This can be done using conditional formatting, I've my data in H1:I6, using the following</p>\n\n<p>On the debit column</p>\n\n<pre><code>=AND(COUNTIF($I$2:I$6,H2)&lt;COUNTIF($H$2:$H$6,H2),ROW(H2)-1=MATCH(H2,$H$2:$H$6,0))\n</code></pre>\n\n<p>On the credit column, switch the count, from comparing I to H, to comparing H to I</p>\n\n<p><code>=AND(COUNTIF($I$2:$I$6,I2)&lt;COUNTIF($H$2:$H$6,I2),ROW(I2)-1=MATCH(I2,$I$2:$I$6,0))</code></p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 4346, "user_id": 6375113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHg5K.jpg?s=128&g=1", "display_name": "Bugs", "link": "https://stackoverflow.com/users/6375113/bugs"}, "edited": false, "score": 0, "creation_date": 1498048823, "post_id": 44676290, "comment_id": 76336793, "body": "Please add an explanation to your code only answer. It would help future visitors. Code only answers are often downvoted and may be deleted."}], "tags": [], "owner": {"reputation": 1, "user_id": 8193398, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767628096598424/picture?type=large", "display_name": "Amgalan Bilegjav", "link": "https://stackoverflow.com/users/8193398/amgalan-bilegjav"}, "is_accepted": false, "score": 0, "last_activity_date": 1498048488, "creation_date": 1498048488, "answer_id": 44676290, "question_id": 44673559, "link": "https://stackoverflow.com/questions/44673559/matching-multiple-occurrences-of-values-in-2-columns-in-excel-using-vba/44676290#44676290", "title": "Matching multiple occurrences of values in 2 columns in excel using VBA", "body": "<pre><code>Sub Macro1()\n    iRowMax = 6\n    iColDeb = 1\n    iColCre = 2\n    For iRowD = 2 To iRowMax\n        For iRowC = 2 To iRowMax\n            If Cells(iRowC, iColCre).Interior.Color &lt;&gt; 65535 Then\n                If Cells(iRowC, iColCre) = Cells(iRowD, iColDeb) Then\n                    Cells(iRowC, iColCre).Interior.Color = 65535\n                    Cells(iRowD, iColDeb).Interior.Color = 65535\n                    Exit For\n                End If\n            End If\n        Next iRowC\n    Next iRowD\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2455307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e3745ee3e45e81d224dc159c806523?s=128&d=identicon&r=PG", "display_name": "Durand Jesse", "link": "https://stackoverflow.com/users/2455307/durand-jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498048488, "creation_date": 1498040921, "last_edit_date": 1498041042, "question_id": 44673559, "link": "https://stackoverflow.com/questions/44673559/matching-multiple-occurrences-of-values-in-2-columns-in-excel-using-vba", "title": "Matching multiple occurrences of values in 2 columns in excel using VBA", "body": "<p>I currently need to match values in 2 columns. Data is currently set up as follows:</p>\n\n<pre><code>Debit        Credit\n5000\n             6000\n6000\n6000\n3000         5000\n</code></pre>\n\n<p>and so on.</p>\n\n<p>what i am trying to achieve is highlighting the number of debits and credits which match ie in the above example, there are 2 debits for 6000 but only one credit so only one 6000 should be highlighted in each column. </p>\n\n<p>any assistance would be greatly appreciated</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498039989, "post_id": 44672973, "comment_id": 76330385, "body": "it still dint satisfy condition 4. I have numbers in column A and no numbers in B, D has date and E has no date, in this case, it should be left blank. But the code prints Project delay."}, {"owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498041012, "post_id": 44672973, "comment_id": 76331085, "body": "Can you upload the file?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498041179, "post_id": 44672973, "comment_id": 76331225, "body": "ya i will do it."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498041896, "post_id": 44672973, "comment_id": 76331733, "body": "i have edited my question and have added an Image . If your not able to view the Image, Please imform me. @ahmed Abdel Khalek"}, {"owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498042578, "post_id": 44672973, "comment_id": 76332206, "body": "I can see the image very well"}, {"owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498042601, "post_id": 44672973, "comment_id": 76332223, "body": "So, A contain a number even if one digit?  Because C312321 is a string value and not numeric That confuses me."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498042738, "post_id": 44672973, "comment_id": 76332314, "body": "I dint get you . sorry ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "edited": false, "score": 0, "creation_date": 1498042745, "post_id": 44672973, "comment_id": 76332319, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147248/discussion-between-mikz-and-ahmed-abdelkhalek\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 176, "user_id": 7283960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpOMc.jpg?s=128&g=1", "display_name": "Ahmed AbdelKhalek", "link": "https://stackoverflow.com/users/7283960/ahmed-abdelkhalek"}, "is_accepted": false, "score": 0, "last_activity_date": 1498039398, "creation_date": 1498039398, "answer_id": 44672973, "question_id": 44672486, "link": "https://stackoverflow.com/questions/44672486/vba-in-excel-to-compare-columns-with-different-cases/44672973#44672973", "title": "VBA in excel to compare columns with different cases", "body": "<p>Try to add these lines before end if </p>\n\n<pre><code>ElseIf IsNumeric(Range(\"A\" &amp; i).Value) And (Not IsNumeric(Range(\"A\" &amp; i).Value)) And IsDate(Range(\"D\" &amp; i).Value) And Range(\"E\" &amp; i).Value = \"\" Then\nZtext = \"\"\nzcolour = vbYellow\nCells(i, 7) = \"Yellow\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498042065, "post_id": 44673595, "comment_id": 76331864, "body": "I tried this, still the case4 is not satisfied. It prints delay. But according to the case, it should leave it as it as blank"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498042601, "post_id": 44673595, "comment_id": 76332221, "body": "I tried with the updated ans, it seems to be changing my cases. It printing on time everywhere, I have attached an Image, which i want the Output to look like, before the edit, the cases were proper except the Case4."}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1498042349, "last_edit_date": 1498042349, "creation_date": 1498041003, "answer_id": 44673595, "question_id": 44672486, "link": "https://stackoverflow.com/questions/44672486/vba-in-excel-to-compare-columns-with-different-cases/44673595#44673595", "title": "VBA in excel to compare columns with different cases", "body": "<p>Try this</p>\n\n<p>Note: not tested</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long, i As Long\n    Dim zWeeks As Double, zcolour As Long\n    Dim Ztext As String\n\n    Set ws = Sheets(\"Preparation Sheet\")\n\n    With ws\n        lRow = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 2 To lRow\n                lDate  = .Range(\"E\" &amp; i).Value\n                sDate= .Range(\"D\" &amp; i).Value\n            zWeeks = DateDiff(\"ww\",sDate , lDate)\n\n            If .Range(\"A\" &amp; i).Value &lt;&gt; \"\" And .Range(\"B\" &amp; i).Value &lt;&gt; \"\" And .Range(\"E\" &amp; i).Value = \"\" Then\n                Ztext = \"remaining\"\n                zcolour = vbYellow\n                Cells(i, 7) = \"Yellow\"\n            ElseIf .Range(\"A\" &amp; i).Value &lt;&gt;\"\" And .Range(\"B\" &amp; i).Value = \"\" And IsDate(sDate) And Ldate = \"\" Then\n                Ztext = \"\"\n                zcolour = vbYellow\n                Cells(i, 7) = \"Yellow\"\n            ElseIf zWeeks &lt; 2 Then\n                Ztext = \" on time\"\n                zcolour = vbGreen\n                Cells(i, 7) = \"Green\"\n            ElseIf zWeeks &gt; 4 Then\n                Ztext = \"delayed\"\n                zcolour = vbRed\n                Cells(i, 7) = \"Red\"\n            ElseIf zWeeks &gt; 2 &lt; 4 Then\n                Ztext = \"remaining\"\n                zcolour = vbYellow\n                Cells(i, 7) = \"Yellow\"\n\n            End If\n\n\n            With .Range(\"F\" &amp; i)\n                .Value = Ztext\n                .Interior.Color = zcolour\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498043450, "post_id": 44674326, "comment_id": 76332770, "body": "ya. this is what exactly i Need .. :) thanks a Ton to solve this."}], "tags": [], "owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "is_accepted": true, "score": 0, "last_activity_date": 1498043625, "last_edit_date": 1498043625, "creation_date": 1498043089, "answer_id": 44674326, "question_id": 44672486, "link": "https://stackoverflow.com/questions/44672486/vba-in-excel-to-compare-columns-with-different-cases/44674326#44674326", "title": "VBA in excel to compare columns with different cases", "body": "<p>Add a new condition after the first one, which check if value on Col.B and E are blanks. </p>\n\n<pre><code>    ElseIf .Range(\"B\" &amp; i).value = \"\" And .Range(\"E\" &amp; i).value = \"\" Then\n      GoTo nextrow\n</code></pre>\n\n<p>Then add the label before the end of the loop. This will skip the other condition and move to the next row:</p>\n\n<pre><code>nextrow:\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44674326, "answer_count": 3, "score": 0, "last_activity_date": 1551005505, "creation_date": 1498038224, "last_edit_date": 1551005505, "question_id": 44672486, "link": "https://stackoverflow.com/questions/44672486/vba-in-excel-to-compare-columns-with-different-cases", "title": "VBA in excel to compare columns with different cases", "body": "<p>I am comparing the columns with Dates and numbers. I have in total 8 columns (A-H). \nColumn A and B contains numbers. (in somecases column B is empty). \nColumn D(sdate) and E(Ldate) contains Dates. ( in some cases column E is empty). </p>\n\n<p>I have 4 cases with me now. </p>\n\n<p>Case 1 is if sdate &lt; 2 weeks of Ldate, then print ontime. </p>\n\n<p>case2  is sdate > 4weeks of Ldate, print delay. </p>\n\n<p>case 3 is sdate is &lt;4weeks and > 2weeks of Ldate, then print Project remaning.with case 3, there is another condition, that, if column A, B and D are present, but no date in column E, it should still print remaining. </p>\n\n<p>case4: column A contains numbers, column B has no numbers, Column D has date and Column E has no date then , it should be left blank. </p>\n\n<p>2 experts of the Forum , guided me to achieve the criteria, but with the below code, there is an error that, it doesnt not satistfy case4 . </p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long, i As Long\n    Dim zWeeks As Double, zcolour As Long\n    Dim Ztext As String\n\n    Set ws = Sheets(\"Preparation Sheet\")\n\n    With ws\n        lRow = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 2 To lRow\n\n\n            zWeeks = DateDiff(\"ww\", .Range(\"E\" &amp; i).Value, .Range(\"D\" &amp; i).Value)\n\n            If .Range(\"A\" &amp; i).Value &lt;&gt; \"\" And .Range(\"B\" &amp; i).Value &lt;&gt; \"\" And .Range(\"E\" &amp; i).Value = \"\" Then\n                Ztext = \"remaining\"\n                zcolour = vbYellow\n                Cells(i, 7) = \"Yellow\"\n            ElseIf zWeeks &lt; 2 Then\n                Ztext = \" on time\"\n                zcolour = vbGreen\n                Cells(i, 7) = \"Green\"\n            ElseIf zWeeks &gt; 4 Then\n                Ztext = \"delayed\"\n                zcolour = vbRed\n                Cells(i, 7) = \"Red\"\n                ElseIf zWeeks &gt; 2 &lt; 4 Then\n                Ztext = \"remaining\"\n                zcolour = vbYellow\n                Cells(i, 7) = \"Yellow\"\n\n            End If\n\n\n            With .Range(\"F\" &amp; i)\n                .Value = Ztext\n                .Interior.Color = zcolour\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eEGmf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eEGmf.png\" alt=\"I Need cases like this \"></a></p>\n"}, {"tags": ["excel", "vba", "loading", "userform", "progress"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1498039711, "post_id": 44672313, "comment_id": 76330200, "body": "Probably because if you call a UserForm modal (which is default) in your second approach, then the subroutine stops executing until the UserForm is finished and closed. And after that the subroutine proceeds. And if you don&#39;t call it modal then the user can work on without having to wait until the subroutine is finished. He can just ignore the UserForm because Excel is not blocked by a modal view. See <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/show-method\" rel=\"nofollow noreferrer\">Show Method</a> for the difference between <i>modal</i> and <i>modeless</i>."}, {"owner": {"reputation": 293, "user_id": 6582967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d5542557534232d9fb22587ca5d6844b?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/6582967/benjamin"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498093173, "post_id": 44672313, "comment_id": 76360764, "body": "@Peh So am I right to say that using a subroutine to call a modeless UserForm is the same as the above method 1? Or is it different? What is the best practice?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498114486, "post_id": 44672313, "comment_id": 76367640, "body": "I wrote an answer to explain the differences between the 2 methods. In my opinion it is not a question of best practice it is a question of what you need or which approach is the best for your project."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498043686, "post_id": 44674053, "comment_id": 76332948, "body": "But as I said in my comment above: The disadvantage of doing it this way is that it doesn&#39;t force the user to wait until <code>Example_OnClick</code> has finished. If this is a long term process let&#39;s say 1 minute or more then the user is still able to modify the worksheets during the run time of the procedure (which can break the running process in several cases). A modal UserForm prevents this. So these are just 2 different use cases and you need to decide which one suits best to your application."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498044489, "post_id": 44674053, "comment_id": 76333505, "body": "Agree there are pro&#39;s and con&#39;s.  Without more context it is hard to judge.  If the bar is reporting progress of an external process (perhaps a large file upload) then it might be better if users can continue to edit Excel in meantime.  Suspect form here is used as a substitute for a custom control."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 1, "last_activity_date": 1498042315, "creation_date": 1498042315, "answer_id": 44674053, "question_id": 44672313, "link": "https://stackoverflow.com/questions/44672313/why-are-loading-bar-in-vba-created-by-using-userforms-to-call-the-main-subroutin/44674053#44674053", "title": "Why are loading bar in VBA created by using UserForms to call the main subroutine instead of the other way round?", "body": "<p>There is nothing to stop you doing it that way.  The code below shows a rough mock-up of the VBA required.</p>\n\n<p>This approach makes it easier to reuse your progress form elsewhere in this, and other, projects.  Just make sure the progress logic, within the subroutine, is separated from the display logic, within the form.  </p>\n\n<pre><code>' Event fired by a button on the Excel grid.\nSub Example_OnClick()\n\n    Dim myForm As UserForm1     ' Replace with your form here.\n\n\n    ' Display the form.\n    ' Ensure it is not modal, as this would prevent subsequent lines\n    ' from executing while the form is open.\n    myForm.Show False\n\n    Do Until myForm.Progress = 100\n\n        ' ToDo: Add processing logic here.\n\n        ' Update the progress bar.\n        myForm.IncrementPrgress 1\n    Loop\n\n    ' Remove the from\n    Unload myForm\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1498741144, "last_edit_date": 1592644375, "creation_date": 1498114411, "answer_id": 44692188, "question_id": 44672313, "link": "https://stackoverflow.com/questions/44672313/why-are-loading-bar-in-vba-created-by-using-userforms-to-call-the-main-subroutin/44692188#44692188", "title": "Why are loading bar in VBA created by using UserForms to call the main subroutine instead of the other way round?", "body": "<p>To explain the differences between the 2 methods.</p>\n<h3>Method 1</h3>\n<ol>\n<li><strong>Create a button to call the UserForm</strong><br />\n<em>We load the user form modal (this is default behavior in Excel) so the userform is on top and the user can only interact with that userform but not with Excel sheets anymore until the form is closed.</em></li>\n<li><strong>UserForm calls subroutine</strong><br />\n<em>Only that userform can call the subroutine because of modal mode.</em></li>\n<li><strong>Subroutine updates the bar</strong></li>\n<li><strong>Unload bar within subroutine</strong></li>\n</ol>\n<h3>Method 2</h3>\n<ol>\n<li><p><strong>Create a button to call the subroutine</strong></p>\n</li>\n<li><p><strong>Subroutine calls UserForm</strong><br />\n<em>The userform needs to be loaded modeless. Because if you load it modal then the subroutine execution would stop at this point until the form is closed again. If you call it modeless then the subroutine execution proceeds, but the form does not block Excel sheets and the user still can edit sheets while the form is open. It is like having Excel and the form parallel instead of having the form on top of Excel (modal).</em></p>\n</li>\n<li><p><strong>Subroutine updates the bar</strong><br />\n<em>The subroutine proceeds because form is modeless. If it was modal the subroutine would have stopped until the form is closed and you could not update the bar anymore</em></p>\n</li>\n<li><p><strong>Unload bar within subroutine</strong></p>\n</li>\n</ol>\n<hr />\n<h3>So how to decide which method is the best for you?</h3>\n<p>This depends on wether you want to allow the user to access a worksheet while the progress bar is shown (method 2) or disallow it and keep the form on top of Excel (method 1). This is completely up to you which approach you need.</p>\n"}], "owner": {"reputation": 293, "user_id": 6582967, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d5542557534232d9fb22587ca5d6844b?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/6582967/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 44674053, "answer_count": 2, "score": 1, "last_activity_date": 1549013899, "creation_date": 1498037822, "last_edit_date": 1549013899, "question_id": 44672313, "link": "https://stackoverflow.com/questions/44672313/why-are-loading-bar-in-vba-created-by-using-userforms-to-call-the-main-subroutin", "title": "Why are loading bar in VBA created by using UserForms to call the main subroutine instead of the other way round?", "body": "<p>I've read through quite a few tutorials on creating a loading bar or progress bar using UserForms in VBA but all of them guide me in the following steps:</p>\n\n<ol>\n<li>Create a button to call the UserForm</li>\n<li>UserForm calls subroutine</li>\n<li>Subroutine updates the bar</li>\n<li>Unload bar within subroutine</li>\n</ol>\n\n<p>Why can't I do the following instead:</p>\n\n<ol>\n<li>Create a button to call the subroutine</li>\n<li>Subroutine calls UserForm</li>\n<li>Subroutine updates the bar</li>\n<li>Unload bar within subroutine</li>\n</ol>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 470, "user_id": 2482299, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/J8yzU.png?s=128&g=1", "display_name": "ApsSanj", "link": "https://stackoverflow.com/users/2482299/apssanj"}, "is_accepted": true, "score": 0, "last_activity_date": 1498206011, "creation_date": 1498206011, "answer_id": 44716481, "question_id": 44672173, "link": "https://stackoverflow.com/questions/44672173/identify-word-ongoing-process-document-saving-using-visual-basic/44716481#44716481", "title": "Identify word ongoing process (Document saving) using visual basic", "body": "<p>We can use the following vb code to identify a word document's saving process is in progress or not.</p>\n\n<pre><code>word.Application.BackgroundSavingStatus\n</code></pre>\n\n<p>This will return <code>0</code>  if there is no document saving process running.</p>\n\n<p>This will return a <code>count &lt;&gt; 0</code> if the document saving process is in progress. </p>\n\n<pre><code>Do\n    Select Case True\n    Case mobjApplication.wordApp.BackgroundSavingStatus = 0\n         Exit Do\n    Case Else\n         DoEvents\n    End Select\nLoop\n</code></pre>\n\n<p>This  will wait the project execution until the document saving process get completed. </p>\n"}], "owner": {"reputation": 470, "user_id": 2482299, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/J8yzU.png?s=128&g=1", "display_name": "ApsSanj", "link": "https://stackoverflow.com/users/2482299/apssanj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 44716481, "answer_count": 1, "score": 0, "last_activity_date": 1498206011, "creation_date": 1498037557, "last_edit_date": 1498038173, "question_id": 44672173, "link": "https://stackoverflow.com/questions/44672173/identify-word-ongoing-process-document-saving-using-visual-basic", "title": "Identify word ongoing process (Document saving) using visual basic", "body": "<p>I am saving a large word document and before the saving process completed , I am uploading the active document content to the server using our vb project. As the saving process is not completed, my code is giving an error saying,</p>\n\n<pre><code>Unexpected Error 70 - Permission Denied\n</code></pre>\n\n<p>Commands.TPS_UplodDocument</p>\n\n<p>Is there any way to identify if the file saving process finished or not by using a visual basic code? \nI tried on this.</p>\n\n<p><code>Word.ActiveDocument.Saved</code></p>\n\n<p>But it is returning True just after the saving process started. </p>\n\n<p>Please help me on this.</p>\n"}, {"tags": ["vba", "excel", "class", "events", "userform"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1498040492, "post_id": 44671994, "comment_id": 76330712, "body": "If you pass in the image as a control in your initialise, you can use the <code>.parent</code> property to get the form, see my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498041093, "post_id": 44672975, "comment_id": 76331157, "body": "In fact you can still use a <code>MSForms.Image</code> not just a <code>control</code>. Then whenever I want to say <code>imgForm.Repaint</code> in my class, I can instead say <code>myPic.Parent.Repaint</code> - or indeed, as you have done, save <code>myPic.Parent</code> as a Userform object  in the <code>Init()</code> sub. But what about the bit you deleted, about declaring a public event? Might that be another way - if I have a collection/array of classes all raising the same Public event, and my userform contains the event handler for it? How would I write that in code?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 1, "creation_date": 1498042174, "post_id": 44672975, "comment_id": 76331947, "body": "With the event you still need the same code to call it, so you&#39;d have raiseevent where repaint is, but you&#39;d have to declare single instances of each image class.  Or have another class handling it, but again, will still need the <code>.parent</code>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498043297, "post_id": 44672975, "comment_id": 76332688, "body": "So, as per my comment on <a href=\"https://stackoverflow.com/a/44673568/6609896\">Rik Sportel&#39;s answer</a>, is there no way to collect all the events together into a single event? Some kind of OR function on an undefined number of event inputs?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498043851, "post_id": 44672975, "comment_id": 76333072, "body": "You could write your own collection class, and take one instance of the parent, so have a class with a collection and a userform, set the user form once, then call that way, but seems like you&#39;d have a class for controlling your custom classes."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498056653, "post_id": 44672975, "comment_id": 76343130, "body": "Correct me if I&#39;m wrong, but doesn&#39;t this just listen for events from the last control added to the collection? I think there&#39;s some promise in <a href=\"https://codereview.stackexchange.com/q/44361\">this approach</a>, creating a function event handler that accepts arguments, but it looks pretty complicated!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498058340, "post_id": 44672975, "comment_id": 76344557, "body": "Hi, yes, I put something along these lines.  I don&#39;t think there will be a solution that you desire.  Best just using the solution that works :("}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1498059221, "last_edit_date": 1498059221, "creation_date": 1498039405, "answer_id": 44672975, "question_id": 44671994, "link": "https://stackoverflow.com/questions/44671994/monitor-class-events-from-userform/44672975#44672975", "title": "Monitor class events from userform", "body": "<p>I did the following,  If you pass the control as a control, you can use the parent.</p>\n\n<p>In my form</p>\n\n<pre><code>Public c As Collection\n\nPrivate Sub UserForm_Initialize()\n\nDim ctl As Control\nDim cls As clsCustomImage\n\n    Set c = New Collection\n    For Each ctl In Me.Controls\n        If TypeName(ctl) = \"Image\" Then\n            Set cls = New clsCustomImage\n            cls.init  ctl\n            c.Add cls, CStr(c.Count)\n        End If\n    Next ctl\n\nEnd Sub\n</code></pre>\n\n<p>and in my class, clsCustomImage</p>\n\n<pre><code>Private WithEvents i As MSForms.Image\nPrivate frm As UserForm\npublic event evtRepaint\nPublic Sub init(c As control)\n    Set frm = c.parent\n    Set i = c\nEnd Sub\n\nPrivate Sub Class_Initialize()\n\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set frm = Nothing\n    Set i = Nothing\nEnd Sub\n\n'\n\nPrivate Sub i_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    i.Picture = Nothing\n    frm.Repaint\n    raiseevent evtRepaint\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>To have a single handler, you'd need to look at something along these lines, in a class called say clsHoldAndHandle</p>\n\n<pre><code>Private c As Collection\nPrivate f As UserForm\nPrivate WithEvents cls As clsCustomImage\n\nPublic Sub AddControl(ctl As Control)\n    Set cls = new clsCustomImage\n    If f Is Nothing Then Set f = ctl.Parent\n    cls.init ctl\n    c.Add cls, CStr(c.Count)\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    Set c = New Collection\nEnd Sub\n\nPrivate Sub cls_evtRepaint()\n    f.Repaint\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498042741, "post_id": 44673568, "comment_id": 76332317, "body": "Sorry, I&#39;m a bit confused. The main body of your answer is very clear and thanks for the tip on Letting/Getting. But as you highlight, this approach won&#39;t work for undefined array lengths as each one requires its own hard coded event handler - am I understanding you correctly? You allude to a workaround <i>using a Collection or some similar approach</i> but the article you link just describes a method of assigning the controls to an array of classes. I&#39;ve already got the exact same thing (albeit with runtime created controls not existing ones), but I don&#39;t see how that links in with any workaround?"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498042994, "post_id": 44673568, "comment_id": 76332484, "body": "I&#39;m guessing what you mean is that I create another class which takes a WithEvents version of my first class, and that second class contains the repaint code. That way you assign the picture-&gt;firstclass and the firstclass-&gt;second class, each object handling the events of the one below it. Is that what you meant? Because what I really need is some way of collecting all the events from the first classes into a single event (like some OR statement with a paramArray input; I&#39;m thinking aloud here) and then pass that collective event to my userform. Is anything like that possible?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 1, "creation_date": 1498048763, "post_id": 44673568, "comment_id": 76336749, "body": "Unfortunately it is not. Instead of Raising an Event you could call a regular module that has <code>UserForm1.Repaint</code> and just add an array of the custom class to the UserForm. The thing is, you can chain events just fine but somewhere you&#39;re going to need a specific handler for the object. The basic construction we&#39;re after is <code>Private WithEvents images() as clsImg</code> but that&#39;s not supported in VBA as far as I know. I&#39;ll see if I can find a cleaner solution."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498204498, "post_id": 44673568, "comment_id": 76414244, "body": "@Greedo Please see my Edit. I think that this would be the cleanest approach as supported by VBA. Any other ideas --&gt; I&#39;d love to hear."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498326764, "post_id": 44673568, "comment_id": 76459941, "body": "Glad the qu has sparked your interest. I was thinking of something along those lines; but the idea of a <i>factory routine</i> is genius and what I was lacking. I would suggest though that the event <i>does not</i> pass the button object. That&#39;s because (preference only) I think that only generic events should be handled by the userform/<code>Publisher</code> class (such as a <code>UF.Repaint</code> which has a <i>global</i> effect on all userform controls). Button-specific events should be handled in <code>cButton</code> meaning that the button object never actually has to be passed up the line. That might make the code more portable"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498327076, "post_id": 44673568, "comment_id": 76460019, "body": "Also, can the <code>GetPublisher()</code> code be coerced into the <code>Publisher</code> class or the UserForm code itself so you only need the 2 classes rather than 3? I&#39;m just trying to work out whether this would be possible, but I guess a class can&#39;t initiate itself and I&#39;m not sure if it could go in the userform as that would require the <code>cButton</code> class to have sight of the userform which is what we&#39;re trying to avoid. Perhaps you could place the Publisher code in the workbook class as that is already initiated and so you wouldn&#39;t need the Publisher factory class"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 1, "creation_date": 1498464495, "post_id": 44673568, "comment_id": 76491443, "body": "<code>GetPublisher</code> can&#39;t be forced into the <code>Publisher</code> class - A class indeed can not instantiate itself. Of course you could do the initial instantiation in the Workbook, but whatever class wants to use it still need that factory routine. As to passing the button in the event - When raising any event it&#39;s up to you what you wish to pass as variables (if any) - Alter to suit your needs I&#39;d say. The idea of having some Publisher is a design pattern that consists of having 3 classes in the first place. In VBA you don&#39;t really have the ability to do a fullblown <code>Subscribe()</code> unfortunately."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1498464547, "post_id": 44673568, "comment_id": 76491472, "body": "Still think it is the most suited design pattern for your situation though, given the limitations of VBA."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 5, "last_activity_date": 1498204457, "last_edit_date": 1498204457, "creation_date": 1498040935, "answer_id": 44673568, "question_id": 44671994, "link": "https://stackoverflow.com/questions/44671994/monitor-class-events-from-userform/44673568#44673568", "title": "Monitor class events from userform", "body": "<p>Since good practice is that classes are self-contained (as you obviously know) the <code>clsImg</code> should indeed not have to be aware of the <code>UserForm</code> and thus shouldn't tell the UserForm to repaint. </p>\n\n<p>What this calls for, is indeed that the clsImg raises an event that the UserForm hooks into, so it repaints based on that event, or, in your own words: \"a way of telling the userform that it needs to repaint.\"</p>\n\n<p>I replicated your Custom Class (<code>clsImg</code>) as follows (wanted to use a proper Setter / Getter, functionality doesn't really change)</p>\n\n<p><code>clsImg</code> Code:</p>\n\n<pre><code>Private WithEvents myPic As MSForms.Image 'Because we need the click event.\nPublic Event NeedToRepaint() 'Because we need to raise an event that the UserForm can hook into.\nPublic Property Let picture(value As MSForms.Image)\n    Set myPic = value\nEnd Property\nPublic Property Get picture() As MSForms.Image\n    Set picture = myPic\nEnd Property\nPublic Sub myPic_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    myPic.picture = Nothing\n    RaiseEvent NeedToRepaint\nEnd Sub\n</code></pre>\n\n<p>Next, in the UserForm we hook into this <code>NeedToRepaint</code> Event that's raised during the Event Handler of the <code>MouseDown</code> of the picture.</p>\n\n<p><code>UserForm1</code> Code:</p>\n\n<pre><code>Private WithEvents oneImg As clsImg 'Our custom class\nPrivate Sub oneImg_NeedToRepaint() 'Handling the event of our custom class\n    Me.Repaint\nEnd Sub\nPrivate Sub UserForm_Initialize()\n    Dim tmpCtrl As MSForms.Image\n    Set oneImg = New clsImg\n    Set tmpCtrl = Me.Controls.Add(\"Forms.Image.1\")\n    tmpCtrl.picture = LoadPicture(\"C:\\Path\\image.jpg\")\n    oneImg.picture = tmpCtrl\nEnd Sub\n</code></pre>\n\n<p>The second part of your question is whether you can use this in an array.\nThe short answer is \"no\" - Each object would have to have it's own Event Handler. However, there are ways to work around this limitation by using a Collection or some similar approach. Still, this wrapper will have to be \"UserForm aware\" since that's where you'll be repainting. The approach would be something like in <a href=\"http://spreadsheetpage.com/index.php/tip/handle_multiple_userform_buttons_with_one_subroutine/\" rel=\"nofollow noreferrer\">this article</a></p>\n\n<p><strong>EDIT: A solution / workaround for not being able to use an Array:</strong> </p>\n\n<p>Since I really liked this question - Here's another approach.\nWe can apply somewhat of a PubSub pattern as follows:\nI did a quick build for CommandButtons, but no reason that it can not be made for other classes of course.</p>\n\n<p><code>Publisher</code> class:</p>\n\n<pre><code>Public Event ButtonClicked(value As cButton)\nPublic Sub RegisterButtonClickEvent(value As cButton)\n    RaiseEvent ButtonClicked(value)\nEnd Sub\n'Add any other events + RegisterSubs.\n</code></pre>\n\n<p>In a regular class, I setup a factory routine to keep this specific Publisher a singleton (as in: It will always be the very same in memory object that you're pointing at):</p>\n\n<pre><code>Private pub As Publisher\nPublic Function GetPublisher() As Publisher\n    If pub Is Nothing Then\n        Set pub = New Publisher\n    End If\n    Set GetPublisher = pub\nEnd Function\n</code></pre>\n\n<p>Next, we have the UserForm (I just made one with 4 buttons) and the button class to utilize this Publisher. The Userform will just subscribe to the event it raises:\n<code>Userform</code> code:</p>\n\n<pre><code>Private WithEvents pPub As Publisher 'Use the Publishers events.\nPrivate button() As cButton 'Custom button array\nPrivate Sub pPub_ButtonClicked(value As cButton) 'Hook into Published event.\n    MsgBox value.button.Caption\nEnd Sub\nPrivate Sub UserForm_Initialize()\n    Set pPub = GetPublisher 'Private publisher for getting it's event. Will be always the same object as long as you use \"GetPublisher\"\n\n    Dim i As Integer\n    Dim btn As MSForms.CommandButton\n\n    'Create an array of the buttons:\n    i = -1\n    For Each btn In Me.Controls\n        i = i + 1\n        ReDim Preserve button(0 To i)\n        Set button(i) = New cButton\n            button(i).button = btn\n    Next btn\nEnd Sub\n</code></pre>\n\n<p>Last we have the <code>cButton</code> class, that centralizes the button events (through the array). Instead of handling each event individually, we just tell the publisher that an Event has been raised.:</p>\n\n<pre><code>Private WithEvents btn As MSForms.CommandButton\nPrivate pPub As Publisher\nPublic Event btnClicked()\nPrivate Sub btn_Click()\n    pPub.RegisterButtonClickEvent Me 'Pass the events to the publisher.\nEnd Sub\nPublic Property Let button(value As MSForms.CommandButton)\n    Set btn = value\nEnd Property\nPublic Property Get button() As MSForms.CommandButton\n    Set button = btn\nEnd Property\nPrivate Sub Class_Initialize()\n    Set pPub = GetPublisher\nEnd Sub\n</code></pre>\n\n<p>With this approach we have one \"Publisher\" that can handle any event from specific classes that register the right event with it. You could also add image events, workbook events, etc.\nThe publisher itself raises the events we need based on what gets passed to it.\nThis way the UserForm can be agnostic of the button class and vice versa.\nBased on what is supported in VBA, I'm quite confident this is the cleanest approach for your scenario. If anyone has a better idea, I'd love to see another answer.</p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 2, "accepted_answer_id": 44673568, "answer_count": 2, "score": 6, "last_activity_date": 1498295034, "creation_date": 1498037115, "last_edit_date": 1498037686, "question_id": 44671994, "link": "https://stackoverflow.com/questions/44671994/monitor-class-events-from-userform", "title": "Monitor class events from userform", "body": "<p>I have a userform which assembles itself at runtime, by looking in a folder and extracting all the pictures from it into image-controls on my form. What makes the process a little more complex is that I'm also using the image-controls' events to run some code.</p>\n\n<p>As a simplified example - I have a form which creates a picture at runtime, the picture has an on-click event to clear its contents. To do this I have a custom class to represent the image object</p>\n\n<p>In a blank userform called \"imgForm\"</p>\n\n<pre><code>Dim oneImg As New clsImg 'our custom class\n\nPrivate Sub UserForm_Initialize()\nSet oneImg.myPic = Me.Controls.Add(\"Forms.Image.1\") 'set some property of the class\noneImg.Init 'run some setup macro of the class\nEnd Sub\n</code></pre>\n\n<p>In a class module called \"clsImg\"</p>\n\n<pre><code>Public WithEvents myPic As MSForms.Image\n\nPublic Sub Init() 'can't put in Class_Initialise as it is called before the set statement - so myPic is still empty at that point\nmyPic.Picture = LoadPicture(path/image)\nEnd Sub\n\nPublic Sub myPic_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nonePic.Picture = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>The problem is, this doesn't display the changes,</strong> and I realised I needed a <code>imgForm.Repaint</code> in there somewhere - <strong>the question is, where?</strong></p>\n\n<h2><em>Attempts</em></h2>\n\n<p>First option is to put it in the <code>Init()</code> sub of <code>clsImg</code>. (ie. have a line <code>imgForm.Repaint</code> at the end of the click event) That works, but not ideal as the class can then only be used with the userform of the correct name.</p>\n\n<hr>\n\n<p>A 2nd idea was to pass the userform as an argument to <code>Init()</code></p>\n\n<pre><code>Public Sub Init(uf As UserForm) 'can't put in Class_Initialise as it is called before the set statement - so myPic is still empty at that point\nmyPic.Picture = LoadPicture(path/image)\nuf.Repaint\nEnd Sub\n</code></pre>\n\n<p>And called with</p>\n\n<pre><code>oneImg.Init Me\n</code></pre>\n\n<p>That works too, but would mean that wherever I require a repaint, I would have to pass the parameter which is also not ideal - the code is in reality a lot more complex than is shown here, so I don't want to have to add in this extra parameter unless necessary</p>\n\n<hr>\n\n<p>The third option which I'm currently using is to pass the userform object to the class and save it there.</p>\n\n<p>So with a <code>Public myForm As UserForm</code> at the top of my class module, I can pass the userform with the <code>Init(uf As UserForm)</code> and have a </p>\n\n<pre><code>Set myForm = uf 'Works with a private \"myForm\"/ class Property\n</code></pre>\n\n<p>Or I can set it directly from the userform code with a </p>\n\n<pre><code>Set clsImg.myForm = Me 'only if \"myForm\" is Public\n</code></pre>\n\n<p>But what does this do for memory - does saving the userform as a variable in my class take up a lot of memory? Bear in mind that in my real code I declare an array of <code>clsImg</code>s that can be of the order of >100 instances so I don't really want to be making copies of the UF in <em>each class</em> if that's what this method does. Also, it's ugly</p>\n\n<h1>What I really want...</h1>\n\n<p>... is a way of <em>telling</em> the userform that it needs to repaint, rather than directly repainting from within the class. To me this says I need an event to occur in my class, which the userform <em>hears</em> with some custom event handler. Exactly how Worksheet_Change works, the sheet object raises a change event, the sheet class code handles it.</p>\n\n<p>Is such a thing possible (I suppose I would have to declare <code>clsImg WithEvents</code> - can you do that for an array?), or is there a better alternative. I'm looking for a method which does not impede performance with a large number of classes declared, as well as one which is portable and easily readable. This is my first use of Classes so I may be missing something really obvious!</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1498039639, "post_id": 44672789, "comment_id": 76330158, "body": "Thanks for the hints Robin, however this doesn&#39;t solve the problem. Still when I call <code>BezemResultaat()</code> I get the error."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1498040279, "post_id": 44672789, "comment_id": 76330565, "body": "Is it a different error - I&#39;m thinking you no longer get the compile time error but a runtime error ?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1498040759, "post_id": 44672789, "comment_id": 76330893, "body": "On a side note, it&#39;s completely horrible that the debugger just lists the first line of code on a compile error..."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1498041014, "post_id": 44672789, "comment_id": 76331088, "body": "I just edited the answer to remove the <code>()</code> from <code>GetData()</code> and just have <code>GetData</code> which was a silly typo. Can you try again?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1498041532, "post_id": 44672789, "comment_id": 76331480, "body": "So maybe if you just try with <code>If Not IsMac Then GetData</code> and see if that works?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498041621, "post_id": 44672789, "comment_id": 76331534, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147246/discussion-between-luuklag-and-robin-mackenzie\">continue this discussion in chat</a>."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1498044170, "post_id": 44672789, "comment_id": 76333274, "body": "You ofcourse need to remove the checkmark in the list of libraries."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1498040978, "last_edit_date": 1498040978, "creation_date": 1498038958, "answer_id": 44672789, "question_id": 44671841, "link": "https://stackoverflow.com/questions/44671841/cant-find-project-or-library-reference-with-filesystemobject-with-excel-vba-on/44672789#44672789", "title": "Can&#39;t find project or library, reference with FileSystemObject with Excel VBA on Mac", "body": "<p>You can use a combination of <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/compiler-constants\" rel=\"nofollow noreferrer\">compiler constants</a> and <a href=\"https://superuser.com/questions/615463/how-to-avoid-references-in-vba-early-binding-vs-late-binding\">late binding</a>.</p>\n\n<p>Function to check if you are on a Mac with compiler constant (credit to <a href=\"https://www.rondebruin.nl/mac/mac001.htm\" rel=\"nofollow noreferrer\">Ron de Bruin</a>)</p>\n\n<pre><code>Function IsMac() As Boolean\n#If Mac Then\n    IsMac = True\n#End If\nEnd Function\n</code></pre>\n\n<p>Code to control program flow:</p>\n\n<pre><code>Sub BezemResultaat()\n    If IsMac Then\n        MsgBox \"etc\"\n    Else\n        GetData\n    End If\nEnd Sub\n</code></pre>\n\n<p><code>GetData</code> sub:</p>\n\n<pre><code>Sub GetData()\n\n    Dim objFso As Object\n\n    Set objFso = CreateObject(\"Scripting.FileSystemObject\") '&lt;-- should not be a compile time error\n\n    ' do your stuff\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 44672789, "answer_count": 1, "score": 1, "last_activity_date": 1593677305, "creation_date": 1498036746, "last_edit_date": 1593677305, "question_id": 44671841, "link": "https://stackoverflow.com/questions/44671841/cant-find-project-or-library-reference-with-filesystemobject-with-excel-vba-on", "title": "Can&#39;t find project or library, reference with FileSystemObject with Excel VBA on Mac", "body": "<p>In code that I have I reference the Microsoft Scripting Runtime library, to make use of the <code>FileSystemObject</code>. Of course this won't work on a Mac. Therefore my first sub is to determine what OS the machine the code is being executed on is running, and to stop execution when this is a Mac:</p>\n\n<pre><code>Sub BezemResultaat()\n    If Left(Application.OperatingSystem, 3) = \"Mac\" Then\n        fout = MsgBox(\"Deze macro werkt alleen op een windows PC vooralsnog.\", vbOKOnly, \"Fout!\")\n        If fout = vbYes Then\n            Exit Sub\n        End If\n    Else\n        Call GetData\n    End If\nEnd Sub\n</code></pre>\n\n<p>In the <code>GetData</code> sub I reference to the FSO. I thought this would work, but on a Mac this errors out due to a missing library. </p>\n\n<p>Is there a different approach to accomplish this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5375390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be65a9efab1ebfbe8ea6876b7d7f8fd8?s=128&d=identicon&r=PG&f=1", "display_name": "OlaOkland", "link": "https://stackoverflow.com/users/5375390/olaokland"}, "edited": false, "score": 0, "creation_date": 1498038783, "post_id": 44671968, "comment_id": 76329500, "body": "Thank you for the response tevlyn :)"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1498037053, "creation_date": 1498037053, "answer_id": 44671968, "question_id": 44671652, "link": "https://stackoverflow.com/questions/44671652/cell-reference-for-workbook-that-changes-name-every-month/44671968#44671968", "title": "Cell reference for workbook that changes name every month", "body": "<p>This is more an issue of data architecture than Excel formulas.</p>\n\n<p>Create the links to a book that is called \"CurrentMonth.xlsx\".</p>\n\n<p>Then use a procedure that takes the January file and saves it as a file called \"CurrentMonth.xlsx\". This can be achieved with Powershell.</p>\n\n<p>Next month, you'll get the February file, create a copy and overwrite/rename it to \"CurrentMonth.xlsx\".</p>\n\n<p>Something like this can be arranged with Powershell or with VBA.</p>\n\n<p>The basic idea here is that you don't change the name of the lookup file, so you don't have to change the formula in the Excel workbook. Rather, use tools at the operating system layer that ensure that the file that the Excel formulas point to is always called the same and is replaced with current data on your schedule.</p>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1498044108, "post_id": 44674681, "comment_id": 76333238, "body": "teylyn&#39;s answer is the more robust and recommendable solution, but it is technically doable this way also."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1498044027, "creation_date": 1498044027, "answer_id": 44674681, "question_id": 44671652, "link": "https://stackoverflow.com/questions/44671652/cell-reference-for-workbook-that-changes-name-every-month/44674681#44674681", "title": "Cell reference for workbook that changes name every month", "body": "<p>Place this code in the <code>ThisWorkbook</code> module and save the workbook with macros enabled (<code>.xlsm</code>):</p>\n\n<pre><code>Private Sub Workbook_Open()\n    ' Change the worksheet to whichever one you need\n    Worksheets(1).Range(\"D5\").Formula = \"='[\" &amp; WorksheetFunction.Proper(MonthName(Month(Now()))) &amp; \".Book1.xlsx]Sheet1'!$D$5\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 5375390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/be65a9efab1ebfbe8ea6876b7d7f8fd8?s=128&d=identicon&r=PG&f=1", "display_name": "OlaOkland", "link": "https://stackoverflow.com/users/5375390/olaokland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 44674681, "answer_count": 2, "score": 1, "last_activity_date": 1498044027, "creation_date": 1498036252, "last_edit_date": 1531161705, "question_id": 44671652, "link": "https://stackoverflow.com/questions/44671652/cell-reference-for-workbook-that-changes-name-every-month", "title": "Cell reference for workbook that changes name every month", "body": "<p>I have a cell D5 that is linked to another workbook with the formula [January.Book1.xlsx]Sheet1!$D$5.</p>\n\n<p>The problem is that the January.Book1.xlsx is called February.Book1.xlsx with updated numbers the next month. However , Its located in the same folder and the structure is the same. </p>\n\n<p>Is there an easy way to make this cell reference automatic to the Sheet1!$D$5 for the latest workbook and updates for each months as time passes?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 543, "user_id": 4647316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24818633aaf7552291e746fde14bd95?s=128&d=identicon&r=PG&f=1", "display_name": "Zalomon", "link": "https://stackoverflow.com/users/4647316/zalomon"}, "is_accepted": false, "score": 1, "last_activity_date": 1498036754, "creation_date": 1498036754, "answer_id": 44671846, "question_id": 44671463, "link": "https://stackoverflow.com/questions/44671463/get-string-between-2-strings-and-the-end-of-the-parent-string/44671846#44671846", "title": "Get String between 2 strings, and the end of the parent string", "body": "<p>if you use regular expressions is quite easy to do, you can use this link as a reference <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n\n<p>You can user a regular expression such as \"ADDR(.*)XADDR\", this will give you the email address</p>\n"}, {"comments": [{"owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 0, "creation_date": 1498038430, "post_id": 44672191, "comment_id": 76329256, "body": "Thank you! one niggle, its left an X on the end of the email address string."}, {"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "reply_to_user": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 1, "creation_date": 1498038746, "post_id": 44672191, "comment_id": 76329466, "body": "@DigitalLightcraft Oops! I have un-niggled it."}, {"owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "edited": false, "score": 0, "creation_date": 1498038969, "post_id": 44672191, "comment_id": 76329630, "body": "Excellent, Thank you, got it working nicely, and also thenks for the 2nd option :-D"}], "tags": [], "owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "is_accepted": true, "score": 2, "last_activity_date": 1498038824, "last_edit_date": 1498038824, "creation_date": 1498037591, "answer_id": 44672191, "question_id": 44671463, "link": "https://stackoverflow.com/questions/44671463/get-string-between-2-strings-and-the-end-of-the-parent-string/44672191#44672191", "title": "Get String between 2 strings, and the end of the parent string", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">InStr</a> function to find where the second delimiter (\"XADDR\" in this case) starts, and the <a href=\"https://msdn.microsoft.com/en-us/library/05e63829(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Mid</a> function to extract the parts you want: </p>\n\n<pre><code>Sub InstrDemo()\n    Dim s, delim1, delim2 As String\n    s = \"ADDRjohnDOTdoeATfooDOTcomXADDRA646A10.FOO\"\n    delim1 = \"ADDR\"\n    delim2 = \"XADDR\"\n\n    Dim pos As Integer\n    pos = InStr(s, delim2)\n\n    Dim part1, part2 As String\n    part1 = Mid(s, Len(delim1) + 1, pos - Len(delim1) - 1)\n    part2 = Mid(s, pos + Len(delim2))\n\n    MsgBox (part1 &amp; vbCrLf &amp; part2)\n\nEnd Sub\n</code></pre>\n\n<p>Outputs:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9pvU6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9pvU6.png\" alt=\"enter image description here\"></a></p>\n\n<p>(I used Excel 2013 because it was easier at the time.)</p>\n\n<p>It's better to put the delimiters in as strings like that because it avoids the use of <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)#Unnamed_numerical_constants\" rel=\"nofollow noreferrer\">\"magic numbers\"</a>.</p>\n\n<hr>\n\n<p>Or you could use the <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Split</a> function:</p>\n\n<pre><code>Sub SplitDemo()\n    Dim s, delim1, delim2 As String\n    s = \"ADDRjohnDOTdoeATfooDOTcomXADDRA646A10.FOO\"\n    delim1 = \"ADDR\"\n    delim2 = \"XADDR\"\n\n    s = Mid(s, Len(delim1) + 1)\n    Dim parts() As String\n    parts = Split(s, delim2)\n\n    ' optional: check that the correct number of parts were found...\n    If UBound(parts) &lt;&gt; 1 Then\n        MsgBox (\"Wrong number of parts.\")\n    End If\n\n    MsgBox (parts(0) &amp; vbCrLf &amp; parts(1))\n\nEnd Sub\n</code></pre>\n\n<p>Which gives the same output as the previous method.</p>\n"}], "owner": {"reputation": 436, "user_id": 1410647, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/A7Lsp.jpg?s=128&g=1", "display_name": "Digital Lightcraft", "link": "https://stackoverflow.com/users/1410647/digital-lightcraft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 44672191, "answer_count": 2, "score": 0, "last_activity_date": 1593358014, "creation_date": 1498035685, "last_edit_date": 1593358014, "question_id": 44671463, "link": "https://stackoverflow.com/questions/44671463/get-string-between-2-strings-and-the-end-of-the-parent-string", "title": "Get String between 2 strings, and the end of the parent string", "body": "<p>I need to extract a string from between 2 delimiters, to be specific, I have had to attach an email address to an attachment file name so that it can be processed and sent back to the sender.\n(This is within Outlook 2013 VBA)</p>\n\n<p>The format of the file name is:\n<strong>ADDR</strong>johnDOTdoeATfooDOTcom<strong>XADDR</strong>A646A10.FOO</p>\n\n<p>My delimiters are <strong>ADDR</strong> and <strong>XADDR</strong></p>\n\n<p>What I need to do is split the string and return both the email string from between the delimiters and the file name after XADDR.</p>\n\n<p>Both the email address and the file name can vary in length, the file extension is not fixed.</p>\n\n<p>What is fixed is ADDR will always be the first 4 characters, and .XXX will be the last 3 characters.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1498035326, "post_id": 44671011, "comment_id": 76326937, "body": "Replace you mid with mid(cell(i, &quot;F&quot;).Value,instr(1,cell(i, &quot;F&quot;).Value,&quot;BE&quot;),2)"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1498036197, "post_id": 44671011, "comment_id": 76327597, "body": "in this line <code>If (Mid(cell(i, &quot;F&quot;).Value, 0, 2) &lt;&gt; &quot;BE&quot;) Then</code> replace <code>cell</code> with <code>Cells</code>"}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1498036974, "last_edit_date": 1498036974, "creation_date": 1498036543, "answer_id": 44671756, "question_id": 44671011, "link": "https://stackoverflow.com/questions/44671011/macro-for-removing-row-starting-with-other-than-be-in-the-column/44671756#44671756", "title": "Macro for removing row starting with other than &quot;BE&quot; in the column", "body": "<p>Try this..this code simple skip the row which has value start with <strong>BE</strong> in <strong>Column F</strong> </p>\n\n<p>Note: not tested </p>\n\n<pre><code>         Last = Cells(Rows.Count, \"H\").End(xlUp).Row\n        For i = Last To 1 Step -1\n        ' If Column F values starts with BE then skip the row\n            If Cells(i, \"F\").Value = \"BE*\" Then\n                GoTo nextline:\n            End If\n\n\n            If (Cells(i, \"H\").Value) &lt;&gt; \"SHARES\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Shares limited Partnership\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Shares Fractions\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Funds\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Certificates ADR\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Certificates\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Investment funds BE dividend\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Investment funds BE capitalization\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Pre-emptive right\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n            If (Cells(i, \"H\").Value) &lt;&gt; \"Mortgage certificates\" Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n\n\n\n    nextline:\n            Next i\n\n    ' This will clear dates which are not today\n\n       Last = Cells(Rows.Count, \"L\").End(xlUp).Row\n       For i = Last To 2 Step -1\n        If Cells(i, \"F\").Value = \"BE*\" Then\n            GoTo nextline1:\n        End If\n       If (Cells(i, \"L\").Value) &lt; Date Then\n                Cells(i, \"A\").EntireRow.Delete\n                End If\n    nextline1:\n       Next i\n\n       Last = Cells(Rows.Count, \"L\").End(xlUp).Row\n       For i = Last To 2 Step -1\n        If Cells(i, \"F\").Value = \"BE*\" Then\n            GoTo nextline2:\n        End If\n\n        If (Cells(i, \"L\").Value) &gt; Date Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    nextline2:\n       Next i\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8183084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207853034438731/picture?type=large", "display_name": "Marek Klu\u010dka", "link": "https://stackoverflow.com/users/8183084/marek-klu%c4%8dka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498036974, "creation_date": 1498034577, "last_edit_date": 1498035432, "question_id": 44671011, "link": "https://stackoverflow.com/questions/44671011/macro-for-removing-row-starting-with-other-than-be-in-the-column", "title": "Macro for removing row starting with other than &quot;BE&quot; in the column", "body": "<p>I have written basic Excel macro for filtering data which kinda worked OK. But I struggle with deleting rows, if column F does not start with \"BE\". In column F there are ISINs for commercial papers and first two letter are country code, followed by few numbers. There is also header. \nIf you are interested, here is the procedure for what the macro should do:</p>\n\n<ol>\n<li>Delete row 1 and 2</li>\n<li>Sort by Pay date (PD): (oldest to newest) </li>\n<li>Withhold the events (rows) with specific pay date (column L)</li>\n<li>Withhold in column H everything that are not these:\n\n<ul>\n<li>Shares        </li>\n<li>Shares limited Partnership        </li>\n<li>Shares Fractions      </li>\n<li>Funds         </li>\n<li>Certificates ADR      </li>\n<li>Certificates      </li>\n<li>Investment funds BE dividend      </li>\n<li>Investment funds BE capitalization        </li>\n<li>Pre-emptive right         </li>\n<li>Mortage certificates</li>\n</ul></li>\n<li>Sort by ISIN code: A to Z (column F)</li>\n<li>Withhold everything else than \"BE\" in column F</li>\n</ol>\n\n<p>My current code looks like this.</p>\n\n<pre><code>Sub Paycheck()\n\n'Delete first two rows\n        Rows(2).EntireRow.Delete\n        Rows(1).EntireRow.Delete\n\n' Restore screen updating and events\n        Application.ScreenUpdating = False\n        Application.EnableEvents = False\n\n' DELETES ALL ROWS FROM A2 DOWNWARDS WITH THE WORDs IN COLUMN H\n' USE THIS TO CLEAR CONTENTS BUT NOT DELETE ROW \"Cells(i, \"A\").EntireRow.ClearContents\"\n\n     Last = Cells(Rows.Count, \"H\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Cells(i, \"H\").Value) &lt;&gt; \"SHARES\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Shares limited Partnership\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Shares Fractions\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Funds\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Certificates ADR\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Certificates\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Investment funds BE dividend\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Investment funds BE capitalization\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Pre-emptive right\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        If (Cells(i, \"H\").Value) &lt;&gt; \"Mortgage certificates\" Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n\n' Deleting other than BE\n\n        If (Mid(cell(i, \"F\").Value, 0, 2) &lt;&gt; \"BE\") Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n        Next i\n\n' This will clear dates which are not today\n\n   Last = Cells(Rows.Count, \"L\").End(xlUp).Row\n   For i = Last To 2 Step -1\n   If (Cells(i, \"L\").Value) &lt; Date Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n   Next i\n\n   Last = Cells(Rows.Count, \"L\").End(xlUp).Row\n   For i = Last To 2 Step -1\n   If (Cells(i, \"L\").Value) &gt; Date Then\n            Cells(i, \"A\").EntireRow.Delete\n            End If\n   Next i\n\n'Order the table ascending\n\n   Selection.AutoFilter\n    ActiveWorkbook.Worksheets(\"Events\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Events\").AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"F:F\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Events\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Selection.AutoFilter\n\n\nEnd Sub\n</code></pre>\n\n<p>As you can see approx in middle of the code, I tried to use basic \"if\" function with \"mid\". But I think I got it wrong (because it does not work). I even tried some other codes I have found (I am beginner and I am looking around internet for solutions).\nWhat I have tried or found and did not work. For example:</p>\n\n<pre><code>Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastRow As Long\n\n    Set ws = ActiveWorkbook.Sheets(\"Events\")\n\n    lastRow = ws.Range(\"F\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    Set rng = ws.Range(\"F1:F\" &amp; lastRow)\n\n    ' filter and delete all but header row\n    With rng\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;*BE*\"\n        .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n\n    ' turn off the filters\n    ws.AutoFilterMode = False\n</code></pre>\n\n<p>I also found some loop code, which also did not worked (and took a lot of time, we are talking about thousands of rows I need to filter). Currently I am in situation when even the code that worked before, does not work anymore (because I somewhere fucked up) so I would really like your advice, how to make this work according to the procedure mentioned above.\nI would be very grateful!\nThank you for your time</p>\n"}, {"tags": ["vba", "ms-access", "ms-word", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 854762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Qe6Rt.jpg?s=128&g=1", "display_name": "The All Powerful", "link": "https://stackoverflow.com/users/854762/the-all-powerful"}, "edited": false, "score": 0, "creation_date": 1498050093, "post_id": 44672044, "comment_id": 76337801, "body": "I&#39;ve been trying various iterations of your code, but all I get is &quot;Error #5941 was generated by Microsoft Word. The requested member of the collection does not exist.&quot;  I&#39;ve tried changing the final part of the FormFields to a variety of different possibilities (Add, Application, Count, Creator, Item, Parent, Shaded are the allowable ones) but Word just doesn&#39;t seem keen to kick out any information about the fields and throws errors or doesn&#39;t tell me anything... I&#39;m guessing Word just doesn&#39;t like being asked uncomfortable questions about its form fields!  Thanks for trying though!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 102, "user_id": 854762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Qe6Rt.jpg?s=128&g=1", "display_name": "The All Powerful", "link": "https://stackoverflow.com/users/854762/the-all-powerful"}, "edited": false, "score": 0, "creation_date": 1498054800, "post_id": 44672044, "comment_id": 76341537, "body": "OK, I <i>have</i> worked with Form fields (I knew that screen shot looked familiar). I didn&#39;t use the Document.FormFields collection, but addressed them directly via their bookmark. But if I open a document containing such fields, my code works fine. Which part exactly doesn&#39;t work for you? @TheAllPowerful"}, {"owner": {"reputation": 102, "user_id": 854762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Qe6Rt.jpg?s=128&g=1", "display_name": "The All Powerful", "link": "https://stackoverflow.com/users/854762/the-all-powerful"}, "edited": false, "score": 0, "creation_date": 1498146212, "post_id": 44672044, "comment_id": 76390863, "body": "Problem was between my keyboard and my chair! I hadn&#39;t used the ctrl+g direct window before, and was expecting a debug report to pop up! My bad! As soon as I did that it all blazed into life, and I got the indexes all popped up for me! Thanks for your help! :-)"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1498055065, "last_edit_date": 1498055065, "creation_date": 1498037232, "answer_id": 44672044, "question_id": 44670877, "link": "https://stackoverflow.com/questions/44670877/microsoft-access-vba-importing-data-from-an-unnamed-word-form-field/44672044#44672044", "title": "Microsoft Access VBA - Importing data from an unnamed Word Form Field", "body": "<p>Like other collections of objects, you can address them either by name (as you do for the other fields) or by numeric index.</p>\n\n<pre><code>For i = 1 To doc.FormFields.Count\n    Debug.Print i, doc.FormFields(i).Result\nNext i\n</code></pre>\n\n<p>This should give you the index of the field, if you know its content.</p>\n\n<p>Then use <code>!the_answer = doc.FormFields(42).Result</code> in your code. (42 is an example!)</p>\n\n<p>Edit: minimal working example (running in Access):</p>\n\n<pre><code>Public Sub TestWord()\n\n    Dim oWord As Word.Application\n    Dim oDoc As Word.Document\n    Dim i As Long\n\n    Set oWord = CreateObject(\"Word.Application\")\n    Set oDoc = oWord.Documents.Open(\"C:\\Users\\foobar\\Documents\\Dok1.docx\")\n    oWord.Visible = True\n\n    For i = 1 To oDoc.FormFields.Count\n        Debug.Print i, oDoc.FormFields(i).Name, oDoc.FormFields(i).Result\n    Next i\n\n    oDoc.Close\n    oWord.Quit\n\nEnd Sub\n</code></pre>\n\n<p>The direct window (Ctrl+g) lists all form fields with their index, name = bookmark, and default text.</p>\n"}], "owner": {"reputation": 102, "user_id": 854762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Qe6Rt.jpg?s=128&g=1", "display_name": "The All Powerful", "link": "https://stackoverflow.com/users/854762/the-all-powerful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 44672044, "answer_count": 1, "score": 0, "last_activity_date": 1593816364, "creation_date": 1498034218, "last_edit_date": 1593816364, "question_id": 44670877, "link": "https://stackoverflow.com/questions/44670877/microsoft-access-vba-importing-data-from-an-unnamed-word-form-field", "title": "Microsoft Access VBA - Importing data from an unnamed Word Form Field", "body": "<p>I have been tasked with importing the contents of a Microsoft Word Form into my Access database. It's working fine using the following VBA code which is triggered from a form:</p>\n\n<pre><code>Private Sub cmdFileDialog_Click()\n  On Error GoTo ErrorHandler\n    Dim objDialog As Object\n    Dim varFile As Variant\n    Dim rec, rec2 As Recordset\n    Dim db As Database\n\n    'New Word Document Variables\n    Dim appWord As Word.Application\n    Dim doc As Word.Document\n\n    Const DEST_TABLE = \"ap_behaviour_referrals\" 'change to suit\n    Const PATH_DELIM = \"\\\"\n\n    Set objDialog = Application.FileDialog(3)\n    ' Clear listbox contents.\n    Me.fileList.RowSource = \"\"\n\nWith objDialog\n    .AllowMultiSelect = False\n    ' Set the title of the dialog box.\n    .Title = \"Please select a behaviour referral to import\"\n    ' Clear out the current filters, and add our own.\n      .Filters.Clear\n      .Filters.Add \"Microsoft Word Forms\", \"*.docx\"\n      .Filters.Add \"All Files\", \"*.*\"\n    .Show\n    If .SelectedItems.Count = 0 Then\n        MsgBox \"No file selected.\"\n    Else\n        For Each varFile In .SelectedItems\n            'New docx Variable Actions\n            Set appWord = GetObject(, \"Word.Application\")\n            Set doc = appWord.Documents.Open(varFile)\n\n        Next\n\n        Set db = CurrentDb\n        Set rec = db.OpenRecordset(DEST_TABLE)\n\n        With rec\n            .AddNew\n            ' my data\n            'preformat the date fields from the form\n            Dim unformattedpupildob As String\n            Dim formattedpupildob As Date\n            unformattedpupildob = doc.FormFields(\"Text2\").Result\n            unformattedpupildob = Replace(unformattedpupildob, \".\", \"/\")\n            formattedpupildob = Format(unformattedpupildob, \"dd/mm/yy\")\n            'And now insert the record into the table\n            !pupil_name = doc.FormFields(\"Text1\").Result\n            !pupil_dob = formattedpupildob\n            !pupil_yr_grp = doc.FormFields(\"Text3\").Result\n            !pupil_submitted_eth = doc.FormFields(\"Text4\").Result\n            !pupil_upn = doc.FormFields(\"Text5\").Result\n            !pupil_looked_after = doc.FormFields(\"Text6\").Result\n            !sen_pre_statement = doc.FormFields(\"Text7\").Result\n            !sen_ehcp = doc.FormFields(\"Text8\").Result\n            !cat_date_final_ehcp = doc.FormFields(\"Text9\").Result\n            !num_exclusion = doc.FormFields(\"Text10\").Result\n            !days_exclusion = doc.FormFields(\"Text11\").Result\n            !sch_name = doc.FormFields(\"Text12\").Result\n            !sch_no = doc.FormFields(\"Text14\").Result\n            !contact_name = doc.FormFields(\"Text13\").Result\n            !contact_role = doc.FormFields(\"Text40\").Result\n            !contact_email = doc.FormFields(\"Text31\").Result\n            .Update\n            .Close\n            MsgBox \"File Processing Complete\"\n        End With\n    End If\nEnd With\nSet objDialog = Nothing\nMe.fileList.RowSource = \"\"\nExitSub:\n    Set rec = Nothing\n    Set db = Nothing\n    '...and set it to nothing\n    Exit Sub\nErrorHandler:\n    If Err.Number &lt;&gt; 0 Then\n        Msg = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl() &amp; Chr(13) &amp; Err.Description\n        MsgBox Msg, , \"Error\", Err.HelpFile, Err.HelpContext\n    End If\n    Resume ExitSub\nEnd Sub\n</code></pre>\n\n<p>All but one of the fields are (badly) bookmarked so I can use this to grab the contents of the field HOWEVER, I've come across an unnamed form field:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ytozf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ytozf.jpg\" alt=\"Word Unnamed Form Field\"></a></p>\n\n<p>Which I need to import and I have no idea how to get the contents of it without a named bookmark.</p>\n\n<p>I have no ability to modify the form since it's controlled by somebody else and is widely distributed, but was wondering if there was any way to pull the contents of this field without it being named?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498034522, "post_id": 44670869, "comment_id": 76326361, "body": "have you reset wb once you have moved the file? It could be that the location has changed and then it would error."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498037959, "post_id": 44670869, "comment_id": 76328895, "body": "Hi Lowpar: Thank you for taking the time to respond. I am unsure of your comment though . I am not actually moving any files. the files never move from <code>folder = &quot;C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\Reject Macro\\Move Exceled\\&quot;</code> the files are EXP in this folder then the become XLS and then the CODE piece 2 loops through <code>folder = &quot;C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\Reject Macro\\Move Exceled\\&quot;</code> The files never actually move."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498121150, "post_id": 44675760, "comment_id": 76372002, "body": "Hi UGP. Thank you for taking the time respond. when i plugged your Code piece 2 into my macro I&#39;m afraid the rows and the columns still don&#39;t get created. and I still get the pop up Error 1 as seen above. keeping your given code in place i then made the change in Code piece 1 <code>Name folder &amp; filename As folder &amp; Left(filename, InStrRev(filename, &quot;.&quot;)) &amp; &quot;.xlsx&quot;</code> putting .xlsx instead of .xls with this in place I ran code piece 2 and I got Error 1 again but this time in the VBA editor debugger as the run time error 1004. Thanks for the help but its still not giving me what i want back :-("}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498125216, "post_id": 44675760, "comment_id": 76375004, "body": "Could you add a picture how a file looks after formatting to xlsx?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498125230, "post_id": 44675760, "comment_id": 76375015, "body": "I get both times Error 1004"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498126847, "post_id": 44675760, "comment_id": 76376224, "body": "Hi UGP. I added a pic of the formatting. as you can see the dilimination happens but not the row add or column add"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498127428, "post_id": 44675760, "comment_id": 76376654, "body": "HI UGP. I think the issue I am facing is that even though I have used code to turn and EXP file to XLS the file somehow still thinks its TXT as you can see in the pic STUCK AS TEXT i just added marked in blue at the top states xls circled in blue at bottom the dialog box it is text. its not fully transforming to xls?? is there something a miss in the code?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498127894, "post_id": 44675760, "comment_id": 76376952, "body": "Yes, renaming, does not really convert it properly. What you could do is rename to <code>.xls</code> and then open and save them as <code>.xlsx</code> then they will be real excel files."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498128573, "post_id": 44675760, "comment_id": 76377391, "body": "Yes I agree this is what I a have been attempting this morning but I am struggling with the code. Does this have to happen in Code piece 1 or 2?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498134125, "post_id": 44675760, "comment_id": 76381315, "body": "I tried but didnt really work. File is still corrupted."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498137140, "post_id": 44675760, "comment_id": 76383639, "body": "I know Its a real brain buster :-) I did mange a kind of ugly way around. With a different loop code. This does save the Excels as Excels but it creates brand new Excel Workbooks it doesn&#39;t actually turn the originals into actual Excel Workbooks. It will have to do. I have put the new code under the last pic if you wish to have a look. And thank you again for the help it is greatly appreciated."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1498137722, "post_id": 44675760, "comment_id": 76384090, "body": "Thats seems to be the only workaround. But i would not use ActiveWorkbook for both files you open and adress the sheet directly to minimize possible errors as you see in my code. Also the <code>with wb</code> does not do anything, there are no methods that use wb. Keep that in mind."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1498047069, "creation_date": 1498047069, "answer_id": 44675760, "question_id": 44670869, "link": "https://stackoverflow.com/questions/44670869/vba-exp-file-transformed-to-excel-file-not-allowing-code-to-work/44675760#44675760", "title": "VBA EXP file transformed to Excel file not allowing code to work", "body": "<p>You should save the Workbooks in CODE Piece 1 as <code>.xlsx</code> instead of <code>.xls</code> (Win2003 Format). Also its enough to say <code>myExtension = \"*.xl*\"</code> for Excel Files. Your problem is when opening workbooks, that you dont address then worksheet correctly. Also what does <code>DoEvents</code> do? Its probably not necessary.</p>\n\n<p>Code Piece 2 should look like this: </p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim wb As Workbook\nDim myPath As String: myPath = \"\"\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim rng As Range\nDim sht As Worksheet\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xl*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(myPath &amp; myFile)\n      Set sht = wb.Worksheets(1) 'First Sheet (adjust if needed)\n\n    'Ensure Workbook has opened before moving on to next line of code\n      DoEvents\n\n    'Change First Worksheet's Background Fill Blue\n\n      Set rng = sht.Range(\"A:A\")\n\n      rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, _\n        OtherChar:=\"|\"\n\n        With sht\n            .Range(\"A1\").EntireRow.Insert\n            .Range(\"A:E\").EntireColumn.Insert\n        End With\n\n\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498137237, "creation_date": 1498034194, "last_edit_date": 1498137237, "question_id": 44670869, "link": "https://stackoverflow.com/questions/44670869/vba-exp-file-transformed-to-excel-file-not-allowing-code-to-work", "title": "VBA EXP file transformed to Excel file not allowing code to work", "body": "<p>I hope you can help. The issue I am facing is this I have two pieces of code the first piece takes EXP files stored in a folder and transforms them into Excel files \"xls\" this piece of code is labelled CODE Piece 1 below. </p>\n\n<p>This piece of code seems to work fine. </p>\n\n<p>The second piece of code labelled CODE Piece 2 below. Allows a user to navigate to a folder select this folder then the code loops through all the files in this folder and deliminates the Excel files with | and then it should add new rows and columns. The issue is that the files deliminate no problem but the adding of rows and columns does not happen. </p>\n\n<p>The odd thing is if I run this macro on workbooks that have <strong>not</strong> been through CODE Piece 1, Everything works fine the row and columns add. </p>\n\n<p>But even if take out the deliminating part of the code and just just tell the macro to added the row and the columns and i run it on the files that have been transformed by CODE piece 1 again nothing. I don't get any errors, the macro runs but nothing happens. </p>\n\n<p>If I even turn on the screen updating applications and I can see the macro doing its thing, adding the row and columns and saving the document but when I went to open the file back up i got the an error pop up (see error 1 below) once i clicked 'Yes' on the pop up the file would open but no added row or columns </p>\n\n<p>I am at a loss as to how to solve this issue. I believe my coding is good but Ia m not getting the result I want. Can someone please advise. </p>\n\n<p>As always any and all help is welcome.    </p>\n\n<p>CODE Piece 1 </p>\n\n<pre><code>Public Sub Loop_Rename_Files_in_Folder()\n\n    Dim folder As String\n    Dim filename As String\n\n    folder = \"C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\Reject Macro\\Move Exceled\\\"               'MODIFY THIS LINE - FOLDER CONTAINING FILES TO BE RENAMED\n\n    If Right(folder, 1) &lt;&gt; \"\\\" Then folder = folder &amp; \"\\\"\n    filename = Dir(folder &amp; \"*.exp\")\n    Do While filename &lt;&gt; vbNullString\n        Name folder &amp; filename As folder &amp; Left(filename, InStrRev(filename, \".\")) &amp; \"xls\"\n        filename = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>CODE Piece 2 </p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim rng As Range\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xl??*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(filename:=myPath &amp; myFile)\n\n    'Ensure Workbook has opened before moving on to next line of code\n      DoEvents\n\n    'Change First Worksheet's Background Fill Blue\n      With wb\n      Set rng = Range(\"A:A\")\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, _\n        OtherChar:=\"|\"\n        Range(\"A1\").EntireRow.Insert\n        Range(\"A:E\").EntireColumn.Insert\n\n      End With\n\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Error 1 \n<a href=\"https://i.stack.imgur.com/dxLkP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dxLkP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formatted\n<a href=\"https://i.stack.imgur.com/qZb55.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qZb55.png\" alt=\"enter image description here\"></a></p>\n\n<p>STUCK AS TXT </p>\n\n<p><a href=\"https://i.stack.imgur.com/3aZN5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3aZN5.png\" alt=\"enter image description here\"></a></p>\n\n<p>CODE that saves as new Workbook but leaves the corrupted Originals as is </p>\n\n<p>CODE Piece 3 </p>\n\n<pre><code>Sub OpenFiles()\n'UpdateByExtendoffice20160623\n    Dim xStrPath As String\n    Dim xFileDialog As FileDialog\n    Dim xFile As String\n    Dim wb As Workbook\n\n    Set wb = ActiveWorkbook\n\n    'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n    On Error Resume Next\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    xFileDialog.AllowMultiSelect = False\n    xFileDialog.Title = \"C:\\Users\\CONNELLP\\Desktop\\GAP Reports\\\"\n    If xFileDialog.Show = -1 Then\n        xStrPath = xFileDialog.SelectedItems(1)\n\n\n\n    End If\n    If xStrPath = \"\" Then Exit Sub\n    xFile = Dir(xStrPath &amp; \"\\*.xl??\")\n    Do While xFile &lt;&gt; \"\"\n        Workbooks.Open xStrPath &amp; \"\\\" &amp; xFile\n    With wb\n      Set rng = Range(\"A:A\")\n\n    rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, _\n        OtherChar:=\"|\"\n        Range(\"A1\").EntireRow.Insert\n        Range(\"A:E\").EntireColumn.Insert\n        Range(\"A1\").Value = \"Source File\"\n        Range(\"B1\").Value = \"Reason\"\n        Range(\"C1\").Value = \"Action\"\n        Range(\"D1\").Value = \"Team\"\n        Range(\"E1\").Value = \"Status\"\n\n\n        ActiveWorkbook.SaveAs FileFormat:=xlExcel8, Password:=\"\", WriteResPassword:=\"\", _\n        ReadOnlyRecommended:=False, CreateBackup:=False\n      ActiveWorkbook.Close\n      End With\n        xFile = Dir\n\n    Loop\n\n      'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498034236, "post_id": 44670689, "comment_id": 76326154, "body": "Is it the ws2 change firing it?  You could move your code into the Workbook one and use the sheetname variable passed in to determine whether to run the above.  Something like <code>ws2.cells(lastline,target.column).value=target.value</code> may be simpler to."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 1, "creation_date": 1498034432, "post_id": 44670689, "comment_id": 76326290, "body": "All you have really written here is your self diagnosis of &quot;weird behaviour&quot;. If you gave us all the relevant code, like what you&#39;re actually doing in sheet 1 etc, we might be able to help. Events is an application wide parameter, so I don&#39;t know why you say you have it &quot;disabled on your <i>first worksheet</i>&quot;? Please make this a bit clearer"}, {"owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 0, "creation_date": 1498036131, "post_id": 44670689, "comment_id": 76327539, "body": "It&#39;s simple : I have only one workbook. In this workbook, I have 34 worksheets. On the first one, i&#39;m performing some computations, and then, i&#39;m pasting those results on the 33 other sheets. The problem is I have one <code>Workbook_SheetChange</code> event which is reacting to this paste. I don&#39;t know why, because before pasting, i&#39;m doing this : <code>Application.EnableEvents = False</code> . I don&#39;t want the <code>Workbook_SheetChange</code> event to be launch. If you know why..."}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "edited": false, "score": 0, "creation_date": 1498122109, "post_id": 44686467, "comment_id": 76372745, "body": "Thanks. It helps me a lot."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1498079990, "creation_date": 1498079990, "answer_id": 44686467, "question_id": 44670689, "link": "https://stackoverflow.com/questions/44670689/bypass-the-workbook-sheetchange-event/44686467#44686467", "title": "Bypass the Workbook_SheetChange event", "body": "<p>You can work this problem without necessarily disabling events if you use a global flag to indicate what kind of processing is happening.</p>\n\n<p>It's not entirely clear from your design description why you need to handle both <code>Worksheet_Change</code> events and <code>Workbook_SheetChange</code> events. But a good understanding of when each event will fire certainly helps. In your case, if you change a cell on Sheet1 you'll get a <code>Worksheet_Change</code> event for Sheet1, then get a <code>Workbook_SheetChange</code> event. This will happen anytime you change ANY sheet.</p>\n\n<p>The example below illustrates how you can handle the processing to keep it all straight and not step on changes that you are making via VBA and changes made manually. There's multiple parts to the example, so follow along at home...</p>\n\n<p>First, we need to establish two <code>Public</code> things: a workbook-global flag and a workbook-global subroutine to perform your processing. So in a VBA code module (<code>Module1</code>), we have the following code:</p>\n\n<pre><code>'------ Module1 --------\nOption Explicit\n\nPublic MyCustomMacroInProgress As Boolean\n\nPublic Sub DistributeChangeToSheets()\n    Debug.Print \"Entering DistributeChangeToSheets... \"\n    MyCustomMacroInProgress = True\n    Debug.Print \"=== setting MyCustomMacroInProgress = \" &amp; MyCustomMacroInProgress\n\n    '--- loop to fire change events in the other worksheets for testing\n    Dim ws As Variant\n    For Each ws In ThisWorkbook.Sheets\n        If ws.Name &lt;&gt; \"Sheet1\" Then\n            ws.Range(\"A1\") = 1\n        End If\n    Next ws\n\n    MyCustomMacroInProgress = False\n    Debug.Print \"=== setting MyCustomMacroInProgress = \" &amp; MyCustomMacroInProgress\n    Debug.Print \"Leaving DistributeChangeToSheets\"\nEnd Sub\n</code></pre>\n\n<p>(Please note that using <code>Option Explicit</code> everywhere vastly helps your code.)</p>\n\n<p>By creating a public global flag (<code>MyCustomMacroInProgress</code>), you now have the ability to check this flag in any module and from any class and any worksheet. By creating the <code>Sub DistributeChangeToSheets</code> in the module and making it public, you can essentially apply this type of processing from any originating sheet you might want. My example only applies the change from Sheet1.</p>\n\n<p>So now to the main change catcher - Sheet1. In your code for Sheet1, I have</p>\n\n<pre><code>Option Explicit\n\n'--- in Sheet1\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Debug.Print \"In \" &amp; Target.Parent.Name;\n    Debug.Print \": Worksheet_Change event fired \";\n    Debug.Print \" - changed cell \" &amp; Target.Address\n\n    DistributeChangeToSheets\nEnd Sub\n</code></pre>\n\n<p>I'm printing <code>Debug</code> statements everywhere so it's easier to follow where the processing is going. You can see that in Sheet1, we're printing where we are and then calling the sub to <code>DistributeChangesToSheets</code> (from Module1).</p>\n\n<p>My example only has three worksheets, so the code in the other sheet modules is simple:</p>\n\n<pre><code>Option Explicit\n\n'--- in Sheet2\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Debug.Print \"In \" &amp; Target.Parent.Name;\n    Debug.Print \": Worksheet_Change event fired \";\n\n    If Not MyCustomMacroInProgress Then\n        Debug.Print \" - process change event normally\"\n    Else\n        Debug.Print \" - skip normal change event processing\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Option Explicit\n\n'--- in Sheet3\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Debug.Print \"In \" &amp; Target.Parent.Name;\n    Debug.Print \": Worksheet_Change event fired \";\n\n    If Not MyCustomMacroInProgress Then\n        Debug.Print \" - process change event normally\"\n    Else\n        Debug.Print \" - skip normal change event processing\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Putting this all together in the example now, type a value into any cell on Sheet1. The immediate window now shows the following output:</p>\n\n<blockquote>\n<pre><code>In Sheet1: Worksheet_Change event fired  - changed cell $B$2\nEntering DistributeChangeToSheets... \n=== setting MyCustomMacroInProgress = True\nIn Sheet2: Worksheet_Change event fired  - skip normal change event processing\nIn Sheet2: Workbook_SheetChange event fired  - skip normal change event processing\nIn Sheet3: Worksheet_Change event fired  - skip normal change event processing\nIn Sheet3: Workbook_SheetChange event fired  - skip normal change event processing\n=== setting MyCustomMacroInProgress = False\nLeaving DistributeChangeToSheets\nIn Sheet1: Workbook_SheetChange event fired  - process change event normally\n</code></pre>\n</blockquote>\n\n<p>From the output, you can see the sheet and workbook events all follow the pattern of events -- so you get two events when a worksheet is changed (<code>Worksheet_Change</code> and <code>Workbook_SheetChange</code>). By setting your global flag on Sheet1 (from inside <code>DistributeChangeToSheets</code>), by using an <code>If</code> statement you can inhibit change processing on all the other sheets during this kind of processing.</p>\n\n<p>It might involve a bit of re-coding on your part, but handling your events in an ordered manner can make the flow of the processing a bit clearer.</p>\n"}], "owner": {"reputation": 178, "user_id": 8013180, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cee29fffd3a2bfac21056f92777cd5ce?s=128&d=identicon&r=PG&f=1", "display_name": "Clement B", "link": "https://stackoverflow.com/users/8013180/clement-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "accepted_answer_id": 44686467, "answer_count": 1, "score": 2, "last_activity_date": 1498079990, "creation_date": 1498033641, "last_edit_date": 1531164843, "question_id": 44670689, "link": "https://stackoverflow.com/questions/44670689/bypass-the-workbook-sheetchange-event", "title": "Bypass the Workbook_SheetChange event", "body": "<p>I don't know why, and this is quite strange, but my code is looping. Indeed, in a first sheet (ws1), i'm doing this on a <code>Worksheet_Change</code> event : </p>\n\n<pre><code>Application.EnableEvents = False\nws2.Range(Col_Letter(target.Column) &amp; LastLine &amp; \":\" &amp; Col_Letter(target.Column) &amp; LastLine ).PasteSpecial Paste:=xlPasteValues\nApplication.EnableEvents = True\n</code></pre>\n\n<p>Moreover, I have, on the <code>ThisWorkbook</code> \"class\", a <code>Workbook_SheetChange</code> event.</p>\n\n<p>On the code above, I'm modifying a Cell. <strong>The problem is</strong> I don't know why it's calling the <code>Workbook_SheetChange</code> event, because I've already disabled the Events on my first worksheet. </p>\n\n<p>Because of that, it's looping, because on my <code>Workbook_SheetChange</code> event i'm modifying the Worksheet1. And then, the Worksheet1 is modifying the second one, .... infinite loop.</p>\n\n<p><strong>I don't know</strong> why <code>Application.EnableEvents = False</code> isn't working (indeed, if I do Debug.Print(Application.EnableEvents) on the <code>Workbook_SheetChange</code> event, it's saying \"True\" which is quite upset.)</p>\n\n<p>Thanks,\nClement</p>\n"}, {"tags": ["asp.net", "windows", "excel", "excel-web-query", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498033674, "post_id": 44670374, "comment_id": 76325752, "body": "What happens with existing webqueries?"}, {"owner": {"reputation": 87, "user_id": 2633379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e09090d709b30976883148c11bf14b2?s=128&d=identicon&r=PG&f=1", "display_name": "Arvind S", "link": "https://stackoverflow.com/users/2633379/arvind-s"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498035665, "post_id": 44670374, "comment_id": 76327191, "body": "I have now found the cause is an office update (1705) and not a windows update. The existing web queries -&gt; the .adjustcolumnwidth param is completely ignored. Column widths get adjusted no matter what, and if the html contains &lt;span&gt; the text does not get saved the the DB. Also, border formatting of tables are lost. &lt;br/&gt; is not recognized and Excel does not create a new empty row for the br tag anymore."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498048639, "post_id": 44670374, "comment_id": 76336659, "body": "Good catch. I think it is a good idea to report this problem at this page: <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel?auth=1\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a> it is where MSFT support looks for bug reports by customers."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498119476, "post_id": 44670374, "comment_id": 76370853, "body": "I have reported the problem to the Excel team, they will look into this."}, {"owner": {"reputation": 87, "user_id": 2633379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e09090d709b30976883148c11bf14b2?s=128&d=identicon&r=PG&f=1", "display_name": "Arvind S", "link": "https://stackoverflow.com/users/2633379/arvind-s"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498205162, "post_id": 44670374, "comment_id": 76414649, "body": "Thanks, I have, as well. Hopefully there will be some respose from Microsoft."}], "owner": {"reputation": 87, "user_id": 2633379, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0e09090d709b30976883148c11bf14b2?s=128&d=identicon&r=PG&f=1", "display_name": "Arvind S", "link": "https://stackoverflow.com/users/2633379/arvind-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498058924, "creation_date": 1498032685, "last_edit_date": 1531161705, "question_id": 44670374, "link": "https://stackoverflow.com/questions/44670374/excel-webquery-malformed-after-office-update-version-1705", "title": "Excel WebQuery malformed after Office update (Version 1705)", "body": "<p>The excel workbook (populated by webqueries using VBA) , which , I have been using for more than a year now has suddenly lost many formatting and some data.</p>\n\n<p>Upon debugging, I find that when the HTML has a  tag, the data is not saved to Excel anymore. I removed the  tag in the HTML by replacing  with  and it works. However, other aspects of the webquery like .AdjustColumnWidth = False are being ignored.</p>\n\n<p>Any idea on fixes if any?</p>\n\n<p>I am using Windows 7, Office 365 Excel. The file works absolutely fine on machines that did not receive a Office update recently.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498032144, "post_id": 44670120, "comment_id": 76324816, "body": "can you show your code also, as there are a couple of ways of approaching it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498032582, "post_id": 44670120, "comment_id": 76325061, "body": "If it is not conditionally formatted then you do not need VBA for this :). You may want to try <a href=\"https://stackoverflow.com/questions/20489472/how-to-count-cells-in-a-range-with-a-value-less-than-another-cell-in-excel/20491479#20491479\">This</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498032820, "post_id": 44670120, "comment_id": 76325193, "body": "If you still want to use Loops then see <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/control-flow/loop-structures\" rel=\"nofollow noreferrer\">This</a>"}], "answers": [{"tags": [], "owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "is_accepted": false, "score": 0, "last_activity_date": 1498032502, "creation_date": 1498032502, "answer_id": 44670305, "question_id": 44670120, "link": "https://stackoverflow.com/questions/44670120/how-to-loop-through-every-cell-in-selected-columns-in-vba-and-excel/44670305#44670305", "title": "How to loop through every cell in selected columns in VBA and Excel?", "body": "<p>For Next loop</p>\n\n<pre><code>For c = 15 to 17 'check the column num\n    For r = 3 to 30 'assuming your last row is 30\n       'color check code here\n    next r\nnext c\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2429, "user_id": 2987273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8n3Mc.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2987273/alexander"}, "edited": false, "score": 3, "creation_date": 1498033385, "post_id": 44670440, "comment_id": 76325550, "body": "please also add some text to your answer - not just a code block"}, {"owner": {"reputation": 1, "user_id": 6810063, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ma_NxDmYAlE/AAAAAAAAAAI/AAAAAAAAM94/egfY02Gf28I/photo.jpg?sz=128", "display_name": "Benjamin Houot", "link": "https://stackoverflow.com/users/6810063/benjamin-houot"}, "reply_to_user": {"reputation": 2429, "user_id": 2987273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8n3Mc.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2987273/alexander"}, "edited": false, "score": 0, "creation_date": 1498033671, "post_id": 44670440, "comment_id": 76325748, "body": "It is the first time I answer a question, i try to format my code. but can&#39;t find find how to make it pretty..."}, {"owner": {"reputation": 2429, "user_id": 2987273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8n3Mc.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2987273/alexander"}, "edited": false, "score": 0, "creation_date": 1498034128, "post_id": 44670440, "comment_id": 76326068, "body": "just indent the code with 4 spaces and separate it from the text-only with one empty line. No &lt;code&gt; tags needed"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 1, "creation_date": 1498034930, "post_id": 44670440, "comment_id": 76326657, "body": "Even with the <a href=\"https://meta.stackexchange.com/questions/22186/how-do-i-format-my-code-blocks\">code formatting improvements</a>, you are missing 2 things. <b>1.</b> comments to go with your code, please elaborate on what the various lines do, what your code does overall, any references to source material which might also help.  <b>2.</b> the code isn&#39;t valid VBA because of the way you have structured the blank spaces. Consider using actual variables instead of question marks, so the code may need <i>tweaking</i> but the reader doesn&#39;t have to think &quot;What do all these invalid characters mean?&quot;"}, {"owner": {"reputation": 1, "user_id": 6810063, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ma_NxDmYAlE/AAAAAAAAAAI/AAAAAAAAM94/egfY02Gf28I/photo.jpg?sz=128", "display_name": "Benjamin Houot", "link": "https://stackoverflow.com/users/6810063/benjamin-houot"}, "edited": false, "score": 0, "creation_date": 1498036965, "post_id": 44670440, "comment_id": 76328147, "body": "Ok thank you for the answers, i will imrove my future answers :)"}, {"owner": {"reputation": 7357, "user_id": 1271898, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ORL1M.png?s=128&g=1", "display_name": "WonderWorker", "link": "https://stackoverflow.com/users/1271898/wonderworker"}, "edited": false, "score": 0, "creation_date": 1498125108, "post_id": 44670440, "comment_id": 76374922, "body": "@Benjamin Houot This post could be edited to provide a correct answer. I recommend that you begin by removing the <code>?</code> and <code>&#39; enter code here</code>, and then think about how you would turn the code into a method that returns a string of the form <code>&quot;Day &quot; + DayNumber + &quot; has &quot; + PurpleCount + &quot; purple and &quot; + GreenCount + &quot; green&quot;</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 6810063, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ma_NxDmYAlE/AAAAAAAAAAI/AAAAAAAAM94/egfY02Gf28I/photo.jpg?sz=128", "display_name": "Benjamin Houot", "link": "https://stackoverflow.com/users/6810063/benjamin-houot"}, "is_accepted": false, "score": -3, "last_activity_date": 1498041157, "last_edit_date": 1498041157, "creation_date": 1498032899, "answer_id": 44670440, "question_id": 44670120, "link": "https://stackoverflow.com/questions/44670120/how-to-loop-through-every-cell-in-selected-columns-in-vba-and-excel/44670440#44670440", "title": "How to loop through every cell in selected columns in VBA and Excel?", "body": "<pre><code>Dim Cell as Range\nFor Each Cell in Selection \n    If cell.row = ? Then ' enter code here\n    If cell.Column = ? Then ? = Cell.Interior.Color\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1498033659, "creation_date": 1498033659, "answer_id": 44670697, "question_id": 44670120, "link": "https://stackoverflow.com/questions/44670120/how-to-loop-through-every-cell-in-selected-columns-in-vba-and-excel/44670697#44670697", "title": "How to loop through every cell in selected columns in VBA and Excel?", "body": "<p>You can also use <code>findformat</code> looped on the complete column, to create a counter, doing the colour checking and the counting.</p>\n\n<p>for example, something along these lines.</p>\n\n<pre><code>With Application.FindFormat.Interior\n     .color=vbRed\nend with\n\nset r=range(\"c3:c30\").find(what:=\"*\", searchformat:=True)\n</code></pre>\n\n<p>Then loop until r is nothing, incrementing a counter.  When looping <code>r=range(\"c3:c30\").find(what:=\"*\", after:=r, searchformat:=True)</code></p>\n\n<p>Thanks.</p>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1498035731, "post_id": 44671358, "comment_id": 76327235, "body": "You should <b>1.</b> Use <code>Dim c As Range, r As Range</code> at the beginning, enabling <code>Option Explicit</code> would have reminded you that you missed this. <b>2.</b> There is no reason to use <code>Integer</code> instead of <code>Long</code> [ <a href=\"https://stackoverflow.com/a/26409520/3978545\">link</a> ]"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1498036071, "post_id": 44671358, "comment_id": 76327488, "body": "Valid points :) The code wasn&#39;t meant to be &quot;production-grade&quot; so much as a rudimentary solution to OP&#39;s challenge, so I hope my laziness isn&#39;t too much of a detriment."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1498036974, "post_id": 44671358, "comment_id": 76328154, "body": "I upvoted because it was the neatest soln. here, just saying for the OP&#39;s benefit as much as yours :)"}, {"owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "edited": false, "score": 0, "creation_date": 1498038450, "post_id": 44671358, "comment_id": 76329272, "body": "Thank you, this answers my question!"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 3, "last_activity_date": 1498037650, "last_edit_date": 1498037650, "creation_date": 1498035428, "answer_id": 44671358, "question_id": 44670120, "link": "https://stackoverflow.com/questions/44670120/how-to-loop-through-every-cell-in-selected-columns-in-vba-and-excel/44671358#44671358", "title": "How to loop through every cell in selected columns in VBA and Excel?", "body": "<pre><code>Sub test()\n    Dim purpleCounter As Long, greenCounter As Long\n    Dim c As Range, r As Range\n\n    ' For each column in the selected area\n    For Each c In Selection.Columns\n        ' Reset the color counters\n        purpleCounter = 0\n        greenCounter = 0\n\n        ' For each row (=cell) in the column we're working on cf. the previous loop\n        For Each r In c.Rows\n            ' If color of the cell matches our value, increment the respective counter\n            If r.Interior.Color = 10498160 Then purpleCounter = purpleCounter + 1\n            If r.Interior.Color = 7658646 Then greenCounter = greenCounter + 1\n        Next r\n\n        ' Print the results to the Immediate window - or replace this section with whatever\n        Debug.Print \"Day \" &amp; c.Rows.Item(1).Value &amp; \" has \" &amp; purpleCounter &amp; _\n            \" purple and \" &amp; greenCounter &amp; \" green.\"\n    Next c\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uMIaM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uMIaM.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 739, "user_id": 4421382, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf1169dc3198dc684ba30b4b08d0bff9?s=128&d=identicon&r=PG&f=1", "display_name": "Engo", "link": "https://stackoverflow.com/users/4421382/engo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4275, "favorite_count": 0, "accepted_answer_id": 44671358, "answer_count": 4, "score": 1, "last_activity_date": 1498041157, "creation_date": 1498031926, "question_id": 44670120, "link": "https://stackoverflow.com/questions/44670120/how-to-loop-through-every-cell-in-selected-columns-in-vba-and-excel", "title": "How to loop through every cell in selected columns in VBA and Excel?", "body": "<p>I would like to count the colors for each day (column) in selection. How can I loop through every cell in the selected columns? I've already implemented the color check code. </p>\n\n<p><strong>Example:</strong></p>\n\n<p>Ouput:</p>\n\n<ul>\n<li>Day 15 has 8 purple and 3 green </li>\n<li>Day 16 has 8 purple and 1 green</li>\n</ul>\n\n<p>and so on..</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nsx3d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nsx3d.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "file", "ms-word", "space"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1498031884, "post_id": 44670047, "comment_id": 76324650, "body": "can you show the code?"}, {"owner": {"reputation": 713, "user_id": 4715656, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/6wq0Q.jpg?s=128&g=1", "display_name": "Gowire", "link": "https://stackoverflow.com/users/4715656/gowire"}, "edited": false, "score": 1, "creation_date": 1498033576, "post_id": 44670047, "comment_id": 76325683, "body": "It seems that you have made some form of string conversion before opening the document. The spaces have been replaced with &quot;%20&quot; and the Open command can&#39;t interpret it correctly. To help you further we need to see the rest of the code"}], "answers": [{"tags": [], "owner": {"reputation": 4028, "user_id": 1721136, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b4f8ad672610e3b4d2b2b47f52cb527?s=128&d=identicon&r=PG", "display_name": "Bill Tarbell", "link": "https://stackoverflow.com/users/1721136/bill-tarbell"}, "is_accepted": false, "score": 0, "last_activity_date": 1498035905, "creation_date": 1498035905, "answer_id": 44671545, "question_id": 44670047, "link": "https://stackoverflow.com/questions/44670047/ms-word-file-names-with-spaces/44671545#44671545", "title": "Ms Word File names with spaces", "body": "<p>Spaces in the filename shouldn't matter.  Here's a quick sample:</p>\n\n<pre><code>   Dim objWord\n   Dim objDoc\n\n   Set objWord = CreateObject(\"Word.Application\")\n   Set objDoc = objWord.Documents.Open(\"c:\\some folder\\test document.docx\")\n\n   objWord.Visible = True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8192629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058da5246c423f84eeacb2833cbda36d?s=128&d=identicon&r=PG&f=1", "display_name": "M_Ch", "link": "https://stackoverflow.com/users/8192629/m-ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498074327, "creation_date": 1498031739, "last_edit_date": 1498074327, "question_id": 44670047, "link": "https://stackoverflow.com/questions/44670047/ms-word-file-names-with-spaces", "title": "Ms Word File names with spaces", "body": "<p>I am trying to open a Ms Word file thru <code>VBA(Visual Basic Application) Command</code>. It runs fine as long as file name does not contain spaces, so I cannot open files with path names like this </p>\n\n<pre><code>--&gt;  C:/Users/Mch/Desktop/blaa blaaa.docx\n</code></pre>\n\n<p>and i get error message like this</p>\n\n<blockquote>\n  <p>-->  Description: Sorry, we couldn?t find your file. Is it possible it was >moved, renamed or deleted?\n  (C://Users/Mch/Desktop/blaa%20blaa...)</p>\n</blockquote>\n\n<p>Any pointers would be helpful.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498030858, "post_id": 44669573, "comment_id": 76323980, "body": "use <code>innerhtml</code>"}, {"owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498031731, "post_id": 44669573, "comment_id": 76324544, "body": "<code>.innerHTML</code> returns the same string."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498031979, "post_id": 44669573, "comment_id": 76324708, "body": "set what you are getting to a variable, and then look in the locals window to see what it contains."}], "owner": {"reputation": 371, "user_id": 7975744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3299b2920c8c47f5c7d4e63613b54275?s=128&d=identicon&r=PG&f=1", "display_name": "Quint", "link": "https://stackoverflow.com/users/7975744/quint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594654335, "creation_date": 1498030397, "last_edit_date": 1594654335, "question_id": 44669573, "link": "https://stackoverflow.com/questions/44669573/vba-extract-string-from-html-tag", "title": "VBA: Extract string from HTML tag", "body": "<p>I am trying to pull this bit as a string <code>fileKey=2945596</code> in this part.</p>\n\n<pre><code>&lt;a href='javascript:OpenDownloadWindow(\"../Common/FileDownloader.aspx?fileKey=2945596\")'&gt;Work Order Inquiry - Work Order&lt;/a&gt;\n</code></pre>\n\n<p>When I use</p>\n\n<pre><code>Right(IE.Document.getElementById(\"ctl00_ContentPlaceHolder1_gvExtract\").getElementsByTagName(\"tr\")(1).getElementsByTagName(\"td\")(1).getElementsByTagName(\"a\")(0).innerText, 10)\n</code></pre>\n\n<p>It Returns this string <code>Work Order</code>. I belive it it because if the <code>.innerText</code> part but I havent a clue how to pull from the javascript link.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3249, "user_id": 7147233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94f37773a80589840319d063ee51ab16?s=128&d=identicon&r=PG&f=1", "display_name": "WhatsThePoint", "link": "https://stackoverflow.com/users/7147233/whatsthepoint"}, "edited": false, "score": 0, "creation_date": 1498031022, "post_id": 44669391, "comment_id": 76324085, "body": "Cells(1,3)=Cells(1,1) and so on"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8192600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef251980095577616d91bc037d7cb2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Narendiran GP", "link": "https://stackoverflow.com/users/8192600/narendiran-gp"}, "edited": false, "score": 0, "creation_date": 1498030527, "post_id": 44669483, "comment_id": 76323778, "body": "Thanks for your response, but i need the result to be displayed VERTICALLY on Column &quot;C&quot;"}], "tags": [], "owner": {"reputation": 51, "user_id": 5053335, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fdd6ae76b70cd80368c60836a609871b?s=128&d=identicon&r=PG&f=1", "display_name": "modhorat", "link": "https://stackoverflow.com/users/5053335/modhorat"}, "is_accepted": false, "score": -2, "last_activity_date": 1498030155, "creation_date": 1498030155, "answer_id": 44669483, "question_id": 44669391, "link": "https://stackoverflow.com/questions/44669391/displaying-rows-values-in-column/44669483#44669483", "title": "Displaying rows values in column", "body": "<p>Copy and Paste Special - Paste in Cell C1, Tick Transpose Box</p>\n\n<p>Shortcut: Ctrl + C (together) Then Alt , E , S , E (in succession) </p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8192600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef251980095577616d91bc037d7cb2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Narendiran GP", "link": "https://stackoverflow.com/users/8192600/narendiran-gp"}, "edited": false, "score": 0, "creation_date": 1498031016, "post_id": 44669538, "comment_id": 76324079, "body": "This works exactly the way i expected. Thanks alot :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498031839, "post_id": 44669538, "comment_id": 76324620, "body": "Little improvement: You can reduce it to only one counter <code>j</code> and remove <code>i</code> completely by using the following <code>Cells(j * 2 - 1, &quot;C&quot;).value = Cells(j, &quot;A&quot;).value</code> and <code>Cells(j * 2, &quot;C&quot;).value = Cells(j, &quot;B&quot;).value</code> and after that incrementing <code>j = j + 1</code>"}], "tags": [], "owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "is_accepted": true, "score": 2, "last_activity_date": 1498030296, "creation_date": 1498030296, "answer_id": 44669538, "question_id": 44669391, "link": "https://stackoverflow.com/questions/44669391/displaying-rows-values-in-column/44669538#44669538", "title": "Displaying rows values in column", "body": "<p>try the following code</p>\n\n<pre><code>Public Sub program()\n    Dim i As Long\n    Dim j As Long\n\n    i = 1\n    j = 1\n    Do While Cells(i, \"A\").Value &lt;&gt; \"\"\n        Cells(j, \"C\").Value = Cells(i, \"A\").Value\n        j = j + 1\n        Cells(j, \"C\").Value = Cells(i, \"B\").Value\n        i = i + 1\n        j = j + 1\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1498030542, "creation_date": 1498030542, "answer_id": 44669635, "question_id": 44669391, "link": "https://stackoverflow.com/questions/44669391/displaying-rows-values-in-column/44669635#44669635", "title": "Displaying rows values in column", "body": "<p>Do it with the formula: <code>=IF(MOD(ROW();2)=1;INDEX(A:B;(1+ROW())/2;1);INDEX(A:B;ROW()/2;2))</code>. Just place it on <code>C1</code> and drag it.</p>\n"}], "owner": {"reputation": 33, "user_id": 8192600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef251980095577616d91bc037d7cb2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Narendiran GP", "link": "https://stackoverflow.com/users/8192600/narendiran-gp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 44669538, "answer_count": 3, "score": 3, "last_activity_date": 1498030709, "creation_date": 1498029910, "last_edit_date": 1531161705, "question_id": 44669391, "link": "https://stackoverflow.com/questions/44669391/displaying-rows-values-in-column", "title": "Displaying rows values in column", "body": "<p>In Excel, Am trying to show A1 cell value in C1 and B1 cell value in C2 and vice versa.  not sure how to do this. Is there any way to do this in VBA? Please Help! </p>\n\n<p><a href=\"https://i.stack.imgur.com/jSflu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jSflu.png\" alt=\"Sample \"></a></p>\n"}, {"tags": ["vba", "excel", "types", "compiler-errors"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498029817, "post_id": 44669238, "comment_id": 76323298, "body": "Is the number a string? If so, you can use CInt()."}, {"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498030751, "post_id": 44669238, "comment_id": 76323910, "body": "@lowpar i am not sure, how to check ?"}, {"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498030891, "post_id": 44669238, "comment_id": 76324003, "body": "@lowpar after adding the cint() the condition is not giving the right results it always giving true"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498033653, "post_id": 44669238, "comment_id": 76325740, "body": "next time, put value into a msgbox to see what it is, after try and do sum simple math to see if its a number."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "edited": false, "score": 0, "creation_date": 1498030796, "post_id": 44669334, "comment_id": 76323942, "body": "Yeah my bad i missed it"}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1498029742, "creation_date": 1498029742, "answer_id": 44669334, "question_id": 44669238, "link": "https://stackoverflow.com/questions/44669238/how-to-change-text-to-numeric-in-vba-excel/44669334#44669334", "title": "how to change text to numeric in VBA Excel", "body": "<p>You have to end the if statements and write the if procedure in another line:</p>\n\n<pre><code>    If Cells(r, c) &gt;= Cells(157, c) Then \n        Cells(i, c) = Cells(r, 3)\n        i = i + 1\n    End if\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "edited": false, "score": 0, "creation_date": 1498031401, "post_id": 44669863, "comment_id": 76324336, "body": "i tried this same thing but the condition line is always returning true    If CInt(Cells(r, c)) &gt;= CInt(Cells(157, c)) Then"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1498032448, "post_id": 44669863, "comment_id": 76324970, "body": "Could you try <code>Val</code> instead of <code>CInt</code>?"}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": true, "score": 0, "last_activity_date": 1498034887, "last_edit_date": 1498034887, "creation_date": 1498031163, "answer_id": 44669863, "question_id": 44669238, "link": "https://stackoverflow.com/questions/44669238/how-to-change-text-to-numeric-in-vba-excel/44669863#44669863", "title": "how to change text to numeric in VBA Excel", "body": "<p>Try This</p>\n\n<pre><code>    Sub comp_above_median()\n    For c = 6 To 19\n     i = 160\n        For r = 2 To 155\n            If Val(Cells(r, c)) &gt;= Val(Cells(157, c)) Then\n            Cells(i, c) = Cells(r, 3)\n            i = i + 1\n            End If\n        Next r\n    Next c\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 44669863, "answer_count": 2, "score": 0, "last_activity_date": 1498034887, "creation_date": 1498029420, "question_id": 44669238, "link": "https://stackoverflow.com/questions/44669238/how-to-change-text-to-numeric-in-vba-excel", "title": "how to change text to numeric in VBA Excel", "body": "<p>I want to convert a cell content to numeric values so that I can compare values.</p>\n\n<pre><code>If Cells(r, c) &gt;= Cells(157, c) Then Cells(i, c) = Cells(r, 3)\n</code></pre>\n\n<p>I need help on how to do it</p>\n\n<pre><code>Sub comp_above_median()\n\nFor c = 6 To 19\n i = 160\n\n    For r = 2 To 155\n        If Cells(r, c) &gt;= Cells(157, c) Then Cells(i, c) = Cells(r, 3)\n        If Cells(r, c) &gt;= Cells(157, c) Then i = i + 1\n\n    Next r\n\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>i am getting Runtime error 13 : type mismatch for the line </p>\n\n<pre><code>If Cells(r, c) &gt;= Cells(157, c) Then Cells(i, c) = Cells(r, 3)\n</code></pre>\n"}, {"tags": ["excel", "string", "vba"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1498032510, "post_id": 44669973, "comment_id": 76325014, "body": "Yes, I understand that now. Then actually, I need to check if there&#39;s a numeric character in that substring then not to include that substring in the extract. Or if in a substring are all letters, then to include it in extract."}, {"owner": {"reputation": 21, "user_id": 7421274, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wy2MmnhGgBI/AAAAAAAAAAI/AAAAAAAAABM/YPGsgw6jWM0/photo.jpg?sz=128", "display_name": "Loowood", "link": "https://stackoverflow.com/users/7421274/loowood"}, "reply_to_user": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "edited": false, "score": 0, "creation_date": 1498033310, "post_id": 44669973, "comment_id": 76325494, "body": "For alphabetical condition, you can check the ASCII of each characters in your string or use something like <a href=\"https://www.experts-exchange.com/articles/1336/Using-Regular-Expressions-in-Visual-Basic-for-Applications-and-Visual-Basic-6.html\" rel=\"nofollow noreferrer\">regular Expressions</a>. After a tiny google search I found <a href=\"https://techniclee.wordpress.com/2010/07/21/isletter-function-for-vba/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters\">this</a>."}], "tags": [], "owner": {"reputation": 21, "user_id": 7421274, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wy2MmnhGgBI/AAAAAAAAAAI/AAAAAAAAABM/YPGsgw6jWM0/photo.jpg?sz=128", "display_name": "Loowood", "link": "https://stackoverflow.com/users/7421274/loowood"}, "is_accepted": false, "score": 1, "last_activity_date": 1498033913, "last_edit_date": 1498033913, "creation_date": 1498031512, "answer_id": 44669973, "question_id": 44669182, "link": "https://stackoverflow.com/questions/44669182/export-only-text-from-the-string-vba/44669973#44669973", "title": "Export only text from the string, VBA", "body": "<p>Your code is a bit weird. If we go through it,</p>\n\n<p>At first you are splitting the string</p>\n\n<blockquote>\n  <p><code>text() = Split(text_string, \"_\")</code></p>\n</blockquote>\n\n<p>So in the array text, for the string <strong>Prijem_LPLC_MO-234_333333</strong>, you will have :</p>\n\n<ul>\n<li>Prijem</li>\n<li>LPLC</li>\n<li>MO-234</li>\n<li>333333</li>\n</ul>\n\n<p>Then, for each objects in your array, you test if the object is text :</p>\n\n<blockquote>\n  <p><code>Application.IsText(text(i))</code></p>\n</blockquote>\n\n<p>Which is the case of every object in your array.</p>\n\n<p>Finally, you concatenate komentar with this kind of structure :</p>\n\n<p>\"<strong>_ + <em>object you were testing</em></strong>\"</p>\n\n<p>In your case, it'll be something like this :</p>\n\n<blockquote>\n  <p>First iteration : komentar = <strong>_Prijem</strong></p>\n  \n  <p>Second iteration : komentar = _Prijem<strong>_LPLC</strong></p>\n  \n  <p>Third iteration : komentar = _Prijem_LPLC<strong>_MO-234</strong></p>\n  \n  <p>Fourth iteration : komentar = _Prijem_LPLC_MO-234<strong>_333333</strong></p>\n</blockquote>\n\n<p>Indeed, if you want only the text from this string, without the \"_\" element, the problem is from this line :</p>\n\n<blockquote>\n  <p><code>komentar = komentar &amp; \"_\" &amp; text(i)</code></p>\n</blockquote>\n\n<p>where you're not only adding the text, but also the \"_\"</p>\n\n<p>For your code to work, you just have to change this part.\nConsider trying this :</p>\n\n<pre><code>komentar = komentar &amp; text(i)\n</code></pre>\n\n<p>Post Scriptum  : Also, just an advice here, I think using <em>LBound(text)</em> is maybe too much, while you can use <em>0</em>, since you want to go through all your array.</p>\n\n<blockquote>\n  <p><code>For i = 0 To UBound(text) - 1</code></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7826878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d83f2857f43a526f46d60b08f2db4c?s=128&d=identicon&r=PG&f=1", "display_name": "marissalianam", "link": "https://stackoverflow.com/users/7826878/marissalianam"}, "is_accepted": false, "score": 0, "last_activity_date": 1498031953, "creation_date": 1498031953, "answer_id": 44670130, "question_id": 44669182, "link": "https://stackoverflow.com/questions/44669182/export-only-text-from-the-string-vba/44670130#44670130", "title": "Export only text from the string, VBA", "body": "<p>Instead of <code>komentar = \"\"</code> add <code>komentar = text(0)</code>. Your code copies the first symbol, because in this line you<code>komentar = komentar &amp; \"_\" &amp; text(i)</code> the first time komentar is empty. So the code returns \" _Prijem\".</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1498073247, "creation_date": 1498073247, "answer_id": 44684707, "question_id": 44669182, "link": "https://stackoverflow.com/questions/44669182/export-only-text-from-the-string-vba/44684707#44684707", "title": "Export only text from the string, VBA", "body": "<p>You are close.</p>\n\n<p>For eliminating any string with digits, you need to check each character.\nWith your method of putting together the result string, there will always be an underscore at the start.  (An alternative would have an underscore at the end).  So after you're done, merely remove the first character.</p>\n\n<pre><code>Option Explicit\nPublic Function komentar(text_string As String) As String\nDim text() As String\nDim pom As String\nDim i As Long, j As Long\n\ntext() = Split(text_string, \"_\")\n\nkomentar = \"\"\nFor i = LBound(text) To UBound(text)\n\n'Check each character\n For j = 1 To Len(text(i))\n    If Mid(text(i), j, 1) Like \"#\" Then Exit For\n Next j\n\n'j will pass this test if no characters are digits\n If j &gt; Len(text(i)) Then\n    komentar = komentar &amp; \"_\" &amp; text(i)\n End If\nNext i\n\n'Strip off the first \"_\"\nkomentar = Mid(komentar, 2)\n\nEnd Function\n</code></pre>\n\n<p>You could also do this with regular expressions in VBA, but that's a very different solution.</p>\n"}], "owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1498073247, "creation_date": 1498029272, "question_id": 44669182, "link": "https://stackoverflow.com/questions/44669182/export-only-text-from-the-string-vba", "title": "Export only text from the string, VBA", "body": "<p>I have strings and I want to export only text from a string (delimiter in the string is \"_\").\nFor example:</p>\n\n<p>string: Prijem_LPLC_MO-234_333333</p>\n\n<p>extract: Prijem_LPLC</p>\n\n<p>My code:</p>\n\n<pre><code>Public Function komentar(text_string As String) As String\nDim text() As String\nDim pom As String\ntext() = Split(text_string, \"_\")\n\nkomentar = \"\"\nFor i = LBound(text) To UBound(text) - 1\n If Application.IsText(text(i)) Then\n    komentar = komentar &amp; \"_\" &amp; text(i)\n End If\nNext i\n\nEnd Function\n</code></pre>\n\n<p>But it copies full string with \"_\" at beginning.</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498029816, "post_id": 44669159, "comment_id": 76323297, "body": "<code>resize</code> and <code>ubound</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1498058415, "post_id": 44669159, "comment_id": 76344621, "body": "This question already has a (much better) answer here: <a href=\"https://stackoverflow.com/questions/6063672/excel-vba-function-to-print-an-array-to-the-workbook\" title=\"excel vba function to print an array to the workbook\">stackoverflow.com/questions/6063672/&hellip;</a>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1498058436, "post_id": 44669159, "comment_id": 76344638, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6063672/excel-vba-function-to-print-an-array-to-the-workbook\">Excel VBA function to print an array to the workbook</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": false, "score": 0, "last_activity_date": 1498058261, "creation_date": 1498058261, "answer_id": 44680108, "question_id": 44669159, "link": "https://stackoverflow.com/questions/44669159/how-to-output-an-array-in-vba/44680108#44680108", "title": "How to output an array in vba", "body": "<p>Something like this should work:</p>\n\n<pre><code>Sub printarray(arrRecords)\n\nDim i As Long, j As Long\n\nFor i = 1 To 4\n      For j = 1 To UBound(arrRecords, 2)\n            ActiveSheet.Cells(j, i).Value = arrRecords(i, j)\n      Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Activesheet.cells needs to be replaced with whatever loaction you want to input the array.</p>\n\n<p>Note that depending on your set up the dimensions may be switched. With ubound(array,2) one can get the Upperbound of an array second dimension. Then just loop through it.\nNote also that i and j do not have to start with 1 this is dependend on your case.</p>\n\n<p>Flies away!</p>\n"}], "owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498058261, "creation_date": 1498029173, "question_id": 44669159, "link": "https://stackoverflow.com/questions/44669159/how-to-output-an-array-in-vba", "title": "How to output an array in vba", "body": "<p>I have created an array named \"arrRecords\" using a query from ODBC. I want to output the value of that array into my worksheet. The array has 4 columns but the number of rows depends on the query. How do i do this?</p>\n\n<p>Please help. </p>\n"}]