[{"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 2, "last_activity_date": 1544712629, "last_edit_date": 1544712629, "creation_date": 1544657784, "answer_id": 53753010, "question_id": 53752895, "link": "https://stackoverflow.com/questions/53752895/ms-access-vba-write-textfile/53753010#53753010", "title": "MS Access VBA - Write #TextFile", "body": "<p>You must use the correct data type. Strings are always enclosed in quotation marks. Convert the string to a double</p>\n\n<pre><code>Write #TextFile, someStringInQuotationMarks, CDbl(someStringContainingNumber)\n</code></pre>\n\n<p>E.g.: <code>Write #TextFile, \"99.9\"</code> will write <code>\"99.9\"</code> into the file, but <code>Write #TextFile, CDbl(\"99.9\")</code> will write <code>99.9</code>.</p>\n"}], "owner": {"reputation": 29, "user_id": 10360284, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YTaT_mW1ieo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOioT4ukC-cX0OrLKbHL_EzTTxL-w/mo/photo.jpg?sz=128", "display_name": "user10360284", "link": "https://stackoverflow.com/users/10360284/user10360284"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1545048872, "answer_count": 1, "score": -3, "last_activity_date": 1544712629, "creation_date": 1544656881, "last_edit_date": 1544657205, "question_id": 53752895, "link": "https://stackoverflow.com/questions/53752895/ms-access-vba-write-textfile", "closed_reason": "Duplicate", "title": "MS Access VBA - Write #TextFile", "body": "<p>I am exporting data from MS Access into a text file using the Write #TextFile command. Everything works OK except I need one field in the output file without the quotation marks which Write #TextFile puts around the text that is being saved.</p>\n\n<p>My output file looks like the following:</p>\n\n<blockquote>\n  <p>\"D\",\"   105\",\"      \",\"ARCL\",\"18/11/15\",\"181115\",\"DEPOSIT\",\"99.9\"<br>\n  \"D\",\"   315\",\"      \",\"ARCL\",\"18/11/15\",\"181115\",\"DEPOSIT\",\"-9.9\"<br>\n  \"D\",\"   315\",\"      \",\"ARCL\",\"18/11/15\",\"181115\",\"DEPOSIT\",\"-90\"</p>\n</blockquote>\n\n<p>and I need it like this:</p>\n\n<blockquote>\n  <p>\"D\",\"   105\",\"      \",\"ARCL\",\"18/11/15\",\"181115\",\"DEPOSIT\",99.9<br>\n  \"D\",\"   315\",\"      \",\"ARCL\",\"18/11/15\",\"181115\",\"DEPOSIT\",-9.9<br>\n  \"D\",\"   315\",\"      \",\"ARCL\",\"18/11/15\",\"181115\",\"DEPOSIT\",-90</p>\n</blockquote>\n\n<p>Any idea how to get the above format, please?</p>\n"}, {"tags": ["excel", "vba", "slicers"], "comments": [{"owner": {"reputation": 1, "user_id": 10783212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bc0c58c5950c1c5893f10b4242f04e?s=128&d=identicon&r=PG&f=1", "display_name": "Ronit", "link": "https://stackoverflow.com/users/10783212/ronit"}, "edited": false, "score": 0, "creation_date": 1544711269, "post_id": 53752751, "comment_id": 94379713, "body": "This was solved!  I added an ElseIf statement for each of the items."}], "answers": [{"tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": false, "score": 1, "last_activity_date": 1544657039, "creation_date": 1544657039, "answer_id": 53752916, "question_id": 53752751, "link": "https://stackoverflow.com/questions/53752751/select-multiple-values-from-a-slicer/53752916#53752916", "title": "Select multiple values from a slicer", "body": "<p>Try this :</p>\n\n<pre><code>Sub Slicer_select()\n\nActiveWorkbook.SlicerCaches(\"Slicer_Fruit\").ClearManualFilter\n\nDim Sl_I As SlicerItem\n\nFor Each Sl_I In ActiveWorkbook.SlicerCaches(\"Slicer_Fruit\").SlicerItems\n    If Not Sl_I.Value Like \"abcx*\" Then Sl_I.Selected = False\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10783212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bc0c58c5950c1c5893f10b4242f04e?s=128&d=identicon&r=PG&f=1", "display_name": "Ronit", "link": "https://stackoverflow.com/users/10783212/ronit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1968, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580626546, "creation_date": 1544656002, "last_edit_date": 1580626546, "question_id": 53752751, "link": "https://stackoverflow.com/questions/53752751/select-multiple-values-from-a-slicer", "title": "Select multiple values from a slicer", "body": "<p>I have a pivot table with a slicer.  The slicer has 50+ values in it and these values can change. I use the slicer to filter the data - I am always looking for the same 5 values, and my 5 values start with the same text string.<br>\nI had recorded a macro to select my 5 values.  this macro selects the items that are true and then lists all the other values and sets selection as false.\nWhen new values are added the macro crashes because I don't have an explicit line of code to set the selection of the new value to false.\nI found code to select one value from the slicer and deselect all other values without having to list them all explicitly, but I can't find code to find the 5 values and deselect all other values without having to list them explicitly, or\na way to modify this code to select all slicer items that \"contains\" the consistent text string.  either would help...</p>\n\n<p>this is the code I have to find one specific value, but deselect the rest without stating them explicitly:</p>\n\n<pre><code>For Each slcCache In ActiveWorkbook.SlicerCaches\n        slcCache.ClearManualFilter\nNext\n\nWith ActiveWorkbook.SlicerCaches(\"Slicer_Fruit\")\n    For Each oSlicerItem In .SlicerItems\n        If oSlicerItem.Name = \"abcx Apple\" Then\n            oSlicerItem.Selected = True\n        Else\n            oSlicerItem.Selected = False\n        End If\n    Next oSlicerItem\nEnd With\n</code></pre>\n\n<p>How can I change the code to select the slicer items that starts with \"abcx\" or contains this text?\nor is there a way to select \"abcx Apple\" and \"abcx Pear\" and \"abcx Banana\" but not select any other values?</p>\n"}, {"tags": ["vba", "button"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544655195, "post_id": 53752610, "comment_id": 94358054, "body": "Where do you have the <code>Worksheet_Calculate</code> code, in a sheet code module or regular code module?"}, {"owner": {"reputation": 115, "user_id": 8214835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9647dcfcbe6137adc39c494e8b93164?s=128&d=identicon&r=PG", "display_name": "ajafarov", "link": "https://stackoverflow.com/users/8214835/ajafarov"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544655473, "post_id": 53752610, "comment_id": 94358141, "body": "@BigBen, I have both codes in regular code module as I wanted my code to be available in any workbook I open. My intention was to have a button in the ribbon. Thanks!"}, {"owner": {"reputation": 115, "user_id": 8214835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9647dcfcbe6137adc39c494e8b93164?s=128&d=identicon&r=PG", "display_name": "ajafarov", "link": "https://stackoverflow.com/users/8214835/ajafarov"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544656727, "post_id": 53752610, "comment_id": 94358537, "body": "@BigBen, I have never used it before but I will do some research and try to understand the idea behind it, thank you!"}, {"owner": {"reputation": 1198, "user_id": 3361377, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b2278758c8fd94df86e3e7f155e96bdb?s=128&d=identicon&r=PG&f=1", "display_name": "dcromley", "link": "https://stackoverflow.com/users/3361377/dcromley"}, "edited": false, "score": 0, "creation_date": 1544664623, "post_id": 53752610, "comment_id": 94360308, "body": "By &quot;activate the second code&quot;, you want the second code to execute upon workbook calculation, right?"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8214835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9647dcfcbe6137adc39c494e8b93164?s=128&d=identicon&r=PG", "display_name": "ajafarov", "link": "https://stackoverflow.com/users/8214835/ajafarov"}, "edited": false, "score": 0, "creation_date": 1545262829, "post_id": 53788443, "comment_id": 94569292, "body": "thank you so much! Sorry, I haven&#39;t been online in the last couple of days, I will review your solution and try to understand it and will definitely let you know, thanks again!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 3, "last_activity_date": 1545053754, "last_edit_date": 1545053754, "creation_date": 1544833024, "answer_id": 53788443, "question_id": 53752610, "link": "https://stackoverflow.com/questions/53752610/vba-excel-call-macro-using-buttons/53788443#53788443", "title": "VBA Excel - Call macro using buttons", "body": "<h1>Worksheet Calculate Event</h1>\n\n<p>This is what you put into <strong>Module1</strong>, or what ever you will call your Module. This is a normal module created with Add Module. I've left the name of the test program intact, but I changed the other because it is used for worksheet events, particularly the <strong>Worksheet Calculate event</strong>. The <strong>test</strong> program and the variable <code>blnCalculation</code> enable or disable the whole thing, so in the beginning nothing will be happening before you enable it. You can create a button for it and in its <strong>Click event</strong> just add <code>Module1.test</code> or just run it from <strong>Macros</strong>.</p>\n\n<pre><code>Option Explicit\n\nPublic TargetValue As Variant\nPublic blnCalculation As Boolean\n\nSub test()\n    Dim result As VbMsgBoxResult\n    result = MsgBox(\"Run Macro?\", vbYesNo, \"Excel VBA\")\n    If result = vbYes Then\n        blnCalculation = True\n        ActiveSheet.Calculate\n      Else\n        blnCalculation = False\n    End If\nEnd Sub\n\nSub SheetCalculate()\n    Dim lastrow As Long\n    With ActiveSheet\n    lastrow = .Cells(Rows.Count, 2).End(xlUp).Row\n        With .Cells(lastrow, 2)\n            .Offset(1, 0) = .Parent.Cells(2, 1).Value\n            .Offset(1, 1) = FormatDateTime(Now, vbLongTime)\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>And the following is what you put into each sheet code aka Object module, which you get by double-clicking on it in VBE. The <strong>Worksheet Calculate event</strong> happens each time Excel 'decides' to calculate a worksheet, which is in your case probably guaranteed because you say that there is a formula in <code>B2</code>, so the event will happen <strong>every time <code>B2</code> gets calculated</strong>. But it won't run the <code>SheetCalculate</code> program unless the <strong>value has changed</strong> which is checked with the <code>TargetValue</code> variable.\nThe <strong>Worksheet Activate event</strong> happens on a worksheet e.g. each time when you select it in the tab. In this case it is used to pass the new <code>B2</code> value from the newly selected worksheet to the <code>TargetValue</code> variable.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Activate()\n    If Module1.blnCalculation Then _\n    Module1.TargetValue = Me.Range(\"B2\").Value\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n    If Module1.blnCalculation Then\n        If Me.Range(\"B2\").Value &lt;&gt; Module1.TargetValue Then\n            Module1.SheetCalculate\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8214835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9647dcfcbe6137adc39c494e8b93164?s=128&d=identicon&r=PG", "display_name": "ajafarov", "link": "https://stackoverflow.com/users/8214835/ajafarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1561, "favorite_count": 0, "accepted_answer_id": 53788443, "answer_count": 1, "score": 1, "last_activity_date": 1546085801, "creation_date": 1544655092, "last_edit_date": 1546085801, "question_id": 53752610, "link": "https://stackoverflow.com/questions/53752610/vba-excel-call-macro-using-buttons", "title": "VBA Excel - Call macro using buttons", "body": "<p>I have written the following macro that calls a Private Sub Worksheet_Calculate() if I confirm that I want to run it. Please find below the first part of the code: </p>\n\n<pre><code>Sub test()\nDim result As VbMsgBoxResult\n\nresult = MsgBox(\"Run Macro?\", vbYesNo, \"Excel VBA\")\n\nIf result = vbYes Then\n    Call Worksheet_Calculate\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The second code, which is Private Sub Worksheet_Calculate(), shall copy the result of the calculation performed in B2 and paste it in C2 as well as add a timestamp to D2. Columns C and D are populated as values in B2 change, so that I get a list of results and timestamps in C3 and D3, C4 and D4 etc. Here is the code: </p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim lastrow As Long\n\nlastrow = Worksheets(1).Cells(Rows.Count, 2).End(xlUp).Row\n\n    With Worksheets(1).Cells(lastrow, 2)\n        .Offset(1, 0) = Cells(2, 1).Value\n        .Offset(1, 1) = FormatDateTime(Now, vbLongTime)\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The problem that I am facing is related to the fact that my Public Sub Worksheet_Calculate() is called only once and whenever I recalculate the value of B2 nothing happens.</p>\n\n<p>Is there a way to a) keep second code activated or b) have a button(s) or a tickbox that would activate/deactivate the second code?</p>\n\n<p>Hope it makes sense, thanks in advance!  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1544652827, "post_id": 53752114, "comment_id": 94357133, "body": "is this a copy directly from the vbe.  do you see the stylized quotes: <code>\u201c\u201d</code>  they need to be replaced with regular quotes."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544653580, "post_id": 53752114, "comment_id": 94357435, "body": "@ScottCraner I find this interesting; if you query the value of anything in those stylized quotes it returns Empty with no errors assigning to a string or variant, what is VBA doing here?"}, {"owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "edited": false, "score": 0, "creation_date": 1544653639, "post_id": 53752114, "comment_id": 94357453, "body": "Thank you so much, Im not sure how those got in there. Im self taught as needed so there is a lot i dont know. Huge help Scott thanks again!"}, {"owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "edited": false, "score": 0, "creation_date": 1544653805, "post_id": 53752114, "comment_id": 94357523, "body": "Is there a way i can use a similar macro that would encompass a whole column?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544653831, "post_id": 53752114, "comment_id": 94357535, "body": "Look into Range.Replace."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544654079, "post_id": 53752114, "comment_id": 94357641, "body": "<code>copySheet.Range(&quot;B:B&quot;).Replace &quot;p&quot;, &quot;POW&quot;, xlWhole</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1544654131, "post_id": 53752114, "comment_id": 94357663, "body": "@Absinthe I honestly do not know why it is doing that.  Greater minds than mine will need to explain."}, {"owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "edited": false, "score": 0, "creation_date": 1544654147, "post_id": 53752114, "comment_id": 94357668, "body": "I had looked into, unfortunately i dont understand whats happening and am unable to flex it to my needs accordingly"}, {"owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "edited": false, "score": 0, "creation_date": 1544654168, "post_id": 53752114, "comment_id": 94357676, "body": "ohhh, thanks scott"}, {"owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "edited": false, "score": 0, "creation_date": 1544654360, "post_id": 53752114, "comment_id": 94357749, "body": "I tried that last code you sent and it works perfect for my needs. Thanks again Scott"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544654449, "post_id": 53752114, "comment_id": 94357782, "body": "I will write up an answer."}, {"owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "edited": false, "score": 0, "creation_date": 1544655151, "post_id": 53752114, "comment_id": 94358031, "body": "Thanks again Scott, I now have a document that pretty much runs, saves and shuts itself down and prints beautifully everytime."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1544654715, "creation_date": 1544654715, "answer_id": 53752547, "question_id": 53752114, "link": "https://stackoverflow.com/questions/53752114/i-am-trying-to-replace-text-in-a-specific-cell-using-logic/53752547#53752547", "title": "I am trying to replace text in a specific cell using logic", "body": "<p>The problem is the stylized quotes <code>\u201cPOW\u201d</code> they need to be replaced with regular quotes.</p>\n\n<p>But to do the full column at once just use <code>Range.Replace()</code></p>\n\n<pre><code>copySheet.Range(\"B:B\").Replace \"p\", \"POW\", xlWhole\n</code></pre>\n\n<p>If you have a list to replace I would fill two arrays, one with what to replace and what to replace with.  Then loop the array and do the replace:</p>\n\n<pre><code>Dim fnd As Variant\nfnd = Array(\"p\", \"c\")\n\nDim outpt As Variant\noutpt = Array(\"POW\", \"CAP\")\n\nDim i As Long\nFor i = LBound(fnd) To UBound(fnd)\n    copySheet.Range(\"B:B\").Replace fnd(i), outpt(i), xlWhole\nNext i\n</code></pre>\n\n<p>Now you just need to update the arrays.</p>\n"}], "owner": {"reputation": 1, "user_id": 10744834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6PxzG04xbcI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-goMsvcyK5C6WWIv282LC3IrA1z8w/mo/photo.jpg?sz=128", "display_name": "Dan White", "link": "https://stackoverflow.com/users/10744834/dan-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544672136, "creation_date": 1544652462, "last_edit_date": 1544672136, "question_id": 53752114, "link": "https://stackoverflow.com/questions/53752114/i-am-trying-to-replace-text-in-a-specific-cell-using-logic", "title": "I am trying to replace text in a specific cell using logic", "body": "<p>This is the code i have used so far, it is removing the \"p\" but not putting in the text like i expected. What might I be doing wrong? I have already dim my titles and those work</p>\n\n<pre><code>If copySheet.Range(\"B2\") = \"p\" Then\ncopySheet.Range(\"B2\").Value = \u201cPOW\u201d\n  End If\n\n  If copySheet.Range(\"B2\") = \"c\" Then\ncopySheet.Range(\"B2\").Value = \u201cCAP\u201d\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 1, "creation_date": 1544653344, "post_id": 53751623, "comment_id": 94357351, "body": "Which line of code is throwing the error?"}, {"owner": {"reputation": 1, "user_id": 10772678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927d4f7d21c88515385affd170660ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/10772678/rob"}, "reply_to_user": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1544654265, "post_id": 53751623, "comment_id": 94357709, "body": "When I select Debug, it highlights the      Sub GetFromOutlook ()  It was also highlighting the Set Folder = OutlookNameSpace.GetDefaultFolder line."}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1544664438, "post_id": 53751623, "comment_id": 94360272, "body": "I have updated the answer. Try using : Set Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(&quot;Se&zwnj;&#8203;nt_Items&quot;)"}, {"owner": {"reputation": 1, "user_id": 10772678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927d4f7d21c88515385affd170660ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/10772678/rob"}, "reply_to_user": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1544728741, "post_id": 53751623, "comment_id": 94389180, "body": "Its giving me a &quot;Compile error: User-Defined type not defined&quot; and its highlighting the Dim OutlookApp As Outlook.Appliation line in blue and highlighting the Sub GetFromOutlook() line in yellow."}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1544763004, "post_id": 53751623, "comment_id": 94398771, "body": "This error comes when the reference is not set. Go to Tools -&gt; References and add the Microsoft Outlook 16.0 reference."}, {"owner": {"reputation": 1, "user_id": 10772678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927d4f7d21c88515385affd170660ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/10772678/rob"}, "reply_to_user": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1545246424, "post_id": 53751623, "comment_id": 94563183, "body": "The outlook references are activated, its still showing the error. I will add that I&#39;m trying to pull data out of my sent items folder sent from a shared mailbox."}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1545255962, "post_id": 53751623, "comment_id": 94567078, "body": "Ohkay, if it&#39;s a shared folder then -&gt;   OutlookNamespace.GetSharedDefaultFolder(olRecip, olFolderSentMail)  &lt;- should be used. I have explained the usage more in my updated answer. Please check and confirm, if it&#39;s working now."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1545257735, "post_id": 53751623, "comment_id": 94567756, "body": "Would you clarify whether the sent mail ends up your default mailbox Sent items or the shared mailbox&#39;s Sent Items."}, {"owner": {"reputation": 1, "user_id": 10772678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927d4f7d21c88515385affd170660ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/10772678/rob"}, "edited": false, "score": 0, "creation_date": 1545346791, "post_id": 53751623, "comment_id": 94601669, "body": "The emails are directly available in my sent items folder, their only being sent out with the from field being generated as a shared mailbox."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10772678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927d4f7d21c88515385affd170660ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/10772678/rob"}, "edited": false, "score": 0, "creation_date": 1544656054, "post_id": 53752273, "comment_id": 94358329, "body": "I tried the       For Each Folder In     OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders     Debug.Print Folder.Name     Next Which resulted in a 424 object required"}], "tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1545255850, "last_edit_date": 1545255850, "creation_date": 1544653270, "answer_id": 53752273, "question_id": 53751623, "link": "https://stackoverflow.com/questions/53751623/pull-metadata-from-outlook-to-excel-using-vba/53752273#53752273", "title": "Pull Metadata from Outlook to Excel using VBA", "body": "<p>I ran this code from Excel/VBA and it worked perfectly. There is only 1 line of code that gave me error and hence I changed that. It was where you establish reference to the sent items folder.</p>\n\n<p>In the code below, default \"Sent Items\" folder being used as defined in outlook reference model. </p>\n\n<pre><code>Option Explicit\n\nSub GetFromOutlook()\n\n    Dim OutlookApp As Outlook.Application\n    Dim OutlookNamespace As Namespace\n    Dim OutlookRecip As Outlook.Recipient\n    Dim Folder As MAPIFolder\n    Dim OutlookMail As Variant\n    Dim i As Integer\n\n    Set OutlookApp = New Outlook.Application\n    Set OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\n\n    Set OutlookRecip = OutlookNamespace .CreateRecipient(\"RobEmail@StackOverflow.com\") '// Owner's Email / Shared Folder email address\n    Set Folder = OutlookNamespace.GetSharedDefaultFolder(OutlookRecip, olFolderSentMail)\n\n    'If you want to refer to Sent Items folder then use this.\n    'Set Folder = OutlookNamespace.GetDefaultFolder(olFolderSentMail)\n    ' Or if your Sent Email folder is inside the Inbox then use the line below (Just Uncomment the below and Comment the upper one)\n    'Set Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Sent_Items\")\n\n    i = 1\n\n    For Each OutlookMail In Folder.Items\n        If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n            Range(\"eMail_subject\").Offset(i, 0).Value = OutlookMail.Subject\n            Range(\"eMail_date\").Offset(i, 0).Value = OutlookMail.ReceivedTime\n            Range(\"eMail_sender\").Offset(i, 0).Value = OutlookMail.SenderName\n            Range(\"eMail_text\").Offset(i, 0).Value = OutlookMail.Body\n\n            i = i + 1\n        End If\n    Next OutlookMail\n\n    Set Folder = Nothing\n    Set OutlookNamespace = Nothing\n    Set OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>However, if your \"Sent Items\" folder is under \"Inbox\" or customised then run the code below to get its exact name and then use it.</p>\n\n<pre><code>For Each Folder In OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders\n    Debug.Print Folder.Name\nNext\n</code></pre>\n\n<p>Also, below is the comprehensive list of available folders in the Outlook library. Thought would be helpful to you.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eKLZO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eKLZO.png\" alt=\"Outlook Folders Reference Library List (olFolder)\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10772678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927d4f7d21c88515385affd170660ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/10772678/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592722949, "creation_date": 1544650035, "last_edit_date": 1592722949, "question_id": 53751623, "link": "https://stackoverflow.com/questions/53751623/pull-metadata-from-outlook-to-excel-using-vba", "title": "Pull Metadata from Outlook to Excel using VBA", "body": "<p>I'm trying to pull metadata for metric tracking (times sent) from my sent items mailbox. </p>\n\n<p>I'm getting an error</p>\n\n<blockquote>\n  <p>The attempted operation failed. An Object could not be found. </p>\n</blockquote>\n\n<p>I've tried several different codes but can not pull any email data from Outlook.</p>\n\n<p>I have ensured that the Outlook 2016 and Excel 2016 objects are active under references.</p>\n\n<pre><code>Sub GetFromOutlook()\n\nDim OutlookApp As Outlook.Application\nDim OutlookNamespace As Namespace\nDim Folder As MAPIFolder\nDim OutlookMail As Variant\nDim i As Integer\n\nSet OutlookApp = New Outlook.Application\nSet OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\nSet Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Inbox\").Folders(\"Sent_Items\")\n\ni = 1\n\nFor Each OutlookMail In Folder.Items\nIf OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n    Range(\"eMail_subject\").Offset(i, 0).Value = OutlookMail.Subject\n    Range(\"eMail_date\").Offset(i, 0).Value = OutlookMail.ReceivedTime\n    Range(\"eMail_sender\").Offset(i, 0).Value = OutlookMail.SenderName\n    Range(\"eMail_text\").Offset(i, 0).Value = OutlookMail.Body\n\n    i = i + 1\nEnd If\nNext OutlookMail\n\nSet Folder = Nothing\nSet OutlookNamespace = Nothing\nSet OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1544650070, "post_id": 53751615, "comment_id": 94355874, "body": "change the <code>;</code> to <code>,</code>"}, {"owner": {"reputation": 1, "user_id": 10783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e23727e5ca43fa1efcc951658e42ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Don Frejo", "link": "https://stackoverflow.com/users/10783014/don-frejo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544651062, "post_id": 53751615, "comment_id": 94356323, "body": "You are a lifesaver !! been trying to get this to work for ages ! Thank you so much !"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1544651168, "post_id": 53751615, "comment_id": 94356378, "body": "remember that using <code>.Formula</code> or <code>.FormulaR1C1</code> expects the formula string to be in EN-US format which uses <code>,</code> and not <code>;</code>."}, {"owner": {"reputation": 1, "user_id": 10783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e23727e5ca43fa1efcc951658e42ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Don Frejo", "link": "https://stackoverflow.com/users/10783014/don-frejo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544651749, "post_id": 53751615, "comment_id": 94356647, "body": "Will do ! As you can imagine English isn&#39;t my first language so it can be quite tricky to manage at times. Thank you again, so much. I can now meet my deadline :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1544663171, "post_id": 53751615, "comment_id": 94360045, "body": "Note you <i>can</i> use <code>FormulaLocal</code> or <code>FormulaR1C1Local</code> to assign your formulas while keeping your local list separator (in this case <code>;</code>), but it&#39;s not &quot;portable&quot; across different regions, so it&#39;s best to stick with using the non-Local version and the comma-separator."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1544713227, "post_id": 53751615, "comment_id": 94381014, "body": "Not an error, but you could write <code>&quot;W2&quot; &amp; &quot;:&quot; &amp; &quot;W&quot; &amp; lastrow</code> as <code>&quot;W2:W&quot; &amp; lastrow</code>"}], "answers": [{"tags": [], "owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "is_accepted": false, "score": 0, "last_activity_date": 1544712863, "creation_date": 1544712863, "answer_id": 53764538, "question_id": 53751615, "link": "https://stackoverflow.com/questions/53751615/error-1004-while-trying-to-paste-formulas-in-cell/53764538#53764538", "title": "Error 1004 while trying to paste formulas in cell", "body": "<p>You need to replace the <strong>\";\"</strong> with regular <strong>\",\"</strong>.</p>\n\n<p>For example, take this line of code:</p>\n\n<pre><code>Range(\"W2:\" &amp; \"W\" &amp; LastRow).FormulaR1C1 = \"=IFERROR(DATEVALUE(CONCATENATE(MID(RC[-10];7;2);\"\"/\"\";MID(RC[-10];5;2);\"\"/\"\";MID(RC[-10];1;4)));TEXT(,))\"\n</code></pre>\n\n<p>And change it to this:</p>\n\n<pre><code>Range(Cells(2, 1), Cells(2, LastRow)).FormulaR1C1 = \"=IFERROR(DATEVALUE(CONCATENATE(MID(RC[-10],7,2),\"\"/\"\",MID(RC[-10],5,2),\"\"/\"\",MID(RC[-10],1,4))),TEXT(,))\"\n</code></pre>\n\n<p>Also, keep in mind I made a few changes to this line. <strong>I changed it so that it is using Cells instead of range.</strong> I find Cells are easier to work with and provide better readability because we don't have to join any strings.</p>\n\n<p>Either way is fine, it just boils down to preference.</p>\n"}], "owner": {"reputation": 1, "user_id": 10783014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e23727e5ca43fa1efcc951658e42ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Don Frejo", "link": "https://stackoverflow.com/users/10783014/don-frejo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580213410, "creation_date": 1544650016, "last_edit_date": 1580213410, "question_id": 53751615, "link": "https://stackoverflow.com/questions/53751615/error-1004-while-trying-to-paste-formulas-in-cell", "title": "Error 1004 while trying to paste formulas in cell", "body": "<p>I'm pretty new to VBA and I've been trying to use a macro to paste a few formulas in cells. Problem is, everytime I do so, I get a 1004 error on the very first formula.</p>\n\n<p>I strongly suspect it's because of quotes but I can't for the life of me understand what goes wrong. Would you guys have any idea ?</p>\n\n<pre><code>Sub PREF()\n\nDim lastrow As Long\nlastrow = Range(\"'Extract WIN'!A\" &amp; Rows.Count).End(xlUp).Row\nDim P2 As Worksheet\nSet P2 = Sheets(\"PRO\")\n\nSelect Case MsgBox(\"Do you want to proceed with\" &amp; P2.[C2].Value &amp; \" ?\", vbYesNo, \"as datepref\")\nCase vbYes\n\nSheets(\"Extract WIN\").Select\n\n\n\n    Range(\"W2\" &amp; \":\" &amp; \"W\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(DATEVALUE(CONCATENATE(MID(RC[-10];7;2);\"\"/\"\";MID(RC[-10];5;2);\"\"/\"\";MID(RC[-10];1;4)));TEXT(,))\"\n    Range(\"Y2\" &amp; \":\" &amp; \"Y\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(DATEVALUE(CONCATENATE(MID(RC[-10];7;2);\"\"/\"\";MID(RC[-10];5;2);\"\"/\"\";MID(RC[-10];1;4)));TEXT(,))\"\n    Range(\"AA2\" &amp; \":\" &amp; \"AA\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(IF(AND(Provision!R2C3-RC[-4]&lt;366;RC[-18]&gt;0);RC[-18];0);TEXT(,))\"\n    Range(\"AB2\" &amp; \":\" &amp; \"AB\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-1]*RC[-18];TEXT(,))\"\n    Range(\"AC2\" &amp; \":\" &amp; \"AC\" &amp; lastrow).FormulaR1C1 = \"=IF(AND(RC[-2]=0;RC[-20]&gt;0;RC[-4]&gt;Provision!R2C6;ISNA(VLOOKUP(RIGHT(TEXT(RC[-25];\"\"000#####\"\");4);Provision!R7C17:R101C18;1;FAUX))=FAUX);1;0)\"\n    Range(\"AD2\" &amp; \":\" &amp; \"AD\" &amp; lastrow).FormulaR1C1 = \"=RC[-1]*RC[-20]\"\n    Range(\"AE2\" &amp; \":\" &amp; \"AE\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-22]-RC[-4]-RC[-2];TEXT(,))\"\n    Range(\"AF2\" &amp; \":\" &amp; \"AF\" &amp; lastrow).FormulaR1C1 = \"=IF(AND(RC[-20]&gt;0;RC[-1]&gt;0);ROUND(MIN(RC[-20]*12;RC[-1]);0);0)\"\n    Range(\"AG2\" &amp; \":\" &amp; \"AG\" &amp; lastrow).FormulaR1C1 = \"=RC[-1]*RC[-23]\"\n    Range(\"AH2\" &amp; \":\" &amp; \"AH\" &amp; lastrow).FormulaR1C1 = \"=RC[-2]-RC[-18]\"\n    Range(\"AI2\" &amp; \":\" &amp; \"AI\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-4]-RC[-3];TEXT(,))\"\n    Range(\"AJ2\" &amp; \":\" &amp; \"AJ\" &amp; lastrow).FormulaR1C1 = \"=IF(RC[-24]&gt;0;ROUND(MIN(RC[-24]*12;RC[-1]);0);0)\"\n    Range(\"AK2\" &amp; \":\" &amp; \"AK\" &amp; lastrow).FormulaR1C1 = \"=RC[-1]*RC[-27]\"\n    Range(\"AL2\" &amp; \":\" &amp; \"AL\" &amp; lastrow).FormulaR1C1 = \"=RC[-2]-RC[-21]\"\n    Range(\"AM2\" &amp; \":\" &amp; \"AM\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-4]-RC[-3];TEXT(,))\"\n    Range(\"AN2\" &amp; \":\" &amp; \"AN\" &amp; lastrow).FormulaR1C1 = \"=IF(AND(RC[-16]&gt;Provision!R2C7;RC[-28]&gt;=0);RC[-1];0)\"\n    Range(\"AO2\" &amp; \":\" &amp; \"AO\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-1]*RC[-31];TEXT(,))\"\n    Range(\"AP2\" &amp; \":\" &amp; \"AP\" &amp; lastrow).FormulaR1C1 = \"=IF(RC[-18]=TEXT(,);0;IF(AND(X2&lt;Provision!R2C7;RC[-3]&gt;0);RC[-3];0))\"\n    Range(\"AQ2\" &amp; \":\" &amp; \"AQ\" &amp; lastrow).FormulaR1C1 = \"=RC[-1]*RC[-33]\"\n    Range(\"AR2\" &amp; \":\" &amp; \"AR\" &amp; lastrow).FormulaR1C1 = \"=IF(RC[-20]=\"\"\"\";RC[-5];0)\"\n    Range(\"AS2\" &amp; \":\" &amp; \"AS\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-1]*RC[-35];TEXT(,))\"\n    Range(\"AT2\" &amp; \":\" &amp; \"AT\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-6]+RC[-4]+RC[-2];TEXT(,))\"\n    Range(\"AU2\" &amp; \":\" &amp; \"AU\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-6]+RC[-4]+RC[-2];TEXT(,))\"\n    Range(\"AV2\" &amp; \":\" &amp; \"AV\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-2]-RC[-30];TEXT(,))\"\n    Range(\"AX2\" &amp; \":\" &amp; \"AX\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-13]*0,5;TEXT(,))\"\n    Range(\"AY2\" &amp; \":\" &amp; \"AY\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-4]*0,9;TEXT(,))\"\n    Range(\"AZ2\" &amp; \":\" &amp; \"AZ\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RC[-2]+RC[-1];TEXT(,))\"\n    Range(\"BA2\" &amp; \":\" &amp; \"BA\" &amp; lastrow).FormulaR1C1 = \"=IFERROR(RANK(RC[-1];RC:RC;0);TEXT(,))\"\n    Columns(\"AA:AZ\").NumberFormat = \"#,##0\"\n    Columns(\"W:BA\").EntireColumn.AutoFit\n\n\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.AutoFilter\n    Range(\"AI2\").Select\n\nSheets(\"PRO\").Select\n\n\nCase vbNo\nP2.[C2].Select\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>I'm sorry for the wall of code but I have no idea where I did something wrong, and was advised to give you guys full context</p>\n"}, {"tags": ["excel", "vba", "multidimensional-array", "shuffle"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10719654, "user_type": "registered", "profile_image": "https://graph.facebook.com/2059549420734890/picture?type=large", "display_name": "David Rubin", "link": "https://stackoverflow.com/users/10719654/david-rubin"}, "edited": false, "score": 0, "creation_date": 1544709554, "post_id": 53753873, "comment_id": 94378629, "body": "I like what you have here, however my total data set is about 7000 rows, so I changed the B612 to B7000 when setting R2 but it only assigned about 700 of them.  I did end up erasing the array, sorting the list based on a =rand()  and redimming it by setting the GoTo NextIR back at the top of the script.  It takes about 15 minutes to run...but that is better than the 7+ hours to do it manually."}, {"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "reply_to_user": {"reputation": 11, "user_id": 10719654, "user_type": "registered", "profile_image": "https://graph.facebook.com/2059549420734890/picture?type=large", "display_name": "David Rubin", "link": "https://stackoverflow.com/users/10719654/david-rubin"}, "edited": false, "score": 0, "creation_date": 1544755148, "post_id": 53753873, "comment_id": 94397352, "body": "@DavidRubin 15 minutes sounds awfully long, try my edited code and see if you can make something of it because it is (a lot) faster. ++"}], "tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": false, "score": 0, "last_activity_date": 1544754822, "last_edit_date": 1544754822, "creation_date": 1544665330, "answer_id": 53753873, "question_id": 53751352, "link": "https://stackoverflow.com/questions/53751352/shuffling-a-2d-array/53753873#53753873", "title": "Shuffling a 2D array", "body": "<p>Not entirely sure I got your set-up right but you can try this:</p>\n\n<pre><code>Option Explicit\n\nSub Assign()\n\nRandomize\nRange(\"C2\", Range(\"C\" &amp; Rows.Count).End(xlUp)).ClearContents\n\nDim R1 As Range: Set R1 = Range(\"L2:M920\") 'People skill table\nDim R2 As Range: Set R2 = Range(\"A2:B612\") 'Cusotmers skill talbe\nDim D0 As Object: Set D0 = CreateObject(\"scripting.dictionary\")\nDim i As Integer, j As Integer, Rand as Integer\n\nFor i = 1 To R2.Rows.Count\n    Rand = Int(R1.Rows.Count * Rnd + 1)\n    For j = 1 To R1.Rows.Count\n        If R1.Cells(Rand, 2) = R2(i, 2) And Not D0.exists(Rand) Then\n            R2.Cells(i, 2).Offset(0, 1) = R1(Rand, 1)\n            D0.Add Rand, Rand\n            Exit For\n        End If\n        Rand = (Rand  Mod R1.Rows.Count) + 1\n    Next j\nNext i\n\nEnd Sub  \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/iekvS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iekvS.png\" alt=\"enter image description here\"></a></p>\n\n<p>The idea is to check the people skill list starting from a random point and making sure a key is not used twice.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong>  </p>\n\n<p>According to your comment I assume a \"people / skill\" can then be assigned more than once as there are 7000+ customers ?</p>\n\n<p>Code below randomly assign with a fairly good distribution 1500 peoples to 7000 customers in +/- 1 second.</p>\n\n<p>Have a try and see if you can adapt it to your project.</p>\n\n<pre><code>Option Explicit\n\nSub Assign()\nApplication.ScreenUpdating = False\nDim Start: Start = Timer\nRandomize\nRange(\"C2:C99999\").ClearContents\n\nDim D1 As Object\nDim R1 As Range: Set R1 = Range(\"L2\", Range(\"M\" &amp; Rows.Count).End(xlUp))\nDim R2 As Range: Set R2 = Range(\"A2\", Range(\"B\" &amp; Rows.Count).End(xlUp))\nDim T1: T1 = R1\nDim T2: T2 = R2\nDim T3()\nDim a As Integer: a = 1\nDim i As Integer, j As Integer, k As Integer, Rnd_Val As Integer, j_loop As Integer\n\nFor i = 1 To (Int(R2.Rows.Count / R1.Rows.Count) + 1)\n    Set D1 = CreateObject(\"scripting.dictionary\")\n    For j = (R1.Rows.Count * i - R1.Rows.Count + 1) To R1.Rows.Count * i\n        ReDim Preserve T3(1 To j)\n        Rnd_Val = Int(Rnd * R1.Rows.Count + 1)\n        For k = 1 To R1.Rows.Count\n            If T1(Rnd_Val, 2) = T2(j, 2) And Not D1.exists(Rnd_Val) And T3(j) = \"\" Then\n                T3(j) = T1(Rnd_Val, 1)\n                D1.Add Rnd_Val, Rnd_Val\n                Exit For\n            End If\n            Rnd_Val = (Rnd_Val Mod R1.Rows.Count) + 1\n        Next k\n        If T3(j) = \"\" Then\n            For k = 1 To R1.Rows.Count\n                If T1(Rnd_Val, 2) = T2(j, 2) Then\n                    T3(j) = T1(Rnd_Val, 1)\n                    Exit For\n                End If\n                Rnd_Val = (Rnd_Val Mod R1.Rows.Count) + 1\n            Next k\n        End If\n        a = a + 1\n        If a &gt; R2.Rows.Count Then GoTo EndLoop\n    Next j\n    Set D1 = Nothing\nNext i\n\nEndLoop:\nRange(\"C2\").Resize(UBound(T3), 1) = Application.Transpose(T3)\nDebug.Print Timer - Start\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/X9rCr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X9rCr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 0, "last_activity_date": 1544693846, "creation_date": 1544693846, "answer_id": 53758833, "question_id": 53751352, "link": "https://stackoverflow.com/questions/53751352/shuffling-a-2d-array/53758833#53758833", "title": "Shuffling a 2D array", "body": "<p>Multiple loops and multiple access to range objects makes your code very, very slow (I don't know if performance is important).</p>\n\n<p>I would read all necessary data to arrays and use filter and rnd to get a random person with the relevant skill:</p>\n\n<pre><code>Option Explicit\n\nSub PeopleBusiness()\nDim People, Customers, FilterArray\nDim I As Long, Idx As Long\n    People = Application.Transpose([L2:L920 &amp; \"|\" &amp; M2:M8])\n    Customers = Range(\"A2:C612\").Value2\n    For I = 1 To UBound(Customers, 1)\n        FilterArray = Filter(People, Customers(I, 2))\n        If UBound(FilterArray) &gt; -1 Then\n            Idx = Round(Rnd() * UBound(FilterArray), 0)\n            Customers(I, 3) = Left(FilterArray(Idx), InStr(1, FilterArray(Idx), \"|\") - 1)\n        End If\n    Next I\n    Range(\"A2:C612\").Value = Customers\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10719654, "user_type": "registered", "profile_image": "https://graph.facebook.com/2059549420734890/picture?type=large", "display_name": "David Rubin", "link": "https://stackoverflow.com/users/10719654/david-rubin"}, "is_accepted": false, "score": 0, "last_activity_date": 1544709995, "creation_date": 1544709995, "answer_id": 53763684, "question_id": 53751352, "link": "https://stackoverflow.com/questions/53751352/shuffling-a-2d-array/53763684#53763684", "title": "Shuffling a 2D array", "body": "<p>I was able to get done what I needed by erasing the array and redimming it after sorting the data based on a rand() number in the table.  It takes about 15 minutes to run 7000 assignment but it is a lot better than 7+ hours it takes to do manually.</p>\n\n<pre><code>Sub Assign()\nDim arOne()\nReDim arOne(1000, 15)\nDim o As Integer\nDim p As Integer\nDim StartTime As Double\nDim MinutesElapsed As String\nApplication.Calculation = xlAutomatic\nStartTime = Timer\nNextIR:\nReDim arOne(1000, 15)\np = 0\no = 0\n\nQAlr = Sheets(\"Sheet1\").Range(\"L\" &amp; Rows.Count).End(xlUp).Row\n\nFor I = 2 To QAlr\n    If Cells(I, 12).Value &lt;&gt; Cells(I - 1, 12) Then\n        p = p + 1\n        arOne(p, 0) = Cells(I, 12).Value\n        arOne(p, 1) = Cells(I, 13).Value\n        o = 2\n    Else\n        arOne(p, o) = Cells(I, 13).Value\n        o = o + 1\n    End If\nNext\n\nAQAlr = Sheets(\"Sheet1\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nAgtLr = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor I = AQAlr + 1 To AgtLr\n    For o = LBound(arOne, 1) + 1 To UBound(arOne, 1)\n        If arOne(o, 0) &lt;&gt; \"\" Then\n            iUsed = Application.WorksheetFunction.CountIf(Range(\"C2:C\" &amp; I), \"=\" &amp; arOne(o, 0))\n            If iUsed &lt; Application.WorksheetFunction.VLookup(arOne(o, 0), Range(\"Q2:R62\"), 2, False) Then\n                For j = LBound(arOne, 2) + 1 To UBound(arOne, 2)\n                    If arOne(o, j) = Cells(I, 2).Value Then\n                        Cells(I, 3).Value = arOne(o, 0)\n                        ActiveSheet.Calculate\n                        Erase arOne()\n                            ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort.SortFields.Clear\n                            ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort.SortFields.Add _\n                            Key:=Range(\"Table1[[#All],[Random '#]]\"), SortOn:=xlSortOnValues, Order:= _\n                            xlDescending, DataOption:=xlSortTextAsNumbers\n                        With ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Sort\n                          .Header = xlYes\n                          .MatchCase = False\n                          .Orientation = xlTopToBottom\n                          .SortMethod = xlPinYin\n                          .Apply\n                        End With\n                        GoTo NextIR\n                    End If\n                Next j\n            End If\n        End If\n    Next o\n\n\nNext I\n\nMinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\")\n\nMsgBox \"Assignments completed in \" &amp; MinutesElapsed &amp; \" minutes\", vbInformation\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10719654, "user_type": "registered", "profile_image": "https://graph.facebook.com/2059549420734890/picture?type=large", "display_name": "David Rubin", "link": "https://stackoverflow.com/users/10719654/david-rubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1580687791, "creation_date": 1544648845, "last_edit_date": 1580687791, "question_id": 53751352, "link": "https://stackoverflow.com/questions/53751352/shuffling-a-2d-array", "title": "Shuffling a 2D array", "body": "<p>I have the follow script to put a list of people with there know skills in an array and then match the first match with a customer with the same skill.  Every time it runs the results are the same.  I would like to have it be a random order of the array, but keeping the two columns in the array together.  How can I shuffle(rearrange) the array that keeps the rows in the array the same?  Or would it be better to erase the array, randomly sort the columns and set the array back up?</p>\n\n<pre><code>Sub Assign()\n\nDim arOne()\nReDim arOne(1000, 15)\nDim o As Integer\nDim p As Integer\nDim StartTime As Double\nDim MinutesElapsed As String\n\np = 0\no = 0\n\nFor i = 2 To 920\n    If Cells(i, 12).Value &lt;&gt; Cells(i - 1, 12) Then\n        p = p + 1\n        arOne(p, 0) = Cells(i, 12).Value\n        arOne(p, 1) = Cells(i, 13).Value\n        o = 2\n    Else\n        arOne(p, o) = Cells(i, 13).Value\n        o = o + 1\n    End If\nNext\n\nFor i = 2 To 612\n    For o = LBound(arOne, 1) + 1 To UBound(arOne, 1)\n        If arOne(o, 0) &lt;&gt; \"\" Then\n            iUsed = Application.WorksheetFunction.CountIf(Range(\"C2:C\" &amp; i), \"=\" &amp; arOne(o, 0))\n            If iUsed &lt; Application.WorksheetFunction.VLookup(arOne(o, 0), Range(\"Q2:R62\"), 2, False) Then\n                For j = LBound(arOne, 2) + 1 To UBound(arOne, 2)\n                    If arOne(o, j) = Cells(i, 2).Value Then\n                        Cells(i, 3).Value = arOne(o, 0)\n                        ActiveSheet.Calculate\n                        GoTo NextIR\n                    End If\n                Next j\n            End If\n        End If\n    Next o\nNextIR:\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "ms-office"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1544647612, "post_id": 53751080, "comment_id": 94354870, "body": "You want SUMIF() or SUMIFS()"}, {"owner": {"reputation": 467, "user_id": 5758799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4bff8ea1fcea29075a72e1c67aeed39e?s=128&d=identicon&r=PG&f=1", "display_name": "Dom Vito", "link": "https://stackoverflow.com/users/5758799/dom-vito"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544647798, "post_id": 53751080, "comment_id": 94354958, "body": "Can you review the screenshots I just added and let me know if you could come up with a formula or methodology to use those functions? I am drawing a blank."}], "answers": [{"tags": [], "owner": {"reputation": 324, "user_id": 9492960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b2a5afddf54ca7744322499cd9b1c3?s=128&d=identicon&r=PG&f=1", "display_name": "JoeJam", "link": "https://stackoverflow.com/users/9492960/joejam"}, "is_accepted": false, "score": 2, "last_activity_date": 1544648097, "creation_date": 1544648097, "answer_id": 53751196, "question_id": 53751080, "link": "https://stackoverflow.com/questions/53751080/sum-of-vlookup-functions-meeting-criteria-in-excel/53751196#53751196", "title": "SUM of VLOOKUP functions meeting criteria in Excel", "body": "<p>You can use <code>=SUMIF(C2:C4,\"No\",B2:B4)</code> where the age is in column B and Yes/No is in column C.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1544648334, "creation_date": 1544648334, "answer_id": 53751242, "question_id": 53751080, "link": "https://stackoverflow.com/questions/53751080/sum-of-vlookup-functions-meeting-criteria-in-excel/53751242#53751242", "title": "SUM of VLOOKUP functions meeting criteria in Excel", "body": "<p>Due to the data structure you provided if you only want to sum the names in Group 1 that are dead then you would use:</p>\n\n<pre><code>=SUMPRODUCT(SUMIFS(E:E,F:F,\"No\",D:D,B1:B3))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gVVZl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gVVZl.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the Names are not important then use @JoeJam's answer.</p>\n"}], "owner": {"reputation": 467, "user_id": 5758799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4bff8ea1fcea29075a72e1c67aeed39e?s=128&d=identicon&r=PG&f=1", "display_name": "Dom Vito", "link": "https://stackoverflow.com/users/5758799/dom-vito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 53751242, "answer_count": 2, "score": 3, "last_activity_date": 1580759380, "creation_date": 1544647566, "last_edit_date": 1580759380, "question_id": 53751080, "link": "https://stackoverflow.com/questions/53751080/sum-of-vlookup-functions-meeting-criteria-in-excel", "title": "SUM of VLOOKUP functions meeting criteria in Excel", "body": "<p>Sorry for the macabre subject matter, but I need to add the ages up of a group of people IF they have died.</p>\n\n<p>My data is structured as follows:</p>\n\n<ul>\n<li>Sheet A has the list of people to analyze.</li>\n<li>Sheet B is an essential database of all people, with a Yes/No column for if they are alive, and another column for their age.</li>\n</ul>\n\n<p>Basically, I want to get the <code>SUM</code> of ages of the people on a list on Sheet A IF the person is dead. </p>\n\n<p>In my head, it combines the <code>VLOOKUP</code>, <code>SUM</code> and <code>IF</code> functions, but not quite sure how. I want the result in ONE cell. </p>\n\n<p>Thanks for any suggestions!</p>\n\n<p>For formula matters, let's assume the data is structured as below, with the highlighted cell where I want the formula to say 60:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tPFsi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tPFsi.png\" alt=\"Sheet A\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RZIUR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RZIUR.png\" alt=\"Sheet B\"></a></p>\n"}, {"tags": ["excel", "vba", "selenium-webdriver", "xpath", "web-scraping"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544647050, "post_id": 53750760, "comment_id": 94354644, "body": "What does the HTML look like at that point?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544647576, "post_id": 53750760, "comment_id": 94354855, "body": "I have updated the post"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1544649410, "post_id": 53750760, "comment_id": 94355608, "body": "That&#39;s some pretty unfriendly HTML for automation. I&#39;m assuming you&#39;ve stripped out a lot of the related HTML because those two tables are pretty empty. Are there any text labels around the desired text that you can use as an anchor? I can&#39;t read Arabic but something like... <code>First name: John</code> where you want the text &#39;John&#39;?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544649633, "post_id": 53750760, "comment_id": 94355687, "body": "I am using selenium for this part .."}], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544650946, "post_id": 53751569, "comment_id": 94356261, "body": "Thanks a lot for reply. As for .count I got 0 .. and the class &#39;.fc180999a8-04b5-46bc-bf86-f601317d19c8-7&#39; is not fixed, it changes each time .. Is the xpath will be easier?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544651100, "post_id": 53751569, "comment_id": 94356343, "body": "There are two possible text. Is it possible to include both and check for the existing element for both of them? I have posted my try but doesn&#39;t work properly and I got incorrect results for the string variable"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544651634, "post_id": 53751569, "comment_id": 94356605, "body": "This is perfect <code>&#47;&#47;*[text()=&#39;\u0646\u0638\u0627\u0645\u064a&#39; or text()=&#39;\u0645\u0646\u0627\u0632\u0644&#39;]</code> but is it possible to make it more specific. Thanks a lot for that solution"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544651743, "post_id": 53751569, "comment_id": 94356645, "body": "I mean to put some other anchors to refer to that part or around ... and have you seen the tip of $0? Is that may be useful?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544651969, "post_id": 53751569, "comment_id": 94356747, "body": "When using <code>sStatus = .FindElementByXPath(&quot;&#47;&#47;*[text()=&#39;\u0646\u0638\u0627\u0645\u064a&#39; or text()=&#39;\u0645\u0646\u0627\u0632\u0644&#39;]&quot;).Text</code> &gt;&gt; I tested on two cases and I got &#39;\u0646\u0638\u0627\u0645\u064a&quot; for both cases !! .."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1544652201, "post_id": 53751569, "comment_id": 94356874, "body": "I was wrong about the last point ... I am so sorry .. Just need to make it specific for Span tag if possible"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1544656860, "post_id": 53751569, "comment_id": 94358568, "body": "Thank you very much my tutor. I am very grateful for all this awesome help"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1544651533, "last_edit_date": 1544651533, "creation_date": 1544649797, "answer_id": 53751569, "question_id": 53750760, "link": "https://stackoverflow.com/questions/53750760/extract-text-using-css-selector/53751569#53751569", "title": "Extract text using css selector", "body": "<p>To use xpath with multiple possible search values use the following syntax:</p>\n\n<pre><code>//*[text()='\u0646\u0638\u0627\u0645\u064a' or text()='\u0645\u0646\u0627\u0632\u0644']\n</code></pre>\n\n<p>CSS selectors (that work for me):</p>\n\n<pre><code>driver.findElementByCss(\"#ctl00_ContentPlaceHolder1_CrystalReportViewer1 div.ad071889d2-8e6f-4755-ad7d-c44ae0ea9fca-5 table span\").text\n</code></pre>\n\n<p>which is an abbreviation of the full selector:</p>\n\n<pre><code>#ctl00_ContentPlaceHolder1_CrystalReportViewer1 &gt; tbody &gt; tr &gt; td &gt; div &gt; div.crystalstyle &gt; div.ad071889d2-8e6f-4755-ad7d-c44ae0ea9fca-5 &gt; table &gt; tbody &gt; tr &gt; td &gt; table &gt; tbody &gt; tr &gt; td &gt; span\n</code></pre>\n\n<p>You can also index into table nodeList</p>\n\n<pre><code>Set matches = html.querySelectorAll(\"#ctl00_ContentPlaceHolder1_CrystalReportViewer1 div.crystalstyle table\")\nActiveSheet.Cells(1, 1) = matches.item(80).innerText\n</code></pre>\n\n<p>Otherwise:</p>\n\n<p>Reading in from html file I can take the last index of the matches based on class selector. For selenium you would switch to:</p>\n\n<pre><code>driver.FindElementsByCss(\".fc180999a8-04b5-46bc-bf86-f601317d19c8-7\").count\n</code></pre>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim html As HTMLDocument, matches As Object\n    Dim fStream  As ADODB.Stream\n    Set html = New HTMLDocument\n    Set fStream = New ADODB.Stream\n    With fStream\n        .Charset = \"UTF-8\"\n        .Open\n        .LoadFromFile \"C:\\Users\\User\\Desktop\\Output6.html\"\n        html.body.innerHTML = .ReadText\n        .Close\n    End With\n\n    Set matches = html.querySelectorAll(\".fc180999a8-04b5-46bc-bf86-f601317d19c8-7\")\n\n    ActiveSheet.Cells(1, 1) = matches.item(matches.Length - 1).innerText\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 0, "accepted_answer_id": 53751569, "answer_count": 1, "score": 0, "last_activity_date": 1544685472, "creation_date": 1544646035, "last_edit_date": 1544685472, "question_id": 53750760, "link": "https://stackoverflow.com/questions/53750760/extract-text-using-css-selector", "title": "Extract text using css selector", "body": "<p>I am trying to extract specific text using a CSS selector. Here's a screenshot of the part that I would like to extract</p>\n\n<p><a href=\"https://i.stack.imgur.com/zLydp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zLydp.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried </p>\n\n<pre><code>div[id=\"Section3\"]:first-child\n</code></pre>\n\n<p>but this doesn't return anything. I can't depend on locating the element by the text because I need to extract that text as shown.</p>\n\n<p>This is the relevant HTML</p>\n\n<pre><code>&lt;div class=\"ad24123fa4-c17c-4dc5-9aa5-ea007a8db30e-5\" style=\"top:8px;left:218px;width:124px;height:31px;text-align:center;\"&gt;\n    &lt;table width=\"113px\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n        &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td&gt;\n                    &lt;table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\n                        &lt;tbody&gt;\n                            &lt;tr&gt;\n                                &lt;td align=\"center\"&gt;\n                                    &lt;span class=\"fcb900b29f-64d7-453d-babf-192e86f17d6f-7\"&gt;\u0646\u0638\u0627\u0645\u064a&lt;/span&gt;\n                                &lt;/td&gt;\n                            &lt;/tr&gt;\n                        &lt;/tbody&gt;\n                    &lt;/table&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/tbody&gt;\n    &lt;/table&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The full HTML is <a href=\"http://www.mediafire.com/file/ys7itn33h1cg88y/FolderToTest.rar\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>This is my try</p>\n\n<pre><code>            On Error Resume Next\n            Set ele = .FindElementByXPath(\"//span[text()='\u00e3\u00e4\u00c7\u00d2\u00e1']\")\n            If ele Is Nothing Then sStatus = \"\u00e4\u00d9\u00c7\u00e3\u00ed\" Else sStatus = \"\u00e3\u00e4\u00c7\u00d2\u00e1\"\n        On Error GoTo 0\n</code></pre>\n\n<p>While inspecting the element I noticed that there is a hint of using $0 in the console .. Can this be useful?\n<a href=\"https://i.stack.imgur.com/kBJGy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kBJGy.png\" alt=\"enter image description here\"></a></p>\n\n<p>As for the two possible texts \"\u0646\u0638\u0627\u0645\u064a\" and \"\u0645\u0646\u0627\u0632\u0644\"</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544646554, "post_id": 53750705, "comment_id": 94354422, "body": "Instead of MAKE TABLE, maybe create the table as a permanent object then DELETE and INSERT records. This is a &#39;temp&#39; table."}, {"owner": {"reputation": 65, "user_id": 2092841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c000b70d15dd1ec4175c0aef7c37c5?s=128&d=identicon&r=PG", "display_name": "Haki_z", "link": "https://stackoverflow.com/users/2092841/haki-z"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544647651, "post_id": 53750705, "comment_id": 94354895, "body": "@June7 Thanks for the reponse! I tried that. Although the field remains as a memo field, the output table still has the result cut to 255 characters, eventhough the output of the function is beyond that."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544648370, "post_id": 53750705, "comment_id": 94355178, "body": "I have never tried the function with memo type field. Could be a limitation of that type. I avoid memo type whenever possible."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 2092841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c000b70d15dd1ec4175c0aef7c37c5?s=128&d=identicon&r=PG", "display_name": "Haki_z", "link": "https://stackoverflow.com/users/2092841/haki-z"}, "is_accepted": true, "score": 0, "last_activity_date": 1544648632, "creation_date": 1544648632, "answer_id": 53751309, "question_id": 53750705, "link": "https://stackoverflow.com/questions/53750705/access-make-table-with-memo-field-as-column-output-instead-of-text/53751309#53751309", "title": "Access Make table with memo field as column output instead of Text", "body": "<p>The answer was to append to the existing table (clearing it first), and setting the concatRelated column from Group By to Expression.</p>\n"}], "owner": {"reputation": 65, "user_id": 2092841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c000b70d15dd1ec4175c0aef7c37c5?s=128&d=identicon&r=PG", "display_name": "Haki_z", "link": "https://stackoverflow.com/users/2092841/haki-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 53751309, "answer_count": 1, "score": 0, "last_activity_date": 1544648632, "creation_date": 1544645764, "question_id": 53750705, "link": "https://stackoverflow.com/questions/53750705/access-make-table-with-memo-field-as-column-output-instead-of-text", "title": "Access Make table with memo field as column output instead of Text", "body": "<p>The Access make table below does the following: </p>\n\n<p>Final app number 10 has three sub apps 6, 7 ,8 in AppCombinedAreasandRegions. Their FirstOfRegion (Memo Field) respectively are \"a\",\"b\",\"c\". Based on the make table, the ConcatRelated function will create a row in the output table as follows.</p>\n\n<p><strong>Project Application:</strong> 10<br>\n<strong>Region_list:</strong> \"a,b,c\"</p>\n\n<p>Currently I have this part working.</p>\n\n<p>The issue is the output table stores Region_List (\"a,b,c\") as a TEXT field, meaning there is a limit and the value from the ConcatRelated function gets truncated. Since the source is a memo field, there will be cases where it exceeds the 255 character limit.</p>\n\n<p>Is there a way for Region_List to be a memo field instead of a text field when using the ConcatRelated function to get the concatenated output?</p>\n\n<p><a href=\"https://i.stack.imgur.com/h1pjR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h1pjR.png\" alt=\"\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544644655, "post_id": 53750237, "comment_id": 94353622, "body": "<a href=\"https://stackoverflow.com/help/how-to-ask\">What have you tried?</a>"}, {"owner": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544644869, "post_id": 53750237, "comment_id": 94353709, "body": "I tried googling but didn&#39;t see anything that I could use. Im in the dark"}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 10783098, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmXFjYRp7LA/AAAAAAAAAAI/AAAAAAAAACY/rorHbOQEnhs/photo.jpg?sz=128", "display_name": "Smiley Lando", "link": "https://stackoverflow.com/users/10783098/smiley-lando"}, "edited": false, "score": 1, "creation_date": 1544651678, "post_id": 53751932, "comment_id": 94356624, "body": "By the way, the Application.Status Bar property lets the user now the percentage of completion of a macro that may take some time to completely process."}, {"owner": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "edited": false, "score": 0, "creation_date": 1544653334, "post_id": 53751932, "comment_id": 94357344, "body": "I got a run-time error 1004. Method&#39;This Workbook&#39; of object &#39;_global&#39; failed. Can you give any instructions (amateur at this)"}, {"owner": {"reputation": 106, "user_id": 10783098, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmXFjYRp7LA/AAAAAAAAAAI/AAAAAAAAACY/rorHbOQEnhs/photo.jpg?sz=128", "display_name": "Smiley Lando", "link": "https://stackoverflow.com/users/10783098/smiley-lando"}, "reply_to_user": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "edited": false, "score": 1, "creation_date": 1544654940, "post_id": 53751932, "comment_id": 94357967, "body": "I forgot to include that in my post. Open up the vba module, and in the task bar choose &quot;TOOLS&quot; (Next to &quot;RUN&quot;). Next, select &quot;REFERENCES&quot;. Go down until you see &quot;MICROSOFT OUTLOOK 16.0 Object Library&quot; and check it. Hopefully that makes sense."}, {"owner": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "edited": false, "score": 0, "creation_date": 1544717384, "post_id": 53751932, "comment_id": 94383597, "body": "I dont see MICROSOFT OUTLOOK 16.0 Object Library in my references. I only  see the MICROSOFT OUTLOOK 12.0 Object Library"}, {"owner": {"reputation": 106, "user_id": 10783098, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmXFjYRp7LA/AAAAAAAAAAI/AAAAAAAAACY/rorHbOQEnhs/photo.jpg?sz=128", "display_name": "Smiley Lando", "link": "https://stackoverflow.com/users/10783098/smiley-lando"}, "reply_to_user": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "edited": false, "score": 0, "creation_date": 1544719943, "post_id": 53751932, "comment_id": 94385067, "body": "That should do the job. Let me know if it works for you."}, {"owner": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "edited": false, "score": 0, "creation_date": 1544727121, "post_id": 53751932, "comment_id": 94388473, "body": "no I got the same error run-time error 1004. Method&#39;This Workbook&#39; of object &#39;_global&#39; failed"}, {"owner": {"reputation": 106, "user_id": 10783098, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmXFjYRp7LA/AAAAAAAAAAI/AAAAAAAAACY/rorHbOQEnhs/photo.jpg?sz=128", "display_name": "Smiley Lando", "link": "https://stackoverflow.com/users/10783098/smiley-lando"}, "reply_to_user": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "edited": false, "score": 0, "creation_date": 1544739963, "post_id": 53751932, "comment_id": 94393709, "body": "Is it highlighting a certain line of code as the error? It works on my station but I am using Outlook 365. It should still theoretically work, regardless of outlook 2007 and 365.  That global variable error is definitely linked to the reference issue.Take a look at this link-it may help you. <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_outlook-mso_other-mso_2007/how-do-i-export-email-addresses-in-the-to-field-to/cae25c2b-fbad-4467-a186-24d4c7b5b3d2\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a>"}], "tags": [], "owner": {"reputation": 106, "user_id": 10783098, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmXFjYRp7LA/AAAAAAAAAAI/AAAAAAAAACY/rorHbOQEnhs/photo.jpg?sz=128", "display_name": "Smiley Lando", "link": "https://stackoverflow.com/users/10783098/smiley-lando"}, "is_accepted": true, "score": 1, "last_activity_date": 1544655416, "last_edit_date": 1544655416, "creation_date": 1544651531, "answer_id": 53751932, "question_id": 53750237, "link": "https://stackoverflow.com/questions/53750237/get-all-the-distribution-list-from-your-outlook-2007/53751932#53751932", "title": "Get all the Distribution List from your outlook 2007", "body": "<p>Try to run this code and let me know if it works for you. Basically, it pulls all of your global address contacts (with additional information) from outlook and puts them on a new sheet.\nOpen up the vba module, and in the task bar choose \"TOOLS\" (Next to \"RUN\"). Next, select \"REFERENCES\". Go down until you see \"MICROSOFT OUTLOOK 16.0 Object Library\" and check it. Hopefully that makes sense.</p>\n\n<pre><code>Dim olApp As Outlook.Application\nDim olNameSpace     As Namespace\nDim olAddrList      As AddressList\nDim olAddrEntry     As AddressEntry\nDim olExchgnUser    As ExchangeUser\nDim sh              As Worksheet\nDim lCnt            As Long\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olNameSpace = olApp.GetNamespace(\"MAPI\")\nSet olAddrList = olNameSpace.AddressLists(\"Global Address List\")\n\n\nSet sh = ThisWorkbook.Worksheets.Add\n\n\nWith sh\n    .Cells(1, 1) = \"NAME\"\n    .Cells(1, 2) = \"FIRST NAME\"\n    .Cells(1, 3) = \"LAST NAME\"\n    .Cells(1, 4) = \"ALIAS\"\n    .Cells(1, 5) = \"JOB TITLE\"\n    .Cells(1, 6) = \"DEPARTMENT\"\nEnd With\n\n\nlCnt = 2\n\nFor Each olAddrEntry In olAddrList.AddressEntries\n\n\n    Set olExchgnUser = olAddrEntry.GetExchangeUser\n\n    On Error Resume Next\n\n    With olExchgnUser\n        sh.Cells(lCnt, 1) = .Name\n        sh.Cells(lCnt, 2) = .FirstName\n        sh.Cells(lCnt, 3) = .LastName\n        sh.Cells(lCnt, 4) = .Alias\n        sh.Cells(lCnt, 5) = .JobTitle\n        sh.Cells(lCnt, 6) = .Department\n    End With\n\n    Application.StatusBar = \"Processing contact \" &amp; lCnt &amp; \"...\"\n\n    If Err.Number = 0 Then lCnt = lCnt + 1\n    Err.Clear\n    On Error GoTo 0\n\nNext olAddrEntry\nApplication.StatusBar = \"\"\n\nMsgBox \"Outlook Extraction Complete\",vbinformation,\"Outlook Extraction\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 6330812, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/30992d09bb624da2094860c3f575322e?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Xavier", "link": "https://stackoverflow.com/users/6330812/charles-xavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 53751932, "answer_count": 1, "score": -4, "last_activity_date": 1544655548, "creation_date": 1544643562, "last_edit_date": 1544644552, "question_id": 53750237, "link": "https://stackoverflow.com/questions/53750237/get-all-the-distribution-list-from-your-outlook-2007", "title": "Get all the Distribution List from your outlook 2007", "body": "<p>I need to get all the distribution list that I created in my outlook 2007 without actually going through all my contacts. </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1544645496, "post_id": 53750039, "comment_id": 94353972, "body": "That not exists will never return true because those quotes are not field delimiters in Access, but string delimiters. Just remove all quotes from that query and it&#39;ll probably run just fine."}, {"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1544646095, "post_id": 53750039, "comment_id": 94354240, "body": "@ErikvonAsmuth When I remove the quotes, Access prompts me to enter parameter values.  I initially had that issue, and a solution elswhere stated the single-quote marks as a fix since the fields&#39; data types are text."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1544649188, "post_id": 53750039, "comment_id": 94355516, "body": "I think your <code>Table1</code> references in the <code>WHERE</code> clause should be <code>sourceDB</code> as this is your alias in the <code>FROM</code> clause. This combined with removing the quotes ought to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 0, "creation_date": 1544654234, "post_id": 53751462, "comment_id": 94357698, "body": "Okay, part way there.  Now, in my test DB, it is appending 304 out of 1579 records.  I there should only be 4.  The rest of the external DB is an exact duplicate (copy and paste) of the current DB, but I added 4 unique test entries.  For some reason it is reading exactly 300 of them as unique."}, {"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 0, "creation_date": 1544657549, "post_id": 53751462, "comment_id": 94358795, "body": "Even if I run the query multiple times, it still keeps pulling those 300 entries.  I mean, although they might not have been seen as duplicates before the run (even though they were) they certainly should be after it Inserted the exact entry."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 1, "creation_date": 1544664934, "post_id": 53751462, "comment_id": 94360376, "body": "@LazyBear I&#39;m willing to bet that those 300 records have <code>null</code> values in one of those comparison fields. <code>Null = Null</code> would always return <code>false</code>; which means the <code>NOT EXISTS</code> would never see that as a duplicate value. You would need to do some sort of null replacement/checking to deal with those cases. I&#39;ll update my answer with a suggestions to deal with that case"}, {"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 0, "creation_date": 1544744971, "post_id": 53751462, "comment_id": 94395209, "body": "That&#39;s it! Thank you. I used the following to sort it out: <code>(sourceDB.[field1] = sourceDB1.[field1] Or (sourceDB.[field1] IS NULL And sourceDB1.[field1] IS NULL))</code>  I didn&#39;t see your code until now, just the comment.  But both seem to work."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 1, "creation_date": 1544754003, "post_id": 53751462, "comment_id": 94397103, "body": "Nice, I like your solution better - the IsNull checks. Glad to have helped @LazyBear"}], "tags": [], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "is_accepted": true, "score": 1, "last_activity_date": 1544665325, "last_edit_date": 1544665325, "creation_date": 1544649344, "answer_id": 53751462, "question_id": 53750039, "link": "https://stackoverflow.com/questions/53750039/how-to-update-tables-from-an-external-access-database-with-identical-tables/53751462#53751462", "title": "How to update tables from an external Access database with identical tables?", "body": "<p>1) Remove the string quotes from your field comparison logic.</p>\n\n<p>2) You have aliased <code>Table1</code> in your query as <code>sourceDB</code>, so use that reference.</p>\n\n<p>3) The table where you check for non-existence ought to be the \"local\" version of <code>Table1</code> (the one you are inserting into).</p>\n\n<pre><code>INSERT INTO Table1 \nSELECT field1, \n       field2, \n       field3, \n       field4, \n       field5\nFROM [;DATABASE=C:\\extDB.accdb].[Table1] sourceDB\nWHERE NOT EXISTS (SELECT * \n                  FROM [Table1] sourceDB1 \n                  WHERE (sourceDB.[field1] = sourceDB1.[field1] And \n                         sourceDB.[field2] = sourceDB1.[field2] And \n                         sourceDB.[field3] = sourceDB1.[field3] And \n                         sourceDB.[field4] = sourceDB1.[field4] And \n                         sourceDB.[field5] = sourceDB1.[field5]));\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>To deal with the case where these fields might have <code>null</code> values, you cannot do a simple <code>=</code> comparison since <code>null</code> does not equal <code>null</code>. The best way I can think of to get around this in MS Access would be to replace <code>null</code> with some other value that is not likely to be used. In doing so, you also need to make sure you chose replacement values that are consistent with the data type. I will make an assumption that all your fields are text.</p>\n\n<pre><code>INSERT INTO Table1 \n    SELECT field1, \n           field2, \n           field3, \n           field4, \n           field5\n    FROM [;DATABASE=C:\\extDB.accdb].[Table1] sourceDB\n    WHERE NOT EXISTS (SELECT * \n                      FROM [Table1] sourceDB1 \n                      WHERE (nz(sourceDB.[field1],\"!@#\") = nz(sourceDB1.[field1],\"!@#\") And \n                             nz(sourceDB.[field2],\"!@#\") = nz(sourceDB1.[field2],\"!@#\") And \n                             nz(sourceDB.[field3],\"!@#\") = nz(sourceDB1.[field3],\"!@#\") And \n                             nz(sourceDB.[field4],\"!@#\") = nz(sourceDB1.[field4],\"!@#\") And \n                             nz(sourceDB.[field5],\"!@#\") = nz(sourceDB1.[field5],\"!@#\")));\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 53751462, "answer_count": 1, "score": 0, "last_activity_date": 1544744879, "creation_date": 1544642816, "last_edit_date": 1544744879, "question_id": 53750039, "link": "https://stackoverflow.com/questions/53750039/how-to-update-tables-from-an-external-access-database-with-identical-tables", "title": "How to update tables from an external Access database with identical tables?", "body": "<p>Using MS Access, via VBA, I have been trying to update an main Access database table from an identically structured external Access database table.  Same columns, same fields.  The external databases are used to update a central main database.  </p>\n\n<p>What I have been trying to develop is a line of SQL that only appends the entries that are completely unique.  Because there is no foreign keys or unique identifiers for the incoming data that can be referenced, I am required to check each field to make sure that there are no exact duplicates.  So, if the table had 2 fields, if entries failed the logic test<br>\n <code>intTable.field1 = extTable.field1 And intTable.field2 = extTable.field2</code><br>\nthen those are the entries that would be appended.</p>\n\n<p>The code I came up with is below, and when it runs it tries to append (in a Gary Oldman voice) EVERYTHING.  I can't find out what could be wrong with it, as it's almost like it ignores the <code>WHERE</code> or <code>WHERE NOT EXIST</code>.  I have tried dozens of small edits and alternate versions.  Either is appends all or none.</p>\n\n<pre><code>INSERT INTO Table1 \nSELECT field1, field2, field3, field4, field5\nFROM [;DATABASE=C:\\extDB.accdb].[Table1] sourceDB \nWHERE NOT EXISTS (SELECT * \n                  FROM [;DATABASE=C:\\extDB.accdb].[Table1] sourceDB1 \n                  WHERE ('Table1.[field1]'='sourceDB1.[field1]' And \n                         'Table1.[field2]'='sourceDB1.[field2]' And \n                         'Table1.[field3]'='sourceDB1.[field3]' And \n                         'Table1.[field4]'='sourceDB1.[field4]' And \n                         'Table1.[field5]'='sourceDB1.[field5]'));\n</code></pre>\n\n<hr>\n\n<p>FINAL CODE (after implementing ArcherBird's solution):</p>\n\n<pre><code>INSERT INTO Table1 \nSELECT field1, field2, field3, field4, field5\nFROM [;DATABASE=C:\\extDB.accdb].[Table1] sourceDB \nWHERE NOT EXISTS (SELECT * \n                  FROM [;DATABASE=C:\\extDB.accdb].[Table1] sourceDB1 \n                  WHERE ((sourceDB.[field1] = sourceDB1.[field1] Or (sourceDB.[field1] IS NULL And sourceDB1.[field1] IS NULL)) And \n                         (sourceDB.[field2] = sourceDB1.[field2] Or (sourceDB.[field2] IS NULL And sourceDB1.[field2] IS NULL)) And \n                         (sourceDB.[field3] = sourceDB1.[field3] Or (sourceDB.[field3] IS NULL And sourceDB1.[field3] IS NULL)) And \n                         (sourceDB.[field4] = sourceDB1.[field4] Or (sourceDB.[field4] IS NULL And sourceDB1.[field4] IS NULL)) And \n                         (sourceDB.[field5] = sourceDB1.[field5] Or (sourceDB.[field5] IS NULL And sourceDB1.[field5] IS NULL)) ));\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1544643402, "post_id": 53749888, "comment_id": 94353043, "body": "See answer below, you have to instantiate that DataObject (create) with a variable (pointer to physical location), not work with it directly."}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1544643532, "post_id": 53749888, "comment_id": 94353109, "body": "You may have renamed the default <code>TextBox1.Text</code> to another (Name) e.g. txtFooBar.Text while coding. So, the object name is different in code and GUI design."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1544643591, "post_id": 53749888, "comment_id": 94353129, "body": "True, because it works your way."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 3, "last_activity_date": 1544643710, "last_edit_date": 1544643710, "creation_date": 1544643137, "answer_id": 53750125, "question_id": 53749888, "link": "https://stackoverflow.com/questions/53749888/copy-text-from-a-textbox-to-clipboard/53750125#53750125", "title": "Copy text from a textbox to clipboard", "body": "<p>Have a look at this:\n<a href=\"https://stackoverflow.com/a/14226925/8716187\">https://stackoverflow.com/a/14226925/8716187</a></p>\n\n<pre><code>Dim DataObj As New MSForms.DataObject\n\n'Put a string in the clipboard\nDataObj.SetText Thisworkbook.Worksheet(\"Sheet1\").TextBox1.Text 'name of your textbox here\nDataObj.PutInClipboard\n\n'Get a string from the clipboard\nDataObj.GetFromClipboard\nDebug.Print DataObj.GetText\n</code></pre>\n\n<p>** Tested and working, no scope problems here though as Textbox, Control Button, Worksheet Code all in the same scope - you may need to describe the location of your objects\n<a href=\"https://i.stack.imgur.com/v3cKp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v3cKp.png\" alt=\"enter image description here\"></a>\n-WWC</p>\n\n<p>I tested your version, it also worked, be sure your TextBox1 is what you think it is.  How is it created, if at runtime it may not the the number (name) you think it is.</p>\n\n<p>This also compiles and runs without error:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\n    With New MSForms.DataObject\n\n    'Put a string in the clipboard\n    .SetText TextBox1.Text 'name of your textbox here\n    .PutInClipboard\n\n    'Get a string from the clipboard\n    .GetFromClipboard\n    Debug.Print .GetText\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 4168141, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iRrEzWMUwtc/AAAAAAAAAAI/AAAAAAAAAFE/scyQw-v7q4w/photo.jpg?sz=128", "display_name": "Danny Holstein", "link": "https://stackoverflow.com/users/4168141/danny-holstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1572995010, "creation_date": 1572995010, "answer_id": 58720772, "question_id": 53749888, "link": "https://stackoverflow.com/questions/53749888/copy-text-from-a-textbox-to-clipboard/58720772#58720772", "title": "Copy text from a textbox to clipboard", "body": "<p>I found the only thing that works is the <a href=\"https://docs.microsoft.com/en-us/office/vba/access/concepts/windows-api/send-information-to-the-clipboard\" rel=\"nofollow noreferrer\">Microsoft solution</a>. Copy the code and paste into a new module (called \"<em>ClipBoard</em>\") and, voila, reliable clipboard functions.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12855892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCOm5oFVGvJrTNJMQZA-2QAWvhm0iqTqYVc6k4n=k-s128", "display_name": "Sani Sanjaya", "link": "https://stackoverflow.com/users/12855892/sani-sanjaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1581046671, "creation_date": 1581046671, "answer_id": 60106753, "question_id": 53749888, "link": "https://stackoverflow.com/questions/53749888/copy-text-from-a-textbox-to-clipboard/60106753#60106753", "title": "Copy text from a textbox to clipboard", "body": "<p>This is work for me. Its will be put all text in Textbox1 to clipboard so its can be use at another application via paste command.</p>\n\n<pre><code>TextBox1.SetFocus\n</code></pre>\n\n<p><code>TextBox1.SelStart = 0</code></p>\n\n<p><code>TextBox1.SelLength = Len(TextBox1.Text)</code></p>\n\n<p><code>TextBox1.Copy</code></p>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 10620833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ffaa41f4be172ba8cb13d6423ad2a8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jovanny", "link": "https://stackoverflow.com/users/10620833/jovanny"}, "is_accepted": false, "score": 0, "last_activity_date": 1600252673, "creation_date": 1600252673, "answer_id": 63918227, "question_id": 53749888, "link": "https://stackoverflow.com/questions/53749888/copy-text-from-a-textbox-to-clipboard/63918227#63918227", "title": "Copy text from a textbox to clipboard", "body": "<p>I think this should surely work without any problem</p>\n<p><code> With Me.TextBox1 .SelStart = 0 .SelLength = Len(.Text) .Copy End With</code></p>\n"}], "owner": {"reputation": 11, "user_id": 10782603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ea34836a53e4d379cd4872ad0fe2c58?s=128&d=identicon&r=PG&f=1", "display_name": "Michaelrulaz", "link": "https://stackoverflow.com/users/10782603/michaelrulaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7485, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1609880223, "creation_date": 1544642119, "last_edit_date": 1600655105, "question_id": 53749888, "link": "https://stackoverflow.com/questions/53749888/copy-text-from-a-textbox-to-clipboard", "title": "Copy text from a textbox to clipboard", "body": "<p>I am trying to copy text from a Text Box to the clipboard.</p>\n<pre><code>Private Sub CommandButton1_Click()\n    With New MSForms.DataObject\n        .SetText TextBox1.Text\n        .PutInClipboard\n    End With\nEnd Sub\n</code></pre>\n<p>I get</p>\n<blockquote>\n<p>&quot;Run-time error '424' Object required.</p>\n</blockquote>\n<p>Debugging causes <code>.setText TextBox1.Text</code> to highlight and say &quot;MyData &lt;Object variable or with block variable not set&quot;.</p>\n"}, {"tags": ["vba", "ms-access", "multidimensional-array"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1544641853, "post_id": 53749621, "comment_id": 94352275, "body": "What exactly is the problem with the code?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544645824, "post_id": 53749621, "comment_id": 94354125, "body": "Where is the code calling MsgBox?"}, {"owner": {"reputation": 3, "user_id": 7534860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c04b57f436e642f49abf9c7b8ab60c8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam S.", "link": "https://stackoverflow.com/users/7534860/adam-s"}, "edited": false, "score": 0, "creation_date": 1544648093, "post_id": 53749621, "comment_id": 94355071, "body": "The message box will be &quot;The test data for S/N &quot; &amp; Me!SN &amp; &quot; has nonconforming values. The TDS will not be approved.&quot; for all conditions. When I hover over result, result = null even though it should = &quot;Pass&quot;."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544649092, "post_id": 53749621, "comment_id": 94355474, "body": "You say &#39;report&#39; has command button but reports in PrintPreview are not interactive. Did you mean form or are you running report in ReportView?"}, {"owner": {"reputation": 3, "user_id": 7534860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c04b57f436e642f49abf9c7b8ab60c8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam S.", "link": "https://stackoverflow.com/users/7534860/adam-s"}, "edited": false, "score": 0, "creation_date": 1544650524, "post_id": 53749621, "comment_id": 94356080, "body": "Yes, it is a form opened with acViewReport"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1544649141, "last_edit_date": 1544649141, "creation_date": 1544645224, "answer_id": 53750594, "question_id": 53749621, "link": "https://stackoverflow.com/questions/53749621/i-need-to-search-multiple-answers-for-one-variable/53750594#53750594", "title": "I need to search multiple answers for one variable", "body": "<p>Can't compare anything to Null and certainly can't simply <code>Or Null</code>. </p>\n\n<p><code>If result = \"Fail\" Or IsNull(result) Then</code></p>\n"}], "owner": {"reputation": 3, "user_id": 7534860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c04b57f436e642f49abf9c7b8ab60c8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam S.", "link": "https://stackoverflow.com/users/7534860/adam-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544649141, "creation_date": 1544640959, "last_edit_date": 1544645475, "question_id": 53749621, "link": "https://stackoverflow.com/questions/53749621/i-need-to-search-multiple-answers-for-one-variable", "title": "I need to search multiple answers for one variable", "body": "<p>The code below is trying to open a pop-up screen depending on what \"result\" equals. The report this command button is in has multiple rows for \"PassFail\". My goal is to search every row and to have different pop-ups for different results. For example, if any \"PassFail\" equals \"fail\" or is blank, the first pop-up message. If all \"PassFail\" equals \"Pass\", the second pop-up message. Please help!!!</p>\n\n<pre><code>Dim result As Variant\nresult = DLookup(\"PassFail\", \"dbo_TestDetail\", \"dbo_TestDetail.TDIndex\" = \" &amp; Me!Index &amp; \")\n\nDim Msg, Style, Title\n\nIf result = \"Fail\" Or Null Then\n\n    Msg = \"The test data for S/N \" &amp; Me!SN &amp; \" has nonconforming values. The TDS will not be approved.\"\n    Style = vbCritical + vbDefaultButton2\n    Title = \"TDS Approval Denied\"\n\nElseIf result = \"Pass\" Then\n    Msg = \"Are you sure you want to approve the test data for S/N \" &amp; Me!SN &amp; \"?\"\n    Style = vbYesNo + vbCritical + vbDefaultButton2\n    Title = \"TDS Approval\"\n\nEnd If\n</code></pre>\n"}, {"tags": ["json", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1544659546, "post_id": 53749573, "comment_id": 94359331, "body": "What library are you getting <code>WebClient</code>, <code>WebRequest</code>, <code>WebResponse</code> and <code>WebMethod</code> from?"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1544659711, "post_id": 53749573, "comment_id": 94359370, "body": "It doesn&#39;t look like you ever replace <code>&lt;URL&gt;</code> with the actual URL. Does this get set somewhere else in your code?"}], "owner": {"reputation": 21, "user_id": 10327557, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QY_n-AezjF8/AAAAAAAAAAI/AAAAAAAAF6g/aNx_uUaMSnA/photo.jpg?sz=128", "display_name": "user10327557", "link": "https://stackoverflow.com/users/10327557/user10327557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594625596, "creation_date": 1544640782, "last_edit_date": 1594625596, "question_id": 53749573, "link": "https://stackoverflow.com/questions/53749573/receiving-an-error-with-vba-web-httpget-call-in-ms-access", "title": "Receiving an Error with VBA-Web HttpGet Call in MS Access", "body": "<p>Web Library to process JSON calls in VBA:</p>\n\n<p><a href=\"https://github.com/VBA-tools/VBA-Web\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-Web</a></p>\n\n<p>This is the call in Postman which works fine:</p>\n\n<pre><code>curl -X GET \\\n  https://&lt;URL&gt;/ \\\n  -H 'Content-Type: application/x-www-form-urlencoded' \\\n  -H 'Postman-Token: dee67429-d5f8-45fd-8004-f5c244729526' \\\n  -H 'cache-control: no-cache' \\\n  -d 'api_key=&lt;Key&gt;'\n</code></pre>\n\n<p>I'm struggling in Access to get the VBA-Web code to work. This is what I've coded:</p>\n\n<pre><code>Dim Client As New WebClient\nDim Request As New WebRequest\nDim Response As WebResponse\nDim Body As New Dictionary\n\nClient.BaseUrl = \"https:&lt;URL&gt;\"\n\nRequest.Method = WebMethod.HttpGet\nRequest.ContentType = \"application/x-www-form-urlencoded\"\n\nRequest.AddBodyParameter \"api_key\", \"&lt;Key&gt;\"\n\nSet Response = Client.Execute(Request)\n</code></pre>\n\n<p>It seems to be hitting the API as the Response in Content is, \"{\"error\":\"Invalid request\"}\". Any thoughts where I'm going astray? Please note, for this call there is no Request.Resource needed as it's at the root level. They have other APIs that are at the next level down.</p>\n\n<p>Thanks!!!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1544641186, "creation_date": 1544641186, "answer_id": 53749669, "question_id": 53749499, "link": "https://stackoverflow.com/questions/53749499/change-chart-colours-bar-based-on-source-cell-using-conditional-formatting-an/53749669#53749669", "title": "Change Chart Colours (bar) Based on Source Cell (using conditional formatting and VBA)", "body": "<p>Formatting applied via CF can be accessed via the <code>DisplayFormat</code> property:</p>\n\n<pre><code>Range(FormulaSplit(2)).Item (pointIterator).DisplayFormat.Interior.Color\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 1, "accepted_answer_id": 53749669, "answer_count": 1, "score": 0, "last_activity_date": 1544672187, "creation_date": 1544640493, "last_edit_date": 1544672187, "question_id": 53749499, "link": "https://stackoverflow.com/questions/53749499/change-chart-colours-bar-based-on-source-cell-using-conditional-formatting-an", "title": "Change Chart Colours (bar) Based on Source Cell (using conditional formatting and VBA)", "body": "<p>Trying to add a button to change the colours on a bar chart given the source cell's colour. </p>\n\n<p>This is the code I'm using:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim oChart As ChartObject\nDim MySeries As Series\nDim FormulaSplit As Variant\nDim SourceRangeColor As Long\nDim seriesArray() As Variant\nDim pointIterator As Integer\n\nFor Each oChart In ActiveSheet.ChartObjects\n\nFor Each MySeries In oChart.Chart.SeriesCollection\n\n    seriesArray = MySeries.Values\n    For pointIterator = 1 To UBound(seriesArray)\n        FormulaSplit = Split(MySeries.Formula, \",\")\n        SourceRangeColor = Range(FormulaSplit(2)).Item    (pointIterator).Interior.Color\n        MySeries.Points(pointIterator).Interior.Color = SourceRangeColor\n      Next pointIterator\n  Next MySeries\nNext oChart\n\nEnd Sub\n</code></pre>\n\n<p>It works perfectly fine if I fill in the respective cells myself, however if I set the cells to have their colour filled in via conditional formatting, the code above changes all the bars to white. I'm assuming it's because it is not reading the conditionally formatted cell fill, so it defaults to white.</p>\n\n<p>Is there any way to fix this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544640483, "post_id": 53749438, "comment_id": 94351574, "body": "Are you sure this can&#39;t be done with XMLHTTP?"}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 1, "creation_date": 1544653888, "post_id": 53751431, "comment_id": 94357555, "body": "Thanks chillin.  I knew it was something like that.  I just didn&#39;t know it was exactly that issue."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 3, "last_activity_date": 1544649624, "last_edit_date": 1544649624, "creation_date": 1544649190, "answer_id": 53751431, "question_id": 53749438, "link": "https://stackoverflow.com/questions/53749438/web-query-throws-error-import-currenturl-matches-no-exports-did-you-miss-a-mod/53751431#53751431", "title": "Web query throws error: import currenturl matches no exports. Did you miss a module reference?", "body": "<p>I think the error message you are receiving is from Power Query.</p>\n\n<p>Your variable <code>currenturl</code> is defined in VBA but not in Power Query (the two are separate and Power Query does not have knowledge of your VBA variables or what they may contain).</p>\n\n<p>So when your <code>M</code> code is evaluated, it knows you want you want to pass some <code>Expression</code> called <code>currenturl</code> as an argument to the <code>Web.Contents</code> function but it can't find <code>currenturl</code> being defined/assigned anywhere (within its own evaluation chain).</p>\n\n<p>I think your options are:</p>\n\n<ul>\n<li><p>Instead of <code>\"...Web.Contents(currenturl)...\"</code>, try <code>\"...Web.Contents(\"\"\" &amp; currenturl &amp; \"\"\")...\"</code> (i.e. let VBA evaluate <code>currenturl</code> and pass its actual value to Power Query, rather than handing Power Query an expression that originates from outside of its evaluation chain/scope). This might be the quickest fix, although the URL needs to be surrounded by <code>\"</code> on each side, so that Power Query evaluates it as text/string -- and there may be other things to watch out for as well.</p></li>\n<li><p>Use a more pure approach i.e. either all in VBA, or all in <code>M</code>/Power Query (probably more work for you, but it means you don't need to have VBA talk to Power Query, or vice versa).</p></li>\n<li><p>Have your VBA code dump all <code>currenturl</code>s (from all loop iterations) to a specific range/column, then have Power Query look at that particular range, return an <code>M</code> table for each <code>currenturl</code>, then combine and load as one table to an Excel sheet. Technically, once you've made the query, you'd only need to refresh it (can be done from VBA), but making the query will require knowledge of <code>M</code> or Power Query GUI.</p></li>\n</ul>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3261, "favorite_count": 0, "accepted_answer_id": 53751431, "answer_count": 1, "score": 0, "last_activity_date": 1579543402, "creation_date": 1544640242, "last_edit_date": 1579543402, "question_id": 53749438, "link": "https://stackoverflow.com/questions/53749438/web-query-throws-error-import-currenturl-matches-no-exports-did-you-miss-a-mod", "title": "Web query throws error: import currenturl matches no exports. Did you miss a module reference?", "body": "<p>I'm running the following code.</p>\n\n<pre><code>Sub HREF_Web()\n\nDim doc As HTMLDocument\nDim output As Object\n\nRange(\"A1:C10000\").Clear\n\n' delete all queries\nDim pq As Object\nFor Each pq In ThisWorkbook.Queries\n    pq.Delete\nNext\n\n' delete all connections\nDim cn As Object\nFor Each cn In ThisWorkbook.Connections\n    cn.Delete\nNext\n\n\nSet ie = New InternetExplorer\nie.Visible = True\nie.navigate Worksheets(\"Sheet1\").Range(\"L1\") ' getting url from the worksheet\n\nDo\n'DoEvents\nLoop Until ie.readyState = READYSTATE_COMPLETE\n\nSet doc = ie.document\nSet output = doc.getElementsByTagName(\"a\")\n\n\nFor Each link In output\n    Debug.Print link.innerHTML\n    If link.innerHTML Like \"*\" &amp; \"Data Corrections\" &amp; \"*\" Then\n        link.Click\n\n        currenturl = ie.LocationURL\n\n            ActiveWorkbook.Queries.Add Name:=\"Table 0\", Formula:= _\n            \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \" Source = Web.Page(Web.Contents(currenturl)),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Promoted Headers\"\" = Table.PromoteHeaders(Data0, [PromoteAllScalars=true]),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(#\"\"Promoted Headers\"\",{{\"\"Data Notice Page\"\", type any}, {\"\"eMBS Inc\"\", type any}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"   \" &amp; _\n            \" #\"\"Changed Type\"\"\"\n        ActiveWorkbook.Worksheets.Add\n        With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n            \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"Table 0\"\";Extended Properties=\"\"\"\"\" _\n            , Destination:=Range(\"$A$1\")).QueryTable\n            .CommandType = xlCmdSql\n            .CommandText = Array(\"SELECT * FROM [Table 0]\")\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = True\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .PreserveColumnInfo = True\n            .ListObject.DisplayName = \"Table_0\"\n            .Refresh BackgroundQuery:=False\n        End With\n\n        Cells.Select\n        Selection.Copy\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Range(\"A2\").Select\n\n    End If\n\nNext\n\nMsgBox \"Done!\"\n\nEnd Sub\n</code></pre>\n\n<p>The error occurs on this line:</p>\n\n<pre><code>.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>The 'currenturl' variable is coming from the newly opened IE window.  Maybe that's not the way to do this kind of thing, but I thought it was going to work.  Basically, I want to loop through all HREF tags in a parent, look for tags that contain 'Data Corrections', click these links, navigate to these children URLs (there are 4), and import the data from the 'Table 0' object.</p>\n\n<p>Here is an image of the error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qbXIT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qbXIT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544641674, "post_id": 53749433, "comment_id": 94352187, "body": "You should start  by recording a macro first, then see what that produces."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1544643467, "post_id": 53749433, "comment_id": 94353078, "body": "Can you instead please edit the code in to your original post?  Also, please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid using <code>.Select</code>`.Activate`</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10782494, "user_type": "registered", "profile_image": "https://graph.facebook.com/10108143119060929/picture?type=large", "display_name": "Mike Childers", "link": "https://stackoverflow.com/users/10782494/mike-childers"}, "edited": false, "score": 0, "creation_date": 1544724353, "post_id": 53758381, "comment_id": 94387198, "body": "I&#39;m getting an error that the variable is not set when the code gets to the end of the If.  Also, I don&#39;t think this is currently set up to loop and perform the copy paste for all values in the filtered column, which is really what I&#39;m hoping to do with the code."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 21, "user_id": 10782494, "user_type": "registered", "profile_image": "https://graph.facebook.com/10108143119060929/picture?type=large", "display_name": "Mike Childers", "link": "https://stackoverflow.com/users/10782494/mike-childers"}, "edited": false, "score": 0, "creation_date": 1544726870, "post_id": 53758381, "comment_id": 94388373, "body": "I assure you I would not supply a code without testing it myself. You would have to be lacking some information."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 21, "user_id": 10782494, "user_type": "registered", "profile_image": "https://graph.facebook.com/10108143119060929/picture?type=large", "display_name": "Mike Childers", "link": "https://stackoverflow.com/users/10782494/mike-childers"}, "edited": false, "score": 0, "creation_date": 1580808980, "post_id": 53758381, "comment_id": 106210509, "body": "@MikeChilders If you are getting &quot;Run-time error &#39;91&#39;: Object variable or With block variable not set&quot; on the line <code>.Range(&quot;A1&quot;).AutoFilter Field:=c.Column, Criteria1:=&quot;1A&quot;</code>, then it probably means that <code>c Is Nothing</code> - this means that the value <code>f</code> (<code>&quot;Job Group&quot;</code>) was not found in <code>fRange</code> (Row 1 of the &quot;Data&quot; worksheet) - however, the code in the <i>question</i> suggests that we should be searching the &quot;<b>All</b> Data&quot; sheet instead:  <code>Set fRng = sSheet.Range(sSheet.Cells(1, 1), sSheet.Cells(1, lastcol))</code> - this is why providing sample data in the question can be very useful!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1544692279, "creation_date": 1544692279, "answer_id": 53758381, "question_id": 53749433, "link": "https://stackoverflow.com/questions/53749433/filter-copy-and-paste-loop-with-non-constant-column-location-in-vba/53758381#53758381", "title": "Filter, Copy and Paste Loop with Non Constant Column Location in VBA", "body": "<pre><code>Sub Button1_Click()\n    Dim lastrow As Long\n    Dim lastcol As Long\n    Dim SSheet As Worksheet, Lst As Long\n    Dim DSheet As Worksheet\n    Dim PRange As Range, fRng As Range, f As String, c As Range\n\n    f = \"Job Group\"\n\n    Set SSheet = Worksheets(\"All Data\")\n    Set DSheet = Worksheets(\"Data\")\n\n    With SSheet\n        Lst = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n\n        With DSheet\n            lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n            lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n            Set fRng = .Range(.Cells(1, 1), .Cells(1, lastcol))\n            Set c = fRng.Find(what:=f, lookat:=xlWhole)\n            Set PRange = .Cells(1, 1).Resize(lastrow, lastcol)\n            If .AutoFilterMode Then\n                .AutoFilter.Sort.SortFields.Clear\n                .AutoFilterMode = False\n            End If\n            .Range(\"A1\").AutoFilter Field:=c.Column, Criteria1:=\"1A\"\n        End With\n\n        PRange.Offset(1).Copy .Cells(Lst, \"A\")\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10782494, "user_type": "registered", "profile_image": "https://graph.facebook.com/10108143119060929/picture?type=large", "display_name": "Mike Childers", "link": "https://stackoverflow.com/users/10782494/mike-childers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580801622, "creation_date": 1544640233, "last_edit_date": 1580801622, "question_id": 53749433, "link": "https://stackoverflow.com/questions/53749433/filter-copy-and-paste-loop-with-non-constant-column-location-in-vba", "title": "Filter, Copy and Paste Loop with Non Constant Column Location in VBA", "body": "<p>I'm looking for some help with putting together some code in VBA that will filter a column with a certain header name, copy and paste that information into a second sheet, and then perform the same filter, copy, paste action for each value that is in the column.  Unfortunately the column will not always be in the same location.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>Below is what I've got so far:</p>\n\n<pre><code>Dim lastrow As Long\nDim lastcol As Long\nDim SSheet As Worksheet\nDim DSheet As Worksheet\nDim PRange As Range\n\n'Define Data Range\nSet SSheet = Worksheets(\"All Data\")\nSet DSheet = Worksheets(\"Data\")\nlastrow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nlastcol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(lastrow, lastcol)\n\nSSheet.Select\nSelection.AutoFilter.Sort.SortFields.Clear\nActiveSheet.ShowAllData\nRows(\"1:1\").Select\nSelection.Find(What:=\"Job Group\", After:=ActiveCell, LookIn:=xlFormulas, _\nLookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False).Activate\nActiveSheet.Range(\"$A$1:\" &amp; lastrow, lastcol).AutoFilter Field:=14, Criteria1:= _\"1A\"\nCell (\"A1\").Select\nRange(\"$A$1:\" &amp; lastrow, lastcol).Select\nSelection.Copy\nDSheet.Select\nRange(\"A1\").Select\nActiveCell.Paste\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1544656068, "post_id": 53749194, "comment_id": 94358334, "body": "Are you able to access the photos in a browser or something? If these photos are privileged/require logging in or authentication, check how the server/site authenticates your request (e.g. cookie in response to a successful log-in form submission?). You may need to emulate the authentication process by sending any necessary HTTP request(s). Also, might be worth trying to firstly save files to disk, then <code>fill</code> using the locally stored version of the image. With this approach, you can verify if the server&#39;s response contains any photo(s)."}, {"owner": {"reputation": 1, "user_id": 10092867, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yotO91B5Zs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUlTy7U9iRX4UyAXvmPDRP75S6jg/mo/photo.jpg?sz=128", "display_name": "Martin H", "link": "https://stackoverflow.com/users/10092867/martin-h"}, "reply_to_user": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1544719096, "post_id": 53749194, "comment_id": 94384616, "body": "I can access the files via browser (e.g. Google Chrome). In icognito modus this is not possible. Therefore I believe that it requires some kind of authentification to the server, but the question is &quot;how do I do that via VBA and download the pic via URL afterwards?&quot; -  a temporary download to a local disk would also be very okay, filling it afterwards is not the problem."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1544729092, "post_id": 53749194, "comment_id": 94389336, "body": "Figure out which site/service you&#39;re logged in to (in the regular, non-incognito browser window), might just be Outlook. Then you need to mimic the log in process (on some sites this can be done by sending HTTP post request with a URL encoded form in the request&#39;s body, to which the server responds with a cookie. If you include that cookie in subsequent requests, you can access privileged resources). To know what exactly what needs to be POSTed to the server, you can log in a browser whilst monitoring the network tab in Developer Tools (F12 in Chrome)."}], "owner": {"reputation": 1, "user_id": 10092867, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yotO91B5Zs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUlTy7U9iRX4UyAXvmPDRP75S6jg/mo/photo.jpg?sz=128", "display_name": "Martin H", "link": "https://stackoverflow.com/users/10092867/martin-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544639204, "creation_date": 1544639204, "question_id": 53749194, "link": "https://stackoverflow.com/questions/53749194/how-to-download-photos-via-url-from-outlook365-to-powerpoint", "title": "How to download photos via URL from outlook365 to powerpoint", "body": "<p>I would like to use VBA Powerpoint to directly download a picture via URL and place it in the current powerpoint presentation. This is working for common and open URLs like \n '<a href=\"http://finviz.com/chart.ashx?t=INTC&amp;ty=c&amp;ta=0&amp;p=w&amp;s=l\" rel=\"nofollow noreferrer\">http://finviz.com/chart.ashx?t=INTC&amp;ty=c&amp;ta=0&amp;p=w&amp;s=l</a>' </p>\n\n<p>Unfortunately the error message \"Run-time error '70': Permission denied\" is popping up while executing the line 'thePix.Fill.UserPicture imageURL' in case I am using the outlook.office365.com adress to download pictures from the company mail server?!.</p>\n\n<p>What exactly is the problem there? Is there a need to somehow also transmit the login data for this specific server? How can this be archieved? Can someone please help me?</p>\n\n<pre><code>Sub AddImage()\nDim thePix As Shape\nDim imageURL As String\n\nDim sld As Slide\nSet sld = ActiveWindow.View.Slide\n\nimageURL = \"https://outlook.office365.com/owa/service.svc/s/GetPersonaPhoto?email=XXX@YY.com&amp;UA=0&amp;size=HR648x648\"\n'imageURL = \"http://finviz.com/chart.ashx?t=INTC&amp;ty=c&amp;ta=0&amp;p=w&amp;s=l\"\n\nFor Each thePix In sld.Shapes\n    thePix.Fill.UserPicture imageURL\nNext thePix\n\nEnd Sub\n</code></pre>\n\n<p>Thank you very much and BR\nMartin</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544639391, "post_id": 53748850, "comment_id": 94351032, "body": "Does it still reset the project if you alter a <code>New UF_PartSelection</code> instance instead of working off the default instance of the form? <code>Dim ui As UF_PartSelection</code> in that procedure scope, <code>Set ui = New LB_PartList</code>, then work with <code>ui.LB_PartList</code>, and do <code>ui.Show</code>. This wouldn&#39;t be the only reason to <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">avoid working with userform default instances</a>."}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544643045, "post_id": 53748850, "comment_id": 94352832, "body": "Tried that, same problem - see EDIT 2"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544644640, "post_id": 53748850, "comment_id": 94353617, "body": "<code>As New</code> has nasty side-effects you&#39;ll also want to avoid."}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544651934, "post_id": 53748850, "comment_id": 94356721, "body": "Interesting, I&#39;m not sure what side effects you mean but the problem is solved when I rewrite the code without using <code>As New</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544652143, "post_id": 53748850, "comment_id": 94356838, "body": "<code>As New</code> creates an auto-instantiated object, which means it&#39;s always going to be a valid object reference. <code>Set thing = Nothing</code> will destroy the object, and then doing <code>thing.Show</code> will re-created it and happily run the member call. Or, merely doing <code>If thing Is Nothing Then</code> will also re-create it. <code>As New</code> is almost always a terrible idea."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544644708, "post_id": 53750296, "comment_id": 94353645, "body": "Normally the form designer closes when the code is running. This still looks very much like a form default instance problem."}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544652162, "post_id": 53750296, "comment_id": 94356853, "body": "Mathieu - you were right. My solution was a workaround but yours is an actual solution. Thank you for your help!"}], "tags": [], "owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "is_accepted": false, "score": 0, "last_activity_date": 1544643838, "creation_date": 1544643838, "answer_id": 53750296, "question_id": 53748850, "link": "https://stackoverflow.com/questions/53748850/excel-vba-project-resets-after-userform-is-called-via-worksheet-change-event/53750296#53750296", "title": "Excel VBA - Project Resets after UserForm is called via Worksheet_Change event", "body": "<p>I have solved the problem, even though I don't understand it at all. For some reason, having the VBE window open is causing the project to be reset when the worksheet_change sub terminates. Closing the VBE window eliminates the problem. Anyone know why that is? I've never encountered anything like this before. </p>\n"}], "owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1544652063, "creation_date": 1544637725, "last_edit_date": 1544652063, "question_id": 53748850, "link": "https://stackoverflow.com/questions/53748850/excel-vba-project-resets-after-userform-is-called-via-worksheet-change-event", "title": "Excel VBA - Project Resets after UserForm is called via Worksheet_Change event", "body": "<p>I have a spreadsheet with a Worksheet_Change event that calls a sub in a module. The worksheet_change code is: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim itemType As String, material As String, size As Variant, rating As Variant, weldType As String\nDim rowNum, i, iMax, j As Double\n\nIf Target.Count &gt; 1 Then Exit Sub\nDisable_Slowdowns\n\n'....code for other columns which is not triggered....\n\n    If Target.Column = 4 And Target.row &gt; 4 Then\n         If Len(Target.Value2) &gt; 0 Then AutoFill_By_PN Target\n    End If\nEnable_Slowdowns\nEnd Sub\n</code></pre>\n\n<p>Code for the Enable_Slowdowns and Disable_Slowdowns subs, stored in a module:</p>\n\n<pre><code>Sub Disable_Slowdowns()\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\nEnd Sub\n\nSub Enable_Slowdowns()\n    If Application.EnableEvents = False Then Application.EnableEvents = True\n    If Application.ScreenUpdating = False Then Application.ScreenUpdating = True\n    If Application.Calculation = xlCalculationManual Then Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Then, the sub doing the work, called AutoFill_by_PN (a variable is declared outside of the sub, within the module, called selectedPartIndex):</p>\n\n<pre><code>Public selectedPartIndex As Integer\n\nPublic Sub AutoFill_By_PN(ByVal rngPN As Range)\nDim vCell As Variant\nDim wb, costingWB As Workbook\nDim strTemp, PN, sName, sPrice, sSize, sType As String\nDim quotePosR, spacePosL, counter, i, k As Integer\nDim priceL, priceR As Variant\nDim dict As Object\n\nDisable_Slowdowns\nSet dict = CreateObject(\"Scripting.Dictionary\")\nPN = rngPN.Value2\nSet costingWB = ActiveWorkbook\nSet wb = Workbooks.Open(Filename:=\"Z:\\Shared\\Materials\\Parts Book\\New Parts Book - Official.xlsx\", UpdateLinks:=1, ReadOnly:=1)\ncounter = 0\nselectedPartIndex = -1\n\nFor Each vCell In wb.Sheets(\"PARTS BOOK\").Range(\"$F$260:$F$3872\")\n    With vCell\n        If InStr(1, .Value2, PN, vbTextCompare) &gt; 0 Then\n            sName = \"name\" &amp; counter\n            sType = \"type\" &amp; counter\n            sPrice = \"price\" &amp; counter\n            sSize = \"size\" &amp; counter\n            dict.Add sName, .Value2\n            dict.Add sType, .Offset(, -2).Value2\n\n            quotePosR = InStr(1, .Value2, \"\"\"\", vbTextCompare)\n            If quotePosR &gt; 0 Then\n                spacePosL = InStrRev(.Value2, \" \", quotePosR, vbBinaryCompare)\n                strTemp = Evaluate(Replace(Mid(.Value2, spacePosL + 1, quotePosR - spacePosL - 1), \"-\", \"+\", compare:=vbTextCompare))\n                dict.Add sSize, strTemp\n            Else\n                dict.Add sSize, \"\"\n            End If\n\n            priceR = .Offset(, 3).Value2\n            priceL = .Offset(, 2).Value2\n            If IsNumeric(priceL) And IsNumeric(priceR) Then\n                If priceL - priceR &lt;= 0 Then\n                    dict.Add sPrice, priceR\n                Else\n                    dict.Add sPrice, priceL\n                End If\n            ElseIf IsNumeric(priceL) Then\n                dict.Add sPrice, priceL\n            ElseIf IsNumeric(priceR) Then\n                dict.Add sPrice, priceR\n            Else\n                dict.Add sPrice, \"\"\n            End If\n            counter = counter + 1\n        End If\n    End With\nNext vCell\nIf counter - 1 &lt;= 0 Then\n    With rngPN\n        .Offset(, 3).Value2 = dict(sName)\n        .Offset(, 4).Value2 = dict(sType)\n        .Offset(, 6).Value2 = dict(sSize)\n        .Offset(, 13).Value2 = dict(sPrice)\n    End With\nElse\n    For i = 0 To counter - 1\n        UF_PartSelection.LB_PartList.AddItem dict(\"name\" &amp; i), i\n    Next i\n    UF_PartSelection.Show\nEnd If\n\nIf selectedPartIndex &gt;= 0 Then\n    With rngPN\n        .Offset(, 3).Value2 = dict(\"name\" &amp; selectedPartIndex)\n        .Offset(, 4).Value2 = dict(\"type\" &amp; selectedPartIndex)\n        .Offset(, 6).Value2 = dict(\"size\" &amp; selectedPartIndex)\n        .Offset(, 13).Value2 = dict(\"price\" &amp; selectedPartIndex)\n    End With\nEnd If\n\nEnable_Slowdowns\nEnd Sub\n</code></pre>\n\n<p>The idea is that a part number is entered in a cell, then the parts book is searched and some values are populated in other columns. The important part is that sometimes the part number is found within text for multiple parts, at which point a userform is shown that lets the user select the correct part. The form is showing and all involved code runs without errors until the very last line (literally), when the worksheet_change code reaches \"End Sub\" - then I get a message that \"this action will reset the project\". </p>\n\n<p>Why is this happening? Code for the userform below (fields populate correctly and the chosen item is captured correctly)</p>\n\n<pre><code>Private Sub cmd_ok_Click()\nDim i, indexNo As Integer, vItem As Variant\nindexNo = -1\nFor i = 0 To Me.LB_PartList.ListCount\n    If Me.LB_PartList.Selected(i) = True Then indexNo = i\nNext i\nIf indexNo &gt;= 0 Then capture_ListBox_Index indexNo Else capture_ListBox_Index -1\nUnload Me\nEnd Sub\n</code></pre>\n\n<p>And the code to capture the listbox selection, in the same module as the AutoFill_by_PN sub:</p>\n\n<pre><code>Public Sub capture_ListBox_Index(indexNo As Integer)\n    selectedPartIndex = indexNo\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated. I can't seem to identify what action is specifically triggering the project reset - it happens on the \"End Sub\" line in the worksheet_change code each time when I step through the code in debugging mode. </p>\n\n<p>[EDIT]: I have found that the code runs fine when there is only one matching part number. This leads me to believe it must have something to do with the userform code because the userform is only shown when there are multiple matches. Additionally, the cell values are all updated correctly according to the part selected by the user in the userform, even when I get the \"Project must be reset\" message. Very strange.</p>\n\n<p>[EDIT 2]: I tried running this code in the AutoFill_By_PN sub and still have the same problem:</p>\n\n<pre><code>If counter - 1 &lt;= 0 Then\n    With rngPN\n        .Offset(, 3).Value2 = dict(sName)\n        .Offset(, 4).Value2 = dict(sType)\n        .Offset(, 6).Value2 = dict(sSize)\n        .Offset(, 13).Value2 = dict(sPrice)\n    End With\nElse\n    Dim ui As New UF_PartSelection\n    For i = 0 To counter - 1\n        ui.LB_PartList.AddItem dict(\"name\" &amp; i), i\n        ui.LB_PartList.List(i, 1) = FormatCurrency(dict(\"price\" &amp; i), 2)\n    Next i\n    ui.Show\nEnd If\n</code></pre>\n\n<p>[EDIT 3]: Thank you for the comment. After rewriting the code inside the \"else\" block shown above, the problem is solved! Code below:</p>\n\n<pre><code>Else\n    Dim ui As UF_PartSelection\n    Set ui = New UF_PartSelection\n    For i = 0 To counter - 1\n        ui.LB_PartList.AddItem dict(\"name\" &amp; i), i\n        ui.LB_PartList.List(i, 1) = FormatCurrency(dict(\"price\" &amp; i), 2)\n    Next i\n    ui.Show\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1544635114, "creation_date": 1544635114, "answer_id": 53748206, "question_id": 53747900, "link": "https://stackoverflow.com/questions/53747900/excel-vba-find-first-occurrence-of-any-value-in-column-a-then-insert-value-o/53748206#53748206", "title": "Excel VBA -- Find first occurrence of any value in column A, then insert value of column B into column C (same row)", "body": "<p>If you used a formula such as</p>\n\n<pre><code> =IF(COUNTIF(A$1:A1,A1)=1,B1,\"del\")\n</code></pre>\n\n<p>You could clear the <code>del</code>s with Find &amp; Select or, since you have tagged this VBA, with:</p>\n\n<pre><code> Selection.SpecialCells(xlCellTypeFormulas, 2).ClearContents\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10781902, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oeklvkfISms/AAAAAAAAAAI/AAAAAAAAABo/9oEEhx9Skbo/photo.jpg?sz=128", "display_name": "B D Cav", "link": "https://stackoverflow.com/users/10781902/b-d-cav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544640537, "creation_date": 1544634000, "last_edit_date": 1544634653, "question_id": 53747900, "link": "https://stackoverflow.com/questions/53747900/excel-vba-find-first-occurrence-of-any-value-in-column-a-then-insert-value-o", "title": "Excel VBA -- Find first occurrence of any value in column A, then insert value of column B into column C (same row)", "body": "<p>I'm trying to write a VBA script for a weekly chore.  Here is my data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/PW34S.png\" alt=\"IMG1\"></p>\n\n<p>I run a macro that clears out the values of column C.  Then i have to find the first occurrence of every unique value in Column A.  When I find the first occurrence, I write in the same row of Column C \"=Column B\" just for that row.  Basically, I'm trying to say, \"A4 is the first occurrence of a unique value; therefore C4=B4.\"  I can't do a simple IF() function and drag it down, because the rest of column C needs to stay truly blank (it's referenced by an IF(NOT(ISBLANK)) function).</p>\n\n<p>I'm new to VBA, and unfortunately recording what I did, did not capture my actual intent.  This was the macro, which doesn't seem efficient:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n    Range(\"C8\").Select\n    Application.Left = 3591.25\n    Application.Top = 268\n    Windows(\"Copy of OPS_schedule_6.xlsm\").Activate\n    Application.Left = 3451.75\n    Application.Top = 163\n    Windows(\"Book1\").Activate\n    Range(\"A1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$B$9\").AutoFilter Field:=1, Criteria1:=\"Alpha\"\n    Range(\"C1\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=RC[-1]\"\n    Range(\"C2\").Select\n    ActiveSheet.Range(\"$A$1:$B$9\").AutoFilter Field:=1, Criteria1:=\"Bravo\"\n    Range(\"C4\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=RC[-1]\"\n    Range(\"C5\").Select\n    ActiveSheet.Range(\"$A$1:$B$9\").AutoFilter Field:=1, Criteria1:=\"Charlie\"\n    Range(\"C8\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=RC[-1]\"\n    Range(\"C9\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "date", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1544640221, "post_id": 53748108, "comment_id": 94351436, "body": "That&#39;s the last day of the month. Shouldn&#39;t it be: <code>DateSerial(Year([date1]);Month([date1])+2;0)</code>?"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 1, "last_activity_date": 1544640541, "last_edit_date": 1544640541, "creation_date": 1544634763, "answer_id": 53748108, "question_id": 53747876, "link": "https://stackoverflow.com/questions/53747876/date1-before-1-monthdate12-monthyear1-vba-access/53748108#53748108", "title": "date1 before (1/month(date1)+2/month(year1)) vba access", "body": "<p>You can use the fact that <code>DateSerial(Year, Month, 0)</code> returns the last day of the previous month, e.g.:</p>\n\n<pre><code>DSum(\"[value]\",\"[collection]\",\"[date] &lt;= DateSerial(Year([date1]),Month([date1])+2,0)\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10204016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LCEVQtEH27g/AAAAAAAAAAI/AAAAAAAAAEY/BpGeJZlHm0w/photo.jpg?sz=128", "display_name": "OUSSAMA HEDDA", "link": "https://stackoverflow.com/users/10204016/oussama-hedda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544640541, "creation_date": 1544633916, "question_id": 53747876, "link": "https://stackoverflow.com/questions/53747876/date1-before-1-monthdate12-monthyear1-vba-access", "title": "date1 before (1/month(date1)+2/month(year1)) vba access", "body": "<p>i have a table collection(id,value,date)\nhow to use dsum to get the sum(value) where date is before last day of month(date1)+1</p>\n\n<p>i tried </p>\n\n<pre><code>SomDom(\"[value]\";\"[collection]\";\"[date]&lt;= format(dateserial(year([date1]);month([date1])+1;1)-1,'dd/mm/yyyy')\")\n</code></pre>\n\n<p>but with no success, any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1544633547, "post_id": 53747656, "comment_id": 94347984, "body": "Use <code>With Cells(Rows.Count, 1).End(xlUp).Offset(1)</code> instead.  It will leave <code>A1</code> blank as it&#39;s offsetting from the last row by one row, but will add to A2, A3, A4, etc."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1544633468, "creation_date": 1544633468, "answer_id": 53747742, "question_id": 53747656, "link": "https://stackoverflow.com/questions/53747656/fill-column-with-timestamps-using-macro/53747742#53747742", "title": "Fill column with timestamps using macro", "body": "<p>You need to determine the current last used row in <code>Column A</code> each time you run the macro. Then you move down one row with <code>Offset(1)</code> to drop your new value</p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click()\n\nDim LR As Long\n\nWith Sheets(\"Sheet1\")\n    LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1).Row\n    .Range(\"A\" &amp; LR).Value = Format(Now, \"h:mm:ss AM/PM\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 4279158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1beacff49c49beeec2579553cb13a65b?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/4279158/neo"}, "is_accepted": false, "score": 0, "last_activity_date": 1544633905, "creation_date": 1544633905, "answer_id": 53747872, "question_id": 53747656, "link": "https://stackoverflow.com/questions/53747656/fill-column-with-timestamps-using-macro/53747872#53747872", "title": "Fill column with timestamps using macro", "body": "<pre><code>Sub RectangleRoundedCorners1_Click() \nWith Cells(Rows.Count, 1).End(xlUp).Offset(1) \n.Value = Now()\n\n.NumberFormat = \"h:mm:ss AM/PM\" \nEnd With \nEnd Sub\n</code></pre>\n\n<p>As commented by Darren </p>\n"}], "owner": {"reputation": 203, "user_id": 4279158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1beacff49c49beeec2579553cb13a65b?s=128&d=identicon&r=PG&f=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/4279158/neo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1544633905, "creation_date": 1544633166, "question_id": 53747656, "link": "https://stackoverflow.com/questions/53747656/fill-column-with-timestamps-using-macro", "title": "Fill column with timestamps using macro", "body": "<p>I am trying to use a button to stamp time into a column of cells, each time the button is pressed I would like it to move to the cell below e.g., A1, A2, A3 etc.</p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click() \nWith Range(\"A1\") \n.Value = Now()\n\n.NumberFormat = \"h:mm:ss AM/PM\" \nEnd With \nEnd Sub\n</code></pre>\n\n<p>This adds the current time stamp to A1 and each time replaces the contents, when excel recognises A1 is full I want it to print in the next cell down. Is there some kind of +1 loop i should be using. I have not used VB before.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 4, "last_activity_date": 1544700344, "last_edit_date": 1544700344, "creation_date": 1544633019, "answer_id": 53747619, "question_id": 53747565, "link": "https://stackoverflow.com/questions/53747565/writing-a-loop-that-has-multiple-criteria/53747619#53747619", "title": "Writing a loop that has multiple criteria", "body": "<p>There are many ways to do this, but as you're almost there yourself I'll present the option that closest matches your attempt:</p>\n\n<pre><code>If .Item(i) = \"w\" Or .Item(i) = \"x\" Or .Item(i) = \"y\" Or .Item(i) = \"z\" Then\n</code></pre>\n\n<p>instead of your existing IF. This is the correct way to use <code>Or</code> for these decisions.</p>\n\n<p>Alternatively, a slightly slicker way that is easier to expand (and read) would be simply to look for an occurrence of the search item in a longer string. I've separated the matches with a <code>|</code> separator in case the cell contains for example <code>xy</code> and you don't want that to match. You may want to change the separator if there is a chance that it might be used in your table.</p>\n\n<pre><code>If InStr(1, \"w|x|y|z\", .Item(i), vbBinaryCompare) Then\n</code></pre>\n\n<p>Change the <code>vbBinaryCompare</code> to <code>vbTextCompare</code> if you don't want it case sensitive.</p>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 4, "last_activity_date": 1544633848, "creation_date": 1544633848, "answer_id": 53747855, "question_id": 53747565, "link": "https://stackoverflow.com/questions/53747565/writing-a-loop-that-has-multiple-criteria/53747855#53747855", "title": "Writing a loop that has multiple criteria", "body": "<p>Select case would be my preferred method here</p>\n\n<hr>\n\n<pre><code>For i = .Rows.Count To 1 Step -1\n     Select Case .Item(i)\n         Case \"w\", \"x\", \"y\", \"z\"\n             .Item(i) = \"A\"\n         Case \"something else\"\n             'If you have other criteria\n         Case Else\n             'If you have a action item for something that isn't any of the above\n     End Select\n Next i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1544727436, "post_id": 53748183, "comment_id": 94388609, "body": "Perfect. Exactly what I was looking for"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1544732705, "post_id": 53748183, "comment_id": 94390915, "body": "All answers worked and I wish I could give you all the check. Thanks!"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 2, "last_activity_date": 1544635006, "creation_date": 1544635006, "answer_id": 53748183, "question_id": 53747565, "link": "https://stackoverflow.com/questions/53747565/writing-a-loop-that-has-multiple-criteria/53748183#53748183", "title": "Writing a loop that has multiple criteria", "body": "<p>I would tend to use an array input for this; you can easily alter the array then but the code will still work. Something like:</p>\n\n<pre><code>Dim arr() As String: arr = Split(\"w,x,y,z\", \",\")\nFor i = .Rows.Count To 1 Step -1\n    For j = LBound(arr) To UBound(arr)\n        If .Item(i) = arr(j) Then .Item(i) = \"A\"\n    Next j\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1544638141, "post_id": 53748793, "comment_id": 94350407, "body": "replace method can actually be very slow if there are many replacements and/or calcs are set to automatic and the workbook has a bunch of formulas."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10781941"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1544638564, "post_id": 53748793, "comment_id": 94350611, "body": "Perhaps, but still faster than looping through each cell in a column. If the OP hadn&#39;t been quite so vague then better methods could have been offered."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10781941"}, "is_accepted": false, "score": 0, "last_activity_date": 1544637474, "creation_date": 1544637474, "answer_id": 53748793, "question_id": 53747565, "link": "https://stackoverflow.com/questions/53747565/writing-a-loop-that-has-multiple-criteria/53748793#53748793", "title": "Writing a loop that has multiple criteria", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.replace\" rel=\"nofollow noreferrer\">Range.Replace method</a> will perform this quickly.</p>\n\n<pre><code>dim repl as variant, i as long\n\nrepl = array(\"w\", \"x\", \"y\", \"z\")\n\nfor i = lbound(repl) to ubound(repl)\n    activesheet.range(\"A:A\").replace what:=repl(i), replacement:=\"A\", _\n                                     lookat:=xlwhole, matchcase:=False\nnext i\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53748183, "answer_count": 4, "score": 0, "last_activity_date": 1580458401, "creation_date": 1544632816, "last_edit_date": 1580458401, "question_id": 53747565, "link": "https://stackoverflow.com/questions/53747565/writing-a-loop-that-has-multiple-criteria", "title": "Writing a loop that has multiple criteria", "body": "<p>I am trying to replace values in a column based on certain criteria. Here is my code:</p>\n\n<pre><code>   For i = .Rows.Count To 1 Step -1\n        If .Item(i) = \"w\" Or \"x\" Or \"y\" Or \"z\" Then\n\n            .Item(i) = \"A\"\n\n        End If                 \n    Next i\n</code></pre>\n\n<p>If the value in the cell is w, x, y, or z, I need it to equal \"A\". This loops works if I do each character individually but how would I go about combining the criteria together.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 1, "creation_date": 1544633001, "post_id": 53747528, "comment_id": 94347664, "body": "There are two &quot;Range&quot;-s, but only one of them is qualified with  &quot; Workbooks(&quot;A&quot;).Worksheets(&quot;Sheet1&quot;).&quot;   Each of the Range-s needs to be properly qualified,  A or B.  Just because the second one is inside parens does not mean that it inherits the outer qualification."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1544633939, "post_id": 53747528, "comment_id": 94348175, "body": "Look at <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/with-end-with-statement\" rel=\"nofollow noreferrer\">With...End With</a> to shorten the code - as @donPablo said <code>Range(&quot;A1&quot;).End(xlDown)</code> needs to be qualified to the worksheet to."}, {"owner": {"reputation": 11, "user_id": 6875624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a86b354863969019e6991d572126147?s=128&d=identicon&r=PG&f=1", "display_name": "H. Watkins", "link": "https://stackoverflow.com/users/6875624/h-watkins"}, "edited": false, "score": 0, "creation_date": 1544634235, "post_id": 53747528, "comment_id": 94348307, "body": "Thanks.  I looked up qualifying an object, and tried adding this to my code, along with changing the references, but I still have the problem. :  Dim ws1 As Worksheet Set ws1 = Workbooks(&quot;Submittals&quot;).Worksheets(&quot;Sheet1&quot;) Dim ws2 As Worksheet Set ws2 = Workbooks(&quot;Previous&quot;).Worksheets(&quot;Sheet1&quot;)      How do I qualify worksheets from two different workbooks?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544636669, "post_id": 53747528, "comment_id": 94349689, "body": "@H.Watkins Please edit your fully updated code - there&#39;s a good chance that you&#39;re still not fully qualifying all your <code>Range</code>s."}, {"owner": {"reputation": 11, "user_id": 6875624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a86b354863969019e6991d572126147?s=128&d=identicon&r=PG&f=1", "display_name": "H. Watkins", "link": "https://stackoverflow.com/users/6875624/h-watkins"}, "edited": false, "score": 0, "creation_date": 1544643415, "post_id": 53747528, "comment_id": 94353052, "body": "Unfortunately, I am still confused about how to qualify the range to the worksheet.  Any more suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6875624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a86b354863969019e6991d572126147?s=128&d=identicon&r=PG&f=1", "display_name": "H. Watkins", "link": "https://stackoverflow.com/users/6875624/h-watkins"}, "edited": false, "score": 0, "creation_date": 1544649848, "post_id": 53750362, "comment_id": 94355768, "body": "Thanks so much! I finally understand what everyone was trying to tell me.  Blessings!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1544685796, "post_id": 53750362, "comment_id": 94365855, "body": "Please note that you cannot use <code>Integer</code> for row counting variables. Excel has more rows than <code>Integer</code> can handle and <code>.Count</code> returns a <code>Long</code>! Therefore both variables need to be of type <code>Long</code>. \u2022 Regardless I recommend <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA since there is no benefit in <code>Integer</code> at all."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1544644115, "creation_date": 1544644115, "answer_id": 53750362, "question_id": 53747528, "link": "https://stackoverflow.com/questions/53747528/accessing-two-different-workbooks-from-personal-macro/53750362#53750362", "title": "Accessing two different workbooks from personal macro", "body": "<p>You still had 2 unqualified <code>Range</code>s in your updated code - I've fully qualified them for you below:</p>\n\n<pre><code>Sub Copy_and_Paste()\n\n    Dim ws1 As Worksheet: Set ws1 = Workbooks(\"Submittals\").Worksheets(\"Sheet1\")\n    Dim ws2 As Worksheet: Set ws2 = Workbooks(\"Previous\").Worksheets(\"Sheet1\")\n    Dim num_rows_A As Integer\n    Dim num_rows_B As Integer\n\n    num_rows = ws1.Range(\"A1\", ws1.Range(\"A1\").End(xlDown)).Count\n\n    MsgBox (\"Num rows in A = \" &amp; num_rows)\n\n    num_rows_B = ws2.Range(\"A1\", ws2.Range(\"A1\").End(xlDown)).Count\n\n    MsgBox (\"Num rows in B = \" &amp; num_rows_B)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6875624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a86b354863969019e6991d572126147?s=128&d=identicon&r=PG&f=1", "display_name": "H. Watkins", "link": "https://stackoverflow.com/users/6875624/h-watkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580801631, "creation_date": 1544632696, "last_edit_date": 1580801631, "question_id": 53747528, "link": "https://stackoverflow.com/questions/53747528/accessing-two-different-workbooks-from-personal-macro", "title": "Accessing two different workbooks from personal macro", "body": "<p>I have a personal macro which accesses two different workbooks.</p>\n\n<p>Here is the updated code:</p>\n\n<pre><code>Sub Copy_and_Paste()\n    Dim ws1 As Worksheet Set ws1 = Workbooks(\"Submittals\").Worksheets(\"Sheet1\") \n    Dim ws2 As Worksheet Set ws2 = Workbooks(\"Previous\").Worksheets(\"Sheet1\") \n    Dim num_rows_A As Integer\n    Dim num_rows_B As Integer\n\n    num_rows = ws1.Range(\"A1\", Range(\"A1\").End(xlDown)).Count\n\n    MsgBox (\"Num rows in A = \" &amp; num_rows)\n\n    num_rows_B = ws2.Range(\"A1\", Range(\"A1\").End(xlDown)).Count\n\n    MsgBox (\"Num rows in B = \" &amp; num_rows_B)\nEnd Sub\n</code></pre>\n\n<p>When I run the code, if A is active, then the MsgBox for A works, but for B I get this error:</p>\n\n<blockquote>\n  <p>Run time error '1004' Application-defined or object-defined error.</p>\n</blockquote>\n\n<ul>\n<li><p>If B is active, I get the error.  </p></li>\n<li><p>If I comment out all three lines related to A, the MsgBox for B works fine.</p></li>\n</ul>\n\n<p>Any idea what I can do to access both workbooks?</p>\n\n<p>I do not understand what qualifying a range to a worksheet means.  Any suggestions of where I can go to read about this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10781928, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HBO9c21gJrA/AAAAAAAAAAI/AAAAAAAAHjc/B4lX5Y7f_Vo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10781928/scott"}, "edited": false, "score": 0, "creation_date": 1544701997, "post_id": 53747717, "comment_id": 94374273, "body": "Worked perfect thanks.  Still curious why the paste would not work but now knowing this I can&#39;t imagine a situation where this wouldn&#39;t just replace a paste."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 10781928, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HBO9c21gJrA/AAAAAAAAAAI/AAAAAAAAHjc/B4lX5Y7f_Vo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10781928/scott"}, "edited": false, "score": 0, "creation_date": 1544705456, "post_id": 53747717, "comment_id": 94376122, "body": "My pleasure. You weren&#39;t copying anything in your code. I think VBA clears the clipboard."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1544633390, "creation_date": 1544633390, "answer_id": 53747717, "question_id": 53747491, "link": "https://stackoverflow.com/questions/53747491/paste-a-copied-data-range-in-all-open-workbooks-using-a-loop/53747717#53747717", "title": "Paste a copied data range in all open workbooks using a loop", "body": "<p>You don't need to copy and paste, you can transfer the value directly, but you need to specify the origin (unless your code accesses the clipboard).</p>\n\n<pre><code>Sub UpdateMatrix()\n\nDim wb As Workbook\n\nFor Each wb In Workbooks\n    If wb.Name &lt;&gt; \"FILE NAME.xlsm\" Then\n        With wb.Sheets(\"Sheet 1\")\n            .Unprotect \"password\"\n            'in the line below you need to specify the source cell (and sheet)\n            .Range(\"A5\").Value = Workbooks(\"FILE NAME.xlsm\").Sheets(1).Range(\"A1\").Value\n            .Protect \"password\", True, True\n        End With\n    End If\nNext wb\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10781928, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HBO9c21gJrA/AAAAAAAAAAI/AAAAAAAAHjc/B4lX5Y7f_Vo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10781928/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 53747717, "answer_count": 1, "score": 0, "last_activity_date": 1544672355, "creation_date": 1544632596, "last_edit_date": 1544672355, "question_id": 53747491, "link": "https://stackoverflow.com/questions/53747491/paste-a-copied-data-range-in-all-open-workbooks-using-a-loop", "title": "Paste a copied data range in all open workbooks using a loop", "body": "<p>I am trying to set up a VBA macro to loop through all open files and  paste the same range of cells on each workbook in the loop.  I was able to do essentially the reverse of this process with the simple macro below (LoopEachOpenWorkbook) I would copy a range from each open workbook and paste it into a central workbook so I could aggregate all the data.  </p>\n\n<pre><code> Sub LoopEachOpenWorkbook()\n\nDim wb As Workbook\n\n For Each wb In Workbooks\n\n      If wb.Name &lt;&gt; \"FILE NAME.xlsm\" Then\n\n              wb.Activate\n\n              ActiveWindow.WindowState = xlNormal\n\n              Sheets(\"Sheet1\").Select\n\n              Range(\"A2:S20\").Select\n\n              Selection.Copy\n\n              Windows(\"FILE NAME.xlsm\").Activate\n\n              Range(\"A1\").Select\n\n              Selection.End(xlDown).Select\n\n              ActiveCell.Offset(1).Select\n\n             ActiveSheet.Paste Link:=True\n\n    End If\n    Next wb\n    End Sub\n</code></pre>\n\n<p>I figured I would be able to use a similar method to update each workbook with a new data set.  I attempted this with macro listed below (Update Matrix).  What my hope was that I could just copy the data I wanted so that it was on the clipboard and the macro would simply paste what was already in the clipboard.  I also tried this with including the copy within the macro but prior to the loop.  No matter what I try I am still getting an error on the line of code to paste.  I have tried various ways  to paste and I am still getting the error.  </p>\n\n<pre><code>Sub Update Matrix()\n\nDim wb As Workbook\n\n\n\n\n\nFor Each wb In Workbooks\n\n  If wb.Name &lt;&gt; \"FILE NAME.xlsm\" Then\n\n\n\n          wb.Activate\n\n          ActiveWindow.WindowState = xlNormal\n\n          Sheets(\"Sheet 1\").Select\n\n          ActiveSheet.Unprotect \"password\"\n\n          Range(\"A5\").Select\n\n          Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n\n        :=False, Transpose:=False\n\n          ActiveSheet.Protect \"password\", True, True\n\n          Sheets(\"Sheet 2\").Select\n\n\n\n  End If\n\nNext wb\n</code></pre>\n\n<p>Does the copy need to be included in the macro and furthermore within the loop?  Would I have to go back to my source workbook and re-copy the range for each time I paste into the new workbook in the loop?  Any help would be greatly appreciated.  </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1544631077, "post_id": 53746997, "comment_id": 94346558, "body": "Please format your code..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1544631156, "post_id": 53746997, "comment_id": 94346609, "body": "You can only have one change event per sheet so you need to combine into a single sub. There might be other issues. Have you placed the code in the relevant sheet module?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1544632471, "post_id": 53746997, "comment_id": 94347353, "body": "Just curious, why are you doing it this way?"}, {"owner": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 0, "creation_date": 1544632677, "post_id": 53746997, "comment_id": 94347479, "body": "because I had some troubles with the conditional formatting tool and using vba code. Colours cannot be identified otherwise..."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 0, "creation_date": 1544632993, "post_id": 53747494, "comment_id": 94347658, "body": "thank you! unfortunately only the range E18:G18 works. for all others there are no changes, just plain white cells..."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 1, "creation_date": 1544633652, "post_id": 53747494, "comment_id": 94348045, "body": "False. Insert the above code into a blank excel sheet... change the value of cell <code>B3</code> to 3 it turns green. Change the value of <code>B4</code> to 0 it turns red. Change the value of <code>B1</code> to 1 it turns yellow. What&#39;s not working for you?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 2, "creation_date": 1544633796, "post_id": 53747494, "comment_id": 94348121, "body": "I did see one error in code on your AND statement. I corrected that in the answer."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 1, "creation_date": 1544640759, "post_id": 53747494, "comment_id": 94351737, "body": "Yeah... I typed the variable wrong. That tends to matter... sorry. I corrected it. Also see my comment about using a named range instead of the hard-coded addresses."}, {"owner": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 0, "creation_date": 1544646201, "post_id": 53747494, "comment_id": 94354288, "body": "PGCodeRider: Thank you for the comment - what do you mean with named ranges?"}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 2, "last_activity_date": 1544640726, "last_edit_date": 1544640726, "creation_date": 1544632609, "answer_id": 53747494, "question_id": 53746997, "link": "https://stackoverflow.com/questions/53746997/use-excel-vba-to-colour-a-range-y-if-value-is-certain-number-is-placed-and-colou/53747494#53747494", "title": "Use Excel-VBA to colour a range y if value is certain number is placed AND colour range x if value is certain number is placed", "body": "<p>As mentioned in the comments, you can only have one <code>Worksheet_Change</code> subroutine. This code should get you what you need:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rngObserve As Range, rngCell As Range\n\n'PGCodeRider comment: I'd set these to named ranges instead of hard-coded addresses\nSet rngObserve = Intersect(Target, Range(\"E18:G18, K1:K10\"))\n\n    If Not rngObserve Is Nothing Then\n\n        For Each rngCell In rngObserve.Cells\n\n    If rngCell.Value = vbNullString Then\n        rngCell.Interior.Color = xlNone\n    ElseIf rngCell.Value &lt; 1 Then\n        rngCell.Interior.ColorIndex = 3 'red\n    ElseIf rngCell.Value &gt;= 1 Then\n        rngCell.Interior.ColorIndex = 4 'green\n    Else\n        rngCell.Interior.ColorIndex = 3 'red\n    End If\n\n        Next rngCell\n\n    End If\n\n\nSet rngObserve = Intersect(Target, Range(\"B1:B10\"))\n\n    If Not rngObserve Is Nothing Then\n\n        For Each rngCell In rngObserve.Cells\n\n            If rngCell.Value = vbNullString Then\n                rngCell.Interior.Color = xlNone\n            ElseIf rngCell.Value &lt; 3 And rngCell.Value &gt; 0 Then\n                rngCell.Interior.ColorIndex = 6 'yellow\n            ElseIf rngCell.Value &gt;= 3 Then\n                rngCell.Interior.ColorIndex = 4 'green\n            Else\n                rngCell.Interior.ColorIndex = 3 'red\n            End If\n\n        Next rngCell\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 53747494, "answer_count": 1, "score": 0, "last_activity_date": 1544640726, "creation_date": 1544630878, "last_edit_date": 1592644375, "question_id": 53746997, "link": "https://stackoverflow.com/questions/53746997/use-excel-vba-to-colour-a-range-y-if-value-is-certain-number-is-placed-and-colou", "title": "Use Excel-VBA to colour a range y if value is certain number is placed AND colour range x if value is certain number is placed", "body": "<p>I need to program a conditional format in Excel VBA (2016) without using the existing conditional formatting tool. As I am a newbie and tried for a while the following, I'm asking you to help me.</p>\n<p>I want to write this e.g. in a private sub: for range E18:G18 and K1:K10:</p>\n<blockquote>\n<p>If value is &gt;=1 then colour = green</p>\n<p>If value is &lt;1 or &quot;&quot; then colour red</p>\n</blockquote>\n<p>for range B1:B10</p>\n<blockquote>\n<p>If value is &gt;=3 then colour = green</p>\n<p>If value is &lt;3 &amp; &gt;0 then colour yellow</p>\n<p>if value is  0 or &quot;&quot; the colour red</p>\n</blockquote>\n<p>My code is the following - when i save it, nothing happens in my second defined range (K1:K10), also after reopening the excel-workbook.</p>\n<p>Also nothing happens with my second conditional formatting range (B1:B10):</p>\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rngObserve As Range, rngCell As Range\n\nSet rngObserve = Intersect(Target, Range(&quot;E18:G18, K1:K10&quot;))\n\nIf rngObserve Is Nothing Then\n    Exit Sub\nEnd If\nFor Each rngCell In rngObserve.Cells\n    If Not Intersect(rngCell, rngObserve) Is Nothing Then\n        If rngCell.Value = vbNullString Then\n            rngCell.Interior.Color = xlNone\n        ElseIf rngCell.Value &lt; 1 Then\n            rngCell.Interior.ColorIndex = 3 'red\n        ElseIf rngCell.Value &gt;= 1 Then\n            rngCell.Interior.ColorIndex = 4 'green\n        Else\n            rngCell.Interior.ColorIndex = 3 'red\n        End If\n    End If\nNext\n\n\n\nDim rngObserve As Range, rngCell As Range\n\nSet rngObserve = Intersect(Target, Range(&quot;B1:B10&quot;))\n\nIf rngObserve Is Nothing Then\n    Exit Sub\nEnd If\nFor Each rngCell In rngObserve.Cells\n    If Not Intersect(rngCell, rngObserve) Is Nothing Then\n        If rngCell.Value = vbNullString Then\n            rngCell.Interior.Color = xlNone\n        ElseIf rngCell.Value &lt; 3 And rgncell.Value &gt; 0 Then\n            rngCell.Interior.ColorIndex = 6 'yellow\n        ElseIf rngCell.Value &gt;= 3 Then\n            rngCell.Interior.ColorIndex = 4 'green\n        Else\n            rngCell.Interior.ColorIndex = 3 'red\n        End If\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1544631176, "post_id": 53746928, "comment_id": 94346619, "body": "You may want to look into using the <code>MSXML</code> libraries to generate a proper xlm that should. This way you can build the whole structure and then write it to a file at once, a temporary solution could also be to write your output to a string and only then to a file."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1544632742, "post_id": 53746928, "comment_id": 94347523, "body": "Have you tried building a query in the format you want to export and then just export that using the built in XML export tool?  <a href=\"http://www.brileigh.com/microsoft-access/export-xml-data-from-microsoft-access-tricks-and-traps/\" rel=\"nofollow noreferrer\">brileigh.com/microsoft-access/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1544630961, "creation_date": 1544630961, "answer_id": 53747019, "question_id": 53746928, "link": "https://stackoverflow.com/questions/53746928/file-output-is-not-as-expected/53747019#53747019", "title": "File output is not as expected", "body": "<p>I strongly recommend not using <code>Print</code> if you want reliable output in files. Access's text mode printing is known to cause trouble, since it includes a lot of logic to do things like concatenating variables and writing non-text variables to CSV.</p>\n\n<p>Instead, use binary writing to be in control of what actually gets written to the file.</p>\n\n<pre><code> Open XMLPath &amp; dblFoo &amp; \".xml\" For Binary Access Write As #15\n Put #15, , \"&lt;?xml version=\" &amp; Q &amp; \"1.0\" &amp; Q &amp; \" encoding=\" &amp; Q &amp; \"utf-8\" &amp; Q &amp; \"?&gt;\" &amp; vbCrLf\n Put #15, ,\"&lt;main&gt;\" &amp; vbCrLf\n 'Etc\n Close #15\n</code></pre>\n\n<p>Also note that this is low-level file IO, that means, each write statement is sent to the disk without buffering. I strongly recommend writing the whole string at once, and not using tons of little <code>Print</code>/<code>Put</code> statements. Else, performance will suffer, especially on network drives.</p>\n\n<p>Note that you specify <em>encoding=utf-8</em> in your XML file, but you're certainly not encoding it as UTF-8 if you're writing it to a file this way, though.</p>\n"}], "owner": {"reputation": 1752, "user_id": 1760335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83fa9f50c53a4b905db585e3fe2d26e2?s=128&d=identicon&r=PG", "display_name": "Bert", "link": "https://stackoverflow.com/users/1760335/bert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53747019, "answer_count": 1, "score": 1, "last_activity_date": 1544644462, "creation_date": 1544630652, "last_edit_date": 1544644462, "question_id": 53746928, "link": "https://stackoverflow.com/questions/53746928/file-output-is-not-as-expected", "title": "File output is not as expected", "body": "<p>The following piece of code is giving unexpected results, but very rarely. It works about 99% of the time. It should be outputting an XML file.</p>\n\n<pre><code> Open XMLPath &amp; dblFoo &amp; \".xml\" For Output As #15\n Print #15, \"&lt;?xml version=\" &amp; Q &amp; \"1.0\" &amp; Q &amp; \" encoding=\" &amp; Q &amp; \"utf-8\" &amp; Q &amp; \"?&gt;\"\n Print #15, \"&lt;main&gt;\"\n Print #15, \"&lt;general&gt;\"\n Print #15, \"&lt;foo&gt;BAR&lt;/foo&gt;\"\n Print #15, \"&lt;/general&gt;\"\n Print #15, \"&lt;foobar_entry&gt;\"\n Print #15, \"&lt;bar_name&gt;\" &amp; Replace(dblFoo, \".\", \"_\") &amp; \"_\" &amp; someOtherVal &amp; \"_F0\" &amp; \"&lt;/bar_name&gt;\"\n `\n ` some more tag printing\n `\n Print #15, \"&lt;/foobar_entry&gt;\"\n Print #15, \"&lt;/main&gt;\"\n Close #15\n</code></pre>\n\n<p>Now, the 'bad part' of the output XML file will look like this:</p>\n\n<pre><code> &lt;/general&gt;\n try&gt;\n ... rest of file looks normal\n</code></pre>\n\n<p>In this case the first part of <code>&lt;foobar_entry&gt;</code> has been cut off.</p>\n\n<p>Another error it will show is:</p>\n\n<pre><code> &lt;/main&gt;\n NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL NUL\n</code></pre>\n\n<p>Where NUL is ASCII code 0.</p>\n\n<p>Could garbage data be output to the file that would move the current read/write position in the file?</p>\n\n<p>Is this just a matter of two people calling the function at the same time? It is an Access application after all, with many users on the system.</p>\n\n<p>There doesn't seem be any error checking code when writing to the file or opening the file.</p>\n"}, {"tags": ["excel", "vba", "excel-2013", "powerquery"], "comments": [{"owner": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "edited": false, "score": 1, "creation_date": 1544805842, "post_id": 53746908, "comment_id": 94418925, "body": "It is true that you cannot create or delete a query in Excel where PQ is installed as an Add-On. It&#39;s also not clear why you would need to do that here. You can refresh an output table that is linked to PQ from VBA, and you can use VBA to alter a Query indirectly by setting parameters that are loaded into PQ from the Excel workbook (look up &quot;power query parameter table&quot; for a number of ways to do this)."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "edited": false, "score": 0, "creation_date": 1544810970, "post_id": 53746908, "comment_id": 94421204, "body": "Ok I&#39;ll look that up, thanks."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "edited": false, "score": 0, "creation_date": 1544811102, "post_id": 53746908, "comment_id": 94421261, "body": "The reason I delete/recreate is because I was getting random and intermittent errors when using VBA to refresh a query. I could never figure out the rhyme nor the reason. I discovered that completely removing the query and then recreating it solved this problem."}, {"owner": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "edited": false, "score": 0, "creation_date": 1545064758, "post_id": 53746908, "comment_id": 94487351, "body": "When refreshing queries from VBA it is often useful to disable the &quot;Enable Background Refresh&quot; option on the query (either from the UI or temporarily through VBA). This will cause Excel (and the VBA script) to pause until the query is finished refreshing, which is important if you are doing anything with the results of query in VBA."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "edited": false, "score": 0, "creation_date": 1545082530, "post_id": 53746908, "comment_id": 94495364, "body": "Yes, I tried that as well back then and this did not prevent the error. The frustrating part was that it did not occur consistently. I&#39;d run several successful tests and it would work for a few to several days and then out of nowhere the error would return. Since adopting the delete and recreate method, the error has not manifested."}], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544631782, "creation_date": 1544630603, "last_edit_date": 1544631782, "question_id": 53746908, "link": "https://stackoverflow.com/questions/53746908/can-i-automate-the-creation-of-a-query-in-power-query-in-office-2013", "title": "Can I automate the creation of a query in Power Query in Office 2013", "body": "<p>I'm leaning towards Power Query more and more now as an extraction and data-merging tool (in combination with VBA). This creates trouble in some instances since our enterprise is a mix of Office 2013 and 2016. I've designed a tool in 2016 that automates the deletion and creation of queries, but it doesn't work in 2013. My solution was to develop an alternative solution for 2013 users, but it appears that query creation can't be automated in this environment. Is this true?</p>\n\n<p>I'm importing two Excel files into Power Query for filtering and field arrangement, then merging the two data sets to produce one table with everything I need. In 2016, I'm able to fully automate this process. I've tried a few techniques with the macro recorder in 2013 and have had no success capturing any of the query creation steps. The fact that PQ is an add-on to 2013 is probably the reason for this, but I'm curious if someone has discovered a work-around.</p>\n\n<p>Upgrading everyone to 2016 is not an option.</p>\n\n<p>I found this and I'm about to try it out:</p>\n\n<p><a href=\"https://www.excelguru.ca/blog/2014/10/22/refresh-power-query-with-vba/\" rel=\"nofollow noreferrer\">https://www.excelguru.ca/blog/2014/10/22/refresh-power-query-with-vba/</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1544630467, "post_id": 53746770, "comment_id": 94346223, "body": "See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid using <code>.Select</code>/<code>.Activate</code></a>.  It&#39;s likely due to your use of <code>ActiveCell</code> after you switch worksheets."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1544631381, "post_id": 53746770, "comment_id": 94346748, "body": "<code>ActiveCell.Offset(-10,-7).Range(&quot;A1&quot;)</code>... that&#39;s weird. What are you trying to do here? Whatever it is it can probably be done with a single line of code like <code>Range(&quot;A1&quot;).Copy Destination:=Sheets(&quot;Data Presentation Template&quot;).Range(&quot;A1&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 10781749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08ddb9c198d0a5afae63187d6a9651fc?s=128&d=identicon&r=PG&f=1", "display_name": "Knowledgeseeker", "link": "https://stackoverflow.com/users/10781749/knowledgeseeker"}, "edited": false, "score": 0, "creation_date": 1544631774, "post_id": 53746770, "comment_id": 94346984, "body": "I have a form which is used for data entry, then I want the same data to be mirror onto a presentation sheet automatically."}, {"owner": {"reputation": 1, "user_id": 10781749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08ddb9c198d0a5afae63187d6a9651fc?s=128&d=identicon&r=PG&f=1", "display_name": "Knowledgeseeker", "link": "https://stackoverflow.com/users/10781749/knowledgeseeker"}, "edited": false, "score": 0, "creation_date": 1544631888, "post_id": 53746770, "comment_id": 94347046, "body": "I used &quot;=&quot; to mirror the data, which worked, but when I run a Macro to reset the form and the presentation sheet, the formula bar gets wiped out too."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10781941"}, "is_accepted": false, "score": 1, "last_activity_date": 1544632712, "last_edit_date": 1544632712, "creation_date": 1544632039, "answer_id": 53747331, "question_id": 53746770, "link": "https://stackoverflow.com/questions/53746770/vba-active-sheet-issue/53747331#53747331", "title": "VBA, active sheet issue", "body": "<p>Your ActiveCell.Offset(<em>r</em>, <em>c</em>) commands use negative numbers. These will depend on whether the currently active cell is in a position where the negative offsets don't try to .Select a cell that is either off the worksheet to the left of column A or a cell that is above row 1.</p>\n\n<pre><code>ActiveCell.Offset(-10, -7).Range(\"A1\").Select\n</code></pre>\n\n<p>This demands that the ActiveCell is at least 10 rows down and 7 columns right from A1; specifically K8 or to the right/down of K8. Anything closer to A1 will produce an error since you are trying to select a cell that is off the worksheet.</p>\n\n<pre><code>ActiveCell.Offset(-25, -6).Range(\"A1\").Select\n</code></pre>\n\n<p>The same for this statement but the minimal distance for the ActiveCell from A1 would be Z7.</p>\n\n<p>The ActiveCell property changes every time you select another cell. It cannot be relied upon to 'automatically transfer' data between worksheets unless you check to ensure that the ActiveCell is where you want it on each worksheet <em>before</em> running your sub procedure.</p>\n\n<p>Any further recommendations would require <strong>specific</strong> worksheet names and ranges for the source and target of the copy &amp; paste operation.</p>\n\n<hr>\n\n<p><sub>The .Range(\"A1\") in ActiveCell.Offset(-10, -7).Range(\"A1\").Select simply means the top-left cell in the ActiveCell.Offset(-10, -7) range. It is likely a 'hangover' from relative positioned macro recording.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 10781749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08ddb9c198d0a5afae63187d6a9651fc?s=128&d=identicon&r=PG&f=1", "display_name": "Knowledgeseeker", "link": "https://stackoverflow.com/users/10781749/knowledgeseeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544637115, "creation_date": 1544630171, "last_edit_date": 1544637115, "question_id": 53746770, "link": "https://stackoverflow.com/questions/53746770/vba-active-sheet-issue", "title": "VBA, active sheet issue", "body": "<p>I am trying to transfer selected data from one worksheet to another via a Transfer macro. \nEvery time I try to do so, I get the following message in Debug:</p>\n\n<pre><code>Sub Transfer Macro\n    ActiveCell.Offset(-10, -7).Range(\"A1\").Select\n\n    Selection.Copy\n\n    Sheets(\"Data Presentation Template\").Select\n\n    ActiveCell.Offset(-25, -6).Range(\"A1\").Select\n\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>Is there a better way to transfer/ mirror the data from a data entry sheet to a presentation sheet with out macro?</p>\n"}, {"tags": ["excel", "vba", "oracle", "oracle11g", "adodb"], "comments": [{"owner": {"reputation": 160176, "user_id": 266304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdb6217d08dcea7d67ff75f5f255081?s=128&d=identicon&r=PG", "display_name": "Alex Poole", "link": "https://stackoverflow.com/users/266304/alex-poole"}, "edited": false, "score": 2, "creation_date": 1544630854, "post_id": 53746703, "comment_id": 94346427, "body": "Are you sure <code>tubetab</code> is a ref cursor, and not a collection?"}, {"owner": {"reputation": 281, "user_id": 1717620, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/11f7b72e14c6043c267750f15d275e1b?s=128&d=identicon&r=PG", "display_name": "BgreenDSI", "link": "https://stackoverflow.com/users/1717620/bgreendsi"}, "reply_to_user": {"reputation": 160176, "user_id": 266304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdb6217d08dcea7d67ff75f5f255081?s=128&d=identicon&r=PG", "display_name": "Alex Poole", "link": "https://stackoverflow.com/users/266304/alex-poole"}, "edited": false, "score": 0, "creation_date": 1544632162, "post_id": 53746703, "comment_id": 94347193, "body": "@AlexPoole I&#39;m not sure. Trying to confirm. If it is a collection and not ref cursor, how should I handle that?"}, {"owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "edited": false, "score": 0, "creation_date": 1544636051, "post_id": 53746703, "comment_id": 94349328, "body": "Did you already test the stored procedure by calling it with pl/sql in Sql/Developer? Just to make sure <code>tubetab</code> is the right data type."}], "owner": {"reputation": 281, "user_id": 1717620, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/11f7b72e14c6043c267750f15d275e1b?s=128&d=identicon&r=PG", "display_name": "BgreenDSI", "link": "https://stackoverflow.com/users/1717620/bgreendsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593632794, "creation_date": 1544629925, "last_edit_date": 1544685955, "question_id": 53746703, "link": "https://stackoverflow.com/questions/53746703/oracle-ref-cursor-adodb-why-am-i-getting-pls-00306-wrong-number-of-types-of-ar", "title": "Oracle Ref Cursor ADODB - Why am I getting PLS-00306 wrong number of types of arguments", "body": "<p>Trying to return a recordset from Oracle. The procedure has an input parameter with datatype <strong>Number</strong> and an in/out parameter with Oracle's <strong>ref cursor</strong> datatype. </p>\n\n<p>Getting error: </p>\n\n<blockquote>\n  <p>PLS-00306 wrong number of types of arguments in call to \"get_random_tube_colors_pr\".</p>\n</blockquote>\n\n<h3>Oracle</h3>\n\n<pre><code>procedure get_random_tube_colors_pr(in_tube_color_id in number,\n                                tubeset in out tubetab)\n</code></pre>\n\n<h3>VBA</h3>\n\n<pre class=\"lang-vb prettyprint-override\"><code>conStr = \"User ID=ops$scxpoly;Password=password;Data Source=source;Provider=OraOLEDB.Oracle;\"\n\nWith db\n  If .state = adStateClosed Then\n     .ConnectionString = conStr\n     .CursorLocation = adUseClient\n     .Open\n  End If\nEnd With\n\nWith cmd\n    .ActiveConnection = db\n    .NamedParameters = False    \n    .CommandType = adCmdStoredProc\n    .CommandText = \"OPS$SCXPOLY.mfg_tube_colors_pk.get_random_tube_colors_pr\"       \n    .Parameters.Append .CreateParameter(\"in_tube_color_id\", adBigInt, adParamInput, , 2679)\n    .Properties(\"PLSQLRSet\") = True\n    Set rst = .Execute()\n    MsgBox Err.Number &amp; vbNewLine &amp; Err.Description\nEnd with  \n</code></pre>\n\n<p>I commented out .CreateParameter calling Oracle's ref cursor datatype:</p>\n\n<pre><code>'   .Parameters.Append .CreateParameter(\"tubeset\", adVariant, adParamReturnValue)\n</code></pre>\n\n<p>But same error - <a href=\"https://stackoverflow.com/questions/42556484/call-oracle-stored-procedure-with-vba-using-a-refcursor\">Call Oracle stored procedure with VBA using a refcursor</a></p>\n\n<p>Added <code>Properties(\"PLSQLRSet\") = TRUE</code> but still same issue\n - <a href=\"https://docs.oracle.com/cd/B28359_01/win.111/b28431/using.htm\" rel=\"nofollow noreferrer\">https://docs.oracle.com/cd/B28359_01/win.111/b28431/using.htm</a></p>\n\n<p>Also set <code>.NamedParameters = True</code>, no go.</p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1544629926, "post_id": 53746677, "comment_id": 94345826, "body": "Drop the <code>Range</code>. You just need <code>Cells(5, copy_col)</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1544629957, "post_id": 53746677, "comment_id": 94345853, "body": "None of that btw are RC reference."}, {"owner": {"reputation": 60, "user_id": 9968466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh78R.jpg?s=128&g=1", "display_name": "Pawels", "link": "https://stackoverflow.com/users/9968466/pawels"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1544630288, "post_id": 53746677, "comment_id": 94346101, "body": "Oh, I see. Thanks a lot, works"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1544630462, "post_id": 53746677, "comment_id": 94346221, "body": "That&#39;s ok. Eg see this <a href=\"https://bettersolutions.com/excel/formulas/cell-references-a1-r1c1-notation.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/excel/formulas/&hellip;</a>"}], "owner": {"reputation": 60, "user_id": 9968466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh78R.jpg?s=128&g=1", "display_name": "Pawels", "link": "https://stackoverflow.com/users/9968466/pawels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580458421, "creation_date": 1544629857, "last_edit_date": 1580458421, "question_id": 53746677, "link": "https://stackoverflow.com/questions/53746677/copy-to-range-specified-by-variable-reference", "title": "Copy to range specified by variable reference", "body": "<p>I need to copy a range to different part of the sheet that can differ in a column used. I recently introduced the variable copy_col to the code that tries to make the destination area flexible and I am using it as a part of R1C1 reference as below. Yet I am receiving 1004 error when running the code. Can anyone help with what I have wrong please?</p>\n\n<pre><code>Range(\"C\" &amp; cell2_row + 1 &amp; \":E\" &amp; cell_row).Copy Destination:=Sheets(\"SQL_Structure\").Range(Cells(5, copy_col)) \n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1544628668, "post_id": 53746111, "comment_id": 94345003, "body": "Well the price (47.2) isn&#39;t an object so you can assign it.. do you want to declare a <code>Double</code> and and assign the &quot;content&quot; attribute?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "reply_to_user": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1544631501, "post_id": 53746111, "comment_id": 94346822, "body": "How can I get the price 47.2?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 1, "creation_date": 1544631957, "post_id": 53746111, "comment_id": 94347073, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34357705/how-to-get-the-meta-name-keywords-vba\">how to get the meta name keywords -vba</a>"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1544632338, "post_id": 53746111, "comment_id": 94347278, "body": "What did you assign to meta_tag and meta_name variables?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1544635063, "post_id": 53746111, "comment_id": 94348731, "body": "Documents is already loaded (<code>Debug.Print ie:Document.body</code>  shows the html)? If not wait till loaded.)"}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "is_accepted": false, "score": 0, "last_activity_date": 1544632087, "creation_date": 1544632087, "answer_id": 53747343, "question_id": 53746111, "link": "https://stackoverflow.com/questions/53746111/getting-meta-property-from-a-url/53747343#53747343", "title": "Getting meta property from a URL", "body": "<p>I think since this piece of the html is not an object or element you wont be able to use this method (the object would have a div and an id or class property that you could search for). What you would need to do is find the element this is in and access it that way. Something like this: <code>ie.document.getElementsByClassName(\"class name like Product info or something maybe\")(0).getElementsByTagName(\"meta\").textcontent</code></p>\n\n<p>Note: <code>.textcontent</code> is faster and unformatted unlike <code>.innertext</code></p>\n\n<p>if a div does not have an id or class property then it is a child and you will have to navigate from the parent using <code>.Children(0)</code> and/or <code>.nextElementSibling</code></p>\n\n<p>This website has a lot of good information that would help I would look here since without more of the html I am unable to help:</p>\n\n<p><a href=\"http://automatetheweb.net/common-vba-methods-properties-web-automation/\" rel=\"nofollow noreferrer\">http://automatetheweb.net/common-vba-methods-properties-web-automation/</a></p>\n"}, {"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1544632215, "creation_date": 1544632215, "answer_id": 53747375, "question_id": 53746111, "link": "https://stackoverflow.com/questions/53746111/getting-meta-property-from-a-url/53747375#53747375", "title": "Getting meta property from a URL", "body": "<p>First you have to get the meta tags:</p>\n\n<pre><code>Dim metaElements\nSet metaElements = ie.Document.GetElementsByTagName(\"meta\")\n</code></pre>\n\n<p>Then loop through them looking for the property:</p>\n\n<pre><code>Dim element\nFor Each element In metaElements\n    If element.Name = \"product:price:amount\" Then\n        Dim price \n        price = element.Content\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1544636840, "post_id": 53747920, "comment_id": 94349781, "body": "Why I get Nothing on price but when I do the similar Set price = ie.Document.querySelector(&quot;meta[property=&#39;product:price:amou&zwnj;&#8203;nt&#39;]&quot;)         wks.Cells(i, &quot;D&quot;).Value = price.Content I get the amount?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544637153, "post_id": 53747920, "comment_id": 94349913, "body": "what do you mean nothing on price?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1544637412, "post_id": 53747920, "comment_id": 94350041, "body": "The variable price has not a value inside"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544637475, "post_id": 53747920, "comment_id": 94350071, "body": "there is no innerText to the tag. The price is in the content attribute of the element."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1544635755, "last_edit_date": 1544635755, "creation_date": 1544634073, "answer_id": 53747920, "question_id": 53746111, "link": "https://stackoverflow.com/questions/53746111/getting-meta-property-from-a-url/53747920#53747920", "title": "Getting meta property from a URL", "body": "<p>You have several options but if you want to refer to <code>product...</code>; that is the value of the attribute <code>property</code>, so you would need an attribute = value css selector. Attribute selectors are denoted by <code>[]</code>. Furthermore, to avoid confusing with psuedo class selector syntax the value of the attribute, which contains <code>:</code>, must be entirely encased within <code>''</code>.</p>\n\n<pre><code>ie.document.querySelector(\"meta[property='product:price:amount']\").Content\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "accepted_answer_id": 53747920, "answer_count": 3, "score": 1, "last_activity_date": 1580458447, "creation_date": 1544627910, "last_edit_date": 1580458447, "question_id": 53746111, "link": "https://stackoverflow.com/questions/53746111/getting-meta-property-from-a-url", "title": "Getting meta property from a URL", "body": "<p>I am trying to get the price of product from URL and it has </p>\n\n<pre><code>&lt;meta property=\"product:price:amount\" content=\"47.2\" /&gt;\n</code></pre>\n\n<p>I tried the following to get it but it does not work</p>\n\n<pre><code>Set price = ie.Document.querySelector(\"product:price:amount\")\nworksheet.Cells(i, \"D\").Value = price.innerText\n</code></pre>\n\n<p>As well as </p>\n\n<pre><code>Set Doc = ie.Document\nSet metaElements = Doc.all.tags(meta_tag)\n\n   For Each element In metaElements\n\n    If element.name = meta_name Then\n    keywd = element.Content\n    wks.Cells(i, \"C\").Value = keywd\n    End If\n\n   Next\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544629333, "post_id": 53746205, "comment_id": 94345437, "body": "unfortunately it gives me textbox1 as invalid qualifier :( How would this work if I wanted inputbox instead of textbox, please?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1544630127, "post_id": 53746205, "comment_id": 94345964, "body": "#dd.mm.yyyy# is not a valid date format in JET SQL. #01.02.2011# will get interpreted as the 2nd of January 2011, not the first of February..."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1544638003, "post_id": 53746205, "comment_id": 94350342, "body": "Well, i guess youre right. To store that format in the table it would need to be text."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1544640300, "post_id": 53746205, "comment_id": 94351483, "body": "Storing a date as text is all kinds of wrong. Always use the proper variable type to store information. Formatting is a consideration for output of data; it should never be a consideration for data storage."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1544642536, "post_id": 53746205, "comment_id": 94352612, "body": "i was only commenting that for the OP - if he actually needs it stored in that fashion thats how. I never said anything about condoning that behavior."}, {"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544643013, "post_id": 53746205, "comment_id": 94352812, "body": "So no straightfoward answer I assume :)"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": -1, "last_activity_date": 1544637980, "last_edit_date": 1544637980, "creation_date": 1544628188, "answer_id": 53746205, "question_id": 53746067, "link": "https://stackoverflow.com/questions/53746067/how-to-add-date-from-the-inputbox-to-populate-the-whole-column-in-chosen-access/53746205#53746205", "title": "How to add date from the inputbox to populate the whole column in chosen Access table by the use of VBA", "body": "<pre><code>Dim vbSql as string\nvbSql = \"UPDATE tbl SET column=#\" &amp; Format(textBox1.Value, \"dd.mm.yyyy\") &amp; \"#;\"\nDoCmd.RunSql vbSql\n</code></pre>\n\n<p>stick this in the appropriate event. Obviously rename tbl, column and textbox1 to what objects youre actually using. </p>\n\n<p>edit for Erik</p>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1544640872, "creation_date": 1544640872, "answer_id": 53749598, "question_id": 53746067, "link": "https://stackoverflow.com/questions/53746067/how-to-add-date-from-the-inputbox-to-populate-the-whole-column-in-chosen-access/53749598#53749598", "title": "How to add date from the inputbox to populate the whole column in chosen Access table by the use of VBA", "body": "<p>Try something like this:</p>\n\n<pre><code>Dim sDate as String\nsDate = InputBox(\"What is the date?\")\nRem Here add code to make sure sDate is in expected format \"dd.mm.yyyy\"\nDoCmd.RunSql \"UPDATE [MyTableName] SET CH_DATE=#\" &amp; Mid(sDate,4,2) &amp; \"/\" &amp; Left(sDate,2) &amp; \"/\" Right(sDate,4) &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53749598, "answer_count": 2, "score": -2, "last_activity_date": 1544640872, "creation_date": 1544627740, "last_edit_date": 1544634012, "question_id": 53746067, "link": "https://stackoverflow.com/questions/53746067/how-to-add-date-from-the-inputbox-to-populate-the-whole-column-in-chosen-access", "title": "How to add date from the inputbox to populate the whole column in chosen Access table by the use of VBA", "body": "<p>I would like to know how to add date (dd.mm.yyyy) with the use of inputbox to populate the whole column in chosen Access table by the use of VBA.\nAs here:</p>\n\n<p>Inserted 12.07.2018 into the Inputbox</p>\n\n<pre><code>BNAME|CH_DATE\nsdjfj|12.07.2018\nsdjdf|12.07.2018\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["mysql", "sql", "vba", "vb.net", "seek"], "comments": [{"owner": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1544627884, "post_id": 53746042, "comment_id": 94344516, "body": "If the content of the file doesn&#39;t change (except if appended) then you should consider storing the position inside the files. It&#39;s much easier to say &quot;read the line starting at position 23423&quot; instead of &quot;read the 423th line&quot;"}, {"owner": {"reputation": 341, "user_id": 9661260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696b4f4a7892396d5828d00157a2874d?s=128&d=identicon&r=PG&f=1", "display_name": "K.Madden", "link": "https://stackoverflow.com/users/9661260/k-madden"}, "reply_to_user": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1544628101, "post_id": 53746042, "comment_id": 94344648, "body": "Sorry @the_lotus don&#39;t think I full quite understand"}, {"owner": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1544628207, "post_id": 53746042, "comment_id": 94344725, "body": "You need to call ReadLine until you get to the line you want. If you stored the position of that line (from the start of the file) you could just <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.io.filestream.seek?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">Seek</a> to that position and start reading from there."}, {"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1544631586, "post_id": 53746042, "comment_id": 94346871, "body": "For reference, here is how the file is indexed: <a href=\"https://stackoverflow.com/questions/53520276/reading-large-text-file-very-slow\" title=\"reading large text file very slow\">stackoverflow.com/questions/53520276/&hellip;</a>"}, {"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1544632103, "post_id": 53746042, "comment_id": 94347159, "body": "One thing to keep in mind here: writing a change back to the file invalidates the index I helped you create two weeks ago. You&#39;ll have to re-build the index every time you change the file."}, {"owner": {"reputation": 341, "user_id": 9661260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696b4f4a7892396d5828d00157a2874d?s=128&d=identicon&r=PG&f=1", "display_name": "K.Madden", "link": "https://stackoverflow.com/users/9661260/k-madden"}, "edited": false, "score": 0, "creation_date": 1544636077, "post_id": 53746042, "comment_id": 94349344, "body": "See I\u2019m not changing any the files I\u2019m searching in. Im just trying to like find the lines then basically copy the full line and write it into a results.txt almost"}, {"owner": {"reputation": 341, "user_id": 9661260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696b4f4a7892396d5828d00157a2874d?s=128&d=identicon&r=PG&f=1", "display_name": "K.Madden", "link": "https://stackoverflow.com/users/9661260/k-madden"}, "reply_to_user": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1544707192, "post_id": 53746042, "comment_id": 94377206, "body": "@the_lotus and Joel Coehoorn thank you very much for the advice and help got it working it seems, Posted below."}], "answers": [{"tags": [], "owner": {"reputation": 6558, "user_id": 350188, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/x8MwP.jpg?s=128&g=1", "display_name": "Stephen Turner", "link": "https://stackoverflow.com/users/350188/stephen-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1544696734, "creation_date": 1544696734, "answer_id": 53759692, "question_id": 53746042, "link": "https://stackoverflow.com/questions/53746042/optimize-sql-result-to-screenwriter/53759692#53759692", "title": "Optimize SQL result to ScreenWriter", "body": "<p>When trying to optimise performance in a piece of code like this you need to measure the performance on a call by call basis. You can do this using Visual Studio's profiling tools (see: <a href=\"https://docs.microsoft.com/en-us/visualstudio/profiling/profiling-feature-tour?view=vs-2017\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/visualstudio/profiling/profiling-feature-tour?view=vs-2017</a>)</p>\n\n<p>Once you have this data you will be able to directly see what is causing the performance issue rather than guessing. You will also have measurements so when you change your code you can see if the performance has improved or gotten worse. This again takes the guesswork out of the process, this is important as modern compilers and systems do a lot behind the scenes to improve performance but it's easy to derail these optimisations.</p>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 9661260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696b4f4a7892396d5828d00157a2874d?s=128&d=identicon&r=PG&f=1", "display_name": "K.Madden", "link": "https://stackoverflow.com/users/9661260/k-madden"}, "is_accepted": true, "score": 0, "last_activity_date": 1544715535, "last_edit_date": 1544715535, "creation_date": 1544707113, "answer_id": 53762780, "question_id": 53746042, "link": "https://stackoverflow.com/questions/53746042/optimize-sql-result-to-screenwriter/53762780#53762780", "title": "Optimize SQL result to ScreenWriter", "body": "<p>Hi guys so got one working and seems to work perfect almost instant. Was able to get it due to the help in comments!</p>\n\n<pre><code>Using sw As New StreamWriter(\"G:\\USER\\TESTRUN1.txt\")\n            For Each word As String In result\n                i = 0\n                sql = \"SELECT * FROM Test_Table WHERE DigNbr = @word\"\n                dataadapter = New SqlDataAdapter(sql, con)\n                dataadapter.SelectCommand.Parameters.AddWithValue(\"@word\", word)\n                dataset = New DataSet()\n                dataadapter.Fill(dataset, \"Test_Table\")\n\n                While i &lt; dataset.Tables(\"Test_Table\").Rows.Count\n\n                    linePos = dataset.Tables(\"Test_Table\").Rows(i).Item(4).ToString()\n                    MyFilePath = dataset.Tables(\"Test_Table\").Rows(i).Item(1).ToString()\n                    i += 1\n\n\n                    Using sr As New StreamReader(MyFilePath)\n                        sr.BaseStream.Seek(4096 * (linePos - 1), SeekOrigin.Begin)\n                        FoundWords.Add(sr.ReadLine)\n                        For Each item As String In FoundWords\n                            sw.WriteLine(item)\n\n                        Next\n                        FoundWords.Clear()\n                    End Using\n</code></pre>\n\n<p>Basically for anyone reading I used the seek method, Every line is 4096 bytes so in other words a new line starts every 4097 so with my Line Number I have which indicates which line the 13 digit number I'm looking for is on I just simply multiple it so the seek goes straight to that byte(line) and gets the line. </p>\n\n<p>e.g say number I was is on line 10, 4096 * 10 is 40960, which is where line 10 starts. Just like one the comments say, instead of search for line 55 I search basically for position (55*4096).</p>\n\n<p>I'm quite bad at explaining but hope that helps someone.</p>\n"}], "owner": {"reputation": 341, "user_id": 9661260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696b4f4a7892396d5828d00157a2874d?s=128&d=identicon&r=PG&f=1", "display_name": "K.Madden", "link": "https://stackoverflow.com/users/9661260/k-madden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53762780, "answer_count": 2, "score": 0, "last_activity_date": 1544715535, "creation_date": 1544627625, "last_edit_date": 1544707257, "question_id": 53746042, "link": "https://stackoverflow.com/questions/53746042/optimize-sql-result-to-screenwriter", "title": "Optimize SQL result to ScreenWriter", "body": "<p>I have a program that reads in a folder of files (4GB all together), indexes them, then adds them to a linked SQL database. This all occurs before the form even loads. </p>\n\n<p>Now I wish to have another file containing one 13 digit number per line and query the SQL database from VB searching for each number to return which folder, file, and line number contains that number. </p>\n\n<p>The method I have below works now, but it's slow. I need to find a much quicker way to go straight to the specific line in a file for my number and write a new line of text at that location.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim result = From n In System.IO.File.ReadLines(\"G:\\USER\\SearchThese.txt\")\n                     Select n.Substring(0, 13)\n\n\nDim MyFilePath As String\nDim linePos As String\nDim lines As String\n'-- connection\nDim con As New SqlConnection(***MY SQL CONNECTION***)\n\nDim dataset As New DataSet\nDim datatable As DataTable\nDim dataadapter As New SqlDataAdapter\nDim sql As String\n\nDim i As Integer\n\n'-- command\nDim cmd As New SqlCommand()\ncon.Open()\n\nUsing sw As New StreamWriter(\"G:\\USER\\TESTRUN1.txt\")\n    For Each word As String In result\n        i = 0\n        sql = (\"SELECT * FROM Test_Table WHERE DigNum = @word\")\n        dataadapter = New SqlDataAdapter(sql, con)\n        dataadapter.SelectCommand.Parameters.AddWithValue(\"@word\", word)\n        dataset = New DataSet()\n        dataadapter.Fill(dataset, \"Test_Table\")\n\n        While i &lt; dataset.Tables(\"Test_Table\").Rows.Count\n\n            linePos = dataset.Tables(\"Test_Table\").Rows(i).Item(4).ToString()\n            MyFilePath = dataset.Tables(\"Test_Table\").Rows(i).Item(1).ToString()\n            i += 1\n            Using sr As New StreamReader(MyFilePath)\n                For n As Integer = 1 To linePos\n                    lines = sr.ReadLine\n                Next\n                sw.WriteLine(lines)\n            End Using\n\n        End While\n\n\n   Next\n\nEnd Using\nMsgBox(\"Complete!\") \n</code></pre>\n\n<p>Like I said this works fine, but even searching for just 5 numbers takes fairly long. I'm guessing the streamreader that slows it down, but I don't know.</p>\n\n<p>For anyone asking, my database table has these columns:</p>\n\n<pre><code>DigNum | FilPth | FilDte | DteAdd | LnePos\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "edited": false, "score": 0, "creation_date": 1544628459, "post_id": 53745395, "comment_id": 94344885, "body": "Worked great! Thank you!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1544625521, "creation_date": 1544625521, "answer_id": 53745395, "question_id": 53745141, "link": "https://stackoverflow.com/questions/53745141/how-do-i-keep-my-conditional-formatting-in-my-subform-after-losing-focus/53745395#53745395", "title": "How do I keep my conditional formatting in my subform after losing focus?", "body": "<p>Method 2 is close.</p>\n\n<p>Instead, use a hidden textbox on the subform. In the Form_Current event for the subform, set the .Value property equal to the ID of the currently selected record. Then, use conditional formatting to check if the value of that textbox is equal to the value of the ID field for your subform using <em>Expression Is</em>.</p>\n"}], "owner": {"reputation": 153, "user_id": 6774429, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9e7fd3a8c197700ba3571e78ebe25d17?s=128&d=identicon&r=PG&f=1", "display_name": "Plaxerous", "link": "https://stackoverflow.com/users/6774429/plaxerous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53745395, "answer_count": 1, "score": 0, "last_activity_date": 1544625521, "creation_date": 1544624673, "question_id": 53745141, "link": "https://stackoverflow.com/questions/53745141/how-do-i-keep-my-conditional-formatting-in-my-subform-after-losing-focus", "title": "How do I keep my conditional formatting in my subform after losing focus?", "body": "<p>I have a subform where a selected record controls data displayed on the main form. I'd like the selected record on the subform to be highlighted yellow via conditional formatting.</p>\n\n<p><strong>Method 1</strong></p>\n\n<p>Setting the conditional format to \"Field Has Focus\" works when the subform has focus, but the highlighting stops when clicking outside the subform.</p>\n\n<p><strong>Method 2</strong></p>\n\n<p>Setting the conditional format to \"Expression Is\" and creating a textbox in the main form equal to the subform Record ID only highlights the first record in the subform.</p>\n\n<p><code>[SubformID] = [Forms]![frm_MainForm]![tbSubformID]</code></p>\n\n<p>Any help would be appreciated! Thanks!</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544627303, "post_id": 53745134, "comment_id": 94344201, "body": "I can&#39;t reproduce the error - your code worked fine for me. What kind of chart is it that you&#39;re trying to paste over? How many charts? There must be something else going on here causing your error. Also, what version of Word and Excel are you using? And what reference libraries?"}, {"owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544627962, "post_id": 53745134, "comment_id": 94344562, "body": "So I&#39;m only exporting <b>two clustered column charts</b> in this code and I&#39;m using <b>Excel 2016 &amp; Word 2016 on Office 365</b>. Finally, I made a reference to the <b>Microsoft Word 16.0 Object Library</b> in this particular script. The only thing I would say is &quot;Unique&quot; about my charts is that they are using a custom color scheme that I made in Excel."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544719092, "post_id": 53745134, "comment_id": 94384615, "body": "Two things to try: 1) Copy/paste as a user and try to choose the corresponding option from the paste option button; 2) Copy/paste special as a user and try to link; 3) create a new, very simple minimal workbook and test the code in the question. Reason: something may be &quot;odd&quot; in this particular workbook or with the charts. Interesting to see if Word will let them be pasted with a link, at all, and whether the problem is general or restricted to this workbook."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544632007, "post_id": 53746508, "comment_id": 94347106, "body": "I figured it was something in your chart - probably some feature that is supported by Excel but not by Word. It&#39;s hard to tell without seeing what it was you were trying to bring in."}, {"owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544632548, "post_id": 53746508, "comment_id": 94347405, "body": "Yeah I changed it to a simple line chart (the one with default formatting in Excel), just to see if the formatting had something to do with it but it doesn&#39;t appear to be the case."}], "tags": [], "owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "is_accepted": false, "score": 1, "last_activity_date": 1544629874, "last_edit_date": 1544629874, "creation_date": 1544629235, "answer_id": 53746508, "question_id": 53745134, "link": "https://stackoverflow.com/questions/53745134/export-excel-chart-to-word-using-pasteformat-is-returning-error-4605-command-not/53746508#53746508", "title": "Export Excel Chart To Word Using PasteFormat is Returning Error 4605 Command Not Available", "body": "<p>So I found a workaround to the problem, but <strong>I'm still not sure why PasteFormat will not work with a linked chart</strong>.</p>\n\n<p>If I replace:</p>\n\n<pre><code>'**THIS WILL RETURN THE ERROR**\nWith WrdApp.Selection\n    .PasteAndFormat Type:=wdChartLinked\nEnd With\n</code></pre>\n\n<p>With the following, <strong>I no longer get an error</strong>:</p>\n\n<pre><code>'**THIS WILL NOT RETURN AN ERROR**\nWith WrdApp.Selection\n    .PasteSpecial Link:=True, DataType:=wdPasteOLEObject\nEnd With\n</code></pre>\n\n<p>I guess it has to do something with the format of the chart or something, but I still find it strange that I can paste it as a picture using PasteFormat but not as a linked chart.</p>\n"}], "owner": {"reputation": 437, "user_id": 9175363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bcd92ae3d11917a924113334a96b73?s=128&d=identicon&r=PG", "display_name": "areed1192", "link": "https://stackoverflow.com/users/9175363/areed1192"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583835051, "creation_date": 1544624651, "last_edit_date": 1583835051, "question_id": 53745134, "link": "https://stackoverflow.com/questions/53745134/export-excel-chart-to-word-using-pasteformat-is-returning-error-4605-command-not", "title": "Export Excel Chart To Word Using PasteFormat is Returning Error 4605 Command Not Available", "body": "<p>So I'm trying to understand what is wrong with my code. All I'm doing is taking some charts in my Excel workbook and exporting them to a Word document but I keep getting an error if I try to paste them a certain way. Here's my code:</p>\n\n<pre><code>Sub ExportingToWord_MultiplePages2()\n\n    'Declare Word Variables\n    Dim WrdApp As Word.Application\n    Dim WrdDoc As Word.Document\n\n    'Declare Excel Variables\n    Dim ChrtObj As ChartObject\n\n    'Create a new instance of Word\n    Set WrdApp = New Word.Application\n        WrdApp.Visible = True\n\n    'Create a new word document\n    Set WrdDoc = WrdApp.Documents.Add\n\n    'Loop through the charts on the active sheet\n    For Each ChrtObj In ActiveSheet.ChartObjects\n\n        'Copy the chart\n        ChrtObj.Chart.ChartArea.Copy\n\n        **'THIS WON'T RETURN AN ERROR**\n        With WrdApp.Selection\n            .PasteAndFormat Type:=wdChartPicture\n        End With\n\n        '**THIS WILL RETURN THE ERROR**\n        With WrdApp.Selection\n            .PasteAndFormat Type:=wdChartLinked\n        End With\n\n        'Clear the Clipboard.\n        Application.CutCopyMode = False\n\n    Next ChrtObj\n\nEnd Sub\n</code></pre>\n\n<p>This is the weird part because I've provided two different ways to paste, the first one I paste it as a chart picture and that works fine. However, if I try <strong>wdChart</strong> or <strong>wdChartLinked</strong> it won't work! I get Error 4605 \"Command Not Avaiable\".</p>\n\n<p>Any thoughts as to why this would be the case?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1544625095, "post_id": 53744978, "comment_id": 94342834, "body": "Your question is likely to be closed for being too broad. Narrow it down to a specific task. Do you need to loop through a folder, do you have problems knowing how to copy and paste? Etc"}, {"owner": {"reputation": 84, "user_id": 10612182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60648689a118b6534d91d12d545e1c40?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfaloo", "link": "https://stackoverflow.com/users/10612182/wolfaloo"}, "edited": false, "score": 0, "creation_date": 1544627419, "post_id": 53744978, "comment_id": 94344263, "body": "The Excel-vba tag is pending deletion. it will be replaced by the combination of Excel and vba tags."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 84, "user_id": 10612182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60648689a118b6534d91d12d545e1c40?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfaloo", "link": "https://stackoverflow.com/users/10612182/wolfaloo"}, "edited": false, "score": 0, "creation_date": 1544628012, "post_id": 53744978, "comment_id": 94344593, "body": "@Wolfaloo I will believe it when I see it.  They have been arguing that for longer than I have been a member."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10682123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319dd07934ae3d34051f0ac573f32f2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/10682123/phil"}, "edited": false, "score": 0, "creation_date": 1545072666, "post_id": 53746410, "comment_id": 94491190, "body": "This is above and beyond, thank you. Works perfectly and I&#39;ve learned a lot. Thanks again."}], "tags": [], "owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "is_accepted": false, "score": 0, "last_activity_date": 1544628902, "creation_date": 1544628902, "answer_id": 53746410, "question_id": 53744978, "link": "https://stackoverflow.com/questions/53744978/retrieve-same-set-cell-values-across-multiple-tabs-from-new-spreadsheets-and-for/53746410#53746410", "title": "Retrieve same set cell values across multiple tabs from new spreadsheets and formatting", "body": "<p>I think you want something like this:</p>\n\n<pre><code>Option Explicit\nPublic Sub Transfer_Data()\nOn Error Resume Next\n        Dim wsMaster As Worksheet\n        Dim wbSource As Workbook\n        Dim wsSource As Worksheet\n        Dim intChoice As Integer\n        Dim strPath As String\n\n        'turn off screen blinking to make code faster and less annoying\n        Application.ScreenUpdating = False\n        'Set the wsMaster to the sheet you want to add data to\n        Set wsMaster = ActiveWorkbook.Sheets(\"Sheet1\")\n        'only allow the user to select one file\n        Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n        'make the file dialog visible to the user\n        intChoice = Application.FileDialog(msoFileDialogOpen).Show\n        'determine what choice the user made\n        If intChoice &lt;&gt; 0 Then\n            'get the file path selected by the user\n            strPath = Application.FileDialog(msoFileDialogOpen).SelectedItems(1)\n            'open the file\n            Set wbSource = Workbooks.Open(strPath)\n        End If\n        'Then you would loop through each worksheet like this and copy whatever information you want to wherever you want on your original sheet\n        For Each wsSource In wbSource.Worksheets\n            'set the values of the cells equal to its corresponding cell in the opened worksheet (copy and paste will be slower and more of a hassle unless you want cell color etc also)\n            'format of cells: .cells('rownubmer', 'colnumber')\n            wsMaster.Cells(3, 2).Value = wsSource.Cells(1, 2).Value\n        Next\n        'close file without saving\n        wbSource.Close (False)\n        'turn screen updating back on\n        Application.ScreenUpdating = True\n        'goto master sheet\n        wsMaster.Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10682123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319dd07934ae3d34051f0ac573f32f2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/10682123/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1580834849, "creation_date": 1544624117, "last_edit_date": 1580834849, "question_id": 53744978, "link": "https://stackoverflow.com/questions/53744978/retrieve-same-set-cell-values-across-multiple-tabs-from-new-spreadsheets-and-for", "title": "Retrieve same set cell values across multiple tabs from new spreadsheets and formatting", "body": "<p>Need to copy and paste set cells data from multiple business entity spreadsheets and match format of master spreadsheet. </p>\n\n<p>Need to copy and paste set cells within each tab on workbook and populate a master spreadsheet with the data in a specific format - So I'll be looking to copy the same cells from new workbooks each time.  (Sheet 1 = Account,  C2, C6. Sheet 3 = Pricing and commission, B5, B7 and so on) and then auto format it into the master spreadsheet layout. </p>\n\n<p>This looks the closest to my need but unsure of how to tailor it.</p>\n\n<pre><code>    Sub Consolidate()\n\nDim wkbkorigin As Workbook\nDim originsheet As Worksheet\nDim destsheet As Worksheet\nDim ResultRow As Long\nDim Fname As String\nDim RngDest As Range\n\n\n    Set destsheet = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set RngDest = destsheet.Cells(Rows.Count, 1).End(xlUp) _\n                       .Offset(1, 0).EntireRow\n    Fname = Dir(ThisWorkbook.Path &amp; \"/*.xlsx\")\n\n    'loop through each file in folder (excluding this one)\n    Do While Fname &lt;&gt; \"\" And Fname &lt;&gt; ThisWorkbook.Name\n\n        If Fname &lt;&gt; ThisWorkbook.Name Then\n\n            Set wkbkorigin = Workbooks.Open(ThisWorkbook.Path &amp; \"/\" &amp; Fname)\n            Set originsheet = wkbkorigin.Worksheets(\"Sheet1\")\n\n            With RngDest\n                .Cells(1).Value = originsheet.Range(\"E9\").Value\n                .Cells(2).Value = originsheet.Range(\"D18\").Value\n                .Cells(3).Value = originsheet.Range(\"D22\").Value\n                .Cells(4).Value = originsheet.Range(\"E11\").Value\n                .Cells(5).Value = originsheet.Range(\"F27\").Value\n            End With\n\n            wkbkorigin.Close SaveChanges:=False   'close current file\n            Set RngDest = RngDest.Offset(1, 0)\n\n        End If\n\n        Fname = Dir()     'get next file\n    Loop\nEnd Sub\n\n\nDo While Fname &lt;&gt; \"\" And Fname &lt;&gt; ThisWorkbook.Name\n    Set wkbkorigin = Workbooks.Open(ThisWorkbook.Path &amp; \"/\" &amp; Fname)\n    For Each ws in wkbkorigin.Worksheets '### YOU NEED TO ITERATE OVER SHEETS IN THE WORKBOOK THAT YOU JUST OPENED ON THE PRECEDING LINE\n        With ws\n            ' Do something with the ws Worksheet, like take the values from D3 and E9 and put them in your RngDest range:\n             RngDest.Cells(1,1).Value = .Range(\"D3\").Value\n             RngDest.Cells(1,2).Value = .Range(\"E9\").Value\n        End With\n        Set RngDest = RngDest.Offset(1, 0) '## Offset this range for each sheet so that each sheet goes in a new row\n    Next\n    wkbkorigin.Close SaveChanges:=False   'close current file\n    Fname = Dir()     'get next file\n</code></pre>\n\n<p>My vba knowledge is very limited so any advice would be much appreciated. Would I need to save each business entity spreadsheet before running macro? Previously I just extract what I need and close out.  Apologies for the length of question. </p>\n"}, {"tags": ["excel", "vba", "google-geocoding-api"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7150013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e21accdced6c0613d5333b0b6f89f9d?s=128&d=identicon&r=PG&f=1", "display_name": "GRACELYN IDA", "link": "https://stackoverflow.com/users/7150013/gracelyn-ida"}, "edited": false, "score": 0, "creation_date": 1544631688, "post_id": 53745014, "comment_id": 94346931, "body": "It is returning &#39;element&#39; which is the default value of the data type &#39;String&#39;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 7150013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e21accdced6c0613d5333b0b6f89f9d?s=128&d=identicon&r=PG&f=1", "display_name": "GRACELYN IDA", "link": "https://stackoverflow.com/users/7150013/gracelyn-ida"}, "edited": false, "score": 0, "creation_date": 1544633456, "post_id": 53745014, "comment_id": 94347933, "body": "a) I don&#39;t understand what you want to tell me because that is even not a question. b) Note that we cannot answer follow-up questions in comments (this site is question/answer based not a forum). You asked where to put the key, so I can only give the answer to that. If you have a completely new issue now (which it is, if it is not directly related to where to put the API-KEY) you should mark this one as solved and ask a new question and describe well what your new issue is (including which error you get exactly and where in your code)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1, "user_id": 7150013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e21accdced6c0613d5333b0b6f89f9d?s=128&d=identicon&r=PG&f=1", "display_name": "GRACELYN IDA", "link": "https://stackoverflow.com/users/7150013/gracelyn-ida"}, "edited": false, "score": 1, "creation_date": 1544634298, "post_id": 53745014, "comment_id": 94348340, "body": "And remove <code>On Error Resume Next</code>. This line just hides all error messages but the errors don&#39;t disappear, you just cannot see them. If you don&#39;t see them you cannot fix them. If you don&#39;t fix them it will not work."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1544624221, "creation_date": 1544624221, "answer_id": 53745014, "question_id": 53744855, "link": "https://stackoverflow.com/questions/53744855/i-want-to-insert-api-key-in-the-geocoding-macro/53745014#53745014", "title": "I want to insert API Key in the Geocoding macro", "body": "<p>The documentation of the <a href=\"https://developers.google.com/maps/documentation/geocoding/get-api-key\" rel=\"nofollow noreferrer\">Geocoding API</a> actually helps here:</p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/5XLFr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5XLFr.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n\n<p>So you need to add your key here </p>\n\n<pre><code>Const API_KEY As String = \"your key here\"\nhttp.Open \"GET\", \"https://maps.googleapis.com/maps/api/geocode/xml?address=\" &amp; URLEncode(Address) &amp; \"&amp;key=\" &amp; API_KEY, False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7150013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e21accdced6c0613d5333b0b6f89f9d?s=128&d=identicon&r=PG&f=1", "display_name": "GRACELYN IDA", "link": "https://stackoverflow.com/users/7150013/gracelyn-ida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544624449, "creation_date": 1544623709, "last_edit_date": 1544624449, "question_id": 53744855, "link": "https://stackoverflow.com/questions/53744855/i-want-to-insert-api-key-in-the-geocoding-macro", "title": "I want to insert API Key in the Geocoding macro", "body": "<p>This is the code that already exists. Now i need to insert API Key in the program and make it work. Where and how should I insert API key ?</p>\n\n<pre><code>Sub Geocode()\n'\nDim counter1 As Long\nDim Address As String\nDim Longitude As Double\nDim Latitude As Double\nDim Success As Boolean\nDim Status As String\ncounter1 = 2\nDo While Not IsEmpty(Cells(counter1, 1))\n    Cells(counter1, 5) = Cells(counter1, 1) &amp; \", \" &amp; Cells(counter1, 2) &amp; \", \" &amp; Cells(counter1, 3) &amp; \", \" &amp; Cells(counter1, 4)\n    Address = Cells(counter1, 5)\n    Success = GetLongitudeAndLatitude(Address, Longitude, Latitude, Status)\n            If Success = True Then\n                Cells(counter1, 7) = Longitude\n                Cells(counter1, 6) = Latitude\n            Else\n                Cells(counter1, 6) = Status\n                Cells(counter1, 7) = Status\n            End If\n    counter1 = counter1 + 1\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\nLoop\n\nColumns(\"E:E\").Select\nSelection.ClearContents\n\nEnd Sub\n\n\n\n\n\nPrivate Function GetLongitudeAndLatitude(Address As String, Longitude As Double, Latitude As Double, Status As String) As Boolean\n\n    ' Declare variables and set return value to false by default\n    GetLongitudeAndLatitude = False\n    Dim response As DOMDocument60\n    Dim http As XMLHTTP60\n    Dim node As IXMLDOMNode\n    Dim nodes As IXMLDOMNodeList\n    Set http = New XMLHTTP60\n\n    ' Read the data from the website\n    On Error Resume Next\n    ' Open an XML request from Google using their GeoCode API\n    http.Open \"GET\", \"https://maps.googleapis.com/maps/api/geocode/xml?address=\" &amp; URLEncode(Address), False\n    http.send\n    Set response = http.responseXML\n\n    ' get the status node.  This node tells you whether your search succeeded - OK means success.  Any other status means some kind of error or address not found.\n    Set node = response.SelectSingleNode(\"/GeocodeResponse/status\")\n    If node.nodeTypedValue &lt;&gt; \"OK\" Then\n        Status = node.nodeTypeString\n    Else\n        Set nodes = response.SelectNodes(\"/GeocodeResponse/result\")\n        ' check for multiple addresses if we found more than 1 result then error out.\n        If nodes.Length &gt; 1 Then\n            MsgBox (\"Found Multiple Matches for Address: \" &amp; Address)\n        Else\n            ' grab the latitude and longitude from the XML response\n            Set node = response.SelectSingleNode(\"/GeocodeResponse/result/geometry/location/lat\")\n            Latitude = node.nodeTypedValue\n            Set node = response.SelectSingleNode(\"/GeocodeResponse/result/geometry/location/lng\")\n            Longitude = node.nodeTypedValue\n            GetLongitudeAndLatitude = True\n        End If\n\n    End If\n\n    Set http = Nothing\n    Set response = Nothing\n\nEnd Function\n\n' URL Encoding function courtesy of http://stackoverflow.com/questions/218181/how-can-i-url-encode-a-string-in-excel-vba\nPrivate Function URLEncode( _\n   StringVal As String, _\n   Optional SpaceAsPlus As Boolean = False _\n) As String\n\n  Dim StringLen As Long: StringLen = Len(StringVal)\n\n  If StringLen &gt; 0 Then\n    ReDim result(StringLen) As String\n    Dim i As Long, CharCode As Integer\n    Dim Char As String, Space As String\n\n    If SpaceAsPlus Then Space = \"+\" Else Space = \"%20\"\n\n    For i = 1 To StringLen\n      Char = Mid$(StringVal, i, 1)\n      CharCode = Asc(Char)\n      Select Case CharCode\n        Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126\n          result(i) = Char\n        Case 32\n          result(i) = Space\n        Case 0 To 15\n          result(i) = \"%0\" &amp; Hex(CharCode)\n        Case Else\n          result(i) = \"%\" &amp; Hex(CharCode)\n      End Select\n    Next i\n    URLEncode = Join(result, \"\")\n  End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1544623495, "post_id": 53744693, "comment_id": 94341902, "body": "There is no direct VBA link to the internals of the Excel calculation engine. You could monitor system RAM, specifically how much is used by the Excel process, though it wouldn&#39;t be easy (by using the Microsoft Scripting Runtime). This sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a> to me. What problem are you really needing to solve?"}, {"owner": {"reputation": 41, "user_id": 10327732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9195630cc0361c07f3a76194cbe48f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10327732/jenny"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1544623747, "post_id": 53744693, "comment_id": 94342040, "body": "@JohnColeman I have a c++ program for calculation and I&#39;m using excel to test it. By running calculation for the whole sheet twice I found that there is some memory leak. Since there are hundreds of calculations, I want to find out which calculation causes the memory leak by monitoring excel&#39;s memory."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1544624820, "post_id": 53744693, "comment_id": 94342662, "body": "Monitoring the memory usage of the Excel process probably wouldn&#39;t give you the resolution needed to break down usage per calculation. Also, if it is C++ code which is behind the memory leak, it might not even be in the Excel process itself (this might depend on just how you are invoking the C++ functions. I don&#39;t know what happens behind the scenes when you e.g. register a dll). It is an interesting question but you might need to provide more details to get a solution."}, {"owner": {"reputation": 41, "user_id": 10327732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9195630cc0361c07f3a76194cbe48f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10327732/jenny"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1544626321, "post_id": 53744693, "comment_id": 94343591, "body": "@JohnColeman For the first time I ran the calculation on whole sheets, the memory takes about 722,296k. Without closing the excel, I used the same macro to calculate again, the memory takes about 768,908k. So I guess there might be some memory leak that can be monitored by excel?"}, {"owner": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "edited": false, "score": 4, "creation_date": 1544629520, "post_id": 53744693, "comment_id": 94345558, "body": "this is anecdotal evidence. It might be that excel just didn&#39;t get around to freeing some unused memory yet. Have you confirmed conclusively that there&#39;s a memory leak there?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544629616, "post_id": 53744693, "comment_id": 94345626, "body": "Also, have you disabled any &amp; all Excel, COM, and VBE add-ins?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1544629662, "post_id": 53744693, "comment_id": 94345655, "body": "I would actually be surprised if if Excel wasn&#39;t performing quite a bit of caching in this case. If I were writing spreadsheet software, I&#39;d only update intermediate results if I had to."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544630077, "post_id": 53744693, "comment_id": 94345927, "body": "A <i>memory leak</i> would be if the cached data remained in memory after the worksheet is closed. As long as it&#39;s opened, RAM consumption going up means nothing other than Excel allocating more memory for its purposes."}, {"owner": {"reputation": 41, "user_id": 10327732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9195630cc0361c07f3a76194cbe48f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10327732/jenny"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544630245, "post_id": 53744693, "comment_id": 94346065, "body": "@MathieuGuindon Is there any way that I can detect whether the cached data is changing? Like can I monitor it by using task manager or something?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1544630390, "post_id": 53744693, "comment_id": 94346175, "body": "You could apply for a position in the Excel product team at Microsoft, attach a debugger and find out. Other than that..."}], "owner": {"reputation": 41, "user_id": 10327732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9195630cc0361c07f3a76194cbe48f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/10327732/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580290546, "creation_date": 1544623143, "last_edit_date": 1580290546, "question_id": 53744693, "link": "https://stackoverflow.com/questions/53744693/check-memory-used-for-each-calculation", "title": "Check memory used for each calculation", "body": "<p>I have a excel that contains about 20 sheets. I have hundreds of calculations among those sheets. Is it possible for me to figure out a way to find how many memory is being used for each calculation?</p>\n\n<p>Update: I found out the issue for the memory leak, which was caused by a destructor, but I thought the question above would still be a reasonable one for excel-vba. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1544622649, "post_id": 53744409, "comment_id": 94341421, "body": "When you say <i>Excel sheet</i> do you mean the Excel file(workbook) as a whole, or individual sheets (worksheets) within the file?"}, {"owner": {"reputation": 116, "user_id": 6700974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IpF4tdyVQ-I/AAAAAAAAAAI/AAAAAAAABCE/SkmLGxCN144/photo.jpg?sz=128", "display_name": "lighthouselk", "link": "https://stackoverflow.com/users/6700974/lighthouselk"}, "edited": false, "score": 0, "creation_date": 1544623287, "post_id": 53744409, "comment_id": 94341783, "body": "Your requirement is not clear. Please write your description again. What did you meant by the &quot;sheet&quot; here?"}, {"owner": {"reputation": 4715, "user_id": 2942504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002530770263/picture?type=large", "display_name": "Maycow Moura", "link": "https://stackoverflow.com/users/2942504/maycow-moura"}, "edited": false, "score": 0, "creation_date": 1544638105, "post_id": 53744409, "comment_id": 94350390, "body": "I meant workbook. Edited my description"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1544624801, "post_id": 53744608, "comment_id": 94342647, "body": "One points towards where you save the file... once you select the extensino of .xla or .xlam, the save location will change directing to the addin folder.  I believe the general consensus is to ensure you save to the XLSTART folder, rather than the addin folder.  For most computers, the location is: <i>%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART</i>  (Note: i use that path for batch files when installing items on computers as to alleviate needing their full local path, such as user name)."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1544624955, "post_id": 53744608, "comment_id": 94342743, "body": "Why XLSTART folder? I have never saved any of my add ins  there. What is the benefit of that versus in the add-in folder?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1544625280, "post_id": 53744608, "comment_id": 94342942, "body": "see: <a href=\"https://accessanalytic.com.au/xlstart-folder/\" rel=\"nofollow noreferrer\">accessanalytic.com.au/xlstart-folder</a> ; regarding general differences in XLSTART versus the AddIns folder, I am not versed enough to say explicitly why they both exist and for what purposes.  What I have noticed is, when having users across Excel 2010 through Office 365, that the XLSTART folder will load modules when Excel loads, allowing access of all macros, and allowing them to be added to the Quick Bar; this was the approach given to me when I had multiple users saving macros and the AddIn folder files would not display in the VBA Editor for &gt;50% of my folks."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1544643492, "post_id": 53744608, "comment_id": 94353088, "body": "I read the reasons listed there and quite frankly, that is a good reason for me to not place anything in that folder. In my xlam files I always include code to both automatically install the xlam, meaning the end user only opens the file and he/she will be promoted to install yes/no. Then it&#39;s installed, no need to find a folder and manually place it there. And each xlam has code that looks for updates. Meaning I can upload a new version and all running this xlam will get a message there is a new version and the code will disable itself and install the new version."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 2, "last_activity_date": 1544622884, "creation_date": 1544622884, "answer_id": 53744608, "question_id": 53744409, "link": "https://stackoverflow.com/questions/53744409/vba-how-run-a-macro-from-another-workbook-without-opening-it/53744608#53744608", "title": "VBA - How run a Macro from another workbook without opening it?", "body": "<p>Save the file with the macros as a xlam file and Excel can load them each time Excel opens.  </p>\n\n<p>You need to open File -> options -> add-ins.  </p>\n\n<p>At the bottom there is a button Go to (or something, I don't have English Excel on the current computer.)<br>\nThen add the file to the list by clicking Browse and finding the file you just saved as xlam file. </p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 2, "last_activity_date": 1544627134, "last_edit_date": 1544627134, "creation_date": 1544624438, "answer_id": 53745074, "question_id": 53744409, "link": "https://stackoverflow.com/questions/53744409/vba-how-run-a-macro-from-another-workbook-without-opening-it/53745074#53745074", "title": "VBA - How run a Macro from another workbook without opening it?", "body": "<p>Two scenarios comes to mind:</p>\n\n<p>1)  You have a second macro for personal use and can save it locally (save in: <em>%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART</em>).  This will allow you to create quick-buttons for your macros, etc.  These types of macros open with Excel and will be separate VBA Projects inside of the default VBA editor.</p>\n\n<p>2)  You have a network or drive that multiple users need to access, so each user has a macro in their file (.xlsm or .xlsb), where that internal macro reads  Application.Run \"filepath\\workbookname.xlsb!macro\", which also allows you to call a private subroutine (note that you could use Call, but Application.Run will ensure that even Private macros are able to be accessed).  This shouldn't require the other workbook be open, though I have personally had one user whose computer always opens the other file, regardless.</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Third scenario (really 2b):</p>\n\n<p>3)  You have files where you want to regularly access another file... you will follow a similar approach to point <strong>2</strong> where you make a macro to Application.Run, though you can save that macro in your XLSTART folder... this will allow you to have a source macro location where others may also want to access and utilize.  The <em>source</em> document would allow you to maintain 1 file for many users.</p>\n"}, {"comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1544643011, "post_id": 53749192, "comment_id": 94352809, "body": "There are other, in my opinion better ways to limit the code to one or a few workbooks. You can make the code only run if activeworkbook is some name. Or limit it to the layout of a workbook, say A1 is &quot;Date&quot;, B1 is something else then run the code else don&#39;t. I have one code that looks at the username logged in on the computer, if it&#39;s not me, then don&#39;t run. Whatever you can imagine is probably possible"}], "tags": [], "owner": {"reputation": 4715, "user_id": 2942504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002530770263/picture?type=large", "display_name": "Maycow Moura", "link": "https://stackoverflow.com/users/2942504/maycow-moura"}, "is_accepted": false, "score": 2, "last_activity_date": 1544639197, "creation_date": 1544639197, "answer_id": 53749192, "question_id": 53744409, "link": "https://stackoverflow.com/questions/53744409/vba-how-run-a-macro-from-another-workbook-without-opening-it/53749192#53749192", "title": "VBA - How run a Macro from another workbook without opening it?", "body": "<p>Your answers were great! Great to know about XLSTART folder from @Cyril, but based on @Andreas answer I found my path.</p>\n\n<p>The \"problems\" with adding an Add-In as @Andreas said, are cause my VBA Project would be avaliable on the VB Editor to every workbook on that computer, and to run my macros I'd have to use Application.Run(\"workbook.xlam!Macro\").</p>\n\n<p>Then I found References, which I have the same features, including I can delete my .xlam file to remove my code, and don't have the problems I mentioned above.</p>\n\n<p>Adding my VBA .xlam file as an reference, it'll be avaliable only to that specific workbook and I can run my macro just like it was on the same workbook.</p>\n\n<p>For general knowledge:</p>\n\n<p>ADDING A REFERENCE:</p>\n\n<p>1- Save your project as an Excel Add-In (.xlam file)</p>\n\n<p>2- Open your target workbook, go to the Visual Basic Editor</p>\n\n<p>3- Go to Tools > References > Browse... find your .xlam file and make sure it's checked.</p>\n\n<p>4- Done! Now you'll see the project on the editor and can run your macros just like it was on the same workbook. </p>\n"}], "owner": {"reputation": 4715, "user_id": 2942504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002530770263/picture?type=large", "display_name": "Maycow Moura", "link": "https://stackoverflow.com/users/2942504/maycow-moura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2150, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1544672386, "creation_date": 1544622238, "last_edit_date": 1544672386, "question_id": 53744409, "link": "https://stackoverflow.com/questions/53744409/vba-how-run-a-macro-from-another-workbook-without-opening-it", "title": "VBA - How run a Macro from another workbook without opening it?", "body": "<p>I wanted to save all my VBA Project in a Excel workbook (or other type of file if possible) and then embbed it to run in another workbook. I've seen topics about it but only found ways to run the macros opening the first sheet.</p>\n\n<p>I want to run a macro from a first workbook in a second one without opening the first workbook to do it. How can I do that?</p>\n"}, {"tags": ["excel", "vba", "rounding"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 2, "creation_date": 1544622135, "post_id": 53744321, "comment_id": 94341089, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/double-data-type\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a> &quot;Precision. When you work with floating-point numbers, remember that they do not always have a precise representation in memory.&quot;"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 2, "creation_date": 1544622567, "post_id": 53744321, "comment_id": 94341372, "body": "In VBA, double is a IEEE 64-bit (8-byte) double-precision floating-point number,  17.005 is most closely represented as <code>1.70049999999999990052401699359E1</code>  So, when you round to two decimals, you get 17.00. See <a href=\"http://www.binaryconvert.com/result_double.html?decimal=049055046048048053\" rel=\"nofollow noreferrer\">binaryconvert.com/result_double.html?decimal=049055046048048&zwnj;&#8203;053</a> to play around"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1544622638, "post_id": 53744321, "comment_id": 94341412, "body": "In your case you could use <code>Application.WorksheetFunction.Round(vTest, 2)</code> if you find the above explained <code>Round</code> behaviour annoying."}, {"owner": {"reputation": 11, "user_id": 9030501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1014859f56a5c555de48995e54bc8256?s=128&d=identicon&r=PG&f=1", "display_name": "OWing", "link": "https://stackoverflow.com/users/9030501/owing"}, "edited": false, "score": 0, "creation_date": 1544622706, "post_id": 53744321, "comment_id": 94341464, "body": "Thank you Cody. I was going for banker&#39;s rounding JvdV."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1544622781, "post_id": 53744321, "comment_id": 94341507, "body": "The reason is vba rounding is banker&#39;s rounding. Which means on 5 it will round towards the even value. For mathematical rounding use application.round"}], "owner": {"reputation": 11, "user_id": 9030501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1014859f56a5c555de48995e54bc8256?s=128&d=identicon&r=PG&f=1", "display_name": "OWing", "link": "https://stackoverflow.com/users/9030501/owing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580847615, "creation_date": 1544621897, "last_edit_date": 1580847615, "question_id": 53744321, "link": "https://stackoverflow.com/questions/53744321/is-this-an-error-in-vbas-round-function-if-so-does-anyone-know-when-why-it-occ", "title": "Is this an error in VBA&#39;s round function? If so does anyone know when/why it occurs?", "body": "<p>I used this code to print some round outputs.</p>\n\n<pre><code>Private Sub TestRound()\n\n    Dim i As Double\n    Dim vTest As Double\n\n    vTest = 17.005\n\n    For i = 1 To 10\n        Debug.Print vTest, Round(vTest, 2)\n        vTest = vTest + 0.01\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Here are the outputs (initial value, rounded value):</p>\n\n<pre><code>( 17.005,        17 )\n( 17.015,        17.02 )\n( 17.025,        17.03 )\n( 17.035,        17.04 )\n( 17.045,        17.05 )\n( 17.055,        17.06 )\n( 17.065,        17.07 )\n( 17.075,        17.08 )\n( 17.085,        17.09 )\n( 17.095,        17.1 )\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 3, "creation_date": 1544626323, "post_id": 53744153, "comment_id": 94343592, "body": "It should be <code>LastRow = .Cells(.Rows.Count, &quot;C&quot;).End(xlUp).Row</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1544626926, "post_id": 53744153, "comment_id": 94343979, "body": "You&#39;re uwing <code>With wsMain</code>, but then never actually &quot;link&quot; any ranges to it. Included in @DarrenBartrup-Cook&#39;s answer, is linking <code>Cells()</code> to the <code>wsMain</code>. However, later in the loop you have another unqualified <code>Cells()</code>, make sure to link that back to the <code>With</code> statement if you expect that to be on <code>wsMain</code>."}, {"owner": {"reputation": 1, "user_id": 10780972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218548144081038/picture?type=large", "display_name": "Sandrine Bramley", "link": "https://stackoverflow.com/users/10780972/sandrine-bramley"}, "edited": false, "score": 0, "creation_date": 1544629930, "post_id": 53744153, "comment_id": 94345834, "body": "Hi Thanks Darren, I have come up to the same solution on my own in the end,... but thank you!!  I now have another problem,... The macro works when I repeatedly hit F8 key but it doesn&#39;t work when I hit the commandbutton which contains the code.... Mind boggling!"}, {"owner": {"reputation": 1, "user_id": 10780972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218548144081038/picture?type=large", "display_name": "Sandrine Bramley", "link": "https://stackoverflow.com/users/10780972/sandrine-bramley"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544630495, "post_id": 53744153, "comment_id": 94346237, "body": "Thanks @BruceWayne also I have also removed the With wsMain and added wsMain. everywhere where it was required. Not sure how how I worked that one out,... I guess certain things are starting to make sense slowly but surely!"}], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 2, "last_activity_date": 1544629018, "creation_date": 1544629018, "answer_id": 53746447, "question_id": 53744153, "link": "https://stackoverflow.com/questions/53744153/runtime-error-438-message-determining-lastrow/53746447#53746447", "title": "Runtime Error 438 message determining LastRow", "body": "<p>You need to replace <code>EndofUp</code> with <code>End(xlUp)</code> an that should fix it for you!</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1580819319, "creation_date": 1580819319, "answer_id": 60057468, "question_id": 53744153, "link": "https://stackoverflow.com/questions/53744153/runtime-error-438-message-determining-lastrow/60057468#60057468", "title": "Runtime Error 438 message determining LastRow", "body": "<p>There's a few modification you should make to your code, some already listed by @Darren Bartrup-Cook </p>\n\n<ol>\n<li>Looking for Last row:</li>\n</ol>\n\n<p>Change:</p>\n\n<pre><code>LastRow = Cells(Rows.Count, \"C\").EndofUp.Row \n</code></pre>\n\n<p>With:    </p>\n\n<pre><code>LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row \n</code></pre>\n\n<ol start=\"2\">\n<li>Looking at <code>Len</code> of a cell, also not fully qualified with <code>wsMain</code> worksheet object.</li>\n</ol>\n\n<p>Change:</p>\n\n<pre><code>If Len(Cells(RowNumber, \"C\").Value) &gt; 0 Then\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>If Len(.Range(\"C\" &amp; RowNumber).Value) &gt; 0 Then\n</code></pre>\n\n<ol start=\"3\">\n<li>Avoid using a <code>With</code> statement, inside another <code>With</code>.</li>\n</ol>\n\n<p>This line:</p>\n\n<pre><code>With olTask  ' &lt;-- Setting a With inside another With statement\n</code></pre>\n\n<p>is inside:</p>\n\n<pre><code>With wsMain\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10780972, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218548144081038/picture?type=large", "display_name": "Sandrine Bramley", "link": "https://stackoverflow.com/users/10780972/sandrine-bramley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1606766940, "creation_date": 1544621372, "last_edit_date": 1606766940, "question_id": 53744153, "link": "https://stackoverflow.com/questions/53744153/runtime-error-438-message-determining-lastrow", "title": "Runtime Error 438 message determining LastRow", "body": "<p>I get</p>\n<blockquote>\n<p>Runtime Error 438 Object doesn't support this property or method</p>\n</blockquote>\n<p>on the &quot;LastRow&quot; line.</p>\n<p>I am trying to set up multiple Outlook tasks (reminders to update certificates) based on data located in an Excel worksheet. Each row includes the data required to set up each task for each certificate.</p>\n<p>I need to determine the last row with data.</p>\n<p>Entire code.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim olApp As Outlook.Application\n    Dim olTask As TaskItem\n    \n    Dim wsMEDCMain As Worksheet\n    Dim LastRow As Long, RowNumber As Long\n    \n    Set olApp = New Outlook.Application\n    Set wsMain = ThisWorkbook.Worksheets(&quot;Main&quot;)\n    \n    With wsMain\n        LastRow = Cells(Rows.Count, &quot;C&quot;).EndofUp.Row '&lt;-------  Line with error\n        \n        If 2 &gt; LastRow Then Exit Sub\n        For RowNumber = 2 To LastRow\n            If Len(Cells(RowNumber, &quot;C&quot;).Value) &gt; 0 Then\n            \n                'Create Task Item\n                Set olTask = olApp.CreateItem(olTaskItem)\n                With olTask\n                    .Subject = Cells(RowNumber, &quot;C&quot;).Value\n                    .Status = olTaskNotStarted\n                    .Importance = olImportanceHigh\n                    .StartDate = Cells(RowNumber, &quot;B&quot;).Value\n                    .DueDate = Cells(RowNumber, &quot;A&quot;).Value\n                    .ReminderSet = True\n                    .ReminderTime = .StartDate &amp; (&quot; 09:00:00&quot;)\n                    .Body = Cells(RowNumber, &quot;D&quot;).Value &amp; vbNewLine &amp; (&quot;Certificate Details: &quot;) &amp; Cells(RowNumber, (&quot;C&quot;)).Value\n                    .Save\n                End With\n            \n                'Clear Object Variable\n                Set olTask = Nothing\n            End If\n        Next RowNumber\n    \n    End With\n     \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1544696986, "creation_date": 1544696986, "answer_id": 53759775, "question_id": 53744007, "link": "https://stackoverflow.com/questions/53744007/reference-a-cell-in-excel-to-the-content-of-an-external-text-file/53759775#53759775", "title": "Reference a cell in excel to the content of an external text file", "body": "<p>The short answer : it is not possible to accomplish this in a formula with \"standard\" Excel.<br>\nSome alternatives:   </p>\n\n<ul>\n<li>The most basic is to manually import (but this you probably know already)</li>\n<li>Use VBA to import the txt file data into a cell in your worksheet</li>\n<li>Use Microsoft Power Query for Excel, a free add-in (has been renamed \"Get and Transform\" in Excel 2016   </li>\n</ul>\n\n<p>Based on your question, I would recommend the last option: powerful, and you can use this straight into formulas. </p>\n"}], "owner": {"reputation": 37, "user_id": 5418025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e7f208b3c9dd574ee8063bdc4c8b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Carsten2015", "link": "https://stackoverflow.com/users/5418025/carsten2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1580319500, "creation_date": 1544620923, "last_edit_date": 1580319500, "question_id": 53744007, "link": "https://stackoverflow.com/questions/53744007/reference-a-cell-in-excel-to-the-content-of-an-external-text-file", "title": "Reference a cell in excel to the content of an external text file", "body": "<p>I want to reference a cell in Excel to the content of an external text file.</p>\n\n<p>I have this file <code>c:\\calc.text</code> which just have a number inside.\nI want to put number inside the <code>calc.txt</code> inside a cell of an excel file by formula.</p>\n"}, {"tags": ["vba", "outlook", "directory"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10780996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E384I-GiazQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jWGP9jFQtHKPnYAQoq5CrfgPHtfg/mo/photo.jpg?sz=128", "display_name": "Chocolate Librarian", "link": "https://stackoverflow.com/users/10780996/chocolate-librarian"}, "edited": false, "score": 0, "creation_date": 1544630632, "post_id": 53744964, "comment_id": 94346316, "body": "I&#180;ve tried to integrate it into my code but nothing works, it either doesn&#39;t loop or it returns an error. Do you know how to solve this?"}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "reply_to_user": {"reputation": 11, "user_id": 10780996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E384I-GiazQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jWGP9jFQtHKPnYAQoq5CrfgPHtfg/mo/photo.jpg?sz=128", "display_name": "Chocolate Librarian", "link": "https://stackoverflow.com/users/10780996/chocolate-librarian"}, "edited": false, "score": 0, "creation_date": 1544632305, "post_id": 53744964, "comment_id": 94347260, "body": "I think the issue may be that you are using code (including my code) that is intended for file system files. If my assumption is correct you are  trying to manipulate the folders used to store email inside outlook?"}, {"owner": {"reputation": 11, "user_id": 10780996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E384I-GiazQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jWGP9jFQtHKPnYAQoq5CrfgPHtfg/mo/photo.jpg?sz=128", "display_name": "Chocolate Librarian", "link": "https://stackoverflow.com/users/10780996/chocolate-librarian"}, "edited": false, "score": 0, "creation_date": 1544632686, "post_id": 53744964, "comment_id": 94347490, "body": "Yes, exactly, that&#39;s what I&#39;m trying to do. I&#39;ll take a look at these resources and let you know how it goes. Thanks!"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1544635962, "post_id": 53744964, "comment_id": 94349292, "body": "I would guess that the <code>For Each</code> goes wrong as you add to folder.SubFolders what changes the Folders collection. I ran into this with moving items. Use <code>For n = LBound(folder.SubFolders) To Ubound(folder.SubFolders) -1 : LoopAllSubFolder. Folder.Subfolders</code> to avoid."}, {"owner": {"reputation": 11, "user_id": 10780996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E384I-GiazQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jWGP9jFQtHKPnYAQoq5CrfgPHtfg/mo/photo.jpg?sz=128", "display_name": "Chocolate Librarian", "link": "https://stackoverflow.com/users/10780996/chocolate-librarian"}, "edited": false, "score": 0, "creation_date": 1544692562, "post_id": 53744964, "comment_id": 94369058, "body": "Hi, could you show me how to integrate the snippet into the code I already have? I&#39;ve tried several ways but it always returns a &quot;needs object&quot; prompt. Thank you!"}], "tags": [], "owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "is_accepted": false, "score": 0, "last_activity_date": 1544639806, "last_edit_date": 1544639806, "creation_date": 1544624061, "answer_id": 53744964, "question_id": 53743946, "link": "https://stackoverflow.com/questions/53743946/how-to-add-subfolders-to-all-folders-of-a-directory/53744964#53744964", "title": "How to add subfolders to all folders of a directory?", "body": "<p>Here's the Sub I use to loop through all subfolders, it just calls the sub for each new subfolder and then loops through the sub-sub folders then the sub-sub-sub folders etc.:</p>\n\n<pre><code>Public Sub LoopAllSubFolders(ByVal folder As object)\n\n    For Each subfolder In folder.SubFolders\n        LoopAllSubFolders subfolder 'remove this if you only want to add the folders to the first subfolder\n        'do stuff with folders, example: subfolder.Name = \"this is a file.exe\"\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "is_accepted": false, "score": 0, "last_activity_date": 1544632600, "creation_date": 1544632600, "answer_id": 53747492, "question_id": 53743946, "link": "https://stackoverflow.com/questions/53743946/how-to-add-subfolders-to-all-folders-of-a-directory/53747492#53747492", "title": "How to add subfolders to all folders of a directory?", "body": "<p>If you are trying to manipulate the folders <strong>Inside</strong> Outlook, like I now suspect, then I would look at these resources for answers (as I am unfamiliar with this):</p>\n\n<h2>Library on methods, properties etc for these folders:</h2>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa210948(v=office.11)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa210948(v=office.11)</a></p>\n\n<h2>Some code examples:</h2>\n\n<p><a href=\"https://www.experts-exchange.com/questions/20301462/Setting-MAPIfolder-properties-in-Outlook\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/questions/20301462/Setting-MAPIfolder-properties-in-Outlook</a>'s-VBA.html</p>\n"}], "owner": {"reputation": 11, "user_id": 10780996, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E384I-GiazQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jWGP9jFQtHKPnYAQoq5CrfgPHtfg/mo/photo.jpg?sz=128", "display_name": "Chocolate Librarian", "link": "https://stackoverflow.com/users/10780996/chocolate-librarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1611267625, "creation_date": 1544620734, "last_edit_date": 1611267625, "question_id": 53743946, "link": "https://stackoverflow.com/questions/53743946/how-to-add-subfolders-to-all-folders-of-a-directory", "title": "How to add subfolders to all folders of a directory?", "body": "<p>I'm organizing e-mail in Outlook 2016. I need to create three subfolders in each folder.</p>\n<p>I have code to create the three subfolders in each folder:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub CreateFolders()\n    Dim CurrentFolder As Outlook.MAPIFolder\n    Dim Subfolder As Outlook.MAPIFolder\n    Dim List As New VBA.Collection\n    Dim Folders As Outlook.Folders\n    Dim Item As Variant\n    \n    List.Add Array(&quot;1&quot;, olFolderInbox)\n    List.Add Array(&quot;2&quot;, olFolderInbox)\n    List.Add Array(&quot;3&quot;, olFolderInbox)\n    \n    Set CurrentFolder = Application.ActiveExplorer.CurrentFolder\n    Set Folders = CurrentFolder.Folders\n    For Each Item In List\n        Folders.Add Item(0), Item(1)\n    Next\nEnd Sub\n</code></pre>\n<p>I got it from <a href=\"https://www.computergaga.com/blog/loop-through-subfolders-using-filesystemobject/\" rel=\"nofollow noreferrer\">https://www.computergaga.com/blog/loop-through-subfolders-using-filesystemobject/</a></p>\n<p>How do I create the three subfolders in all folders of a directory?</p>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1544620875, "post_id": 53743937, "comment_id": 94340354, "body": "Please note <i>&quot;does not work&quot;</i> is no useful error description. Please <a href=\"https://stackoverflow.com/posts/53743937/edit\">edit</a> your question and include: Which error do you get and where? Also <code>Range(&quot;A&quot;)</code> is no valid range it must be <code>Range(&quot;A:A&quot;)</code> or <code>Columns(&quot;A&quot;)</code> if you mean column A. <code>MyPlage As Range</code> is missing a <code>Dim</code>. Also you might want to have a look at the <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/select-case-statement\" rel=\"nofollow noreferrer\">Select...Case Statement</a>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1544621046, "post_id": 53743937, "comment_id": 94340449, "body": "Your code cannot even compile as you are missing an <code>End If</code>. If you want to use <code>WorksheetChange</code> you can&#39;t change the name and you must place it in the relevant sheet module."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "edited": false, "score": 0, "creation_date": 1544621802, "post_id": 53744141, "comment_id": 94340891, "body": "Doesn&#39;t an empty cell have a value of zero (<i>less than 1</i>)?"}, {"owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "edited": false, "score": 0, "creation_date": 1544622024, "post_id": 53744141, "comment_id": 94341013, "body": "Yes. And if emil7 doesn&#39;t want emptied cells being marked red he can adjust the formatting pattern."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544622564, "post_id": 53744141, "comment_id": 94341370, "body": "you could use <code>Set rngObserve = Intersect(Target, Range(&quot;A1:C5&quot;))</code> and <code>For Each rngCell In rngObserve</code> so you would only have one <code>Intersect</code> that should speed it up a lot. Of course test <code>If rngObserve Is Nothing Then Exit Sub</code> after <code>Set</code> it."}, {"owner": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 0, "creation_date": 1544625401, "post_id": 53744141, "comment_id": 94343013, "body": "Thank you so much! How could I add a second range (e.g. A1:B10 &amp; K18:K30)? Thank you in advance!!!"}, {"owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "edited": false, "score": 0, "creation_date": 1544625617, "post_id": 53744141, "comment_id": 94343145, "body": "You can define more complex ranges by separating them with commas. E.g. &quot;A1:B10,K18:K30&quot;"}, {"owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "reply_to_user": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "edited": false, "score": 0, "creation_date": 1544627439, "post_id": 53744141, "comment_id": 94344275, "body": "@emil7 I&#39;m glad I can help. Please upvote/select as answer if your happy with the solution. Thanks."}], "tags": [], "owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "is_accepted": true, "score": 0, "last_activity_date": 1544622893, "last_edit_date": 1544622893, "creation_date": 1544621319, "answer_id": 53744141, "question_id": 53743937, "link": "https://stackoverflow.com/questions/53743937/colour-a-cell-if-a-certain-number-is-entered/53744141#53744141", "title": "Colour a cell if a certain number is entered", "body": "<p>You can use the following macro. It must the placed in the respective worksheet (not the workbook and not in a module). Moreover, you can define a range to observe by defining rngObserve). I guess you don't want to check the whole worksheet...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rngObserve As Range, rngCell As Range\n\nSet rngObserve = Intersect(Target, Range(\"A1:C5\"))\n\nIf rngObserve Is Nothing Then\n    Exit Sub\nEnd If\nFor Each rngCell In rngObserve.Cells\n    If Not Intersect(rngCell, rngObserve) Is Nothing Then\n        If rngCell.Value = vbNullString Then\n            rngCell.Interior.Color = xlNone\n        ElseIf rngCell.Value &lt; 1 Then\n            rngCell.Interior.ColorIndex = 3\n        ElseIf rngCell.Value &gt;= 1 Then\n            rngCell.Interior.ColorIndex = 4\n        Else\n            rngCell.Interior.ColorIndex = 3\n        End If\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544622845, "post_id": 53744230, "comment_id": 94341535, "body": "Note that using <code>ActiveSheet</code> in the <code>Worksheet_Change</code> event is dangerous. <code>ActiveSheet</code> is NOT the sheet that triggered the event BUT the sheet that is on top at the moment the code runs. If the event eg. is triggered by a VBA statement like <code>Range(&quot;A1&quot;).Value = 5</code> then the <code>ActiveSheet</code> might be a completely different sheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544622973, "post_id": 53744230, "comment_id": 94341605, "body": "Very true and that is not a practice to be advocated. My response was not to fix a Worksheet_Change event sub but rather a public or private sub to be run on the active sheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544623750, "post_id": 53744230, "comment_id": 94342042, "body": "Just wanted to mention it to avoid the OP using it in combination with <code>Worksheet_Change</code>. Note that your second code also turns strings into red which are usually not <code>&lt;1</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544624204, "post_id": 53744230, "comment_id": 94342304, "body": "Good point about the strings. I had assumed that the OP only wanted to deal with numbers and blanks (per original code) but that was wrong. In fact, those <code>&quot;&quot;</code> could be zero-length strings left by a formula in which case they are not considered &#39;empty&#39;.. Also, good mention about the fallacy of relying on ActiveSheet within a triggered sub procedure."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "is_accepted": false, "score": 0, "last_activity_date": 1544621600, "creation_date": 1544621600, "answer_id": 53744230, "question_id": 53743937, "link": "https://stackoverflow.com/questions/53743937/colour-a-cell-if-a-certain-number-is-entered/53744230#53744230", "title": "Colour a cell if a certain number is entered", "body": "<p>You need <code>Range(\"A:A\")</code> but that would be better if it were cut down to the cells within the worksheet's UsedRange property. Additionally, a blank cell's value is considered zero so that condition should be checked first.</p>\n\n<pre><code>dim MyPlage As Range, cell as range\n\nSet MyPlage = intersect(activesheet.Range(\"A:A\"), activesheet.UsedRange)\n\nFor Each Cell In MyPlage\n\n    If isempty(cell) then\n        Cell.Interior.ColorIndex = 3 'red\n    elseIf Cell.Value &lt; 1 Then\n        Cell.Interior.ColorIndex = 3 'red\n    ElseIf Cell.Value &gt;= 1 Then\n        Cell.Interior.ColorIndex = 4 'green\n    end if\n\nNext cell\n</code></pre>\n\n<p>I've separated the empty cells and the cells with a value less than one because although they are for all intents and purposes the same thing, you might want to choose a different color for one of them in the future.</p>\n\n<p>It might be easier to set all to vbRed then selectively set values greater or equal to 1 as vbGreeen.</p>\n\n<pre><code>dim MyPlage As Range, cell as range\n\nSet MyPlage = intersect(activesheet.Range(\"A:A\"), activesheet.UsedRange)\n\nMyPlage.Interior.ColorIndex = 3 'red \n\nFor Each Cell In MyPlage\n\n    If  Cell.Value &gt;= 1 Then\n        Cell.Interior.ColorIndex = 4 'green\n    end if\n\nNext cell\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "edited": false, "score": 0, "creation_date": 1544622771, "post_id": 53744298, "comment_id": 94341502, "body": "fwiw, a blank cell IsNumeric and has a value less than 1 (considered zero). e.g. IsNumeric(&lt;blank cell&gt;) is true and  &lt;blank cell&gt;.value = 0."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544623086, "post_id": 53744298, "comment_id": 94341675, "body": "@user10779473 Totally correct, thanks! I switched the <code>If \u2026 ElseIf</code>. Nevertheless I kept the <code>IsNumeric</code> to ensure it runs on numeric values only (can easily be removed if not needed)."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1544622981, "last_edit_date": 1544622981, "creation_date": 1544621802, "answer_id": 53744298, "question_id": 53743937, "link": "https://stackoverflow.com/questions/53743937/colour-a-cell-if-a-certain-number-is-entered/53744298#53744298", "title": "Colour a cell if a certain number is entered", "body": "<ol>\n<li>You must use the Worksheet_Change Event. You cannot rename that event!</li>\n<li>Use <code>Intersect(Target, Target.Parent.Range(\"A:A\"))</code> to get only the cells in column A.</li>\n<li>Test each cell value in <code>Target</code> if it is a number <code>If IsNumeric(Cell.Value) Then</code> to make sure it works on number values only!</li>\n</ol>\n\n<p>So you end up with something like:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim MyPlage  As Range\n    Set MyPlage = Intersect(Target, Target.Parent.Range(\"A:A\"))\n\n    If Not MyPlage Is Nothing Then\n        Dim Cell As Range\n        For Each Cell In MyPlage\n            If Cell.Value = vbNullString Then\n                Cell.Interior.ColorIndex = 3 'red\n            ElseIf IsNumeric(Cell.Value) Then\n                If Cell.Value &lt; 1 Then\n                    Cell.Interior.ColorIndex = 3 'red\n                Else\n                    Cell.Interior.ColorIndex = 4 'green\n                End If\n            End If\n        Next Cell\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9003581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aaa51d0c2a5265078f88ecc8438a63d?s=128&d=identicon&r=PG&f=1", "display_name": "emil7", "link": "https://stackoverflow.com/users/9003581/emil7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 53744141, "answer_count": 3, "score": 2, "last_activity_date": 1554772529, "creation_date": 1544620706, "last_edit_date": 1554772529, "question_id": 53743937, "link": "https://stackoverflow.com/questions/53743937/colour-a-cell-if-a-certain-number-is-entered", "title": "Colour a cell if a certain number is entered", "body": "<p>I need to program a conditional format in Excel 2016 without using the existing conditional formatting tool.</p>\n\n<p>I want to write this e.g. in a private sub:</p>\n\n<p>for range A1:A100:<br>\n- If value is >=1 then colour = green<br>\n- If value is &lt;1 or \"\" then colour red</p>\n\n<p>for range B1:B100<br>\n- If value is >=3 then colour = green<br>\n- If value is &lt;3 &amp; >0 then colour yellow<br>\n- if value is  0 or \"\" the colour red</p>\n\n<p>My code. When I save it, nothing happens in my second defined range, also after reopening the Excel workbook:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rngObserve As Range, rngCell As Range\n\nSet rngObserve = Intersect(Target, Range(\"A1:A100\"))\n\nIf rngObserve Is Nothing Then\n    Exit Sub\nEnd If\n\nFor Each rngCell In rngObserve.Cells\n    If Not Intersect(rngCell, rngObserve) Is Nothing Then\n\n        If rngCell.Value = vbNullString Then\n            rngCell.Interior.Color = xlNone\n\n        ElseIf rngCell.Value &lt; 1 Then\n            rngCell.Interior.ColorIndex = 3 'red\n\n        ElseIf rngCell.Value &gt;= 1 Then\n            rngCell.Interior.ColorIndex = 4 'green\n\n        Else\n            rngCell.Interior.ColorIndex = 3\n        End If\n    End If\nNext\n\nSet rngObserve = Intersect(Target, Range(\"B1:B100\"))\n\nIf rngObserve Is Nothing Then\n    Exit Sub\nEnd If\n\nFor Each rngCell In rngObserve.Cells\n\n    If Not Intersect(rngCell, rngObserve) Is Nothing Then\n\n        If rngCell.Value = vbNullString Then\n            rngCell.Interior.Color = xlNone\n\n        ElseIf rngCell.Value &lt; 1&amp; &gt; 0 Then\n            rngCell.Interior.ColorIndex = 6 'yellow\n\n        ElseIf rngCell.Value &gt;= 3 Then\n            rngCell.Interior.ColorIndex = 4 'green\n\n        Else\n            rngCell.Interior.ColorIndex = 3\n\n        End If\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1544620848, "post_id": 53743916, "comment_id": 94340335, "body": "I don&#39;t understand what you&#39;re asking."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1545486272, "creation_date": 1545486272, "answer_id": 53896150, "question_id": 53743916, "link": "https://stackoverflow.com/questions/53743916/excel-vba-filter-critiriarange/53896150#53896150", "title": "Excel VBA filter CritiriaRange", "body": "<h1>Filter Combo</h1>\n\n<p>You have a sheet called after a month. You add a new sheet to the last postition and rename it. Now you can refer to it with <code>Sheets(Sheets.Count)</code> or <code>Sheets(\"Test \" &amp; Mh)</code> or <code>ActiveSheet</code>. I chose the first way. Then you copy the specifically filtered range (filters from sheet <code>Filters</code>) in the initial sheet to the new sheet. You apply additional 2 filters on the range. </p>\n\n<pre><code>Sub test()\n\n  Const cStr2 = \"WABO\"\n  Const cStr3 = \"Zuid\"\n\n  Application.DisplayAlerts = False\n\n  Dim Mh As String\n\n  Mh = ActiveSheet.Name 'Month name\n\n  'Add and Rename ActiveSheet\n  Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Test \" &amp; Mh\n\n  With Sheets(Sheets.Count)\n    'Filter Ranges\n     Sheets(Mh).Range(\"A1:F999\").AdvancedFilter Action:=xlFilterCopy, _\n         CriteriaRange:=Sheets(\"Filters\").Range(\"A1:B2\"), _\n         CopyToRange:=.Range(\"A1:F1\")\n    .Range(\"A2:F999\").AutoFilter Field:=2, Criteria1:=cStr2\n    .Range(\"A2:F999\").AutoFilter Field:=3, Criteria1:=cStr3\n  End With\n\n  Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2734261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b03a787b8bedfc5103bc69c50a07924?s=128&d=identicon&r=PG&f=1", "display_name": "Imans314", "link": "https://stackoverflow.com/users/2734261/imans314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545486272, "creation_date": 1544620640, "question_id": 53743916, "link": "https://stackoverflow.com/questions/53743916/excel-vba-filter-critiriarange", "title": "Excel VBA filter CritiriaRange", "body": "<p>I want to filter 2 columns from my sheet (B and C) and created code to do so but want to make it easier to change the filter criteria.</p>\n\n<p>What I have created is:</p>\n\n<pre><code>Sub test()\n\nApplication.DisplayAlerts = False\nDim Mh As String\nMh = ActiveSheet.Name 'Month name\n\n'Add en Rename ActiveSheet\n   Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Test \" &amp; Mh\n\n'Filter Ranges\n Range(\"A1\").Select\n Sheets(\"October\").Range(\"A1:F999\").AdvancedFilter Action:=xlFilterCopy, _\nCriteriaRange:=Sheets(\"Filters\").Range(\"A1:B2\"), CopyToRange:=Range(\"A1:F1\"), Unique:=False\n\nEnd Sub\n</code></pre>\n\n<p>What I would like is something like this to be able to change the filternames:</p>\n\n<pre><code>ActiveSheet.Range(\"A2:F999\").AutoFilter Field:=2, Criteria1:=\"WABO\"\nActiveSheet.Range(\"A2:F999\").AutoFilter Field:=3, Criteria1:=\"Zuid\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "activex", "designmode"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544645042, "post_id": 53743844, "comment_id": 94353791, "body": "The link in the question you linked probably solves the problem (delete the .exd files) <a href=\"https://stackoverflow.com/a/27500258/10223558\">stackoverflow.com/a/27500258/10223558</a> . You could also just add a custom ribbon, which IMO is a much cleaner more professional method."}, {"owner": {"reputation": 1, "user_id": 10780934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68a370b2c19b7be14495c9afaec8c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "JT1", "link": "https://stackoverflow.com/users/10780934/jt1"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544793231, "post_id": 53743844, "comment_id": 94412070, "body": "Unfortunately, upon removing the .exd files I received the same error."}], "owner": {"reputation": 1, "user_id": 10780934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68a370b2c19b7be14495c9afaec8c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "JT1", "link": "https://stackoverflow.com/users/10780934/jt1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580847669, "creation_date": 1544620386, "last_edit_date": 1580847669, "question_id": 53743844, "link": "https://stackoverflow.com/questions/53743844/activex-command-button-stops-working-when-excel-is-closed-and-then-reopened", "title": "ActiveX Command Button Stops working when Excel is closed and then reopened", "body": "<p>I am not the most experienced with vba so forgive me...\nI am currently working on some code that automates and captures data from an Omicron Program. This involves one active-x command button that once clicked commences the entire code.</p>\n\n<p>The command button works and the code executes exactly how I want it to, but...\nOnce I close and reopen excel I get the error </p>\n\n<blockquote>\n  <p>\"Can't exit design mode because Control <code>CommandButton1</code> can not be\n  created.\"</p>\n</blockquote>\n\n<p>A little odd considering it was working moments before. If I copy the work sheets and code to a new work book then everything begins to work again... until I close and reopen excel.</p>\n\n<p>From a quick google search I haven't found a successful solution. I did try the following recommended steps:</p>\n\n<ol>\n<li>Close all Excel documents</li>\n<li>Open a blank document</li>\n<li>Excel options > Trust center settings>macro settings>Select{Disable all macros with notifications}</li>\n<li><p>Active X settings ></p></li>\n<li><p>Select either:</p>\n\n<p>Disable all controls without notifications\nPrompt me before enabling all controls with minimal restrictions\nApply all settings and close.</p></li>\n<li><p>Open the affected file and check allow the prompt to enable macros if required.</p></li>\n</ol>\n\n<p>Found: <a href=\"https://superuser.com/questions/862168/cant-exit-design-mode-because-control-xxxx-can-not-be-created\">https://superuser.com/questions/862168/cant-exit-design-mode-because-control-xxxx-can-not-be-created</a></p>\n\n<p>This did not help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1544619556, "post_id": 53743529, "comment_id": 94339663, "body": "I suggest you start browsing the internet for examples on filtered data and copy/paste data to a certain range. Your current code is imo a bad start."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1544620357, "post_id": 53743529, "comment_id": 94340092, "body": "I recommend to read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> to your code first, before doing anything else."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1544620858, "post_id": 53743529, "comment_id": 94340343, "body": "I&#39;d have a look at getting excel cell data, as a first venture into code.  You are asking the wrong question, google &quot;get value from excel cell in VBA&quot;  i agree with @JvdV and Peh also."}, {"owner": {"reputation": 1, "user_id": 10780909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503d948fb8960851006913cf2e894ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Rachjulie", "link": "https://stackoverflow.com/users/10780909/rachjulie"}, "edited": false, "score": 0, "creation_date": 1544718295, "post_id": 53743529, "comment_id": 94384153, "body": "Thanks, as I said I&#39;m still learning. I managed to solve my problem and ended up with the following code which worked perfectly."}, {"owner": {"reputation": 1, "user_id": 10780909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503d948fb8960851006913cf2e894ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Rachjulie", "link": "https://stackoverflow.com/users/10780909/rachjulie"}, "edited": false, "score": 0, "creation_date": 1544718337, "post_id": 53743529, "comment_id": 94384183, "body": "&#39; Search Macro &#39;  &#39;  Application.ScreenUpdating = False      Sheets(&quot;Concur Expenses&quot;).Range(&quot;A13:f100&quot;).ClearContents     Sheets(&quot;Detail for selection&quot;).Select     Worksheets(&quot;Detail for selection&quot;).Range(&quot;$A$1:$F$55&quot;).AutoFilter Field:=6, Criteria1:=&quot;<i>&quot; &amp; Worksheets(&quot;Concur Expenses&quot;).Range(&quot;B7&quot;).Value &amp; &quot;</i>&quot;, _         Operator:=xlAnd     Range(&quot;A2:F100&quot;).Copy     Sheets(&quot;Concur Expenses&quot;).Range(&quot;A13&quot;).PasteSpecial     Sheets(&quot;Concur Expenses&quot;).Select     Range(&quot;B7&quot;).Select      End Sub"}], "owner": {"reputation": 1, "user_id": 10780909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503d948fb8960851006913cf2e894ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Rachjulie", "link": "https://stackoverflow.com/users/10780909/rachjulie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544623331, "creation_date": 1544619350, "last_edit_date": 1544623331, "question_id": 53743529, "link": "https://stackoverflow.com/questions/53743529/copy-and-paste-a-cell-into-a-filter-box-vba", "title": "copy and paste a cell into a filter box vba", "body": "<p>I'm extremely new to this and most off my codes have come from recording.</p>\n\n<p>I'm trying to complete a basic search using a filter box and then copy the cells onto a different work sheet ready to start again. </p>\n\n<p>This is the macro I recorded, the problem I keep having is rather than \"copy what is in Cell B7 in places the contents of what I record in the macro....=\"=<em>meal</em>\", I need this to be Cell B7 from the concur expenses tab?</p>\n\n<pre><code>Sub MySub()\n    Range(\"A13:G36\").Select\n    Selection.ClearContents\n\n    Range(\"B7\").Select\n    Selection.Copy\n\n    Sheets(\"Detail for selection\").Select\n    ActiveSheet.Range(\"$A$1:$F$55\").AutoFilter Field:=6, Criteria1:=\"=*meal*\", _\n        Operator:=xlAnd\n\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Sheets(\"Concur Expenses\").Select\n    Range(\"A12\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Sheets(\"Detail for selection\").Select\n    ActiveSheet.Range(\"$A$1:$F$55\").AutoFilter Field:=6\n\n    Sheets(\"Concur Expenses\").Select\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n\n    Range(\"B7\").Select\nEnd Sub\n</code></pre>\n\n<p>Any helps greatly appreciated,</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "target", "selectionchanged"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 3, "creation_date": 1544618402, "post_id": 53743098, "comment_id": 94339001, "body": "Most likely because using count errors out above a certain numbers of selected cells (Count is a Long data type). Use CountLarge like explained over here: <a href=\"https://stackoverflow.com/questions/25756467/target-count-causing-an-overflow-error\" title=\"target count causing an overflow error\">stackoverflow.com/questions/25756467/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "is_accepted": true, "score": 1, "last_activity_date": 1544620134, "last_edit_date": 1544620134, "creation_date": 1544619481, "answer_id": 53743565, "question_id": 53743098, "link": "https://stackoverflow.com/questions/53743098/vba-target-count-1-error-when-selecting-all/53743565#53743565", "title": "vba target.count=1 error when selecting all", "body": "<p><strong>tldr;</strong> You're trying to retrieve too large a number into the Range.Count property.</p>\n\n<p>The Range.Count property was written to return a long integer resolved to the total number of individual cells within the range object.</p>\n\n<blockquote>\n  <p><sup><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.count\" rel=\"nofollow noreferrer\">Range.Count property (Excel)</a></sup><br/>\n  <sub>Returns a Long value that represents the number of objects in the collection.</sub></p>\n</blockquote>\n\n<p>You're receiving <code>Runtime error 6: Overflow</code> because the total number of individual cells on an XLSX worksheet is 1,048,576 rows \u00d7 16,384 (A through XFD) columns. This resolves to 17,179,869,184 individual cells which exceeds the maximum alllowed value of a signed long integer\u00b9.</p>\n\n<hr>\n\n<p>\u00b9 <sub>The maximum value that a signed long integer can retain is 2,147,483,647 or &amp;H7FFF,FFFF16.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "is_accepted": false, "score": 2, "last_activity_date": 1544619918, "creation_date": 1544619918, "answer_id": 53743699, "question_id": 53743098, "link": "https://stackoverflow.com/questions/53743098/vba-target-count-1-error-when-selecting-all/53743699#53743699", "title": "vba target.count=1 error when selecting all", "body": "<p>Replace your <code>Target.Count</code> with <code>Target.CountLarge</code> property.</p>\n\n<p>Ref: <a href=\"http://msdn.microsoft.com/en-us/library/office/ff196838(v=office.15).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/office/ff196838(v=office.15).aspx</a></p>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 53743565, "answer_count": 2, "score": 0, "last_activity_date": 1544620134, "creation_date": 1544617927, "question_id": 53743098, "link": "https://stackoverflow.com/questions/53743098/vba-target-count-1-error-when-selecting-all", "title": "vba target.count=1 error when selecting all", "body": "<p>I have a sheet including code that would trigger some VBA code depending of which cells are selected. (a cell has the function of a button).\nSince the user can select ranges including several cells the way to limit that problem (not triggering the vba code when the cell is included in the selected range, but IT IS NOT THE ONLY CELL) is using targe.count\nThis work fine indeed when the user select several cells including the one which fires the vba BUT i am wondering why it gives error when the user selects all with CTRL-A</p>\n\n<p>this is the code behind the sheet</p>\n\n<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Count = 1 Then\n     run some code\n</code></pre>\n\n<p>If I select the whole sheet with contrl-A a error ocurr.</p>\n\n<p>runtime error 6\nOverflow</p>\n\n<p>More strange even. the sheet contains a table (listobject) If I do ctrl-A within the table the whole table is selected and no error occurs.\nIf I do ctrl-A outside the table the whole sheet is selected and an error occurs.</p>\n\n<p>Some explanation for this behaiviour? </p>\n"}, {"tags": ["html", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1544617077, "post_id": 53742742, "comment_id": 94338300, "body": "No question and no code!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544617856, "post_id": 53742742, "comment_id": 94338712, "body": "Please include your vba code and why the javascript tag? I can see HTML. Also, format your html properly. I have simply edited so it will display."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1544619600, "post_id": 53742742, "comment_id": 94339688, "body": "what does doesn&#39;t work mean?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10780541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d465e28c74e72e2540718c68eb5456?s=128&d=identicon&r=PG&f=1", "display_name": "Shikhar", "link": "https://stackoverflow.com/users/10780541/shikhar"}, "edited": false, "score": 0, "creation_date": 1544620848, "post_id": 53743624, "comment_id": 94340336, "body": "Thanks for your help, but I am still not able click the span"}, {"owner": {"reputation": 1, "user_id": 10780541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d465e28c74e72e2540718c68eb5456?s=128&d=identicon&r=PG&f=1", "display_name": "Shikhar", "link": "https://stackoverflow.com/users/10780541/shikhar"}, "edited": false, "score": 0, "creation_date": 1544623828, "post_id": 53743624, "comment_id": 94342080, "body": "I am not getting any error message but the above code gets executed and the span is not clicked"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 10780541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d465e28c74e72e2540718c68eb5456?s=128&d=identicon&r=PG&f=1", "display_name": "Shikhar", "link": "https://stackoverflow.com/users/10780541/shikhar"}, "edited": false, "score": 0, "creation_date": 1544623886, "post_id": 53743624, "comment_id": 94342116, "body": "is using selenium basic an option?"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 10780541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d465e28c74e72e2540718c68eb5456?s=128&d=identicon&r=PG&f=1", "display_name": "Shikhar", "link": "https://stackoverflow.com/users/10780541/shikhar"}, "edited": false, "score": 0, "creation_date": 1544678594, "post_id": 53743624, "comment_id": 94363356, "body": "@shikhar, can you please inform us what happen if you manually click on that span tag? further, try to debug your VBA code and check that it is finding the correct span and clicking on it or not. you can try to inform us your testing results. We will try to provide further suggestions, If needed."}, {"owner": {"reputation": 1, "user_id": 10780541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d465e28c74e72e2540718c68eb5456?s=128&d=identicon&r=PG&f=1", "display_name": "Shikhar", "link": "https://stackoverflow.com/users/10780541/shikhar"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1544691904, "post_id": 53743624, "comment_id": 94368696, "body": "@Deepak-MSFT When I manually click on that particular span tag, it opens a new form..."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1544764304, "post_id": 53743624, "comment_id": 94399046, "body": "other work around can be to add a link inside the span in HTML. So when you click using the code, that link will take you to the new form."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544766290, "post_id": 53743624, "comment_id": 94399520, "body": "Perhaps there is a js event that needs triggering."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1544620043, "last_edit_date": 1544620043, "creation_date": 1544619691, "answer_id": 53743624, "question_id": 53742742, "link": "https://stackoverflow.com/questions/53742742/vba-programming-code-to-click-on-span-in-a-webpage/53743624#53743624", "title": "vba programming code to click on Span in a webpage", "body": "<p>Did you try</p>\n\n<pre><code>ie.document.querySelector(\"[tabindex='0']\").click\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>ie.document.querySelector(\"[tabindex='0']\").FireEvent \"onclick\"\n</code></pre>\n\n<p>These target the element by its attribute <code>tabindex</code> and its value.</p>\n"}], "owner": {"reputation": 1, "user_id": 10780541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2d465e28c74e72e2540718c68eb5456?s=128&d=identicon&r=PG&f=1", "display_name": "Shikhar", "link": "https://stackoverflow.com/users/10780541/shikhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544622255, "creation_date": 1544616622, "last_edit_date": 1544622255, "question_id": 53742742, "link": "https://stackoverflow.com/questions/53742742/vba-programming-code-to-click-on-span-in-a-webpage", "title": "vba programming code to click on Span in a webpage", "body": "<p>HTML:</p>\n\n<pre><code>&lt;tr id=\"m48482eee_tbod_tdrow-tr[R:16]\"     class=\"tablerow   trodd\" style=\"display:;\" &gt;\n&lt;td role=\"presentation\" headers='m48482eeeerrtitle[R:-1]' aria-labelledby='m48482eeeerrtitle[R:-1]' class='tc' style='border-right:0px; width: 1px;'&gt;&lt;img id='m48482eee_tbod_tdrow-tr[R:16]_er_img' src='blank.gif' style='display:none' class='tablerow_blank_icon' title=\"\" alt=\"\"/&gt;&lt;/td&gt; &lt;td id=\"m48482eee_tdrow_[C:0]-c[R:16]\" tablecell=\"1\"     class=\"tc cd\" headers=\"m48482eee_ttrow_[C:0]-c\"  &gt;\n&lt;span id=\"m48482eee_tdrow_[C:0]_ttxt-lb[R:16]\" align='left' ctype=\"label\"    tabindex=\"0\"      targetid=\"m48482eee_tdrow_[C:0]_ttxt-lb[R:16]\"  mxevent=\"click\"  class=\"text label   anchor\" style=\"padding:0px;padding-left:1px;padding-top:5px;padding-bottom:5px;cursor:pointer;\"&gt;INVTROPPR - Transfer Opportunities for Items Under Max&lt;/span&gt;\n\n    &lt;/td&gt;\n</code></pre>\n\n<p>This is my code</p>\n\n<pre><code>For Each obj In ie.Document.forms(0).getElementsByTagName(\"span\")\n    If obj.innerText = \"INVTROPPR - Transfer Opportunities for Items Under \n    Max\" Then\n       obj.parentElement.Click\n       Exit For\n    End If\nNext\n</code></pre>\n\n<p>I want to click on a Span in a the HTML above. I tried to run the above code, but this is not working, where is the problem?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10678084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAEIxIg2vRI/AAAAAAAAAAI/AAAAAAAACZM/5JIPyC93Njg/photo.jpg?sz=128", "display_name": "Faraj", "link": "https://stackoverflow.com/users/10678084/faraj"}, "edited": false, "score": 0, "creation_date": 1544627985, "post_id": 53745305, "comment_id": 94344572, "body": "Hi @Harassed Dad, thank you for your reply. The file name to be saved can be anything (I will choose it myself later), I just meant to give an example that different cases will require a different file name. Apologies if that caused any confusion. Do I understand correctly that the code &#39;postpend = asc(ucase(range(&quot;c12&quot;)))-64&#39; sorts the dir by ascending order? And which part of the code sets the conditions for naming, i.e. If Cell C12 is ... , then name should be ...? Thanks."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1544625163, "creation_date": 1544625163, "answer_id": 53745305, "question_id": 53742663, "link": "https://stackoverflow.com/questions/53742663/searching-through-list-of-random-files-in-directory-and-renaming-files-based-on/53745305#53745305", "title": "Searching through list of random files in directory and renaming files based on Cell Value", "body": "<p>two files can't have the same name in the same directory so you can't name more than one file as \"1\" , Do you mean you want to rename the file to what it was before plus a \"1\"? Assuming you do - and assuming you want to append the 1 to the name and not the extension then</p>\n\n<pre><code>Sub RenameFiles\nConst dirholdingfiles = \"C:\\Test\"\ndim sFileName as string\ndim postpend as string\npostpend = asc(ucase(range(\"c12\")))-64\nsfilename=dir(dirholdingfiles)\ndo while sfilename &lt;&gt; \"\"\nmovefile dirholdingfiles &amp; \"\\\" &amp; sfilename dirholdingfiles &amp; \"\\\" &amp; left(sfilename,len(sfilename)-4) &amp; postpend &amp; right(sfilename,4)\nsfilename = dir()\nloop\nend sub\n</code></pre>\n\n<p>(Written on my phone - not tested, typos likely)</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 10678084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAEIxIg2vRI/AAAAAAAAAAI/AAAAAAAACZM/5JIPyC93Njg/photo.jpg?sz=128", "display_name": "Faraj", "link": "https://stackoverflow.com/users/10678084/faraj"}, "is_accepted": true, "score": 0, "last_activity_date": 1544697254, "creation_date": 1544697254, "answer_id": 53759870, "question_id": 53742663, "link": "https://stackoverflow.com/questions/53742663/searching-through-list-of-random-files-in-directory-and-renaming-files-based-on/53759870#53759870", "title": "Searching through list of random files in directory and renaming files based on Cell Value", "body": "<p>Found the solution, from an excellent explanation why it didn't work in this post: <a href=\"https://stackoverflow.com/questions/42494212/excel-vba-dir-loop-fails-when-open-and-close-command-added-within-loop\">Excel VBA Dir loop fails when open and close command added within loop</a></p>\n\n<p>Added an extra sub as the YowE3K suggested and it works great now!</p>\n"}], "owner": {"reputation": 17, "user_id": 10678084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAEIxIg2vRI/AAAAAAAAAAI/AAAAAAAACZM/5JIPyC93Njg/photo.jpg?sz=128", "display_name": "Faraj", "link": "https://stackoverflow.com/users/10678084/faraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53759870, "answer_count": 2, "score": -1, "last_activity_date": 1544697254, "creation_date": 1544616317, "last_edit_date": 1544687175, "question_id": 53742663, "link": "https://stackoverflow.com/questions/53742663/searching-through-list-of-random-files-in-directory-and-renaming-files-based-on", "title": "Searching through list of random files in directory and renaming files based on Cell Value", "body": "<p>EDIT: Included my code.</p>\n\n<p>I am still relatively new to VBA, so please bear with me:</p>\n\n<p>I am trying to write a code that will go through a folder and loop through all files (file names will be random) and rename them based on a specific cell's value, C12 in my case. To give an example:</p>\n\n<p>If C12 in a file = A, then file name should be 1, if C12 in a file = B, then file name should be 2, if C = 3, and so on. </p>\n\n<p>I have put together the following code:</p>\n\n<pre><code>Let Files = Dir(Path &amp; \"\\*.xlsx\")\n\nDo While Files &lt;&gt; \"\"\nSet X = Workbooks.Open(Path &amp; \"\\*.xlsx\", True, True)\nX.Saved = True\n\nIf X.Sheets(\"Sheet1\").Range(\"C12\").Value = \"VALUE1\" Then\n   Name Path &amp; File As Path &amp; NAME1\nX.Close\n\nElseIf X.Sheets(\"Sheet1\").Range(\"C12\").Value = \"VALUE2\" Then\n    Name Path &amp; File As Path &amp; NAME2\nX.Close\nEnd If\n\nFile = Dir()\n\nLoop\n</code></pre>\n\n<p>The way I understand it, the code should go through each file (because of <code>File = Dir()</code>) , open it and run the IF statement above, rename the file, and then move on to the next file in the directory and do the same. But when I run it, it only opens the same file every time. Any thoughts on why?</p>\n\n<p>Hope that makes sense. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 4, "creation_date": 1544615157, "post_id": 53742326, "comment_id": 94337158, "body": "Yes it is possible but for that do not use <code>MsgBox</code>. Use a Userform"}, {"owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1544615331, "post_id": 53742326, "comment_id": 94337234, "body": "Do you have any Example? I could really use some help."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1544615855, "post_id": 53742326, "comment_id": 94337549, "body": "Example: On Userform activation: Application.OnTime Now + TimeValue(&quot;00:00:05&quot;), &quot;NoResponse&quot;... Make a module that will Unload your userform."}], "owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "closed_date": 1544717036, "answer_count": 0, "score": 0, "last_activity_date": 1580458471, "creation_date": 1544615069, "last_edit_date": 1580458471, "question_id": 53742326, "link": "https://stackoverflow.com/questions/53742326/yes-no-message-box-automatically-press-no-if-there-is-no-response-for-5-second", "closed_reason": "Duplicate", "title": "Yes/NO Message Box - Automatically press No If there is no response for 5 seconds", "body": "<p>I'm looking to automate a workflow of opening a Workbook, running a macro and closing a file</p>\n\n<pre><code>//Run a Macro//\nActiveWorkbook.Close\n</code></pre>\n\n<p>But the problem with this is that I can't edit anything if I want to edit something, as it automatically closes the workbook. So I want to pop-up a Yes/No Message Box asking if I want to close the file. If there is no response it should automatically close(Press Yes). </p>\n\n<pre><code>/*Run a Macro*/\nClose:= MsgBox, \"Do you want to Close the File?\", vbYesNo\n\n/*Wait for 5 seconds for Response. If no response, automatically click Yes.*/\n\nIf Close = vbYes Then\n   ActiveWorkbook.Close\nElse\n   'Don't Close\nEnd If\n</code></pre>\n\n<p>P.S: Please do let me know if there is any simpler way to this.</p>\n\n<p><strong>Edit #1:</strong></p>\n\n<p>Thank you for the link below. I did find the <a href=\"https://stackoverflow.com/questions/40631009/display-popup-for-a-time-period-in-excel\">link</a> provided below useful, but it doesn't not satisy below points </p>\n\n<ol>\n<li>it is not a Yes/No popup.</li>\n<li>it doesn't click the Yes or Ok after 5 seconds. It just unloads the popup I tried this method using</li>\n<li>Userforms too. Using the Application.OnTime Now +\nTimeValue(\"00:00:05\"), \"Test\" function. But even that is not\ndesirable. Even if I click no the userform still runs the \"Test\"\nSub.</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1544614815, "post_id": 53741992, "comment_id": 94336977, "body": "Extended? What does that mean? What have you managed so far?"}, {"owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1544621958, "post_id": 53741992, "comment_id": 94340964, "body": "i added what i have."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "edited": false, "score": 0, "creation_date": 1544624369, "post_id": 53744886, "comment_id": 94342390, "body": "Thanks this selection works good. But it always selects until Column DI and i only want to select until the last two used columns, what do i have to change to make that happen?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "edited": false, "score": 0, "creation_date": 1544625393, "post_id": 53744886, "comment_id": 94343011, "body": "I&#39;ve updated the code so <code>rngStart</code> references the last two columns which are then autofilled across to <code>DI</code>."}, {"owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "edited": false, "score": 0, "creation_date": 1544625573, "post_id": 53744886, "comment_id": 94343117, "body": "the code works but it always selects until column &quot;DI&quot; and it needs to select only the last 2 columns and then autofill it from those last two culomns"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "edited": false, "score": 0, "creation_date": 1544625791, "post_id": 53744886, "comment_id": 94343250, "body": "You asked <i>I like to have a VBA code that selects the last two columns of my sheet. When the columns are selected they need to be extended until column DI.</i>    Where does it autofill to if not column <code>DI</code>?"}, {"owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "edited": false, "score": 0, "creation_date": 1544628680, "post_id": 53744886, "comment_id": 94345007, "body": "yes sorry, i meant something else. I mean it does not use the two columns that are selected (the last two). in each column is an function that adds +7 to a certain row. as seen in the picture. When i use the code it adds 1 and not 7. so that means it does not use the last two rows but only the last row."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1544625314, "last_edit_date": 1544625314, "creation_date": 1544623810, "answer_id": 53744886, "question_id": 53741992, "link": "https://stackoverflow.com/questions/53741992/excel-select-last-two-columns-and-extend/53744886#53744886", "title": "excel select last two columns and extend", "body": "<p>This will select the columns between your last column (based on data in row 9 as you used <code>G9</code>) and column <code>DI</code>.  </p>\n\n<pre><code>Sub test()\n\n    Dim rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set rng = .Range(.Cells(9, .Columns.Count).End(xlToLeft).EntireColumn, .Columns(\"DI\"))\n    End With\n\n    'Try not to select ranges before using them.\n    MsgBox rng.Address\n    rng.Interior.Color = RGB(255, 255, 0) 'Turn background to yellow.\n\n    rng.Select 'Select the range.\n\nEnd Sub\n</code></pre>\n\n<p>The selection will include the last populate column.<br>\nSo might want to use <code>.Cells(9, .Columns.Count).End(xlToLeft).Offset(, 1).EntireColumn</code> instead.  </p>\n\n<p>Also if last populated column is > <code>DI</code> it will select backwards so could select column <code>DN:DI</code> for example.  </p>\n\n<p><strong>Edit:</strong><br>\nTo autofill from last populated column to column <code>DI</code>:  </p>\n\n<pre><code>Sub test()\n\n    Dim rng As Range\n    Dim rngStart As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set rngStart = .Cells(9, .Columns.Count).End(xlToLeft).Offset(, -1).EntireColumn.Resize(, 2)\n        Set rng = .Range(rngStart, .Columns(\"DI\"))\n    End With\n\n    rngStart.AutoFill rng, xlFillValues\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1544629852, "post_id": 53746532, "comment_id": 94345780, "body": "That does exactly what my second block of code does.  Are you a manager by any chance? :)"}], "tags": [], "owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "is_accepted": false, "score": 0, "last_activity_date": 1544629299, "creation_date": 1544629299, "answer_id": 53746532, "question_id": 53741992, "link": "https://stackoverflow.com/questions/53741992/excel-select-last-two-columns-and-extend/53746532#53746532", "title": "excel select last two columns and extend", "body": "<p>Thanks all for the help i edited the code a bit to make it work for me.</p>\n\n<pre><code>Private Sub CommandButton4_Click()\nDim rng As Range\nDim rngStart As Range\nDim rngEnd As Range\nDim rngX As Range\n\nWith ThisWorkbook.Worksheets(\"Blad1\")\n    Set rngStart = .Cells(9, .Columns.Count).End(xlToLeft).Offset(, -1).EntireColumn\n    Set rngEnd = .Cells(9, .Columns.Count).End(xlToLeft).EntireColumn\n    Set rng = .Range(rngStart, .Columns(\"DI\"))\n    Set rngX = .Range(rngStart, rngEnd)\n\nEnd With\nrngX.AutoFill rng, xlFillDefault\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1544629366, "creation_date": 1544613855, "last_edit_date": 1544629366, "question_id": 53741992, "link": "https://stackoverflow.com/questions/53741992/excel-select-last-two-columns-and-extend", "title": "excel select last two columns and extend", "body": "<p>I like to have a VBA code that selects the last two columns of my sheet.\nWhen the columns are selected they need to be extended until column DI.</p>\n\n<p>what i have so far as code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n'select the last two columns\n\n    Range(\"G9\").Select\n    Selection.End(xlToRight).Select\n    ActiveCell.EntireColumn.Resize(, 2).Offset(, -1).Select\n\n'Extend the two last columns until it have reached column: DI\n\nEnd Sub\n</code></pre>\n\n<p>Now i only need to add the code for draggin the two columns until it reached column \"DI\" as seen in the image below. i dont have the reputation for images so its became a link\n<a href=\"https://i.stack.imgur.com/AiISr.png\" rel=\"nofollow noreferrer\">image</a></p>\n\n<p>any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 10780486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9a714fdb554e197bef8d4d5f9f59b3?s=128&d=identicon&r=PG&f=1", "display_name": "vba_noob", "link": "https://stackoverflow.com/users/10780486/vba-noob"}, "edited": false, "score": 0, "creation_date": 1544613958, "post_id": 53741767, "comment_id": 94336438, "body": "Just to add I think its a combination of if and else statements but I am not sure how to add that"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544645692, "post_id": 53741767, "comment_id": 94354065, "body": "Sharepoint can be a bit tricky with file access, are all paths mapped out on the pc?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10780486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9a714fdb554e197bef8d4d5f9f59b3?s=128&d=identicon&r=PG&f=1", "display_name": "vba_noob", "link": "https://stackoverflow.com/users/10780486/vba-noob"}, "edited": false, "score": 0, "creation_date": 1545231822, "post_id": 53753226, "comment_id": 94555251, "body": "Sir, I tip my hat to you, it got me what I needed to do :D"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 13, "user_id": 10780486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9a714fdb554e197bef8d4d5f9f59b3?s=128&d=identicon&r=PG&f=1", "display_name": "vba_noob", "link": "https://stackoverflow.com/users/10780486/vba-noob"}, "edited": false, "score": 0, "creation_date": 1545232985, "post_id": 53753226, "comment_id": 94556005, "body": "@vba_noob Hey, glad I could help. If you think this solution solved your problem please mark this answers as accepted, thanks."}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 0, "last_activity_date": 1544659696, "last_edit_date": 1544659696, "creation_date": 1544659384, "answer_id": 53753226, "question_id": 53741767, "link": "https://stackoverflow.com/questions/53741767/excel-macro-saving-sheet-as-pdf-to-sharepoint-to-location-dependent-on-input-in/53753226#53753226", "title": "Excel macro saving sheet as pdf to sharepoint to location dependent on input in new folder", "body": "<p>OK, I probably overshot the targer a bit...</p>\n\n<p>This code only works with drives mapped to the normal Filesystem, if you want to use a network path you can read some more on the topic here: <a href=\"https://stackoverflow.com/q/45039061/\">Cannot save file to Sharepoint Online using VBA (Permissions error)</a><br>\nUnfortunately I do not have a way to test code against a Sharepoint Server until I get back to work.</p>\n\n<p>First of, you need to add the <code>Microsoft Scripting Runtime</code> to your project, described here: <a href=\"https://stackoverflow.com/a/3236348\">https://stackoverflow.com/a/3236348</a></p>\n\n<p>You can call the <code>publishQuoteToDirectory</code> sub from anywhere inside your project. I would recommend a custom Ribbon in the Application that passes the activeSheet Object, but you could also just point a Makro to <code>runExportExample</code> and fill in some static parameters.</p>\n\n<ul>\n<li><strong>sheetToPublish:</strong> Expects a Worksheet Object, you can use ActiveSheet if you want</li>\n<li><strong>publishingPath:</strong> The \"Quotes\" Folder</li>\n<li><strong>currencyCell:</strong> The Cell which holds the Currency</li>\n<li><strong>fileName:</strong> If you want to override the Filename for some reason</li>\n</ul>\n\n<p>The <code>Select Case</code> structure decides which currency the Worksheet Contains, it also accepts the signs of the currencies, can be extended with whatever you want.</p>\n\n<p><code>quoteNamePathPart</code> I was not exactly sure how you meant this in your main question, this gives you the option to use the Workbook or the Worksheet Name, choose whichever you want.</p>\n\n<p>The <code>FileSystemObject</code> helps us with building a valid path, there are other methodes to create this but I prefer using it over them because it gives direct access to the Microsoft Filesystem.</p>\n\n<p><code>BuildFullPath</code> is a separate sub because it has to call itself recursively. The FSO can not create nested Folder in one Action. An alternative would be to use the Shell (described here: <a href=\"https://stackoverflow.com/a/4407468\">https://stackoverflow.com/a/4407468</a>).</p>\n\n<p>This is the whole Magic, if you have any Question regarding the code feel free to ask.\nThere are definitely other easier, faster, more secure ways to solve this. My knowledge with VBA is still limited and I don't know all the best practices, but the code should get the job done. (@all the other, feel free to criticize)</p>\n\n<hr>\n\n<h2>Code:</h2>\n\n<pre><code>'all this sits in a standart module:\nOption Explicit\n\nPrivate Const StandartCurrencyCell As String = \"B2\"\nPrivate Const StandartFileName As String = \"Quote.pdf\"\n\n\nPublic Sub runExportExample()\n    publishQuoteToDirectory _\n        sheetToPublish:=ActiveSheet, _\n        publishingPath:=\"C:\\Users\\User1\\company\\Sales Team - Documents\\Quotes\\\", _\n        currencyCell:=\"B2\", _\n        fileName:=\"SomeOtherFileName.pdf\"\nEnd Sub\n\n\nPublic Sub publishQuoteToDirectory(sheetToPublish As Worksheet, Optional publishingPath As String, Optional currencyCell As String, Optional fileName As String)\n\n    'Sanitize the input if necessary\n    If publishingPath = \"\" Then publishingPath = Environ$(\"USERPROFILE\") &amp; \"\\Quotes\\\"\n    If currencyCell = \"\" Then currencyCell = StandartCurrencyCell\n    If fileName = \"\" Then fileName = StandartFileName\n\n    Dim currencyPathPart As String\n    Select Case sheetToPublish.Range(currencyCell).Value2\n        Case \"USD\", \"$\"\n            currencyPathPart = \"USD\"\n        Case \"EUR\", \"\u20ac\"\n            currencyPathPart = \"EUR\"\n        Case \"GBP\", \"\u00a3\"\n            currencyPathPart = \"GBP\"\n        Case Else\n            currencyPathPart = \"OtherCurrencies\"\n    End Select\n\n    Dim quoteNamePathPart\n    With New FileSystemObject\n        'I'm a bit sceptic on the correctness of this, since your PDF is called \"Quote\" the FOlder Name would be \"Quote\" as well\n        'Comment out whatever you don't want\n        'I think this should be:\n        quoteNamePathPart = .GetBaseName(sheetToPublish.Parent.Name) 'this will use the Workbook Name (without Suffix)\n        'not:\n        'quoteNamePathPart = sheetToPublish.Name 'This will use the Name of the Sheet\n\n        'build the path and create folder, using the FSO takes care of missing Seperators etc.\n        publishingPath = .BuildPath(publishingPath, currencyPathPart)\n        publishingPath = .BuildPath(publishingPath, quoteNamePathPart)\n        BuildFullPath (publishingPath)\n\n        publishingPath = .BuildPath(publishingPath, fileName)\n\n    End With\n\n    On Error GoTo ExportFailed\n    sheetToPublish.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        fileName:=publishingPath, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n\n    Exit Sub\n\nExportFailed:\n    MsgBox prompt:=\"The Export of the File: \" &amp; fileName &amp; \" failed\" &amp; vbCrLf &amp; \"The expected Output Path was: \" &amp; publishingPath, Title:=\"Export Failed\"\nEnd Sub\n\n\nSub BuildFullPath(ByVal FullPath)\n    'FSO can only create one Folder at a time, so I used a recursive function found here: https://stackoverflow.com/a/4407468\n    Dim fso As New FileSystemObject\n    If Not fso.FolderExists(FullPath) Then\n        BuildFullPath fso.GetParentFolderName(FullPath)\n        fso.CreateFolder FullPath\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10780486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9a714fdb554e197bef8d4d5f9f59b3?s=128&d=identicon&r=PG&f=1", "display_name": "vba_noob", "link": "https://stackoverflow.com/users/10780486/vba-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2253, "favorite_count": 1, "accepted_answer_id": 53753226, "answer_count": 1, "score": 1, "last_activity_date": 1544659696, "creation_date": 1544613094, "last_edit_date": 1544613649, "question_id": 53741767, "link": "https://stackoverflow.com/questions/53741767/excel-macro-saving-sheet-as-pdf-to-sharepoint-to-location-dependent-on-input-in", "title": "Excel macro saving sheet as pdf to sharepoint to location dependent on input in new folder", "body": "<p>I am new to VBA and have to complete a task for my manager about saving sheet as a pdf into sharepoint (if firstly can be done) which creates a folder at the location with the same name as the saved PDF and saves the pdf there.</p>\n\n<p>Now where it gets harder for me is at the location in sharepoint there are 3 folders, for USD, EUR and GBP and depending on a field in the excel (which will denote one of the 3 currencies) it will have to be saved at that location</p>\n\n<p>(Sharepoint URL or mapped to network drive)\\Quote\\USD\\new folder created with file name matching pdf\\pdf file</p>\n\n<p>(Sharepoint URL or mapped to network drive)\\Quote\\EUR\\new folder created with file name matching pdf\\pdf file</p>\n\n<p>(Sharepoint URL or mapped to network drive)\\Quote\\GBP\\new folder created with file name matching pdf\\pdf file</p>\n\n<p>Is it the sharepoint URL will work or is it only when mapped to the network drive (which I have with a filepath with my username which im guessing would stop working from anyone else but me)</p>\n\n<p>I am using the below which saves to sharepoint but with me as User_1 I cant see how anyone else will be able to?</p>\n\n<pre><code>Sub test()\n\n     ChDir \"C:\\Users\\user_1\\company\\Sales Team - Documents\\Quotes\"\nWith Sheets(\"Quote\")\n\n    .ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=\"C:\\Users\\user_1\\company\\Sales Team - Documents\\Quotes\\\" &amp;   ActiveSheet.Range(\"B2\").Value &amp; \" Quote.pdf\", _\n\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\nEnd With\nend sub\n</code></pre>\n\n<p>It took me a while to figure out the above (which im sure is really simple) but i am still learning, </p>\n\n<p>Can anyone help me with this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544614331, "post_id": 53741886, "comment_id": 94336671, "body": "Great! Thank you very much! Works like a charm. Just one question to complicate it a bit :) How would it be possible to tdf.Name show only the text before the second underscore? Thus, WIP_100, please? I have tried the left  function, but length of system names varies by  length - e.g. PA_40, SGWC_1400 etc. Thank you!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544614795, "post_id": 53741886, "comment_id": 94336958, "body": "They&#39;ll only have a maximum of two underscores (i.e. take everything before the last underscore)?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544614963, "post_id": 53741886, "comment_id": 94337037, "body": "You&#39;d use <code>LEFT(tdf.Name, INSTRREV(tdf.Name,&quot;_&quot;)-1)</code>.  <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/instrrev-function\" rel=\"nofollow noreferrer\">INSTRREV</a> returns the position of an occurrence of one string within another, from the end of the string.  So the <code>LEFT</code> function returns everything to the left of whatever number <code>INSTRREV</code> returns."}, {"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 1, "creation_date": 1544615200, "post_id": 53741886, "comment_id": 94337178, "body": "Splendid! Thank you very much!"}, {"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544616069, "post_id": 53741886, "comment_id": 94337685, "body": "Actually it should be everything before the second (the middle underscore), can I use the MID function, please? Thank you!"}, {"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544616839, "post_id": 53741886, "comment_id": 94338158, "body": "Because this way it leaves WIP_100_AGR from the name WIP_100_AGR_USERS. However I would need only WIP_100...so how would I get the text before second occurence of _ (underscore)? Thank you!"}, {"owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "edited": false, "score": 0, "creation_date": 1544618737, "post_id": 53741886, "comment_id": 94339187, "body": "Hi, already solved it! Thank you very much! The string was &quot;CurrentDb.Execute <code>UPDATE [&quot; &amp; tdf.Name &amp; _                 &quot;] SET [SYSTEM NO] = &#39;&quot; &amp; Left(tdf.Name, InStr(InStr(1, tdf.Name, &quot;_&quot;) + 1, tdf.Name, &quot;_&quot;) - 1) &amp; &quot;&#39;&quot;, dbFailOnError</code>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1544613445, "creation_date": 1544613445, "answer_id": 53741886, "question_id": 53741638, "link": "https://stackoverflow.com/questions/53741638/access-vba-add-new-column-to-existing-table-with-name-of-the-actual-table/53741886#53741886", "title": "Access VBA - add new column to existing table with name of the actual table", "body": "<p>Providing none of your tables already have a field named <code>SYSTEM NO</code> then this should work:  </p>\n\n<pre><code>Sub InsertNameField()\n\n    Dim tdf As DAO.TableDef\n\n    For Each tdf In CurrentDb.TableDefs\n        If Left(tdf.Name, 4) &lt;&gt; \"MSys\" And Left(tdf.Name, 1) &lt;&gt; \"~\" Then\n            CurrentDb.Execute \"ALTER TABLE [\" &amp; tdf.Name &amp; _\n                \"] ADD COLUMN [SYSTEM NO] TEXT(255)\", dbFailOnError\n\n            CurrentDb.Execute \"UPDATE [\" &amp; tdf.Name &amp; _\n                \"] SET [SYSTEM NO] = '\" &amp; tdf.Name &amp; \"'\", dbFailOnError\n\n        End If\n    Next tdf\n\n    MsgBox \"Finished.\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>NB</strong> Test on a copy of your database first.</p>\n"}], "owner": {"reputation": 115, "user_id": 9799161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a09e100ce77206beeaef98f6021023?s=128&d=identicon&r=PG&f=1", "display_name": "user9799161", "link": "https://stackoverflow.com/users/9799161/user9799161"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1120, "favorite_count": 0, "accepted_answer_id": 53741886, "answer_count": 1, "score": 0, "last_activity_date": 1544613445, "creation_date": 1544612675, "last_edit_date": 1544613030, "question_id": 53741638, "link": "https://stackoverflow.com/questions/53741638/access-vba-add-new-column-to-existing-table-with-name-of-the-actual-table", "title": "Access VBA - add new column to existing table with name of the actual table", "body": "<p>I have imported various tables - WIP_100_AGR_USERS, WIP_100_USR06, WBP_100_USR02 with their real names as they were downloaded from SAP. Now I would need to add column \"SYSTEM_NO\"where would be the name of the table by use of VBA for ACCESS next to all other records in the particular table. </p>\n\n<p>E.g. I have table WIP_100_USR06, so the result will be:</p>\n\n<pre><code>AGR NAME| SYSTEM NO\n________|______________\nashkjas | WIP_100_USR_06\nasdjhjh | WIP_100_USR_06\n</code></pre>\n\n<p>Thank you!!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1544615065, "post_id": 53741537, "comment_id": 94337100, "body": "Not for points but I guess you chose FSO over DIR? Or maybe you actually did not understand my answer? Feel free to select Jeremy&#39;s answer but in preference to FSO (FileSystemObject) I recommend using the (VBA methods) Dir, FileCopy and Kill. Use FSO only where necessary."}, {"owner": {"reputation": 41, "user_id": 9202163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1775d0b82797582bbec494e6f8a8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Razzleflamm", "link": "https://stackoverflow.com/users/9202163/nick-razzleflamm"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1544615605, "post_id": 53741537, "comment_id": 94337393, "body": "Hey sorry I appreciate your answer but Jimmy&#39;s answer provided me an immediate solution which i needed whereas with yours i had to experiment with the code a little. Could you share the advantages of using VBA methods as you mentioned over FSO in this instance? Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1544613145, "last_edit_date": 1544613145, "creation_date": 1544612658, "answer_id": 53741629, "question_id": 53741537, "link": "https://stackoverflow.com/questions/53741537/check-availability-of-folder-files/53741629#53741629", "title": "Check availability of folder/files", "body": "<pre><code>RFPath = \"\"\nOn Error Resume Next\nRFPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\\"\nOn Error GoTo 0\n</code></pre>\n\n<p>You are creating the path in a String Variable but not checking if it exists or not. Use this function</p>\n\n<pre><code>Public Function FileFolderExists(strFullPath As String) As Boolean\n    On Error GoTo EarlyExit\n    If Not Dir(strFullPath, vbDirectory) = vbNullString Then FileFolderExists = True\nEarlyExit:\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Ex:</p>\n\n<pre><code>Debug.Print FileFolderExists(RFPath)\n</code></pre>\n\n<p>Also to store in a String variable you do not need the <code>On Error Resume Next</code>. You can directly do</p>\n\n<pre><code>RFPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 41, "user_id": 9202163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1775d0b82797582bbec494e6f8a8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Razzleflamm", "link": "https://stackoverflow.com/users/9202163/nick-razzleflamm"}, "edited": false, "score": 0, "creation_date": 1544614192, "post_id": 53741952, "comment_id": 94336578, "body": "@NickRazzleflamm No problem :)"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": true, "score": 1, "last_activity_date": 1544613700, "creation_date": 1544613700, "answer_id": 53741952, "question_id": 53741537, "link": "https://stackoverflow.com/questions/53741537/check-availability-of-folder-files/53741952#53741952", "title": "Check availability of folder/files", "body": "<p>I'd advise using the <code>file scripting object</code> to avoid the volatility where you can come up against issues if looping the function:</p>\n\n<pre><code>Sub FileCheck()\nDim FSO As Object\nDim CheckForFolder As Boolean, CheckForFile1 As Boolean, CheckForFile2 As Boolean\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nCheckForFolder = False\nCheckForFile1 = False\nCheckForFile2 = False\n\n'Check the REQUIRED FILES folder\nUserForm1.Show\n\nIf FSO.FolderExists(Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\\") Then CheckForFolder = True ' Checks for the folder. If it exsists, set boolean to \"True\"\n\nIf FSO.FileExists(Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\UPDATED_OUTLET_LIST.xlsx\") Then CheckForFile1 = True ' Checks for the 1st file. If it exsists, set boolean to \"True\"\n\nIf FSO.FileExists(Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\SAP_OUTLET_LIST.xlsx\") Then CheckForFile2 = True ' Checks for the 2nd file. If it exsists, set boolean to \"True\"\n\n\nIf CheckForFolder = False Then ' Checks the boolean, asings the checkbox accordingly\n    UserForm1.CheckBox3.Value = False\nElse\n    UserForm1.CheckBox3.Value = True\nEnd If\n\nIf CheckForFile2 = False Then ' Checks the boolean, asings the checkbox accordingly\n    UserForm1.CheckBox2.Value = False\nElse\n    UserForm1.CheckBox2.Value = True\nEnd If\n\nIf CheckForFile1 = False Then ' Checks the boolean, asings the checkbox accordingly\n    UserForm1.CheckBox1.Value = False\nElse\n    UserForm1.CheckBox1.Value = True\nEnd\n\nSet FSO = Nothing 'Tidy up the memory\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9202163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1775d0b82797582bbec494e6f8a8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Razzleflamm", "link": "https://stackoverflow.com/users/9202163/nick-razzleflamm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 53741952, "answer_count": 2, "score": 0, "last_activity_date": 1580910293, "creation_date": 1544612374, "last_edit_date": 1580910293, "question_id": 53741537, "link": "https://stackoverflow.com/questions/53741537/check-availability-of-folder-files", "title": "Check availability of folder/files", "body": "<pre><code>Sub CWSSCheck()\n\nIf ActiveSheet.Name = \"Position_by_Fixture\" Then\n\nCall FileCheck\n\nElseIf ActiveSheet.Name = \"Group_PositionList\" Then\nMsgBox \"This is the Group Position List. Convert the Shelfstock to the old \nformat using the 'Convert Shelfstock' function and try again.\", vbExclamation, \"Invalid Format\"\n\nElse\nMsgBox \"This workbook doesn't have a Shelfstock sheet. Please open a valid Shelfstock file and try again.\", vbExclamation, \"Shelfstock Not Found\"\n\nEnd If\nEnd Sub\n\nSub FileCheck()\n\n'Check the REQUIRED FILES folder\nUserForm1.Show\n\nDim RFPath As String\nDim UOLPath As String\nDim SOLPath As String\n\nRFPath = \"\"\nOn Error Resume Next\nRFPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\\"\nOn Error GoTo 0\n\nUOLPath = \"\"\nOn Error Resume Next\nUOLPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\UPDATED_OUTLET_LIST.xlsx\"\nOn Error GoTo 0\n\nSOLPath = \"\"\nOn Error Resume Next\nSOLPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\REQUIRED FILES\\SAP_OUTLET_LIST.xlsx\"\nOn Error GoTo 0\n\nIf RFPath = \"\" Then\n    UserForm1.CheckBox3.Value = False\nElse\n    UserForm1.CheckBox3.Value = True\nEnd If\n\nIf SOLPath = \"\" Then\n    UserForm1.CheckBox2.Value = False\nElse\n    UserForm1.CheckBox2.Value = True\nEnd If\n\nIf UOLPath = \"\" Then\n    UserForm1.CheckBox1.Value = False\nElse\n    UserForm1.CheckBox1.Value = True\nEnd \n\nEnd Sub\n</code></pre>\n\n<p>I wrote the following code to check for a folder in the user's desktop and two files inside that folder and then update three checkboxes in a userform. </p>\n\n<p>But every time i run this i get different results regardless the availability of the files in the said folder. The code seems to be checking the checkboxes at random.</p>\n\n<p>I'm having a hard time seeing what's wrong with the code. Any help would be appreciated!</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 133386, "user_id": 295783, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da548667c834109a7059b51060e53dff?s=128&d=identicon&r=PG", "display_name": "mplungjan", "link": "https://stackoverflow.com/users/295783/mplungjan"}, "edited": false, "score": 0, "creation_date": 1544611808, "post_id": 53741317, "comment_id": 94335263, "body": "I have removed the JavaScript tag."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1544614886, "post_id": 53741317, "comment_id": 94337006, "body": "Is it a form as opposed to a button (have you tried <code>.Submit</code>)?"}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1544615567, "post_id": 53741317, "comment_id": 94337368, "body": "1st two loop are useless. If I manually hover over the menu it kind of generate its elements, then 3rd loop works fine. Only problem I am having is that I dont know how write code to hover over the menu so that it generates relevant code. And for your question there are no submit option except at the beginning wnem I logging into the website."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544618027, "post_id": 53741317, "comment_id": 94338807, "body": "Please share your html."}, {"owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "edited": false, "score": 0, "creation_date": 1544673956, "post_id": 53741317, "comment_id": 94362317, "body": "I have shared HTML when I have not hovered over the menu. I have no idea how to work this. I want to hover over &#39;IMPORT&#39; first then &#39;STATIC DATA&#39; then click on &#39;ISIN&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1544698507, "creation_date": 1544698507, "answer_id": 53760257, "question_id": 53741317, "link": "https://stackoverflow.com/questions/53741317/html-onmouseover-onmouseout-element-click-error-object-variable-or-with-bl/53760257#53760257", "title": "HTML - onmouseover, onmouseout - Element click error- Object variable or with block not set Error 91", "body": "<p>Ok Since it was issue of simple mouseover which I believe didnot interpret the way others understood, I figured it out by myself. Instead of using click event I made only one change and it works like a charm.</p>\n\n<pre><code>element.FireEvent \"onmouseover\"\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7189757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f950dfcba8c35c4a2d2c6370a9d1faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Suman Kumar", "link": "https://stackoverflow.com/users/7189757/suman-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 53760257, "answer_count": 1, "score": 0, "last_activity_date": 1580909170, "creation_date": 1544611676, "last_edit_date": 1580909170, "question_id": 53741317, "link": "https://stackoverflow.com/questions/53741317/html-onmouseover-onmouseout-element-click-error-object-variable-or-with-bl", "title": "HTML - onmouseover, onmouseout - Element click error- Object variable or with block not set Error 91", "body": "<p>I have a website where I got Menu bar which is in frame 1 and its sub menus are in frame 2. Now I have found all the element where I need to go. But problem that I am facing is that if I manually hover on those menu then code works but if I don't I get error no 91. Can you please help me resolve this issue? below is the code that I am using for the same.</p>\n\n<p>Once I hover on 1st option its html changes, when I hover over 2nd menu option again HTML code changes. How do I control it?</p>\n\n<p>IMPORT (hover) -> STATIC DATA (hover) -> ISIN (CLICK)  </p>\n\n<pre><code>Sub test()\n\nDim IE As InternetExplorer\nDim doc, element\nSet IE = New InternetExplorer\nDim frm\nDim menu\nDim submenu\nDim submenu2\n\nIE.Visible = True\nIE.Navigate URL\n\nDo\n    DoEvents\n    Loop Until IE.ReadyState = READYSTATE_COMPLETE\n\n    IE.Document.all(\"usr_name\").Value = uName\n    IE.Document.all(\"password\").Value = pwd\n    IE.Document.getElementsByTagName(\"input\")(7).Click\n\n    DoEvents\nLoop Until IE.ReadyState = READYSTATE_COMPLETE\n\nSleep (2000)\nSet doc = IE.Document\nSleep (5000)\n\n'doc.frames(0).Document.getElementsByTagName(\"Body\")(0).getElementsByTagName(\"Div\")(5).FireEvent (\"onclick\")\n'\n'Sleep (2000)\n'doc.frames(1).Document.getElementsByTagName(\"Body\")(0).getElementsByTagName(\"span\")(0).FireEvent (\"onclick\")\n\nFor Each element In doc.frames(0).Document.getElementsByTagName(\"Body\")(0).getElementsByTagName(\"Div\")\n    Debug.Print element.innerHTML\n    If InStr(1, element.innerHTML, \"IMPORT\", vbTextCompare) &gt; 0 Then\n         element.Click\n         Exit For\n    End If\nNext\n\n'Frame 2 sub menu...I think I need something which can hover over these menu\nFor Each element In doc.frames(1).Document.getElementsByTagName(\"Body\")(0).getElementsByTagName(\"span\")\n\n    Debug.Print element.innerHTML\n    If InStr(1, element.innerHTML, \"Static Data\", vbTextCompare) &gt; 0 Then\n         element.Click\n         Exit For\n    End If\n\nNext\n\n'This is where I click\nFor Each element In doc.frames(1).Document.getElementsByTagName(\"Body\")(0).getElementsByTagName(\"div\")\n\n    If InStr(1, element.innerHTML, \"ISIN\", vbTextCompare) &gt; 0 Then\n    Debug.Print element.innerHTML\n        element.Click\n        Exit For\n    End If\n    Debug.Print element.innerHTML\n\nNext element\n\n'doc.frames(1).Document.getElementsByTagName(\"Body\")(0).getElementsByTagName(\"Span\")(28).Click  '' ISIN\n\nEnd Sub\n</code></pre>\n\n<p>Please let me know if I need to provide any other data here. Please find below the html when I have not hover over the menu...</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;TR&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD onclick=fSetSelected(this) onmouseover=this.bgColor=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR&gt;\n\n&lt;TD onclick=fSetSelected(this) onmouseo\nSETUP\n\nver=this.bgColoIMPORT\n\nEXPORT\n\nREPORTS\n\nBILLING\n\nMIS\n\nDOC TRACKING\n\nLOG OUT &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\nr=gcToggle onmouseout=this.bgColor=gcBG id=calCell style=\"CURSOR: hand; FONT: bold 16px Courier\" bgColor=#cccccc height=18 vAlign=middle borderColor=#cccccc align=center&gt;&lt;FONT id=cellText Victor=\"Liming Weng\"&gt;&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;\n</code></pre>\n\n<p>Below code I found in javascript: Woruld it be any help understanding the issue?</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>oCFMenu.makeTop('IMPORT') //Main 2\n    oCFMenu.makeSub('Static Data&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;raquo;')\n        oCFMenu.makeSub2('ISIN','import_isin.asp','frmMain')\n        oCFMenu.makeSub2('Business Partner','import_bp.asp','frmMain')\n        oCFMenu.makeSub2('CC Calender','import_cccalender.asp','frmMain')\n        oCFMenu.makeSub2('Auto Corporate','import_autocorporate.asp','frmMain')\n        oCFMenu.makeSub2('CA (Corporate Action)','import_autocorporateCA.asp','frmMain')\n</code></pre>\n\n<p>Below are the relevent html for IMPORT, STATIC DATA and ISIN</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;DIV id=divTop1 class=clMain style=\"CLIP: rect(0px 126px 20px 0px); HEIGHT: 20px; WIDTH: 126px; LEFT: 80px; TOP: 39px; VISIBILITY: visible; BACKGROUND-COLOR: #cccccc\"&gt;IMPORT&lt;/DIV&gt;\n\n&lt;DIV id=divSub0 class=clSubs style=\"LEFT: 80px; TOP: 0px; VISIBILITY: visible; BACKGROUND-COLOR: #cccccc\"&gt;&lt;SPAN class=clSub style=\"COLOR: white\"&gt;Static Data&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\u00bb&lt;/SPAN&gt;&lt;/DIV&gt;\n\n&lt;DIV id=divSub2_0 class=clSubs2 style=\"LEFT: 239px; TOP: 8px; VISIBILITY: visible; BACKGROUND-COLOR: #cccccc\"&gt;&lt;SPAN class=clSub2 style=\"COLOR: white\"&gt;ISIN&lt;/SPAN&gt;&lt;/DIV&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10744218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xs2UzfCg22A/AAAAAAAAAAI/AAAAAAAAAC0/1TDe8wvZHbw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10744218/daniel"}, "edited": false, "score": 0, "creation_date": 1544611164, "post_id": 53740872, "comment_id": 94334878, "body": "Hi, thanks but still is throwing and error on &#39;if c = val then&#39; line... :( If I run it for column containing only numbers it works but problem appears when running for eg. &quot;X102&quot; or &quot;S097&quot;."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 3, "user_id": 10744218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xs2UzfCg22A/AAAAAAAAAAI/AAAAAAAAAC0/1TDe8wvZHbw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10744218/daniel"}, "edited": false, "score": 0, "creation_date": 1544611294, "post_id": 53740872, "comment_id": 94334952, "body": "What is val when it throws an error? try &quot;if c.text = val then &quot; to see if that works"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1544610196, "creation_date": 1544610196, "answer_id": 53740872, "question_id": 53740764, "link": "https://stackoverflow.com/questions/53740764/souble-loop-sheets-and-cells/53740872#53740872", "title": "Souble Loop sheets and cells", "body": "<pre><code>Sub ostdat()\nDim val As String\nDim ws As Worksheet\nDim c As Range\n\nval = InputBox(\"Enter Number\")\nFor Each ws In Worksheets\n    For Each c In ws.Range(\"d2:d20\")\n         If c = val Then\n              c.Interior.ColorIndex = 30\n         End If\n    Next c\nNext ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10744218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xs2UzfCg22A/AAAAAAAAAAI/AAAAAAAAAC0/1TDe8wvZHbw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10744218/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53740872, "answer_count": 1, "score": 0, "last_activity_date": 1580626580, "creation_date": 1544609850, "last_edit_date": 1580626580, "question_id": 53740764, "link": "https://stackoverflow.com/questions/53740764/souble-loop-sheets-and-cells", "title": "Souble Loop sheets and cells", "body": "<p>please see below code. It works well but when I am trying to add extra loop over all sheets it gives me an mismatch error 13</p>\n\n<p>This one works</p>\n\n<pre><code>Sub ostdat()\n\nDim val As String\nval = InputBox(Insert)\nFor Each cell In Range(\"d2:d20\")\nIf cell = val Then\ncell.Interior.ColorIndex = 30\nEnd If\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>But this one is not working, I have added only sheets loop</p>\n\n<pre><code>Sub ostdat()\nDim val As String\ndim ws as worksheet\nval = InputBox(Insert)\nFor Each ws In Worksheets\nws.Activate\nFor Each cell In Range(\"d2:d20\")\nIf cell = val Then\ncell.Interior.ColorIndex = 30\nEnd If\nNext cell\nNext ws\nEnd Sub\n</code></pre>\n\n<p>Basically what I am trying to do is to loop for all sheets and for all cells in column d and highlight all cells where value in cell meet the criteria from inbox (like \"X130\").</p>\n\n<p>thanks\nDan</p>\n"}, {"tags": ["excel", "vba", "compiler-errors"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1544616782, "post_id": 53740747, "comment_id": 94338114, "body": "if think you can also use &quot;UserForm1.TextBox1.BackColor = &amp;HFF00&amp;&quot; and get the color from the properties window."}], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "edited": false, "score": 0, "creation_date": 1544610377, "post_id": 53740804, "comment_id": 94334385, "body": "Right! I changed the Dim to Combobox. Sadly, the problem is stil there."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1544610488, "post_id": 53740804, "comment_id": 94334436, "body": "I think ColorIndex is the problem because this does not exist."}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544611072, "post_id": 53740804, "comment_id": 94334815, "body": "yes, you&#39;re right @storax do you know if there is another possibilty to set a color than RGB(x,x,x)?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1544611090, "post_id": 53740804, "comment_id": 94334827, "body": "D&#39;oh! Yes your right - Backcolor takes a RGB value so that line should be AMU.Textboxobject.backcolor = 8421504"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1544609984, "creation_date": 1544609984, "answer_id": 53740804, "question_id": 53740747, "link": "https://stackoverflow.com/questions/53740747/getting-compiler-error-invalid-identifier/53740804#53740804", "title": "getting compiler error (invalid identifier)", "body": "<pre><code> Dim TextBoxObject As String\n AMU.TextBoxObject.BackColor.ColorIndex = 15\n</code></pre>\n\n<p>At a guess it doesn't like you declaring a string variable as the same name as a text box</p>\n"}, {"comments": [{"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "edited": false, "score": 0, "creation_date": 1544619885, "post_id": 53741736, "comment_id": 94339861, "body": "Thank you, I solved the problem using the AMU.Controls - Collection"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 1, "last_activity_date": 1544660820, "last_edit_date": 1544660820, "creation_date": 1544612978, "answer_id": 53741736, "question_id": 53740747, "link": "https://stackoverflow.com/questions/53740747/getting-compiler-error-invalid-identifier/53741736#53741736", "title": "getting compiler error (invalid identifier)", "body": "<p>You try to assign a String to an Object</p>\n\n<pre><code>TextBoxObject = \"Textbox\" &amp; i\n</code></pre>\n\n<p>You can use the <code>AMU.Controls</code>- Collection</p>\n\n<pre><code>Set TextBoxObject = AMU.Controls(\"Textbox\" &amp; i)\n</code></pre>\n\n<p>If you don't have the reference just the Name.</p>\n\n<p>Or if there is no Collection on other Objects have a look at </p>\n\n<pre><code>CallByName(Object As Object, ProcName As String, _\n           CallType As VbCallType, Args() As Variant)`\n</code></pre>\n\n<p>`.</p>\n"}], "owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 53741736, "answer_count": 2, "score": 0, "last_activity_date": 1545041490, "creation_date": 1544609794, "last_edit_date": 1545041490, "question_id": 53740747, "link": "https://stackoverflow.com/questions/53740747/getting-compiler-error-invalid-identifier", "title": "getting compiler error (invalid identifier)", "body": "<p>As said above, in my following code I get an compiler error telling me there is an invalid identifier. I don't really see the problem, basically it is a very easy code. The problem should be in the lines using the backcolor-Function. </p>\n\n<pre><code>Sub addmaterial()\n\nDim AMU As UserForm\nSet AMU = AddMaterialUserform1\nDim SCU As ComboBox\nSet SCU = AMU.SelectComboBoxUserform\nDim APCU As ComboBox\nSet APCU = AddMaterialUserform1.AddedPropertiesComboBoxUserform\nDim TextBoxObject As Combobox\nDim i As Integer\n\n\nSCU.AddItem \"Material\"\nSCU.AddItem \"Material Group\"\n\nAPCU.BorderColor.ColorIndex = 15\n\nFor i = 1 To 12\n    TextBoxObject = \"Textbox\" &amp; i\n    AMU.TextBoxObject.BackColor.ColorIndex = 15\nNext\n\nAMU.Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10342547, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822649344437911/picture?type=large", "display_name": "Simon Rosenfeld", "link": "https://stackoverflow.com/users/10342547/simon-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1544613115, "post_id": 53741728, "comment_id": 94336000, "body": "I sadly don&#39;t know what the macro will be as this script will be used on custom files (could be missing file, out of range, any error that could arise in a VBA script)"}, {"owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "reply_to_user": {"reputation": 37, "user_id": 10342547, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822649344437911/picture?type=large", "display_name": "Simon Rosenfeld", "link": "https://stackoverflow.com/users/10342547/simon-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1544613281, "post_id": 53741728, "comment_id": 94336083, "body": "@SimonRosenfeld In that case, there is not much more you can do I&#39;m afraid. If you cannot see/edit the actual macro code, all you can do is the above so exceptions will be cought by PowerShell. Hoe exceptions are handled (or not) in the macro code is then anybody&#39;s guess."}, {"owner": {"reputation": 37, "user_id": 10342547, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822649344437911/picture?type=large", "display_name": "Simon Rosenfeld", "link": "https://stackoverflow.com/users/10342547/simon-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1544613585, "post_id": 53741728, "comment_id": 94336252, "body": "Is there any way to at least not have the script hanging? Even with a try catch I&#39;m only able to catch once the popup is clicked"}, {"owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "reply_to_user": {"reputation": 37, "user_id": 10342547, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822649344437911/picture?type=large", "display_name": "Simon Rosenfeld", "link": "https://stackoverflow.com/users/10342547/simon-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1544613843, "post_id": 53741728, "comment_id": 94336380, "body": "I don&#39;t think so.. What does the (VBA) popup say? You may be able to handle simple errors like &#39;File not found&#39; yourself before you set Excel to work, like checking in PowerShell if the given <code>$excelDataPath</code> really exists using <code>Test-Path -Path $excelDataPath -PathType Leaf</code>."}], "tags": [], "owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "is_accepted": false, "score": 0, "last_activity_date": 1544612939, "creation_date": 1544612939, "answer_id": 53741728, "question_id": 53740679, "link": "https://stackoverflow.com/questions/53740679/how-can-i-catch-an-excel-files-macro-error-in-powershell/53741728#53741728", "title": "How can I catch an Excel file&#39;s macro error in Powershell?", "body": "<p>I think from the PowerShell point of view, this will catch and display the exception that has occurred:</p>\n\n<pre><code>try {\n    $Excel = New-Object -ComObject \"Excel.Application\"\n    $Excel.DisplayAlerts = $false\n    $Excel.AskToUpdateLinks = $false\n    $Excel.Visible = $true\n\n    $Workbook = $Excel.Workbooks.Open($excelDataPath)\n    $Excel.Run(\"Macro1\")\n    $Workbook.Save()\n    $Workbook.Close($true)\n    $Excel.Close()\n}\ncatch {\n    $exception = $_.Exception\n    while ($exception.InnerException) {\n        $exception = $exception.InnerException\n    }\n    # Throw a terminating error. \n    throw $exception\n}\nfinally {\n    # IMPORTANT! Always release the comobjects used from memory when done\n    if ($Workbook) { [System.Runtime.Interopservices.Marshal]::ReleaseComObject($Workbook) | Out-Null }\n    if ($Excel)    { [System.Runtime.Interopservices.Marshal]::ReleaseComObject($Excel) | Out-Null }\n    [System.GC]::Collect()\n    [System.GC]::WaitForPendingFinalizers()\n}\n</code></pre>\n\n<p>However, as for the VBA macro code you did not show us, you will have to check to see what it does wit any errors via <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/on-error-statement\" rel=\"nofollow noreferrer\">VBA On Error Statement</a>. Especially the <code>Err.Raise</code> and <code>Throw</code> statements.</p>\n"}], "owner": {"reputation": 37, "user_id": 10342547, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822649344437911/picture?type=large", "display_name": "Simon Rosenfeld", "link": "https://stackoverflow.com/users/10342547/simon-rosenfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 720, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1544612939, "creation_date": 1544609530, "question_id": 53740679, "link": "https://stackoverflow.com/questions/53740679/how-can-i-catch-an-excel-files-macro-error-in-powershell", "title": "How can I catch an Excel file&#39;s macro error in Powershell?", "body": "<p>I have a scheduled PowerShell script that opens Excel, opens a file and runs a macro.\nIf an error arises, I need to display it in the shell and interrupt the script. (I can not afford the script to hang while waiting for user input)</p>\n\n<p>Here is my current script ($excelDataPath is defined earlier in the script)</p>\n\n<pre><code>$Excel = New-Object -ComObject \"Excel.Application\"\n$Excel.DisplayAlerts = $false\n$Excel.AskToUpdateLinks = $false\n$Excel.Visible = $true\n\n$Workbook = $Excel.Workbooks.Open($excelDataPath)\n$Excel.Run(\"Macro1\")\n$Workbook.Save()\n$Workbook.Close($true)\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1544609178, "post_id": 53740006, "comment_id": 94333640, "body": "Welcome to SO. You are kind of close, but honestly, in VBA there are different ways of doing stuff. About your question, I think it would be better if you loop trough all the usedcells, checking A and N, and deleting (or not) the row."}, {"owner": {"reputation": 1, "user_id": 10780055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e038aa70d3dc1d200b75a3c549f942?s=128&d=identicon&r=PG&f=1", "display_name": "KarinFromSweden", "link": "https://stackoverflow.com/users/10780055/karinfromsweden"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1544609579, "post_id": 53740006, "comment_id": 94333888, "body": "Thanks foxfire. Cant delete the whole row. The data needs to be stored, but GDPR means personal info needs to be deleted once the information is no longer important. So I cant remove the whole row.  But - if I get a code to loop to check A and N, cant I instead of creating a delete-commando use my offset-commando?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1544609753, "post_id": 53740006, "comment_id": 94333981, "body": "My bad. In your question you typed <b>...clear data in column G-I...</b>. It would be the same but just clearing contents of range <code>Gx:Ix</code> where <code>x</code> would be the row number being checked in the loop."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10780055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e038aa70d3dc1d200b75a3c549f942?s=128&d=identicon&r=PG&f=1", "display_name": "KarinFromSweden", "link": "https://stackoverflow.com/users/10780055/karinfromsweden"}, "is_accepted": false, "score": 0, "last_activity_date": 1544703138, "creation_date": 1544703138, "answer_id": 53761596, "question_id": 53740006, "link": "https://stackoverflow.com/questions/53740006/excel-macro-to-clear-cells-after-4-months-and-when-another-cell-is-filled-in/53761596#53761596", "title": "Excel Macro to clear cells after 4 months AND when another cell is filled in", "body": "<p>Finally got a solution:</p>\n\n<pre><code>Sub ClearCells()\n  Dim Cel As Range, Ws As Worksheet\n   Set Ws = Sheets(\"NameOfSheet\")\n     For Each Cel In Ws.Range(\"A6\", Ws.Range(\"A\" &amp; Rows.Count).End(xlUp))\n     If DateDiff(\"d\", Cel, Date) &gt; 120 And Cel.Offset(, 13) &lt;&gt; \"\" Then \n     Cel.Offset(, 6).Resize(, 3).ClearContents\n    Next Cel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10780055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e038aa70d3dc1d200b75a3c549f942?s=128&d=identicon&r=PG&f=1", "display_name": "KarinFromSweden", "link": "https://stackoverflow.com/users/10780055/karinfromsweden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544703138, "creation_date": 1544607358, "last_edit_date": 1544613346, "question_id": 53740006, "link": "https://stackoverflow.com/questions/53740006/excel-macro-to-clear-cells-after-4-months-and-when-another-cell-is-filled-in", "title": "Excel Macro to clear cells after 4 months AND when another cell is filled in", "body": "<p>I'm working with a list where I need to automatically clear data in column G-I if two criteria are true:</p>\n\n<ol>\n<li>If column N has a value</li>\n</ol>\n\n<p>AND</p>\n\n<ol start=\"2\">\n<li>If column A is older than 4 months</li>\n</ol>\n\n<p>I've been googling and reading up, and found something that I think might be on the right track, using the <code>If DateDiff</code> code, but I have no idea how to adjust the code to be matching per row and also take into account that column N needs to be filled in.</p>\n\n<pre><code>Sub Workbook_Open()\n If Not Intersect(Target, Range(\"N6:N2000\")) Is Nothing Then\n\n  If DateDiff(\"d\", FileDateTime(ThisWorkbook.FullName), Now) &gt;= 120 Then\n  ' this above needs to only check on cell at the time in A??? \n\n        Target.Offset(0, -5).ClearContents\n        Target.Offset(0, -6).ClearContents\n        Target.Offset(0, -7).ClearContents\n\n    ThisWorkbook.Save\n  End If\n End If\nEnd Sub\n</code></pre>\n\n<p>Am I getting close?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1544607599, "post_id": 53739815, "comment_id": 94332714, "body": "Just to check, these are ActiveX command buttons, as opposed to a Form Control button? With a Form Control button, you could use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.caller\" rel=\"nofollow noreferrer\"><code>Application.Caller</code></a>. More complex with ActiveX, but doable."}], "answers": [{"tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1544607592, "creation_date": 1544607592, "answer_id": 53740078, "question_id": 53739815, "link": "https://stackoverflow.com/questions/53739815/trigger-same-macro-with-different-command-button-with-button-properties/53740078#53740078", "title": "Trigger same macro with different command button with Button properties", "body": "<p>You can create many commandbuttons as ActiveX controller, then write VBA like below:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Call GetFile(\"Account1\")\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    Call GetFile(\"Account2\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1544610561, "last_edit_date": 1544610561, "creation_date": 1544608725, "answer_id": 53740403, "question_id": 53739815, "link": "https://stackoverflow.com/questions/53739815/trigger-same-macro-with-different-command-button-with-button-properties/53740403#53740403", "title": "Trigger same macro with different command button with Button properties", "body": "<h2>Form Controls</h2>\n\n<p>In a normal module add a procedure with no arguments:  </p>\n\n<pre><code>Public Sub Button_Click()\n    GetFile Application.Caller\nEnd Sub  \n</code></pre>\n\n<p>This code will pick up the button name and pass it to the <code>GetFile</code> procedure.  </p>\n\n<pre><code>Sub GetFile(Account As String)\n    MsgBox \"Account Name is \" &amp; Account\nEnd Sub  \n</code></pre>\n\n<p>So now all you need to do is name your buttons <em>Account1</em>, <em>Account2</em>, etc..    </p>\n\n<hr>\n\n<h2>ActiveX Controls</h2>\n\n<p>If you're using ActiveX controls you can use a class to capture the click event.  </p>\n\n<p>Create a class module and name it <code>clsButtonClick</code>.<br>\nAdd this code to the class module:  </p>\n\n<pre><code>Public WithEvents AccountBtn As MSForms.CommandButton\n\nPrivate Sub AccountBtn_Click()\n    MsgBox AccountBtn.Name &amp; \" on \" &amp; AccountBtn.Parent.Name\n    GetFile AccountBtn.Name\nEnd Sub\n</code></pre>\n\n<p>At the very top of a normal module add this line:  </p>\n\n<pre><code>Public colBtns As New Collection  \n</code></pre>\n\n<p>And add this code to the module:  </p>\n\n<pre><code>Public Sub Initialize_Buttons()\n\n    Dim wrkSht As Worksheet\n    Dim btnEvnt As clsButtonClick\n    Dim obj As OLEObject\n\n    For Each wrkSht In ThisWorkbook.Worksheets\n        For Each obj In wrkSht.OLEObjects\n            If TypeName(obj.Object) = \"CommandButton\" Then\n                Set btnEvnt = New clsButtonClick\n                Set btnEvnt.AccountBtn = obj.Object\n                colBtns.Add btnEvnt\n            End If\n        Next obj\n    Next wrkSht\n\nEnd Sub  \n</code></pre>\n\n<p>This will go through each sheet in your workbook and give any ActiveX command buttons the click event from the class module.<br>\nUpdate the <code>Initialize_Buttons</code> procedure if you need to limit it to a specific sheet, or specific buttons on a sheet.  </p>\n\n<p>Finally call the <code>Initialize_Buttons</code> code in the <code>Workbook_Open</code> event in the <code>ThisWorkbook</code> module.</p>\n"}], "owner": {"reputation": 140, "user_id": 4795359, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153158823210791/picture?type=large", "display_name": "Osman Wong", "link": "https://stackoverflow.com/users/4795359/osman-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 1, "accepted_answer_id": 53740403, "answer_count": 2, "score": 0, "last_activity_date": 1580911643, "creation_date": 1544606748, "last_edit_date": 1580911643, "question_id": 53739815, "link": "https://stackoverflow.com/questions/53739815/trigger-same-macro-with-different-command-button-with-button-properties", "title": "Trigger same macro with different command button with Button properties", "body": "<p>As the subject suggest, I have build a macro that will need a variable input</p>\n\n<pre><code>Sub GetFile(Account as String)\n</code></pre>\n\n<p>Currently i am setting multiple sub to call the script and assign them to different command buttons</p>\n\n<pre><code>Sub AC1_File\n    Call GetFile(\"Account1\")\nend sub\n\nSub AC2_File\n    Call GetFile(\"Account2\")\nend sub\n</code></pre>\n\n<p>And the list go on</p>\n\n<p>I am trying to not make my code too long (as i got double digits accounts),\nis it possible for me code to get properties of the commandbutton name and use it instead of Account1,2,3...?</p>\n\n<p>Something like below?</p>\n\n<pre><code>Call GetFile(triggering-commandbutton.name)\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 2, "creation_date": 1544606529, "post_id": 53739452, "comment_id": 94332017, "body": "Select Case c.value:Case &quot;A&quot;,&quot;B&quot;,&quot;C&quot;:Case Else:dic(c.value) = c.value:End Select"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10755675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c76073878c7b3ffebde4a1ab964cb4?s=128&d=identicon&r=PG&f=1", "display_name": "RmRekoj", "link": "https://stackoverflow.com/users/10755675/rmrekoj"}, "edited": false, "score": 1, "creation_date": 1544609862, "post_id": 53740408, "comment_id": 94334034, "body": "Thanks, no an issue I can use this too, but I was thinking there can be use array too , and since hours I was searching on google but not found any solution.. thanks"}], "tags": [], "owner": {"reputation": 166, "user_id": 7745179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e144a6b6feef74440d16582cd37a6891?s=128&d=identicon&r=PG&f=1", "display_name": "user123", "link": "https://stackoverflow.com/users/7745179/user123"}, "is_accepted": false, "score": 0, "last_activity_date": 1544608737, "creation_date": 1544608737, "answer_id": 53740408, "question_id": 53739452, "link": "https://stackoverflow.com/questions/53739452/how-to-use-array-instead-of-using-and-in-if/53740408#53740408", "title": "how to use array instead of using And in if", "body": "<p>Your question needs more context which makes it difficult to provide a good answer. All I can think of is:</p>\n\n<ul>\n<li><p>You can do it also with a <code>Switch</code> but you are still applying the same logic than in an <code>if</code>.</p></li>\n<li><p>You could apply a <code>filter</code> to your range so that doesn't have nor A, B, C and you would avoid the <code>If</code> inside the loop.</p></li>\n<li><p>If you want to make it \"shorter\" but less readable (for the reason which I don't suggest this) you could convert your c in ASCII and then knowing that A-C are contiguous you can just see if the value is not between those that correspond to A-C. If you had more cases (and are still contiguous letters) can be decent I guess.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 894, "user_id": 10644878, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "D&#225;vid Laczk&#243;", "link": "https://stackoverflow.com/users/10644878/d%c3%a1vid-laczk%c3%b3"}, "is_accepted": false, "score": 0, "last_activity_date": 1544868541, "last_edit_date": 1544868541, "creation_date": 1544621211, "answer_id": 53744102, "question_id": 53739452, "link": "https://stackoverflow.com/questions/53739452/how-to-use-array-instead-of-using-and-in-if/53744102#53744102", "title": "how to use array instead of using And in if", "body": "<p>Of course you can, but might not be more cleaner/easier: if <code>array</code>'s elements are A, B &amp; C, then you can use a similar code to this pseudo-code:<br>\n</p>\n\n<pre><code>For Each c In rng\n    For each element in array\n        If c.value &lt;&gt; array(element) Then count = count + 1 'how many times it is true\n        End If\n    Next element\n    If count = NumberOfElementsOf(array) Then do your stuff with c\nNext c\n</code></pre>\n\n<p>But if you had a lot of criteria it might be better. Of course it can be optimized e.g. if you check the opposite criteria and if that's true exit the loop - you can discover different opportunities.</p>\n"}], "owner": {"reputation": 11, "user_id": 10755675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c76073878c7b3ffebde4a1ab964cb4?s=128&d=identicon&r=PG&f=1", "display_name": "RmRekoj", "link": "https://stackoverflow.com/users/10755675/rmrekoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544868541, "creation_date": 1544605653, "last_edit_date": 1544620691, "question_id": 53739452, "link": "https://stackoverflow.com/questions/53739452/how-to-use-array-instead-of-using-and-in-if", "title": "how to use array instead of using And in if", "body": "<p>Is there any option to use and criteria in array because I have 4-5 criteria.\nSo is any option there or have to do same like below?</p>\n\n<pre><code>For Each c In rng\nIf c.Value &lt;&gt; \"A\" And c.Value &lt;&gt; \"B\" And c.Value &lt;&gt; \"C\" Then\n dic(c.Value) = c.Value\nEnd If\nNext c\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2104, "user_id": 949044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84ec01bed6dea2f97aad7cc5d4e495c?s=128&d=identicon&r=PG", "display_name": "Lyth", "link": "https://stackoverflow.com/users/949044/lyth"}, "edited": false, "score": 1, "creation_date": 1544606012, "post_id": 53739434, "comment_id": 94331685, "body": "Please add the code to the question itself instead of linking to a picture, that would make easier to answer. Of course you should redact out sensitive information, and even better if you could reproduce the same problem without relying on it."}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "reply_to_user": {"reputation": 2104, "user_id": 949044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84ec01bed6dea2f97aad7cc5d4e495c?s=128&d=identicon&r=PG", "display_name": "Lyth", "link": "https://stackoverflow.com/users/949044/lyth"}, "edited": false, "score": 0, "creation_date": 1544606101, "post_id": 53739434, "comment_id": 94331740, "body": "Aplogies Lyth here &#39;s the code."}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "reply_to_user": {"reputation": 2104, "user_id": 949044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84ec01bed6dea2f97aad7cc5d4e495c?s=128&d=identicon&r=PG", "display_name": "Lyth", "link": "https://stackoverflow.com/users/949044/lyth"}, "edited": false, "score": 0, "creation_date": 1544606350, "post_id": 53739434, "comment_id": 94331896, "body": "Post has been edited thanks :)"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544606458, "post_id": 53739434, "comment_id": 94331962, "body": "Which transaction do you use? What do you mean by &quot;extract a file&quot;? Do you download an excel file and do you get a file dialog &quot;Save as&quot;?"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1544606794, "post_id": 53739434, "comment_id": 94332205, "body": "i want to full a data from SAP .. extraction of data"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1544606944, "post_id": 53739434, "comment_id": 94332298, "body": "Yes the Script is stop to the file dialog to click the Save button."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544606948, "post_id": 53739434, "comment_id": 94332302, "body": "Sorry, this is not helpful. Could you please have look at my questions otherwise <a href=\"https://archive.sap.com/discussions/thread/1487670\" rel=\"nofollow noreferrer\">this</a> might help"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1544606962, "post_id": 53739434, "comment_id": 94332313, "body": "session.findById(&quot;wnd[0]/mbar/menu[0]/menu[3]/menu[1]&quot;).Sele&zwnj;&#8203;ct session.findById(&quot;wnd[1]/tbar[0]/btn[0]&quot;).Press"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544607101, "post_id": 53739434, "comment_id": 94332402, "body": "session.findById(&quot;wnd[0]&quot;).sendVKey 8  -- this is the enter button? @Storax"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544607213, "post_id": 53739434, "comment_id": 94332482, "body": "What SapGui version do you have? If it&#39;s 7.40 or less you probabyl need to use Win API functions. You can&#39;t control it via SapGui Scripting"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544607370, "post_id": 53739434, "comment_id": 94332581, "body": "its 7.20 sir @Storax"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544607532, "post_id": 53739434, "comment_id": 94332673, "body": "Then you are probably out of luck. Have a look <a href=\"https://blogs.sap.com/2014/03/26/new-scripting-option-in-sap-gui-for-windows-730-pl-8/\" rel=\"nofollow noreferrer\">here</a>. You need to use API functions to control the windows dialog like I said in my earlier comment. But as you do not tell which transaction you use it&#39;s kind of guessing."}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1544607757, "post_id": 53739434, "comment_id": 94332815, "body": "even the file dialog is inside the SAP not in windows?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544608313, "post_id": 53739434, "comment_id": 94333118, "body": "I think it is a windows dialog called from sapgui. And you can&#39;t control it via Sapgui scripting, see also SAP note 1974590 (you need a SAP oss user to access it). Again, as you do not tell which transaction you use it&#39;s difficult to help. Sorry but should be a little bit more talkative"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1544610318, "post_id": 53739434, "comment_id": 94334344, "body": "im sorry im new from SAP so i do not know the transaction , only to record the SAP and transfer the vbscript to excel."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544610933, "post_id": 53739434, "comment_id": 94334724, "body": "I am afraid but if you are not even able to find out the transaction you are using then it does not really make sense trying to help you. This is spoon feeding then. Sorry!!"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544613415, "post_id": 53739434, "comment_id": 94336151, "body": "@Storax thanks for your advise appreciated :)"}, {"owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "edited": false, "score": 0, "creation_date": 1544613487, "post_id": 53739434, "comment_id": 94336196, "body": "what i only need to know is the enter key inside the SAP."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544618699, "post_id": 53739434, "comment_id": 94339174, "body": "This will not really help you but anyway you send Enter with <i>session.findById(&quot;wnd[0]&quot;).sendVKey 0</i>"}], "owner": {"reputation": 13, "user_id": 10663013, "user_type": "registered", "profile_image": "https://graph.facebook.com/1929159693841905/picture?type=large", "display_name": "His Lombres", "link": "https://stackoverflow.com/users/10663013/his-lombres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580626602, "creation_date": 1544605602, "last_edit_date": 1580626602, "question_id": 53739434, "link": "https://stackoverflow.com/questions/53739434/calling-enter-key-inside-the-sap", "title": "Calling enter key inside the SAP", "body": "<p>I create a macro to extract a file from SAP and i try to record step by step before copying the script from visual basic in Excel the code is working fine but in the last row of code the script is stop to click the save button. but my record is full until to save the button. seeking for help to SAP and VBA Click the Save button or call enter function in SAP to VBA Below is my code.</p>\n\n<pre><code>session.findById(\"wnd[0]\").Maximize\nsession.findById(\"wnd[0]/usr/cntlIMAGE_CONTAINER/shellcont/shell/shellcont[0]/shell\").DoubleClickNode \"F00007\"\nsession.findById(\"wnd[0]/usr/subSUBSCR:ZFIR093:0100/ctxtS_SYDAT\").Text = \"12/31/2018\"\nsession.findById(\"wnd[0]/usr/subSUBSCR:ZFIR093:0100/ctxtS_BUKRS\").Text = caompnay code\nsession.findById(\"wnd[0]/usr/subSUBSCR:ZFIR093:0100/ctxtS_HKONT-LOW\").Text = code\nsession.findById(\"wnd[0]/usr/subSUBSCR:ZFIR093:0100/ctxtS_POSTD\").Text = \"12/31/2018\"\nsession.findById(\"wnd[0]/usr/subSUBSCR:ZFIR093:0100/ctxtS_POSTD\").SetFocus\nsession.findById(\"wnd[0]/usr/subSUBSCR:ZFIR093:0100/ctxtS_POSTD\").caretPosition = 10\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").Press\nsession.findById(\"wnd[0]/tbar[1]/btn[8]\").Press\nsession.findById(\"wnd[0]/mbar/menu[0]/menu[3]/menu[1]\").Select\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").Press\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "multidimensional-array"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1544603003, "post_id": 53738803, "comment_id": 94330104, "body": "You can only <code>ReDim Preserve</code> the last dimension. You would be much better off getting the dimensions first."}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1544604185, "post_id": 53738803, "comment_id": 94330670, "body": "Hi, thanks for the reply. I have always done it in this order, is there a better one? can you give me a brief example how this would look like?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "edited": false, "score": 0, "creation_date": 1544606039, "post_id": 53738803, "comment_id": 94331696, "body": "Your array can be up to arr(0 to 32766, 0 to 32766). Anything larger in either dimension and you have to build your own transpose function. (zero to 32,766 is a total of 32,767 array elements in one rank)"}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544606575, "post_id": 53738803, "comment_id": 94332049, "body": "Did i mix up the solution of you (@user10779473 and @K.D\u1d00\u1d20\u026as) by exident? :o"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1544606991, "post_id": 53738803, "comment_id": 94332331, "body": "@G.M You get error(9) due to you try to change the size of the first dimension."}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544611975, "post_id": 53738803, "comment_id": 94335362, "body": "It works, mostly ^^"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544605234, "post_id": 53739182, "comment_id": 94331217, "body": "Hey there, thanks alot, especially the second part seems intresting (and clever) to me so I first make the array static (and big) and just shortening it at the end. so its not really &quot;fluid array but at the ned hast the minimal size. Sounds great and way faster then what I did. Is there a regular size you choose as a size?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "reply_to_user": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544605511, "post_id": 53739182, "comment_id": 94331376, "body": "That would depend on what is populating the array. You haven&#39;t provided enough information to hazard a guess at any initial size."}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544605927, "post_id": 53739182, "comment_id": 94331623, "body": "As an educated gues I would say about onethousand is fine, but maybe it makes sense to choose the next bigger datatype size (like 32.767 for integer or something like that) but its not necessary of course ^^"}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544607873, "post_id": 53739182, "comment_id": 94332878, "body": "Thanks alot it seems to work fine.(at least no error). :D  There isnt any quick way to show the whole array to see if it works is there?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "reply_to_user": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1544608143, "post_id": 53739182, "comment_id": 94333032, "body": "You can dump the 2-D array back onto the worksheet like <code>cells(1, &quot;A&quot;).resize(ubound(arr, 1), ubound(arr, 2)) = arr</code> or look at the VBE&#39;s Locals window when you step through your code with F8."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "is_accepted": true, "score": 1, "last_activity_date": 1544606724, "last_edit_date": 1544606724, "creation_date": 1544604627, "answer_id": 53739182, "question_id": 53738803, "link": "https://stackoverflow.com/questions/53738803/multidimensional-array-redim/53739182#53739182", "title": "Multidimensional Array redim", "body": "<p>You can ReDim either or both ranks of an array at any time but if you use the <em>Preserve</em> argument (which retains values previously set), you can only change the last rank (second dimension).</p>\n\n<p>However you can Transpose\u00b9 the array to flip the ranks of a 2-D array, modify the new last rank, then Transpose to return the 2-D array to its original form. This will either expand or truncate the 'rows' (first rank) of a 2-D array.</p>\n\n<pre><code>MultiArrPaerchen(m, n) = VarBasisZeile \nm = m + 1 \napplication.transpose(MultiArrPaerchen)\nReDim Preserve MultiArrPaerchen(0 To n, 0 To m)\napplication.transpose(MultiArrPaerchen)\n</code></pre>\n\n<p>This takes time and calculation, especially if performed repetitively in a large loop. As mentioned in comments (thanks <a href=\"https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas\">K.D\u1d00\u1d20\u026as</a>), it is significantly better to predict your upper boundaries (UBound) of each rank first or make the initial limits sufficiently large enough to handle any circumstances and reduce the array with a single transpose/redim/transpose after the loop is complete.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/53738803/multidimensional-array-redim/53739182#53739182\">Addendum</a></p>\n\n<p>This would fix your recent addition to your question.</p>\n\n<pre><code>dim m as long, n as long\nReDim MultiArrPaerchen(0 To 1000, 0 To 1000)\nm = 0\nn = 0\n\nfor each something in something else\n    if some condition then \n        MultiArrPaerchen(m, n) = something\n        m = m + 1\n        n = n + 1\n    end if\nnext something\n\n'm is now 199, n is now 255\n\nReDim Preserve MultiArrPaerchen(lbound(MultiArrPaerchen, 1) To ubound(MultiArrPaerchen, 1), lbound(MultiArrPaerchen, 2) To n)\nApplication.Transpose (MultiArrPaerchen)\nReDim Preserve MultiArrPaerchen(lbound(MultiArrPaerchen, 1) To ubound(MultiArrPaerchen, 1), lbound(MultiArrPaerchen, 2) To m)\nApplication.Transpose (MultiArrPaerchen)\n\ndebug.print lbound(MultiArrPaerchen, 1) &amp; \":\" &amp; ubound(MultiArrPaerchen, 1)\ndebug.print lbound(MultiArrPaerchen, 2)&amp; \":\" &amp; ubound(MultiArrPaerchen, 2)\n\n'result in Immediate window\n0:199\n0:255\n</code></pre>\n\n<hr>\n\n<p>\u00b9 <sub>Transpose has an upper limit of a signed short integer; 1.e. 32,767. If you require larger transpositions, you'll have to write your own or get one from several examples on this site.</sub></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "edited": false, "score": 0, "creation_date": 1544604743, "post_id": 53739193, "comment_id": 94330955, "body": "Did you try this? It doesn&#39;t look like it would work."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1544606632, "last_edit_date": 1544606632, "creation_date": 1544604657, "answer_id": 53739193, "question_id": 53738803, "link": "https://stackoverflow.com/questions/53738803/multidimensional-array-redim/53739193#53739193", "title": "Multidimensional Array redim", "body": "<p>In VBA, you can only change the size of the last dimension in the array.</p>\n\n<p>Since your <code>MultiArrPaerchen(m, n)</code> is a two-dimension array, the size of <code>m</code> cannot be changed.</p>\n\n<p>Use <code>transpose</code> function to move your first dimension to second, then <code>redim</code> to change the size.</p>\n\n<pre><code>dim MultiArrPaerchen as variant\n\nMultiArrPaerchen = Application.Transpose(VarBasisZeile) \nReDim Preserve MultiArrPaerchen(lbound(MultiArrPaerchen, 1) to ubound(MultiArrPaerchen, 1), lbound(MultiArrPaerchen,2) to ubound(MultiArrPaerchen, 2) + 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1544605425, "last_edit_date": 1544605425, "creation_date": 1544605089, "answer_id": 53739313, "question_id": 53738803, "link": "https://stackoverflow.com/questions/53738803/multidimensional-array-redim/53739313#53739313", "title": "Multidimensional Array redim", "body": "<p>You can grab the dimensions of your array <em>upfront</em>. </p>\n\n<p>So, count the number of times that the dupe in the rows occur, then set the dimensions. </p>\n\n<p>Since it's unclear how you're using your multidimensional array, here's how you can get set the dimensions on a 1-D array before you ever assign a value to it (hence, no need to use <code>Preserve</code> at all) using the worksheet function: <code>COUNTIF()</code>:</p>\n\n<pre><code>Dim dupeCount As Long\ndupeCount = WorksheetFunction.CountIf([D:D], [E1])\nReDim MultiArrPaerchen(dupeCount - 1)\n</code></pre>\n\n<p>You can then proceed using the same method to get your upper-boundary of the second dimension - but I am not sure of your criteria for that so I cannot provide an example.</p>\n"}], "owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 53739182, "answer_count": 3, "score": 0, "last_activity_date": 1580910231, "creation_date": 1544602940, "last_edit_date": 1580910231, "question_id": 53738803, "link": "https://stackoverflow.com/questions/53738803/multidimensional-array-redim", "title": "Multidimensional Array redim", "body": "<p>Once again I need some help :)</p>\n\n<p>I have a List of values And for each line it should check if there is another row where the values of column D and E are identical to the current row.\nSo all values where Column D and E are identical need to be grouped together.</p>\n\n<p>His part seems to be working fine but I wanted to store the Pairs/groups in a multidimensional Array, and thats where it gets tricky.</p>\n\n<pre><code>MultiArrPaerchen(m, n) = VarBasisZeile \nm = m + 1 \nReDim Preserve MultiArrPaerchen(0 To m, 0 To n)\n</code></pre>\n\n<p>This should be the important part of the code. A new value should be added and then the array is enlarged and redim'ed. The error itself occurs in the last line.\nAny ideas? its the first time I use multidimensional arrays, so its quiet possible that I made a mistake here.</p>\n\n<p>Thanks alot in advance.</p>\n\n<hr>\n\n<p>Just to make sure I got right what @user10779473 said:</p>\n\n<pre><code>ReDim MultiArrPaerchen(0 To 1000, 0 To 1000)\n\n'The arrays gets filled and with every new value m or n increases when necessary\n\nReDim Preserve MultiArrPaerchen(0 To m, 0 To n)\nApplication.Transpose (MultiArrPaerchen)\nReDim Preserve MultiArrPaerchen(0 To n, 0 To m)\nApplication.Transpose (MultiArrPaerchen)\n\nEnd Sub\n</code></pre>\n\n<p>In the end my Array has exactly the size I need it to be. Only problem my arraysize cant get above 1000? </p>\n\n<hr>\n\n<p>After trying the above version I still get the same error (9) on the first </p>\n\n<pre><code>ReDim Preserve MultiArrPaerchen(0 To m, 0 To n)\n</code></pre>\n\n<p>line. At this point m is 120 and n is 18 so regular, fitting numbers i would assume.</p>\n\n<p>Thanks alot so far, its great new knowledge for me :)</p>\n\n<hr>\n\n<p>It works :D or at least half of it ^^\nMaybe a mistake with the transponse?</p>\n\n<p>This is the current code:</p>\n\n<pre><code>ReDim Preserve MultiArrPaerchen(LBound(MultiArrPaerchen, 1) To UBound(MultiArrPaerchen, 1), LBound(MultiArrPaerchen, 2) To n)\nApplication.Transpose (MultiArrPaerchen)\nReDim Preserve MultiArrPaerchen(LBound(MultiArrPaerchen, 1) To UBound(MultiArrPaerchen, 1), LBound(MultiArrPaerchen, 2) To m)\nApplication.Transpose (MultiArrPaerchen)\n</code></pre>\n\n<p>And the VBA Local window shows Variant (0 to 1000 and 0 to 120).\n120 is the fitting value, the oher one should be 18 but seemingly the m value doesnt get shortend.</p>\n\n<p>Something i noticed while F8 ing through the code is that it is first Variant (0 to 1000 and 0 to 18) and then (0 to 1000 and 0 to 120). So the issue really seems to be the transpose in between.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1544602386, "post_id": 53738626, "comment_id": 94329825, "body": "SQL Server doesn&#39;t execute the files or their macros. Import means simply import the data, eg using SSIS or the <code>Import Data</code> task in SSMS which effectively generates an SSIS package"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544602608, "post_id": 53738626, "comment_id": 94329916, "body": "Copy / Paste.Special Values, then treat as data..."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544602676, "post_id": 53738626, "comment_id": 94329948, "body": "BTW Excel sheets have no relations. VLOOKUP is just a function. <code>xlsx</code> is a zip package containing XML files. You don&#39;t need Excel itself to read it. You can read it directly, throug the OpenXML SDK or use a library like Epplus. In a web application you can read the uploaded files in your code, retrieve the data and insert it into a database using eg EF, ADO.NET or SqlBulkCopy"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544602703, "post_id": 53738626, "comment_id": 94329955, "body": "@SolarMike how do you do that in a web application? Why would you do that in SSMS when Import is already available?"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544602772, "post_id": 53738626, "comment_id": 94329990, "body": "SQL Server isn&#39;t more compatible with any data file. Its <code>Import Data</code> wizard and the SSIS packages it generates can read from any available source, from CSV files to other databases to Hadoop."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544604260, "post_id": 53738626, "comment_id": 94330711, "body": "@PanagiotisKanavos probably because the source is the excel files... as per the OP&#39;s post, first line..."}, {"owner": {"reputation": 57, "user_id": 10455425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b0L3KyzknnU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX9oBXoUNlhJUtRsxi7QREKudVsaA/mo/photo.jpg?sz=128", "display_name": "alireza azadi", "link": "https://stackoverflow.com/users/10455425/alireza-azadi"}, "edited": false, "score": 0, "creation_date": 1544605412, "post_id": 53738626, "comment_id": 94331327, "body": "@SloarMike :  This web app is based on the good materials and prices. It first goal is to calculate the price of the product. each table and excel file has some fields with their prices. I want to make this as a web app. Count of records are growing up and excel become unusable."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544605578, "post_id": 53738626, "comment_id": 94331399, "body": "@SolarMike that doesn&#39;t mean the <i>application</i> is open, or that it can be opened at all on the web server. Even on the desktop why open Excel just to paste the data into SSMS when you can import them faster than you can open Excel itself? Copy/paste doesn&#39;t give you any control of the types and forces conversions to text which can cause serious problems with dates and numbers"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544605704, "post_id": 53738626, "comment_id": 94331476, "body": "@PanagiotisKanavos Copy paste special values does not always force text..."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544605775, "post_id": 53738626, "comment_id": 94331525, "body": "@alirezaazadi then when you tag excel, you should expect comments / answers relevant to excel, if you don&#39;t want excel don&#39;t use the tag..."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544606158, "post_id": 53738626, "comment_id": 94331789, "body": "@SolarMike it&#39;s never, ever used for importing data. <code>not always</code> is unacceptable in any kind of production environment and all but the most simplistic development and testing environments. <i>Especially</i> when different decimal points and date formats are involved."}, {"owner": {"reputation": 57, "user_id": 10455425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b0L3KyzknnU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX9oBXoUNlhJUtRsxi7QREKudVsaA/mo/photo.jpg?sz=128", "display_name": "alireza azadi", "link": "https://stackoverflow.com/users/10455425/alireza-azadi"}, "edited": false, "score": 0, "creation_date": 1544607141, "post_id": 53738626, "comment_id": 94332426, "body": "So you guys telling me there is no way to import excel file with vlookup relations into sql server, right? And is there any way to create and generate a diagram from Excel file with vlookup relations? I googled and found power pivot, But seems does not work for Vlookup relationship."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544607958, "post_id": 53738626, "comment_id": 94332927, "body": "@PanagiotisKanavos I used to use SAS to analyse data (one data file of 10megs to produce 180,000 result files to be charted), so avoided any excel issues..."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544608368, "post_id": 53738626, "comment_id": 94333147, "body": "@alirezaazadi no, I&#39;m saying that there are no relations to begin with. VLOOKUP is just a function, it doesn&#39;t specify any kind of relation. <i>Real</i> relations exist in the Power pivot data model. You can convert that model to an SSAS Tabular cube directly using the <a href=\"https://docs.microsoft.com/en-us/sql/ssdt/download-sql-server-data-tools-ssdt?view=sql-server-2017\" rel=\"nofollow noreferrer\">SQL Server Data Tools</a>. SSAS Tabular uses the same engine as PowerPivot."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544608621, "post_id": 53738626, "comment_id": 94333300, "body": "@SolarMike that&#39;s because SAS is the <i>processing</i> software. Not the ETL product. 180K rows is a very small amount of data anyway - even Excel can store 1M rows and handle far more data through PowerPivot, as much as can fit in memory. If the source file locale matches your locale, you wouldn&#39;t have problems. Try importing dates from French, German and Polish sources though, in an ETL job every 15 minutes. Even small data marts have dozens of millions of rows and use many GBs of storage"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544608653, "post_id": 53738626, "comment_id": 94333324, "body": "@SolarMike SAS has conversion problems too, if the wrong settings are used to load the data. SAS, R etc are good tools to <i>analyze</i> sample data and discover patterns, distributions, values that are then used to create appropriate ETL scripts or jobs"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544608747, "post_id": 53738626, "comment_id": 94333380, "body": "@PanagiotisKanavos the solution is to know what your data is and make sure you deal with it correctly... ie test and test again before you hit &quot;go&quot;... Oh and the 180,000 result files are not 1 row each..."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1544609159, "post_id": 53738626, "comment_id": 94333630, "body": "@SolarMike in the real world your data will change a <i>lot</i> after you hit <code>Go</code>, especially when it&#39;s not <i>your</i> data - it comes from other systems, other companies, or in this case, from a user uploading a file that could contain anything. In ETL jobs the data gets tested automatically in every run to detect anomalies"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1544609673, "post_id": 53738626, "comment_id": 94333930, "body": "@PanagiotisKanavos which &quot;real world&quot; ?? - the data we dealt with was sent to us each month by the company data processing unit... And they had their own quality controls..."}, {"owner": {"reputation": 57, "user_id": 10455425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b0L3KyzknnU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX9oBXoUNlhJUtRsxi7QREKudVsaA/mo/photo.jpg?sz=128", "display_name": "alireza azadi", "link": "https://stackoverflow.com/users/10455425/alireza-azadi"}, "edited": false, "score": 0, "creation_date": 1544612214, "post_id": 53738626, "comment_id": 94335487, "body": "So final solution is to convert this vlookup functions into power pivot and then import them into sql server? In this way the relations exist in the sql server? Or better way is to analysis data and import each table separately with their relations?   Which way you finally suggest?"}], "owner": {"reputation": 57, "user_id": 10455425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b0L3KyzknnU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX9oBXoUNlhJUtRsxi7QREKudVsaA/mo/photo.jpg?sz=128", "display_name": "alireza azadi", "link": "https://stackoverflow.com/users/10455425/alireza-azadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580862445, "creation_date": 1544602198, "last_edit_date": 1580862445, "question_id": 53738626, "link": "https://stackoverflow.com/questions/53738626/import-multi-excel-files-with-relationship-between-them-vlookup-into-ms-sql-s", "title": "Import multi EXCEL files with relationship between them( Vlookup ) into MS SQL Server", "body": "<p>I have multiple Excel files that have relation between them. I want to use their data and develop a Web Application. First of all I need to import them into SQL server.( I think SQL Server is more compatible with Excel files ) But some of them have lots of records and and also relationship.(vlookup) How can I import them with their relations into SQL Server? Is there any way?</p>\n\n<p>Note that I use SQL Server 2016, and excel file format is 2007-2010, But I open the excel file in Microsoft Office Excel 2016 as well.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544603937, "post_id": 53738366, "comment_id": 94330537, "body": "A few things to start with, add the <code>Microsoft Scripting Runtime</code> to your Project References (Tools--&gt;References) to be able to early-bind the FSO. Then declare all your variables properly, <code>dim file1 as String</code> and <code>dim ObjFSO as FileSystemObject</code> to get the full benefits of InteliSense. Also, can you write where the error happens and what the values of the variables are at this point? (View--&gt;Locals Window)"}, {"owner": {"reputation": 1, "user_id": 10770367, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItIoJ5PO61A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iFbrfeqKSDD98JVXb0SZoRCB0IOA/mo/photo.jpg?sz=128", "display_name": "Vaseem Syed", "link": "https://stackoverflow.com/users/10770367/vaseem-syed"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544604957, "post_id": 53738366, "comment_id": 94331065, "body": "Just to clarify It is a VBS script.  The error is file not found pointing to line (ObjFSO.MoveFile file1, file2) and Char1"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10770367, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItIoJ5PO61A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iFbrfeqKSDD98JVXb0SZoRCB0IOA/mo/photo.jpg?sz=128", "display_name": "Vaseem Syed", "link": "https://stackoverflow.com/users/10770367/vaseem-syed"}, "edited": false, "score": 0, "creation_date": 1544669021, "post_id": 53739731, "comment_id": 94361286, "body": "Hi Thanks for input.  now only first set is running ,i Dn&#39;t see the 2ed set renaming the file."}, {"owner": {"reputation": 1, "user_id": 10770367, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItIoJ5PO61A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iFbrfeqKSDD98JVXb0SZoRCB0IOA/mo/photo.jpg?sz=128", "display_name": "Vaseem Syed", "link": "https://stackoverflow.com/users/10770367/vaseem-syed"}, "edited": false, "score": 0, "creation_date": 1544778661, "post_id": 53739731, "comment_id": 94404198, "body": "No, it&#39;s just running the 1 st set and switching off"}, {"owner": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "reply_to_user": {"reputation": 1, "user_id": 10770367, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItIoJ5PO61A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iFbrfeqKSDD98JVXb0SZoRCB0IOA/mo/photo.jpg?sz=128", "display_name": "Vaseem Syed", "link": "https://stackoverflow.com/users/10770367/vaseem-syed"}, "edited": false, "score": 0, "creation_date": 1544781218, "post_id": 53739731, "comment_id": 94405706, "body": "Can you please share your final full script, combining 1st and 2nd sets?"}], "tags": [], "owner": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "is_accepted": false, "score": 0, "last_activity_date": 1544615338, "last_edit_date": 1544615338, "creation_date": 1544606530, "answer_id": 53739731, "question_id": 53738366, "link": "https://stackoverflow.com/questions/53738366/2nd-set-of-vb-script-is-running-first-than-the-first-set-of-statements/53739731#53739731", "title": "2nd set of VB script is running first than the first set of statements", "body": "<p>The shell command is running in a separate system thread, therefore VBS script will not wait when shell is finished. To solve this problem, you need to wait until the file is actually created and released by the system and only then rename it.\nAs a possible solution, you could update your 2nd script as follows:</p>\n\n<p><strong>Set2</strong></p>\n\n<pre><code>Dim ObjFSO\nSET ObjFSO = CreateObject(\"Scripting.FileSystemObject\")\nDim file1, file2\n\nfile1 = \"D:\\FullExport\\Export.tar.gz\"\nfile2 = \"D:\\FullExport\\Export\" &amp; year(date) &amp; month(date) &amp; Day(Date) &amp; \".tar.gz\"\n\nOn Error Resume Next\nDo\n    Err.Clear\n    Set oFile = ObjFSO.OpenTextFile(file1, 8, False)\n    if err.number = 0 then Exit Do\n\n    WScript.Sleep 1000\nLoop\n\nOn Error Goto 0\noFile.Close\nset oFile = Nothing\n\nObjFSO.MoveFile file1, file2\n\nSet ObjFSO = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10770367, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItIoJ5PO61A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iFbrfeqKSDD98JVXb0SZoRCB0IOA/mo/photo.jpg?sz=128", "display_name": "Vaseem Syed", "link": "https://stackoverflow.com/users/10770367/vaseem-syed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544615338, "creation_date": 1544601179, "last_edit_date": 1544602417, "question_id": 53738366, "link": "https://stackoverflow.com/questions/53738366/2nd-set-of-vb-script-is-running-first-than-the-first-set-of-statements", "title": "2nd set of VB script is running first than the first set of statements", "body": "<p>I have 2 sets of VB scripts, one is to create a file and 2nd is to rename the file.</p>\n\n<p>When I am running it, it is giving me error: 'file not found promoting error line at move command', which means it is looking for file to rename. But I want to generate a file and then rename.</p>\n\n<p>When I am running individually it's working fine. Can someone please assist to resolve the issue?</p>\n\n<p><strong>Set1:</strong></p>\n\n<pre><code>' it will create a object called Export.tar.gz  (Working fine - Due to security contrarian i have partially placed the code in set1)\n\nDim objShell\nSet objShell = WScript.CreateObject (\"WScript.shell\")\n\nobjShell.run \"cmd /C CD D:\\test\\VB practice\\Mrcctl ************************************ localfolder=D:\\FullExport\"\nSet objShell = Nothing\n</code></pre>\n\n<p><strong>Set2:</strong></p>\n\n<pre><code>Dim ObjFSO\nSET ObjFSO = CreateObject(\"Scripting.FileSystemObject\")\nDim file1, file2\n\nfile1 = \"D:\\FullExport\\Export.tar.gz\"\nfile2 = \"D:\\FullExport\\Export\" &amp; year(date) &amp; month(date) &amp; Day(Date) &amp; \".tar.gz\"\n\nObjFSO.MoveFile file1, file2\n\nSet ObjFSO = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1544600847, "post_id": 53738214, "comment_id": 94329111, "body": "If you are writing that much data to the worksheet, you should consider writing it to an array first, then writing the array to the worksheet all at once. Also, you should just go ahead and declare everything as type <code>Long</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1544601352, "post_id": 53738214, "comment_id": 94329325, "body": "For uploading to what/where?  Are you really just writing a single column of data?  That doesn&#39;t seem like it would be very useful..."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1544602527, "last_edit_date": 1544602527, "creation_date": 1544601775, "answer_id": 53738525, "question_id": 53738214, "link": "https://stackoverflow.com/questions/53738214/overflow-issue-in-excel-vba-script-large-list-creation/53738525#53738525", "title": "Overflow issue in Excel VBA script / large list creation", "body": "<p>Create an array that you can loop through, and once the loop has finished, set a range object to match the array's dimensions and proceed to write the array to the worksheet.</p>\n\n<p><em>Untested:</em></p>\n\n<pre><code>Dim DEPTH As Long, MIN_D As Long, MAX_D As Long, STEP_D As Long\nDim WIDTH As Long, MIN_W As Long, MAX_W As Long, STEP_W As Long\nDim HEIGHT As Long, MIN_H As Long, MAX_H As Long, STEP_H As Long\nDim COLUMN As Long\n\n' . . .\n\nDim wsArr As Variant\nReDim wsArr(roundUp((MAX_D - MIN_D) / STEP_D) * roundUp((MAX_W - MIN_W) / STEP_W) * _\n            roundUp((MAX_H - MIN_H) / STEP_H) + 3, 1)\nFor DEPTH = MIN_D To MAX_D Step STEP_D\n    For WIDTH = MIN_W To MAX_W Step STEP_W\n        For HEIGHT = MIN_H To MAX_H Step STEP_H\n            wsArr(Row, 1) = BLOCK &amp; \"-\" &amp; HEIGHT &amp; \"-\" &amp; WIDTH &amp; \"-\" &amp; DEPTH\n            Row = Row + 1\n        Next HEIGHT\n    Next WIDTH\nNext DEPTH\n\nDim rng As Range\nWith ActiveSheet\n    Set rng = .Range(.Cells(1, COLUMN), .Cells(UBound(wsArr) + 1, COLUMN))\nEnd With\n\nrng.Value = wsArr\n</code></pre>\n\n<p></p>\n\n<pre><code>Function roundUp(ByVal dVal As Double) As Long\n    If Int(dVal) = dVal Then\n        roundUp = dVal\n    Else\n        roundUp = Int(dVal) + 1\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 0, "last_activity_date": 1544605413, "creation_date": 1544605413, "answer_id": 53739387, "question_id": 53738214, "link": "https://stackoverflow.com/questions/53738214/overflow-issue-in-excel-vba-script-large-list-creation/53739387#53739387", "title": "Overflow issue in Excel VBA script / large list creation", "body": "<p>As a somewhat quicker alternative, you can use Power Query.</p>\n\n<p>Add your parameters to a table:</p>\n\n<pre><code>+-------+-------+--------+-------+-------+--------+-------+-------+--------+\n| MIN_D | MAX_D | STEP_D | MIN_W | MAX_W | STEP_W | MIN_H | MAX_H | STEP_H |\n+-------+-------+--------+-------+-------+--------+-------+-------+--------+\n|     1 |    11 |      1 |     1 |   101 |      1 |     1 |   181 |      1 |\n+-------+-------+--------+-------+-------+--------+-------+-------+--------+\n</code></pre>\n\n<p>Now add a query:</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    #\"Change Type Numbers\" = Table.TransformColumnTypes(Source,List.Transform(Table.ColumnNames(Source), each {_, Int64.Type})),\n    ListDepth = List.Numbers(#\"Change Type Numbers\"[MIN_D]{0},(#\"Change Type Numbers\"[MAX_D]{0}-#\"Change Type Numbers\"[MIN_D]{0})/#\"Change Type Numbers\"[STEP_D]{0}+1,#\"Change Type Numbers\"[STEP_D]{0}),\n    ListWidth = List.Numbers(#\"Change Type Numbers\"[MIN_W]{0},(#\"Change Type Numbers\"[MAX_W]{0}-#\"Change Type Numbers\"[MIN_W]{0})/#\"Change Type Numbers\"[STEP_W]{0}+1,#\"Change Type Numbers\"[STEP_W]{0}),\n    ListHeight = List.Numbers(#\"Change Type Numbers\"[MIN_H]{0},(#\"Change Type Numbers\"[MAX_H]{0}-#\"Change Type Numbers\"[MIN_H]{0})/#\"Change Type Numbers\"[STEP_H]{0}+1,#\"Change Type Numbers\"[STEP_H]{0}),\n    #\"Make Table\" = Table.FromList(ListDepth,Splitter.SplitByNothing(),{\"Depth\"}),\n    #\"Add Width\" = Table.AddColumn(#\"Make Table\", \"Width\", each ListWidth),\n    #\"Expand Width\" = Table.ExpandListColumn(#\"Add Width\", \"Width\"),\n    #\"Add Height\" = Table.AddColumn(#\"Expand Width\", \"Height\", each ListHeight),\n    #\"Expanded Height\" = Table.ExpandListColumn(#\"Add Height\", \"Height\"),\n    #\"Change Type Text\" = Table.TransformColumnTypes(#\"Expanded Height\",List.Transform(Table.ColumnNames(#\"Expanded Height\"), each {_, type text})),\n    #\"Added Output\" = Table.AddColumn(#\"Change Type Text\", \"Output\", each Text.Combine({\"BLOCK\",[Height],[Width],[Depth]},\" - \"), type text),\n    #\"Removed Other Columns\" = Table.SelectColumns(#\"Added Output\",{\"Output\"})\nin\n    #\"Removed Other Columns\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10779091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e7933f6dc6340340de57d8acbe4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "user10779091", "link": "https://stackoverflow.com/users/10779091/user10779091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544605413, "creation_date": 1544600522, "question_id": 53738214, "link": "https://stackoverflow.com/questions/53738214/overflow-issue-in-excel-vba-script-large-list-creation", "title": "Overflow issue in Excel VBA script / large list creation", "body": "<p>I need to write a list of new part number descriptions for uploading. There are several lists, the first list is ~600,000 numbers. The parts are basically a block with height, width, depth dimensions.</p>\n\n<p>Considering it has 3 dimensions/vectors to it, I thought it <strong>can't</strong> be easily formatted into one column with VBA. Maybe I am wrong and there is an easier way. </p>\n\n<pre><code>For DEPTH = MIN_D To MAX_D Step STEP_D\n    For WIDTH = MIN_W To MAX_W Step STEP_W\n        For HEIGHT = MIN_H To MAX_H Step STEP_H\n            ROW = ROW + 1\n            Cells(ROW, COLUMN).Value = BLOCK &amp; \"-\" &amp; HEIGHT &amp; \"-\" &amp; WIDTH &amp; \"-\" &amp; DEPTH\n        Next HEIGHT\n    Next WIDTH\nNext DEPTH\n</code></pre>\n\n<p>The code works (ROW is Long, other dims are Integer) for 200,000 iterations (181x101x11 HxWxD), but I am unsure about it working beyond this.</p>\n\n<p>So if there are 600000+ steps, is there a better way to do it? Like maybe pre-allocating the space or using waits etc?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544596913, "post_id": 53737344, "comment_id": 94327579, "body": "Worksheet Change or Worksheet Calculate?  Also, <code>If Not Intersect(cbX1, Range(&quot;A1:F1&quot;)) Is Nothing</code> will always be true, since <code>cbX1</code> is the same as <code>Range(&quot;A1:F1&quot;)</code>, and similarly for the rest of the conditions."}, {"owner": {"reputation": 29, "user_id": 5702184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f25095d787971aa81e2ae4b147fa35e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Babayev", "link": "https://stackoverflow.com/users/5702184/m-babayev"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544597813, "post_id": 53737344, "comment_id": 94327931, "body": "@BigBen thanks for your quick reply. Worksheet Calculate since both - &quot;the cells linked to checkboxes&quot; and &quot;the cells that replicate previous cells&quot; are considered as a formula type. Worksheet change will only work if it&#39;s changed manually. Cells get TRUE and FALSE values based on formula."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544597897, "post_id": 53737344, "comment_id": 94327959, "body": "Right, I was just commenting that you mention &quot;Worksheet_Change&quot; in your question...."}, {"owner": {"reputation": 29, "user_id": 5702184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f25095d787971aa81e2ae4b147fa35e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Babayev", "link": "https://stackoverflow.com/users/5702184/m-babayev"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1544598051, "post_id": 53737344, "comment_id": 94328013, "body": "@BigBen oh, sorry, I think I just wrote my question too quick and made a mistake. Edited my question"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544598273, "post_id": 53737344, "comment_id": 94328092, "body": "Maybe see <a href=\"https://stackoverflow.com/questions/11406628/vba-code-doesnt-run-when-cell-is-changed-by-a-formula\">this question</a>, as well as this <a href=\"https://stackoverflow.com/questions/43184798/timestamp-when-a-cell-is-changed-via-a-formula-excel\">implementation</a> of it."}, {"owner": {"reputation": 29, "user_id": 5702184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f25095d787971aa81e2ae4b147fa35e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Babayev", "link": "https://stackoverflow.com/users/5702184/m-babayev"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1544598420, "post_id": 53737344, "comment_id": 94328151, "body": "@BigBen I&#39;ve tried that solution, but for some reason I don&#39;t get timestamp update when I untick the checkbox. It gets updated only when I tick it"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5702184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f25095d787971aa81e2ae4b147fa35e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Babayev", "link": "https://stackoverflow.com/users/5702184/m-babayev"}, "edited": false, "score": 0, "creation_date": 1544599001, "post_id": 53737792, "comment_id": 94328381, "body": "thank you very much for the answer. I not only works perfectly, but also opened my eyes to realize that I was on a wrong way. Good luck"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "reply_to_user": {"reputation": 29, "user_id": 5702184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f25095d787971aa81e2ae4b147fa35e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Babayev", "link": "https://stackoverflow.com/users/5702184/m-babayev"}, "edited": false, "score": 2, "creation_date": 1544599458, "post_id": 53737792, "comment_id": 94328550, "body": "Please note that I added disabling the events with                             Application.EnableEvents = False so that writing the timestamp did not trigger Worksheet_Change (if you had one of those)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10779473"}, "is_accepted": true, "score": 5, "last_activity_date": 1544601157, "last_edit_date": 1544601157, "creation_date": 1544598731, "answer_id": 53737792, "question_id": 53737344, "link": "https://stackoverflow.com/questions/53737344/put-timestamp-when-a-checkbox-is-ticked-or-unticked/53737792#53737792", "title": "Put timestamp when a checkbox is ticked or unticked", "body": "<p>You seem to be confusing Worksheet_Calculate with Worksheet_Change and using Intersect as if one of the arguments was Target (which Worksheet_Calculate does not have).</p>\n\n<p><code>Intersect(cbX1, Range(\"A1:F1\"))</code> is <strong>always</strong> not nothing because you are comparing six apples to the same six apples. You might as well ask <em>'Is 1,2,3,4,5,6 the same as 1,2,3,4,5,6?'</em>. </p>\n\n<p>You need a method of recording the values of your range of formulas from one calculation cycle to the next. Some use a public variable declared outside the Worksheet_calculate sub procedure; personally I prefer a Static variant array declared within the Worksheet_calculate sub.</p>\n\n<p>The problem with these is initial values but this can be accomplished since workbooks undergo a calculation cycle when opened. However, it is not going to register Now in column G the first time you run through a calculation cycle; you already have the workbook open when you paste in the code and it needs one calculation cycle to 'seed' the array containing the previous calculation cycle's values.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Calculate()\n    Static vals As Variant\n\n    If IsEmpty(vals) Then   'could also be IsArray(vals)\n        vals = Range(Cells(1, \"A\"), Cells(3, \"F\")).Value2\n    Else\n        Dim i As Long, j As Long\n        With Range(Cells(1, \"A\"), Cells(3, \"F\"))\n            For i = LBound(vals, 1) To UBound(vals, 1)\n                For j = LBound(vals, 2) To UBound(vals, 2)\n                    If .Cells(i, j).Value2 &lt;&gt; vals(i, j) Then\n                        Application.EnableEvents = False\n                        .Cells(i, \"G\") = Now\n                        Application.EnableEvents = True\n                        vals(i, j) = .Cells(i, j).Value2\n                    End If\n                Next j\n            Next i\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5702184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f25095d787971aa81e2ae4b147fa35e?s=128&d=identicon&r=PG&f=1", "display_name": "M. Babayev", "link": "https://stackoverflow.com/users/5702184/m-babayev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 53737792, "answer_count": 1, "score": 2, "last_activity_date": 1568926385, "creation_date": 1544596566, "last_edit_date": 1568926385, "question_id": 53737344, "link": "https://stackoverflow.com/questions/53737344/put-timestamp-when-a-checkbox-is-ticked-or-unticked", "title": "Put timestamp when a checkbox is ticked or unticked", "body": "<p>I have a worksheet with 3 rows and 7 columns (<code>A1:G3</code>).<br>\nA and B columns have 6 checkboxes (<code>A1:B3</code>). Boxes in columns A &amp; B are linked to columns C &amp; D respectively. Cells in columns E &amp; F are just replicating columns C &amp; D respectively (live <code>E1</code> cell is <code>=C1</code> and <code>F3</code> cell is <code>=D3</code>).</p>\n\n<p>I want to put a timestamp in cell G for each row when a checkbox is ticked or unticked by using Worksheet_Calculate event in VBA for that sheet.</p>\n\n<p>My code works when used for just 1 row.</p>\n\n<pre><code>Private Sub Worksheet_calculate()\n    Dim cbX1 As Range\n    Set cbX1 = Range(\"A1:F1\")\n    If Not Intersect(cbX1, Range(\"A1:F1\")) Is Nothing Then\n        Range(\"G1\").Value = Now()\n    End If\nEnd Sub\n</code></pre>\n\n<p>I want to combine the code for 3 rows.</p>\n\n<p>Here are 2 variations:</p>\n\n<p>1st one:</p>\n\n<pre><code>Private Sub Worksheet_calculate()\n    Dim cbX1 As Range\n    Dim cbX2 As Range\n    Dim cbX3 As Range\n    Set cbX1 = Range(\"A1:F1\")\n    Set cbX2 = Range(\"A2:F2\")\n    Set cbX3 = Range(\"A3:F2\")\n    If Not Intersect(cbX1, Range(\"A1:F1\")) Is Nothing Then\n        Range(\"G1\").Value = Now()\n    ElseIf Intersect(cbX2, Range(\"A2:F2\")) Is Nothing Then\n        Range(\"G2\").Value = Now()\n    ElseIf Intersect(cbX3, Range(\"A3:F3\")) Is Nothing Then\n        Range(\"G3\").Value = Now()\n    End If\nEnd Sub \n</code></pre>\n\n<p>When I combine them with <code>ElseIf</code> like in the code above, a timestamp gets put in only <code>G1</code>, no matter if I tick <code>B1</code> or <code>C2</code>.</p>\n\n<p>2nd one:</p>\n\n<pre><code>Private Sub Worksheet_calculate()\n    Dim cbX1 As Range\n    Dim cbX2 As Range\n    Dim cbX3 As Range\n    Set cbX1 = Range(\"A1:F1\")\n    If Not Intersect(cbX1, Range(\"A1:F1\")) Is Nothing Then\n        Range(\"G1\").Value = Now()\n    End If\n    Set cbX2 = Range(\"A2:F2\")\n    If Not Intersect(cbX2, Range(\"A2:F2\")) Is Nothing Then\n        Range(\"G2\").Value = Now()\n    End If\n    Set cbX3 = Range(\"A3:F2\")\n    If Not Intersect(cbX3, Range(\"A3:F3\")) Is Nothing Then\n        Range(\"G3\").Value = Now()\n    End If\nEnd Sub\n</code></pre>\n\n<p>When I combine them by ending each one with <code>End If</code> and start a new <code>If</code>, timestamp gets put in all of the <code>G1</code>, <code>G2</code> and <code>G3</code> cells, even if I tick just one of the boxes.</p>\n"}, {"tags": ["excel", "vba", "save", "data-entry"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1544593526, "post_id": 53736709, "comment_id": 94326389, "body": "That is good, so what is your question?"}, {"owner": {"reputation": 3401, "user_id": 2086966, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/047de0e0aa362e30a75f3bebe840ed48?s=128&d=identicon&r=PG", "display_name": "smilyface", "link": "https://stackoverflow.com/users/2086966/smilyface"}, "edited": false, "score": 1, "creation_date": 1544593946, "post_id": 53736709, "comment_id": 94326522, "body": "The question is not clear. What is 1 minute inside the bracket ? Also let us know what have you tried to achieve the expected output (any code snippet or other details of your try)"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 29, "user_id": 10779141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uG1-Na3AZD8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iefK--YpN8_u8zGNKVwQXbsuEneg/mo/photo.jpg?sz=128", "display_name": "Newbie", "link": "https://stackoverflow.com/users/10779141/newbie"}, "edited": false, "score": 0, "creation_date": 1544675984, "post_id": 53737371, "comment_id": 94362709, "body": "Great! Glad to help."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1544597052, "last_edit_date": 1544597052, "creation_date": 1544596699, "answer_id": 53737371, "question_id": 53736709, "link": "https://stackoverflow.com/questions/53736709/vba-saving-delay-after-data-entry/53737371#53737371", "title": "VBA Saving delay after data entry", "body": "<p>One possibility is to leverage the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetchange\" rel=\"nofollow noreferrer\">Workbook.SheetChange</a> event and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.ontime\" rel=\"nofollow noreferrer\"><code>Application.OnTime</code></a>. You'll also need a <code>Public</code> variable, <code>ScheduledTime</code> in the example below.</p>\n\n<p>Every time any (non-chart) sheet is changed (e.g. via data entry):</p>\n\n<ol>\n<li>Any previously scheduled save, as long as it's still within the one-minute window, is cancelled.</li>\n<li>A new save is scheduled for one minute out.</li>\n</ol>\n\n<hr>\n\n<p>So something like the following:</p>\n\n<p>In the <code>ThisWorkbook</code> code module:</p>\n\n<pre><code>Option Explicit\n\nPublic ScheduledTime\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, _\n ByVal Target As Range)\n\n    On Error Resume Next\n    Application.OnTime EarliestTime:=ScheduledTime, Procedure:=\"SaveTheFile\", Schedule:=False\n    On Error GoTo 0\n\n    ScheduledTime = Now + TimeValue(\"00:01:00\")\n    Application.OnTime EarliestTime:=ScheduledTime, Procedure:=\"SaveTheFile\"\nEnd Sub\n</code></pre>\n\n<p>In a regular code module:</p>\n\n<pre><code>Public Sub SaveTheFile()\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You could just as well use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet Change</a> event if you want to restrict this to a particular sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 4209542, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LU9qTK2gQHo/AAAAAAAAAAI/AAAAAAAAAAA/-6ZlzT4HEJc/photo.jpg?sz=128", "display_name": "Diederik Sieburgh", "link": "https://stackoverflow.com/users/4209542/diederik-sieburgh"}, "is_accepted": false, "score": 0, "last_activity_date": 1544597462, "creation_date": 1544597462, "answer_id": 53737515, "question_id": 53736709, "link": "https://stackoverflow.com/questions/53736709/vba-saving-delay-after-data-entry/53737515#53737515", "title": "VBA Saving delay after data entry", "body": "<p>I have a similar take on this to BigBen. </p>\n\n<p>In <code>ThisWorkbook</code> module:</p>\n\n<pre><code>Option Explicit\n\nPublic SnapShot As String\n\nPrivate Sub Workbook_Open()\n    StartTimer\nEnd Sub\n\nSub StartTimer()\n    If SnapShot = vbNullString Then SnapShot = Now\n    If DateDiff(\"s\", SnapShot, VBA.CStr(Now)) &gt;= 10 Then ThisWorkbook.Save\n    RestartTimer\nEnd Sub\n\nSub RestartTimer()\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"ThisWorkbook.StartTimer\"\nEnd Sub\n</code></pre>\n\n<p>And then in the worksheet you are monitoring:  </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    ThisWorkbook.SnapShot = Now\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10779141, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uG1-Na3AZD8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iefK--YpN8_u8zGNKVwQXbsuEneg/mo/photo.jpg?sz=128", "display_name": "Newbie", "link": "https://stackoverflow.com/users/10779141/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53737371, "answer_count": 2, "score": 0, "last_activity_date": 1544603848, "creation_date": 1544593262, "last_edit_date": 1544603848, "question_id": 53736709, "link": "https://stackoverflow.com/questions/53736709/vba-saving-delay-after-data-entry", "title": "VBA Saving delay after data entry", "body": "<p>VBA newbie here. I am looking for a way that will allow my excel file to automatically save after a delay of 1 min after data input.</p>\n\n<p><strong>For example:</strong> </p>\n\n<pre><code>User Inputs Data --&gt; Timer Starts (1min)\n</code></pre>\n\n<p>5 seconds passes. </p>\n\n<pre><code>User inputs Data --&gt; Timer Restarts (1min)\n</code></pre>\n\n<p>1 min passes.</p>\n\n<p>Excel File Saves - until the user starts inputting data again</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544592133, "post_id": 53736467, "comment_id": 94325986, "body": "Perhaps use textbox InputMask property. It won&#39;t actually changing the existing data but should display with the dashes. Changing the data will likely involve string manipulation functions in VBA procedure to breakup the string and then reassemble with dashes."}], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "edited": false, "score": 0, "creation_date": 1544593475, "post_id": 53736608, "comment_id": 94326370, "body": "This is exactly what I was looking for!  One issue though is that this query doesn&#39;t preserve leading zeroes.  Is there a way to do so that you know of?"}], "tags": [], "owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "is_accepted": true, "score": 2, "last_activity_date": 1544592654, "creation_date": 1544592654, "answer_id": 53736608, "question_id": 53736467, "link": "https://stackoverflow.com/questions/53736467/how-to-change-field-into-ssn-format-in-ms-access/53736608#53736608", "title": "How to change field into SSN format (###-##-####) in MS Access?", "body": "<p>There is <code>Format(expression[, format[, firstdayofweek[, firstweekofyear]]])</code> function, which can show you your 9 symbols in desired format</p>\n\n<pre><code>?format(\"123456789\",\"@@@-@@-@@@@\")\n123-45-6789\n</code></pre>\n\n<p>If you decided to change stored values you can use SQL query like this</p>\n\n<pre><code>UPDATE [tblTable] SET [ssn] = format([ssn],\"@@@-@@-@@@@\")\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 0, "accepted_answer_id": 53736608, "answer_count": 1, "score": 0, "last_activity_date": 1544592654, "creation_date": 1544591685, "question_id": 53736467, "link": "https://stackoverflow.com/questions/53736467/how-to-change-field-into-ssn-format-in-ms-access", "title": "How to change field into SSN format (###-##-####) in MS Access?", "body": "<p>I know how to edit a field to remove the dashes but how do I take a field that is a text field with 9 numbers and manipulate it so that it follows standard SSN formatting?  Open to VBA or Query (SQL) methods.  Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "filter", "filtering"], "comments": [{"owner": {"reputation": 3, "user_id": 10779011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677e48a52d0f93db5f5f4f81478a4e7e?s=128&d=identicon&r=PG&f=1", "display_name": "John Kingston", "link": "https://stackoverflow.com/users/10779011/john-kingston"}, "edited": false, "score": 0, "creation_date": 1549485148, "post_id": 53736393, "comment_id": 95923077, "body": "I tried creating a button; however, it didn&#39;t work. I created an ActiveX button. The button was a private sub and then I called the DeleteAllRowsWithNoHighlightedCells Public Sub... then I put in the Public Sub DeleteAllRowsWithNoHiglightedCells... but each time it gave me error or Sub or Function not defined... I am also unclear on the second part of the code you provided and to be honest I&#39;m not sure where to put it... Sorry for my lack of knowledge but I&#39;m completely new to VBA and trying to make it work. Thank you in advance for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 10759528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9A47RbyNDTc/AAAAAAAAAAI/AAAAAAAAL4U/M7g9-tZo9GY/photo.jpg?sz=128", "display_name": "Michael Matt", "link": "https://stackoverflow.com/users/10759528/michael-matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1544603136, "creation_date": 1544603136, "answer_id": 53738856, "question_id": 53736393, "link": "https://stackoverflow.com/questions/53736393/vba-delete-all-rows-that-do-not-contain-at-least-1-highlighted-cell/53738856#53738856", "title": "VBA - Delete all rows that do not contain at least 1 highlighted cell", "body": "<p>you can do it like this:</p>\n\n<pre><code>Public Sub DeleteAllRowsWithNoHighlitedCells()\n\nDim iRow As Long\nDim lastColumn As Long\nDim aktRow As Range\nDim owsh As Worksheet\nSet owsh = ActiveSheet\niRow = 1\nlastColumn = 7\nDo Until owsh.Cells(iRow, 1) = \"\"\n    Set aktRow = owsh.Range(Cells(iRow, 1), Cells(iRow, lastColumn))\n    If Not AktRowHasHighlightedCells(aktRow) Then\n        owsh.Rows(aktRow.Row).Delete\n        iRow = iRow - 1\n    End If\n    iRow = iRow + 1\nLoop\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Private Function AktRowHasHighlightedCells(ByVal aktRow As Range) As Boolean\n     Dim aktcell As Variant</p>\n\n<pre><code> For Each aktcell In aktRow.Cells\n\n    If aktcell.Interior.ColorIndex = 3 Then\n        AktRowHasHighlightedCells = True\n        Exit Function\n    End If\n\nNext aktcell\nAktRowHasHighlightedCells = False\n</code></pre>\n\n<p>End Function</p>\n\n<p>To explain what i mean. First you have to create a Button and put the <strong>DeleteAllRowsWithNoHiglitedCells</strong> - Procedure behind the Click-Event. Then until Column1 for each row  is not empty, every Cell in the selected Row from column1 to lastColumn (you have to define or you also can get the lastusedColumn via VBA) is checked for a Interior.Colorindex = 3 (hard coded red) If the Function <strong>AktRowHasHighlightedCells</strong> is false, the row will be deleted and the rowCounter will be decreased.</p>\n"}], "owner": {"reputation": 3, "user_id": 10779011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677e48a52d0f93db5f5f4f81478a4e7e?s=128&d=identicon&r=PG&f=1", "display_name": "John Kingston", "link": "https://stackoverflow.com/users/10779011/john-kingston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 53738856, "answer_count": 1, "score": -2, "last_activity_date": 1544603136, "creation_date": 1544591111, "last_edit_date": 1544592901, "question_id": 53736393, "link": "https://stackoverflow.com/questions/53736393/vba-delete-all-rows-that-do-not-contain-at-least-1-highlighted-cell", "title": "VBA - Delete all rows that do not contain at least 1 highlighted cell", "body": "<p>Looking for VBA code to delete all rows that do not contain at least 1 highlighted cell (interior color used: REDINDEX).</p>\n\n<p>Sample data sheet with randomly highlighted cells</p>\n\n<p><a href=\"https://i.stack.imgur.com/9tWej.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9tWej.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544588601, "post_id": 53736023, "comment_id": 94325155, "body": "What have you tried so far? Have you <a href=\"https://www.google.com/search?q=excel+vbeditor+add+missing+references\" rel=\"nofollow noreferrer\">searched for your issue</a>?"}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1544607919, "post_id": 53736023, "comment_id": 94332902, "body": "Are you using Microsoft Access 64bit Version? That could be the reason."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1544611697, "post_id": 53736023, "comment_id": 94335191, "body": "Office Libs V 9.0 fit to Access 2000. The refs are linked top to bottom? then <code>JMAIL 4.0</code>is missing."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10778865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efe84bdf7ea1a7aa651ce8eef7a44ae?s=128&d=identicon&r=PG&f=1", "display_name": "Sonltk", "link": "https://stackoverflow.com/users/10778865/sonltk"}, "edited": false, "score": 0, "creation_date": 1544684384, "post_id": 53749748, "comment_id": 94365288, "body": "I found the project problem already, Thank you very much. (Missing a hardcode folder)."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1544641518, "creation_date": 1544641518, "answer_id": 53749748, "question_id": 53736023, "link": "https://stackoverflow.com/questions/53736023/microsoft-access-vba-cannot-find-project-or-library/53749748#53749748", "title": "Microsoft Access VBA: Cannot find project or library", "body": "<p>What is probably happening is that you are trying to open an Access file that was developed using certain Add-ons or applications, on a computer where these add-ons or applications are not installed.</p>\n"}], "owner": {"reputation": 1, "user_id": 10778865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9efe84bdf7ea1a7aa651ce8eef7a44ae?s=128&d=identicon&r=PG&f=1", "display_name": "Sonltk", "link": "https://stackoverflow.com/users/10778865/sonltk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1544667803, "creation_date": 1544588394, "last_edit_date": 1544667803, "question_id": 53736023, "link": "https://stackoverflow.com/questions/53736023/microsoft-access-vba-cannot-find-project-or-library", "title": "Microsoft Access VBA: Cannot find project or library", "body": "<p>I have a problem as below:</p>\n\n<p>Title: MS Access 2000, Win 10 enterprise- Cannot find project or library.</p>\n\n<p>Steps:</p>\n\n<ul>\n<li>I open a form, </li>\n<li>Click on a button (Click event).</li>\n</ul>\n\n<p>Actual result:\n- Cannot find project or library.</p>\n\n<p>Notes: It works correctly on WinXP\nAcction:\n     I open Reference dialog box:\n   <a href=\"https://i.stack.imgur.com/1kUbZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1kUbZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>But i dont know how to register the libs: JMAIL 4.0, MS Rich textbox control 6, MS Access Barcode control 9.</p>\n\n<p>Please feel free to help me, </p>\n\n<p>Let me know if there is any unclear in the post.</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["vba", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544601559, "post_id": 53735654, "comment_id": 94329421, "body": "Are you running the code in Excel or in word? Why do you want to open a .PDF in MS-Word?"}, {"owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544602164, "post_id": 53735654, "comment_id": 94329720, "body": "Hi! i am running the code through excel. Is there a more efficient method to do this, whereby i can manipulate the data within the pdf files"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544602423, "post_id": 53735654, "comment_id": 94329845, "body": "Well it depends on what you want to do? PDFs are thought to be files that are portable and should not be changed. A PDF is for example a great way to send someone a document they are supposed to read or print but not supposed to edit. The question is what you want a user to do? Should it just display data from your worksheet? Should it be printed? Should it be manipulated and then saved again? Please do add a little more detail on your problem and on your strategy to solve it. We will then try to help you with the code."}, {"owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544602909, "post_id": 53735654, "comment_id": 94330048, "body": "Sorry for the lack of details. What i&#39;m planning to do is to print according to specifications within the pdf files. For example performing calculations and if it is within the specifications i want, it will proceed to the next loop. I am also looking for specific words, if those words are within the pdf files, the program will proceed to PrintFile. Nothing will be changed in the original pdf file, it will close right after i perform the reading and printing."}, {"owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544603208, "post_id": 53735654, "comment_id": 94330202, "body": "Right now i am looking more to the framework of the code, like to open up, close and printing the file."}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544603262, "post_id": 53735654, "comment_id": 94330234, "body": "So the pdf file you open is already existing. You then want to scan the pdf file for keywords and perform some calculations on some data existing in the PDF file. Based on these criteria you want to decide if you print the file or not. Is that correct?"}, {"owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1544603678, "post_id": 53735654, "comment_id": 94330423, "body": "Yes, that&#39;s correct sir. The program will open the pdf to determine if the file is supposed to be printed out, if Yes, print, if No, then proceed to closing the pdf file and moving on to the next file within the folder."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "edited": false, "score": 0, "creation_date": 1544602364, "post_id": 53738383, "comment_id": 94329816, "body": "By the way, do you happen to know how to print a pdf file using vba? The printing setting i am look for is landscape and double sided flip to short edge."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "edited": false, "score": 0, "creation_date": 1544613437, "post_id": 53738383, "comment_id": 94336164, "body": "Your original question is about opening the file, but getting an error message, @Nick. Does my suggestion solve that? If yes, it should be accepted as &quot;the answer&quot; (the checkmark next to it clicked&quot; and any further problem asked in a new question. It might help you to understand how the site works by reading how to ask in the <a href=\"https://stackoverflow.com/help\">help center</a>. Questions should be narrowly scoped: a specific problem and only one problem / question. The scope of your request is expanding geometrically..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1544601269, "creation_date": 1544601269, "answer_id": 53738383, "question_id": 53735654, "link": "https://stackoverflow.com/questions/53735654/opening-pdf-files-through-ms-word/53738383#53738383", "title": "Opening pdf files through MS-Word", "body": "<p>Don't us the <code>New</code> keyword in the line that declares the object variable. This will \"block\" the object variable - it causes the error when the code laters tries to instantiate it. This method can work in VB.NET but not in VBA.</p>\n\n<p>Do it more like this:</p>\n\n<pre><code>Dim wd As Word.Application\nSet wd = New Word.Application. 'Or use CreateObject\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "edited": false, "score": 0, "creation_date": 1544750712, "post_id": 53739812, "comment_id": 94396442, "body": "Hi! The code looks good, i&#39;ll try it out! But how do i change the printer setup? The format i am looking for is landscape, double sided and flip to short edge!"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "edited": false, "score": 0, "creation_date": 1544771505, "post_id": 53739812, "comment_id": 94401190, "body": "@Nick You then need to look up the shell commands for those print parameters and then add it to the shell code in the function <code>PrintPDF</code> in order to print it according to your parameters."}], "tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": false, "score": 0, "last_activity_date": 1544606735, "creation_date": 1544606735, "answer_id": 53739812, "question_id": 53735654, "link": "https://stackoverflow.com/questions/53735654/opening-pdf-files-through-ms-word/53739812#53739812", "title": "Opening pdf files through MS-Word", "body": "<p>I think a combination of those three sources will lead to the answer: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/19185260/open-a-pdf-using-vba-in-excel\">How to open a pdf with Excel?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/36270247/vba-extract-data-from-pdf-and-add-to-worksheet\">How to extract data from pdf using VBA?</a></p>\n\n<p><a href=\"https://www.techwalla.com/articles/how-to-use-vba-to-open-print-a-pdf-file\" rel=\"nofollow noreferrer\">How to open and print a pdf using VBA?\n</a></p>\n\n<p>I think it will be something like this: </p>\n\n<pre><code>Sub Extract_PDF_Data()\n\nDim mainData As String\nDim strFile As String\nDim Oldname As String\nDim Newname As String\nDim Folderpath As String\nDim s As String\nDim t As Excel.Range\nDim Appshell As Variant\nDim ap As String\nDim Browsedir As Variant\nDim f As Variant\nDim KeyWord As String\n\n' This is a suggestion, I use it because it is more convenient than copy-pasting folder paths\nDim FSO As Object\nSet FSO = CreateObject(\"Scripting.Filesystemobject\")\n\n ' Get Folder over user input\nSet Appshell = CreateObject(\"Shell.Application\")\nSet Browsedir = Appshell.BrowseForFolder(0, \"Select a Folder\", &amp;H1000, \"E:\\Xample\\Path\")\n\n' check if not cancalled\nIf Not Browsedir Is Nothing Then\n      Folderpath = Browsedir.items().Item().Path\nElse\n    GoTo Quit\nEnd If\n\nKeyWord = \"The_Materialist_Example\"\n\n' go through all files in the folder\nFor Each f In FSO.GetFolder(Folderpath).Files\n    ' if file is a pdf , open, check for keyword, decide if should be printed\n    If LCase(Right(f.Name, 3)) = \"pdf\" Then\n\n        ' Here the methods suggest different answers.\n        ' You can either use FollowHyperLink or use the Adobe Library to OPEN PDF\n\n        ' I would write a function that checks the active pdf for the keyword : IsKeyFound\n        Debug.Print Folderpath &amp; \"\\\" &amp; f.Name\n\n        Call PrintPDF(Folderpath &amp; \"\\\" &amp; f.Name)\n        If IsKeyFound(f, KeyWord) Then\n            f.Print\n        End If\n    End If\nNext f\n\nQuit:\nEnd Sub\n\nPrivate Sub PrintPDF(strPDFFileName As String)\n  Dim sAdobeReader As String 'This is the full path to the Adobe Reader or Acrobat application on your computer\n  Dim RetVal As Variant\n  sAdobeReader = \"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe\"\n  'Debug.Print sAdobeReader &amp; \"/P\" &amp; Chr(34) &amp; strPDFFileName &amp; Chr(34)\n  RetVal = Shell(sAdobeReader &amp; \" /P \" &amp; Chr(34) &amp; strPDFFileName &amp; Chr(34), 0)\nEnd Sub\n\n\nPrivate Function IsKeyFound(PDF As Variant, KeyWord As String) As Boolean\n   'Decide if file needs to be printed, insert your criteria and search algorithm here\nEnd Function\n</code></pre>\n\n<p>I have not been able to figure out how to extract the keywords, you could however use a user input as a first approach and later move on to a automated scan of the pdf. </p>\n\n<p>I hope this gets you further on the way to the solution.</p>\n"}], "owner": {"reputation": 1, "user_id": 10108580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754aabf191ebb128c393a1593f8d8f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10108580/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544606735, "creation_date": 1544585522, "last_edit_date": 1544602042, "question_id": 53735654, "link": "https://stackoverflow.com/questions/53735654/opening-pdf-files-through-ms-word", "title": "Opening pdf files through MS-Word", "body": "<p>I am trying to open a pdf file through MS Word, perform certain action such as evaluating calculations, printing the files, etc. and then proceed with closing the file. The error message I received is \"Microsoft Excel is waiting for another application to complete an OLE action.\"</p>\n\n<p>I have previously tried hyperlinkfollow and <code>Shell MyPath &amp; \" \" &amp; MyFile, vbNormalFocus</code> method, it doesn't work. I am still at the starting phase of opening the pdf files, please advice. Thanks!</p>\n\n<pre><code>Sub Extract_PDF_Data()\n\nDim mainData As String\nDim strFile As String\nDim Oldname As String\nDim Newname As String\nDim Folderpath As String\n\nDim s As String\nDim t As Excel.Range\nDim wd As New Word.Application\nDim mydoc As Word.Document\n\n\n\nFolderpath = InputBox(\"Folder path: \")\nFolderpath = Folderpath &amp; \"\\\"\nstrFile = Dir(Folderpath &amp; \"\", vbNormal)\n\n\nDo While Len(strFile) &gt; 0\nOldname = Folderpath &amp; strFile\nSet wd = CreateObject(\"Word.Application\")\nSet mydoc = Word.Documents.Open(Filename:=Oldname, Format:=\"PDF Files\", \nConfirmConversions:=False)\n\nmainData = mydoc.Content.Text\nmydoc.Close False\nwd.Quit\n\n\nstrFile = Dir\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "view", "passwords"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1544584781, "post_id": 53735528, "comment_id": 94324361, "body": "Just turn on/off <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\">Worksheet Protection</a>. ...actually, you might consider using the <code>Worksheet.Protection</code> password parameter after making the sheet visible. That would also prevent someone from just making the sheet visible.  Also, I&#39;d use <code>xlSheetveryhidden</code> instead of <code>xlSheetVisible</code>. That makes the worksheet unable to be unhidden unless you use VBA."}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544585826, "post_id": 53735528, "comment_id": 94324566, "body": "@BruceWayne, could you add this into the code so I cant accept the answer. I&#39;m having the same issue. I need to be able to view and edit the sheet after the correct password has been entered."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544587369, "post_id": 53735528, "comment_id": 94324865, "body": "That&#39;s almost a new question/task altogether. I suggest first <a href=\"https://www.google.com/search?q=VBA+add+worksheet+protection+password\" rel=\"nofollow noreferrer\">searching around</a> first."}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544587734, "post_id": 53735528, "comment_id": 94324951, "body": "It&#39;s not protecting a sheet, it&#39;s restricting access. I&#39;ve updated the question in case this wasn&#39;t clear the first time"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1544752902, "post_id": 53736251, "comment_id": 94396885, "body": "Thanks @Haran24HR. This is exactly what I&#39;m after. Could I incorporate a few sheets with the same password?"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1544756324, "post_id": 53736251, "comment_id": 94397575, "body": "Glad to know! You can do that."}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": true, "score": 3, "last_activity_date": 1544590088, "creation_date": 1544590088, "answer_id": 53736251, "question_id": 53735528, "link": "https://stackoverflow.com/questions/53735528/access-password-blocked-sheet-excel/53736251#53736251", "title": "Access password blocked sheet - Excel", "body": "<p>Following code will help you. When a user will select a sheet with name <code>HiddenSheet</code> it will ask for password. If password is correct then it will allow for editing data otherwise will go to previous sheet automatically, You have to change <code>HiddenSheet</code> for your sheet name.</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\nDim MySheetName As String\n\nMySheetName = \"HiddenSheet\" 'The sheed which I want to hide.\n\nIf Application.ActiveSheet.Name = MySheetName Then\n    Application.EnableEvents = False\n    Application.ActiveSheet.Visible = False\n    response = Application.InputBox(\"Password\", \"Enter Password\", \"\", Type:=2)\n\n        If response = \"123456\" Then 'Unhide Password.\n            Application.Sheets(MySheetName).Visible = True\n            Application.Sheets(MySheetName).Select\n        End If\nEnd If\n\nApplication.Sheets(MySheetName).Visible = True\n\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong><em>Code snipped:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/iiz55.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iiz55.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53736251, "answer_count": 1, "score": 0, "last_activity_date": 1544590088, "creation_date": 1544584460, "last_edit_date": 1544588276, "question_id": 53735528, "link": "https://stackoverflow.com/questions/53735528/access-password-blocked-sheet-excel", "title": "Access password blocked sheet - Excel", "body": "<p>The code below restricts access by hiding a sheet unless a password is entered. If it is entered correctly, the sheet can be viewed from the individual tabs. However, it won't let me view and then edit the sheet. </p>\n\n<p>Can this be adjusted to allow the user to enter a password and then view and edit the sheet?</p>\n\n<pre><code>Private Sub Workbook_Open()\nSheets(\"Sheet1\").Visible = xlSheetHidden\nEnd Sub\n\nPublic ViewAccess As Boolean       'In restricted sheet's activate event\nPrivate Sub Worksheet_Activate()\nIf ViewAccess = False Then\nMe.Visible = xlSheetHidden\nResponse = Application.InputBox(\"Password\", xTitleId, \"\", Type:=2)\n    If Response = \"123\" Then\n        Me.Visible = xlSheetVisible\n        Application.EnableEvents = True\n        ViewAccess = True\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "edited": false, "score": 0, "creation_date": 1544741035, "post_id": 53735523, "comment_id": 94394070, "body": "OP back, I tried the first suggestion that urdearboy mentioned at that is working flawlessly! thank you"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10773628"}, "is_accepted": false, "score": 1, "last_activity_date": 1544585282, "last_edit_date": 1544585282, "creation_date": 1544584422, "answer_id": 53735523, "question_id": 53735346, "link": "https://stackoverflow.com/questions/53735346/automatically-run-macro-at-4-points-in-the-day/53735523#53735523", "title": "Automatically run macro at 4 points in the day", "body": "<p>In a public module, put this dynamic scheduling code.</p>\n\n<pre><code>sub runWhen()\n\n    Select Case Time\n        Case Is &lt; TimeSerial(10, 10, 0)\n            Application.OnTime TimeSerial(10, 10, 0), \"UpdateManifestpending\"\n        Case Is &lt; TimeSerial(12, 25, 0)\n            Application.OnTime TimeSerial(12, 25, 0), \"UpdateManifestpending\"\n        Case Is &lt; TimeSerial(15, 25, 0)\n            Application.OnTime TimeSerial(15, 25, 0), \"UpdateManifestpending\"\n        Case Is &lt; TimeSerial(18, 15, 0)\n            Application.OnTime TimeSerial(18, 15, 0), \"UpdateManifestpending\"\n    End Select\n\nend sub\n</code></pre>\n\n<p>In ThisWorkbook,</p>\n\n<pre><code>Private Sub Workbook_Open()\n    runWhen\nEnd Sub\n</code></pre>\n\n<p>Add the scheduling to UpdateManifestpending just before End Sub.</p>\n\n<pre><code>sub UpdateManifestpending()\n\n   'lots of code here\n\n    runWhen\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 2, "last_activity_date": 1544585318, "creation_date": 1544585318, "answer_id": 53735631, "question_id": 53735346, "link": "https://stackoverflow.com/questions/53735346/automatically-run-macro-at-4-points-in-the-day/53735631#53735631", "title": "Automatically run macro at 4 points in the day", "body": "<ol>\n<li><strong>Code 1:</strong> A <code>WorkBook_Open</code> which calls your scheduler macro</li>\n<li><strong>Code 2:</strong> Your scheduler macro which calls the code to be ran at given times</li>\n<li><strong>Code 3:</strong> your code to be ran at given times</li>\n<li><strong>Home Stretch:</strong> Validate <kbd>Security Settings</kbd> to allow this type series of steps to be executed</li>\n</ol>\n\n<hr>\n\n<h2>Code 1</h2>\n\n<p>Under the code space for <code>ThisWorkbook</code> </p>\n\n<pre><code>Private Sub Workbook_Open()\n    Call Scheduler\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Code 2</h2>\n\n<p>Under a <code>Module</code> code space you will have 2 sets of code. </p>\n\n<pre><code>Sub Scheduler()\n    Application.OnTime TimeValue(\"10:10:00\"), \"UpdateManifestpending\"\n    Application.OnTime TimeValue(\"12:15:00\"), \"UpdateManifestpending\"\n    Application.OnTime TimeValue(\"15:25:00\"), \"UpdateManifestpending\"\n    Application.OnTime TimeValue(\"15:25:00\"), \"UpdateManifestpending\"\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<h2>Code 3</h2>\n\n<pre><code>Sub UpdateManifestpending()\n    'Code here\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Home Stretch</h2>\n\n<p>You will need to allow programmatic access to the VB project </p>\n\n<p>Navigate to <code>Trust Center &gt; Macro Settings</code> and select <code>Trust access to the VBA project object module</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/dBYzi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dBYzi.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 10778642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6e3e8b19763edb78096a0b1d218dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "petepedropetey", "link": "https://stackoverflow.com/users/10778642/petepedropetey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1580458503, "creation_date": 1544582770, "last_edit_date": 1580458503, "question_id": 53735346, "link": "https://stackoverflow.com/questions/53735346/automatically-run-macro-at-4-points-in-the-day", "title": "Automatically run macro at 4 points in the day", "body": "<p>I am trying to run a macro 4 times in a day. 10:10 am, 12:25 pm, 15:25 PM and 18:15 PM. </p>\n\n<p>This excel file is opened in the morning and is open all day. The following day the file is re-saved under a new date name and is open all day.</p>\n\n<p>I think I got it working to automatically update once, but it doesn't seem to work for the rest. I used what I found online to make it automatically run once at 10:10 am.</p>\n\n<p>This part is in \"ThisWorkbook\" under \"Workbook\" and \"Open\"</p>\n\n<pre><code>Private Sub Workbook_Open()\nApplication.OnTime TimeValue(\"10:10:00\"), \"UpdateManifestpending\"\nEnd Sub\n</code></pre>\n\n<p>Then the next part is in the module that the macro is saved in. The macro just refreshes a data connection.</p>\n\n<pre><code>Sub UpdateManifestpending()\n\nApplication.OnTime TimeValue(\"10:10:00\"), \"UpdateManifestpending\"\n'\n' UpdateManifestpending Macro\n'\n\n'\nActiveWorkbook.Connections(\"ManifestPendingUpdates\").Refresh\nEnd Sub\n</code></pre>\n\n<p>I would like to have this run, not only just that one time at 10:10, but at the other times of the day listed above. I tried this to have it run 4 times a day but it doesn't seem to work.</p>\n\n<p>In \"thisworkbook\"</p>\n\n<pre><code>Private Sub Workbook_Open()\nApplication.OnTime TimeValue(\"10:10:00\"), \"UpdateManifestpending\"\nApplication.OnTime TimeValue(\"12:15:00\"), \"UpdateManifestpending\"\nApplication.OnTime TimeValue(\"15:25:00\"), \"UpdateManifestpending\"\nApplication.OnTime TimeValue(\"15:25:00\"), \"UpdateManifestpending\"\nEnd Sub'\n</code></pre>\n\n<p>And under the ModuleID for the macro</p>\n\n<pre><code>`Sub UpdateManifestpending()\n\nApplication.OnTime TimeValue(\"10:10:00\"), \"UpdateManifestpending\"\nApplication.OnTime TimeValue(\"12:15:00\"), \"UpdateManifestpending\"\nApplication.OnTime TimeValue(\"15:25:00\"), \"UpdateManifestpending\"\nApplication.OnTime TimeValue(\"15:25:00\"), \"UpdateManifestpending\"\n\n'\n' UpdateManifestpending Macro\n'\n\n'\nActiveWorkbook.Connections(\"ManifestPendingUpdates\").Refresh\nEnd Sub\n\n`\n</code></pre>\n\n<p>I might be misunderstanding how this activate.ontime works\nAnyhelp is appreciated</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1544631680, "post_id": 53735060, "comment_id": 94346923, "body": "IS there a way to do this but use xlCellValue instead of $A1 ?"}, {"owner": {"reputation": 116, "user_id": 6700974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IpF4tdyVQ-I/AAAAAAAAAAI/AAAAAAAABCE/SkmLGxCN144/photo.jpg?sz=128", "display_name": "lighthouselk", "link": "https://stackoverflow.com/users/6700974/lighthouselk"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1544665961, "post_id": 53735060, "comment_id": 94360610, "body": "You can only use xlExpression for your problem since it has different kind of comparisons (numbers and text). Tragamor&#39;s approach above is the only solution for your type of problems."}], "tags": [], "owner": {"reputation": 116, "user_id": 6700974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IpF4tdyVQ-I/AAAAAAAAAAI/AAAAAAAABCE/SkmLGxCN144/photo.jpg?sz=128", "display_name": "lighthouselk", "link": "https://stackoverflow.com/users/6700974/lighthouselk"}, "is_accepted": false, "score": 1, "last_activity_date": 1544580403, "creation_date": 1544580403, "answer_id": 53735060, "question_id": 53734982, "link": "https://stackoverflow.com/questions/53734982/vba-how-to-programmatically-use-conditional-formatting-and-have-it-apply-to-numb/53735060#53735060", "title": "VBA How to programmatically use conditional formatting and have it apply to numbers only", "body": "<p>You should use a formula to determine your conditions like this.</p>\n\n<pre><code>.FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND($A1&gt;0.8, ISNUMBER($A1))\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1544641628, "post_id": 53749175, "comment_id": 94352161, "body": "I set my range up but the code errors on on this line   Dim FirstCell As String: FirstCell = Replace(Range(&quot;RngTest&quot;)(1).Address, &quot;$&quot;, &quot;&quot;)"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1544641803, "post_id": 53749175, "comment_id": 94352258, "body": "oh I see, a named range in the excel sheet. I would have to programmatically create a named range."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 1, "creation_date": 1544647262, "post_id": 53749175, "comment_id": 94354720, "body": "That&#39;s just to have an example for the code; it can be any range you set prior to running the code, or you can set up a dynamic named range if you like..."}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 3, "last_activity_date": 1544694762, "last_edit_date": 1544694762, "creation_date": 1544639138, "answer_id": 53749175, "question_id": 53734982, "link": "https://stackoverflow.com/questions/53734982/vba-how-to-programmatically-use-conditional-formatting-and-have-it-apply-to-numb/53749175#53749175", "title": "VBA How to programmatically use conditional formatting and have it apply to numbers only", "body": "<p>Using a named range \"RngTest\" the following should do what you want</p>\n\n<pre><code>Sub CFTest()\n    Dim Cond1 As FormatCondition\n    Dim CFRange As Range: Set CFRange = Range(\"RngTest\")\n    Dim FirstCell As String: FirstCell = Replace(CFRange(1).Address, \"$\", \"\")\n\n    With CFRange\n        .FormatConditions.Delete\n        Set Cond1 = .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=AND(ISNUMBER(\" &amp; FirstCell &amp; \"),\" &amp; FirstCell &amp; \"&gt;0.8)\")\n    End With\n\n    With Cond1\n        .Font.Bold = True\n        .Font.Color = -11489280\n        .StopIfTrue = False\n        .Interior.Color = 13421823\n        .Interior.ThemeColor = xlThemeColorAccent6\n        .Interior.TintAndShade = 0.799981688894314\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 53749175, "answer_count": 2, "score": 0, "last_activity_date": 1582426806, "creation_date": 1544579611, "last_edit_date": 1582426806, "question_id": 53734982, "link": "https://stackoverflow.com/questions/53734982/vba-how-to-programmatically-use-conditional-formatting-and-have-it-apply-to-numb", "title": "VBA How to programmatically use conditional formatting and have it apply to numbers only", "body": "<p>Using VBA and Excel\nI have a dynamic range and I want to apply basic conditional formatting that turns the box green if there is a number greater than 0.8</p>\n\n<p>some cells have text and not numbers and I do not want to format those cells. </p>\n\n<p>Here is what I have so far but it doesn't work. </p>\n\n<pre><code>With RESPXL.xlsWS4.Range(RESPXL.xlsWS4.Cells(2, 7), RESPXL.xlsWS4.Cells(RECCNT, 19)).FormatConditions.Add(xlCellValue, xlGreater, \"=IsNumber(xlCellValue)\", \"=0.8\")\n    .Font.Bold = True\n    .Font.Color = -11489280\n    .StopIfTrue = False\n    .Interior.Color = 13421823\n    .Interior.ThemeColor = xlThemeColorAccent6\n    .Interior.TintAndShade = 0.799981688894314\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544587807, "post_id": 53734976, "comment_id": 94324966, "body": "Yes, it&#39;s possible, but your question is far too broad for this site.  Is there some <i>specific</i> part of this which is giving you problems?"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544595631, "post_id": 53734976, "comment_id": 94327118, "body": "@TimWilliams added the codes for my current update button which does not work, tried looking up on the internet but to no avail due to the data placement for this worksheet"}], "owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1580320092, "creation_date": 1544579595, "last_edit_date": 1580320092, "question_id": 53734976, "link": "https://stackoverflow.com/questions/53734976/how-to-edit-the-data-in-cells-with-different-rows-and-columns-respectively-with", "title": "How to edit the data in cells with different rows and columns respectively with userforms", "body": "<p>Here is an example of how the data is placed:\n<img src=\"https://i.stack.imgur.com/74Cg4.png\" alt=\"\"></p>\n\n<p>Here is an example of how my userform is structured: <a href=\"https://i.stack.imgur.com/t1aaN.png\" rel=\"nofollow noreferrer\">Client Userform</a></p>\n\n<p>The codes for the update button are as follows which does not work: </p>\n\n<pre><code>Private Sub UpdateCommandButton_Click()\n\n    Dim countryname As String\n    Dim username As String\n    Dim CompanyName As String\n    Dim onetime As String\n    Dim actualmonthly As String\n\n    'Updating based on User's Name as of now\n\n    ActiveSheet.Activate\n\n    countryname = countryTextBox.Text\n    username = usernameComboBox.Text\n    CompanyName = companyComboBox.Text\n    onetime = oneTimeTextBox.Text\n    actualmonthly = actualMonthlyTextBox.Text\n\n    Cells(currentrow, 2).Value = countryname\n    Cells(currentrow, 3).Value = username\n    Cells(currentrow + 1, 4).Value = CompanyName\n    Cells(currentrow + 1, 6).Value = onetime\n    Cells(currentrow + 1, 7).Value = actualmonthly\n    MsgBox \"Client's Details Has Been Updated!\"\n\nEnd Sub\n</code></pre>\n\n<p>My userform will also display the respective data if the User is searched and the one time and monthly values will change respectively in the comboboxes</p>\n\n<p>Thus, is it possible to edit the different cells respectively based on the inputs from the user form? (Examples of cells that I want to be able edited are <code>B19, C19, D20, D21, D22, E19, E20, E21, E22</code>)</p>\n\n<p>Note that I do not want to hard code the cells which means that the userform can update other columns and rows if more data were to be added. Thanks in advance!</p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544598977, "post_id": 53734974, "comment_id": 94328365, "body": "which row do you actually need to click on?"}, {"owner": {"reputation": 27, "user_id": 2813175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344936129/picture?type=large", "display_name": "Jonathan JC", "link": "https://stackoverflow.com/users/2813175/jonathan-jc"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544638123, "post_id": 53734974, "comment_id": 94350397, "body": "in the first one with the value 49343 i tried all the code i put above but it only gets highlighted also the row it does not have a href attribute"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2813175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344936129/picture?type=large", "display_name": "Jonathan JC", "link": "https://stackoverflow.com/users/2813175/jonathan-jc"}, "edited": false, "score": 0, "creation_date": 1544716851, "post_id": 53754057, "comment_id": 94383308, "body": "I already tried to use  the  code that you provided but it did not worked  so the only work arround i think in orther to move to the next page is to composing the URL:"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 27, "user_id": 2813175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344936129/picture?type=large", "display_name": "Jonathan JC", "link": "https://stackoverflow.com/users/2813175/jonathan-jc"}, "edited": false, "score": 0, "creation_date": 1544767070, "post_id": 53754057, "comment_id": 94399741, "body": "You can also try to add button or link in that table cell and try to click it using VBA code may help to solve the issue."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1544666667, "creation_date": 1544666667, "answer_id": 53754057, "question_id": 53734974, "link": "https://stackoverflow.com/questions/53734974/how-do-i-navigate-to-another-page-by-double-clicking-on-an-html-table-row/53754057#53754057", "title": "How do I navigate to another page by double-clicking on an HTML table row?", "body": "<p>I can see that you are only using Click(). it will not do double click and not fire any event.</p>\n\n<p>To fire any event, You can try to use code like below.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>objElement.click\r\nobjElement.FireEvent \"ondblclick\", 1, 2</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Reference:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25855904/how-to-double-click-web-object-in-vba\">how to double click web object in VBA</a></p>\n\n<p><a href=\"http://www.vbforums.com/showthread.php?802943-Perform-double-click-on-html-element-vb6\" rel=\"nofollow noreferrer\">Re: Perform double click on html element, vb6</a></p>\n"}], "owner": {"reputation": 27, "user_id": 2813175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1344936129/picture?type=large", "display_name": "Jonathan JC", "link": "https://stackoverflow.com/users/2813175/jonathan-jc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580862431, "creation_date": 1544579590, "last_edit_date": 1580862431, "question_id": 53734974, "link": "https://stackoverflow.com/questions/53734974/how-do-i-navigate-to-another-page-by-double-clicking-on-an-html-table-row", "title": "How do I navigate to another page by double-clicking on an HTML table row?", "body": "<p>I am only able to highlight the row but I am not able to double click in the TR in order to fire the event and to go to the next page.</p>\n\n<p>Here is my VBA code: </p>\n\n<pre><code>Set table = webpage.Document.getElementsByClassName(\"grid-mvc\")(0).getElementsByTagName(\"div\")(0).getElementsByTagName(\"table\")(0).getElementsByTagName(\"tbody\")(0).getElementsByTagName(\"tr\")(0)\n'Double Click on row\n\n\nFor Each RowElement In table.getElementsByClassName(\"grid-cell\")\nMsgBox RowElement.innerText\n    RowElement.Click\n    RowElement.Focus\n\n     RowElement.FireEvent \"ondblclick\", 1, 2\n      RowElement.Focus\n     SendKeys \"{ENTER}\"\n\n\n\n     RowElement.FireEvent (\"ondbclick\")\n     SendKeys \"{ENTER}\"\n     RowElement.FireEvent (\"ondbclick\")\n     RowElement.FireEvent (\"onmousedown\")\n       'RowElement.dispatchEvent (\"ondblclick\")\n     SendKeys \"{ENTER}\"\n\nRowElement.getElementsByTagName(\"td\")(1).Click\n\n\n\n\n    If Trim(RowElement.getElementsByTagName(\"td\")(0).innerText) = Value Then\n\n\n MsgBox RowElement.textContent\nRowElement.getElementsByTagName(\"td\")(0).Click\n\n\n\nEnd If\nNext\n</code></pre>\n\n<p>HTML CODE:</p>\n\n<pre><code>&lt;TBODY&gt;\n  &lt;TR class=\"grid-row \"&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"FacilityID\"&gt;49343&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"SubBrand\"&gt;QQ&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"PMSType\"&gt;OnQ&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"PMSAccountingID\"&gt;ORNA       &lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"PMSIDDesc\"&gt;&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"AccountingIDFullAcct\"&gt;\n      &lt;DIV class=\"GLAccount\"&gt;99 90700 USD&lt;/DIV&gt;&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"AccountDescription\"&gt;\n      &lt;DIV title=\"Charitable Contributions      \" \n      class=\"GLAccountDesc\"&gt;Charitable Contributions      &lt;/DIV&gt;&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"AccountingID\"&gt;2861&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"StartDate\"&gt;12/7/2018&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"EndDate\"&gt;12/31/2078&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"CodeBlockSpecific\"&gt;No&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"SystemDefault\"&gt;No&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"PermissionLevel\"&gt;Permitted&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"UserID\"&gt;MERE&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"LastUpdateTime\"&gt;\n      &lt;DIV class=\"LastUpdateTime\"&gt;12/7/2018 11:02:00 PM&lt;/DIV&gt;&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"MgmtGroup\"&gt;Franchised&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"AcctType\"&gt;Franchised&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"FinSys\"&gt;\n      &lt;DIV title=\"Franchise\" class=\"FinancialSystem\"&gt;Franchise&lt;/DIV&gt;&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"Inncode\"&gt;SEACU&lt;/TD&gt;\n    &lt;TD class=\"grid-cell\" data-name=\"HotelName\"&gt;\n      &lt;DIV title=\"The Charter Hotel  Seattle, WA\" class=\"HotelName\"&gt;The Charter \n      Hotel  Seattle, WA&lt;/DIV&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;\n&lt;DIV class=\"grid-footer\"&gt;\n&lt;DIV class=\"grid-itemscount\"&gt;&lt;SPAN class=\"grid-itemscount-label\"&gt;Total \nCount:&lt;/SPAN&gt;                 &lt;SPAN class=\"grid-itemscount-caption\"&gt;1&lt;/SPAN&gt;     \n        &lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;\n&lt;DIV id=\"MappingSearchFacilityIdDialog\"&gt;&lt;/DIV&gt;\n&lt;DIV id=\"ApplyBrandDefaultMappingDialog\"&gt;&lt;/DIV&gt;\n&lt;SCRIPT&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "add-in"], "comments": [{"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "edited": false, "score": 0, "creation_date": 1544592005, "post_id": 53733536, "comment_id": 94325955, "body": "The article you refer to indicates you should indicate the directory in your network like <code>F:\\Addins</code>. I cannot remember 100%, but I think we had similar issues in my company and were able to solve that by indicating the directory like <code>\\\\servername.domain.name\\etc.</code>"}, {"owner": {"reputation": 109, "user_id": 4139050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556875864eba560b6ecfdf26c9b8f34?s=128&d=identicon&r=PG&f=1", "display_name": "Salvatore Fanale", "link": "https://stackoverflow.com/users/4139050/salvatore-fanale"}, "reply_to_user": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "edited": false, "score": 0, "creation_date": 1544643160, "post_id": 53733536, "comment_id": 94352898, "body": "@EarlyBird2 that path is only for deploying updates to the add-in from my development machine.  I am referring to issues with one of the users machines not retaining the reference to the network add-in, and instead creating some internal reference to a local file, even though I have said not to copy the file over."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1580626805, "creation_date": 1580626805, "answer_id": 60023921, "question_id": 53733536, "link": "https://stackoverflow.com/questions/53733536/add-in-installed-from-network-reverts-to-local-path-excel-2016/60023921#60023921", "title": "Add-in Installed from Network Reverts to Local Path? (Excel 2016)", "body": "<p>I've seen that happen if the user initially selects to copy it locally, then removes it, and then tries to add the network copy. The only fix is to edit the registry to remove the local reference, and then add the network copy again. </p>\n\n<p>It's important for the end users to not copy the file locally the first time, or you end up in this mess.</p>\n\n<p>Search their registry for the filename of the add-in and delete it.</p>\n"}], "owner": {"reputation": 109, "user_id": 4139050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556875864eba560b6ecfdf26c9b8f34?s=128&d=identicon&r=PG&f=1", "display_name": "Salvatore Fanale", "link": "https://stackoverflow.com/users/4139050/salvatore-fanale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1580626805, "creation_date": 1544568697, "last_edit_date": 1580626665, "question_id": 53733536, "link": "https://stackoverflow.com/questions/53733536/add-in-installed-from-network-reverts-to-local-path-excel-2016", "title": "Add-in Installed from Network Reverts to Local Path? (Excel 2016)", "body": "<p>I am attempting to deploy a custom MS Excel add-in across our network environment following this article: <a href=\"https://www.excelguru.ca/content.php?152-Deploying-Add-ins-in-a-Network-Environment\" rel=\"nofollow noreferrer\">https://www.excelguru.ca/content.php?152-Deploying-Add-ins-in-a-Network-Environment</a>.</p>\n\n<p>One users computer is causing trouble for me.  I install as directed, specifically when asked, I say \"NO\" to copying the file to the local user's folder.  Initially the add-in appears to have installed and work properly.  However, upon restarting Excel, I find that in fact, Excel gives the error message stating the add-in is missing and has a file path to the local users folder.  I have tried multiple times to the same outcome.</p>\n\n<p>On other users PC's (win7 and win10 boxes) the file installs fine from the network and remains after a restart of Excel.  So far, the issue appears to be isolated to one user's PC.  He is on windows 10 and excel 2016.  </p>\n\n<p>Has anyone encountered this?  To me seems like a bug maybe?</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1544568082, "post_id": 53733390, "comment_id": 94320688, "body": "Don&#39;t use <code>ThisWorkbook</code>, that refers to the workbook the code is run from.  Try <code>For each cn in Workbooks(newFilePath).Connections</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1544575905, "post_id": 53733390, "comment_id": 94322671, "body": "To add to @BruceWayne&#39;s comment - you need to open the copy you just created before you can remove the connections from it."}, {"owner": {"reputation": 13, "user_id": 10145789, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FK7hAtCjc58/AAAAAAAAAAI/AAAAAAAAAbk/XGP8qCLz4ds/photo.jpg?sz=128", "display_name": "ShrewdOperator", "link": "https://stackoverflow.com/users/10145789/shrewdoperator"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544698503, "post_id": 53733390, "comment_id": 94372348, "body": "Thank you @BruceWayne - I changed &#39;ThisWorkbook&#39; to Workbooks and the connections in the original document remained so thank you for that. Tim, you&#39;re right it didn&#39;t remove the connections in the new copy. Do you know of any way of removing the connections without having to open the new document? Many Thanks :)"}], "owner": {"reputation": 13, "user_id": 10145789, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FK7hAtCjc58/AAAAAAAAAAI/AAAAAAAAAbk/XGP8qCLz4ds/photo.jpg?sz=128", "display_name": "ShrewdOperator", "link": "https://stackoverflow.com/users/10145789/shrewdoperator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544585015, "creation_date": 1544567702, "last_edit_date": 1544585015, "question_id": 53733390, "link": "https://stackoverflow.com/questions/53733390/create-copy-of-excel-workbook-and-remove-query-connections", "title": "Create Copy of Excel Workbook and Remove Query Connections", "body": "<p>Evening Everyone, </p>\n\n<p>I have a workbook that has power query connections and I'm looking to create and save a copy of that file and remove the query connections in the new file and keep the connections in the first file.</p>\n\n<p>This is the code so far which I've combined from the web:</p>\n\n<pre><code>Clone Copy()\nDim cn As WorkbookConnection\nDim qr As WorkbookQuery\nDim NewFilePath As String\n\n    NewFilePath = ThisWorkbook.Path &amp; \"\\Cloned_Workbook.xlsm\"\n\n    If VBA.Dir(NewFilePath) &lt;&gt; \"\" Then\n        MsgBox \"File With Same Name Exists already. Enter Different Name\"\n        End\n    End If\n\n    With ActiveWorkbook\n        .SaveCopyAs Filename:=NewFilePath\n        On Error Resume Next\n        For Each cn In ThisWorkbook.Connections\n    cn.Delete\nNext\nFor Each qr In ThisWorkbook.Queries\n    qr.Delete\n    Next\nEnd Sub\n</code></pre>\n\n<p>This removes the query connections from the existing file and keeps the connections in the copied file which is the opposite of what I'm looking for.</p>\n\n<p>Any help is much appreciated :)</p>\n\n<p>Shrew</p>\n"}, {"tags": ["c#", "vba", "ms-access", "loadlibrary", "unmanagedexports"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1544605777, "post_id": 53733123, "comment_id": 94331526, "body": "This all seems pretty wrong, I can detect at least 3 errors from here. Can&#39;t get UnmanagedExports to work on my machine, so I can&#39;t properly write up an answer since there might be even more to be found, but I can strongly recommend you just register the DLLs. If administrator rights or an installer is the problem, you can register them in HKCU instead of HKLM (doesn&#39;t require administrator access) and register them for a specific path (doesn&#39;t require access to C:\\Windows, can be on a network drive)"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1544614685, "post_id": 53733123, "comment_id": 94336903, "body": "These are standard DLL Hell errors, that&#39;s where unmanaged exports always get ugly quick.  The function you declared in VBA doesn&#39;t match the actual method that implements it.  We can&#39;t see the actual method, but it having an extra parameter would be the most typical cause.  Having an adversary relationship with the customer&#39;s IT staff is never a problem that should be solved in software."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1544612103, "post_id": 53741345, "comment_id": 94335434, "body": "That&#39;s 1 out of 3 errors I&#39;ve found. Still won&#39;t work. Remaining errors are at least: can&#39;t return reference types from unmanaged functions (should use an output parameter instead), object will probably not get unmarshalled after marshalling it this way. But as said, probably even more errors."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1544611760, "creation_date": 1544611760, "answer_id": 53741345, "question_id": 53733123, "link": "https://stackoverflow.com/questions/53733123/vba-error-49-and-error-424-when-calling-c-dll-from-access-vba-using-unmamagedex/53741345#53741345", "title": "VBA error 49 and error 424 when calling C# DLL from Access VBA using unmamagedexports", "body": "<p>Your declaration for the DLL is incomplete or missing <code>Data Type</code>. Change </p>\n\n<pre><code>Public Declare PtrSafe Function YOUR_DLL_OBJECT Lib \"NonRegisteredDLL.dll\" ()\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Public Declare PtrSafe Function YOUR_DLL_OBJECT Lib \"NonRegisteredDLL.dll\" () As Object\n</code></pre>\n\n<blockquote>\n  <p>Note</p>\n  \n  <p>Previous versions of Visual Basic allowed you to declare parameters As\n  Any, meaning that data of any data type could be used. Visual Basic\n  requires that you use a specific data type for all Declare statements.</p>\n</blockquote>\n\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/com-interop/walkthrough-calling-windows-apis\" rel=\"nofollow noreferrer\">read more here</a>\nand try again.</p>\n"}], "owner": {"reputation": 19, "user_id": 10718996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44fbf50cc8beffd9193121c65da708b?s=128&d=identicon&r=PG&f=1", "display_name": "D.DeWitty", "link": "https://stackoverflow.com/users/10718996/d-dewitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594625626, "creation_date": 1544566327, "last_edit_date": 1594625626, "question_id": 53733123, "link": "https://stackoverflow.com/questions/53733123/vba-error-49-and-error-424-when-calling-c-dll-from-access-vba-using-unmamagedex", "title": "VBA error 49 and error 424 when calling C# DLL from Access VBA using unmamagedexports", "body": "<p>In our environment our main application uses MS Access for a front-end. The back-ends are Access, MySQL and MariaDB. Some of the routines we need are only available in C# so we have to be able to call .NET dll routines from VBA. I did some testing with registered dlls (using RegASM) and it worked fine. However, for the installs on client machines, we really need to be able to get to the shared dlls WITHOUT registering them.</p>\n\n<p>I have been trying to get dynamically loaded libraries in MS Access VBA to work for a long time now. I thought I was close when I found this example: <a href=\"https://stackoverflow.com/questions/37074533/canonical-how-to-call-net-methods-from-excel-vba\">Canonical: How to call .NET methods from Excel VBA</a></p>\n\n<p>I typed in the example verbatim and built it using Visual Studio 2017 Community. Then I tried to run it in two different test environments. The first was a Windows 7 Pro (64 bit) box with MS Office Pro 2010 (32 bit). The second test box has Windows 10 Pro (64 bit) and MS Office 2016 Pro (64 bit). The result was the same on both, except for the error number/message. </p>\n\n<p>Here is the sample code from the above link (I hope reposting the snippet is not a breach of etiquette. I wanted to make this post easier to follow):</p>\n\n<pre><code>[ComVisible(true), ClassInterface(ClassInterfaceType.AutoDual)]\npublic class YOUR_MAIN_CLASS\n{\n    [return: MarshalAs(UnmanagedType.BStr)]\n    public string FN_RETURN_TEXT(string iMsg)\n    {\n\n        return \"You have sent me: \" + iMsg + \"...\";\n    }\n}\n\n\nstatic class UnmanagedExports\n{\n    [DllExport]\n    [return: MarshalAs(UnmanagedType.IDispatch)]\n    static Object YOUR_DLL_OBJECT()\n    {\n        return new YOUR_MAIN_CLASS();\n    }\n}\n</code></pre>\n\n<p>Here is the VBA code. The only difference is that I did not use the \"PtrSafe\" qualifier in the Access 2010 32 bit test, but I did use it for the Access 2016 64 bit Access test. I set the Visual Studio Platform Target to x86 for the test with 32 bit Access and to x64 for the 64 bit Access. Other than that, everything was the same. </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Declare PtrSafe Function LoadLibrary Lib \"kernel32\" _\n    Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As LongPtr\n\nPublic Declare PtrSafe Function YOUR_DLL_OBJECT Lib \"NonRegisteredDLL.dll\" ()\n\nPublic Sub TestLoad()\n\n    LoadLibrary (\"C:\\Users\\lab\\Documents\\Visual Studio 2017\\Projects\\NonRegisteredDLL\\NonRegisteredDLL\\bin\\Debug\\NonRegisteredDLL.dll\")\n\n    Dim mObj As Object\n\n\n' Error occurs on next line\nSet mObj = YOUR_DLL_OBJECT()\n\n\n    Debug.Print mObj.FN_RETURN_TEXT(\"Testing...\")\n\nEnd Sub\n</code></pre>\n\n<p>When the code is run, the errors always occur at the \"Set mObj\" line. </p>\n\n<p>In the Access 2010 32 bit test, the error is:</p>\n\n<p>Run-time error '49':\nBad DLL calling convention</p>\n\n<p>In the Access 2016 64 bit test, the error is:</p>\n\n<p>Run-time error '424':\nObject required</p>\n\n<p>On both tests, I ran DumpBin and the result seemed fine:</p>\n\n<pre><code>&gt;dumpbin nonregistereddll.dll /exports\n\nDump of file nonregistereddll.dll\n\nFile Type: DLL\n\n  Section contains the following exports for \\NonRegisteredDLL.dll\n\n    00000000 characteristics\n    5C0FF158 time date stamp Tue Dec 11 10:18:16 2018\n        0.00 version\n           0 ordinal base\n           1 number of functions\n           1 number of names\n\n    ordinal hint RVA      name\n\n          0    0 0000283E YOUR_DLL_OBJECT\n\n  Summary\n\n        2000 .reloc\n        2000 .rsrc\n        2000 .sdata\n        2000 .text\n\n&gt;\n</code></pre>\n\n<p>Based upon a few other posts here on stackoverflow, I also experimented with the CallingConvention parameter on the DllExport but the result was always the same. I was very surprised that I couldn't get the example to work as I had entered it directly from the other post and I double-checked to make sure it was copied correctly. Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "loops", "range"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1544565441, "post_id": 53732914, "comment_id": 94319740, "body": "Change the heading and use VLOOKUP()"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1544565609, "post_id": 53732914, "comment_id": 94319806, "body": "If it&#39;s a one-time thing copy the table and <code>paste special -&gt; transpose</code> may do the job"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1545147100, "post_id": 53733629, "comment_id": 94520601, "body": "thank you for the code above! the problem i&#39;m having is that this works great if all the columns line up. however, the example i provided was simplified. all the columns/data points aren&#39;t always lined up perfectly.  is there a way to get it to match the cell&#39;s content to the column heading, and if true, return that cell&#39;s value?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1545169767, "post_id": 53733629, "comment_id": 94531375, "body": "Thanks for the tick as it answers your question. much appreciated. Anything is possible. May I suggest starting a new question stating what you are after. Also give this link a read and see if you can answer your own question. If not I&#39;d be more than happy to help. <a href=\"https://stackoverflow.com/questions/52113901/finding-the-cell-reference-of-a-cells-find-function\" title=\"finding the cell reference of a cells find function\">stackoverflow.com/questions/52113901/&hellip;</a>"}], "tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": true, "score": 0, "last_activity_date": 1544580010, "last_edit_date": 1544580010, "creation_date": 1544569216, "answer_id": 53733629, "question_id": 53732914, "link": "https://stackoverflow.com/questions/53732914/how-to-get-vba-code-to-check-if-cell-value-matches-column-heading-and-return-val/53733629#53733629", "title": "How to get VBA code to check if cell value matches column heading and return value from another cell in the same row?", "body": "<p>I always find it good practice to <code>Dim</code> your <code>Workbook</code> and <code>Worksheet</code>. If you decide to expand you're already set.</p>\n\n<p>The following code will essentially transpose the data set, no matter how many questions.</p>\n\n<pre><code>Sub test()\n\n\nDim wbk As Workbook\nDim wks_1 As Worksheet\nDim wks_2 As Worksheet\n\n    Set wbk = ThisWorkbook\n    Set wks_1 = wbk.Sheets(\"Sheet1\")\n    Set wks_2 = wbk.Sheets(\"Sheet2\")\n\n    LastRow = wks_1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 1 To LastRow\n        wks_1.Cells(i, 1).Copy wks_2.Cells(1, i)\n        wks_1.Cells(i, 2).Copy wks_2.Cells(2, i)\n    Next i\n\n\nEnd Sub\n</code></pre>\n\n<p>It will copy the headers also. </p>\n\n<p>Firstly I want to know where the last row is, hence the <code>LastRow</code> code. Then we simply loop through all rows and transpose the data set.</p>\n\n<p>The reference <code>.Cells</code> in line <code>wks_1.Cells(i, 1).Copy wks_2.Cells(1, i)</code> always references <code>Row</code> then <code>Col</code>.</p>\n\n<p>Let me know how you go.</p>\n"}], "owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 53733629, "answer_count": 1, "score": 0, "last_activity_date": 1544580010, "creation_date": 1544565362, "question_id": 53732914, "link": "https://stackoverflow.com/questions/53732914/how-to-get-vba-code-to-check-if-cell-value-matches-column-heading-and-return-val", "title": "How to get VBA code to check if cell value matches column heading and return value from another cell in the same row?", "body": "<p>I've searched all over and can't seem to get this piece working.</p>\n\n<p>I have 2 worksheets. </p>\n\n<p>Sheet 1 contains the quiz question numbers and then the score for each corresponding q#.</p>\n\n<p>Sheet 2 contains each q# as column headings and I'd like for the VBA code to grab the score from the q# that corresponds to the right heading. </p>\n\n<p>For ex:</p>\n\n<p>Sheet 1</p>\n\n<pre><code>Question#      Score \n1               100\n2                90\n3                75\n4                95\n</code></pre>\n\n<p>Sheet 2</p>\n\n<pre><code>Q1    Q2    Q3   Q4 \n100   90    75   95\n</code></pre>\n\n<p>The column headings in Sheet 2 can be changed to simply say \"1\", \"2\", etc so there can be an exact match if that makes it easier. </p>\n\n<p>I found and played with this code but it copies the entire column if it finds a match which doesnt work:</p>\n\n<pre><code>Sub CopyDataDynamically()\nDim lr As Long, num As Long\nDim rng As Range\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nSet rng = Range(\"a2\")\nnum = Range(\"b2\").Value\nIf num = 1 Then\n    Range(\"B2:B\" &amp; lr).Copy\n    rng.Offset(0, num - 1).PasteSpecial xlPasteValues\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1544562917, "post_id": 53732308, "comment_id": 94318717, "body": "<a href=\"https://stackoverflow.com/a/15482073/3961708\">stackoverflow.com/a/15482073/3961708</a>"}, {"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1544564026, "post_id": 53732308, "comment_id": 94319177, "body": "This solution doesn&#39;t seem to work for me as when I change it to Dir(myFinalPath, vbDirectory)= &quot;&quot;, it returns saying &quot;Found it.&quot; when I know the folder doesn&#39;t exist yet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544565616, "post_id": 53732308, "comment_id": 94319808, "body": "What actually happens when your code runs?  You need something a little more complex if it&#39;s not just the last folder in the path which is missing - <code>CreateFolder</code> only creates one level: it will not create (eg) a missing parent folder. <a href=\"https://stackoverflow.com/questions/4407386/help-to-create-folder1-folder2-in-windows-using-vbscript-both-the-folders-not\" title=\"help to create folder1 folder2 in windows using vbscript both the folders not\">stackoverflow.com/questions/4407386/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544584490, "post_id": 53732308, "comment_id": 94324310, "body": "Add <code>Debug.Print myFinalPath</code> right before the <code>If</code> statement. Is the path exactly as you expect it? (To see the debug output, open the Immediate Window with CTRL+G in the VBEditor).  I just tried your code and it works correctly for me."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1544595709, "creation_date": 1544595709, "answer_id": 53737182, "question_id": 53732308, "link": "https://stackoverflow.com/questions/53732308/rename-attachment-and-save/53737182#53737182", "title": "Rename attachment and save", "body": "<p>According to my search, <code>fdObj.FolderExists()</code> can accept variables, like this:</p>\n\n<pre><code>Sub Test_File_Exist_FSO_Early_binding()\n'If you want to use the Intellisense help showing you the properties\n'and methods of the objects as you type you can use Early binding.\n'Add a reference to \"Microsoft Scripting Runtime\" in the VBA editor\n'(Tools&gt;References)if you want that.\n\n    Dim FSO As Scripting.FileSystemObject\n    Dim FilePath As String\n\n    Set FSO = New Scripting.FileSystemObject\n\n    FilePath = \"C:\\Users\\Ron\\test\\book1.xlsm\"\n\n    If FSO.FileExists(FilePath) = False Then\n        MsgBox \"File doesn't exist\"\n    Else\n        MsgBox \"File exist\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Reference from:</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/s9/win003.htm\" rel=\"nofollow noreferrer\">Test if Folder, File or Sheet exists or File is open</a></p>\n\n<p>You could save and rename attachment refer to the below link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15531093/save-attachments-to-a-folder-and-rename-them\">Save attachments to a folder and rename them</a></p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1544595726, "creation_date": 1544595726, "answer_id": 53737187, "question_id": 53732308, "link": "https://stackoverflow.com/questions/53732308/rename-attachment-and-save/53737187#53737187", "title": "Rename attachment and save", "body": "<p><em>Use function like this</em></p>\n\n<pre><code>Private Function CreateDir(FldrPath As String)\n    Dim Elm As Variant\n    Dim CheckPath As String\n\n    CheckPath = \"\"\n    For Each Elm In Split(FldrPath, \"\\\")\n        CheckPath = CheckPath &amp; Elm &amp; \"\\\"\n\n        If Len(Dir(CheckPath, vbDirectory)) = 0 Then\n            MkDir CheckPath\n            Debug.Print CheckPath &amp; \" Folder Created\"\n        End If\n\n        Debug.Print CheckPath &amp; \" Folder Exist\"\n    Next\nEnd Function\n</code></pre>\n\n<p><em>then call it</em> </p>\n\n<p><em>Example</em></p>\n\n<pre><code>    'Define Final Path\n    myFinalPath = myPath + Format$(NextFriday, \"yyyy-mm-dd\") + \"\\\" + JobArea + \"\\\"\n\n    CreateDir myFinalPath ' &lt;--- call call function \n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 53737187, "answer_count": 2, "score": 1, "last_activity_date": 1592723480, "creation_date": 1544562214, "last_edit_date": 1592723480, "question_id": 53732308, "link": "https://stackoverflow.com/questions/53732308/rename-attachment-and-save", "title": "Rename attachment and save", "body": "<p>I have emails with pdf attachments I would like to save automatically as they come into my inbox.  I have my code mostly written, I have tested that all the variables have the correct value, and they output the correct data; however, I'm not sure how to code the actual saving of the file.  </p>\n\n<p>The file will get renamed to the customer's address, which is extracted with my code below:</p>\n\n<pre><code>Sub EagleViewSaveAttachment()\n\n    'Define Variables\n    Dim sFileName As String\n    Dim varAddress As Variant\n    Dim City As Variant\n    Dim fdObj As Object\n    Dim NextFriday As Date\n    Dim JobArea As String\n    Dim JobCity As Variant\n    Dim myPath As String\n    Dim objAtt As Outlook.Attachment\n    Dim myFinalPath As String\n\n    'Set Variables\n    NextFriday = Date + 8 - Weekday(Date, vbFriday)\n    myPath = \"C:\\Users\\admin\\OneDrive\\Documents\\EagleView\\\"\n\n    Set myfolder = Outlook.ActiveExplorer.CurrentFolder\n    Set fdObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    'Loop through emails in folder\n    For i = 1 To myfolder.Items.Count\n        Set myitem = myfolder.Items(i)\n        msgtext = myitem.Body\n\n        'Search for Specific Text\n        delimitedMessage = Replace(msgtext, \"Address: \", \"###\")\n        delimitedMessage = Replace(delimitedMessage, \",\", \"###\")\n        varAddress = Split(delimitedMessage, \"###\")\n\n        'Assign the job address from email to variable\n        sFileName = varAddress(10)\n        JobCity = LTrim(varAddress(11))\n\n        'Define office area based on job city\n\n        If JobCity = \"Panama City\" Or JobCity = \"Mexico Beach\" Or JobCity = \"Panama City Beach\" Or JobCity = \"Lynn Haven\" Or JobCity = \"Port Saint Joe\" Then\n            JobArea = \"Panama\"\n        ElseIf JobCity = \"Daytona Beach\" Or JobCity = \"Port Orange\" Or JobCity = \"Deltona\" Or JobCity = \"Ormond Beach\" Or JobCity = \"Deland\" Then\n            JobArea = \"Daytona\"\n        ElseIf JobCity = \"Orlando\" Then\n            JobArea = \"Orlando\"\n        ElseIf JobCity = \"Jacksonville\" Then\n            JobAre = \"Jacksonville\"\n        Else\n            JobArea = LTrim(varAddress(11))\n        End If\n\n        'Define Final Path\n        myFinalPath = myPath + Format$(NextFriday, \"yyyy-mm-dd\") + \"\\\" + JobArea + \"\\\"\n\n        'Check if the path exists, if not create it\n        If fdObj.FolderExists(myFinalPath) Then\n            MsgBox \"Found it.\"\n        Else\n            fdObj.CreateFolder (myFinalPath)\n            MsgBox \"It has been created.\"\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>As of right now, what I am unable to do is get it to check if the directory <code>C:\\Users\\admin\\OneDrive\\Documents\\EagleView\\yyyy-mm-dd\\JobArea</code> already exists and to create it if it doesn't already exist.</p>\n\n<p>I'm fairly certain the problem lies in my usage of <code>fdObj.FolderExists(myFinalPath)</code> as it seems that doesn't accept variables.</p>\n"}, {"tags": ["excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544560276, "post_id": 53731887, "comment_id": 94317555, "body": "do you have errors in the sheet?"}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544560429, "post_id": 53731887, "comment_id": 94317633, "body": "Not that I know of or that have been brought to my attention. Can you recommend anything that I should be looking for?"}, {"owner": {"reputation": 211, "user_id": 10354858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc309abb1dd4b73110007e850653dbc?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/10354858/david-s"}, "edited": false, "score": 0, "creation_date": 1544560455, "post_id": 53731887, "comment_id": 94317638, "body": "Without the variables declared, variant types can change depending on how the data is treated. It looks like comparing a range value to a form control value."}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544561167, "post_id": 53731887, "comment_id": 94317958, "body": "Are you recomending declaring like below?      Dim i As Integer     Dim superColm As Integer     Dim sheetName As String     sheetName = Worksheets(Sheet2).Cells(1, i).Value     For i = 5 To 12     If sheetName = LCase(GUI.superCB.Value) Then     superColm = i     Exit For     Else     End If     Next i"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544562051, "post_id": 53732140, "comment_id": 94318320, "body": "David S I gave that a try and I am getting the same error (run time 13-Type mismatch) on the <code>iRange= worksheets(sheet2).cells(1,i).value</code>  What can we try next?     cells(1,i) is still showing type- variant/integer in the watch."}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544562264, "post_id": 53732140, "comment_id": 94318435, "body": "<code>GUI.superCB.value</code> is showing Type- variant/String in the watch."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544562696, "post_id": 53732140, "comment_id": 94318619, "body": "What is the actual value in the cell being referenced at the error? @Gman"}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544563318, "post_id": 53732140, "comment_id": 94318871, "body": "@ScottCraner it doesn&#39;t make it far enough to reference cells 5-12 (whom contain names).   I tried to past a snip, but no luck. The debug highlights <code>iRange = Worksheets(Sheet2).Cells(1, i).Value</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 1, "creation_date": 1544563424, "post_id": 53732140, "comment_id": 94318922, "body": "@Gman see Mathieu&#39;s answer.  we all missed it, but he got it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 2, "creation_date": 1544564233, "post_id": 53732140, "comment_id": 94319260, "body": "@Gman not that I care much for the +15, but why put the checkmark on an answer that admits being incorrect?"}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544565081, "post_id": 53732140, "comment_id": 94319603, "body": "@mathieuGuindon Please don&#39;t take this negatively but I think this was this answer that made me realize that my order of operations was incorrect. and was hopefully the root cause of my issue. I tried giving the check to both but it didn&#39;t work."}], "tags": [], "owner": {"reputation": 211, "user_id": 10354858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc309abb1dd4b73110007e850653dbc?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/10354858/david-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1544563528, "last_edit_date": 1544563528, "creation_date": 1544561363, "answer_id": 53732140, "question_id": 53731887, "link": "https://stackoverflow.com/questions/53731887/type-mismatch-when-comparing-two-strings/53732140#53732140", "title": "Type mismatch when comparing two strings", "body": "<p>This will be fixed with doing a check on the range object data type first.</p>\n\n<p><code>Worksheets(Sheet2).Cells(1, i).Value</code> is the range object. This can change data types every time the range is modified depending on how it is modified.</p>\n\n<p><code>LCase(GUI.superCB.Value)</code> This appears to be a form control. If the range is an integer, they cannot compare.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>Dim i As Integer\nDim iRange as String\n'Dim superColm As Integer\n`This is untested\nFor i = 5 To 12\niRange = Worksheets(sheet2).Cells(1, i).Text\nIf iRange = LCase(GUI.superCB.Value) Then 'problem line is right here\n    superColm = i\n    Exit For\nElse\nEnd If\nNext i\n</code></pre>\n\n<p>The idea is to first be sure that the data types are the same.</p>\n\n<p>You may need to use <code>.Text</code> or <code>.Value2</code> instead of <code>.Value</code> for the range. If it is possible that the range object will be <code>Empty</code> or <code>Nothing</code> , then you also need to check for those too.</p>\n\n<p>Edit: Changed <code>.Value</code> to <code>.Text</code>\nEdit2: This answer is incorrect.</p>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 10354858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc309abb1dd4b73110007e850653dbc?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/10354858/david-s"}, "edited": false, "score": 0, "creation_date": 1544563602, "post_id": 53732487, "comment_id": 94318981, "body": "The issue is <code>Worksheets</code> being used. I typically use <code>Sheets</code> instead. I didn&#39;t catch this difference."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 211, "user_id": 10354858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc309abb1dd4b73110007e850653dbc?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/10354858/david-s"}, "edited": false, "score": 0, "creation_date": 1544564050, "post_id": 53732487, "comment_id": 94319192, "body": "@DavidS <code>Worksheets</code>/<code>Sheets</code> makes no difference. The only difference is that <code>Sheets</code> can give you a <code>Chart</code> object, which is another kind of problem - you <b>should</b> use <code>Worksheets</code> if you&#39;re looking for a <code>Worksheet</code>. The problem is that a <code>Worksheet</code> object is being passed as a parameter... to retrieve <i>that very same worksheet</i> - the collection lookup isn&#39;t even needed in the first place, assuming <code>Sheet2</code> is a <code>Worksheet</code> and not a <code>String</code>."}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544564475, "post_id": 53732487, "comment_id": 94319365, "body": "Mathieu thank you for taking the time to write this us. I think i was able to catch most of what you were saying. Sadly, I think my issue was that I somehow moved my <code>iRange=</code> above where the variable was being set. I also changed the .value to a .text at the same time so that may have helped also. i will keep the error checking in mind for if it comes back.  Thank you all!"}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544564791, "post_id": 53732487, "comment_id": 94319498, "body": "@MathieuGuindon what do you recommend insted of <code>rows</code>?  <code>lastrow = Sheet2.Cells(Rows.Count, superColm).End(xlUp).Row</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544564934, "post_id": 53732487, "comment_id": 94319546, "body": "@Gman you do realize that <code>iRange=</code> is nowhere in your original question (that <code>iRange</code> error has nothing to do with your type mismatch), and that VBA seamlessly performs implicit type conversions all the time - no integer/string comparison will ever throw a type mismatch; <code>Empty</code> happily converts to an empty string for comparisons, and no worksheet cell will ever be <code>Nothing</code>. Anyway, beware of implicit <code>ActiveSheet</code> references. <code>Rows.Count</code> is one, and yes, <code>lastRow</code> would be a much better name for something that means &quot;the last row&quot;."}, {"owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544565656, "post_id": 53732487, "comment_id": 94319831, "body": "@MathieuGuindon Yes sir I know it wasn&#39;t in my original question. Like most things in my life I know just enough VBA to unknowingly back my self into a very dark corner. In my original Q I was trying the exact location indexers (correct term?) because at other times in this program I have had to do that because i have multiple workbooks open. I was truly throwing things at the wall hoping something would stick and took the above comments as &quot;well heck, they know more than me, cant believe I missed that."}, {"owner": {"reputation": 211, "user_id": 10354858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfc309abb1dd4b73110007e850653dbc?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/10354858/david-s"}, "reply_to_user": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "edited": false, "score": 0, "creation_date": 1544565657, "post_id": 53732487, "comment_id": 94319833, "body": "@Gman I don&#39;t want to confuse you. The whole <code>iRange</code> part of my answer is actually not helping in correcting the problem you originally had. This answer is the solution. However, I highly recommend using meaningful variable names. <code>iRange</code> was selected as it is the iterated range that cycles through your loop. For something like rows I usually do <code>rowCounter</code> or <code>lastRow</code> or <code>nextRow</code>. Just something to make it easier to read."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1544563519, "last_edit_date": 1544563519, "creation_date": 1544563077, "answer_id": 53732487, "question_id": 53731887, "link": "https://stackoverflow.com/questions/53731887/type-mismatch-when-comparing-two-strings/53732487#53732487", "title": "Type mismatch when comparing two strings", "body": "<p>A <code>String</code> can safely be compared against any other data type in VBA... <em>except</em> <code>Error</code>.</p>\n\n<p>Comparing a <code>Variant/Error</code> against anything will throw a <em>type mismatch</em> error.</p>\n\n<p>This code is implicitly accessing whatever <code>ActiveSheet</code> is:</p>\n\n<pre><code>chk.Caption = Cells(idx + 1, superColm) &amp; \"   \" &amp; idx\n</code></pre>\n\n<p><code>Cells</code> should be qualified with the specific <code>Worksheet</code> object you mean to work with. If the active sheet contains a value that can't be coerced into a <code>String</code> (e.g. <code>#VALUE!</code> or <code>#REF!</code>), that will throw a <em>type mismatch</em> error.</p>\n\n<blockquote>\n<pre><code>Worksheets(Sheet2).Cells(1, i).Value = ...\n</code></pre>\n</blockquote>\n\n<p>Here <code>Sheet2</code> is an <em>identifier</em>. The <code>Worksheets</code> indexer wants either an integer value, or a string. If <code>Sheet2</code> is the code name of a worksheet in <code>ThisWorkbook</code>, you don't need to dereference it from <code>Worksheets</code> - just use it:</p>\n\n<pre><code>Sheet2.Cells(1, i).Value = ...\n</code></pre>\n\n<p>The <code>Worksheet</code> class doesn't have a <em>default property</em>, so <code>Debug.Print Worksheets(Sheet2)</code> throws error 438 <em>object doesn't support this property or method</em> - and a subsequent member call like <code>.Cells(1, i)</code>, also throws a <em>type mismatch</em> error. If you don't have a <code>Sheet2</code> string variable holding a worksheet name, I suspect that's the bug you're having right now... which means everything above is just what's waiting to bite you :)</p>\n\n<p>If <code>Sheet2</code> <em>is</em> a string variable that contains a valid sheet name, you can use the <code>IsError</code> function to verify whether a <code>Variant</code> is a <code>Variant/Error</code>:</p>\n\n<pre><code>If Not IsError(Sheet2.Cells(1, i).Value) Then\n    ' value is safe to compare against a string\nElse\n    ' comparing the cell value to anything will throw error 13\nEnd If\n</code></pre>\n\n<p>Lastly, I would advise against using <code>Rows</code> as a global variable, since it's already a global-scope identifier (<code>[_Global].Rows</code>, implicitly referring to <code>ActiveSheet</code>). Now, renaming that variable with Find/Replace is going to be pretty hard to do without breaking your code: <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a>'s \"rename\" refactoring could probably help with doing that safely (disclaimer: I manage that OSS VBIDE add-in project).</p>\n"}], "owner": {"reputation": 13, "user_id": 10755906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acebab80f841de0a6b32c0de226952a6?s=128&d=identicon&r=PG&f=1", "display_name": "Gman", "link": "https://stackoverflow.com/users/10755906/gman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "accepted_answer_id": 53732487, "answer_count": 2, "score": 1, "last_activity_date": 1544563528, "creation_date": 1544560178, "last_edit_date": 1544561305, "question_id": 53731887, "link": "https://stackoverflow.com/questions/53731887/type-mismatch-when-comparing-two-strings", "title": "Type mismatch when comparing two strings", "body": "<p>I have the following code that is comparing a combobox on a userform(GUI) to a populated cell on sheet2 of my workbook and I am getting a \"type mismatch\" error. This was all working until another sub shifted some data into the cells being compared on sheet 2.</p>\n\n<p>My issue lies with <code>if Worksheets(sheet2).cells(1,i).value = LCase(GUI.superCB.Value) then</code></p>\n\n<p><code>Worksheets(sheet2).cells(1,i).value</code> Now shows up in the watch as a Variant/Integer which made me think that when the data was shifted it changed the \"style\" of that cell.</p>\n\n<pre><code>Private Sub NextButton_Click() ''' adds check boxes to frame\n\nDim i As Integer\n'Dim superColm As Integer\nFor i = 5 To 12\n    If Worksheets(Sheet2).Cells(1, i).Value = LCase(GUI.superCB.Value) Then 'problem line is right here\n        superColm = i\n        Exit For\n    Else\n    End If\nNext i\n\nNextButton.Visible = False\nsuperCB.Visible = False\n\nRun.Visible = True\nFrame1.Visible = True\n\n\n\n    Dim chk As Control\n    Dim idx As Integer\n\n    Dim lastrow As Integer\n    lastrow = Worksheets(Sheet2).Cells(Rows.Count, superColm).End(xlUp).Row\n\n    For idx = 1 To lastrow - 1\n        Set chk = GUI.Frame1.Controls.add(\"Forms.CheckBox.1\", idx, True)\n        'set chk = gui.Frame1.Controls.Add(\n        chk.Visible = True\n        chk.Left = 5\n        chk.Top = (idx - 1) * (chk.Height + 2)\n        chk.Caption = Cells(idx + 1, superColm) &amp; \"   \" &amp; idx\n    Next\n    With Me.Frame1\n        .ScrollBars = fmScrollBarsVertical\n            If lastrow &lt;= 10 Then\n                .ScrollHeight = .InsideHeight * 1.5\n            ElseIf lastrow &lt;= 15 Then\n                .ScrollHeight = .InsideHeight * 2.25\n            ElseIf lastrow &lt;= 20 Then\n                .ScrollHeight = .InsideHeight * 3\n            ElseIf lastrow &lt;= 25 Then\n                .ScrollHeight = .InsideHeight * 3.9\n            ElseIf lastrow &lt;= 30 Then\n                .ScrollHeight = .InsideHeight * 4.75\n            ElseIf lastrow &lt;= 35 Then\n                .ScrollHeight = .InsideHeight * 5.35\n            Else\n                .ScrollHeight = .InsideHeight * 6.25\n            End If\n        .ScrollWidth = .InsideWidth * 9\n    End With\nEnd Sub\n</code></pre>\n\n<p>If I have sheet 2 as the active sheet <code>Cells(1,i).value</code> will work however, I need to have sheet 2 hidden from the user in the end. With this working it makes me think that the cell style is not the issue.</p>\n\n<p>I have tried going to <code>Excel.Workbooks(\"Shawn_sch_v1.2.xlsm\").worksheets(sheet2).cells(1,i).value</code> and everything down to the base cells() hoping it was missing a sheet reference but nothing has helped.</p>\n"}, {"tags": ["excel", "vba", "file", "reference"], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 15, "user_id": 8462860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df46ec07a47e8eb9527b8a3a513de832?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Kriefall", "link": "https://stackoverflow.com/users/8462860/jonny-kriefall"}, "edited": false, "score": 0, "creation_date": 1544561215, "post_id": 53732095, "comment_id": 94317976, "body": "That was fast :-) Glad it helped!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1544561065, "creation_date": 1544561065, "answer_id": 53732095, "question_id": 53731705, "link": "https://stackoverflow.com/questions/53731705/error-message-when-trying-to-open-and-access-data-from-other-excel-documents-usi/53732095#53732095", "title": "Error message when trying to open and access data from other excel documents using VBA. OK allows program to resume. How do I avoid this issue?", "body": "<p>If macros in workbooks being opened by code are causing problems the execution of such macros can be disabled for the current macro session. This is similar to the setting in the Trust Center, but doesn't change that setting - it only changes it for the duration of code execution.</p>\n\n<p>Use the following line of code before opening any workbooks:</p>\n\n<pre><code>Application.AutomationSecurity = msoAutomationSecurityForceDisable\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8462860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df46ec07a47e8eb9527b8a3a513de832?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny Kriefall", "link": "https://stackoverflow.com/users/8462860/jonny-kriefall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53732095, "answer_count": 1, "score": 1, "last_activity_date": 1544561128, "creation_date": 1544559386, "last_edit_date": 1544561128, "question_id": 53731705, "link": "https://stackoverflow.com/questions/53731705/error-message-when-trying-to-open-and-access-data-from-other-excel-documents-usi", "title": "Error message when trying to open and access data from other excel documents using VBA. OK allows program to resume. How do I avoid this issue?", "body": "<p>I use the following code to open another workbook and pull data.</p>\n\n<pre><code>FileName = \"F:\\QA\\CMM\\CMM Job Results\\2-08533R\\Rev4\\F103223\\Excel Printouts\\2- 08533R_Rev4_\" &amp; i &amp; \"1.xls\"\nSet arc(i) = Workbooks.Open(FileName, True, True)\n</code></pre>\n\n<p>When I do this, the file opens and the following error message appears:</p>\n\n<blockquote>\n  <p>Unable to locate ReportINI sheet. Please make sure, ReportINI.xls is in the -xlstart- subdirectory of the -office- program.</p>\n</blockquote>\n\n<p>This is caused by a macro in the workbook I'm trying to open. All of the workbooks I would like to pull data from have macros.</p>\n\n<p>I want to access data from several Excel workbooks and reorganize it. Is there another way to access data from several unopened Excel workbooks without causing a script pause to answer this error message?</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1544560040, "post_id": 53731286, "comment_id": 94317441, "body": "I&#39;m honestly not sure why you&#39;d want this.  Excel works best with your current setup (the screenshot of &quot;What I have&quot;).  You could just filter for John Smith for example and see all of his comments.  Various other excel formulas and functions will expect a setup like you currently have as well in order to calculate properly.  Is there a specific reason you need to transform the data?"}, {"owner": {"reputation": 3, "user_id": 10777485, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zCIS9OoGibA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i2MRyiv2yahlCgPPp6nt3lBPJy5w/mo/photo.jpg?sz=128", "display_name": "Pickleweasel", "link": "https://stackoverflow.com/users/10777485/pickleweasel"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1544561367, "post_id": 53731286, "comment_id": 94318040, "body": "The initial project was to was map each cell value onto a fill-able PDF form. This part has since been completed as it only contained integers but the requirements have since changed to also include strings of text."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 0, "last_activity_date": 1544566671, "creation_date": 1544566671, "answer_id": 53733181, "question_id": 53731286, "link": "https://stackoverflow.com/questions/53731286/how-to-merge-text-string-based-on-value-of-another-column-in-vba/53733181#53733181", "title": "How to merge text string based on value of another column in VBA?", "body": "<pre><code>Sub Macro1()\n\n    Dim lngCount As Long\n    Dim lngLastRow As Long\n    Dim rng As Range, cll As Range\n    Dim str As String\n\n    With ActiveWorkbook.ActiveSheet.Sort\n        .SetRange Range(\"A1\").CurrentRegion\n        .Header = xlYes\n        .Apply\n    End With\n\n    lngLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    Set rng = Range(\"A2:A\" &amp; lngLastRow)\n\n    lngCount = 2\n    str = str &amp; Range(\"B2\").Value &amp; vbNewLine\n\n    For Each cll In rng\n        If cll.Value = cll.Offset(1, 0).Value Then\n            str = str &amp; cll.Offset(1, 1).Value &amp; vbNewLine\n        Else\n            Range(\"C\" &amp; lngCount &amp; \":C\" &amp; cll.Row).MergeCells = True\n            Range(\"C\" &amp; lngCount) = Left(str, Len(str) - 1)\n            str = cll.Offset(1, 1).Value &amp; vbNewLine\n            lngCount = cll.Row + 1\n        End If\n    Next\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10777485, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zCIS9OoGibA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i2MRyiv2yahlCgPPp6nt3lBPJy5w/mo/photo.jpg?sz=128", "display_name": "Pickleweasel", "link": "https://stackoverflow.com/users/10777485/pickleweasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1544564966, "accepted_answer_id": 53733181, "answer_count": 1, "score": -2, "last_activity_date": 1544566671, "creation_date": 1544557488, "last_edit_date": 1544557632, "question_id": 53731286, "link": "https://stackoverflow.com/questions/53731286/how-to-merge-text-string-based-on-value-of-another-column-in-vba", "closed_reason": "Needs more focus", "title": "How to merge text string based on value of another column in VBA?", "body": "<p>I'm new to VBA and MS Excel in general so pardon my ignorance. \nI am trying to make a macro that detects each unique Name in column A and merge all the Comments associated with the Name, in column B and having it delimited on a new line. </p>\n\n<p>The number of names and comments will vary which is why I was looking at a macro in VBA. Do I need to include SQL too to make it work? </p>\n\n<p>What I have:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pWswL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pWswL.png\" alt=\"https://i.stack.imgur.com/1RYgq.png\"></a></p>\n\n<p>What I want: </p>\n\n<p><a href=\"https://i.stack.imgur.com/qZW2C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qZW2C.png\" alt=\"https://i.stack.imgur.com/8EmOh.png\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1544560303, "post_id": 53731109, "comment_id": 94317570, "body": "Why is there an extra period in <code>If IsHighlighted(.L8) Then</code>? Also, what&#39;s the point of setting <code>L8</code> if you&#39;re going to use it as an iterable variable in your <code>For</code> loop?"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544562437, "post_id": 53731109, "comment_id": 94318517, "body": "@dwirony well I want to loop through every cell of the L8 range, if there is any other way of doing that I would be happy to implement that. The extra period is a mistake on my part I will correct it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1544563332, "post_id": 53731109, "comment_id": 94318877, "body": "Then that should be something like <code>For Each cell in L8</code> - also what is <code>BidL8</code>? You should put <code>Option Explicit</code> at the top of your module and make sure all your variables are declared."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544563801, "post_id": 53731109, "comment_id": 94319072, "body": "@dwirony BidL8 is the table in sheet1 as said in the question. The table has position against employee."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544565474, "post_id": 53731109, "comment_id": 94319754, "body": "That may be what you think it is, but right now in your current code <code>BidL8</code> is nothing - you have to declare it and <code>Set</code> it to something."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544567000, "post_id": 53731109, "comment_id": 94320346, "body": "@dwirony Sorry! error while typing the question. Now it would make much more sense."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544631738, "post_id": 53735865, "comment_id": 94346958, "body": "Hey I tried to implement the code but it is giving me the error: Object doesn&#39;t support this property or method. I have updated the question to show my corrected code. Thank you for your help!"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544634268, "post_id": 53735865, "comment_id": 94348327, "body": "The Evaluate function"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1544587230, "creation_date": 1544587230, "answer_id": 53735865, "question_id": 53731109, "link": "https://stackoverflow.com/questions/53731109/match-a-value-from-the-table-to-a-dropdown-range/53735865#53735865", "title": "Match a value from the table to a dropdown range", "body": "<p>From the comments, I think this is what you are trying to do.<br>\n(I renamed some variables to make them a little easier to understand. Also, adjust the named ranges as needed. They may not all be on the \"OT_Table\" sheet, which I assumed they were. It wasn't clear.)</p>\n\n<pre><code>Sub AssignBided()\nDim ws As Worksheet\nSet ws = Worksheets(\"OT_Table\")\nDim cel As Range\n\nDim line8 As Range\nSet line8 = ws.Range(\"Line8_Highlight_Mon\")\n\nDim Offemp As Range\nSet Offemp = ws.Range(\"Scheduled_Off\")\n\nDim BidL8 As Range\nSet BidL8 = ws.Range(\"BidedL8_T\")\n\nDim coresVal As String\nFor Each cel In line8\n    ' cel.Select\n    If IsHighlighted(cel) Then\n        If Application.WorksheetFunction.CountIf(Offemp, cel.Value) &gt; 0 Then\n            coresVal = Evaluate(\"INDEX(OFFSET(\" &amp; BidL8.Address &amp; \",,2),MATCH(\" &amp; _\n                cel.Value &amp; \",\" &amp; BidL8.Address &amp; \",0))\")\n            Debug.Print coresVal\n            cel.Offset(0, 2).Value = coresVal\n        End If\n    End If\nNext cel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 53735865, "answer_count": 1, "score": 0, "last_activity_date": 1581005913, "creation_date": 1544556693, "last_edit_date": 1581005913, "question_id": 53731109, "link": "https://stackoverflow.com/questions/53731109/match-a-value-from-the-table-to-a-dropdown-range", "title": "Match a value from the table to a dropdown range", "body": "<p>I have been trying this for a while now and am not able to figure out the <code>for</code> code for this problem.\nI have a table in sheet1 with two columns, in one column I have positions, in the next I have people who can work on those positions.\nIn sheet2 I have the list of all the positions and the one that are supposed to be staffed are highlighted when you select a SKU, and two columns besides it is the dropdown list of the employees.\nThis same sheet also has a range which displays employee who are not working that day.\nTried to implement @BruceWayne answer the code is:</p>\n\n<pre><code>  Option Explicit\n'use a constant to store the highlight color...\nConst HIGHLIGHT_COLOR = 9894500 'RGB(100, 250, 150)\n\nSub AssignBided()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim cel1 As range\nDim cel2 As range\nDim line8 As range\nDim Offemp As range\nDim BidL8 As range\nDim BidL8E As range\nDim coresVal As String\n\nSet ws1 = Worksheets(\"OT_Table\")\nSet ws2 = Worksheets(\"Monday\")\nSet line8 = ws2.range(\"Line8_Hilight_Mon\")\nSet Offemp = ws2.range(\"Off_Mon\")\nSet BidL8 = ws1.range(\"BidedL8\")\nSet BidL8E = ws1.range(\"BidedL8_E\")\n\nFor Each cel2 In BidL8E\n    For Each cel1 In line8\n        If IsHighlighted(cel1) Then\n            If Application.WorksheetFunction.CountIf(Offemp, cel2.Value) &gt; 0 Then\n                coresVal = Evaluate(\"Index(\" &amp; BidL8E.Address &amp; \"),MATCH(\" &amp; cel1.Validation &amp; \",\" &amp; BidL8.Address &amp; \",0))\")\n                Debug.Print coresVal\n                cel1.Offset(0, 2).Value = coresVal\n            End If\n        End If\n    Next cel1\nNext cel2\nEnd Sub\n\n'Is a cell highlighted? EDIT: changed the function name to IsHighlighted\nFunction IsHighlighted(c As range)\n    IsHighlighted = (c.Interior.Color = HIGHLIGHT_COLOR)\nEnd Function\n</code></pre>\n\n<p>This code is giving me this error: Object doesn't support this property or method. It highlights the <code>evaluate</code> line. Am I using this in some wrong manner?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 1, "creation_date": 1544557092, "post_id": 53731053, "comment_id": 94316048, "body": "Are you calling the function from a worksheet formula?"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 1, "creation_date": 1544557357, "post_id": 53731053, "comment_id": 94316184, "body": "I wouldn&#39;t do the <code>With Worbooks.Open(...</code> thing. Go back to setting a variable and then try to figure out why the variable is not getting set."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544558148, "post_id": 53731053, "comment_id": 94316554, "body": "You open the workbook but never close it...  It will not close itself just because it goes out of scope."}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "edited": false, "score": 0, "creation_date": 1544560405, "post_id": 53731053, "comment_id": 94317621, "body": "The workbook I am unable to close is the one I am working in. The workbook I am opening via code is a different workbook that never gets opened at all"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1544560639, "post_id": 53731053, "comment_id": 94317717, "body": "Please let us know <i>how you call your function</i>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1544566185, "post_id": 53731053, "comment_id": 94320014, "body": "If you&#39;re calling this function from a worksheet cell it will not work: there are restrictions on what a function called from a cell can do.  Opening other workbooks would be something not &quot;allowed&quot; in this context.  See:  <a href=\"https://support.microsoft.com/en-nz/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-nz/help/170787/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "edited": false, "score": 0, "creation_date": 1544570613, "post_id": 53731053, "comment_id": 94321453, "body": "Tim - I did not know this. That seems very likely to be the problem. Unfortunately, I really need to be able to insert this function into the worksheet&#39;s cells since the arguments are not always going to be in the same place and the user needs to be able to easily specify them without having to write more code. Is there any kind of workaround that would allow me to open this workbook another way? Like maybe using the function to call a sub that opens the workbook?"}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "edited": false, "score": 0, "creation_date": 1544571179, "post_id": 53731053, "comment_id": 94321603, "body": "Tim - actually I just stumbled across your own posted question from years ago outlining your approach to the workaround. Thanks for the help, I&#39;ll try your approach and see what happens! Link to your question: <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet\" title=\"using a udf in excel to update the worksheet\">stackoverflow.com/questions/23433096/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544631701, "post_id": 53731053, "comment_id": 94346938, "body": "That might work.  In gneral it might be worth trying to cache the data in an array after the first call, so that every recalculation doesn&#39;t need to open/close the other workbook"}], "owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544570133, "creation_date": 1544556493, "last_edit_date": 1544570133, "question_id": 53731053, "link": "https://stackoverflow.com/questions/53731053/vba-workbooks-open-is-stuck-in-a-loop-must-be-force-closed", "title": "VBA - Workbooks.Open is stuck in a loop, must be force closed", "body": "<p>I am trying to open a workbook so I can read data from it and populate fields in another worksheet. When I run the code, it isn't detecting the workbook or opening it. The workbook is on a shared drive and must be opened read only.</p>\n\n<p>When I tried to set \"wb\", a workbook variable, <code>set wb = Workbooks(\"filepath\")</code>, when debugging it is showing wb = Empty.</p>\n\n<p>I changed the code slightly to use a With statement instead, but still have the same problem. The code jumps from the <code>With Workbooks.Open</code> to the line below, then back and forth between the two forever, not allowing me to close the workbook.</p>\n\n<p>I eventually have to force close and reopen the file. I can break the code, but it immediately starts the function again without giving me a chance to save or close the workbook. Code below, please help me understand what is happening.</p>\n\n<p>[EDIT]: When I first manually open the parts book, then replace the <code>Workbooks.Open</code> line with this code: <code>Set wb = Workbooks(\"New Parts Book - Official.xlsx\")</code> and type the function into a cell, I have no issues and it works just fine (also requires declaration <code>Dim wb as Workbook</code>). The cell formula looks like this: <code>=Lookup_By_PN([@[Part Number]],\"name\")</code> where the part number argument is coming from a named table column on the same row as the function cell.</p>\n\n<pre><code>Function Lookup_By_PN(ByVal PN As String, Optional ByVal returnField As String = \"Price\") As Variant\nDim vCell As Variant, result As Variant\nresult = \"\"\nWith Workbooks.Open(Filename:=\"Z:\\Shared\\Materials\\Parts Book\\New Parts Book - Official.xlsx\", UpdateLinks:=0, ReadOnly:=1)\nFor Each vCell In .Sheets(\"PARTS BOOK\").Range(\"$F$260:$F$3872\")\n    With vCell\n        If InStr(1, .Value2, PN, vbTextCompare) &gt; 0 Then\n            Select Case True\n                Case InStr(1, returnField, \"Price\", vbTextCompare) &gt; 0\n                    If IsNumeric(.Offset(, 3).Value2) Then\n                        result = .Offset(, 3).Value2\n                    Else\n                        result = .Offset(, 2).Value2\n                    End If\n                Case InStr(1, returnField, \"Name\", vbTextCompare) &gt; 0\n                    result = .Value2\n                Case InStr(1, returnField, \"Size\", vbTextCompare) &gt; 0\n                    Dim quotePosR As Integer, spacePosL As Integer\n                    quotePosR = InStr(1, .Value2, \"\"\"\", vbTextCompare)\n                    spacePosL = InStrRev(.Value2, \" \", quotePosR, vbBinaryCompare)\n                    result = Evaluate(Replace(Mid(.Value2, spacePosL + 1, quotePosR - spacePosL - 1), \"-\", \"+\", compare:=vbTextCompare))\n                Case InStr(1, returnField, \"Type\", vbTextCompare) &gt; 0\n                    result = .Offset(, -2).Value2\n                Case Else\n                    result = \"Not Found\"\n            End Select\n        End If\n    End With\nNext vCell\nEnd With\n    Lookup_By_PN = result\nEnd Function\n</code></pre>\n"}, {"tags": ["ios", "excel", "vba", "add", "ole"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544556049, "post_id": 53730922, "comment_id": 94315600, "body": "with <code>Dim oTB, obj As Object</code>, <code>oTB</code> is set as variant not object: <code>Dim oTB as Object, obj As Object</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544556681, "post_id": 53730922, "comment_id": 94315869, "body": "@ScottCraner that&#39;s correct and a good thing to point out and for the OP to fix, but the variant is <code>Set</code>-assigned, so the runtime type after the assignment is <code>Variant&#47;Object</code>, which is fine. <a href=\"https://support.office.com/en-us/article/enable-or-disable-activex-settings-in-office-files-f1303e08-a3f8-41c5-a17e-b0b8898743ed\" rel=\"nofollow noreferrer\">Is ActiveX enabled</a> (or even supported, on iOS)?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544556782, "post_id": 53730922, "comment_id": 94315911, "body": "@MathieuGuindon sorry, yes, meant to put, that was not the problem, but a recommendation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1544556891, "post_id": 53730922, "comment_id": 94315958, "body": "A worksheet is literally <i>made</i> of thousands of little textboxes (cells). Have you considered <i>not</i> using a <code>TextBox</code> control, and naming a specific [merged?] range instead, nicely formatted, with borders and shading?"}, {"owner": {"reputation": 3, "user_id": 5525768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7889c52a227f6328d9da86802867f9?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice Cinque", "link": "https://stackoverflow.com/users/5525768/maurice-cinque"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544566736, "post_id": 53730922, "comment_id": 94320238, "body": "Thank you all for answers. @MathieuGuindon Spreadsheet is 2D table with has various content including both short &amp; large fields (larger than max height in Excel). Table is generated by an external system. For easy reading, filterring, sorting, i set fixed height for all rows (single line). For multiline columns,  Upon selection, I create on the fly a well positionned text box with horizontal+vertical scrollbars. This allows easy reading of a cell without destroying table formatting. I use worksheet_selection_change event. Boxes are deleted when selection changes."}, {"owner": {"reputation": 3, "user_id": 5525768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7889c52a227f6328d9da86802867f9?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice Cinque", "link": "https://stackoverflow.com/users/5525768/maurice-cinque"}, "edited": false, "score": 1, "creation_date": 1544566894, "post_id": 53730922, "comment_id": 94320305, "body": "While writing, I think I found a workaround. Instead of creating on the fly the textbox. I could simply create once the textbox and just move its position upon selection change."}, {"owner": {"reputation": 3, "user_id": 5525768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7889c52a227f6328d9da86802867f9?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice Cinque", "link": "https://stackoverflow.com/users/5525768/maurice-cinque"}, "edited": false, "score": 0, "creation_date": 1544639699, "post_id": 53730922, "comment_id": 94351194, "body": "After several tests, it appears any OLE method or property is failing on iOS. Finally, I removed the OLE object and used instead a simple rectangle shape with the AutoFit to text option."}], "owner": {"reputation": 3, "user_id": 5525768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7889c52a227f6328d9da86802867f9?s=128&d=identicon&r=PG&f=1", "display_name": "Maurice Cinque", "link": "https://stackoverflow.com/users/5525768/maurice-cinque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544555815, "creation_date": 1544555815, "question_id": 53730922, "link": "https://stackoverflow.com/questions/53730922/inserting-a-textbox-causes-1004-error-on-ios-while-works-on-windows-10", "title": "Inserting a TextBox causes 1004 error on iOS while works on Windows 10", "body": "<p>I use a VBA macro for Excel (Office 365) that creates dynamically a text box. It works perfectly on Windows 10 but fails on iOS (Office 365 too).</p>\n\n<p>Below I isolated the sample code where function <strong>ActiveSheet.OLEObjects.Add</strong> fails on iOS with the following error message: <em>execution error 1004. Cannot insert object</em></p>\n\n<p><em>Any hint is welcome</em></p>\n\n<pre><code>Sub AddTextBox()\n     Dim oTB, obj As Object\n     Set oTB = ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.TextBox.1\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544558336, "post_id": 53730914, "comment_id": 94316655, "body": "Is <code>Option Explicit</code> specified? What is <code>Row</code>?"}, {"owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544558842, "post_id": 53730914, "comment_id": 94316877, "body": "Row refers to another public variable from a previous form, the code above the for loop does appear to work, the loop is where the error is occurring. I&#39;ve added option explicit to the top but now I&#39;m getting an error saying &#39;invalid inside procedure&#39;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544558903, "post_id": 53730914, "comment_id": 94316898, "body": "So, which line is throwing the error specifically?"}, {"owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544558960, "post_id": 53730914, "comment_id": 94316928, "body": "Unfortunately I&#39;m not sure which line is causing the error :( just know it&#39;s somewhere in the for loop."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544558997, "post_id": 53730914, "comment_id": 94316945, "body": "That would be the line that&#39;s highlighted when you hit &quot;Debug&quot; when the error pops up. Make sure the VBE options are configured to &quot;break on all errors&quot;."}, {"owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544559518, "post_id": 53730914, "comment_id": 94317214, "body": "Thanks for the tip, debug wasn&#39;t showing for me but after selecting &#39;break on all errors&#39; it did, and apparently the error came from the LoggedInTxt = Row.Offset(0,-3) line. I moved that entire &#39;sign in details&#39; code below the for loop code and there now seems to be no error. However when I run the code the checkbox is not checked as expected, any idea why? thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544559573, "post_id": 53730914, "comment_id": 94317235, "body": "Feel free to <a href=\"https://stackoverflow.com/posts/53730914/edit\">edit</a> your post with the new info :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544559769, "post_id": 53730914, "comment_id": 94317317, "body": "Assuming <code>LoggedInTxt</code> is a control on the form, that&#39;s an implicit default member call on both sides of the <code>=</code> operator. <code>LoggedInTxt.Value = Row.Offset(0, -3).Value</code> would be more explicit. But it looks like <code>Row</code> might be <code>Nothing</code> when the form instance is initialized. Mixing in global state is probably a bad idea. Use parameters, and don&#39;t store state in the form&#39;s default instance - <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">don&#39;t show the default instance</a>, too."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544560574, "post_id": 53730914, "comment_id": 94317689, "body": "Now you&#39;re searching for <code>BNumberTxt</code> before you&#39;ve set its value from <code>Row</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544566018, "post_id": 53730914, "comment_id": 94319944, "body": "It would help to add the code where you set the global <code>Row</code> and launch the form."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 6, "creation_date": 1546608073, "post_id": 53730914, "comment_id": 94914506, "body": "You got some pretty solid answers. Vandalizing your post will lose useful replies and is very disrespectful towards the people who took the time to try to help you. The content you submitted when you posted this question was transferred to the ownership of Stack Overflow when you asked this question."}, {"owner": {"reputation": 154038, "user_id": 462627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0285ad1973e938e2d2f40254c247f6f?s=128&d=identicon&r=PG", "display_name": "Praveen Kumar Purushothaman", "link": "https://stackoverflow.com/users/462627/praveen-kumar-purushothaman"}, "edited": false, "score": 0, "creation_date": 1546609142, "post_id": 53730914, "comment_id": 94915017, "body": "I rolled back your latest edit because it rendered the code invalid. The effort to make the code shorter would be welcome per se, but you need to take care to not introduce errors, and also make sure it doesn&#39;t make the answer harder to understand (which will often be the case when the answer was in response to an earlier version of the code)."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "edited": false, "score": 0, "creation_date": 1544566891, "post_id": 53732119, "comment_id": 94320304, "body": "This look great! Thank you! I&#39;m just slightly confused as to how to fix the row part? It&#39;s a public variable and the row value comes from a previous for loop from another form."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "edited": false, "score": 0, "creation_date": 1544567679, "post_id": 53732119, "comment_id": 94320561, "body": "Hence my comment above to add that code to your question - I can&#39;t suggest how to fix that without seeing the code where you set the value."}, {"owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "edited": false, "score": 0, "creation_date": 1544570152, "post_id": 53732119, "comment_id": 94321302, "body": "Apologies I misunderstood, have added the code now :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "edited": false, "score": 0, "creation_date": 1544570399, "post_id": 53732119, "comment_id": 94321388, "body": "Where is your <code>Row</code> global declared?"}, {"owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "edited": false, "score": 0, "creation_date": 1544570654, "post_id": 53732119, "comment_id": 94321469, "body": "It&#39;s in a module, and under General and Declarations it&#39;s declared as &#39;Public Row as Range&#39;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "edited": false, "score": 0, "creation_date": 1544571229, "post_id": 53732119, "comment_id": 94321621, "body": "Change it to something more distinctive like <code>gUserRow</code> and set it explicitly from your login - something like <code>MsgBox &quot;Welcome&quot;:Set gUserRow = Row</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1544561248, "creation_date": 1544561248, "answer_id": 53732119, "question_id": 53730914, "link": "https://stackoverflow.com/questions/53730914/for-each-code-not-making-check-box-value-true/53732119#53732119", "title": "For each code not making check box value true", "body": "<p>Once you fix your problem with the <code>Row</code> global, you can do something like this:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim shtData As Worksheet\n    Dim Year2CourseRange As Range, HeaderRange As Range, m, c As Range\n\n    Set shtData = ThisWorkbook.Sheets(\"Year2\")\n    With shtData\n        Set Year2CourseRange = .Range(\"A:A\")\n        Set HeaderRange = .Range(.Range(\"B2\"), .Cells(2, 500).End(xlToLeft))\n    End With\n\n    'you'll need to fix this part....\n    BNumberTxt = Row.Offset(0, -7)\n    'etc\n\n    'find a matching row: Match() is a good approach here\n    m = Application.Match(BNumberTxt, Year2CourseRange, 0)\n\n    'loop over all the column headers\n    For Each c In HeaderRange.Cells\n        'Assumes all checkboxes are named \"CHK[ColumnHeaderHere]\"\n        With Me.Controls(\"CHK\" &amp; c.Value)\n            If IsError(m) Then\n                .Value = False  'clear all if no match\n            Else\n                .Value = (UCase(shtData.Cells(m, c.Column)) = \"X\") 'set if \"x\"\n            End If\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1544655652, "creation_date": 1544655652, "answer_id": 53752703, "question_id": 53730914, "link": "https://stackoverflow.com/questions/53730914/for-each-code-not-making-check-box-value-true/53752703#53752703", "title": "For each code not making check box value true", "body": "<h1>Ranges and Ranges</h1>\n\n<p>This is your code squashed a little bit and below is your data:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nSet Year2CourseRange = Sheets(\"Year2\").Range(\"A:A\")\nFor Each RowYear2 In Year2CourseRange.Cells\n    If RowYear2.Value = BNumberTxt Then\n        If RowYear2.Offset(0, 1) = \"x\" Then\n            Me.CHKSBB005.value = True\n        Else: Me.CHKSBB005.value = False: End If\n    ElseIf IsEmpty(RowYear2) Then\n        Exit For: End If: Next RowYear2\n  LoggedInTxt = Row.Offset(0, -3): BNumberTxt = Row.Offset(0, -7)\n  CourseTxt = Row.Offset(0, -1): CourseNumTxt = Row.Offset(0, -2): End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/R1B8B.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R1B8B.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Take a look for a while, you might see the error yourself.</p>\n\n<h2>The CheckBox Tick Mystery</h2>\n\n<p>When you write <code>Range(\"A:A\")</code> that refers to the whole column including <code>Range(\"A1\")</code> which appears to be <code>EMPTY</code>. The code never even enters the If <code>RowYear2.Offset...</code> line but exits via the  <code>ElseIf</code> line.</p>\n\n<h2>The Row Variable</h2>\n\n<p>I hate the idea of declaring a variable <code>Row</code>. But it is valid. Since there is an <code>Offset</code> involved, <code>Row</code> should be a range, probably a cell. As in the comments indicated, it has to 'survive' from another UserForm let's say <code>UserFormX</code>. If it has 'survived' you have to refer to it like this: </p>\n\n<pre><code>UserFormX.Row\n</code></pre>\n\n<p>or you have to declare it in a 'not-object' module to use only <code>Row</code>.</p>\n\n<h2>Another EnterBtn_Click</h2>\n\n<p>Probably useless now but here is the code I worked on the other day:</p>\n\n<pre><code>Option Explicit\n\nPublic intAttempts As Integer\n\nPrivate Sub CancelBtn_Click()\n  Unload Me\nEnd Sub\n\nPrivate Sub EnterBtn_Click()\n\n    Const strEmail = \"Please enter email address.\"   ' Email Input Message\n    Const strPassword = \"Please enter a password.\"   ' Password Input Message\n    Const strLoginCorrect = \"Welcome\"                ' Correct Login Message\n    Const strLoginIncorrect = \"Incorrect Login.\"     ' Incorrect Login Message\n    Const strAttempts = \"Too many login attempts.\"   ' Login Attempts Message\n\n    ' Use worksheet name or index e.g. \"SInfo\" or 1.\n    Const vntWsName As String = \"StudentInformation\" ' Worksheet\n    ' Use column letter or column number e.g. \"F\" or 6.\n    Const vntEmailColumn As Variant = \"F\"            ' Email Column\n    Const intFirstRow As Integer = 2                 ' Email Column First Row\n    Const intPasswordColumnOffset As Integer = -4    ' Password Column Offset\n    Const intMaxAttempts As Integer = 3              ' Maximum Login Attempts\n\n    Dim lngCounter As Long                           ' Email Column Row Counter\n    Dim lngLastrow As Long                           ' Email Column Last Row\n\n    ' Check number of login attempts.\n    If intAttempts &gt;= intMaxAttempts Then\n        MsgBox strAttempts\n        Exit Sub\n    End If\n\n    ' Show annoying text messages if nothing was entered.\n    If Me.EmailTxt.Text = \"\" Then\n        Me.EmailTxt.Text = strEmail: Exit Sub\n      ElseIf Me.EmailTxt.Text = strEmail Then Exit Sub\n    End If\n    If Me.PasswordTxt.Text = \"\" Then\n        Me.PasswordTxt.Text = strPassword: Exit Sub\n      ElseIf Me.PasswordTxt.Text = strPassword Then Exit Sub\n    End If\n\n    ' Check for data in specified worksheet.\n    With ThisWorkbook.Worksheets(vntWsName)\n\n        ' Determine last row of data in Email Column.\n        lngLastrow = .Cells(Rows.Count, vntEmailColumn).End(xlUp).Row\n\n        For lngCounter = intFirstRow To lngLastrow\n            ' Ceck for email in Email Column.\n            If UCase(.Cells(lngCounter, vntEmailColumn).Value) _\n                    = UCase(EmailTxt.Text) Then ' Correct email.\n                ' Check if correct password in Password Column\n                If UCase(.Cells(lngCounter, vntEmailColumn) _\n                        .Offset(0, intPasswordColumnOffset).Value) _\n                        = UCase(PasswordTxt.Text) Then ' Correct password.\n                    Exit For\n                  Else ' Wrong password. Set \"counter\" to \"end\".\n                    ' Faking that the loop was not interrupted.\n                    lngCounter = lngLastrow\n                End If\n'              Else ' Wrong Email. Do nothing. Not necessary.\n            End If\n        Next\n        ' When the loop wasn't interrupted, \"lngcounter = lnglastrow + 1\".\n\n    End With\n\n    ' Check if loop was NOT interrupted.\n    If lngCounter = lngLastrow + 1 Then ' Loop was NOT interrupted.\n        intAttempts = intAttempts + 1\n        MsgBox strLoginIncorrect\n      Else ' Loop was interrupted. Correct email and password.\n        MsgBox strLoginCorrect\n        Unload Me\n        NewForm.Show\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10765289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438376d49077f70cf73f82a4ad72687e?s=128&d=identicon&r=PG&f=1", "display_name": "SarahL500", "link": "https://stackoverflow.com/users/10765289/sarahl500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1546609121, "creation_date": 1544555757, "last_edit_date": 1546609121, "question_id": 53730914, "link": "https://stackoverflow.com/questions/53730914/for-each-code-not-making-check-box-value-true", "title": "For each code not making check box value true", "body": "<p>I am trying to create code that runs through a list of user ID's (B Numbers) and then when it finds the corresponding ID it checks to see if there's an X in the column directly next to it for a certain subject named SBB005 <a href=\"https://i.stack.imgur.com/y4NOc.png\" rel=\"nofollow noreferrer\">See image</a>. If there is an X, I want the check box value to be true. The for each loop ends when it reaches a blank cell.</p>\n\n<p>I have declared the 'RowYear2' and 'Year2CourseRange' ranges as public variables, and when running the code, nothing happens and the check box remains unticked! Any idea why the checkbox isn't being ticked as expected?</p>\n\n<p>I am planning on setting up multiple checkboxes once this is working for all the subjects in each column:\n<a href=\"https://i.stack.imgur.com/y4NOc.png\" rel=\"nofollow noreferrer\">See image</a></p>\n\n<p>Hoping that someone can help me to get this working or may even introduce an easier way to do so for another 20 checkboxes!</p>\n\n<p>Many thanks :)</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nSet Year2CourseRange = Sheets(\"Year2\").Range(\"A:A\")\n\nFor Each RowYear2 In Year2CourseRange.Cells\n    If RowYear2.Value = BNumberTxt Then\n        If RowYear2.Offset(0, 1) = \"x\" Then\n            Me.CHKSBB005.value = True\n        Else\n            Me.CHKSBB005.value = False\n        End If\n    ElseIf IsEmpty(RowYear2) Then\n        Exit For\n    End If\nNext RowYear2\n\nLoggedInTxt = Row.Offset(0, -3)\nBNumberTxt = Row.Offset(0, -7)\nCourseTxt = Row.Offset(0, -1)\nCourseNumTxt = Row.Offset(0, -2)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub EnterBtn_Click()\n\nDim LIMatch As Boolean\nDim Win As Boolean\n\nEmail = Me.EmailTxt\nPassword = Me.PasswordTxt\n\nSet UserRange = Sheets(\"StudentInformation\").Range(\"H:H\")\n\nFor Each Row In UserRange.Cells\n    If Me.EmailTxt = \"\" And Me.PasswordTxt = \"\" Then\n        MsgBox (\"Please enter an email and password\")\n        LIMatch = False\n        Win = True\n    Exit For\n    ElseIf Me.EmailTxt = \"\" Then\n        MsgBox (\"Please enter an email address\")\n        LIMatch = False\n        Win = True\n    Exit For\n    ElseIf Me.PasswordTxt = \"\" Then\n        MsgBox (\"Please enter a password\")\n        LIMatch = False\n        Win = True\n    Exit For\n\n    Else\n\n        If UCase(Row.Value) = UCase(Email) Then\n            If UCase(Row.Offset(0, -6)) = UCase(Password) Then\n                MsgBox \"Welcome\"\n                LIMatch = True\n                Win = True\n                Attempts = 0\n                Exit For\n            ElseIf IsEmpty(Row) Then\n                Exit For\n                Win = False\n            Else\n                LIMatch = False\n                Win = False\n\n            Exit For\n            End If\n        Else\n            LIMatch = False\n            Win = False\n        End If\n\n    End If\n    Next Row\n\nIf LIMatch = True And Win = True Then\n    Unload Me\n    NewForm.Show\nElseIf LIMatch = False And Win = False Then\n    MsgBox (\"Incorrect login\")\n    Attempts = Attempts + 1\nElse\nEnd If\n\nIf Attempts &gt;= 3 Then\nMsgBox (\"You have entered the incorrect login 3 times\")\nUnload Me\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "edited": false, "score": 1, "creation_date": 1544556656, "post_id": 53730893, "comment_id": 94315856, "body": "I would suggest a MsgBox isn&#39;t the best solution for this; you&#39;d be better creating a UserForm, which gives you much more flexibility."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1544555980, "creation_date": 1544555980, "answer_id": 53730966, "question_id": 53730893, "link": "https://stackoverflow.com/questions/53730893/message-box-that-loops-and-displays-multiple-records/53730966#53730966", "title": "Message Box that loops and displays multiple records", "body": "<p>Use a string variable to hold the data then after the loop present the string in one MsgBox</p>\n\n<pre><code>Dim str As String\nstr = \"Loan Summary (Price, Range, Standard Deviation):\" &amp; vbCrLf &amp; vbTab\nFor theRep = 1 To wsv.Range(\"J3\").Value\n    Average1 = Range(\"loanSummary\").Offset(0, theRep)\n    Range1 = Range(\"loanSummary\").Offset(1, theRep)\n    StdDev1 = Range(\"loanSummary\").Offset(2, theRep)\n\n\n    str = str &amp; \"Loan \" &amp; theRep &amp; \": (\" &amp; Format(Average1, \"##0.00\") &amp; \", \" &amp; Format(Range1, \"##0.00\") &amp; \", \" &amp; Format(StdDev1, \"##0.00\") &amp; \")\" &amp; vbCrLf &amp; vbTab\nNext\nMsgBox str\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9339805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5a9ea8d72a565db8060cb8d23fb27d?s=128&d=identicon&r=PG&f=1", "display_name": "financedude", "link": "https://stackoverflow.com/users/9339805/financedude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 53730966, "answer_count": 1, "score": 0, "last_activity_date": 1547417339, "creation_date": 1544555642, "last_edit_date": 1547417339, "question_id": 53730893, "link": "https://stackoverflow.com/questions/53730893/message-box-that-loops-and-displays-multiple-records", "title": "Message Box that loops and displays multiple records", "body": "<p>I'm trying to create a message box that displays various entries for an undetermined number of columns.</p>\n\n<p>I believe I want a loop, but I want the message box to display all the records available in a range and not create a new message box for each item in the range.</p>\n\n<p>I want the message box to look like</p>\n\n<pre><code>Loan Summary(Price, Range, Standard Deviation):\nLoan 1: (100, 5, 2)\nLoan 2: (102, 4, 3)\n</code></pre>\n\n<p>and so on but the number of records (loans) will change each time.</p>\n\n<p>I have the below code. How do I add a new line for each record in a range?</p>\n\n<pre><code>For theRep = 1 To wsv.Range(\"J3\").Value\n    Average1 = Range(\"loanSummary\").Offset(0, theRep)\n    Range1 = Range(\"loanSummary\").Offset(1, theRep)\n    StdDev1 = Range(\"loanSummary\").Offset(2, theRep)\n\n    MsgBox \"Loan Summary (Price, Range, Standard Deviation):\" &amp; vbCrLf &amp; vbTab &amp; \"Loan 1: \" &amp; Format(Average1, \"##0.00\") &amp; \", \" &amp; Format(Range1, \"##0.00\") &amp; \", \" &amp; Format(StdDev1, \"##0.00\")\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula", "parentheses"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544551809, "post_id": 53729945, "comment_id": 94313600, "body": "Looks correct to me, how are you using it in vba, please show your actual code."}, {"owner": {"reputation": 1, "user_id": 4174427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71a798b5e47508032e763c846d026c7?s=128&d=identicon&r=PG&f=1", "display_name": "GlenAllan", "link": "https://stackoverflow.com/users/4174427/glenallan"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544551988, "post_id": 53729945, "comment_id": 94313685, "body": "it is the ampersand and wildcards throwing me off."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1544552283, "post_id": 53729945, "comment_id": 94313830, "body": "All <code>&quot;</code> inside the formula need to be doubled <code>&quot;&quot;</code> Except where it is around vba <code>&quot; &amp; i &amp; &quot;</code> and remove the spaces around the <code>*</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1544552331, "post_id": 53729945, "comment_id": 94313860, "body": "Also you do not need to loop to put in a formula  Excel will make the changes to the formula relatively when entered in bulk."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 6700974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IpF4tdyVQ-I/AAAAAAAAAAI/AAAAAAAABCE/SkmLGxCN144/photo.jpg?sz=128", "display_name": "lighthouselk", "link": "https://stackoverflow.com/users/6700974/lighthouselk"}, "is_accepted": false, "score": 0, "last_activity_date": 1544552741, "creation_date": 1544552741, "answer_id": 53730226, "question_id": 53729945, "link": "https://stackoverflow.com/questions/53729945/vba-parenthesis/53730226#53730226", "title": "vba parenthesis", "body": "<p>Your formula should be..</p>\n\n<pre><code>.Formula = \"=INDEX($C$1:$C$2,MATCH(\"\"*\"\" &amp; TRIM(RIGHT(A8,LEN(A8)-FIND(\"\"-\"\",A8)))&amp; \"\"*\"\",$A$1:$A$2,0),0)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4174427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71a798b5e47508032e763c846d026c7?s=128&d=identicon&r=PG&f=1", "display_name": "GlenAllan", "link": "https://stackoverflow.com/users/4174427/glenallan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544552741, "creation_date": 1544551609, "last_edit_date": 1544552028, "question_id": 53729945, "link": "https://stackoverflow.com/questions/53729945/vba-parenthesis", "title": "vba parenthesis", "body": "<p>struggling to get the parenthesis in the right spot. this is formula in a specified range in vba macro </p>\n\n<pre><code>Range(\"C\" &amp; i).Formula = \"=INDEX($C$1:$C$2,MATCH(\" * \"&amp;TRIM(RIGHT(A\" &amp; i &amp; \",LEN(A\" &amp; i &amp; \")-FIND(\" - \",A\" &amp; i &amp; \")))&amp;\" * \",$A$1:$A$2,0),0)\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "text", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10375968, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-H829Zj13VvM/AAAAAAAAAAI/AAAAAAAAFSk/6tJgg7oPjFA/photo.jpg?sz=128", "display_name": "Benjamin Connell", "link": "https://stackoverflow.com/users/10375968/benjamin-connell"}, "edited": false, "score": 0, "creation_date": 1544608373, "post_id": 53732796, "comment_id": 94333150, "body": "Unfortunately, because I&#39;m pasting into a CSV, not an xlsx, the formats will go as soon as the sheet is closed. The next time it opens the cell displays the date code in a general formatted cell. I need to paste in the date as a string, which means I need to copy it as a string."}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1544564796, "creation_date": 1544564796, "answer_id": 53732796, "question_id": 53729918, "link": "https://stackoverflow.com/questions/53729918/how-do-i-copy-and-past-date-text-from-a-range-of-filtered-cells-into-a-csv/53732796#53732796", "title": "How do I Copy and Past date text from a range of filtered cells, into a CSV?", "body": "<p>You can change .PasteSpecial (xlPasteValues) to .PasteSpecial (xlPasteAll) </p>\n\n<p>It will not only paste values but also replicate cell formats (in this case - dates).</p>\n\n<p>Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10375968, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-H829Zj13VvM/AAAAAAAAAAI/AAAAAAAAFSk/6tJgg7oPjFA/photo.jpg?sz=128", "display_name": "Benjamin Connell", "link": "https://stackoverflow.com/users/10375968/benjamin-connell"}, "is_accepted": true, "score": 1, "last_activity_date": 1544614266, "creation_date": 1544614266, "answer_id": 53742095, "question_id": 53729918, "link": "https://stackoverflow.com/questions/53729918/how-do-i-copy-and-past-date-text-from-a-range-of-filtered-cells-into-a-csv/53742095#53742095", "title": "How do I Copy and Past date text from a range of filtered cells, into a CSV?", "body": "<p>Ok, I don't think an answer to this exists! Haha. I can't find a way to grab the TEXT of a range of filtered cells, BUT I've come up with a work around that will do. </p>\n\n<p>The CSV file is open in Excel while I'm populating it. At this time the cells can be formatted, but the formatting is lost when the file is closed. So, I need to reset the cells before I save and close. For this I've found a loop which I can call right after the copy/pasting is done:</p>\n\n<pre><code>TemplateSheet.Range(\"G2:G500\").NumberFormat = \"dd/mm/yyyy\"\nFor Each Cell In TemplateSheet.Range(\"G2:G500\")\n  Cell.Value = Cell.Text\nNext Cell\n</code></pre>\n\n<p>This of course requires a Dim Cell As Range at the top of the code. It's not as elegant a solution as I'd hoped, but I just need the job done now! Haha. It works fairly quickly too.</p>\n"}], "owner": {"reputation": 13, "user_id": 10375968, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-H829Zj13VvM/AAAAAAAAAAI/AAAAAAAAFSk/6tJgg7oPjFA/photo.jpg?sz=128", "display_name": "Benjamin Connell", "link": "https://stackoverflow.com/users/10375968/benjamin-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53742095, "answer_count": 2, "score": 0, "last_activity_date": 1544614266, "creation_date": 1544551509, "question_id": 53729918, "link": "https://stackoverflow.com/questions/53729918/how-do-i-copy-and-past-date-text-from-a-range-of-filtered-cells-into-a-csv", "title": "How do I Copy and Past date text from a range of filtered cells, into a CSV?", "body": "<p>I'm trying to copy a range of filtered, date formatted cells into a CSV file. I want the text of the date, not the date code. </p>\n\n<p>This is what I have so far. It gets the date code, but I want the text. </p>\n\n<pre><code>.Range.Columns(EmployeeEffectiveDateCol).Offset(1, 0).SpecialCells(xlCellTypeVisible).Copy\n    TemplateSheet.Range(\"G2\").PasteSpecial (xlPasteValues)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": 0, "last_activity_date": 1544557226, "creation_date": 1544557226, "answer_id": 53731229, "question_id": 53729887, "link": "https://stackoverflow.com/questions/53729887/vba-file-directory-link-into-outlook/53731229#53731229", "title": "VBA File Directory Link into Outlook", "body": "<p>I figured it out.  I was using the incorrect structure for the file directory.</p>\n\n<p><code>target = \"\\\\fsps02\\users\\......\"</code></p>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 53731229, "answer_count": 1, "score": 0, "last_activity_date": 1544557226, "creation_date": 1544551388, "question_id": 53729887, "link": "https://stackoverflow.com/questions/53729887/vba-file-directory-link-into-outlook", "title": "VBA File Directory Link into Outlook", "body": "<p><br>\nI have the following code written (based on other posts here in SO) to insert a hyperlink to the folder that the workbook is saved in on a network drive into the body of an Email and the link does not show up in the body of the Email and I am at a loss as to why.  Any help is greatly appreciated.</p>\n\n<p>I do have the Microsoft Outlook Object Library checked in the References.</p>\n\n<p>I have tried <code>hyperlink = \"&lt;a href=\"\"\" &amp; currDir &amp; \"\"\"&gt;&lt;/a&gt;\"</code> and <code>hyperlink = \"&lt;a href=\" &amp; currDir &amp; \"&gt;&lt;/a&gt;\"</code> to no avail.</p>\n\n<p>Below is the full code:</p>\n\n<pre><code>Private Sub FileToApprRev_Click()\n    Dim OutlookApp As Object, MItem As Object\n    Dim Subj As String, EmailAddr As String, Recipient As String\n    Dim LienPos As Range, clsDate As Range, address As String, lNum As Range, Street As Range, City As Range, State As Range, ZipCode As Range, CustName As Range\n    Dim strBody As String, Email As String, hyperlink As String, currDir As String\n\n\n    Set wb = Application.ThisWorkbook\n    Set wsSI = wb.Sheets(\"SavedInfo\")\n    Set Street = wsSI.Range(\"Street\")\n    Set City = wsSI.Range(\"City\")\n    Set State = wsSI.Range(\"State\")\n    Set ZipCode = wsSI.Range(\"Zip\")\n    Set lNum = wsSI.Range(\"Loan_Number\")\n    Set clsDate = wsSI.Range(\"Closing_Date\")\n    Set LienPos = wsSI.Range(\"Lien_Position\")\n    Set CustName = wsSI.Range(\"PBName\")\n\n    address = Street &amp; \", \" &amp; City &amp; \", \" &amp; State &amp; \" \" &amp; ZipCode\n\n    Set OutlookApp = CreateObject(\"Outlook.Application\")\n    Set MItem = OutlookApp.CreateItem(0)\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Email = \"SpongeBob@UnderTheSeaHeaven.com\"\n    currDir = wb.path\n    hyperlink = \"&lt;a href=\"\"\" &amp; currDir &amp; \"\"\"&gt;&lt;/a&gt;\"\n    Debug.Print hyperlink\n\n    strBody = \"&lt;p&gt;\" &amp; \"Hello , \" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; vbNewLine &amp; vbNewLine &amp; _\n        \"Please complete the Appraisal Review for the file below.\" &amp; \"&lt;/p&gt;\" &amp; vbNewLine &amp; _\n        hyperlink\n\n\n    With MItem\n        .Display\n        .to = Email\n        .Subject = \"ATTN - Appraisal Review\" &amp; \" - \" &amp; CustName &amp; \" - \" &amp; clsDate\n        .HTMLBody = strBody &amp; \"&lt;br&gt;\" &amp; .HTMLBody\n        .send\n    End With\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "range"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1544548581, "post_id": 53728794, "comment_id": 94312028, "body": "<i>&quot;The code works, but in unintended ways unfortunately.&quot;</i> - What do you mean by this? Are you getting an error? What&#39;s your expected result, and what&#39;s the current result?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1544548651, "post_id": 53728794, "comment_id": 94312060, "body": "Also, you&#39;re iterating through <code>cell</code> in your <code>For Each</code> loop but you never use it in your loop."}, {"owner": {"reputation": 252, "user_id": 4100810, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7149a57ab7f5c5022e0c8a0a3ca7c5dc?s=128&d=identicon&r=PG", "display_name": "C Dieguez", "link": "https://stackoverflow.com/users/4100810/c-dieguez"}, "edited": false, "score": 0, "creation_date": 1544550583, "post_id": 53728794, "comment_id": 94313064, "body": "Does it change anything if you explicitly name the range in your for loop as <code>wslean.Range(&quot;A2&quot;).Offset(i,0)</code>?  Just a guess.  Without knowing what your code is outputting, it&#39;s hard to identify the problem."}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1544551140, "post_id": 53728794, "comment_id": 94313300, "body": "without making any changes, it seems to to take the column headings from the MACRO sheet and paste it into the LEAN workbook starting from cell A2. It seems to be functioning in reverse :("}, {"owner": {"reputation": 252, "user_id": 4100810, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7149a57ab7f5c5022e0c8a0a3ca7c5dc?s=128&d=identicon&r=PG", "display_name": "C Dieguez", "link": "https://stackoverflow.com/users/4100810/c-dieguez"}, "edited": false, "score": 0, "creation_date": 1544552116, "post_id": 53728794, "comment_id": 94313750, "body": "So is <code>wsmacro.Range(&quot;enum&quot;)</code> your column header?  If so, I think you&#39;ve just got the syntax reversed.  Does <code>wsmacro.Range(&quot;enum&quot;) = wslean.Range(&quot;A2&quot;).Offset(i,0)</code> solve the problem?"}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1544552685, "post_id": 53728794, "comment_id": 94314030, "body": "its working in that its now changing the data in the MACRO workbook, however, it seems to cycle through the data in the LEAN workbook and change the data in the column headings space (replacing the column headings with data) and doesnt paste it into the sheet/next blank cell."}, {"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1544553061, "post_id": 53728794, "comment_id": 94314224, "body": "to additionally clarify, &quot;Enum&quot; is a named range, with the column heading being Eng #. The goal is to have the data from the LEAN workbook get pasted into the next empty cell in this column."}], "answers": [{"tags": [], "owner": {"reputation": 252, "user_id": 4100810, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7149a57ab7f5c5022e0c8a0a3ca7c5dc?s=128&d=identicon&r=PG", "display_name": "C Dieguez", "link": "https://stackoverflow.com/users/4100810/c-dieguez"}, "is_accepted": true, "score": 0, "last_activity_date": 1544558908, "creation_date": 1544558908, "answer_id": 53731609, "question_id": 53728794, "link": "https://stackoverflow.com/questions/53728794/loop-through-each-row-in-one-worksheet-and-copy-to-another-worksheets-named-ran/53731609#53731609", "title": "Loop through each row in one worksheet and copy to another worksheet&#39;s named ranges", "body": "<p>What I gather you want to do is to take the value from each cell in <code>leanrange</code> and the adjacent columns and insert it into your table in the macro workbook under the appropriate header.</p>\n\n<p>I think there are two problems here:</p>\n\n<ol>\n<li>the syntax in your for loop is reversed    </li>\n<li>you're offsetting ineffectively</li>\n</ol>\n\n<p>Here's what I would suggest:  since you're using a for each loop, use the <code>cell</code> object to loop through all the cells in the range instead of using offset.  Then, you need to offset the row in your macro workbook, otherwise you're just pasting to the same row over and over again.  That's why your headers are getting overwritten.  You can use a second loop to offset <code>cell</code> so that you can loop through each column in <code>leanrange</code>.  Finally, since it looks like your ranges \"Enum\", \"ds\", \"dc\" etc. are all adjacent columns, I've simplified things by using j to also offset your columns in the macro workbook.</p>\n\n<pre><code>Dim i As Integer\nDim j As Integer\nDim cell As Range\n\ni = 1\nFor Each cell In leanrange\n    If leanrange.Range(\"A2\") &lt;&gt; \"E1002\" Then\n        For j = 0 To 3\n            wsmacro.Range(\"Enum\").Offset(i, j) = cell.Offset(0, j).Value\n        Next j\n        i = i + 1\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53731609, "answer_count": 1, "score": 0, "last_activity_date": 1544558908, "creation_date": 1544547163, "last_edit_date": 1544548687, "question_id": 53728794, "link": "https://stackoverflow.com/questions/53728794/loop-through-each-row-in-one-worksheet-and-copy-to-another-worksheets-named-ran", "title": "Loop through each row in one worksheet and copy to another worksheet&#39;s named ranges", "body": "<p>I've been trying to work through this but have not been successful so far. The code works, but in unintended ways unfortunately. </p>\n\n<p>The MACRO workbook is the master workbook with all data fields on the \"Data\" sheet.\nThe LEAN workbook contains certain data points that I'd like to copy and paste into named ranges on the \"Data\" sheet within the MACRO workbook to the last row available. </p>\n\n<p>For ex:</p>\n\n<p>Macro Workbook has columns:</p>\n\n<pre><code>Eng #  Eng Name   Date Started     Date Completed    KPI1   KPI2  \n\n100    ABC        12/01/2018       12/10/2018        50    100 \n</code></pre>\n\n<p>Lean Workbook has columns:</p>\n\n<pre><code>Eng #   Date Started   Date Completed   KPI#   Score\n101     12/02/2018      12/03/2018      1       50\n101     12/02/2018      12/03/2018      2       10\n102     11/01/2018      11/20/2018      1       100\n102     11/01/2018      11/20/2018      4       100\n</code></pre>\n\n<p>The goal is two-fold:</p>\n\n<ol>\n<li>Grab data from the Lean workbook's specific columns and paste into the Macro workbook's \"Data\" sheet to the last row available</li>\n<li>Grab the KPI # from the Lean Workbook (which are in rows) and past the <em>score</em> to the named ranges/columns that match the KPI # in the \"Data\" sheet.</li>\n</ol>\n\n<p>My attempt at the code below:</p>\n\n<pre><code>Public Sub GrabLeanFileData()\n\nDim wbmacro As Workbook\nDim wblean As Workbook\n\nSet wbmacro = Workbooks.Item(\"MacroFile.xlsm\")\nSet wblean = Workbooks.Item(\"Subcontractor CA - KPI's Lean.csv\")\n\nDim wsmacro As Worksheet\nDim wslean As Worksheet\n\nSet wsmacro = wbmacro.Worksheets.Item(\"Data\")\nSet wslean = wblean.Worksheets.Item(\"Subcontractor CA - KPI's Lean\")\n\nDim leanrange As Range\nSet leanrange = wslean.Range(\"A2:A15000\")\n\nwblean.Activate\n\nDim cell As Range\n\ni = 1\n\nFor Each cell In leanrange\n\n    If leanrange.Range(\"A2\") &lt;&gt; \"E1002\" Then\n        Range(\"A2\").Offset(i, 0).Value = wsmacro.Range(\"Enum\").Value\n        Range(\"B2\").Offset(i, 0).Value = wsmacro.Range(\"ds\").Value\n        Range(\"C2\").Offset(i, 0).Value = wsmacro.Range(\"dc\").Value\n        Range(\"D2\").Offset(i, 0).Value = wsmacro.Range(\"kpi1\").Value\n\n\n        i = i + 1\n    End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>I wanted to skip the test Eng # of 1002 so i put that condition in. </p>\n"}, {"tags": ["excel", "vba", "delete-row"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1544546490, "post_id": 53728564, "comment_id": 94310922, "body": "How about <code>if .Min(..) = 0 &amp; .Max(...) = 0</code> then all must be 0"}, {"owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1544611365, "post_id": 53728564, "comment_id": 94334985, "body": "Is there a function i can use for it to search for only blanks and zeros in the cell of the row, and if so to delete the row within the specific columns of C to O?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544547117, "post_id": 53728608, "comment_id": 94311291, "body": "I just looked up flag variable, im still a big noob in the VBA world. This is above my current understanding, though i understand what you wrote, sort of, when you broke it down. I actually stole part of this code from researching a similar question when i searched google and then modified it to fit my report row and column range. any further assistance would be greatly appreciated."}, {"owner": {"reputation": 388, "user_id": 6181153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adaccdd999ad2cf2b7bc72f66d1490a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mason", "link": "https://stackoverflow.com/users/6181153/jay-mason"}, "reply_to_user": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544547675, "post_id": 53728608, "comment_id": 94311582, "body": "A flag variable would just be true/false :) Sorry. Let me see if I can write this up for you or at least get you closer"}, {"owner": {"reputation": 388, "user_id": 6181153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adaccdd999ad2cf2b7bc72f66d1490a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mason", "link": "https://stackoverflow.com/users/6181153/jay-mason"}, "reply_to_user": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544548236, "post_id": 53728608, "comment_id": 94311871, "body": "Updated the answer @LLF I used notepad to code this so if there are any errors I apologize. It should be pretty good. Take backups before you run the code"}, {"owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544551751, "post_id": 53728608, "comment_id": 94313576, "body": "Thank you will try it now!"}, {"owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544552853, "post_id": 53728608, "comment_id": 94314118, "body": "its only taking away rows with blanks but not the ones populated with zero&#39;s."}, {"owner": {"reputation": 388, "user_id": 6181153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adaccdd999ad2cf2b7bc72f66d1490a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mason", "link": "https://stackoverflow.com/users/6181153/jay-mason"}, "reply_to_user": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544623210, "post_id": 53728608, "comment_id": 94341738, "body": "Add a check in there for a zero next to IsEmpty (Similar to how you did it before)"}, {"owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544625485, "post_id": 53728608, "comment_id": 94343070, "body": "im trying to comment in the zero &quot;0&quot;, even did some searches on google for isempty and zeros but couldn&#39;t find a way to remark it.  Im sorry for added help, im just not understanding how to add it, tried (,0 &quot;0&quot;, or, =) I just dont know enough yet, just have the ability to edit other peoples code, but slowly im learning what they mean when used. i really do appreciate your assistance."}, {"owner": {"reputation": 388, "user_id": 6181153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adaccdd999ad2cf2b7bc72f66d1490a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mason", "link": "https://stackoverflow.com/users/6181153/jay-mason"}, "reply_to_user": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1544625617, "post_id": 53728608, "comment_id": 94343144, "body": "@LLF added 0 check. Goodluck"}], "tags": [], "owner": {"reputation": 388, "user_id": 6181153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adaccdd999ad2cf2b7bc72f66d1490a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mason", "link": "https://stackoverflow.com/users/6181153/jay-mason"}, "is_accepted": true, "score": 1, "last_activity_date": 1544771872, "last_edit_date": 1544771872, "creation_date": 1544546392, "answer_id": 53728608, "question_id": 53728564, "link": "https://stackoverflow.com/questions/53728564/delete-row-if-populated-with-blanks-and-zeros-within-a-range/53728608#53728608", "title": "Delete Row if populated with blanks and zeros within a range", "body": "<p>Rather than checking the SUM, loop through each cell and check if its valid.</p>\n\n<p>To explain this better I will use pseudo code for you:</p>\n\n<ol>\n<li>Create a flag variable and set it to false</li>\n<li>Create a loop that will check each cell in a row</li>\n<li>If a valid number if found, set the flag to true</li>\n<li>Before moving to the next cell, check if your flag is still false</li>\n<li>If your flag is false -> Continue to next cell</li>\n<li>Loop through to the end of all of the cells in the row</li>\n</ol>\n\n<p>Pseudo-Code made into rough code</p>\n\n<pre><code>Dim rw As Long, i As Long\nDim rng As Range\nDim validRow As Boolean\nvalidRow = false\n\nrw = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = rw To 6 Step -1\n    Set rng = (Cells(i, 3).Resize(1, 17))\n    For Each cell In rng\n         If Not IsEmpty(cell) Then\n            If cell.value &lt;&gt; 0 Then\n               validRow = true\n            End If\n         End If\n         If validRow = true Then\n        Exit For\n         End If\n    Next cell\n    If validRow = false Then\n        Rows(i).Delete\n    End If\n    validRow = false\nNext\n</code></pre>\n\n<p>[@LL edit: changed >0 to &lt;>0 too look for anything different than zero, to account for rows populated with only negative values]</p>\n"}, {"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1544639291, "post_id": 53748002, "comment_id": 94350978, "body": "I even know that you&#39;re answering by first line HUGE FONT! \ud83d\ude06"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1544645670, "post_id": 53748002, "comment_id": 94354055, "body": "I&#39;m uploading a better version. Take a look."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": -1, "last_activity_date": 1544735549, "last_edit_date": 1544735549, "creation_date": 1544634380, "answer_id": 53748002, "question_id": 53728564, "link": "https://stackoverflow.com/questions/53728564/delete-row-if-populated-with-blanks-and-zeros-within-a-range/53748002#53748002", "title": "Delete Row if populated with blanks and zeros within a range", "body": "<h1>Empty Cells Treated As Zeros!?</h1>\n\n<p>When developing code for the deletion of rows and/or columns it is good practice to use the Hidden property instead of the Delete method, so the wrong things don't get deleted. Therefore I would conclude that it is good practice to post it in that way, too.<br>\nYou will have to change <code>cBlnDEL</code> to <code>True</code> to enable the <strong>DELETE</strong> feature, which I would recommend you do only after you have checked the code with the <strong>HIDDEN</strong> feature active.</p>\n\n<h2>A 'Fast' Union Version</h2>\n\n<pre><code>'*******************************************************************************\n' Purpose:    Deletes or hides empty rows, and rows containing zero (0) in     *\n'             a specified range, in the ActiveSheet (of the ActiveWorkbook).   *\n'*******************************************************************************\nSub DeleteBlankAndZeroRows()\n\n  Application.ScreenUpdating = False\n  Application.Calculation = xlCalculationManual\n\n  Const Col1 As Integer = 3         ' First Column of Source Range\n  Const Col2 As Integer = 13        ' Last Column of Source Range\n  Const Row1 As Integer = 6         ' First Row of Source Range\n  Const cBlnDEL As Boolean = False  ' If True, Delete. If False, Hide.\n\n  Dim rng As Range                  ' Check Range\n  Dim rngU As Range                 ' Target Union Range\n\n  Dim Row2 As Long                  ' Last Row of Source Range\n  Dim i As Long                     ' Source Range Rows Counter\n  Dim j As Long                     ' Source Range Columns Counter\n  Dim k As Long                     ' Deleted Rows Counter\n  Dim strMsg As String              ' Msgbox Text\n\n  On Error GoTo ErrorHandler\n\n  With ActiveWorkbook.ActiveSheet ' A reminder of where this is happening.\n    ' Calculate last row of Source Range.\n    Row2 = .Cells(.Rows.Count, 1).End(xlUp).Row\n    ' Set bogus reference to \"aquire range level\" (Parent).\n    Set rng = .Cells(1, 1)\n  End With\n\n  ' Loop through each row in Source Range.\n  For i = Row1 To Row2\n\n    ' Calculate the Check Range for current row in Source Range.\n    Set rng = rng.Parent.Cells(i, Col1).Resize(1, Col2)\n\n    ' If the cell at the intersection of column Col1 and the current row\n    ' is 0, add it to the Target Union Range.\n    ' Note: Unexpectedly, the value of an empty cell is treated as 0 here.\n\n    ' Loop through each cell of the (one-row) Check Range.\n    For j = 1 To rng.Columns.Count\n\n      If rng.Cells(1, j).Value = 0 Then ' If 0 is found.\n        k = k + 1                         ' Count to be deleted rows.\n        If Not rngU Is Nothing Then       ' There already is a range in rngU.\n          Set rngU = Union(rngU, rng.Cells(1, 1)) ' Add another.\n         Else                             ' There is no range in rngU.\n          Set rngU = rng.Cells(1, 1)              ' Add one.\n        End If\n        Exit For\n'         Else                            ' If 0 is NOT found.\n      End If\n\n    Next ' (Cell in (one-row) Check Range)\n\n  Next   ' (Row in Source Range)\n\n  ' Note: If no 0 was found, the Target Union Range does NOT contain a range.\n\n  If Not rngU Is Nothing Then ' Target Union Range contains range(s).\n    If cBlnDEL Then ' DELETE is active. Delete Target Union Range.\n      strMsg = \"DeleteBlankAndZeroRows successfully deleted \" &amp; k _\n          &amp; \" rows in \" &amp; rngU.Areas.Count &amp; \" areas.\"\n      rngU.Rows.EntireRow.Delete\n     Else           ' HIDDEN is active. Hide Target Union Range.\n      strMsg = \"DeleteBlankAndZeroRows has successfully hidden \" &amp; k _\n          &amp; \" rows in \" &amp; rngU.Areas.Count &amp; \" areas.\"\n      rngU.Rows.EntireRow.Hidden = True\n    End If\n   Else                       ' Target Union Range does NOT contain range(s).\n    strMsg = \"You may have used the DELETE feature of \" _\n        &amp; \"DeleteBlankAndZeroRows recently, because \" _\n        &amp; \" it could not find any zeros. Nothing deleted.\"\n  End If\n\nProcedureExit:\n\n  Set rngU = Nothing\n  Set rng = Nothing\n\n  Application.Calculation = xlCalculationAutomatic\n  Application.ScreenUpdating = True\n\n  MsgBox strMsg\n\nExit Sub\n\nErrorHandler:\n  strMsg = \"An unexpected error occurred. Error: \" &amp; Err.Number &amp; vbCr _\n      &amp; Err.Description\n  GoTo ProcedureExit\n\nEnd Sub\n'*******************************************************************************\n</code></pre>\n\n<p><strong>The previous code hides or deletes each row where there is a red cell in the yellow area as shown in the image.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/vAo0l.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vAo0l.jpg\" alt=\"enter image description here\"></a></p>\n\n<h2>Special Versions (Not Recommended)</h2>\n\n<pre><code>Sub DelBlankAndZeroRowsDontKnowHowIGotOutOfMyBedThisAfternoonVersion()\n  Dim rw As Long, i As Long, j As Long\n  Dim rng As Range, rngU As Range\n    rw = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = rw To 6 Step -1\n      Set rng = Cells(i, 3).Resize(1, 13)\n      For j = 1 To rng.Columns.Count\n        If rng.Cells(1, j).Value = 0 Then\n          If Not rngU Is Nothing Then\n            Set rngU = Union(rng.Cells(1, 1), rngU)\n           Else\n            Set rngU = rng.Cells(1, j)\n          End If\n        End If\n      Next\n    Next\n    rngU.Rows.Hidden = True\n  Set rngU = Nothing\n  Set rng = Nothing\nEnd Sub\n\nSub DelBlankAndZeroRowsThinkImGonnaStayInBedTodayVersion()\nDim rw As Long, i As Long, j As Long\nDim rng As Range, rngU As Range\nrw = Cells(Rows.Count, 1).End(xlUp).Row\nFor i = rw To 6 Step -1\nSet rng = Cells(i, 3).Resize(1, 13)\nFor j = 1 To rng.Columns.Count\nIf rng.Cells(1, j).Value = 0 Then\nIf Not rngU Is Nothing Then\nSet rngU = Union(rng.Cells(1, 1), rngU)\nElse\nSet rngU = rng.Cells(1, j)\nEnd If\nEnd If\nNext\nNext\nrngU.Rows.Hidden = True\nSet rngU = Nothing\nSet rng = Nothing\nEnd Sub\n\nSub DelBlankAndZeroRowsNeverGonnaGetUpVersion()\nDim rw As Long, i As Long, j As Long, rng As Range, rngU As Range\nrw = Cells(Rows.Count, 1).End(xlUp).Row: For i = rw To 6 Step -1\nSet rng = Cells(i, 3).Resize(1, 13): For j = 1 To rng.Columns.Count\nIf rng.Cells(1, j).Value = 0 Then\nIf Not rngU Is Nothing Then\nSet rngU = Union(rng.Cells(1, 1), rngU)\nElse: Set rngU = rng.Cells(1, j): End If: End If: Next: Next\nrngU.Rows.Hidden = True: Set rngU = Nothing: Set rng = Nothing: End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1544647859, "creation_date": 1544647859, "answer_id": 53751142, "question_id": 53728564, "link": "https://stackoverflow.com/questions/53728564/delete-row-if-populated-with-blanks-and-zeros-within-a-range/53751142#53751142", "title": "Delete Row if populated with blanks and zeros within a range", "body": "<p>First, I guess, there's error in <code>Resize</code> - it should be 13 - not 17.\nSecond, if you have lots of data to remove, you can use <code>AutoFilter</code>.</p>\n\n<h3>First way.</h3>\n\n<p>Altering your code:</p>\n\n<pre><code>Sub FFF()\n    Dim rw As Long, i As Long, cntZeroes%, cntEmpty%\n    rw = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = rw To 6 Step -1\n        With Cells(i, 3).Resize(, 13)\n            cntZeroes = Application.CountIf(.Cells, 0)\n            cntEmpty = Application.CountIf(.Cells, vbNullString)\n            If cntZeroes = 13 Or cntEmpty = 13 Then Rows(i).Delete\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<h3>Second way.</h3>\n\n<p>Using helper column <code>P</code> (as it's next to <code>O</code>) with <code>AutoFilter</code>. It's rather complex, but it's faster than row-by-row deleting:</p>\n\n<pre><code>Sub FFF2()\n    Dim rw As Long, i As Long, cntZeroes%, cntEmpty%\n    rw = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = rw To 6 Step -1\n        With Cells(i, 3).Resize(, 13)\n            cntZeroes = Application.CountIf(.Cells, 0)\n            cntEmpty = Application.CountIf(.Cells, vbNullString)\n            If cntZeroes = 13 Or cntEmpty = 13 Then\n                Cells(i, \"P\") = 1\n            End If\n        End With\n    Next\n    With Rows(5)\n        .AutoFilter Field:=16, Criteria1:=1\n        On Error Resume Next\n        With .Parent.AutoFilter.Range\n            .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        On Error GoTo 0\n        .Parent.AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53728608, "answer_count": 3, "score": 1, "last_activity_date": 1544771872, "creation_date": 1544546249, "last_edit_date": 1544549815, "question_id": 53728564, "link": "https://stackoverflow.com/questions/53728564/delete-row-if-populated-with-blanks-and-zeros-within-a-range", "title": "Delete Row if populated with blanks and zeros within a range", "body": "<p>I have a report where i need to remove the rows with no data in the cells or a zero within a range column C to O. </p>\n\n<p>This code i have almost does it perfectly, but i found a fatal flaw in the logic. If the row has a positive and negative value that sum to zero it will be deleted while i would still need to retain that row. </p>\n\n<p>I really appreciate the assistance from this site as I have been able to really automate many of my reports and help people in other departments! you guys rock! Thank You!</p>\n\n<pre><code>Dim rw As Long, i As Long\nrw = Cells(Rows.Count, 1).End(xlUp).Row\nFor i = rw To 6 Step -1\nIf Application.Sum(Cells(i, 3).Resize(1, 17)) = 0 Then\nRows(i).Delete\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 0, "creation_date": 1544612201, "post_id": 53729186, "comment_id": 94335480, "body": "Hi @Kubie, thank you for your help - we are now getting emails with entire rows, which is amazing. There a few bugs still though? We can&#39;t select non-adjacent rows and pass them over as it sends the entire sheet again. Also, I think there&#39;s an issue where the email is sending after it&#39;s copied over the details to the other sheet, but it&#39;s copying the cells that have replaced the transferred data on the original sheet. Is is it possible for me to make the email send first and then transfer the data? Thanks so much for all your help."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 0, "creation_date": 1544630034, "post_id": 53729186, "comment_id": 94345901, "body": "@LizH hey so I editted my response above and fixed most of the problems you mentioned. You can now send 2 non-adjacent selections and also send from the correct sheet. I could also change it so that it transfers the data after the email but right now this approach was the easiest lol"}, {"owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 1, "creation_date": 1545045656, "post_id": 53729186, "comment_id": 94476492, "body": "Hi @Kubie - I&#39;m so sorry! I took a few days off work last week, and only just came back to the office. Yes, the new suggestions send the row being transferred, and it sends non-adjacent rows as well. Thank you so much for all your help!"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 0, "last_activity_date": 1544630532, "last_edit_date": 1544630532, "creation_date": 1544548633, "answer_id": 53729186, "question_id": 53728333, "link": "https://stackoverflow.com/questions/53728333/excel-macro-sending-automatic-email-when-transferring-data-from-one-sheet-to-a/53729186#53729186", "title": "Excel macro - sending automatic email when transferring data from one sheet to another (copy full row)", "body": "<p>In order to send the details of the whole row, you can set the <code>Sendrng</code> variable by choosing its contents via range rather than assigning it to <code>selection</code>.</p>\n\n<p>Note: the code was slightly rearranged to send the email after transferring the data for this to work.</p>\n\n<p>This should also compensate for selecting different ranges and wanting the avoid sending the entire sheet.</p>\n\n<pre><code>Sub Pass_to_xDepartment()\n\n    'Declare variables\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim lastRow As Long\n    Dim lastRow2 As Long\n    Dim WSheet As Variant\n    Dim DTable As Variant\n    Dim Sendrng As Range\n    Dim sht3 As Worksheet\n\n    If MsgBox(\"Do you want to pass the selected tours to XDepartment?\", vbYesNo, \"Pass to XDepartment\") = vbNo Then Exit Sub\n\n    For Each WSheet In ActiveWorkbook.Worksheets\n        If WSheet.AutoFilterMode Then\n            If WSheet.FilterMode Then\n                WSheet.ShowAllData\n            End If\n        End If\n        For Each DTable In WSheet.ListObjects\n            If DTable.ShowAutoFilter Then\n                DTable.Range.AutoFilter\n                DTable.Range.AutoFilter\n            End If\n        Next DTable\n    Next WSheet\n\n    'Set variables\n    Set sht1 = Sheets(\"YDepartment\")\n    Set sht2 = Sheets(\"XDepartment\")\n\n    'Move row to destination sheet &amp; Delete source row\n    lastRow = sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).Row\n\n    'Select Entire Row.Resize(ColumnSize:=12)\n    Intersect(Selection.EntireRow, Selection.Parent.Range(\"A:L\")).Select\n\n    With Selection\n        .Copy Destination:=sht2.Range(\"A\" &amp; lastRow + 1)\n        lastRow2 = sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).Row\n        .EntireRow.Delete\n    End With\n\n    Set sht3 = ActiveWorkbook.Sheets.Add(After:=Worksheets(Worksheets.Count))\n    sht3.Name = \"temp\"\n    'Note: if the selection is one cell it will send the whole worksheet\n    Set Sendrng = sht2.Range(\"A\" &amp; (lastRow + 1) &amp; \":L\" &amp; lastRow2)\n    Sendrng.Copy Destination:=sht3.Range(\"A1\")\n\n On Error GoTo StopMacro\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Create the mail and send it\n    sht3.Activate\n    lastRow2 = sht3.Range(\"A\" &amp; sht3.Rows.Count).End(xlUp).Row\n    Set Sendrng = sht3.Range(\"A1:L\" &amp; lastRow2)\n\n    With Sendrng\n\n        ActiveWorkbook.EnvelopeVisible = True\n        With .Parent.MailEnvelope\n\n            ' Set the optional introduction field thats adds\n            ' some header text to the email body.\n            .Introduction = \"The following rows have been completed. \"\n\n            With .Item\n                .To = \"EMAIL\"\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"Updated\"\n                .Send\n            End With\n\n        End With\n    End With\n\nStopMacro:\n\n    Application.DisplayAlerts = False\n    ActiveWorkbook.Sheets(\"temp\").Delete\n    Application.DisplayAlerts = True\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n    ActiveWorkbook.EnvelopeVisible = False\n\nEnd Sub\n</code></pre>\n\n<p>Also, its good practice to declare or <code>Dim</code> all your variables at the top of your programs but not necessary</p>\n\n<p>Best of luck</p>\n"}], "owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53729186, "answer_count": 1, "score": 0, "last_activity_date": 1544630532, "creation_date": 1544545393, "last_edit_date": 1544613269, "question_id": 53728333, "link": "https://stackoverflow.com/questions/53728333/excel-macro-sending-automatic-email-when-transferring-data-from-one-sheet-to-a", "title": "Excel macro - sending automatic email when transferring data from one sheet to another (copy full row)", "body": "<p>I'm working on the Macro below which transfers the selected rows to a new sheet and deletes it from the original sheet when pressing a command button.</p>\n\n<p>I'm trying to get it to send an automatic email when running this macro to inform xDepartment that yDepartment has transferred work. I want the body of the email to contain the active rows in their entirety which are being transferred.</p>\n\n<p>At the moment, when tranferring the rows, I can click on any cell in the row in the yDepartment worksheet (adjacent and non-adjacent) and it will transfer columns A:L to the xDepartment worksheet. But when I add the macro to also send an email, it will only send the details of the specific cells that I have selected, instead of the full row.</p>\n\n<p>Also, if the cells are non-adjacent (e.g. I'm transferring rows 4-5 and 8-10 at the same time), it sends the entire sheet, which I don't want.</p>\n\n<p>Does anyone know how I can fix this so that when work is transferred, the automatic email contains the same content as that which is transferred?</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Sub Pass_to_xDepartment()\n\nIf MsgBox(\"Do you want to pass the selected tours to XDepartment?\", vbYesNo, \"Pass to XDepartment\") = vbNo Then Exit Sub\n\nFor Each WSheet In ActiveWorkbook.Worksheets\n        If WSheet.AutoFilterMode Then\n            If WSheet.FilterMode Then\n                WSheet.ShowAllData\n            End If\n        End If\n        For Each DTable In WSheet.ListObjects\n            If DTable.ShowAutoFilter Then\n                DTable.Range.AutoFilter\n                DTable.Range.AutoFilter\n            End If\n        Next DTable\n    Next WSheet\n\n   Dim Sendrng As Range\n\n    On Error GoTo StopMacro\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Note: if the selection is one cell it will send the whole worksheet\n    Set Sendrng = Selection\n\n    'Create the mail and send it\n    With Sendrng\n\n        ActiveWorkbook.EnvelopeVisible = True\n        With .Parent.MailEnvelope\n\n            ' Set the optional introduction field thats adds\n            ' some header text to the email body.\n            .Introduction = \"The following rows have been completed. \"\n\n            With .Item\n                .To = \"EMAIL\"\n                .CC = \n                .BCC = \"\"\n                .Subject = \"Updated\"\n                .Send\n            End With\n\n        End With\n    End With\n\nStopMacro:\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n    ActiveWorkbook.EnvelopeVisible = False\n\n'Declare variables\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim lastRow As Long\n\n'Set variables\n    Set sht1 = Sheets(\"YDepartment\")\n    Set sht2 = Sheets(\"XDepartment\")\n\n'Select Entire Row.Resize(ColumnSize:=12)\n    Intersect(Selection.EntireRow, Selection.Parent.Range(\"A:L\")).Select\n\n'Move row to destination sheet &amp; Delete source row\n    lastRow = sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).Row\n\n    With Selection\n        .Copy Destination:=sht2.Range(\"A\" &amp; lastRow + 1)\n        .EntireRow.Delete\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "ms-access", "vba"], "comments": [{"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1544545642, "post_id": 53728250, "comment_id": 94310394, "body": "&quot;i cant add anything&quot;...and &quot;the add works fine&quot;. These two statements appear to contradict each other. Can you be a bit clearer about what is happening please? Also what debugging have you done exactly? Precisely where is your code failing? Are you getting errors, or some other unexpected flow of the code? You say you &quot;can&#39;t&quot; do something (but then appear to contradict yourself), but don&#39;t explain what is happening instead."}, {"owner": {"reputation": 7, "user_id": 10691734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OEo0pR-Cu3o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hxEeBhtwnSY1DosQpXklUP7bHOrA/mo/photo.jpg?sz=128", "display_name": "diabetes_comms", "link": "https://stackoverflow.com/users/10691734/diabetes-comms"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1544573409, "post_id": 53728250, "comment_id": 94322195, "body": "Im sorry if i am not abit clear. For example when the user inputs something to the text box such as their information, when they click save button which is the button 3 click. The data should appear in the datagrid view, but it appears on the database grid view as blank. I have done anything such as changing the primary key to lrn and making sure both label and the database is the same word. But now the error says along the lines of &quot;lrn.Table1 is blank&quot;"}, {"owner": {"reputation": 7, "user_id": 10691734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OEo0pR-Cu3o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hxEeBhtwnSY1DosQpXklUP7bHOrA/mo/photo.jpg?sz=128", "display_name": "diabetes_comms", "link": "https://stackoverflow.com/users/10691734/diabetes-comms"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1544591902, "post_id": 53728250, "comment_id": 94325926, "body": "The flow of the program is the user presses add new button (which is button 1), the users enter their lrn, first name, middle name, surname, their gender (from the combo box) and their birthday (from the dateandtimepicker) and press save which is the button 2 and the entered data will show up in the datagridview and the access file."}, {"owner": {"reputation": 7, "user_id": 10691734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OEo0pR-Cu3o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hxEeBhtwnSY1DosQpXklUP7bHOrA/mo/photo.jpg?sz=128", "display_name": "diabetes_comms", "link": "https://stackoverflow.com/users/10691734/diabetes-comms"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1544591908, "post_id": 53728250, "comment_id": 94325928, "body": "The flow of the program is the user presses add new button (which is button 1), the users enter their lrn, first name, middle name, surname, their gender (from the combo box) and their birthday (from the dateandtimepicker) and press save which is the button 2 and the entered data will show up in the datagridview and the access file. Hope this helps"}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 10691734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OEo0pR-Cu3o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hxEeBhtwnSY1DosQpXklUP7bHOrA/mo/photo.jpg?sz=128", "display_name": "diabetes_comms", "link": "https://stackoverflow.com/users/10691734/diabetes-comms"}, "is_accepted": false, "score": 0, "last_activity_date": 1544610699, "creation_date": 1544610699, "answer_id": 53741026, "question_id": 53728250, "link": "https://stackoverflow.com/questions/53728250/vb-net-data-does-not-show-up-in-database-grid-and-does-not-update-the-ms-acces/53741026#53741026", "title": "VB.Net - data does not show up in database grid and does not update the ms access database", "body": "<p>At last! I have fixed the problem. The textboxes were not binded to the table in the data bindings. I just changed in the data bindings section in the textbox properties. sorry for the inconvenience</p>\n"}], "owner": {"reputation": 7, "user_id": 10691734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OEo0pR-Cu3o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hxEeBhtwnSY1DosQpXklUP7bHOrA/mo/photo.jpg?sz=128", "display_name": "diabetes_comms", "link": "https://stackoverflow.com/users/10691734/diabetes-comms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1544610699, "creation_date": 1544545163, "last_edit_date": 1544591672, "question_id": 53728250, "link": "https://stackoverflow.com/questions/53728250/vb-net-data-does-not-show-up-in-database-grid-and-does-not-update-the-ms-acces", "title": "VB.Net - data does not show up in database grid and does not update the ms access database", "body": "<p>I am making a database program where users can add their data such as lrn, first name, middle name, and last name. My data sources are fine and the table loads in data grid view but when I run the program and enter new data, they do not show up in the data grid nor the access file</p>\n\n<p>Here is the code :</p>\n\n<pre><code>Public Class Form1\nPrivate Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click\n    Dim poi As DialogResult\n    poi = MessageBox.Show(\"Do You Want To Exit?\", \"Exit Program?\", MessageBoxButtons.OKCancel)\n    If poi = DialogResult.OK Then\n        Application.Exit()\n    End If\nEnd Sub\n\nPrivate Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n    'TODO: This line of code loads data into the 'BoboDataSet.Table1' table. You can move, or remove it, as needed.\n    Me.Table1TableAdapter.Fill(Me.BoboDataSet.Table1)\n\nEnd Sub\n\nPrivate Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click\n    Table1BindingSource.AddNew()\nEnd Sub\n\nPrivate Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click\n    'this button users click that will transfer the user's inputted data to the data grid viewer and updates the database\n    Table1BindingSource.EndEdit()\n    Table1TableAdapter.Update(BoboDataSet.Table1)\nEnd Sub\n\nPrivate Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click\n    Table1BindingSource.RemoveCurrent()\nEnd Sub\n</code></pre>\n\n<p>End Class</p>\n\n<p>I am a bit stumped! I think there is a wrong configuration in my data source but I followed steps to enter it and I already changed the database property to Copy if Newer but the new data entered does not show up in the database grid viewer and the access file</p>\n\n<p>Thanks for the response :)\n*Edited to better reflect my problem, Hopefully</p>\n"}]