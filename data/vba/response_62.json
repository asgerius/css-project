[{"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1458169474, "post_id": 36048593, "comment_id": 59745679, "body": "Alternatively this could be solved by doing <code>For Each cell In rngData.SpecialCells(xlCellTypeConstants)</code>"}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1458222795, "post_id": 36048593, "comment_id": 59771697, "body": "Using the suggestion by @Taelsin allows the code to run faster than added another statement to the If condition"}], "tags": [], "owner": {"reputation": 353, "user_id": 993817, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42814e5316b6057088f9f33fbbb6eda8?s=128&d=identicon&r=PG", "display_name": "kurin123", "link": "https://stackoverflow.com/users/993817/kurin123"}, "is_accepted": false, "score": 2, "last_activity_date": 1458169260, "creation_date": 1458169260, "answer_id": 36048593, "question_id": 36048541, "link": "https://stackoverflow.com/questions/36048541/vba-duplicate-condition-met-before-running-macro/36048593#36048593", "title": "VBA Duplicate Condition Met Before Running Macro", "body": "<p>I would say that two empty cells match than when you run this macro all empty cells will have red color font. So add <code>cell.Value &lt;&gt; \"\"</code> to you If condition</p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1458223350, "post_id": 36049079, "comment_id": 59772129, "body": "Thank you all for the help"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1458171773, "creation_date": 1458171773, "answer_id": 36049079, "question_id": 36048541, "link": "https://stackoverflow.com/questions/36048541/vba-duplicate-condition-met-before-running-macro/36049079#36049079", "title": "VBA Duplicate Condition Met Before Running Macro", "body": "<p>You could use a Worksheet Change event:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rngData As Range\nApplication.EnableEvents = False\nOn Error GoTo getout\nSet rngData = Range(\"P3:P19, P56:P58, P39:P42, P21:P25, P27:P37, P39:P42, P39:P42, P44:P54, M25:M76, B69:B77, B66:E67, B51:B64, H44:H47, D44:D47, H42, H33:H40, D33:D42, H31, D28:D31, H28:H29, D5:D8\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n\nIf Not Intersect(Target, rngData) Is Nothing Then\n    Duplicate\nEnd If\nApplication.EnableEvents = True\nExit Sub\n\ngetout:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Put this in the code sheet for the worksheet on which the data is located.</p>\n"}], "owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 36049079, "answer_count": 2, "score": 0, "last_activity_date": 1458171773, "creation_date": 1458168950, "question_id": 36048541, "link": "https://stackoverflow.com/questions/36048541/vba-duplicate-condition-met-before-running-macro", "title": "VBA Duplicate Condition Met Before Running Macro", "body": "<p>I am trying to manage duplicates on an Excel sheet by having the duplicate cells' font turn red. I decided to use a macro to check for duplicates, code below. It works, but I have one small issue:</p>\n\n<p>When I type in a new cell within the range, it automatically turn red even if there is no duplicate, unless I run the macro again then it corrects itself. I would like for it to stay black in the first instance and show up red only when it is a duplicate-- after running the macro. </p>\n\n<pre><code>Sub Duplicate()\nDim rngData As Range\nDim cell As Range\nDim cell2 As Range\n\nSet rngData = Range(\"P3:P19, P56:P58, P39:P42, P21:P25, P27:P37, P39:P42, P39:P42, P44:P54, M25:M76, B69:B77, B66:E67, B51:B64, H44:H47, D44:D47, H42, H33:H40, D33:D42, H31, D28:D31, H28:H29, D5:D8\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n\nrngData.Font.Color = vbBlack\n\nFor Each cell In rngData\n    If cell.Font.Color = vbBlack Then\n        For Each cell2 In rngData\n            If cell = cell2 And cell.Address &lt;&gt; cell2.Address Then\n                cell.Font.Color = vbRed\n                cell2.Font.Color = vbRed\n            End If\n        Next\n    End If\nNext\n\n\nSet rngData = Nothing\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "split"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1458168344, "post_id": 36048354, "comment_id": 59745224, "body": "<code>Split(mystring, &quot;,&quot;)(0)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 7, "last_activity_date": 1458168301, "creation_date": 1458168301, "answer_id": 36048388, "question_id": 36048354, "link": "https://stackoverflow.com/questions/36048354/using-vba-split-string-and-set-first-item-only-to-variable/36048388#36048388", "title": "Using VBA, split string and set first item only to variable?", "body": "<p><code>myvar = split(mystring, \",\")(0)</code> will work since <code>split(mystring, \",\")</code> is a 0-based array.</p>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2693, "favorite_count": 0, "accepted_answer_id": 36048388, "answer_count": 1, "score": 2, "last_activity_date": 1458246794, "creation_date": 1458168100, "last_edit_date": 1458246794, "question_id": 36048354, "link": "https://stackoverflow.com/questions/36048354/using-vba-split-string-and-set-first-item-only-to-variable", "title": "Using VBA, split string and set first item only to variable?", "body": "<p>What is the easiest way to set my variable = to the first item of the string after split?\nmyvar should = \"this\"</p>\n\n<pre><code>  mystring = \"this,that,theother\"\n  myvar = split(mystring, \",\")\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1458823675, "creation_date": 1458823675, "answer_id": 36200595, "question_id": 36048231, "link": "https://stackoverflow.com/questions/36048231/how-do-i-highlight-all-text-and-wrap-in-data-exported-from-access-to-excel-using/36200595#36200595", "title": "How do I highlight all text and wrap in data exported from Access to Excel using VBA?", "body": "<p>Probably the following would work clearly for you:</p>\n\n<pre><code>objApp.ActiveWorkbook.Worksheets(1).usedrange.wraptext=true\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6074102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f968b6376a519b3355f62395ea54f9c?s=128&d=identicon&r=PG&f=1", "display_name": "CluelessVBAAccess", "link": "https://stackoverflow.com/users/6074102/cluelessvbaaccess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458823675, "creation_date": 1458167536, "last_edit_date": 1458823446, "question_id": 36048231, "link": "https://stackoverflow.com/questions/36048231/how-do-i-highlight-all-text-and-wrap-in-data-exported-from-access-to-excel-using", "title": "How do I highlight all text and wrap in data exported from Access to Excel using VBA?", "body": "<p>I am using VBA in Access to export a file into Excel and format the text in Excel.  I am trying to highlight all data in Excel (once it has been exported) and then wrap that data using VBA code in Access.</p>\n\n<p>How would I get this task completed?   </p>\n\n<p>Trying to use the code below is not working.  The data starts in cell A1 and should end with the end xlright ans down (meaning, I do not have a set column or row where the data ends).</p>\n\n<pre><code>objApp.ActiveWorkbook.Worksheets(1).Activate\nobjApp.ActiveWorkbook.Worksheets(1).Range(\"A1\").Select\nobjApp.ActiveWorkbook.Worksheets(1).Selection.End(xlToRight).Select\nobjApp.ActiveWorkbook.Worksheets(1).Selection.End(xlDown).Select\nobjApp.Selection.WrapText = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy", "rows"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6074050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154658053565021/picture?type=large", "display_name": "Damien Minter", "link": "https://stackoverflow.com/users/6074050/damien-minter"}, "edited": false, "score": 0, "creation_date": 1458180479, "post_id": 36048108, "comment_id": 59749104, "body": "I went with the top one. It worked perfectly. Thanks"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1458169962, "last_edit_date": 1458169962, "creation_date": 1458167036, "answer_id": 36048108, "question_id": 36047959, "link": "https://stackoverflow.com/questions/36047959/copy-specific-columns-for-particular-row-not-entire-row-into-another-sheet-e/36048108#36048108", "title": "Copy specific columns for particular row (not entire row) into another sheet - Excel Macro", "body": "<pre><code>c.EntireRow.Range(\"C1:X1\").Copy\n</code></pre>\n\n<p>Here \"C1:X1\" is <em>relative</em> to the specificed row.  </p>\n\n<p>Similarly</p>\n\n<pre><code>someRectangularRange.Range(\"A1\")\n</code></pre>\n\n<p>is the top-left cell in <code>someRectangularRange</code></p>\n"}], "owner": {"reputation": 51, "user_id": 6074050, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154658053565021/picture?type=large", "display_name": "Damien Minter", "link": "https://stackoverflow.com/users/6074050/damien-minter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3061, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459502833, "creation_date": 1458166433, "last_edit_date": 1459502833, "question_id": 36047959, "link": "https://stackoverflow.com/questions/36047959/copy-specific-columns-for-particular-row-not-entire-row-into-another-sheet-e", "title": "Copy specific columns for particular row (not entire row) into another sheet - Excel Macro", "body": "<p>I am trying to get a macro to copy rows dependent on certain criteria, in this case \"FX Ccy Options\", for a table of data using column M. I have manged to do this with the below code, but I don't want to copy the entire row (c.EntireRow.copy). Just for all the columns with data (C:X). </p>\n\n<pre><code>Sub Button2_Click()\n\n    Dim bottomL As Integer\n    bottomL = Sheets(\"DGM\").Range(\"M\" &amp; Rows.Count).End(xlUp).Row: x = 1\n\n    Dim c As Range\n    For Each c In Sheets(\"DGM\").Range(\"M1:M\" &amp; bottomL)\n        If c.Value = \"FX Ccy Options\" Then\n            c.EntireRow.Copy Worksheets(\"sheet2\").Range(\"A\" &amp; x + 1)\n            x = x + 1\n        End If\n    Next c\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5602195, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eYeln.jpg?s=128&g=1", "display_name": "Randy", "link": "https://stackoverflow.com/users/5602195/randy"}, "edited": false, "score": 0, "creation_date": 1458168214, "post_id": 36047495, "comment_id": 59745170, "body": "Works like I needed. Greatly appreciated."}, {"owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "reply_to_user": {"reputation": 23, "user_id": 5602195, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eYeln.jpg?s=128&g=1", "display_name": "Randy", "link": "https://stackoverflow.com/users/5602195/randy"}, "edited": false, "score": 0, "creation_date": 1458174322, "post_id": 36047495, "comment_id": 59747308, "body": "Thanks Randy. You can mark it as the correct answer to close the post if you wish :) Thanks."}], "tags": [], "owner": {"reputation": 1362, "user_id": 4910205, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wz5LG.jpg?s=128&g=1", "display_name": "Brendan Gooden", "link": "https://stackoverflow.com/users/4910205/brendan-gooden"}, "is_accepted": true, "score": 0, "last_activity_date": 1458174601, "last_edit_date": 1458174601, "creation_date": 1458164440, "answer_id": 36047495, "question_id": 36047183, "link": "https://stackoverflow.com/questions/36047183/select-all-visible-worksheets-to-print-to-pdf/36047495#36047495", "title": "Select all &quot;visible&quot; worksheets (to print to pdf)", "body": "<p>Try this code, it should do what you are looking for.</p>\n\n<pre><code>Sub SelectSheets()\n    Dim myArray() As Variant\n    Dim i As Integer\n    Dim j As Integer\n    j = 0\n    For i = 1 To Sheets.Count\n        If Sheets(i).Visible = True Then\n            ReDim Preserve myArray(j)\n            myArray(j) = i\n            j = j + 1\n        End If\n    Next i\n    Sheets(myArray).Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1458165357, "post_id": 36047582, "comment_id": 59743929, "body": "very similar to what Brendan Gooden posted while I was writing my solution. the differences lay functionally in that it&#39;s more general (you can specify the workbook you need visible sheets names from) and more reusable (you can call it form your code more time without having to rewrite it). From the coding optimization point of view in that it uses <code>ReDim</code> only twice, it uses a String array instead of a Variant one. most of what above may not be felt by the user but I think they&#39;re good coding habits."}, {"owner": {"reputation": 23, "user_id": 5602195, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eYeln.jpg?s=128&g=1", "display_name": "Randy", "link": "https://stackoverflow.com/users/5602195/randy"}, "edited": false, "score": 0, "creation_date": 1458166018, "post_id": 36047582, "comment_id": 59744231, "body": "I inadvertently hit the button to note your solution was not useful. I reversed it immediately, sorry. I&#39;ll give your solution a try. Much appreciated."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1458164790, "creation_date": 1458164790, "answer_id": 36047582, "question_id": 36047183, "link": "https://stackoverflow.com/questions/36047183/select-all-visible-worksheets-to-print-to-pdf/36047582#36047582", "title": "Select all &quot;visible&quot; worksheets (to print to pdf)", "body": "<p>try this</p>\n\n<pre><code>Option Explicit\n\nSub main()\n\nThisWorkbook.Sheets(GetVisibleWorksheetsNames(ThisWorkbook)).Select\n\nEnd Sub\n\n\nFunction GetVisibleWorksheetsNames(wb As Workbook) As String()\nDim ws As Worksheet\nDim wsNames() As String\nDim iV As Long\n\nWith wb\n    ReDim wsNames(1 To .Worksheets.Count)\n    For Each ws In .Worksheets\n        If ws.Visible Then\n            iV = iV + 1\n            wsNames(iV) = ws.name\n        End If\n    Next ws\n    ReDim Preserve wsNames(1 To iV)\nEnd With\n\nGetVisibleWorksheetsNames = wsNames\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 3, "last_activity_date": 1458176422, "creation_date": 1458176422, "answer_id": 36049826, "question_id": 36047183, "link": "https://stackoverflow.com/questions/36047183/select-all-visible-worksheets-to-print-to-pdf/36049826#36049826", "title": "Select all &quot;visible&quot; worksheets (to print to pdf)", "body": "<p>A short approach that uses the <code>False</code> argument to add to an existing selection:</p>\n\n<pre><code>Sub Test()\nDim ws As Worksheet\nFor Each ws In ActiveWorkbook.Sheets\n If ws.Visible Then ws.Select False\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5602195, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eYeln.jpg?s=128&g=1", "display_name": "Randy", "link": "https://stackoverflow.com/users/5602195/randy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3301, "favorite_count": 0, "accepted_answer_id": 36047495, "answer_count": 3, "score": 1, "last_activity_date": 1458177046, "creation_date": 1458163273, "last_edit_date": 1458177046, "question_id": 36047183, "link": "https://stackoverflow.com/questions/36047183/select-all-visible-worksheets-to-print-to-pdf", "title": "Select all &quot;visible&quot; worksheets (to print to pdf)", "body": "<p>I'm using the following in an existing app and this works fine as is to print particular worksheets to a pdf: </p>\n\n<pre><code>Sheets(Array(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\")).Select\n</code></pre>\n\n<p>I'm trying to print an array of just my <strong>\"visible\"</strong> worksheets. </p>\n\n<p>I've searched for a solution but can't put my finger on it.</p>\n"}, {"tags": ["excel", "vba", "powerpivot", "powerquery", "pivot-chart"], "comments": [{"owner": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "edited": false, "score": 0, "creation_date": 1458175390, "post_id": 36047180, "comment_id": 59747580, "body": "Can you check your Excel version number to make sure you have the latest fixes installed?  <a href=\"https://support.microsoft.com/en-us/gp/office-2013-365-update\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/gp/office-2013-365-update</a> or  <a href=\"https://technet.microsoft.com/library/dn789213(v=office.14)\" rel=\"nofollow noreferrer\">technet.microsoft.com/library/dn789213(v=office.14)</a>"}, {"owner": {"reputation": 948, "user_id": 5867672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc90776a7f4a8344c766894d44529e?s=128&d=identicon&r=PG&f=1", "display_name": "ImkeF", "link": "https://stackoverflow.com/users/5867672/imkef"}, "edited": false, "score": 0, "creation_date": 1458204797, "post_id": 36047180, "comment_id": 59758377, "body": "The option &quot;visually indicate items with no data&quot; can become very costly on performance: <a href=\"http://www.ssas-info.com/analysis-services-articles/53-excel/2567-excel-slicer-impact-on-query-performance\" rel=\"nofollow noreferrer\">ssas-info.com/analysis-services-articles/53-excel/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 6071145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90f40803794f6dad6f8df172590dacb?s=128&d=identicon&r=PG&f=1", "display_name": "Zach H", "link": "https://stackoverflow.com/users/6071145/zach-h"}, "edited": false, "score": 0, "creation_date": 1458219168, "post_id": 36047180, "comment_id": 59768805, "body": "There was an update which I didn\u2019t expect because I have updates to this Office product enabled and they should be downloaded and installed automatically.  That was obviously a bad assumption on my part. I was not prompted to reboot after the install but I did anyway. Unfortunately the update did not fix the issue.  I did however receive a new message to send information about the crash to Microsoft, which I did.    Was running version: 15.0.4797.1003 Now running version: 15.0.4805.1003"}, {"owner": {"reputation": 11, "user_id": 6071145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90f40803794f6dad6f8df172590dacb?s=128&d=identicon&r=PG&f=1", "display_name": "Zach H", "link": "https://stackoverflow.com/users/6071145/zach-h"}, "edited": false, "score": 0, "creation_date": 1458221243, "post_id": 36047180, "comment_id": 59770402, "body": "My slicers are set to &quot;Hide items with no data&quot;. I have tried both settings.  My thinking was that the difference in processing between these two settings was probably related to this glitch in some way, but it crashes either way.  I tried switching this again after updating to no avail."}, {"owner": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "edited": false, "score": 0, "creation_date": 1458250413, "post_id": 36047180, "comment_id": 59790299, "body": "@ZachH now that you are on the latest version if it still happens then opening a support case is the best way forward"}], "owner": {"reputation": 11, "user_id": 6071145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90f40803794f6dad6f8df172590dacb?s=128&d=identicon&r=PG&f=1", "display_name": "Zach H", "link": "https://stackoverflow.com/users/6071145/zach-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 833, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458168774, "creation_date": 1458163257, "last_edit_date": 1458168774, "question_id": 36047180, "link": "https://stackoverflow.com/questions/36047180/excel-crashes-when-cross-filtering", "title": "Excel crashes when cross filtering", "body": "<p>I have a read only 2013 workbook I use as a template tool with a data model going to 4 linked pivot charts with slicer enabled cross filtering.  When I select filter options on one slicer that filter out all options with data on another slicer my workbook crashes.  </p>\n\n<p>That is to say, slicer 1 has an option A, B, C and so on.</p>\n\n<ul>\n<li>Option A is related to a subset 1, 2 &amp; 3 on slicer 2.</li>\n<li>Option B is related to a subset 4, 5 &amp; 6 on slicer 2.</li>\n</ul>\n\n<p>If slicer 2 has any data selected and I filter slicer 1 to preclude any portion of that selection my workbook crashes.  </p>\n\n<p>Things that didn\u2019t work:</p>\n\n<ul>\n<li>I have rebuilt the charts, slicers and connections and still get the same issue.  </li>\n<li>I built a very simple model in another workbook and could not reproduce the issue.  </li>\n<li>I turned off events.</li>\n<li>I commented out my VBA.</li>\n</ul>\n\n<p>If I am careful so select items that share a slicer 1 relationship from slicer 2 things seem to \u201cwork\u201d but something is clearly broken here.  </p>\n\n<p>This condition seems to only occur when there is no overlap in related subsets to slicer 1 from slicer 2.  If option A has a subset 1, 2, 3, 4, 5. . . and option B has a 3, 4, 5 but no 1 or 2 I don\u2019t get the issue, its only when all subsets are unique to the parent and selections don\u2019t overlap (like no 5 in A = crash when 5 is unique to B and A is selected).  I couldn\u2019t find any known issues related to this.  </p>\n\n<p>Event Viewer shows:</p>\n\n<pre><code>Faulting application name: EXCEL.EXE, version: 15.0.4797.1003, time stamp: 0x56bf05fc\n    Faulting module name: msolap110_xl.DLL, version: 0.0.0.0, time stamp: 0x55b0c5bf\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Could \u201cmsolap110_xl.DLL\u201d be the issue or is it more likely part of the symptom?</p></li>\n<li><p>Have I mishandled the pivot charts, slicers or data model in some way to cause this?</p></li>\n<li><p>Can it be fixed?</p></li>\n</ol>\n\n<p>Relevant Programming:</p>\n\n<pre><code>Private Sub myReloadDataModel()\n    If Range(\"myHasPath\").Value = \"True\" Then\n        MsgBox \"You need to enter a path to a valid target location.\", vbOKOnly, \"Bad Path\"\n    Else\n        myUser = MsgBox(\"Are you sure you want Reload the Data Model with any csv data located in the target path?\", vbOKCancel, \"3. Load Data Model\")\n        If myUser = vbOK Then\n\n            Application.ScreenUpdating = False\n            Application.EnableEvents = False\n            Application.Cursor = xlWait\n\n            myTime01 = Time\n            Sheets(\"Notes\").Unprotect\n            Sheets(\"2. Get Table\").Unprotect\n            ActiveWorkbook.RefreshAll\n'            ActiveWorkbook.Model.Refresh\n'            ActiveWorkbook.Connections(\"Query - myGetMasterSpan\").Refresh\n            x = ActiveWorkbook.Connections(\"Query - myGetMasterSpan\").ModelTables.Item(1).RecordCount\n            myTime02 = Time\n            myTime03 = Format(myTime02 - myTime01, \"HH:MM:SS\")\n\n            Sheets(\"2. Get Table\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n                , AllowUsingPivotTables:=True\n\n            Application.Cursor = xlDefault\n            Application.EnableEvents = True\n            Application.ScreenUpdating = True\n\n            MsgBox Format(x, \"#,##0\") &amp; \" Records Loaded!\" &amp; vbNewLine _\n                &amp; vbNewLine _\n                &amp; \"Total Update Time = \" &amp; myTime03, , \"Update Completed\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>event</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n    On Error Resume Next\n    Application.ScreenUpdating = Fales\n    Application.EnableEvents = False\n    Sheets(\"2. Get Table\").Unprotect\n\n    Application.Run \"mySlicerMagic\"\n    ActiveWorkbook.Connections(\"LinkedTable_Table6\").Refresh\n\n    Set myChart04 = Sheets(\"Flow Errors\").ChartObjects(\"Chart 4\").Chart\n        myChart04.ChartTitle.Text = Range(\"myErrorsTitle\")\n    With myChart04.Axes(xlValue)\n        .MinimumScale = Range(\"myMin_Scale\")\n        .MaximumScale = Range(\"myMax_Scale\")\n    End With\n\n    Set myChart05 = Sheets(\"Flow Errors\").ChartObjects(\"Chart 5\").Chart\n        myChart05.ChartTitle.Text = Range(\"myErrorsTitle\")\n    With myChart05.Axes(xlValue)\n        .MinimumScale = Range(\"myMin_Zoom\")\n        .MaximumScale = Range(\"myMax_Zoom\")\n    End With\n\n        Application.Run \"myChart5Format\"\n\n    Set thisPulseChart_02 = Sheets(\"Pulse Analyzer\").ChartObjects(\"Chart 2\").Chart\n    With thisPulseChart_02\n        .ChartTitle.Text = \"Full Pulse Flow - \" &amp; Range(\"myErrorsTitle\")\n    End With\n    With thisPulseChart_02.Axes(xlValue)\n        .MaximumScale = Range(\"myMax_Scale\") + 0.09\n    End With\n\n    Set thisPulseChart_03 = Sheets(\"Pulse Analyzer\").ChartObjects(\"Chart 3\").Chart\n    With thisPulseChart_03\n        .ChartTitle.Text = \"Raw Pulse Flow by Pulse- \" &amp; Range(\"myErrorsTitle\")\n    End With\n\n        Application.Run \"myChart3Format\"\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This sub gets the selection range for me</p>\n\n<pre><code>Private Sub mySlicerMagic()\n    On Error GoTo 100\n\n    Set myX = ActiveWorkbook.SlicerCaches(\"Slicer_Pulse_Set\").SlicerCacheLevels(1).SlicerItems\n\n    For i = 1 To myX.Count\n        If myX(i).Selected = True Then\n            x = x + 1\n            If x = 1 Then\n                myItemName01 = myX(i).SourceName\n            End If\n            myItemName02 = myX(i).SourceName\n        End If\n    Next\n\n    Range(\"myPulseRange\")(1, 1) = myItemName01\n    Range(\"myPulseRange\")(2, 1) = myItemName02\n100\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "import", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1458174099, "post_id": 36047013, "comment_id": 59747244, "body": "I used linked tables and append queries. They work pretty well."}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1458619613, "post_id": 36047013, "comment_id": 59929587, "body": "Best? Don&#39;t know. For csv data, an import specification will get the data in the fastest, though given you only want a portion of it, I&#39;d be picking you&#39;re best to read it a line at a time, to locate what it is you want. For .xlsx, I&#39;d think you&#39;ll need to open it via create object, and hopefully you can locate the data via a named range, though if you do have to loop through cells for the table I doubt it would be that slow. Once you&#39;ve found your data SQL is usually faster for manipulating/using data than using cursors and loops."}], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 0, "creation_date": 1458935936, "post_id": 36207534, "comment_id": 60085295, "body": "Thanks all,  I&#39;ve been doing my research and given your responses this is what I see:  1.  Setting up a staging table seems like the easiest practice 2. I want to access the CSV data in such a way that I can use query to extract the data I want.    Here is my big question:     How do I identify the table I want within the CSV.  There is a lot of useless information at the top of the file, and the table I want (labeled &quot;Report Fields&quot; is underneath).  Given the current methods, I can&#39;t see hot to do that."}, {"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 0, "creation_date": 1459456874, "post_id": 36207534, "comment_id": 60308463, "body": "I&#39;ve added an edit to help better explain the issues I&#39;m running into with this method."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1458844249, "creation_date": 1458844249, "answer_id": 36207534, "question_id": 36047013, "link": "https://stackoverflow.com/questions/36047013/access-data-import-best-practices/36207534#36207534", "title": "Access - Data import best practices", "body": "<p>Excactly, linked tables and append queries.  Or, load your data into a staging table (i.e., temp table) and append records from that (which presumably has everything).  So, you would append ONLY the records you need into your production table.</p>\n"}], "owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594642417, "creation_date": 1458162642, "last_edit_date": 1594642417, "question_id": 36047013, "link": "https://stackoverflow.com/questions/36047013/access-data-import-best-practices", "title": "Access - Data import best practices", "body": "<p>this is a best practices question.</p>\n\n<p><strong>The Task:</strong></p>\n\n<p>I need to import a report to Access 2013.  The report can be generated as either a .csv file, or a .xlsx file. During the import process I need to:</p>\n\n<ol>\n<li>Ignore lines of irrelevant data and import only the data in one section of the report. This <em>relevant</em> data will be in a proper\ntable with table name, table header, and then records  below it.</li>\n<li>Match columns (most likely by header) with existing data in my database.</li>\n<li>Import matching columns to the proper matching columns, in the proper matching tables of the database, and type the data accordingly.</li>\n<li>Generate custom Keys for imported records. </li>\n</ol>\n\n<p>There are many ways to go about it, i'm just looking for a little input from the community as to what might be the most efficient way.  Speed of import is important, you can assume the report will have somewhere in the neighborhood of 50k records. </p>\n\n<p><strong>Background on me:</strong></p>\n\n<p>I am a very advanced programmer with some experience on VBA and very little experience within MSAccess. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>My data looks like this:</p>\n\n<pre><code> Title Cell\n File Info Cell\n Time Date Cell\n\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n Data1, Data 2\n ....(continues for around 800 rows)\n\n Second Table Title Cell\n Col1Title, Col2Title, ColTitle, Col4Title ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)    \n Data 3,    Data4,     Data 5,   Data6 ....(continues for around 50 columns)\n ...(Continues for around 1500 rows)\n End of CSV\n</code></pre>\n\n<p>I guess the big problem is how to extract just table 2 from the text file.  This seems to be preventing me from using SQL to query the data.  Can I select just the second table of the text file? </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1458161914, "post_id": 36046719, "comment_id": 59742166, "body": "Normally you introduce another column (possibly hidden) to store the result of <code>EXTREMELY LONG COMPLICATED FORMULA</code>, and then you refer to that twice from the actual formula."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458163251, "post_id": 36046719, "comment_id": 59742904, "body": "Also just a FWIW all the Row() counters do not need to be sheet specific: <code>ROW(ImportedData!A$2:A$1000)</code> gives the same answer as <code>ROW($2:$1000)</code> with less typing."}, {"owner": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1458166955, "post_id": 36046719, "comment_id": 59744649, "body": "@GSerg - Thank you for your suggestion of adding helper columns. That is what I was leaning toward but, since each column has it&#39;s own references, I&#39;m going to have to create multiple helper columns and then hide them. I was hoping there was an easier way."}, {"owner": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458167142, "post_id": 36046719, "comment_id": 59744740, "body": "@ScottCraner - Since I am referencing rows on other sheets I thought I had to reference those sheets. Thank you for saving me the typing."}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "edited": false, "score": 0, "creation_date": 1458167546, "post_id": 36046806, "comment_id": 59744908, "body": "As I commented above: &quot;Thank you for your suggestion of adding helper columns. That is what I was leaning toward but, since each column has it&#39;s own references, I&#39;m going to have to create multiple helper columns and then hide them. I was hoping there was an easier way.&quot;"}, {"owner": {"reputation": 39443, "user_id": 129164, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec326c009186734854c600265b69a6ce?s=128&d=identicon&r=PG", "display_name": "devuxer", "link": "https://stackoverflow.com/users/129164/devuxer"}, "reply_to_user": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "edited": false, "score": 0, "creation_date": 1458170850, "post_id": 36046806, "comment_id": 59746192, "body": "That&#39;s usually the best way. It&#39;s a bit of a nuisance, but much less of a nuisance than having to make every edit to a formula twice."}, {"owner": {"reputation": 39443, "user_id": 129164, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec326c009186734854c600265b69a6ce?s=128&d=identicon&r=PG", "display_name": "devuxer", "link": "https://stackoverflow.com/users/129164/devuxer"}, "reply_to_user": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "edited": false, "score": 0, "creation_date": 1458171589, "post_id": 36046806, "comment_id": 59746446, "body": "@user2597747, Please see my edit. Perhaps that will help you avoid helper columns."}, {"owner": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "edited": false, "score": 0, "creation_date": 1458229722, "post_id": 36046806, "comment_id": 59777298, "body": "The solution in your edit works great for numerical values. I&#39;ll use helper columns for text. Thank you."}], "tags": [], "owner": {"reputation": 39443, "user_id": 129164, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec326c009186734854c600265b69a6ce?s=128&d=identicon&r=PG", "display_name": "devuxer", "link": "https://stackoverflow.com/users/129164/devuxer"}, "is_accepted": false, "score": 3, "last_activity_date": 1458171550, "last_edit_date": 1458171550, "creation_date": 1458161948, "answer_id": 36046806, "question_id": 36046719, "link": "https://stackoverflow.com/questions/36046719/in-excel-how-can-i-avoid-repeating-a-big-part-of-the-formula-just-to-check-if-t/36046806#36046806", "title": "In Excel, how can I avoid repeating a big part of the formula just to check if the return value is blank?", "body": "<p>The most obvious solution is to use a helper column or cell. Just put <code>EXTREMELY LONG COMPLICATED FORMULA</code> somewhere in your spreadsheet, then refer to that cell in your <code>IF</code> formula.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>To avoid a helper column, here is a trick I've used on occasion:</p>\n\n<pre><code>=IFERROR(VALUE(long_formula&amp;\"\"),\"\")\n</code></pre>\n\n<p>What this does is, concatenate the result of long formula with an empty string (which converts it to a string), then take the value of all that (which converts it back to a number if possible), then substitute any errors with a blank. (An error would occur if you attempt to take the value of something that's not numerical.)</p>\n\n<p><em>This will only work if you either have a numerical result or an empty result. It will fail if you have a text result.</em></p>\n"}, {"comments": [{"owner": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "edited": false, "score": 0, "creation_date": 1458230107, "post_id": 36056175, "comment_id": 59777611, "body": "The second case formatting option will not work when the referenced cell has a zero in it. I would need it to return the zero. The IfEmpty function solves it. Thanks."}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": true, "score": 0, "last_activity_date": 1458206292, "creation_date": 1458206292, "answer_id": 36056175, "question_id": 36046719, "link": "https://stackoverflow.com/questions/36046719/in-excel-how-can-i-avoid-repeating-a-big-part-of-the-formula-just-to-check-if-t/36056175#36056175", "title": "In Excel, how can I avoid repeating a big part of the formula just to check if the return value is blank?", "body": "<p>Do you need the blank in the cell for further calulations or if-functions or Do you just dont want to see the 0s?</p>\n\n<p>Second case:\nJust use a number format for the column like</p>\n\n<p><code>0,00;-0,00;\"\";@</code></p>\n\n<p>First case:\nPut the following code in a module:</p>\n\n<pre><code>Option Explicit\n\nPublic Function IfEmpty(LongFormula As String) As String\n    If LongFormula = \"\" Then\n        IfEmpty = \"\"\n    Else\n        IfEmpty = LongFormula\n    End If\nEnd Function\n</code></pre>\n\n<p>And use it in your worksheet like </p>\n\n<pre><code>=IfEmpty(**EXTREMELY LONG COMPLICATED FORMULA**)\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 2597747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3a3b372d8411795bad153a1bf13d0a?s=128&d=identicon&r=PG", "display_name": "user2597747", "link": "https://stackoverflow.com/users/2597747/user2597747"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 36056175, "answer_count": 2, "score": 1, "last_activity_date": 1458206292, "creation_date": 1458161634, "last_edit_date": 1531161705, "question_id": 36046719, "link": "https://stackoverflow.com/questions/36046719/in-excel-how-can-i-avoid-repeating-a-big-part-of-the-formula-just-to-check-if-t", "title": "In Excel, how can I avoid repeating a big part of the formula just to check if the return value is blank?", "body": "<p>I have a situation where I am referencing cells in a different worksheet and returning the values of cells from that worksheet. Although it works, I find my current method inefficient because I have to repeat the formula in the logical test part of the IF statement:</p>\n\n<pre><code>=IF(**EXTREMELY LONG COMPLICATED FORMULA** &lt;&gt; \"\", **EXTREMELY LONG COMPLICATED FORMULA**, \"\")\n</code></pre>\n\n<p>As you can see, I must repeat the main part of the formula just to check if it is blank first. If I do not do this, I get a zero in the cell (for blank values in the referenced worksheet). I'm looking for something more like:</p>\n\n<pre><code>=IF(**EXTREMELY LONG COMPLICATED FORMULA** &lt;&gt; \"\", **RETURN VALUE**, \"\")\n</code></pre>\n\n<p>This looks cleaner to me because I won't have to repeat myself. Also, if we ever have to update the formula, I won't have to duplicate my changes to the repeated parts. <strong>Is there a way to do this?</strong></p>\n\n<p>The above is actually a simplified version of my problem, but the answer should get me where I need to go. My actual formula has nested IF statements checking along the way for blanks. For reference, here it is:</p>\n\n<pre><code>=IFERROR(IF(SMALL(IF(ImportedData!$H$2:$H$1000&gt;=DataFilters!$A$1,IF(ImportedData!$G$2:$G$1000=DataFilters!$A$15,ROW(ImportedData!A$2:A$1000)-ROW(ImportedData!A$2)+1)),ROWS(ImportedData!A$2:ImportedData!A2))&lt;&gt;\"\",IF(INDEX(ImportedData!A$2:A$1000,SMALL(IF(ImportedData!$H$2:$H$1000&gt;=DataFilters!$A$1,IF(ImportedData!$G$2:$G$1000=DataFilters!$A$15,ROW(ImportedData!A$2:A$1000)-ROW(ImportedData!A$2)+1)),ROWS(ImportedData!A$2:ImportedData!A2)))&lt;&gt;\"\",INDEX(ImportedData!A$2:A$1000,SMALL(IF(ImportedData!$H$2:$H$1000&gt;=DataFilters!$A$1,IF(ImportedData!$G$2:$G$1000=DataFilters!$A$15,ROW(ImportedData!A$2:A$1000)-ROW(ImportedData!A$2)+1)),ROWS(ImportedData!A$2:ImportedData!A2))),\"\"),\"\"),\"\")\n</code></pre>\n"}, {"tags": ["arrays", "vba", "class", "object", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6073502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209874647769595/picture?type=large", "display_name": "sweBers", "link": "https://stackoverflow.com/users/6073502/swebers"}, "edited": false, "score": 0, "creation_date": 1458219318, "post_id": 36046714, "comment_id": 59768917, "body": "I tried that, as it seemed to be the most straightforward approach.  Unfortunately, I could not assign the variant array returned by the function to a new variant array.  Paraphrasing, I got an error stating that I could not assign to an array.  It works though when I change cAgentInfo to a cAgent data type."}], "tags": [], "owner": {"reputation": 1345, "user_id": 4771174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nPr2P.png?s=128&g=1", "display_name": "koolhuman", "link": "https://stackoverflow.com/users/4771174/koolhuman"}, "is_accepted": false, "score": 0, "last_activity_date": 1458194740, "last_edit_date": 1458194740, "creation_date": 1458161612, "answer_id": 36046714, "question_id": 36046329, "link": "https://stackoverflow.com/questions/36046329/vba-passing-objects-between-functions/36046714#36046714", "title": "VBA - passing objects between functions", "body": "<p>Try declaring</p>\n\n<pre><code>Dim cAgentInfo As Variant \n</code></pre>\n\n<p>as an array like this:</p>\n\n<pre><code>Dim cAgentInfo() As Variant\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6073502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209874647769595/picture?type=large", "display_name": "sweBers", "link": "https://stackoverflow.com/users/6073502/swebers"}, "edited": false, "score": 0, "creation_date": 1458219179, "post_id": 36047103, "comment_id": 59768812, "body": "This is what worked.  I was not aware I could declare the function as an array of the class I created.  I thought I could only pass arrays as a variant."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1458162945, "creation_date": 1458162945, "answer_id": 36047103, "question_id": 36046329, "link": "https://stackoverflow.com/questions/36046329/vba-passing-objects-between-functions/36047103#36047103", "title": "VBA - passing objects between functions", "body": "<p>I can't catch your big design, so I try suggesting</p>\n\n<pre><code>Private Sub cmdAssignRecords_Click()\n'Dim cAgentInfo As Variant\nDim cAgentInfo() As cAgent\n...\n</code></pre>\n\n<p>and</p>\n\n<pre><code>'Function CalculateRecords() As Variant\nFunction CalculateRecords() As cAgent()\n</code></pre>\n\n<p>that way you can use cAgentInfo(0).AgentNames(0) in function <code>CalculateRecords</code></p>\n"}], "owner": {"reputation": 13, "user_id": 6073502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209874647769595/picture?type=large", "display_name": "sweBers", "link": "https://stackoverflow.com/users/6073502/swebers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 36047103, "answer_count": 2, "score": 0, "last_activity_date": 1458194740, "creation_date": 1458160242, "question_id": 36046329, "link": "https://stackoverflow.com/questions/36046329/vba-passing-objects-between-functions", "title": "VBA - passing objects between functions", "body": "<p>First question here.  I've been looking for answers to this question for days, and have worked out MOST of what I've been trying to do myself.  I'd like to share what I found, and hope that someone can suggest a better way to make this work.</p>\n\n<p>I have a function that uses several of one class, and then needs to return this information in an array for use elsewhere.  The code that uses this needs to break this information back down, and reuse the information returned.  The reason it's not all one block of code is that the function is called many times without asking for the return values.</p>\n\n<p>The part of the Class module that we are concerned about is below.  This is the ONLY way I have been able to get it to work.  Mind the parentheses and count the parameters.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate p_intaryAgentNames() As Integer\n\nPublic Property Get AgentNames() As Variant\n        AgentNames = p_intaryAgentNames()\nEnd Property\n\nPublic Property Let AgentNames(IncomingArray As Variant)\n  If IsArray(IncomingArray) Then\n        If UBound(p_intaryAgentNames) &lt;&gt; UBound(IncomingArray) Then ReDim Preserve p_intaryAgentNames(UBound(IncomingArray))\n        p_intaryAgentNames() = IncomingArray\n    Else\n        MsgBox (\"Invalid information passed to AgentNames array\")\n    End If\nEnd Property\n\nPublic Property Get Filter() As String\n    Filter = p_strFilter\nEnd Property\n\nPublic Property Let Filter(value As String)\n    p_strFilter = value\nEnd Property\n\nPrivate Sub Class_Initialize()\n\n    ReDim p_intaryAgentNames(0)\n\nEnd Sub\n</code></pre>\n\n<p>When finishing my function, this is how I use my object members, put them into an array, then pass it to the calling code:</p>\n\n<pre><code>Function CalculateRecords() As Variant\n\nConst CONSTANTSTRINGZEROLENGTH As String = \"\"\n\nDim objRec1 As cAgent\nDim objRec2 As cAgent\nDim objRec3 As cAgent\n\nSet objRec1 = New cAgent\nSet objRec2 = New cAgent\nSet objRec3 = New cAgent\n\nDim objAgents(2) As cAgent\n'some things happen\nSet objAgents(0) = objRec1\nSet objAgents(1) = objRec2\nSet objAgents(2) = objRec3\n\n\nCalculateRecords = objAgents\nEnd Function\n</code></pre>\n\n<p>This is how I plan to unpack the data, but it doesn't seem like I'm using it right:</p>\n\n<p>Private Sub cmdAssignRecords_Click()</p>\n\n<pre><code>Dim cAgentInfo As Variant\nDim objRec1 As cAgent\nSet objRec1 = New cAgent\nDim objRec2 As cAgent\nSet objRec2 = New cAgent\nDim objRec3 As cAgent\nSet objRec3 = New cAgent\n\ncAgentInfo = CalculateRecords() 'A variant to catch a variant\n\nSet objRec1 = cAgentInfo(0) \nSet objRec2 = cAgentInfo(0) \nSet objRec3 = cAgentInfo(0) \n</code></pre>\n\n<p>What I would rather do is use cAgentInfo() directly, and this works for other objects of the class.  What I cannot do is access cAgentInfo(0).AgentNames(0), while objRec1.AgentNames(0) and cAgentInfo(0).filter work just fine.  </p>\n\n<p>I'm sure I'm just missing something here, or maybe I'm just throwing myself against a wall.  Any suggestions as to what I'm missing, or how I can improve are well-appreciated.  I feel like doing it this way will improve readability, but isn't it also wasting namespace?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1458160511, "post_id": 36046240, "comment_id": 59741332, "body": "The issue is you cannot use a disjointed range in Countif().  So you need to set the rngdata part to the extents as in this case <code>B3:P81</code>."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458160706, "post_id": 36046240, "comment_id": 59741444, "body": "there are some other items in that region that are duplicates that I do not want highlighted... how else can I get around this?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458161053, "post_id": 36046240, "comment_id": 59741637, "body": "Yes you can set a double loop through the data testing whether it is equal or not,and not use the countif."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1458164983, "post_id": 36046787, "comment_id": 59743754, "body": "This is setting every cell in the range to have a red font color, changing it from black. It is not checking the duplicates."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1458165495, "post_id": 36046787, "comment_id": 59743989, "body": "@Kish see edit, I forgot to exclude itself when looking for duplicates."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1458166644, "post_id": 36046787, "comment_id": 59744527, "body": "It works! There is one small issue. When I type in a new cell within the range, it automatically turn red even if there is no, unless I run the macro again then it corrects itself. I would like for it to stay black in the first instance and show up red only when it is a duplicate-- after running the macro"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1458168167, "post_id": 36046787, "comment_id": 59745147, "body": "That is a different question but the quick answer is call this sub from a worksheet change event."}, {"owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "edited": false, "score": 0, "creation_date": 1458168622, "post_id": 36046787, "comment_id": 59745332, "body": "OK, I will post it separately since I need help with the code."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1458165464, "last_edit_date": 1458165464, "creation_date": 1458161872, "answer_id": 36046787, "question_id": 36046240, "link": "https://stackoverflow.com/questions/36046240/conditional-formatting-in-vba/36046787#36046787", "title": "Conditional Formatting in VBA", "body": "<p>As per comment you would need to loop twice:</p>\n\n<pre><code>Sub Duplicate()\nDim rngData As Range\nDim cell As Range\nDim cell2 As Range\n\nSet rngData = Range(\"P3:P19, P56:P58, P39:P42, P21:P25, P27:P37, P39:P42, P39:P42, P44:P54, M25:M76, B69:B77, B66:E67, B51:B64, H44:H47, D44:D47, H42, H33:H40, D33:D42, H31, D28:D31, H28:H29, D5:D8\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n\nrngData.Font.Color = vbBlack\n\nFor Each cell In rngData\n    If cell.Font.Color = vbBlack Then\n        For Each cell2 In rngData\n            If cell = cell2 And cell.Address &lt;&gt; cell2.Address Then\n                cell.Font.Color = vbRed\n                cell2.Font.Color = vbRed\n            End If\n        Next\n    End If\nNext\n\n\nSet rngData = Nothing\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4068364, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bfb0239a8a1cabf7366df3c1887e0c76?s=128&d=identicon&r=PG&f=1", "display_name": "Kish", "link": "https://stackoverflow.com/users/4068364/kish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 36046787, "answer_count": 1, "score": 0, "last_activity_date": 1458165464, "creation_date": 1458159921, "last_edit_date": 1531161705, "question_id": 36046240, "link": "https://stackoverflow.com/questions/36046240/conditional-formatting-in-vba", "title": "Conditional Formatting in VBA", "body": "<p>I am tying to manage duplicates on an Excel sheet by having the duplicate cells turn red. I put this in a use to sheet protection to keep from editing the conditional formatting for these columns. However, when I move the cell information (by clicking and dragging) the conditional formatting moves from that cell as well. At the end of the day, I do not have duplicate coverage for every cell that I want. Is there some way I can prevent this from happening when I move the cell, or what macro can I put in to take care of this? </p>\n\n<p>I want to do something like this using VBA:</p>\n\n<pre><code>Sub Duplicate()\nDim rngData As Range\nDim cell As Range\n\nSet rngData = Range(\"P3:P19, P56:P58, P39:P42, P21:P25, P27:P37, P39:P42, P39:P42, P44:P54, M25:M76, B69:B77, B66:E67, B51:B64, H44:H47, D44:D47, H42, H33:H40, D33:D42, H31, D28:D31, H28:H29, D5:D8\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\nFor Each cell In rngData\ncell.Offset(0, 0).Font.Color = vbBlack          ' DEFAULT COLOR\n' LOCATE DUPLICATE VALUE(S) IN THE SPECIFIED RANGE OF DATA.\n        If Application.Evaluate(\"COUNTIF(\" &amp; rngData.Address &amp; \",\" &amp; cell.Address &amp; \")\") &gt; 1 Then\n            cell.Offset(0, 0).Font.Color = vbRed        ' CHANGE FONT COLOR TO RED.\n        End If\n    Next cell\n\n    Set rngData = Nothing\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>But I get a \"Type Mismatch\" error at:\nIf Application.Evaluate(\"COUNTIF(\" &amp; rngData.Address &amp; \",\" &amp; cell.Address &amp; \")\") > 1 Then </p>\n\n<p>How can I get around this?</p>\n"}, {"tags": ["string", "vba", "class", "variables", "declaration"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458160243, "post_id": 36045982, "comment_id": 59741178, "body": "Look at CallByName"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1458161174, "post_id": 36045982, "comment_id": 59741698, "body": "Do you mean Method, or Property here?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1458165564, "post_id": 36045982, "comment_id": 59744026, "body": "I&#39;m with Tim: CallByName is the way to go"}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458219616, "post_id": 36045982, "comment_id": 59769129, "body": "@TimWilliams, apologies I was getting confused, I actually want to use a string to reference a class of a particular module , see edited above"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458231078, "post_id": 36045982, "comment_id": 59778334, "body": "I don&#39;t think you can do that, but a simpler approach using <code>Select Case</code> would work fine - presumably there is a finite list of class types you need to handle ?"}], "owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458220392, "creation_date": 1458159051, "last_edit_date": 1458220392, "question_id": 36045982, "link": "https://stackoverflow.com/questions/36045982/dynamicaly-referencing-class-based-on-a-string-variable", "title": "Dynamicaly referencing class based on a string variable", "body": "<p>I'm fairly new to vba. I have a vba script that basically connects to my database using the ADODB class and returns a recordset with a bunch of information in. One column is entitled Class and it will contain the name of a Class that i'm looking to use in vb, the Class I want to use will change based on the value in the row. Is there a way I can declare and instantiate an object of this class based on the string I receive from each field under the column class. The purpose being that I need  information for each row based on the class it contains  without having to account for all possibilities.</p>\n\n<p>for example</p>\n\n<pre><code> Dim Class as string\n\n Class = Array(1, 4) ' Array(1, 4) contains Maths Class\n\n Dim x as Class\n\n Set x = New Class\n</code></pre>\n\n<p>if for example the particular Class is Math that would equate to</p>\n\n<pre><code> Dim x as Math\n\n Set x = New Math\n</code></pre>\n\n<p>Is there a Function that could return the Class based on the string value? Thanks</p>\n"}, {"tags": ["excel", "hamming-distance", "hammingweight", "vba"], "comments": [{"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 1, "creation_date": 1470377334, "post_id": 36045792, "comment_id": 64935226, "body": "Your <code>x</code> and <code>y</code> can&#39;t be <code>Long</code>. For 96 bits, you&#39;ll have to work with strings as inputs rather than <code>Integer</code>, <code>Long</code>, <code>LongLong</code>, or <code>Double</code>, since these all store 64 or fewer bits. This is unwieldy and requires you to write large number arithmetic functions <a href=\"http://www.tushar-mehta.com/misc_tutorials/project_euler/LargeNumberArithmetic.htm\" rel=\"nofollow noreferrer\">like here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "is_accepted": true, "score": 2, "last_activity_date": 1481208223, "creation_date": 1481208223, "answer_id": 41042110, "question_id": 36045792, "link": "https://stackoverflow.com/questions/36045792/calculate-hamming-weight-and-or-distance-in-vba-excel/41042110#41042110", "title": "Calculate Hamming weight and/or distance in VBA Excel", "body": "<p>If you store the chain of qualities in String form (e.g. a String consisting only of the letters 'T' and 'F'), this could quite easily be done using a loop.</p>\n\n<pre><code>Function hammingDistance(qualities1 As String, qualities2 As String) As Integer\n\n    If Len(qualities1) &lt;&gt; Len(qualities2) Then\n        hammingDistance = -1\n        Exit Function\n    End If\n\n    Dim i, result As Integer\n    result = 0\n\n    For i = 1 To Len(qualities1)\n        If Mid(qualities1, i, 1) &lt;&gt; Mid(qualities2, i, 1) Then result = result + 1\n    Next\n\n    hammingDistance = result\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 2261631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQPMH.jpg?s=128&g=1", "display_name": "P. O.", "link": "https://stackoverflow.com/users/2261631/p-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 0, "accepted_answer_id": 41042110, "answer_count": 1, "score": 3, "last_activity_date": 1481208223, "creation_date": 1458158370, "last_edit_date": 1531164843, "question_id": 36045792, "link": "https://stackoverflow.com/questions/36045792/calculate-hamming-weight-and-or-distance-in-vba-excel", "title": "Calculate Hamming weight and/or distance in VBA Excel", "body": "<p>I\u2019m trying to compare clients, two by two, whose qualities can be defined by binary choices (for example a client uses a product or not).<br>\nAfter much search online, it looks like I\u2019d need to use the Hamming Distance for that, or its equivalent:  find the Hamming Weight to the result of an XOR operation between two words.</p>\n\n<p>For a concrete example, <strong>Hamming distance between 1001 &amp; 1011:</strong> </p>\n\n<blockquote>\n  <p>Calculate the number 1001 XOR 1011= 0010<br>\n  Hamming weight of 0010 = 1 (numbers of bit set to\n  1 in 0010)</p>\n</blockquote>\n\n<p>I need to do  that in for words up to 96 bits.</p>\n\n<p>I found some information on </p>\n\n<p><a href=\"http://people.revoledu.com/kardi/tutorial/Similarity/HammingDistance.html\" rel=\"nofollow noreferrer\">http://people.revoledu.com/kardi/tutorial/Similarity/HammingDistance.html</a></p>\n\n<p><a href=\"http://trustedsignal.blogspot.ca/2015/06/xord-play-normalized-hamming-distance.html\" rel=\"nofollow noreferrer\">http://trustedsignal.blogspot.ca/2015/06/xord-play-normalized-hamming-distance.html</a></p>\n\n<p>and plenty of pieces of code , for example </p>\n\n<p><a href=\"https://stackoverflow.com/questions/9946115/hamming-weight-written-only-in-binary-operations\">Hamming weight written only in binary operations?</a>  </p>\n\n<p>but only in C, Java , Perl, O, opencl... anything but Excel VBA. </p>\n\n<p>So far, here\u2019s what I manage to put together.</p>\n\n<p>It works, but unfortunately <strong>only for words of 30 bits or less</strong>, and uses a somewhat crude method: XOR on the two numbers X and Y, then convert to a string that represent the binary number. Then count the length of the string once the 1\u2019s are taken out. I guess there\u2019s a more elegant and efficient way. </p>\n\n<pre><code>Public Function HamDist(x As Long, y As Long, NbBit As Integer)\n\nDim i As Long, BinStrg As String, bxor As Long \n\nbxor = x Xor y \n\nBinStrg = \"\" \n\nFor i = NbBit To 0 Step -1 \u2018going from left to right \n         If bxor And (2 ^ i) Then\n            BinStrg = BinStrg + \"1\" \u2018add a 1 to the string \n         Else\n            BinStrg = BinStrg + \"0\"\n         End If\n      Next\n\n HamDist = Len(BinStrg) - Len(Replace(BinStrg, \"1\", \"\")) ' replace the 1 by nothing and count  the length of the resulting string \nEnd Function\n</code></pre>\n\n<p>Can you help make it works <strong>for 96 bit words in VBA for Excel 2010</strong> and below (udf or sub), either by calculating the hamming weight or distance ?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458156998, "post_id": 36045304, "comment_id": 59739223, "body": "you can use <code>IF</code> statements in formulas to determine which of the 6 different types it is and then adjust accordingly. If you update the question with the an example of each type and what it needs to convert to you, we can help you more."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1458157177, "post_id": 36045304, "comment_id": 59739336, "body": "Hard to say if this will work without more sample data (can really only test against what you&#39;ve provided), but perhaps try <code>=MID(REPLACE(A1,LEN(A1)-2,1,&quot;&#47;&quot;),MIN(FIND({1,2,3,4,5,6,7,8,9&zwnj;&#8203;},A1&amp;123456789)),LEN&zwnj;&#8203;(A1))</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1458158287, "post_id": 36045304, "comment_id": 59740031, "body": "Welcome to SO.  This is not a free code-writing service but exists to help others with code or functions they are trying to develop.  As such, we expect to see clear cut questions with examples of data, attempted code, actual output, desired output, research efforts to solve the problem, etc.  Please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>; and also <a href=\"http://stackoverflow.com/help/mcve\">How to Provide an Example</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1458158718, "creation_date": 1458158718, "answer_id": 36045887, "question_id": 36045304, "link": "https://stackoverflow.com/questions/36045304/in-excel-vba-id-like-to-change-and-delete-some-character-from-a-type-of-ip-form/36045887#36045887", "title": "In Excel VBA I&#39;d like to change and delete some character from a type of IP format", "body": "<p>From your sample (and inferred from your description) try,</p>\n\n<pre><code>=SUBSTITUTE(REPLACE(SUBSTITUTE(A2, CHAR(45), CHAR(95)), 1, FIND(CHAR(95), A2), \"\"), CHAR(95), CHAR(47))\n</code></pre>\n\n<p>That should cover at least one of your 5-7 format variations, perhaps more. More assistance can be forthcoming if you supply examples on non-working formats.</p>\n\n<p>\u00a0\u00a0<a href=\"https://i.stack.imgur.com/L2LO6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L2LO6.png\" alt=\"ip_mask_parsing\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 6073408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7819ae646fd3d0a016ae786dbcb85867?s=128&d=identicon&r=PG&f=1", "display_name": "Bence Barb&#233;ly", "link": "https://stackoverflow.com/users/6073408/bence-barb%c3%a9ly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1458217354, "accepted_answer_id": 36045887, "answer_count": 1, "score": -1, "last_activity_date": 1458158718, "creation_date": 1458156756, "question_id": 36045304, "link": "https://stackoverflow.com/questions/36045304/in-excel-vba-id-like-to-change-and-delete-some-character-from-a-type-of-ip-form", "closed_reason": "Needs more focus", "title": "In Excel VBA I&#39;d like to change and delete some character from a type of IP format", "body": "<p>I have a task at work, that's about making an excel macro for some virtual servers, which can collect the right ip adresses into an other sheet.</p>\n\n<p>So my problem is that the VM table's original ip format is like this host_192.168.1.39_32 and I need to change it to 192.168.1.39/32. This seems quite easy, but there are 6 kind of different formats, for example the ips are longer, isntead of 'host' there is 'net' and before the netmask there is '-' symbol.</p>\n\n<p>I tried with the excel's own functions, RIGHT and LEFT, but for the 6 typle of formats I faild.</p>\n\n<p>Can anyone help me with a scheme macro?\nThanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1458155690, "post_id": 36044781, "comment_id": 59738402, "body": "To access the list of a Data Validation Cell, you have to use the <code>Rng.Validation.Formula1</code>. You may want to see <a href=\"http://stackoverflow.com/questions/16426939/edit-or-export-drop-down-lists-in-excel\">This</a>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1458155845, "post_id": 36044781, "comment_id": 59738492, "body": "There are two ways to setup <b>DV</b>.  The first is using a set of worksheet cells; the second is an internal list..................which are you using ??"}, {"owner": {"reputation": 105, "user_id": 5112291, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f34e18de359c7a7a13a7f65d6e320b38?s=128&d=identicon&r=PG&f=1", "display_name": "Zeta", "link": "https://stackoverflow.com/users/5112291/zeta"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1458165558, "post_id": 36044781, "comment_id": 59744024, "body": "Hi @Gary&#39;sStudent, I am using the 2nd form."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1458166147, "post_id": 36044781, "comment_id": 59744290, "body": "@Zeta  My posted code will handle either form..............."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5112291, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f34e18de359c7a7a13a7f65d6e320b38?s=128&d=identicon&r=PG&f=1", "display_name": "Zeta", "link": "https://stackoverflow.com/users/5112291/zeta"}, "edited": false, "score": 0, "creation_date": 1458167613, "post_id": 36045952, "comment_id": 59744929, "body": "This is a great start for me and I am adapting the code. Do you know if I can have the code to return each value in the Data Validation in alphabetical order?"}, {"owner": {"reputation": 105, "user_id": 5112291, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f34e18de359c7a7a13a7f65d6e320b38?s=128&d=identicon&r=PG&f=1", "display_name": "Zeta", "link": "https://stackoverflow.com/users/5112291/zeta"}, "edited": false, "score": 0, "creation_date": 1458168070, "post_id": 36045952, "comment_id": 59745104, "body": "Also, can you explain the logic behind S,1 and Range(Mid(s,2) in your code?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 105, "user_id": 5112291, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f34e18de359c7a7a13a7f65d6e320b38?s=128&d=identicon&r=PG&f=1", "display_name": "Zeta", "link": "https://stackoverflow.com/users/5112291/zeta"}, "edited": false, "score": 0, "creation_date": 1458169473, "post_id": 36045952, "comment_id": 59745678, "body": "@Zeta  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1458169441, "last_edit_date": 1458169441, "creation_date": 1458158947, "answer_id": 36045952, "question_id": 36044781, "link": "https://stackoverflow.com/questions/36044781/is-there-a-way-to-manipulate-each-item-in-data-validation-in-vba/36045952#36045952", "title": "Is there a way to manipulate each item in Data Validation in VBA?", "body": "<p>There are <strong>2</strong> forms of DV.  One that uses a list of cells like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mUzOZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mUzOZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the other that uses an internal comma separated list like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xnyGF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xnyGF.png\" alt=\"enter image description here\"></a></p>\n\n<p>This code will handle either form:</p>\n\n<pre><code>Sub IsDV()\n    Dim s As String, r As Range, rng As Range\n\n    s = \"NO DV\"\n    On Error Resume Next\n    With ActiveCell\n        s = .Validation.Formula1\n        On Error GoTo 0\n    End With\n\n    If s = \"NO DV\" Then\n        MsgBox s\n        Exit Sub\n    End If\n\n    If Left(s, 1) = \"=\" Then\n        Set rng = Range(Mid(s, 2))\n        For Each r In rng\n            MsgBox r.Value\n        Next r\n        Exit Sub\n    End If\n\n    ary = Split(s, \",\")\n    For Each a In ary\n        MsgBox a\n    Next a\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>As the picture shows, <code>Formula1</code> creates a string.  If that string begins with an <strong>=</strong> sign, then the rest of the string is an <code>Address</code>.  So I discard the <strong>=</strong> sign and make a range.  Knowing the range allows me to grab the items</p>\n"}], "owner": {"reputation": 105, "user_id": 5112291, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f34e18de359c7a7a13a7f65d6e320b38?s=128&d=identicon&r=PG&f=1", "display_name": "Zeta", "link": "https://stackoverflow.com/users/5112291/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458169441, "creation_date": 1458155023, "question_id": 36044781, "link": "https://stackoverflow.com/questions/36044781/is-there-a-way-to-manipulate-each-item-in-data-validation-in-vba", "title": "Is there a way to manipulate each item in Data Validation in VBA?", "body": "<p>I am trying to do a loop function in VBA to select every item in the data validation (22 items) and Copy and Paste on newsheets based on the item name. </p>\n\n<p>I tried Record Macro to see the language from selecting different data validation items but nothing is registering. Is there a way to manipulate each item in Data Validation in VBA?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "is_accepted": false, "score": 1, "last_activity_date": 1458243469, "creation_date": 1458243469, "answer_id": 36070157, "question_id": 36044720, "link": "https://stackoverflow.com/questions/36044720/find-next-record-based-on-certain-criteria/36070157#36070157", "title": "Find next record based on certain criteria", "body": "<p>I was able to fix the problem by setting applying a filter for sensitivity on the actual forms On_Load event rather than the command button. It now works using a next record command button added with the default code/settings! </p>\n"}], "owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458243469, "creation_date": 1458154868, "question_id": 36044720, "link": "https://stackoverflow.com/questions/36044720/find-next-record-based-on-certain-criteria", "title": "Find next record based on certain criteria", "body": "<p>I am trying to use the .FindNext (and .FindPrevious) function on an update form \"next button\" to find the record that meets certain criteria. </p>\n\n<pre><code>Private Sub NextRecord_Click()\nDim foundmatch As Boolean\n\nFor x = 0 To 3 Step 1\n  With Me.RecordsetClone\n    .FindNext \"[Sensitivity] = \" &amp; [TempVars]![AccessLevel] + x\n    If .NoMatch Then\n        foundmatch = False\n    Else\n        Me.Bookmark = .Bookmark\n        foundmatch = True\n        Exit For\n    End If\n  End With\nNext\nIf foundmatch = False Then\n    MsgBox \"No More Records\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Upon a user entering the database the users accesslevel is assigned to a temp variable (1 to 4), and each project has a sensitivity rating of 1 to 4. The code below was used and worked for both next and previous only in finding records when the sensitivity and accesslevel were equal but not for sensitivities below the users access level which they are qualified to see. </p>\n\n<pre><code>Private Sub PrevRecord_Click()\nDim Stringy As String\nStringy = \"[Sensitivity] = \" &amp; [txtaccess]\nWith Me.RecordsetClone\n.FindPrevious Stringy\nIf .NoMatch Then\nMsgBox \"No More Records\"\nElse\nMe.Bookmark = .Bookmark\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> The form is pulled from a query with Sensitivity one of the fields, and [txtaccess] is a text box on the field with the default value set at [TempVars]![AccessLevel]. I've also tried changing it to:</p>\n\n<pre><code>Stringy = \"[Sensitivity] &gt;= \" &amp; [txtaccess]\n</code></pre>\n\n<p>but that doesn't work either</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 1, "creation_date": 1458155328, "post_id": 36044716, "comment_id": 59738191, "body": "You need to add the reference &quot;Microsoft Scripting Runtime&quot;"}, {"owner": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1458155340, "post_id": 36044716, "comment_id": 59738198, "body": "I have it added already. It can&#39;t seem to find &quot;.Dictionary&quot; of &quot;Scripting&quot;"}, {"owner": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1458155452, "post_id": 36044716, "comment_id": 59738258, "body": "Doesn&#39;t seem to matter though, it runs in a blink of an eye even with late binding. Why is that code so much faster than what I have?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1458155681, "post_id": 36044716, "comment_id": 59738397, "body": "Reading cell by cell is slow with excel. It&#39;s faster to load the data in an array and write them back if necessary."}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1458165841, "post_id": 36044716, "comment_id": 59744146, "body": "The only problem you&#39;ll encounter with the dictionary approach is that the cell&#39;s value will be taken into the dictionary.  That&#39;s fine for text; any numbers will lose currency or thousand separators and dates will convert to a value (the date/time value right now is 42445.92)"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "reply_to_user": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1458171067, "post_id": 36044716, "comment_id": 59746259, "body": "@NeepNeepNeep this is another reason why the orthodox method I show is best practice."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1507200129, "post_id": 36044716, "comment_id": 80120101, "body": "How can reach values  that saved in <code>unique</code> variable?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 1, "creation_date": 1507200323, "post_id": 36044716, "comment_id": 80120223, "body": "@MGae2M, use <code>.Keys()</code> on the dictionary to get the unique values in an array."}, {"owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "edited": false, "score": 0, "creation_date": 1522789723, "post_id": 36044716, "comment_id": 86285972, "body": "Any suggestion how I can convert to the unique values in a string separated by comma. I am new to array and not quite able to figure it out how to achieve this."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "edited": false, "score": 0, "creation_date": 1522789963, "post_id": 36044716, "comment_id": 86286074, "body": "@Chito, ask/post a question."}, {"owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "edited": false, "score": 0, "creation_date": 1522791231, "post_id": 36044716, "comment_id": 86286609, "body": "@FlorentB. I have the below code, not getting any error while running but how I can get the unique values in a string separated each value by comma?  <code>Sub test()  Dim data() Dim unique As Variant Dim r As Long  data = ThisWorkbook.Sheets(&quot;LT ID-IP-PR&quot;).UsedRange.Value  Set unique = CreateObject(&quot;Scripting.Dictionary&quot;) For r = 1 To UBound(data)     unique(data(r, 1)) = Empty  Next r  End Sub</code>"}, {"owner": {"reputation": 109, "user_id": 4765367, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70ab36fdb24961af0d4aac6b152f75d4?s=128&d=identicon&r=PG&f=1", "display_name": "AmericanCities", "link": "https://stackoverflow.com/users/4765367/americancities"}, "edited": false, "score": 0, "creation_date": 1572443824, "post_id": 36044716, "comment_id": 103561484, "body": "@FlorentB. Thanks for code!  Can you share how you would call RemoveDuplicates() from another sub?  This would be a big help to me.  If I was calling this sub, would DATA be an empty array, or the entire range of data?  Are the columns empty ie, 1, 2 or are they columns with data in them?  Thanks!"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 109, "user_id": 4765367, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70ab36fdb24961af0d4aac6b152f75d4?s=128&d=identicon&r=PG&f=1", "display_name": "AmericanCities", "link": "https://stackoverflow.com/users/4765367/americancities"}, "edited": false, "score": 0, "creation_date": 1572447062, "post_id": 36044716, "comment_id": 103563504, "body": "@AmericanCities, the sub removes the duplicated rows in the provided 2D array. columns is the indexes of the columns that contain the duplicate information. It needs to be provided and can&#39;t be empty. For example: <code>data = Range(&quot;A1:B10&quot;).Value</code>, <code>RemoveDuplicates data, 1, 2</code>."}, {"owner": {"reputation": 109, "user_id": 4765367, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70ab36fdb24961af0d4aac6b152f75d4?s=128&d=identicon&r=PG&f=1", "display_name": "AmericanCities", "link": "https://stackoverflow.com/users/4765367/americancities"}, "edited": false, "score": 0, "creation_date": 1572452990, "post_id": 36044716, "comment_id": 103566979, "body": "@FlorentB. Thanks a ton!  Confirms I was calling it correctly.  My issue was that I was using Union(rng1,rng2).value for data and not contiguous blocks.  When I re-ordered my columns together and created the range, your code worked and performed beautifully!  This will speed along my program, so many thanks!"}, {"owner": {"reputation": 1994, "user_id": 2117037, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ba92d2cbd6945934f38d5aa952ffcab2?s=128&d=identicon&r=PG", "display_name": "Leo Gurdian", "link": "https://stackoverflow.com/users/2117037/leo-gurdian"}, "edited": false, "score": 0, "creation_date": 1600832732, "post_id": 36044716, "comment_id": 113209328, "body": "@FlorentB. thank you so much for putting this together, it really helped me out! upvote+"}, {"owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "edited": false, "score": 0, "creation_date": 1611687516, "post_id": 36044716, "comment_id": 116529925, "body": "I think some small updates may be needed to the first block of code at the start of this post to make it work, and make it more robust while I&#39;m at it:  ``` lang-vb Dim data(), dict As Object, r As Long Set dict = CreateObject(&quot;Scripting.Dictionary&quot;)  data = ActiveSheet.UsedRange.Columns(1).Value  For r = 1 To UBound(data)     dict(data(r, some_column_number)) = Empty Next  data = WorksheetFunction.Transpose(dict.keys()) ```"}, {"owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "edited": false, "score": 0, "creation_date": 1611688226, "post_id": 36044716, "comment_id": 116530192, "body": "@FlorentB: Sorry about my previous comment here; please ignore (still learning to format, and didn&#39;t see a way to &#39;preview&#39; my comment).  Anyway--I was saying that I think some small updates may be needed to the first block of code at the start of this post to make it work, and make it more robust while I&#39;m at it:  <b>1)</b> (required?): <code>ActiveSheet.UsedRange.Columns(**some_column_number**).Value</code>.    <b>2)</b> (required?): <code>dict(data(r, **1**)) = Empty</code>.    <b>3)</b> <code>(optional?) For r = **LBound(data)** To UBound(data)</code>.   (Note &#39;**&#39;s are only for emphasis on what changed; not literal)"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 22, "last_activity_date": 1562168604, "last_edit_date": 1562168604, "creation_date": 1458154862, "answer_id": 36044716, "question_id": 36044556, "link": "https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba/36044716#36044716", "title": "Quicker way to get all unique values of a column in VBA?", "body": "<p>Loading the values in an array would be much faster:</p>\n\n<pre><code>Dim data(), dict As Object, r As Long\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\ndata = ActiveSheet.UsedRange.Columns(1).Value\n\nFor r = 1 To UBound(data)\n    dict(data(r, some_column_number)) = Empty\nNext\n\ndata = WorksheetFunction.Transpose(dict.keys())\n</code></pre>\n\n<p>You should also consider early binding for the Scripting.Dictionary:</p>\n\n<pre><code>Dim dict As New Scripting.Dictionary  ' requires `Microsoft Scripting Runtime` '\n</code></pre>\n\n<p>Note that using a dictionary is way faster than <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.advancedfilter?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm144078)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"noreferrer\">Range.AdvancedFilter</a> on large data sets.</p>\n\n<p>As a bonus, here's a procedure similare to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.removeduplicates?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm144243)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"noreferrer\">Range.RemoveDuplicates</a> to remove duplicates from a 2D array:</p>\n\n<pre><code>Public Sub RemoveDuplicates(data, ParamArray columns())\n    Dim ret(), indexes(), ids(), r As Long, c As Long\n    Dim dict As New Scripting.Dictionary  ' requires `Microsoft Scripting Runtime` '\n\n    If VarType(data) And vbArray Then Else Err.Raise 5, , \"Argument data is not an array\"\n\n    ReDim ids(LBound(columns) To UBound(columns))\n\n    For r = LBound(data) To UBound(data)         ' each row '\n        For c = LBound(columns) To UBound(columns)   ' each column '\n            ids(c) = data(r, columns(c))                ' build id for the row\n        Next\n        dict(Join$(ids, ChrW(-1))) = r  ' associate the row index to the id '\n    Next\n\n    indexes = dict.Items()\n    ReDim ret(LBound(data) To LBound(data) + dict.Count - 1, LBound(data, 2) To UBound(data, 2))\n\n    For c = LBound(ret, 2) To UBound(ret, 2)  ' each column '\n        For r = LBound(ret) To UBound(ret)      ' each row / unique id '\n            ret(r, c) = data(indexes(r - 1), c)   ' copy the value at index '\n        Next\n    Next\n\n    data = ret\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1535, "user_id": 451456, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4c4d2097aad9133400fe2fa4bc3fc3da?s=128&d=identicon&r=PG", "display_name": "Gopalakrishna Palem", "link": "https://stackoverflow.com/users/451456/gopalakrishna-palem"}, "edited": false, "score": 1, "creation_date": 1547864509, "post_id": 36048357, "comment_id": 95351234, "body": "Good method. But one should be careful that this modifies the original source column."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1458168147, "creation_date": 1458168147, "answer_id": 36048357, "question_id": 36044556, "link": "https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba/36048357#36048357", "title": "Quicker way to get all unique values of a column in VBA?", "body": "<p>Try this</p>\n\n<pre><code>Option Explicit\n\nSub UniqueValues()\nDim ws As Worksheet\nDim uniqueRng As Range\nDim myCol As Long\n\nmyCol = 5 '&lt;== set it as per your needs\nSet ws = ThisWorkbook.Worksheets(\"unique\") '&lt;== set it as per your needs\n\nSet uniqueRng = GetUniqueValues(ws, myCol)\n\nEnd Sub\n\n\nFunction GetUniqueValues(ws As Worksheet, col As Long) As Range\nDim firstRow As Long\n\nWith ws\n    .Columns(col).RemoveDuplicates Columns:=Array(1), header:=xlNo\n\n    firstRow = 1\n    If IsEmpty(.Cells(1, col)) Then firstRow = .Cells(1, col).End(xlDown).row\n\n    Set GetUniqueValues = Range(.Cells(firstRow, col), .Cells(.Rows.Count, col).End(xlUp))\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>it should be quite fast and without the drawback NeepNeepNeep told about</p>\n"}, {"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 1, "creation_date": 1529427806, "post_id": 36048717, "comment_id": 88865614, "body": "2 issues. #1 - this is pasting data into sheet, as opposed to saving it in a VBA variable. #2 - It is looking at formulas instead of actual values (for me, instead of pasting unique values in the column, it only pasted one common formula into one cell)."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1529448106, "post_id": 36048717, "comment_id": 88874067, "body": "@ZygD 1. The Range is a variable, you use it in VBA. 2. You&#39;re doing it wrong, use Paste As Value instead of doing it on formula&#39;s."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1529483832, "post_id": 36048717, "comment_id": 88885030, "body": "1. Even though technically speaking Range is a variable... but the thing is, you cannot use <code>AdvancedFilter</code> method to put data to only a &quot;VBA-visible&quot; variable like array or dictionary (i.e. without &quot;physical&quot; presence in the worksheet). 2. I cannot find how to do it, does this <code>AdvancedFilter</code> method really provide the option to paste as values?"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1529485613, "post_id": 36048717, "comment_id": 88886041, "body": "Issue #3 - this method removes the original filter in the sheet, if it existed."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1529566764, "post_id": 36048717, "comment_id": 88922571, "body": "#1 you can do the filter and put the results in an Array or Collection, those types don&#39;t have inbuilt methods to filter unique, #2 you paste values in the  sheet AND then apply the filter #3 that&#39;s by design. ps I&#39;m not here to discuss using Excel, maybe ask on SuperUser."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1562167880, "post_id": 36048717, "comment_id": 100295642, "body": "<code>AdvancedFilter</code> is not the fastest way. On large data sets, using a dictionary will outperform and by far <code>AdvancedFilter</code> (~500ms vs ~60sec for 100k cells)."}], "tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": false, "score": 37, "last_activity_date": 1569919824, "last_edit_date": 1569919824, "creation_date": 1458169836, "answer_id": 36048717, "question_id": 36044556, "link": "https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba/36048717#36048717", "title": "Quicker way to get all unique values of a column in VBA?", "body": "<p><strong>Use Excel's AdvancedFilter function to do this.</strong> </p>\n\n<p>Using Excels inbuilt C++ is the fastest way with smaller datasets, using the dictionary is faster for larger datasets. For example:</p>\n\n<p>Copy values in Column A and insert the unique values in column B:</p>\n\n<pre><code>Range(\"A1:A6\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"B1\"), Unique:=True\n</code></pre>\n\n<hr>\n\n<p>It <em>works</em> with multiple columns too:</p>\n\n<pre><code>Range(\"A1:B4\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"D1:E1\"), Unique:=True\n</code></pre>\n\n<p>Be careful with multiple columns as it doesn't always work as expected. In those cases I resort to removing duplicates which works by choosing a selection of columns to base uniqueness. Ref: <a href=\"https://support.office.com/en-us/article/find-and-remove-duplicates-00e35bea-b46a-4d5d-b28e-66a552dc138d\" rel=\"noreferrer\">MSDN - Find and remove duplicates</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RvA5R.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/RvA5R.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here I remove duplicate columns based on the third column:</p>\n\n<pre><code>Range(\"A1:C4\").RemoveDuplicates Columns:=3, Header:=xlNo\n</code></pre>\n\n<p>Here I remove duplicate columns based on the second and third column:</p>\n\n<pre><code>Range(\"A1:C4\").RemoveDuplicates Columns:=Array(2, 3), Header:=xlNo\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 2, "creation_date": 1508414104, "post_id": 36076071, "comment_id": 80605850, "body": "This is brilliant!"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 9, "last_activity_date": 1458274817, "creation_date": 1458274817, "answer_id": 36076071, "question_id": 36044556, "link": "https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba/36076071#36076071", "title": "Quicker way to get all unique values of a column in VBA?", "body": "<p>PowerShell is a very powerful and efficient tool. This is cheating a little, but shelling PowerShell via VBA opens up lots of options</p>\n\n<p>The bulk of the code below is simply to save the current sheet as a <em>csv</em> file. The output is another <em>csv</em> file with just the unique values</p>\n\n<pre><code>Sub AnotherWay()\nDim strPath As String\nDim strPath2 As String\n\nApplication.DisplayAlerts = False\nstrPath = \"C:\\Temp\\test.csv\"\nstrPath2 = \"C:\\Temp\\testout.csv\"\nActiveWorkbook.SaveAs strPath, xlCSV\nx = Shell(\"powershell.exe $csv = import-csv -Path \"\"\" &amp; strPath &amp; \"\"\" -Header A | Select-Object -Unique A | Export-Csv \"\"\" &amp; strPath2 &amp; \"\"\" -NoTypeInformation\", 0)\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1618210489, "post_id": 67053675, "comment_id": 118523218, "body": "This function is only available in Office 365 I think"}], "tags": [], "owner": {"reputation": 1, "user_id": 15609035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UzIfjp7qc_Y/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucknVqFjzARn2ZKyrt9xva0Ji8JBgA/s96-c/photo.jpg?sz=128", "display_name": "Maxim Karpyn", "link": "https://stackoverflow.com/users/15609035/maxim-karpyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1618209584, "creation_date": 1618209584, "answer_id": 67053675, "question_id": 36044556, "link": "https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba/67053675#67053675", "title": "Quicker way to get all unique values of a column in VBA?", "body": "<p>it's funny because i've had to read these instructions over and over again, but it think i worked out a much faster way to do this:</p>\n<pre><code>Set data = ws.UsedRange\ndim unique as variant\nunique = WorksheetFunction.Unique(data)\n</code></pre>\n<p>And then you can do whatever you want with the <code>unique</code> array such as iterating it:</p>\n<pre><code>For i = LBound(unique) To UBound(unique)\n    Range(&quot;Q&quot; &amp; i) = indexes(i, 1)\nNext\n</code></pre>\n"}], "owner": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165882, "favorite_count": 22, "accepted_answer_id": 36044716, "answer_count": 5, "score": 35, "last_activity_date": 1618209584, "creation_date": 1458154415, "question_id": 36044556, "link": "https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba", "title": "Quicker way to get all unique values of a column in VBA?", "body": "<p>Is there a faster way to do this?</p>\n\n<pre><code>Set data = ws.UsedRange\n\nSet unique = CreateObject(\"Scripting.Dictionary\")\n\nOn Error Resume Next\nFor x = 1 To data.Rows.Count\n    unique.Add data(x, some_column_number).Value, 1\nNext x\nOn Error GoTo 0\n</code></pre>\n\n<p>At this point <code>unique.keys</code> gets what I need, but the loop itself seems to be very slow for files that have tens of thousands of records (whereas this wouldn't be a problem at all in a language like Python or C++ especially).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458155361, "post_id": 36044552, "comment_id": 59738209, "body": "possible candidate for <a href=\"https://codereview.stackexchange.com/\">Code Review</a> assuming the code works as OP says it does."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1458166957, "creation_date": 1458166957, "answer_id": 36048085, "question_id": 36044552, "link": "https://stackoverflow.com/questions/36044552/excel-vba-code-cleanup/36048085#36048085", "title": "Excel vba code cleanup", "body": "<p>Suggestion below.</p>\n\n<p>Also I would avoid <code>Option Base 1</code> - it's rarely used, and will just cause problems later when you get used to working with zero-based arrays.</p>\n\n<pre><code>Sub Print_copy_Current_Workbook()\n    Dim Tabs As Variant\n    Dim I As Long\n\n    Application.ScreenUpdating = False\n\n    Tabs = Array(\"Draw\", \"AIN\", \"Calculations\")\n\n    For I = LBound(Tabs) To UBound(Tabs)\n\n        Sheets(Tabs(I)).PrintOut\n        Sheets.Add(After:=Sheets(Worksheets.Count)).Name = Tabs(I) &amp; \" Final\"\n        CopyPaste Sheets(Tabs(I)).Range(\"A1:L1000\")\n\n    Next I\n\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub CopyPaste(rng As Range)\n    rng.Copy\n    'this is a new sheet we're pasting to, so why not just Range(\"A1\") ?\n    With Sheets(rng.Parent.Name &amp; \" Final\").Range(\"iv1\").End(xlToLeft).Offset(, 1)\n         .PasteSpecial xlPasteFormats\n         .PasteSpecial xlPasteValues\n         .PasteSpecial xlPasteColumnWidths\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6073299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b06f1d742efea8039c02922e5bfb0cd?s=128&d=identicon&r=PG&f=1", "display_name": "A Yoder", "link": "https://stackoverflow.com/users/6073299/a-yoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 36048085, "answer_count": 1, "score": -1, "last_activity_date": 1458166957, "creation_date": 1458154409, "question_id": 36044552, "link": "https://stackoverflow.com/questions/36044552/excel-vba-code-cleanup", "title": "Excel vba code cleanup", "body": "<p>The code below works but isn't fast and I'm sure there are ways it could simplified. I'm not a coder -- I just compiled a few samples that I found.  I really don't understand the range/end/offset pieces for the pasting aspect.  Here's what I'm trying to do:\n1. Print the first three worksheets in the workbook\n2. Create three new worksheets at the end of the workbook\n3. copy and paste values, formats, and column widths to the three new worksheets from the first three.</p>\n\n<p>Thanks for any help you can provide!</p>\n\n<pre><code>Option Explicit\nOption Base 1\nSub Print_copy_Current_Workbook()\n'Prints the current active workbook in Excel\n\nSheets(\"Draw\").PrintOut\nSheets(\"Calculations\").PrintOut\nSheets(\"AIN\").PrintOut\n\nApplication.ScreenUpdating = False\n    Dim Tabs As Variant\n    Dim I As Byte\n    Tabs = Array(\"Draw Final\", \"AIN Final\", \"Calculations Final\")\n    For I = LBound(Tabs) To UBound(Tabs)\n        Sheets.Add(After:=Sheets(Worksheets.Count), Count:=1).Name = Tabs(I)\n            Next I\nSheets(\"Draw\").Range(\"A1:L1000\").Copy\nWith Sheets(\"Draw Final\").Range(\"iv1\").End(xlToLeft).Offset(, 1)\n     .PasteSpecial xlPasteFormats\n     .PasteSpecial xlPasteValues\n     .PasteSpecial xlPasteColumnWidths\nEnd With\nSheets(\"AIN\").Range(\"A1:L1000\").Copy\nWith Sheets(\"AIN Final\").Range(\"iv1\").End(xlToLeft).Offset(, 1)\n     .PasteSpecial xlPasteFormats\n     .PasteSpecial xlPasteValues\n     .PasteSpecial xlPasteColumnWidths\nEnd With\nSheets(\"Calculations\").Range(\"A1:L1000\").Copy\nWith Sheets(\"Calculations Final\").Range(\"iv1\").End(xlToLeft).Offset(, 1)\n     .PasteSpecial xlPasteFormats\n     .PasteSpecial xlPasteValues\n     .PasteSpecial xlPasteColumnWidths\nEnd With\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1458156054, "post_id": 36044491, "comment_id": 59738635, "body": "Ah, yes, we&#39;ve actually gone over this a while back. MoveStart or MoveEnd, as appropriate, with the WdUnits wdWord will do it.... Maybe research those parts of the object model a bit?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1458156459, "post_id": 36044491, "comment_id": 59738865, "body": "@CindyMeister - Ah, yes thanks for the reminder. I&#39;m trying to use <code>moveStart</code>, but get a &quot;Type Mismatch&quot; error when I do. I&#39;ll edit my OP."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1458157373, "post_id": 36044491, "comment_id": 59739458, "body": "If you look at the Help for MoveStart you&#39;ll see it returns an integer for the number of units that were successfully moved. You can&#39;t assign that to a Range object, thus the error message. First do the MoveStart and then, if you need to assign that to a different Range object: <code>Set Check_For_Rorman_Numerals = mySelection.Duplicate</code> Or assign <code>Check_For_Rorman_Numerals</code> first, then MoveStart on that. And yes, you NEED <code>Duplicate</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1458159963, "post_id": 36044491, "comment_id": 59741010, "body": "@CindyMeister - Aha, I think that&#39;s got it!  I&#39;ll read into <code>.Duplicate</code>.  Also, this almost gets me to my final goal (also, I need whitespace removed before the first word), but I&#39;ll play around a lot before asking again.  Thanks so much!"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1594050805, "creation_date": 1458154196, "last_edit_date": 1594050805, "question_id": 36044491, "link": "https://stackoverflow.com/questions/36044491/contract-selection-opposite-of-expand-extend", "title": "&quot;Contract&quot; selection (opposite of Expand/Extend)?", "body": "<p>I'm working on a macro that will scan my document for a word (user inputted). When it finds that word, add the paragraph to a variable.  Then check the first \"word\" in the variable and see if it's a roman numeral.  If it is a roman numeral, I want to reduce the selection to be the second word on to the end.</p>\n\n<p>In Excel, I'd use something like \"Mid\" or \"Right\" to get the text Right of \"x.\" or \"i\".</p>\n\n<p>However, I'm stuck on how to \"resize\" a word selection.  I've searched around but mostly find help in Excel. </p>\n\n<p>Here's the two-part code:</p>\n\n<pre><code>Sub Find_Definitions()\nDim myDoc As Word.Document\nDim oRng As Word.Range, rng As Word.Range\nDim addDefinition$, findText$, editedDefinition$\nSet myDoc = ActiveDocument\n\nfindText = InputBox(\"What term would you like to search for?\")\nIf findText = \"\" Then Exit Sub\n\n'Loop through the document\nSet oRng = myDoc.Content\n\nWith oRng.Find\n    .ClearFormatting\n    .Text = findText\n    .MatchCase = False\n    .Wrap = wdFindContinue\n    While .Execute\n        Set rng = oRng.Paragraphs(1).Range\n        rng.Select\n       ' Here's where I could check the text, and see if it starts with Roman numerals.\n        editedDefinition = Check_For_Roman_Numerals(rng)\n\n    Wend 'end .execute\nEnd With 'oRng.find\n\nEnd Sub\n</code></pre>\n\n<p>and here's the code I'm trying to get working:</p>\n\n<pre><code>Private Function Check_For_Roman_Numerals(ByVal mySelection As Word.Range) As Range\nDim romanNumerals() As Variant\nDim firstWord$, paragraphsText As Variant, xWord As Variant\nDim oWord As Word.Range\nDim i&amp;\nromanNumerals = Array(\"i\", \"ii\", \"iii\", \"iv\", \"v\", \"vi\", \"vii\", \"viii\", \"ix\", \"x\", \"xi\", \"xii\")\nDim editedSelection$\neditedSelection = mySelection.Text\n\nWith mySelection\n    Debug.Print mySelection.Text\n        For i = LBound(romanNumerals) To UBound(romanNumerals)\n            If (mySelection.Words(1) = romanNumerals(i)) Or (mySelection.Words(1) = romanNumerals(i) &amp; \".\") Then\n                'I get a TYPE MISMATCH Error on the next line, highlighting 'MoveStart'\n                Set Check_For_Roman_Numerals = mySelection.MoveStart(unit:=wdWord, Count:=1)\n                Debug.Print Check_For_Roman_Numerals\n                Debug.Print mySelection.Text\n                Exit For\n            End If\n        Next i\nEnd With 'mySelection\n\nSet Check_For_Roman_Numerals = mySelection\n\nEnd Function\n</code></pre>\n\n<p>Thanks for any help or tips.  The idea is the second macro will return text without \"i. \" or \"ii. \" or \"x. \" etc at the start.  Otherwise, return the original text.</p>\n\n<p>Edit: I think I could also try to reduce the <code>rng</code>  by one word, but am not sure how.</p>\n\n<p>Also, I was able to almost get what I want, but do <strong><em>not</em></strong> want the text in the document to change. If I did, the following works (in place of my error line above):\n<code>mySelection.Words(1).Delete</code>. </p>\n\n<p>I need to keep the roman numerals in the word document, I'm just trying to figure out how to remove them (and put in a String perhaps), so I can add the <em>non-roman numeral</em> text to an index's <code>entry</code> and <code>entryautotext</code>.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458308232, "post_id": 36044342, "comment_id": 59816047, "body": "I appreciate the help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1458153735, "creation_date": 1458153735, "answer_id": 36044342, "question_id": 36044036, "link": "https://stackoverflow.com/questions/36044036/how-would-i-remove-all-leading-alphabetical-characters/36044342#36044342", "title": "How would I remove all leading alphabetical characters?", "body": "<p>This short UDF should strip off leading alphabetic characters.</p>\n\n<pre><code>Function noLeadAlpha(str As String)\n    If Not IsNumeric(str) Then\n        Do While Asc(str) &lt; 48 Or Asc(str) &gt; 57\n            str = Mid(str, 2)\n            If Not CBool(Len(str)) Then Exit Do\n        Loop\n    End If\n    noLeadAlpha = str\nEnd Function\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/sx7zN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sx7zN.png\" alt=\"udf_no_leading_alphas\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458306584, "post_id": 36044410, "comment_id": 59814767, "body": "For some reason this formula is not outputting anything. I am pressing ctrl+shift+enter. I entered it the way you have it (but with commas instead of semicolon), but instead of an output when I press ctrl+shift+enter it still shows the formula in the cell."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458307211, "post_id": 36044410, "comment_id": 59815239, "body": "@JoeDolan  It works fine here.  Changing the semicolons to commas within the array constant, and/or using CSE vs just E, should not make any difference.  If your original data does not contain a digit, then, as designed, there will not be any output.  Are there leading characters not to be removed that are other than non-digits?  e.g symbols or Unicode characters?  There were none in your examples.  The other issue might be that the cell reference is incorrect.  I used <code>A1</code>, but maybe you need to change that."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458307230, "post_id": 36044410, "comment_id": 59815264, "body": "@JoeDolan   If the above discussion doesn&#39;t help, post a copy of a workbook showing the problem to some public site, and post a link here."}, {"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458308015, "post_id": 36044410, "comment_id": 59815865, "body": "It worked once I tried it on a different workbook. Not sure what was wrong the first time, but it is all good now."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458308228, "post_id": 36044410, "comment_id": 59816042, "body": "@JoeDolan I misswrote. The problem is a setting that has it showing formulas instead of the calculation in <b>Options</b> or on the formula tab."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 3, "last_activity_date": 1458153954, "creation_date": 1458153954, "answer_id": 36044410, "question_id": 36044036, "link": "https://stackoverflow.com/questions/36044036/how-would-i-remove-all-leading-alphabetical-characters/36044410#36044410", "title": "How would I remove all leading alphabetical characters?", "body": "<p>Here is an Excel formula that will \"strip off the leading alpha characters\"  Actually, it looks for the first numeric character, and returns everything after that:</p>\n\n<pre><code>=MID(A1,MIN(FIND({0;1;2;3;4;5;6;7;8;9},A1&amp;\"0123456789\")),99)\n</code></pre>\n\n<p>The <code>99</code> at the end needs to be some value longer than the longest string you might be processing.  <code>99</code> usually works.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458306478, "post_id": 36044414, "comment_id": 59814691, "body": "For some reason this formula is not outputting anything. I am pressing ctrl+shift+enter. I entered it the way you have it, and tried removing the 255, but instead of an output when I press ctrl+shift+enter it still shows the formula in the cell."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458310827, "post_id": 36044414, "comment_id": 59817963, "body": "@JoeDolan - yes, it had to do with your excel settings. you probably inadvertently turned the option on to show formulas in the cells. and you don&#39;t to enter it as an array formula."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1458153974, "creation_date": 1458153974, "answer_id": 36044414, "question_id": 36044036, "link": "https://stackoverflow.com/questions/36044036/how-would-i-remove-all-leading-alphabetical-characters/36044414#36044414", "title": "How would I remove all leading alphabetical characters?", "body": "<p>Here's a formula based solution complete with test results:</p>\n\n<pre><code>=MID(A1,MIN(SEARCH({0,1,2,3,4,5,6,7,8,9},A1&amp;\"0123456789\"),255),100)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QeND8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QeND8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Change the <code>100</code> at the end if any string may be longer than 100 characters. Also the 255 is not needed, but it won't hurt. </p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "edited": false, "score": 0, "creation_date": 1458308258, "post_id": 36044452, "comment_id": 59816063, "body": "Thanks for the help. I appreciate the time you took."}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1458154060, "creation_date": 1458154060, "answer_id": 36044452, "question_id": 36044036, "link": "https://stackoverflow.com/questions/36044036/how-would-i-remove-all-leading-alphabetical-characters/36044452#36044452", "title": "How would I remove all leading alphabetical characters?", "body": "<p>Koodos Jeeped, you beat me to it.</p>\n\n<p>But here is an alternative anyway:</p>\n\n<pre><code>Function RemoveAlpha(aString As String) As String\n\n    For i = 1 To Len(aString)\n        Select Case Mid(aString, i, 1)\n            Case \"0\" To \"9\"\n                RemoveAlpha = Right(aString, Len(aString) - i + 1): Exit For\n        End Select\n    Next i\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5974900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZN0.jpg?s=128&g=1", "display_name": "JoeDolan", "link": "https://stackoverflow.com/users/5974900/joedolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 1, "accepted_answer_id": 36044410, "answer_count": 4, "score": 0, "last_activity_date": 1458154060, "creation_date": 1458152874, "last_edit_date": 1531161705, "question_id": 36044036, "link": "https://stackoverflow.com/questions/36044036/how-would-i-remove-all-leading-alphabetical-characters", "title": "How would I remove all leading alphabetical characters?", "body": "<p>I am interested in removing leading alphabetical (alpha) characters from cells which appear in a column. I only wish to remove the leading alpha characters (including UPPER and LOWER case): if alpha characters appear after a number they should be kept. Some cells in the column might not have leading alpha characters.</p>\n\n<p>Here is an example of what I have:</p>\n\n<pre><code>36173\nPIL51014\n4UNV22001\nZEB54010\nBICMPAFG11BK\nBICMPF11\n</code></pre>\n\n<p>Notice how there are not always the same number of leading alpha characters. I cannot simply use a Left or Right function in Excel, because the number of characters I wish to keep and remove varies.</p>\n\n<p>A correct output for what I am looking for would look like:</p>\n\n<pre><code>36173\n51014\n4UNV22001\n54010\n11BK\n11\n</code></pre>\n\n<p>Notice how the second to last row preserved the characters \"BK\", and the 3rd row preserved \"UNV\". I cannot simply remove all alpha characters.</p>\n\n<p>I am a beginner with visual basic and was not able to figure out how to use excel functions to address my issue. How would I do this?</p>\n"}, {"tags": ["excel", "vba", "data-connections"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "edited": false, "score": 0, "creation_date": 1526564024, "post_id": 36085273, "comment_id": 87801345, "body": "Yes, please provide us with the code to do this, @Baseline9!"}], "tags": [], "owner": {"reputation": 101, "user_id": 4657998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7cbd1ecc62a6a788271ce4c0502d65a?s=128&d=identicon&r=PG&f=1", "display_name": "Baseline9", "link": "https://stackoverflow.com/users/4657998/baseline9"}, "is_accepted": true, "score": 1, "last_activity_date": 1458306613, "creation_date": 1458306613, "answer_id": 36085273, "question_id": 36044015, "link": "https://stackoverflow.com/questions/36044015/change-data-connection-to-read-only/36085273#36085273", "title": "Change Data Connection to Read Only", "body": "<p>ok I found a solution and hopefully it will help someone else in the future. </p>\n\n<ol start=\"2\">\n<li><p>I'll deal with the 2nd problem first!</p>\n\n<pre><code>Dim conn As Variant\n\nFor Each conn In ActiveWorkbook.Connections\n    conn.OLEDBConnection.MaintainConnection = False\n Next conn\n</code></pre></li>\n</ol>\n\n<p>So in excel 2013 I discovered the maintain connection property is set the true by default. This sets it to false after I have refreshed the data connections. Works a treat and now the user can go into the source data after my refresh with no problems at all. </p>\n\n<ol>\n<li>For the first issue and after much searching + trying to set the connection string Mode=Read/Readonly=False etc.. (which I could not get to work) I decided to handle the read only issue when refreshing the connection. Basically I got some code to check if a user in in the source file. If they are open the source file as read only, refresh the connection (and pivots) then close the file. If no user has the file open then simply refresh the connection. If anyone needs the code please comment and I can post</li>\n</ol>\n\n<p>Many thanks!</p>\n"}], "owner": {"reputation": 101, "user_id": 4657998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7cbd1ecc62a6a788271ce4c0502d65a?s=128&d=identicon&r=PG&f=1", "display_name": "Baseline9", "link": "https://stackoverflow.com/users/4657998/baseline9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4321, "favorite_count": 0, "protected_date": 1537761870, "accepted_answer_id": 36085273, "answer_count": 1, "score": 2, "last_activity_date": 1544634948, "creation_date": 1458152804, "last_edit_date": 1544634948, "question_id": 36044015, "link": "https://stackoverflow.com/questions/36044015/change-data-connection-to-read-only", "title": "Change Data Connection to Read Only", "body": "<p>I have a \"summary\" Excel workbook with pivots and data connections to other \"data\" workbooks.</p>\n\n<ol>\n<li>When refreshing the connection and a user is in the data workbook the refresh falls over saying it is read only. (It then tries to open the data workbook.) Is there a way around this? E.g. read the data rather than needing write access? Data String properties below.</li>\n</ol>\n\n<blockquote>\n  <p>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=C:\\Test\\Test.xlsm;Mode=Share Deny Write;Extended Properties=\"HDR=YES;\";Jet OLEDB:System database=\"\";Jet OLEDB:Registry Path=\"\";Jet OLEDB:Engine Type=37;Jet OLEDB:Database Locking Mode=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password=\"\";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False;Jet OLEDB:Bypass UserInfo Validation=False;Jet OLEDB:Limited DB Caching=False;Jet OLEDB:Bypass ChoiceField Validation=False</p>\n</blockquote>\n\n<ol start=\"2\">\n<li>When I have refreshed the connections and a user goes into the data workbooks, excel says it read only and used by \"Another user\".</li>\n</ol>\n\n<p>I'm refreshing using VBA <code>ActiveWorkbook.Connections(\"Test.xlsm\").Refresh</code>.</p>\n\n<p>Is there a way in VBA to tell Excel to drop the access so the data workbook becomes free. The only solution I can think of is to shut down the workbook and open again.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458152476, "post_id": 36043564, "comment_id": 59736501, "body": "Seems to me that you could even accomplish that with a normal VLOOKUP or INDEX / MATCH function. But if you really want to do it with VBA then please post the code you have written thus far and explain where you are encountering a bug or problem in your code."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6073167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154056474674540/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/6073167/jason"}, "edited": false, "score": 0, "creation_date": 1458324070, "post_id": 36044048, "comment_id": 59826811, "body": "So, im not sure if im doing it right, let me clarify a bit more:  Im looking at an expense report that has 3 columns i look in, column E, G, and H.  any of those 3 may contain the keywords I am looking for.  This is in a sheet called &#39;Working&#39;  The keywords i am searching for are in column A of a sheet called Tracking.  I want it to go row by row and look at those 3 columns for the keywords, and if it finds it, put THAT keyword in the cell on that row of column J of the Working sheet, and if not, put Unknown.  I&#39;m sorry I am a novice when it comes to VBA."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1458152923, "creation_date": 1458152923, "answer_id": 36044048, "question_id": 36043564, "link": "https://stackoverflow.com/questions/36043564/search-a-column-for-words-in-a-table-on-another-sheet-and-insert-the-value-from/36044048#36044048", "title": "Search a column for words in a table on another sheet and insert the value from the cell next to it in the current cell", "body": "<p>An example to replace in all the sheets all the expressions defined in a range:</p>\n\n<pre><code>Sub ReplaceMulti()\n  Dim dictionary As Range, sh As Worksheet, data(), r&amp;, search$, replace$\n\n  ' Loads a translation table from a worksheet\n  ' The first column is the searched string and the second is the replacement\n  Set dictionary = [Sheet1!A1:B10]\n  data = dictionary.value\n\n  ' iterate each sheet\n  For Each sh In ActiveWorkbook.Worksheets\n\n    ' skip the sheet with the dictionary\n    If sh.CodeName &lt;&gt; dictionary.Worksheet.CodeName Then\n\n      ' iterate each expression\n      For r = 1 To UBound(data)\n\n        If Not IsEmpty(data(r, 1)) Then\n          search = data(r, 1)\n          replace = data(r, 2)\n\n          ' replace in the sheet\n          sh.Cells.replace What:=search, replacement:=replace, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n            SearchFormat:=False, ReplaceFormat:=False\n\n        End If\n      Next\n    End If\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6073167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154056474674540/picture?type=large", "display_name": "Jason", "link": "https://stackoverflow.com/users/6073167/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "accepted_answer_id": 36044048, "answer_count": 1, "score": 1, "last_activity_date": 1565398794, "creation_date": 1458151471, "last_edit_date": 1565398794, "question_id": 36043564, "link": "https://stackoverflow.com/questions/36043564/search-a-column-for-words-in-a-table-on-another-sheet-and-insert-the-value-from", "title": "Search a column for words in a table on another sheet and insert the value from the cell next to it in the current cell", "body": "<p>I want to:</p>\n\n<ul>\n<li><p>look through a column (work column a) row by row searching for any words in a table (list column a) on another sheet.</p></li>\n<li><p>if any of those words are found, return the value from the next column (list column b) and put it in a cell in the worksheet (work column c).</p></li>\n</ul>\n\n<p>I know an if then else formula is listed to 7 items, and im working with a list longer that that (and growing).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458152198, "post_id": 36043415, "comment_id": 59736335, "body": "You are merely showing us the formatted values. Maybe you can add a 2nd screenshot next to it which shows us the un-formatted values (what is really stored in these cell as <code>.Value2</code> or <code>.Formula</code>)? It seems to me that not all dates are recognized as such."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458156073, "post_id": 36043415, "comment_id": 59738638, "body": "@Ralph, I&#39;ve updated the code and added a screenshot to show the <code>.Value2</code> and <code>.Formula</code> results."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458157217, "post_id": 36043415, "comment_id": 59739360, "body": "Perfect. In that case I&#39;d transpose the <code>.Value2</code> and then change the formatting of the cells to the desired date format. Note, that date are essentially numbers: 42409 = 42409 days after 00.01.1900 and 0.75 = three quarters of a day = 18:00. Change the format using <code>.NumberFormat = &quot;[$-409]d-mmm-yy;@&quot;</code> (for example)."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458159706, "post_id": 36043415, "comment_id": 59740874, "body": "@Ralph The thing I&#39;m looking for is the answer to <b>why</b> when the array is transposed Excel suddenly behaves oddly with dates  but behaves normally when looping through the array or simply not transposing the array, . The easiest workaround is declaring the array as <code>long</code>, storing the dates as the number and then use <code>.Numberformat = &quot;dd&#47;mm&#47;yy&quot;</code> on the range to which the numbers were printed."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458160086, "post_id": 36043415, "comment_id": 59741086, "body": "Whenever you enter anything into a cell Excel automatically tries to evaluate what you want and formats it accordingly. The same happens when you are copying and pasting data. Yet, the date format is somewhat misleading. The <code>&#47;</code> indicates to your NL Excel a foreign date when it is normally expecting a <code>-</code> according to this: <a href=\"https://en.wikipedia.org/wiki/Date_format_by_country\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Date_format_by_country</a>. So, I assume that it tries to evaluate the date as US date using mm/dd/yyyy."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458160185, "post_id": 36043415, "comment_id": 59741138, "body": "@Ralph, but then wouldn&#39;t you expect the same result on each column?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458160771, "post_id": 36043415, "comment_id": 59741479, "body": "If the values come without formatting (as with <code>.Value2</code>) then yes. If there is a proposed formatting from where the data is coming from then no. Furthermore, the destination cell is also taken into consideration. If the destination cell is pre-formatted then it does not matter what you enter and Excel keeps the set format. If not, Excel tries to determine the best format as described above. In other words: only if the source is without formatting <code>.Value2</code> and the destination is without formatting <code>.ClearFormats</code> then I&#39;d expect a similar result."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458160855, "post_id": 36043415, "comment_id": 59741526, "body": "Note that the results are in fact similar: dates following the rule mm/dd/yyyy are recognized and shown as dates, while others (such as 31/01/2016 and 13/01/2016) cannot be converted using mm/dd/yyyy (there is no 13th months) and are therefore shown as unrecognized text."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458233830, "post_id": 36048752, "comment_id": 59780341, "body": "While I cannot confirm your findings on my computer (both debug print produce the same result being January 4, 2016) I am glad that you have found a working solution."}, {"owner": {"reputation": 569, "user_id": 617258, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f4efef7ac4c9b1822ed23a16a8a1a416?s=128&d=identicon&r=PG&f=1", "display_name": "RomnieEE", "link": "https://stackoverflow.com/users/617258/romnieee"}, "edited": false, "score": 0, "creation_date": 1542582236, "post_id": 36048752, "comment_id": 93609290, "body": "I just posted a variation on your question ( <a href=\"https://stackoverflow.com/questions/53348333/excel-vba-converts-dates-to-american-format-on-transpose-paste-from-vba\" title=\"excel vba converts dates to american format on transpose paste from vba\">stackoverflow.com/questions/53348333/&hellip;</a> ) and someone directed me here. So far I can&#39;t fix it and am avoiding Transpose instead. One point I can contribute is that if look in the locals window at a transposed date array--you can see that the Dates become Strings after Transpose. For whatever reason, I guess Transpose makes a new array, but doesn&#39;t make it the same type. What&#39;s still weird is that those Locals Strings are in the correct format. But get misread on pasting."}], "tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": true, "score": 3, "last_activity_date": 1458170022, "creation_date": 1458170022, "answer_id": 36048752, "question_id": 36043415, "link": "https://stackoverflow.com/questions/36043415/why-does-transposing-array-with-dates-in-format-dd-mm-yy-change-some-dates-to-mm/36048752#36048752", "title": "Why does transposing array with dates in format dd/mm/yy change some dates to mm/dd/yy format?", "body": "<p>After doing some more research, I have found the following:</p>\n\n<p>It would seem that the <code>Application.Transpose(arrDate)</code> transposes not only the array, but also date values when they are stored as actual date.</p>\n\n<p>Consider the date , <code>42373</code> (January 4, 2016)</p>\n\n<ul>\n<li><code>Debug.Print Format(CDate(42373), \"mmmm d, yyyy\")</code>\n\n<ul>\n<li>produces <code>januari 4, 2016</code></li>\n</ul></li>\n<li><code>Debug.Print Application.Transpose(Format(CDate(42373), \"mmmm d, yyyy\"))</code>\n\n<ul>\n<li>produces <code>april 1, 2016</code></li>\n</ul></li>\n</ul>\n\n<p>It appears that a date value can be transposed when stored as an actual date. The transposing effectively reorders the date from <code>day/month</code> to <code>month/day</code> after which the the month becomes the day and the day becomes the month because the system still uses the <code>day/month</code> format. This can only be done if the day of the month is 12 or less, because after transposing the day becomes the month.</p>\n"}, {"tags": [], "owner": {"reputation": 176, "user_id": 5291603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0caf850f15f9811de944163db88500?s=128&d=identicon&r=PG&f=1", "display_name": "kiden", "link": "https://stackoverflow.com/users/5291603/kiden"}, "is_accepted": false, "score": 1, "last_activity_date": 1491930877, "creation_date": 1491930877, "answer_id": 43352328, "question_id": 36043415, "link": "https://stackoverflow.com/questions/36043415/why-does-transposing-array-with-dates-in-format-dd-mm-yy-change-some-dates-to-mm/43352328#43352328", "title": "Why does transposing array with dates in format dd/mm/yy change some dates to mm/dd/yy format?", "body": "<p>I hit this problem, but interestingly, the date switch (from dd/mm to mm/dd) on transpose only happened when I ran the macro from a toolbar button; if I ran it from inside the VBA editor, or from the Developer menu>Macros dialogue box, it worked fine.\nTo make it work no matter where I ran the macro from, I added a function before the transpose to convert all dates to strings (looping through my array and using the CStr function), and then converted back from strings to dates after the transpose (another loop and CDate function) - the loops having to be slightly different to account for the transposed dimensions.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 11960693, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215170896689648/picture?type=large", "display_name": "Oleksandr Krasnoshchok", "link": "https://stackoverflow.com/users/11960693/oleksandr-krasnoshchok"}, "is_accepted": false, "score": 1, "last_activity_date": 1566454844, "creation_date": 1566454844, "answer_id": 57603082, "question_id": 36043415, "link": "https://stackoverflow.com/questions/36043415/why-does-transposing-array-with-dates-in-format-dd-mm-yy-change-some-dates-to-mm/57603082#57603082", "title": "Why does transposing array with dates in format dd/mm/yy change some dates to mm/dd/yy format?", "body": "<p>Transposing array with Application.Transpose() transforms the \"Date\" data type into \"String\". Not able to explain why.\nSo my suggestion is to transform the Column with \"Date\" data type into \"Long\" before you do the Application.Transpose() (simply using CLng).\nAfter that you can either transform it back to \"Date\" or just set the number format as \"Date\" for the cells, where you would like to paste the array.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15045122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1a5df259b7fb57d1e600cba9cc7c25?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/15045122/noah"}, "is_accepted": false, "score": 0, "last_activity_date": 1616588538, "creation_date": 1616588538, "answer_id": 66780950, "question_id": 36043415, "link": "https://stackoverflow.com/questions/36043415/why-does-transposing-array-with-dates-in-format-dd-mm-yy-change-some-dates-to-mm/66780950#66780950", "title": "Why does transposing array with dates in format dd/mm/yy change some dates to mm/dd/yy format?", "body": "<p>I resolve this issue using .FormulaLocal to write back the array in the sheet.</p>\n"}], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1946, "favorite_count": 2, "accepted_answer_id": 36048752, "answer_count": 4, "score": 1, "last_activity_date": 1616588538, "creation_date": 1458151081, "last_edit_date": 1569093235, "question_id": 36043415, "link": "https://stackoverflow.com/questions/36043415/why-does-transposing-array-with-dates-in-format-dd-mm-yy-change-some-dates-to-mm", "title": "Why does transposing array with dates in format dd/mm/yy change some dates to mm/dd/yy format?", "body": "<h3>Behavior:</h3>\n\n<p>When I transpose a 1 dimensional array, containing dates, in order to print them to a sheet in it's entirety, some dates are changed from the <code>dd/mm/yy</code> to <code>mm/dd/yyyy</code>. </p>\n\n<p>In particular, when the day of the month:</p>\n\n<ul>\n<li>is less than or equal to 12, such as <code>January 2, 2016 (02/01/16)</code>, or <code>May 11, 2016 (11/05/16)</code>, then the date is printed with the date format <code>mm/dd/yy</code> and is aligned right.</li>\n<li>is greater than or equal to 13, such as <code>April 23, 2016 (23/04/16)</code>, or <code>December 17, 2016 (17/12/16)</code>, then the date is printed with the date format <code>dd/mm/yyyy</code> and is aligned left.</li>\n</ul>\n\n<p>When I use a for loop to print each date separately, or I do not transpose the array and print each date in the first row of each column however, all dates are printed with the format <code>dd/mm/yy</code> and all dates are aligned right.</p>\n\n<h3>Additional information:</h3>\n\n<p>I have:</p>\n\n<ul>\n<li>Windows 8.1 (English U.S.)</li>\n<li>Office 365 Student (English U.S) (Excel 2016 32 bit)</li>\n<li>Locale setting: Netherlands</li>\n</ul>\n\n<h3>Code:</h3>\n\n<pre><code>Option Explicit\n\nSub TransposeDatesArray()\n    Dim arrDates() As Date\n    Dim i As Variant\n\n    ReDim arrDates(0)\n\n    For i = CDate(\"Januari 01, 2016\") To CDate(\"December 31, 2016\")\n        If UBound(arrDates) = 0 Then\n            ReDim arrDates(1 To 1)\n        Else\n            ReDim Preserve arrDates(1 To UBound(arrDates) + 1)\n        End If\n        arrDates(UBound(arrDates)) = i\n    Next\n\n    With ThisWorkbook.Worksheets(1)\n        .Cells.Delete\n        .Cells(1, 1).Resize(UBound(arrDates)).Value = Application.Transpose(arrDates)\n        .Cells(1, 2).Resize(UBound(arrDates)).Value2 = Application.Transpose(arrDates)\n        .Cells(1, 3).Resize(UBound(arrDates)).Formula = Application.Transpose(arrDates)\n\n        For i = LBound(arrDates) To UBound(arrDates)\n            .Cells(i, 4).Value = arrDates(i)\n            .Cells(i, 5).Value2 = arrDates(i)\n            .Cells(i, 6).Formula = arrDates(i)\n        Next\n\n    End With\nEnd Sub\n</code></pre>\n\n<h3>Result:</h3>\n\n<p><img src=\"https://i.stack.imgur.com/ihgQ4.png\" alt=\"Result\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458151143, "post_id": 36043275, "comment_id": 59735684, "body": "Please post the VBA code you have written thus far."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458154646, "post_id": 36043977, "comment_id": 59737797, "body": "Although in of itself the <code>.Select</code> is needed in places, it should be avoided as it can be volatile.  See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">HERE</a>"}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458155647, "post_id": 36043977, "comment_id": 59738379, "body": "Thanks for the link.  I&#39;ve been meaning to look into alternatives to <code>.Select</code> but haven&#39;t gotten into it.  Appreciate your help"}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1458152642, "creation_date": 1458152642, "answer_id": 36043977, "question_id": 36043275, "link": "https://stackoverflow.com/questions/36043275/moving-data-in-excel-from-a-column-to-rows-based-on-criteria-of-column/36043977#36043977", "title": "Moving data in excel from a column to rows based on criteria of column", "body": "<p>Assuming the maximum characters within a value before there is a space (when applicable) is 6, you can use a combination of <code>RTrim</code> and <code>Left</code> within a <code>While</code> loop.  See below:</p>\n\n<pre><code>Sub test()\n\nRange(\"A1\").Select\n\nWhile ActiveCell.Value &lt;&gt; \"\"\n\nIf RTrim(Left(ActiveCell.Value, 6)) = RTrim(Left(ActiveCell.Offset(1, 0).Value, 6)) Then\n\n    ActiveCell.Offset(1, 0).Select\n\nElse\n\n    ActiveCell.Offset(1, 0).Select\n\n    If ActiveCell.Offset(1, 0).Value = \"\" Then\n\n        ActiveCell.Cut\n        ActiveCell.Offset(0, 1).Select\n        Selection.End(xlUp).Select\n        ActiveSheet.Paste\n        Selection.End(xlUp).Select\n\n    Else\n\n        Range(Selection, Selection.End(xlDown)).Cut\n        ActiveCell.Offset(0, 1).Select\n        Selection.End(xlUp).Select\n        ActiveSheet.Paste\n        Selection.End(xlUp).Select\n\n    End If\n\nEnd If\n\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1458154649, "creation_date": 1458154649, "answer_id": 36044650, "question_id": 36043275, "link": "https://stackoverflow.com/questions/36043275/moving-data-in-excel-from-a-column-to-rows-based-on-criteria-of-column/36044650#36044650", "title": "Moving data in excel from a column to rows based on criteria of column", "body": "<p>This uses arrays and will be very quick:</p>\n\n<pre><code>Sub trnp()\nDim rngarr() As Variant\nDim oarr() As Variant\nDim rng As Range\nDim i As Long\nDim j As Long\nDim r As Long\nDim lg As Long\n\nj = 1\nr = 2\nWith ThisWorkbook.ActiveSheet\n    Set rng = .Range(.Cells(1, 1), Cells(.Rows.Count, 1).End(xlUp))\n    lg = .Evaluate(\"=LARGE(COUNTIF(\" &amp; rng.Address &amp; \",\"\"*\"\" &amp; \" &amp; rng.Address &amp; \" &amp; \"\"*\"\"),1)\")\n    rngarr = rng.Value\n    ReDim oarr(1 To lg, 1 To 1)\n    oarr(1, 1) = rngarr(1, 1)\n    For i = 2 To UBound(rngarr, 1)\n        If InStr(rngarr(i, 1), Trim(Left(rngarr(i - 1, 1), 6))) &gt; 0 Then\n            oarr(r, j) = rngarr(i, 1)\n            r = r + 1\n        Else\n            j = j + 1\n            r = 2\n            ReDim Preserve oarr(1 To lg, 1 To j)\n            oarr(1, j) = rngarr(i, 1)\n        End If\n    Next i\n    'paste back array starting in B1\n    .Range(\"B1\").Resize(UBound(oarr, 1), UBound(oarr, 2)).Value = oarr\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1458157949, "creation_date": 1458157949, "answer_id": 36045677, "question_id": 36043275, "link": "https://stackoverflow.com/questions/36043275/moving-data-in-excel-from-a-column-to-rows-based-on-criteria-of-column/36045677#36045677", "title": "Moving data in excel from a column to rows based on criteria of column", "body": "<p>Here is another VBA Macro that uses arrays and a user defined object to represent each column.  The User defined object consists of a Column Header item and then a collection of items below that.  It should be quite fast.  It makes assumptions about the data locations that should be easily modifiable at the top of the macro.</p>\n\n<h2>Class Module</h2>\n\n<p>(rename this to cColHeaders)</p>\n\n<hr>\n\n<pre><code>Option Explicit\nPrivate pColHeader As String\nPrivate pColItem As String\nPrivate pColItems As Collection\n\nPrivate Sub Class_Initialize()\n    Set pColItems = New Collection\nEnd Sub\n\nPublic Property Get ColHeader() As String\n    ColHeader = pColHeader\nEnd Property\nPublic Property Let ColHeader(Value As String)\n    pColHeader = Value\nEnd Property\n\nPublic Property Get ColItem() As String\n    ColItem = pColItem\nEnd Property\nPublic Property Let ColItem(Value As String)\n    pColItem = Value\nEnd Property\n\nPublic Property Get ColItems() As Collection\n    Set ColItems = pColItems\nEnd Property\nFunction ADDColItem(Value As String)\n    ColItems.Add Value\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2>Regular Module</h2>\n\n<hr>\n\n<pre><code>Option Explicit\nSub OrganizeByColumn()\n    Dim wsSrc As Worksheet, wsRes As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes() As Variant\n    Dim cCH As cColumnHeaders, colCH As Collection\n    Dim I As Long, J As Long\n    Dim lMaxItems As Long 'will be the maximum number of items in a column\n    Dim V As Variant\n\n'set source and results worksheets, ranges\nSet wsSrc = Worksheets(\"sheet2\")\nSet wsRes = Worksheets(\"sheet3\")\n    Set rRes = wsRes.Cells(1, 1) 'start results in wsRes A1\n\n'Get source data == assumes in Col A starting at A1\nWith wsSrc\n    vSrc = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\n\n'Collect and organize the data\nSet colCH = New Collection\nFor I = 1 To UBound(vSrc, 1)\n    Set cCH = New cColumnHeaders\n    With cCH\n        .ColHeader = vSrc(I, 1)\n        V = Split(.ColHeader)\n        If UBound(V) = 0 Then\n            colCH.Add cCH, .ColHeader\n        Else\n            .ColItem = vSrc(I, 1)\n            .ADDColItem .ColItem\n            colCH(V(0)).ADDColItem (.ColItem)\n            J = colCH(V(0)).ColItems.Count\n            lMaxItems = IIf(lMaxItems &gt; J, lMaxItems, J)\n        End If\n    End With\nNext I\n\n'Create and populate results array\nReDim vRes(0 To lMaxItems, 1 To colCH.Count)\n\nFor I = 1 To colCH.Count\n    With colCH(I)\n        vRes(0, I) = .ColHeader\n        For J = 1 To .ColItems.Count\n            vRes(J, I) = .ColItems(J)\n        Next J\n    End With\nNext I\n\n'resize results range\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\n\n'write and format the results\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    With .Rows(1)\n        .Font.Bold = True\n        .HorizontalAlignment = xlCenter\n    End With\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 1, "user_id": 6072840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc36370a09bf510ff348e1fc8f83237?s=128&d=identicon&r=PG&f=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/6072840/rick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1458157949, "creation_date": 1458150669, "last_edit_date": 1531161705, "question_id": 36043275, "link": "https://stackoverflow.com/questions/36043275/moving-data-in-excel-from-a-column-to-rows-based-on-criteria-of-column", "title": "Moving data in excel from a column to rows based on criteria of column", "body": "<p>I have a spreadsheet that has a column of information ie:</p>\n\n<pre><code>VA221\nVA222\nVL911\nVL911 S\nVL911 M\nVL911 L\nVL911 XL\nHF2301\nHF2301 S\nHF2301 M\nHF2301 L\nVS400\nVS402\n</code></pre>\n\n<p>I need to move it to a new sheet based on the items in the column I have an example below.</p>\n\n<pre><code>VA221    VA222    VL911    HF2301    VS400    VS402\n                  VL911 S  HF2301 S\n                  VL911 M  HF2301 M\n                  VL911 L  HF2301 L\n                  VL911 XL\n</code></pre>\n\n<p>if it was just a few I would do manually but the column will be very long. If anyone can point me in the right direction.</p>\n\n<p>Thanks for looking at my problem</p>\n\n<p>Rick</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1458150020, "post_id": 36042899, "comment_id": 59735001, "body": "Please let us know what your question is or where the code is not working. BTW, this is not the code which you are using, right? Especially the line <code>.Range(&quot;G&quot; &amp; NR).Value = Prior Val</code> shouldn&#39;t work as it is."}, {"owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458152409, "post_id": 36042899, "comment_id": 59736464, "body": "Hi Ralph, This code is .Range(&quot;G&quot; &amp; NR).Value = PriorVal as it was not allowing me to post my code. This code is a piece of my entire code set what i am looking here is, if anybody changes all cell value in the worksheet it will get captured in the Audit log and the cell need to be hyperlink, so that the person who is auditing the log should go directly to the location where we have changes."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458152639, "post_id": 36042899, "comment_id": 59736604, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20000463/hyperlinks-add-vba\">Hyperlinks.add VBA</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458152704, "post_id": 36042899, "comment_id": 59736649, "body": "Try to incorporate any of the suggested solutions provided on MSDN: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822490.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff822490.aspx</a>"}, {"owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458158237, "post_id": 36042899, "comment_id": 59739999, "body": "Thank you Ralph, i got this fixed by using the code .Hyperlinks.Add Anchor:=Sheets(&quot;AuditLog&quot;).Cells(NR, 6), Address:=&quot;&quot;, SubAddress:=sh.Name &amp; &quot;!&quot; &amp; Target.Address, TextToDisplay:=sh.Name &amp; &quot;!&quot; &amp; Target.Address which even you have mentioned here, the only problem i am facing now is is the name of worksheet has space this code is not working. In my code I need to fix at this point &quot;SubAddress:=sh.Name&quot;"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458158337, "post_id": 36042899, "comment_id": 59740059, "body": "Wrap the sheet name between apostrophes like so: <code>SubAddress:= &quot;&#39;&quot; &amp; sh.Name &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458158598, "post_id": 36042899, "comment_id": 59740205, "body": "It works Ralph, Thank you again!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458158710, "post_id": 36042899, "comment_id": 59740254, "body": "Please post the complete answer down below for everybody else to read and as a future reference."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "is_accepted": false, "score": 0, "last_activity_date": 1458158921, "creation_date": 1458158921, "answer_id": 36045945, "question_id": 36042899, "link": "https://stackoverflow.com/questions/36042899/looking-to-get-the-audit-log-values-as-hyperlink/36045945#36045945", "title": "Looking to get the audit log values as hyperlink", "body": "<pre><code>' This code will help to traverse back to the cell where the changes was made to get captured under Audit Log\nOption Explicit\nPublic PriorVal As String\n\nPrivate Sub Workbook_Open()\nDim NR As Long\n    With Sheets(\"AuditLog\")\n        NR = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row + 1\n        Application.EnableEvents = False\n        .Range(\"B\" &amp; NR).Value = Environ(\"UserName\")\n        .Range(\"C\" &amp; NR).Value = Environ(\"ComputerName\")\n        Application.EnableEvents = True\n    End With\nEnd Sub\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)\n    If Selection(1).Value = \"\" Then\n        PriorVal = \"Blank\"\n    Else\n        PriorVal = Selection(1).Value\n    End If\nEnd Sub\n\nPrivate Sub Workbook_SheetChange(ByVal sh As Object, ByVal Target As Range)\nDim NR As Long\nDim CELL As Range\nIf sh.Name = \"AuditLog\" Then Exit Sub     'allows you to edit the log sheet\n\nApplication.EnableEvents = False\n    With Sheets(\"AuditLog\")\n        NR = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n        .Range(\"B\" &amp; NR).Value = Environ(\"UserName\")\n        .Range(\"C\" &amp; NR).Value = Environ(\"ComputerName\")\n        .Range(\"D\" &amp; NR).Value = Now\n        .Range(\"E\" &amp; NR).Value = sh.Name\n        .Hyperlinks.Add Anchor:=Sheets(\"AuditLog\").Cells(NR, 6), Address:=\"\", SubAddress:=\"'\" &amp; sh.Name &amp; \"'\" &amp; \"!\" &amp; Target.Address, TextToDisplay:=sh.Name &amp; \"!\" &amp; Target.Address\n        .Range(\"G\" &amp; NR).Value = PriorVal\n        .Range(\"H\" &amp; NR).Value = Target(1).Value\n        NR = NR + 1\n    End With\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461704311, "creation_date": 1458149543, "last_edit_date": 1531164843, "question_id": 36042899, "link": "https://stackoverflow.com/questions/36042899/looking-to-get-the-audit-log-values-as-hyperlink", "title": "Looking to get the audit log values as hyperlink", "body": "<pre><code>'This is my code and I want the values retrieved by this code as linkable .Range(\"F\" &amp; NR).Value = Hyperlink(\"#'!sh.Name'!\" &amp; CELL(\"Target.Address\"), \"Target.Address\")\n\n'Below is the full code\nPrivate Sub Workbook_SheetChange(ByVal sh As Object, ByVal Target As Range)\nDim NR As Long\nDim CELL As Range, Hyperlink As String\nIf sh.Name = \"AuditLog\" Then Exit Sub     \n\nApplication.EnableEvents = False\n    With Sheets(\"AuditLog\")\n        NR = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n        .Range(\"B\" &amp; NR).Value = Environ(\"UserName\")\n        .Range(\"C\" &amp; NR).Value = Environ(\"ComputerName\")\n        .Range(\"D\" &amp; NR).Value = Now\n        .Range(\"E\" &amp; NR).Value = sh.Name\n'This code will retrieve values from the changed cell, I want this as a hyperlink to the value changed in another worksheet\n        .Range(\"F\" &amp; NR).Value = Hyperlink(\"#'!sh.Name'!\" &amp; CELL(\"Target.Address\"), \"Target.Address\")\n        .Range(\"G\" &amp; NR).Value = Prior Val\n        .Range(\"H\" &amp; NR).Value = Target(1).Value\n        NR = NR + 1\n    End With\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word", "export"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458148991, "post_id": 36042632, "comment_id": 59734262, "body": "To where in Word?  A new document?  An existing document?"}, {"owner": {"reputation": 41, "user_id": 6067216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fbcf921ff08929416f43c6c7928001?s=128&d=identicon&r=PG&f=1", "display_name": "CodingNewb", "link": "https://stackoverflow.com/users/6067216/codingnewb"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458149053, "post_id": 36042632, "comment_id": 59734322, "body": "To a new word document"}, {"owner": {"reputation": 41, "user_id": 6067216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fbcf921ff08929416f43c6c7928001?s=128&d=identicon&r=PG&f=1", "display_name": "CodingNewb", "link": "https://stackoverflow.com/users/6067216/codingnewb"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458149768, "post_id": 36042632, "comment_id": 59734808, "body": "Although I&#39;d definitely settle for an existing document"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1458152620, "post_id": 36042632, "comment_id": 59736596, "body": "While there is no way to &#39;convert&#39; your message box. You can use the variables you already have (Cst, Hrs, Scope) to write to a new microsoft word document. Just write to the &#39;WordDoc&#39; variable as seen in this link: <a href=\"http://stackoverflow.com/questions/16418292/vba-open-word-from-excel\" title=\"vba open word from excel\">stackoverflow.com/questions/16418292/vba-open-word-from-exce&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 41, "user_id": 6067216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fbcf921ff08929416f43c6c7928001?s=128&d=identicon&r=PG&f=1", "display_name": "CodingNewb", "link": "https://stackoverflow.com/users/6067216/codingnewb"}, "edited": false, "score": 0, "creation_date": 1458153212, "post_id": 36042632, "comment_id": 59736963, "body": "Would this export the information generated by the excel macro to word?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1458157496, "post_id": 36042632, "comment_id": 59739540, "body": "No, there&#39;s no function in Excel that will export to Word instead of displaying text in a MsgBox. You have to write that code yourself. There are <i>many</i> examples on StackOverflow and on the Internet, in general, that show how to do that."}, {"owner": {"reputation": 41, "user_id": 6067216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fbcf921ff08929416f43c6c7928001?s=128&d=identicon&r=PG&f=1", "display_name": "CodingNewb", "link": "https://stackoverflow.com/users/6067216/codingnewb"}, "edited": false, "score": 0, "creation_date": 1458158054, "post_id": 36042632, "comment_id": 59739878, "body": "Okay :(     <a href=\"http://memesvault.com/wp-content/uploads/Okay-Guy-Meme-04.jpg\" rel=\"nofollow noreferrer\">memesvault.com/wp-content/uploads/Okay-Guy-Meme-04.jpg</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6067216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fbcf921ff08929416f43c6c7928001?s=128&d=identicon&r=PG&f=1", "display_name": "CodingNewb", "link": "https://stackoverflow.com/users/6067216/codingnewb"}, "edited": false, "score": 0, "creation_date": 1458226602, "post_id": 36052193, "comment_id": 59774783, "body": "THIS IS AMAZING!! Thank you! Thank you! Thank you!"}], "tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": true, "score": 2, "last_activity_date": 1458364953, "last_edit_date": 1458364953, "creation_date": 1458191801, "answer_id": 36052193, "question_id": 36042632, "link": "https://stackoverflow.com/questions/36042632/information-appears-in-a-message-box-how-do-i-export-the-info-from-the-message/36052193#36052193", "title": "Information appears in a message box, how do I export the info from the message box to MS Word?", "body": "<p>I use this type of code for my Job</p>\n\n<pre><code>Sub demo()\n'If trueCount &gt; 0 Then\nCst = \"1\"\nhrs = \"12\"\nscope = \"none\"\n   Data = \"Cost: \" &amp; Cst _\n    &amp; vbNewLine &amp; \"Hours: \" &amp; hrs _\n    &amp; vbNewLine &amp; \"Scope: \" &amp; scope\n   'MsgBox Data\n   Dim objWord\n   Dim objDoc\n   Set objWord = CreateObject(\"Word.Application\")\n   Set objDoc = objWord.Documents.Add\n   objWord.Visible = True\n   objDoc.Range.Text = Data\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6067216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fbcf921ff08929416f43c6c7928001?s=128&d=identicon&r=PG&f=1", "display_name": "CodingNewb", "link": "https://stackoverflow.com/users/6067216/codingnewb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 36052193, "answer_count": 1, "score": 1, "last_activity_date": 1458364953, "creation_date": 1458148753, "last_edit_date": 1458152014, "question_id": 36042632, "link": "https://stackoverflow.com/questions/36042632/information-appears-in-a-message-box-how-do-i-export-the-info-from-the-message", "title": "Information appears in a message box, how do I export the info from the message box to MS Word?", "body": "<p>I wrote code that calculates if-then conditional values and then appears in a message box. How do I export the the message box to MS Word? Is there a function that instead of Msgbox, I could export to MS Word? Could I convert it to word from Debug.print?</p>\n\n<pre><code>Sub Way_EatFresh()\n\nDim ws As Worksheet, wsB As Worksheet\nSet ws = Worksheets(\"Overview\")\nSet wsB = Worksheets(\"Billing Rates\")\n\nDim trueCount As Integer\nDim i As Integer\nDim Cst, Hrs\n\n\nFor i = 1 To 11\n\nIf ws.Range(Chr(65 + i) &amp; \"36\").Value = \"True\" Then\n    trueCount = trueCount + 1\n    Cst = Cst + wsB.Range(Chr(66 + i) &amp; \"33\").Value\n    Hrs = Hrs + wsB.Range(Chr(66 + i) &amp; \"25\").Value\n    Scope = Scope + wsB.Range(Chr(66 + i) &amp; \"150\").Value\nEnd If\n\nIf ws.Range(Chr(65 + i) &amp; \"37\").Value = \"True\" Then\n    trueCount = trueCount + 1\n    Cst = Cst + wsB.Range(Chr(66 + i) &amp; \"34\").Value\n    Hrs = Hrs + wsB.Range(Chr(66 + i) &amp; \"26\").Value\n    Scope = Scope + wsB.Range(Chr(66 + i) &amp; \"150\").Value\nEnd If\n\nIf ws.Range(Chr(65 + i) &amp; \"38\").Value = \"True\" Then\n    trueCount = trueCount + 1\n    Cst = Cst + wsB.Range(Chr(66 + i) &amp; \"35\").Value\n    Hrs = Hrs + wsB.Range(Chr(66 + i) &amp; \"27\").Value\n    Scope = Scope + wsB.Range(Chr(66 + i) &amp; \"150\").Value\nEnd If\n\nIf ws.Range(Chr(65 + i) &amp; \"40\").Value = \"True\" Then\n    trueCount = trueCount + 1\n    Cst = Cst + wsB.Range(Chr(66 + i) &amp; \"49\").Value\n    Hrs = Hrs + wsB.Range(Chr(66 + i) &amp; \"41\").Value\n    Scope = Scope + wsB.Range(Chr(66 + i) &amp; \"150\").Value\nEnd If\n\n If ws.Range(Chr(65 + i) &amp; \"41\").Value = \"True\" Then\n    trueCount = trueCount + 1\n    Cst = Cst + wsB.Range(Chr(66 + i) &amp; \"50\").Value\n    Hrs = Hrs + wsB.Range(Chr(66 + i) &amp; \"42\").Value\n    Scope = Scope + wsB.Range(Chr(66 + i) &amp; \"150\").Value\nEnd If\n\n If ws.Range(Chr(65 + i) &amp; \"42\").Value = \"True\" Then\n    trueCount = trueCount + 1\n    Cst = Cst + wsB.Range(Chr(66 + i) &amp; \"51\").Value\n    Hrs = Hrs + wsB.Range(Chr(66 + i) &amp; \"43\").Value\n    Scope = Scope + wsB.Range(Chr(66 + i) &amp; \"150\").Value\nEnd If\n\nNext i\n\nIf trueCount &gt; 0 Then\n   MsgBox \"Cost: \" &amp; Cst _\n    &amp; vbNewLine &amp; \"Hours: \" &amp; Hrs _\n    &amp; vbNewLine &amp; \"Scope: \" &amp; Scope _\n\nEnd If\n\nIf trueCount = 0 Then\n     MsgBox \"Please select engagement components.\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba"], "comments": [{"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458157754, "post_id": 36042226, "comment_id": 59739698, "body": "Set frme = htmldoc.frames(6)            Set loa = frme.getElementsByName(&quot;SpreadsheetClicked&quot;)(0) &#39;error 438 object doesn&#39;t support this method"}], "answers": [{"comments": [{"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458152600, "post_id": 36043149, "comment_id": 59736575, "body": "Where are you actually assigning your <code>htmldoc</code>? Because the line <code>Set htmldoc = .document</code> doesn&#39;t seem right to me, unless this whole snippet is within a <code>With</code> statement. Have you tried cycling through the frames on the webpage until you come upon the one with the name &quot;content&quot;? I&#39;ll update my answer to give an example. And three, this is more of a statement than a question. <code>Frames</code> are by indexes, so <code>.frames(&quot;content&quot;).</code> won&#39;t work. I would suggest trying to loop through the elements like I&#39;ll show."}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458153544, "post_id": 36043149, "comment_id": 59737172, "body": "The snippet is within a with statement (with ie). I did cycle through frames and got the name content. Working with frames is new to me so i&#39;m not sure what you mean when you say frames are by indexes."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458153747, "post_id": 36043149, "comment_id": 59737298, "body": "I&#39;ve updated my answer with another snippet for you to try. When I say frames are by indexes I mean I don&#39;t believe you&#39;re able to get a frame by it&#39;s name directly (like you tried doing by saying <code>htmldoc.frames(&quot;content&quot;)</code>. It would be something like <code>htmldoc.frames(0)</code> or <code>htmldoc.frames(1)</code>, etc. By looping as I do in my answer it looks through each index and finds the one with the name &quot;content&quot;"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458153893, "post_id": 36043149, "comment_id": 59737372, "body": "Also, you were trying to grab the wrong index when you were trying to click <i>SpreadsheetClicked</i> button with <code>getElementsByTagName(&quot;input&quot;)(0).Click</code>. It should be <code>getElementsByTagName(&quot;input&quot;)(1).Click</code> because it&#39;s the 2nd <i>input</i> tag (indexes are 0-based, meaning they start at 0)"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458157304, "post_id": 36043149, "comment_id": 59739409, "body": "I think i&#39;m getting closer, I found that the index for content is 6."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458157381, "post_id": 36043149, "comment_id": 59739463, "body": "That&#39;s great. In that case see my second edit that I&#39;ll add right now."}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458157654, "post_id": 36043149, "comment_id": 59739637, "body": "And when you say <i>index for content is 6</i> I&#39;m assuming it&#39;s the 7th element then. If not, then replace my <code>.frames(6)</code> with <code>.frames(5)</code>"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458157705, "post_id": 36043149, "comment_id": 59739668, "body": "I found that the index for content is 6. However, i&#39;m now getting error 438. I tried using your code but that had the same issue, here is what I currently am trying:    Set frme = htmldoc.frames(6)            Set loa = frme.getElementsByName(&quot;SpreadsheetClicked&quot;)(0) &#39;error 438 object doesn&#39;t support this method"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458158510, "post_id": 36043149, "comment_id": 59740156, "body": "I believe it should actually be <code>Set loa = frme.document.getElementsByName(&quot;SpreadsheetClicked&quot;)</code>, including the <code>.document.</code> and no index on the end if you&#39;re getting it by name"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458159423, "post_id": 36043149, "comment_id": 59740680, "body": "I tried it both ways, using your edit#2 code I got error 438 again at the &quot;Set loa2 = loa.getElementsByTagName(&quot;input&quot;)(1)&quot; line.  I also tried getting it by name with no success. I&#39;m trying to figure out if I can use name &quot;spreadsheetclicked&quot; in your edit#2 code? Would that help specify what needs to be clicked?"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458181650, "post_id": 36043149, "comment_id": 59749473, "body": "Ok, try my 3rd edit. I think I wasn&#39;t getting the tag correctly"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458196511, "post_id": 36043149, "comment_id": 59754022, "body": "just about there! your 3rd edit did not give me any errors. the problem is that it doesn&#39;t actually click the button. so I played with the item numbers (your code has item(1). I was successful in finding 3 numbers that clicked on different buttons but not the one i&#39;m trying to click. My guess is that the code is referencing more html than the snippet I showed. Is there a way to cycle through the inputs similiar to how you showed me for the frame indexes?"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458213274, "post_id": 36043149, "comment_id": 59764468, "body": "It sounds like you&#39;re not accessing the correct frame then (since there are only 3 input tags you show in the content frame). My first suggest is to play around with the frame index (or use the code in my edit#1 to find the correct index) and if that doesn&#39;t work and somehow you&#39;re on the correct frame you can use the same code (edit#1) to cycle through inputs. Just change the <code>getElementsByTagName</code> to &quot;input&quot; instead of &quot;frame&quot;"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458316102, "post_id": 36043149, "comment_id": 59821715, "body": "The buttons I was able to click by changing the input item # are located on the top row of a list of buttons on the webpage. The button I am trying to click is located below that row. The code is unable to click any of the buttons on that 2nd row. I noticed when I go to &quot;inspect the element&quot; the html shows the input tags for only 1 those rows. So my source code i posted doesn&#39;t show the input tags for that 1st row. Also, I noticed when I went to view source, each row of buttons were in separate tables. Obviously I&#39;m new to html so I&#39;m not sure how to handle this in my code. Any suggestions?"}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458316173, "post_id": 36043149, "comment_id": 59821772, "body": "by the way I double checked, it does appear that all the buttons share the same frame. Thanks!"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458316294, "post_id": 36043149, "comment_id": 59821843, "body": "can you post the full source code? That would make things much easier."}, {"owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "edited": false, "score": 0, "creation_date": 1458322704, "post_id": 36043149, "comment_id": 59826017, "body": "sorry for the delay, I just added a more complete version of the source code. the last line in the html includes the button i&#39;m trying to click (spreadsheet). thanks"}], "tags": [], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "is_accepted": false, "score": 0, "last_activity_date": 1458181616, "last_edit_date": 1458181616, "creation_date": 1458150308, "answer_id": 36043149, "question_id": 36042226, "link": "https://stackoverflow.com/questions/36042226/vba-error-91-when-trying-to-click-a-button-on-webpage/36043149#36043149", "title": "vba &quot;error 91&quot; when trying to click a button on webpage", "body": "<p>Try declaring <code>loa</code> like this</p>\n\n<pre><code>Dim loa As Object\n</code></pre>\n\n<p>Edit #1:</p>\n\n<p>Here's how you can loop through the html document to find the frame named \"content\":</p>\n\n<pre><code>Set htmldoc = .document\nSet frmes = htmldoc.getElementsByTagName(\"frame\")\n    For Each frme In frmes\n        If frme.Name = \"content\" Then\n               Set loa = frme.document.getElementsByTageName(\"input\")(1)\n               Or\n               Set load = frme.document.getElementsByName(\"SpreadsheetClicked\")\n               loa.click\n        End if\n    Next resultClass\n</code></pre>\n\n<p>Let me know if this helps get you any closer</p>\n\n<p>Edit #2: This should do it</p>\n\n<pre><code>Dim htmldoc As MSHTML.IHTMLDocument 'Document object\nDim loa As Object, loa2 As Object\n\n    Set htmldoc = .document\n    Set loa = htmldoc.frames(6)\n    Set loa2 = loa.document.getElementsByTagName(\"input\")(1)\n    loa2.Click\n</code></pre>\n\n<p>Edit #3: Ok, I think I figured out how to correctly navigate the tags in a frame now</p>\n\n<pre><code>Dim htmldoc As MSHTML.IHTMLDocument 'Document object\nDim loa As Object, loa2 As Object\n\n    Set htmldoc = .document\n    Set loa = htmldoc.frames(6).document.all.tags(\"input\").Item(1)\n    loa.Click\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6046195, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5cf8258fb6b6b9e5b3e1afd82eaa1849?s=128&d=identicon&r=PG&f=1", "display_name": "guice99", "link": "https://stackoverflow.com/users/6046195/guice99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458322564, "creation_date": 1458147602, "last_edit_date": 1458322564, "question_id": 36042226, "link": "https://stackoverflow.com/questions/36042226/vba-error-91-when-trying-to-click-a-button-on-webpage", "title": "vba &quot;error 91&quot; when trying to click a button on webpage", "body": "<p>I can't figure out why i'm getting error 91 in the snippet of code below. Any help is much appreciated. </p>\n\n<pre><code> Dim htmldoc As MSHTML.IHTMLDocument 'Document object\n Dim loa\n\n    Set htmldoc = .document\n    Set loa = htmldoc.frames(\"content\").document.getElementsByname(\"SpreadsheetClicked\") \n        loa.getElementsByTagName(\"input\")(0).Click `**'error 91 block variable not set`**\n</code></pre>\n\n<p><strong>Edited html to include whole source:</strong>\ntowards the bottom you'll see the input tags for the buttons on the top and bottom rows. </p>\n\n<pre><code>FRAME src=\"/cgi-bin/webplus.dll?script=/woa/woa-home-frameset.wml\" name=content&gt;\n\n&lt;CENTER&gt;&lt;SPAN id=oContentWait style=\"DISPLAY: none\"&gt;&lt;IFRAME height=\"100%\" src=\"/cgi-bin/webplus.dll?script=/woa/woa-wait-display.wml\" frameBorder=3 width=\"100%\" scrolling=no&gt;&lt;/IFRAME&gt;&lt;/SPAN&gt;&lt;SPAN id=oContentMain style=\"DISPLAY: inline\"&gt;  \n&lt;DIV class=filter&gt;\n&lt;TABLE class=Outter border=3&gt;\n&lt;TBODY&gt;\n&lt;TR&gt;\n&lt;TD&gt;&lt;INPUT type=hidden name=SubmitTP&gt; \n&lt;TABLE class=Inner cellSpacing=0 cellPadding=2 width=\"100%\" border=0&gt;\n&lt;TBODY&gt;\n&lt;TR class=content align=center&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;TP&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD noWrap align=left&gt;&lt;SELECT onchange=\"form1.SubmitTP.value = 'True'; form1.submit();\" name=TP&gt;&lt;OPTION selected&gt;ALL&lt;OPTION&gt;ALL*&lt;A onclick=\"getUserEntry('TP','TP'); return false;\" title=\"Click here to select multiple Providers\" href=\"#\"&gt;*&lt;/A&gt;&lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Incr&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD noWrap align=left&gt;&lt;SELECT name=Incr&gt;&lt;OPTION&gt;ALL&lt;OPTION&gt;DAILY&lt;OPTION selected&gt;HOURLY&lt;OPTION&gt;MONTHLY&lt;OPTION&gt;SMONTHLY&lt;OPTION&gt;VARIABLE&lt;OPTION&gt;WEEKLY&lt;OPTION&gt;YEARLY&lt;/OPTION&gt;&lt;/SELECT&gt;&lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Peri&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD noWrap align=left&gt;&lt;SELECT name=Peri&gt;&lt;OPTION selected&gt;ALL&lt;OPTION&gt;FULL_PERIOD&lt;OPTION&gt;OFF_PEAK&lt;OPTION&gt;OFF_PEAK_DAY&lt;OPTION&gt;ON-PEAK&lt;OPTION&gt;ON_PEAK&lt;OPTION&gt;ON_PEAK_DAY&lt;OPTION&gt;WEEKDAY&lt;OPTION&gt;WEEKEND&lt;/OPTION&gt;&lt;/SELECT&gt;&lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;POR&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD &lt;/TD&gt;\n&lt;TD&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR class=content align=center&gt;\n&lt;TD &lt;/TD&gt;\n&lt;TD &lt;/A&gt;&lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Class&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD &lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Win&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD noWrap align=left&gt;&lt;SELECT name=Win&gt;&lt;OPTION selected&gt;ALL&lt;OPTION&gt;EXTENDED&lt;OPTION&gt;FIXED&lt;OPTION&gt;ROLLING&lt;OPTION&gt;SLIDING&lt;/OPTION&gt;&lt;/SELECT&gt;&lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;POD&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD &lt;/A&gt;&lt;/TD&gt;\n&lt;TD colSpan=2 noWrap align=left&gt;&lt;FONT size=-1&gt;Daylight Savings &lt;INPUT type=checkbox value=1 name=UseDST&gt; &lt;/FONT&gt;&lt;FONT size=-1&gt;Show Active Data &lt;INPUT CHECKED type=checkbox value=1 name=ShowActive&gt; &lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR class=content align=center&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Ref&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD align=left&gt;&lt;INPUT style=\"HEIGHT: 0.5cm\" maxLength=12 size=6 name=Posting&gt;&lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Type&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD &lt;/TD&gt;\n&lt;TD &lt;/TD&gt;\n&lt;TD &lt;/TD&gt;\n&lt;TD align=right&gt;&lt;FONT size=-1&gt;&amp;nbsp;Time&lt;/FONT&gt;&lt;/TD&gt;\n&lt;TD colSpan=4 noWrap align=left&gt;&lt;SELECT name=TimeFilter&gt; &lt;OPTION value=StartTime&gt;Start&lt;OPTION value=StopTime&gt;Stop&lt;OPTION value=OfferStartTime&gt;Offer Start&lt;OPTION value=OfferStopTime&gt;Offer End&lt;OPTION selected value=Active&gt;Active&lt;OPTION value=UpdateTime&gt;Update&lt;/OPTION&gt;&lt;/SELECT&gt; &lt;SELECT style=\"WIDTH: 160px\" name=TSpan&gt; &lt;OPTION value=Today&gt;Today&lt;OPTION selected value=\"This Hour\"&gt;This hour&lt;OPTION value=\"This Hour Forward\"&gt;This hour fwd&lt;OPTION value=\"Next Hour\"&gt;Next hour&lt;OPTION value=\"After Next Hour\"&gt;After next hour&lt;OPTION value=Yesterday&gt;Yesterday&lt;OPTION value=Tomorrow&gt;Tomorrow&lt;OPTION value=\"This Week\"&gt;This week&lt;OPTION value=\"Last Week\"&gt;Last week&lt;OPTION value=\"Next Week\"&gt;Next week&lt;OPTION value=\"This Month\"&gt;This month&lt;OPTION value=\"Last Month\"&gt;Last month&lt;OPTION value=\"Next Month\"&gt;Next month&lt;OPTION value=\"Today Forward\"&gt;Today forward&lt;OPTION value=\"Tomorrow Forward\"&gt;Tomorrow fwd&lt;OPTION value=\"All Past\"&gt;Before today&lt;/OPTION&gt;&lt;/SELECT&gt; &amp;nbsp;&amp;nbsp;&lt;INPUT class=btn1 type=submit value=\" Enter \" name=EnterClicked&gt; &lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;/DIV&gt;&lt;INPUT type=hidden name=NewColumnList&gt; &lt;INPUT type=hidden name=NewQueryList&gt;\n&lt;SCRIPT language=JavaScript&gt;\n    window.document.form1.NewColumnList.value = ''\n&lt;/SCRIPT&gt;\n\n&lt;TABLE border=0&gt;\n&lt;TBODY&gt;\n&lt;TR vAlign=top&gt;\n&lt;TD align=center&gt;&lt;INPUT disabled class=btn1 type=button value=\"New Posting\" name=NewClicked&gt; \n&lt;TD align=center&gt;&lt;INPUT onclick=\"openChild( '/cgi-bin/webplus.dll?script=/woa/woa-transoffering-summary-popup-userrange.wml', 'UserRange', 500, 150, true );\" class=btn1 type=button value=\"User Range\" name=UserRangeClicked&gt;&lt;/TD&gt;\n&lt;TD align=center&gt;&lt;INPUT onclick=showTransofferingSummaryColumnsPopup() class=btn1 type=button value=Columns name=ColumnsClicked&gt;&lt;/TD&gt;\n&lt;TD align=center&gt;&lt;INPUT onclick=\"window.location.href='/cgi-bin/webplus.dll?script=/woa/woa-path-atc-hourly-summary.wml'\" class=btn1 type=button value=\"Hourly Summary\" name=\"NEW ATC\"&gt; &lt;/TD&gt;\n&lt;TD align=center&gt;&lt;INPUT onclick=SaveQuery(); class=btn1 type=button value=\"Save Query\"&gt;&lt;/TD&gt;\n&lt;TD align=center&gt;&lt;SELECT onchange=SelectQuery(); name=SelectedQuery&gt; &lt;OPTION selected&gt;&lt;/OPTION&gt; &lt;OPTION&gt;Configure&lt;/OPTION&gt;&lt;/SELECT&gt; &lt;/TD&gt;&lt;INPUT type=hidden name=NewQueryChanged&gt; &lt;/TR&gt;\n&lt;TR&gt;\n&lt;TD colSpan=6 align=center&gt;&lt;INPUT onclick=\"openChildWindow( '/cgi-bin/webplus.dll?script=/woa/woa-atcmonitordetail.wml&amp;amp;Allow=1', 'ATCMonitorDetail', 500, 150, true );\" class=btn1 type=button value=\"ATC/TTC Monitor\" name=ATCMonitorAlarmDetailClicked&gt; &lt;INPUT onclick=OpenSpreadsheetView() class=btn1 type=button value=Spreadsheet name=SpreadsheetClicked&gt; &lt;INPUT onclick=DownloadCSV() class=btn1 type=button value=\"Download CSV\" name=DownloadCSVClicked&gt; &lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;&lt;FONT color=#ff0000&gt;Selected time range: &lt;B&gt;2016-03-18 10:00:00 PD&lt;/B&gt; to &lt;B&gt;10:59:00 PD&lt;/B&gt; &lt;/FONT&gt;&lt;INPUT type=hidden value=2012-01-19 name=SelectedUserRangeStart&gt; &lt;INPUT type=hidden value=2012-01-20 name=SelectedUserRangeEnd&gt; &lt;BR&gt;&lt;TR&gt;&lt;TD&gt;&amp;nbsp;&lt;/TD&gt;&lt;/TR&gt; \n</code></pre>\n"}, {"tags": ["vba", "runtime-error"], "comments": [{"owner": {"reputation": 101, "user_id": 5072846, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-9vmmB88wWW4/AAAAAAAAAAI/AAAAAAAAAdc/FpiOFvWEhB8/photo.jpg?sz=128", "display_name": "Azan Momin", "link": "https://stackoverflow.com/users/5072846/azan-momin"}, "edited": false, "score": 0, "creation_date": 1459177514, "post_id": 36041769, "comment_id": 60157856, "body": "Hi Tim, Just like you said I updated the lwp declaration to Match type and used Set to assign it the expression, yet it continues to encounter the same error. To add to the above I tried checking the typeName of lwp its showing as &quot;Nothing&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1458147153, "creation_date": 1458147153, "answer_id": 36042065, "question_id": 36041769, "link": "https://stackoverflow.com/questions/36041769/issue-extracting-pattern-from-url-in-vba/36042065#36042065", "title": "Issue extracting pattern from URL in VBA", "body": "<p><code>lwp</code> is a <code>Match</code> object, not a string, so you need to change your declaration and use Set when assigning a value. </p>\n\n<p>See\n<a href=\"https://msdn.microsoft.com/en-us/library/yfy6y4h1(v=vs.84).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/yfy6y4h1(v=vs.84).aspx</a></p>\n"}], "owner": {"reputation": 101, "user_id": 5072846, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-9vmmB88wWW4/AAAAAAAAAAI/AAAAAAAAAdc/FpiOFvWEhB8/photo.jpg?sz=128", "display_name": "Azan Momin", "link": "https://stackoverflow.com/users/5072846/azan-momin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458148226, "creation_date": 1458146422, "last_edit_date": 1458148226, "question_id": 36041769, "link": "https://stackoverflow.com/questions/36041769/issue-extracting-pattern-from-url-in-vba", "title": "Issue extracting pattern from URL in VBA", "body": "<p>Here in the excel sheet I am looping through the column(containing URL) extracting patterns(for eg. us/en/dhs) however I am getting a runtime error : 5\nTried a similar piece of code which was working but here it fails.</p>\n\n<p>Error at line containing bold text.</p>\n\n<pre>\nSub generateLWP()\n'\n' In the Active Sheet :\n'   - Extract the LWP from the URL and save it in column N\n'   - Identify pattern in every URL in the From Column and add the matching word to its corresponding cell in Article column\n'\n\n    'Select Non-Blank Link Text\n   \u2018 Call selectNonBlank\n\n    'Start from D3(URL) and loop through till the end and extract the LWP pattern\n    With ActiveSheet\n        .Range(\"N1\") = \"LWP\"\n        '.Range(\"O1\") = \"Article Pattern\"\n        .Range(\"D3\").Select\n    End With\n    'End\n\n    'Variables\n    Dim lwp As String: lwp = \"\"\n    Dim str As String\n\n    Set regEx = CreateObject(\"vbscript.regexp\")\n    With regEx\n            .Global = True\n            '.MultiLine = True\n            .IgnoreCase = True\n            .pattern = \"/([a-zA-Z]){2}\\/([a-zA-Z]){2}\\/(([a-zA-z]{5}[+0-9])|[a-zA-z]{3}|[0-9]{2})/g\"\n    End With\n\n    Do Until IsEmpty(ActiveCell)\n        'extract the LWP pattern and store it in corresponding cell of column N\n        str = ActiveCell.Value\n        Set regMatchObj = regEx.Execute(str)    \u2018Object containing the matching text\n        <b>lwp = regMatchObj.Item(0)</b>\n        \u2018lwp = regMatchObj.Item(0).SubMatches.Item(0)\n        ActiveCell.Offset(0, 10).Text = lwp\n        ActiveCell.Offset(1, -10).Select  'Go down\n    Loop    \n\nEnd Sub\n</pre>\n\n<p>Can you help determine why I am receiving an error on this line?</p>\n"}, {"tags": ["sql", "vba", "csv", "oledb", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 2255914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fbe53cab50813a25e87484fdc70c744?s=128&d=identicon&r=PG", "display_name": "johnn", "link": "https://stackoverflow.com/users/2255914/johnn"}, "edited": false, "score": 0, "creation_date": 1458147404, "post_id": 36041957, "comment_id": 59733152, "body": "thank you, but what is [SO Article]? how can I actually write the query? I tried use [SO Article][1] to take place Col1, but failed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5684647"}, "reply_to_user": {"reputation": 177, "user_id": 2255914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fbe53cab50813a25e87484fdc70c744?s=128&d=identicon&r=PG", "display_name": "johnn", "link": "https://stackoverflow.com/users/2255914/johnn"}, "edited": false, "score": 0, "creation_date": 1458148053, "post_id": 36041957, "comment_id": 59733619, "body": "Sorry, the link didn&#39;t work correctly.  I edited the link and provide some sample code."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5684647"}, "is_accepted": false, "score": 0, "last_activity_date": 1458148017, "last_edit_date": 1495535291, "creation_date": 1458146885, "answer_id": 36041957, "question_id": 36041635, "link": "https://stackoverflow.com/questions/36041635/sql-how-to-select-column-by-index-instead-of-name-from-csv/36041957#36041957", "title": "SQL how to select column by index instead of name from csv", "body": "<p>You may have to approach the read differently, but this solution would work for you.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7747105/specify-target-columns-on-import-csv-to-access\">Link to StackOverflow Q/A that will help you</a></p>\n\n<pre><code>sql = \"SELECT * FROM abc.csv\"\nrs.Open sql, cn, adOpenKeyset, adLockOptimistic\nvar column1 = \"\";\n\nDo While Not rsCSV.EOF\n    column1 = rs.Fields(0)\n    'Do something with the column1 data\n    rs.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 2255914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fbe53cab50813a25e87484fdc70c744?s=128&d=identicon&r=PG", "display_name": "johnn", "link": "https://stackoverflow.com/users/2255914/johnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 909, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458149524, "creation_date": 1458146062, "question_id": 36041635, "link": "https://stackoverflow.com/questions/36041635/sql-how-to-select-column-by-index-instead-of-name-from-csv", "title": "SQL how to select column by index instead of name from csv", "body": "<pre><code>Dim cn As New ADODB.Connection\nDim rs As New ADODB.Recordset\nDim sql As String\ncn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n                \"Data Source=\" &amp; ThisWorkbook.Path &amp; \";\" &amp; _\n                \"Extended Properties='Text;HDR=No'\"\n\nsql = \"SELECT Col1 FROM abc.csv\"\nrs.Open sql, cn, adOpenKeyset, adLockOptimistic\n</code></pre>\n\n<p>how can I select Col1 by column number while there is no column title row from a csv file using vba?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458146735, "post_id": 36041626, "comment_id": 59732615, "body": "Since you have a command button and want to control the update you&#39;re bound to use VBA. But if you want to update the formatting (with or without strikethrough) automatically, then you could also accomplish this with conditional formatting and no VBA code."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458147926, "post_id": 36041626, "comment_id": 59733541, "body": "The availability column is manipulated by the user and once the user either adds or deletes a number in the availability value I want to hit the command button and the employee name and number will either get a strikethrough or have one removed or if nothing changes nothing happens to the employee number and ID"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458148237, "post_id": 36041626, "comment_id": 59733747, "body": "I have added a picture of the file I am using... You can see the availability values are those numbers in the 4th column... so what I want to happen is if any of those values that are shown changes to nothing they get crossed out or if a value is added the strikethrough goes away... but those at the bottom in the green and orange that do not have a availability value I do not want these to get a strikethrough because they never change.. I just need those value that change from something to nothing or from nothing to something"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458148490, "post_id": 36041626, "comment_id": 59733925, "body": "If you want to compare to a previous value (when pressing the button) then you need to know the previous value. So, you&#39;ll have to copy the table to another (hidden) sheet. Then someone can press the button and you can compare the two lists and see if something has changed."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458148494, "post_id": 36041626, "comment_id": 59733930, "body": "Use the conditional formatting as suggested by @Ralph: it will automatically update the font property (or any other property) depends on the condition you set (no need for VBA). Best regards,"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458148929, "post_id": 36041626, "comment_id": 59734229, "body": "I cant use conditional formatting because the worksheet that needs the formatting is being pulled in daily to the workbook that holds all the code"}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458149744, "post_id": 36041626, "comment_id": 59734795, "body": "Please refer to my answer posted below. Best regards,"}], "answers": [{"tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1458156148, "last_edit_date": 1458156148, "creation_date": 1458149577, "answer_id": 36042909, "question_id": 36041626, "link": "https://stackoverflow.com/questions/36041626/changing-cell-value-formatting/36042909#36042909", "title": "Changing cell value formatting", "body": "<p>Pertinent to your question, the task can be completed in VBA using Array to store the previous values in Column D like shown in the following code snippet:</p>\n\n<pre><code>Dim ColumArray(65000) As String\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If Target.Column = 4 Then\n        ThisRow = Target.Row\n        If Target.Value = \"\" And ColumArray(ThisRow) &lt;&gt; \"\" Then\n            Range(\"B\" &amp; ThisRow &amp; \":C\" &amp; ThisRow).Font.Strikethrough = True\n        Else\n            Range(\"B\" &amp; ThisRow &amp; \":C\" &amp; ThisRow).Font.Strikethrough = False\n        End If\n        ColumArray(ThisRow) = Target.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that this procedure does not require Button event: it will run automatically on any change in Column \"D\". Alternatively, you can encapsulate it into your Sub <code>AircraftChange(ByVal Target As Range)</code> and run it on Button click event. Also, you can set the max index of the array ColumArray(65000) pertinent to the Column \"B\" last row (as per your code: endrow = Cells(Rows.count, \"B\").End(xlUp).Row ).</p>\n\n<p>The most universal solution (though a bit longer) would be create a global array placed in added Excel VBA code module (e.g. Module1) to store the values of, for example, <code>Worksheet(1)</code> Column \"D\" on <code>Workbook_Open</code>, and add the Sub procedure like shown above to the Worksheet(1).</p>\n\n<p>Hope this may help.</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459501920, "creation_date": 1458146028, "last_edit_date": 1459501920, "question_id": 36041626, "link": "https://stackoverflow.com/questions/36041626/changing-cell-value-formatting", "title": "Changing cell value formatting", "body": "<p>I have an excel sheet that has three columns:</p>\n\n<p><strong>employee number</strong></p>\n\n<p><strong>employee name</strong> </p>\n\n<p><strong>availability (some already have nothing values)</strong></p>\n\n<p>What I am trying to do is when the <strong>availability</strong> value changes from a number to nothing the <strong>employee number</strong> and the <strong>employee name</strong> associated with that row gets a strikethrough. \nAlso when an <strong>availability</strong> number is added the strikethrough disappears. I would like this code to run when a command button is pressed. As of right now the code runs when the button is pressed but those <strong>availability</strong> values that were already nothing and do not change are getting a strikethrough. Is there a way that only the <strong>availability</strong> values that change to nothing not those that were already nothing can get a strikethrough?\nI have written some code below but I have no idea if I am going in the right direction.</p>\n\n<pre><code>Sub AircraftChange(ByVal Target As Range)\nDim watchrange As Range, r As Range, rw As Long\nDim intersectrange As Range, endrow As Long\n\nendrow = Cells(Rows.count, \"B\").End(xlUp).Row\nSet watchrange = Range(\"E2:E\" &amp; endrow)\nSet intersectrange = Intersect(Target, watchrange)\n\nIf intersectrange Is Nothing Then Exit Sub\n\nFor Each r In intersectrange\nrw = r.Row\nIf r.Value = \"\" Then\n    Range(\"B\" &amp; rw &amp; \":C\" &amp; rw).Font.Strikethrough = True\nElse\n    Range(\"B\" &amp; rw &amp; \":C\" &amp; rw).Font.Strikethrough = False\nEnd If\nNext r\nEnd Sub\n</code></pre>\n\n<p>Could someone help me?</p>\n\n<p>Thank you in advance\n<a href=\"https://i.stack.imgur.com/pmI9L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pmI9L.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458145023, "post_id": 36041167, "comment_id": 59731389, "body": "Try: <code>Range(tbl &amp; &quot;[[Column1]:[Column5]]&quot;)</code>"}, {"owner": {"reputation": 121, "user_id": 6072734, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/70xmU.jpg?s=128&g=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/6072734/salman-khan"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1458147654, "post_id": 36041167, "comment_id": 59733339, "body": "thanx scott. it really helped me."}], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "is_accepted": false, "score": 1, "last_activity_date": 1458145706, "last_edit_date": 1458145706, "creation_date": 1458145171, "answer_id": 36041303, "question_id": 36041167, "link": "https://stackoverflow.com/questions/36041167/code-to-select-multiple-columns-in-an-excel-table/36041303#36041303", "title": "Code to Select Multiple Columns in an Excel Table", "body": "<p>Welcome to Stackoverflow!</p>\n\n<p>There are many ways to do this:</p>\n\n<p>you could use:</p>\n\n<pre><code>Range(\"A:E\").Select ' example selects columns from A to E\n</code></pre>\n\n<p>Otherwise you could also make it by using an array example:</p>\n\n<pre><code>Sub test()\n\n Dim x, y As Range, z As Integer\n    x = Array(1, 5)\n    Set y = Columns(x(0))\n    For z = 1 To UBound(x)\n        Set y = Union(y, Columns(x(z)))\n    Next z\n    y.Select\n  End Sub\n</code></pre>\n\n<p>but this depends of what you needs</p>\n\n<p>Best regards</p>\n\n<p>Daniel</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6901588, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fcD_o3RCQro/AAAAAAAAAAI/AAAAAAAAAJc/L1DclDtV2YY/photo.jpg?sz=128", "display_name": "Erin Strauts", "link": "https://stackoverflow.com/users/6901588/erin-strauts"}, "is_accepted": false, "score": 3, "last_activity_date": 1482250323, "creation_date": 1482250323, "answer_id": 41246666, "question_id": 36041167, "link": "https://stackoverflow.com/questions/36041167/code-to-select-multiple-columns-in-an-excel-table/41246666#41246666", "title": "Code to Select Multiple Columns in an Excel Table", "body": "<p>You can use concatenation to use a variable as a table name. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim ws As Worksheet\nDim tbl As ListObject\n\nSet ws = Sheets(\"Sheet1\")\nSet tbl = ws.ListObjects(1)\n\nRange(tbl &amp; \"[[Column1]:[Column5]]\").Select\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6072734, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/70xmU.jpg?s=128&g=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/6072734/salman-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15292, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1543431325, "creation_date": 1458144811, "last_edit_date": 1458148061, "question_id": 36041167, "link": "https://stackoverflow.com/questions/36041167/code-to-select-multiple-columns-in-an-excel-table", "title": "Code to Select Multiple Columns in an Excel Table", "body": "<p>I am new to Excel VBA. I need a modification in my code so that I would be able to proceed further.</p>\n\n<p>I want to select multiple table columns in an excel table.\nHere is my code:</p>\n\n<pre><code>Dim ws As Worksheet\nDim tbl As ListObject\n\nSet ws = Sheets(\"Sheet1\")\nSet tbl = ws.ListObjects(1)\n\nRange(\"tbl[[Column1]:[Column5]]\").Select\n</code></pre>\n\n<p>When I put the table name, it works. but I want to use variable which I have used in my code to select the table columns.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1458145440, "post_id": 36041099, "comment_id": 59731702, "body": "Try declaring <code>sFile</code> as <code>Variant</code> rather than <code>String</code>."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 2065058, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/552fe5881e43e23064e526c88e3decf5?s=128&d=identicon&r=PG", "display_name": "Jeph Gagnon", "link": "https://stackoverflow.com/users/2065058/jeph-gagnon"}, "edited": false, "score": 0, "creation_date": 1458152891, "post_id": 36042712, "comment_id": 59736769, "body": "When I added Trim(), it worked. But if there is some leading/trailing space problem, then why does the check if sFile=&quot;P:\\test2.txt&quot; returns true?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 99, "user_id": 2065058, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/552fe5881e43e23064e526c88e3decf5?s=128&d=identicon&r=PG", "display_name": "Jeph Gagnon", "link": "https://stackoverflow.com/users/2065058/jeph-gagnon"}, "edited": false, "score": 0, "creation_date": 1458153157, "post_id": 36042712, "comment_id": 59736929, "body": "I am not sure. It shouldn&#39;t return true if there are leading or trailing spaces :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1458149012, "creation_date": 1458149012, "answer_id": 36042712, "question_id": 36041099, "link": "https://stackoverflow.com/questions/36041099/cant-write-to-zip-file-if-using-a-string-or-variant-in-shell-application-copyhe/36042712#36042712", "title": "Can&#39;t write to zip File if using a string or variant in Shell.Application Copyhere", "body": "<p>If this works</p>\n\n<pre><code>objApp.Namespace(sZipArchive).CopyHere \"P:\\test2.txt\"\n</code></pre>\n\n<p>and <code>sFile</code> and <code>vLogs(i)</code> appears to be the same as <code>P:\\test2.txt</code> then I believe it could be a leading or trailing space problem. Try this</p>\n\n<pre><code>objApp.Namespace(sZipArchive).CopyHere Trim(sFile)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>objApp.Namespace(sZipArchive).CopyHere Trim(vLogs(i))\n</code></pre>\n\n<p>The other way to check if <code>sFile</code> and <code>vLogs(i)</code> contains a valid path is by using <code>DIR</code></p>\n\n<p>One more way of debugging is to step through your code and then type this in the Immediate window</p>\n\n<pre><code>?=vLogs(i)=\"P:\\test2.txt\"\n?=sFile=\"P:\\test2.txt\"\n</code></pre>\n\n<p>You should get a true in both cases. If you don't then there is your problem :)</p>\n"}], "owner": {"reputation": 99, "user_id": 2065058, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/552fe5881e43e23064e526c88e3decf5?s=128&d=identicon&r=PG", "display_name": "Jeph Gagnon", "link": "https://stackoverflow.com/users/2065058/jeph-gagnon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 36042712, "answer_count": 1, "score": 2, "last_activity_date": 1459503913, "creation_date": 1458144638, "last_edit_date": 1459503913, "question_id": 36041099, "link": "https://stackoverflow.com/questions/36041099/cant-write-to-zip-file-if-using-a-string-or-variant-in-shell-application-copyhe", "title": "Can&#39;t write to zip File if using a string or variant in Shell.Application Copyhere", "body": "<p>I am having troubles with NameSpace CopyHere function. I am trying to create a zip file containing a bunch of logs. I can create the zip file just fine, but when using the NameSpace.CopyHere, if I use a string or a variant containing a string, it won't write the file to the zip archive.</p>\n\n<p>For example, I have a file located at P:\\test2.txt .</p>\n\n<p>If I use those lines :</p>\n\n<pre><code> objApp.Namespace(sZipArchive).CopyHere sFile\n objApp.Namespace(sZipArchive).CopyHere vLogs(i)\n</code></pre>\n\n<p>where sFile = vLogs(i) = \"P:\\test2.txt</p>\n\n<p>the file test2.txt won't be copied in the zip archive.</p>\n\n<p>However, if I use this line :</p>\n\n<pre><code>objApp.Namespace(sZipArchive).CopyHere \"P:\\test2.txt\"\n</code></pre>\n\n<p>Then, the file gets copied in the zip file. </p>\n\n<p>If I put a check to see if the sFile or vLog(i) is = \"P:\\test2.txt\", I can see that they are the same thing. </p>\n\n<p>Is there something I am missing here on why the first 2 lines don't work, but the third one does?</p>\n\n<p>Thank you for your time.</p>\n\n<p>Full sub :</p>\n\n<pre><code>Private Sub BtnSaveToZip_Click()\nDim bEndRow, bTest As Boolean\nDim iRow, iCount As Integer\nDim sZipArchive, sDate, sFolderExists, sFile As String\nDim vLogs, vFilename As Variant\nDim objApp As Object\n\nsDate = Date\nsDate = Replace(sDate, \"/\", \"\") ' set date format to DDMMYYYY instead of DD/MM/YYYY\nsZipArchive = LblLogArchive + \"\\\" + sDate\nsFolderExists = Dir(sZipArchive)\nIf sFolderExists = \"\" Then\n    CreateDir (sZipArchive) ' if the subfolder with the date does not exists, create it\nEnd If\nsZipArchive = sZipArchive + \"\\\" + wsContacts.Range(\"B7\").Value + \" Logs_\" + sDate + \".zip\"\n'Check if file is open\nIf FileLocked(sZipArchive) Then\n    MsgBox sZipArchive + \" already open. Please close the archive.\"\n    Exit Sub\nEnd If\n\n'Creating the zip file from Ron de Bruin\nNewZip (sZipArchive)\n\n'filling the zip file\nSet objApp = CreateObject(\"Shell.Application\")\n\nbEndRow = False\niRow = gFirstData\nDo While bEndRow = False\n    If Not IsEmpty(wsLogs.Cells(iRow, gTestCase).Value) Then\n        If Not IsEmpty(wsLogs.Cells(iRow, gLog).Value) Then\n            vLogs = Split(wsLogs.Cells(iRow, gLog).Value, \";\")\n            For i = 0 To UBound(vLogs) - 1\n                sFile = vLogs(i) ' Debug only\n                If sFile = \"P:\\test2.txt\" Then 'Debug only\n                objApp.Namespace(sZipArchive).CopyHere vLogs(i) ' if I put \"P:\\test2.txt\", it works correctly\n                'Keep script waiting 5s for debug purpose\n                Application.Wait (Now + TimeValue(\"00:00:05\"))\n                End If\n            Next\n        End If\n    iRow = iRow + 1\n    Else\n        bEndRow = True\n    End If\nLoop\nMsgBox \"Zip successfully created\"\nSet objApp = Nothing\nEnd Sub    \n</code></pre>\n"}, {"tags": ["vba", "excel", "formulas"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458145603, "post_id": 36040848, "comment_id": 59731831, "body": "if I understand your question correctly, I tested this and it works: <code>=IF(COUNTIF(A2:M2,A2)+COUNTIF(B2:M2,&quot;&quot;)=13,TRUE,FALSE)</code>. It counts the number of times the row header appears and then counts the blanks, and if the sum of the two equal 13, you know its an exact match, taking blanks into consideration."}, {"owner": {"reputation": 17, "user_id": 3525945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0041419e3491e25714f5a2826a44185?s=128&d=identicon&r=PG&f=1", "display_name": "user3525945", "link": "https://stackoverflow.com/users/3525945/user3525945"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1458223610, "post_id": 36040848, "comment_id": 59772336, "body": "Thanks @ScottHoltzman"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3525945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0041419e3491e25714f5a2826a44185?s=128&d=identicon&r=PG&f=1", "display_name": "user3525945", "link": "https://stackoverflow.com/users/3525945/user3525945"}, "edited": false, "score": 0, "creation_date": 1458201772, "post_id": 36042820, "comment_id": 59756559, "body": "Well done @jeeped,, Also I have another question in the above work sheet through this formulas I can get results....but there is another stuff which is in the row cell there are multiple different values then what is formula for ROGUE AND HDR...Thanks BN"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 17, "user_id": 3525945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0041419e3491e25714f5a2826a44185?s=128&d=identicon&r=PG&f=1", "display_name": "user3525945", "link": "https://stackoverflow.com/users/3525945/user3525945"}, "edited": false, "score": 0, "creation_date": 1458202556, "post_id": 36042820, "comment_id": 59757002, "body": "I&#39;m afraid that I do not really understand your new criteria. However, it does sound like <a href=\"http://meta.stackexchange.com/questions/188625\">Another Question</a>. It is probably best to <a href=\"http://stackoverflow.com/help/someone-answers\">close off</a> this inquiry and initiate a <a href=\"http://stackoverflow.com/questions/ask\">New Question</a>. That will give you the opportunity to properly supply the new information."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1458149308, "creation_date": 1458149308, "answer_id": 36042820, "question_id": 36040848, "link": "https://stackoverflow.com/questions/36040848/formula-for-matching-multiple-row-cell-including-blank-cell/36042820#36042820", "title": "Formula for matching multiple row cell including blank cell", "body": "<p>The three standard formulas use in M2:O2 in the following image are,</p>\n\n<pre><code>=COUNTIF(A2:L2, A2)=COUNTA(A2:L2)\n=IFERROR(INDEX(A2:L2, AGGREGATE(15, 6, COLUMN(A:L)/((A2:L2&lt;&gt;A2)*SIGN(LEN(A2:L2))), 1)), \"\")\n=IFERROR(INDEX(A$1:L$1, AGGREGATE(15, 6, COLUMN(A:L)/((A2:L2&lt;&gt;A2)*SIGN(LEN(A2:L2))), 1)), \"\")\n</code></pre>\n\n<p>Fill down as necessary.</p>\n\n<p>\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/dG7GY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dG7GY.png\" alt=\"ROGUE_ENTRIES\"></a></p>\n\n<p>The conditional formatting rule for B2:L9 was based upon the following formula,</p>\n\n<pre><code>=AND(LEN(B2), B2&lt;&gt;$A2)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3525945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d0041419e3491e25714f5a2826a44185?s=128&d=identicon&r=PG&f=1", "display_name": "user3525945", "link": "https://stackoverflow.com/users/3525945/user3525945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 36042820, "answer_count": 1, "score": 0, "last_activity_date": 1458149308, "creation_date": 1458143961, "last_edit_date": 1458144793, "question_id": 36040848, "link": "https://stackoverflow.com/questions/36040848/formula-for-matching-multiple-row-cell-including-blank-cell", "title": "Formula for matching multiple row cell including blank cell", "body": "<p>Well, my question is, What is the formula for matching multiple row cell, if Match TRUE else FALSE then show the different row cell value in next column also sheet have blanks cell too so formula avoid blank cell and result is TRUE.</p>\n\n<p>Please follow the sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/5BAhy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5BAhy.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using this formula:</p>\n\n<pre><code>{=AND(EXACT(A2:M2,A2))} \n</code></pre>\n\n<p>and this formula:</p>\n\n<pre><code>=IF(COUNTIF(A2:M2,A2)=13,\"TRUE\",\"FALSE\") \n</code></pre>\n\n<p>But it match with blank cell, I need formula to only for existed matching row cell value then result is TRUE and FALSE. and if False then show that row cell column value in next column</p>\n\n<p>Thanks\nBN</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1458144579, "post_id": 36040951, "comment_id": 59731061, "body": "Thank you!. I am extremely new to excel macros (today), so it is greatly appreciated."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1458144252, "creation_date": 1458144252, "answer_id": 36040951, "question_id": 36040847, "link": "https://stackoverflow.com/questions/36040847/concatenate-cell-text-with-up-to-100-leading-characters-of-another-cells-text/36040951#36040951", "title": "Concatenate cell text with up to 100 leading characters of another cell&#39;s text", "body": "<p>You need to change:</p>\n\n<pre><code>Range(\"A\" &amp; X).Value = Left(\"B\" &amp; X, 8) &amp; Right(\"C\" &amp; X, 100)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Range(\"A\" &amp; X).Value = Left(Range(\"B\" &amp; X), 8) &amp; Right(Range(\"C\" &amp; X), 100)\n</code></pre>\n\n<p>You are literally finding the left 8 of the text string \"B11\" and the Right 100 of the text string \"C11\", when you want the values in the ranges B11 and C11.</p>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1458144670, "post_id": 36041021, "comment_id": 59731131, "body": "Thank you for pointing that out!. I thought RIGHT put it at the end of the destination box, but upon reading your answer I was way off!. thank you very much."}], "tags": [], "owner": {"reputation": 95, "user_id": 3303242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lec6G.jpg?s=128&g=1", "display_name": "R West", "link": "https://stackoverflow.com/users/3303242/r-west"}, "is_accepted": false, "score": 1, "last_activity_date": 1458144393, "creation_date": 1458144393, "answer_id": 36041021, "question_id": 36040847, "link": "https://stackoverflow.com/questions/36040847/concatenate-cell-text-with-up-to-100-leading-characters-of-another-cells-text/36041021#36041021", "title": "Concatenate cell text with up to 100 leading characters of another cell&#39;s text", "body": "<p>And if you want the first 100 characters from \"C\" then change <code>RIGHT</code> to <code>LEFT</code></p>\n\n<pre><code>Range(\"A\" &amp; X).Value = Left(Range(\"B\" &amp; X).Value, 8) &amp; Left(Range(\"C\" &amp; X).Value, 100)\n</code></pre>\n"}], "owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 36040951, "answer_count": 2, "score": 1, "last_activity_date": 1565393241, "creation_date": 1458143960, "last_edit_date": 1565393241, "question_id": 36040847, "link": "https://stackoverflow.com/questions/36040847/concatenate-cell-text-with-up-to-100-leading-characters-of-another-cells-text", "title": "Concatenate cell text with up to 100 leading characters of another cell&#39;s text", "body": "<p>I have two columns of data. Column B has 8 characters of data and begins at row 11. Column C has extensive data and begins at row 11 as well.</p>\n\n<p>I am trying to take the first 8 characters in a cell in column B, combine it with up to 100 characters in column C, and place this combined data into column A. This will loop for the next 200 rows of data.</p>\n\n<pre><code>Sub concat()\nFor X = 11 To 200\n    Range(\"A\" &amp; X).Value = Left(\"B\" &amp; X, 8) &amp; Right(\"C\" &amp; X, 100)\nNext X\nEnd Sub\n</code></pre>\n\n<p>Original data:</p>\n\n<pre><code>A            B                  C\n             testdata          SomeExtremelylongtext...\n</code></pre>\n\n<p>Expected Results:</p>\n\n<pre><code>A                                                  B                  C\ntestdataSomeExtremelylongtext...                testdata          SomeExtremelylongtext...\n</code></pre>\n\n<p>What I get:</p>\n\n<pre><code>A                         B                  C\nB11C11                testdata          SomeExtremelylongtext...\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4562, "user_id": 140187, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1c625e8cc951231fc15116b3214fe24e?s=128&d=identicon&r=PG", "display_name": "The King", "link": "https://stackoverflow.com/users/140187/the-king"}, "edited": false, "score": 0, "creation_date": 1458143953, "post_id": 36040732, "comment_id": 59730582, "body": "U need to consider the date part of the difference along with time part. Theway excel handles datetime is little complicated until someone fully understands."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458145869, "post_id": 36040819, "comment_id": 59731993, "body": "getting #VALUE as a fill down. Seems to work for the first calcuatiion though, very odd."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458147103, "post_id": 36040819, "comment_id": 59732902, "body": "Tried :<code>=SUM(D2,E2)-SUM(B2,C2)</code> was able to fill down, but only works if the days are the same. Not T and T + 1."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458147213, "post_id": 36040819, "comment_id": 59732998, "body": "I would need to see your data"}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458148093, "post_id": 36040819, "comment_id": 59733658, "body": "do you have an email where I can send it to? Or shall I post a pic?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458148754, "post_id": 36040819, "comment_id": 59734104, "body": "post a pic, then if someone else has a better solution they have the info also."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458148798, "post_id": 36040819, "comment_id": 59734139, "body": "Actually post the data itself as text in the Original post that way I do not need to recreate and can just copy paste."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458149283, "post_id": 36040819, "comment_id": 59734476, "body": "let me know if this is sufficient."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458149625, "post_id": 36040819, "comment_id": 59734704, "body": "@Jonathan the formula worked for me.  See edit.  You may need to format the cells with a custom format of <code>[hh]:mm:ss</code>"}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458149874, "post_id": 36040819, "comment_id": 59734885, "body": "Not sure, this is bizarre, I am getting #VALUE still after the first cell."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458150050, "post_id": 36040819, "comment_id": 59735026, "body": "Then some of your dates or time or both are text not actual date/time.  Try <code>=((--C1)+(--D1))-((--A1)+(--B1))</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458150934, "post_id": 36040819, "comment_id": 59735565, "body": "Change your format to general on your date and time columns, did it change to a number or did it remain a date?  If it remained a date then it is text and needs to be changed to a number, there are many methods online to do this with formulas.  If they change to numbers then I have no idea why it is not working. Sorry"}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458151978, "post_id": 36040819, "comment_id": 59736194, "body": "The Start and End times turned into Numbers. However dates stayed the same except for the 1st row. (1st row changed to numbers for dates)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458152551, "post_id": 36040819, "comment_id": 59736549, "body": "There ya go.  Your dates need to be changed from text to numbers.  Put this in an empty column: <code>=IFERROR(DATEVALUE(A1),A1)</code> and copy down, then copy and paste just the values back into column A.  Do this for Column C also."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458153287, "post_id": 36040819, "comment_id": 59737006, "body": "the values still remain as dates lol. Except for that first row."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458160593, "post_id": 36040819, "comment_id": 59741379, "body": "seems like these are strings not actual dates in my file."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1458160707, "post_id": 36040819, "comment_id": 59741445, "body": "Then you need to figure a way to make them dates.  Try this formula instead of the last one in a blank column <code>=IFERROR(DATEVALUE(TRIM(A1)),A1) </code> If that does not work I am out of ideas."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1458149569, "last_edit_date": 1458149569, "creation_date": 1458143888, "answer_id": 36040819, "question_id": 36040732, "link": "https://stackoverflow.com/questions/36040732/vba-time-difference-24-hour-clock/36040819#36040819", "title": "VBA, Time Difference, 24 hour clock", "body": "<p>So if your columns start at A1 then:</p>\n\n<pre><code>=(C1+D1)-(A1+B1)\n</code></pre>\n\n<p>This only works if they are true date/time and not text.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UelE5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UelE5.png\" alt=\"![enter image description here\"></a></p>\n\n<p>Make sure you use a custom format on column E of <code>[hh]:mm:ss</code> this will make it work if the hours are greater than 24.</p>\n"}], "owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 754, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458149569, "creation_date": 1458143685, "last_edit_date": 1458149260, "question_id": 36040732, "link": "https://stackoverflow.com/questions/36040732/vba-time-difference-24-hour-clock", "title": "VBA, Time Difference, 24 hour clock", "body": "<p>I would like to get time differences.</p>\n\n<p>Say I have 4 columns: Start day, start time, end day, end time. I would like to get the difference of the start day and time with the end day and time.</p>\n\n<p>Problem is, times may be 20:00 on T, and 02:00 on T+1 , giving me a difference of 18 hours. When it should be 6 hours.</p>\n\n<p>I need some help calculating the true time difference. Whether using VBA or Formula.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>EDIT </p>\n\n<pre><code>03/02/2016  6:29:34 03/02/2016  9:31:39\n03/15/2016  23:17:51    03/15/2016  23:25:36\n03/16/2016  2:15:53 03/16/2016  2:15:58\n03/15/2016  20:45:19    03/15/2016  21:09:07\n03/15/2016  20:45:25    03/15/2016  20:58:59\n03/16/2016  3:12:21 03/16/2016  3:12:30\n03/16/2016  3:33:19 03/16/2016  6:07:58\n03/16/2016  3:40:13 03/16/2016  6:12:50\n03/16/2016  3:47:05 03/16/2016  6:16:59\n03/15/2016  22:18:51    03/15/2016  22:18:57\n03/15/2016  20:51:14    03/15/2016  20:51:19\n03/15/2016  20:51:23    03/15/2016  22:07:25\n03/15/2016  20:52:46    03/16/2016  2:01:57\n03/15/2016  20:52:48    03/15/2016  22:44:39\n03/16/2016  1:31:43 03/16/2016  1:35:18\n03/15/2016  20:55:37    03/16/2016  2:13:30\n03/15/2016  20:55:03    03/15/2016  20:58:56\n03/15/2016  20:53:37    03/16/2016  2:11:34\n03/15/2016  20:56:27    03/15/2016  20:56:36\n03/15/2016  20:56:40    03/15/2016  22:43:39\n03/15/2016  20:57:02    03/16/2016  4:06:36\n03/15/2016  20:57:12    03/15/2016  21:01:35\n03/15/2016  20:57:21    03/15/2016  22:17:34\n03/15/2016  20:59:01    03/15/2016  22:44:28\n03/15/2016  20:59:03    03/15/2016  22:22:59\n03/15/2016  20:59:43    03/15/2016  23:06:02\n03/15/2016  21:01:38    03/15/2016  21:01:43\n03/15/2016  21:01:47    03/15/2016  22:55:07\n03/15/2016  21:09:11    03/15/2016  22:19:53\n03/15/2016  20:45:32    03/15/2016  20:52:44\n03/15/2016  20:45:38    03/15/2016  20:59:39\n03/15/2016  20:45:44    03/15/2016  20:51:00\n03/15/2016  20:45:45    03/15/2016  21:30:36\n03/15/2016  21:30:40    03/15/2016  21:30:46\n03/15/2016  20:45:51    03/15/2016  20:45:55\n03/15/2016  20:45:51    03/15/2016  20:45:55\n03/15/2016  21:30:40    03/15/2016  23:15:32\n03/16/2016  2:16:00 03/16/2016  2:24:15\n03/16/2016  4:29:20 03/16/2016  4:29:24\n03/16/2016  4:29:56 03/16/2016  4:41:31\n02/04/2016  5:03:17 02/04/2016  5:03:21\n03/16/2016  4:37:32 03/16/2016  5:44:57\n03/16/2016  4:41:35 03/16/2016  5:45:41\n03/16/2016  4:46:39 03/16/2016  5:49:00\n03/16/2016  4:52:32 03/16/2016  5:57:40\n03/16/2016  4:56:47 03/16/2016  6:06:33\n03/16/2016  5:00:58 03/16/2016  6:06:29\n03/16/2016  5:05:07 03/16/2016  6:05:03\n03/16/2016  5:09:13 03/16/2016  6:08:24\n03/15/2016  20:45:58    03/15/2016  20:53:34\n03/16/2016  1:09:17 03/16/2016  1:24:15\n03/16/2016  3:17:21 03/16/2016  3:27:41\n03/15/2016  22:44:37    03/15/2016  22:44:41\n03/16/2016  2:16:06 03/16/2016  2:23:46\n03/02/2016  6:21:32 03/02/2016  6:21:41\n03/16/2016  2:07:14 03/16/2016  2:09:40\n03/16/2016  2:16:13 03/16/2016  2:16:17\n03/16/2016  3:16:16 03/16/2016  3:25:21\n03/16/2016  3:16:16 03/16/2016  3:17:20\n03/16/2016  3:26:01 03/16/2016  3:34:23\n03/16/2016  2:16:19 03/16/2016  2:23:03\n03/15/2016  23:08:19    03/16/2016  0:47:27\n03/15/2016  20:45:58    03/15/2016  20:52:42\n03/16/2016  2:07:21 03/16/2016  2:07:26\n03/16/2016  2:16:20 03/16/2016  2:31:01\n03/16/2016  0:30:43 03/16/2016  0:30:49\n03/15/2016  20:45:58    03/15/2016  20:57:18\n03/15/2016  20:45:59    03/15/2016  20:56:57\n03/15/2016  20:45:59    03/15/2016  20:56:24\n03/15/2016  20:45:59    03/15/2016  20:55:34\n03/15/2016  20:46:04    03/15/2016  20:54:59\n03/15/2016  20:46:05    03/15/2016  20:50:57\n03/16/2016  0:11:30 03/16/2016  1:14:54\n03/16/2016  0:16:00 03/16/2016  1:16:38\n03/16/2016  0:20:47 03/16/2016  1:12:29\n03/16/2016  0:25:45 03/16/2016  1:09:22\n03/16/2016  0:30:14 03/16/2016  1:02:42\n03/16/2016  0:30:53 03/16/2016  0:31:00\n03/15/2016  20:51:00    03/15/2016  20:57:08\n03/15/2016  22:17:53    03/15/2016  22:32:45\n03/15/2016  20:51:04    03/15/2016  20:51:08\n03/16/2016  2:02:01 03/16/2016  2:02:05\n03/16/2016  4:09:03 03/16/2016  4:20:56\n03/16/2016  4:08:45 03/16/2016  4:08:49\n03/16/2016  4:08:55 03/16/2016  4:21:55\n03/16/2016  4:19:51 03/16/2016  5:43:01\n03/16/2016  4:21:39 03/16/2016  5:13:21\n03/16/2016  4:23:44 03/16/2016  5:09:15\n03/16/2016  4:25:47 03/16/2016  4:37:24\n03/16/2016  4:18:50 03/16/2016  4:49:45\n03/16/2016  4:33:38 03/16/2016  5:31:13\n03/16/2016  4:34:54 03/16/2016  5:17:24\n03/16/2016  3:17:44 03/16/2016  4:23:21\n03/16/2016  4:23:25 03/16/2016  4:23:29\n03/16/2016  3:21:49 03/16/2016  3:32:58\n03/16/2016  3:24:59 03/16/2016  3:37:11\n03/16/2016  3:27:35 03/16/2016  3:38:37\n03/16/2016  6:20:29 03/16/2016  6:20:33\n03/16/2016  2:04:35 03/16/2016  2:10:40\n03/16/2016  2:06:32 03/16/2016  3:31:43\n03/16/2016  5:58:19 03/16/2016  5:58:23\n03/16/2016  2:07:39 03/16/2016  2:19:36\n03/15/2016  23:01:00    03/15/2016  23:01:47\n03/15/2016  22:52:27    03/15/2016  22:52:58\n03/15/2016  22:57:25    03/15/2016  22:58:18\n03/15/2016  22:49:37    03/15/2016  22:50:25\n03/15/2016  22:49:58    03/15/2016  22:50:30\n03/15/2016  22:49:46    03/15/2016  22:50:18\n03/16/2016  1:58:35 03/16/2016  1:59:12\n03/16/2016  1:58:41 03/16/2016  1:59:08\n03/15/2016  22:53:27    03/15/2016  22:53:57\n03/16/2016  1:58:48 03/16/2016  1:59:08\n03/16/2016  1:58:54 03/16/2016  1:59:03\n03/16/2016  1:59:00 03/16/2016  1:59:19\n03/16/2016  1:58:26 03/16/2016  1:59:03\n03/15/2016  23:00:43    03/15/2016  23:01:10\n03/15/2016  22:52:44    03/15/2016  22:53:32\n03/16/2016  1:59:01 03/16/2016  1:59:16\n03/15/2016  23:02:06    03/15/2016  23:02:34\n03/15/2016  23:03:35    03/15/2016  23:04:06\n03/15/2016  22:56:42    03/15/2016  22:57:43\n03/15/2016  22:57:54    03/15/2016  22:59:00\n03/15/2016  23:06:21    03/15/2016  23:06:47\n03/15/2016  23:00:03    03/15/2016  23:00:52\n03/15/2016  23:08:57    03/15/2016  23:09:21\n03/16/2016  1:59:01 03/16/2016  2:01:58\n03/15/2016  23:01:34    03/15/2016  23:02:03\n03/15/2016  23:00:28    03/15/2016  23:01:00\n03/15/2016  23:09:58    03/15/2016  23:10:12\n03/16/2016  8:02:06 03/16/2016  8:04:45\n03/16/2016  7:04:54 03/16/2016  7:05:18\n</code></pre>\n"}, {"tags": ["string", "excel", "vba", "text"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1458143743, "post_id": 36040635, "comment_id": 59730391, "body": "You need to post your existing code, or this question will likely be closed."}, {"owner": {"reputation": 3, "user_id": 6072519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290428efacf6f674754b3e9015f5e7b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nikola", "link": "https://stackoverflow.com/users/6072519/nikola"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458203525, "post_id": 36040635, "comment_id": 59757577, "body": "Thanks for warning me I will put the code next time right away, my bad so no hard feelings"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6072519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290428efacf6f674754b3e9015f5e7b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nikola", "link": "https://stackoverflow.com/users/6072519/nikola"}, "edited": false, "score": 0, "creation_date": 1458202376, "post_id": 36042302, "comment_id": 59756894, "body": "Thanks very much, this answer is very helpful to me and I now managed the problem. Quick and accurate answer and excellent problem understanding as I did not provide full info, but this is difference between human intelligence and a computer programm. Humans can read  between the lines!"}, {"owner": {"reputation": 3, "user_id": 6072519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290428efacf6f674754b3e9015f5e7b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nikola", "link": "https://stackoverflow.com/users/6072519/nikola"}, "edited": false, "score": 0, "creation_date": 1458202513, "post_id": 36042302, "comment_id": 59756973, "body": "Here is the code(I so new and my browser so old that formatting look very strange so I am not really sure where to post the code ):"}, {"owner": {"reputation": 3, "user_id": 6072519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290428efacf6f674754b3e9015f5e7b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nikola", "link": "https://stackoverflow.com/users/6072519/nikola"}, "edited": false, "score": 0, "creation_date": 1458202754, "post_id": 36042302, "comment_id": 59757115, "body": "Sub Macro1 ()  Dim ws As Worksheet  Set ws = ActiveSheet  For Each cell In ws.Columns(5).Cells  If IsEmpty(cell) = True Then cell.Select: Exit For  Next cell Dim string1 As String: string1 = &quot;* Note: In this review are ... a total of&quot; Dim string2 As String: string2 = &quot;in this day) is given in W drive, &quot;&quot;Something&quot;&quot;&quot; ActiveCell.Value = string1 &amp; &quot; &quot; &amp; ActiveSheet.Range(&quot;L3&quot;).Value &amp; &quot; &quot; &amp; string2     Range(ActiveCell.Offset(1, -1), ActiveCell.Offset(0, 6)).Select         With Selection         .WrapText = True         .MergeCells = True     End With End Sub"}], "tags": [], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "is_accepted": true, "score": 0, "last_activity_date": 1458148943, "last_edit_date": 1458148943, "creation_date": 1458147796, "answer_id": 36042302, "question_id": 36040635, "link": "https://stackoverflow.com/questions/36040635/vba-for-text-string-another-cell-value-text-string/36042302#36042302", "title": "Vba for Text string + another cell value + text string", "body": "<p>I feel like the user has provided enough info and has explained how they arrived at their current roadblock (plus they are new), so I will give them the benefit of the doubt and provide my input.</p>\n\n<p>Code:\n<img src=\"https://i.imgur.com/TRX5Mx1.jpg\" alt=\"code\"></p>\n\n<p>Output</p>\n\n<p><img src=\"https://i.imgur.com/fliedbp.jpg\" alt=\"output\"></p>\n\n<pre><code>ActiveSheet.Range(\"Whatever cell you want this in\").Value = textstring1 &amp; ActiveSheet.Range(\"Cell with the formula/number you need\").Value &amp; textstring2\n</code></pre>\n\n<p>In the parentheses you would put the cell or range you want the value from for example:\n <code>ActiveSheet.Range(\"A2\").Value</code></p>\n\n<p>Also, instead of hard coding your text strings you can use variables. So, in place of <code>\"Test\"</code> you could use say variable <code>string1</code>, which you defined above your code and gave a value like so:</p>\n\n<p><code>Dim string1 as String: string1 = \"Test\"</code></p>\n"}], "owner": {"reputation": 3, "user_id": 6072519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290428efacf6f674754b3e9015f5e7b0?s=128&d=identicon&r=PG&f=1", "display_name": "Nikola", "link": "https://stackoverflow.com/users/6072519/nikola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 0, "closed_date": 1458192875, "accepted_answer_id": 36042302, "answer_count": 1, "score": 0, "last_activity_date": 1458148943, "creation_date": 1458143424, "question_id": 36040635, "link": "https://stackoverflow.com/questions/36040635/vba-for-text-string-another-cell-value-text-string", "closed_reason": "Needs more focus", "title": "Vba for Text string + another cell value + text string", "body": "<p>I have a problem. I have simple excel table with pictures that changes number of row every day. I adapted vba code found on internet (I am very new to vba). I wanted to add a string at the first empty cell (last row of the table) and managed that using vba. But the string contains a number that changes every day and I need to update that numer along with the string. The number is number of non empty rows after filter applied and is contained in some cell in the same workbook. How can you make vba that would adapt to what I already have? So it goes like this:\n1. Find first empty cell (donne)\n2. Select a range from finded cell and merge (donne)\n3. Add a text string + number from another cell (the cell contains formula to calculate that number) + another part of text string (this part is my problem)?</p>\n\n<p>Best regard to anyone who can help</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458142908, "post_id": 36040305, "comment_id": 59729750, "body": "So you want to replace the <code>somefilename</code> part with the name of the workbook? If so, just: <code>&quot;Z:\\1000_Entwicklung\\&quot; &amp; Replace(Thisworkbook.Name, &quot;xlsm&quot;, &quot;ppt&quot;)</code>"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458143494, "post_id": 36040305, "comment_id": 59730224, "body": "this works perfectly, thanks a lot. What if i want to use the macro again ? then it ll have an error because it is already saved with the filename of the excel.How can i make the automatically filename(2) or so ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458143762, "post_id": 36040305, "comment_id": 59730406, "body": "That&#39;s a different question and should be asked as such."}], "owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458142577, "creation_date": 1458142577, "question_id": 36040305, "link": "https://stackoverflow.com/questions/36040305/saving-a-powerpoint-file-with-a-variable-name-under-given-path", "title": "saving a powerpoint file with a variable name under given path", "body": "<p>I have an active Excel file which has a Name \"makroyigit.xlsm\".This Name is variable but i think i should be able to extract this Name with a function. I know i get the whole path by </p>\n\n<pre><code>       ThisWorkbook.FullName   \n</code></pre>\n\n<p>I can then assing the fullname as a variable and if possible i would like to assign the filename as variable.</p>\n\n<p>My macro then opens a new PowerPointslide and pastes some Content from my Excel file. Then it saves this PowerPoint file under this Name and path;</p>\n\n<pre><code>     PowerPointApp.ActivePresentation.SaveAs \"Z:\\1000_Entwicklung\\somefilename.ppt\",1\n</code></pre>\n\n<p>I would like to put the name of my Excel file in to this path, so i want it to be substituted with somefilename.ppt.</p>\n\n<p>I know i should assign the excel file name to a variable then put this variable in to the path but how do i do this ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1190, "user_id": 1902181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1158bb9a54b2a8a9b02cb91a253ee5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/1902181/seb"}, "edited": false, "score": 1, "creation_date": 1458141756, "post_id": 36039915, "comment_id": 59728853, "body": "try the &quot;text to columns&quot; function (In the &#39;data&#39; tab)"}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 3061364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eUkpU.png?s=128&g=1", "display_name": "Mr. Meeseeks", "link": "https://stackoverflow.com/users/3061364/mr-meeseeks"}, "is_accepted": false, "score": 1, "last_activity_date": 1458144937, "creation_date": 1458144937, "answer_id": 36041212, "question_id": 36039915, "link": "https://stackoverflow.com/questions/36039915/copy-part-of-text-from-the-same-cell/36041212#36041212", "title": "Copy part of text from the same cell", "body": "<p>As well as Seb's answer, you can use the split function. So:</p>\n\n<pre><code>Sub splitting_string()\nDim arr1 As Variant, var1 As String\nvar1 = Range(\"A9\")\n\narr1 = Split(var1, \",\")\n\nFor i = 0 To UBound(arr1)\n    Cells(10 + i, 1) = arr1(i)\nNext i\nEnd Sub\n</code></pre>\n\n<p>This will separate the long string in A9 into smaller ones by splitting them every time there's a comma, placing them in the cells below. </p>\n"}], "owner": {"reputation": 43, "user_id": 5998083, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b82ea90540cf3c6828ebc2c234026cd8?s=128&d=identicon&r=PG&f=1", "display_name": "Laizy", "link": "https://stackoverflow.com/users/5998083/laizy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458146682, "creation_date": 1458141630, "last_edit_date": 1531164843, "question_id": 36039915, "link": "https://stackoverflow.com/questions/36039915/copy-part-of-text-from-the-same-cell", "title": "Copy part of text from the same cell", "body": "<p>I have a problem when I downloaded a file containing different kind of information that should be stored in different cells but all is written in the same cell.</p>\n\n<p>For example <strong>A:9</strong> contains:</p>\n\n<pre><code>2016.03.16,\"8982266507\",\"QLGJG\",\"AHGLG\",\"OKK\",\"IK\",\"ODEADKIK\",\"DK57200028982561607\",\"485979,12\",\"65164,94\",\"485979,12\",\"65164,94\",\"485979,12\",\"65164,94\",\"\",\"\",\"\",\"\",\"\",\"\",\n</code></pre>\n\n<p>I would like to have a macro that copies specific parts of this string for example the last part <code>\"65164,94\"</code> and paste in to <strong>cell A:10.</strong> </p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba", "datetime", "excel-formula"], "comments": [{"owner": {"reputation": 31, "user_id": 4303749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26410a9102eb82a6850fc99d1d86e7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley_Hill", "link": "https://stackoverflow.com/users/4303749/ashley-hill"}, "edited": false, "score": 1, "creation_date": 1458142874, "post_id": 36039359, "comment_id": 59729717, "body": "I would say nevermind, as I was wrong.  The formula I was using does appear to work.  I changed the date on my computer, but didn&#39;t refresh the formulas, which made it appear not to work.  I would however, be interested in different approaches to this formula.  Was reading a bit about the NSDate function."}, {"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 0, "creation_date": 1533066361, "post_id": 36039359, "comment_id": 90207349, "body": "Are you looking for this : <code>=DATE(YEAR(TODAY())+1,MONTH(TODAY())-13,1)</code>  ?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4303749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26410a9102eb82a6850fc99d1d86e7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley_Hill", "link": "https://stackoverflow.com/users/4303749/ashley-hill"}, "edited": false, "score": 0, "creation_date": 1458338245, "post_id": 36039556, "comment_id": 59834201, "body": "That is way more elegant than what I used.  All that remains is to convert it back from the number of days since I think Jan 1 1900 or whatever base date Excel uses to the human format for dates.  I like your answer better.  Thanks!"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 6, "last_activity_date": 1458141546, "last_edit_date": 1458141546, "creation_date": 1458140813, "answer_id": 36039556, "question_id": 36039359, "link": "https://stackoverflow.com/questions/36039359/excel-formula-for-first-day-of-previous-month/36039556#36039556", "title": "Excel formula for first day of previous month", "body": "<p>You could try</p>\n\n<pre><code>=EOMONTH(TODAY(),-2)+1\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4303749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26410a9102eb82a6850fc99d1d86e7a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley_Hill", "link": "https://stackoverflow.com/users/4303749/ashley-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1458141698, "creation_date": 1458140412, "last_edit_date": 1458140736, "question_id": 36039359, "link": "https://stackoverflow.com/questions/36039359/excel-formula-for-first-day-of-previous-month", "title": "Excel formula for first day of previous month", "body": "<p>I'm trying to write a formula for the first day of the previous month.<br>\nI'm using: <code>=DATE(YEAR(TODAY()),MONTH(TODAY())-1,1)</code></p>\n\n<p>It works today, but I don't think it will work in January, because the formula would then return the year as 2016, and I need it to return the previous year in that case.  Does anyone have a suggestion for how I can modify this so it will return Dec 1 of the previous year if the current date is sometime in January?</p>\n"}, {"tags": ["vba", "ms-word", "word-2013"], "answers": [{"comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1458225074, "post_id": 36045647, "comment_id": 59773502, "body": "Thank you so much! I knew there had to be something this simple but could not find any information. Guess I should&#39;ve browsed all the methods on the paragraph type first. One question though, aren&#39;t line numbers valid for the section? If there is a section break, line numbers can be turned off for that section and therefore wouldn&#39;t be active for the entire document. Thanks again :-)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1458225451, "post_id": 36045647, "comment_id": 59773824, "body": "I don&#39;t ever use these, just know what they are and where to find it. I did specifically look for whether document or section yesterday, when writing up my answer, and the dialog box didn&#39;t <i>look</i> like I could specify by section, only renumber by section (or page). So I could be wrong about that :-) Tell me where you find the option and I&#39;ll edit my answer..."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1458315974, "post_id": 36045647, "comment_id": 59821617, "body": "Scenario: 3 paragraphs separated by section breaks. If I put my cursor in the middle paragraph, then go to Page Layout &gt; Line Numbers &gt; Line Numbering Options &gt; Line Numbers... (at the bottom) &gt; Check &quot;Add line numbering&quot; and select &quot;Restart each section&quot;. If I run a loop through my documents paragraphs, para.range.pagesetup.linenumbering.active is false until I hit my middle paragraph, however, the Selection.Information route returns 1 for the first paragraph which has no line numbers which means that returns the line number count in the actual document. Thanks again for your help :-)"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1458157849, "creation_date": 1458157849, "answer_id": 36045647, "question_id": 36038983, "link": "https://stackoverflow.com/questions/36038983/word-2013-suppress-line-numbers-vba/36045647#36045647", "title": "Word 2013: Suppress Line Numbers VBA", "body": "<p>Line numbers are valid for the entire document, which is why what you've tried is returning the information it is. </p>\n\n<p>Line number suppression is direct formatting applied to individual paragraphs, so you need to query the <em>paragraph</em> properties. For example:</p>\n\n<pre><code>If Selection.Paragraphs(1).NoLineNumber Then\n  'True (-1) means the line numbers are suppressed\nElse\n  'Flase (0) means the line numbers are visible\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 36045647, "answer_count": 1, "score": 0, "last_activity_date": 1458157849, "creation_date": 1458139541, "question_id": 36038983, "link": "https://stackoverflow.com/questions/36038983/word-2013-suppress-line-numbers-vba", "title": "Word 2013: Suppress Line Numbers VBA", "body": "<p>I am stuck.</p>\n\n<p>At my organization, we need to check if line numbers are active for a given paragraph. We are attempting to do this but are running into an issue with suppressed line numbers.</p>\n\n<p>We have tried:</p>\n\n<pre><code>Selection.Information(wdFirstCharacterLineNumber)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Paragraph.Range.PageSetup.LineNumbers.Active = True\n</code></pre>\n\n<p>However, the paragraph(s) we are trying to avoid have suppressed line numbers. We are trying to determine whether or not the current paragraph has line numbers. </p>\n\n<p>If line numbers are suppressed <code>LineNumbers.Active</code> returns <code>True</code> for the current paragraph. In addition, if line numbers are suppressed then <code>wdFirstCharacterLineNumber</code> returns <code>1</code> for the first paragraph even though it is obviously not <code>1</code> as I see <code>1</code> in a lower paragraph.</p>\n\n<p>I have not found a function that returns a bool or an integer if line numbers are suppressed for a given paragraph.</p>\n\n<p>I welcome any suggestions. Thank you.</p>\n"}, {"tags": ["arrays", "vba", "excel", "boundary"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5052625"}, "edited": false, "score": 0, "creation_date": 1458141261, "post_id": 36038961, "comment_id": 59728465, "body": "Thanks, exactly what I was looking for :)"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1458139482, "creation_date": 1458139482, "answer_id": 36038961, "question_id": 36038758, "link": "https://stackoverflow.com/questions/36038758/what-is-the-best-way-to-get-the-boundary-of-an-array-of-data-in-vba-excel/36038961#36038961", "title": "What is the best way to get the boundary of an array of data in VBA excel?", "body": "<p>How about <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow\"><code>CurrentRegion</code></a>:</p>\n\n<pre><code>Dim boundaryPoint(2) As Long, r As Range\n\nSet r = Range(\"A1\").CurrentRegion\n\nboundaryPoint(0) = r.Rows.Count\nboundaryPoint(1) = r.Columns.Count\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5052625"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 36038961, "answer_count": 1, "score": 0, "last_activity_date": 1459500151, "creation_date": 1458138925, "last_edit_date": 1459500151, "question_id": 36038758, "link": "https://stackoverflow.com/questions/36038758/what-is-the-best-way-to-get-the-boundary-of-an-array-of-data-in-vba-excel", "title": "What is the best way to get the boundary of an array of data in VBA excel?", "body": "<p>I wrote a code in VBA that gets the last boundary of data array in excel. I assumed that the array begins with the cell \"A1\" :</p>\n\n<pre><code>Function getBoundary()\n\nDim boundaryPoint(2)\nboundaryPoint(0) = Cells(Rows.Count, 1).End(xlUp).Row\nboundaryPoint(1) = Cells(1, Columns.Count).End(xlToLeft).Column\ngetBoundary = boundaryPoint\n</code></pre>\n\n<p>End Function</p>\n\n<p>I want to know if there is a better way to do it and if my code is optimized.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1458138043, "post_id": 36038250, "comment_id": 59725924, "body": "How is it not working? Are values not being displayed?"}, {"owner": {"reputation": 17, "user_id": 5869361, "user_type": "registered", "profile_image": "https://graph.facebook.com/1551330198511496/picture?type=large", "display_name": "Travis Cole", "link": "https://stackoverflow.com/users/5869361/travis-cole"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1458138597, "post_id": 36038250, "comment_id": 59726345, "body": "it says there is a type mismatch in the first if statement"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1458141426, "post_id": 36038250, "comment_id": 59728597, "body": "Check for an error (e.g. <code>#N&#47;A</code>) in the cell that are being referenced there."}, {"owner": {"reputation": 17, "user_id": 5869361, "user_type": "registered", "profile_image": "https://graph.facebook.com/1551330198511496/picture?type=large", "display_name": "Travis Cole", "link": "https://stackoverflow.com/users/5869361/travis-cole"}, "edited": false, "score": 0, "creation_date": 1458142329, "post_id": 36038250, "comment_id": 59729297, "body": "so it is actually filling in the for the first cell but then the second cell doesnt match the conditions so I think it never moves on. I originally was using a double for each loop to go through the second range as well but then it was just returning the final value that matched for every single one. im not sure what I could use to iterate through the second range without just returning the last value every time again"}], "owner": {"reputation": 17, "user_id": 5869361, "user_type": "registered", "profile_image": "https://graph.facebook.com/1551330198511496/picture?type=large", "display_name": "Travis Cole", "link": "https://stackoverflow.com/users/5869361/travis-cole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458138650, "creation_date": 1458137724, "last_edit_date": 1458138650, "question_id": 36038250, "link": "https://stackoverflow.com/questions/36038250/updating-a-range-within-a-for-each-loop-in-excel", "title": "updating a range within a for each loop in excel", "body": "<p>I am trying to write a search sub that looks through the cells in one range and then given some parameter finds a match in a second range, there are multiple values that are the same so in this case I want to return the next value in the second range. I was thinking that I could have a for each loop that whenever there was a value that was the same in the first range the next time it looped through the second range was adjusted to exclude the first value that i returned from it, but if it is a new value from the first range then it would search through all of the second range again but I cant seem to get it to work (it is giving me an error of a type mismatch for the first if statement)</p>\n\n<pre><code>    Sub mySearch()\nDim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Sheets(\"Deduped NS Data\").Range(\"E2:E142\")\nSet rng2 = Sheets(\"Sheet3\").Cells(2, 1)\n\n    For Each i In rng1\n        If i = i.Offset(1) And i = rng2 And i.Offset(, 3) = rng2.Offset(, 8) Then\n            i.Offset(, 2) = rng2.Offset(, 7)\n            rng2 = rng2.Offset(1)\n\n        ElseIf i = rng2 And i.Offset(, 3) = rng2.Offset(, 8) Then\n            i.Offset(, 2) = rng2.Offset(, 7)\n            rng2 = Sheets(\"Sheet3\").Cells(2, 1)\n\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458139351, "post_id": 36038180, "comment_id": 59726933, "body": "Try to change <code>Dim TimeSheet As Object</code> to <code>Dim TimeSheet As Worksheet</code>. Also, change the <code>.Activate</code> at the end of the find to <code>.Select</code>. Finally, I am not quite sure if you can immediately <code>.Select</code> or <code>Activate</code> the result of a <code>.Find</code>. You may have to store if in a variable first."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1458401742, "creation_date": 1458401742, "answer_id": 36103636, "question_id": 36038180, "link": "https://stackoverflow.com/questions/36038180/auto-open-macro-produces-error-code-91/36103636#36103636", "title": "auto_open Macro produces error code 91", "body": "<p>Perhaps it is time to graduate from relying on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197597.aspx\" rel=\"nofollow\">Range .Select</a> and \n<a href=\"https://msdn.microsoft.com/en-us/library/office/aa221681.aspx\" rel=\"nofollow\">Range .Activate</a> methods in favor of explicit range / cell / worksheet references.</p>\n\n<pre><code>'Public Sub Auto_Open()\n'workbook and worksheet subs are Private, not Public!\nPrivate Sub Workbook_Open()\n    'Dim Today As Date\n    Dim Jan1 As Date\n    Dim strDate As String, curDay As Date, curYear As Long\n    'dim defYear As Long\n    Dim JDate As Long\n    'Dim TimeSheet As Object\n    Dim fndDate As Range\n\n\n    'Today = DateSerial(Year(Now()), Month(Now()), Day(Now()))\n    'this can be simpler as Today = Date or Today = Int(Now)\n    'or just use Date anytime you would use Today and discard the Today var altogether\n\n    'Set TimeSheet = Sheets(\"Time\")\n    'TimeSheet.Select\n    'this is better as an explicit worksheet parent reference\n    With Worksheets(\"Time\")\n        .Activate   '&lt;~~ activate the worksheet for display purposes but do not rely on the ActiveSheet reference\n\n        'Range(\"A371\").Select\n        'curYear = ActiveCell.Offset(0, 1).Value\n        'curDay = ActiveCell.Offset(0, 0).Value\n        'we are working with a defined parent worksheet\n        'there are only three uses of ActiveCell but I'll puit them in a With End With anyways\n        With .Range(\"A371\")\n            curYear = .Offset(0, 1).Value2\n            curDay = .Value2    '&lt;~~ don't know what this does since it is reassigned a little further down\n\n            'If Today &gt; curDay Then\n            'Date is fine for this\n            If Date &gt; curDay Then\n                .Offset(0, 1) = Year(Date)\n            End If\n        End With\n\n\n        'Range(\"A1\").Select\n        'work with A1 (actually A2 with the offset)\n        Jan1 = .Range(\"A1\").Offset(1, 0).Value\n\n        'curDay = Today\n        'this seems like a unnecessary use of two vars - just use Date\n        curDay = Date\n\n        Set fndDate = .Cells.Find(What:=CDate(Date), After:=.Cells(1, 1), MatchCase:=False, _\n                                  LookIn:=xlValues, LookAt:=xlWhole, SearchFormat:=False, _\n                                  SearchOrder:=xlByColumns, SearchDirection:=xlNext)\n        'date formatting can foul up a .Find operation. If the above failed, try again with a CDate conversion on string date using the \"Short Date\" format\n        If fndDate Is Nothing Then\n            strDate = Format(Date, \"Short Date\")\n            Set fndDate = .Cells.Find(What:=CDate(strDate), After:=.Cells(1, 1), MatchCase:=False, _\n                                      LookIn:=xlValues, LookAt:=xlWhole, SearchFormat:=False, _\n                                      SearchOrder:=xlByColumns, SearchDirection:=xlNext)\n        End If\n\n        If Not fndDate Is Nothing Then\n            fndDate.Offset(0, 1).Select '&lt;~~ selected for user interface assistance only\n        Else\n            Debug.Print Err.Number &amp; \": \" &amp; Err.Description\n        End If\n\n        'JDate = DateDiff(\"d\", Jan1, Today)\n        'again, Date is the current date, Now is the current date and time and Time is the current time\n        'DateDif is unnecessary since the difference in days is simple subtraction\n        JDate = Date - Jan1\n        'don't know what you want to do with jdate\n        Debug.Print JDate\n    End With\nEnd Sub\n</code></pre>\n\n<p>Your code is working so I've performed a rewrite with attention on getting rid of any implicit references that rely on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx\" rel=\"nofollow\">ActiveSheet property</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193314.aspx\" rel=\"nofollow\">ActiveCell property</a>. Additionally, there are three date-type reserved vars in VBA. <strong>Date</strong> is the current date, Now is the current date with current time and Time is the current time without the date.</p>\n"}], "owner": {"reputation": 1, "user_id": 6062416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6025be9b2dc447a1643ea46383d18b3?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Oyler", "link": "https://stackoverflow.com/users/6062416/jerry-oyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458401742, "creation_date": 1458137536, "last_edit_date": 1531164843, "question_id": 36038180, "link": "https://stackoverflow.com/questions/36038180/auto-open-macro-produces-error-code-91", "title": "auto_open Macro produces error code 91", "body": "<p>The macro is an auto_open() that executes upon opening the spreadsheet. It checks first to see if the year has changed since it was last used. If it has, it changes it to the current year. The sheet that is the focus is named \"Time\". It has a list of all days in the year as well as holidays. The principal function is to search for the current day according to the system date. When found, it points to the current day for the purpose of recording hours worked for that day.</p>\n\n<p>In Excel 2016 it functions as expected. In Excel 2010 it bombs with error 91.</p>\n\n<p>Thanks for all who have looked at this question previously. First time in stack overflow. Don't you hate newbies? LOL</p>\n\n<pre><code>Public Sub Auto_Open()\nDim Today As Date\nDim Jan1 As Date\nDim Curday As Date\nDim DefYear As Long\nDim CurYear As Long\nDim JDate As Long\nDim TimeSheet As Object\n\nSet TimeSheet = Sheets(\"Time\")\n\n    Today = DateSerial(Year(Now()), Month(Now()), Day(Now()))\n    TimeSheet.Select\n    Range(\"A371\").Select\n    CurYear = ActiveCell.Offset(0, 1).Value\n    Curday = ActiveCell.Offset(0, 0).Value\n    If Today &gt; Curday Then\n    ActiveCell.Offset(0, 1) = Year(Now)\n    End If\n    Range(\"A1\").Select\n    Jan1 = ActiveCell.Offset(1, 0).Value\n    Curday = Today\n    Cells.Find(What:=Curday, After:=ActiveCell, LookIn:=xlValues, LookAt _\n        :=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False).Activate\n    ActiveCell.Offset(0, 1).Select\n    JDate = DateDiff(\"d\", Jan1, Today)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458137662, "post_id": 36037993, "comment_id": 59725619, "body": "Can you post the rest of the code? Some here may not be willing to download a macro enabled excel file for security reasons."}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458137763, "post_id": 36037993, "comment_id": 59725701, "body": "Thanks @asp8811 Good shout there, This is all I there is in the macros."}], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458140342, "post_id": 36038792, "comment_id": 59727749, "body": "I followed the instructions and to an extent it worked. However, 3 days have moved to the next month. Will post the screenshots"}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "reply_to_user": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458140433, "post_id": 36038792, "comment_id": 59727812, "body": "I made some changes to my answer. Please see the first step and the addition. Changing the +1 to +4 in that part of the macro is what fixes the problem you are having. The sheet should be working now."}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458142162, "post_id": 36038792, "comment_id": 59729166, "body": "Thanks asp8811 but looks like this solved the problem. I will do a couple of checks and accept this answer. Also, get back with additional doubts if you don&#39;t mind."}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "reply_to_user": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458143931, "post_id": 36038792, "comment_id": 59730561, "body": "Don&#39;t mind at all. Just respond with any other questions you have. Glad I could help."}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458144712, "post_id": 36038792, "comment_id": 59731167, "body": "Thank you, this is fantastic. Everything is working fine. Was struggling for an entire day, trying different combinations, as I have never worked with Excel macros/formulas"}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458210647, "post_id": 36038792, "comment_id": 59762594, "body": "Hey, back again. Apologies for asking more help, any chance I can get help on the formula for the column &quot;Leaves Applied&quot; (Total leaves) : <a href=\"https://www.dropbox.com/s/6b9g174g3xu6tbo/Excel-Leave-Tracker-2016-Additional%20Column%20-%20Copy.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/6b9g174g3xu6tbo/&hellip;</a>  Not sure why is it so complicated :-/"}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "reply_to_user": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458224788, "post_id": 36038792, "comment_id": 59773251, "body": "There are cells in row 3 that originally had a formula in them. I would replace those first. Then, use this formula =SUMPRODUCT((OFFSET($B8,0,1,1,372)&lt;&gt;&quot;&quot;)*(IF(OFFSET($B8,0,1,1&zwnj;&#8203;,372)=$NS$6,0.5,1)*(&zwnj;&#8203;OFFSET($B$3,0,1,1,37&zwnj;&#8203;2)))) in NK8 and use CTRL+SHIFT+ENTER to enter it as an array formula. Then drag and drop to NK11. When you use arrays in formulas like this, you have to use CTRL+SHIFT+ENTER instead of ENTER."}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "edited": false, "score": 0, "creation_date": 1458232278, "post_id": 36038792, "comment_id": 59779177, "body": "asp8811 cannot thank you enough for you time. I downloaded the file again and yes there was that formula on there. Will fix that bit (I hope, as I am not sure of hiding it). I was thinking isn&#39;t the column NL8 instead of NK8?"}, {"owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "reply_to_user": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "edited": false, "score": 0, "creation_date": 1458234095, "post_id": 36038792, "comment_id": 59780541, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/106630/discussion-between-vivian-lobo-and-asp8811\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "is_accepted": true, "score": 0, "last_activity_date": 1458140378, "last_edit_date": 1458140378, "creation_date": 1458139020, "answer_id": 36038792, "question_id": 36037993, "link": "https://stackoverflow.com/questions/36037993/adding-columns-without-breaking-formula-in-template/36038792#36038792", "title": "Adding columns without breaking formula in template", "body": "<p>There are some complex formulas in the dates and days of the week. They are using the COLUMN function which returns the current cell's column number.</p>\n\n<p>First, you need to stick with the change you made to the macro, but change <code>Columns(Range(\"A3\").Value * 31 + 1)</code> to <code>Columns(Range(\"A3\").Value * 31 + 4)</code></p>\n\n<p>Second, you need to adjust the line <code>LeaveTracker.Columns(\"B:NI\").Hidden = True</code> to reflect the changes that you are making. I believe the columns should be \"E:NM\"</p>\n\n<p>Third, the dates and days of the week all have complex formulas in them. They are using the COLUMN() function, which returns the cell's column number, to determine the day of the month. You will need to adjust this. Do a Find and Replace on \"COLUMN()-1\" and replace it with \"COLUMN()-4\"</p>\n\n<p>That should fix several things and get you moving.</p>\n\n<p>Edit to add: \nRight click on the scroll bar at the bottom and choose \"Format Control...\" \nChange the target cell link to 'Leave Tracker'!$D$1</p>\n\n<p>That should fix almost everything. The only issue now is that you'll have a blank column or two at the end of the month if it is less than 31 days.</p>\n"}], "owner": {"reputation": 497, "user_id": 1006821, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/395e13a5f57eb8cc2d05a05619dd62b1?s=128&d=identicon&r=PG", "display_name": "Vivian Lobo", "link": "https://stackoverflow.com/users/1006821/vivian-lobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 36038792, "answer_count": 1, "score": 0, "last_activity_date": 1565386023, "creation_date": 1458137083, "last_edit_date": 1565386023, "question_id": 36037993, "link": "https://stackoverflow.com/questions/36037993/adding-columns-without-breaking-formula-in-template", "title": "Adding columns without breaking formula in template", "body": "<p>I am using a <a href=\"http://trumpexcel.com/2015/03/excel-leave-tracker/\" rel=\"nofollow noreferrer\">template</a> from Trump Excel.</p>\n\n<p>I want to add four columns just before the name column.</p>\n\n<p>I went through the comments from the wesbite and managed to get a sample with an additional column from <a href=\"https://www.dropbox.com/s/qsubvcfounytzqn/Excel-Leave-Tracker-2016-TrumpExcel%20Additional%20Column.xlsm?dl=0\" rel=\"nofollow noreferrer\">Dropbox</a> but everything seems so difficult and this sample does not look like the original one. Missing end columns.</p>\n\n<p>I tried inserting the columns in the beginning and the macro breaks. I fixed the macro by changing the following line:</p>\n\n<pre><code>LeaveTracker.Range(Columns(Range(\"A3\").Value * 31 - 29), Columns(Range(\"A3\").Value * 31 + 1)).Hidden = False\n</code></pre>\n\n<p>and changing the range to D3 after adding EmpID, Rep, Col3 before Name. </p>\n\n<p>This stops the error but now, the dates has a problem. Jan shows only 28 starts from 4th and Feb has other problems and the rest of the months also exhibit date problems.</p>\n\n<p>The Excel file <a href=\"http://trumpexcel.com/wp-content/uploads/2015/03/Excel-Leave-Tracker-2016-TrumpExcel_Custom-Range_v1.xlsm\" rel=\"nofollow noreferrer\">Download</a>.</p>\n\n<p>The complete macro.</p>\n\n<pre><code>Sub showcalendar()\nLeaveTracker.Columns(\"B:NI\").Hidden = True\nLeaveTracker.Range(Columns(Range(\"A3\").Value * 31 - 29), Columns(Range(\"A3\").Value * 31 + 1)).Hidden = False\nEnd Sub\n</code></pre>\n\n<p>The date formula.</p>\n\n<pre><code>=IF(AND((COLUMN()-1)&gt;31*($A$3-1),MONTH(DATE($A$2+INT(($A$3+$A$1)/12),INT((COLUMN()-1)/31.001)+$A$1,ROUNDUP(MOD(COLUMN()-1,31.001),0)))=ROUNDUP(MOD($A$1+$A$3-1,12.01),0)),ROUNDUP(MOD(COLUMN()-1,31.001),0),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Cnnez.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cnnez.png\" alt=\"The dates and formula\"></a></p>\n"}, {"tags": ["vba", "excel", "if-statement", "checkbox"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1458138652, "creation_date": 1458138652, "answer_id": 36038645, "question_id": 36037946, "link": "https://stackoverflow.com/questions/36037946/excel-vba-userform-checkbox-if-statement-syntax-differences/36038645#36038645", "title": "Excel VBA: Userform Checkbox - If Statement syntax differences", "body": "<p>I would recommend the second one. It is always best to specify the property of an object explicitly rather than relying on defaults. There is no point in comparing a Boolean to True/False, since it already is True or False, and there is less point comparing it to a String value (which would be different in different regions).</p>\n"}, {"comments": [{"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1458139724, "post_id": 36038683, "comment_id": 59727236, "body": "Do you have a source for accessing default properties slowing down code execution? I&#39;ve never heard of that."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1458141085, "post_id": 36038683, "comment_id": 59728319, "body": "I did my own testing a while back with 500.000 rows comparing the use of <code>.Value</code>, <code>.Value2</code>, and ` ` with Office 2010. It was the traditional <code>.Value</code> vs <code>.Value2</code> I wanted to verify myself. But I have never seen the comparison to ` ` (forcing VBA to auto complete with the default). The time differences was rather minimal compared to the differences between <code>.Value</code> and <code>.Value2</code> and <a href=\"http://stackoverflow.com/questions/939230/how-to-get-a-datediff-value-in-milliseconds-in-vba-excel\">had to be calculated in milliseconds</a>. Hence (and since I don&#39;t have a website) I never posted my findings."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1458138753, "creation_date": 1458138753, "answer_id": 36038683, "question_id": 36037946, "link": "https://stackoverflow.com/questions/36037946/excel-vba-userform-checkbox-if-statement-syntax-differences/36038683#36038683", "title": "Excel VBA: Userform Checkbox - If Statement syntax differences", "body": "<p>In this case they are all the same and can be used interchangeably. Yet, I would only use the first or the second option.</p>\n\n<p><code>checkBox1</code> is essentially incomplete and VBA automatically assumes (for you) that you are referring to its value and hence \"completes\" (during run-time) your code to <code>checkBox1.Value</code>. This takes time and may essentially slow down your code (even if this is barely noticeable).</p>\n\n<p>To most programmers the second option is the preferred option because the <code>if</code> statement evaluates if something is <code>True</code> or <code>False</code>. Since the <code>.Value</code> of the checkbox is already <code>True</code> or <code>False</code> the first option is unnecessarily long. The value of checkbox1 is alredy <code>True</code>. So, why would you compare it to <code>True</code>?</p>\n\n<p>At the same time I always prefer to use the first option as it makes the code easier to read for me (personal preference).</p>\n\n<p>So, I'd say option 1 or 2: it's your choice.</p>\n"}], "owner": {"reputation": 15, "user_id": 1617513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0024c1e7e5cd4d161350b7936860a135?s=128&d=identicon&r=PG", "display_name": "Jon Torsch", "link": "https://stackoverflow.com/users/1617513/jon-torsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2123, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458138753, "creation_date": 1458136988, "question_id": 36037946, "link": "https://stackoverflow.com/questions/36037946/excel-vba-userform-checkbox-if-statement-syntax-differences", "title": "Excel VBA: Userform Checkbox - If Statement syntax differences", "body": "<p>I'm working with some checkboxes on a userform, and am checking if they have been checked by the user in my code. The question I'm running into is in how to properly check for this condition. I've found several examples, and am wondering where I may run into trouble with each.</p>\n\n<p>For example, I have seen several snippets use:</p>\n\n<pre><code>If checkBox1.Value = \"True\" Then\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If checkBox1.Value Then\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If checkBox1 Then\n</code></pre>\n\n<p>Is there any functional difference between these? It seems like the latter is the shortest, most succinct application, however the engineer's brain in me is saying there must be a reason for the other two cases (although the more I work with VBA, the less I believe in that concept).</p>\n\n<p>Any assistance or guidance you could provide would be appreciated. </p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1458137347, "post_id": 36037812, "comment_id": 59725358, "body": "Hard to tell at first glance, but what would really help you is to make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, trying it out, and sharing it with us here. This would make the issue easier and quicker to diagnose."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1458142747, "post_id": 36037812, "comment_id": 59729619, "body": "I agree, I apologize for not giving a more verifiable example, but I would need to provide a lot of assets including a database with my SQL statement. Thanks for taking a look though:-)"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1458144585, "post_id": 36037812, "comment_id": 59731065, "body": "No, you wouldn&#39;t. That&#39;s the &quot;minimal&quot; part of &quot;minimal, complete, and verifiable&quot;. Peel off the things that don&#39;t cause the error. Only keep what does in your example."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1458305859, "post_id": 36037812, "comment_id": 59814234, "body": "Oh yes, you are definitely right on there. I thought you were touching on the lack of completeness in my example. I&#39; usually have a hard time balance the minimal part and the complete part..."}], "answers": [{"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1458137401, "creation_date": 1458137401, "answer_id": 36038128, "question_id": 36037812, "link": "https://stackoverflow.com/questions/36037812/sub-is-affecting-the-wrong-excel-workbook/36038128#36038128", "title": "Sub is affecting the wrong Excel workbook", "body": "<p>When Cells and Columns are used alone, they refer to ActiveSheet.Cells and ActiveSheet.Columns.\nTry to prefix them with the targeted sheet:</p>\n\n<pre><code>Sub FreezePaneFormatting(xlapp As Excel.Application, ws As Worksheet, Optional lngRowFreeze As Long = 0, Optional lngColumnFreeze As Long = 0)\n\n    ws.Cells.WrapText = False\n    ws.Columns.AutoFit\n    ...\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "is_accepted": false, "score": 2, "last_activity_date": 1458144657, "last_edit_date": 1458144657, "creation_date": 1458142614, "answer_id": 36040320, "question_id": 36037812, "link": "https://stackoverflow.com/questions/36037812/sub-is-affecting-the-wrong-excel-workbook/36040320#36040320", "title": "Sub is affecting the wrong Excel workbook", "body": "<p>Okay, I figured out the issue here. I guess I can't use the \".Select\" or \"Selection.\" when I'm working with an invisible, non updating workbook. I found that when I changed some code from automated selecting to simply directly changing the value of cells, it worked out.</p>\n\n<p>OLD:</p>\n\n<pre><code>    startCell.Offset(0, i).Select\n    Selection.Value = rs.Fields(i).Name\n</code></pre>\n\n<p>NEW:</p>\n\n<pre><code>    ws.Cells(startCell.Row, startCell.Column).Offset(0, i).Value = rs.Fields(i).Name\n</code></pre>\n"}], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 36038128, "answer_count": 2, "score": 0, "last_activity_date": 1594651474, "creation_date": 1458136664, "last_edit_date": 1594651474, "question_id": 36037812, "link": "https://stackoverflow.com/questions/36037812/sub-is-affecting-the-wrong-excel-workbook", "title": "Sub is affecting the wrong Excel workbook", "body": "<p>I wrote this VBA code to generate a report from data in an Access table and dump it into Excel with user friendly formatting. </p>\n\n<p>The code works great the first time. But if I run the code again while the first generated Excel sheet is open, one of my subroutines affects the first workbook instead of the newly generated one. </p>\n\n<p>Why? How can I fix this? </p>\n\n<p>I think the issue is where I pass my worksheet and recordset to the subroutine called <code>GetHeaders</code> that prints the columns, but I'm not sure. </p>\n\n<pre><code>Sub testROWReport()\n\nDoCmd.Hourglass True\n\n'local declarations\nDim strSQL As String\nDim rs1 As Recordset\n'excel assests\nDim xlapp As excel.Application\nDim wb1 As Workbook\nDim ws1 As Worksheet\nDim tempWS As Worksheet\n'report workbook dimentions\nDim intColumnCounter As Integer\nDim lngRowCounter As Long\n\n'initialize SQL container\nstrSQL = \"\"\n'BEGIN: construct SQL statement {\n--this is a bunch of code that makes the SQL Statement\n'END: SQL construction}\n\n'Debug.Print (strSQL) '***DEBUG***\nSet rs1 = CurrentDb.OpenRecordset(strSQL)\n\n'BEGIN: excel export {\n    Set xlapp = CreateObject(\"Excel.Application\")\n    xlapp.Visible = False\n    xlapp.ScreenUpdating = False\n    xlapp.DisplayAlerts = False\n\n    'xlapp.Visible = True '***DEBUG***\n    'xlapp.ScreenUpdating = True '***DEBUG***\n    'xlapp.DisplayAlerts = True '***DEBUG***\n\n    Set wb1 = xlapp.Workbooks.Add\n    wb1.Activate\n    Set ws1 = wb1.Sheets(1)\n    xlapp.Calculation = xlCalculationManual\n    'xlapp.Calculation = xlCalculationAutomatic '***DEBUG***\n\n    'BEGIN: Construct Report\n    ws1.Cells.Borders.Color = vbWhite\n    Call GetHeaders(ws1, rs1) 'Pastes and formats headers\n    ws1.Range(\"A2\").CopyFromRecordset rs1 'Inserts query data\n    Call FreezePaneFormatting(xlapp, ws1, 1) 'autofit formatting, freezing 1 row,0 columns\n    ws1.Name = \"ROW Extract\"\n        'Special Formating\n        'Add borders\n        'Header background to LaSenza Pink\n        'Fix Comment column width\n        'Wrap Comment text\n\n        'grey out blank columns\n    'END: Report Construction\n\n    'release assets\n    xlapp.ScreenUpdating = True\n    xlapp.DisplayAlerts = True\n    xlapp.Calculation = xlCalculationAutomatic\n    xlapp.Visible = True\n\n    Set wb1 = Nothing\n    Set ws1 = Nothing\n    Set xlapp = Nothing\n    DoCmd.Hourglass False\n'END: excel export}\n\n End Sub\n\n    Sub GetHeaders(ws As Worksheet, rs As Recordset, Optional startCell As Range)\n\n    ws.Activate 'this is to ensure selection can occur w/o error\n\n    If startCell Is Nothing Then\n    Set startCell = ws.Range(\"A1\")\n    End If\n\n    'Paste column headers into columns starting at the startCell\n    For i = 0 To rs.Fields.Count - 1\n    startCell.Offset(0, i).Select\n    Selection.Value = rs.Fields(i).Name\n    Next\n\n    'Format Bold Text\n    ws.Range(startCell, startCell.Offset(0, rs.Fields.Count)).Font.Bold = True\n\nEnd Sub\nSub FreezePaneFormatting(xlapp As excel.Application, ws As Worksheet, Optional lngRowFreeze As Long = 0, Optional lngColumnFreeze As Long = 0)\n\n\n  Cells.WrapText = False\n  Columns.AutoFit\n\n    ws.Activate\n    With xlapp.ActiveWindow\n        .SplitColumn = lngColumnFreeze\n        .SplitRow = lngRowFreeze\n    End With\n    xlapp.ActiveWindow.FreezePanes = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458137550, "post_id": 36037482, "comment_id": 59725535, "body": "Please post your entire code including the <code>.Paste</code> into the new workbook.  Could it be that you&#39;re using <code>.Paste Link:=True</code>? Also, have you tried recording a macro to get something like this: <code>ThisWorkbook.BreakLink Name:=&quot;C:\\yourPath\\YourFile.xls&quot;, Type:=xlExcelLinks</code>?"}, {"owner": {"reputation": 115, "user_id": 5198910, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/545708f4a6a7c82b7ab41cdf9d8bd064?s=128&d=identicon&r=PG&f=1", "display_name": "JYurkovich", "link": "https://stackoverflow.com/users/5198910/jyurkovich"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458144990, "post_id": 36037482, "comment_id": 59731358, "body": "that is literally the only code that deals with copying to the Deliverable worksheet. The next line of code after paste is &#39;Rows(&quot;1:1&quot;).Select&#39;, and everything after I paste is literally sorting columns and adding cell formatting. No formulas of any kind.  I thought about doing the macro, but that still shows a link when you go through the file menu, so I think I was trying to get at the root of the problem."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458145394, "post_id": 36037482, "comment_id": 59731662, "body": "Why don&#39;t you try <code>.PasteSpecial xlPasteValues</code> or (as mentioned above) break any existing link after pasting (which preserves formulas)?"}, {"owner": {"reputation": 115, "user_id": 5198910, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/545708f4a6a7c82b7ab41cdf9d8bd064?s=128&d=identicon&r=PG&f=1", "display_name": "JYurkovich", "link": "https://stackoverflow.com/users/5198910/jyurkovich"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1458160082, "post_id": 36037482, "comment_id": 59741082, "body": "I worked it out. the links were named ranges that came over with the worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 5198910, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/545708f4a6a7c82b7ab41cdf9d8bd064?s=128&d=identicon&r=PG&f=1", "display_name": "JYurkovich", "link": "https://stackoverflow.com/users/5198910/jyurkovich"}, "is_accepted": false, "score": 0, "last_activity_date": 1458160164, "creation_date": 1458160164, "answer_id": 36046310, "question_id": 36037482, "link": "https://stackoverflow.com/questions/36037482/create-a-workbook-using-a-macro-with-no-formulas-but-still-linked-back-to-macro/36046310#36046310", "title": "Create a workbook using a macro with no formulas, but still linked back to macro workbook?", "body": "<p>OK, the links were being caused by named ranges in the workbook that came over with the copied worksheet. No formulas, just named ranges.</p>\n\n<p>I added this after the worksheet copy and it took care of it.</p>\n\n<pre><code>Dim nm As Name \n\nOn Error Resume Next \nFor Each nm In ActiveWorkbook.Names \n    nm.Delete \nNext \nOn Error Goto 0 \n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5198910, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/545708f4a6a7c82b7ab41cdf9d8bd064?s=128&d=identicon&r=PG&f=1", "display_name": "JYurkovich", "link": "https://stackoverflow.com/users/5198910/jyurkovich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458160164, "creation_date": 1458135898, "last_edit_date": 1531161705, "question_id": 36037482, "link": "https://stackoverflow.com/questions/36037482/create-a-workbook-using-a-macro-with-no-formulas-but-still-linked-back-to-macro", "title": "Create a workbook using a macro with no formulas, but still linked back to macro workbook?", "body": "<p>So I built this macro workbook that creates a formatted monthly report for me.</p>\n\n<p>How it works is the macro builds the report based on some criteria I define, then it copies the data portion from the worksheet \"Slide\" and pastes it as values to the next worksheet, \"Deliverable\", using this code:</p>\n\n<pre><code>Application.Goto (ActiveWorkbook.Sheets(\"Slide\").Range(\"A1\"))\nRange(\"C2\", Cells(TableRows, 30)).Select\nSelection.Copy\nActiveSheet.Next.Select\nActiveSheet.Paste\n</code></pre>\n\n<p>then it formats and sorts everything on \"Deliverable\", and copies it to a new workbook using this:</p>\n\n<pre><code>Sheets(\"Deliverable\").Select\nSheets(\"Deliverable\").Copy\n</code></pre>\n\n<p>The only issue is when you open up the new workbook that only contains the copy of \"Deliverable\", it's still linked back to the original macro workbook and you get the security warning. I could care less about this as I know it came from me, but the report is shared outside my organization and I would prefer to avoid questions and/or hassles for my clients.</p>\n\n<p>The new workbook is not macro enabled, and like I said above, contains no formulas, let alone those that reference the original workbook.</p>\n\n<p>What can I do to address this?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "edited": false, "score": 0, "creation_date": 1458138568, "post_id": 36037301, "comment_id": 59726308, "body": "Also I should mention, that I need to consider the case that I don&#39;t want records inserted into the new table for Projects before they were created. In another table - ProjectList, I have a field &quot;StartDate&quot; that should be checked in the case that  a new record is going to be inserted. ProjectList and Updates table are joined in a one-to-many relationship through the id field ProjectID."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "edited": false, "score": 0, "creation_date": 1458223083, "post_id": 36045504, "comment_id": 59771927, "body": "I added this code to the afterupdate() event for my status control on the update form. It returns no error however it is not filling in any values into my table?"}, {"owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "edited": false, "score": 0, "creation_date": 1458223244, "post_id": 36045504, "comment_id": 59772056, "body": "<code>Set db = CurrentDb</code> <code>Set rs = db.OpenRecordset(&quot;SELECT * FROM StatusTracking&quot;)</code>  <code>ID = DLookup(&quot;ProjectID&quot;, &quot;StatusTracking&quot;, &quot;[ValueMonth]=&quot; &amp; _</code>     <code>Month(Now()) &amp; &quot; AND [History] = &#39; 1 &#39;&quot;)</code>     <code>TempVars.Add &quot;CurrentStatus&quot;, Screen.ActiveControl.Value</code>     <code>If Day(Now()) = 1 Or IsNull(ID) = True Then</code>     <code>rs.AddNew</code>       <code>rs(&quot;ValueMonth&quot;) = Month(Now())</code>       <code>rs(&quot;ValueYear&quot;) = Year(Now())</code>       <code>rs(&quot;Status&quot;) = TempVars!CurrentStatus</code>       <code>rs(&quot;ProjectID&quot;) = Me.Controls(&quot;ProjectID&quot;).Value</code> <code>Else</code>      <code>rs.Update</code>    <code>End If</code>"}, {"owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "edited": false, "score": 0, "creation_date": 1458238846, "post_id": 36045504, "comment_id": 59783547, "body": "It seems the data is getting deleted, as the table has an autonumber and when I went to enter data manually into the table the autonumber started at 9 after trying the after update with no luck and never having deleted any data from the table manually."}, {"owner": {"reputation": 113, "user_id": 5946200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe95bb0e0a51286c4fd4c9c37e9696d3?s=128&d=identicon&r=PG&f=1", "display_name": "X0r", "link": "https://stackoverflow.com/users/5946200/x0r"}, "reply_to_user": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "edited": false, "score": 0, "creation_date": 1458323918, "post_id": 36045504, "comment_id": 59826730, "body": "What does your select query return when you run it?  If you get zero results when you&#39;re expecting something to return, it means the criteria needs to be adjusted."}], "tags": [], "owner": {"reputation": 113, "user_id": 5946200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe95bb0e0a51286c4fd4c9c37e9696d3?s=128&d=identicon&r=PG&f=1", "display_name": "X0r", "link": "https://stackoverflow.com/users/5946200/x0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1458157386, "creation_date": 1458157386, "answer_id": 36045504, "question_id": 36037301, "link": "https://stackoverflow.com/questions/36037301/loop-through-records-and-add-record-or-create-if-none-exists-to-new-table-depend/36045504#36045504", "title": "loop through records and add record or create if none exists to new table depending on multiple criteria", "body": "<p><a href=\"https://support.office.com/en-gb/article/DCount-function-counts-the-unique-values-in-a-record-set-227efeeb-5bb3-4343-8277-a0750daf3496\" rel=\"nofollow\">DCount</a> is useful for counting unique occurrences in a specified field.  The link I provided should put you on the right track there.  Note that that only returns the count itself, and not the records.  If you need to populate a recordset, you can use SELECT DISTINCT in your query to return only the records that have, well, distinct values in your criteria.</p>\n\n<p>I recently worked on a project that involved building a history table for tracking purposes.  Since it was based around forms, I opted for using .addnew and .update rather than INSERT INTO.  Of course, use what's best for the situation at hand; I used .addnew and .update for the main reason that I had a lot of controls in my form and it was simpler in my mind to do it that way.  There's lots of ways to do it, this worked best for me.  I've also provided a snippet of the code I wrote for that project as another example.</p>\n\n<p>Hope this helps!</p>\n\n<pre><code>'Example\n'Assuming recordset and database variables are already declared\n'rec = recordset, db = currentdb\n\nset rec = db.openrecordset(&lt;source table, name of existing query, or SQL query&gt;)\nif &lt;condition is met&gt; then\n'populate table with values in form controls\nrec.addnew\nrec(\"Destination Table Field\") = Me.Controls(\"Name of Form Control\").Value\n.\n.\n.\nrec.update\nset rec = nothing\nset db = nothing\n'clearing rec and db after done using\nend if\n</code></pre>\n\n<p>Code from my project:</p>\n\n<pre><code>Set db = CurrentDb\nSet rec = db.OpenRecordset(\"Select * from tbl_maintenanceOrders\")\nSet recHist = db.OpenRecordset(\"Select * from tbl_umoHistory\")\n\nmsgConfirm = MsgBox(\"Correct values confirmed?\", vbYesNo, \"Continue\")\n'enter record in maintenance order table\nIf msgConfirm = vbYes Then\n    rec.AddNew\n    recHist.AddNew\n    rec(\"openTimestamp\") = Now()\n    rec(\"openedBy\") = Me.Controls(\"cbo_originator\").Value\n    rec(\"assetID\") = Me.Controls(\"cbo_asset\").Value\n    rec(\"assetDesc\") = Me.Controls(\"txt_assetDesc\").Value\n    rec(\"priority\") = Me.Controls(\"cbo_priority\").Value\n    rec(\"umoProblemDesc\") = Me.Controls(\"txt_issueDesc\").Value\n    rec(\"umoSpecifics\") = Me.Controls(\"txt_issueDetails\").Value\n    rec(\"umoState\") = \"open\"\n    rec(\"umoStatus\") = \"new\"\n    rec.Update\n'add UMO history entry\n    recHist(\"umoID\") = rec(\"orderID\")\n    recHist(\"activity\") = \"opened\"\n    recHist(\"umoState\") = \"open\"\n    recHist(\"umoStatus\") = \"new\"\n    recHist(\"activityDesc\") = \"UMO Requested\"\n    recHist(\"initiatorID\") = Me.Controls(\"cbo_originator\").Value\n    recHist(\"timeStamp\") = Now()\n    recHist(\"updater\") = Me.Controls(\"cbo_originator\").Value\n    recHist.Update\n    End If\n'cleanup\nSet rec = Nothing\nSet recHist = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6071715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/93a4f3e92b526ec41d288b486625d286?s=128&d=identicon&r=PG&f=1", "display_name": "madelina", "link": "https://stackoverflow.com/users/6071715/madelina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1374, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1458157386, "creation_date": 1458135467, "last_edit_date": 1458140506, "question_id": 36037301, "link": "https://stackoverflow.com/questions/36037301/loop-through-records-and-add-record-or-create-if-none-exists-to-new-table-depend", "title": "loop through records and add record or create if none exists to new table depending on multiple criteria", "body": "<p>I'm new to access/vba and trying to set up a project database. I have a table (\"Updates\") that is generated when changes are made to certain fields on a form (used for project updates by the end user). It has the primary key UpdateID, foreign key ProjectID as well as UTimeStamp, OldValue, NewValue, History. I use the history key to identify which type of update was made (for example for Status, History=1). I want to then count the number of projects for each status at the end of each month, keeping historical data to allow users to track the changes from month to month (or even compare data from months apart). I'm trying to write a code (in VBA for access) that would take into account that there are sometimes multiple status updates in each month and I don't want them to get counted twice, also some months no updates are made but I still want them included in the count (using the last updated status before that month as the status). </p>\n\n<p>I was thinking of using a combination of looping through the records and checking to see if a value exists for that specific ProjectID and month and inserting the last value (most recent) into a new table \"StatusTracking\" and if no record exists then using the INSERT INTO function to add a new record. \"StatusTracking\" will have the fields ID, ValueMonth, ValueYear, (since ideally I want to track over the course of more than a year) Status, ProjectID. However, I am very new to this and am having trouble getting started as I'm not sure the best way to loop through both the months and ProjectID. </p>\n\n<pre><code>Public Function getStatus()\n\nDim varMonth As Integer\nDim ReportStatus As String\nDim RS As DAO.Recordset\nDim db As DAO.Database\nDim sqlStr As String\n\n\nsqlStr = \"SELECT Updates.ProjectID, Format(Month([UTimeStamp])) AS   UpdateMonth, ProjectList.Status, Updates.NewValue, Updates.UTimeStamp\" &amp; _\n\"FROM Updates RIGHT JOIN ProjectList ON Updates.ProjectID = ProjectList.ProjectID\" &amp; _\n\"WHERE (((Updates.History) = 1))\" &amp; _\n\"GROUP BY Updates.ProjectID, Format(Month([UTimeStamp])), ProjectList.Status, Updates.NewValue, Updates.UTimeStamp\"\n\nSet db = CurrentDb\nSet RS = db.OpenRecordset(sqlStr)\n\n\nWith RS\n\n.MoveLast\n.MoveFirst\n\n\nWhile (Not .EOF)\n\n    'Cycle through each month\n    For varMonth = 1 To 12 Step 1\n\n        ReportStatus = DLast(\"NewValue\", RS, \"UpdateMonth = \" &amp; varMonth)\n\n            RS.Fields (\"Status\") &lt;&gt; RS.Fields(\"NewValue\")\n\n\n\nEnd Function\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 8401374, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlGnH.jpg?s=128&g=1", "display_name": "Shaida Muhammad", "link": "https://stackoverflow.com/users/8401374/shaida-muhammad"}, "edited": false, "score": 0, "creation_date": 1600334943, "post_id": 36037490, "comment_id": 113057314, "body": "How to change fonts to calibri? for font size I used tbl.Range.Font.Size = 12 and it worked. What properties should I use for font family."}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 4, "last_activity_date": 1458135906, "creation_date": 1458135906, "answer_id": 36037490, "question_id": 36037065, "link": "https://stackoverflow.com/questions/36037065/how-to-change-the-font-size-of-all-tables-in-a-word-document-using-a-vba-macro/36037490#36037490", "title": "How to change the font size of all tables in a word document using a vba macro", "body": "<p>For your exact code use</p>\n\n<pre><code>   tbl.Range.Font.Size = 12\n</code></pre>\n\n<p>I have retyped a few things to show better naming and spacing etc.</p>\n\n<pre><code> Sub changetables()\n\n      Dim CurrentTable As Table\n\n      For Each CurrentTable In ActiveDocument.Tables\n\n           With CurrentTable\n\n                .AutoFitBehavior wdAutoFitWindow\n                .Columns.DistributeWidth\n                .Range.Font.Size = 12\n           End With\n\n      Next CurrentTable\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 793, "user_id": 1555502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0a7fe627a02aa8cbfeccc53fa88c195?s=128&d=identicon&r=PG", "display_name": "iantist", "link": "https://stackoverflow.com/users/1555502/iantist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6383, "favorite_count": 2, "accepted_answer_id": 36037490, "answer_count": 1, "score": 1, "last_activity_date": 1458135906, "creation_date": 1458134852, "question_id": 36037065, "link": "https://stackoverflow.com/questions/36037065/how-to-change-the-font-size-of-all-tables-in-a-word-document-using-a-vba-macro", "title": "How to change the font size of all tables in a word document using a vba macro", "body": "<p>I have a word document with a lot of tables. I would like a macro which changes the fonts size of all tables to 10, autofits each table to the window and distributes the columns evenly. I can accomplish the last two goals using the below code, but not sure how to change the font size. Any help would be greatly appreciated. </p>\n\n<pre><code>Sub changetables()\nDim tbl As Table\nFor Each tbl In ActiveDocument.Tables\n    tbl.AutoFitBehavior wdAutoFitWindow\n    tbl.Columns.DistributeWidth\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 5491402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lr2f9.jpg?s=128&g=1", "display_name": "Sythr", "link": "https://stackoverflow.com/users/5491402/sythr"}, "edited": false, "score": 0, "creation_date": 1458137262, "post_id": 36037338, "comment_id": 59725282, "body": "Works like a charm. Thank&#39;s for the Inspiration, that&#39;s what I needed"}], "tags": [], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "is_accepted": true, "score": 1, "last_activity_date": 1458135555, "creation_date": 1458135555, "answer_id": 36037338, "question_id": 36037038, "link": "https://stackoverflow.com/questions/36037038/create-sql-query-for-name-value-pair-data/36037338#36037338", "title": "Create SQL Query for Name/Value Pair Data", "body": "<p>You can use conditional aggregation like this:</p>\n\n<pre><code>SELECT t.id,t.source\n       max(CASE WHEN t.fieldname = 'From' then t.FieldValue end) as From_col,\n       max(CASE WHEN t.fieldname = 'To' then t.FieldValue end) as To_col,\n       max(CASE WHEN t.fieldname = 'Subject' then t.FieldValue end) as Subject_col\nFROM YourTable t\nGROUP BY t.id,t.source\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 6067281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/949949a56040429b3ba80ef204b35d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Avani", "link": "https://stackoverflow.com/users/6067281/avani"}, "is_accepted": false, "score": 1, "last_activity_date": 1458136496, "creation_date": 1458136496, "answer_id": 36037746, "question_id": 36037038, "link": "https://stackoverflow.com/questions/36037038/create-sql-query-for-name-value-pair-data/36037746#36037746", "title": "Create SQL Query for Name/Value Pair Data", "body": "<pre><code>SELECT id,\n  source,\n  MAX(DECODE(fieldname,'From',FieldValue)) f_From,\n  MAX(DECODE(fieldname,'To',FieldValue)) f_To ,\n  MAX(DECODE(fieldname,'Subject',FieldValue)) f_Subject\nFROM table\nGROUP BY id,\n  source;\n</code></pre>\n"}], "owner": {"reputation": 120, "user_id": 5491402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lr2f9.jpg?s=128&g=1", "display_name": "Sythr", "link": "https://stackoverflow.com/users/5491402/sythr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 2, "accepted_answer_id": 36037338, "answer_count": 2, "score": 2, "last_activity_date": 1458136496, "creation_date": 1458134776, "last_edit_date": 1458135819, "question_id": 36037038, "link": "https://stackoverflow.com/questions/36037038/create-sql-query-for-name-value-pair-data", "title": "Create SQL Query for Name/Value Pair Data", "body": "<p>I have data stored in a table like the one below, and I need to rearrange it. Theres a limited amount of \"FieldName\" entries. These should go as Header for the \"FieldValue\" Data. The data is stored in an Excel Workbook for further use.  I don't have the possibility to change the way data is stored and/or redesign the table.</p>\n\n<pre><code>ID | Source | FieldName | FieldValue  \n--------------------------------------------\n1  | EMail  | From      | Sender\n1  | EMail  | To        | Receiver\n1  | EMail  | Subject   | Whatever\n2  | EMail  | From      | Another Sender\n2  | EMail  | To        | Another Receiver\n2  | EMail  | Subject   | Other Text\n3  | Letter | From      | 3rd Sender\n3  | Letter | To        | asdg\n3  | Letter | Subject   | odasda\n</code></pre>\n\n<p>This is what the final table should look like.</p>\n\n<pre><code>ID | Source | From           | To               | Subject\n-----------------------------------------------------------------\n1  | EMail  | Sender         | Receiver         | Whatever\n2  | EMail  | Another Sender | Another Receiver | Other Text\n3  | Letter | 3rd Sender     | asdg             | odasda\n</code></pre>\n\n<p>The purpose of this is that - by having the data like this - i can join the data by ID onto other data.</p>\n\n<p>At the moment, I'm rearranging the data after running the query with vba in my Excel Workbook, but this feels kind of non-performant. </p>\n\n<p>Does anyone have some idea how to solve it? I didn't find anything after googling a while.</p>\n"}, {"tags": ["r", "excel", "import", "ms-word", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5973, "user_id": 3087927, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0eb1c6d3cb3f33fa2b60adcbacda549a?s=128&d=identicon&r=PG", "display_name": "cory", "link": "https://stackoverflow.com/users/3087927/cory"}, "edited": false, "score": 0, "creation_date": 1458137171, "post_id": 36037134, "comment_id": 59725216, "body": "Somebody is gonna yell at you for giving a link answer. If the link goes down... the answer is gone."}, {"owner": {"reputation": 369, "user_id": 5962832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a64b058212b0623b111c6d1353a31912?s=128&d=identicon&r=PG&f=1", "display_name": "M. Siwik", "link": "https://stackoverflow.com/users/5962832/m-siwik"}, "reply_to_user": {"reputation": 5973, "user_id": 3087927, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0eb1c6d3cb3f33fa2b60adcbacda549a?s=128&d=identicon&r=PG", "display_name": "cory", "link": "https://stackoverflow.com/users/3087927/cory"}, "edited": false, "score": 0, "creation_date": 1458145734, "post_id": 36037134, "comment_id": 59731904, "body": "You&#39;re right. I will add answer, when i will be back home."}, {"owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "edited": false, "score": 0, "creation_date": 1501835513, "post_id": 36037134, "comment_id": 77964388, "body": "Still not back? ;-) So the trick is using <code>library(xml2)</code> to process the unpacked word files."}], "tags": [], "owner": {"reputation": 369, "user_id": 5962832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a64b058212b0623b111c6d1353a31912?s=128&d=identicon&r=PG&f=1", "display_name": "M. Siwik", "link": "https://stackoverflow.com/users/5962832/m-siwik"}, "is_accepted": false, "score": 1, "last_activity_date": 1458135047, "creation_date": 1458135047, "answer_id": 36037134, "question_id": 36036891, "link": "https://stackoverflow.com/questions/36036891/is-there-a-way-to-import-data-from-word-to-r/36037134#36037134", "title": "Is there a way to import data from word to R", "body": "<p>This article will give you all the idea and code solution</p>\n\n<p><a href=\"http://www.r-bloggers.com/using-r-to-get-data-out-of-word-docs/\" rel=\"nofollow\">http://www.r-bloggers.com/using-r-to-get-data-out-of-word-docs/</a></p>\n"}], "owner": {"reputation": 161, "user_id": 4898882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6ggqA3pP12w/AAAAAAAAAAI/AAAAAAAAU_M/Kf9FxsiItvY/photo.jpg?sz=128", "display_name": "Gokce Mehmet AY", "link": "https://stackoverflow.com/users/4898882/gokce-mehmet-ay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458135047, "creation_date": 1458134384, "last_edit_date": 1531161705, "question_id": 36036891, "link": "https://stackoverflow.com/questions/36036891/is-there-a-way-to-import-data-from-word-to-r", "title": "Is there a way to import data from word to R", "body": "<p>Our lab gives EDS results as a word file like the one below.<a href=\"https://i.stack.imgur.com/bfP0u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bfP0u.png\" alt=\"Sample EDS Result\"></a></p>\n\n<p>My usual process is to copy the table to an excel sheet like <a href=\"https://stackoverflow.com/questions/12038461/moving-data-from-ms-word-to-ms-excel\">the answer here</a> however I've got more than 50 results and would like to speed things up. There is a macro for getting tables from Word to Excel <a href=\"https://stackoverflow.com/questions/4465212/macro-to-export-ms-word-tables-to-excel-sheets\">here</a>. It is faster than copy paste but it doesn't cycle through all files in a folder.</p>\n\n<p>Is there a way to get data off of Word to R?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1458136487, "post_id": 36036783, "comment_id": 59724616, "body": "@HansUp yes that&#39;s correct. I&#39;m replacing banker1 with 11 and 12 to begin with. Possibly adding a few more later on. For example I have a query called Banker1SavedEntry which refers to controls on a form called Banker1Statement. I need that to become Banker12SavedEntry etc. There are roughly 60 objects associated with each banker, not including VBA."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1458140509, "post_id": 36036783, "comment_id": 59727871, "body": "@HansUp sorry, yes I also need to change the query name. Which wasn&#39;t an issue in my original method because as I looped through the querydefs looking for ones that matched banker1 I saved them as the new name each time. The find/replace loop I created in Word to open each file in the folder, carry out the find/replace, and then close the file."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1458144387, "post_id": 36036783, "comment_id": 59730897, "body": "@HansUp I added a sample of the queries from the file created by exporting the querydef.SQL. The only thing that would change is BNK30 would become BNK31."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1458144916, "post_id": 36036783, "comment_id": 59731300, "body": "@HansUp that&#39;s the bit I&#39;m stuck on. When I do it using my original method, I&#39;m importing a specific file and telling Access what to save it as. When it&#39;s one long text file I&#39;m not sure if what I want to do is possible. I guess I need someway to tell Access that it is a new query."}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1458147175, "post_id": 36036783, "comment_id": 59732968, "body": "@HansUp thanks for taking the time to have a look :)"}, {"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1458151928, "post_id": 36036783, "comment_id": 59736163, "body": "@HansUp I didn&#39;t know I could do that on the querydef but I shall investigate that lead. Exporting to a text file is a bit of a pain!"}], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "edited": false, "score": 1, "creation_date": 1458562841, "post_id": 36053610, "comment_id": 59900281, "body": "thanks for this. I tried it out this morning and it works like a charm. Much appreciated :)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1458243063, "last_edit_date": 1458243063, "creation_date": 1458198072, "answer_id": 36053610, "question_id": 36036783, "link": "https://stackoverflow.com/questions/36036783/import-previously-exported-access-sql-queries-from-text-files/36053610#36053610", "title": "Import previously exported Access SQL queries from text files", "body": "<p>You can use a VBA procedure to modify both your query names and their SQL as needed.  That approach should be much simpler than dumping the query definitions to a text file, doing search and replace in the text file, and then (somehow?) modifying your queries based on the text file changes.</p>\n\n<p>For example, using the procedure below, you can do a <em>\"find/replace of BNK30 with BNK31\"</em> like this ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>ModifyQueries \"BNK30\", \"BNK31\"\n</code></pre>\n\n<p>However as written, the procedure does not change the queries. It only shows you the changes it would make if you enable the <code>.Name = strNewName</code> and <code>.SQL = strNewSql</code> lines.  Please review the output in the Immediate window before enabling those lines.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub ModifyQueries(ByVal pFind As String, ByVal pReplace As String)\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim strNewSql As String\n    Dim varNewName As Variant\n\n    Set db = CurrentDb\n    For Each qdf In db.QueryDefs\n        With qdf\n            varNewName = Null\n            strNewSql = vbNullString\n            If .Name Like \"*\" &amp; pFind &amp; \"*\" Then\n                varNewName = Replace(.Name, pFind, pReplace)\n                Debug.Print \"change \" &amp; .Name &amp; \" to \" &amp; varNewName\n                '.Name = strNewName\n            End If\n\n            If .SQL Like \"*\" &amp; pFind &amp; \"*\" Then\n                strNewSql = Replace(.SQL, pFind, pReplace)\n                Debug.Print Nz(varNewName, .Name) &amp; \" SQL: \"\n                Debug.Print strNewSql\n                '.SQL = strNewSql\n            End If\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>Beware that code has not been thoroughly tested.  It is intended only as a starting point; you must test and refine it.</p>\n\n<p>You should add error handling.  The procedure will throw an error if/when it attempts to name a query with a name which matches an existing query or table.</p>\n\n<p>Note, I wrote that procedure to rename queries.  If you prefer to create new queries instead, revise the code to do this ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>db.CreateQueryDef varNewName, strNewSql\n</code></pre>\n\n<p>Finally make sure to backup your database before running the \"enabled\" version of that code.  I doubt you need that warning, Nathan, but I cringe at the thought of anyone else inadvertently hosing their queries.</p>\n"}], "owner": {"reputation": 540, "user_id": 1440590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UQ39N.jpg?s=128&g=1", "display_name": "nathanjw", "link": "https://stackoverflow.com/users/1440590/nathanjw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 36053610, "answer_count": 1, "score": 1, "last_activity_date": 1458243063, "creation_date": 1458134121, "last_edit_date": 1495539910, "question_id": 36036783, "link": "https://stackoverflow.com/questions/36036783/import-previously-exported-access-sql-queries-from-text-files", "title": "Import previously exported Access SQL queries from text files", "body": "<p>I used the answer from this post to export my queries to a text file so I could do a find/replace exercise:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1275502/using-vba-to-export-all-ms-access-sql-queries-to-text-files\">Using VBA to export all ms access sql queries to text files</a></p>\n\n<p>I inherited a database that has object names, banker1, banker2 etc., hard coded and I had to create extras. I exported all of my queries and replaced banker1 with the new names. So far so good.</p>\n\n<p>Is it possible to reverse this process from the single text file generated and load the queries back into Access?</p>\n\n<p>My previous method involved exporting the queries to single text files using <code>Application.SaveAsText</code>, then looping through and doing my find/replace. The issue I encountered using this method is that the file is \"formatted\", possibly fixed width but not sure, such that some of the names were split across lines and therefore weren't detected by the find/replace. Loading them back in using <code>Application.LoadFromText</code> worked perfectly except I still had to search through queries to find the names that hadn't changed.</p>\n\n<p>Edit: Sample of queries requested.</p>\n\n<blockquote>\n  <p>BNK30-AddChargebacks\n  INSERT INTO BNK30EntryTable ( Entry )\n  SELECT BNK30SelectChargebacks.Entry\n  FROM BNK30SelectChargebacks\n  WHERE (((BNK30SelectChargebacks.Amount)&lt;>0));</p>\n  \n  <p>BNK30-AddCredit \n  INSERT INTO BNK30EntryTable ( Entry ) SELECT\n  BNK30EntryQuery.Credit FROM BNK30EntryQuery WHERE\n  (((BNK30EntryQuery.Amt)&lt;>0));</p>\n</blockquote>\n\n<p>In the above I would be doing a find/replace of BNK30 with BNK31 etc.</p>\n\n<p>Edit 2:</p>\n\n<pre><code>Operation =3\nName =\"BNK01SavedReserves\"\nOption =0\nWhere =\"(((BNK01Select.Reference) Is Null Or (BNK01Select.Reference)=[forms]![BNK01Nav]!\"\n    \"[txtReference]) AND ((BNK01Select.Date) Is Null Or (BNK01Select.Date)=[forms]![B\"\n    \"NK01Form]![StartedTime]))\"\nBegin InputTables\n    Name =\"BNK01Select\"\nEnd\nBegin OutputColumns\n    Name =\"AssignedTo\"\n</code></pre>\n\n<p>The above is from my original method which works except where the BNK01 is split; just above the <em>Begin InputTables</em> line. Hence trying to switch to exporting the SQL as one big file.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1489961033, "last_edit_date": 1489961033, "creation_date": 1458134776, "answer_id": 36037039, "question_id": 36036680, "link": "https://stackoverflow.com/questions/36036680/auto-fill-date-based-on-value/36037039#36037039", "title": "Auto-fill date based on value", "body": "<p>Resize the destination to two columns wide and add 'Registered\" along with the date.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Columns(3), Target) Is Nothing Then\n        On Error GoTo bm_SafeExit\n        Application.EnableEvents = False\n        Dim C As Range\n        For Each C In Intersect(Columns(3), Target, Target.Parent.UsedRange)\n            If IsEmpty(C.Offset(0, 8)) Then\n               C.Offset(0, 7).Resize(1, 2) = Array(\"registered\", Date)\n            End If\n        Next C\n    End If\nbm_SafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I've found that if you are going to process multiple Target cells (e.g. from a paste operation) then the loop through the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195772(v=office.11).aspx\" rel=\"nofollow noreferrer\">Intersect</a> of Target and your predetermined column should also be pared down to the extents of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow noreferrer\">Worksheet.UsedRange property</a>. Without it, a large number of blank cells would be looped through on a full column paste operation.</p>\n"}], "owner": {"reputation": 31, "user_id": 5975247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04fcab60073ece63fc96fae05cdb283e?s=128&d=identicon&r=PG", "display_name": "Solomon3y", "link": "https://stackoverflow.com/users/5975247/solomon3y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 36037039, "answer_count": 1, "score": 0, "last_activity_date": 1489961033, "creation_date": 1458133877, "last_edit_date": 1495541836, "question_id": 36036680, "link": "https://stackoverflow.com/questions/36036680/auto-fill-date-based-on-value", "title": "Auto-fill date based on value", "body": "<p>What the code does:</p>\n\n<p>Enter a name in column C, date populates in column K.</p>\n\n<p>Other:</p>\n\n<ol>\n<li>Drop down in column J can be \"registered\" or \"locked\"</li>\n<li>When data is entered in column C it auto populates \"registered\" in column J</li>\n</ol>\n\n<p>Here is the code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>'Adds date when borrower name is entered\r\nPrivate Sub Worksheet_Change(ByVal Target As Range)\r\n    Dim A As Range, B As Range, Inte As Range, r As Range\r\n    Set A = Range(\"C:C\")\r\n    Set Inte = Intersect(A, Target)\r\n    If Inte Is Nothing Then Exit Sub\r\n    Application.EnableEvents = False\r\n        For Each r In Inte\r\n            If r.Offset(0, 8).Value = \"\" Then\r\n               r.Offset(0, 8).Value = Date\r\n            End If\r\n        Next r\r\n    Application.EnableEvents = True\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I got this code from: <a href=\"https://stackoverflow.com/questions/26411407/auto-fill-the-date-in-a-cell-when-the-user-enters-information-in-an-adjacent-ce\">Auto-fill the date in a cell, when the user enters information in an adjacent cell</a></p>\n\n<p>What I would like the code to do:</p>\n\n<p>If column J is \"registered\" add date to column K (Which is currently does) </p>\n\n<p>If column J is changed to \"locked\", add date to column L</p>\n"}, {"tags": ["excel", "vba", "loops", "multidimensional-array"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1458133909, "post_id": 36036211, "comment_id": 59722318, "body": "Note that the changes I made in editing make it clearer how the logic of your program branches - keeping each sub-branch one indent further than the branch above allows you to look down the path to see how everything is nested together. This is VBA standard practice, and more or less mirrors practices in other languages."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1458133999, "post_id": 36036211, "comment_id": 59722386, "body": "Also - your question is not well worded - you use internal jargon referring to variable and function names in your question, which is not initially clear. Some examples of inputs and outputs would help show the logic of your program."}], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1458134899, "post_id": 36036897, "comment_id": 59723188, "body": "Ah I forgot to include .value when I put this in here. However, the true/false evaluation of checkboxes is correct (especially if you gave your checkbox a custom name)."}], "tags": [], "owner": {"reputation": 29, "user_id": 5448580, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qkNP5375A8E/AAAAAAAAAAI/AAAAAAAAAMg/80jFsqvE4Yw/photo.jpg?sz=128", "display_name": "Nerobyrne", "link": "https://stackoverflow.com/users/5448580/nerobyrne"}, "is_accepted": false, "score": 0, "last_activity_date": 1458134400, "creation_date": 1458134400, "answer_id": 36036897, "question_id": 36036211, "link": "https://stackoverflow.com/questions/36036211/looping-through-two-dimensional-arrays-based-on-conditions/36036897#36036897", "title": "Looping through two dimensional arrays based on conditions", "body": "<p>It appears that your syntax is incorrect, you need control.value in order to check what is written in a combobox.\nExample:\nElseIF ComboBox = \"Text1\" Or ComboBox = \"Text2\" Then</p>\n\n<p>should be:\nElseIF ComboBox.Value = \"Text1\" Or ComboBox.Value = \"Text2\" Then</p>\n\n<p>Also I would like to point out that you check the condition \"checkbox has been checked by the user\" with the line</p>\n\n<p>checkbox.value = -1 for checked and</p>\n\n<p>checkbox.value = 0 for unchecked.</p>\n\n<p>(This is really counterintuitive, I know.)</p>\n\n<p>The code \"If checkbox = true then ...\" doesn't cause an error, but it's not what you are looking for I assume.</p>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458134587, "creation_date": 1458132646, "last_edit_date": 1458134587, "question_id": 36036211, "link": "https://stackoverflow.com/questions/36036211/looping-through-two-dimensional-arrays-based-on-conditions", "title": "Looping through two dimensional arrays based on conditions", "body": "<p>I am trying to loop through a two dimensional array based on a few conditions. I think I must have my syntax wrong because my conditions are not triggering the new loop (through the array of dates). This new loop, will test whether or not the user input date (\"lastdate\") =  UACFArray(l, 0) and if not to find whether or not that date is in between the values stored in UACFArray(l, 0) &amp; UACFArray(0, m) and if so use the next position in that array(UACFArray(l+1, 0)/UACFArray(0, m+1). </p>\n\n<p>Some helpful information before you look through everything:</p>\n\n<p>a() is the original array in the original loop (loop i that is) that this is a part of. this loop is stuck at the very end of loop  i, so that it checks for this last. loop i begins with a case select statement for each step in a(). I stuck this loop at the end (of loop i) to override the previous values if the conditions are met. </p>\n\n<p>If this is overall sloppy and just plain bad, please feel free to suggest best practices approaches as I would love to learn better ways of thinking about these things. </p>\n\n<p>For example: User input is 1/3/15 (and since the code says to take lastdate+7 for the check), the conditions do not trigger the loop to check whether or not that 1) 1/3/15 doesnt match UACFArray(l, 0) nor does it check that its is in between UACFArray(l, 0) &amp; UACFArray(0, m). the output is that of the original arguments in the case select. </p>\n\n<p>Sample Code: </p>\n\n<pre><code>UACFArray(0, 0) = #1/6/2015#: UACFArray(0, 1) = #2/3/2015#\nUACFArray(1, 0) = #1/20/2015#: UACFArray(1, 1) = #2/17/2015#\nUACFArray(2, 0) = #2/10/2015#: UACFArray(2, 1) = #3/10/2015#\nUACFArray(3, 0) = #2/24/2015#: UACFArray(3, 1) = #3/24/2015#\nUACFArray(4, 0) = #3/17/2015#: UACFArray(4, 1) = #4/14/2015#\nUACFArray(5, 0) = #3/31/2015#: UACFArray(5, 1) = #4/28/2015#\nUACFArray(6, 0) = #4/21/2015#: UACFArray(6, 1) = #5/19/2015#\nUACFArray(7, 0) = #5/5/2015#: UACFArray(7, 1) = #6/2/2015#\n    If CheckBox = True And (ComboBox = \"Text1\" Or ComboBox = \"Text2\") And i = a(0) Then\n        For l = LBound(UACFArray, 1) To UBound(UACFArray, 1)\n            For m = LBound(UACFArray, 2) To UBound(UACFArray, 2)\n                If (LastDate + 7) &lt;&gt; UACFArray(l, 0) And (LastDate + 7) &gt; UACFArray(l, 0) And (LastDate + 7) &lt; UACFArray(0, m) Then\n                    BlcokStart = UACFArray(l + 1, 0)\n                    BlockEnd = UACFArray(0, m + 1)\n                End If\n            Next m\n        Next l\n    ElseIF ComboBox = \"Text1\" Or ComboBox = \"Text2\" Then\n        For l = LBound(UACFArray, 1) To UBound(UACFArray, 1)\n                If UACFArray(l, 0) = BlcokStart Then\n                    For m = LBound(UACFArray, 2) To UBound(UACFArray, 2)\n                        BlockEnd = UACFArray(l, m)\n                        a(i) = BlcokStart &amp; \" &amp; \" &amp; BlockEnd\n                        BlcokStart = UACFArray(l + 1, m)\n                    Next m\n                End If\n        Next l\n    End If\n</code></pre>\n"}, {"tags": ["string", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 5125921, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/034f2e7643ae425f5db23d8c404817a1?s=128&d=identicon&r=PG&f=1", "display_name": "whatin1992", "link": "https://stackoverflow.com/users/5125921/whatin1992"}, "edited": false, "score": 0, "creation_date": 1458135127, "post_id": 36036537, "comment_id": 59723397, "body": "Hmmm so I guess I need something to happen as soon as the job number is scanned in. So I was looking at some stuff and I think I need either a OnKeyDown or OnKeyPress event."}, {"owner": {"reputation": 159, "user_id": 5125921, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/034f2e7643ae425f5db23d8c404817a1?s=128&d=identicon&r=PG&f=1", "display_name": "whatin1992", "link": "https://stackoverflow.com/users/5125921/whatin1992"}, "edited": false, "score": 0, "creation_date": 1458135291, "post_id": 36036537, "comment_id": 59723561, "body": "So when the hyphen key is press/scanned in, the focus must go to the next textbox and continue the input there."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 159, "user_id": 5125921, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/034f2e7643ae425f5db23d8c404817a1?s=128&d=identicon&r=PG&f=1", "display_name": "whatin1992", "link": "https://stackoverflow.com/users/5125921/whatin1992"}, "edited": false, "score": 0, "creation_date": 1458136663, "post_id": 36036537, "comment_id": 59724774, "body": "use SetFocus to do that."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1458133471, "creation_date": 1458133471, "answer_id": 36036537, "question_id": 36036209, "link": "https://stackoverflow.com/questions/36036209/how-do-i-force-a-textbox-in-an-access-form-to-skip-to-the-next-textbox-when-a-sp/36036537#36036537", "title": "How do I force a textbox in an Access form to skip to the next textbox when a specific character is entered?", "body": "<pre><code>Sub OnExitTextBox1(strInput As String)\n\nDim aTest() As String\n\naTest = Split(strInput, \"-\")\n\nMe.TextBox1.value = aTest(0)\nMe.TextBox2.value = aTest(1)\n\nEnd Sub\n</code></pre>\n\n<p>Using the split function splits a string into an array based on a delimiter, in our case the hyphen, then you can use the array to pass to textbox1 and textbox2, the hyphen is removed, as its the delimiter, so your left with the 2 parts.</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 159, "user_id": 5125921, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/034f2e7643ae425f5db23d8c404817a1?s=128&d=identicon&r=PG&f=1", "display_name": "whatin1992", "link": "https://stackoverflow.com/users/5125921/whatin1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458133471, "creation_date": 1458132644, "question_id": 36036209, "link": "https://stackoverflow.com/questions/36036209/how-do-i-force-a-textbox-in-an-access-form-to-skip-to-the-next-textbox-when-a-sp", "title": "How do I force a textbox in an Access form to skip to the next textbox when a specific character is entered?", "body": "<p>I have 2 textboxes: job and suffix. The format looks like this.</p>\n\n<p>Job: H000001501\nSuffix: 0012</p>\n\n<p><em>However</em>, some of the reports we use combine both fields to make one scannable barcode, like so:</p>\n\n<p>Job Number H000001501-0012</p>\n\n<p>I want to allow my users to be able to either scan the barcode <strong>or</strong> type in the job and suffix. To do this, I need to make the job textbox skip over the hyphen (\"-\") when it's entered and finish inputting the suffix into the 2nd textbox. How do I do this? Would it have something to do with VBA?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1458134223, "post_id": 36036185, "comment_id": 59722561, "body": "You&#39;d add it here: <code>Workbooks.Open Filename:=FilesToOpen(x), Delimiter:=Chr(124), Origin:=65001</code>. It looks like you should perhaps be using <code>Workbooks.OpenText</code> if the files are text."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458134443, "post_id": 36036185, "comment_id": 59722754, "body": "@Rory the file is used to load about 40 different files at the same time. Other methods only open 1 file at a time, and open separate spreadsheets for each file"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458138426, "post_id": 36036185, "comment_id": 59726200, "body": "<code>Workbooks.Open</code> behaves the same way."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458139463, "post_id": 36036185, "comment_id": 59727029, "body": "@Rory I tried both the method you suggested, and putting Origin:=65001 before the Delimited:=Chr(124). Both times I got the Message that says &quot;Method &#39;Open&#39; of object &#39;Workbooks&#39; failed&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458139958, "post_id": 36036185, "comment_id": 59727432, "body": "Did you try <code>Workbooks.OpenText</code> instead?"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458140026, "post_id": 36036185, "comment_id": 59727470, "body": "@Rory Not all the file being imported are CSV or text. There are also some .xls and .xlsx files as well, that get imported at the same time"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1458140108, "post_id": 36036185, "comment_id": 59727541, "body": "Then you should test the extension and use whichever method is appropriate."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1458150311, "post_id": 36036185, "comment_id": 59735193, "body": "Why don&#39;t you test the extensions of each file as @Rory says, using <code>Application.FileDialog(msoFileDialogFilePicker)</code> to pick each file name, then open it as the extension requieres."}], "answers": [{"tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 1, "last_activity_date": 1613662480, "last_edit_date": 1613662480, "creation_date": 1458151643, "answer_id": 36043617, "question_id": 36036185, "link": "https://stackoverflow.com/questions/36036185/where-to-put-origin-65001-in-code/36043617#36043617", "title": "Where to put Origin:=65001 in code", "body": "<p>May be this could give you a hint.</p>\n<pre><code>Sub Test()\nDim FD As FileDialog\nDim FilesToOpen\nDim e\nDim tmp\n\nSet FD = Application.FileDialog(msoFileDialogFilePicker)\n\nWith FD\n    If .Show = -1 Then\n    appTGGL bTGGL:=False\n        For Each FilesToOpen In .SelectedItems\n            tmp = Split(Dir(FilesToOpen), &quot;.&quot;)\n            Select Case tmp(UBound(tmp)) 'the last\n                Case &quot;xlsx&quot;\n                    MsgBox &quot;2007&quot;\n                    Workbooks.Open Filename:=FilesToOpen\n                    Sheets().Move Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n                Case &quot;xlsm&quot;\n                    MsgBox &quot;2007M&quot;\n                    Workbooks.Open Filename:=FilesToOpen\n                    Sheets().Move Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n                Case &quot;xls&quot;\n                    MsgBox &quot;2003&quot;\n                    Workbooks.Open Filename:=FilesToOpen\n                    Sheets().Move Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n                Case &quot;csv&quot;\n                    MsgBox &quot;CSV&quot;\n                    Workbooks.Open Filename:=FilesToOpen, Delimiter:=Chr(124), Origin:=65001\n                    Sheets().Move Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n                Case &quot;txt&quot;\n                    MsgBox &quot;TXT&quot;\n                    Workbooks.Open Filename:=FilesToOpen, Delimiter:=Chr(124), Origin:=65001\n                    Sheets().Move Before:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n                Case Else\n                    MsgBox &quot;NO Ext/Other Ext&quot;\n            End Select\n        Next FilesToOpen\n    appTGGL\n    Else\n        MsgBox &quot;No Files were selected&quot;\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2010, "favorite_count": 0, "accepted_answer_id": 36043617, "answer_count": 1, "score": 3, "last_activity_date": 1613662480, "creation_date": 1458132556, "last_edit_date": 1495541733, "question_id": 36036185, "link": "https://stackoverflow.com/questions/36036185/where-to-put-origin-65001-in-code", "title": "Where to put Origin:=65001 in code", "body": "<p>This question is a follow on from a previous question <a href=\"https://stackoverflow.com/questions/35939045/replace-values-across-all-worksheets-with-new-value/35945208#35945208\">here</a>.</p>\n\n<p>Based on the answer by @Jeeped, it seems that the best way to resolve the issue is to insert this section of code into a macro:</p>\n\n<pre><code>Origin:=65001\n</code></pre>\n\n<p>This is in order to force my code to import the files in UTF-8 format.</p>\n\n<p>The issue now arises that I can't work out how or where to insert the code above in my macro. I have the following macro (that I found online - but can't remember where, so can't credit), that imports a large set of files into the workbook, creating spreadsheets for each file.</p>\n\n<pre><code>Sub Extractions()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.DisplayStatusBar = False\n\nDim FilesToOpen\nDim x As Integer\n\n    On Error GoTo ErrHandler\n\n    FilesToOpen = Application.GetOpenFilename _\n      (fileFilter:=\"Microsoft Excel Files (*.*?), *.*?\", MultiSelect:=True, Title:=\"Files to Import\")\n\n    If TypeName(FilesToOpen) = \"Boolean\" Then\n        MsgBox \"No Files were selected\"\n        GoTo ExitHandler\n    End If\n\n    x = 1\n    While x &lt;= UBound(FilesToOpen)\n        Workbooks.Open Filename:=FilesToOpen(x), Delimiter:=Chr(124)\n        Sheets().Move Before:=ThisWorkbook.Sheets _\n          (ThisWorkbook.Sheets.Count)\n        x = x + 1\n    Wend\n\nExitHandler:\n    Application.ScreenUpdating = False\n    Exit Sub\n\nErrHandler:\n    MsgBox Err.Description\n    Resume ExitHandler\n    Resume\n\nEnd Sub\n</code></pre>\n\n<p>Any suggestions on how to get around this issue?</p>\n\n<p>EDIT 1:</p>\n\n<p>Thanks to @Rory for his suggestions. After more investigation, it looks like <code>Origin:=65001</code> is not a valid entry in <code>Workbook.Open</code>.</p>\n\n<p>As such, I'm wondering is there any way that I can keep the original formatting from the text files, which is set to UTF-8, while I import to MFGI, using the code above? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458134405, "post_id": 36036434, "comment_id": 59722721, "body": "So if I was running this code from a command button that already has code withing its click event could I turn this code into a public sub and call it in the command button event?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458134837, "post_id": 36036434, "comment_id": 59723126, "body": "@BriannaCates  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458135369, "post_id": 36036434, "comment_id": 59723628, "body": "The only issue I have with that is that the excel workbook that is holding my code is pulling the worksheet that I want to be able to altar so the code would be removed every time a new sheet is added"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458136252, "post_id": 36036434, "comment_id": 59724407, "body": "@BriannaCates  If your button code is performing the column <b>C</b> changes, then have it also perform the column <b>A</b> and <b>B</b> format changes and forget about using an event macro."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458136610, "post_id": 36036434, "comment_id": 59724728, "body": "I got it to work by just making it a sub and calling it under my command button but your code worked perfect! Thanks so much :)"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458136956, "post_id": 36036434, "comment_id": 59725034, "body": "One more question though... Im sorry but what if the availability column already has nothing in it?.. What I want is just the changes... if its already nothing then I dont want the strike through, I just want the strike through to happen if the value changes to nothing not if it already is zero. Does that make sense?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458137243, "post_id": 36036434, "comment_id": 59725268, "body": "@BriannaCates  My code will not react to a <b>zero</b> in column <b>C</b>, only the entry of a <b>blank</b> in column <b>C</b>"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458137655, "post_id": 36036434, "comment_id": 59725610, "body": "Some of the value are already blank that I do not want to get a strikethrough"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458137926, "post_id": 36036434, "comment_id": 59725828, "body": "@BriannaCates  My code should only react to <b><i>changes</i></b> to blank not cells that <b><i>are</i></b> blank."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458141315, "post_id": 36036434, "comment_id": 59728506, "body": "Oh hmm when I run it it is turning the ones that are already blank are getting a strikethrough.. maybe I have something wrong"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458141655, "post_id": 36036434, "comment_id": 59728768, "body": "@BriannaCates  It is the nature of the Event macro to only process those cells that have changed."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1458141825, "post_id": 36036434, "comment_id": 59728903, "body": "I think that maybe the way I converted it into a regular sub and have that procedure called through the button in whats making it not work but I do not know how to put it any other way"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1458142331, "post_id": 36036434, "comment_id": 59729302, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/106486/discussion-between-brianna-cates-and-garys-student\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1458134814, "last_edit_date": 1458134814, "creation_date": 1458133152, "answer_id": 36036434, "question_id": 36035675, "link": "https://stackoverflow.com/questions/36035675/strikethrough-associated-cells-when-value-in-column-changes/36036434#36036434", "title": "Strikethrough associated cells when value in column changes", "body": "<p>With data like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dJpHB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dJpHB.png\" alt=\"enter image description here\"></a></p>\n\n<p>This worksheet event macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim watchrange As Range, r As Range, rw As Long\n    Dim intersectrange As Range, endrow As Long\n\n    endrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set watchrange = Range(\"C2:C\" &amp; endrow)\n    Set intersectrange = Intersect(Target, watchrange)\n    If intersectrange Is Nothing Then Exit Sub\n\n    For Each r In intersectrange\n        rw = r.Row\n        If r.Value = \"\" Then\n            Range(\"A\" &amp; rw &amp; \":B\" &amp; rw).Font.Strikethrough = True\n        Else\n            Range(\"A\" &amp; rw &amp; \":B\" &amp; rw).Font.Strikethrough = False\n        End If\n    Next r\nEnd Sub\n</code></pre>\n\n<p>will meet your needs.  You need to adjust the columns to match your data schema.</p>\n\n<p>Because it is worksheet code, it is very easy to install and automatic to use:</p>\n\n<ol>\n<li>right-click the tab name near the bottom of the Excel window</li>\n<li>select View Code - this brings up a VBE window</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you have any concerns, first try it on a trial worksheet.</p>\n\n<p>If you save the workbook, the macro will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the macro:</p>\n\n<ol>\n<li>bring up the VBE windows as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To learn more about Event Macros (worksheet code), see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/event.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/event.htm</a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This code is triggered by changes to column <strong>C</strong> and reside in the worksheet code area for that sheet.</p>\n\n<p>If your button code changes those column <strong>C</strong> values, then this event code would work with it.</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "accepted_answer_id": 36036434, "answer_count": 1, "score": 2, "last_activity_date": 1459500639, "creation_date": 1458131213, "last_edit_date": 1459500639, "question_id": 36035675, "link": "https://stackoverflow.com/questions/36035675/strikethrough-associated-cells-when-value-in-column-changes", "title": "Strikethrough associated cells when value in column changes", "body": "<p><br>\n<br>I have an excel sheet that has three columns:<br> <strong>employee number</strong> <br><strong>employee name</strong> <br><strong>availability</strong> <br><br>What I am trying to do is when the <strong>availability</strong> value changes from a number to nothing the <strong>employee number</strong> and the <strong>employee name</strong> associated with that row gets a strikethrough. <br>Also when an <strong>availability number</strong> is added the strikethrough disappears. <br>I have written some code below but I have no idea if I am going in the right direction.</p>\n\n<pre><code>Sub change(ByVal Target As Range)\nDim ws As Worksheet\nDim watchrange As Range\ndim intersectrange as range\n\nSet ws = Worksheets(\"Workbench Report\")\n\nendrow = ws.Cells(ws.Rows.count, \"E\").End(xlUp).Row\n\nSet watchrange = Range(\"E2:E\" &amp; endrow)\nSet intersectrange = Intersect(Target, watchrange)\nIf intersectrange = \"\" Then\nws.Range(\"B\" &amp; rng.Row).Resize(1, 2).Font.Strikethrough = True\nElse\n'do nothing\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Could someone help me?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "date", "macros", "vba"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1458134002, "creation_date": 1458134002, "answer_id": 36036732, "question_id": 36035625, "link": "https://stackoverflow.com/questions/36035625/automatic-date-and-time-get-refreshed-on-pressing-delete-key-in-excel/36036732#36036732", "title": "Automatic Date and Time get refreshed on pressing &quot;Delete&quot; Key in Excel", "body": "<p>Stepping through your code:</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n     If Target.Column &lt;&gt; 5 Then Exit Sub\n</code></pre>\n\n<p>\"If the target's column is not 5 then exit the subroutine\" This is cool.</p>\n\n<pre><code>    Application.EnableEvents = False\n</code></pre>\n\n<p>Flipping this to false insures that this code won't run again until this value is set to true. <code>Worksheet_Change</code> needs <code>enableevents</code> to be on. So now if the cell that changed was in Column <code>E</code> then <code>Worksheet_Change</code> will be kept from executing again. This makes sense to keep infinite loops from happening as cells are changed via this code.</p>\n\n<pre><code>    Target.Offset(0, -2).Value = Date\n</code></pre>\n\n<p>Set the cell that is two columns back from the target cell to the current date.</p>\n\n<pre><code>    Application.EnableEvents = True\n</code></pre>\n\n<p>Set <code>enableEvents</code> back on. This is good since you probably don't want to leave this off.</p>\n\n<pre><code>    If Target.Column &lt;&gt; 5 Then Exit Sub\n</code></pre>\n\n<p>Why are we checking this again? Target.Column hasn't changed since last time, and if it was already <code>&lt;&gt;5</code> then we wouldn't be here to test it. This line is superfluous.</p>\n\n<pre><code>    Application.EnableEvents = False\n</code></pre>\n\n<p>OK.. Well we just turned this on, but now we are turning this off again. Just leave it off.</p>\n\n<pre><code>    Target.Offset(0, -1).Value = Time\n</code></pre>\n\n<p>Set the value 1 column to the left of the target cell to the current time. Coolios.</p>\n\n<pre><code>     Application.EnableEvents = True\n</code></pre>\n\n<p>Turn <code>enableEvents</code> back on. This makes sense here.</p>\n\n<pre><code>End Sub\n</code></pre>\n\n<hr>\n\n<p>Rewriting this to remove the redundant toggles and superflous target.Column check:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'make sure this is column 5 that was changed. Like if anything changed in \n    ' column 5, then run the rest of this.\n    If Target.Column &lt;&gt; 5 Then Exit Sub\n\n    'Make sure we don't infinite loop if we accidently trigger a change to\n    ' column 5 in this code.\n    Application.EnableEvents = False\n\n    ' Set two cells to the left to the current date\n    ' and one cell to the left to the current time\n    Target.Offset(0, -2).Value = Date\n    Target.Offset(0, -1).Value = Time\n\n    'turn events back on.\n    Application.EnableEvents = True\n\n End Sub\n</code></pre>\n\n<hr>\n\n<p>So.. Everytime you make a change in Column 5, the date and time change. IF you want it so that it only changes a row's date and time once. Then check to see if date and time are already set for the row:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'make sure this is column 5 that was changed. Like if anything changed in \n    ' column 5, then run the rest of this.\n    If Target.Column &lt;&gt; 5 Then Exit Sub\n\n    'Check to see if the date and time are already set for this row:\n    ' If they are, then exit subroutine.\n    If target.offset(0,-2).value &lt;&gt; \"\" OR target.offset(0,-1).value &lt;&gt; \"\" Then Exit Sub\n\n    'Make sure we don't infinite loop if we accidently trigger a change to\n    ' column 5 in this code.\n    Application.EnableEvents = False\n\n    ' Set two cells to the left to the current date\n    ' and one cell to the left to the current time\n    Target.Offset(0, -2).Value = Date\n    Target.Offset(0, -1).Value = Time\n\n    'turn events back on.\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6071525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-t0V-z0D2BrE/AAAAAAAAAAI/AAAAAAAAAGw/KyFxhDPGW6M/photo.jpg?sz=128", "display_name": "Sameer Gupta", "link": "https://stackoverflow.com/users/6071525/sameer-gupta"}, "edited": false, "score": 0, "creation_date": 1458200835, "post_id": 36036842, "comment_id": 59756034, "body": "It worked great, for a moment. I am working on a table. After i pressed &quot;Delete&quot; key, date and time automatically appeared the desired cells. But then I selected all cells in Column E, and pressed &quot;Delete&quot; and a pop up came with an error, which I dismissed, now the code doesn&#39;t work at all. I see the cursor showing refresh action but date and time do not appear. It is happening every time I open the file and press &quot;Delete&quot; after selecting multiple cells in Column E. &#39;It throws Run-time error &#39;13&#39;: Type Mismatch&#39;"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 13, "user_id": 6071525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-t0V-z0D2BrE/AAAAAAAAAAI/AAAAAAAAAGw/KyFxhDPGW6M/photo.jpg?sz=128", "display_name": "Sameer Gupta", "link": "https://stackoverflow.com/users/6071525/sameer-gupta"}, "edited": false, "score": 0, "creation_date": 1458211151, "post_id": 36036842, "comment_id": 59762948, "body": "@SameerGupta  For more than one cell we need a <b>loop</b>.  I will update the code."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 13, "user_id": 6071525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-t0V-z0D2BrE/AAAAAAAAAAI/AAAAAAAAAGw/KyFxhDPGW6M/photo.jpg?sz=128", "display_name": "Sameer Gupta", "link": "https://stackoverflow.com/users/6071525/sameer-gupta"}, "edited": false, "score": 0, "creation_date": 1458260615, "post_id": 36036842, "comment_id": 59794035, "body": "@SameerGupta  See my <b>EDIT#1.</b>"}, {"owner": {"reputation": 13, "user_id": 6071525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-t0V-z0D2BrE/AAAAAAAAAAI/AAAAAAAAAGw/KyFxhDPGW6M/photo.jpg?sz=128", "display_name": "Sameer Gupta", "link": "https://stackoverflow.com/users/6071525/sameer-gupta"}, "edited": false, "score": 0, "creation_date": 1458274530, "post_id": 36036842, "comment_id": 59797490, "body": "Great! Works like a charm"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1458260592, "last_edit_date": 1458260592, "creation_date": 1458134266, "answer_id": 36036842, "question_id": 36035625, "link": "https://stackoverflow.com/questions/36035625/automatic-date-and-time-get-refreshed-on-pressing-delete-key-in-excel/36036842#36036842", "title": "Automatic Date and Time get refreshed on pressing &quot;Delete&quot; Key in Excel", "body": "<p>This will preserve the date/time once they have been entered:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column &lt;&gt; 5 Then Exit Sub\n    Application.EnableEvents = False\n        If Target.Offset(0, -2).Value = \"\" And Target.Offset(0, -2).Value = \"\" Then\n            Target.Offset(0, -2).Value = Date\n            Target.Offset(0, -1).Value = Time\n        End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This version will allow you to both set and clear multiple cells in column <strong>E</strong>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim r As Range, i1 As Long, i2 As Long\n\n    If Target.Column &lt;&gt; 5 Then Exit Sub\n\n    With ActiveSheet.UsedRange\n        i2 = .Rows.Count + .Row - 1\n        i1 = .Row\n    End With\n\n    Application.EnableEvents = False\n        For Each r In Intersect(Target, Range(\"E\" &amp; i1 &amp; \":E\" &amp; i2))\n            If r.Offset(0, -2).Value = \"\" And r.Offset(0, -1).Value = \"\" And r.Value &lt;&gt; \"\" Then\n                r.Offset(0, -2).Value = Date\n                r.Offset(0, -1).Value = Time\n            End If\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><em>Clearing a cell that is already empty will not cause a time/date recording.</em></p>\n"}], "owner": {"reputation": 13, "user_id": 6071525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-t0V-z0D2BrE/AAAAAAAAAAI/AAAAAAAAAGw/KyFxhDPGW6M/photo.jpg?sz=128", "display_name": "Sameer Gupta", "link": "https://stackoverflow.com/users/6071525/sameer-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 36036842, "answer_count": 2, "score": 1, "last_activity_date": 1458260592, "creation_date": 1458131105, "last_edit_date": 1531161705, "question_id": 36035625, "link": "https://stackoverflow.com/questions/36035625/automatic-date-and-time-get-refreshed-on-pressing-delete-key-in-excel", "title": "Automatic Date and Time get refreshed on pressing &quot;Delete&quot; Key in Excel", "body": "<p>I am using a simple code to enter date and time automatically in 2 separate cells in the excel sheet, however, they change automatically if I enter a new value in the cell or just press \"Delete\" Key. Below is the code I am using:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column &lt;&gt; 5 Then Exit Sub\nApplication.EnableEvents = False\nTarget.Offset(0, -2).Value = Date\nApplication.EnableEvents = True\nIf Target.Column &lt;&gt; 5 Then Exit Sub\nApplication.EnableEvents = False\nTarget.Offset(0, -1).Value = Time\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I need the date and time to remain static until I delete them from their respective cells. How can I achieve this?</p>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 3061364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eUkpU.png?s=128&g=1", "display_name": "Mr. Meeseeks", "link": "https://stackoverflow.com/users/3061364/mr-meeseeks"}, "edited": false, "score": 0, "creation_date": 1458134818, "post_id": 36036056, "comment_id": 59723107, "body": "It works! Thanks Vegard. Follow up question: How is it that when I get intellisense up - by pressing ctrl space - after ChartObjects(&quot;Chart 1&quot;) there is no &quot;Chart&quot; option to add next? Odd. It&#39;s like Chart isn&#39;t a known object of ChartObjects"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 239, "user_id": 3061364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eUkpU.png?s=128&g=1", "display_name": "Mr. Meeseeks", "link": "https://stackoverflow.com/users/3061364/mr-meeseeks"}, "edited": false, "score": 1, "creation_date": 1458135069, "post_id": 36036056, "comment_id": 59723358, "body": "I can&#39;t answer that, unfortunately. I do know that IntelliSense does work correctly if you declare a <code>ChartObjects</code> variable, like I did in the example I linked to. If I were to speculate it would be related to how the IDE parses object types on the fly, maybe?"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 2, "last_activity_date": 1458132260, "last_edit_date": 1495540226, "creation_date": 1458132260, "answer_id": 36036056, "question_id": 36035622, "link": "https://stackoverflow.com/questions/36035622/why-does-my-code-work-for-activechart-but-not-for-the-chart-name/36036056#36036056", "title": "Why does my code work for ActiveChart but not for the chart name?", "body": "<p>Try:</p>\n\n<pre><code>V_900_SPC.ChartObjects(\"Chart 1\").Chart.SeriesCollection(1).Values = \"='AR Data 900A SPC'!\" &amp; chart1values\n</code></pre>\n\n<p>The reasoning being that <code>ChartObject</code> and <code>Chart</code> isn't the same thing. <code>ChartObject</code> is a container for <code>Chart</code>, and <code>SeriesCollection</code> belongs to <code>Chart</code>.</p>\n\n<p>I recently <a href=\"https://stackoverflow.com/questions/35846158/create-an-average-of-multiple-excel-chart-without-the-data-source/36019602#36019602\">made a post on SO</a> that is relevant to this, that also contains more information and examples, as well as MSDN links.</p>\n"}], "owner": {"reputation": 239, "user_id": 3061364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eUkpU.png?s=128&g=1", "display_name": "Mr. Meeseeks", "link": "https://stackoverflow.com/users/3061364/mr-meeseeks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 36036056, "answer_count": 1, "score": 1, "last_activity_date": 1458132260, "creation_date": 1458131097, "last_edit_date": 1531164843, "question_id": 36035622, "link": "https://stackoverflow.com/questions/36035622/why-does-my-code-work-for-activechart-but-not-for-the-chart-name", "title": "Why does my code work for ActiveChart but not for the chart name?", "body": "<p>At the moment, my code reads:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n' This Macro Code for this sheet updates the x axis range for the graph in 'Dashboard' automatically\nDim V_900_SPC As Worksheet\nSet V_900_SPC = Sheets(\"AR Data 900A SPC\")\n\nDim chart1values As String, chart1_xvalues As String\nchart1values = Cells(2, 10)\nchart1_xvalues = Cells(3, 10)\n\nV_900_SPC.ChartObjects(\"Chart 1\").Activate\nActiveChart.SeriesCollection(1).Values = \"='AR Data 900A SPC'!\" &amp; chart1values\nActiveChart.SeriesCollection(1).XValues = \"='AR Data 900A SPC'!\" &amp; chart1_xvalues\n\nCells(1, 1).Activate\n\n\nEnd Sub\n</code></pre>\n\n<p>However if I replace \"ActiveChart.\" with \"V_900_SPC.ChartObjects(\"Chart 1\").\"  (and obviously delete the line that activates the chart object) then the code doesn't work. What's going on??</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4964002, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-KkCNZH9amcg/AAAAAAAAAAI/AAAAAAAAAEg/1v-YA3CG90o/photo.jpg?sz=128", "display_name": "chandra mouli", "link": "https://stackoverflow.com/users/4964002/chandra-mouli"}, "edited": false, "score": 0, "creation_date": 1458130093, "post_id": 36035267, "comment_id": 59719374, "body": "Can some one help me where am doing wrong plzzz"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1458130932, "post_id": 36035267, "comment_id": 59719949, "body": "Format your Code properly please. It looks like you are creating a function inside a sub, which won&#39;t work"}, {"owner": {"reputation": 8752, "user_id": 2087463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jPvET.png?s=128&g=1", "display_name": "tmthydvnprt", "link": "https://stackoverflow.com/users/2087463/tmthydvnprt"}, "edited": false, "score": 0, "creation_date": 1458131098, "post_id": 36035267, "comment_id": 59720086, "body": "This is a story, what is your question?"}, {"owner": {"reputation": 8752, "user_id": 2087463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jPvET.png?s=128&g=1", "display_name": "tmthydvnprt", "link": "https://stackoverflow.com/users/2087463/tmthydvnprt"}, "edited": false, "score": 0, "creation_date": 1458131118, "post_id": 36035267, "comment_id": 59720104, "body": "what is the error?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4964002, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-KkCNZH9amcg/AAAAAAAAAAI/AAAAAAAAAEg/1v-YA3CG90o/photo.jpg?sz=128", "display_name": "chandra mouli", "link": "https://stackoverflow.com/users/4964002/chandra-mouli"}, "edited": false, "score": 0, "creation_date": 1458131737, "post_id": 36035684, "comment_id": 59720572, "body": "i have done the same as u mentioned above and now am unable to compel it am not getting any option to compel (am using 2016)"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 1, "user_id": 4964002, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-KkCNZH9amcg/AAAAAAAAAAI/AAAAAAAAAEg/1v-YA3CG90o/photo.jpg?sz=128", "display_name": "chandra mouli", "link": "https://stackoverflow.com/users/4964002/chandra-mouli"}, "edited": false, "score": 0, "creation_date": 1458132383, "post_id": 36035684, "comment_id": 59721111, "body": "The code to test the function should NOT be placed in the module, but instead, in the Immediate window."}, {"owner": {"reputation": 1, "user_id": 4964002, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-KkCNZH9amcg/AAAAAAAAAAI/AAAAAAAAAEg/1v-YA3CG90o/photo.jpg?sz=128", "display_name": "chandra mouli", "link": "https://stackoverflow.com/users/4964002/chandra-mouli"}, "edited": false, "score": 0, "creation_date": 1458133742, "post_id": 36035684, "comment_id": 59722160, "body": "am very new to VBA and an when am searching how to remove special char in Excel i got the above code from here and am trying to implement the same but not happning"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1458131241, "creation_date": 1458131241, "answer_id": 36035684, "question_id": 36035267, "link": "https://stackoverflow.com/questions/36035267/compler-error-while-compiling-the-vba-code/36035684#36035684", "title": "Compler Error while compiling the VBA Code", "body": "<p>You can't place a function declaration inside a Sub. Here's the code reformatted, and with the Sub/End Sub lines commented out. </p>\n\n<pre><code>'Sub tem()\n\nFunction removeSpecial(sInput As String) As String\n  Dim sSpecialChars As String\n  Dim i As Long\n  sSpecialChars = \"/:*?\"\"&lt;&gt;|\" \n  For i = 1 To Len(sSpecialChars)\n    sInput = Replace$(sInput, Mid$(sSpecialChars, i, 1), \" \")\n  Next\n  removeSpecial = sInput\nEnd Function\n\n'End Sub\n</code></pre>\n\n<p>And when it is run from the immediate window:</p>\n\n<pre><code>?removespecial(\"a/a:a*a?a\"\"a&lt;a&gt;a|a\")\na a a a a a a a a\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4964002, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-KkCNZH9amcg/AAAAAAAAAAI/AAAAAAAAAEg/1v-YA3CG90o/photo.jpg?sz=128", "display_name": "chandra mouli", "link": "https://stackoverflow.com/users/4964002/chandra-mouli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1458131271, "creation_date": 1458130074, "last_edit_date": 1458131271, "question_id": 36035267, "link": "https://stackoverflow.com/questions/36035267/compler-error-while-compiling-the-vba-code", "title": "Compler Error while compiling the VBA Code", "body": "<pre><code>Sub tem()\nFunction removeSpecial(sInput As String) As String\n    Dim sSpecialChars As String\n    Dim i As Long\n    sSpecialChars = \"\\/:*?\"\"&lt;&gt;|\"\n    For i = 1 To Len(sSpecialChars)\n        sInput = Replace$(sInput, Mid$(sSpecialChars, i, 1), \" \")\n    Next\n    removeSpecial = sInput\nEnd Function\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "validation"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1458130409, "post_id": 36035050, "comment_id": 59719594, "body": "you didnt provide any of your own attempts. That being said your data validation would more likely be date format translations (take their input and convert it to your own) and a basic IF statement that would check values of (hours) and then execution an action based on that condition. This should get you started to be able to try it for yourself first."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458130432, "post_id": 36035050, "comment_id": 59719617, "body": "You can do almost exactly everything you need using the <a href=\"https://support.office.com/en-gb/article/Apply-data-validation-to-cells-c743a24a-bc48-41f1-bd92-95b6aeeb73c9\" rel=\"nofollow noreferrer\">data validation</a> feature in Excel - no need for VBA."}, {"owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458133743, "post_id": 36035050, "comment_id": 59722161, "body": "@Vegard please elaborate. how can i write a formula to enforce 24hr time format I can do each of the conditions individually but not simultaneously which is why i felt i needed to use VBA. fairly clueless though- Thank again"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458133872, "post_id": 36035050, "comment_id": 59722279, "body": "From the data validation menu, choose &quot;Allow: Timestamp&quot;, then add numberformat for 24h timestamps for those cells. If a valid timestamp is entered, it will display as 24h regardless."}, {"owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1458135050, "post_id": 36035050, "comment_id": 59723337, "body": "@DougCoats  I have reworded my issue hopefully this is easier to understand now - thanks"}, {"owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458135128, "post_id": 36035050, "comment_id": 59723399, "body": "@Vegard There is no option to allow time stamp only time"}, {"owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458135758, "post_id": 36035050, "comment_id": 59723968, "body": "@Vegard but I need a custom data validation. this is my issue!"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458136158, "post_id": 36035050, "comment_id": 59724319, "body": "Why? If you just want 24H format, you can do that with cell formatting and the validation as described. What condition do you need enforced that is not covered by this?"}, {"owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458137437, "post_id": 36035050, "comment_id": 59725444, "body": "@Vegard because I&#39;m using the 24hr format for a start and end time to calculate hours worked and this cannot exceed 37.5"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458138369, "post_id": 36035050, "comment_id": 59726164, "body": "Having glanced at the previous screenshot you posted, that does not seem to pose a problem. You can use formulas to validate the 37.5hr rule. I&#39;ll post an answer to show you the formula setup."}, {"owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458138978, "post_id": 36035050, "comment_id": 59726652, "body": "@Vegard Thank you very much"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458138990, "post_id": 36035050, "comment_id": 59726662, "body": "Actually, can you post the first screenshot again? The one where we can see how the workbook looks."}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1458139240, "creation_date": 1458139240, "answer_id": 36038869, "question_id": 36035050, "link": "https://stackoverflow.com/questions/36035050/multiple-data-validations-excel-macros/36038869#36038869", "title": "multiple data validations excel macros", "body": "<p>As mentioned in comments, you can use <a href=\"https://support.office.com/en-gb/article/Apply-data-validation-to-cells-c743a24a-bc48-41f1-bd92-95b6aeeb73c9\" rel=\"nofollow\">data validation</a> to take care of the timestamps.</p>\n\n<p>To enforce the condition \"put any number of worked time in excess of 37,5 hrs into overtime\", you can use two formulas to solve this.</p>\n\n<p>Assuming a workbook looking roughly like this:</p>\n\n<pre><code>    A          B        C\n1  Days       Hours    Hours\n2  Monday     8        8\n3  Tuesday    8        6\n4  Wednesday  8        7\n5  Thursday   8        5\n6  Friday     8        3\n7\n8  Regular\n9  Overtime\n10 Sum hrs\n</code></pre>\n\n<p>In cells B8 and C8, use this formula (enter it in to B8 and copy it to C8):<br>\n<code>=IF(SUM(B$2:B$6) &gt; 37,5; 37,5; SUM(B$2:B$6))</code></p>\n\n<p>In cells B9 and C9, use this formula (enter it in to B9 and copy it to C9):<br>\n<code>=IF(SUM(B$2:B$6) &gt; 37,5; SUM(B$2:B$6) - 37,5; 0)</code></p>\n\n<p>The workbook from above will then look like this:</p>\n\n<pre><code>    A          B        C\n1  Days       Hours    Hours\n2  Monday     8        8\n3  Tuesday    8        6\n4  Wednesday  8        7\n5  Thursday   8        5\n6  Friday     8        3\n7\n8  Regular    37,5     29\n9  Overtime   2,5      0\n10 Sum hrs    40       29\n</code></pre>\n\n<p>This can be adapted (with some changes to the formulae) to work with a scenario where you put \"Started work\" in one column and \"Ended work\" in another column. If you show me how your workbook looks, I can see about making such a change for you.</p>\n"}], "owner": {"reputation": 3, "user_id": 6071377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979669aa94d652f8745c094d4d9037ac?s=128&d=identicon&r=PG&f=1", "display_name": "A.Hulk", "link": "https://stackoverflow.com/users/6071377/a-hulk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 36038869, "answer_count": 1, "score": -1, "last_activity_date": 1458139253, "creation_date": 1458129470, "last_edit_date": 1458139253, "question_id": 36035050, "link": "https://stackoverflow.com/questions/36035050/multiple-data-validations-excel-macros", "title": "multiple data validations excel macros", "body": "<p>I need to consolidate the following two data validations into one condition </p>\n\n<p><a href=\"http://i.stack.imgur.com/yb0X1.png\" rel=\"nofollow\">Validation formuala</a>\nHere is the full formula from the image:</p>\n\n<p>((86400*((E5-D5)+(E6-D6)+(E7-D7)+(E8-D8)+(E9-D9)+(E10-D10)+(E11-D11)))/3600)+(7.5*SUM(G5:G11))&lt;=37.50</p>\n\n<p><a href=\"http://i.stack.imgur.com/nG3bu.jpg\" rel=\"nofollow\">Workbook</a></p>\n\n<p>I assumed I needed VBA to do this, please advise if at all possible</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1458129881, "post_id": 36035030, "comment_id": 59719222, "body": "Welcome to Stackoverflow. Can you paste an example of what your tables look like. Also, provide some of the code you have developed, this way it wont seem like a &quot;request for code&quot; question. Coping Data between two instances of Excel is not difficult so I am sure we can get you sorted quickly."}, {"owner": {"reputation": 29, "user_id": 6066626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2df24c54da079baf0412e2408baa066?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/6066626/ricky"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1458132419, "post_id": 36035030, "comment_id": 59721140, "body": "Thanks Jeeeped!!  Sorry I asked a question that was already answered - I couldn&#39;t find it....but the link to that answer solved my problem!!!"}], "owner": {"reputation": 29, "user_id": 6066626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2df24c54da079baf0412e2408baa066?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/6066626/ricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1458130698, "answer_count": 0, "score": 0, "last_activity_date": 1458131209, "creation_date": 1458129409, "last_edit_date": 1458131209, "question_id": 36035030, "link": "https://stackoverflow.com/questions/36035030/vba-paste-values", "closed_reason": "Duplicate", "title": "VBA Paste Values", "body": "<p>I'm working on a project that moves many pivot tables from multiple books to one master workbook.  I've got all of the tabs from the source moved into the master book, but now I need to find some code that will break the links between the pivot tables and the source books.  I was thinking a paste special/values function would do the trick but I'm having difficulty getting that to work.  I would also like to note that the VBA macro is located in a different workbook than in the master workbook, so that seems to be complicating things.  Any help would be greatly appreciated!!</p>\n\n<p>Here is the code I have so far</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Run_Process()\n\nDim Y As String\nDim M As String\nDim MonthName As String\n\n\n\nY = \"2016\"\nM = \"01\"\nMonthName = \"January\"\n\n'Opens the workbooks\nWorkbooks.Open  Filename:=\"\\\\(Path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CD_1993 Source.xlsx\"\nWorkbooks.Open Filename:=\"\\\\(Path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CD_1997 Source.xlsx\"\nWorkbooks.Open Filename:=\"\\\\(Path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CD_2002 Source.xlsx\"\nWorkbooks.Open Filename:=\"\\\\(path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CD_1993 Source2.xlsx\"\nWorkbooks.Open Filename:=\"\\\\(path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CD_1997 Source2.xlsx\"\nWorkbooks.Open Filename:=\"\\\\(path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CD_2002 Source2.xlsx\"\n\n\n'Adding New Workbook\nWorkbooks.Add\n'Saving the Workbook\nActiveWorkbook.SaveAs Filename:=\"\\\\(path)\\\" &amp; Y &amp; \"\\\" &amp; Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\"\n\n\n'Begin Copying and renaming the tabs from the source workbooks\n\nWorkbooks(Y &amp; M &amp; \"CD_2002 Source2.xlsx\").Sheets(\"2002\").Copy     Before:=Workbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Sheets(1)\nSheets(\"2002\").Name = \"2002 Rpt - \" &amp; MonthName &amp; \" \" &amp; Y\n\nWorkbooks(Y &amp; M &amp; \"CD_2002 Source.xlsx\").Sheets(\"Summ by Pool Year\").Copy Before:=Workbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Sheets(1)\nSheets(\"Summ by Pool Year\").Name = \"2002 Summ by Pool Year\"\n\nWorkbooks(Y &amp; M &amp; \"CD_1997 Source2.xlsx\").Sheets(\"1997\").Copy Before:=Workbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Sheets(1)\nSheets(\"1997\").Name = \"1997 Rpt - \" &amp; MonthName &amp; \" \" &amp; Y\n\nWorkbooks(Y &amp; M &amp; \"CD_1997 Source.xlsx\").Sheets(\"Summ by Pool Year\").Copy Before:=Workbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Sheets(1)\nSheets(\"Summ by Pool Year\").Name = \"1997 Summ by Pool Year\"\n\nWorkbooks(Y &amp; M &amp; \"CD_1993 Source2.xlsx\").Sheets(\"1993\").Copy Before:=Workbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Sheets(1)\nSheets(\"1993\").Name = \"1993 Rpt - \" &amp; MonthName &amp; \" \" &amp; Y\n\nWorkbooks(Y &amp; M &amp; \"CD_1993 Source.xlsx\").Sheets(\"Summ by Pool Year\").Copy Before:=Workbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Sheets(1)\nSheets(\"Summ by Pool Year\").Name = \"1993 Summ by Pool Year\"\n\nWorkbooks(Y &amp; M &amp; \"CR_CUNA_Client_Report_Test.xlsx\").Activate\n\n'Dim Sh As Worksheet\n'  For Each Sh In (Format$(Y, \"0000\") &amp; Format$(M, \"00\") &amp;     \"CR_CUNA_Client_Report_Test.xlsx\").Worksheets\n'   If Sh.Visible = True Then\n'        Sh.Activate\n'        Sh.Cells.Copy\n'        Sh.Range(\"A1\").PasteSpecial Paste:=xlValues\n'\n'       Sh.Range(\"A1\").Select\n'   End If\n' Next Sh\n'Application.CutCopyMode = False\n</code></pre>\n\n<p>Where CR_CUNA_Client_Report_Test.xlsx is the Master sheet that I'm trying to break the links to the source workbooks in.....</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458130609, "post_id": 36034807, "comment_id": 59719725, "body": "How is it not working correctly?"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458131538, "post_id": 36034807, "comment_id": 59720434, "body": "I have a form, which is continous form of joined table. In form&#39;s header I use Dlookup fields to view what Table2 record I wish to &quot;join&quot; with Table1 record. In this continous form I have replaced field ID_Table1(FK) with Combobox that displays records from Table1, and stores It&#39;s value into ID_Table1(FK). That creates link. Now If I select whatever value from that Combobox I get this code executed, even if It doesn&#39;t exist yet in JoinTable record. So, if It doesn&#39;t exist yet, then code should allow me to link tables."}], "answers": [{"tags": [], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "is_accepted": true, "score": 0, "last_activity_date": 1458132068, "creation_date": 1458132068, "answer_id": 36035986, "question_id": 36034807, "link": "https://stackoverflow.com/questions/36034807/access-custom-the-changes-you-requested-to-the-table-were-not-succesfull/36035986#36035986", "title": "Access - custom &quot;The changes you requested to the table were not succesfull...&quot;", "body": "<p>I figured out, what a stupid mistake :</p>\n\n<p>Instead of</p>\n\n<pre><code>If DCount(\"*\", \"Table1\", sWhere) &gt; 0 Then \n</code></pre>\n\n<p>I had to change to </p>\n\n<pre><code> If DCount(\"*\", \"JoinTable\", sWhere) &gt; 0 Then \n</code></pre>\n\n<p>Code didn't work because I was referencing to wrong Table. Problem solved, thanks for response Matt.</p>\n"}], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 36035986, "answer_count": 1, "score": 0, "last_activity_date": 1458132068, "creation_date": 1458128831, "question_id": 36034807, "link": "https://stackoverflow.com/questions/36034807/access-custom-the-changes-you-requested-to-the-table-were-not-succesfull", "title": "Access - custom &quot;The changes you requested to the table were not succesfull...&quot;", "body": "<p>I have set Duplicates(No) to one of my table's ID. Then I created a form with Combobox to select all records from that table and to store selected record in a field of joined table (ID foreign key). If I try to add another record with same ID, Access prompts me with a warning message \"The changes you requested to the table were not succesfull...etc).</p>\n\n<p>What I want is to remove this message and create a custom one. Here is what I tried:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n\nDim sWhere As String\nsWhere = \"[ID_Table]=\" &amp; Me.Combo5\n'\nIf DCount(\"*\", \"Table1\", sWhere) &gt; 0 Then \n\nCancel = True\nMe.Undo\nMsgBox \" Duplicate\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This code executes If I select whatever value from combobox. Here are my tables:</p>\n\n<pre><code>Table1\nID_Table(PK)\nField1\nField2 etc.\n\nJoinTable\nID_Join(PK)\nID_Table1(FK)\nID_Table2(FK)\n</code></pre>\n\n<p>ID Field that has property Duplicates(No) is in Table1 (PK). How can I get this working correctly ?</p>\n"}, {"tags": ["vba", "excel", "range"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458128934, "post_id": 36034770, "comment_id": 59718580, "body": "It could use a &#39;dot&#39; in front of <code>.Range(&quot;B9&quot;)</code> as well."}, {"owner": {"reputation": 11, "user_id": 6006982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e449b1a16282ae60a58a0f31bbc0748?s=128&d=identicon&r=PG&f=1", "display_name": "eklo", "link": "https://stackoverflow.com/users/6006982/eklo"}, "edited": false, "score": 0, "creation_date": 1458132773, "post_id": 36034770, "comment_id": 59721404, "body": "Thank you for your answer!"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 0, "last_activity_date": 1458129169, "last_edit_date": 1458129169, "creation_date": 1458128726, "answer_id": 36034770, "question_id": 36034598, "link": "https://stackoverflow.com/questions/36034598/creating-a-range-from-several-ranges-in-excel-vba/36034770#36034770", "title": "Creating a range from several ranges in excel vba", "body": "<p>You don't seem to set an initial range for OldRange, so it'll be Nothing during the first iteration - the likely cause of your error.</p>\n\n<p>Delete this line:</p>\n\n<pre><code>Set OldRange = MatrixRange\n</code></pre>\n\n<p>Correct this line to include a dot in front of Cells:</p>\n\n<pre><code>Set NextRange = .Range(Range(\"B9\").Offset(n + 1, n), .Cells(78, n + 2))\n</code></pre>\n\n<p>and before the For Loop, add this (extra dot noted, thanks Jeeped):</p>\n\n<pre><code>Set OldRange = .Range(.Range(\"B9\").Offset(1,0), .Cells(78, 2))\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6006982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e449b1a16282ae60a58a0f31bbc0748?s=128&d=identicon&r=PG&f=1", "display_name": "eklo", "link": "https://stackoverflow.com/users/6006982/eklo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458129169, "creation_date": 1458128239, "question_id": 36034598, "link": "https://stackoverflow.com/questions/36034598/creating-a-range-from-several-ranges-in-excel-vba", "title": "Creating a range from several ranges in excel vba", "body": "<p>I have a worksheet with a matrix, which is divided diagonally with a cell that is black. The matrix contains the same header, both vertically and horisontally.\nThe idea is that you show the relation between the items in the bottom area, below the diagonal.</p>\n\n<p>I want to create a Range (MatrixRange) that is the bottom part of the area. </p>\n\n<p>What I'm trying to do is create a range for each column that I use, and add it to the MatrixRange. The different ranges im trying to combine is therefore of different height.</p>\n\n<pre><code>Dim MatrixRange As Range\n\nPrivate Sub Workbook_Open()\n\nDim n As Integer\nDim NextRange As Range\nDim OldRange As Range\nDim ws As Worksheet\n\nSet ws = Sheets(\"Systemmatrise\")\n\nWith ws\n    For n = 1 To 68\n        Set OldRange = MatrixRange\n        Set NextRange = .Range(Range(\"B9\").Offset(n + 1, n), Cells(78, n + 2))\n        Set MatrixRange = Union(OldRange, NextRange)\n\n    Next n\n\nEnd With\n\nDebug.Print MatrixRange\n\nEnd Sub\n</code></pre>\n\n<p>I get a \"Runtime error 5\" after</p>\n\n<pre><code>Set MatrixRange = Union(OldRange, NextRange)\n</code></pre>\n\n<p>Is there an easier way to create this Range, or somehow to fix this problem?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "search", "offset", "vlookup", "msgbox"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458131774, "post_id": 36035121, "comment_id": 59720610, "body": "Thank you for helping but It does not seem to work. Let me clarify: i need the vba to automatically go to column A &amp; B to find the stock ticker and the name, along with column c value to show in msgbox. base on what you have written above the msgbox will only show &quot;column c value is&quot; along with the column c value. thank you again!"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458131947, "post_id": 36035121, "comment_id": 59720745, "body": "it works for me. ensure you copied listener to Sheet Object and macro to Module"}, {"owner": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458132228, "post_id": 36035121, "comment_id": 59720973, "body": "i am sorry, can you please explain &quot;ensure you copied listener to Sheet Object&quot;?"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458132436, "post_id": 36035121, "comment_id": 59721160, "body": "When you open VBA Editor, you see list of Sheets and Modules. You need to copy first piece of code into the sheet, where you have  your stock data and columns A,B,C"}, {"owner": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458133020, "post_id": 36035121, "comment_id": 59721600, "body": "i don&#39;t know what I&#39;m doing wrong. I followed your instruction copied the first piece of code into the sheet where i have the stock data. then i went over to the left right click and created a new module, then i copied the sub msgboxmacro code you have designed. what do i do afterwards? i pressed save, and press F5 try to see if it works but nothing happened. am i doing it right? or missing any steps? thanks again!"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458133210, "post_id": 36035121, "comment_id": 59721752, "body": "First ensure you have correct column number (in my code 3). Then ensure, MsgBoxMacro finds columns A and B correctly to fetch their values. I just assume A and B preceding C, but you need to substract correct number. Finally, you don&#39;t need to press F5, just go to your sheet and try to change value in your column manually"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458133415, "post_id": 36035121, "comment_id": 59721902, "body": "Do I understand correctly, that you have DDE server that fetches stock data in real-time and you need to capture it, calculate C column and show message box in case it meets your requirements? Or you just have static data and want to show messagebox? In this case, my code will not work, it only captures realtime changes. If you want ot find which rows fall under your criteria, you can just do simple Excel formula"}, {"owner": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "edited": false, "score": 0, "creation_date": 1458202060, "post_id": 36035121, "comment_id": 59756717, "body": "what is i have Column D, (a different critiria), which needs exact same instruction as Column C. I have trouble putting two codes together, so that that when column D value match the critria it will also pop up in msgbox column A &amp; B to find the stock ticker and the name, along with column D value. I need both C &amp; D to pop up msgbox. Thank you."}], "tags": [], "owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "is_accepted": true, "score": 0, "last_activity_date": 1458131302, "last_edit_date": 1458131302, "creation_date": 1458129652, "answer_id": 36035121, "question_id": 36033527, "link": "https://stackoverflow.com/questions/36033527/vba-constantly-listen-to-changes-in-cells-that-meet-specific-criteria/36035121#36035121", "title": "VBA, constantly listen to changes in cells that meet specific criteria", "body": "<p>Insert this Event change listener to your Sheet (e.g. Sheet1). Target.Column is your Column C (pass your correct column number)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Target.column = 3 And Target.value &gt;= -4 And Target.value &lt;= 4 Then\n    Call MsgBoxMacro(Target.value, Target.column, Target.row)\n  End If\nEnd Sub\n</code></pre>\n\n<p>Then add new macro (right click -> insert -> new module). Pass cell value to it.</p>\n\n<pre><code>Sub MsgBoxMacro(value, column, row)\n    MsgBox \"Ticker: \" &amp; Cells(row, column - 2) &amp; vbNewLine &amp; \"Stock Name: \" &amp; Cells(row, column - 1) &amp; vbNewLine &amp; \"Variable Value: \" &amp; value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6071049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e736b6b800ad9f0aa476a22b397b1?s=128&d=identicon&r=PG&f=1", "display_name": "Laura Lee", "link": "https://stackoverflow.com/users/6071049/laura-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 36035121, "answer_count": 1, "score": 2, "last_activity_date": 1458133759, "creation_date": 1458125568, "last_edit_date": 1458133759, "question_id": 36033527, "link": "https://stackoverflow.com/questions/36033527/vba-constantly-listen-to-changes-in-cells-that-meet-specific-criteria", "title": "VBA, constantly listen to changes in cells that meet specific criteria", "body": "<p>I am new to VBA, I have an excel sheet that contains data on stocks.</p>\n\n<ul>\n<li>column A - stock ticker</li>\n<li>column B - stock name</li>\n<li>column C - \"the variable number\"\uff0cthe number that changes all the\ntime.</li>\n</ul>\n\n<p>When the number in column C is between [-4;4], then a message box should pop       up showing the stock ticker in column A &amp; the name in column B, with the number in column C.</p>\n\n<p>For example, if at this moment, Google value in column C is -1, then the message box will show: Google Alphabet Inc -1 [in this example: Googl(column A)\u3001Alphabet Inc(column B), -1 (the change value is column C).</p>\n\n<p>Please help me out, thank you so much!</p>\n"}, {"tags": ["vba", "excel", "transpose"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1458140533, "last_edit_date": 1458140533, "creation_date": 1458127298, "answer_id": 36034226, "question_id": 36033386, "link": "https://stackoverflow.com/questions/36033386/vba-transpose-multiple-times/36034226#36034226", "title": "VBA transpose multiple times", "body": "<p>Try the <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX function</a>.</p>\n\n<pre><code>=INDEX($1:$1, 1, ROW(1:1))\n</code></pre>\n\n<p>\u00a0\u00a0<a href=\"https://i.stack.imgur.com/8vOC5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8vOC5.png\" alt=\"index_dumbass\"></a></p>\n\n<p><strong>Addendum: <a href=\"https://dl.dropboxusercontent.com/u/100009401/VBA%20transpose%20multiple%20times.xlsb\" rel=\"nofollow noreferrer\">VBA strip &amp; transpose</a></strong></p>\n\n<p>Dumping the values from the S&amp;P 500 Constituents worksheet into a two-dimensioned variant array and processing the reorientation in-memory to a second array would be the most expedient method.</p>\n\n<pre><code>Sub Flip()\n' Flip Macro\n    Dim v As Long, val As Variant, vals As Variant\n    Dim a As Long, b As Long, stp As Long\n\n    stp = 16\n    ReDim val(1 To stp, 1 To 1)\n\n    With Worksheets(\"S&amp;P 500 Constituents\")\n        With .Range(.Cells(2, \"I\"), .Cells(Rows.Count, \"CM\").End(xlUp))\n            vals = .Value2\n        End With\n    End With\n\n    With Worksheets(\"Sheet1\")\n        For a = LBound(vals, 1) To UBound(vals, 1)\n            For b = LBound(vals, 2) To UBound(vals, 2) - stp Step stp\n                For v = 1 To stp\n                    val(v, 1) = vals(a, b - ((b &gt; 1) * 3) + (v - 1))\n                Next v\n                .Cells(2, \"D\").Offset((a - 1) * stp, Int(b / stp)).Resize(stp, 1) = val\n            Next b\n        Next a\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've intentionally avoided the use of the native <a href=\"https://support.office.com/en-us/article/TRANSPOSE-function-ED039415-ED8A-4A81-93E9-4B6DFAC76027\" rel=\"nofollow noreferrer\">TRANSPOSE function</a> as it has limitations for size that are more suited to an .xls than an .xlsx. The maths that supply the looped reorientation have been derived from your sample code's first row.</p>\n"}], "owner": {"reputation": 1, "user_id": 6071081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/064fe9c4116a127d17ca8b942b3d6b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Staysman", "link": "https://stackoverflow.com/users/6071081/staysman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1458153431, "creation_date": 1458125153, "last_edit_date": 1458136995, "question_id": 36033386, "link": "https://stackoverflow.com/questions/36033386/vba-transpose-multiple-times", "title": "VBA transpose multiple times", "body": "<p>I am currently working on a big set of data downloaded from Morningstar Direct. I need help with a macro that can change the exported document from horizontal to vertical. I have tried all the functions in excel without any luck, so i think i need a macro for this operation.</p>\n\n<p>For example:</p>\n\n<p>From:</p>\n\n<pre><code>Data1-2000    Data1-2001   Data1-2002 ... Data1-2016   Data2-2000   Data2-2001 and so on \n</code></pre>\n\n<p>To: </p>\n\n<pre><code>Data1-2000  \nData1-2001  \n   ...  \nData1-2016  \nData2-2000  \nData2-2001  \n     ...\n</code></pre>\n\n<p>Every datavariable goes from 2000 to 2016. We have more then 500 tickers that need the same transformation. Is there any VBA code that can do this for me? It will save my life (at least my Easter)!</p>\n\n<p>**Addedum from OP's answer post:</p>\n\n<p>I have made this macro:</p>\n\n<pre><code>Sub Flip()\n'\n' Flip Macro\n'\n    Sheets(\"S&amp;P 500 Constituents\").Select\n    Range(\"I2:X2\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"D2\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Sheets(\"S&amp;P 500 Constituents\").Select\n    Range(\"AB2:AQ2\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"E2\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Sheets(\"S&amp;P 500 Constituents\").Select\n    Range(\"AR2:BG2\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"F2\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Sheets(\"S&amp;P 500 Constituents\").Select\n    Range(\"BH2:BW2\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"G2\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Sheets(\"S&amp;P 500 Constituents\").Select\n    Range(\"BX2:CM2\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"H2\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\nEnd Sub\n</code></pre>\n\n<p>As you can see everything is taken from row 2 in my S&amp;P500 sheet, and then transposed into sheet1. </p>\n\n<p>How can i make this macro repeat the same operation on row 3, 4, 5 ... 518?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 771, "user_id": 3182178, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcb5836e4eca83bba5629299ee1ede12?s=128&d=identicon&r=PG", "display_name": "ebelair", "link": "https://stackoverflow.com/users/3182178/ebelair"}, "edited": false, "score": 0, "creation_date": 1458133206, "post_id": 36033652, "comment_id": 59721749, "body": "Just perfect! My bad i confused strikeout with Strikethrough!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1458125894, "creation_date": 1458125894, "answer_id": 36033652, "question_id": 36032996, "link": "https://stackoverflow.com/questions/36032996/vba-excel-conditional-formatting-on-listobject/36033652#36033652", "title": "vba excel conditional formatting on listObject", "body": "<p>The following uses the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.listobject.databodyrange.aspx\" rel=\"nofollow\">.DataBodyRange property</a> to retrieve the address in the top-left corner to be used in a formuLa.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    With .ListObjects(\"Table1\")\n        With .DataBodyRange\n            .FormatConditions.Delete\n            .FormatConditions.Add Type:=xlExpression, _\n                Formula1:=\"=\" &amp; .Cells(1, 1).Address(0, 1) &amp; \"=1\"\n            .FormatConditions(1).Font.Strikethrough = True\n        End With\n    End With\nEnd With\n</code></pre>\n\n<p>Note that the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195304.aspx\" rel=\"nofollow\">FormatConditions</a> object has a 1-based ineex and the use of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841197.aspx\" rel=\"nofollow\">Font.Strikethrough</a> property, not Font.StrikeOut.</p>\n"}], "owner": {"reputation": 771, "user_id": 3182178, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcb5836e4eca83bba5629299ee1ede12?s=128&d=identicon&r=PG", "display_name": "ebelair", "link": "https://stackoverflow.com/users/3182178/ebelair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1626, "favorite_count": 0, "accepted_answer_id": 36033652, "answer_count": 1, "score": 1, "last_activity_date": 1483016040, "creation_date": 1458124145, "last_edit_date": 1531164843, "question_id": 36032996, "link": "https://stackoverflow.com/questions/36032996/vba-excel-conditional-formatting-on-listobject", "title": "vba excel conditional formatting on listObject", "body": "<p>I need to strikeout a row cells depending of a relative column value in a listobject.\nHow i can add a conditional formatting on all row cells based on relative column value in vba?\nEx: If the cell value = 1, then the entire row need to be strikeout</p>\n\n<p>I tried this:</p>\n\n<pre><code>Dim qt As ListObject\nqt = Sheets.ListObjects(1)\nWith qt.DataBodyRange\n.FormatConditions.Delete\n.FormatConditions.Add Type:=xlExpression, Formula1:=\"=[MyColumn]=0\"\n.FormatConditions(0).Font.StrikeOut = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1458125570, "creation_date": 1458125570, "answer_id": 36033529, "question_id": 36032955, "link": "https://stackoverflow.com/questions/36032955/link-outlook-to-access/36033529#36033529", "title": "Link Outlook to Access", "body": "<p>I would use an add-in(vba) to test it, then move to something more substantial should you desire, playing around, you could use something like this</p>\n\n<pre><code>Sub EMAIL_TEST()\n\nDim olMail As MailItem\n\nSet olMail = ActiveInspector.CurrentItem\n\n' Pass properties from mail to access here\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1458139055, "last_edit_date": 1458139055, "creation_date": 1458138057, "answer_id": 36038399, "question_id": 36032955, "link": "https://stackoverflow.com/questions/36032955/link-outlook-to-access/36038399#36038399", "title": "Link Outlook to Access", "body": "<p>Here you have some of my own code scanning a functionnal mailbox and inserting email data in an MS Access database.</p>\n\n<ul>\n<li>Put this in a stand-alone module in Outlook</li>\n<li>Add a the reference \"<em>Microsoft Office x.0 Access database engine Object Library</em>\"</li>\n<li>Adapt the 3 constants on top of it</li>\n<li>Create a table in your MS Access DB with fields <code>Subject</code> (string) and <code>TS</code> (date)</li>\n<li>Optionnaly adapt the code in sub <code>My_Stuff()</code></li>\n<li>Run the code in sub <code>SCAN_MAILBOX()</code></li>\n</ul>\n\n<p>After some inevitable tweaking following your environment, it will populate your table with all the subject/receivedtime of all mails in your inbox</p>\n\n<pre><code>Option Explicit\n\n\nConst DB_PATH = \"C:\\thepath\\YourDatabase.accdb\"\nConst DB_TABLE = \"Your_Table\"\n\nConst MAILBOX_TO_SCAN = \"Your mailbox Name\"\n\nPublic Sub SCAN_MAILBOX()\n\n    ' To perform My_Stuff on the Inbox, do :\n    My_Stuff \"Inbox\"\n\n    ' To perform My_Stuff on any folder/subfolder of the mailbox, do :\n    ' My_Stuff \"Inbox/folder/subfolder\"\n\nEnd Sub\n\n\n\nPrivate Sub My_Stuff(strMailboxSubfolder As String)\n\n    Dim objOutlook As Outlook.Application\n    Dim objNamespace As Outlook.NameSpace\n    Dim Mailbox As Outlook.MAPIFolder\n    Dim folderInbox As Outlook.MAPIFolder\n    Dim folderToProcess As Outlook.MAPIFolder\n    Dim folderItems As Outlook.Items\n    Dim oEmail As Outlook.MailItem\n\n    Dim WS As DAO.Workspace\n    Dim DB As DAO.Database\n\n    Dim e As Long\n    Dim tot As Long\n\n\n    On Error GoTo Err_Handler\n\n\n    Set WS = DBEngine.Workspaces(0)\n    Set DB = WS.OpenDatabase(DB_PATH)\n\n    Set objNamespace = Application.GetNamespace(\"MAPI\")\n    Set Mailbox = objNamespace.Folders(MAILBOX_TO_SCAN)\n\n    Set folderToProcess = GetFolder(strMailboxSubfolder, Mailbox)\n    Set folderItems = folderToProcess.Items\n\n    tot = folderToProcess.Items.Count\n\n    folderToProcess.Items.Sort \"ReceivedTime\", True\n\n\n    For e = tot To 1 Step -1\n\n        Set oEmail = folderItems(e)\n\n        ' Some of the oEmail usefull properties :\n        Debug.Print oEmail.Subject\n        Debug.Print oEmail.ReceivedTime\n\n        ' INSERT email Subject and Received timestamp in an Access database\n        DB.Execute \"INSERT INTO \" &amp; DB_TABLE &amp; \" ([SUbject],[TS]) VALUES ('\" &amp; Trim(oEmail.Subject) &amp; \"',#\" &amp; Format(oEmail.ReceivedTime, \"MM/DD/YYYY hh:nn:ss\") &amp; \"#)\"\n\n        Set oEmail = Nothing\n\n        DoEvents\n    Next\n\n\n\nExit_Sub:\n\n    Set folderItems = Nothing\n    Set folderToProcess = Nothing\n    Set Mailbox = Nothing\n    Set objNamespace = Nothing\n    Set DB = Nothing\n    Set WS = Nothing\n\n    Exit Sub\n\nErr_Handler:\n    MsgBox Err.Description, vbExclamation\n    Resume Exit_Sub\n    Resume\n\nEnd Sub\n\n\n\n\nPrivate Function GetFolder(strFolderPath As String, ByRef Mailbox As Outlook.MAPIFolder) As MAPIFolder\n\n  Dim colFolders As Outlook.Folders\n  Dim objFolder As Outlook.MAPIFolder\n  Dim arrFolders() As String\n  Dim I As Long\n  On Error Resume Next\n\n  strFolderPath = Replace(strFolderPath, \"/\", \"\\\")\n  arrFolders() = Split(strFolderPath, \"\\\")\n\n  Set objFolder = Mailbox.Folders.Item(arrFolders(0))\n  If Not objFolder Is Nothing Then\n    For I = 1 To UBound(arrFolders)\n      Set colFolders = objFolder.Folders\n      Set objFolder = Nothing\n      Set objFolder = colFolders.Item(arrFolders(I))\n      If objFolder Is Nothing Then\n        Exit For\n      End If\n    Next\n  End If\n\n  Set GetFolder = objFolder\n  Set colFolders = Nothing\n\nEnd Function\n</code></pre>\n\n<p>I won't cover in this chapter how to add a button to run the code, that's a bit too much. \nI have shown you enough to experiment and achieve what you want quickly.</p>\n"}], "owner": {"reputation": 639, "user_id": 4598964, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10153689452664899/picture?type=large", "display_name": "Dave B", "link": "https://stackoverflow.com/users/4598964/dave-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1482, "favorite_count": 0, "accepted_answer_id": 36038399, "answer_count": 2, "score": 0, "last_activity_date": 1593003484, "creation_date": 1458124039, "last_edit_date": 1593003484, "question_id": 36032955, "link": "https://stackoverflow.com/questions/36032955/link-outlook-to-access", "title": "Link Outlook to Access", "body": "<p>I need a bit of advice please. </p>\n\n<p>I would like to add a button to Outlook that will copy/import information in an individual email to an MS Access DB. We currently have a pretty well developed Access application that has been developed in VBA. </p>\n\n<p>However, I am at a loss as to the best approach to take when trying to create the button (VSTO, COM, Addon - not familiar with any of these technologies).</p>\n\n<p>Could anybody offer any advice as to the best approach for this?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1458124150, "post_id": 36032841, "comment_id": 59715299, "body": "See <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a> and <a href=\"http://meta.stackoverflow.com/questions/303812/discourage-screenshots-of-code-and-or-errors\">Discourage screenshots of code and/or errors</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5837529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff96c8b47d42f125e24a77f2ebcf757?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5837529/john"}, "edited": false, "score": 0, "creation_date": 1458131441, "post_id": 36035280, "comment_id": 59720361, "body": "Thanks for your answer, I understand a bit more now about how to use weighting for this. I have updated my question to be more clear on the difficulty I am having which is to do with pulling the unique values from the table and displaying them as a column."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1458130139, "creation_date": 1458130139, "answer_id": 36035280, "question_id": 36032841, "link": "https://stackoverflow.com/questions/36032841/extract-unique-strings-from-array-in-excel-2013/36035280#36035280", "title": "Extract unique strings from array in Excel (2013)", "body": "<p>The problem you are having with your layout is that the text labels in B1:D1 cannot be easily parsed to retrieve a value. To rectify this format B1:C1 with a custom number format of <code>W\\ei\\g\\ht=0</code> then type 1, 2 and 3 into them as values.</p>\n\n<p>With the column header labels as true numbers (and only displayed as text), the formulas in G8:G8 become,</p>\n\n<pre><code>=COUNTIF($B$2:$D$5, $E8)\n=SUMPRODUCT(($B$2:$D$5=$E8)*$B$1:$D$1)\n'alternate with text labels remaining but a 1, 2, 3 result based on position\n=SUMPRODUCT(($B$2:$D$5=$E8)*COLUMN($A:$C))\n</code></pre>\n\n<p>Fill down as necessary.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/p9qnr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p9qnr.png\" alt=\"sump_count_matrix\"></a></p>\n\n<p>There are text parsing functions available that could pull the <em>1, 2</em> or <em>3</em> from <em>Weight-1, Weight-2, Weight-3, etc</em> but the calculation load is simply not worthwhile when there other readily available (and easier!) methods available .</p>\n"}], "owner": {"reputation": 43, "user_id": 5837529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff96c8b47d42f125e24a77f2ebcf757?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5837529/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458131401, "creation_date": 1458123768, "last_edit_date": 1531161705, "question_id": 36032841, "link": "https://stackoverflow.com/questions/36032841/extract-unique-strings-from-array-in-excel-2013", "title": "Extract unique strings from array in Excel (2013)", "body": "<p>I have a table of values in the format:</p>\n\n<pre><code>Source |Option 1|Option 2|Option 3\n-------|--------|--------|--------\nFrance |  AA    |   BB   |  CC\nWales  |  BB    |   CC   |\nBritain|  CC    |   AA   |\nGreece |  BB    |        |\n</code></pre>\n\n<p>I need them in the format:</p>\n\n<pre><code>Outcome | Count |\n--------|-------|\n AA     |  2    | \n BB     |  3    |     \n CC     |  3    |      \n DD     |  0    |       \n</code></pre>\n\n<p><strong>Where the outcome column and count columns are generated from a formula</strong></p>\n\n<p>I currently cannot work out how to use pivot tables (my first idea) to do a output of the unique outcomes as it doesn't seem to work for an array in the way I intend.</p>\n"}, {"tags": ["r", "excel", "vba"], "comments": [{"owner": {"reputation": 1799, "user_id": 3293236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16c61212bc100894498133756caad8f?s=128&d=identicon&r=PG&f=1", "display_name": "Buggy", "link": "https://stackoverflow.com/users/3293236/buggy"}, "edited": false, "score": 0, "creation_date": 1458122650, "post_id": 36031997, "comment_id": 59714182, "body": "Which of the tabs do you need? There&#39;s different data on each tab.. Here&#39;s how I would start: use the readxl package. Read the Tabnames and filter the tabs you don&#39;t need. E.g. get rid of the charts. Then basically do sg. similar to this here: list_sheets &lt;- excel_sheets(filepath)   list_tables &lt;- lapply(list_sheets, read_excel, path = filepath, col_names = col_names)   list_tables &lt;- rbindlist(list_tables)"}, {"owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "reply_to_user": {"reputation": 1799, "user_id": 3293236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16c61212bc100894498133756caad8f?s=128&d=identicon&r=PG&f=1", "display_name": "Buggy", "link": "https://stackoverflow.com/users/3293236/buggy"}, "edited": false, "score": 0, "creation_date": 1458122763, "post_id": 36031997, "comment_id": 59714260, "body": "like I wrote...say &quot;Prices wo taxes, per CTR&quot;"}, {"owner": {"reputation": 1799, "user_id": 3293236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e16c61212bc100894498133756caad8f?s=128&d=identicon&r=PG&f=1", "display_name": "Buggy", "link": "https://stackoverflow.com/users/3293236/buggy"}, "edited": false, "score": 0, "creation_date": 1458123923, "post_id": 36031997, "comment_id": 59715129, "body": "Sorry just realized that there&#39;s data beneath the first set. Should have read it more thouroughly."}], "answers": [{"comments": [{"owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458134696, "post_id": 36033091, "comment_id": 59722983, "body": "Thanks for the answer and the effort. It does not work on my machine yet...I get some errors. Could you paste also your <code>sessionInfo()</code>? And also, the table lacks country codes."}, {"owner": {"reputation": 3499, "user_id": 1987629, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh6.googleusercontent.com/-vvDcPxiTqEY/AAAAAAAAAAI/AAAAAAAADE0/Gq3LhZzPdak/photo.jpg?sz=128", "display_name": "TheRimalaya", "link": "https://stackoverflow.com/users/1987629/therimalaya"}, "reply_to_user": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458134835, "post_id": 36033091, "comment_id": 59723123, "body": "I have added the sessionInfo in the answer, but what is the error you are getting??"}, {"owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458135574, "post_id": 36033091, "comment_id": 59723806, "body": "I am on Windows OS machine and using your solution gives the following error: <code>Error: IOException (Java): Your file contains 20919 sectors, but the initial DIFAT array at index 20 referenced block # 658688. This isn&#39;t allowed and  your file is corrupt</code> I do not know, it seems to be some Java related issue."}, {"owner": {"reputation": 3499, "user_id": 1987629, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh6.googleusercontent.com/-vvDcPxiTqEY/AAAAAAAAAAI/AAAAAAAADE0/Gq3LhZzPdak/photo.jpg?sz=128", "display_name": "TheRimalaya", "link": "https://stackoverflow.com/users/1987629/therimalaya"}, "reply_to_user": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458135949, "post_id": 36033091, "comment_id": 59724131, "body": "I am not sure what is the error,  it may be the problem with <code>XLConnect</code>, you can use <code>gdata</code> or other package to get the excel file into R."}, {"owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458137501, "post_id": 36033091, "comment_id": 59725492, "body": "Apart from the error I get, there is stil one more thing. Your solution lacks the country codes, since the data is published by country. I will upvote your answer anyway, but for now it is a partial solution."}, {"owner": {"reputation": 3499, "user_id": 1987629, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh6.googleusercontent.com/-vvDcPxiTqEY/AAAAAAAAAAI/AAAAAAAADE0/Gq3LhZzPdak/photo.jpg?sz=128", "display_name": "TheRimalaya", "link": "https://stackoverflow.com/users/1987629/therimalaya"}, "reply_to_user": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458137810, "post_id": 36033091, "comment_id": 59725732, "body": "Sorry for that, you did not talked anything about country code. Anyway I will try if I get some time today."}], "tags": [], "owner": {"reputation": 3499, "user_id": 1987629, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh6.googleusercontent.com/-vvDcPxiTqEY/AAAAAAAAAAI/AAAAAAAADE0/Gq3LhZzPdak/photo.jpg?sz=128", "display_name": "TheRimalaya", "link": "https://stackoverflow.com/users/1987629/therimalaya"}, "is_accepted": false, "score": 1, "last_activity_date": 1458134816, "last_edit_date": 1458134816, "creation_date": 1458124376, "answer_id": 36033091, "question_id": 36031997, "link": "https://stackoverflow.com/questions/36031997/oil-bulletin-weekly-fuel-data-import-to-r/36033091#36033091", "title": "Oil Bulletin weekly fuel data: import to R", "body": "<pre><code>url = \"http://ec.europa.eu/energy/observatory/reports/Oil_Bulletin_Prices_History.xls\"\ndownload.file(url=url, \"data/PriceHistory.xls\")\n\nrequire(XLConnect)\nwb &lt;- XLConnect::loadWorkbook(\"data/PriceHistory.xls\")\ndt &lt;- readWorksheet(wb, sheet = 1, startRow = 1, endRow = 14992)\ndt.body &lt;- dt[7:14992, 2:7]\ndt.head &lt;- c(\"Date\", \"ExcRate\", \"EuroSuper\", \"GasOilAuto\", \"GasOilHeat\", \"FuelOil\")\ncolnames(dt.body) &lt;- dt.head\n\ndt.body &lt;- dt.body[nchar(dt.body$Date) == nchar(dt.body$Date[1]), ]\ndt.body[[\"Date\"]] &lt;- as.Date(dt.body[[\"Date\"]], format = \"%Y-%m-%d %H:%M:%S\")\n\nfor(i in 2:ncol(dt.body)) {\n    dt.body[, i] &lt;- as.numeric(dt.body[, i])\n}\n</code></pre>\n\n<p>Remove the rows with <code>NA</code> if you like but think about <code>ExcRate</code> column</p>\n\n<pre><code># dt.body &lt;- na.omit(dt.body)\nrownames(dt.body) &lt;- NULL\ndt.body &lt;- dplyr::tbl_dt(dt.body)\n\ndt.body\n</code></pre>\n\n<p>The result is (After <code>na.omit</code>),</p>\n\n<pre><code>Source: local data table [11,054 x 6]\n\n         Date ExcRate EuroSuper GasOilAuto GasOilHeat FuelOil\n       (date)   (dbl)     (dbl)      (dbl)      (dbl)   (dbl)\n1  2016-03-07       1    371.64     387.86     358.08     176\n2  2016-02-29       1    370.81     382.03     344.54     171\n3  2016-02-22       1    375.81     384.53     339.44     171\n4  2016-02-15       1    369.97     372.03     331.05     171\n5  2016-02-08       1    382.47     380.36     337.09     178\n6  2016-02-01       1    387.47     376.19     337.01     172\n7  2016-01-25       1    384.97     370.36     321.67     146\n8  2016-01-18       1    392.47     385.36     329.30     165\n9  2016-01-11       1    413.31     407.86     346.26     175\n10 2016-01-04       1    418.31     412.86     363.64     176\n..        ...     ...       ...        ...        ...     ...\n</code></pre>\n\n<h3>Session Info:</h3>\n\n<pre><code>R version 3.2.4 (2016-03-10)\nPlatform: x86_64-apple-darwin13.4.0 (64-bit)\nRunning under: OS X 10.11.3 (El Capitan)\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] MASS_7.3-45      ggplot2_2.0.0    dplyr_0.4.3      data.table_1.9.7\n\nloaded via a namespace (and not attached):\n [1] Rcpp_0.12.3      digest_0.6.9     assertthat_0.1   chron_2.3-47    \n [5] grid_3.2.4       R6_2.1.2         plyr_1.8.3       gtable_0.1.2    \n [9] DBI_0.3.1        magrittr_1.5     scales_0.3.0     pls_2.5-0       \n[13] labeling_0.3     tools_3.2.4      munsell_0.4.3    parallel_3.2.4  \n[17] colorspace_1.2-6\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "edited": false, "score": 0, "creation_date": 1458138577, "post_id": 36037904, "comment_id": 59726317, "body": "Thanks for your effort, however on my Windows machine the code provided by TheRimalaya does not work (yet)."}], "tags": [], "owner": {"reputation": 8410, "user_id": 202553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Clpiv.jpg?s=128&g=1", "display_name": "knb", "link": "https://stackoverflow.com/users/202553/knb"}, "is_accepted": false, "score": 0, "last_activity_date": 1458137724, "last_edit_date": 1458137724, "creation_date": 1458136900, "answer_id": 36037904, "question_id": 36031997, "link": "https://stackoverflow.com/questions/36031997/oil-bulletin-weekly-fuel-data-import-to-r/36037904#36037904", "title": "Oil Bulletin weekly fuel data: import to R", "body": "<p>You can use TheRimalaya's code (change the download destination if necessary)</p>\n\n<p>and then add this to make the imported data tidy:</p>\n\n<pre><code>library(dplyr)\nlibrary(tidyr)\ndt.body.tidy &lt;- dt.body %&gt;%\n        gather(fueltype, price, 3:ncol(dt.body), -ExcRate)\n\ndt.body.tidy &lt;- dt.body.tidy %&gt;%\n        filter(ExcRate == 1)\n\nlibrary(ggplot2)\ndt.body.tidy %&gt;%\n        ggplot(aes(Date, price)) +\n        geom_line(color=\"darkgrey\") +\n        geom_line(stat=\"summary\", fun.y=\"median\", color=\"red\", size=0.3)+\n        facet_wrap(~fueltype, ncol=1)\n</code></pre>\n\n<p>Addmittedly, this imports only the first worksheet, and has the values for startrow and endrow hardcoded, but you can adapt the code to your needs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lnUlp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lnUlp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "is_accepted": false, "score": 0, "last_activity_date": 1458226691, "last_edit_date": 1495535278, "creation_date": 1458226691, "answer_id": 36064242, "question_id": 36031997, "link": "https://stackoverflow.com/questions/36031997/oil-bulletin-weekly-fuel-data-import-to-r/36064242#36064242", "title": "Oil Bulletin weekly fuel data: import to R", "body": "<p>Answers posted before my own are partial solutions. I decided to post mine that was somewhat influenced by them. </p>\n\n<h3>Download file</h3>\n\n<pre><code>url = \"http://ec.europa.eu/energy/observatory/reports/Oil_Bulletin_Prices_History.xls\"\ndownload.file(url = url, \"PriceHistory.xls\")\n</code></pre>\n\n<h3>Assumptions</h3>\n\n<p>Following the \n<a href=\"https://stackoverflow.com/questions/8188415/save-excel-spreadsheet-as-csv-with-r\">Save Excel spreadsheet as .csv with R?</a> one can open Excel file and save the tabs as separate .csv files delimited by say <code>\\t</code>. Assuming one saves three of them in working directory (<strong>\"Prices wo taxes, per CTR\"</strong>, <strong>\"Prices with taxes, per CTR\"</strong>, <strong>\"All taxes, per CTR\"</strong>) and names them like <code>mpc_ex_taxes.txt</code>, <code>mpc.txt</code>, <code>taxes.txt</code>, the code below should work.</p>\n\n<h3>Libraries used</h3>\n\n<pre><code>library(plyr)\nlibrary(dplyr)\nlibrary(readr)\nlibrary(stringr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(tidyr)\n</code></pre>\n\n<h3>Getting data from .csv files</h3>\n\n<pre><code># name of .txt files\nmy_file_name &lt;- \n  c(\"mpc_ex_taxes\", \"mpc\", \"taxes\")\n  # c(\"mpc\")\n\nmy_files &lt;- \n  str_c(my_file_name, \".txt\")\n\n# getting data at once\nmy_file_list &lt;- list()\n\nfor(file in seq_along(my_files)){\n\n# read data: line by line (assuming you are in working directory)\n  # my_oil &lt;- read_lines(my_files[1])\n  my_oil &lt;- read_lines(my_files[file])\n\n# split by delimiter\nmy_oil_split &lt;- str_split(my_oil, \"\\t\")\n\n# compute length of vector in each line\nmy_len &lt;- sapply(my_oil_split, length)\n\n# filter lines with vector length equal to 9\nmy_data &lt;-\n  my_oil_split[which(my_len == 9)] %&gt;% \n  ldply(.) %&gt;% \n  tbl_df\n\n# offset rows by this integer (used below in selecting data values)\nmy_number_to_add &lt;- 4\n\n# get country codes; str_length(V1) == 2\n# get index_of_data; my_number_to_add lower than country code\nmy_geos &lt;-\n  my_data %&gt;% \n  select(V1) %&gt;%\n  add_rownames(., var = \"index_geo\") %&gt;% \n  filter(str_length(V1) == 2) %&gt;% \n  mutate(index_geo = as.numeric(index_geo),\n         index_of_data = index_geo + my_number_to_add) %&gt;% \n  rename(geo = V1)\n\n# calculate index where data for each country starts and where data ends\nmy_data_values &lt;- \n  my_data %&gt;% \n  add_rownames(., var = \"index_of_data\") %&gt;% \n  filter(str_length(V2) == 8) %&gt;% \n  mutate(index_of_data = as.integer(index_of_data),\n         diff_index_of_data = index_of_data - lag(index_of_data, 1),\n         index_of_data_end = index_of_data - diff_index_of_data) %&gt;% \n  filter(is.na(diff_index_of_data) | diff_index_of_data &gt; 1) %&gt;% \n  mutate(index_of_data_end = lead(index_of_data_end, 1)) %&gt;% \n  select(matches(\"^index\"))\n\n# join country codes and start and end of data values\nmy_case &lt;- \n  left_join(my_geos, my_data_values) %&gt;% \n  filter(complete.cases(.))\n\n# get data for each country except the last one (UK)\nmy_data_list &lt;- list()\n\nfor(i in seq_along(my_case$geo)){\n  my_data_list[[i]] &lt;- \n    my_data[my_case$index_of_data[i]:my_case$index_of_data_end[i], ]\n}\n\nnames(my_data_list) &lt;- my_case$geo\n\n# tidy dataset\nmy_df &lt;-\n  ldply(my_data_list) %&gt;% \n  tbl_df %&gt;% \n  rename(geo = .id) %&gt;%\n  select(geo, V2:V7) %&gt;% \n  mutate(my_date = as.Date(dmy(V2))) %&gt;% \n  select(-V2) %&gt;% \n  mutate_each(funs(str_replace_all(., \",\", \"\"))) %&gt;% \n  mutate_each(funs(as.numeric), matches(\"V\")) %&gt;% \n  select(geo, my_date, everything())\n\n# renaming the variables\nmy_names &lt;-  c(\"my_geo\", \"my_date\", \"ExcRate\", \"Gasoline\", \n               \"Diesel\", \"GasOilHeat\", \"FuelOil\")\n\nnames(my_df) &lt;- my_names\n\nmy_df_to_save &lt;-\n  my_df %&gt;% \n  mutate(my_fuel_price_component = rep(my_file_name[file]))\n\nmy_file_list[[file]] &lt;- my_df_to_save\n\n}\n\n# final data frame\nmy_final_fuel_df &lt;-\n  my_file_list %&gt;% \n  ldply(.) %&gt;%\n  tbl_df\n</code></pre>\n\n<h3>Tidy Oil Bulletin data</h3>\n\n<p>Remark: one can coerce time variable <code>my_date</code> that is of class character to class date by <code>as.Date()</code> function.</p>\n\n<pre><code>Source: local data frame [42,495 x 8]\n\n   my_geo    my_date ExcRate Gasoline Diesel GasOilHeat FuelOil my_fuel_price_component\n    (chr)      (chr)   (dbl)    (dbl)  (dbl)      (dbl)   (dbl)                   (chr)\n1      AT 2016-03-14       1   387.47 409.53     373.71     191            mpc_ex_taxes\n2      AT 2016-03-07       1   371.64 387.86     358.08     176            mpc_ex_taxes\n3      AT 2016-02-29       1   370.81 382.03     344.54     171            mpc_ex_taxes\n4      AT 2016-02-22       1   375.81 384.53     339.44     171            mpc_ex_taxes\n5      AT 2016-02-15       1   369.97 372.03     331.05     171            mpc_ex_taxes\n6      AT 2016-02-08       1   382.47 380.36     337.09     178            mpc_ex_taxes\n7      AT 2016-02-01       1   387.47 376.19     337.01     172            mpc_ex_taxes\n8      AT 2016-01-25       1   384.97 370.36     321.67     146            mpc_ex_taxes\n9      AT 2016-01-18       1   392.47 385.36     329.30     165            mpc_ex_taxes\n10     AT 2016-01-11       1   413.31 407.86     346.26     175            mpc_ex_taxes\n..    ...        ...     ...      ...    ...        ...     ...                     ...\n</code></pre>\n\n<h3>Session info</h3>\n\n<pre><code>R version 3.2.4 (2016-03-10)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 7 x64 (build 7601) Service Pack 1\n\nlocale:\n[1] LC_COLLATE=Slovenian_Slovenia.1250  LC_CTYPE=Slovenian_Slovenia.1250    LC_MONETARY=Slovenian_Slovenia.1250\n[4] LC_NUMERIC=C                        LC_TIME=Slovenian_Slovenia.1250    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] tidyr_0.3.0         ggplot2_1.0.1       lubridate_1.5.0     stringr_1.0.0       readr_0.2.2        \n[6] dplyr_0.4.3         plyr_1.8.3          XLConnect_0.2-11    XLConnectJars_0.2-9\n\nloaded via a namespace (and not attached):\n [1] Rcpp_0.12.0      digest_0.6.8     assertthat_0.1   MASS_7.3-44      grid_3.2.4       R6_2.1.1        \n [7] gtable_0.1.2     DBI_0.3.1        magrittr_1.5     scales_0.3.0     stringi_0.5-5    lazyeval_0.1.10 \n[13] reshape2_1.4.1   labeling_0.3     proto_0.3-10     tools_3.2.4      munsell_0.4.2    parallel_3.2.4  \n[19] colorspace_1.2-6 rJava_0.9-7 \n</code></pre>\n"}], "owner": {"reputation": 1982, "user_id": 1573580, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PNVeN.jpg?s=128&g=1", "display_name": "Miha Tro\u0161t", "link": "https://stackoverflow.com/users/1573580/miha-tro%c5%a1t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1458226691, "creation_date": 1458121671, "last_edit_date": 1531161705, "question_id": 36031997, "link": "https://stackoverflow.com/questions/36031997/oil-bulletin-weekly-fuel-data-import-to-r", "title": "Oil Bulletin weekly fuel data: import to R", "body": "<h3>Background</h3>\n\n<p>European Commission gathers and publishes weekly average prices of motor fuels in Europe. However, they publish it in a way that is painfull to work with. By pressing this <a href=\"http://ec.europa.eu/energy/observatory/reports/Oil_Bulletin_Prices_History.xls\" rel=\"nofollow\">link</a> one can download the data in .xls format and have a look at it.  </p>\n\n<p>I emailed the Commission asking if they could publish the data in a <a href=\"https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html\" rel=\"nofollow\">tidy</a> like structure, but they answered that thay have no intention to do it.</p>\n\n<h3>Question</h3>\n\n<p>Has anybody managed to programmaticaly either import this kind of data into R or tidy it in VBA prior to importing it to R, for say, first tab: \"Prices wo taxes, per CTR\"? </p>\n\n<h3>What I tried</h3>\n\n<p>I usually manually stack country tables one under the other in Excel and do some other transformations and save tidier data as say .csv and than import it into R.  </p>\n\n<p>Thank you in advance.</p>\n\n<h3>Edit</h3>\n\n<p>Please note that data is provided per country.</p>\n"}, {"tags": ["vba", "excel", "inputbox"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458121315, "post_id": 36031701, "comment_id": 59713187, "body": "Are you trying to put a formula in the cell or a static value?"}, {"owner": {"reputation": 55, "user_id": 4291041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db75cb3ea6d6d85bd1c9dc12a7d799f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/4291041/chris-s"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1458121358, "post_id": 36031701, "comment_id": 59713218, "body": "Formula to be included in the cell. Ty"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4291041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db75cb3ea6d6d85bd1c9dc12a7d799f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/4291041/chris-s"}, "edited": false, "score": 0, "creation_date": 1458122291, "post_id": 36031880, "comment_id": 59713919, "body": "Thank you perfect. Such a simple solution :/"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1458121438, "creation_date": 1458121438, "answer_id": 36031880, "question_id": 36031701, "link": "https://stackoverflow.com/questions/36031701/vba-sum-range-including-variant/36031880#36031880", "title": "VBA Sum Range including Variant", "body": "<p>To enter a formula you would use:</p>\n\n<pre><code>Range(\"B7\").Formula = \"=Sum(F39:F41)+\" &amp; CInt(myValue)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458121594, "post_id": 36031888, "comment_id": 59713408, "body": "This will add only a value, not a formula. Also no need for the equality sign in <code>Evaluate</code>."}, {"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458121868, "post_id": 36031888, "comment_id": 59713606, "body": "@Vegard, since the OP&#39;s question is not clear about whether he/she needs the result or formula so the suggestions will vary because of unclear description.  Downvoting someones thread without clear understanding about the answer will be considered as an unclear downvoter."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458121954, "post_id": 36031888, "comment_id": 59713676, "body": "The question was clarified in the comments below the question."}, {"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458122024, "post_id": 36031888, "comment_id": 59713726, "body": "@Vegard, See the time of posting."}, {"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458122381, "post_id": 36031888, "comment_id": 59713975, "body": "Quote: &quot;(nor am I trying to take anything from you)&quot; Downvoting someones post will reduce the reputation points.  If you find someones answer is correct upvote that post.  Don&#39;t be contradictory person without knowing how SO works. I personally upvoted Rory&#39;s post to +1 since it solves OP&#39;s expectation. Downvoting should be considered if the post is completely useless."}, {"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458122885, "post_id": 36031888, "comment_id": 59714359, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/106446/discussion-between-sixthsense-and-vegard\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": -2, "last_activity_date": 1458121452, "creation_date": 1458121452, "answer_id": 36031888, "question_id": 36031701, "link": "https://stackoverflow.com/questions/36031701/vba-sum-range-including-variant/36031888#36031888", "title": "VBA Sum Range including Variant", "body": "<pre><code>Range(\"B7\").Value = evaluate(\"=Sum(F39:F41)\") + CInt(myValue)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1056, "user_id": 4264336, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/021c629e7b4df802600f337267e5da38?s=128&d=identicon&r=PG&f=1", "display_name": "Lobsterpants", "link": "https://stackoverflow.com/users/4264336/lobsterpants"}, "is_accepted": false, "score": 0, "last_activity_date": 1458121515, "creation_date": 1458121515, "answer_id": 36031917, "question_id": 36031701, "link": "https://stackoverflow.com/questions/36031701/vba-sum-range-including-variant/36031917#36031917", "title": "VBA Sum Range including Variant", "body": "<p>I make it that you want:</p>\n\n<pre><code>Dim myValue As Variant\n\nmyValue = InputBox(\"Enter Value\", \"Enter Value in \u00a3's\", \"\u00a3\")\nRange(\"B7\").Formula = \"=Sum(F39:F41)  +\" &amp; CInt(myValue)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1458123083, "creation_date": 1458123083, "answer_id": 36032544, "question_id": 36031701, "link": "https://stackoverflow.com/questions/36031701/vba-sum-range-including-variant/36032544#36032544", "title": "VBA Sum Range including Variant", "body": "<p>The value returned by InputBox is a string, so there's no need to convert to an Integer to add it to a formula. Moreover, you might want to check that the user didn't canceled the input:</p>\n\n<pre><code>Dim userInput As String\nuserInput = InputBox(\"Enter Value\", \"Enter Value in \u00a3's\", \"\u00a3\")\nIf Len(userInput) Then\n  Range(\"B7\").Formula = \"=Sum(F39:F41)+\" &amp; userInput\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4291041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4db75cb3ea6d6d85bd1c9dc12a7d799f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris S", "link": "https://stackoverflow.com/users/4291041/chris-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 36031880, "answer_count": 4, "score": 0, "last_activity_date": 1458123083, "creation_date": 1458121054, "question_id": 36031701, "link": "https://stackoverflow.com/questions/36031701/vba-sum-range-including-variant", "title": "VBA Sum Range including Variant", "body": "<p>So I've defined myValue as an input value but now I want to sum the input value with the sum of F39:41.</p>\n\n<pre><code>Dim myValue As Variant\n\n    myValue = InputBox(\"Enter Value\", \"Enter Value in \u00a3's\", \"\u00a3\")\n    Range(\"B7\").Formula = \"=Sum(F39:F41)\" + CInt(myValue)\n</code></pre>\n\n<p>Range(\"B7\").Value = myValue works just fine, but if I look to also include sum F39:41 in the formula it fails. I've tried this as a formula with CInt but still not working. Any ideas?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "debugging"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1458121597, "post_id": 36031781, "comment_id": 59713411, "body": "Knew I&#39;d be missing something simple like this, thank you :)"}], "tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": true, "score": 3, "last_activity_date": 1458121221, "creation_date": 1458121221, "answer_id": 36031781, "question_id": 36031625, "link": "https://stackoverflow.com/questions/36031625/vba-for-each-ws-only-executes-code-on-active-sheet/36031781#36031781", "title": "VBA For Each ws only executes code on active sheet", "body": "<pre><code>For Each Ws In ActiveWorkbook.Worksheets\n    With Ws\n        .Range(\"A1:A100\").EntireRow.Hidden = False\n        lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column - 11\n        'hide newly unneeded columns\n        For i = 1 To 3\n            .Columns(lastcol).Hidden = True\n            lastcol = lastcol + 1\n        Next i\n        lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        'paste across columns\n        For i = 1 To 3\n            .Columns(lastcol).Copy .Columns(lastcol + 3)\n            lastcol = lastcol - 1\n        Next i\n    End With\nNext Ws\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1458121283, "creation_date": 1458121283, "answer_id": 36031807, "question_id": 36031625, "link": "https://stackoverflow.com/questions/36031625/vba-for-each-ws-only-executes-code-on-active-sheet/36031807#36031807", "title": "VBA For Each ws only executes code on active sheet", "body": "<p>You need to prefix things like Range(\"a1:a10\") with ws, so ws.range(\"a1:a10\") or select ws in each loop.  Without Range &amp; Cells will act on the active sheet.</p>\n"}], "owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 36031781, "answer_count": 2, "score": -1, "last_activity_date": 1458121283, "creation_date": 1458120861, "question_id": 36031625, "link": "https://stackoverflow.com/questions/36031625/vba-for-each-ws-only-executes-code-on-active-sheet", "title": "VBA For Each ws only executes code on active sheet", "body": "<p>I want to format a worksheet the same way in every sheet, currently the code works fine, except for the <code>for each ws in workbook</code> section.</p>\n\n<p>All the code executes well enough, but only in the activesheet.\nWhat am I missing here?</p>\n\n<p>Thanks in advance,</p>\n\n<pre><code>Option Explicit\nSub prepareForInput()\nApplication.ScreenUpdating = False\nDim ws As Worksheet\nDim answer As Variant\nDim i As Integer, lastcol As Integer\n\nanswer = MsgBox(\"Would you like to update the tracker sheet automatically?\", vbYesNo)\nIf answer = vbYes Then\n    For Each ws In ActiveWorkbook.Worksheets\n        Range(\"A1:A100\").EntireRow.Hidden = False\n        lastcol = Cells(1, Columns.Count).End(xlToLeft).Column - 11\n        'hide newly unneeded columns\n        For i = 1 To 3\n            Columns(lastcol).Hidden = True\n            lastcol = lastcol + 1\n        Next i\n        lastcol = Cells(1, Columns.Count).End(xlToLeft).Column\n        'paste across columns\n        For i = 1 To 3\n            Columns(lastcol).Copy Columns(lastcol + 3)\n            lastcol = lastcol - 1\n        Next i\n    Next ws\nEnd If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1458121108, "post_id": 36031611, "comment_id": 59713027, "body": "Look at events of worksheets and controls, so the Click event of a button, then you&#39;ll need to use the text or value of the combobox.   A little gooogling will explain a lot about this. :)"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5377762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/860e112e62e8aa66d31f47737e8da4db?s=128&d=identicon&r=PG&f=1", "display_name": "qube13", "link": "https://stackoverflow.com/users/5377762/qube13"}, "edited": false, "score": 0, "creation_date": 1458208976, "post_id": 36038479, "comment_id": 59761310, "body": "Thanks for your help! Do you have an idea, how to open the UserForm in the whole column of A?  <code>If Selection.Count = 1 Then         Dim check As Boolean         check = True         If check Then         Dim i As Long             For i = 1 To 100000                 If Not Intersect(Target, Range(&quot;A&quot; &amp; i)) Is Nothing Then                     UserForm1.Show                     check = False                 End If             Next         End If     End If</code> This was my idea, but it is very slow, when you have to go trough 100000 cells."}, {"owner": {"reputation": 65, "user_id": 5377762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/860e112e62e8aa66d31f47737e8da4db?s=128&d=identicon&r=PG&f=1", "display_name": "qube13", "link": "https://stackoverflow.com/users/5377762/qube13"}, "edited": false, "score": 0, "creation_date": 1458209227, "post_id": 36038479, "comment_id": 59761495, "body": "Another question is, if there is another way of adding the text to the cell, because If I click in one cell in the whole column, I don&#39;t know, where I am going to click. I tried to save the target in a public variable, but that doesn&#39;s work."}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 65, "user_id": 5377762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/860e112e62e8aa66d31f47737e8da4db?s=128&d=identicon&r=PG&f=1", "display_name": "qube13", "link": "https://stackoverflow.com/users/5377762/qube13"}, "edited": false, "score": 0, "creation_date": 1458209935, "post_id": 36038479, "comment_id": 59762064, "body": "Those would need to be new questions, comments arent big enough to put in the answers for those, if my answer has resolved your initial question then please accept this as an answer"}, {"owner": {"reputation": 65, "user_id": 5377762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/860e112e62e8aa66d31f47737e8da4db?s=128&d=identicon&r=PG&f=1", "display_name": "qube13", "link": "https://stackoverflow.com/users/5377762/qube13"}, "edited": false, "score": 0, "creation_date": 1458217594, "post_id": 36038479, "comment_id": 59767602, "body": "Thanks for the hint. The new question is <a href=\"https://stackoverflow.com/questions/36060525/vba-open-a-userform-by-clicking-anywhere-in-a-specific-column\">here</a>."}], "tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1458138269, "creation_date": 1458138269, "answer_id": 36038479, "question_id": 36031611, "link": "https://stackoverflow.com/questions/36031611/excel-vba-text-from-textbox-in-the-active-cell/36038479#36038479", "title": "Excel VBA - Text from TextBox in the active cell", "body": "<p>Here is a piece of code that will run when you click a cell</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Selection.Count = 1 Then\n        If Not Intersect(Target, Range(\"A1\")) Is Nothing Then\n            'name of userform .Show\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Where the code has a comment you need the name oof your userform and then <code>.Show</code></p>\n\n<p>Entering the text into, lets say A1 as you suggested, would be:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nTextValue = TextBox1.Text\n\n[A1].Value = TextValue\n\nEnd Sub\n</code></pre>\n\n<p>Change the <code>CommandButton1</code> and <code>TextBox1</code> to whatever you named them(if you named them, which you should)</p>\n\n<p>If you need anything clarified just ask</p>\n"}], "owner": {"reputation": 65, "user_id": 5377762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/860e112e62e8aa66d31f47737e8da4db?s=128&d=identicon&r=PG&f=1", "display_name": "qube13", "link": "https://stackoverflow.com/users/5377762/qube13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "accepted_answer_id": 36038479, "answer_count": 1, "score": -1, "last_activity_date": 1458138269, "creation_date": 1458120830, "question_id": 36031611, "link": "https://stackoverflow.com/questions/36031611/excel-vba-text-from-textbox-in-the-active-cell", "title": "Excel VBA - Text from TextBox in the active cell", "body": "<p>I would like to build a simple UserForm with a TextBox and a CommandButton, which opens itself by clicking inside a <strong>empty cell</strong> in a special column (for example in the column A, the cell A1) inside the worksheet. When I enter a text and hit the button, the entered text should be pasted in the active cell (A1). </p>\n\n<p>The building of the UserForm is not the problem, but the actions which are behind it. </p>\n\n<p>Do you guys have an idea how to solve this? Or even better pieces of code? </p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["sql-server", "vba", "adodb"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1458121392, "post_id": 36031601, "comment_id": 59713250, "body": "As far as I understand your code, you are loading the first recordset in the form, then looping into all the records without doing anything..."}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1458121911, "post_id": 36031601, "comment_id": 59713650, "body": "@Vincent Why i am loading only the first? Please help me... in the Moment i understand nothing :-(  I can&#39;t place the Do above the Rs.Open !!??"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1458125071, "post_id": 36031601, "comment_id": 59715906, "body": "How are we supposed to understand your code if you don&#39;t?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1458125677, "post_id": 36031601, "comment_id": 59716357, "body": "<code>msgbox i</code> after <code>rs.close</code> would show you the number of records you have, you presumably only see 1 record as you only set the <code>.value</code> of the controls once."}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1458126814, "post_id": 36031601, "comment_id": 59717147, "body": "@Gareth you&#39;re right but today is really not my day. of course mine is loop in the nothing went..."}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458126964, "post_id": 36031601, "comment_id": 59717261, "body": "now the Loop is on the right place and it is how your were wrote. i overwrite always the first and then only the last is recorded!!! thx"}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1458135753, "post_id": 36031601, "comment_id": 59723961, "body": "@AlexK. i tried .Value both but no effect. I set the MsgBox i and the are more than one rows..."}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458136083, "post_id": 36031601, "comment_id": 59724252, "body": "@All                                                                                                                    Do Until Rs.EOF = True         i = i + 1         Me.TeileGruppe.Value = Rs.Fields(&quot;Teilegruppe&quot;).Value         ...         Me.Sparte.Value = Rs.Fields(&quot;Sparte&quot;).Value         Rs.MoveNext     Loop          But only the last is in the datarecord!!! Why the loop is now correct!? Or not!?"}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458127033, "post_id": 36033460, "comment_id": 59717311, "body": "THX, but i have it not finaly yet"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458127915, "post_id": 36033460, "comment_id": 59717941, "body": "I don&#39;t know what you are trying to achieve, try to explain what you want to do."}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458128458, "post_id": 36033460, "comment_id": 59718300, "body": "Access is only the frontend. SQL Server 2008 completly the backend. On the Server i have a view with 10000 rows. When i link the view with ODBC, the performance is very awful!!! So i want to get the data with the ABODB."}, {"owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458128543, "post_id": 36033460, "comment_id": 59718353, "body": "Should i better use DAO with snapshot?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "edited": false, "score": 0, "creation_date": 1458129845, "post_id": 36033460, "comment_id": 59719199, "body": "You could try it, snapshot should be a lot faster"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": true, "score": 0, "last_activity_date": 1458125388, "creation_date": 1458125388, "answer_id": 36033460, "question_id": 36031601, "link": "https://stackoverflow.com/questions/36031601/access-2010-vba-adodb-recordset-returns-only-one-record/36033460#36033460", "title": "Access 2010 VBA ADODB Recordset returns only one record", "body": "<p>Try to change the code to something like this:</p>\n\n<pre><code>Rs.MoveFirst\nDo Until Rs.EOF\n\nMe.TeileGruppe.Value = Rs.Fields(\"Teilegruppe\")\nMe.PlanTGrpSpanne_Stfl1.Value = Rs.Fields(\"Plan-TGrp-Spanne_Stfl1\")\nMe.PlanTGrpSpanne_Stfl2.Value = Rs.Fields(\"Plan-TGrp-Spanne_Stfl2\")\nMe.PlanTGrpSpanne_Stfl3.Value = Rs.Fields(\"Plan-TGrp-Spanne_Stfl3\")\n...\nMe.Suchbegriff.Value = Rs.Fields(\"Suchbegriff\")\nMe.Selektion.Value = Rs.Fields(\"Selektion\")\nMe.Katalogartikel.Value = Rs.Fields(\"Katalogartikel\")\nMe.Sparte.Value = Rs.Fields(\"Sparte\")\n\nRs.MoveNext\nLoop\n</code></pre>\n\n<p>In your code, you loaded the first recordset into your form and then you looped through all the recordsets, with this code, you loop through the records and load each on into the form.\nBut each time the value of the textboxes will be replaced, so you will most likely only see the last record.</p>\n"}], "owner": {"reputation": 444, "user_id": 4632468, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a75d69cd8a784fad22704c0423bd5fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Vegeta_77", "link": "https://stackoverflow.com/users/4632468/vegeta-77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 36033460, "answer_count": 1, "score": -1, "last_activity_date": 1458125388, "creation_date": 1458120789, "last_edit_date": 1458124986, "question_id": 36031601, "link": "https://stackoverflow.com/questions/36031601/access-2010-vba-adodb-recordset-returns-only-one-record", "title": "Access 2010 VBA ADODB Recordset returns only one record", "body": "<p>Since hours i am trying and trying, but find no solution... Here's the code:</p>\n\n<pre><code>Private Sub Form_Load()\n    Dim Cn As New ADODB.Connection\n    Dim Rs As New ADODB.Recordset\n\n    Cn.Provider = \"SQLOLEDB.1\"\n    Cn.CursorLocation = adUseClient\n    Cn.ConnectionString = \"Password=*************;\" &amp; _\n    \"Persist Security Info=True;\" &amp; _\n    \"User ID=sa;\" &amp; _\n    \"Initial Catalog=pA-StdVK-KalkDB_V1;\" &amp; _\n    \"Data Source=WINSER27\"\n    Cn.Open\n\n    Rs.Open \"SELECT * FROM [dbo].[VIEW_Superliste_000]\", Cn\n\n    ' Me ist im Formular Name und Rs das Column im SQL Server\n    Me.TeileGruppe.Value = Rs.Fields(\"Teilegruppe\")\n    Me.PlanTGrpSpanne_Stfl1.Value = Rs.Fields(\"Plan-TGrp-Spanne_Stfl1\")\n    Me.PlanTGrpSpanne_Stfl2.Value = Rs.Fields(\"Plan-TGrp-Spanne_Stfl2\")\n    Me.PlanTGrpSpanne_Stfl3.Value = Rs.Fields(\"Plan-TGrp-Spanne_Stfl3\")\n    ...\n    Me.Suchbegriff.Value = Rs.Fields(\"Suchbegriff\")\n    Me.Selektion.Value = Rs.Fields(\"Selektion\")\n    Me.Katalogartikel.Value = Rs.Fields(\"Katalogartikel\")\n    Me.Sparte.Value = Rs.Fields(\"Sparte\")\n\n    Dim i As Long\n    i = 0\n\n    Do Until Rs.EOF\n        i = i + 1\n        Rs.MoveNext\n    Loop\n\n    Rs.Close\n\n\nExitSub:\n    Set Rs = Nothing\n    Exit Sub\nErrorHandler:\n    Resume ExitSub\nEnd Sub\n</code></pre>\n\n<p>With ... i short the code here on stackoverflow, that it is not so long!!!  </p>\n\n<p>Why get i only one record???</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1458124112, "last_edit_date": 1458124112, "creation_date": 1458120690, "answer_id": 36031560, "question_id": 36031470, "link": "https://stackoverflow.com/questions/36031470/short-way-of-cheeking-multiple-string-in-vba/36031560#36031560", "title": "short way of cheeking multiple string in VBA", "body": "<p>Use the Select Case or Switch function</p>\n\n<pre><code>Function SwapString(strInput As String)\n    SwapString= Switch(strInput = \"a\", \"Apple\", strInput = \"b\", \"Banana\", strInput = \"c\", \"Cherry\")\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1458121879, "post_id": 36031796, "comment_id": 59713617, "body": "I have no idea about dictionary. I will try your idea and get back. +1 till then."}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 4, "last_activity_date": 1458127184, "last_edit_date": 1458127184, "creation_date": 1458121255, "answer_id": 36031796, "question_id": 36031470, "link": "https://stackoverflow.com/questions/36031470/short-way-of-cheeking-multiple-string-in-vba/36031796#36031796", "title": "short way of cheeking multiple string in VBA", "body": "<p>A dictionary may be worthwhile here, as long as the [a, b, ...z] set is unique.</p>\n\n<p>In the VBA IDE, go to Tools, References, and select Windows Scripting Runtime.</p>\n\n<pre><code>Public gdctAnimals As Dictionary\n\nPublic Sub SetUpAnimalDictionary()\n    Set gdctAnimals = new Scripting.Dictionary\n    gdctAnimals.Add \"a\", \"apple\"\n    gdctAnimals.Add \"b\", \"ball\"\n    gdctAnimals.Add \"c\", \"cat\"\n    gdctAnimals.Add \"z\", \"zebra\"\nEnd Sub\n\nPublic Sub YourProc(midtxt As String)\n    If gdctAnimals Is Nothing Then\n        SetUpAnimalDictionary\n    End If\n\n    If gdctAnimals.Exists(midtxt) Then\n        MsgBox gdctAnimals(midtxt)\n    Else\n        MsgBox \"Item not found in dictionary\", vbExclamation\n    End if\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1458121747, "creation_date": 1458121747, "answer_id": 36032031, "question_id": 36031470, "link": "https://stackoverflow.com/questions/36031470/short-way-of-cheeking-multiple-string-in-vba/36032031#36032031", "title": "short way of cheeking multiple string in VBA", "body": "<p>In your case, if you can only have 26 combinations (a-z) the easiest way is to do this:</p>\n\n<pre><code>Public Function ReturnString(strIn As String) As String\n\n    Select Case strIn\n\n        Case \"a\"\n            ReturnString = \"apple\"\n        Case \"b\"\n            ReturnString = \"ball\"\n        Case \"c\"\n            ReturnString = \"cat\"\n\n        ' .............\n\n        Case Else\n            ReturnString = \"UNKNOWN\"\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>and you call your fonction like this</p>\n\n<pre><code>MyLongString = ReturnString \"a\"\n</code></pre>\n\n<p>But there are many more possibililities that I won't detail because you have not detailed enough your question:</p>\n\n<ul>\n<li>You can use 2 arrays or a 2D array</li>\n<li>you can use an array of private types</li>\n<li>you can use a dictionary as specified in another answer</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1458125316, "post_id": 36033356, "comment_id": 59716090, "body": "Let me understand it."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1458125954, "post_id": 36033356, "comment_id": 59716558, "body": "This works but I failed to give better example. This sims shortest answer. If the string is fixed this will be very useful. for me every time the parsing string will be different."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1458126632, "post_id": 36033356, "comment_id": 59717030, "body": "This is certainly the creative example code. Will test and tell."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1458126692, "post_id": 36033356, "comment_id": 59717072, "body": "Yeah this is not going to work for anything other than single letter lookups"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1458125389, "last_edit_date": 1458125389, "creation_date": 1458125057, "answer_id": 36033356, "question_id": 36031470, "link": "https://stackoverflow.com/questions/36031470/short-way-of-cheeking-multiple-string-in-vba/36033356#36033356", "title": "short way of cheeking multiple string in VBA", "body": "<p>No need for an external component or tedious population, you are looking for something based on an ordinal value; <code>a=&gt;z</code> is the character code range <code>97=&gt;122</code> so you can use a simple efficient array lookup by converting the character code to a value within the bounds of the array:</p>\n\n<pre><code>'//populate (once)\nDim map() As String: map = Split(\"apple,ball,cat,...,zebra\", \",\")\n\n'//lookup\nmidtxt = \"a\"\nmidtxt = map(Asc(Left$(midtxt, 1)) - 97)\n\n'=&gt;apple\n\nmidtxt = \"c\"\nmidtxt = map(Asc(Left$(midtxt, 1)) - 97)\n\n'=&gt;cat\n</code></pre>\n\n<p>If needed check the value starts with a character first with <code>if midtxt like \"[a-z]*\" then ...</code></p>\n"}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 36031560, "answer_count": 4, "score": 1, "last_activity_date": 1458127184, "creation_date": 1458120459, "last_edit_date": 1458126497, "question_id": 36031470, "link": "https://stackoverflow.com/questions/36031470/short-way-of-cheeking-multiple-string-in-vba", "title": "short way of cheeking multiple string in VBA", "body": "<p>What is shortcut of checking string value like this.</p>\n\n<pre><code>If midtxt = \"a\" Then\n    midtxt = \"apple\"\n    ElseIf midtxt = \"b\" Then\n        midtxt = \"ball\"\n        ElseIf midtxt = \"c\" Then\n            midtxt = \"cat\"\n         .....\n            ElseIf midtxt = \"z\" Then\n               midtxt = \"zebra\"\nEnd If\nMsgBox midtxt\n</code></pre>\n\n<p>Is there any way I can do this using two arrays.</p>\n\n<pre><code>[a, b, c....z] and [apple, ball, cat.....zebra]\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>I need reproducible function for my task.</p>\n\n<p>I think a for apple is not right example for me.</p>\n\n<p>This is updated array for me.</p>\n\n<pre><code>[ap, bl, ca,... zr]  [apple, ball, cat... zebra]\n</code></pre>\n\n<p>means the two letter code is derived from the corresponding string but it is not uniformly derived.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 1, "creation_date": 1458116676, "post_id": 36030056, "comment_id": 59710175, "body": "Error 1004 usually means that VLOOKUP returns #NA. Have you tried un-commenting this line: &#39;On Error GoTo MyErrorHandler:"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "reply_to_user": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 0, "creation_date": 1458116798, "post_id": 36030056, "comment_id": 59710242, "body": "yes i did and it says employee not present but it does exist in the data sheet:/ @bioschaf"}, {"owner": {"reputation": 9559, "user_id": 92092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f89ccd615b02ac716a550ec951a84976?s=128&d=identicon&r=PG", "display_name": "stephan", "link": "https://stackoverflow.com/users/92092/stephan"}, "reply_to_user": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 0, "creation_date": 1458116854, "post_id": 36030056, "comment_id": 59710273, "body": "And to add to @bioschaf, my guess is that <code>Seat_No</code> is a string, but the seat number in your sheet is an integer, try <code>Application.WorksheetFunction.Vlookup(Int(Seat_No), ...</code>. More generally, set a break point at the VLookup and look what happens."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "reply_to_user": {"reputation": 9559, "user_id": 92092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f89ccd615b02ac716a550ec951a84976?s=128&d=identicon&r=PG", "display_name": "stephan", "link": "https://stackoverflow.com/users/92092/stephan"}, "edited": false, "score": 0, "creation_date": 1458116977, "post_id": 36030056, "comment_id": 59710344, "body": "Okay got it! Thanks alot @stephan"}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "is_accepted": false, "score": 0, "last_activity_date": 1458117003, "creation_date": 1458117003, "answer_id": 36030308, "question_id": 36030056, "link": "https://stackoverflow.com/questions/36030056/vlookup-with-vba/36030308#36030308", "title": "Vlookup with VBA", "body": "<pre><code>Sub FINDSAL()\n\nOn Error GoTo MyErrorHandler:\nDim Seat_No As Integer\nSeat_No = InputBox(\"Enter the Seat Number:\")\nIf Len(Seat_No) &gt; 0 Then\n  nameit = Application.WorksheetFunction.Vlookup(Seat_No, Sheets(\"L12 - Data Sheet\").Range(\"B4:E250\"), 2, False)\n  MsgBox \"The name is : $ \" &amp; nameit\nElse\n  MsgBox (\"You entered an invalid value\")\nEnd If\nExit Sub\nMyErrorHandler:\nIf Err.Number = 1004 Then\n  MsgBox \"Employee Not Present in the table.\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458126459, "creation_date": 1458115965, "last_edit_date": 1458126459, "question_id": 36030056, "link": "https://stackoverflow.com/questions/36030056/vlookup-with-vba", "title": "Vlookup with VBA", "body": "<p>I am trying to do an automated vlookupfunction but I am getting a run time error: </p>\n\n<pre><code>1004 \"Unable to get the Vlookup property of the worksheet functionclass\"\n</code></pre>\n\n<p>Would need some help on where it could have gone wrong and how it could be adjusted!</p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub FINDSAL()\n'On Error GoTo MyErrorHandler:\nDim Seat_No As String\nSeat_No = InputBox(\"Enter the Seat Number:\")\nIf Len(Seat_No) &gt; 0 Then\n  nameit = Application.WorksheetFunction.Vlookup(Seat_No, Sheets(\"L12 - Data Sheet\").Range(\"B4:E250\"), 2, False)\n  MsgBox \"The name is : $ \" &amp; nameit\nElse\n  MsgBox (\"You entered an invalid value\")\nEnd If\nExit Sub\nMyErrorHandler:\nIf Err.Number = 1004 Then\n  MsgBox \"Employee Not Present in the table.\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1458128922, "post_id": 36029202, "comment_id": 59718571, "body": "Do you have a merged cell in column &quot;O&quot; ?"}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1458171431, "post_id": 36029202, "comment_id": 59746396, "body": "@florentbr yes thats where my column date is"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458114992, "post_id": 36029713, "comment_id": 59709207, "body": "i tried it but its not working, thanks for answer tho"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458115251, "post_id": 36029713, "comment_id": 59709344, "body": "I just already tried it and it works. Can you describe it more? Which is your input, how looks like result,"}], "tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 0, "last_activity_date": 1458114888, "creation_date": 1458114888, "answer_id": 36029713, "question_id": 36029202, "link": "https://stackoverflow.com/questions/36029202/vba-error-in-numberformat-for-date/36029713#36029713", "title": "VBA - error in .NumberFormat for date", "body": "<p>Can you try this one?</p>\n\n<pre><code>Cells(1, 5).NumberFormat = \"dd/mm/yyyy\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458115487, "post_id": 36029791, "comment_id": 59709484, "body": "i already declared data,  Dim Sheet2 As Worksheet, data(), i&amp;"}, {"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458115805, "post_id": 36029791, "comment_id": 59709668, "body": "Where are you stuck at BTW."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458116167, "post_id": 36029791, "comment_id": 59709884, "body": "i want to return month value from column O which contains date but what i getting is the exact value from column O"}], "tags": [], "owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1458115142, "creation_date": 1458115142, "answer_id": 36029791, "question_id": 36029202, "link": "https://stackoverflow.com/questions/36029202/vba-error-in-numberformat-for-date/36029791#36029791", "title": "VBA - error in .NumberFormat for date", "body": "<p>Try  </p>\n\n<pre><code>  Dim data As Range\n  Set data = Intersect(Sheet2.Columns(\"O\"), Sheet2.UsedRange)\n  data.NumberFormat = \"mm/dd/yyyy\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458172694, "post_id": 36031792, "comment_id": 59746817, "body": "wow its now working! thanks your @vegard so my code is for mm/dd/yyyy format and yours is Mar 16 2016 3:19PM"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458172902, "post_id": 36031792, "comment_id": 59746893, "body": "My code fixes a possible mismatch and makes it easier to apply the correct number format by forcing the value to become a <code>Date</code> type. You should be able to apply whatever format you want to it once it is being put on the sheet."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458173470, "post_id": 36031792, "comment_id": 59747062, "body": "coz i tried mm/dd/yyyy and i got an error type mismatch but now that i re-run it again its now working, but in the output there is something wrong in the output.. i have 19 rows i used march so the value will be 3 all 19 rows are 3 but there is row 20 and the value is 12"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458198923, "post_id": 36031792, "comment_id": 59755067, "body": "You have to show us the original data for the cell that is going wrong and the result of the procedure."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458199247, "post_id": 36031792, "comment_id": 59755213, "body": "i&#39;ve tried it on other file its working, the problem is the file that i&#39;m using i think it has to do with the format"}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458200371, "post_id": 36031792, "comment_id": 59755802, "body": "is it possible to upload my file here..?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458200419, "post_id": 36031792, "comment_id": 59755831, "body": "No. But I doubt the whole file is necessary - you can just paste the original and resulting data."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1458200605, "post_id": 36031792, "comment_id": 59755909, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/106552/discussion-between-7a65726f-and-vegard\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1458121251, "creation_date": 1458121251, "answer_id": 36031792, "question_id": 36029202, "link": "https://stackoverflow.com/questions/36029202/vba-error-in-numberformat-for-date/36031792#36031792", "title": "VBA - error in .NumberFormat for date", "body": "<p>Try changing this:</p>\n\n<pre><code>  For i = 2 To UBound(data)\n  If VarType(data(i, 1)) = vbDate Then\n    data(i, 1) = Month(data(i, 1))\n  End If\nNext\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>For i = 2 To UBound(data)\n  data(i, 1) = Month(CDate(data(i, 1)))\nNext i\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 36031792, "answer_count": 3, "score": 0, "last_activity_date": 1458171759, "creation_date": 1458113229, "last_edit_date": 1531164843, "question_id": 36029202, "link": "https://stackoverflow.com/questions/36029202/vba-error-in-numberformat-for-date", "title": "VBA - error in .NumberFormat for date", "body": "<p>My problem is that the format of my column <code>DATE</code> is <code>Mar 16 2016 3:19PM</code>. The format that I need for my code to run is <code>3/16/2016</code> and now I'm try to convert it. This is the error I get with using my code:</p>\n\n<blockquote>\n  <p>Run-time error '13' Type mismatch</p>\n</blockquote>\n\n<p>this is the line that i got the error </p>\n\n<pre><code>data = Intersect(Sheet2.Columns(\"O\"), Sheet2.UsedRange).NumberFormat = \"mm/dd/yyyy\"\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>Public Sub Selection()\n\nDim file2 As Excel.Workbook\nDim Sheet2 As Worksheet, data(), i&amp;\n\n    Set Sheet2 = Workbooks.Open(TextBox2.Text).Sheets(1)\n\n    ' load the data from column O\n    data = Intersect(Sheet2.Columns(\"O\"), Sheet2.UsedRange).NumberFormat = \"mm/dd/yyyy\"\n    'set the title\n    data(1, 1) = \"Month\"\n    ' extract the month\n    For i = 2 To UBound(data)\n    If VarType(data(i, 1)) = vbDate Then\n      data(i, 1) = Month(data(i, 1))\n    End If\n  Next\n\n  ' write the data back to the sheet\n  Sheet2.UsedRange.Columns(Sheet2.UsedRange.Columns.Count + 1) = data\n\nEnd Sub\n</code></pre>\n\n<p>I've tried using: </p>\n\n<p><code>outputWksht.Columns(24).NumberFormat = \"mm/dd/yyyy\"</code></p>\n\n<p>and </p>\n\n<p><code>Cells(1, 1).Value = Format(StartDate, \"dd/mm/yyyy\")</code></p>\n\n<p>There are no errors but its not working, I wonder why??</p>\n"}, {"tags": ["vba", "excel", "filter", "macros"], "comments": [{"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1458139150, "post_id": 36028196, "comment_id": 59726788, "body": "Since you have recorded the whole working step I am going to take a shot in the dark and say you are new to VBA? If so I do recommend looking at some VBA guides/courses [<a href=\"http://www.homeandlearn.org/]\" rel=\"nofollow noreferrer\">homeandlearn.org/]</a>  is a good site to start at, also on this site code review will be good as it is for code that already works but you are wanting to improve it(NOTE - only for working code use code review), as you improve I ope you will help others on this site and other sites!"}], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1458113626, "creation_date": 1458113626, "answer_id": 36029314, "question_id": 36028196, "link": "https://stackoverflow.com/questions/36028196/vba-to-filter-values-based-on-two-criteria-wherein-header-column-keeps-on-changi/36029314#36029314", "title": "VBA to filter values based on Two Criteria wherein Header column keeps on changing", "body": "<p>See a cleaner way of performing what you desire below. Note that it is only for USD and \"Willie PCard\", you will need to edit it for any other AutoFilter etc.</p>\n\n<pre><code> Sub FilterAndCopy()\n\n      Dim DataWorkBook As Workbook\n      Set DataWorkBook = ThisWorkbook\n\n      Dim DataWorkSheet As Worksheet\n      Set DataWorkSheet = DataWorkBook.Sheets(\"ProcessorReportList\")\n\n      Dim FirstRowRange As Range\n      Dim CurrencyColumn As Long\n      Dim PolicyColumn As Long\n\n      Set FirstRowRange = DataWorkSheet.Rows(1).Find(\"Currency\")\n      CurrencyColumn = FirstRowRange.Column\n\n      Set FirstRowRange = DataWorkSheet.Rows(1).Find(\"Policy\")\n      PolicyColumn = FirstRowRange.Column\n\n      FirstRowRange.AutoFilter Field:=CurrencyColumn, Criteria1:=\"USD\"\n      FirstRowRange.AutoFilter Field:=PolicyColumn, Criteria1:=\"Willis PCard\"\n\n      DataWorkSheet.UsedRange.Copy\n\n      Dim PCard9Sheet As Worksheet\n      Set PCard9Sheet = DataWorkBook.Sheets.Add(After:=DataWorkBook.Sheets(\"ProcessorReportList\"))\n      PCard9Sheet.Name = \"P Card - 9\"\n\n      PCard9Sheet.Paste\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6038018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd5245a89b6ae60427a102a7c07d2f4?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/6038018/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458113626, "creation_date": 1458109498, "last_edit_date": 1458110133, "question_id": 36028196, "link": "https://stackoverflow.com/questions/36028196/vba-to-filter-values-based-on-two-criteria-wherein-header-column-keeps-on-changi", "title": "VBA to filter values based on Two Criteria wherein Header column keeps on changing", "body": "<p>In VBA i've recorded below code wherein, Col E = \"Currency\" &amp; Col B = \"Policy\"..</p>\n\n<p>What it should do is.. </p>\n\n<ol>\n<li>Both the column header Currency &amp; Policy keeps on changing so they should be automatically find by there names..</li>\n<li>Col Currency should filter as \"USD\" &amp; Col Policy should filter as \"Willis PCard\" than the filtered result should be copied to new sheet naming as \"P Card - \"</li>\n<li>Col Currency should filter as \"USD\" &amp; Col Policy should filter as \"Willis\" &amp; \"Willis Re\" &amp; both should be copied to new sheet naming as \"US -\"</li>\n</ol>\n\n<p>`</p>\n\n<pre><code>Sub Filter()    \n'\n' Filter Macro\n'\n'\n\nRows(\"1:1\").Select\nSelection.AutoFilter\nActiveSheet.Range(\"$A$1:$R$337\").AutoFilter Field:=5, Criteria1:=\"USD\"\nActiveSheet.Range(\"$A$1:$R$337\").AutoFilter Field:=2, Criteria1:= _\n\"Willis PCard\"\nCells.Select\nSelection.Copy\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(\"Sheet1\").Name = \"P Card - \"\nActiveSheet.Paste\nSheets(\"ProcessorReportsList\").Select\nApplication.CutCopyMode = False\nActiveSheet.Range(\"$A$1:$R$337\").AutoFilter Field:=2, Criteria1:=\"=Willis\" _\n, Operator:=xlOr, Criteria2:=\"=Willis RE\"\nActiveSheet.Range(\"$A$1:$R$337\").AutoFilter Field:=18, Criteria1:=\"&lt;&gt;\"\nCells.Select\nSelection.Copy\nActiveWindow.SmallScroll ToRight:=1\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(\"Sheet2\").Select\nSheets(\"Sheet2\").Name = \"US on Hold - \"\nActiveSheet.Paste\nSheets(\"ProcessorReportsList\").Select\nApplication.CutCopyMode = False\nActiveSheet.Range(\"$A$1:$R$337\").AutoFilter Field:=18, Criteria1:=\"=\"\nCells.Select\nSelection.Copy\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(\"Sheet3\").Select\nSheets(\"Sheet3\").Name = \"US - \"\nActiveSheet.Paste\nCells.Select\nCells.EntireColumn.AutoFit\nSheets(\"US on Hold - \").Select\nCells.Select\nCells.EntireColumn.AutoFit\nSheets(\"P Card - \").Select\nCells.Select\nCells.EntireColumn.AutoFit\nRange(\"A1\").Select\nSheets(\"ProcessorReportsList\").Select\nCells.Select\nCells.EntireColumn.AutoFit\nApplication.CutCopyMode = False\nSelection.AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p>However, the <a href=\"http://i.stack.imgur.com/tROlq.png\" rel=\"nofollow\">result</a> seems unexpected</p>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["excel", "macros", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1458131118, "post_id": 36027777, "comment_id": 59720105, "body": "Yes, you are correct on your deduction. I updated my formula I keep receiving the same error I posted on the summary. That didn&#39;t work. Any guidance would be great. :)"}, {"owner": {"reputation": 209, "user_id": 6069822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KaEZr.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/6069822/james"}, "reply_to_user": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1458140537, "post_id": 36027777, "comment_id": 59727892, "body": "After re-reading the question I think that you&#39;ve mixed up which range you want to return a value FROM vs. which one you want to match. Also, do you only have 3 addresses that you&#39;re checking (A2-A4) or more?"}, {"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1458149575, "post_id": 36027777, "comment_id": 59734667, "body": "I found out what the issue was. I will copy and paste the working formula below. It appears that when the formula was trying to find the other workbook, for some reason wouldn&#39;t read with numbers or spaces in them."}, {"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1458150001, "post_id": 36027777, "comment_id": 59734978, "body": "My workbook wasn&#39;t read by the formula. Had to remove all the spaces and numbers, very odd. The new formula works now but it auto mapped the folder structure as well, is that normal?=INDEX(&#39;C:\\Users\\sgatica\\Documents\\PM00045406\\BES, GOOD and Mobileiron Inventory\\Countries Migrated to MI\\March\\International Good and BES users&#91;InternationalDevicesTest.xlsx]Australia&#39;!$E$2:$E$4&zwnj;&#8203;,MATCH(A3:A122,&#39;C:\\U&zwnj;&#8203;sers\\sgatica\\Documen&zwnj;&#8203;ts\\PM00045406\\BES, GOOD and Mobileiron Inventory\\Countries Migrated to MI\\March\\International Good and BES users&#91;InternationalDevicesTest.xlsx]Australia&#39;!$G$2:$G$4&zwnj;&#8203;,0),1)"}, {"owner": {"reputation": 209, "user_id": 6069822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KaEZr.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/6069822/james"}, "reply_to_user": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1458187441, "post_id": 36027777, "comment_id": 59750907, "body": "I have referenced external workbooks before and while they are open it is not that crazy but when the source is closed you&#39;ll get that result: <a href=\"https://support.office.com/en-us/article/Create-an-external-reference-link-to-a-cell-range-in-another-workbook-c98d1803-dd75-4668-ac6a-d7cca2a9b95f\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 209, "user_id": 6069822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KaEZr.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/6069822/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1458141115, "last_edit_date": 1458141115, "creation_date": 1458107703, "answer_id": 36027777, "question_id": 36027619, "link": "https://stackoverflow.com/questions/36027619/match-text-from-workbook-1-column-a-and-workbook-2-column-a-and-return-value-fro/36027777#36027777", "title": "Match text from workbook 1 column A and workbook 2 column A and return value from column B in Workbook 2", "body": "<p>Sorry if I'm misunderstanding but let me unpack this a little bit:</p>\n\n<p>Are you trying to INDEX MATCH more than one address in workbook 1? If so, you have set the MATCH value as $A$2, meaning it will not change during an autofill.</p>\n\n<p>Also, it sounds like you're creating the formula inside of \"International Good and BES Users.xlsx\". If so, trying writing \"...Match(A2,...\" instead of spelling out the current workbook and sheet you're already in. </p>\n\n<p>The final formula would look like </p>\n\n<p>\"=INDEX([International Devices (3) 3.10 v3.xlxs]Australia!$G$2:$G$4, MATCH(A2, [International Devices (3) 3.10 v3.xlsx]Australia!$E$2:$E$4,0),1)\"</p>\n\n<hr>\n\n<p>Answer #2: \"=INDEX([International Devices (3) 3.10 v3.xlsx]Australia!$E$2:$E$4, MATCH(A2,[International Devices (3) 3.10 v3.xlxs]Australia!$G$2:$G$4,0),1)\"</p>\n"}], "owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458141115, "creation_date": 1458106996, "last_edit_date": 1531161705, "question_id": 36027619, "link": "https://stackoverflow.com/questions/36027619/match-text-from-workbook-1-column-a-and-workbook-2-column-a-and-return-value-fro", "title": "Match text from workbook 1 column A and workbook 2 column A and return value from column B in Workbook 2", "body": "<p>I have a workbook 1 with email addresses in column A. I also have a workbook 2 with addresses in column G. </p>\n\n<p>In workbook 1 column B I am trying to write a formula that will match the email addresses from workbook 1 Column A and workbook 2 column G. Once a match is found using the formula, I want the rest of the formula to copy the information from column E from workbook 2.</p>\n\n<p>This is the formula I am using: =INDEX([International Devices (3) 3.10 v3.xlxs]Australia!$G$2:$G$4, MATCH(International Good and BES Users.xlsx]Australia!$A$2, [International Devices (3) 3.10 v3.xlsx]Australia!$E$2:$E$4,0),1)</p>\n\n<p>I am receiving an error and unable to make it work. Am I on the right track, is there anything I can change to the formula to make it work.</p>\n\n<p><strong>Error</strong></p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/lJx8j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lJx8j.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n"}, {"tags": ["excel", "powerquery", "vba"], "answers": [{"tags": [], "owner": {"reputation": 948, "user_id": 5867672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc90776a7f4a8344c766894d44529e?s=128&d=identicon&r=PG&f=1", "display_name": "ImkeF", "link": "https://stackoverflow.com/users/5867672/imkef"}, "is_accepted": true, "score": 4, "last_activity_date": 1458114243, "creation_date": 1458114243, "answer_id": 36029499, "question_id": 36027448, "link": "https://stackoverflow.com/questions/36027448/calculations-within-power-query/36029499#36029499", "title": "Calculations within Power Query", "body": "<p>In order to substract the field from the following row from your current row, you need to use relative cell-references like described in this article: <a href=\"http://excel-inside.pro/blog/2015/11/05/absolute-and-relative-references-in-power-query/\" rel=\"nofollow\">http://excel-inside.pro/blog/2015/11/05/absolute-and-relative-references-in-power-query/</a></p>\n"}, {"tags": [], "owner": {"reputation": 505, "user_id": 3047101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oV8MQ.jpg?s=128&g=1", "display_name": "Stephan", "link": "https://stackoverflow.com/users/3047101/stephan"}, "is_accepted": false, "score": 0, "last_activity_date": 1467805227, "creation_date": 1467805227, "answer_id": 38223138, "question_id": 36027448, "link": "https://stackoverflow.com/questions/36027448/calculations-within-power-query/38223138#38223138", "title": "Calculations within Power Query", "body": "<p>Since you want to evaluate the data with a pivot table, I would recommend to load the data into the data model and use Power Pivot to perform the calculation. Add a calculated column with the formula</p>\n\n<pre><code>=CALCULATE(Min(Table1[MS]),FILTER(Table1,EARLIER(Table1[MS]) &lt; Table1[MS]))\n</code></pre>\n\n<p>This will give you the minimum value of MS which is greater than the one in the current row. Afterwards you can add another column with the difference between the new column and the MS column to get the Duration. You need to include an If clause to set the Duration of the highest MS value to 0 (or however you want to handle that):</p>\n\n<pre><code>=If([CalculatedColumn1]=BLANK(),0,[CalculatedColumn1]-[MS])\n</code></pre>\n\n<p>You can also add additional filters in the first formula to compare only those MS values related to the same \"Name_Age\":</p>\n\n<pre><code>=CALCULATE(Min(Table1[MS]),FILTER(Table1,EARLIER(Table1[MS]) &lt; Table1[MS] &amp;&amp; EARLIER(Table1[Name_Age]) = Table1[Name_Age]))\n</code></pre>\n\n<p>For more information about EARLIER() see <a href=\"https://msdn.microsoft.com/en-us/library/ee634551(v=sql.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ee634551(v=sql.110).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10519801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c10091b862f4d73472cab3704bfbd19?s=128&d=identicon&r=PG", "display_name": "Daniel Herce", "link": "https://stackoverflow.com/users/10519801/daniel-herce"}, "is_accepted": false, "score": 0, "last_activity_date": 1539795096, "last_edit_date": 1539795096, "creation_date": 1539794760, "answer_id": 52859842, "question_id": 36027448, "link": "https://stackoverflow.com/questions/36027448/calculations-within-power-query/52859842#52859842", "title": "Calculations within Power Query", "body": "<p>Try this (Power Query code):</p>\n\n<pre><code>let\nInput = Excel.CurrentWorkbook(){[Name=\"RawData\"]}[Content],\n</code></pre>\n\n<p>// Generates two lists (Time and Type) from source table columns.</p>\n\n<pre><code>Time = Input[MS],\nType = Input[Event],\n</code></pre>\n\n<p>// Creates a list of integers to loop, from 0 to the size of Time list less 1</p>\n\n<pre><code>Loop = {0..(List.Count(Time)-1)},\n</code></pre>\n\n<p>// Generates a new list (Delta) calculating the durations substracting the values in the Time List: value(position + 1) - value (position). If Type(position) = \"ER\" returns \"NA\".</p>\n\n<pre><code>Delta = List.Transform(Loop, each if Type{_}=\"ER\" then \"NA\" else Time{(_+1)}-Time{_}),\n</code></pre>\n\n<p>// Add the Delta list to the original table.</p>\n\n<pre><code>Indexed = Table.AddIndexColumn(Input,\"Duration\"),\nOutput = Table.TransformColumns(Indexed, {\"Duration\", each Delta{_}})\nin\nOutput\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 2360108, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/UxSid.jpg?s=128&g=1", "display_name": "Dragonsen", "link": "https://stackoverflow.com/users/2360108/dragonsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 36029499, "answer_count": 3, "score": 2, "last_activity_date": 1539795096, "creation_date": 1458106151, "last_edit_date": 1531161705, "question_id": 36027448, "link": "https://stackoverflow.com/questions/36027448/calculations-within-power-query", "title": "Calculations within Power Query", "body": "<p>I am trying to create a summary table of data located in a couple hundred CSV files. I have created some power queries to convert the data into one table with five columns (Name_Age, Events, MS, Name, Age) and import it into a table in Excel. This table is called RawData.\n<a href=\"https://i.stack.imgur.com/02AHx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/02AHx.png\" alt=\"RawData Example\"></a></p>\n\n<p>In a second tab, I have a VBA script copying RawData into a second table called Prep. The second table is necessary because I have a sixth column that calculates Duration. This second table is necessary because I couldn't figure out how to do the calculations in Power Query.\n<a href=\"https://i.stack.imgur.com/hibBQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hibBQ.png\" alt=\"Prep Example\"></a></p>\n\n<p>So, MS stands for milliseconds. This field represents the moment in time that Event happens. I need to calculate the duration of the event, i.e. MS of next event - MS of the current event. Using the Event AR as an example, my formula takes the MS of F (32635) and subtracts the MS of AR (32301) to give a duration of 334. ER stands for End of Record or the end of the timeline in question for the subject. How can I do that in Power Query?</p>\n\n<p>I can do it in Excel but I am using a macro to copy RawData into Prep. I would prefer to just have it all done in Power Query. The other reason is I then have a PivotTable summarizing the whole thing. If I can get the Duration calculated in Power Query, I can skip the macro.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458131077, "post_id": 36027404, "comment_id": 59720078, "body": "When you say you&#39;re running qryTYP1 or qryTYP2, are then just opening a saved query object for the user to start adding data to? If so, perhaps consider opening these in forms or subforms instead... I answered a question with some guidance on how to do this recently: <a href=\"http://stackoverflow.com/a/35912886/2140244\">stackoverflow.com/a/35912886/2140244</a> there&#39;s more events available to your to write VBA code on in forms/subforms."}, {"owner": {"reputation": 13, "user_id": 6069712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4949171bad7cbe9e4332a56969b5ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dre24", "link": "https://stackoverflow.com/users/6069712/dre24"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458255110, "post_id": 36027404, "comment_id": 59792287, "body": "Hi Matt, thanks for your help.  That&#39;s correct. I have considered using a form with a subform to display the results, but for example one query might have 6 columns displayed, and the next might have 40 columns displayed, and I couldn&#39;t figure out how to do this in a presentable way using forms/subforms and decided query results in general were the best way to handle this. However, is this the best way do you think (with forms and subforms)?  Thanks, Dre."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1458296559, "post_id": 36027404, "comment_id": 59808014, "body": "I believe so. Forms/subforms have lots of events on them for you to write VBA code, which makes sense when you think that forms/subforms are <i>designed</i> for user interaction and therefore a developer would want a lot of options to control that user interaction. A query object, on the otherhand, isn&#39;t really meant to be used as a user interface and hence has very little (if any?) events for a developer to work with. A query object is more for creating views of your existing data rather than a way of collecting/editing new data via user interaction."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6069712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4949171bad7cbe9e4332a56969b5ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dre24", "link": "https://stackoverflow.com/users/6069712/dre24"}, "edited": false, "score": 0, "creation_date": 1458255211, "post_id": 36027517, "comment_id": 59792334, "body": "Thanks Sergey. Currently I am referring to just query results being displayed, so not in a form/subform. However I am now considering this approach and may use this, so thank you."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1458106544, "creation_date": 1458106544, "answer_id": 36027517, "question_id": 36027404, "link": "https://stackoverflow.com/questions/36027404/ms-access-make-a-subform-display-separate-query-results/36027517#36027517", "title": "MS Access - Make a subform display separate query results", "body": "<p>You can add a button like \"Copy to New Record\" on the form with search results. By click on this button capture ID of found row, scroll to/add/insert new empty record and copy required data from found record to new one.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6069712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4949171bad7cbe9e4332a56969b5ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dre24", "link": "https://stackoverflow.com/users/6069712/dre24"}, "edited": false, "score": 0, "creation_date": 1458255264, "post_id": 36028824, "comment_id": 59792364, "body": "Thank you Gustav. I am now considering the form/subform approach to display data, so this will be very useful. Thank you for your assistance."}, {"owner": {"reputation": 13, "user_id": 6069712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4949171bad7cbe9e4332a56969b5ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dre24", "link": "https://stackoverflow.com/users/6069712/dre24"}, "edited": false, "score": 0, "creation_date": 1458255449, "post_id": 36028824, "comment_id": 59792435, "body": "Would you say this is the best method, using forms/subforms? Currently I am just running queries and displaying them as query results in another tab."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 13, "user_id": 6069712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4949171bad7cbe9e4332a56969b5ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dre24", "link": "https://stackoverflow.com/users/6069712/dre24"}, "edited": false, "score": 0, "creation_date": 1458290259, "post_id": 36028824, "comment_id": 59803906, "body": "Yes, I would recommend that."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1458111932, "creation_date": 1458111932, "answer_id": 36028824, "question_id": 36027404, "link": "https://stackoverflow.com/questions/36027404/ms-access-make-a-subform-display-separate-query-results/36028824#36028824", "title": "MS Access - Make a subform display separate query results", "body": "<p>Here is how to copy a record using a button click:</p>\n\n<pre><code>Private Sub btnCopy_Click()\n\n  Dim rstSource   As DAO.Recordset\n  Dim rstInsert   As DAO.Recordset\n  Dim fld         As DAO.Field\n\n  If Me.NewRecord = True Then Exit Sub\n\n  Set rstInsert = Me.RecordsetClone\n  Set rstSource = rstInsert.Clone\n  With rstSource\n    If .RecordCount &gt; 0 Then\n      ' Go to the current record.\n      .Bookmark = Me.Bookmark\n      With rstInsert\n        .AddNew\n          For Each fld In rstSource.Fields\n            With fld\n              If .Attributes And dbAutoIncrField Then\n                ' Skip Autonumber or GUID field.\n              ElseIf .Name = \"SomeFieldNotToCopy\" Then\n                ' Ignore this field.\n              ElseIf .Name = \"SomeSpecialField\" Then\n                ' Insert fixed or special value.\n                rstInsert.Fields(.Name).Value = SomeValue\n              Else\n                ' Copy field content.\n                rstInsert.Fields(.Name).Value = .Value\n              End If\n            End With\n          Next\n        .Update\n        ' Go to the new record and sync form.\n        .MoveLast\n        Me.Bookmark = .Bookmark\n        .Close\n      End With\n    End If\n    .Close\n  End With\n\n  Set rstInsert = Nothing\n  Set rstSource = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6069712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4949171bad7cbe9e4332a56969b5ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dre24", "link": "https://stackoverflow.com/users/6069712/dre24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458264337, "creation_date": 1458105877, "last_edit_date": 1458264337, "question_id": 36027404, "link": "https://stackoverflow.com/questions/36027404/ms-access-make-a-subform-display-separate-query-results", "title": "MS Access - Make a subform display separate query results", "body": "<p>First, note that I need to be rather 'general' about information in this post as it is work related.</p>\n\n<p>Currently in MS Access I have a database which uses one large sheet for the data stored (lets say <strong>tblDATASHEET</strong>) along with other tables. Queries are used to select the specific columns related, using a <strong>type_id</strong>. </p>\n\n<p>Users are searched from a listbox and the <strong>type_id</strong> is gathered.</p>\n\n<p>For example, if <strong>type_id</strong> = TYP1, then run <strong>qryTYP1</strong>. \n<strong>qryTYP1</strong> might need columns 1, 2, 5, 6 and 11 from <strong>tblDATASHEET</strong>.\n<strong>qryTYP2</strong> might only need columns 3, 4 and 5 from <strong>tblDATASHEET</strong>.</p>\n\n<p>This all works fine. So when the user is searched and the appropriate query is run, a list of records for the user will appear. From here I would like to be able to create/edit records displayed.</p>\n\n<p>Here's my problem, within query results for <strong>tblDATASHEET</strong>, when a new row is to be started/added, I would like certain fields to be auto-populated from the previous row. These fields are general fields such as name, title, dates, etc. Is this possible? </p>\n\n<p>Let me know if I've been too brief and I can go in to further detail. I have spent a LOT of time mucking around with VBA and data macros, and have gotten close but not close enough.</p>\n\n<p>Thank you,\nDre24. </p>\n\n<p><strong>EDIT</strong>\nSo I've decided to take the approach of displaying the query results within a subform on a form. </p>\n\n<p>Now my issue is, how can I make a subform display alternate queries depending on input?</p>\n\n<p>For example, the subform might need to display results from <strong>qryTYP1</strong> or <strong>qryTYP2</strong>, both two separate queries.</p>\n\n<p>Thanks again for any help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "is_accepted": true, "score": 5, "last_activity_date": 1458107242, "creation_date": 1458107242, "answer_id": 36027667, "question_id": 36027393, "link": "https://stackoverflow.com/questions/36027393/vba-excel-determine-if-table-has-data/36027667#36027667", "title": "VBA Excel Determine if &quot;Table##&quot; has data", "body": "<p>Answer: \n    If WorksheetFunction.CountA(Range(\"Table24\")) = 1 Then</p>\n"}, {"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 2, "last_activity_date": 1458120367, "last_edit_date": 1495541408, "creation_date": 1458120367, "answer_id": 36031433, "question_id": 36027393, "link": "https://stackoverflow.com/questions/36027393/vba-excel-determine-if-table-has-data/36031433#36031433", "title": "VBA Excel Determine if &quot;Table##&quot; has data", "body": "<p>Add this function (taken <a href=\"https://stackoverflow.com/questions/5183374/vba-test-if-cell-is-in-a-range/27838714#27838714\">from here</a>):</p>\n\n<pre><code>Function DBRRangeTest(rng1 As Range, Optional rng2 As Range)\n    ' DataBodyRange Range Test\n\n    ' Test if rng1 and rng2 intersect\n    If rng2 Is Nothing Then\n        ' Either no argument was supplied or the supplied argument was empty\n        DBRRangeTest = False\n        Exit Function\n    End If\n\n    If (rng1.Parent.Name = rng2.Parent.Name) Then\n        Dim ints As Range\n        Set ints = Application.Intersect(rng1, rng2)\n        If (Not (ints Is Nothing)) Then\n            DBRRangeTest = True\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>Then, replace this: </p>\n\n<pre><code>If ws.Range(\"Table24\").Rows.Count &gt; 0 Then\n\nSet myDataRange = ws.ListObjects(\"Table24\").ListColumns(3).DataBodyRange\n\nElse\n\nSet myDataRange = ws.Range(\"K1\")\n\nEnd If\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Dim tbl As ListObject\nSet tbl = ws.ListObject(\"Table24\")\n\nIf DBRRangeTest(tbl.HeaderRowRange.Offset(1), tbl.DataBodyRange) Then\n    ' If this test returns true, it means that there is a valid databodyrange _\n    ' but we have no guarantee whether the cell is empty or not, because DataBodyRange _\n    ' will return with an address if there *has* been a value in its range.\n    ' So we'll test manually.\n    If tbl.HeaderRowRange.Offset(1).Value &lt;&gt; \"\" Then\n        Set myDataRange = tbl.ListColumns(3).DataBodyRange\n    Else\n        Set myDataRange = ws.Range(\"K1\")\n    End If\nElse\n    ' The test returned false, which essentially is the same as _\n    ' DataBodyRange Is Nothing.\n    Set myDataRange = ws.Range(\"K1\")\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 1, "creation_date": 1570487702, "post_id": 48319173, "comment_id": 102922163, "body": "If any blank rows were added to the table then the DataBodyRange property will contain a range (it is -not- Nothing) and this logic might not behave as expected.  If the purpose is to avoid throwing an error by referencing DataBodyRange then this is fine."}], "tags": [], "owner": {"reputation": 131, "user_id": 9034104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b68003caf5ba7f02a51147496e4dec1?s=128&d=identicon&r=PG&f=1", "display_name": "Takudzwa", "link": "https://stackoverflow.com/users/9034104/takudzwa"}, "is_accepted": false, "score": 7, "last_activity_date": 1516271618, "creation_date": 1516271618, "answer_id": 48319173, "question_id": 36027393, "link": "https://stackoverflow.com/questions/36027393/vba-excel-determine-if-table-has-data/48319173#48319173", "title": "VBA Excel Determine if &quot;Table##&quot; has data", "body": "<p>The databodyrange property of a listobject represents the range of data. if there is no data in the list object, then the range has nothing</p>\n\n<pre><code>if ws.ListObjects(\"Table24\").DataBodyRange is Nothing then\n  'Do something if there is no data\nElse\n  'Do something if there is data\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 1, "last_activity_date": 1570488619, "creation_date": 1570488619, "answer_id": 58278096, "question_id": 36027393, "link": "https://stackoverflow.com/questions/36027393/vba-excel-determine-if-table-has-data/58278096#58278096", "title": "VBA Excel Determine if &quot;Table##&quot; has data", "body": "<p>I'll share the function I use.  It returns TRUE if a ListObject (table) is empty below the header row and above total row.  (It still works if the table isn't displaying either the header or total row.)</p>\n\n<p>This function checks for 1 of 4 possibilities:</p>\n\n<ol>\n<li>If the ListObject (table) variable \"Is Nothing\" it generates an easy to understand error.</li>\n<li>If the table doesn't have a DataBodyRange (no data was added below the header and above the total row and no blank rows were added to the table except for the row automatically created when the table was created) then it returns <code>False</code>.</li>\n<li>If the table has a DataBodyRange but every cell below the header and above the total row is <code>Empty</code> (does not contain a value, not even a zero length vbNullString character) then it returns <code>False</code>.</li>\n<li>If <strong>(a)</strong> the table has a DataBodyRange <em>and</em> <strong>(b)</strong> at least one cell below the header and above the total row is NOT <code>Empty</code> (contains any value, including a zero length vbNullString character) then it returns <code>False</code>.</li>\n</ol>\n\n<h2>Function IsEmptyTable()</h2>\n\n<pre><code>Public Function IsEmptyTable(ByVal target As Excel.ListObject) As Boolean        \n\n    Const APPNAME As String = \"IsEmptyTable()\"\n\n    If target Is Nothing Then\n        ' The parameter doesn't contain a ListObject (table).\n        Err.Raise 2310, _\n                  APPNAME, _\n                  APPNAME &amp; String$(2, vbNewLine) &amp; \"Parameter 'target' must refer to a valid ListObject (table).\"\n\n    ElseIf target.DataBodyRange Is Nothing Then\n        ' The table doesn't have a databody range and therefore has no data below\n        '   the header row and above the total row.\n        IsEmptyTable = True\n\n    Else\n        ' The table has a DataBodyRange.\n        '   Check it for any non-empty cells (including zero-length\n        '   vbNullString).  Return TRUE if any are found.\n        IsEmptyTable = Excel.WorksheetFunction.CountA(target.DataBodyRange) = 0\n\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": false, "score": 2, "last_activity_date": 1596539410, "creation_date": 1596539410, "answer_id": 63245631, "question_id": 36027393, "link": "https://stackoverflow.com/questions/36027393/vba-excel-determine-if-table-has-data/63245631#63245631", "title": "VBA Excel Determine if &quot;Table##&quot; has data", "body": "<p>I know this is old but for anyone reading this, the correct way to check for an empty table is using <em>ListRows.Count.</em></p>\n<p>This will give zero if the table is empty. In other words, if you delete all the rows in a table then <em>ListRows.Count</em> will be zero.</p>\n<pre><code>If Sheet1.ListObjects(&quot;Table&quot;).ListRows.Count = 0 Then\n    ' empty\nElse\n    ' not empty\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 4803331, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b5dc93c1f4aea1e990b16f9eed466a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Simmons", "link": "https://stackoverflow.com/users/4803331/ben-simmons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15560, "favorite_count": 4, "accepted_answer_id": 36027667, "answer_count": 5, "score": 7, "last_activity_date": 1596539410, "creation_date": 1458105830, "last_edit_date": 1531164843, "question_id": 36027393, "link": "https://stackoverflow.com/questions/36027393/vba-excel-determine-if-table-has-data", "title": "VBA Excel Determine if &quot;Table##&quot; has data", "body": "<p>I have the following code developed to create a chart from a named Range \"Table24\". However, there will be times when this table has no valid data and then I want the range of my dataset to be a cell with 0 and populate the chart with no data.</p>\n\n<p>This is for the 4th out of 5 charts- using the debug module I've determined that this is the code which crashes my excel file everytime it's run:</p>\n\n<pre><code>'//////////////////CHART 4 Creation //////////////////////////////\nSet myChtRange = ws.Range(\"L43:R63\")\n' What range contains data for chart\n\nIf ws.Range(\"Table24\").Rows.Count &gt; 0 Then\n\nSet myDataRange = ws.ListObjects(\"Table24\").ListColumns(3).DataBodyRange\n\nElse\n\nSet myDataRange = ws.Range(\"K1\")\n\nEnd If\n\n' Cover chart range with chart\nSet objChart = .ChartObjects.Add( _\n    Left:=myChtRange.Left, Top:=myChtRange.Top, _\n    Width:=myChtRange.Width, Height:=myChtRange.Height)\n' Put all the right stuff in the chart\nWith objChart.Chart\n    .ChartArea.AutoScaleFont = False\n    .ChartType = xlColumnClustered\n    .ChartStyle = 214\n    .SetSourceData Source:=myDataRange\n    .Parent.Name = \"Chart4\"\n    .HasTitle = True\n    .HasLegend = False\n    .ChartTitle.Characters.Text = \"Most Tolerance Holds\"\n    .ChartTitle.Font.Bold = True\n    .ChartTitle.Font.Size = 15\n\nIf ws.Range(\"Table24\").Rows.Count &gt; 0 Then\n\n     .SeriesCollection(1).XValues = ws.ListObjects(\"Table24\").ListColumns(2).DataBodyRange\nElse\n    .SeriesCollection(1).XValues = ws.Range(\"K1\")\n\nEnd If\n    With .Axes(xlCategory, xlPrimary)\n        .HasTitle = True\n        With .AxisTitle\n            .Characters.Text = \" \"\n            .Font.Size = 10\n            .Font.Bold = True\n        End With\n    End With\n    With .Axes(xlValue, xlPrimary)\n        .HasTitle = True\n        .DisplayUnit = none\n        .HasDisplayUnitLabel = False\n        .TickLabels.NumberFormat = \"#,##0.0\"\n        With .AxisTitle\n            .Characters.Text = \"Lines\"\n            .Font.Size = 15\n            .Font.Bold = True\n        End With\n    End With\nEnd With\n</code></pre>\n\n<p>I have tried:</p>\n\n<pre><code>If ws.ListObjects(\"Table24\").DataBodyRange.Rows.Count &gt; 0 Then\n\nIf NOT ws.ListObjects(\"Table24\").DataBodyRange Is Nothing Then\n</code></pre>\n\n<p>And even the IS Empty </p>\n\n<p>I need help in creating the correct argument when the table looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/jY2vI.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jY2vI.png\" alt=\"enter image description here\"></a></p>\n\n<p>For reference the named range \"Table24\" does exist. The table has no data in it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jpzyd.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jpzyd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458109132, "post_id": 36027712, "comment_id": 59706337, "body": "wow! suddenly it&#39;s magic! thank you so much! :) but i have a question what if the format of the column date is March,3,2016 how can the script read it automatically as mm/dd/yyyy?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458109178, "post_id": 36027712, "comment_id": 59706355, "body": "Have a look to the VBA.Format function or change the cell format."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1458109450, "post_id": 36027712, "comment_id": 59706473, "body": "sorry, i got confused wksht.Columns(94).NumberFormat = &quot;mm/dd/yyyy&quot; anw, thanks your codes helps a lot :)"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1458107437, "creation_date": 1458107437, "answer_id": 36027712, "question_id": 36026735, "link": "https://stackoverflow.com/questions/36026735/iterate-all-rows-in-date-and-store-the-month-value-to-the-last-column/36027712#36027712", "title": "Iterate all rows in date and store the month value to the last column", "body": "<p>To extract the month from column \"E\" to a new column:</p>\n\n<pre><code>Public Sub Selection()\n  Dim ws As Worksheet, data(), i&amp;\n  Set ws = Workbooks.Open(TextBox1.text).sheets(1)\n\n  ' load the data from column E\n  data = Intersect(ws.Columns(\"E\"), ws.UsedRange)\n\n  'set the title\n  data(1, 1) = \"Month\"\n\n  ' extract the month\n  For i = 2 To UBound(data)\n    If VarType(data(i, 1)) = vbDate Then\n      data(i, 1) = Month(data(i, 1))\n    End If\n  Next\n\n  ' write the data back to the sheet\n  ws.UsedRange.Columns(ws.UsedRange.Columns.count + 1) = data\n\n  MsgBox \"Succes!\", vbExclamation\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 36027712, "answer_count": 1, "score": 1, "last_activity_date": 1458115691, "creation_date": 1458102080, "last_edit_date": 1531164843, "question_id": 36026735, "link": "https://stackoverflow.com/questions/36026735/iterate-all-rows-in-date-and-store-the-month-value-to-the-last-column", "title": "Iterate all rows in date and store the month value to the last column", "body": "<p>I'm trying to loop through a column(A) that contains date and create an arbitrary column(lastcolumn+1) and store only the month value from the column(A) which contains the date. Please help me!</p>\n\n<p>Code: what my code is doing is copying the column and paste it the specified can someone help me to improve my code?</p>\n\n<pre><code> Public Sub Selection()\n\nDim file1 As Excel.Workbook\nDim Sheet1 As Worksheet\nDim serviceIDRng As Range\nDim lngLastRow As Long\nDim rngSheet1 As Range\nDim NextRow As Long\nDim LastRow As Long\nDim LastCol As Long\nDim c As Long\n\nSet Sheet1 = Workbooks.Open(TextBox1.Text).Sheets(1)\n\n'lngLastRow = Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).End(xlUp).Row\n'Set serviceIDRng = Sheet1.Range(\"T1:T\" &amp; lngLastRow)\n\n    Application.ScreenUpdating = False\n\n    With Sheet1\n        NextRow = .Cells(.Rows.Count, \"E\").End(xlUp).Row + 1\n    End With\n\n    With Sheet1\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        For c = 1 To LastCol\n            LastRow = .Cells(.Rows.Count, c).End(xlUp).Row\n            Set rngSheet1 = .Range(.Cells(3, c), .Cells(LastRow, c))\n            rngSource.Copy Sheet1.Range(\"E\" &amp; NextRow)\n            NextRow = NextRow + rngSheet1.Rows.Count\n        Next c\n    End With\n\n    Application.ScreenUpdating = True\n\n    MsgBox \"Succes!\", vbExclamation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "edited": false, "score": 0, "creation_date": 1458132884, "post_id": 36033823, "comment_id": 59721491, "body": "Thanks Jochen, you are great guy. but one more question if you do not mind, how about if the two similar dates not in order. eg. (&quot;E2&quot;)=1/1/2016 and the below one is 3/3/2016 and the third below cell is 1/1/2016. how can I do here. sorry for troubling you with me questions."}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "reply_to_user": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "edited": false, "score": 0, "creation_date": 1458141779, "post_id": 36033823, "comment_id": 59728874, "body": "No problem. I edited my solution to support unsorted lists."}, {"owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "edited": false, "score": 0, "creation_date": 1458214544, "post_id": 36033823, "comment_id": 59765352, "body": "many thanks Jochen, I really cannot but to thank you and hope you all the best. Appreciate it."}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 1, "last_activity_date": 1458141716, "last_edit_date": 1458141716, "creation_date": 1458126283, "answer_id": 36033823, "question_id": 36026686, "link": "https://stackoverflow.com/questions/36026686/employee-serial-number-based-on-hiring-date/36033823#36033823", "title": "Employee serial Number based on hiring date", "body": "<p>If your list stays sorted by Hiring Date you can just put the following formula in B2 and draw it down:</p>\n\n<p>=IF(E2=E1,B1+1,VALUE(TEXT(E2,\"YYMMDD\")&amp;\"00\"))</p>\n\n<p>EDIT:</p>\n\n<p>In case of unsorted lists use the following formula in B2 and draw it down:</p>\n\n<p>=TEXT(E2,\"YYMMDD\")&amp;TEXT(COUNTIF($E$1:E1,E2),\"00\")</p>\n\n<p>or (if you want it as a number instead of text): </p>\n\n<p>=VALUE(TEXT(E2,\"YYMMDD\")&amp;TEXT(COUNTIF($E$1:E1,E2),\"00\"))</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "edited": false, "score": 0, "creation_date": 1458215234, "post_id": 36040566, "comment_id": 59765865, "body": "As usual, you are one of the best who gives a great short and to the point  answers in VBA. many thanks Jeeped, Appreciate it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1458143198, "creation_date": 1458143198, "answer_id": 36040566, "question_id": 36026686, "link": "https://stackoverflow.com/questions/36026686/employee-serial-number-based-on-hiring-date/36040566#36040566", "title": "Employee serial Number based on hiring date", "body": "<p>You cannot apply a format mask (see <a href=\"https://support.office.com/en-us/article/Number-format-codes-5026BBD6-04BC-48CD-BF33-80F18B4EAE68\" rel=\"nofollow noreferrer\">Number Format Codes</a>) that included both date/time characters as well as a regular integer character, but if you convert the integer to the number of hours then your <strong>Emp no</strong> can be created in one shot.</p>\n\n<pre><code>Dim i As Long, seq As Long, dayPart As String\n\nWith Worksheets(\"employees\")\n    For i = 2 To .Cells(Rows.Count, \"E\").End(xlUp).Row\n        seq = Application.CountIf(.Columns(5).Resize(i - 1, 1), .Cells(i, \"E\").Value)\n        dayPart = Format(.Cells(i, \"E\").Value2 + TimeSerial(seq, 0, 0), _\n                            \"yymmddhh\")\n        .Cells(i, \"B\") = dayPart\n    Next i\nEnd With\n</code></pre>\n\n<p>After collecting the number of previous matching dates with a <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow noreferrer\">COUNTIF function</a>, the returned integer is converted to hours with <a href=\"https://msdn.microsoft.com/en-us/library/ws25fd2z%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">TimeSerial</a> and added to the <strong>hiring date</strong>. A format mask of <code>yymmddhh</code> generated the entire <strong>Emp no</strong>.</p>\n\n<p>Granted, this is limited to 24 new employee hires per day.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/E2aOD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E2aOD.png\" alt=\"emp_no_frequency\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 4460442, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/d212ed6e1333a32c85d932241fef5717?s=128&d=identicon&r=PG", "display_name": "Nabil Amer", "link": "https://stackoverflow.com/users/4460442/nabil-amer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1509964884, "creation_date": 1458101748, "last_edit_date": 1459502894, "question_id": 36026686, "link": "https://stackoverflow.com/questions/36026686/employee-serial-number-based-on-hiring-date", "title": "Employee serial Number based on hiring date", "body": "<p><a href=\"https://i.stack.imgur.com/iPCY2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iPCY2.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Please assist amending the code below. what I want to do is creating unique serial number for each employee based on their hiring date eg. on was hired on 1/13/2016 the serial number comes with the last two digital number of (year,month,day+00) that means (16011300) for the one who hired in the same day and (year,month,day+01) that means (16011301)for the second one who hired in the same day. and do the same thing for those hired on different days. see pic below first what the code do but the second what I want it to be. thanks in advance for assistance\nthe used code:</p>\n\n<pre><code>  Dim myDate As Date, i As Long, dayPart As String\n  Application.EnableEvents = False\n  For i = 2 To Rows.Count\n  If Cells(i, 5).Value &gt; 1 And Not IsEmpty(Cells(i, 5).Value) Then\n     myDate = Cells(i, 5)\n     dayPart = Format(Year(myDate), \"00\") - 2000 &amp; _\n               Format(Month(myDate), \"00\") &amp; _\n               Format(Day(myDate), \"00\") &amp; 1\n     Cells(i, 2) = dayPart\n  End If\n  Next i\n  Application.EnableEvents = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbe"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "edited": false, "score": 0, "creation_date": 1458143904, "post_id": 36026786, "comment_id": 59730531, "body": "Beautiful! thank you. If I may ask a follow up question, Where would you place the code if you wanted a label&#39;s text to dynamically change?"}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "reply_to_user": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "edited": false, "score": 1, "creation_date": 1458155423, "post_id": 36026786, "comment_id": 59738242, "body": "When you want code to run, the first thing to do is ask yourself &quot;When do I want this code to run?&quot;  The answer to that question will tell you where the code goes. If the label needs it&#39;s text to change dynamically, you need to know when that change has to happen. if, for example, it needs to happen when you click a button, then you need to create a click event handler for that button and put the code in there. Also, don&#39;t forget to mark this as the answer. Thanks!"}], "tags": [], "owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "is_accepted": true, "score": 1, "last_activity_date": 1458102403, "creation_date": 1458102403, "answer_id": 36026786, "question_id": 36026477, "link": "https://stackoverflow.com/questions/36026477/in-userform-how-to-link-the-value-of-a-textbox-dynamically-to-that-of-another-th/36026786#36026786", "title": "In Userform how to link the value of a textbox dynamically to that of another thing like Spinbutton or checkboxes", "body": "<p>Well, you are on the right track, but it would be:</p>\n\n<pre><code> Userform1.textbox1.value = spinbutton1.value\n</code></pre>\n\n<p>And, you'd want to have that code inside of the spinbutton1's change event handler.</p>\n"}], "owner": {"reputation": 115, "user_id": 5652999, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10204305671197001/picture?type=large", "display_name": "Zack Withrow", "link": "https://stackoverflow.com/users/5652999/zack-withrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 0, "accepted_answer_id": 36026786, "answer_count": 1, "score": 0, "last_activity_date": 1458102403, "creation_date": 1458100324, "last_edit_date": 1531164843, "question_id": 36026477, "link": "https://stackoverflow.com/questions/36026477/in-userform-how-to-link-the-value-of-a-textbox-dynamically-to-that-of-another-th", "title": "In Userform how to link the value of a textbox dynamically to that of another thing like Spinbutton or checkboxes", "body": "<p>I am curious how to make the value of a text box dynamically change when you select a different option button or toggle with a spin button. What I have tried so far is\n    Userform1.textbox1.value = spinbutton1</p>\n\n<p>Is there a better way to do this??</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["excel", "ribbonx", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1458102004, "post_id": 36026166, "comment_id": 59704005, "body": "the custom button is not saved by the workbook. It is in your Excel itself. All you can do is going for an open-event do get it there like <a href=\"http://stackoverflow.com/questions/8850836/how-to-add-a-custom-ribbon-tab-using-vba\">HERE</a>"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1458121260, "post_id": 36026166, "comment_id": 59713150, "body": "Have you saved the code to your personal section?"}], "owner": {"reputation": 274, "user_id": 2109956, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/079568eb4405447628919f0fcdfb8263?s=128&d=identicon&r=PG", "display_name": "Anthony Steven", "link": "https://stackoverflow.com/users/2109956/anthony-steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458098120, "creation_date": 1458098120, "last_edit_date": 1531161705, "question_id": 36026166, "link": "https://stackoverflow.com/questions/36026166/custom-excel-ribbon-button-missing", "title": "Custom Excel Ribbon Button missing", "body": "<p>I create a custom button in the excel ribbon that will call a Macro. After I save the .xlsm file and try to open it in another PC, the custom button is gone. </p>\n\n<p>What should I do to make custom button always there even when I open it in another machine? </p>\n"}, {"tags": ["excel", "vba", "random", "get"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458098076, "post_id": 36025925, "comment_id": 59702984, "body": "one question. Why can&#39;t i run the code? should i insert it to a module or somewhere? take note that i have a text box that should contain how many data should i get from the other workbook. I haven&#39;t done anything yet with the text box."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458101352, "post_id": 36025925, "comment_id": 59703811, "body": "you need to call the sub with a value like on button click <code>Macro1 TextBox1.Value</code>. you can test this in direct window (just something like <code>Macro2 12</code> to get Row 1 and 12 other random lines)"}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458105816, "post_id": 36025925, "comment_id": 59705130, "body": "sorry but i wasn&#39;t able to understand. where exactly should i put your code and how do i connect them with mine. Also, i am not familiar with calling subs. I just recorded a macro that copies all data from other workbook and that&#39;s all my code does when i click the button where my macro is assigned"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1458096287, "creation_date": 1458096287, "answer_id": 36025925, "question_id": 36025673, "link": "https://stackoverflow.com/questions/36025673/vba-to-copy-specified-random-data-from-different-workbook/36025925#36025925", "title": "VBA to copy specified random data from different workbook", "body": "<p>a \"not so smart\" way to do it would be something like this:</p>\n\n<pre><code>Sub Macro1(numRows As Long)\n  Dim a As Long, i As Long, rng As Range\n  Windows(\"sample rnd.xlsm\").Activate\n  a = Int(Rnd() * 5213) + 2\n  Set rng = Range(\"A1:L1\")\n\n  For i = 1 To numRows\n    While Not Intersect(Cells(a, 1), rng) Is Nothing\n      a = Int(Rnd() * 5213) + 2\n    Wend\n    Set rng = Union(rng, Range(\"A1:L5215\").Rows(a))\n  Next\n\n  rng.Copy\n  Sheets(\"Random Sample\").Range(\"A1\").Select\n  ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>if you are not going for a huge amount of lines... you also could put all lines in a collection and then delete one random item in it till the count reaches the number of lines you want like this (also not so smart solution):</p>\n\n<pre><code>Sub Macro2(numRows As Long)\n  Dim a As Long, myCol As New Collection, rng As Range\n  Windows(\"sample rnd.xlsm\").Activate\n\n  For a = 2 To 5215\n    myCol.Add a\n  Next\n\n  While myCol.Count &gt; numRows\n    myCol.Remove Int(Rnd() * myCol.Count) + 1\n  Wend\n\n  Set rng = Range(\"A1:L1\")\n  For a = 1 To myCol.Count\n    Set rng = Union(rng, Range(\"A1:L5215\").Rows(myCol(a)))\n  Next\n\n  rng.Copy\n  Sheets(\"Random Sample\").Range(\"A1\").Select\n  ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>if you still have questions, just ask ;)</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458112837, "post_id": 36028511, "comment_id": 59708072, "body": "getting error with this line of code       data(r, c) = data(rr, c)    Also, I can&#39;t run the code for the second time, it gives me error even if it runs successfully at the first time"}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458117352, "post_id": 36028511, "comment_id": 59710578, "body": "Thank you! But i have another question. Why is it that it is only getting 2 columns? How can i be able to get all columns? I need to get columns until column L. Also, I want to be able to use the TextBox to define how many random sample to get by inputting number in the textbox so when i click the button, the number of random sample will depend on what i input in the textbox. i hope you can help me out with this"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458118079, "post_id": 36028511, "comment_id": 59710956, "body": "The number of columns is defined by source which is &quot;$A$1:$B$10&quot; in my example. You can change it to &quot;A1:L5215&quot;. The number of samples is defined by randCount which can be changed too with the value of your textbox."}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458118685, "post_id": 36028511, "comment_id": 59711359, "body": "Anyway, I can just simply manually input the header and paste the random sample starting from the second row to not make things more complicated but i need to exclude the first row in getting sample data because it might be included"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458118827, "post_id": 36028511, "comment_id": 59711455, "body": "To get the data from an input box: <a href=\"http://stackoverflow.com/questions/21673105/get-the-value-of-a-textbox-to-a-cell\" title=\"get the value of a textbox to a cell\">stackoverflow.com/questions/21673105/&hellip;</a>"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458122338, "post_id": 36028511, "comment_id": 59713952, "body": "<a href=\"https://www.google.co.uk/webhp?hl=en#hl=en&amp;q=vba+assign++textbox+value+to+variable\" rel=\"nofollow noreferrer\">google.co.uk/&hellip;</a>"}, {"owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "edited": false, "score": 0, "creation_date": 1458545911, "post_id": 36028511, "comment_id": 59890235, "body": "Set source = Workbooks(&quot;CheckSum3.xlsm&quot;).Worksheets(&quot;Sheet17&quot;).Range(&quot;$A$&zwnj;&#8203;1:$B$10&quot;) how do i make this part of the code as dynamic range? because my data is changing everytime."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1458113489, "last_edit_date": 1458113489, "creation_date": 1458110780, "answer_id": 36028511, "question_id": 36025673, "link": "https://stackoverflow.com/questions/36025673/vba-to-copy-specified-random-data-from-different-workbook/36028511#36028511", "title": "VBA to copy specified random data from different workbook", "body": "<p>One solution would be to load the rows in an array, shuffle the rows and write the array to the target:</p>\n\n<pre><code>Sub CopyRandomRows()\n  Dim source As Range, target As Range, randCount&amp;, data(), value, r&amp;, rr&amp;, c&amp;\n\n  ' define the source to take the data\n  Set source = Workbooks(\"CheckSum3.xlsm\").Worksheets(\"Sheet17\").Range(\"$A$1:$B$10\")\n  ' define the target to paste the data\n  Set target = Workbooks(\"rnd sample draft.xlsm\").Worksheets(\"Random Sample\").Range(\"A1\")\n  ' define the number of rows to generate\n  randCount = 5\n\n  ' load the data in an array\n  data = source.value\n\n  'shuffle the rows\n  For r = 1 To randCount\n    rr = 1 + Math.Round(VBA.Rnd * (UBound(data) - 1))\n    For c = 1 To UBound(data, 2)\n      value = data(r, c)\n      data(r, c) = data(rr, c)\n      data(rr, c) = value\n    Next\n  Next\n\n  ' write the data to the target\n  target.Resize(randCount, UBound(data, 2)) = data\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6011617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6385fd327f18b779b1a6f5344b861eb?s=128&d=identicon&r=PG&f=1", "display_name": "markerbean", "link": "https://stackoverflow.com/users/6011617/markerbean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 36028511, "answer_count": 2, "score": 0, "last_activity_date": 1458113489, "creation_date": 1458094442, "last_edit_date": 1458096289, "question_id": 36025673, "link": "https://stackoverflow.com/questions/36025673/vba-to-copy-specified-random-data-from-different-workbook", "title": "VBA to copy specified random data from different workbook", "body": "<pre><code>Sub getdata()\n\n'CTRL+J\n\n    Windows(\"sample rnd.xlsm\").Activate\n    Range(\"A1:L5215\").Select\n    Range(\"A2\").Activate\n    Selection.Copy\n    Application.CutCopyMode = False\n    Selection.Copy\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"rnd sample draft.xlsm\").Activate\n    Sheets(\"Random Sample\").Select\n    Sheets(\"Random Sample\").Name = \"Random Sample\"\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>Above is my code so far. It is just copying data from another another workbook and pasting it to my specified worksheet.</p>\n\n<p>What I want is to get random data (rows) without duplicates and I always want to include the first row since it contains the header.</p>\n\n<p>Also, I want to have a text box where I can input number so that I can specify how many data to get from the other workbook. Quite new to vba. need help.</p>\n\n<p>I attached a screenshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bGJuw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bGJuw.png\" alt=\"layout\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1458094722, "post_id": 36025502, "comment_id": 59702123, "body": "Can you edit your question to include the code which calls this routine please."}, {"owner": {"reputation": 769, "user_id": 4067588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81ea12f9a566214a93474ce048ddd4fe?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose36", "link": "https://stackoverflow.com/users/4067588/mongoose36"}, "edited": false, "score": 0, "creation_date": 1458096271, "post_id": 36025502, "comment_id": 59702554, "body": "I think the checkbox is assigned to the copy_address sub. which is why it runs when he checks or un-checks the check box."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1458094757, "creation_date": 1458094757, "answer_id": 36025714, "question_id": 36025502, "link": "https://stackoverflow.com/questions/36025502/excel-make-a-checkbox-undo-operation-when-de-selected/36025714#36025714", "title": "excel, make a checkbox undo operation when de-selected", "body": "<p>There is no mention in your code of any checkbox or its current state (aka .Value). Typically, after putting an ActiveX checkbox on the worksheet, you would use Design Mode and right-click it for the <strong>View Code</strong> command.</p>\n\n<p>Once on the worksheet's code sheet in the VBE, modify the on-click handler to something like this.</p>\n\n<pre><code>Private Sub CheckBox1_Click()\n    If CheckBox1.Value Then\n        Range(\"D5:G8\").Copy Destination:=Range(\"D11\")\n        Range(\"F9:G9\").Copy Destination:=Range(\"F15\")\n    Else\n        Range(\"D11:G14\").ClearContents\n        Range(\"F15:G15\").ClearContents\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5968469, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/97a9226faaddd8823cd7b59e5cfee1ef?s=128&d=identicon&r=PG&f=1", "display_name": "C Hale", "link": "https://stackoverflow.com/users/5968469/c-hale"}, "edited": false, "score": 0, "creation_date": 1458170268, "post_id": 36025912, "comment_id": 59745977, "body": "Many thanks Guys this works perfectly. Much appreciated."}], "tags": [], "owner": {"reputation": 769, "user_id": 4067588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81ea12f9a566214a93474ce048ddd4fe?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose36", "link": "https://stackoverflow.com/users/4067588/mongoose36"}, "is_accepted": false, "score": 0, "last_activity_date": 1458096196, "creation_date": 1458096196, "answer_id": 36025912, "question_id": 36025502, "link": "https://stackoverflow.com/questions/36025502/excel-make-a-checkbox-undo-operation-when-de-selected/36025912#36025912", "title": "excel, make a checkbox undo operation when de-selected", "body": "<p>Or you can try this if you want to keep the already assigned copy_address sub.</p>\n\n<pre><code>Sub copy_address()\n'\n' copy_address Macro\nIf ActiveSheet.Shapes(\"Check Box 1\").ControlFormat.Value = 1 Then\n    ActiveSheet.Range(\"D5:G8\").Copy Destination:=ActiveSheet.Range(\"D11:G14\")\n    ActiveSheet.Range(\"F9:G9\").Copy Destination:=ActiveSheet.Range(\"F15:G15\")\nElse\n    ActiveSheet.Range(\"D11:G15\").ClearContents\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5968469, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/97a9226faaddd8823cd7b59e5cfee1ef?s=128&d=identicon&r=PG&f=1", "display_name": "C Hale", "link": "https://stackoverflow.com/users/5968469/c-hale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458096196, "creation_date": 1458093280, "last_edit_date": 1531161705, "question_id": 36025502, "link": "https://stackoverflow.com/questions/36025502/excel-make-a-checkbox-undo-operation-when-de-selected", "title": "excel, make a checkbox undo operation when de-selected", "body": "<p>I have a checkbox which copies 5 cells of a address into 5 cells below if the project address is the same as the correspondence address.\nhere is the code I have:</p>\n\n<pre><code>Sub copy_address()\n'\n' copy_address Macro\n'\n    Range(\"D5:G5\").Select\n    Selection.Copy\n    Range(\"D11:G11\").Select\n    ActiveSheet.Paste\n    Range(\"D6:G6\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"D12:G12\").Select\n    ActiveSheet.Paste\n    Range(\"D7:G7\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"D13:G13\").Select\n    ActiveSheet.Paste\n    Range(\"D8:G8\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"D14:G14\").Select\n    ActiveSheet.Paste\n    Range(\"F9:G9\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"F15:G15\").Select\n    ActiveSheet.Paste\n\n    SendKeys \"{ESC}\"\n\n    ActiveSheet.Range(\"D17\").Select\n\nEnd Sub\n</code></pre>\n\n<p>But what it does not do is undo the copy and paste when de-selected. In fact it carries out the copy and paste operation weather the box is ticked or un-ticked.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1458090621, "post_id": 36024867, "comment_id": 59701024, "body": "Direct value transfer sounds good and I suppose without the use of clipboard it&#39;s much less of a resource hog.   Using the direct value transfer code you provided I get a bunch of errors, I added it below the &quot;Set&quot; commands and have tried it without the set commands and still to no avail.  Further, the definition of the named range doesn&#39;t select the correct area. The reason I tried to use offset was because I&#39;m selecting the area below previous data. I&#39;m looking into NextRow function to see if this provides a solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1458091484, "post_id": 36024867, "comment_id": 59701226, "body": "I&#39;ve adjusted the named range definition to reflect teh full A:I width. The source ranges were created using your mashup of quoted cell reference and &#39;square bracket&#39; reference. I&#39;ve changed them to something closer to a conventional &#39;one-piece&#39; range reference."}, {"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1458091985, "post_id": 36024867, "comment_id": 59701354, "body": "Yeh I changed it to reflect the full width earlier but it doesn&#39;t hang below the previous data. For example I already have 7 data sets (of 75 rows) in there so I want to add the next data from row 527 to 601."}, {"owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "edited": false, "score": 0, "creation_date": 1458092031, "post_id": 36024867, "comment_id": 59701367, "body": "Scratch that, it works! :D Thanks for the help @Jeeped"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1458091364, "last_edit_date": 1458091364, "creation_date": 1458088822, "answer_id": 36024867, "question_id": 36024803, "link": "https://stackoverflow.com/questions/36024803/excel-vba-copying-a-static-range-into-a-dynamic-range-on-different-sheet/36024867#36024867", "title": "Excel VBA copying a static range into a dynamic range on different sheet", "body": "<p>If you are only interested in pasting the values, then a direct value transfer is more efficient and does not involve the clipboard.</p>\n\n<pre><code>with Sheets(\"IND BASKET\").Range(\"A2:I76\")\n    Sheets(\"IND TOTAL\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(.Rows.Count, .Columns.Count) = .Value\nend with\n</code></pre>\n\n<p>With your own Copy, Paste Special xlPasteValues you only need to specify the cell in the top-left corner of the destination and allow the copied area to define the size and shape.</p>\n\n<pre><code>Sheets(\"IND BASKET\").Range(\"A2:I76\").Copy\nSheets(\"IND TOTAL\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>The definition of your named range might be better without the volatile OFFSET function like,</p>\n\n<pre><code>=INDEX('IND TOTAL'!$A:$A, MATCH(\"zzz\",'IND TOTAL'!$A:$A )+1):INDEX('IND TOTAL'!$I:$I, MATCH(\"zzz\",'IND TOTAL'!$A:$A ) + 75)\n'or for just the first cell\n=INDEX('IND TOTAL'!$A:$A, MATCH(\"zzz\",'IND TOTAL'!$A:$A )+1)\n</code></pre>\n\n<p>That assumes that column A contains text which I deduced by your use of COUNTA and not COUNT. If column A contains numbers, swap 1e99 for \"zzz\".</p>\n"}], "owner": {"reputation": 103, "user_id": 5932505, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153236626947373/picture?type=large", "display_name": "Berry", "link": "https://stackoverflow.com/users/5932505/berry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 36024867, "answer_count": 1, "score": 3, "last_activity_date": 1458091364, "creation_date": 1458088349, "question_id": 36024803, "link": "https://stackoverflow.com/questions/36024803/excel-vba-copying-a-static-range-into-a-dynamic-range-on-different-sheet", "title": "Excel VBA copying a static range into a dynamic range on different sheet", "body": "<p>I'm having a few issues working this out as I'm new to VBA but I'm sure it has a pretty simple solution.</p>\n\n<p>I'm essentially wanting to automate the addition of new data to a sheet. </p>\n\n<p>Sheet: INB BASKET Cells: A2:I76 contains live links to another worksheet.\nBasically I want to copy these as Values to Sheet IND TOTAL below the latest entry on a button press (not continually updating).</p>\n\n<p>I've created a dynamic named range (PasteRange) in excel that selects the 75 rows below the last entry that I want to paste into:</p>\n\n<pre><code>=OFFSET('IND TOTAL'!$A$1,COUNTA('IND TOTAL'!$A:$A),0,75,9)\n</code></pre>\n\n<p>I've then created a module with the following:</p>\n\n<pre><code>Sub CopyRange()\nDim CopyFrom As Range\n\nSet CopyFrom = Sheets(\"IND BASKET\").Range(\"A2\", [I76])\net PasteArea = Sheets(\"IND TOTAL\").Range(\"PasteRange\")\n\nCopyFrom.Copy\nPasteArea.PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>But to no success as of yet, please advise.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145144, "post_id": 36039352, "comment_id": 59731480, "body": "I need to delete blank rows not columns and I tried the .entirerow.delete, my problem is the proper syntax using my current code.  Please help with the correct syntax. I insert the code from another example, but doesn&#39;t seem that I need that.  I need to modify or add to the following line of code to allow for the deletion of blank rows, prior to the data being updated:"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145380, "post_id": 36039352, "comment_id": 59731651, "body": "@Karen Schaefer , this doesnt delete the column, it check the whole column for any blank cells, any blank cells it finds it will delete that row"}, {"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145472, "post_id": 36039352, "comment_id": 59731737, "body": "here is where I need to delete the blank rows that seem to be added, prior to the append of the data to the worksheet:                              Set rng = sourceRange.Offset(1, 0).Resize(sourceRange.Rows.Count - 1, sourceRange.Columns.Count)  is there away to post a attachment to this comment?                                 rng.ClearContents"}, {"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145645, "post_id": 36039352, "comment_id": 59731853, "body": "Set rng = sourceRange.Offset(1, 0).Resize(sourceRange.Rows.Count - 1, sourceRange.Columns.Count)                                 rng.ClearContents                                 rng.EntireRow.Delete                             RwCount = rng.Rows.Count                         I tried this but the code has issues with   Object required error"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145701, "post_id": 36039352, "comment_id": 59731886, "body": "If you are using <code>rng.ClearContents</code> why not just change it to <code>rng.EntireRow.Delete</code>"}, {"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145954, "post_id": 36039352, "comment_id": 59732046, "body": "I need to clear the contents and then remove any blank rows.  for some reason my code does not want to post the results in column A2 each time it seems to want to add columns then goes to the end of the columns then appends the data.  Is there a way to post attachments on this website?\\"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458145997, "post_id": 36039352, "comment_id": 59732064, "body": "Which row are you going down when you are doing the <code>rng.CLearContents</code>?"}, {"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458146127, "post_id": 36039352, "comment_id": 59732155, "body": "Turns out the code has issue with the:  RwCount = rng.Rows.Count  sorry don&#39;t know how to place the code in grey area, in this section:         Set rng = sourceRange.Offset(1, 0).Resize(sourceRange.Rows.Count - 1, sourceRange.Columns.Count)                                 rng.EntireRow.Delete                             RwCount = rng.Rows.Count"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458146242, "post_id": 36039352, "comment_id": 59732231, "body": "to give text the grey back ground use ` <code>before</code> and <code>after</code> the <code>text</code>"}, {"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458146398, "post_id": 36039352, "comment_id": 59732364, "body": "How do I post an attachment here?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458146844, "post_id": 36039352, "comment_id": 59732687, "body": "Cant in comments, <a href=\"http://stackoverflow.com/editing-help#comment-formatting\">stackoverflow.com/editing-help#comment-formatting</a> is what you can do in comments"}, {"owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458147160, "post_id": 36039352, "comment_id": 59732957, "body": "Mr Burns,  thanks for your assistance.  Should I open a new question regarding modifying my code to make sure that the data is always placed in the table area of the worksheet?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "reply_to_user": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1458147821, "post_id": 36039352, "comment_id": 59733466, "body": "Yea that would be a new question"}], "tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1458141309, "last_edit_date": 1458141309, "creation_date": 1458140396, "answer_id": 36039352, "question_id": 36024763, "link": "https://stackoverflow.com/questions/36024763/delete-blank-rows-from-excel-table/36039352#36039352", "title": "Delete blank rows from Excel table", "body": "<p>Not sure if this is what you are after but it will delete all the rows which have a blank cell in column A</p>\n\n<pre><code>Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>A quick explination <code>Columns(\"A:A\")</code> is the target column, change the letter and add numbers or varibles as you wish. <code>.SpecialCells(xlCellTypeBlanks)</code> is what cell it will target, in this case it will be the blank cells (record a macro and press <code>Ctrl + G</code> for any variations you need). And lastly <code>.EntireRow.Delete</code> will delete the target row(s).</p>\n\n<p>So it will look in column A, and if there is any blank cells in column A it will delete that row.</p>\n\n<p>Hope this helps, leave a comment if you need anything clarifed</p>\n"}], "owner": {"reputation": 17, "user_id": 5530818, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/70c9cb45ae885b4d545fa265c0bdd780?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/5530818/karen-schaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459501622, "creation_date": 1458088113, "last_edit_date": 1459501622, "question_id": 36024763, "link": "https://stackoverflow.com/questions/36024763/delete-blank-rows-from-excel-table", "title": "Delete blank rows from Excel table", "body": "<p>I have code the merges multiple excel workbooks together, and updates the data into another workbook \"Master\", however, when it paste the data into the master it leaves numerous blank rows prior to the insert of the data table.</p>\n\n<p>I have tried various posted solutions, however, when I incorporate the new code it is failing.  I could use some assistances in modifying my code to handle the removal of the inserted blank rows in my table, prior to the data being updated.</p>\n\n<p>See '>>>>>>>>> marked in the code.</p>\n\n<pre><code>Public Function MergeMultipleSheets()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, FNum As Long\n    Dim myBook As Workbook, wbMaster As Workbook\n    Dim BaseWks As Worksheet, ws As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n    Dim rng As Range, SearchValue As String\n    Dim FilterField As Integer, RangeAddress As String\n    Dim ShName As Variant, ShNames As Variant, RwCount As Long, nName As Variant\n    Dim nFilter As String\n    Dim currentrow As Long\n    Dim LastRow As Long\n\n    MyPath = ThisWorkbook.Sheets(\"Data Input\").Range(\"B1\")\n '   ShNames = Array(\"ProjSum\", \"FinSum\", \"CommSum\", \"InvPlan\", \"ResPlan_Data\")\n    ShNames = Array(\"ProjSum\", \"ResPlan_Data\")\n\n    Set wbMaster = ActiveWorkbook\n    '**********************************************************\n    'Merge data into existing worksheets in this workbook\n    '**********************************************************\n\n    ' Add a slash after MyPath if needed.\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n   ' If there are no Excel files in the folder, exit.\n    'FilesInPath = Dir(MyPath &amp; \"week*.xl*\")\n\n    nFilter = ThisWorkbook.Sheets(\"Data Input\").Range(\"B2\")\n    If nFilter = \"\" Or FilesInPath = \"\" Then\n        FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    End If\n\n    ' Fill the myFiles array with the list of Excel files in the\n    ' folder.\n    FNum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        FNum = FNum + 1\n        ReDim Preserve MyFiles(1 To FNum)\n        MyFiles(FNum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    ' Change application properties.\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n        ' Clear data from summary worksheets\n        For Each ShName In ShNames\n            Set rng = Nothing\n            On Error Resume Next\n            Set rng = wbMaster.Worksheets(ShName).UsedRange\n            On Error GoTo 0\n            If Not rng Is Nothing Then\n                'Don't delete header labels in the first row\n                Set rng = rng.Offset(1, 0)\n            End If\n        Next\n\n    rnum = 1\n\n    ' Loop through all files in the myFiles array.\n    If FNum &gt; 0 Then\n        For FNum = LBound(MyFiles) To UBound(MyFiles)\n            Set myBook = Nothing\n            On Error Resume Next\n            Set myBook = Workbooks.Open(MyPath &amp; MyFiles(FNum), UpdateLinks:=0)\n\n        '**************************************************************************************************\n        'Removes unused Named Ranges from Name Manager from the Various JC files to prevent error dialogs.\n        '**************************************************************************************************\n               For Each nName In Names\n                    If InStr(1, nName.RefersTo, \"#REF!\") &gt; 0 Then\n                        nName.Delete\n                    End If\n                    If InStr(1, nName.RefersTo, \"https://\") &gt; 0 Then\n                        nName.Delete\n                    End If\n                Next nName\n            On Error GoTo 0\n\n            If Not myBook Is Nothing Then\n\n                For Each ShName In ShNames\n                    Set ws = Nothing\n                    On Error Resume Next\n                    Set ws = myBook.Worksheets(ShName)\n                    On Error GoTo 0\n     '****************************************************************************************************************************\n    'Calls function to update ResPlan in active workbook\n    'Executes Updating of the ResPlan data to proper format for extraction of data in correct format\n    '****************************************************************************************************************************\n                    If ShName = \"ResPlan_Data\" Then\n                        Call UnpivotResPlan\n                        myBook.Save\n                    End If\n\n                        '**************************************************\n                        'Updates template data per shName\n                        '*************************************************\n'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n                        If Not ws Is Nothing Then\n                            Set BaseWks = wbMaster.Worksheets(ShName)\n                            Set sourceRange = ws.UsedRange\n                            'Exclude header labels\n                            Set rng = sourceRange.Offset(1, 0).Resize(sourceRange.Rows.Count - 1, sourceRange.Columns.Count)\n                                rng.ClearContents\nDim rngBlanks As Excel.Range\n\n    With wbMaster.Worksheets(ShName).ListObjects(\"Res_Plan_Data\")\n        On Error Resume Next\n        Set rngBlanks = Intersect(.DataBodyRange, .ListColumns(\"New\").Range).SpecialCells(xlCellTypeBlanks)\n        On Error GoTo 0\n        If Not rngBlanks Is Nothing Then\n            rngBlanks.Delete\n        End If\n    End With\n                            RwCount = rng.Rows.Count\n                            rnum = BaseWks.Cells(BaseWks.Rows.Count, 1).End(xlUp).Row + 1\n\n                            BaseWks.Cells(rnum, \"A\").Resize(RwCount).Value _\n                                  = myBook.Name\n                            BaseWks.Cells(rnum, \"B\").Resize(RwCount, rng.Columns.Count).Value = rng.Value\n                        End If\n                Next\n\n               ' Close the workbook without saving.\n                 myBook.Close savechanges:=True\n             End If\n\n            ' Open the next workbook.\n        Next FNum\n\n        ' Set the column width in the new workbook.\n        BaseWks.Columns.AutoFit\n\n        'Prepares Salary Detail for Updating.\n        Call UnpivotSalaryDetail\n\n    End If\n        Call Reset\n       ' ActiveWorkbook.Model.Refresh\n\n        If Worksheets(\"Resplan_Data\").Visible = True Then\n            Worksheets(\"Resplan_Data\").Visible = False\n        End If\n        MsgBox \"Update completed!\"\n\n    ' Restore the application properties.\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Function\n\n\nSub ClearBlankCellsInColumnNew()\nDim rngBlanks As Excel.Range\n\n    With Worksheets(\"ResPlan_Data\").ListObjects(\"Res_Plan_Data\")\n        On Error Resume Next\n        Set rngBlanks = Intersect(.DataBodyRange, .ListColumns(\"New\").Range).SpecialCells(xlCellTypeBlanks)\n        On Error GoTo 0\n        If Not rngBlanks Is Nothing Then\n            rngBlanks.Delete\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink", "userform"], "comments": [{"owner": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "edited": false, "score": 0, "creation_date": 1458099765, "post_id": 36023034, "comment_id": 59703409, "body": "re: <i>put the output in a userform input box?</i>   What do you mean by that? and re : <i>.. and edit it so I can?</i> its feel like this sentence not complete..i mean <i>so I can</i> what?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458105493, "post_id": 36023034, "comment_id": 59705015, "body": "You could select an empty cell, allow the dialog to complete, then pull the hyperlink out from the cell if one was added."}, {"owner": {"reputation": 11, "user_id": 3609802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19f18a7b329663ed254bc396023580b?s=128&d=identicon&r=PG&f=1", "display_name": "user3609802", "link": "https://stackoverflow.com/users/3609802/user3609802"}, "edited": false, "score": 0, "creation_date": 1458176983, "post_id": 36023034, "comment_id": 59748052, "body": "Of course! Thank you Tim."}], "owner": {"reputation": 11, "user_id": 3609802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19f18a7b329663ed254bc396023580b?s=128&d=identicon&r=PG&f=1", "display_name": "user3609802", "link": "https://stackoverflow.com/users/3609802/user3609802"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458079163, "creation_date": 1458079163, "question_id": 36023034, "link": "https://stackoverflow.com/questions/36023034/use-excel-vba-hyperlink-form-to-add-link-to-userform", "title": "use Excel VBA Hyperlink form to add link to userform", "body": "<p>so I've figured out that this line of code:</p>\n\n<p>Application.Dialogs(xlDialogInsertHyperlink).Show </p>\n\n<p>will bring up the add hyperlink form. However, this form exclusively outputs the link to the selected cell. I was wondering if there was a way to put the output in a userform input box? If not, is there a way I can view the default InsertHyperlink form and edit it so I can? Thank you for your response!</p>\n"}, {"tags": ["vba", "excel", "cmd"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1458079274, "post_id": 36022976, "comment_id": 59697222, "body": "I think you are missing the quotes sign in the string. Shouldn&#39;t the Immediate window output the string without the <code>&quot;</code> character ?"}, {"owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1458079667, "post_id": 36022976, "comment_id": 59697406, "body": "@Santosh Without the quotes around %ProgramFiles(x86)%\\TextPad 5\\TextPad.exe, the command doesn&#39;t run in a shell window."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1458090391, "post_id": 36022976, "comment_id": 59700973, "body": "It might be the percentage sign that needs escaping. If you remove them and give entire full path, does Excel VBA Shell work?"}], "answers": [{"tags": [], "owner": {"reputation": 763, "user_id": 4822084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd50faf356acb4de8f507832d917a2?s=128&d=identicon&r=PG&f=1", "display_name": "Susilo", "link": "https://stackoverflow.com/users/4822084/susilo"}, "is_accepted": true, "score": 2, "last_activity_date": 1458099081, "creation_date": 1458099081, "answer_id": 36026304, "question_id": 36022976, "link": "https://stackoverflow.com/questions/36022976/excel-vba-shell-command-with-spaces-in-file-path/36026304#36026304", "title": "Excel VBA Shell command with spaces in file path", "body": "<p>Use <code>Environ</code> function to get Special Folders</p>\n\n<pre><code>pathSpecial = Environ(\"ProgramFiles(x86)\")\nshellCommand = \"\"\"\" &amp; pathSpecial  &amp; \"\\TextPad 5\\TextPad.exe\"\" -r -q -u \"\"\" &amp; filePath &amp; agingsEntry &amp; \"\"\" -u \"\"\" &amp; filePath &amp; invenEntry &amp; \"\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4339, "favorite_count": 0, "accepted_answer_id": 36026304, "answer_count": 1, "score": 1, "last_activity_date": 1458099081, "creation_date": 1458078941, "last_edit_date": 1531164843, "question_id": 36022976, "link": "https://stackoverflow.com/questions/36022976/excel-vba-shell-command-with-spaces-in-file-path", "title": "Excel VBA Shell command with spaces in file path", "body": "<pre><code>Public Sub openEntryFiles()\nDim filePath, shellCommand, agingsEntry, invenEntry As String\nfilePath = Range(\"CustomerPath\").Value2 &amp; \"\\files\\\"\nagingsEntry = \"agings\\entry_EP.bat\"\ninvenEntry = \"inven\\entry_EP.bat\"\n\nshellCommand = \"\"\"%ProgramFiles(x86)%\\TextPad 5\\TextPad.exe\"\" -r -q -u \"\"\" &amp; filePath &amp; agingsEntry &amp; \"\"\" -u \"\"\" &amp; filePath &amp; invenEntry &amp; \"\"\"\"\nDebug.Print shellCommand\nShell shellCommand, 0\nEnd Sub\n</code></pre>\n\n<p>I am trying to write a subroutine that will run a shell command with spaces in the file path. I have done lots of research about using multiple quotes, but I still get a file not found error whenever I run the code. The debug print that is outputted to the Immediate window reads:</p>\n\n<pre><code>\"%ProgramFiles(x86)%\\TextPad 5\\TextPad.exe\" -r -q -u \"\\\\ablsgaat002\\aclwin\\Clients\\*****\\files\\agings\\entry_EP.bat\" -u \"\\\\ablsgaat002\\aclwin\\Clients\\*****\\files\\inven\\entry_EP.bat\"\n</code></pre>\n\n<p>Copying that string into a shell window works great, however, running it from the Shell command in VBA doesn't work. What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel", "integer-overflow"], "comments": [{"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458079220, "post_id": 36022946, "comment_id": 59697193, "body": "Why don&#39;t you use a Long type instead?"}, {"owner": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "reply_to_user": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458079363, "post_id": 36022946, "comment_id": 59697261, "body": "I&#39;m translating some code from C that relies heavily on overflow for angle calculations. It stores angles as 2 byte integers."}, {"owner": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "reply_to_user": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458079786, "post_id": 36022946, "comment_id": 59697453, "body": "Basically <a href=\"http://www.ozgrid.com/forum/showthread.php?t=72602\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 4463, "user_id": 1769887, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YDowu.jpg?s=128&g=1", "display_name": "MikeDub", "link": "https://stackoverflow.com/users/1769887/mikedub"}, "edited": false, "score": 0, "creation_date": 1458088062, "post_id": 36022946, "comment_id": 59703835, "body": "Duplicate of <a href=\"http://stackoverflow.com/questions/26659256/how-to-turn-off-overflow-check-in-vba-for-ms-access\">this article</a> pretty much."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1458080305, "post_id": 36023267, "comment_id": 59697702, "body": "Misses the point.  From OP <i>I want myFunc() to return <b>-30536</b></i>"}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1458080821, "post_id": 36023267, "comment_id": 59697923, "body": "@chrisneilsen Thanks for your comment: please see the extended answer. Best regards,"}, {"owner": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "edited": false, "score": 0, "creation_date": 1458083401, "post_id": 36023267, "comment_id": 59698863, "body": "The error handling is intriguing but is it tied to the function itself? I would want this to work for all modules."}, {"owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "edited": false, "score": 0, "creation_date": 1458088445, "post_id": 36023267, "comment_id": 59700475, "body": "You can add the Overflow Error handling to any Function or Sub (I guess this is what you mean by &quot;all modules&quot;). You can, for example, create a Global Function and place it in a Code Module to make it universally accessible from any Worksheet module, etc. Hope this may help. Best regards,"}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1458081715, "last_edit_date": 1458081715, "creation_date": 1458080052, "answer_id": 36023267, "question_id": 36022946, "link": "https://stackoverflow.com/questions/36022946/is-it-possible-to-allow-integer-overflow-in-excel-vba/36023267#36023267", "title": "Is it possible to allow Integer Overflow in Excel VBA?", "body": "<p>In order to prevent <code>Integer</code> overflow in your Excel VBA code, you may use the custom <code>Function</code> to perform the <code>Integer</code> to <code>Long</code> type casting like shown below:</p>\n\n<pre><code>Sub TestIntegerConversion()\n    Debug.Print myFuncLong(20000, 15000)\nEnd Sub\n\nFunction myFuncLong(a As Integer, b As Integer) As Long\n    myFuncLong = CLng(a) + CLng(b)\nEnd Function\n</code></pre>\n\n<p>or without using custom Function in a simple form like this:</p>\n\n<pre><code>Sub PreventOverflow()\n    Dim a As Integer\n    Dim b As Integer\n    a = 20000\n    b = 15000\n\n    Debug.Print CLng(a) + CLng(b)\nEnd Sub\n</code></pre>\n\n<p>Alternatively, you may write your own custom function, which should implement that \"overflow math\" (you have somehow to specify using plain math notation how to get the number -30536 from 35000) and return the result either as <code>Long</code>, or <code>String</code>. Possible implementation is shown below (note: Overflow exception number is 6)</p>\n\n<pre><code>Sub OverflowCustomMath()\n    Dim a As Integer\n    Dim b As Integer\n    Dim c As Long\n    a = 20000\n    b = 15000\n\nOn Error GoTo Err:\n    Debug.Print a + b\nErr:\n    If (Err.Number = 6) Then\n        'apply your custom overflow math, as for e.g.\n        Debug.Print CLng(a) + CLng(b)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Hope this may help.</p>\n"}, {"tags": [], "owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1458081867, "creation_date": 1458081867, "answer_id": 36023668, "question_id": 36022946, "link": "https://stackoverflow.com/questions/36022946/is-it-possible-to-allow-integer-overflow-in-excel-vba/36023668#36023668", "title": "Is it possible to allow Integer Overflow in Excel VBA?", "body": "<p>Use typical VBA error handler but tests for your case.</p>\n\n<pre><code>            Option Explicit\n\n            Sub test()\n                MsgBox myFunc\n            End Sub\n\n            Function myFunc()\n            On Error GoTo Local_err\n                Dim a As Integer\n                Dim b As Integer\n                Dim c As Integer\n\n                a = 20000\n                b = 15000\n                c = a + b\n\n                myFunc = c\nLocal_exit:\n                Exit Function\nLocal_err:\n                If Err = 6 Then\n                    myFunc = -30536\n                Else\n                    MsgBox Err &amp; \" \" &amp; Err.Description\n                    '  myFunc = whatever error value to return\n                End If\n                Resume Local_exit\n            End Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "edited": false, "score": 0, "creation_date": 1458699798, "post_id": 36023861, "comment_id": 59974520, "body": "Yeah, that&#39;s basically what I ended up doing, with separate functions for addition and subtraction. Not what I was hoping for, but at least it works."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "edited": false, "score": 0, "creation_date": 1458700240, "post_id": 36023861, "comment_id": 59974633, "body": "You could get away with only one function, by negating a parameter, eg <code>a-b</code> = <code>MuFunc(a, -b)</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "edited": false, "score": 0, "creation_date": 1458700470, "post_id": 36023861, "comment_id": 59974695, "body": "Yes, for that edge case"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1458087460, "last_edit_date": 1458087460, "creation_date": 1458082871, "answer_id": 36023861, "question_id": 36022946, "link": "https://stackoverflow.com/questions/36022946/is-it-possible-to-allow-integer-overflow-in-excel-vba/36023861#36023861", "title": "Is it possible to allow Integer Overflow in Excel VBA?", "body": "<p>I would suggest writing <code>MyFunc</code> to do the math as Long, and test for integer \"overflow\" and adjust </p>\n\n<pre><code>Function MyFunc(a As Integer, b As Integer) As Integer\n    Dim sum As Long\n    Const Mask As Integer = -1\n\n    sum = CLng(a) + CLng(b)\n    If sum &gt; 32767 Then\n        sum = sum - 65536\n    ElseIf sum &lt; -32768 Then\n        sum = sum + 65536\n    End If\n    MyFunc = sum\nEnd Function\n</code></pre>\n\n<p>Test with</p>\n\n<pre><code>Sub zx()\n    Debug.Print MyFunc(20000, 15000)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 3866205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0b10a0ba3cb7140fa72d6014b34aa16f?s=128&d=identicon&r=PG&f=1", "display_name": "knockonwood", "link": "https://stackoverflow.com/users/3866205/knockonwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1459501560, "creation_date": 1458078825, "last_edit_date": 1459501560, "question_id": 36022946, "link": "https://stackoverflow.com/questions/36022946/is-it-possible-to-allow-integer-overflow-in-excel-vba", "title": "Is it possible to allow Integer Overflow in Excel VBA?", "body": "<p>Pretty simple, but I couldn't find anything by Googling. An example of what I want to happen:</p>\n\n<pre><code>Function myFunc()\n    Dim a As Integer\n    Dim b As Integer\n    Dim c As Integer\n\n    a = 20000\n    b = 15000\n    c = a + b\n\n    myFunc = c\nEnd Function\n</code></pre>\n\n<p>I want myFunc() to return -30536 instead of throwing an overflow exception. I know I could write a function that does that, but I've written a bunch of code for a project with the assumption that overflow was allowed, so I'm hoping there's a quick fix.</p>\n\n<p>EDIT: I don't need help coming up with a function that solves the overflow issue with type conversions. I have one already; I just want to avoid changing hundreds of addition and subtraction operations. I'm also bit frustrated that VBA seems to go out of its way to disable overflow functionality--it should let the user decide if they want to use it or not.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1458144319, "post_id": 36022595, "comment_id": 59730854, "body": "Your asking to move copy only if the mail item is flagged? Automatically or by selecting?"}, {"owner": {"reputation": 39, "user_id": 4441145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/451117b9e1bda86c7fe78cb8a21d994c?s=128&d=identicon&r=PG&f=1", "display_name": "mpstring", "link": "https://stackoverflow.com/users/4441145/mpstring"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1458144760, "post_id": 36022595, "comment_id": 59731203, "body": "By selecting.  If there is an email that is in my inbox and I click the flag to the right, I want it to make a copy of the flagged email and put it in a folder.  I want it to be automatic every time I flag an email."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4441145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/451117b9e1bda86c7fe78cb8a21d994c?s=128&d=identicon&r=PG&f=1", "display_name": "mpstring", "link": "https://stackoverflow.com/users/4441145/mpstring"}, "edited": false, "score": 0, "creation_date": 1458220828, "post_id": 36049088, "comment_id": 59770056, "body": "I&#39;m not sure if I implemented this correctly.  I created a macro and inserted the code and tested it and nothing happened.  I saved the macro, closed Outlook, reopened it and ran the macro again and still nothing.  Could you tell me where &#39;ThisOutLookSession&#39; is located?"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1460528231, "last_edit_date": 1460528231, "creation_date": 1458171828, "answer_id": 36049088, "question_id": 36022595, "link": "https://stackoverflow.com/questions/36022595/outlook-macro-that-will-copy-an-email-i-flag-and-put-it-in-a-folder/36049088#36049088", "title": "Outlook Macro that will copy an email I flag and put it in a folder", "body": "<p>I think this is what your trying to do, add the following code to <strong><em><code>ThisOutlookSession</code></em></strong> and then restart your outlook.</p>\n\n<p>Code will automatically move copy of flagged Mailitem</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olFolder  As Outlook.MAPIFolder\n\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNameSpace.GetDefaultFolder(olFolderInbox) \n    Set Items = olFolder.Items\nEnd Sub\n\nPrivate Sub Items_ItemChange(ByVal Item As Object)\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olFolder  As Outlook.MAPIFolder\n    Dim olInbox  As Outlook.MAPIFolder\n    Dim ItemCopy As MailItem\n\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olInbox = olNameSpace.GetDefaultFolder(olFolderInbox)\n    Set olFolder = olInbox.Folders(\"Follow Up\")\n\n    If TypeOf Item Is Outlook.MailItem Then\n        Debug.Print Item\n\n        If Item.FlagStatus = olFlagMarked Then\n            Set ItemCopy = Item.Copy ' Copy Flagged item\n             ItemCopy.Move olFolder ' Move Copied item\n        End If\n\n        Set Item = Nothing\n        Set ItemCopy = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p>Press <strong><code>Alt+F11</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/SIo52.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SIo52.png\" alt=\"enter image description here\"></a></p>\n\n<p>double click <strong><code>ThisOutlookSession</code></strong> and paste the code in there, then restart your outlook and flag your mail item.</p>\n"}], "owner": {"reputation": 39, "user_id": 4441145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/451117b9e1bda86c7fe78cb8a21d994c?s=128&d=identicon&r=PG&f=1", "display_name": "mpstring", "link": "https://stackoverflow.com/users/4441145/mpstring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2051, "favorite_count": 1, "accepted_answer_id": 36049088, "answer_count": 1, "score": 1, "last_activity_date": 1593518960, "creation_date": 1458077548, "last_edit_date": 1593518960, "question_id": 36022595, "link": "https://stackoverflow.com/questions/36022595/outlook-macro-that-will-copy-an-email-i-flag-and-put-it-in-a-folder", "title": "Outlook Macro that will copy an email I flag and put it in a folder", "body": "<p>How can I move copy of emails I flag and put them in a folder?</p>\n\n<p>For example, John Doe sends me an email, I flag it, the original email stays in my inbox but a copy of the email goes into a folder called <strong><code>\"Follow Up\"</code></strong>.  Can someone help me?  </p>\n\n<p><strong>EDIT:</strong> </p>\n\n<p>The code below is extremely close to what I want but it's moving the original email to the folder instead of a copy.  It's also not targeting the flagged email.</p>\n\n<pre><code>Sub FollowUp()\nOn Error Resume Next\n\nDim ns As Outlook.NameSpace\nDim moveToFolder As Outlook.MAPIFolder\nDim objItem As Outlook.MailItem\n\n\n\nSet ns = Application.GetNamespace(\"MAPI\")\n\n'Define path to the target folder\nSet moveToFolder = ns.Folders(\"MainFolder\").Folders(\"Inbox\").Folders(\"Follow Up\")\n\nIf Application.ActiveExplorer.Selection.Count = 0 Then\nMsgBox (\"No item selected\")\nExit Sub\nEnd If\n\nIf moveToFolder Is Nothing Then\nMsgBox \"Target folder not found!\", vbOKOnly + vbExclamation, \"Move Macro Error\"\nEnd If\n\nFor Each objItem In Application.ActiveExplorer.Selection\nIf moveToFolder.DefaultItemType = olMailItem Then\n  If objItem.Class = olMail Then\n     objItem.Move moveToFolder\n  End If\nEnd If\nNext\n\nSet objItem = Nothing\nSet moveToFolder = Nothing\nSet ns = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "fibonacci"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458077827, "post_id": 36022510, "comment_id": 59696514, "body": "<code>Return</code> isn&#39;t used in VBA"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458077883, "post_id": 36022510, "comment_id": 59696544, "body": "@TimWilliams <i>shouldn&#39;t be</i>. I hope it&#39;s not used anymore. Truly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458077919, "post_id": 36022510, "comment_id": 59696567, "body": "I guess I should have clarified <i>in that context</i>  ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 2, "creation_date": 1458078015, "post_id": 36022681, "comment_id": 59696621, "body": "(hold your breath and pinch your nose) . LOL +1"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 1, "creation_date": 1458078201, "post_id": 36022681, "comment_id": 59696717, "body": "Wow, that <code>GoSub</code> brought back memories of 25 years ago."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1458079933, "last_edit_date": 1458079933, "creation_date": 1458077849, "answer_id": 36022681, "question_id": 36022510, "link": "https://stackoverflow.com/questions/36022510/vba-thinks-return-is-a-variable/36022681#36022681", "title": "VBA thinks Return is a variable", "body": "<p>A VBA function's return value isn't returned with the <code>Return</code> keyword.</p>\n\n<p>In fact, the only valid usage of <code>Return</code> as a keyword is to return from a <code>GoSub</code> jump:</p>\n\n<pre><code>    foo = 42\n    GoSub DoSomething\n    Debug.Print foo\n\nDoSomething:\n    foo = foo / 2\n    Return\n</code></pre>\n\n<p>The <code>GoSub</code> jumps to the <code>DoSomething</code> label, divides <code>foo</code> by 2 and <em>returns</em> to the calling subroutine, to output 21 to the debug/immediate pane.</p>\n\n<p>An archaic keyword and construct that predates the introduction of actual <code>Sub</code> and <code>Function</code> constructs.</p>\n\n<p>So how does a function return then?</p>\n\n<p>By... (hold your breath and pinch your nose) ... <em>assigning to the function's identifier</em>:</p>\n\n<pre><code>Function GetFoo() As Integer\n    GetFoo = 42\nEnd Function\n</code></pre>\n\n<p>Same for property getters:</p>\n\n<pre><code>Property Get Foo() As Integer\n    Foo = 42\nEnd Property\n</code></pre>\n\n<p>The best part? Doing that doesn't <em>return</em>. It determines the <em>return value</em>. If you need to exit immediately (say, because there's other code that would run otherwise), you need to use <code>Exit Function</code>.</p>\n\n<pre><code>Function GetFoo() As Integer\n    GetFoo = 42\n    Exit Function\n    Debug.Print \"dead code here\"\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": false, "score": 0, "last_activity_date": 1458078074, "creation_date": 1458078074, "answer_id": 36022757, "question_id": 36022510, "link": "https://stackoverflow.com/questions/36022510/vba-thinks-return-is-a-variable/36022757#36022757", "title": "VBA thinks Return is a variable", "body": "<p>When you want to return the value of the function, you would set that value to the name of the function like below:</p>\n\n<pre><code>function fibonacci(n)\n  if n &lt; 2 then\n    fibonacci = n\n  else\n    fibonacci = fibonacci(n-1) + fibonacci(n-2)\n  end if        \nEnd function\n</code></pre>\n\n<p>Your function has a logical error though, your for loop is returning termo + 1 elements because you are including elements 0, 1, 2, and 3. So you could set your for loop to go from 0 to termo-1.</p>\n"}, {"tags": [], "owner": {"reputation": 5726, "user_id": 5969411, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e12d84a1f74d9acd8afab1d679aca89?s=128&d=identicon&r=PG", "display_name": "ManoDestra", "link": "https://stackoverflow.com/users/5969411/manodestra"}, "is_accepted": false, "score": 0, "last_activity_date": 1458078429, "creation_date": 1458078429, "answer_id": 36022854, "question_id": 36022510, "link": "https://stackoverflow.com/questions/36022510/vba-thinks-return-is-a-variable/36022854#36022854", "title": "VBA thinks Return is a variable", "body": "<p>Change to...</p>\n\n<pre><code>Function fibonacci(n)\n    If n &lt; 1 Then\n        fibonacci = n\n    Else\n        fibonacci = n + fibonacci(n - 1)\n    End if        \nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3191601, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XvzWO.jpg?s=128&g=1", "display_name": "Msalvatori", "link": "https://stackoverflow.com/users/3191601/msalvatori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 36022681, "answer_count": 3, "score": 1, "last_activity_date": 1458169435, "creation_date": 1458077232, "last_edit_date": 1458169435, "question_id": 36022510, "link": "https://stackoverflow.com/questions/36022510/vba-thinks-return-is-a-variable", "title": "VBA thinks Return is a variable", "body": "<p>I was trying to make fibonacci in a recursive way like this:</p>\n\n<pre><code>Option Explicit\nDim n, contador, termo\n\nfunction fibonacci(n)\n  if n &lt; 2 then\n    Return n\n  else\n    Return fibonacci(n-1) + fibonacci(n-2)\n  end if        \nEnd function\n\ntermo = InputBox(\"Diga ate que termo vai a sequencia de fibonacci\")*1\n\nfor contador = 0 to termo\n  MsgBox fibonacci(contador)\nnext\n</code></pre>\n\n<p>But I am getting the error: Variable not defined: 'Return'\nWhat is wrong with my code?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1458118504, "post_id": 36022414, "comment_id": 59711220, "body": "In your example, how does <code>0000000- First code &lt;12&gt; take a trip</code> becomes <code>First code &lt;$**.00&gt; take a trip**</code> ? Why <code>$**.00</code>?"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1458118534, "post_id": 36022414, "comment_id": 59711238, "body": "For us to help, you must at least show us you tried something, and the errors you got."}, {"owner": {"reputation": 1, "user_id": 6068526, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-414EmLDJ5gU/AAAAAAAAAAI/AAAAAAAAAD8/Te-pphMtzuQ/photo.jpg?sz=128", "display_name": "Naveen Sagar", "link": "https://stackoverflow.com/users/6068526/naveen-sagar"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1458129875, "post_id": 36022414, "comment_id": 59719215, "body": "I have tried the code , and it has removed all special characters and numbers"}, {"owner": {"reputation": 1, "user_id": 6068526, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-414EmLDJ5gU/AAAAAAAAAAI/AAAAAAAAAD8/Te-pphMtzuQ/photo.jpg?sz=128", "display_name": "Naveen Sagar", "link": "https://stackoverflow.com/users/6068526/naveen-sagar"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1458130646, "post_id": 36022414, "comment_id": 59719763, "body": "Dim RE As Object         Dim rng As Range         If Range(&quot;A2&quot;) &lt;&gt; &quot;&quot; Then           Range(&quot;A2&quot;).Select           Set RE = CreateObject(&quot;VBScript.RegExp&quot;)      With RE          .Global = True          .Pattern = &quot;[^a-zA-Z&gt;&lt;= ]&quot;                 For Each rng In Sheets(&quot;All_Errors&quot;).Range(&quot;B2:B40000&quot;).SpecialCells(xlCellT&zwnj;&#8203;ypeConstants)                                       rng.Value = .Replace(rng.Value, &quot;&quot;)              rng.Value = Trim(rng.Value)         Next rng      End With"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6068526, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-414EmLDJ5gU/AAAAAAAAAAI/AAAAAAAAAD8/Te-pphMtzuQ/photo.jpg?sz=128", "display_name": "Naveen Sagar", "link": "https://stackoverflow.com/users/6068526/naveen-sagar"}, "edited": false, "score": 0, "creation_date": 1458132977, "post_id": 36033298, "comment_id": 59721547, "body": "Hi Thanks a lot this coding is working fine for me, but i need to make little changes in this, I will make those changes to my requirement and If I need more help, I will contact you."}, {"owner": {"reputation": 1, "user_id": 6068526, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-414EmLDJ5gU/AAAAAAAAAAI/AAAAAAAAAD8/Te-pphMtzuQ/photo.jpg?sz=128", "display_name": "Naveen Sagar", "link": "https://stackoverflow.com/users/6068526/naveen-sagar"}, "edited": false, "score": 0, "creation_date": 1458154323, "post_id": 36033298, "comment_id": 59737604, "body": "I ran the same code and altered little for my requirement but i am facing a problem in this. for example, I am having a string which starts with &quot;1st car is red&quot; here i need the output as &quot;1st car is red&quot; but i am getting output as &quot;st car is red&quot;."}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "reply_to_user": {"reputation": 1, "user_id": 6068526, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-414EmLDJ5gU/AAAAAAAAAAI/AAAAAAAAAD8/Te-pphMtzuQ/photo.jpg?sz=128", "display_name": "Naveen Sagar", "link": "https://stackoverflow.com/users/6068526/naveen-sagar"}, "edited": false, "score": 0, "creation_date": 1458198083, "post_id": 36033298, "comment_id": 59754672, "body": "Hi, this is what I understood from your requirements: the leading numbers had to be removed: <i>I need to remove prefixed special character, numbers in a string</i>; and this is what your example shows when <code>12#- First code 12 &#47;05</code> becomes <code>First code **&#47;**</code> . Now if you want something a little more specific, please <b>accept my first answer</b> and comment your question about possible special cases."}], "tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 0, "last_activity_date": 1458124879, "last_edit_date": 1495542687, "creation_date": 1458124879, "answer_id": 36033298, "question_id": 36022414, "link": "https://stackoverflow.com/questions/36022414/vba-code-to-remove-special-charectors/36033298#36033298", "title": "VBA code to Remove Special charectors", "body": "<p>This is good for me to work a little on regexp, so here is how you could do what you want --- I write the first \"code-and-special-chars\" part in cell B, use cell C as a temporary so that it does not look too magical, and result will be in column D:</p>\n\n<pre><code>Public Sub that()\n    mySheet = \"regexp\"\n    Dim strInput As String\n    Dim re As Object\n    Set re = CreateObject(\"VBScript.RegExp\")\n\n    Set Myrange = ThisWorkbook.Sheets(mySheet).Range(\"A1:A1000\")\n'    re.Pattern = ThisWorkbook.Sheets(mySheet).Cells(1, 8).Value\n    re.Pattern = \"([^a-zA-Z \\r\\t\\n\\f]*)(.*)(.*)\"\n    For Each C In Myrange\n        If re.Pattern &lt;&gt; \"\" Then\n            strInput = C.Value    \n            If re.test(strInput) Then\n                C.Offset(0, 1) = re.Replace(strInput, \"$1\")\n                C.Offset(0, 2) = re.Replace(strInput, \"$2\")\n            Else\n                C.Offset(0, 1) = \"(Not matched)\"\n            End If\n\n        End If\n    Next\n' then do it again to replace numbers\n    Set Myrange = ThisWorkbook.Sheets(mySheet).Range(\"C1:C1000\")\n    re.Pattern = \"[0-9]\"       \n    For Each C In Myrange\n        strInput = C.Value\n        Do While re.test(strInput)\n            strInput = re.Replace(strInput, \"*\")\n            ' MsgBox (strInput)\n        Loop\n        C.Offset(0, 1) = strInput\n    Next\nEnd Sub\n</code></pre>\n\n<p>This <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">answer</a> was totally useful to me.</p>\n"}], "owner": {"reputation": 1, "user_id": 6068526, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-414EmLDJ5gU/AAAAAAAAAAI/AAAAAAAAAD8/Te-pphMtzuQ/photo.jpg?sz=128", "display_name": "Naveen Sagar", "link": "https://stackoverflow.com/users/6068526/naveen-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1458124879, "creation_date": 1458076872, "question_id": 36022414, "link": "https://stackoverflow.com/questions/36022414/vba-code-to-remove-special-charectors", "title": "VBA code to Remove Special charectors", "body": "<p>I need to remove prefixed special character, numbers in a string in a particular column, For example I am having data in column A (say from A1 to A10000) in column B i need result. below is my example strings </p>\n\n<p>EX1: <strong>12#- First code 12 /05 or \n     0000000- First code &lt;12> take a trip</strong></p>\n\n<p>Result : First code 12/05\n         First code  take a trip**</p>\n\n<p>Like wise the same resulted data will be copied and all numbers should be replaced with \"*\" but the the special characters should not be removed.</p>\n\n<p>Result in Column c should be as mentioned below.</p>\n\n<pre><code>     First code **/**\n     First code &lt;$**.00&gt; take a trip**\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1458077257, "post_id": 36022316, "comment_id": 59696194, "body": "You need to escape it (i.e. double-up any apostrophes)."}, {"owner": {"reputation": 1, "user_id": 6068456, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154070884564656/picture?type=large", "display_name": "Paoa", "link": "https://stackoverflow.com/users/6068456/paoa"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1458080990, "post_id": 36022316, "comment_id": 59697997, "body": "That worked great, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1458082323, "creation_date": 1458082323, "answer_id": 36023753, "question_id": 36022316, "link": "https://stackoverflow.com/questions/36022316/runtime-3075-inserting-apostrophe/36023753#36023753", "title": "Runtime 3075 Inserting apostrophe", "body": "<p>A single quote /apostrophe delimits a string. If your string includes an apostrophe, you must escape it so that the engine doesn't interpret it as the end of your string (and then get confused about everything that follows).</p>\n\n<p>The joys of string-concatenating parameters into SQL. Watch out for malicious user input!</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1458113290, "creation_date": 1458113290, "answer_id": 36029225, "question_id": 36022316, "link": "https://stackoverflow.com/questions/36022316/runtime-3075-inserting-apostrophe/36029225#36029225", "title": "Runtime 3075 Inserting apostrophe", "body": "<p>You also have to handle the date correctly.</p>\n\n<pre><code>' Converts a value of any type to its string representation.\n' The function can be concatenated into an SQL expression as is\n' without any delimiters or leading/trailing white-space.\n'\n' Examples:\n'   SQL = \"Select * From TableTest Where [Amount]&gt;\" &amp; CSql(12.5) &amp; \"And [DueDate]&lt;\" &amp; CSql(Date) &amp; \"\"\n'   SQL -&gt; Select * From TableTest Where [Amount]&gt; 12.5 And [DueDate]&lt; #2016/01/30 00:00:00#\n'\n'   SQL = \"Insert Into TableTest ( [Street] ) Values (\" &amp; CSql(\" \") &amp; \")\"\n'   SQL -&gt; Insert Into TableTest ( [Street] ) Values ( Null )\n'\n' Trims text variables for leading/trailing Space and secures single quotes.\n' Replaces zero length strings with Null.\n' Formats date/time variables as safe string expressions.\n' Uses Str to format decimal values to string expressions.\n' Returns Null for values that cannot be expressed with a string expression.\n'\n' 2016-01-30. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function CSql( _\n    ByVal Value As Variant) _\n    As String\n\n    Const vbLongLong    As Integer = 20\n    Const SqlNull       As String = \" Null\"\n\n    Dim Sql             As String\n    Dim LongLong        As Integer\n\n    #If Win32 Then\n        LongLong = vbLongLong\n    #End If\n    #If Win64 Then\n        LongLong = VBA.vbLongLong\n    #End If\n\n    Select Case VarType(Value)\n        Case vbEmpty            '    0  Empty (uninitialized).\n            Sql = SqlNull\n        Case vbNull             '    1  Null (no valid data).\n            Sql = SqlNull\n        Case vbInteger          '    2  Integer.\n            Sql = Str(Value)\n        Case vbLong             '    3  Long integer.\n            Sql = Str(Value)\n        Case vbSingle           '    4  Single-precision floating-point number.\n            Sql = Str(Value)\n        Case vbDouble           '    5  Double-precision floating-point number.\n            Sql = Str(Value)\n        Case vbCurrency         '    6  Currency.\n            Sql = Str(Value)\n        Case vbDate             '    7  Date.\n            Sql = Format(Value, \" \\#yyyy\\/mm\\/dd hh\\:nn\\:ss\\#\")\n        Case vbString           '    8  String.\n            Sql = Replace(Trim(Value), \"'\", \"''\")\n            If Sql = \"\" Then\n                Sql = SqlNull\n            Else\n                Sql = \" '\" &amp; Sql &amp; \"'\"\n            End If\n        Case vbObject           '    9  Object.\n            Sql = SqlNull\n        Case vbError            '   10  Error.\n            Sql = SqlNull\n        Case vbBoolean          '   11  Boolean.\n            Sql = Str(Abs(Value))\n        Case vbVariant          '   12  Variant (used only with arrays of variants).\n            Sql = SqlNull\n        Case vbDataObject       '   13  A data access object.\n            Sql = SqlNull\n        Case vbDecimal          '   14  Decimal.\n            Sql = Str(Value)\n        Case vbByte             '   17  Byte.\n            Sql = Str(Value)\n        Case LongLong           '   20  LongLong integer (Valid on 64-bit platforms only).\n            Sql = Str(Value)\n        Case vbUserDefinedType  '   36  Variants that contain user-defined types.\n            Sql = SqlNull\n        Case vbArray            ' 8192  Array.\n            Sql = SqlNull\n        Case Else               '       Should not happen.\n            Sql = SqlNull\n    End Select\n\n    CSql = Sql &amp; \" \"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6068456, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154070884564656/picture?type=large", "display_name": "Paoa", "link": "https://stackoverflow.com/users/6068456/paoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594642541, "creation_date": 1458076573, "last_edit_date": 1594642541, "question_id": 36022316, "link": "https://stackoverflow.com/questions/36022316/runtime-3075-inserting-apostrophe", "title": "Runtime 3075 Inserting apostrophe", "body": "<p>I'm very new at this, so I'm a in a little over my head.</p>\n\n<p>I'm working with an access form that inserts employee attendance information into a table. It works perfectly for the most part. The problem comes when there's an apostrophe in the \"Notes\" text box. I can't seem to find a workaround. </p>\n\n<pre><code>If Not IsNull(Me.lstStudentID) And Not IsNull(Me.cboShiftLocation) And Not IsNull(Me.txtShiftTime) _\nAnd Not IsNull(Me.cboInfraction) And Not IsNull(Me.txtDate) Then\n    CurrentDb.Execute \"INSERT INTO tblDiscipline(UOID, Infraction, Shift_Date, Shift_Time, Shift_Location, [Notes]) \" _\n    &amp; \" VALUES ('\" &amp; result &amp; \"','\" &amp; Me.cboInfraction &amp; \"', '\" &amp; Me.txtDate &amp; \"', '\" &amp; Me.txtShiftTime &amp; \"', '\" _\n     &amp; Me.cboShiftLocation &amp; \"', '\" &amp; me.txtNotes &amp; \"')\"\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1458565686, "post_id": 36022176, "comment_id": 59902334, "body": "If you really want to <i>&quot;Thank for help&quot;</i>, as you write, then please could you give some feed-back on the answer given?"}], "answers": [{"comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 1, "creation_date": 1458130064, "post_id": 36022482, "comment_id": 59719356, "body": "@Codingrookie, did you try this? Could you give some feed-back on whether you still have a problem with this?"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 2, "last_activity_date": 1458077132, "creation_date": 1458077132, "answer_id": 36022482, "question_id": 36022176, "link": "https://stackoverflow.com/questions/36022176/form-load-error/36022482#36022482", "title": "Form Load error", "body": "<p>You cannot set the focus on an element of a form during the <code>Load</code> event. Instead you should do that in the <code>Open</code> or <code>Activate</code> event:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Open()\n    Me!Cell5.SetFocus\nEnd Sub\n</code></pre>\n\n<p>or:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Activate()\n    Me!Cell5.SetFocus\nEnd Sub\n</code></pre>\n\n<p>However, instead of setting the focus on a particular element in code, go to the properties of that <code>Cell5</code> and set the <code>TabIndex</code> property to <code>0</code>. This will ensure that this element gets focus whenever the form is loaded.</p>\n"}], "owner": {"reputation": 43, "user_id": 6030679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5330e08f3f97d1023981f060a72ac00f?s=128&d=identicon&r=PG&f=1", "display_name": "Codingrookie", "link": "https://stackoverflow.com/users/6030679/codingrookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 36022482, "answer_count": 1, "score": 1, "last_activity_date": 1594655526, "creation_date": 1458076053, "last_edit_date": 1594655526, "question_id": 36022176, "link": "https://stackoverflow.com/questions/36022176/form-load-error", "title": "Form Load error", "body": "<p>I have a form that I want to open focusing to a cell and also full screen. I am using the following code:</p>\n\n<pre><code>Private Sub Form_Load()\n\n   DoCmd.Maximize\n   Me!Cell5.SetFocus\nEnd Sub\n</code></pre>\n\n<p>It keeps giving me an error</p>\n\n<blockquote>\n  <p>object doesn't support  this property or method</p>\n</blockquote>\n\n<p>What am I doing wrong? Could you please help me to fix this code?</p>\n"}, {"tags": ["vba", "excel", "charts", "export"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458078312, "post_id": 36022160, "comment_id": 59696773, "body": "On which line do you get the error?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1458078590, "post_id": 36022160, "comment_id": 59696895, "body": "Your code works for me - the only thing I can suggest is maybe there&#39;s a different workbook active when you run it (so it will look for the sheet &quot;Growth_of_10k&quot; in that workbook and not find it) Fix: <code>Set objChrt = ThisWorkbook.Sheets(&quot;Growth_of_10k&quot;).ChartObjects(3)</code>"}, {"owner": {"reputation": 27, "user_id": 6068507, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e786a6cd03a2d790e33d66544632dd42?s=128&d=identicon&r=PG&f=1", "display_name": "gcefaloni", "link": "https://stackoverflow.com/users/6068507/gcefaloni"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1458087541, "post_id": 36022160, "comment_id": 59700226, "body": "It is telling me Run-time error &#39;1004&#39; Application-defined or object-defined error. I took the Set objChrt = Sheets(&quot;Growth_of_10k&quot;).ChartObjects(3) from someone else. So I don&#39;t know what is the Chart name or number of the chart in the page I have made. I have a page called &quot;Growth_of_10k&quot; with only a chart in it and so on. But I don&#39;t know whats the number of the chart inside the worksheet nor do I know how to refer to those charts that I want to export.  Dropbox link:<a href=\"https://www.dropbox.com/s/ir3f7223nb9o2db/Avanguard%20Test%20Hypothetical%20Fund%20Cummulative%20Returns.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/ir3f7223nb9o2db/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1458092828, "creation_date": 1458092828, "answer_id": 36025431, "question_id": 36022160, "link": "https://stackoverflow.com/questions/36022160/excel-vba-export-chart/36025431#36025431", "title": "Excel VBA Export chart", "body": "<p>A chart sheet is different from a chartobject embedded on a worksheet.</p>\n\n<pre><code>Thisworkbook.Sheets(\"Chart1\").Export _\n        Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; myFileName, Filtername:=\"PNG\"\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6068507, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e786a6cd03a2d790e33d66544632dd42?s=128&d=identicon&r=PG&f=1", "display_name": "gcefaloni", "link": "https://stackoverflow.com/users/6068507/gcefaloni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1346, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458092828, "creation_date": 1458076009, "question_id": 36022160, "link": "https://stackoverflow.com/questions/36022160/excel-vba-export-chart", "title": "Excel VBA Export chart", "body": "<p>I know absolutely nothing about VBA, I'm just trying to have 4 charts (that are already separated in their own tabs) be seamlessly exported as PNG files to a prespecified location every time I save an excel document.</p>\n\n<p>Going through some of stackoverflow's database I managed to do something similar with a worksheet that I wanted to export as a CSV, but I can't manage to do the same for my charts.</p>\n\n<p>Right now thats what my VBA looks like for ThisWorkbook:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\nThisWorkbook.Worksheets(\"CSV Monthly Update\").Copy\nActiveWorkbook.SaveAs Filename:=\"CSV Monthly Update.csv\", FileFormat:=xlCSVWindows\nActiveWorkbook.Close\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>'This above part works well'</p>\n\n<p>'The one below doesn't, I'm trying to get the chart from Worksheet \"Growth_of_10k\" to be exported but it gives me a Runtime error 9 about runscript being out of page'</p>\n\n<pre><code>Sub ExportChart()\n    Dim objChrt As ChartObject\n    Dim myChart As Chart\n\n    Set objChrt = Sheets(\"Growth_of_10k\").ChartObjects(3)\n    Set myChart = objChrt.Chart\n\n    myFileName = \"myChart.png\"\n\n    On Error Resume Next\n    Kill ThisWorkbook.Path &amp; \"\\\" &amp; myFileName\n    On Error GoTo 0\n\n    myChart.Export Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; myFileName, Filtername:=\"PNG\"\n\n    MsgBox \"OK\"\nEnd Sub\n</code></pre>\n\n<p>Any idea how I would need to change the code so that the chart is exported automatically to the same location as the file (or another pre-specified location, it doesn't matter) at the same time as I save the excel document?</p>\n\n<p>I'm sorry if this is a newbie question, this is really my very first endeavor with VBA and googling can only get you so far when you don't understand what you're doing.</p>\n\n<p>Thanks a ton in advance.</p>\n"}, {"tags": ["excel", "vba", "batch-file"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1458074951, "post_id": 36021501, "comment_id": 59694952, "body": "Would a batch code that opens this workbook work? Then you could add an &quot;on open&quot; workbook event to fire the macro.  Or do you literally want to run the macro directly from the batch file?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1458094518, "post_id": 36021501, "comment_id": 59702039, "body": "I suggest using VBScript for that case. You also could execute the VBScript via your batch file (if you really need the batch file). <a href=\"http://stackoverflow.com/questions/10232150/run-excel-macro-from-outside-excel-using-vbscript-from-command-line\">How to do</a>"}, {"owner": {"reputation": 1022, "user_id": 5463995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GHKok.jpg?s=128&g=1", "display_name": "Bloodied", "link": "https://stackoverflow.com/users/5463995/bloodied"}, "edited": false, "score": 0, "creation_date": 1458098898, "post_id": 36021501, "comment_id": 59703163, "body": "You can use the built in windows program &quot;task scheduler&quot; to start a file on log on every <code>x</code> time"}, {"owner": {"reputation": 11, "user_id": 5105527, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MrJg33VWi-k/AAAAAAAAAAI/AAAAAAAAACA/QItb81pNFJc/photo.jpg?sz=128", "display_name": "ChemCat", "link": "https://stackoverflow.com/users/5105527/chemcat"}, "edited": false, "score": 0, "creation_date": 1458137100, "post_id": 36021501, "comment_id": 59725158, "body": "Thank you a lot! I will think about all the suggestions."}], "owner": {"reputation": 11, "user_id": 5105527, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MrJg33VWi-k/AAAAAAAAAAI/AAAAAAAAACA/QItb81pNFJc/photo.jpg?sz=128", "display_name": "ChemCat", "link": "https://stackoverflow.com/users/5105527/chemcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1458075513, "creation_date": 1458073789, "last_edit_date": 1458075513, "question_id": 36021501, "link": "https://stackoverflow.com/questions/36021501/how-to-use-batch-file-to-automatically-run-a-vba-code", "title": "How to use batch file to automatically run a VBA code", "body": "<p>everyone, I need to split a excel file which contains multiple worksheets into individual excel files based on the different worksheet names. I found a VBA code which works very well. </p>\n\n<p>However, now I need to create a batch file to run the VBA code automatically, how to reach this functionality? Since I do not have strong code experience, </p>\n\n<p>hope some one would tell me or give a hint.\nHere is the code:</p>\n\n<pre><code>Sub Splitbook()\nDim xPath As String\nxPath = Application.ActiveWorkbook.Path\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nFor Each xWs In ThisWorkbook.Sheets\n    xWs.Copy\n    Application.ActiveWorkbook.SaveAs Filename:=xPath &amp; \"\\\" &amp; xWs.Name &amp; \".xlsx\"\n    Application.ActiveWorkbook.Close False\nNext\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "postgresql", "excel"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1458307402, "post_id": 36020951, "comment_id": 59815413, "body": "You are comparing two different SQL dialects: MS Access ACE/Jet SQL and PostgreSQL. One difference is use of parentheses in joins. If PGSQL tables are linked in Access, you will run the ACE/Jet dialect. If using pass-through queries like in Excel, you use the direct connected PGSQL dialect. Had you run a pass-thru query in Access you would receive same error. Also <code>user</code> is a reserved word in both dialects. Either escape or rename."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1458072271, "post_id": 36020983, "comment_id": 59693438, "body": "This now shows runtime error: Preprocessor;relation &quot;Telephone&quot; does not exist; SQLSTATE 42P01;SOURSE_FILE src\\backend\\parser\\parse_relations.c; COURSE_line 984; SOURCE_FUNCTION parserOpenTable"}, {"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1458072362, "post_id": 36020983, "comment_id": 59693490, "body": "Check for Telephone or telephone  you have a lower case in select and upper case in JOIN .. otherwise you don&#39;t have a table with this name .."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1458072563, "post_id": 36020983, "comment_id": 59693606, "body": "Yep that&#39;s it. Thank you"}], "tags": [], "owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "is_accepted": true, "score": 1, "last_activity_date": 1458072018, "creation_date": 1458072018, "answer_id": 36020983, "question_id": 36020951, "link": "https://stackoverflow.com/questions/36020951/sql-code-wont-work-in-excel-vba/36020983#36020983", "title": "SQL code won&#39;t work in Excel VBA", "body": "<p>Seems you have a () after form try without </p>\n\n<pre><code> SELECT user.surname,user.forename,recall.recalldate,telephone.number\n FROM  user INNER JOIN recall ON user.entity_id = recall.master_id\n LEFT JOIN Telephone ON recall.master_id=Telephone.master_id\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1458940048, "creation_date": 1458940048, "answer_id": 36228044, "question_id": 36020951, "link": "https://stackoverflow.com/questions/36020951/sql-code-wont-work-in-excel-vba/36228044#36228044", "title": "SQL code won&#39;t work in Excel VBA", "body": "<p>Yeah, it's probably different SQL for different databases.  Typically, the SQL is very similar, but there are always slight differences between different databases.  </p>\n\n<p>Take a look at this little utility in the link below when you have time.  That is very useful for converting SQL to VBA.  Give it a try, and see how you get along.</p>\n\n<p><a href=\"http://allenbrowne.com/ser-71.html\" rel=\"nofollow\">http://allenbrowne.com/ser-71.html</a></p>\n"}], "owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 36020983, "answer_count": 2, "score": 3, "last_activity_date": 1458940048, "creation_date": 1458071908, "question_id": 36020951, "link": "https://stackoverflow.com/questions/36020951/sql-code-wont-work-in-excel-vba", "title": "SQL code won&#39;t work in Excel VBA", "body": "<p>I am using Excel 2010 VBA and querying 3 tables from a PGSQL database</p>\n\n<p>The following SQL code works perfect in MS ACCESS:</p>\n\n<pre><code>SELECT user.surname,user.forename,recall.recalldate,telephone.number\nFROM (user INNER JOIN recall ON user.entity_id = recall.master_id) \nLEFT JOIN Telephone ON recall.master_id=Telephone.master_id\n</code></pre>\n\n<p>but doesn't seem to transfer to EXCEL VBA:</p>\n\n<pre><code>Dim RECALL As String\nRECALL = \"SELECT user.surname,user.forename,recall.recalldate,telephone.number \" _\n        &amp; \"FROM (user INNER JOIN recall ON user.entity_id = recall.master_id) \" _\n        &amp; \"LEFT JOIN Telephone ON recall.master_id=Telephone.master_id \" _\n\nSet rs = conn.Execute(RECALL)\nWith ActiveSheet.QueryTables.Add(Connection:=rs, Destination:=Range(\"A1\"))\n  .Refresh\nEnd With\n</code></pre>\n\n<p>I get a runtime error: ...expected table source after FROM, got(</p>\n\n<p>The user table links to the recall table using user.entity_id = recall.master_id and shows all recall records for users.\nThen I need the telephone numbers for the matched users. Not all will have a tel number, but I need all recalls regardless of whether they have a tel number.</p>\n\n<p>What is wrong with the SQL code in VBA? </p>\n"}]