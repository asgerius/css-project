[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461193753, "post_id": 36756773, "comment_id": 61093527, "body": "<code>.Cells(i, c).Value = arr(e)</code> E is a string variable not a integer try <code>.Cells(i, c).Value = e</code>"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 8, "creation_date": 1461193919, "post_id": 36756773, "comment_id": 61093579, "body": "I think its the name of your procedure."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461193941, "post_id": 36756773, "comment_id": 61093588, "body": "LOLOLOLOLOLOLOL YEP Edit: post answer?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461194269, "post_id": 36756773, "comment_id": 61093672, "body": "You will want to put c=2 inside the loop or it will not restart on column B each row iteration."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461194366, "post_id": 36756773, "comment_id": 61093694, "body": "@ScottCraner lol yep. Literally just did that. BUUUTTTT, code still needs tweaking :/ Trying to pull names XD Will put in more effort on my part before I ask for more help &lt;3"}], "answers": [{"comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 1, "creation_date": 1461194524, "post_id": 36756912, "comment_id": 61093736, "body": "That sounds like a new question. 8)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461194525, "post_id": 36756912, "comment_id": 61093737, "body": "An example please. @findwindow"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 1, "creation_date": 1461194642, "post_id": 36756912, "comment_id": 61093768, "body": "code needed more work then just a new name, just work it into your answer and this can be a complete (accepted) answer"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461194660, "post_id": 36756912, "comment_id": 61093772, "body": "is there anything that would help delineate between name and not name."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1461194671, "post_id": 36756912, "comment_id": 61093777, "body": "@gtwebb <b>CLASSY</b>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461194803, "post_id": 36756912, "comment_id": 61093809, "body": "What about the first letter of the word, is it capitalized versus not?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461194845, "post_id": 36756912, "comment_id": 61093818, "body": "See picture above in OP please. Edit: uh, it won&#39;t always be <code>side</code>. Could be <code>party</code>, <code>friend</code>..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461194954, "post_id": 36756912, "comment_id": 61093847, "body": "Ok, Does the word <code>Side</code> always precede the name?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461195066, "post_id": 36756912, "comment_id": 61093879, "body": "You are asking a computer to think.  Is the list short of possible preceding words?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461195106, "post_id": 36756912, "comment_id": 61093893, "body": "Oooooooo, I can build an array of preceding words eh?! GENIUS. Edit: you&#39;re correct. There&#39;s maybe 6? possibilities."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461195239, "post_id": 36756912, "comment_id": 61093940, "body": "There you go make an array then when those words are found you start your mining of the names.  If you get stuck feel free to ask another question :P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461195835, "post_id": 36756912, "comment_id": 61094089, "body": "What, you think I couldn&#39;t come up with a formula answer?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461253598, "post_id": 36756912, "comment_id": 61125971, "body": "@ScottCraner So I figured it out with vba. But ok, do it with a formula. And you can&#39;t use <code>substitute</code>, <code>index</code>, <code>match</code>,<code>mid</code>,<code>left</code>,<code>right</code>,<code>len</code> and any other function that includes a vowel =P Edit: there are actually only 3 key words. <code>party</code>,<code>side</code> and <code>friends</code>. Edit2: some names only have a first name. So I expect this in 3 minutes. GO"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461255136, "post_id": 36756912, "comment_id": 61127084, "body": "@ScottCraner It&#39;s been way over 3 minutes."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461258065, "post_id": 36756912, "comment_id": 61128990, "body": "@jeeped wanna give this a shot? Or is Scott trolling me XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461258129, "post_id": 36756912, "comment_id": 61129023, "body": "@findwindow you tied my hands so I did not think you were serious."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461258161, "post_id": 36756912, "comment_id": 61129037, "body": "oooooohhhh lolololol that part was a joke XD Edit: I should ask a new question. You definitely deserve points if you do it with formulas."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461258864, "post_id": 36756912, "comment_id": 61129401, "body": "@findwindow <code>=TRIM(MID(SUBSTITUTE($A1,&quot; &quot;,REPT(&quot; &quot;,99)),IFERROR(SEARCH(&quot;Friends&quot;,SUBSTITUTE($A1,&quot; &quot;,REPT(&quot; &quot;,99))),IFERROR(SEARCH(&quot;Side&quot;,SUBSTITUTE($A1,&quot; &quot;,REPT(&quot; &quot;,99))),SEARCH(&quot;party&quot;,SUBSTITUTE($A1,&quot; &quot;,REPT(&quot; &quot;,99)))))+COLUMN(A:A)*99,99))</code> :P  Copy accros and down as far as needed."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461263405, "post_id": 36756912, "comment_id": 61131839, "body": "Gah. It&#39;s the same thing you did yesterday XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461263464, "post_id": 36756912, "comment_id": 61131865, "body": "I mean, I should have known better. I clearly didn&#39;t <i>learn</i> anything -_-"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1461194733, "last_edit_date": 1461194733, "creation_date": 1461194346, "answer_id": 36756912, "question_id": 36756773, "link": "https://stackoverflow.com/questions/36756773/compile-error-no-line-highlighted/36756912#36756912", "title": "Compile error no line highlighted", "body": "<p>As @gtwebb stated the name was the main issue.</p>\n\n<p>There were a couple other minor thing I found will debugging:</p>\n\n<pre><code>Sub name2()\n\nDim e As Variant\nDim lastRow As Long\nDim c As Integer\nDim arr() As String\nc = 2\n\nWith ActiveSheet\n\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To lastRow\n        c = 2\n        arr = Split(.Cells(i, 1), \" \")\n\n        For Each e In arr\n            .Cells(i, c).Value = e\n            c = c + 1\n        Next\n\n    Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/c1Nkj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c1Nkj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 36756912, "answer_count": 1, "score": 1, "last_activity_date": 1461249021, "creation_date": 1461193606, "last_edit_date": 1531161705, "question_id": 36756773, "link": "https://stackoverflow.com/questions/36756773/compile-error-no-line-highlighted", "title": "Compile error no line highlighted", "body": "<p>I am getting a compile error: expected expression. No line is highlighted XD</p>\n\n<pre><code>Sub name()\n\nDim arr() As String\nDim lastRow As Long\nc = 2\n\nWith ActiveSheet\n\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To lastRow\n\n        arr = Split(.Cells(i, 1), \" \")\n\n        For Each e In arr\n            .Cells(i, c).Value = arr(e)\n            c = c + 1\n        Next\n\n        Set arr = Empty\n\n    Next\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 1175786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c14aa407e58edb6f2b00e44346c6dd3c?s=128&d=identicon&r=PG", "display_name": "Fran", "link": "https://stackoverflow.com/users/1175786/fran"}, "edited": false, "score": 0, "creation_date": 1461231399, "post_id": 36756708, "comment_id": 61109111, "body": "That didn&#39;t work because that didn&#39;t add up barcodes.  I took a screenshot of it: <a href=\"http://i.imgur.com/CLBm2Ix.png\" rel=\"nofollow noreferrer\">i.imgur.com/CLBm2Ix.png</a>"}], "tags": [], "owner": {"reputation": 561, "user_id": 6129564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e064473c907295669d37fe7f6f2ea35?s=128&d=identicon&r=PG&f=1", "display_name": "Reid Hughes", "link": "https://stackoverflow.com/users/6129564/reid-hughes"}, "is_accepted": false, "score": 0, "last_activity_date": 1461193247, "creation_date": 1461193247, "answer_id": 36756708, "question_id": 36756086, "link": "https://stackoverflow.com/questions/36756086/parameters-for-nested-mysql-views/36756708#36756708", "title": "parameters for nested mysql views", "body": "<p>I think what you're looking for is a JOIN statement.  You can join the Barcode-Warehouse table with the Barcode-Box table using the common <code>Barcode</code> column.  This article is a great explanation: <a href=\"http://www.tutorialspoint.com/mysql/mysql-using-joins.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/mysql/mysql-using-joins.htm</a>.</p>\n\n<p>Your server side query will end up being something like this:</p>\n\n<pre><code>SELECT Barcode, Box, Warehouse FROM  Barcode-Warehouse LEFT JOIN Barcode-Box USING (Barcode);\n</code></pre>\n\n<p>This should result in a result set that has Barcode, Box, and Warehouse on each line.  Your users would then be able to filter that result by Warehouse and retrieve only the records that they are interested in.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 1175786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c14aa407e58edb6f2b00e44346c6dd3c?s=128&d=identicon&r=PG", "display_name": "Fran", "link": "https://stackoverflow.com/users/1175786/fran"}, "is_accepted": false, "score": 0, "last_activity_date": 1461243821, "last_edit_date": 1495539921, "creation_date": 1461243821, "answer_id": 36770481, "question_id": 36756086, "link": "https://stackoverflow.com/questions/36756086/parameters-for-nested-mysql-views/36770481#36770481", "title": "parameters for nested mysql views", "body": "<p>Found a way to solve it:\n<a href=\"https://stackoverflow.com/questions/2281890/can-i-create-view-with-parameter-in-mysql\">Can I create view with parameter in MySQL?</a></p>\n\n<p>I filter the first query by adding:</p>\n\n<p>\"where warehouse=function()\"</p>\n\n<p>When I call the final query, I add the parameter for the function as explained in the post. Easy, simple.</p>\n\n<p>thank you</p>\n"}], "owner": {"reputation": 123, "user_id": 1175786, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c14aa407e58edb6f2b00e44346c6dd3c?s=128&d=identicon&r=PG", "display_name": "Fran", "link": "https://stackoverflow.com/users/1175786/fran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461243821, "creation_date": 1461190006, "last_edit_date": 1461243572, "question_id": 36756086, "link": "https://stackoverflow.com/questions/36756086/parameters-for-nested-mysql-views", "title": "parameters for nested mysql views", "body": "<p>Here is a table with barcodes which belongs to different warehouses.</p>\n\n<pre><code>    Barcode  |  Warehouse\n_____________________________\n    1111111  |  A\n    2222222  |  B\n    1111111  |  C\n    3333333  |  A\n</code></pre>\n\n<p>And here is a table with boxes containing barcodes. </p>\n\n<pre><code>    Barcode  |  Box\n_____________________________\n    1111111  |  0001\n    2222222  |  0002\n</code></pre>\n\n<p>Each warehouse's available stock is its amount in the first table, plus all the amount in boxes.\nExample for warehouse A:</p>\n\n<pre><code> Barcode  \n_________\n 1111111  (from its warehouse)\n 3333333  (from its warehouse)\n 1111111  (from a box)\n 2222222  (from a box)\n</code></pre>\n\n<p>This is a simplified example. After retrieving the total amount of barcodes, I cross it with a lot of other queries and tables to transform it into a human-readable report.</p>\n\n<p>Ok,\nThe idea would be a server-side query. \nEvery client (VBA msaccess) would retrieve the query and filter it using its warehouse code.</p>\n\n<p>Warehouse A would call it like this:</p>\n\n<p>select * from finalQuery where warehouse like 'A' &lt;--- BUT it won't work, because boxes' barcodes haven't the warehouse field, thus, they would be excluded.\nThe \"where\" clause should be performed before the UNION ALL.</p>\n\n<p>Would it be possible to use parameters in order to exclusively retrieve a warehouse's barcodes + all boxes' barcodes in a server-side query? Even though the user calls the last query with its code, it should push the parameter down to the first nested query.</p>\n\n<p>Or any other trick? Maybe my scheme is wrong?</p>\n\n<p>The problem manipulating queries in the client side, is that it becomes painstakingly SLOW, because as I said, after joining barcodes, I use the resulting query for building other queries.</p>\n\n<p>Hope I explaied it clearly. It is somewhat complex to explain. I would appreciate any suggestion, trick, idea, etc</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "date", "macros"], "answers": [{"comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1461202060, "post_id": 36756765, "comment_id": 61095637, "body": "Using dateadd is safer.  debug.print DateAdd(&quot;m&quot;,-1,now()), DateAdd(&quot;m&quot;,1,now())"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1461194666, "last_edit_date": 1461194666, "creation_date": 1461193573, "answer_id": 36756765, "question_id": 36755903, "link": "https://stackoverflow.com/questions/36755903/vba-for-past-month-to-2-months-after-current-month/36756765#36756765", "title": "VBA for past month to 2 months after current month", "body": "<p>Say we have data like:</p>\n\n<pre><code>Dates\n2/27/2016\n5/28/2016\n1/30/2016\n5/3/2016\n2/13/2016\n4/29/2016\n2/3/2016\n7/5/2016\n5/23/2016\n3/11/2016\n7/3/2016\n2/5/2016\n5/4/2016\n6/20/2016\n6/26/2016\n7/14/2016\n5/9/2016\n1/26/2016\n2/14/2016\n3/9/2016\n4/1/2016\n2/18/2016\n3/7/2016\n</code></pre>\n\n<p>In column <strong>A</strong> and we want to display dates in:</p>\n\n<ul>\n<li>last month</li>\n<li>this month</li>\n<li>one month ahead</li>\n<li>two months ahead.  </li>\n</ul>\n\n<p>These are dates greater than or equal to 3/1/2016 and less than or equal to 6/30/2016 if today is 4/20/2016.</p>\n\n<p>Consider:</p>\n\n<pre><code>Sub Macro1()\n    Dim d1 As Date, d2 As Date\n    Dim cr1 As String, cr2 As String\n\n    d1 = DateSerial(Year(Now), Month(Now) - 1, 1)\n    d2 = DateSerial(Year(Now), Month(Now) + 3, 0)\n\n    MsgBox d1 &amp; vbCrLf &amp; d2\n    MsgBox CLng(d1) &amp; vbCrLf &amp; CLng(d2)\n\n    cr1 = \"&gt;=\" &amp; CStr(CLng(d1))\n    cr2 = \"&lt;=\" &amp; CStr(CLng(d2))\n\n    ActiveSheet.Range(\"$A$1:$A$24\").AutoFilter Field:=1, Criteria1:=cr1, _\n            Operator:=xlAnd, Criteria2:=cr2\nEnd Sub\n</code></pre>\n\n<p>The result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WIWOZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WIWOZ.png\" alt=\"enter image description here\"></a>\n<br><strong><em>WARNING</em></strong>:</p>\n\n<p>You must test this further to see if it works if today is in January or December.  That is, can the code look ahead to next year or back to the previous year.</p>\n"}], "owner": {"reputation": 1, "user_id": 6232589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j3nqU5laI00/AAAAAAAAAAI/AAAAAAAAFRY/f4hvC3J7WHo/photo.jpg?sz=128", "display_name": "DarthBrute", "link": "https://stackoverflow.com/users/6232589/darthbrute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461194666, "creation_date": 1461189146, "question_id": 36755903, "link": "https://stackoverflow.com/questions/36755903/vba-for-past-month-to-2-months-after-current-month", "title": "VBA for past month to 2 months after current month", "body": "<p>I am trying to get more into VBA as it allows a lot more freedom. What I am trying to figure out is how can I do a VBA to filter a column to show only values that only occur last month, current month and two months in the future.</p>\n\n<p>I know I can use xlFilterLastMonth but right now I am still just recording macros and then changing them to fit my more specific needs. I can find singular filters using xlFilterNextMonth or xlFilterLastMonth. But I can't really find anything for what I am looking for.</p>\n\n<p>Here is my current Macro:</p>\n\n<pre><code>Sub BASICPQS()\n'\n' BASICPQS Macro\n'\n\n'\n    Sheets(\"PRODUCTION\").Range(\"$A$1:$AA$146\").AutoFilter Field:=9, Operator:= _\n        xlFilterValues, Criteria2:=Array(1, \"3/31/2016\", 1, \"4/27/2016\")\n    ActiveWindow.SmallScroll Down:=-18\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated. Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461191141, "post_id": 36755493, "comment_id": 61092605, "body": "Does it just overwrite the last row of your table? Does it happen during the <code>If</code> or the <code>Else</code> part of your code, or both? Is LastRow correct when you step through your code using F8?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461195499, "post_id": 36755493, "comment_id": 61094010, "body": "You check if the cell value (<code>Me.RowNumber.Value</code>) is not Null, however, it may not be a number. If it&#39;s not a number, the .Add will fail."}, {"owner": {"reputation": 151, "user_id": 3683652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0c04f653a241f23a912e73c5ceb846?s=128&d=identicon&r=PG&f=1", "display_name": "fatboyzfishing", "link": "https://stackoverflow.com/users/3683652/fatboyzfishing"}, "edited": false, "score": 0, "creation_date": 1461253123, "post_id": 36755493, "comment_id": 61125618, "body": "Thanks for the response Doug and OldUgly, to respond to your inquiry. It overwrites at the location of the rownumval+1. I stepped through the code and it only overwrites on the <code>If</code> portion. and LastRow is correct. I have stepped through it and it reads rownumval as a long and has value. it just seems to not work on the <code>.ListRows.Add (rownumval)</code>. To Old Ugly  <code>Me.RowNumber.Value</code> is reading as long and has value. I did try the code you provided but still continues with the error."}], "answers": [{"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 1, "last_activity_date": 1461196844, "creation_date": 1461196844, "answer_id": 36757289, "question_id": 36755493, "link": "https://stackoverflow.com/questions/36755493/excel-vba-listrow-add-not-inserting-row/36757289#36757289", "title": "Excel-VBA Listrow.add not inserting row", "body": "<p>This will provide further protection against having a non-number in <code>rownumval</code></p>\n\n<pre><code>If Not vbNullString = Me.CrimeSN2.Value Then\n    If Not vbNullString = Me.RowNumber.Value And IsNumeric(Me.RowNumber.Value) Then\n        rownumval = Me.RowNumber.Value\n        Worksheets(\"Offense\").ListObjects(\"OffenseTable\").ListRows.Add (rownumval)\n        rownumval = rownumval + 1\n    Else\n        rownumval = LastRow + 1\n        Worksheets(\"Offense\").ListObjects(\"OffenseTable\").ListRows.Add (rownumval)\n        rownumval = rownumval + 1\nend if\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3683652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0c04f653a241f23a912e73c5ceb846?s=128&d=identicon&r=PG&f=1", "display_name": "fatboyzfishing", "link": "https://stackoverflow.com/users/3683652/fatboyzfishing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 36757289, "answer_count": 1, "score": 0, "last_activity_date": 1461198491, "creation_date": 1461187521, "last_edit_date": 1531164843, "question_id": 36755493, "link": "https://stackoverflow.com/questions/36755493/excel-vba-listrow-add-not-inserting-row", "title": "Excel-VBA Listrow.add not inserting row", "body": "<p>I have a bit of code that checks a userform for data in a combobox. Then if found adds a row to the table. Unfortunately, I am finding that some times it does not add the row and just overwrites the line. Any ideas on what I have done wrong would help. The following is the code for the portion that creates the new line:</p>\n\n<pre><code>If Not vbNullString = Me.CrimeSN2.Value Then\n    If Not vbNullString = Me.RowNumber.Value Then\n        rownumval = Me.RowNumber.Value\n        Worksheets(\"Offense\").ListObjects(\"OffenseTable\").ListRows.Add (rownumval)\n        rownumval = rownumval + 1\n    Else\n        rownumval = LastRow + 1\n        Worksheets(\"Offense\").ListObjects(\"OffenseTable\").ListRows.Add (rownumval)\n        rownumval = rownumval + 1\nend if\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461187241, "post_id": 36755395, "comment_id": 61091038, "body": "You have nothing for <code>Case 1 To 10</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461187273, "post_id": 36755395, "comment_id": 61091056, "body": "Nothing, no error at all, the editor just pops up with no message and the line Get_Special = c_money   highlighted.  and it doesn&#39;t do it all the time"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461187392, "post_id": 36755395, "comment_id": 61091114, "body": "Case 1 to 10 may have something in the future, and it originally did.  End users are getting the error and I was able to recreate it once, but only once."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461187723, "post_id": 36755395, "comment_id": 61091259, "body": "Uh can you have empty cases? What has debugging revealed so far? And are you calling other functions?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461188045, "post_id": 36755395, "comment_id": 61091415, "body": "@findwindow yes you can have empty cases, it does nothing."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1461191307, "post_id": 36755395, "comment_id": 61092668, "body": "What option do you have selected in &quot;Error Trapping&quot; in the VBE options?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461199048, "post_id": 36755395, "comment_id": 61094935, "body": "In <code>IsArrayInitialized</code>, do you have <code>On Error Resume Next</code> with no <code>On Error GoTo 0</code>?"}, {"owner": {"reputation": 438, "user_id": 3007188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WbZIr.jpg?s=128&g=1", "display_name": "AndrewT", "link": "https://stackoverflow.com/users/3007188/andrewt"}, "edited": false, "score": 0, "creation_date": 1461225613, "post_id": 36755395, "comment_id": 61104881, "body": "Unlikely but I will ask just in case. Is there a break point set on that line i.e. a brown dot in the margin next to that line as its easy to set accidentally. Your exit function would mean it does not always get that far which is why it could be sometimes.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "edited": false, "score": 0, "creation_date": 1461242044, "post_id": 36755395, "comment_id": 61116878, "body": "I am calling three functions to this one, IsArrayInitialized, which is a function that attempts to get the lower bound of an array, and returns false if an error is generated.  The other two are lookups of charges under special circumstances.  11 and 12 are special cases flagged in a column on the spreadsheet."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 1, "creation_date": 1461251243, "post_id": 36755395, "comment_id": 61124201, "body": "Debug -&gt; Clear all Debug Points. Debug -&gt; Compile. Then save the file. Sometimes phantom debug break points exist."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1461349919, "post_id": 36755395, "comment_id": 61175967, "body": "@CodyG. That seems to have fixed it!  Thanks.  Why don&#39;t you put your comment down as an answer so I can give you credit?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1461549303, "post_id": 36755395, "comment_id": 61232927, "body": "@RichardU Done! Thanks. :)"}], "answers": [{"tags": [], "owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "is_accepted": true, "score": 0, "last_activity_date": 1461549282, "creation_date": 1461549282, "answer_id": 36830962, "question_id": 36755395, "link": "https://stackoverflow.com/questions/36755395/excel-opens-up-vba-editor-opens-up-during-processing-no-error-generated/36830962#36830962", "title": "Excel opens up VBA editor opens up during processing. No error generated", "body": "<p>Debug -> Clear all Debug Points. \nDebug -> Compile. Then save the file. \nSometimes phantom debug break points exist.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 36830962, "answer_count": 1, "score": 1, "last_activity_date": 1461549282, "creation_date": 1461187125, "last_edit_date": 1461241719, "question_id": 36755395, "link": "https://stackoverflow.com/questions/36755395/excel-opens-up-vba-editor-opens-up-during-processing-no-error-generated", "title": "Excel opens up VBA editor opens up during processing. No error generated", "body": "<p>I wrote an application in Excel VBA, when it gets to this function, it <strong>sometimes</strong> and <strong><em>only</em></strong> sometimes stops, opens up the editor and highlights the last line before \"end Function\"</p>\n\n<pre><code>Option Explicit\n\nFunction Get_Special(i_Row, c_Total, v_code As Variant) As Currency\n\nDim c_money As Currency\nDim s_Code As String\nDim i_Ctr As Integer\n\nc_money = 0\n\nIf Not IsArrayInitialized(v_code) Then\n    Get_Special = c_money + c_Total\n    Exit Function\nEnd If\n\nFor i_Ctr = LBound(v_code) To UBound(v_code)\n    Select Case v_code(i_Ctr)\n\n        Case 1 To 10\n\n        Case 11  \n             If c_Total = 0 Then c_money = Minimum_Charge(i_Row)\n        Case 12  \n            c_money = c_money + Plug_Fee(i_Row, Range(rngName(RNM.PLUG)).Column) \n        Case Else\n\n    End Select\nNext i_Ctr\n'VBA editor opens here, highlighted.  No error message is given pressing F5 causes it to finish with no problem.  \n\nGet_Special = c_money  \nEnd Function\n</code></pre>\n\n<p>I am at a loss</p>\n\n<p>To address the questions below:</p>\n\n<p>The IsArrayInitialized function has \"On Error resume next\" error handling, which then checks to see if the error number is zero, if not, the function returns false.  </p>\n\n<p>The error is intermittent.  I ran the code 70 times with different data entered each time and could not recreate the error a second time.</p>\n\n<p>I double checked and there is no break point set.</p>\n"}, {"tags": ["sql", "excel", "vba", "oledb"], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1461200297, "creation_date": 1461200297, "answer_id": 36757768, "question_id": 36755328, "link": "https://stackoverflow.com/questions/36755328/excel-ado-vba-count-returning-incorrect-results/36757768#36757768", "title": "Excel/ADO/VBA: Count returning incorrect results", "body": "<p>Give this a try:</p>\n\n<pre><code>select  max([Folio Type]),\n        [Folio ID],\n        max([Departure Date]),\n        sum([Folio Total]),\n        count([Folio ID])\nfrom    [Individual Folios$B2:O150000]\ngroup by [Folio ID],\n        [Folio Total]\nhaving  sum([Folio Total]) &lt;&gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1461200304, "creation_date": 1461200304, "answer_id": 36757770, "question_id": 36755328, "link": "https://stackoverflow.com/questions/36755328/excel-ado-vba-count-returning-incorrect-results/36757770#36757770", "title": "Excel/ADO/VBA: Count returning incorrect results", "body": "<p>Consider inner joins of derived tables (i.e., subqueries in <code>FROM</code> clause).</p>\n\n<p>Standard SQL <em>(conceptual illustration)</em></p>\n\n<pre><code>SELECT t1.[Folio Type], t1.[Folio ID], t1.[Departure Date], \n       t2.FolioCount, t2.FolioSum  \nFROM    \n        (SELECT [Folio Type], [Folio ID], [Departure Date],\n                [Folio Total]   \n         FROM [Individual Folios$B2:O150000]\n        ) AS t1 \nINNER JOIN  \n        (SELECT [Folio ID], Count([Folio ID]) As FolioCount,   \n                    SUM([Folio Total]) As FolioSum   \n             FROM [Individual Folios$B2:O150000]   \n             GROUP BY [Folio ID], [Folio Total]   \n             HAVING SUM([Folio Total]) &lt;&gt; 0\n         ) As t2 \nON t1.[Folio ID] = t2.[Folio ID] \nAND t1.[Folio Total] = t2.[Folio Total]\n</code></pre>\n\n<p>VBA embedded string:</p>\n\n<pre><code> sSQL = \"SELECT t1.[Folio Type], t1.[Folio ID], t1.[Departure Date],\"\n sSQL = sSQL &amp;  \" t2.FolioCount, t2.FolioSum\"\n sSQL = sSQL &amp;  \" FROM\"\n sSQL = sSQL &amp;  \"  (SELECT [Folio Type], [Folio ID], [Departure Date]\" \n sSQL = sSQL &amp;  \"   FROM [Individual Folios$B2:O150000]) AS t1\" \n sSQL = sSQL &amp;  \" INNER JOIN\"\n sSQL = sSQL &amp;  \"  (SELECT [Folio ID], Count([Folio ID]) As FolioCount,\"\n sSQL = sSQL &amp;  \"          SUM([Folio Total]) As FolioSum\" \n sSQL = sSQL &amp;  \"   FROM [Individual Folios$B2:O150000]\"\n sSQL = sSQL &amp;  \"   GROUP BY [Folio ID], [Folio Total]\"\n sSQL = sSQL &amp;  \"   HAVING SUM([Folio Total]) &lt;&gt; 0) As t2\"\n sSQL = sSQL &amp;  \" ON t1.[Folio ID] = t2.[Folio ID]\"\n sSQL = sSQL &amp;  \" AND t1.[Folio Total] = t2.[Folio Total]\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "edited": false, "score": 0, "creation_date": 1461336148, "post_id": 36775119, "comment_id": 61167816, "body": "This answer was similar to Parfait&#39;s, but I chose this one because for some reason I had to delete the last line of code he provided:             <code>sSQL = sSQL &amp;  &quot; AND t1.[Folio Total] = t2.[Folio Total]</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1461346735, "post_id": 36775119, "comment_id": 61174287, "body": "I added that last join because of your original <code>GROUP BY</code> had <code>[Folio ID]</code> and <code>[Folio Total]</code> which I almost asked about!"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1461340023, "last_edit_date": 1461340023, "creation_date": 1461255012, "answer_id": 36775119, "question_id": 36755328, "link": "https://stackoverflow.com/questions/36755328/excel-ado-vba-count-returning-incorrect-results/36775119#36775119", "title": "Excel/ADO/VBA: Count returning incorrect results", "body": "<p>You need to do this in two queries.  I've put the second one as a subquery in the FROM clause.</p>\n\n<pre><code>SELECT \n     a.[Folio Type]\n     ,a.[Folio ID]\n     ,a.[Departure Date]\n     ,b.FolioCount\n     ,b.FolioSum  \nFROM   \n    [Individual Folios$B2:O150000] a    \nINNER JOIN  \n        (SELECT \n              [Folio ID], [Folio Type]\n              ,Count([Folio ID]) As FolioCount\n              ,SUM([Folio Total]) As FolioSum   \n         FROM \n              [Individual Folios$B2:O150000]\n         GROUP BY \n              [Folio ID]\n              ,[Folio Type]   \n         HAVING SUM([Folio Total]) &lt;&gt; 0\n         ) b\nON a.[Folio ID] = b.[Folio ID] \n</code></pre>\n\n<p>Make your string equal to this query:</p>\n\n<pre><code> sSQL = \"SELECT a.[Folio Type],a.[Folio ID],a.[Departure Date]\" _\n      &amp; \",b.FolioCount,b.FolioSum\" _  \n      &amp; \" FROM [Individual Folios$B2:O150000] a\" _    \n      &amp; \" INNER JOIN\" _  \n      &amp; \"     (SELECT [Folio ID], [Folio Type] \" _\n      &amp; \"      Count([Folio ID]) As FolioCount,SUM([Folio Total]) As FolioSum\" _   \n      &amp; \"      FROM [Individual Folios$B2:O150000]\" _\n      &amp; \"      GROUP BY [Folio ID], [Folio Type]\" _   \n      &amp; \"      HAVING SUM([Folio Total]) &lt;&gt; 0) b\"_\n      &amp; \" ON a.[Folio ID] = b.[Folio ID]\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 36775119, "answer_count": 3, "score": 0, "last_activity_date": 1461340023, "creation_date": 1461186901, "last_edit_date": 1461200095, "question_id": 36755328, "link": "https://stackoverflow.com/questions/36755328/excel-ado-vba-count-returning-incorrect-results", "title": "Excel/ADO/VBA: Count returning incorrect results", "body": "<p>I have a macro with the following code:</p>\n\n<pre><code>sSQL = \"select [Folio Type], [Folio ID], [Departure Date],\" &amp; _\n       \"        Sum([Folio Total]), Count([Folio ID])\" &amp; _\n       \" from [Individual Folios$B2:O150000]\" &amp; _\n       \" group by [Folio Type], [Departure Date], [Folio ID], [Folio Total]\" &amp; _\n       \" having Sum([Folio Total]) &lt;&gt; 0\"\n</code></pre>\n\n<p>The code above gives me an incorrect count of 1 for each <code>[Folio ID]</code>. I want to get the total count of a given <code>[Folio ID]</code>, regardless of <code>[Departure Date]</code>. When I remove some of the fields I get different results - the following code appears to be working correctly:</p>\n\n<pre><code> sSQL = \"select [Folio ID], Count([Folio ID]), Sum([Folio Total])\" &amp; _\n        \" from [Individual Folios$B2:O150000]\" &amp; _\n        \" group by [Folio ID], [Folio Total]\" &amp; _\n        \" having sum([Folio Total]) &lt;&gt; 0\"\n</code></pre>\n\n<p>I need to figure out how to get the same results as above after adding the removed fields back in. My guess is that the query is counting occurrences by taking all the fields into consideration. If that's the case, is there any easy workaround?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461186436, "post_id": 36754959, "comment_id": 61090587, "body": "See <a href=\"http://mathforum.org/library/drmath/view/58972.html\" rel=\"nofollow noreferrer\">HERE</a> for a better explanation, but  the gist is that there are two ways to round number ending in 5.  The 1st approach uses the toward even.  So if you changed the number to <code>123456.715</code> both would return the <code>123456.72</code>.  The second appraoch uses the 5 as the deliminator."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461186473, "post_id": 36755190, "comment_id": 61090613, "body": "Beat me by 20 seconds."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461186925, "post_id": 36755190, "comment_id": 61090878, "body": "@ScottCraner :-)  Rounding is an interesting topic for me.  There are many different ways of tiebreaking in addition to those used in the Excel and VBA functions."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1461198481, "post_id": 36755190, "comment_id": 61094792, "body": "Additional info. VBA is using banker&#39;s rounding <a href=\"http://www.xbeat.net/vbspeed/i_BankersRounding.htm\" rel=\"nofollow noreferrer\">xbeat.net/vbspeed/i_BankersRounding.htm</a>.  Same method in .net <a href=\"http://stackoverflow.com/questions/311696/why-does-net-use-bankers-rounding-as-default\" title=\"why does net use bankers rounding as default\">stackoverflow.com/questions/311696/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1461186860, "last_edit_date": 1461186860, "creation_date": 1461186414, "answer_id": 36755190, "question_id": 36754959, "link": "https://stackoverflow.com/questions/36754959/why-does-round-produce-a-different-result-than-application-round/36755190#36755190", "title": "Why does Round produce a different result than Application.Round", "body": "<p>There is no entirely correct answer for how to round.  The differences have to do with how to handle values that fall exactly on the midpoint.  <code>Application.Round</code> will always round up in that instance.  e.g.  0.5 will round to 1.0.  VBA.Round will tie break to the closest even number  </p>\n\n<pre><code>1.5--&gt;2   \n2.5--&gt;2  \n3.5--&gt;4  \n</code></pre>\n\n<p>and so forth.  This is one way of several ways of reducing the bias inherent in always rounding up.</p>\n\n<p>Also, if interested, there is a fairly extensive discussion of Rounding in <a href=\"https://en.wikipedia.org/wiki/Rounding\" rel=\"nofollow\">this Wikipedia article</a></p>\n"}], "owner": {"reputation": 1078, "user_id": 172354, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46e6ae27b952647e61413d36bb702e4d?s=128&d=identicon&r=PG", "display_name": "Shawn H", "link": "https://stackoverflow.com/users/172354/shawn-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "closed_date": 1461187882, "accepted_answer_id": 36755190, "answer_count": 1, "score": 3, "last_activity_date": 1461186860, "creation_date": 1461185527, "question_id": 36754959, "link": "https://stackoverflow.com/questions/36754959/why-does-round-produce-a-different-result-than-application-round", "closed_reason": "Duplicate", "title": "Why does Round produce a different result than Application.Round", "body": "<p>I am finding that the VBA Round function returns the wrong result. I found a working alternative which is to use the <code>Application.Round</code> instead.</p>\n\n<p>Why doesn't the VBA <code>Round</code> function work as expected?</p>\n\n<pre><code>Sub roundingResults()\n    Range(\"A1\") = 123456.705\n    Debug.Print \"Approach #1 \" &amp; Round(Range(\"A1\").Value, 2)\n    Debug.Print \"Approach #2 \" &amp; Application.Round(Range(\"A1\").Value, 2)    \nEnd Sub\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Approach #1 123456.7\nApproach #2 123456.71\n</code></pre>\n"}, {"tags": ["vba", "proxy"], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 1410618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e43a45b8289c7a7ea6b5eeba57c53a16?s=128&d=identicon&r=PG", "display_name": "Sarabadu", "link": "https://stackoverflow.com/users/1410618/sarabadu"}, "edited": false, "score": 0, "creation_date": 1481905726, "post_id": 41167467, "comment_id": 69577041, "body": "I will try... but where you enter the proxy user and password?"}, {"owner": {"reputation": 1, "user_id": 4405592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dTM45rfxUmY/AAAAAAAAAAI/AAAAAAAAAB4/pRZ9g0q_Jbw/photo.jpg?sz=128", "display_name": "Diego Robledo", "link": "https://stackoverflow.com/users/4405592/diego-robledo"}, "reply_to_user": {"reputation": 555, "user_id": 1410618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e43a45b8289c7a7ea6b5eeba57c53a16?s=128&d=identicon&r=PG", "display_name": "Sarabadu", "link": "https://stackoverflow.com/users/1410618/sarabadu"}, "edited": false, "score": 0, "creation_date": 1482256621, "post_id": 41167467, "comment_id": 69697032, "body": "I believe you don&#39;t have that option (proxy server requiring authentication) using CDO"}], "tags": [], "owner": {"reputation": 1, "user_id": 4405592, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dTM45rfxUmY/AAAAAAAAAAI/AAAAAAAAAB4/pRZ9g0q_Jbw/photo.jpg?sz=128", "display_name": "Diego Robledo", "link": "https://stackoverflow.com/users/4405592/diego-robledo"}, "is_accepted": false, "score": 0, "last_activity_date": 1481814728, "creation_date": 1481814728, "answer_id": 41167467, "question_id": 36754877, "link": "https://stackoverflow.com/questions/36754877/vba-send-email-over-proxy-with-credentials/41167467#41167467", "title": "VBA send Email over proxy with credentials", "body": "<p>If you are behind a proxy you can try this:</p>\n\n<pre><code>.Item(\"http://schemas.microsoft.com/cdo/configuration/urlproxyserver\") = \"proxy\"\n.Item(\"http://schemas.microsoft.com/cdo/configuration/proxyserverport\") = 8080\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 1410618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e43a45b8289c7a7ea6b5eeba57c53a16?s=128&d=identicon&r=PG", "display_name": "Sarabadu", "link": "https://stackoverflow.com/users/1410618/sarabadu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 936, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1493034989, "creation_date": 1461185253, "last_edit_date": 1493034989, "question_id": 36754877, "link": "https://stackoverflow.com/questions/36754877/vba-send-email-over-proxy-with-credentials", "title": "VBA send Email over proxy with credentials", "body": "<p>I have an internet proxy server that requires credentials, user and password...\nWhen i use MSXML2.ServerXMLHTTP.6.0 i can set setProxyCredentials</p>\n\n<pre><code>Dim url, xhr\nurl = \"https://www.example.com/\"\nSet xhr = CreateObject(\"MSXML2.ServerXMLHTTP.6.0\")\nxhr.Open \"GET\", url, False\nxhr.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nxhr.setProxy 2, \"proxy:8080\"\nxhr.setProxyCredentials \"user\", \"password\" ' &lt;--- Here i set the proxy credentials\nxhr.Send\nMsgBox xhr.responseText\n</code></pre>\n\n<p>But when i use a CDO i cannot set that and throw me error...</p>\n\n<pre><code>Set cdomsg = CreateObject(\"CDO.message\")\nWith cdomsg.Configuration.Fields\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2 'NTLM method\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.gmail.com\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smptserverport\") = 25\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = False\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout\") = 60\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/URLGetLatestVersion\") = True\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"gmailUser\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"GmailPasswor\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/urlproxyserver\") = \"proxy:8080\"\n    .Update\n    End With\n    ' build email parts\n    With cdomsg\n    .To = \"mail@gmail\"\n    .From = \"mail@gmail\"\n    .Subject = \"the email subject\"\n    .TextBody = \"the full message body goes here. you may want to create a variable to hold the text\"\n    .Send\n</code></pre>\n\n<p>error -2147220973(80040213)</p>\n\n<p>i think that is for the proxy....</p>\n\n<p>Any work around?</p>\n"}, {"tags": ["excel", "button", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 6226844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3efcbd749667f12a90438272c2f09b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Peters", "link": "https://stackoverflow.com/users/6226844/matt-peters"}, "is_accepted": true, "score": 1, "last_activity_date": 1461185177, "creation_date": 1461185177, "answer_id": 36754844, "question_id": 36754418, "link": "https://stackoverflow.com/questions/36754418/automatically-update-links-when-opening-a-workbook/36754844#36754844", "title": "Automatically update links when opening a workbook", "body": "<p>When the user downloads the workbook, I would venture to say that the path to your Click event becomes invalid since that was probably the path on the machine the workbook was created on and may not exist on the users machine. When the event is re-assigned, it's most likely saved in a default local directory, probably Users/current user/AppData/... (Vista +). The easiest way around this is to save the macro to an existing system location on the original workbook. </p>\n"}], "owner": {"reputation": 379, "user_id": 6134241, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7145cec770657cc6c03eb2b91f5f6798?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/6134241/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 36754844, "answer_count": 1, "score": 0, "last_activity_date": 1490027824, "creation_date": 1461183770, "last_edit_date": 1531164843, "question_id": 36754418, "link": "https://stackoverflow.com/questions/36754418/automatically-update-links-when-opening-a-workbook", "title": "Automatically update links when opening a workbook", "body": "<p>My add-in downloads and open a workbook that has a button.\nThe button calls a macro named CommandBUtton_Click. As shown in the form bellow.</p>\n\n<p>When the user downloads and click on  the button a error message is shown warning that no macro CommandBUtton_Click was found. But If I manually right-click the button and click on assign macro I can make the button work just by removing the path before the macro name.<br>\nIs it possible to set a workbook event to automatically remove the path?\n<br>\n<a href=\"https://i.stack.imgur.com/p0TJC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p0TJC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461184105, "post_id": 36754409, "comment_id": 61089306, "body": "Too long code, I can&#39;t be bothered to read through it all. Which row produces the error? Also, read <a href=\"http://stackoverflow.com/help/mcve\">this</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461185873, "post_id": 36754409, "comment_id": 61090312, "body": "First things first; get rid of the <code>.Select</code> and <code>.Activate</code> It slows down the code.  For a great tutorial and explanation look <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">HERE</a>"}, {"owner": {"reputation": 65, "user_id": 2069483, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eaae84d2c5423441faa713dcf0e5ca9d?s=128&d=identicon&r=PG", "display_name": "Eric Hondzinski", "link": "https://stackoverflow.com/users/2069483/eric-hondzinski"}, "edited": false, "score": 0, "creation_date": 1461203744, "post_id": 36754409, "comment_id": 61096061, "body": "I&#39;m not really worried about scalability. This is an ad-hoc request that involves a very limited amount of data."}], "answers": [{"tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": true, "score": 1, "last_activity_date": 1461192452, "last_edit_date": 1525816150, "creation_date": 1461192452, "answer_id": 36756566, "question_id": 36754409, "link": "https://stackoverflow.com/questions/36754409/assigning-a-range-variable-to-row-of-current-cell/36756566#36756566", "title": "Assigning a range variable to row of current cell", "body": "<p>Change:</p>\n\n<pre><code>Range(IB).Copy\n</code></pre>\n\n<p>to</p>\n\n<pre><code>IB.Copy\n</code></pre>\n\n<p>IB is already a <code>Range</code> (kind of, see below) so when you call it in a range function, it's looking for a range with a name that's equal to what's in IB on your sheet.</p>\n\n<p>In addition to Scott's tips about <code>Select</code> and <code>Activate</code>, be aware that </p>\n\n<pre><code>Dim IB, OB As Range\n</code></pre>\n\n<p>declares OB as a range, just like you want, but declares IB as a <code>Variant</code>. For more info, see this <a href=\"http://www.cpearson.com/excel/declaringvariables.aspx\" rel=\"nofollow noreferrer\">Chip Pearson page</a> and scroll down to \"Pay Attention To Variables Declared With One Dim Statement.\"</p>\n"}], "owner": {"reputation": 65, "user_id": 2069483, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eaae84d2c5423441faa713dcf0e5ca9d?s=128&d=identicon&r=PG", "display_name": "Eric Hondzinski", "link": "https://stackoverflow.com/users/2069483/eric-hondzinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 36756566, "answer_count": 1, "score": -1, "last_activity_date": 1461192452, "creation_date": 1461183741, "question_id": 36754409, "link": "https://stackoverflow.com/questions/36754409/assigning-a-range-variable-to-row-of-current-cell", "title": "Assigning a range variable to row of current cell", "body": "<p>I am having difficulty assigning the range of the active cell's row to a ranged variable. When I attempt to copy this variable in a range function call, I get the \"Method range of object global failed\" error. Any tips?</p>\n\n<pre><code>Sub GroupLanes()\nDim Origin, Destination, ODPair As String\nDim mainWorkbook As Workbook\nDim Index As Long\nDim IB, OB As Range\n\nSet mainWorkbook = ActiveWorkbook\nIndex = 6\n\nRange(\"G\" &amp; Index).Select\nOrigin = ActiveCell.Value\n\nDebug.Print Origin\n\nRange(\"H\" &amp; Index).Select\nDestination = ActiveCell.Value\n\nDebug.Print Destination\n\nRange(\"AV\" &amp; Index).Select\nODPair = ActiveCell.Value\n\nDebug.Print ODPair\n\nDo Until IsEmpty(ActiveCell)\n\n    Set IB = ActiveCell.EntireRow\n\n    Range(\"AV6\").Select\n    ODPair = ActiveCell.Value\n\n    Do Until IsEmpty(ActiveCell)\n\n        If (Mid(ODPair, 1, 5) = Destination And Mid(ODPair, 6, 5) = Origin) Then\n            Set OB = ActiveCell.EntireRow\n\n            Range(IB).Copy\n            Sheets(\"Sheet2\").Range(\"A\" &amp; Index &amp; \":\" &amp; \"AV\" &amp; Index).PasteSpecial xlPasteValues\n\n            Range(OB).Copy\n            Sheets(\"Sheet2\").Range(\"A\" &amp; Index &amp; \":\" &amp; \"AV\" &amp; Index).PasteSpecial xlPasteValues\n\n            ActiveCell.Offset(1, 0).Select\n            ODPair = ActiveCell.Value\n        Else\n            ActiveCell.Offset(1, 0).Select\n            ODPair = ActiveCell.Value\n            Debug.Print ODPair\n        End If\n\n    Loop\n\n    Index = Index + 1\n\n    Range(\"G\" &amp; Index).Select\n    Origin = ActiveCell.Value\n\n    Range(\"H\" &amp; Index).Select\n    Destination = ActiveCell.Value\n\nLoopEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1461183285, "post_id": 36754182, "comment_id": 61088765, "body": "<code>not sure if this works</code>.  Well, it either does what you want or it does not.  What does it do that is wrong?"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461183420, "post_id": 36754182, "comment_id": 61088857, "body": "&#39; if the &quot;Winner&quot; Defect passed retest, now &quot;Loser&quot; can retest which should be green in color , i have multiple Loser defect id associated to one id separated with (,), so if Winner is passed i need to make all loser to green color End Sub..."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1461183464, "post_id": 36754182, "comment_id": 61088886, "body": "People seem to hate <a href=\"https://www.google.hu/search?client=opera&amp;q=conditional+formatting&amp;sourceid=opera&amp;ie=UTF-8&amp;oe=UTF-8\" rel=\"nofollow noreferrer\">conditional formatting</a>... :("}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461184491, "post_id": 36754182, "comment_id": 61089564, "body": "@Vacip: as my sheet gets created a fresh every time, more over i am new to macro and conditional formatting, but if you have a reference please pass it , i will try it out.   I need to mark color a different color  as per below condition, if the &quot;Winner&quot; Defect passed retest, now &quot;Loser&quot; can retest which should be green in color , i have multiple Loser defect id associated to one id separated with (,), so if Winner is passed i need to make all loser to green color End Sub"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 3, "creation_date": 1461184925, "post_id": 36754182, "comment_id": 61089807, "body": "I don&#39;t see a question..."}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1461209606, "post_id": 36754182, "comment_id": 61097546, "body": "@Davesexcel, my apologies.  Question is : i need a logic  1.where i can get the status of a defect from Column F,  2.If the status is retested and passed then i need to see if there are any values in Column C, Duplicate ID( there may have multiple id separated with comma(,) 3.I need to take individual values and search in Column A , ex. for defect ID , JIRA1 there are 2 duplicate id ALM3 and ALM7. so i need to look for those values in Column A Defect id.  4.If the status of those defects (ALM3 and ALM7) is NOT closed then i need to mark the entire row in Green color. as per the screen shot."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1461348103, "post_id": 36759497, "comment_id": 61175005, "body": "What i need is to find the duplicate id in C column in row 1 and mark it with a color.1.Where i can get the status of a defect from Column F,  2.If the status is retested and passed then i need to see if there are any values in Column C, Duplicate ID( there may have multiple id separated with comma(,)  3.I need to take individual values and search in Column A ,ex. for defect ID , JIRA1 there are 2 duplicate id ALM3 and ALM7. so i need to look for those values in Column A Defect id.  4.If the status of those defects (ALM3 and ALM7) is NOT closed then i need to mark the entire row in Green color"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1461418886, "post_id": 36759497, "comment_id": 61196008, "body": "i am got answer for few just i need to how to put this logic....     if Range(&quot;F2:F565&quot;) =&quot; ready to retest&quot; then      pick value from (&quot;D2:D565&quot;),     Split the value (&quot;D2:D5655&quot;)     find the splited value in (&quot;A2:A565&quot;) high light with a green color     end if"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1461546972, "post_id": 36759497, "comment_id": 61232513, "body": "Can any of the admin remove on hold status???? i need help here very badly....thanks in advance"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1461553139, "post_id": 36759497, "comment_id": 61233581, "body": "@Venkat - your question is on hold because it is too broad, and now it is morphing. If you now have a more focused question, it is worth posting a new explicit question, following the rules of <a href=\"http://stackoverflow.com/help/how-to-ask\">asking a good question</a>"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 1, "last_activity_date": 1461211831, "creation_date": 1461211831, "answer_id": 36759497, "question_id": 36754182, "link": "https://stackoverflow.com/questions/36754182/split-and-color-the-duplicate-row-value-if-the-defect-status-is-ready-to-retest/36759497#36759497", "title": "Split and color the duplicate row value if the defect status is ready to retest, using VBA macro", "body": "<p>I am interpreting your comments to mean:</p>\n\n<ol>\n<li>Column I contains information regarding the current status. It will have certain key words such as \"Closed\", \"New\", \"blocked\", \"Open\". Now, you have a new key word \"Passed\" (I am guessing).</li>\n<li>Each key word will have a corresponding color that is used to highlight some of the cells in the same row. In the case of the new key word \"Passed\", you want the color to be Green.</li>\n</ol>\n\n<p>And I am interpreting your question to be: <strong>How do I modify the code I already have, to make the cell colors green when I find the key word \"Passed\"?</strong></p>\n\n<p>Your code, modified to address <em>that</em> question, is below.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim rng As Range, cell As Range\n    Set rng = Range(\"I2:I250\")\n    For Each cell In rng\n    Select Case cell.Offset(0, 0).Value\n       Case \"Closed\"\n           cell.Resize(1, 12).Interior.ColorIndex = 4\n       Case \"New\"\n           cell.Resize(1, 12).Interior.ColorIndex = 31\n       Case \"blocked\"\n           cell.Resize(1, 1).Interior.ColorIndex = 50\n       Case \"open\"\n           cell.Resize(1, 1).Interior.ColorIndex = 27\n       Case \"Passed\"\n           cell.Resize(1, 1).Interior.ColorIndex = 4\n       Case Else\n           cell.Resize(1, 1).Interior.ColorIndex = 3\n       End Select\n     Next\n ' if the \"Winner\" Defect passed retest, now \"Loser\" can retest which should be green in color , i havee multiple Losed defect id associated to one id separated with (,), so if Winner is passed i need to make all loser to green color\nEnd Sub\n</code></pre>\n\n<p>I choose the number 4 to represent green based on the default color palette <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840443.aspx\" rel=\"nofollow\">as documented by MS</a>. Since you already are using the number 4 for \"Closed\", you may already be highlighting with green, or you may be using a customized color palette. </p>\n"}], "owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1461277236, "answer_count": 1, "score": 0, "last_activity_date": 1461551703, "creation_date": 1461183009, "last_edit_date": 1461551703, "question_id": 36754182, "link": "https://stackoverflow.com/questions/36754182/split-and-color-the-duplicate-row-value-if-the-defect-status-is-ready-to-retest", "closed_reason": "Needs more focus", "title": "Split and color the duplicate row value if the defect status is ready to retest, using VBA macro", "body": "<p><a href=\"https://i.stack.imgur.com/cveEr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cveEr.png\" alt=\"enter image description here\"></a>Rewording based on the Comment.</p>\n\n<p>1.If the status in F column = ready to retest or passed </p>\n\n<p>2.then if there are any values in Column C, take/split the Duplicate ID in column C separated with comma(,) </p>\n\n<p>3.search the duplicate id in Column A and mark it with Green color </p>\n\n<p>ex. In Row 1 for the defect ID  JIRA1 there are 2 duplicate id ALM3 and ALM7. so i need to look for those values in Column A. 4.If the status of those defects (ALM3 and ALM7) is NOT closed then i need to mark the entire row in Green color</p>\n\n<p>Sub findduplicateColoreIt()</p>\n\n<pre><code>'Get the last row\nDim Report As Worksheet\nDim i As Integer, j As Integer\nDim lastRow As Integer\n\nSet Report = Excel.Worksheets(\"Sheet2\")                                       \nlastRow = Report.UsedRange.Rows.Count\n\nApplication.ScreenUpdating = False\nFor i = 2 To lastRow\n    For j = 2 To lastRow\n        If Report.Cells(i, 4).Value &lt;&gt; \"\" And Report.Cells(i, 7).Value = \"Ready to retest\" And Report.Cells(i, 1).Value = \"Jira\" Then 'This will omit blank cells at the end (in the event that the column lengths are not equal.\n            If InStr(1, Report.Cells(j, 2).Value, Report.Cells(i, 3).Value, vbTextCompare) &gt; 0 Then\n\n\n            ' need to get a logic where i need to get value from Colum D, split it and find the value in column A and color the row with green/any.\n                a = Split(ActiveCell.Value, \",\")\n\n\n                Exit For\n            Else\n            End If\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1461187779, "post_id": 36754048, "comment_id": 61091283, "body": "Do you want to create a VBA function to use in the cell? for example your new cell formula would then read <code>=Myfunction(B2)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1461187033, "last_edit_date": 1461187033, "creation_date": 1461182976, "answer_id": 36754173, "question_id": 36754048, "link": "https://stackoverflow.com/questions/36754048/if-condition-from-excel-to-vba/36754173#36754173", "title": "IF condition from excel to VBA", "body": "<p>This will do what you are asking:</p>\n\n<pre><code>If Range(\"B2\") = \"USD\" Then\n    If Range(\"B170\") = \"USD\" Then\n        Range(\"A1\").Value = Range(\"B173\").Value\n    Else\n        Range(\"A1\").Value = Range(\"B173\").Value / Range(\"B1\").Value\n    End If\nElse\n    If Range(\"B170\") = \"USD\" Then\n        Range(\"A1\").Value = Range(\"B173\").Value * Range(\"B1\").Value\n    Else\n        Range(\"A1\").Value = Range(\"B173\").Value\n    End If\nEnd If\n</code></pre>\n\n<p>This assumes that you want the value in A1.</p>\n\n<p>Also formatting the code as above allows it to be easier read.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "edited": false, "score": 0, "creation_date": 1461195446, "post_id": 36756015, "comment_id": 61093998, "body": "Cool ! nice approach"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1461204376, "last_edit_date": 1461204376, "creation_date": 1461189655, "answer_id": 36756015, "question_id": 36754048, "link": "https://stackoverflow.com/questions/36754048/if-condition-from-excel-to-vba/36756015#36756015", "title": "IF condition from excel to VBA", "body": "<p>Maybe this as an alternative?</p>\n\n<pre><code>Select Case CStr(Range(\"B2\").text = \"USD\") &amp; CStr(Range(\"B170\").text = \"USD\")\nCase Is = \"TrueFalse\"\n    Range(\"A1\").Value = Range(\"B173\").Value / Range(\"B1\").Value\nCase Is = \"FalseTrue\"\n    Range(\"A1\").Value = Range(\"B173\").Value * Range(\"B1\").Value\nCase Else\n    Range(\"A1\").Value = Range(\"B173\").Value\nEnd Select\n</code></pre>\n\n<p>Just been playing around with this a bit more, you can mathematically get it smaller by using the boolean as a value in your calculation, it gets down to just 2 lines of code, set the value for an exception then overwrite it if it meets the criteria.</p>\n\n<p>We use the maths here that X * Y = X / (1/Y)</p>\n\n<p>By knowing this we can use the boolean as 1 or 0 and manipulate a formula that way.</p>\n\n<p>Here is what I came up with:</p>\n\n<pre><code>Range(\"A1\").Value = Range(\"B173\").Value\nIf CLng(Range(\"B2\").Text = \"USD\") + CLng(Range(\"B170\").Text = \"USD\") = -1 Then Range(\"A1\").Value = Range(\"B173\").Value * (((CLng(Range(\"B2\").Text = \"USD\") * -1) / Range(\"B1\").Value) + ((CLng(Range(\"B170\").Text = \"USD\") * -1) * Range(\"B1\").Value))\n</code></pre>\n\n<p>It is much harder to read and maintain than my original suggestion though :).</p>\n"}], "owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 36756015, "answer_count": 2, "score": 0, "last_activity_date": 1461204376, "creation_date": 1461182558, "question_id": 36754048, "link": "https://stackoverflow.com/questions/36754048/if-condition-from-excel-to-vba", "title": "IF condition from excel to VBA", "body": "<p>I'm confused on how to pass this problem from excel to VBA:</p>\n\n<p>In excel:</p>\n\n<p>Theoric:</p>\n\n<pre><code>=IF(cond1, IF(cond2, statement1,statement2),IF(cond2,statement3,statement4))\n</code></pre>\n\n<p>Actual excel cells:</p>\n\n<pre><code>=IF($B$2=\"USD\",IF($B$170=\"USD\",B173,B173/B$1),IF($B$170=\"USD\",B173*B$1,B173))\n</code></pre>\n\n<p>In VBA:</p>\n\n<pre><code>If cond1 Then\nIf cond2 Then\nStatement1\nElse\nStatement2\nEnd if\nElseif cond2 Then\nstatement3\nElse\nstatement4\nEnd if\n</code></pre>\n\n<p>Would it be ok ?</p>\n"}, {"tags": ["vba", "excel", "highlight", "vlookup"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461181278, "post_id": 36753332, "comment_id": 61087422, "body": "What&#39;s wrong with conditional formatting with a <code>countif</code> inside? Any particular reason for using a complicated and strange VBA macro?"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461181868, "post_id": 36753332, "comment_id": 61087807, "body": "how will the conditional formatting work in such a case?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461181922, "post_id": 36753332, "comment_id": 61087833, "body": "Very well, actually. :) Give me a minute, let me write up an answer."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461182034, "post_id": 36753332, "comment_id": 61087906, "body": "Do you want to highlight cells on Sheet1 or Sheet2? Highlight cells with <b>no</b> match on the other sheet?"}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461182195, "post_id": 36753332, "comment_id": 61088024, "body": "Highlight in sheet 2. Highlight cells with no match on the other sheet"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461182744, "post_id": 36753332, "comment_id": 61088399, "body": "This code is pretty far from working, conditional formatting is faster, cheaper and shinier. See my answer. :)"}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1461183986, "post_id": 36754088, "comment_id": 61089225, "body": "@James Cool, glad I could help. Mark it as answer then? :)"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 2, "last_activity_date": 1461183004, "last_edit_date": 1461183004, "creation_date": 1461182687, "answer_id": 36754088, "question_id": 36753332, "link": "https://stackoverflow.com/questions/36753332/highlight-unique-values-based-on-another-range/36754088#36754088", "title": "Highlight unique values based on another range", "body": "<p>Assuming you have data on Sheet1!A1:A15 and Sheet2!A1:A10.</p>\n\n<p>Also assuming you want to highlight unique cells (ones withouth at least one identical in the other list) on Sheet2.</p>\n\n<p>Basically you want to format all the cells that if counted on the other list comes up with 0. The steps:</p>\n\n<ol>\n<li>Select all the cells to be evaluated on Sheet2</li>\n<li>Go to <code>Home</code>/<code>Styles</code>/<code>Conditional Formatting</code></li>\n<li>Select <code>New Rule</code>, then <code>Use a formula to determine...</code></li>\n<li>Enter this formula: <code>=COUNTIF(Sheet1!$A$1:$A$5,A1)=0</code></li>\n<li>Click on the Format button, and set up a formatting for the unique cells</li>\n<li>OK</li>\n<li>Profit. :)</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/sEMYa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sEMYa.png\" alt=\"Conditional formatting\"></a></p>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 36754088, "answer_count": 1, "score": 0, "last_activity_date": 1461183004, "creation_date": 1461180368, "last_edit_date": 1461182915, "question_id": 36753332, "link": "https://stackoverflow.com/questions/36753332/highlight-unique-values-based-on-another-range", "title": "Highlight unique values based on another range", "body": "<p>Column 1 is in Sheet1 and column 2 is in Sheet2. If the value is not found , then highlight that cell. I am trying to do a vlookup comparing two columns. I think the <strong>Syntax is incorrect</strong>.  Please see my code I was trying below:</p>\n\n<pre><code>Option Explicit\n\nSub VlookupColoums()\n   ' declarations\n    Dim lookFor As Range\n    Dim srchRange As Range\n    Dim I As Long\n    Dim vtest As Variant\n    ' start\n    Set lookFor = Sheets(\"Sheet1\").Range(\"A13\").End(xlUp)\n  Set srchRange = Sheets(\"Sheet2\").Range(\"A2\").End(xlUp)\n  vtest = Application.VLookup(lookFor.Rows.Count, srchRange.Rows.Count, 2, False)\n    ' process\n   For I = 1 To lookFor.Rows.Count\n    If IsError(vtest) Then\nsrchRange.Interior.Color = 4\nElse\nExit Sub\nEnd If\nNext I\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1461180903, "post_id": 36753223, "comment_id": 61087208, "body": "Did you try to debug and see at which line is the error coming?"}, {"owner": {"reputation": 1, "user_id": 6232074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ec283afa14ca70d078f84646f6c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hon", "link": "https://stackoverflow.com/users/6232074/andrew-hon"}, "reply_to_user": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1461181265, "post_id": 36753223, "comment_id": 61087413, "body": "Error occurs right after Cells.Select"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461181515, "post_id": 36753223, "comment_id": 61087572, "body": "So at <code>Range(&quot;A9&quot;).Activate</code>? That seems to be all right. Try stepping through your code with F8 while looking at the Excel worksheet (2nd monitor or one side of the screen) and see what goes wrong."}, {"owner": {"reputation": 1, "user_id": 6232074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ec283afa14ca70d078f84646f6c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hon", "link": "https://stackoverflow.com/users/6232074/andrew-hon"}, "edited": false, "score": 0, "creation_date": 1461181879, "post_id": 36753223, "comment_id": 61087813, "body": "After doing some reading there might be a problem with the cells.select? When running through the program it seems to do everything, which is copying the information then pasting it on a new excel sheet, but it is not saving down at the individual place. Thanks in advance guys!"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461182345, "post_id": 36753223, "comment_id": 61088121, "body": "You shouldn&#39;t need Cells.Select - maybe try removing that?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1461182725, "post_id": 36753223, "comment_id": 61088388, "body": "The problem is that Excel does not now on which page it should look.  When using multiple pages one should qualify the range witht he correct parentage.  For example <code>Workbooks(&quot;MyWorkBook&quot;).Sheets(&quot;Sheet1&quot;).Range(&quot;A9&quot;).Copy</code> .  When using the macro recorder it is assumed the active sheet, but when reusing it a lot of times Excel will get confused."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6232074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ec283afa14ca70d078f84646f6c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hon", "link": "https://stackoverflow.com/users/6232074/andrew-hon"}, "edited": false, "score": 0, "creation_date": 1461338031, "post_id": 36754646, "comment_id": 61169219, "body": "Hi gentleman, I wand to just thank you for spending time to help me out with this problem. I am still relatively new to excel and your assistance is greatly appreciated."}, {"owner": {"reputation": 1, "user_id": 6232074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ec283afa14ca70d078f84646f6c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hon", "link": "https://stackoverflow.com/users/6232074/andrew-hon"}, "edited": false, "score": 0, "creation_date": 1461338115, "post_id": 36754646, "comment_id": 61169295, "body": "after using the new code, with executed, there is a new excel sheet that pops up but it is blank, so I am not sure if it copied the values over. This is then followed by the two message boxes. Please assist."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1461184528, "creation_date": 1461184528, "answer_id": 36754646, "question_id": 36753223, "link": "https://stackoverflow.com/questions/36753223/run-time-error-1004-application-defined-or-object-defined-error/36754646#36754646", "title": "Run- Time Error 1004 : Application-defined or object-defined error", "body": "<p>Here is your code with some minor adjustments / improvements (including the ones suggested by @ScottCraner and @Charlie in their comments).</p>\n\n<pre><code>Option Explicit\n\nSub SaveXLST()\n'\n' SaveXLST Macro\n'\nDim monthVal As Integer\nDim dayVal As Integer\nDim yearVal As Integer\nDim xlsNewFile As Workbook\n\nmonthVal = Month(Date)\ndayVal = Day(Date)\nyearVal = Year(Date)\n\nApplication.CutCopyMode = False\n\n'Indicate here from which sheet you want to copy\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"A9\").Copy\nSet xlsNewFile = Workbooks.Add\nSelection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n    , SkipBlanks:=False, Transpose:=False\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nActiveWindow.SmallScroll Down:=-12\nApplication.CutCopyMode = False\nIf Dir(\"c:\\tmp\", vbDirectory) = vbNullString Then\n'If Dir(\"N:\\D\\IG\\C\\~ P\", vbDirectory) &lt;&gt; vbNullString Then\n    MsgBox \"No such path: N:\\D\\IG\\C\\~ P\" &amp; Chr(10) &amp; \"Skipping first save!\"\nElse\n    xlsNewFile.SaveAs Filename:= _\n        \"c:\\tmp\\\" &amp; \"-\" &amp; yearVal &amp; \".\" &amp; Format(monthVal, \"00\") &amp; \".\" &amp; Format(dayVal, \"00\") &amp; \".xlsx\", FileFormat:= _\n        xlOpenXMLWorkbook, CreateBackup:=False\nEnd If\n\n\nIf Dir(\"N:\\D\\IG\\C\\T\\T\", vbDirectory) = vbNullString Then\n    MsgBox \"No such path: N:\\D\\IG\\C\\T\\T\" &amp; Chr(10) &amp; \"Not saving to second location!\"\nElse\n    xlsNewFile.SaveAs Filename:= _\n        \"N:\\D\\IG\\C\\T\\T\" &amp; yearVal &amp; \".\" &amp; Format(monthVal, \"00\") &amp; \".\" &amp; Format(dayVal, \"00\") &amp; \".xlsx\", FileFormat:= _\n        xlOpenXMLWorkbook, CreateBackup:=False\nEnd If\n\nxlsNewFile.Close\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if this solved your problems / errors.</p>\n"}], "owner": {"reputation": 1, "user_id": 6232074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ec283afa14ca70d078f84646f6c4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Hon", "link": "https://stackoverflow.com/users/6232074/andrew-hon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461184528, "creation_date": 1461180039, "last_edit_date": 1461180225, "question_id": 36753223, "link": "https://stackoverflow.com/questions/36753223/run-time-error-1004-application-defined-or-object-defined-error", "title": "Run- Time Error 1004 : Application-defined or object-defined error", "body": "<p>In summary, the code below copies all the information on a sheet and pastes the information on a new excel sheet while keeping the formatting. That document is then saved with the naming convention of the active sheet name and the current date. This sheet is saved in two places and then closes itself. When I run the code all the steps occur but the document does not save into the two folders and the error message pops up and stops the code there. Can you please check out my code and see why it does not work? Thank you in advance! </p>\n\n<pre><code>Sub SaveXLST()\n'\n' SaveXLST Macro\n'\nDim monthVal As Integer\nDim mVal As String\nDim dayVal As Integer\nDim dVal As String\nDim yearVal As Integer\nDim yVal As String\n\nmonthVal = Month(Date)\ndayVal = Day(Date)\nyearVal = Year(Date)\n\nIf monthVal &lt; 10 Then\n   mVal = \"0\" &amp; monthVal\nElse\n   mVal = \"\" &amp; monthVal\nEnd If\n\nIf dayVal &lt; 10 Then\n   dVal = \"0\" &amp; dayVal\nElse\n   dVal = \"\" &amp; dayVal\nEnd If\n\nCells.Select\nRange(\"A9\").Activate\nApplication.CutCopyMode = False\nSelection.Copy\nWorkbooks.Add\nSelection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n    , SkipBlanks:=False, Transpose:=False\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nActiveWindow.SmallScroll Down:=-12\nApplication.CutCopyMode = False\nChDir \"N:\\D\\IG\\C\\~ P\"\nActiveWorkbook.SaveAs Filename:= _\n    \"N:\\D\\IG\\C\\~P\\T\" &amp; \"-\" &amp; yearVal &amp; \".\" &amp; mVal &amp; \".\" &amp; dVal, FileFormat:= _\n    xlOpenXMLWorkbook, CreateBackup:=False\nChDir \"N:\\D\\IG\\C\\T\"\nActiveWorkbook.SaveAs Filename:= _\n    \"N:\\D\\IG\\C\\T\\T\" &amp; \"-\" &amp; yearVal &amp; \".\" &amp; mVal &amp; \".\" &amp; dVal, FileFormat:= _\n    xlOpenXMLWorkbook, CreateBackup:=False\nActiveWindow.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1461179282, "post_id": 36752876, "comment_id": 61086175, "body": "your problem is that whatever method is calling this one is sending in the mail item and you create the excel object in this method.  You should create it in the calling method and pass it as a param to this one that way you don&#39;t create a new instance every time this is called."}, {"owner": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1461180303, "post_id": 36752876, "comment_id": 61086828, "body": "@Sorceri where would be the quickest way for me to learn about the calling method, passing as a parameter, etc. Also, the use of this one and that way, this is my first VB script so more explanation would be helpful. I need it to pass each time I run this script, since this will be ran once a week and I need it to create a new excel file each time. I was trying to reuse the variable strPath, which is why I included it where I did and this is causing the problem? So, I need to create the excel file in the calling method and then pass it where?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1461182555, "post_id": 36752876, "comment_id": 61088291, "body": "You need to open the visual basic editor on the developer tab and in the module that has this code and look for what is calling it CopyToExcel(mailItem) and post that code."}, {"owner": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1461184633, "post_id": 36752876, "comment_id": 61089648, "body": "@Sorceri that is the first line of the code. I pasted the entire script here, didn&#39;t leave anything out."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1461185935, "post_id": 36752876, "comment_id": 61090339, "body": "Updated answer to show you GetObject."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "edited": false, "score": 0, "creation_date": 1461344107, "post_id": 36754211, "comment_id": 61172931, "body": "Thanks for the explanation &amp; example. So this is running &amp; it asks me for EVERY email &quot;this file already exists do you want to overwrite it...&quot; instead of replacing the file, I just need it to open the existing one (the one it creates) and append the next string to it."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "edited": false, "score": 0, "creation_date": 1461344453, "post_id": 36754211, "comment_id": 61173115, "body": "replace the SaveAs with Save since it is an existing document.  If it resolved the issue mark is as answer as well."}, {"owner": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "edited": false, "score": 0, "creation_date": 1461358221, "post_id": 36754211, "comment_id": 61180175, "body": "It works, but doesn&#39;t solve the problem of an incredibly slow task. It&#39;s no longer opening a new instance (and keeping it open) but instead it is opening and closing a new excel instance every time thus causing the process to be even slower. Because I&#39;m thinking in Python, I feel like there should be an else line, If open already exists, open it, leave it open and copy the string to the file then when done end the process."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "edited": false, "score": 0, "creation_date": 1461358722, "post_id": 36754211, "comment_id": 61180377, "body": "Did you remove the xlApp.Quit call?"}, {"owner": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "edited": false, "score": 0, "creation_date": 1461360094, "post_id": 36754211, "comment_id": 61180936, "body": "Ah, yes I removed the xlApp.Quit call but I had instead of xlApp = Nothing as Set xlApp = Nothing. It&#39;s no longer closing each time, still is slower than preferred (5min to process 131 emails) but now it doesn&#39;t kill the excel process when finished so I have to manually kill it."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 0, "last_activity_date": 1461185892, "last_edit_date": 1461185892, "creation_date": 1461183121, "answer_id": 36754211, "question_id": 36752876, "link": "https://stackoverflow.com/questions/36752876/why-does-copying-a-string-from-outlook-to-excel-open-a-new-instance-of-excel-for/36754211#36754211", "title": "Why does copying a string from Outlook to Excel open a new instance of Excel for each email?", "body": "<p>Ok, so you are running this as a rule with a script as the action. Use GetObject to get the current instance and if an error occurs create one.  May also want to remove the quit call as that is exiting out of Excel.</p>\n\n<pre><code>Sub CopyToExcel(olItem As Outlook.MailItem)\n On Error Resume Next\n Dim xlApp as Object\n Dim xlWB As Object\n Dim xlSheet As Object\n Dim xlOpenWB As Object\n Dim vText As Variant\n Dim sText As String\n Dim rCount As Long\n Dim bXStarted As Boolean\n Dim enviro As String\n Dim strPath As String\n Dim Reg1 As RegExp\n Dim M1 As MatchCollection\n Dim M As Match\n Dim xlUp As Long\n Dim FileName As String\n xlUp = -4162\n'try and get the current running object\nSet xlApp = GetObject(, \"Excel.Application\")\nIf Err.Number &lt;&gt; 0 Then 'no object was found so create one\n    Set xlApp = CreateObject(\"Excel.Application\")\n    Err.Clear\nEnd If\nFileName = \"\\Desktop\\newhires\" &amp; Format(Date, \"yyyyMMDD\") &amp; \".xlsx\"\n\nenviro = (Environ(\"USERPROFILE\"))\n\n'the path of the workbook VB function, don't change\n strPath = enviro &amp; FileName\n\n 'Add the workbook to input the data\n     Set xlWB = xlApp.Workbooks.Add()\n     xlWB.SaveAs (strPath)\n\n     Set xlOpenWB = xlApp.Workbooks.Open(strPath)\n     Set xlSheet = xlOpenWB.Sheets(\"newhires\")\n  'Find the next empty line of the worksheet\n     rCount = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(xlUp).Row\n\n     rCount = rCount + 1\n\n'sText is content of the email\n    sText = olItem.Body\n\n    Set Reg1 = New RegExp\n\n    ' \\s* = invisible spaces\n    ' \\d* = match digits\n    ' \\w* = match alphanumeric\n\n    With Reg1\n        .Pattern = \"(Employee Number\\s*[:]\\s*(\\d*))\"\n    End With\n    If Reg1.test(sText) Then\n\n        Set M1 = Reg1.Execute(sText)\n        For Each M In M1\n           vText = Trim(M.SubMatches(1))\n        Next\n    End If\n\n    xlSheet.Range(\"A\" &amp; rCount) = vText\n    vText.RemoveDuplicates Columns:=Array(1)\n    xlOpenWB.Close 1\n  'removed xlApp.Quit\n  xlApp = Nothing\n  Set Reg1 = Nothing\n  Set xlWB = Nothing\n  Set xlSheet = Nothing\n  Set xlOpenWB = Nothing\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6231999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2beb7f27bb801d7261014784617f0938?s=128&d=identicon&r=PG&f=1", "display_name": "Whitni", "link": "https://stackoverflow.com/users/6231999/whitni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36754211, "answer_count": 1, "score": 0, "last_activity_date": 1461265116, "creation_date": 1461178936, "last_edit_date": 1461265116, "question_id": 36752876, "link": "https://stackoverflow.com/questions/36752876/why-does-copying-a-string-from-outlook-to-excel-open-a-new-instance-of-excel-for", "title": "Why does copying a string from Outlook to Excel open a new instance of Excel for each email?", "body": "<p>I've written this script to search an Outlook folder containing a series of emails with a certain string of information in the email body to copy into an Excel file.</p>\n\n<p>When I first created and ran the script there weren't any problems, this is the second time I'm running it and it's excruciatingly slow and froze up my computer. I noticed it seems to be opening a new instance of Excel for each email. </p>\n\n<p>I'm confused because it ran without error the first time, no changes to the script and second time running it, well I couldn't let it finish because the computer froze. Is there any way to not open a new instance for every email?</p>\n\n<p>I'm not interested in revamping the entire code, but if we can make it more efficient in a simple way, count me in. </p>\n\n<p>To be clear, this is run from Outlook as a rule and is run once a week. </p>\n\n<pre><code> Sub CopyToExcel(olItem As Outlook.MailItem)\n Dim xlApp As Object\n Set xlApp = CreateObject(\"Excel.Application\")\n Dim xlWB As Object\n Dim xlSheet As Object\n Dim xlOpenWB As Object\n Dim vText As Variant\n Dim sText As String\n Dim rCount As Long\n Dim bXStarted As Boolean\n Dim enviro As String\n Dim strPath As String\n Dim Reg1 As RegExp\n Dim M1 As MatchCollection\n Dim M As Match\n Dim xlUp As Long\n Dim FileName As String\n xlUp = -4162\n\nFileName = \"\\Desktop\\newhires\" &amp; Format(Date, \"yyyyMMDD\") &amp; \".xlsx\"\n\nenviro = (Environ(\"USERPROFILE\"))\n\n'the path of the workbook VB function, don't change\n strPath = enviro &amp; FileName\n\n 'Add the workbook to input the data\n     Set xlWB = xlApp.Workbooks.Add()\n     xlWB.SaveAs (strPath)\n\n     Set xlOpenWB = xlApp.Workbooks.Open(strPath)\n     Set xlSheet = xlOpenWB.Sheets(\"newhires\")\n  'Find the next empty line of the worksheet\n     rCount = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(xlUp).Row\n\n     rCount = rCount + 1\n\n'sText is content of the email\n    sText = olItem.Body\n\n    Set Reg1 = New RegExp\n\n    ' \\s* = invisible spaces\n    ' \\d* = match digits\n    ' \\w* = match alphanumeric\n\n    With Reg1\n        .pattern = \"(Employee Number\\s*[:]\\s*(\\d*))\"\n    End With\n    If Reg1.test(sText) Then\n\n        Set M1 = Reg1.Execute(sText)\n        For Each M In M1\n           vText = Trim(M.SubMatches(1))\n        Next\n    End If\n\n    xlSheet.Range(\"A\" &amp; rCount) = vText\n    vText.RemoveDuplicates Columns:=Array(1)\n    xlOpenWB.Close 1\n\n  xlApp.Quit\n  Set Reg1 = Nothing\n  Set xlApp = Nothing\n  Set xlWB = Nothing\n  Set xlSheet = Nothing\n  Set xlOpenWB = Nothing\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461178949, "post_id": 36752814, "comment_id": 61085959, "body": "This is pretty ambitious ^_^;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461179341, "post_id": 36752814, "comment_id": 61086216, "body": "It&#39;s tedious to color it by hand but that may be far less tedious than the logic required for a macro?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461179808, "post_id": 36752814, "comment_id": 61086516, "body": "Ahh, I <b><i>highly</i></b> suggest you read through <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid <code>.Select</code></a>, it will save you many headaches, and will help learn how VBA works/thinks."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461192062, "post_id": 36752814, "comment_id": 61092950, "body": "Did you use <code>Option Explicit</code> at the top of your module? I think <code>x1CrissCross</code> should be <code>xlCrissCross</code> or <code>xlPatternCrissCross</code>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6193662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfee15f7df7b13d14a089528f37407b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Terry", "link": "https://stackoverflow.com/users/6193662/alec-terry"}, "edited": false, "score": 0, "creation_date": 1463588761, "post_id": 36784374, "comment_id": 62132199, "body": "Thank you NanoTera.  I think this is what I am looking for.  I appreciate you taking the time"}], "tags": [], "owner": {"reputation": 61, "user_id": 6202530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3975576684610670931111e0886c2a?s=128&d=identicon&r=PG&f=1", "display_name": "NanoTera", "link": "https://stackoverflow.com/users/6202530/nanotera"}, "is_accepted": false, "score": 0, "last_activity_date": 1461296196, "creation_date": 1461296196, "answer_id": 36784374, "question_id": 36752814, "link": "https://stackoverflow.com/questions/36752814/a-macro-that-does-not-properly-recognize-contraints-in-scheduling/36784374#36784374", "title": "A macro that does not properly recognize contraints in scheduling", "body": "<p>One of your issues is to do with the logic of your loop, because you always \"process\" the next cell without testing it (for the holidays). Also as mentioned above the x1crisscross should be xlcrisscross, and I dont think orange is a \"defined\" color so you may need to get the value for that and test against it (see myorange below). </p>\n\n<p>A loop like this would avoid that:</p>\n\n<pre><code>' I think you need to need to define what color orange is - as its not one of the \"standard\" named ones\nmyOrange = 4626167\n\nFor i = 1 To 7\n    Debug.Print Selection.Interior.Color\n    Debug.Print Selection.Interior.Pattern\n\n    If (Selection.Interior.Color = black Or (Selection.Interior.Color = myOrange And Selection.Interior.Pattern = xlCrissCross))  Then\n        ' skip this one so decrement counter\n        i = i - 1\n    Else\n        ' Do the \"stuff\" for a valid cell here - for testing I just put the counter in the cell\n        ActiveCell.Value = i\n    End If\n    ' move to next cell\n    ActiveCell.Offset(0, 1).Select\nNext i\n</code></pre>\n\n<p>Personally I never like fiddling with the \"counter\" like this, it just seems messy to decrement it.</p>\n\n<p>The other way to get the same affect is to have a loop within the for/next loop that keeps checking until it finds a valid cell. </p>\n\n<pre><code>myOrange = 4626167\n\nFor i = 1 To 7\n    found1 = False\n    While Not found1\n        If Not ( Selection.Interior.Color = black Or (Selection.Interior.Color = myOrange And Selection.Interior.Pattern = xlCrissCross))  Then\n            found1 = True\n        Else\n            ' move to next cell as this one isnt available\n            ActiveCell.Offset(0, 1).Select\n        End If\n    Wend\n    ' Do the \"stuff\" for a valid cell here\n     ActiveCell.Value = i\n    ' move to next cell\n    ActiveCell.Offset(0, 1).Select\n\nNext i\n</code></pre>\n\n<p>I also added the test for weekends (black) and holidays into the same If statement (notice the brackets to make sure the or and and are processed correctly). I always tend to put them just to make it clearer.</p>\n\n<p>Of course you could do all this using a counter and \"range\" etc... and not selecting the cell but the end result will be the same.</p>\n\n<p>Both these methods \"could\" loop forever if there are no more valid cells so it might be worth testing for some maximum column count and breaking out if you reach that. </p>\n"}], "owner": {"reputation": 37, "user_id": 6193662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfee15f7df7b13d14a089528f37407b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Terry", "link": "https://stackoverflow.com/users/6193662/alec-terry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461296196, "creation_date": 1461178745, "last_edit_date": 1461178801, "question_id": 36752814, "link": "https://stackoverflow.com/questions/36752814/a-macro-that-does-not-properly-recognize-contraints-in-scheduling", "title": "A macro that does not properly recognize contraints in scheduling", "body": "<p>I am working on a macro that provides a visual representation of the 4 different production phases of a product we produce. The spreadsheet is set up to appear as a linear calendar, showing all 365 days of the year and grouping them into calendar weeks. Each production phase has a different color associated with it. The four buildphases are: 1) Assembly: 1 day (yellow) 2) Initial analysis: 1 day (purple) 3) In-depth analysis: 7 days (green) 4) Shipping: 1 day (red)</p>\n\n<p>No work is performed in the facility on weekends or holidays. Saturdays and sundays are represented by cells colored black and holidays are represented by cells colored orange and having a criss cross pattern. The macro is designed to skip these holidays using the following if then statement:</p>\n\n<pre><code>Dim i As Integer\n\ni = Analysis days\n\nfor i = 1 to 7\n\nActiveCell.Select\n\nIf Selection.Interior.Pattern = x1CrissCross And Selection.Interior.Color = orange Then\n\n    ActiveCell.Offset(0, 1).Select\n\nElse: ActiveCell.Select\n\nEnd If\n\nIf Selection.Interior.Color = black Then\n\n    ActiveCell.Offset(0, 2).Select\n\nElse: ActiveCell.Select\n\nEnd If\n</code></pre>\n\n<p>The If Then statement that tells the macro to skip Saturday and Sunday works every time. But the statement that tells the macro to skip holidays only works part of the time, and if the holidays last longer than a few days (Christmas vacation lasts nine days) the macro inserts production work days interspersed throughout the holiday. I've found that copying and pasting the above statements directly beneath one another several times seems to provide a quick fix of the issue. But I am sure there has to be a more efficient way to do this. Does anyone know of a way I can fix the issue without having to copy and paste the same lines of code mulitple times? </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "dictionary"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461181800, "post_id": 36752799, "comment_id": 61087759, "body": "Any code? What have you tried? You need to show some effort, so that we can help you with it."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6058587"}, "is_accepted": false, "score": 0, "last_activity_date": 1461948424, "creation_date": 1461948424, "answer_id": 36943623, "question_id": 36752799, "link": "https://stackoverflow.com/questions/36752799/use-vba-to-pull-store-locations/36943623#36943623", "title": "Use VBA to pull store locations", "body": "<p>I don't think you can do it on those javascript sites.  VBA works great with HTML, but not so great with javascript and flash.  Also, the code isn't even exposed, so the search results must be generated dynamically from the server.  I just did a search on that freshpet site and got the results then did a right-click and viewed the source code and nothing that I searched for was in the code.</p>\n"}], "owner": {"reputation": 9, "user_id": 6156102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f97d84ec472eb614969d9d31e2bd6712?s=128&d=identicon&r=PG&f=1", "display_name": "user6156102", "link": "https://stackoverflow.com/users/6156102/user6156102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1461948424, "creation_date": 1461178702, "question_id": 36752799, "link": "https://stackoverflow.com/questions/36752799/use-vba-to-pull-store-locations", "title": "Use VBA to pull store locations", "body": "<p>I am trying to pull all the store locations from several different websites, for example Sephora <a href=\"http://www.sephora.com/store-locations-events\" rel=\"nofollow\">http://www.sephora.com/store-locations-events</a> and Freshpet <a href=\"http://freshpet.com/storelocator/\" rel=\"nofollow\">http://freshpet.com/storelocator/</a>. </p>\n\n<p>Every site constrains the radius for the search, so to find all locations, the only thing I have come up with is cycling through every zip code and then filtering out duplicates. Is there a way to use VBA to manipulate the search radius using VBA to just search the entire United States, instead of only up to 100 miles? That way, I could just do one search for each of these sites.  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1461178339, "post_id": 36752612, "comment_id": 61085558, "body": "K is a range not a integer."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1461178698, "post_id": 36752612, "comment_id": 61085793, "body": "row A ? I thinkk you meant column A."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1461178767, "post_id": 36752612, "comment_id": 61085835, "body": "@newguy each cell in the first row I believe even though code is looping <code>B1 to L something</code> XD"}, {"owner": {"reputation": 25, "user_id": 6210464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gj_sdnHxypM/AAAAAAAAAAI/AAAAAAAAABw/_5omunQjSW4/photo.jpg?sz=128", "display_name": "tamara smith", "link": "https://stackoverflow.com/users/6210464/tamara-smith"}, "edited": false, "score": 0, "creation_date": 1461179875, "post_id": 36752612, "comment_id": 61086554, "body": "How do I make sure the worksheet range goes all the way though to the end? should I do sht.Range(&quot;A1:A&quot; &amp; lastRow).Cells"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6210464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gj_sdnHxypM/AAAAAAAAAAI/AAAAAAAAABw/_5omunQjSW4/photo.jpg?sz=128", "display_name": "tamara smith", "link": "https://stackoverflow.com/users/6210464/tamara-smith"}, "edited": false, "score": 0, "creation_date": 1461181112, "post_id": 36753391, "comment_id": 61087317, "body": "Is there anyway to highlight the row that has only 60 or 59 characters? I ran it and the macro completes but I cannot tell if it worked since it does not highlight the line"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 25, "user_id": 6210464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gj_sdnHxypM/AAAAAAAAAAI/AAAAAAAAABw/_5omunQjSW4/photo.jpg?sz=128", "display_name": "tamara smith", "link": "https://stackoverflow.com/users/6210464/tamara-smith"}, "edited": false, "score": 0, "creation_date": 1461181319, "post_id": 36753391, "comment_id": 61087449, "body": "@tamarasmith See edit. Replace whole code I made a typo."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1461181250, "last_edit_date": 1461181250, "creation_date": 1461180563, "answer_id": 36753391, "question_id": 36752612, "link": "https://stackoverflow.com/questions/36752612/how-to-search-through-column-a-for-60-or-59-characters-then-highlight-row-with-p/36753391#36753391", "title": "How to search through column A for 60 or 59 characters then highlight row with purple", "body": "<p>When adding or subtracting rows it is best to loop backwards.</p>\n\n<p>The previous loop was looping through every cell except Column A so it would never return true, thus it was doing nothing.</p>\n\n<p>Try this:</p>\n\n<pre><code>Dim k As Long\nDim lastRow As Integer\nDim sht As Worksheet\n\nSet sht = ActiveSheet\nlastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nFor k = lastRow To 1 Step -1\n    If Len(sht.Cells(k, 1).Value) = 60 Or Len(ht.Cells(k, 1).Value) = 59 Then\n        Rows(k).Interior.Color = 24\n        Rows(k).Insert Shift:=xlDown\n    End If\nNext k\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6210464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gj_sdnHxypM/AAAAAAAAAAI/AAAAAAAAABw/_5omunQjSW4/photo.jpg?sz=128", "display_name": "tamara smith", "link": "https://stackoverflow.com/users/6210464/tamara-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 36753391, "answer_count": 1, "score": 0, "last_activity_date": 1461181250, "creation_date": 1461178212, "last_edit_date": 1531164843, "question_id": 36752612, "link": "https://stackoverflow.com/questions/36752612/how-to-search-through-column-a-for-60-or-59-characters-then-highlight-row-with-p", "title": "How to search through column A for 60 or 59 characters then highlight row with purple", "body": "<p>The code below is suppose to search for cells in column A that only have 60 or 59 characters and then highlight the row and add a line below. The code will run but will not add any color or add lines, please help</p>\n\n<pre><code>Dim k As Range\nDim lastRow As Integer\nDim sht As Worksheet\n\n    Set sht = Worksheets.Select\n    lastRow = sht.Cells(Rows.Count, \"A\").End(xlUp).Row   \n\nFor Each k In sht.Range(\"B1:L\" &amp; lastRow).Cells\nIf Len(k.Value) = 60 Or Len(k.Value) = 59 Then\n    k.EntireRow.Cells(1).Interior.Color = 24\n    Selection.Insert Shift:=xlDown\n    End If\n    Exit For\n\nNext k\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461177909, "post_id": 36752227, "comment_id": 61085312, "body": "All this time you spent editing your question, you could be researching for an answer you know."}, {"owner": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461178398, "post_id": 36752227, "comment_id": 61085600, "body": "I have tried ,But not getting the exact result ,,so i posted here"}, {"owner": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461178486, "post_id": 36752227, "comment_id": 61085662, "body": "And final editing done  now plz help with this"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461178594, "post_id": 36752227, "comment_id": 61085723, "body": "Oh ok. Well, no one is going to download a file from some stranger on the internet so you&#39;re going to have to format your data properly before anyone can help you :/"}, {"owner": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461178865, "post_id": 36752227, "comment_id": 61085911, "body": "Can i have your mail id,So that i can send you the files,if pssible"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461179003, "post_id": 36752227, "comment_id": 61085997, "body": "You miss my point XD No one is going to risk opening a random file from the internet :/"}], "owner": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513612371, "creation_date": 1461177003, "last_edit_date": 1513612371, "question_id": 36752227, "link": "https://stackoverflow.com/questions/36752227/copy-specific-values-from-text-file-to-another-excel-sheet-using-vba", "title": "copy specific values from text file to another excel sheet using vba", "body": "<p><a href=\"https://www.dropbox.com/s/frevwb1ovafpynp/Expected_Result.xlsx?dl=0\" rel=\"nofollow noreferrer\">This is the result what i want</a>\n<a href=\"https://www.dropbox.com/s/oigqpn15ou84b3e/Source.txt?dl=0\" rel=\"nofollow noreferrer\">This is the source file link</a></p>\n\n<p>I am trying to extract certain data from a text</p>\n\n<p><code>file(C:\\Users\\mondals\\Desktop\\Source.txt)</code> into an Excel spreadsheet. I'm using MS Office 2010 . I saved my files as TEXT formatted files and now I need to pull information from the text files.Here is a list of the information I need to extract from the text file:\nLines starting with</p>\n\n<pre><code>103 0 TestTime\n203 0 TestTime\n303 0 TestTime\n403 0 TestTime\n503 0 TestTime\n603 0 TestTime\n703 0 TestTime\n803 0 TestTime\n</code></pre>\n\n<p>Example: </p>\n\n<pre><code>103 0 TestTime -1 0.0000 mSec 60.3948 mSec 4000.0000 mSec 0.0000 m 0\n</code></pre>\n\n<p>from this lines I want to copy 60.3948 and so on.</p>\n\n<p>Note: Please go through the attached doc Result.xlsx</p>\n\n<p>And ....</p>\n\n<p>from following line i want copy the values</p>\n\n<pre><code>104 0 TimeStdDev\n204 0 TimeStdDev\n304 0 TimeStdDev\n404 0 TimeStdDev\n504 0 TimeStdDev\n604 0 TimeStdDev\n704 0 TimeStdDev\n804 0 TimeStdDev\n</code></pre>\n\n<p>Example: 104 0 TimeStdDev -1 0.0000 mSec 2.6139 mSec 10000.0000 mSec 0.0000 m 0\nfrom this line i have to copy 2.6139.</p>\n\n<p>Attached sample txt           file and required output excel file</p>\n\n<p>txt file=Source.txt          this thetxt  file i have</p>\n\n<p>Xlsx file= Result.xlsx    This is the excel i want</p>\n\n<p>Note: Please go through the links n the top</p>\n\n<p>Really appreciate your help!!!! </p>\n\n<p>Here\"s what i have tried </p>\n\n<pre><code>Sub Demo()\n    v = ThisWorkbook.Path &amp; \"C:\\Users\\subhajit\\Desktop\\Autmation\\data.txt\"\n    If Dir(v) = \"\" Then Beep: Exit Sub\n    F% = FreeFile\n    Open v For Input As #F\n    v = Filter(Filter(Split(Input(LOF(F), #F), vbNewLine), vbTab), \"TestTime Avg\")\n    Close #F\n    If UBound(v) &lt; 0 Then Beep: Exit Sub\n    ReDim VA#(0 To UBound(v), 0)\n    For F = 0 To UBound(v):  VA(F, 0) = Val(Split(v(F), vbTab)(1)):  Next\n    With Worksheets(1).Cells(1)\n       .CurrentRegion.Clear\n        Resize(F).Value = VA\n    End With\n    v = ThisWorkbook.Path &amp; \"C:\\Users\\subhajit\\Desktop\\Autmation\\data.txt\"\n    If Dir(v) = \"\" Then Beep: Exit Sub\n    F% = FreeFile\n    Open v For Input As #F\n    v = Filter(Filter(Split(Input(LOF(F), #F), vbNewLine), vbTab), \"TestTime StdDev\")\n    Close #F\n    If UBound(v) &lt; 0 Then Beep: Exit Sub\n    ReDim VA#(0 To UBound(v), 0)\n    For F = 0 To UBound(v):  VA(F, 0) = Val(Split(v(F), vbTab)(1)):  Next\n    With Worksheets(1).Cells(2)\n       'CurrentRegion.Clear = False\n       .Resize(F).Value = VA\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461176406, "post_id": 36751975, "comment_id": 61084423, "body": "You didn&#39;t test for <code>ByVal Sh As Object</code>. Edit: you want <code>sheet_change</code> not <code>workbook_sheetchange</code>."}, {"owner": {"reputation": 31, "user_id": 6231714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8a4ec008c33e9ca7defae402d7fcbe?s=128&d=identicon&r=PG&f=1", "display_name": "zjv", "link": "https://stackoverflow.com/users/6231714/zjv"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461245136, "post_id": 36751975, "comment_id": 61119360, "body": "@findwindow Thanks for the feedback! I tried Worksheet_Change(ByVal Target As Range) first, and it didn&#39;t work. I can&#39;t run this in the immediate window to see where it is failing either"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461249073, "post_id": 36751975, "comment_id": 61122534, "body": "Please edit your OP with updated code."}, {"owner": {"reputation": 31, "user_id": 6231714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8a4ec008c33e9ca7defae402d7fcbe?s=128&d=identicon&r=PG&f=1", "display_name": "zjv", "link": "https://stackoverflow.com/users/6231714/zjv"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461260908, "post_id": 36751975, "comment_id": 61130485, "body": "@findwindow Hi, I just updated my question, hope it is clearer! Any advice would be greatly appreciated"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461265571, "post_id": 36751975, "comment_id": 61133099, "body": "There is something seriously off... There is an <code>End If</code>, but there is no block <code>If</code> statement... This code is not supposed to work at all."}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461265697, "post_id": 36778253, "comment_id": 61133156, "body": "<code>Target.column</code> is nice, but it is not the same as <code>Intersect(Target, range(&quot;v:v&quot;))</code>. What if you update range(&quot;u1:z1&quot;)?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461265812, "post_id": 36778253, "comment_id": 61133218, "body": "@vacip OP&#39;s condition was column V. Never said anything about updating range. And even if OP were to update range, <code>intersect</code> still would break. So not sure what you&#39;re trying to get at here."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1461266189, "post_id": 36778253, "comment_id": 61133418, "body": "Worksheet_Change runs every time a range - any range - is changed. Updated. This can be a single cell, in which case your code does the same as OP&#39;s. Or it can be several cells, in which case it is not the same. Is that more clear now?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461266268, "post_id": 36778253, "comment_id": 61133466, "body": "No need to get defensive, I&#39;m not saying what you did is wrong. I merely point out a small fact that seems to have eluded you."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1461266482, "post_id": 36778253, "comment_id": 61133595, "body": "Oh. Misunderstood what you meant when you said update. It makes sense that the two is different but I can&#39;t make the distinction in logic. But thanks, will play with it."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 2, "last_activity_date": 1461267179, "last_edit_date": 1461267179, "creation_date": 1461265125, "answer_id": 36778253, "question_id": 36751975, "link": "https://stackoverflow.com/questions/36751975/vba-worksheet-change-for-pasting-value-from-one-sheet-to-another-is-not-working/36778253#36778253", "title": "vba worksheet_change for pasting value from one sheet to another is not working, but works manually", "body": "<p>This works for me. This goes in <code>SheetA</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, WorkSheets(\"A\").Range(\"V:V\")) Is Nothing Then\n\n    'Application.EnableEvents = False\n\n    thisrow = Target.Row\n    Debug.Print thisrow\n\n    WorkSheets(\"B\").Cells(12, 1).Value = WorkSheets(\"A\").Cells(thisrow, 1).Value\n\n    'Application.EnableEvents = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Edit: per vacip's comment.</p>\n"}], "owner": {"reputation": 31, "user_id": 6231714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8a4ec008c33e9ca7defae402d7fcbe?s=128&d=identicon&r=PG&f=1", "display_name": "zjv", "link": "https://stackoverflow.com/users/6231714/zjv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1552681616, "creation_date": 1461176224, "last_edit_date": 1552681616, "question_id": 36751975, "link": "https://stackoverflow.com/questions/36751975/vba-worksheet-change-for-pasting-value-from-one-sheet-to-another-is-not-working", "title": "vba worksheet_change for pasting value from one sheet to another is not working, but works manually", "body": "<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n\n    If Intersect(target, Worksheets(\"SheetA\").Range(\"V:V\")) Is Nothing Then \n        Application.EnableEvents = False\n        thisrow = target.Row\n        Worksheets(\"SheetB\").Cells(12, 1).Value = Worksheets(\"SheetA\").Range(\"A\" &amp; thisrow).Value\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I am trying to populate SheetB's cell A12 under the condition that SheetA's Column V was triggered, and the value I am assigning SheetB A12 is the A&amp;the row of the trigger.</p>\n\n<p>However, I can't seem to get the code to work. </p>\n\n<p>If someone can point out what's wrong with the code that would be great!\nAnd I was wondering if anyone has tips on debugging subs like Workbook_SheetChange/ worksheet_change</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I posted my new code, instead of using workbook_sheetchange, I am trying worksheet_change.</p>\n\n<p>It is still not working, however, when I run it manually it does work. And in the immediate window, I type \"? Application.EnableEvents = True\" and it returns true.</p>\n"}, {"tags": ["excel", "vba", "sap"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461177012, "post_id": 36751819, "comment_id": 61084781, "body": "Would the line <code>Set Connection = Sap_Application.Children(0)</code> throw an error if the connection cannot be made? You can use the debugger, Watches window to inspect the object that you get. You should be able to click down to <code>Connection.Children</code>"}, {"owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461177437, "post_id": 36751819, "comment_id": 61085047, "body": "I have taken a screenshot of the debugger right before the line that error&#39;s out executes"}, {"owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461177469, "post_id": 36751819, "comment_id": 61085064, "body": "So it looks like Children is empty, but I&#39;m not sure why that would be.  Am I opening SAP incorrectly?"}], "answers": [{"tags": [], "owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "is_accepted": true, "score": 0, "last_activity_date": 1461334234, "last_edit_date": 1461334234, "creation_date": 1461184923, "answer_id": 36754766, "question_id": 36751819, "link": "https://stackoverflow.com/questions/36751819/sap-gui-scripting-error-the-enumerator-of-the-collection-cannot-find-an-elemen/36754766#36754766", "title": "SAP GUI Scripting Error, &quot;The Enumerator of the collection cannot find an element with the specified index.&quot;", "body": "<p>I think something else I installed (or maybe even my company's updating scripts), messed up the vba support that is installed when you install SAP.</p>\n\n<p>Re installing the SAP Logon application fixed my issue</p>\n\n<p>(if someone else gives a better reason to WHY this happened, I'll accept that answer)</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6743979, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d06deedae9e294112c86a3fcaf5f563b?s=128&d=identicon&r=PG", "display_name": "Anonygreat", "link": "https://stackoverflow.com/users/6743979/anonygreat"}, "is_accepted": false, "score": 0, "last_activity_date": 1471874641, "creation_date": 1471874641, "answer_id": 39081627, "question_id": 36751819, "link": "https://stackoverflow.com/questions/36751819/sap-gui-scripting-error-the-enumerator-of-the-collection-cannot-find-an-elemen/39081627#39081627", "title": "SAP GUI Scripting Error, &quot;The Enumerator of the collection cannot find an element with the specified index.&quot;", "body": "<p>I know it's old, but probably might help someone else.\nI don't know the reason for this, out of the blue started having problems with my scripts. I recorded a new operation to see what SAP would write for those actions (since that part of the code is standard for the connection). \nSame code, same problem. </p>\n\n<p>Fix (or at least temporary):\nChange the number of the child being searched.\nPrevious code:</p>\n\n<pre><code>*Set Connection = Sap_Application.Children(0)*\n</code></pre>\n\n<p>New code:</p>\n\n<pre><code>*Set Connection = Sap_Application.Children(1)*\n</code></pre>\n\n<p>Not sure what the difference is, I know that if you also change the number in this line:</p>\n\n<pre><code>*Set session = Connection.Children(0) 'This is the line that causes the error*\n</code></pre>\n\n<p>the execution takes place in the second session, if you do change this one, also have to change the previous line of code.</p>\n\n<p>Hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12355763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586da4fc9675f8b7fb9a4085d1fd665b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/12355763/marcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1573479820, "creation_date": 1573479820, "answer_id": 58802572, "question_id": 36751819, "link": "https://stackoverflow.com/questions/36751819/sap-gui-scripting-error-the-enumerator-of-the-collection-cannot-find-an-elemen/58802572#58802572", "title": "SAP GUI Scripting Error, &quot;The Enumerator of the collection cannot find an element with the specified index.&quot;", "body": "<p>Had the same problem and found this thread, so I'm reviving it with the solution that worked for me:</p>\n\n<p>Scripting is probably deativated.\nsapgui/user_scripting must be set to true</p>\n"}], "owner": {"reputation": 1080, "user_id": 4993526, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10203437109768535/picture?type=large", "display_name": "dustinroepsch", "link": "https://stackoverflow.com/users/4993526/dustinroepsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10074, "favorite_count": 1, "accepted_answer_id": 36754766, "answer_count": 3, "score": 3, "last_activity_date": 1573479820, "creation_date": 1461175667, "last_edit_date": 1461177407, "question_id": 36751819, "link": "https://stackoverflow.com/questions/36751819/sap-gui-scripting-error-the-enumerator-of-the-collection-cannot-find-an-elemen", "title": "SAP GUI Scripting Error, &quot;The Enumerator of the collection cannot find an element with the specified index.&quot;", "body": "<p>A few weeks ago I generated a script via SAP's built in GUI scripting functionality, and then put the vba in an excel document and attached it to a button. </p>\n\n<p>this worked perfectly fine for few weeks, however now when I press  the button I get this error:\n<code>\"The enumerator of the collection cannot find en element with the specified index.\"</code> on the line that says <code>Set session = Connection.Children(0)</code>\nHere is a snippet of code</p>\n\n<pre><code>If Not IsObject(Sap_Application) Then\n    Set SapGuiAuto = GetObject(\"SAPGUI\")\n    Set Sap_Application = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n    Set Connection = Sap_Application.Children(0)\nEnd If\nIf Not IsObject(session) Then\n    Set session = Connection.Children(0) 'This is the line that causes the error\nEnd If\nIf IsObject(WScript) Then\n    WScript.ConnectObject session, \"on\"\n    WScript.ConnectObject Sap_Application, \"on\"\nEnd If\n</code></pre>\n\n<p>I have SAP open and I'm logged in, and all of the code in the snippet was generated by SAP gui scripting.</p>\n\n<p>I tried a few solutions I saw online (like adding some ocx files that were in my sap install folder into my excel addons) but nothing seems to be working.</p>\n\n<p>I was wondering if anyone on here has ran into a similiar problem, and know how I can successfully open an SAP session in my vba.</p>\n\n<p>EDIT FROM COMMENTS:</p>\n\n<p>When I inspect the connection object this is what I see. It looks like Children length is 0. </p>\n\n<p><a href=\"https://i.stack.imgur.com/EZqCC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EZqCC.png\" alt=\"Debugger View\"></a></p>\n"}, {"tags": ["vba", "variables", "scope"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1461180643, "post_id": 36751682, "comment_id": 61087050, "body": "I agree with Peter&#39;s Answer and with Thomas&#39;s statement that general accepted practic is to declare variables at the top of a procedure. &quot;Global&quot; variables <i>must</i> be at the top of a module, before any procedures. The only &quot;scopes&quot; VBA recognizes is &quot;global&quot; (Public, module-level),  module-level (Private, module-level) vs. procedure level. There are no &quot;block scopes&quot;, such as within If."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1596211168, "post_id": 36751682, "comment_id": 111748938, "body": "&quot;Instantiated&quot; is about <i>objects being created</i>, I&#39;d avoid using it in another context; the correct word would be &quot;initialized&quot;, I believe."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1461181681, "post_id": 36752828, "comment_id": 61087689, "body": "That is not correct regarding to when procedure variables are created. They are created when the procedure begins execution (lifetime), but are inaccessible before the point of declaration (scope)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1596210953, "post_id": 36752828, "comment_id": 111748855, "body": "<i>always declare your variables at one place, on top of your module or sub/function, and avoid doing it in the middle of your code, for the sake of clarity only</i> - this is how we get 30 variables in a wall of declarations at the top of a scope, 10 of which are never used, 4 have a useless name followed by a digit, ...I&#39;ll never understand why declaring closer to usage is best for readability <i>in any language other than VBA</i>. This isn&#39;t personal preference, it&#39;s part of the well-outdated set of &quot;best practices&quot; from the 90s, needs to be left in the past with Hungarian Notation."}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1461182008, "last_edit_date": 1525816150, "creation_date": 1461178799, "answer_id": 36752828, "question_id": 36751682, "link": "https://stackoverflow.com/questions/36751682/when-are-vba-variables-instantiated/36752828#36752828", "title": "When are VBA Variables Instantiated", "body": "<p>The variables, constants, and objects, are instantiated that way :</p>\n\n<ul>\n<li><p>at <strong>module</strong> level they are instantiated when the application starts, whether they are declared <code>public</code>, <code>private</code> or <code>static</code></p></li>\n<li><p>at <strong>procedure</strong> level (sub/function) they are instantiated when the procedure is executed. </p></li>\n</ul>\n\n<p>You have to understand that, although it does have a \"compiler\", <strong>vba is NOT a true compiled language</strong>. The compiler is a syntax checker that checks for errors in your code to not encounter them at runtime. In MS access the compiler produce something that is called <strong>p-code</strong> and which is a combination of <em>compiled</em> and <em>interpreted</em> code.</p>\n\n<p>As a rule of thumb: </p>\n\n<ul>\n<li><p>always use <code>option explicit</code> statement (configure your compiler for this)</p></li>\n<li><p>always declare your variables at one place, on top of your module or sub/function, and avoid doing it in the middle of your code, for the sake of clarity only. This doesn't affect the performance in any way.</p></li>\n<li><p>avoid using <code>variant</code> data type</p></li>\n</ul>\n\n<p>Worth a read doc: \n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg278427.aspx\" rel=\"nofollow noreferrer\">Understanding the Lifetime of Variables</a> (official mSDN), <a href=\"https://support.microsoft.com/en-us/kb/109382\" rel=\"nofollow noreferrer\">Visual/Access Basic Is Both a Compiler and an Interpreter</a> (official MS) and <a href=\"http://www.cpearson.com/excel/declaringvariables.aspx\" rel=\"nofollow noreferrer\">Declaring variables</a>. You might also find interesting this answer I recently gave about the <a href=\"https://stackoverflow.com/questions/36118919/vba-function-returned-value-after-call/36121300#36121300\">vba garbage collector</a></p>\n"}, {"comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1461238412, "post_id": 36752837, "comment_id": 61114121, "body": "Thank you, that is exactly the documentation I was looking for."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 5, "last_activity_date": 1461178820, "last_edit_date": 1592644375, "creation_date": 1461178820, "answer_id": 36752837, "question_id": 36751682, "link": "https://stackoverflow.com/questions/36751682/when-are-vba-variables-instantiated/36752837#36752837", "title": "When are VBA Variables Instantiated", "body": "<p>According to the <a href=\"https://msdn.microsoft.com/en-us/library/ee440517(v=office.12).aspx\" rel=\"nofollow noreferrer\">reference documentation</a>,</p>\n<blockquote>\n<p>When a procedure begins running, all variables are initialized. A numeric variable is initialized to zero, a variable-length string is initialized to a zero-length string (&quot;&quot;), and a fixed-length string is filled with the character represented by the ASCII character code 0, or Chr(0). Variant variables are initialized to Empty. Each element of a user-defined type variable is initialized as if it were a separate variable.</p>\n<p>When you declare an object variable, space is reserved in memory, but its value is set to Nothing until you assign an object reference to it using the Set statement.</p>\n</blockquote>\n<p>The implication is that regardless of where the variable declaration is stated, the space/memory for it is allocation when the procedure is entered.</p>\n"}], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 1, "accepted_answer_id": 36752837, "answer_count": 2, "score": 4, "last_activity_date": 1461182008, "creation_date": 1461175253, "last_edit_date": 1495540952, "question_id": 36751682, "link": "https://stackoverflow.com/questions/36751682/when-are-vba-variables-instantiated", "title": "When are VBA Variables Instantiated", "body": "<p>I'm hesitant to ask, but there's no documentation that I can find <strong>for VBA</strong>.</p>\n\n<p>Relevant (but I don't think a dupe): </p>\n\n<ul>\n<li><strong>C++</strong> <a href=\"https://stackoverflow.com/questions/19618801/when-are-global-variables-created\">When are global variables created?</a> </li>\n<li><a href=\"https://stackoverflow.com/questions/1411463/in-java-should-variables-be-declared-at-the-top-of-a-function-or-as-theyre-ne\">In Java, should variables be declared at the top of a function, or as they&#39;re needed?</a></li>\n<li><strong>C++</strong> <a href=\"https://stackoverflow.com/questions/3773396/declare-variables-at-top-of-function-or-in-separate-scopes\">Declare variables at top of function or in separate scopes?</a> </li>\n<li>and the most likely relevant <a href=\"https://stackoverflow.com/questions/14366432/when-are-a-modules-variables-in-vb-net-instantiated\">When are a module&#39;s variables in VB.NET instantiated?</a> </li>\n<li>I also took a look at <a href=\"https://softwareengineering.stackexchange.com/questions/113262/why-declare-variables-close-to-where-they-are-used\">C# on programmers.SE</a>.</li>\n</ul>\n\n<p>I think I'm using the word \"Instantiate\" right, but please correct me if I'm wrong. <em>Instantiating</em> is when a variable is created and allocated the resources it requires? So in VBA I see two ways of doing this.</p>\n\n<p>Everything at the top!</p>\n\n<pre><code>Public Sub ToTheTop()\n    Dim var1 As Long\n    Dim var2 As Long\n    Dim var3 As Long\n\n    var1 = 10\n    var2 = 20\n    var3 = var1 + var1\n    Debug.Print var3\nEnd Sub\n</code></pre>\n\n<p>Or close to use</p>\n\n<pre><code>Public Sub HoldMeCloser()\n    Dim var1 As Long\n    var1 = 10\n    Dim var2 As Long\n    var2 = 20\n    Dim var3 As Long\n\n    var3 = var1 + var1\n    Debug.Print var3\nEnd Sub\n</code></pre>\n\n<p>I like to put them closer to use so that it's easier to remember what they are, whereas others might want to get them all out of the way. That's personal preference.</p>\n\n<p>But, I think I remember reading somewhere that the VBE goes through a sub/function and instantiates <em>all</em> the variables before going on to <em>anything else</em>. This would indicate that there's no <em>right way</em> to do this in VBA because the variable scopes <em>in time</em> don't change. Not the scope as in <code>Private</code> vs <code>Public</code>.</p>\n\n<p>Whereas in other languages it seems that scope can change based on placement and therefor has a <em>best practice</em>.</p>\n\n<p>I've been searching for this documentation for a while now, but whatever words I'm using aren't pointing me in the right direction, or the documentation doesn't exist.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1461175339, "post_id": 36751596, "comment_id": 61083760, "body": "It works fine for me.  Hides your columns then unhides then 1 at a time."}, {"owner": {"reputation": 1585, "user_id": 2197403, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ff4016163d27669ef08cc4d71f85bb5?s=128&d=identicon&r=PG", "display_name": "CoSpringsGuy", "link": "https://stackoverflow.com/users/2197403/cospringsguy"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1461175581, "post_id": 36751596, "comment_id": 61083903, "body": "Odd... I wonder what is different about how I have set up my spreadsheet. When I step through using F8 line     Range(&quot;O:S&quot;).Select highlights &quot;A:S&quot; instead... then the next line Hides those columns"}], "answers": [{"tags": [], "owner": {"reputation": 798, "user_id": 4005915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/631230112/picture?type=large", "display_name": "Nathan Clement", "link": "https://stackoverflow.com/users/4005915/nathan-clement"}, "is_accepted": true, "score": 2, "last_activity_date": 1461175617, "creation_date": 1461175617, "answer_id": 36751804, "question_id": 36751596, "link": "https://stackoverflow.com/questions/36751596/hiding-columns-in-vba/36751804#36751804", "title": "Hiding Columns in VBA", "body": "<p>Try getting rid of selections. This code works for me.</p>\n\n<pre><code>Sub test()\n    Dim choice As Integer\n    Sheets(\"Summary\").Activate\n    range(\"O:S\").EntireColumn.Hidden = True\n    choice = CInt(Sheets(\"Data\").Cells(2, 3))\n\nIf choice = 1 Then\n    range(\"O:P\").EntireColumn.Hidden = False\n\nElseIf choice = 2 Then\n    range(\"Q:Q\").EntireColumn.Hidden = False\n\nElseIf choice = 3 Then\n    range(\"R:R\").EntireColumn.Hidden = False\n\nElseIf choice = 4 Then\n    range(\"S:S\").EntireColumn.Hidden = False\n\nEnd If\nSheets(\"Summary\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1585, "user_id": 2197403, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ff4016163d27669ef08cc4d71f85bb5?s=128&d=identicon&r=PG", "display_name": "CoSpringsGuy", "link": "https://stackoverflow.com/users/2197403/cospringsguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 36751804, "answer_count": 1, "score": 0, "last_activity_date": 1461175617, "creation_date": 1461174998, "question_id": 36751596, "link": "https://stackoverflow.com/questions/36751596/hiding-columns-in-vba", "title": "Hiding Columns in VBA", "body": "<p>I am trying to hide columns based on a value from another sheet. I have read several articles and don't feel like this is very difficult but am having some issues. When the value in Sheets(\"Data\").Cells(2, 3) is 1 everything works fine but when I change it to 2,3 or 4 the code somehow highlights the entire spreadsheet and \"hides\" everything. Makes no sense. Below is one version using If..Then. I tried the same thing with select case and this same issue occurs.</p>\n\n<pre><code>Sub test()\n   Dim choice As Integer\n   Sheets(\"Summary\").Select\n    Range(\"O:S\").Select\n    Selection.EntireColumn.Hidden = True\n    choice = CInt(Sheets(\"Data\").Cells(2, 3))\n\nIf choice = 1 Then\n    Range(\"O:P\").Select\n    Selection.EntireColumn.Hidden = False\n\nElseIf choice = 2 Then\n    Range(\"Q:Q\").Select\n    Selection.EntireColumn.Hidden = False\n\nElseIf choice = 3 Then\n    Range(\"R:R\").Select\n    Selection.EntireColumn.Hidden = False\n\nElseIf choice = 4 Then\n    Range(\"S:S\").Select\n    Selection.EntireColumn.Hidden = False\n\nEnd If\nSheets(\"Summary\").Cells(1, 1).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1461260595, "post_id": 36756446, "comment_id": 61130333, "body": "I like your answer, as far as making the macro flow through controls in the order one wants regardless of how controls were added. This would also help in the situation that a new control is added into the mix. I&#39;d like to give it a little longer to see if a different solution pops up."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1461261189, "post_id": 36756446, "comment_id": 61130613, "body": "I understand. It looks a bit clumsy(having to loop twice), and who knows - maybe there is some more elegant way"}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1461708885, "post_id": 36756446, "comment_id": 61320120, "body": "I ended up removing the controls and re-adding them - there weren&#39;t many (maybe a dozen) that were affected. I&#39;ll keep this in mind in the future, though. Nice answer. :-)"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1461191855, "creation_date": 1461191855, "answer_id": 36756446, "question_id": 36751486, "link": "https://stackoverflow.com/questions/36751486/excel-macro-userform-for-each-not-looping-through-controls-in-tabindex-order/36756446#36756446", "title": "Excel Macro/Userform: &quot;For Each&quot; not looping through controls in TabIndex order", "body": "<p>The controls seem to be added into the form by copy/paste order(a group often has last as first), and you cannot change that order of controls.</p>\n\n<p>You could look at the following code and see how you might use the tabIndex to reorder the controls for your purpose. </p>\n\n<pre><code>  Dim ctrl As Control\n  Dim str As String\n  Dim v() As Control\n  Dim i As Long\n  Dim arrItem As Variant\n\n  i = ADSheaderForm.Controls.count\n  ReDim v(1 To i)\n\n  For Each ctrl In ADSheaderForm.Controls\n        Set v(ctrl.TabIndex + 1) = ctrl\n  Next ctrl\n\n  For Each arrItem In v\n        str = str &amp; arrItem.Name &amp; vbNewLine\n        'Actually do your code as above within this loop e.g. if typeName = blabla\n  Next arrItem\n\n  MsgBox str\n</code></pre>\n\n<p>If you set the tabIndexes to run as you do, then this will push them into an array by tabIndex position. Then you cycle through the array.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6764446, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/780e843007d838a4d1e1636d71ecb77c?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/6764446/guest"}, "is_accepted": false, "score": 1, "last_activity_date": 1472299290, "last_edit_date": 1472299290, "creation_date": 1472297026, "answer_id": 39180583, "question_id": 36751486, "link": "https://stackoverflow.com/questions/36751486/excel-macro-userform-for-each-not-looping-through-controls-in-tabindex-order/39180583#39180583", "title": "Excel Macro/Userform: &quot;For Each&quot; not looping through controls in TabIndex order", "body": "<p>I had a similar problem working with an Access form and was looking for solutions, so I stumbled upon this post. Because of my very limited knowledge of VBA syntax, I had to turn MarcoMarc's idea (thanks for that, btw) into something I would know how to write. </p>\n\n<p>Here's what I came up with... It worked for me:</p>\n\n<pre><code>Dim i as Integer\nDim ctl as Control\n\nFor i = 1 To ADSheaderForm.Controls.Count\n    For Each ctl In ADSheaderForm.Controls\n        If ctl.TabIndex = i then\n            'do something \n            Exit For\n        End If\n    Next ctl\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5826614, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208308423137583/picture?type=large", "display_name": "BoredFish", "link": "https://stackoverflow.com/users/5826614/boredfish"}, "is_accepted": false, "score": 1, "last_activity_date": 1524078816, "last_edit_date": 1524078816, "creation_date": 1524066644, "answer_id": 49903998, "question_id": 36751486, "link": "https://stackoverflow.com/questions/36751486/excel-macro-userform-for-each-not-looping-through-controls-in-tabindex-order/49903998#49903998", "title": "Excel Macro/Userform: &quot;For Each&quot; not looping through controls in TabIndex order", "body": "<p>You can reorder them all at once, as MacroMarc touched on, using the copy/paste function but the controls must be selected <em>REVERSE</em> order from what you want them to cycle.</p>\n\n<p>For your example, in the userform you would select the textbox next to \"Scope of Work\", hold <kbd>CTRL</kbd> and click on each subsequent control, again in <em>reverse</em> order. Cut, paste and voil\u00e0, they will cycle in the correct order.</p>\n"}], "owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1546, "favorite_count": 0, "accepted_answer_id": 36756446, "answer_count": 3, "score": 3, "last_activity_date": 1524078816, "creation_date": 1461174644, "last_edit_date": 1531161705, "question_id": 36751486, "link": "https://stackoverflow.com/questions/36751486/excel-macro-userform-for-each-not-looping-through-controls-in-tabindex-order", "title": "Excel Macro/Userform: &quot;For Each&quot; not looping through controls in TabIndex order", "body": "<p>Could someone help me understand how to adjust the order that a \"For Each\" loop will cycle through a UserForm's controls? (I know it's not cycling via \"TabIndex\" order, and I understand it doesn't care about the \"TabIndex\" when looping programatically in \"For Each\".)</p>\n\n<p>I added controls to my current UserForm (screenshot below) by copying a single controls for a couple and then a group of controls (Ctrl+click, copy/paste) from a previous form, and adding controls after that. The group of controls (\"Site Name\" to \"City,St,Zip\") cycles in reverse-order (bottom to top). Ideally, I want to cycle from the top to bottom continuously. </p>\n\n<p>I tried to re-order by right-clicking and \"Send Backward/Forward\" but that does nothing for my \"For Each\" loop.</p>\n\n<pre><code>For Each txtBox In ADSheaderForm.Controls\n    If TypeName(txtBox) = \"TextBox\" Then\n        If txtBox.Name = \"stNmTxtBx\" Then\n            ReDim Preserve txtArr(txtNum)\n            txtArr(txtNum) = txtBox.Text\n            txtNum = txtNum + 1\n        Else\n            If txtBox.Text = \"\" Or txtBox.Text = \"Optional\" Then\n                ReDim Preserve txtArr(txtNum)\n                txtArr(txtNum) = \"Not Entered\"\n                txtNum = txtNum + 1\n            Else\n                ReDim Preserve txtArr(txtNum)\n                txtArr(txtNum) = txtBox.Text\n                txtNum = txtNum + 1\n            End If\n        End If\n    End If\nNext\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7bvkI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7bvkI.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1461173728, "post_id": 36751137, "comment_id": 61082755, "body": "How are you <i>pulling in</i> the data? It&#39;s  pretty relevant when trying to figure out what you can and can&#39;t do."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1461174051, "post_id": 36751137, "comment_id": 61082972, "body": "Please <a href=\"https://stackoverflow.com/posts/36751137/edit\">edit</a> to put that information in your question. How the data is stored in the underlying table (column types) and specifics about the SQL statement you&#39;re using are relevant to the question, as I said. We&#39;re not really interested in a mention of what <i>everyone you&#39;ve talked to</i> said; apparently you&#39;re interested in what others say, or you wouldn&#39;t be asking here. :-)"}, {"owner": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461174370, "post_id": 36751137, "comment_id": 61083174, "body": "Fair enough! Does it look better or is there anything you think I should add?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1461174613, "post_id": 36751137, "comment_id": 61083314, "body": "Well, you added half of what I asked. :-) That&#39;s a start. Now how are you <i>pulling in the data</i>? You&#39;ve shown how you&#39;re <i>selecting</i> the data, but that doesn&#39;t explain how it&#39;s getting from there to Excel."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "reply_to_user": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "edited": false, "score": 0, "creation_date": 1461563793, "post_id": 36752456, "comment_id": 61236529, "body": "Sorry to read that. the other options that spring to mind are: check if cells in spreadsheet aren&#39;t formatted as text, use <code>VALUE</code> and <code>DATEVALUE</code> in formulas to enable calculation on text records and third one would be to write a small macro to go through all cells and convert them to proper formats. That&#39; all in order how I would have checked it"}], "tags": [], "owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "is_accepted": false, "score": 0, "last_activity_date": 1461177733, "creation_date": 1461177733, "answer_id": 36752456, "question_id": 36751137, "link": "https://stackoverflow.com/questions/36751137/sql-pulling-into-excel-as-text/36752456#36752456", "title": "SQL pulling into Excel as text", "body": "<p>Wouldn't <code>FORMAT(&lt;&lt;your field&gt;&gt;,'#') AS &lt;&lt;your alias&gt;&gt;</code> solve your problem? Try using 'd' for date. I don't have much experience pulling data from SQL Server, but in Access that's how I'd try to work around this issue.</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 2665100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0272b01e64a74107dc7db7c208e729c?s=128&d=identicon&r=PG", "display_name": "Szebeni", "link": "https://stackoverflow.com/users/2665100/szebeni"}, "is_accepted": false, "score": 0, "last_activity_date": 1471949890, "last_edit_date": 1471949890, "creation_date": 1471943993, "answer_id": 39097212, "question_id": 36751137, "link": "https://stackoverflow.com/questions/36751137/sql-pulling-into-excel-as-text/39097212#39097212", "title": "SQL pulling into Excel as text", "body": "<p>I had a similar problem with Dates. Excel only recognized them as strings. To solve the issue I created a view that converted the Date to an Int and then set up excel to recognize the Int column as dates.</p>\n\n<p>To convert dates to Excel date integers you can use this function: </p>\n\n<pre><code>DATEDIFF(day,'1899-12-30',@yourDate)\n</code></pre>\n\n<p>I do not have experience with numeric types, but you may try and cast it to a <code>decimal(18,4)</code> which works for me in Excel.</p>\n\n<p>The above works for me using Azure SQL.</p>\n"}], "owner": {"reputation": 86, "user_id": 5687813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96e734149e18635c34c1adca2965c484?s=128&d=identicon&r=PG&f=1", "display_name": "Tollbooth", "link": "https://stackoverflow.com/users/5687813/tollbooth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2713, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471949890, "creation_date": 1461173592, "last_edit_date": 1531161705, "question_id": 36751137, "link": "https://stackoverflow.com/questions/36751137/sql-pulling-into-excel-as-text", "title": "SQL pulling into Excel as text", "body": "<p>The data I'm pulling in from a SQL server is being <em>displayed</em> correctly as a date or number, but the data seems to be <em>stored</em> as text. For example, if I pulled in data with the number value 1, the cell would display \"1\" (no quotes) in it but Excel would not recognize it as a number - I can't perform any math to it and it won't be recognized as a number. I can fix that by selecting the cell and doing F2+Enter.</p>\n\n<p>To clarify, the SQL data is not formatted in Excel as text. Changing formats does not solve my issue. The actual data in the cells isn't being recognized by Excel as numbers or dates, no matter what format I make the cells. I have to manually select and F2+Enter.</p>\n\n<pre><code>select distinct vl.Property As 'Property'\n, vl.Property As 'Property number'\n, vl.LeaseID as 'Lease ID'\n, vl.priorleaseid as 'Prior lease ID'\n\nfrom realpage_uds.dbo.property p\n\ninner join realpage_uds.dbo.vwsa_lease vl\non p.propertyid = vl.propertyid\n\n\nwhere p.name like '%Name%'\n</code></pre>\n\n<p>vl.LeaseID is a good example. It is data type \"T-IDNumeric\", system type \"numeric\" yet I can't select a leaseID and perform any arithmetic to it in Excel.</p>\n\n<p>I'm pulling in the SQL data to Excel in the following way:</p>\n\n<ol>\n<li>Go to \"Data\" tab, click \"From Other Sources\" under \"Get External\nData\"</li>\n<li>Choose \"From SQL server\", enter server name to connect</li>\n<li>Connect to a database and choose a random table in the database</li>\n<li>Click finish, and choose to pull in the data as a table or pivot table. I've used both and they both have this issue.</li>\n<li>Finally, update the SQL query under connection properties, and change the query to my desired query that I have typed up. Then I choose \"SQL\" and hit OK.</li>\n</ol>\n\n<p>Has anyone else experienced this? Is there a way I can make the SQL data pull in as a number and date, and not have to manually select the cell and F2+Enter to get Excel to recognize the data?</p>\n\n<p>Alternatively, if there is no way to change the way the SQL data pulls in, is there a macro I could implement to change all text data in a spreadsheet to number or date values?</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["arrays", "excel", "vba", "adox"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1461174309, "post_id": 36750939, "comment_id": 61083137, "body": "AFAIK for ADO to work, you need your worksheet <i>set up like a table</i>, with column names in row 1 and consistent data types throughout a column. <i>The sheet is the table</i>, you can&#39;t just say &quot;give me range C5:L12&quot;, ADO doesn&#39;t know anything about <i>ranges</i>."}, {"owner": {"reputation": 241, "user_id": 3116934, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b5cda9623d4bd6f5ea27535148fc1722?s=128&d=identicon&r=PG&f=1", "display_name": "Metalgearmaycry", "link": "https://stackoverflow.com/users/3116934/metalgearmaycry"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1461176716, "post_id": 36750939, "comment_id": 61084622, "body": "Oof. Then I don&#39;t think ADO is going to work at all then. Merged cells, multiple variable types, all sorts of nasty things inhabit these worksheets."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1461190496, "post_id": 36750939, "comment_id": 61092374, "body": "You want to load data from Excel to Excel? why is there an MS-Access tag?"}, {"owner": {"reputation": 241, "user_id": 3116934, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b5cda9623d4bd6f5ea27535148fc1722?s=128&d=identicon&r=PG&f=1", "display_name": "Metalgearmaycry", "link": "https://stackoverflow.com/users/3116934/metalgearmaycry"}, "edited": false, "score": 0, "creation_date": 1461240382, "post_id": 36750939, "comment_id": 61115566, "body": "I thought ADO was an access thing. I was wrong, so tag removed. Thanks!"}], "owner": {"reputation": 241, "user_id": 3116934, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b5cda9623d4bd6f5ea27535148fc1722?s=128&d=identicon&r=PG&f=1", "display_name": "Metalgearmaycry", "link": "https://stackoverflow.com/users/3116934/metalgearmaycry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 714, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461240915, "creation_date": 1461173030, "last_edit_date": 1461240915, "question_id": 36750939, "link": "https://stackoverflow.com/questions/36750939/get-array-of-values-from-a-closed-workbook-with-vba-ado", "title": "Get array of values from a closed Workbook with VBA/ADO?", "body": "<p>I am trying to load a variable range of values from each worksheet in a closed workbook into a dictionary with the format \"worksheet.name: [range]\" in order to not have to open said workbook and iterate through the worksheets and then iterate through the cells in a specified cell range (the \"for each\" loops are endless!).\nI have found many people recommend a popular Excel4Macro called GetValues, but this macro, from what I have seen, can take or return only one cell address, where as I would need to return a variable range, i.e., C5:L12 or C5:K12. I have been mucking about with ADOX and collections, but I'm not getting much headway there (any idea how to return a \"cell\" entry in an Catalog.Table object? Access/SQL keys and fields are foreign to me). Has anyone tried something like this before? Any pointers or advice? Thank you all.</p>\n\n<p>This is the code I am working with currently. I want to accomplish it without opening the workbook I pull the values from. How can I do that?</p>\n\n<pre><code>Set WB = Workbooks.Open(c:\\work\\book\\path.xlsm)\n'loop through the worksheets in WB and create a master dictionary with key:value ws.name:[wsvalues]\nSet wsdict = CreateObject(\"Scripting.Dictionary\")\nFor Each ws In WB.Worksheets\n    Set wsccoll = New Collection\n    With ws\n        maxcols = .Cells(5, .Columns.Count).End(xlToLeft).Column    'get the last column in the search area\n        basewsc = .Range(.Cells(5, 3), .Cells(12, maxcols)).Value   'get the searchable area on the worksheet, which starts at C5 and goes to maxcols12\n        For Each i In basewsc                                       'start getting a list of all non-blank cells with no repeats\n            isincollection = False\n            If i &lt;&gt; vbNullString Then\n                For Each Item In wsccoll\n                    If Item = i Then\n                        isincollection = True\n                        Exit For\n                    End If\n                Next Item\n                If Not isincollection Then\n                    wsccoll.Add i\n                End If\n            End If\n        Next i\n        wsdict.Add .Name, wsccoll                     'populate the dictionary with the sheetname: [non-blank cells in sheet search area]\n    End With\nNext ws\n'close the workbook because we don't need it anymore\nWB.Close SaveChanges:=False\nSet WB = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1461173085, "post_id": 36750796, "comment_id": 61082373, "body": "The <code>If</code> statement is probably your best bet. However, you could try to offset the start of your next search with <code>set c1 = .FindNext(c1.offset(0,1).Range)</code> to see how that works. I&#39;m uncertain off the top of my head if the <code>Find</code> algorithm works left-right-top-bottom or a different direction."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6226869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bf6865c3a7b2da3943e38f013c71c3a?s=128&d=identicon&r=PG&f=1", "display_name": "Lampsh4de", "link": "https://stackoverflow.com/users/6226869/lampsh4de"}, "edited": false, "score": 0, "creation_date": 1461174113, "post_id": 36750896, "comment_id": 61083014, "body": "This worked perfectly, thanks for the tip!  Can&#39;t believe it was that simple!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1461173328, "last_edit_date": 1461173328, "creation_date": 1461172849, "answer_id": 36750896, "question_id": 36750796, "link": "https://stackoverflow.com/questions/36750796/vba-findnext-skipping-the-next-value/36750896#36750896", "title": "VBA .FindNext() - skipping the next value", "body": "<p>Limit your search to only Column A:</p>\n\n<pre><code>Sub Macro2()\n\n    With Worksheets(\"Sheet3\").Range(\"A:A\")\n        Set c1 = .Find(\"TOTAL\", After:=.Range(\"A1\"), LookIn:=xlValues)\n            If Not c1 Is Nothing Then\n                firstOne = c1.Address\n                Do\n                    With c1\n                        .ClearContents\n                        .Offset(0, 1).Value = \"Totals:\"\n                    End With\n                    Set c1 = .FindNext(c1)\n\n                Loop While Not c1 Is Nothing And c1.Address &lt;&gt; firstOne And c1.Value &lt;&gt; \"Grand Total\"\n            End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6226869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bf6865c3a7b2da3943e38f013c71c3a?s=128&d=identicon&r=PG&f=1", "display_name": "Lampsh4de", "link": "https://stackoverflow.com/users/6226869/lampsh4de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 36750896, "answer_count": 1, "score": 1, "last_activity_date": 1461173328, "creation_date": 1461172559, "last_edit_date": 1531164843, "question_id": 36750796, "link": "https://stackoverflow.com/questions/36750796/vba-findnext-skipping-the-next-value", "title": "VBA .FindNext() - skipping the next value", "body": "<p>I have a spreadsheet that contains general ledger information for specific accounts that is structured as thus:</p>\n\n<p><a href=\"http://i.stack.imgur.com/yQ0Zs.png\" rel=\"nofollow\">Data Structure</a></p>\n\n<p>I wanted to design a simple macro to find the cell containing \"Total\" and remove it, then moving to the right one column and putting \"Total:\" in the cell(column b).</p>\n\n<p>The issue I am running into with my macro is, when I set it up to .FindNext() it picks up the \"Total:\" cell that just got populated as the next find. I know that I could probably handle this with an if function but I wanted to know if there was any method in which .FindNext() could skip the next result and move on accordingly.</p>\n\n<p>Here is the macro in its current form. Note: This is my first attempt at making my own VBA macro.</p>\n\n<pre><code>Sub Macro2()\n\n    With Worksheets(\"Sheet3\").Cells\n        Set c1 = .Find(\"TOTAL\", After:=.Range(\"A1\"), LookIn:=xlValues)\n            If Not c1 Is Nothing Then\n        firstOne = c1.Address\n        Do\n            c1.Select\n            ActiveCell.ClearContents\n            c1.Offset(0, 1).Value = \"Totals:\"\n            Set c1 = .FindNext(c1)\n\n        Loop While Not c1 Is Nothing And c1.Address &lt;&gt; firstOne And c1.Value &lt;&gt; \"Grand Total\"\n            End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>If someone could assist me with either getting it to skip the next value or properly offsetting it so it results in the desired effect I would be much appreciative. I also attempted to find other posts on this but did not find any with specifically this issue, I appreciate your help!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1461172126, "post_id": 36750226, "comment_id": 61081849, "body": "&quot;457      This key is already associated with an element of this collection&quot; I got this!"}, {"owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1461173360, "post_id": 36750226, "comment_id": 61082530, "body": "@HansUp That worked! Changing the Dim Tables and Set Tables = New Collection works %100. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1461173037, "creation_date": 1461173037, "answer_id": 36750945, "question_id": 36750226, "link": "https://stackoverflow.com/questions/36750226/vba-access-database-table-collection/36750945#36750945", "title": "VBA - Access database table collection", "body": "<p>You miss a refresh:</p>\n\n<pre><code>Set db = DBEngine(0)(0)\nFor Each tdf In db.TableDefs\n    If Left(tdf.Connect, 5) = \"ODBC;\" Then\n        Tables.Add tdf, Chr(34) &amp; tdf.Name &amp; Chr(34)\n    End If\nNext tdf\ndb.TableDefs.Refresh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1461174184, "last_edit_date": 1461174184, "creation_date": 1461173662, "answer_id": 36751167, "question_id": 36750226, "link": "https://stackoverflow.com/questions/36750226/vba-access-database-table-collection/36751167#36751167", "title": "VBA - Access database table collection", "body": "<p>Change the first line to <code>Public Tables As Collection</code> Then, in <code>SET_VAR()</code>, add <code>Set Tables = New Collection</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Tables As Collection\nSub SET_VAR()\nOn Error GoTo handlr:\n   Dim tdf As TableDef\n   Dim db As Database\n   Set Tables = New Collection\n   Set db = DBEngine(0)(0)\n   For Each tdf In db.TableDefs\n      If Left(tdf.Connect, 5) = \"ODBC;\" Then\n         Tables.Add tdf, Chr(34) &amp; tdf.Name &amp; Chr(34)\n      End If\n   Next tdf\n   MsgBox \"Success. Linked tables public collection created!\"\n   Exit Sub\nhandlr:\n   MsgBox \"Error. Linked tables not added to public collection!\" &amp; _\n        vbCrLf &amp; \"(error #\" &amp; err.Number &amp; \" :\" &amp; err.Description &amp; \")\"\nEnd Sub \n</code></pre>\n\n<p>Since you will then start with an empty <code>Collection</code> each time the procedure runs, those changes should eliminate the duplicate key problem.</p>\n\n<p>I also added the error number and description to the <code>MsgBox</code> text.  If you prefer not to show those details to the users, <code>Debug.Print</code> them to the Immediate window.  When your code encounters an error, you need to understand why it happened.  </p>\n"}], "owner": {"reputation": 203, "user_id": 5355024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EAYrq.png?s=128&g=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5355024/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 36751167, "answer_count": 2, "score": 1, "last_activity_date": 1461174184, "creation_date": 1461170877, "last_edit_date": 1461173909, "question_id": 36750226, "link": "https://stackoverflow.com/questions/36750226/vba-access-database-table-collection", "title": "VBA - Access database table collection", "body": "<p>I have a sub which creates a new collection of Access database object linked <code>tabledef</code>. The sub works 1/2 the time without error if code is not reset (just hitting F5), but always works if first reset. However when calling this sub in another module it only works 1/2 of the time again. Any ideas why this only works only 1/2 the time when called in another sub?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Tables As New Collection\nSub SET_VAR()\n'##############################################################\n'# 1. CREATE PUBLIC COLLECTION OF LINKED TABLES IN DB\n'##############################################################\nOn Error GoTo handlr:\n   Dim tdf As TableDef\n   Dim db As Database\n   Set db = DBEngine(0)(0)\n   For Each tdf In db.TableDefs\n      If Left(tdf.Connect, 5) = \"ODBC;\" Then\n         Tables.Add tdf, Chr(34) &amp; tdf.Name &amp; Chr(34)\n      End If\n   Next tdf\n   MsgBox \"Success. Linked tables public collection created!\"\n   Exit Sub\nhandlr:\n   MsgBox \"Error. Linked tables not added to public collection!\"\n   End\nEnd Sub \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jc6p1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jc6p1.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the error Access gives me:</p>\n\n<blockquote>\n  <p>\"457 This key is already associated with an element of this\n  collection\"</p>\n</blockquote>\n"}, {"tags": ["vba", "file", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 6000978, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c93f1928fbc6404e7b67fc23612e626f?s=128&d=identicon&r=PG&f=1", "display_name": "wp44", "link": "https://stackoverflow.com/users/6000978/wp44"}, "edited": false, "score": 0, "creation_date": 1461172454, "post_id": 36750533, "comment_id": 61082033, "body": "HI Paul, my apologies - I am trying to insert 1 filename per row. I will edit question. I also tried selection.Insertafter - nothing happened :("}, {"owner": {"reputation": 265, "user_id": 6000978, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c93f1928fbc6404e7b67fc23612e626f?s=128&d=identicon&r=PG&f=1", "display_name": "wp44", "link": "https://stackoverflow.com/users/6000978/wp44"}, "edited": false, "score": 0, "creation_date": 1461173307, "post_id": 36750533, "comment_id": 61082492, "body": "Thank you very much Paul, it did the job :)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1461172720, "last_edit_date": 1461172720, "creation_date": 1461171783, "answer_id": 36750533, "question_id": 36750171, "link": "https://stackoverflow.com/questions/36750171/import-file-names-into-word-table-column-1-1-filename-per-row/36750533#36750533", "title": "Import File Names into Word Table Column 1 - 1 Filename Per Row", "body": "<p>You have the filename already. It is in <code>myFile</code>.</p>\n\n<p>After <code>aTable.Rows.Add</code> the cursor is in the first cell of the new row. Just insert it with <code>Selection.InsertAfter myFile</code>.</p>\n\n<p>EDIT:</p>\n\n<p>The following sub in Word inserts a new 3-column table and lists all filenames.</p>\n\n<pre><code>Sub ListFilenames()\nDim myFile As String, getFolder As String\n\n    getFolder = \"&lt;set your folder here&gt;\"\n    myFile = Dir(getFolder &amp; \"\\\" &amp; \"*.doc*\", vbNormal)\n\n    ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:=3\n\n    While myFile &lt;&gt; \"\"\n        Selection.InsertAfter (myFile): Selection.MoveRight Unit:=wdCell\n        Selection.InsertAfter (\"Col2\"): Selection.MoveRight Unit:=wdCell\n        Selection.InsertAfter (\"Col3\"): Selection.MoveRight Unit:=wdCell    ' this inserts a new row\n        myFile = Dir()\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 6000978, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c93f1928fbc6404e7b67fc23612e626f?s=128&d=identicon&r=PG&f=1", "display_name": "wp44", "link": "https://stackoverflow.com/users/6000978/wp44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 36750533, "answer_count": 1, "score": -1, "last_activity_date": 1479756670, "creation_date": 1461170735, "last_edit_date": 1479756670, "question_id": 36750171, "link": "https://stackoverflow.com/questions/36750171/import-file-names-into-word-table-column-1-1-filename-per-row", "title": "Import File Names into Word Table Column 1 - 1 Filename Per Row", "body": "<p>I am trying to import file names into a word table. There are many scripts for importing files into Excel, but nothing for a word table :(</p>\n\n<p>I will browse for the folder > Then import the filenames into Column 1</p>\n\n<p><strong>1 filename per table row</strong></p>\n\n<p>I am stuck on how to import or insert  the file names into the table.</p>\n\n<pre><code>Sub ImportFileName()\n    Dim getFolder As String\n    Dim myFile As String\n    Dim myDoc As Document\n    Dim aTable As Table\n    Application.ScreenUpdating = False\n    getFolder = getFolder\n    If getFolder = \"\" Then Exit Sub\n    myFile = Dir(getFolder &amp; \"\\\" &amp; \"*.doc*\", vbNormal)\n    Set aTable = ActiveDocument.Tables(1)\n    While myFile &lt;&gt; \"\"\n        Set myDoc = Documents.Open(getFolder &amp; \"\\\" &amp; myFile)\n        'How do I import the file name into table column 1\n        aTable.Rows.Add\n        myDoc.Close wdDoNotSaveChanges\n        myFile = Dir()\n        Set myDoc = Nothing\n        Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n\n<p>How can I import the filenames into the word table?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461170362, "post_id": 36750024, "comment_id": 61080791, "body": "<code>set</code> it to an object and close that way. Something like <code>set wb=Workbooks(&quot;Base de Datos Cotizaciones Shared.xlsb&quot;)</code> then later do <code>wb.close</code>."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461170566, "post_id": 36750024, "comment_id": 61080928, "body": "That line of code works, VBA closes the WB, but somehow Excel is still running it sometimes (not always). I need to fix that issue..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461170696, "post_id": 36750024, "comment_id": 61080990, "body": "I guess we differ in how we define what &quot;works&quot;."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461171039, "post_id": 36750024, "comment_id": 61081218, "body": "You use various references (variables) to workbooks. I suggest (as FindWindow also implies) to set these to Nothing: <code>Set wb2 = Nothing</code> and <code>Set wb3 = Nothing</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1461171221, "post_id": 36750024, "comment_id": 61081318, "body": "For the record - I&#39;ve used shared files before over a network, and have seen the user sitting behind me close the file, and if I open it quickly after that, it tells me it&#39;s still in use (sometimes telling me this for a while).  This may be more of a Windows issue than VBA/Excel."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461172902, "post_id": 36750024, "comment_id": 61082281, "body": "@BruceWayne Exactly, that is actually the problem I&#39;m experiencing. I was wondering if VBA has a function like an emergency shut down to close WBs, or something like that."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461173002, "post_id": 36750024, "comment_id": 61082324, "body": "@N.Pavon - Ah, okay yeah I see. What if you did <code>Application.Quit</code> after closing the workbook? Although I think that might close any and all open Excel&#39;s, it may be what you&#39;re needing? See <a href=\"http://stackoverflow.com/questions/3628252/closing-excel-application-using-vba\">this thread</a> for more explanation."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461173016, "post_id": 36750024, "comment_id": 61082331, "body": "@PaulOgilvie If I set them to nothing, how can I use them afterwards?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461173444, "post_id": 36750024, "comment_id": 61082588, "body": "@BruceWayne About <code>Application.Quit</code>... if the user has more Excel files opened, this will close all of them, right? So if the user is working with other files, he will lose all the changes he did to those files?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1461173700, "post_id": 36750024, "comment_id": 61082737, "body": "@N.Pavon - I&#39;m pretty sure, yes. So, it&#39;s not really a solution, sorry! I just wanted to at least mention it though. Perhaps you can try it with your one workbook open, and if it in fact works, perhaps we can get a workaround? I&#39;ve been searching, and that&#39;s the only other idea to ensure that Excel is closed. I think Windows sees an  &quot;artifact&quot; (no idea if that word is right) that a user is in a worksheet, when they aren&#39;t. Is there some Excel cache we can clear maybe?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461173856, "post_id": 36750024, "comment_id": 61082846, "body": "I noticed such Windows/Application behavior before too (files remain busy even when closed). Usually, opening and closing a few (random) files solves the problem. Maybe this forces some cache to be flushed."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1461174360, "post_id": 36750024, "comment_id": 61083168, "body": "Yes, I know that if the person experiencing the problem closes all the Excel files that were open, the problem is solved. However, I need somehow a &quot;VBA&quot; solution, so that the tool I&#39;m developing can work without having these kind of problems. I would be very grateful if you come up with a solution (I&#39;ve tried everything I could come up with)."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1461174466, "post_id": 36750024, "comment_id": 61083229, "body": "Something like: at the end of the code, when everything that had to be done is done, check if the file is somehow busy (I know how to do this) and in that case, shut it down complitely (I don&#39;t know how to do this)."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461176673, "post_id": 36750024, "comment_id": 61084593, "body": "&quot;<i>I need somehow a &quot;VBA&quot; solution</i>&quot;: then open/close a number of other files in VBA so the Windows(?) cache gets flushed and the file in question gets unlocked. They can be text files opened with <code>Open</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1513613996, "post_id": 36750024, "comment_id": 82710145, "body": "I&#39;m a bit late to the party, but I&#39;ll go with the comment from @BruceWayne.  I believe it&#39;s our network speed here that causes problems - I can open a file, close it again and Windows won&#39;t let me open it again as it thinks I&#39;ve still got it open.  I put it down to companies going for the lowest bidder when outsourcing their IT requirements."}], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513612429, "creation_date": 1461170248, "last_edit_date": 1513612429, "question_id": 36750024, "link": "https://stackoverflow.com/questions/36750024/vba-to-close-workbook-doesnt-work-perfectly", "title": "VBA to close Workbook doesn&#39;t work perfectly", "body": "<p>I have the following code, which opens a certain WB, gets some info from it and then closes it. The thing is, that sometimes the WB doesn't get closed correctly. Sometimes, even if the user can't see that the WB is open, Excel is still running it, because if someone else tries to open it (the WB is located in a shared folder), Excel won't let him because it says that someone else has the WB opened.</p>\n\n<pre><code>Dim iStatus As Long\nErr.Clear\nOn Error Resume Next\nSet wb2 = Workbooks(\"Base de Datos Cotizaciones Shared.xlsb\")\niStatus = Err\nOn Error GoTo 0\nIf iStatus Then\n    Workbooks.Open Filename:=\"\\\\3kusmiafs02\\CAPACITY\\Cotizaciones\\Base de Datos Cotizaciones Shared.xlsb\"\nElse\n    wb2.Activate\nEnd If\n\nOn Error GoTo errHandler:\n\nWorksheets(\"Data\").Activate\n\nmaxnum = CLng(Application.WorksheetFunction.Max(Range(\"A:A\")))\nquote_num = maxnum + 1\n\nActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = quote_num\n\n\nRange(\"A1\").Select\nSelection.End(xlDown).Select\n\nDim input_range As Range\n\nSet input_range = Selection.Offset(0, 1)\n\nwb3.Activate\nWorksheets(\"UI VENTAS\").Activate\nRange(\"Quote_num\") = quote_num\nApplication.Goto Reference:=\"Dimstable\"\nSelection.Copy\n\nWorkbooks(\"Base de Datos Cotizaciones Shared.xlsb\").Activate\nWorksheets(\"Dims\").Activate\n\nRange(\"table_start2\").Select\nSelection.End(xlDown).Select\nSelection.Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n                       xlNone, SkipBlanks:=False, Transpose:=False\n\nFor i = 1 To 17\n    input_range.Offset(0, i - 1).Value = data_values(i - 1)\nNext i\ninput_range.Offset(0, 32).Value = data_values(17)\n\nWorkbooks(\"Base de Datos Cotizaciones Shared.xlsb\").Save\nWorkbooks(\"Base de Datos Cotizaciones Shared.xlsb\").Close\n</code></pre>\n\n<p>Is there a way to fix this?</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "edited": false, "score": 0, "creation_date": 1462146796, "post_id": 36960382, "comment_id": 61502109, "body": "I that&#39;s exactly what I did first. It just displays the connections in the Active Workbook. Check the code I wrote in my post. It&#39;s exactly what you proposed, the only difference being that you called your connection variable &quot;conn&quot;  instead of &quot;cnn&quot;. Thanks for the help though!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6058587"}, "is_accepted": false, "score": -1, "last_activity_date": 1462051317, "creation_date": 1462051317, "answer_id": 36960382, "question_id": 36749616, "link": "https://stackoverflow.com/questions/36749616/list-all-computer-connection-from-excel-vba/36960382#36960382", "title": "List all Computer Connection from Excel VBA", "body": "<p>Try it this way and let me know how it goes.</p>\n\n<pre><code>Dim conn As WorkbookConnection\nFor Each conn In ActiveWorkbook.Connections\n  Debug.Print conn.Name\nNext conn\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 3023808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1072692623/picture?type=large", "display_name": "Oscar Anthony", "link": "https://stackoverflow.com/users/3023808/oscar-anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1045, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1462051317, "creation_date": 1461168989, "question_id": 36749616, "link": "https://stackoverflow.com/questions/36749616/list-all-computer-connection-from-excel-vba", "title": "List all Computer Connection from Excel VBA", "body": "<p>I would like to know if there is a way to list the <strong>Computer Connections</strong> from Excel using VBA?</p>\n\n<p>I was able to get all the <strong>Workbook Connections</strong> using this simple block of code:</p>\n\n<pre><code>Private Sub ListWorkBookConnections()\n    Dim cnn As WorkbookConnection\n    For Each cnn In ActiveWorkbook.Connections\n        Debug.Print cnn.Name\n    Next cnn\nEnd Sub\n</code></pre>\n\n<p>Those are the connections that are specific to the Active workbook (the one currently opened) and that appear in the \"<em>Connections in this Workbook</em>\" section if you open the \"<em>Existing Connection</em>\" window of Excel (Data >> Existing Connection). See the Red sections in the Picture below :</p>\n\n<p><a href=\"https://i.stack.imgur.com/JD9Zg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JD9Zg.png\" alt=\"Existing Connections Pop Up\"></a></p>\n\n<p>What I would like to achieve is listing all the connection under the section \"<em>Connection Files on this Computer</em>\", in Blue on the image above.</p>\n\n<p>I am using Excel 2007 on a Windows 7 computer.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461169970, "post_id": 36749514, "comment_id": 61080567, "body": "What have you done sofar? Show us the code please. What is Left Indent of a table? Does the table have to move to the left, does the paragraph(s) of the first column has to move or does the paragraph(s) of every cell have to move to the left?"}, {"owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461171683, "post_id": 36749514, "comment_id": 61081582, "body": "Thank you for your prompt response.   No code, yet. I don&#39;t even know how to begin to approach this problem. There are randomly indented tables in the document and all of them need to come back to the left by 0.45 picas. So, basically, I&#39;m looking for a way to decrease all left table indents by 0.45 picas."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461180812, "post_id": 36749514, "comment_id": 61087156, "body": "If you&#39;re able to do it in the UI (and it can be done, via the Table Properties) then record these steps in a macro in order to get the basic code as a starting point. You can then use the <a href=\"https://stackoverflow.com/posts/36749514/edit\">edit</a> link below your question to copy the code into the question (and please remember to format it as code)."}, {"owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "edited": false, "score": 0, "creation_date": 1461184559, "post_id": 36749514, "comment_id": 61089598, "body": "Please see the code in the edited original post."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461258308, "post_id": 36749514, "comment_id": 61129117, "body": "@WillieD.Washington When you want to &quot;flag&quot; someone, so that they know you&#39;ve answered, you need to precede their name with a @, as I&#39;ve done for you. Otherwise, no one will know you&#39;ve replied/edited."}, {"owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461598697, "post_id": 36749514, "comment_id": 61259610, "body": "@Cindy Meister - Oh, that&#39;s good to know. Thank you very much, Cindy!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "edited": false, "score": 0, "creation_date": 1461599312, "post_id": 36776234, "comment_id": 61260017, "body": "Thank you, I love it and it gets me closer to what I need. However, it&#39;s giving me this error: Run-time error &#39;5149&#39;: The measurement must be between -1584pt and 1584pt."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "edited": false, "score": 0, "creation_date": 1461599826, "post_id": 36776234, "comment_id": 61260367, "body": "That&#39;s odd... I did test it and I just tested it again: no error. Is this happening for all tables in the document? (When you get the error, you can drag the error-pointer down a line then press F5 to continue to the next table in the loop.) Or just a particular one?"}, {"owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "edited": false, "score": 0, "creation_date": 1461600102, "post_id": 36776234, "comment_id": 61260545, "body": "I believe I pinpointed where the error was coming from. I had a table within a table, an unfortunate byproduct of our department with respect to specific boilerplate items that aren&#39;t common to all forms. I can just manually adjust those tables. Thank you again for your patience and assistance, Cindy! It is very appreciated."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "edited": false, "score": 0, "creation_date": 1461600454, "post_id": 36776234, "comment_id": 61260729, "body": "Ah, yes, that seems reasonable :-) If you&#39;d like, the code can be adjusted to ignore such instances, although I might not have time today (meeting to attend!). BTW, since you&#39;re new to Stack Overflow: when an &quot;Answer&quot; answers your Question you should click the checkmark next to it to mark it as &quot;the&quot; answer. This helps site admin, others with the same question and awards the answerer with &quot;site reputation&quot; :-) Any post (question or answer) you find &quot;good&quot; you can upvote, once you have enough repuation; any &quot;bad&quot; post you can downvote."}, {"owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "edited": false, "score": 0, "creation_date": 1461601555, "post_id": 36776234, "comment_id": 61261330, "body": "Ahhh, thanks again. I was wondering what that was for. I thought it was another type of arrow. lol And for further clarification, it was a &quot;table within a frame&quot; that caused the error."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1461258416, "creation_date": 1461258416, "answer_id": 36776234, "question_id": 36749514, "link": "https://stackoverflow.com/questions/36749514/vba-word-07-13-macro-to-decrease-left-indent-on-all-tables-by-0-45-picas/36776234#36776234", "title": "VBA Word 07/13 Macro To Decrease Left Indent On All Tables By 0.45 Picas", "body": "<p>It's basic math, really...</p>\n\n<pre><code>Sub IndentAllTablesByAmount()\n\n  Dim oTbl As Word.Table\n  For Each oTbl In ActiveDocument.Tables\n    oTbl.Rows.LeftIndent = oTbl.Rows.LeftIndent - PicasToPoints(0.45)\n  Next oTbl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6231326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-azDPHv4oIcM/AAAAAAAAAAI/AAAAAAAADWw/Oagj-M8Zulg/photo.jpg?sz=128", "display_name": "Willie D. Washington", "link": "https://stackoverflow.com/users/6231326/willie-d-washington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 0, "accepted_answer_id": 36776234, "answer_count": 1, "score": -2, "last_activity_date": 1461258416, "creation_date": 1461168717, "last_edit_date": 1461184755, "question_id": 36749514, "link": "https://stackoverflow.com/questions/36749514/vba-word-07-13-macro-to-decrease-left-indent-on-all-tables-by-0-45-picas", "title": "VBA Word 07/13 Macro To Decrease Left Indent On All Tables By 0.45 Picas", "body": "<p>I am trying to create a macro that will enable me to reduce the Left Indent of all tables in a document by 0.45 picas. I am familiar with being able to write one that includes a specific amount, but I don't even know if it's possible to reduce or subtract an amount from a measurement within VBA Word.</p>\n\n<p>Our company's tables had to be 0.45 picas indented in Word 2007 due to the uneven alignment of the left side of the box. In Word 2013, this indent is no longer necessary so all of our preexisting documents appear unnecessarily indented by 0.45 picas.</p>\n\n<p>This is all I could come up with as an example:</p>\n\n<pre><code>Sub IndentAllTablesByAmount()\n\nDim oTbl As Word.Table\n  For Each oTbl In ActiveDocument.Tables\n    With oTbl.Range\n    .Tables(1).Rows.LeftIndent = PicasToPoints(-0.45)\n\n    End With\n\n  Next oTbl\nEnd Sub\n</code></pre>\n\n<p>But instead of putting a set number as a measurement, I want to minus that amount from the differently indented tables.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461168462, "post_id": 36749392, "comment_id": 61079598, "body": "What does <code>debug.print c</code> say?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1461168556, "post_id": 36749392, "comment_id": 61079652, "body": "If you think there are too many, a quick check would be to do <code>Dim c as Long</code>."}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 2, "creation_date": 1461168566, "post_id": 36749392, "comment_id": 61079656, "body": "I don&#39;t think c would be assigned because it dies before that statement completes."}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 0, "creation_date": 1461168644, "post_id": 36749392, "comment_id": 61079711, "body": "I don&#39;t think I&#39;m overflowing the integer variable.  I think Excel is trying to load to many checkboxes in to the ActiveSheet.Checkboxes object."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461168662, "post_id": 36749392, "comment_id": 61079724, "body": "D&#39;oh, you&#39;re right.  Does <a href=\"http://www.ozgrid.com/forum/showthread.php?t=57891\" rel=\"nofollow noreferrer\">this page</a> provide any help? or <a href=\"http://www.xtremevbtalk.com/archive/index.php/t-86538.htmlc\" rel=\"nofollow noreferrer\">this one</a>?  I don&#39;t think that it&#39;s you&#39;re trying to load too many, I think it&#39;s <i>how</i> you&#39;re trying to get it. (It could be that you have too many, I just doubt that VBA would crash because of too many checkboxes)."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461168702, "post_id": 36749392, "comment_id": 61079740, "body": "Then don&#39;t grab the entire sheet. Grab ranges at a time?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461168751, "post_id": 36749392, "comment_id": 61079772, "body": "WAIT. There is no workbook XD Edit: nevermind, you did pass it. Ignore me! Edit2: kinda silly to <code>with</code> workbook but not sheet?"}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461168949, "post_id": 36749392, "comment_id": 61079906, "body": "@findwindow: The workbook is passed in as wb var.  Also, because the checkboxes are on the sheet but not technically in a cell, I can&#39;t grab just a range of them."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461168993, "post_id": 36749392, "comment_id": 61079939, "body": "Oh. Did not know checkboxes were a sheet object XD. I am so bad."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1461169005, "post_id": 36749392, "comment_id": 61079947, "body": "what about using a for loop with an indexer ActiveSheet.CheckBoxes (index)"}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461169079, "post_id": 36749392, "comment_id": 61079990, "body": "@BruceWayne:  I will check out those suggestions.  I&#39;m not sure that the checkboxes I&#39;m using are OLE controls but I will try it out.  The files I&#39;m dealing with that work with the script above have more than 30,000 checkboxes.  Then ones that don&#39;t work are double the file size so I&#39;m guessing there are upwards of 60,000 checkboxes."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461169132, "post_id": 36749392, "comment_id": 61080020, "body": "Uh pretty sure 30K exceeds <code>int</code> type? Edit: as Batman suggested above, dim it as <code>long</code>. Edit: goes just past <a href=\"http://stackoverflow.com/questions/10558540/vba-macro-crashes-after-32000-rows\">32K</a>."}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 0, "creation_date": 1461169568, "post_id": 36749392, "comment_id": 61080301, "body": "Doh! Yeah, max int is 32767.  Let me try that and see.  Have to head to a meeting so will update results later."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461175053, "post_id": 36749392, "comment_id": 61083583, "body": "@Caynadian -  further to @findwindow comments about the With statement ... you haven&#39;t really connected your activesheet object to wb. I would expect to see <code>.Worksheets(&quot;Vessel &amp; Voyage Information&quot;).Activate</code> instead of <code>Worksheets(&quot;Vessel &amp; Voyage Information&quot;).Activate</code> and <code>.ActiveSheet.CheckBoxes.Count</code> instead of <code>ActiveSheet.CheckBoxes.Count</code>. There are several occurrences of this. It probably won&#39;t solve your problem however."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461175147, "post_id": 36749392, "comment_id": 61083631, "body": "Have you stepped through the code using F8 and monitored Excel&#39;s memory change? It&#39;s possible the memory bloats somewhere else and a small change at the lines you suspect is putting it over the top."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461175959, "post_id": 36749392, "comment_id": 61084150, "body": "@OldUgly if using <code>with</code>, <code>activate</code> is moot."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 0, "creation_date": 1461169311, "post_id": 36749553, "comment_id": 61080146, "body": "Nope.  As I guessed, the checkboxes are not OLEObjects.  cnt is 0 if I use the function above but &quot;cnt = ActiveSheet.CheckBoxes.Count&quot; returns 25,429."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1461168820, "creation_date": 1461168820, "answer_id": 36749553, "question_id": 36749392, "link": "https://stackoverflow.com/questions/36749392/using-vba-to-delete-thousands-of-checkboxes/36749553#36749553", "title": "Using VBA To Delete Thousands of Checkboxes", "body": "<p>From <a href=\"http://www.xtremevbtalk.com/archive/index.php/t-86538.html\" rel=\"nofollow\">this page</a>, does this work:</p>\n\n<pre><code>Sub Count_CheckBoxes()\nDim cnt     As Long\nDim cbx     As OLEObject\n\ncnt = 0\n'Count CheckBoxes\nFor Each cbx In ActiveSheet.OLEObjects\n    If TypeName(cbx.Object) = \"CheckBox\" Then\n        cnt = cnt + 1\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1461171194, "post_id": 36750260, "comment_id": 61081303, "body": "Nice solution, that&#39;s definitely something to try"}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 0, "creation_date": 1461254997, "post_id": 36750260, "comment_id": 61126959, "body": "This worked well!  Thanks!  Although, the original issue does seem to be me overflowing my integer field.  By converting it to long I don&#39;t get the error so some credit should also go to @findwindow."}, {"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 0, "creation_date": 1461255025, "post_id": 36750260, "comment_id": 61126990, "body": "Also to @brucewayne (couldn&#39;t tag 2 users in one comment)."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1461257482, "last_edit_date": 1461257482, "creation_date": 1461170966, "answer_id": 36750260, "question_id": 36749392, "link": "https://stackoverflow.com/questions/36749392/using-vba-to-delete-thousands-of-checkboxes/36750260#36750260", "title": "Using VBA To Delete Thousands of Checkboxes", "body": "<p>I would try with the shape collection and with an indexer intead of an iterator:</p>\n\n<pre><code>Sub DeleteCheckBoxes()\n  Dim itms As shapes, i&amp;, count&amp;, deleted&amp;\n  Set itms = ActiveSheet.Shapes\n\n  On Error GoTo ErrHandler\n  For i = 1&amp; To &amp;HFFFFFFF\n    If itms(i).Type = msoFormControl Then\n      If itms(i).FormControlType = xlCheckBox Then\n        count = count + 1\n        If count &gt; 43 Then \n          itms(i).Delete\n          deleted = deleted + 1\n          i = i - 1\n        End If\n      End If\n    End If\n  Next\n\nErrHandler:\n  Debug.Print \"Count   \" &amp; count\n  Debug.Print \"Deleted \" &amp; deleted\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 36750260, "answer_count": 2, "score": 2, "last_activity_date": 1461257482, "creation_date": 1461168368, "last_edit_date": 1461171513, "question_id": 36749392, "link": "https://stackoverflow.com/questions/36749392/using-vba-to-delete-thousands-of-checkboxes", "title": "Using VBA To Delete Thousands of Checkboxes", "body": "<p>Somehow 10s of thousands of checkboxes were created in some spreadsheets that we have.  I'm not sure how this happened but we cannot open the sheets in Excel 2010 only in Excel 2003 because of it.  I wrote some VBA script to go through and delete the extra checkboxes and it works for most of the files.  But, some files seem to have way more checkboxes than others and the script dies with an Out of Memory error.  This is my script:</p>\n\n<pre><code>Sub ProcessFiles()\n  Dim Filename, Pathname, LogFileName As String\n  Dim wb As Workbook\n  Dim fso As Object\n\n  Set fso = CreateObject(\"Scripting.FileSystemObject\")\n  Set log = fso.OpenTextFile(\"Z:\\Temp\\Fix.log\", 8, True, 0)\n\n  PrintLog (\"*** Beginning Processing ***\")\n\n  Pathname = \"Z:\\Temp\\Temp\\\"\n  Filename = Dir(Pathname &amp; \"*.xls\")\n  Do While Filename &lt;&gt; \"\"\n    PrintLog (\"Opening \" &amp; Pathname &amp; Filename)\n    Set wb = Workbooks.Open(Pathname &amp; Filename)\n    DoWork wb\n    PrintLog (\"Saving file \" &amp; Pathname &amp; Filename)\n    wb.Close SaveChanges:=True\n    Filename = Dir()\n  Loop\n\n  log.Close\nEnd Sub\n\nSub DoWork(wb As Workbook)\n  Dim chk As CheckBox\n  Dim c As Integer\n\n  With wb\n    Worksheets(\"Vessel &amp; Voyage Information\").Activate\n    PrintLog (\"Getting count of checkboxes\")\n    c = ActiveSheet.CheckBoxes.Count\n    PrintLog (c &amp; \" checkboxes found\")\n    If (c &lt;= 43) Then\n      PrintLog (\"Correct # of checkboxes.  Skipping...\")\n    Else\n      c = 0\n      For Each chk In ActiveSheet.CheckBoxes\n        If Not (Application.Intersect(chk.TopLeftCell, Range(\"D29:D39\")) Is Nothing) Then\n          chk.Delete\n          c = c + 1\n        End If\n      Next\n      PrintLog (\"Deleted \" &amp; c &amp; \" checkboxes.\")\n    End If\n  End With\nEnd Sub\n\nPublic Sub PrintLog(argument As String)\n    If Not log Is Nothing Then\n        log.WriteLine Format(Now(), \"yyyy-MM-dd hh:mm:ss\") &amp; \": \" &amp; argument\n    End If\nEnd Sub\n</code></pre>\n\n<p>The script fails at the <code>c = ActiveSheet.CheckBoxes.Count</code> in <code>DoWork</code> or, if I comment that line out, then at the <code>For Each chk In ActiveSheet.CheckBoxes</code>.  I am guessing that calling <code>ActiveSheet.CheckBoxes</code> gathers up all the checkboxes and there are too many so it dies.</p>\n\n<p>Is there a way to step through each checkbox on a worksheet without using <code>ActiveSheet.CheckBoxes</code>?</p>\n"}, {"tags": ["html", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461173529, "post_id": 36749781, "comment_id": 61082638, "body": "it does not... and there is a error: &quot;object doesn&#39;t support this property or method&quot;                                                                                                                I tried &quot;.selectedIndex&quot;, as I think you might get a typo. But got the same result, &quot;Monthly&quot; on &quot;time frame&quot;, with the daily data presented on the webpage and in my excel"}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461173890, "post_id": 36749781, "comment_id": 61082863, "body": "It was a typo. So, even though the drop-down box shows Monthly, you  are sill getting daily data? Can you post your download code?"}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461176280, "post_id": 36749781, "comment_id": 61084346, "body": "I modified your code, by &quot;Var&quot; to &quot;Set&quot;, and <code>.onchange()</code> to <code>onchange</code>, but there is a error: &quot;application-defined or object-defined error&quot;. ___  I later switched <code>.onchange</code> to <code>.FireEvent(&quot;onchange&quot;)</code> (in fact i dont know what it means, but just copy it somewhere in stackoverflow). it goes to &quot;Monthly&quot;, but no data changed."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461177380, "post_id": 36749781, "comment_id": 61085015, "body": "I get code in the webpage, maybe JavaScript basis. I can understand it, but I do not know what I can do with it."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461177477, "post_id": 36749781, "comment_id": 61085070, "body": "I am sorry, I omit your question. And yes, it shows Monthly, but I get daily data, in all of these methods."}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461177667, "post_id": 36749781, "comment_id": 61085174, "body": "I am not sure why you needed to modify the code. It is pure JavaScript. Did you view the jsfiddle? What browser and version are you using? I have tested with Chrome and IE 10. I think the VBA browser control uses IE.  With IE I needed to wrap the code in an window.onload = function() {...} event."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461178616, "post_id": 36749781, "comment_id": 61085740, "body": "In VBA I use IE. I modify it because in VBA, it says &quot;compile error: sub or function not defined&quot; if I do not change <code>var</code> to <code>set</code>, and &quot;compile error: expect =&quot; if I do not dismiss the parenthesis. I tried <code>Selected.onchange() = True</code>, but got the same result. I guess you had got a wrong link when you edit the pure java, but I ahve finally opened it...I will learn carefully to see if I can wield it on my vBA code."}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461179957, "post_id": 36749781, "comment_id": 61086614, "body": "Does your version of Excel include a Browser control like VB.NET? Is the Var (capitalized) a typo? It should be lower case &quot;var&quot;."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461181238, "post_id": 36749781, "comment_id": 61087392, "body": "Not sure what you mean. I have added &quot;Microsoft html object library&quot; and &quot;Microsoft Internet Controls&quot; in reference. I tried DEVELOPER&gt;Insert&gt;More Controls&gt;Microsoft Web Browser, but it says &quot;cannot insert object&quot;. No, <code>var</code> or <code>Var</code> are not typo. I type <code>var</code> in vba and it automatically turns into <code>Var</code>. ... I am not sure if there is a method could work... maybe I will try to access the function that embedded in the webpage, and apply the function?"}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461184478, "post_id": 36749781, "comment_id": 61089554, "body": "There is no &quot;var&quot; in VBA, the equivalent is &quot;Dim&quot;.  I was able to load the references you mentioned, so now we can be on the same page. Can you show me your VBA code?"}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461185751, "post_id": 36749781, "comment_id": 61090236, "body": "Sure. Can I send you a email or something? or i&#39;ll edit on my question?"}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461187725, "post_id": 36749781, "comment_id": 61091261, "body": "Hold on a moment. I am testing some VBA code using the HTML Object library. I think I am almost there."}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "reply_to_user": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461188637, "post_id": 36749781, "comment_id": 61091673, "body": "See REVISION-2. I am getting an error on &#39;sel = html.getElementsByClassName(&quot;newInput selectBox&quot;)&#39; but am hoping you can fix it."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461249605, "post_id": 36749781, "comment_id": 61122910, "body": "I guess maybe you should try &quot;newInput selectBox float_lang_base_1&quot;. I ran the REVISION-2 and there is variable that not set? But I cannot tell which one..."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461249878, "post_id": 36749781, "comment_id": 61123119, "body": "In fact, I found that if I can update dates on the up right of the chart from <a href=\"http://www.investing.com/indices/stoxx-600-historical-data\" rel=\"nofollow noreferrer\">investing.com/indices/stoxx-600-historical-data</a>, I can update the whole data if the up left drop down menu shows &quot;Monthly&quot;. Maybe I should try my best on adjust the dates changing."}, {"owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "edited": false, "score": 0, "creation_date": 1461250047, "post_id": 36749781, "comment_id": 61123255, "body": "Hi Ron, I would like to say thank you for what you have done... Although the problem still remains, but it took you whole day helping me to solve this. Many thanks. @ron tornambe"}], "tags": [], "owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "is_accepted": false, "score": 0, "last_activity_date": 1461188393, "last_edit_date": 1461188393, "creation_date": 1461169460, "answer_id": 36749781, "question_id": 36749037, "link": "https://stackoverflow.com/questions/36749037/vba-how-to-set-option-on-webpage-as-it-will-change-the-pages-content/36749781#36749781", "title": "VBA : how to set option on webpage, as it will change the page&#39;s content", "body": "<p>I think this should work:</p>\n\n<pre><code>html.getElementById(\"data_interval\").options.selectedIndex = 2;\n</code></pre>\n\n<p><strong>REVISION</strong></p>\n\n<p>After further investigation, the onchange event must be triggered. Let's try this:</p>\n\n<pre><code>var selected = html.getElementById(\"data_interval\");\nselected.options.selectedIndex = 2;\nselected.onchange();\n</code></pre>\n\n<p><strong>REVISION-2</strong></p>\n\n<pre><code>Dim html As New HTMLDocument\nSet thtml = html.createDocumentFromUrl(\"http://bunkerhill.com/test.html\", vbNull)\nDim sel As HTMLSelectElement\nsel = html.getElementsByClassName(\"newInput selectBox\")\nsel.selectedIndex = 2\nsel.FireEvent (\"afterupdate\")\n</code></pre>\n\n<p><a href=\"https://https://jsfiddle.net/j12ebL3u/1/\" rel=\"nofollow\">Pure JavaScript jsFiddle</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6209681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd9b2f13f0c24fc198f1af933249517?s=128&d=identicon&r=PG&f=1", "display_name": "Hey.Jude", "link": "https://stackoverflow.com/users/6209681/hey-jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1512137097, "creation_date": 1461167392, "last_edit_date": 1531164843, "question_id": 36749037, "link": "https://stackoverflow.com/questions/36749037/vba-how-to-set-option-on-webpage-as-it-will-change-the-pages-content", "title": "VBA : how to set option on webpage, as it will change the page&#39;s content", "body": "<p>I was trying to copy monthly performance data from investing.com</p>\n\n<p>When I type \"<a href=\"http://www.investing.com/indices/stoxx-600-historical-data\" rel=\"nofollow noreferrer\">http://www.investing.com/indices/stoxx-600-historical-data</a>\" for the website, it presents, at default value, only daily data.</p>\n\n<p>However, I want to catch monthly performance. On the website, I can simply click drop down menu and click \"monthly\".</p>\n\n<p>I find the webpage code (maybe called xml?) for the drop down menu:</p>\n\n<pre><code> &lt;div class=\"float_lang_base_1\"&gt;\n         &lt;select class=\"newInput selectBox float_lang_base_1\" id=\"data_interval\"&gt;\n             &lt;option value=\"Daily\" selected=\"\"&gt;Daily&lt;/option&gt;\n             &lt;option value=\"Weekly\"&gt;Weekly&lt;/option&gt;\n             &lt;option value=\"Monthly\"&gt;Monthly&lt;/option&gt;\n         &lt;/select&gt;\n     &lt;/div&gt;\n</code></pre>\n\n<p>I have tried to change the \"selected\" attribute to monthly, by such vba code:</p>\n\n<pre><code>html.getElementsByTagName(\"select\")(\"data_interval\").Children(0).removeAttribute(\"selected\", \"=\") = \"\"\nhtml.getElementsByTagName(\"select\")(\"data_interval\").Children(2).setAttribute(\"selected\", \"\") = \"\"\n</code></pre>\n\n<p>The page will present \"monthly\" in the time frame drop down menu, but it did not work out. The data I download will still be daily.</p>\n\n<p>I have also tried to change the value of \"time frame\" to \"Monthly\", I got the same result. The code is as follows:</p>\n\n<pre><code>html.getElementsByTagName(\"select\")(\"data_interval\").Value = \"Monthly\"\n</code></pre>\n\n<p>Both present the webpage like this: <a href=\"https://i.stack.imgur.com/5Ie65.png\" rel=\"nofollow noreferrer\">click me</a></p>\n\n<p>Is there any method to solve the problem?</p>\n\n<p>There is also code in the webpage.</p>\n\n<pre><code>function historical_submit(isInterval) {\n    var isDatePicked = !isInterval;\n    if(!firstTimePicker) isDatePicked=true;\n    var dateFormat = $.datepicker.regional[''].dateFormat;\n    var dateTo =new Date();\n    var dateFrom = new Date();\n    var intervalInDays=30;\n    if(isDatePicked) {\n        var dates = $.datepicker._getFromToDates($.datepicker._curInst,'yy-mm-dd');\n        if (dates !== null) {\n            dateFrom=dates.dateFrom;\n            dateTo=dates.dateTo;\n        }\n    }\n    else {\n        if ($('#data_interval').val() === 'Weekly') {intervalInDays = 52 * 7}; //365 - full year\n        if ($('#data_interval').val() === 'Monthly') {intervalInDays = 30 * 24}; //~ 2 years\n        var dateFromObj=new Date();\n        dateFromObj.setDate(dateFromObj.getDate() - intervalInDays);\n        dateFrom= dateFromObj;//$.datepicker.formatDate(dateFormat,dateFromObj);\n    }\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox", "textbox"], "comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1461166638, "post_id": 36748520, "comment_id": 61078163, "body": "John can you please post all of your code?  Having a little trouble understanding what you&#39;re trying to do exactly."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1461167253, "post_id": 36748520, "comment_id": 61078684, "body": "replace for each loop like this &#39;For Each TPID In WS.Range(&quot;B2:B10&quot;)&#39; . just Assumption"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 1317640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a846b5680948f0988debf56acb4f7d1?s=128&d=identicon&r=PG", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/1317640/j-doe"}, "edited": false, "score": 0, "creation_date": 1461226096, "post_id": 36749094, "comment_id": 61105219, "body": "Tigeravatar, this worked perfectly! Thanks so much! This is as straight forward as you can possibly get, and I actually understand the code as well! Thanks again!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1461167506, "creation_date": 1461167506, "answer_id": 36749094, "question_id": 36748520, "link": "https://stackoverflow.com/questions/36748520/return-value-in-text-box-from-combobox-in-excel/36749094#36749094", "title": "Return value in text box from Combobox in Excel", "body": "<p>Create a combobox change event for your cmbTPID combobox and use this code.  Replace textbox names and named range names with your actual names:</p>\n\n<pre><code>Private Sub cmbTPID_Change()\n\n    Dim ws As Worksheet\n    Dim rFound As Range\n\n    If Me.cmbTPID.ListIndex = -1 Then\n        'Nothing selected, or user manually typed an invalid entry\n        'Clear textboxes\n        Me.txtBranch.Value = vbNullString\n        Me.txtCompanyNo.Value = vbNullString\n        Me.txtMQName.Value = vbNullString\n    Else\n        'Valid TPID selected\n        'Find it and populate the textboxes\n        Set ws = ActiveWorkbook.Sheets(\"TPIDLookup\")\n        Set rFound = ws.Range(\"TPID\").Find(Me.cmbTPID.Text, , xlValues, xlWhole)\n        If Not rFound Is Nothing Then\n            Me.txtBranch.Value = Intersect(ws.Range(\"Branch\"), rFound.EntireRow).Value\n            Me.txtCompanyNo.Value = Intersect(ws.Range(\"CompanyNo\"), rFound.EntireRow).Value\n            Me.txtMQName.Value = Intersect(ws.Range(\"MQName\"), rFound.EntireRow).Value\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1461167914, "creation_date": 1461167914, "answer_id": 36749224, "question_id": 36748520, "link": "https://stackoverflow.com/questions/36748520/return-value-in-text-box-from-combobox-in-excel/36749224#36749224", "title": "Return value in text box from Combobox in Excel", "body": "<p>you could try this</p>\n\n<p>here's your \"main\" sub code excerpt relevant for your question</p>\n\n<pre><code>Option Explicit\n\nPublic TPIDRng As Range, branchRng As Range, companyRng As Range, MQRng As Range\n\nSub main()\n\nSet TPIDRng = GetColumnUsedRange(Worksheets(\"TPIDLookup\"), \"A\")\nSet branchRng = GetColumnUsedRange(Worksheets(\"TPIDLookup\"), \"B\")\nSet companyRng = GetColumnUsedRange(Worksheets(\"TPIDLookup\"), \"C\")\nSet MQRng = GetColumnUsedRange(Worksheets(\"TPIDLookup\"), \"D\")\n\nWith UserForm1 ' change it to whatever name your actual UserForm has\n    .ComboBox1.List = Application.Transpose(TPIDRng)\n    .Show\nEnd With\nUnload UserForm1\n\nEnd Sub\n\nFunction GetColumnUsedRange(sht As Worksheet, col As String)\n\nWith sht\n    Set GetColumnUsedRange = .Range(.Cells(1, col), .Cells(.Rows.Count, col).End(xlUp))\nEnd With\nEnd Function\n</code></pre>\n\n<p>and here's the corresponding code in the UserForm code pane</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nWith Me\n    If .ComboBox1.ListIndex = -1 Then\n        .TextBoxBranch.Text = \"\"\n        .TextBoxCompany.Text = \"\"\n        .TextBoxMQ.Text = \"\"\n    Else\n        .TextBoxBranch.Text = branchRng.Cells(.ComboBox1.ListIndex + 1, 1).Value\n        .TextBoxCompany.Text = companyRng.Cells(.ComboBox1.ListIndex + 1, 1).Value\n        .TextBoxMQ.Text = MQRng.Cells(.ComboBox1.ListIndex + 1, 1).Value\n    End If\nEnd With\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>change names (for ranges, Userform, TextBoxes and Combobox) as per your needs</p>\n"}], "owner": {"reputation": 33, "user_id": 1317640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a846b5680948f0988debf56acb4f7d1?s=128&d=identicon&r=PG", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/1317640/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1913, "favorite_count": 0, "accepted_answer_id": 36749094, "answer_count": 2, "score": 0, "last_activity_date": 1461167914, "creation_date": 1461166093, "question_id": 36748520, "link": "https://stackoverflow.com/questions/36748520/return-value-in-text-box-from-combobox-in-excel", "title": "Return value in text box from Combobox in Excel", "body": "<p>I'm just looking for the most straight forward way to return a value in three text boxes, based off a selection from a combobox within a Userform. </p>\n\n<p>I have a Worksheet called 'TPIDLookup' which comprises of 4 columns; TPID, Branch Plant, Company No and MQ Name. I have set ranges for all four columns, now I just need the values from Branch Plant, Company and MQ Name to be displayed when a TPID is selected from the Combobox. I'm lost when it comes to doing this within Excel however, although I'm familiar with how it would be done within Access. </p>\n\n<p>If it helps, here is the code I've used to generate the combobox list:</p>\n\n<pre><code>Set WS = Worksheets(\"TPIDLookup\")\nFor Each TPID In WS.Range(\"TPID\")\nWith Me.cmbTPID\n.AddItem TPID.Value\nEnd With\nNext TPID\n</code></pre>\n\n<p>My research over the web has confused me even more, and I'm certain there is a dead straight forward way to do this. I am not a programmer and I am new to VBA, but any help would be greatly appreciated as this is the last step for me to complete my form. </p>\n\n<p>Many Thanks,</p>\n\n<p>John. </p>\n"}, {"tags": ["excel", "vba", "export", "range", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6206050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2100ea504e2ccdb5fd38ab0abf4369ea?s=128&d=identicon&r=PG&f=1", "display_name": "finessefitness73", "link": "https://stackoverflow.com/users/6206050/finessefitness73"}, "edited": false, "score": 1, "creation_date": 1461166907, "post_id": 36748541, "comment_id": 61078376, "body": "BruceWayne this is the answer I was looking for. I will look more into adding loops for future reference. Thank you for your prompt response!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1461166152, "creation_date": 1461166152, "answer_id": 36748541, "question_id": 36748465, "link": "https://stackoverflow.com/questions/36748465/create-multiple-text-files-using-multiple-excel-worksheets-using-vba/36748541#36748541", "title": "Create multiple text files using multiple Excel worksheets using VBA", "body": "<p>You just needed to add a loop around your code, if I understand correctly:</p>\n\n<pre><code>Sub t()\nDim ws      As Worksheet\n\nDim userName As Variant\nuserName = InputBox(\"Enter your six character user ID\")\nDim userNamePath As String\nuserNamePath = \"C:\\Users\\\" &amp; userName &amp; \"\\Desktop\\Device Configurations\\\"\nMkDir userNamePath\nDim filename As String, lineText As String\nDim myrng   As Range, i, j\n\nFor Each ws In ActiveWorkbook.Sheets\n    With ws\n        filename = userNamePath &amp; .Name &amp; \" - test.txt\"    ' to add the worksheet name to the text file\n\n        Open filename For Output As #1\n\n        Set myrng = .Range(\"C1:C5, D1:D5\")\n\n        For i = 1 To myrng.Rows.Count\n\n            For j = 1 To myrng.Columns.Count\n                lineText = IIf(j = 1, \"\", lineText &amp; \",\") &amp; myrng.Cells(i, j)\n            Next j\n            Print #1, lineText\n        Next i\n\n        Close #1\n    End With                 'ws\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6206050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2100ea504e2ccdb5fd38ab0abf4369ea?s=128&d=identicon&r=PG&f=1", "display_name": "finessefitness73", "link": "https://stackoverflow.com/users/6206050/finessefitness73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1474, "favorite_count": 0, "accepted_answer_id": 36748541, "answer_count": 1, "score": 1, "last_activity_date": 1461170668, "creation_date": 1461165933, "last_edit_date": 1461170668, "question_id": 36748465, "link": "https://stackoverflow.com/questions/36748465/create-multiple-text-files-using-multiple-excel-worksheets-using-vba", "title": "Create multiple text files using multiple Excel worksheets using VBA", "body": "<p>So what I am trying to do is create a text file from each worksheet in my excel file, exporting only column <code>D</code>. </p>\n\n<p>So far I have a macro which exports column <code>D</code>, but only on the active worksheet. </p>\n\n<p>Here is my current macro:</p>\n\n<pre><code> Private Sub CommandButton21_Click()\n\n    Dim userName As Variant\n    userName = InputBox(\"Enter your six character user ID\")\n    Dim userNamePath As String\n    userNamePath = \"C:\\Users\\\" &amp; userName &amp; \"\\Desktop\\Device Configurations\\\"\n    MkDir userNamePath\n    Dim filename As String, lineText As String\n    Dim myrng As Range, i, j\n\n    filename = userNamePath &amp; \"test.txt\"\n\n    Open filename For Output As #1\n\n    Set myrng = Range(\"C1:C5, D1:D5\")\n\n    For i = 1 To myrng.Rows.Count\n\n        For j = 1 To myrng.Columns.Count\n            lineText = IIf(j = 1, \"\", lineText &amp; \",\") &amp; myrng.Cells(i, j)\n        Next j\n        Print #1, lineText\n    Next i\n\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>So I am creating a folder on the users Desktop titled \"<code>Device configurations</code>\" and am dropping the text files into this directory. The text file is called \"<code>test</code>\" for testing purposes. I would like to export these text files with the name of their respective worksheets. </p>\n\n<p>So for example I would like to export Sheets <code>1</code>,<code>2</code>,<code>3</code>,<code>4</code>, and <code>5</code> but only column <code>D</code> from each worksheet, and each needs to have its own text file. I would like to accomplish this with a single macro click.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1461165890, "post_id": 36748171, "comment_id": 61077607, "body": "<code>all the code written to plot the chart, and all the code written to gather the data into these two columns</code> if you did all that, why is this <code>easy one</code> giving you problems??"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461165937, "post_id": 36748171, "comment_id": 61077640, "body": "If you can&#39;t sort, but you can run macros, why not duplicate that sheet, turn on macro recorder, then sort the stuff.  Then take that code and use it in your sheet? Or just use that code and have it duplicate the data on a new sheet?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461165949, "post_id": 36748171, "comment_id": 61077651, "body": "@BruceWayne how do you know where the ranges are to be?"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1461167246, "post_id": 36748171, "comment_id": 61078676, "body": "cant you just use a pivot table and have both columns as &#39;Row Labels, that separates the data by type?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461168139, "post_id": 36748171, "comment_id": 61079347, "body": "can you write in adjacent columns? or add a sheet to write in?"}, {"owner": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "edited": false, "score": 0, "creation_date": 1461173957, "post_id": 36748171, "comment_id": 61082907, "body": "@user359876- I have other data in the adjacent columns. BruceWayne- If I duplicate the sheet it won&#39;t be dynamic anymore. Right now they can input their data and click run and see a trend (if this piece of code worked) findwindow- I was hoping that other people had a quick and easy answer, as it seems like a problem others would&#39;ve had before. I&#39;m certainly no VBA expert."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461174358, "post_id": 36748171, "comment_id": 61083165, "body": "are there free column before reaching the sheet end? is it possible to add to a new temporary sheet?"}, {"owner": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461176062, "post_id": 36748171, "comment_id": 61084210, "body": "@user3598756, there are other available columns further down the sheet,  around column AA. Adding sheets is not very feasible, because each individual sample is analyzed and graphed on its own new sheet."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "edited": false, "score": 0, "creation_date": 1461175854, "post_id": 36749792, "comment_id": 61084083, "body": "I get a Type mismatch error once it makes it to the Function, at the vPrint command in the for loop. I also copied my data to a new spreadsheet, plus sheet 2 and 3 blank, so that it wouldn&#39;t interfere with my current stuff during testing. Is there a way to do this without adding sheets?"}, {"owner": {"reputation": 100, "user_id": 3123467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pN0WF.jpg?s=128&g=1", "display_name": "JMcD", "link": "https://stackoverflow.com/users/3123467/jmcd"}, "reply_to_user": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "edited": false, "score": 0, "creation_date": 1461181365, "post_id": 36749792, "comment_id": 61087482, "body": "I wonder if you have your data lined up the same way I did; 3 columns, <code>&#39;&#39;,type,%</code>. It&#39;s certainly possible to place the outputs somewhere else. Where do you want them?"}], "tags": [], "owner": {"reputation": 100, "user_id": 3123467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pN0WF.jpg?s=128&g=1", "display_name": "JMcD", "link": "https://stackoverflow.com/users/3123467/jmcd"}, "is_accepted": false, "score": 0, "last_activity_date": 1461169490, "creation_date": 1461169490, "answer_id": 36749792, "question_id": 36748171, "link": "https://stackoverflow.com/questions/36748171/if-an-excel-criteria-is-met-in-one-column-record-the-value-of-the-column-next-t/36749792#36749792", "title": "If an Excel criteria is met in one column, record the value of the column next to the matching criteria into a range", "body": "<p>I copied your dataset into Sheet1 of a blank workbook, used text to columns, made sure Sheet2 &amp; Sheet3 exist, and used this code to split it out. You can rework it for your needs. Essentially, I'm setting the dataset to an array, looping the values into separate arrays for each type, then loading each of those into a print array. The print array matches the <code>value2</code> dimensions. The intermediary arrays are jagged because you can't <code>redim preserve</code> a multidimensional array. </p>\n\n<pre><code>Sub SplitSet()\n  Dim vInput() As Variant, vTruck() As Variant, vHopper() As Variant, vPrint() As Variant\n  Dim l As Long\n\n  'Get values into array\n  vInput = Sheet1.UsedRange.Value2\n\n  'Loop through array and load type arrays\n  ReDim vTruck(1 To 1)\n  ReDim vHopper(1 To 1)\n  For l = 1 To UBound(vInput)\n    Select Case vInput(l, 2)\n      Case \"Truck\"\n        If IsEmpty(vTruck(1)) = False Then ReDim Preserve vTruck(1 To UBound(vTruck) + 1)\n        vTruck(UBound(vTruck)) = Array(vInput(l, 2), vInput(l, 3))\n      Case \"Hopper\"\n        If IsEmpty(vHopper(1)) = False Then ReDim Preserve vHopper(1 To UBound(vHopper) + 1)\n        vHopper(UBound(vHopper)) = Array(vInput(l, 2), vInput(l, 3))\n    End Select\n  Next l\n\n  'Print\n  vPrint = TypeArrayToPrintArray(vTruck)\n  Sheet2.Activate\n  Sheet2.Range(Cells(1, 1), Cells(UBound(vPrint), 2)).Value2 = vPrint\n\n  vPrint = TypeArrayToPrintArray(vHopper)\n  Sheet3.Activate\n  Sheet3.Range(Cells(1, 1), Cells(UBound(vPrint), 2)).Value2 = vPrint\nEnd Sub\n\nFunction TypeArrayToPrintArray(ByRef vArray() As Variant) As Variant()\n  Dim vPrint() As Variant\n  Dim l As Long\n  ReDim vPrint(1 To UBound(vArray), 1 To 2)\n  For l = 1 To UBound(vArray)\n    vPrint(l, 1) = vArray(l)(0)\n    vPrint(l, 2) = vArray(l)(1)\n  Next l\n\n  TypeArrayToPrintArray = vPrint\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "edited": false, "score": 0, "creation_date": 1461265062, "post_id": 36760858, "comment_id": 61132805, "body": "Yes! This is exactly what I was looking for! Worked flawlessly."}, {"owner": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "edited": false, "score": 0, "creation_date": 1461287813, "post_id": 36760858, "comment_id": 61142208, "body": "The code pastes the transposed data further down and right everytime the macro runs. Any thoughts on how to correct this? Ideally it would always show up starting at AA:1"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "edited": false, "score": 0, "creation_date": 1461301086, "post_id": 36760858, "comment_id": 61145639, "body": "just change the <code>helperRng</code> setting as per your needs. see edited code"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1461301046, "last_edit_date": 1461301046, "creation_date": 1461218422, "answer_id": 36760858, "question_id": 36748171, "link": "https://stackoverflow.com/questions/36748171/if-an-excel-criteria-is-met-in-one-column-record-the-value-of-the-column-next-t/36760858#36760858", "title": "If an Excel criteria is met in one column, record the value of the column next to the matching criteria into a range", "body": "<p><strong>edited</strong> as per OP's last clarifications</p>\n\n<p>try this</p>\n\n<pre><code>Option Explicit\n\nSub main()\n\nDim dataRng As Range, dbRng As Range, helperRng As Range, cell As Range, found As Range\nDim rangeArray() As Range\nDim iRng As Long\n\nWith Worksheets(\"MySheet\") '&lt;= change it to your actual worksheet name\n    Set dbRng = .Range(\"A1:A\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row).Resize(, 2) '&lt;= change \"A1\" to your actual data first up-left cell address\n    Set dataRng = dbRng.Offset(1).Resize(dbRng.Rows.Count - 1) 'extrapolate data only (headers off)\n    'Set helperRng = dbRng.Offset(.UsedRange.Rows.Count + 1, .UsedRange.Columns.Count + 1).Cells(1, 1) ' localize \"helper\" range out of sheet used range\n    Set helperRng = .Range(\"AA1\") ' localize \"helper\" range from cell \"AA1\" \nEnd With\ndataRng.Columns(1).SpecialCells(xlCellTypeConstants, xlTextValues).Copy Destination:=helperRng ' copy relevant data into \"helper\" rang\n\nWith helperRng\n    If .CurrentRegion.Rows.Count &gt; 1 Then .CurrentRegion.RemoveDuplicates Columns:=Array(1), Header:=xlNo ' take only samples unique values\n    With .CurrentRegion\n        ReDim rangeArray(1 To .Rows.Count) 'size the array to sample unique values number\n        For iRng = 1 To .Rows.Count 'loop through sample unique values\n            dbRng.AutoFilter field:=1, Criteria1:=helperRng(iRng, 1) ' filter data accordingly to current sample value\n            Set rangeArray(iRng) = dataRng.Columns(2).SpecialCells(xlCellTypeVisible) 'store filtered rows columns 2 ranges\n            .AutoFilter\n        Next iRng\n    End With\n'    .ClearContents '&lt;== remove the comment once you're done with the example\nEnd With\n\n' here follows an example of exploiting rangeArray array\n' once you're done with it, remove this example and uncomment the \".ClearContents\" statement by the end of preceeding \"With ... End With\" block\nFor iRng = 1 To UBound(rangeArray)\n    rangeArray(iRng).Copy\n    helperRng.Offset(iRng - 1, 1).Resize(1, rangeArray(iRng).Count).PasteSpecial xlPasteAll, Transpose:=True\nNext iRng\n\nEnd sub\n</code></pre>\n\n<p>it'll work with whatever samples different values</p>\n"}], "owner": {"reputation": 5, "user_id": 6226467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684fbf733d7ae3410ecc8f3db9f47f61?s=128&d=identicon&r=PG&f=1", "display_name": "LJohns", "link": "https://stackoverflow.com/users/6226467/ljohns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 36760858, "answer_count": 2, "score": 0, "last_activity_date": 1461301046, "creation_date": 1461165314, "last_edit_date": 1461176659, "question_id": 36748171, "link": "https://stackoverflow.com/questions/36748171/if-an-excel-criteria-is-met-in-one-column-record-the-value-of-the-column-next-t", "title": "If an Excel criteria is met in one column, record the value of the column next to the matching criteria into a range", "body": "<p>Perhaps I just haven't been looking in the right places, but I don't think this should be as difficult as I am finding it to be.</p>\n\n<p>I have a spreadsheet, that CANNOT be sorted (it's in a production line, connected to individual sheets that bring other data in, filled out by many different people). The data that comes in is essentially random, and looks like this:</p>\n\n<pre><code>''    Type    Sieve #40\n''\n''    Truck       55%\n''    Truck       55%\n''    CoA         48%\n''    Basement    55%\n''    Bin2        55%\n''    Bin1        55%\n''    Hopper      57%\n''    Basement    58%\n''    Bin2        54%\n''    Bin1        58%\n''    Hopper      56%\n''    Truck       56%\n''    CoA         47%\n''    Basement    55%\n''    Bin2        57%\n''    Bin1        61%\n''    Hopper      50%\n</code></pre>\n\n<p>Now, I need a macro that can find the sample type (truck, bin1, etc.) and puts each value that corresponds to that sample type into a range. Then I can plot the ranges on a chart.</p>\n\n<p>For example, the \"Truck\" range would have the numbers 55%, 55%, 56%.</p>\n\n<p>So there are 6 different sample types which means 6 different ranges, which means 6 different series on my chart.</p>\n\n<p>I have all the code written to plot the chart, and all the code written to gather the data into these two columns. I am just missing this piece.</p>\n\n<p>Ideally, for example, there would be a way to set up a For loop that goes from row 1 to the last row of the sheet, and when it finds \"truck\", it assigns the number in the column next to \"truck\" to the first spot in a new array. Then the next instance of \"truck\" fills the next spot in the \"Truck\" array, and so on.</p>\n\n<p>Adding sheets is very nearly impossible for me, because the operators must add a new sheet for each sample, which then gets some data pulled into this summary sheet.</p>\n"}, {"tags": ["vba", "excel", "macros", "userform"], "comments": [{"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461165722, "post_id": 36748161, "comment_id": 61077477, "body": "Do you need to unload the userform? Can you just hide it instead? <a href=\"http://stackoverflow.com/questions/18897803/vba-hide-user-form-but-retain-data-entered-into-it\" title=\"vba hide user form but retain data entered into it\">stackoverflow.com/questions/18897803/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461165836, "post_id": 36748161, "comment_id": 61077557, "body": "Try stepping through your macro (with <code>F8</code>) and see if that helps determine where the crash is coming from."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 5372235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de1b3104a9e960d1ca4659b188fce94a?s=128&d=identicon&r=PG&f=1", "display_name": "Callum Rhodes", "link": "https://stackoverflow.com/users/5372235/callum-rhodes"}, "is_accepted": false, "score": 0, "last_activity_date": 1461166800, "creation_date": 1461166800, "answer_id": 36748788, "question_id": 36748161, "link": "https://stackoverflow.com/questions/36748161/vba-macro-crash-with-no-error-message/36748788#36748788", "title": "VBA Macro crash with no error message", "body": "<p>I seem to have stumbled across an answer. I had defined an userform1_activate event which I mistakenly wanted to use as an initialize event so having now changed this my problem has stopped. </p>\n\n<p>I guess it was something to do with userform1 trying to run two subs at the same time, the activate event (when userform2 closes) and button1_click.</p>\n"}], "owner": {"reputation": 5, "user_id": 5372235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de1b3104a9e960d1ca4659b188fce94a?s=128&d=identicon&r=PG&f=1", "display_name": "Callum Rhodes", "link": "https://stackoverflow.com/users/5372235/callum-rhodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 961, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461166800, "creation_date": 1461165298, "question_id": 36748161, "link": "https://stackoverflow.com/questions/36748161/vba-macro-crash-with-no-error-message", "title": "VBA Macro crash with no error message", "body": "<p>I'm having an issue where my macro is crashing to excel with no error message. </p>\n\n<p>The macro opens a first userform1, data is inputted into userform1 then a button is pressed. I have coded this button to run some code and also open a second userform (userform2) using the command:</p>\n\n<pre><code>    Private Sub button1_Click()\n    'Some code\n    Userform2.show\n    'More code\n    End Sub()\n</code></pre>\n\n<p>In this second userform some more data is added and the button2 is pressed to run some code. This code uses data from userform1 as well changing some textboxes in userform 1</p>\n\n<pre><code>    Private Sub button2_Click()\n    'Some Code\n    Unload Userform2\n    End Sub\n</code></pre>\n\n<p>Button2_Click runs through no problems but as soon as userform2 is closed i get the crash to excel with no message. I think it is a syntax issue as the two userforms in question work in isolation.</p>\n\n<p>Also, when I add a break point after Userform2.show in Button1_Click I get the error message: \"Can't perform requested operation\" but then the code stops at the break point. I then play the code and it doesn't crash in this instance.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "trim"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461165266, "post_id": 36748074, "comment_id": 61077125, "body": "They all have <code>&amp;</code>? Confused to your goal."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461165386, "post_id": 36748074, "comment_id": 61077208, "body": "edited original post so that its more clear"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461165425, "post_id": 36748074, "comment_id": 61077240, "body": "the image is to reference two examples of why it didnt work- if the textbox display happens to be a part of the issue"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461165550, "post_id": 36748074, "comment_id": 61077323, "body": "It&#39;s kind of hard to tell which examples don&#39;t work when all of them have <code>&amp;</code> XD Whatever, I can think this through theoretically."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461165647, "post_id": 36748074, "comment_id": 61077417, "body": "Oh. Because the <code>instr</code> in your <code>trim</code> is reading the first half. Edit: so it only works if that is shorter than the second half. Edit2: you want to find the space after the <code>&amp;</code> and do your <code>right</code> from there."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461166337, "post_id": 36748074, "comment_id": 61077945, "body": "@findwindow comment upvotes don&#39;t earn you rep you know ;-)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1461166434, "post_id": 36748074, "comment_id": 61078015, "body": "@Mat&#39;sMug ooohh so that&#39;s what I have been doing wrong XD"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1461166910, "post_id": 36748074, "comment_id": 61078381, "body": "Why don&#39;t you just use the <code>Mid$()</code> function instead?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1461167061, "post_id": 36748074, "comment_id": 61078508, "body": "Because I didnt think of it till you mentioned it <i>blush</i>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1461167101, "post_id": 36748074, "comment_id": 61078542, "body": "haha fair enough - also I&#39;ve updated your post to clarify the image as I this <i>really</i> confused me!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461167148, "post_id": 36748074, "comment_id": 61078578, "body": "Oh yea! <code>mid</code> with <code>find</code> duh XD Edit: ooohhhh the image is the source. Yea, super confusing."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1461168518, "post_id": 36748074, "comment_id": 61079630, "body": "sorry about that :( I will try and be super thorough next time"}], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1461167079, "post_id": 36748695, "comment_id": 61078522, "body": "i will try this out and let you know how awesome you are in a bit"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1461168425, "post_id": 36748695, "comment_id": 61079571, "body": "syntax error in you altered line. got it to work but i had to choose an answer and the mid function is actually what I ended up doing anyway,."}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 1, "last_activity_date": 1461166581, "creation_date": 1461166581, "answer_id": 36748695, "question_id": 36748074, "link": "https://stackoverflow.com/questions/36748074/trim-issue-with-vba/36748695#36748695", "title": "Trim Issue With VBA", "body": "<p>You're currently getting the position of <code>&amp;</code> from the left of the string and then using this number to take the date from the right of the string; instead you should subtract the <code>Instr</code> value of <code>&amp;</code> from the <code>Len</code> of the string in order to get your remaining characters. Try this:</p>\n\n<pre><code>Private Sub Block1_Enter()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Dim MyData As New DataObject\n    Dim this As String\n    Dim oldxt As String\n    oldtxt = Block1.Text\n    If InStr(Block1.Text, \"&amp;\") &gt; 0 Then\n        this = Trim(Right(Block1.Text, (Len(Block1) - InStr(Block1.Text, \"&amp;\") - 1))\n        Block1.Text = \"End Date Copied\" &amp; this\n        MyData.SetText this\n        MyData.PutInClipboard\n        Application.Wait (Now + #12:00:02 AM#)\n        Block1.Text = oldtxt\n    End If\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>The reason those dates in particular were errors was because the character length of the second date was shorter than the character length of the first date.</p>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461167276, "post_id": 36748965, "comment_id": 61078701, "body": "Wait. What&#39;s the <code>$</code>?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461167388, "post_id": 36748965, "comment_id": 61078809, "body": "It&#39;s a type character, methods like <code>Trim()</code>, <code>Left()</code>, <code>Mid()</code> etc. actually return a <code>Variant</code> - using the <code>$</code> type character implicitly casts the return value to a <code>String</code> which is faster to process. But in real life - probably not any noticeable difference. Okay, I&#39;m a snob so what.."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461167429, "post_id": 36748965, "comment_id": 61078836, "body": "Removing upvote and downvoting and flagging for being a snob."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461167450, "post_id": 36748965, "comment_id": 61078853, "body": "Totally worth it. I regret nothing."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1461168461, "post_id": 36748965, "comment_id": 61079596, "body": "Snobby and cocky are ok as long as you are awesome at whatever youre being arrogant about :D"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1461167221, "creation_date": 1461167221, "answer_id": 36748965, "question_id": 36748074, "link": "https://stackoverflow.com/questions/36748074/trim-issue-with-vba/36748965#36748965", "title": "Trim Issue With VBA", "body": "<p>Use <code>Mid$()</code> instead:</p>\n\n<pre><code>this = Trim$(Mid$(Block1.Text, InStr(Block1.Text, \"&amp;\") +  1))\n</code></pre>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 36748965, "answer_count": 2, "score": 2, "last_activity_date": 1461167221, "creation_date": 1461165089, "last_edit_date": 1461167056, "question_id": 36748074, "link": "https://stackoverflow.com/questions/36748074/trim-issue-with-vba", "title": "Trim Issue With VBA", "body": "<p>So the below code works sometimes and sometimes it adds the ampersand (to the copy buffer) which I am trying to cut out of the text string. </p>\n\n<p>The point of the code is to copy the string from the right position up to before the ampersand. However, in random scenarios it still adds the ampersand.</p>\n\n<pre><code>Private Sub Block1_Enter()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Dim MyData As New DataObject\n    Dim this As String\n    Dim oldxt As String\n    oldtxt = Block1.Text\n    If InStr(Block1.Text, \"&amp;\") &gt; 0 Then\n        this = Trim(Right(Block1.Text, InStr(Block1.Text, \"&amp;\") - 1))\n        Block1.Text = \"End Date Copied\" &amp; this\n        MyData.SetText this\n        MyData.PutInClipboard\n        Application.Wait (Now + #12:00:02 AM#)\n        Block1.Text = oldtxt\n    End If\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>can someone try and explain why it sometimes works and sometimes doesnt? Below is an image with the two examples of where it doesnt work correctly</p>\n\n<p><em>(Note for clarification: the textbox values shown below are the <strong>source</strong> values, not the results)</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/GxG6S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GxG6S.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 2, "creation_date": 1461165112, "post_id": 36747984, "comment_id": 61077011, "body": "Would it not be easier to save the template as a &#39;Read Only&#39; file so that you don&#39;t save over it each day but instead save a copy of it with the copied images/text, then whenever you re-enter the spreadsheet you will not need to reset it as it will be in the same state as you left it?"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1461168212, "post_id": 36747984, "comment_id": 61079395, "body": "That&#39;s a good idea.  Unfortunately due to our processes in my business unit I have to save over the same file each day."}], "answers": [{"comments": [{"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1461169695, "post_id": 36749412, "comment_id": 61080390, "body": "That makes sense.  I ran it on my currently large file and it didn&#39;t make it smaller.  Maybe this won&#39;t make an already large file smaller, but will keep a small file from becoming large?  In which case I can create a new template and run this macro daily."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1461170545, "post_id": 36749412, "comment_id": 61080910, "body": "I just a added the code to remove obsolete columns too. If that doesn&#39;t help then you might want to give this a try: <a href=\"http://stackoverflow.com/questions/17527917/how-to-reduce-a-huge-excel-file\" title=\"how to reduce a huge excel file\">stackoverflow.com/questions/17527917/&hellip;</a>. To answer your question: the above code may reduce the file size if there is unused space reserved. This should work for small files (to keep them small) and large file (making them smaller) alike. But if that code doesn&#39;t help then maybe there are other causes."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1461170343, "last_edit_date": 1461170343, "creation_date": 1461168424, "answer_id": 36749412, "question_id": 36747984, "link": "https://stackoverflow.com/questions/36747984/vba-to-clear-template-not-deleting-everything/36749412#36749412", "title": "VBA to Clear Template not Deleting Everything?", "body": "<p>Give this a try and let me know if it helps:</p>\n\n<pre><code>Option Explicit\n\nSub Reset_Template()\n\nDim I As Integer\nDim WS_Count As Integer\nDim lngLastRow As Long\nDim lngLastColumn As Long\n\nWS_Count = ThisWorkbook.Worksheets.Count - 1\n\nFor I = 1 To WS_Count\n    lngLastRow = 0: lngLastColumn = 0\n    With ThisWorkbook.Worksheets(I)\n        If .AutoFilterMode Then .AutoFilter\n        .DrawingObjects.Delete\n        .Range(\"C67\").Delete Shift:=xlUp\n        On Error Resume Next\n        lngLastRow = .Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        lngLastColumn = .Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n        On Error GoTo 0\n        .Rows(lngLastRow + 1 &amp; \":\" &amp; .Rows.Count).EntireRow.Delete\n        .Columns(lngLastColumn + 1 &amp; \":\" &amp; .Columns.Count).EntireColumn.Delete\n    End With\nNext I\n\nThisWorkbook.Worksheets(1).Activate\nThisWorkbook.Worksheets(1).Cells.Select\n\nEnd Sub\n</code></pre>\n\n<p>In addition to some code optimizations the main difference between the above code and yours is that \"seemingly\" empty rows after the last one are being deleted. The problem I encountered is that: if a row is being used and then the content is cleared out then (sometimes) Excel still \"keeps\" the empty row in the save file. In the above code I am deleting all such rows and was (in my case) thereby able to drastically reduce some of my older files.</p>\n"}, {"tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": true, "score": 0, "last_activity_date": 1461858787, "creation_date": 1461858787, "answer_id": 36919684, "question_id": 36747984, "link": "https://stackoverflow.com/questions/36747984/vba-to-clear-template-not-deleting-everything/36919684#36919684", "title": "VBA to Clear Template not Deleting Everything?", "body": "<p>I found that when I switched the file type from .xls to .xlsm the file size shrunk immediately and stayed small.  From a posting I read that .xls files sometimes have data leaks.  I imagine this is what was contributing to the steadily increasing file size.  I used the .xls and .xlsm files in parallel and measured the file size for 6 days.  The regressions are below:    </p>\n\n<p>This is the regression for .xlsm:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rgrPl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rgrPl.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is the regression for .xls:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4P1xw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4P1xw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So as you can see, the .xls file is increasing by 760 KB a day with a very high level of significance.  </p>\n\n<p>My conclusion is that it is not the code itself, but is based on the type that the file is saved as</p>\n"}], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 36919684, "answer_count": 2, "score": 0, "last_activity_date": 1461858787, "creation_date": 1461164876, "question_id": 36747984, "link": "https://stackoverflow.com/questions/36747984/vba-to-clear-template-not-deleting-everything", "title": "VBA to Clear Template not Deleting Everything?", "body": "<p>I wrote a macro to clear the data of an excel template I use every day.  I put copied images and text into the template, save it and then the next day use the macro to clear it and repeat the process.  I've noticed after a month or two the file has become extremely large for what it contains.  It was about 50KB and is now 18,317KB with about the same amount of data.  The increase was gradual, not immediate.  Probably a few hundred KB a day.</p>\n\n<p>I've checked to see if there is any formatting in the cells and there isn't.  I think my code deletes all of the cells in each sheet except for the last (which contains very little data), but I'm not sure if it is working.</p>\n\n<pre><code>Sub Reset_Template()\n    Dim WS_Count As Integer\n    Dim I As Integer\n    WS_Count = ActiveWorkbook.Worksheets.Count - 1\n\n    For I = 1 To WS_Count\n    Sheets(I).Select\n    If ActiveSheet.AutoFilterMode Then\n    Cells.AutoFilter\n    End If\n    Sheets(I).Select\n    ActiveSheet.DrawingObjects.Select\n    Selection.Delete\n    Cells.Select\n    Range(\"C67\").Activate\n    Selection.Delete Shift:=xlUp\n    Cells.Select\n\n    Next I\n\n    Sheets(1).Select\n    Cells.Select    \nEnd Sub\n</code></pre>\n\n<p>Is my macro somehow not deleting all of the contents of my template? Or could it be something to do with the spreadsheet's settings?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "find", "carriage-return"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1461163504, "post_id": 36747392, "comment_id": 61075696, "body": "What if you try <code>Range(&quot;1:1&quot;).Find(&quot;*&quot; &amp; headerText &amp; &quot;*&quot;).Column</code>"}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461163810, "post_id": 36747392, "comment_id": 61075917, "body": "No luck. Same problem"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461164297, "post_id": 36747392, "comment_id": 61076326, "body": "How did you declare <code>newCol</code>? I put &quot;Test [alt-enter] Test&quot; and ran <code>newCol = Range(&quot;1:1&quot;).Find(&quot;Test&quot;).Column</code> and it worked."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1461164327, "post_id": 36747392, "comment_id": 61076349, "body": "Did you try <code>Trim</code> and <code>CLEAN</code>Functions???"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1461164507, "post_id": 36747392, "comment_id": 61076527, "body": "If you are absolutely certain it is in Range (1:1) then you can try <code>Range(&quot;1:1&quot;).Find(What:=headerText, LookAt:=xlPart).Column</code>"}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461165586, "post_id": 36747392, "comment_id": 61077359, "body": "Elbert and LocEngineer: neither solution worked. There are no blank spaces on either end of the string and the string is the entire value of the cell, not just part of it."}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461165665, "post_id": 36747392, "comment_id": 61077434, "body": "Bruce: Technically, it&#39;s the return value of a function. But I&#39;m not surprised yours worked since you looked for a string &quot;Test&quot; with no carriage return in it."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1461165852, "post_id": 36747392, "comment_id": 61077563, "body": "Stupid question: are you searching for <code>Incomplete Email</code> or for <code>Incomplete Email (more text)</code> ?"}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461166031, "post_id": 36747392, "comment_id": 61077715, "body": "I&#39;m searching for the whole thing: &quot;Incomplete Email (more text)&quot;, where there&#39;s a carriage return between &quot;Incomplete Email&quot; and &quot;(more text)&quot;."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1461166733, "post_id": 36747392, "comment_id": 61078239, "body": "In that case it just worked for me using <code>Find(What:=&quot;Incomplete Email&quot; &amp; Chr(10) &amp; &quot;(more text)&quot;)</code>"}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461167000, "post_id": 36747392, "comment_id": 61078453, "body": "Right, so that works because you&#39;ve hardcoded the string and carriage return. But I don&#39;t KNOW there will be one. So I need to search for the VARIABLE not the VALUE."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461164272, "post_id": 36747708, "comment_id": 61076299, "body": "See BruceWayne&#39;s comment above. This does not work. Makes some sense that it would not, since I have the whole string, so the wildcards &quot;*&quot; don&#39;t really do much."}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461167335, "post_id": 36747708, "comment_id": 61078753, "body": "It&#39;s not a perfect solution for me, but it can do as a backup. First I&#39;ll determine if there&#39;s a carriage return and there is, I&#39;ll use this code. Thanks!"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1461167016, "last_edit_date": 1461167016, "creation_date": 1461164201, "answer_id": 36747708, "question_id": 36747392, "link": "https://stackoverflow.com/questions/36747392/range-find-text-with-carriage-return-excel-vba/36747708#36747708", "title": "Range.Find() text with carriage return Excel VBA", "body": "<p>pls try with below code</p>\n\n<pre><code>Public Function getColumn(headerText As String)\n    str1 = Split(headerText, vbCrLf)\n    str2 = UBound(str1)\n    b = Range(\"1:1\").Find(str1(0) &amp; Chr(10) &amp; str1(1)).Column\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461166088, "post_id": 36748393, "comment_id": 61077754, "body": "You&#39;re searching for part of the header text, not the whole thing."}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461167201, "post_id": 36748393, "comment_id": 61078632, "body": "Try searching for Range(&quot;H1&quot;).Value, or wherever you have that text stored. It shouldn&#39;t work."}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461169804, "post_id": 36748393, "comment_id": 61080464, "body": "No such luck, although things are slightly different. Because I&#39;m working with a form, headerText is actually the value of a dropdown/combobox that&#39;s passed to the function. Using the <code>LookAt:=xlWhole</code> and <code>Lookin:=xlValues</code> didn&#39;t help."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1461168591, "last_edit_date": 1461168591, "creation_date": 1461165757, "answer_id": 36748393, "question_id": 36747392, "link": "https://stackoverflow.com/questions/36747392/range-find-text-with-carriage-return-excel-vba/36748393#36748393", "title": "Range.Find() text with carriage return Excel VBA", "body": "<p>Your code should work even if the header cell contains carriage returns:</p>\n\n<pre><code>Sub FindColumnWithTextInRowOne()\n    Dim headerText As String, newCol As Long\n\n    headerText = \"whatever\"\n    newCol = Range(\"1:1\").Find(headerText).Column\n    MsgBox newCol\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kVcMU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVcMU.png\" alt=\"enter image description here\"></a></p>\n\n<p><br> This is because your use of <em>Find()</em> does not require a match to the WHOLE contents of the cell.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If the header cell was constructed using a <em>formula</em>, then a slightly different <code>Find()</code> should be used:</p>\n\n<pre><code>   Sub FindColumnWithTextInRowOne()\n    Dim headerText As String, newCol As Long, r As Range\n    headerText = Range(\"H1\").Text\n    newCol = Range(\"1:1\").Find(What:=headerText, LookAt:=xlWhole, LookIn:=xlValues).Column\n    MsgBox newCol\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zod6R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zod6R.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461167568, "post_id": 36749058, "comment_id": 61078968, "body": "Thanks. Unfortunately, as I&#39;ve mentioned above, I need to search for the variable because the exact string can vary. Can you use RegEx with a variable?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461168025, "post_id": 36749058, "comment_id": 61079274, "body": "Provided breaks can only happen in between words of the variable value, yes. See edit2."}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461169855, "post_id": 36749058, "comment_id": 61080495, "body": "This seems more intuitive, but also more clunky than Karthick&#39;s solution above."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1461227548, "post_id": 36749058, "comment_id": 61106281, "body": "It definitely looks more clunky. But Kathick&#39;s won&#39;t work if there is NO line break. Also my code above contained errors. I have amended it a bit and also extended for when the headertext contains spaces or line breaks or characters that need to be escaped for regex. Should do fine though."}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 1, "last_activity_date": 1461227654, "last_edit_date": 1461227654, "creation_date": 1461167431, "answer_id": 36749058, "question_id": 36747392, "link": "https://stackoverflow.com/questions/36747392/range-find-text-with-carriage-return-excel-vba/36749058#36749058", "title": "Range.Find() text with carriage return Excel VBA", "body": "<p>Here's the thing: text with and without line break is NOT the same text hence the <code>.Find</code> fail. What you should do is a pattern lookup. I have just tested this and it works, provided that if there is no line break there shall be a space:</p>\n\n<pre><code>Sub test()\nDim rex As RegExp, ran As Range\nDim col As Integer, headerText As String\n\n'read you headerText here\n\nSet rex = New RegExp\nrex.Pattern = RegexIt(headerText)\n\nFor Each ran In Range(\"1:1\")\n    If rex.test(ran.Text) Then\n        col = ran.Column\n        Exit For\n    End If\nNext ran\n\nMsgBox col\n\nEnd Sub\n\nFunction RegexIt(what As String) As String\n\nwhat = Replace(what, \"(\", \"\\(\")\nwhat = Replace(what, \")\", \"\\)\")\nwhat = Replace(what, \"[\", \"\\[\")\nwhat = Replace(what, \"]\", \"\\]\")\nwhat = Replace(what, \"&lt;\", \"\\&lt;\")\nwhat = Replace(what, \"&gt;\", \"\\&gt;\")\nwhat = Replace(what, \" \", \"[\\n ]?\")\nwhat = Replace(what, vbCrLf, \"[\\n ]?\")\n\nEnd Function\n</code></pre>\n\n<p>Good luck!</p>\n\n<p><strong>Edit:</strong> Reference to Microsoft VBScript Regular Expressions 5.5 required</p>\n\n<p><strong>Edit2:</strong> Edited for variable use. Explanation: Replace space in variable value with optionel space/line break, escape brackets for pattern matching.</p>\n"}], "owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3517, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1461227654, "creation_date": 1461163462, "last_edit_date": 1461167087, "question_id": 36747392, "link": "https://stackoverflow.com/questions/36747392/range-find-text-with-carriage-return-excel-vba", "title": "Range.Find() text with carriage return Excel VBA", "body": "<p><strong>What I'm trying to do</strong> <br/>\nLocate the column whose header cell contains a unique string. In other words, I know the cell's text, and I know the cell is in row 1, but I don't know which column. NOTE: I want to search for the <em>entire</em> text, not just part of it. NOTE2: The text can vary, so I cannot hardcode the <em>value</em> into my code. Rather I need to use the <em>variable</em> in which the value is stored.</p>\n\n<p><strong>The problem</strong> <br/>\nWhen there's no carriage return in the header text, a simple <code>newCol = Range(\"1:1\").Find(headerText).Column</code> <strong>works fine</strong>. However, if there is a carriage return, this doesn't work. It throws up the error \"Object variable or With block variable not set\". Here's my exact header string:</p>\n\n<pre><code>Incomplete Email\n(more text)\n</code></pre>\n\n<p><strong>What I've already tried</strong> <br/>\nI also tried using <code>WorksheetFunction.Match(headerText, Range(\"1:1\"), 0)</code>, but got the same issue. </p>\n\n<p><strong>Additional notes and requirements</strong> <br/>\nThis is part of an add-in, so I do not want to change anything in the user's excel sheet if I don't have to (i.e., I <em>don't</em> want to remove the carriage return).</p>\n\n<p>Technically, I'm doing this in a function:</p>\n\n<pre><code>Public Function getColumn(headerText As Variant)\n    getColumn = Range(\"1:1\").Find(headerText).Column\nEnd Function\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["java", "forms", "vba", "jsp"], "comments": [{"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461165409, "post_id": 36747051, "comment_id": 61077224, "body": "This error means there&#39;s a JavaScript error on the page - it has nothing to do with VBA/Java/JSP etc. Please get the error from the browser console and paste it here. Also see <a href=\"http://stackoverflow.com/questions/10903989/could-not-complete-the-operation-due-to-error-80020101-ie\" title=\"could not complete the operation due to error 80020101 ie\">stackoverflow.com/questions/10903989/&hellip;</a>"}, {"owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461165605, "post_id": 36747051, "comment_id": 61077374, "body": "Yes, i&#39;ve read this article, but have nothing to do with it :( No some comments or &quot;//&quot; symbols to add or remove. And, btw, entering everything manually and pressing the button generates no error. Or it doesn&#39;t mean anything?"}, {"owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461165964, "post_id": 36747051, "comment_id": 61077662, "body": "And actually, i&#39;ve get this error in the VBA editor itself, so probably i&#39;m sending some arguments somehow wrong."}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461166254, "post_id": 36747051, "comment_id": 61077883, "body": "Right the SO question was merely showing that error 80020101 is related to JS. I agree if you can&#39;t get the error when doing it manually it&#39;s with VBA. But you should be able to pause the code on the error and check the IE console for the JS error."}, {"owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461166579, "post_id": 36747051, "comment_id": 61078111, "body": "Erm, unfortunately i&#39;ve got &quot;Permission denied&quot; error to access any Developer tools via IE. I&#39;ve used Chrome to get tag names and properties."}], "answers": [{"tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1461173736, "last_edit_date": 1495541772, "creation_date": 1461173736, "answer_id": 36751198, "question_id": 36747051, "link": "https://stackoverflow.com/questions/36747051/submitting-a-java-script-form-for-jsp-site-through-vba/36751198#36751198", "title": "Submitting a Java Script form for jsp site through VBA", "body": "<p>The Permission Denied issues appears be well documented elsewhere e.g. <a href=\"https://stackoverflow.com/questions/10283496/vba-internet-explorer-automation-permission-denied\">here</a>. My recommendation is that you need to get access to the actual JS error from within IE to figure out what's wrong.</p>\n\n<p>Of course there are other ways to do this type of things namely to use a tool called <a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">Selenium</a> which has bindings in many languages including VBA. The advantages to a tool like Selenium is that 1) It's the defacto choice for this type of thing and 2) it works on all browsers not just IE.</p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "is_accepted": true, "score": 0, "last_activity_date": 1461325069, "creation_date": 1461325069, "answer_id": 36792838, "question_id": 36747051, "link": "https://stackoverflow.com/questions/36747051/submitting-a-java-script-form-for-jsp-site-through-vba/36792838#36792838", "title": "Submitting a Java Script form for jsp site through VBA", "body": "<p>Well, thanks everyone for concerns, I've found what I need.</p>\n\n<p>Actually, I didn't need to address the script directly. I've just had to dig a bit deeper in trying to use .Click method.</p>\n\n<p>Initially I supposed, that only some \"button\" tags may be accessed by \".Click\", but then I found that you may use it on &lt; a ...> tag as well.</p>\n\n<p>So, i've just used following code:</p>\n\n<pre><code>IEDoc.Frames(\"i2ui_shell_content\").Document.Frames(\"results\") _\n.Document.forms(\"LoginViewForm\").GetElementsByTagName(\"a\")(1).Click\n</code></pre>\n\n<p>Which accordingly run JS, contained in this  tag:</p>\n\n<pre><code>&lt;a href=\"javascript:submitLogin (document.LoginViewForm);\"tabindex=\"3\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 36792838, "answer_count": 2, "score": 0, "last_activity_date": 1461325069, "creation_date": 1461162664, "last_edit_date": 1461166873, "question_id": 36747051, "link": "https://stackoverflow.com/questions/36747051/submitting-a-java-script-form-for-jsp-site-through-vba", "title": "Submitting a Java Script form for jsp site through VBA", "body": "<p>I need to fill the login form by VBA code.\nI could not get any reaction on any combination of \".Click\" method so i've tried to fill the form and then call JS submitting function but always get this error (as a VBA Error Message Box):</p>\n\n<blockquote>\n  <p>Could not complete the operation due to error 80020101</p>\n</blockquote>\n\n<p>On the .jsp page there are following elements to interact with:</p>\n\n<p>The form itself:</p>\n\n<pre><code>&lt;form id=\"LoginViewForm\" onsubmit=\"checkOnSubmit(this); return false;\"\nmethod=\"POST\" name=\"LoginViewForm\" action=\"LoginViewController.jsp\"&gt;\n&lt;input type=\"HIDDEN\" name=\"ControllerAction\"&gt;\n&lt;input type=\"HIDDEN\" name=\"loginPassword\"&gt;\n&lt;input type=\"HIDDEN\" name=\"newPassword\"&gt;\n</code></pre>\n\n<p>Input boxes are the following:</p>\n\n<pre><code>        &lt;td&gt;\n            &lt;input name=\"loginUser\" size=\"20\" maxlength=\"18\" type=\"text\"\n             tabindex=\"1\" class=\"inputField\" onfocus=\"this.select();\"&gt;\n        &lt;/td&gt;\n\n        &lt;td&gt;\n            &lt;input name=\"dspLoginPassword\" size=\"20\" maxlength=\"18\"\n            type=\"password\" tabindex=\"2\" class=\"inputField\"\n            onfocus=\"this.select();\" autocomplete=\"off\"&gt;\n        &lt;/td&gt;\n</code></pre>\n\n<p>There is a button, which should be clicked to submit a form:</p>\n\n<pre><code>&lt;table id=\"buttonID1\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\"\nclass=\"buttonBorderEmphasized\"&gt;\n &lt;tbody&gt;&lt;tr&gt;\n  &lt;td id=\"buttonEmphasized\" nowrap=\"yes\"class=\"buttonTextEmphasized\"&gt;\n   &lt;a href=\"javascript:submitLogin (document.LoginViewForm);\"\n   tabindex=\"3\"&gt;&amp;nbsp;&amp;nbsp;\n   Login&amp;nbsp;&amp;nbsp;&lt;/a&gt;\n&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n</code></pre>\n\n<p>And there is following script function, which is started by the button above:</p>\n\n<pre><code> function submitLogin(form)\n {\n\n  if(validateLogin()) {\n\n    window.document.body.style.cursor = 'progress';\n    showStatusMessage();\n    form.ControllerAction.value = 'Login';\n    form.submit();\n    return;\n\n  } else resetSubmitted(); return;\n\n} \n</code></pre>\n\n<p>I'm trying following code to handle with it (have tried different variants of calling java script, this is final one, but still doesn't work):</p>\n\n<pre><code> Set objFormMain = IEDoc.Frames(\"i2ui_shell_content\").Document _\n .Frames(\"results\").Document.forms(\"LoginViewForm\")\n\nWith objFormMain\n    .Elements(\"LoginUser\").Value = 1\n    .Elements(\"dspLoginPassword\").Value = 1\n    IE.Document.all.Item\n    Call IE.Document.parentWindow.execScript(\"submitLogin(document.LoginViewForm)\", \"JavaScript\")\n    .submit\nEnd With\n</code></pre>\n\n<p>The error itself returns at line \"Call IE.Document.parentWindow.execScript(\"submitLogin(document.LoginViewForm)\", \"JavaScript\")\"</p>\n\n<p>Any ideas how to modify the code to make it work?</p>\n"}, {"tags": ["excel", "vba", "letters"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461162970, "post_id": 36747042, "comment_id": 61075272, "body": "<code>Can anyone help with this query please?</code> what have you tried so far?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1461163337, "post_id": 36747042, "comment_id": 61075543, "body": "Did you even Google for anything? There are <a href=\"http://forum.chandoo.org/threads/removing-all-charcters-from-cell-but-numbers.13352/\" rel=\"nofollow noreferrer\">many</a> <a href=\"https://www.extendoffice.com/documents/excel/651-excel-remove-non-numeric-characters.html\" rel=\"nofollow noreferrer\">examples</a>.  What have you tried? What hasn&#39;t worked? I see you want to replace the letter, but keep the placeholder?"}, {"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "edited": false, "score": 0, "creation_date": 1461164922, "post_id": 36747042, "comment_id": 61076863, "body": "At the moment I have code that loops through every used cell in a column to perform an action (change the contents etc....). With this problem I&#39;m having is getting the code to loop through and remove the letters from the cell leaving the numbers."}], "answers": [{"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1461165118, "last_edit_date": 1461165118, "creation_date": 1461163686, "answer_id": 36747490, "question_id": 36747042, "link": "https://stackoverflow.com/questions/36747042/remove-letters-from-a-cell-leaving-numbers-only/36747490#36747490", "title": "Remove letters from a cell leaving numbers only", "body": "<p>You could use a regular expression:</p>\n\n<pre><code>Sub UsageExample()\n  Dim cl\n\n  ' iterate each cell\n  For Each cl in Range(\"Sheet1!A1:A100\")\n    ' replace each non digit sequence by a space\n    cl.Value = ReplaceRe(cl.Value, \"\\D+\", \" \")\n  Next\n\nEnd Sub\n\nPublic Function ReplaceRe(text As String, pattern As String, replacement) As String\n  Static re As Object\n  If re Is Nothing Then\n    Set re = CreateObject(\"VBScript.RegExp\")\n    re.Global = True\n  End If\n  re.pattern = pattern\n  ReplaceRe = re.Replace(text, replacement)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1461163997, "creation_date": 1461163997, "answer_id": 36747622, "question_id": 36747042, "link": "https://stackoverflow.com/questions/36747042/remove-letters-from-a-cell-leaving-numbers-only/36747622#36747622", "title": "Remove letters from a cell leaving numbers only", "body": "<p>Here's a UDF if you want to do something like that. Making \"Spaces\" True or False will allow for you to have a single space where non-numeric characters used to be. </p>\n\n<pre><code>Sub Test()\n    Debug.Print Nums(\"as12df34\", True)\nEnd Sub\n\nFunction Nums(What As String, Spaces As Boolean) As String\n\nDim i As Long\n\nFor i = 1 To Len(What)\n\n    If IsNumeric(Mid(What, i, 1)) = True Then Nums = Nums &amp; Mid(What, i, 1)\n    If IsNumeric(Mid(What, i, 1)) = False Then Nums = Nums &amp; \" \"\n\nNext i\n\nNums = Trim(Nums)\n\nIf Spaces = True Then\n    Do Until InStr(Nums, \"  \") = 0\n        Nums = Replace(Nums, \"  \", \" \")\n    Loop\nElse\n    Do Until InStr(Nums, \" \") = 0\n        Nums = Replace(Nums, \" \", \"\")\n    Loop\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 6318616, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154782396953056/picture?type=large", "display_name": "Donald Clark-Charest", "link": "https://stackoverflow.com/users/6318616/donald-clark-charest"}, "is_accepted": false, "score": 0, "last_activity_date": 1487363910, "creation_date": 1487363910, "answer_id": 42306964, "question_id": 36747042, "link": "https://stackoverflow.com/questions/36747042/remove-letters-from-a-cell-leaving-numbers-only/42306964#42306964", "title": "Remove letters from a cell leaving numbers only", "body": "<p>I know this may have been answered, but I wanted to let others that may come across this question to see another possibility. I came up with an obvious solution to eliminate all the letters to be replaced with nothing to only leave numbers in the cell. You can just replace the \"\" for a \" \" to leave the space that the letters left behind. </p>\n\n<p>It's a huge clutter, but I use it and it works as intended just drag the function to the next cell. No typing required. In my situation, I had a word like \"platinum ingot, 3\" and it will remove all the letters, comma, and spaces and leaves 3 which can be used to calculate stuff with. I use this to hold 2 values in 1 cell when 1 of the value is never going to also contain numbers.</p>\n\n<blockquote>\n  <p>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE( SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE( SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE( SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE( SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE( SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE( F5,\"A\",\"\"),\"B\",\"\"),\"C\",\"\"),\"D\",\"\"),\"E\",\"\"),\"F\",\"\"),\"G\",\"\"),\"H\",\"\"),\"I\",\"\"),\"J\",\"\"),\"K\",\"\"),\"L\",\"\"),\"M\",\"\"),\"N\",\"\"),\"O\",\"\"),\"P\",\"\"),\"Q\",\"\"),\"R\",\"\"),\"S\",\"\"),\"T\",\"\"),\"U\",\"\"),\"V\",\"\"),\"W\",\"\"),\"X\",\"\"),\"Y\",\"\"),\"Z\",\"\"),\"a\",\"\"),\"b\",\"\"),\"c\",\"\"),\"d\",\"\"),\"e\",\"\"),\"f\",\"\"),\"g\",\"\"),\"h\",\"\"),\"i\",\"\"),\"j\",\"\"),\"k\",\"\"),\"l\",\"\"),\"m\",\"\"),\"n\",\"\"),\"o\",\"\"),\"p\",\"\"),\"q\",\"\"),\"r\",\"\"),\"s\",\"\"),\"t\",\"\") ,\"u\",\"\"),\"v\",\"\") ,\"w\",\"\"),\"x\",\"\"),\"y\",\"\"),\"z\",\"\"),\",\",\"\"),\" \",\"\")</p>\n</blockquote>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3301, "favorite_count": 0, "accepted_answer_id": 36747490, "answer_count": 3, "score": -1, "last_activity_date": 1487363910, "creation_date": 1461162646, "question_id": 36747042, "link": "https://stackoverflow.com/questions/36747042/remove-letters-from-a-cell-leaving-numbers-only", "title": "Remove letters from a cell leaving numbers only", "body": "<p>I am trying to remove all letters from a cell and leave the numbers remaining.\nI have found bits of code and other questions on here but none are making much sense to me.</p>\n\n<p>I have in cell E23 \"as12df34\" and want the value of Cell E23 to read \"12 34\"</p>\n\n<p>Can anyone help with this query please?</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1461166052, "post_id": 36746927, "comment_id": 61077729, "body": "I know this isn&#39;t directly related to your question, but just thought I&#39;d mention that you don&#39;t have to reinitialize Screen updating back to true.  At the conclusion of the script excel will automatically turn it back to true.  Also, it&#39;s best to use proper naming conventions so it&#39;s easier to read and troubleshoot your code.  variables like &quot;i&quot;, &quot;j&quot;, &quot;k&quot; etc give very little information about what they&#39;re for, scope, or things of that nature.  Just a few thoughts =]"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1461163817, "post_id": 36747170, "comment_id": 61075925, "body": "Unfortunately I got an error after trying it that way @Dani El:  Run-time error \u201813\u2019: Type mismatch"}, {"owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "reply_to_user": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1461170434, "post_id": 36747170, "comment_id": 61080834, "body": "I can see that you and @Ralph have solved this problem. For making it slightly more resistant to the way you input the dates, consider using <code>Date</code> variables for storing values from cells As for the macro closing after first row, you do have <code>Exit For</code> when match is found. That&#39;s your issue."}], "tags": [], "owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "is_accepted": false, "score": 0, "last_activity_date": 1461162930, "creation_date": 1461162930, "answer_id": 36747170, "question_id": 36746927, "link": "https://stackoverflow.com/questions/36746927/compare-dates-in-vba-with-offset-amount/36747170#36747170", "title": "Compare dates in VBA with offset amount", "body": "<pre><code>If .Cells(i, 10) &gt; laws.Cells(j, 10) + 5  Then\n</code></pre>\n\n<p>I don't know how your data looks like, but try this.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1461165944, "post_id": 36748067, "comment_id": 61077648, "body": "The code worked fine without an error (well after I discovered a seperate issue), but unfortunately it didn&#39;t capture the difference. For example to ensure the code works, I set the laws.Cells date to be 29-Apr-16 and the .cells date to be 5/7/2016. I assume since they are both formatted as dates the formatting doesn&#39;t matter. I was able to do a subtraction calculation which told me the difference was 8 days so this should have been copied over if the calculation worked, but it didn&#39;t. Any guesses?  @Ralph"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1461166942, "post_id": 36748067, "comment_id": 61078403, "body": "I wasn&#39;t aware that you are not storing actual dates in all cells but merely internationally formatted dates which need to be converted into actual dates. I just adjusted the code so that your cell values get converted to real dates. Now it should work as expected."}, {"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1461168611, "post_id": 36748067, "comment_id": 61079690, "body": "I was able to get it to work, but only when I deleted all of my other data except for this example I created. I believe the formula is closing out the loop after the very first line of my data rather than going through every line. It seemed to never get to the example data we set up unless I deleted everything else. Any ideas?  Also, what do you mean I am not storing actual dates? I can reformat my data pretty easily if that will make the code more straight forward. Thanks again. @Ralph"}, {"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1461169480, "post_id": 36748067, "comment_id": 61080250, "body": "What is the easiest way to send you a sample file to show what the current issue is? Thanks."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1461166862, "last_edit_date": 1461166862, "creation_date": 1461165072, "answer_id": 36748067, "question_id": 36746927, "link": "https://stackoverflow.com/questions/36746927/compare-dates-in-vba-with-offset-amount/36748067#36748067", "title": "Compare dates in VBA with offset amount", "body": "<p>Maybe one or more cells contain something other than dates and therefore Excel VBA cannot compare them. Here is a slightly adjusted (portion) of your code which does a bit more error handling:</p>\n\n<pre><code>With Worksheets(\"Data\")\n    For i = 2 To Rows2\n    ' Loop through Sheet 2\n        For j = 2 To RowsMaster\n        ' Loop through the Master sheet\n            If IsDate(.Cells(i, 10).Value) And IsDate(laws.Cells(j, 10).Value) Then\n                If CDate(.Cells(i, 10).Value) &gt; CDate(laws.Cells(j, 10).Value + 5) Then\n                ' If a match is found:\n                    laws.Cells(j, 7).Value2 = .Cells(i, 7).Value2\n                    ' Copy in contact info\n                    Exit For\n                ElseIf j = RowsMaster Then\n                ' If we got to the end of the Master sheet\n                    RowsMaster = RowsMaster + 1\n                    ' Increment the number of rows\n                    For k = 1 To 11 ' Change 3 to however many fields Sheet2 has\n                        laws.Cells(RowsMaster, k).Value2 = .Cells(i, k).Value2\n                        laws.Range(laws.Cells(j + 1, 1), laws.Cells(j + 1, 10)).Interior.ColorIndex = 24\n                        ' Copy the data from Sheet2 in on the bottom row of Master\n                    Next\n                End If\n            Else\n                MsgBox \"Cannot compare \" &amp; .Cells(i, 10).Value &amp; \" to \" &amp; laws.Cells(j, 10).Value &amp; \".\"\n            End If\n        Next j\n    Next i\nEnd With\n</code></pre>\n\n<p>Give it a try and let me know if this works.</p>\n"}], "owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461166862, "creation_date": 1461162375, "question_id": 36746927, "link": "https://stackoverflow.com/questions/36746927/compare-dates-in-vba-with-offset-amount", "title": "Compare dates in VBA with offset amount", "body": "<p>I am trying to use the below script to compare 2 dates but only copy over the  data if the dates are more than 5 days apart. I am pretty sure my greater than equation is giving incorrect results though.</p>\n\n<pre><code>Sub CompareSheets()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n    Dim laws As Worksheet\n    Set laws = Sheets(\"LookAhead\")\n    Dim galreqws As Worksheet\n    Set galreqws = Sheets(\"Data\")\n\n    Dim RowsMaster As Integer, Rows2 As Integer\n    RowsMaster = laws.Cells(1048576, 1).End(xlUp).Row\n    Rows2 = galreqws.Cells(1048576, 1).End(xlUp).Row\n    ' Get the number of used rows for each sheet\n\n\n    With Worksheets(\"Data\")\n        For i = 2 To Rows2\n        ' Loop through Sheet 2\n            For j = 2 To RowsMaster\n            ' Loop through the Master sheet\n                If .Cells(i, 10) &gt; laws.Cells(j + 5, 10) Then\n                ' If a match is found:\n                    laws.Cells(j, 7) = .Cells(i, 7)\n                    ' Copy in contact info\n                    Exit For\n                ElseIf j = RowsMaster Then\n                ' If we got to the end of the Master sheet\n                    RowsMaster = RowsMaster + 1\n                    ' Increment the number of rows\n                    For k = 1 To 11 ' Change 3 to however many fields Sheet2 has\n                        laws.Cells(RowsMaster, k) = .Cells(i, k)\n                        laws.Range(laws.Cells(j + 1, 1), laws.Cells(j + 1, 10)).Interior.ColorIndex = 24\n                        ' Copy the data from Sheet2 in on the bottom row of Master\n                    Next\n                End If\n            Next j\n        Next i\n    End With\n\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "image", "macos", "vba", "insert"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461165509, "post_id": 36746837, "comment_id": 61077301, "body": "I just had a very similar case here: <a href=\"http://stackoverflow.com/questions/36459111/click-shape-or-button-preview-close-that-displays-an-image/36461010#36461010\" title=\"click shape or button preview close that displays an image\">stackoverflow.com/questions/36459111/&hellip;</a> I think this will be very helpful for you. BTW: what is your question? Is your code running or do you get an error and it does not complete? Or maybe the result of what your code does is unexpected? In that case, please elaborate what you want it to do and what it currently does."}, {"owner": {"reputation": 5, "user_id": 6225747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef3f3e0be2b4bd88965107801335f4f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ida", "link": "https://stackoverflow.com/users/6225747/ida"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461338723, "post_id": 36746837, "comment_id": 61169730, "body": "Thanks Ralph, I&#39;ve edited my post so hopefully it is more clear. As you can see my worksheet is not the easiest. But for now, I haven&#39;t managed to add/link any image at all."}], "owner": {"reputation": 5, "user_id": 6225747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef3f3e0be2b4bd88965107801335f4f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ida", "link": "https://stackoverflow.com/users/6225747/ida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1535, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470856071, "creation_date": 1461162195, "last_edit_date": 1470856071, "question_id": 36746837, "link": "https://stackoverflow.com/questions/36746837/vba-insert-jpg-to-specific-cells-by-matching-cell-value-with-image-name", "title": "vba Insert jpg to specific cells by matching cell value with image name", "body": "<p>I've looked around on a few different ways to insert .jpg by a macro and there seem to be few, but some different ways. I tried to follow <a href=\"http://ccm.net/faq/6485-excel-a-macro-to-insert-pictures\" rel=\"nofollow\">this</a> helpful guide, but are unsuccessful. </p>\n\n<p>MY macro doesn't find the image location. I want the macro to look for images saved in a folder named \"Pictures\" in the same location the current workbook, compare it to references in column A and insert in column B if match.</p>\n\n<p>I get this error message: \"Unable to get the insert property of the Pictures class.\" Does mean my link is wrong?</p>\n\n<p>As you can see (<a href=\"http://i.stack.imgur.com/yY5VJ.png\" rel=\"nofollow\">Worksheet</a>) my references are in Column A, starting at A7, but I have merged cells(A7:A16), so the next reference is in A18, A29.. etc. \nex.</p>\n\n<p>Any help appreciated. Thanks.</p>\n\n<pre><code>Sub ImageMacro()\n\n'Used to import picture files from a pre-sorted file. (Each picture must have a unique name, duplicates removed).\n\n'Sub Picture()\n Dim picname As String\n Dim pasteAt As Integer\n Dim lThisRow As Integer\n\n    lThisRow = 7\n\n    Do While (Cells(lThisRow, 1) &lt;&gt; \"\")\n\n        'Range(\"B7\").Select 'This is where picture will be inserted\n        pasteAt = Cells(lThisRow, 2)\n      '  Cells(pasteAt, 2).Select 'This is where picture will be inserted (IS THIS A DUPLICATE OF ABOVE?)\n\n        'Dim picname As String\n        'picname = Range(\"A7\") 'This is the picture name\n         picname = Cells(lThisRow, 1) 'This is the picture name\n\n        ActiveSheet.Pictures.Insert(\"smb://pnld-svr-02._smb._tcp.local/Business Administration/Staff Folders/Ida Moe Evensen/0000 Templates/Pictures/\" &amp; picname &amp; \".jpg\").Select 'Path to where pictures are stored\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' This resizes the picture\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        With Selection\n            '.Left = Range(\"A6\").Left\n            '.Top = Range(\"A6\").Top\n            .Left = Cells(pasteAt, 1).Left\n            .Top = Cells(pasteAt, 1).Top\n\n            .ShapeRange.LockAspectRatio = msoFalse\n            .ShapeRange.Height = 100#\n            .ShapeRange.Width = 80#\n            .ShapeRange.Rotation = 0#\n        End With\n\n        lThisRow = lThisRow + 11\n\n    Loop\n\n    Application.ScreenUpdating = True\n\n    Exit Sub\n\nErrNoPhoto:\n    MsgBox \"Unable to Find Photo\" 'Shows message box if picture not found\n    Exit Sub\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "edited": false, "score": 0, "creation_date": 1461161897, "post_id": 36746585, "comment_id": 61074381, "body": "It works!...Thanks!  but what is value2 syntax where I can get help or more explanation on this."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "edited": false, "score": 0, "creation_date": 1461162246, "post_id": 36746585, "comment_id": 61074673, "body": "If you have questions in Excel VBA about something just highlight the word you are looking help on (in this case, highlight <code>Value2</code>) and then press <code>F1</code>."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "edited": false, "score": 0, "creation_date": 1461162429, "post_id": 36746585, "comment_id": 61074809, "body": "<code>.Value</code> will probably also work. <code>.Value2</code> is just faster than <code>.Value</code>. Therefore I prefer it and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553%28v=office.15%29.aspx\" rel=\"nofollow noreferrer\">if you are not dealing with dates or currencies</a> then there is no difference."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1461161650, "creation_date": 1461161650, "answer_id": 36746585, "question_id": 36746005, "link": "https://stackoverflow.com/questions/36746005/value-not-stored-in-dynamic-array/36746585#36746585", "title": "Value not stored in Dynamic Array", "body": "<p>Try this:</p>\n\n<pre><code>vArray = Worksheets(\"ListofSheets\").Range(\"A1:D39\").Value2\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461161650, "creation_date": 1461160313, "last_edit_date": 1531161705, "question_id": 36746005, "link": "https://stackoverflow.com/questions/36746005/value-not-stored-in-dynamic-array", "title": "Value not stored in Dynamic Array", "body": "<p>Earlier it works fine but now the data is not store in array and the same is store in rng1\nI can check in dubug windows by <strong><em>?rng1(1,1) or ?rng1(39,4)</em></strong> but vArray is giving error subscript out range.</p>\n\n<pre><code>Dim vArray() As Variant\nDim rng1 As Range\nDim ShNm As String\nDim lROW AS LONG \n\nShNm = Sheets(\"Main\").Range(\"G3\")\n\nlRow = Worksheets(ShNm).Cells(Rows.Count, 1).End(xlUp).Row \n\nSet rng1 = Worksheets(ShNm).Range(\"A1:D\" &amp; lRow)\n\nvArray = Worksheets(ShNm).Range(\"A1:D\" &amp; lRow)\nor        \nvArray = Worksheets(Sheets(\"Main\").Range(\"G3\")).Range(\"A1:D39\")\nor\nvArray = Worksheets(\"ListofSheets\").Range(\"A1:D39\")\n</code></pre>\n"}, {"tags": ["sql", "vba", "ado"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1461159775, "post_id": 36745705, "comment_id": 61072491, "body": "if you want to list them below each other, use UNION instead of ;"}, {"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1461160243, "post_id": 36745705, "comment_id": 61072886, "body": "UNION ALL is even better."}], "answers": [{"comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 1, "creation_date": 1461160264, "post_id": 36745941, "comment_id": 61072901, "body": "Do UNION ALL instead, in case of same numbers."}, {"owner": {"reputation": 1105, "user_id": 4412610, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/de9ba9338d342841ada0d83532f52bd1?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime", "link": "https://stackoverflow.com/users/4412610/maxime"}, "edited": false, "score": 0, "creation_date": 1461161744, "post_id": 36745941, "comment_id": 61074247, "body": "Thank you both. the UNION ALL was indeed very much needed."}], "tags": [], "owner": {"reputation": 251, "user_id": 6218950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kYHcO.png?s=128&g=1", "display_name": "oratom", "link": "https://stackoverflow.com/users/6218950/oratom"}, "is_accepted": true, "score": 1, "last_activity_date": 1461160195, "creation_date": 1461160195, "answer_id": 36745941, "question_id": 36745705, "link": "https://stackoverflow.com/questions/36745705/using-ado-to-query-multiple-counts-in-sql/36745941#36745941", "title": "Using ADO to query multiple counts in SQL", "body": "<p>Do</p>\n\n<pre><code>SELECT COUNT(*) cnt FROM table1\nUNION \nSELECT COUNT(*) cnt FROM table2\n</code></pre>\n\n<p>and you\u00b4ll execute one statement and retrieve 2 rows with 1 column.</p>\n"}, {"tags": [], "owner": {"reputation": 6263, "user_id": 443685, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/763f2fd4e97190d25310e3027bbf2cef?s=128&d=identicon&r=PG", "display_name": "Luis Siquot", "link": "https://stackoverflow.com/users/443685/luis-siquot"}, "is_accepted": false, "score": 1, "last_activity_date": 1461160690, "last_edit_date": 1461160690, "creation_date": 1461160370, "answer_id": 36746030, "question_id": 36745705, "link": "https://stackoverflow.com/questions/36745705/using-ado-to-query-multiple-counts-in-sql/36746030#36746030", "title": "Using ADO to query multiple counts in SQL", "body": "<p>This will generate just one record (as you want) with the count from both tables</p>\n\n<pre><code>select (select count(*) from TABLE1) as cntTbl1, (select count(*) from TABLE2) as cntTbl2 \n</code></pre>\n\n<p>Union all solution will generate one record on each table, and will need a reference to the table</p>\n\n<pre><code>select count(*) as cnt, 'table1' as reference from table1\nunion all\nselect count(*),'table2' from table2\n</code></pre>\n"}], "owner": {"reputation": 1105, "user_id": 4412610, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/de9ba9338d342841ada0d83532f52bd1?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime", "link": "https://stackoverflow.com/users/4412610/maxime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 36745941, "answer_count": 2, "score": 0, "last_activity_date": 1461160690, "creation_date": 1461159667, "question_id": 36745705, "link": "https://stackoverflow.com/questions/36745705/using-ado-to-query-multiple-counts-in-sql", "title": "Using ADO to query multiple counts in SQL", "body": "<p>I am trying, through ADO to count the number of items in some tables.\nThe query is the following:</p>\n\n<pre><code>select count(*) as a from TABLE1;\nselect count(*) as b from TABLE2;\n</code></pre>\n\n<p>If I run it through my SQL GUI, I get:</p>\n\n<pre><code>a\n------------\n1\nb\n------------\n0\n</code></pre>\n\n<p>so far so good.</p>\n\n<p>But, if I run this code (VBA):</p>\n\n<pre><code>Dim adoCon As New ADODB.Connection\nDim adoRecords As ADODB.Recordset\nDim query As String\nquery =\"select count(*) as a from TABLE1;select count(*) as b from TABLE2;\"\nadoRecords = adoCon.Execute(query)\nDebug.Print(adoRecords!a)\nDebug.Print(adoRecords!b)\n</code></pre>\n\n<p>It fails on <code>adoRecords!b</code> If I check the adoRecords object, the Fields field only has one item, a.</p>\n\n<p>If I run it in two separate queries, it works fine (but I have a important round trip time, so that's bothering...).</p>\n\n<p>How could I get two outputs through ADO?</p>\n\n<p>Thanks a lot for your help,</p>\n\n<p>Maxime</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1461162351, "post_id": 36745687, "comment_id": 61074736, "body": "You can record the macro doing changes that you want and get the right code generated in the module."}, {"owner": {"reputation": 1767, "user_id": 1109164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a4e5a61b5eead817f51ab3cb9de8eb9?s=128&d=identicon&r=PG&f=1", "display_name": "Alan K", "link": "https://stackoverflow.com/users/1109164/alan-k"}, "edited": false, "score": 0, "creation_date": 1537242118, "post_id": 36745687, "comment_id": 91701562, "body": "I know that this comment is way late, but in this specific case, the comment by newguy is incorrect. The macro recorder will record the code using the constants shown in the question like xlEdgeRight. However these are the wrong constants, and will not work. The correct constants are the ones shown in the answer like xlRight."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 1, "creation_date": 1462344118, "post_id": 36747038, "comment_id": 61591511, "body": "Works perfectly. Thanks"}], "tags": [], "owner": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "is_accepted": true, "score": 2, "last_activity_date": 1461162642, "creation_date": 1461162642, "answer_id": 36747038, "question_id": 36745687, "link": "https://stackoverflow.com/questions/36745687/cant-set-borders-correctly-in-styles-in-vba/36747038#36747038", "title": "Can&#39;t set borders correctly in styles in VBA", "body": "<p>Try using <code>xlRight</code> etc rather than <code>xlEdgeRight</code> etc. This seems to work, though I don't fully understand why.</p>\n\n<pre><code>With ActiveWorkbook.Styles.Add(\"Table top row\")\n    .Font.Name = \"Tahoma\"\n    .Font.Size = 8\n    .Font.Bold = True\n    .Font.Italic = False\n    .Font.Color = vbBlack\n    .Borders.Color = RGB(120, 159, 218)\n    .Borders.Weight = xlThin\n    .Borders(xlBottom).LineStyle = xlContinuous\n    .Borders(xlTop).LineStyle = xlNone\n    .Borders(xlLeft).LineStyle = xlNone\n    .Borders(xlRight).LineStyle = xlNone\n    .Borders(xlDiagonalUp).LineStyle = xlNone\n    .Borders(xlDiagonalDown).LineStyle = xlNone\n    .HorizontalAlignment = xlLeft\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 36747038, "answer_count": 1, "score": 2, "last_activity_date": 1461162642, "creation_date": 1461159625, "question_id": 36745687, "link": "https://stackoverflow.com/questions/36745687/cant-set-borders-correctly-in-styles-in-vba", "title": "Can&#39;t set borders correctly in styles in VBA", "body": "<p>I have a bunch of code which adds 8 custom styles to Excel and removes all others.\nMost of the code works except for 1 bit. This concerns a style which has a colored border only on the bottom edge, the other edges have no border.</p>\n\n<pre><code>With ActiveWorkbook.Styles.Add(\"Table top row\")\n   .Font.Name = \"Tahoma\"\n   .Font.Size = 8\n   .Font.Bold = True\n   .Font.Italic = False\n   .Font.Color = vbBlack\n   .Borders(xlEdgeBottom).Color = RGB(120, 159, 218)\n   .Borders(xlEdgeBottom).Weight = xlThin\n   .Borders(xlEdgeBottom).LineStyle = xlContinuous\n   .HorizontalAlignment = xlLeft\nEnd With\n</code></pre>\n\n<p>This piece of code results in the right font but no border at all.\nI then tried it another way:</p>\n\n<pre><code>With ActiveWorkbook.Styles.Add(\"Table top row\")\n    .Font.Name = \"Tahoma\"\n    .Font.Size = 8\n    .Font.Bold = True\n    .Font.Italic = False\n    .Font.Color = vbBlack\n    .Borders.Color = RGB(120, 159, 218)\n    .Borders.Weight = xlThin\n    .Borders(xlEdgeBottom).LineStyle = xlContinuous\n    .Borders(xlEdgeTop).LineStyle = xlNone\n    .Borders(xlEdgeLeft).LineStyle = xlNone\n    .Borders(xlEdgeRight).LineStyle = xlNone\n    .Borders(xlDiagonalUp).LineStyle = xlNone\n    .Borders(xlDiagonalDown).LineStyle = xlNone\n    .HorizontalAlignment = xlLeft\nEnd With\n</code></pre>\n\n<p>This results in a border everywhere except the left edge. I'm absolutely puzzled to why I can't get this to work. Some solutions I've found include transforming a range instead of a style, but i need the style to quickly use in different files.</p>\n"}, {"tags": ["vba", "excel", "multiple-columns", "copy-paste", "vlookup"], "comments": [{"owner": {"reputation": 798, "user_id": 4005915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/631230112/picture?type=large", "display_name": "Nathan Clement", "link": "https://stackoverflow.com/users/4005915/nathan-clement"}, "edited": false, "score": 0, "creation_date": 1461161554, "post_id": 36745634, "comment_id": 61074057, "body": "<a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1461166532, "post_id": 36745634, "comment_id": 61078084, "body": "Maybe a fuzzy match:  <a href=\"http://www.mrexcel.com/forum/hall-fame-winners/69649-alans-udfs-fuzzy-match-problem.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/hall-fame-winners/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 783, "user_id": 3783326, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zBekJ.jpg?s=128&g=1", "display_name": "Alex Chance", "link": "https://stackoverflow.com/users/3783326/alex-chance"}, "is_accepted": false, "score": 1, "last_activity_date": 1461162017, "creation_date": 1461162017, "answer_id": 36746759, "question_id": 36745634, "link": "https://stackoverflow.com/questions/36745634/excel-wizards-using-vlookup-to-find-and-copy-cells-best-fit-search-issues/36746759#36746759", "title": "Excel Wizards - using VLOOKUP to find and copy cells, &quot;best fit&quot; search issues", "body": "<p>I have found it easier to use INDEX(MATCH()) to accomplish this, rather than V-LOOKUP. </p>\n\n<p>For a simple example, I have 2 sheets in my workbook with only 2 columns each. </p>\n\n<p>Sheet: testData</p>\n\n<p><a href=\"https://i.stack.imgur.com/XlOfh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XlOfh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet: testData2</p>\n\n<p><a href=\"https://i.stack.imgur.com/stweu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/stweu.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to check if the [Name] exists in Sheet testData2, and if it does, return the value of [TestValue] and insert into [Column1] on Sheet testData1. It sounds like that is what you want.</p>\n\n<p>Here is what the formula would look like with INDEX(MATCH())</p>\n\n<pre><code>=INDEX(testData2!B:B,MATCH([@Name],testData2!A:A,0))\n</code></pre>\n\n<p>INDEX returns a value from an array based on row and column numbers provided, this gives us the values we want from [TestValue]</p>\n\n<p>MATCH searches for the value and returns the relative position, allowing us to match the correct row from [TestValue].</p>\n\n<p>If you need further explanation, please have a read <a href=\"https://www.ablebits.com/office-addins-blog/2014/08/13/excel-index-match-function-vlookup/\" rel=\"nofollow noreferrer\">here</a>. They do a better job explaining the use of INDEX(MATCH()) and the advantages it has over V-LOOKUP. </p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1461166274, "last_edit_date": 1461166274, "creation_date": 1461164180, "answer_id": 36747696, "question_id": 36745634, "link": "https://stackoverflow.com/questions/36745634/excel-wizards-using-vlookup-to-find-and-copy-cells-best-fit-search-issues/36747696#36747696", "title": "Excel Wizards - using VLOOKUP to find and copy cells, &quot;best fit&quot; search issues", "body": "<p>As a \"VBA\" solution, place the following code in any module code pane of the workbook both \"Sheet1\" and \" Sheet2\"  sheets belong to:</p>\n\n<pre><code>Sub FillColumn2()\n\nDim rngToSearchIn as Range, rngToSearchFrom as Range, found as Range, cell as Range \n\nSet rngToSearchFrom = GetColumnUsedRange(Sheets(\"Sheet1\"), \"A\")\nSet rngToSearchIn  = GetColumnUsedRange(Sheets(\"Sheet2\"), \"X\")\n\nFor Each cell In rngToSearchFrom \n   Set found = rngToSearchIn.Find (What:=cell.Value, LookAt:=xlWhole, LookIn:=xlValues, MatchCase=True)    \n   If Not found is Nothing then cell.Offset (,1) = found.Offset (,1)\nNext cell\n\nEnd Sub \n\n\nPrivate Function GetColumnUsedRange (sht as Worksheet, col as string)\n\nWith sht    \n  Set GetColumnUsedRange = .Range(.Cells (1,col), .Cells(Rows.Count,col).End (xlUp))    \nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Now you can call it from Excel by either placing a button on the sheet you want to \"update\" and attach it to the \"FillColumn2\" Sub or clicking the \"Macro\" button and selecting the \"FillColumn2\" sub from the dropdown menu that appears</p>\n"}], "owner": {"reputation": 3, "user_id": 6203389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a2ca7bbe21ab31bf3860a15d6807f7?s=128&d=identicon&r=PG&f=1", "display_name": "extratonic", "link": "https://stackoverflow.com/users/6203389/extratonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461166274, "creation_date": 1461159474, "last_edit_date": 1461165455, "question_id": 36745634, "link": "https://stackoverflow.com/questions/36745634/excel-wizards-using-vlookup-to-find-and-copy-cells-best-fit-search-issues", "title": "Excel Wizards - using VLOOKUP to find and copy cells, &quot;best fit&quot; search issues", "body": "<p>I am using this formula as my base:</p>\n\n<p>=VLOOKUP(B1, E$1:F$13728, 2, FALSE)</p>\n\n<p>Then I'm copying the formula down, so I get B2, B3 etc.</p>\n\n<p>I have a problem in that the names in my B column are not exact matches to those in my searched range. However, they contain much of the same things, \"limited\", \"ltd\", \"financial\" etc. This means that swapping FALSE for TRUE means I end up pulling all kinds of random data.</p>\n\n<p>What would be the best way to pull the data relevant to the 'best fit' from the range?</p>\n\n<p>Your help would be most appreciated, and I'm sure would allow for ease of use of such formula for many such excel failures as myself.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1461162598, "post_id": 36745522, "comment_id": 61074950, "body": "What exactly are you trying to do here ? iCol = wsE And irow ? You set the colum to &quot;worksheet and number&quot; ?"}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1461162789, "post_id": 36745522, "comment_id": 61075112, "body": "@DoktorOSwaldo this was my way of trying to use Worksheet &quot;Elkhart East&quot; and add it to the last row available."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1461166034, "post_id": 36747890, "comment_id": 61077718, "body": "This is giving me a object doesn&#39;t support this object or method and it highlights the case"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1461229769, "post_id": 36747890, "comment_id": 61107923, "body": "this is your case ^^ maybe you should remove the ** and complete the case (thats what ... means)"}], "tags": [], "owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "is_accepted": false, "score": 0, "last_activity_date": 1461164657, "creation_date": 1461164657, "answer_id": 36747890, "question_id": 36745522, "link": "https://stackoverflow.com/questions/36745522/incorporate-combobox-from-a-userform-to-multiple-sheets-based-on-values-provided/36747890#36747890", "title": "Incorporate combobox from a userform to multiple sheets based on values provided", "body": "<p>Ok maybe i don't get your code, but i think you want something like this:</p>\n\n<pre><code>**Select Case warehousecombobox.value\nCase \"Elkhart East\"\n    wSheet = wsE \n...\n\nwSheet.Range(iCol &amp; iRow).value =  CLng(Me.AddTextBox.value)\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462455798, "creation_date": 1461159222, "last_edit_date": 1462455798, "question_id": 36745522, "link": "https://stackoverflow.com/questions/36745522/incorporate-combobox-from-a-userform-to-multiple-sheets-based-on-values-provided", "title": "Incorporate combobox from a userform to multiple sheets based on values provided", "body": "<p>I'm a bit stuck with this part.</p>\n\n<p>I have created a userform with different sections. First section will ask for Part# the userform will search in column A if the part exists if it doesn't it will add it to the last row available. Second section is a combobox selecting a month to add a value to (Columns C,N,O,P,Q). Next section is the value amount given to the part based on which month is selected. And the next section is where I'm stuck in the warehouse section I want to select a warehouse this references the tabs I created \"Elkhart\", \"Tennessee\" etc. I want to be able to add the part in the active sheet which is the \"main\" and also based on warehouse combobox option to add it to the last row of the tab. </p>\n\n<blockquote>\n  <p>Ex. Part:Bob</p>\n  \n  <p>Month:Current</p>\n  \n  <p>Add:200</p>\n  \n  <p>Warehouse:Elkhart East</p>\n</blockquote>\n\n<p><em>This will add <strong>Bob</strong> to \"<strong>Main</strong>\" tab in the lastrow, however will add it to \"<strong>Elkhart East</strong>\" tab in the last row</em> too.</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nDim irow As Long\nDim lastRow As Long\nDim iCol As String\nDim C As Range\nDim ws As Worksheet\nDim value As Long\nDim NewPart As Boolean\nSet ws = Worksheets(\"Main\")\nSet wsE = Worksheets(\"Elkhart East\")\nSet wsT = Worksheets(\"Tennessee\")\nSet wsA = Worksheets(\"Alabama\")\nSet wsN = Worksheets(\"North Carolina\")\nSet wsP = Worksheets(\"Pennsylvania\")\nSet wsT = Worksheets(\"Texas\")\nSet wsW = Worksheets(\"West Coast\")\n\nSet C = ws.Range(\"A7:A1048576\").Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole)\nIf C Is Nothing Then\n'find first empty row in database\n    lastRow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n    irow = lastRow + 1\n    NewPart = True\nElse\n'find row where the part is\n    irow = ws.Cells.Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    NewPart = False\nEnd If\n'check for a part number\nIf Trim(Me.PartTextBox.value) = \"\" Then\n  Me.PartTextBox.SetFocus\n  MsgBox \"Please Enter A Part Number\"\n  Exit Sub\nEnd If\n\nIf Trim(Me.MonthComboBox.value) = \"\" Then\n  Me.MonthComboBox.SetFocus\n  MsgBox \"Please Enter A Month\"\n  Exit Sub\nEnd If\n\nIf Trim(Me.AddTextBox.value) = \"\" Then\n  Me.AddTextBox.SetFocus\n  MsgBox \"Please Enter A Value To Add Or Substract\"\n  Exit Sub\nEnd If\n\n\n\nSelect Case MonthComboBox.value\n\n    Case \"Current Month\"\n\n        iCol = \"C\"\n\n    Case \"Current Month +1\"\n\n        iCol = \"N\"\n\n    Case \"Current Month +2\"\n\n        iCol = \"O\"\n\n    Case \"Current Month +3\"\n\n        iCol = \"P\"\n\n    Case \"Current Month +4\"\n\n        iCol = \"Q\"\n\nEnd Select\n\n**Select Case warehousecombobox.value\n    Case \"Elkhart East\"\n        iCol = wsE And irow\n    Case \"Tennessee\"\n        iCol = wsT And irow\n    Case \"Alabama\"\n        iCol = wsA And irow\n    Case \"North Carolina\"\n        iCol = wsN And irow\n    Case \"Pennsylvania\"\n        iCol = wsP And irow\n    Case \"Texas\"\n        iCol = wsT And irow\n    Case \"West Coast\"\n        iCol = wsW And irow\n    End Select\nvalue = Cells(irow, iCol).value**\nWith ws\n\n\n  .Cells(irow, iCol).value = value + CLng(Me.AddTextBox.value)\n\n\nEnd With\n\nIf NewPart = True Then\n    ws.Cells(irow, \"A\").value = Me.PartTextBox.value\nEnd If\n\n\nIf NewPart = True Then\n ws.Cells(irow, \"C\").value = Me.AddTextBox.value\nEnd If\n\n\n\n'clear the data\nMe.PartTextBox.value = \"\"\nMe.MonthComboBox.value = \"\"\nMe.AddTextBox.value = \"\"\nMe.PartTextBox.SetFocus\nMe.warehousecombobox.value = \"\"\n\nEnd Sub\n\nPrivate Sub cmdClose_Click()\nUnload Me\nEnd Sub\n\n\nPrivate Sub MonthComboBox_Change()\n\nEnd Sub\nPrivate Sub Warehousecombobox_Change()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n'Empty NameTextBox\n PartTextBox.value = \"\"\n\n'Empty PhoneTextBox\n AddTextBox.value = \"\"\n\n'Empty DinnerComboBox\n\n'Fill DinnerComboBox\nWith MonthComboBox\n     .AddItem \"Current Month\"\n     .AddItem \"Current Month +1\"\n     .AddItem \"Current Month +2\"\n     .AddItem \"Current Month +3\"\n     .AddItem \"Current Month +4\"\n\nEnd With\n\nWith warehousecombobox\n    .AddItem \"Elkhart East\"\n    .AddItem \"Tennessee\"\n    .AddItem \"Alabama\"\n    .AddItem \"North Carolina\"\n    .AddItem \"Pennsylvania\"\n    .AddItem \"Texas\"\n    .AddItem \"West Coast\"\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "textbox", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 0, "last_activity_date": 1461164818, "creation_date": 1461164818, "answer_id": 36747963, "question_id": 36745507, "link": "https://stackoverflow.com/questions/36745507/delete-string-from-textbox-shapes-etc-that-may-be-grouped/36747963#36747963", "title": "Delete string from textbox,shapes etc that may be grouped", "body": "<p>Got the solution from <a href=\"http://www.mrexcel.com/forum/excel-questions/472302-grouped-shapes-visual-basic-applications.html\" rel=\"nofollow\">here</a> by MrExcel MVP.</p>\n\n<p>This loops through each sub items in the group which I wanted essentially.</p>\n\n<pre><code>        For Each Sld In PP.Slides\n            For Each Shp In Sld.Shapes\n                With Shp\n                    .TextFrame.TextRange.Text = Replace(.TextFrame.TextRange.Text, \"(\" &amp; strf &amp; \")\", \"\")\n                    .TextFrame.TextRange.Text = Replace(.TextFrame.TextRange.Text, strf, \"\")\n                     Debug.Print Sld.Name, .Name, .TextFrame.TextRange.Text\n                End With\n\n                For Each Shp1 In Shp.GroupItems\n                With Shp1\n                    .TextFrame.TextRange.Text = Replace(.TextFrame.TextRange.Text, \"(\" &amp; strf &amp; \")\", \"\")\n                    .TextFrame.TextRange.Text = Replace(.TextFrame.TextRange.Text, strf, \"\")\n                    Debug.Print Sld.Name, .Name, .TextFrame.TextRange.Text\n                End With\n                Next\n\n            Next Shp\n\n        Next Sld\n</code></pre>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 36747963, "answer_count": 1, "score": 0, "last_activity_date": 1461164818, "creation_date": 1461159184, "last_edit_date": 1461159218, "question_id": 36745507, "link": "https://stackoverflow.com/questions/36745507/delete-string-from-textbox-shapes-etc-that-may-be-grouped", "title": "Delete string from textbox,shapes etc that may be grouped", "body": "<p>This will remove the texts from shapes or textboxes but not from grouped textboxes or shapes.</p>\n\n<p>How can I modify the code below to suit my need ?</p>\n\n<p>What I want is simple remove the string <code>strf</code> and <code>\"(\" &amp; strf &amp; \")\"</code> present any where in the ppt. But this seems to ignore the grouped objects.</p>\n\n<pre><code>       For Each Sld In PP.Slides\n            For Each Shp In Sld.Shapes\n                With Shp\n                    .TextFrame.TextRange.Text = Replace(.TextFrame.TextRange.Text, \"(\" &amp; strf &amp; \")\", \"\")\n                    .TextFrame.TextRange.Text = Replace(.TextFrame.TextRange.Text, strf, \"\")\n                     Debug.Print Sld.Name, .Name, .TextFrame.TextRange.Text\n                End With\n            Next Shp\n        Next Sld\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1461160702, "last_edit_date": 1461160702, "creation_date": 1461159223, "answer_id": 36745524, "question_id": 36744933, "link": "https://stackoverflow.com/questions/36744933/run-time-error-7961-when-referring-to-modulesname-for-form-modules/36745524#36745524", "title": "Run-time error 7961 when referring to Modules(name) for Form modules", "body": "<blockquote>\n  <p>The Modules() collection contains all open modules, including the\n  modules that sit behind forms.</p>\n</blockquote>\n\n<p>So assuming your <em>F_Inserts</em> form is open, you can reference its <code>Module</code> property and get <code>CountOfLines</code> from there.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Debug.Print Modules(\"Form_F_Inserts\").Name     ' fail\n'Debug.Print Modules(\"F_Inserts\").Name          ' fail\nDebug.Print Forms!F_Inserts.Module.Name         '&lt;-- this should return \"Form_F_Inserts\"\nDebug.Print Forms!F_Inserts.Module.CountOfLines '&lt;-- this should work, too\n</code></pre>\n\n<p>However if you want to retrieve <code>CountOfLines</code> for the module of a from which is not open, use the VBE object model with the form's module name (<em>Form_F_Inserts</em>)...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Application.VBE.ActiveVBProject\n    Debug.Print .VBComponents(\"Form_F_Inserts\").CodeModule.CountOfLines\nEnd With\n</code></pre>\n\n<p>If you want <code>CountOfLines</code> for each form module, perhaps this is sufficient ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim objComponent As Object ' VBComponent\nDim strName As String\n\nFor Each objComponent In Application.VBE.ActiveVBProject.VBComponents\n    strName = objComponent.Name\n    If strName Like \"Form_*\" Then\n        Debug.Print strName, objComponent.CodeModule.CountOfLines\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 340, "user_id": 2474008, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/810145437/picture?type=large", "display_name": "Vexen Crabtree", "link": "https://stackoverflow.com/users/2474008/vexen-crabtree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 36745524, "answer_count": 1, "score": 1, "last_activity_date": 1461160702, "creation_date": 1461157894, "last_edit_date": 1461159482, "question_id": 36744933, "link": "https://stackoverflow.com/questions/36744933/run-time-error-7961-when-referring-to-modulesname-for-form-modules", "title": "Run-time error 7961 when referring to Modules(name) for Form modules", "body": "<p>The Modules() collection contains all open modules, including the modules that sit behind forms. But I don't know how to <em>refer</em> to the modules that sit behind forms. In the code below (from the Immediate pane), the naming convention is that objects starting with \"M_\" are a standalone module, and objects starting with \"F_\" are forms.</p>\n\n<p>From the Immediate pane:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Proving that the method works for standalone modules:\ndebug.print Modules(\"M_Test\").Name\nM_Test\n\n' Proving I am spelling the name of the form correctly:\ndebug.Print currentproject.AllForms(\"F_Inserts\").Name\nF_Inserts\n\n' Proving the form is open (so it appears in Modules() collection)\ndebug.Print currentproject.AllForms(\"F_Inserts\").IsLoaded\nTrue\n</code></pre>\n\n<p>Good. Try to access the module behind the form - don't forget, all forms' modules are prepended by \"Form_\" in their name:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>debug.Print Modules(\"Form_F_Inserts\").Name\ndebug.Print Modules(\"F_Inserts\").Name\n</code></pre>\n\n<p>Results in Run-time error 7961 both times - \"can't find the module 'Form_F_Inserts' referred to in a macro expression or Visual Basic code\".\nAnd pretty much as always nowadays, the \"Help\" button is broken and takes me to a \"Unable to Service Request\" error page (<a href=\"https://msdn.microsoft.com/Areas/Epx/Content/500.aspx?aspxerrorpath=/query/dev11.query\" rel=\"nofollow\">https://msdn.microsoft.com/Areas/Epx/Content/500.aspx?aspxerrorpath=/query/dev11.query</a>).</p>\n\n<p>The purpose of the routine is to get <code>.CountOfLines</code> for each form module. Here's the whole thing:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim lOut As String, lVariant As Variant, lInt As Integer, lBool As Boolean\nlInt=0\nFor Each lVariant In CurrentProject.AllForms\n    lBool = lVariant.IsLoaded   'If not loaded, we open it &amp; close it after\n    If Not lBool Then DoCmd.OpenForm lVariant.Name, acDesign, WindowMode:=acHidden\n    If Forms(lVariant.Name).HasModule Then lInt = lInt + Modules(\"Form_\" &amp; lVariant.Name).CountOfLines\n    If Not lBool Then DoCmd.Close acForm, lVariant.Name, acSaveNo\nNext\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461157176, "post_id": 36744439, "comment_id": 61070259, "body": "That would create a circular reference. Why do you want a formula in there?"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461157406, "post_id": 36744439, "comment_id": 61070459, "body": "I want to append the same string to the TAIL of each cell in Column AC.  I don&#39;t know the number of rows in advance.   Cutting &amp; pasting the formula seemed a direct approach"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461158312, "post_id": 36744439, "comment_id": 61071239, "body": "Do the cells contain formulas or values currently?"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461158455, "post_id": 36744439, "comment_id": 61071354, "body": "The original Cells in column AC contain simple text, no formulas."}], "answers": [{"tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": -1, "last_activity_date": 1461158426, "creation_date": 1461158426, "answer_id": 36745163, "question_id": 36744439, "link": "https://stackoverflow.com/questions/36744439/excel-vba-formula-pad-a-cell/36745163#36745163", "title": "EXCEL VBA Formula - Pad a cell", "body": "<p>I think instead of this:</p>\n\n<pre><code>Range(\"AC2:AC2\").Formula = \"=AC2.value &amp; value(strTest)\"\n</code></pre>\n\n<p>You want this:</p>\n\n<pre><code>Range(\"AC2:AC2\").Formula = \"=AC2.value &amp; value(\" &amp; strTest &amp; \")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1461160962, "post_id": 36745345, "comment_id": 61073521, "body": "I hate those pesky triple quotes! :)"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1461158822, "creation_date": 1461158822, "answer_id": 36745345, "question_id": 36744439, "link": "https://stackoverflow.com/questions/36744439/excel-vba-formula-pad-a-cell/36745345#36745345", "title": "EXCEL VBA Formula - Pad a cell", "body": "<p>To append <code>strTest</code> to the cell values, you can use:</p>\n\n<pre><code>With Range(\"X2:X\" &amp; lastRow)\n    .Value2 = .Worksheet.Evaluate(\"Index(\" &amp; .Address &amp; \"&amp;\"\"\" &amp; strTest &amp; \"\"\",)\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 36745345, "answer_count": 2, "score": 0, "last_activity_date": 1461158822, "creation_date": 1461156802, "last_edit_date": 1531164843, "question_id": 36744439, "link": "https://stackoverflow.com/questions/36744439/excel-vba-formula-pad-a-cell", "title": "EXCEL VBA Formula - Pad a cell", "body": "<p>I am attempting to pad an XLS cell via VBA &amp; XLS Formula but I am stumbling:</p>\n\n<p>Example:  I want to append \" - Test\" to the contents of Cell AC2 via a formula, then paste that formula to all the remaining rows in Col AC:</p>\n\n<pre><code>lastRow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\nstrTest = \" - Test\"\n\n'append\n\nRange(\"AC2:AC2\").Formula = \"=AC2.value &amp; value(strTest)\"\n\n'then cut and paste\n\nRange(\"AC2\").Select\nSelection.Copy\nRange(\"AC2:A\" &amp; lastRow).Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>I am guessing I need to adjust the syntax of the formula to append.  I've tried several variants without success.</p>\n\n<p>Any suggestions?</p>\n\n<p>Note:  the following formula works, but only in the first row.  Copy &amp; Paste simply copies the VALUE from X2 into subsequent rows, not the formula:</p>\n\n<pre><code> Range(\"X2:X2\").Formula = Range(\"AC2:AC2\").Value &amp; strTest\n Range(\"X2\").Select\n Selection.Copy\n Range(\"X2:X\" &amp; lastRow).Select\n Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n     SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "combobox"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1461155897, "post_id": 36743997, "comment_id": 61069245, "body": "Do you use a form to select from the dropdown? or where should it be?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1461156078, "post_id": 36743997, "comment_id": 61069357, "body": "it should be a userform but i don&#39;t find how to connect a userform from outlook to a dynamic column from excel. i can make an userform but i don&#39;t have the code for it ."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461158005, "post_id": 36743997, "comment_id": 61070995, "body": "Which application does the macro reside in? Excel, Outlook?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1461158102, "post_id": 36743997, "comment_id": 61071058, "body": "The macro is in outlook."}], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1461158395, "creation_date": 1461158395, "answer_id": 36745155, "question_id": 36743997, "link": "https://stackoverflow.com/questions/36743997/choose-email-subject-from-dropdown-list-of-excel-column/36745155#36745155", "title": "Choose email subject from dropdown list of excel column", "body": "<p>To connect your Outlook to Excel, you first have to add a reference to \"Microsoft Excel XX Object Library\" where XX is some version number (Extras->References)</p>\n\n<p>Then create a userform, mine looks like this:\n<a href=\"https://i.stack.imgur.com/m1PR8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m1PR8.png\" alt=\"example userform\"></a></p>\n\n<p>Note that my combobox has 2 columns (first one has a width of 0 so it's invisible)</p>\n\n<p>Then, when you are loading the Form, add code to open an Excel instance and load the combobox with values to select from:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n'Define Excel-Variables\nDim xlApp As Excel.Application\nDim xlWB As Excel.Workbook\nDim xlSheet As Excel.Worksheet\n\n'Create Excel Instance\nSet xlApp = New Excel.Application\n\n'Make it invisible\nxlApp.Visible = False\n\n'Open Workbook with Values\nSet xlWB = xlApp.Workbooks.Open(\"PATH TO YOUR EXCEL FILE\")\n\n'Select the Sheet with Values\nSet xlSheet = xlWB.Worksheets(\"sheet1\")\n\nDim i As Integer\n\n'Loop through the Values\nFor i = 1 To 30 Step 1\n\n    'This Combobox has 2 Columns where 1 is the bound one\n    'Add RowIndex to the first column(will be used to find the values later)\n    Me.cboTest.AddItem i\n\n    'Add the Name to the second Column\n    Me.cboTest.List(Me.cboTest.ListCount - 1, 1) = xlSheet.Cells(i, 1).Value\nNext i\n\n'Clean up and close Excel\nSet xlSheet = Nothing\n\nxlWB.Close False\n\nxlApp.Quit\n\nSet xlWB = Nothing\nSet xlApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Then you need to add some code to the button:</p>\n\n<p>Private Sub cmdSend_Click()</p>\n\n<pre><code>'variables for the values we are getting now\nDim name As String, email As String, text As String\n\n'more excel variables\nDim xlApp As Excel.Application\nDim xlWB As Excel.Workbook\nDim xlSheet As Excel.Worksheet\n\n\nSet xlApp = New Excel.Application\n\nxlApp.Visible = False\n\nSet xlWB = xlApp.Workbooks.Open(\"PATH TO EXCEL FILE\")\n\nSet xlSheet = xlWB.Worksheets(\"sheet1\")\n\n\n'access the rowindex from the first column of the combobox\n'use it for the Cells() as row\n'column may be edited as needed\nname = xlSheet.Cells(Me.cboTest.List(Me.cboTest.ListIndex, 0), 1).Value\nemail = xlSheet.Cells(Me.cboTest.List(Me.cboTest.ListIndex, 0), 2).Value\ntext = xlSheet.Cells(Me.cboTest.List(Me.cboTest.ListIndex, 0), 3).Value\n\n'excel cleanup\nSet xlSheet = Nothing\n\nxlWB.Close False\n\nxlApp.Quit\n\nSet xlWB = Nothing\nSet xlApp = Nothing\n\n'print output to console\n'instead of this, write your email\nDebug.Print \"mailto:\" &amp; email &amp; \" name:\" &amp; name &amp; \" text: \" &amp; text\nEnd Sub\n</code></pre>\n\n<p>Then, if we open the form, we can select from the values:\n<a href=\"https://i.stack.imgur.com/rlvlC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rlvlC.png\" alt=\"selection example\"></a></p>\n\n<p>If we then click the button, it will open excel and get the relevant values of the item we have selected.</p>\n\n<p>Output for Name5 looks like this:\n<a href=\"https://i.stack.imgur.com/5sPS9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5sPS9.png\" alt=\"console output\"></a></p>\n\n<p>By the way, my excel example list looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qI1hA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qI1hA.png\" alt=\"exel example list\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1461161628, "post_id": 36746531, "comment_id": 61074125, "body": "Sorry I&#39;m not able to format properly from my smartphone."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1461228212, "post_id": 36746531, "comment_id": 61106764, "body": "I saw you accepted another solution. Do you still need further elaborations on my answer? The error is due to UserForm code unloading itself and thus not making choices made available to code following it. I believe both handling the &quot;birth&quot; of a new application (Excel) and the closing of a UserForm should be kept away from the UserForm code and placed in its calling code. Should you agree you want to substitute any UserForm <code>Unload Me</code> statement  with <code>Me.Hide</code> and add <code>Unload UserForm1</code> after my code last <code>End With</code>.There remains possible &quot;close &quot;button&quot; users&#39;s clicking to handle."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1461229541, "post_id": 36746531, "comment_id": 61107733, "body": "That&#39;s precisely it: have UserForm being &quot;exploited&quot; by the caller code who&#39;d take care of all &quot;pre&quot; and &quot;post&quot; fuss and have UserForm do its dirty work only (gather information). Should you need any further clarification, just ask for them. If you found my answer useful, you may want to up-vote it..."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1461310004, "post_id": 36746531, "comment_id": 61150161, "body": "as for the &quot;Type mismatch&quot; error in <code>.ComboBox1.AddItem namesRng.Value</code>: query data in <code>namesRng</code> (it should be a one cell range, since you get there after <code>If namesRng.Count = 1</code> returns <code>True</code>). Actually  <code>.Value</code> property of <code>Range</code> object returns a <code>Variant</code> while <code>.AddItem</code> method of <code>.ListBox</code> object requires a <code>String</code> type. Maybe in my &quot;environment&quot; that conversion is made under the hood... try substituting <code>namesRng.Value</code> with <code>CStr(namesRng.Value)</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1461319061, "post_id": 36746531, "comment_id": 61155984, "body": "most probably the macro execution was stopped before total completion at least once. from then on there lingers at least 1 active Excel application which gets caught at the subsequent call of <code>GetExcel</code>. You could rectify this situation in two ways 1) close all application and restart your PC. and from then on make sure the macro <i>always</i> gets to call ReleaseExcel (throw in some error handling labels) 2) from the immediate window type <code>Set myExcel = GetObject(, &quot;Excel.Application&quot;)</code> and, if no errors are notified, type in <code>myExcel.Visible=True</code> and switch to Excel and close it. and loop..."}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1461322055, "post_id": 36746531, "comment_id": 61157877, "body": "Hi, the persons.xlsm remains open after i run the macro. I have tried to close after the execution of the macro but it just doesn&#39;t close (or i didn&#39;t do something good) . i can close the persons.xlsm with task manager so when i run the macro the message &quot;persons.xlsm is open , reopen persons.xlsm?&quot; will not appear. is there a way to just close the file after macro execution? Thank you."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1461323114, "post_id": 36746531, "comment_id": 61158545, "body": "To close a workbook you want to use the <code>.Close()</code> method of the <code>Workbook</code> object  (see <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff838613.aspx\" rel=\"nofollow noreferrer\">here</a>). In this case you may want to close the workbook in <code>ReleaseExcel</code> Sub by adding <code>xlApp.ActiveWorkbook.Close (False)</code> as its first statement"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 1, "creation_date": 1461344997, "post_id": 36746531, "comment_id": 61173406, "body": "Did you get through it?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1461834886, "post_id": 36746531, "comment_id": 61382987, "body": "Hi, i have tested and it works. Thank you for you support."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1461838826, "post_id": 36746531, "comment_id": 61385777, "body": "You&#39;re welcome. If this is the solution you adopted you may want to mark my answer as accepted. Thank you."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1461254463, "last_edit_date": 1461254463, "creation_date": 1461161520, "answer_id": 36746531, "question_id": 36743997, "link": "https://stackoverflow.com/questions/36743997/choose-email-subject-from-dropdown-list-of-excel-column/36746531#36746531", "title": "Choose email subject from dropdown list of excel column", "body": "<p><strong>edited</strong> after OP's usage of my original code and further clarifications</p>\n\n<p>here follows a complete refactoring code as per the following \"rules\"</p>\n\n<ul>\n<li><p><code>Option Explicit</code>statement</p>\n\n<p>this forces you to declare all variables</p>\n\n<p>but this little extra work but earns you back with much more control over what your writing and less debugging and/or maintenance efforts </p></li>\n<li><p>main \"mega\" code splitting into many single Sub/Funcs </p>\n\n<p>this helps in </p>\n\n<ul>\n<li><p>have more readable and maintainable code</p></li>\n<li><p>keeping Userforms and Applications loading and unloading calls away from any UserForm code, which must only take care of its real work: gather information </p></li>\n</ul></li>\n</ul>\n\n<p>place this in your Outlook Module:</p>\n\n<pre><code>Option Explicit\n\nSub email_DP2()\n\nDim mailData As Variant\n\nmailData = GetMailDataFromExcel(\"C:\\persons.xlsm\", _\n                                      \"Module2.FetchData3\", _\n                                      \"Sheet4\", _\n                                      \"L\")\nIf mailData = Empty Then Exit Sub\n\nWith CreateItem(0)\n    .SentOnBehalfOfName = \"\"\n    .Importance = olImportanceHigh\n    .To = mailData(1)\n    .Subject = mailData(0)\n    .GetInspector.WordEditor.Range.collapse 1\n    .Display\n    .HTMLBody = mailData(2)\n    '.Paste 'what are you pasting from?\nEnd With\n\nEnd Sub\n\n\n'-------------------------------------------------------\n' Excel handling Subs and Funcs\n'-------------------------------------------\nFunction GetMailDataFromExcel(strFile As String, fetchingModule As String, strSheet As String, colStrng As String) As Variant\n    Dim xlApp As Excel.Application\n    Dim closeExcel As Boolean\n    Dim namesRng As Excel.Range\n\n    Set xlApp = GetExcel(closeExcel)\n\n    If Not xlApp Is Nothing Then\n        Set namesRng = GetExcelRange(xlApp, strFile, fetchingModule, strSheet, colStrng) 'this will get the names range from given column of given worksheet of given workbook\n        With UserForm14\n            If namesRng.Count = 1 Then\n                .ComboBox1.AddItem namesRng.Value\n            Else\n                .ComboBox1.List = xlApp.Transpose(namesRng)\n            End If\n            .Show\n            With .ComboBox1\n                If .ListIndex &gt; -1 Then GetMailDataFromExcel = Array(.Value, _\n                                             namesRng.Offset(, 5).Cells(.ListIndex + 1, 1).Value, _\n                                             namesRng.Offset(, 6).Cells(.ListIndex + 1, 1).Value)\n            End With\n        End With\n        Unload UserForm14\n        Set namesRng = Nothing\n        ReleaseExcel xlApp, closeExcel\n    End If\n\nEnd Function\n\n\nFunction GetExcelRange(xlApp As Excel.Application, strFile As String, fetchingModule As String, strSheet As String, colStrng As String) As Excel.Range\n    With xlApp.Workbooks.Open(strFile, , False, , , , , , , True)\n        xlApp.Run fetchingModule\n        With .Worksheets(strSheet)\n            Set GetExcelRange = .Columns(colStrng).Resize(.Cells(.Rows.Count, colStrng).End(xlUp).Row)\n        End With\n    End With\nEnd Function\n\n\nFunction GetExcel(closeExcel As Boolean) As Excel.Application\n    On Error Resume Next\n    Set GetExcel = GetObject(, \"Excel.Application\")\n    If GetExcel Is Nothing Then\n        Set GetExcel = CreateObject(\"Excel.Application\")\n        closeExcel = True\n    End If\n    If GetExcel Is Nothing Then\n        MsgBox \"Couldn't instantiate Excel!\", vbCritical\n    End If\nEnd Function\n\n\nSub ReleaseExcel(xlApp As Excel.Application, closeExcel As Boolean)\n    If closeExcel Then xlApp.Quit\n    Set xlApp = Nothing\nEnd Sub\n'-------------------------------------------------------\n</code></pre>\n\n<p>place this in your UserForm14 code pane</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub btnOK_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub CancelButton_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = vbFormControlMenu Then\n        Cancel = True\n        Me.Hide\n    End If\nEnd Sub\n</code></pre>\n\n<p>in this latter I</p>\n\n<ul>\n<li><p>added <code>Option Explicit</code> statement</p>\n\n<p>although not strictly necessary (there is no variables usage but \"built in\" ones), it builds on a good habit</p></li>\n<li><p>added a <code>UserForm_QueryClose</code>event handler</p>\n\n<p>that handles the possible user's clicking the UserForm \"Close\" button</p></li>\n<li><p>erased the <code>End</code> statement</p>\n\n<p>I always learned it's a bad habit to use it and better stick to <code>Exit Sub</code>/<code>Exit Function</code> ones (possibly with proper mix of  <code>If.. Then.. Else</code> blocks) to achieve the same effect without any harm</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1461243718, "post_id": 36766903, "comment_id": 61118192, "body": "at a quick glance: change <code>With ComboBox1</code> with <code>With .ComboBox1</code> (a dot missing). then you dim <code>Dim sourceWS As Object</code> and then use <code>Set sourceWH =...</code>, so try dimming <code>Dim sourceWH As Object</code>. But you&#39;d better get the habit of using <code>Option Explicit</code> at the very top of every module to force yourself to declare all variables: this will put in some extra work but you&#39;ll be rewarded with tons of more control over what your writing!"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461247232, "post_id": 36766903, "comment_id": 61121065, "body": "Hi, now it works. I will test the code better on the morrow and let you know if is good. Thank you."}], "tags": [], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "is_accepted": false, "score": 0, "last_activity_date": 1461234743, "creation_date": 1461234743, "answer_id": 36766903, "question_id": 36743997, "link": "https://stackoverflow.com/questions/36743997/choose-email-subject-from-dropdown-list-of-excel-column/36766903#36766903", "title": "Choose email subject from dropdown list of excel column", "body": "<p>@user3598756</p>\n\n<p>I made the config with your code:</p>\n\n<p>userform14 code:\"</p>\n\n<pre><code>Private Sub btnOK_Click()\nMe.Hide\nEnd Sub\nPrivate Sub CancelButton_Click()\n Me.Hide\n End\nEnd Sub\nPrivate Sub UserForm_Click()\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RGD18.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RGD18.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the function code:</p>\n\n<pre><code>    Sub email_DP2()\n    Dim name As String, email As String, text As String\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim olInsp As Object\n    Dim oRng As Object\n    Dim StrBdB As String\n\n        Dim xlApp As Object\n        Dim sourceWB As Object\n        Dim sourceWS As Object\n        Set xlApp = CreateObject(\"Excel.Application\")\n        strFile = \"C:\\persons.xlsm\" \n        Set sourceWB = xlApp.Workbooks.Open(strFile, , False, , , , , , , True)\n        Set sourceWH = sourceWB.Worksheets(\"Sheet4\")\n        sourceWH.Application.Run \"Module2.FetchData3\"\n\n    Dim pickedName As String, emailAddress As String, emailText As String\n    Dim namesRng As Range\n\n    With sourceWH '&lt;== change \"myWorkbookName\" and \"Sheet4\" to your needs\n        Set namesRng = .Range(\"L1:L\" &amp; .Cells(.Rows.Count, \"L\").End(xlUp).Row)\n    End With\n    With UserForm14 ' change it to whatever name your actual UserForm has\n        .ComboBox1.List = xlApp.Transpose(namesRng)\n        .Show\n        With ComboBox1\n             pickedName = .Value\n             emailAddress = namesRng.Offset(, 5).Cells(.ListIndex + 1, 1).Value\n             emailText = namesRng.Offset(, 6).Cells(.ListIndex + 1, 1).Value\n        End With\n    End With\nUnload UserForm14\n         On Error Resume Next\n         Set OutApp = GetObject(, \"Outlook.Application\")\n         If Err &lt;&gt; 0 Then Set OutApp = CreateObject(\"Outlook.Application\")\n         On Error GoTo 0\n         Set OutMail = OutApp.CreateItem(0)\n         With OutMail\n             OutMail.SentOnBehalfOfName = \"\"\n             .Importance = olImportanceHigh\n             .To = emailAddress  \n             .Subject = pickedName \n             Set olInsp = .GetInspector\n             Set wdDoc = olInsp.WordEditor\n             Set oRng = wdDoc.Range\n             oRng.collapse 1\n             .Display\n             OutMail.HTMLBody = emailText \n             oRng.Paste\n         End With\n         Set OutMail = Nothing\n         Set OutApp = Nothing\n         Set olInsp = Nothing\n         Set wdDoc = Nothing\n         Set oRng = Nothing\n    End Sub\n</code></pre>\n\n<p>It gives object required on line pickedName = .Value - if i eliminate the line it will give the same at line emailAddress = namesRng.Offset ...  I thing is a problem with   With ComboBox1 - if i eliminate with , it will generate an email but without the to, subject and text added to it.  </p>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 36746531, "answer_count": 3, "score": 0, "last_activity_date": 1461254463, "creation_date": 1461155731, "last_edit_date": 1461157124, "question_id": 36743997, "link": "https://stackoverflow.com/questions/36743997/choose-email-subject-from-dropdown-list-of-excel-column", "title": "Choose email subject from dropdown list of excel column", "body": "<p>I have code for emails and I want to connect to a column in an excel. When the macro is triggered, a dropdown should appear so I can choose to how to send the email depending on a list in an excel. The list is generated from other excels, it could have 2 full names or 40 full names. The list is in Sheet4 and the names are in column L, the email address is in column Q and the text in column P. If I choose from the dropdown, the name in L2, it should take the email address from Q2, the name from L2 and the text from P2. Here is what I have until now:</p>\n\n<pre><code>Sub email_to_one_person_from_the_list()\nDim OutApp As Object\nDim OutMail As Object\nDim xlApp As Object\nDim sourceWB As Object\nDim sourceWS As Object\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    strFile = \"C:\\persons.xlsm\" \n\n    Set sourceWB = xlApp.Workbooks.Open(strFile, , False, , , , , , , True)\n    Set sourceWH = sourceWB.Worksheets(\"Sheet4\")\n    sourceWB.Activate\n\nsourceWH.Application.Run \"Module2.FetchData3\"\n\n     On Error Resume Next\n     Set OutApp = GetObject(, \"Outlook.Application\")\n     If Err &lt;&gt; 0 Then Set OutApp = CreateObject(\"Outlook.Application\")\n     On Error GoTo 0\n\n     Set OutMail = OutApp.CreateItem(0)\n     With OutMail\n         .To = sourceWH.Range(\"Q2\").Value\n         .CC = \"\"\n         .BCC = \"\"\n         .Subject = \"Dear \" &amp; sourceWH.Range(\"L2\").Value\n         .Display\n         OutMail.HTMLBody = sourceWH.Range(\"P2\").Value\n\n   sourceWB.Close SaveChanges:=False\n   xlApp.Quit\n\n     Set OutMail = Nothing\n     Set OutApp = Nothing\n\nEnd Sub \n</code></pre>\n\n<p>and the combobox:</p>\n\n<pre><code>Private Sub CancelButton_Click()\n Unload Me\n End\nEnd Sub\nPrivate Sub OKButton_Click()\n    thelist1 = ComboBox1.ListIndex\n    Unload Me\nEnd Sub\nPrivate Sub UserForm_Initialize()\nWith ComboBox1 \n             ' the  excel list here\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461155963, "post_id": 36743973, "comment_id": 61069283, "body": "What does the <code>copy</code> code look like?"}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461156172, "post_id": 36743973, "comment_id": 61069450, "body": "@Rory added the code for the Excel Macro."}], "answers": [{"comments": [{"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "edited": false, "score": 0, "creation_date": 1461156661, "post_id": 36744263, "comment_id": 61069830, "body": "This gives the exact same result; closing the workbooks is not the problem. In fact, I need this one to stay open and open other workbooks for me. Further, if that was the problem, the excel-macro would throw an error, not the WORD one."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "edited": false, "score": 0, "creation_date": 1461156924, "post_id": 36744263, "comment_id": 61070052, "body": "I&#39;ve made one amendment to the code - can you retest?"}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "edited": false, "score": 0, "creation_date": 1461157012, "post_id": 36744263, "comment_id": 61070122, "body": "That&#39;s it! Works like a charm! - I can now see the logic behind my error, and gaining insights on these things is always way better than copy/pasting code. thnx"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1461156907, "last_edit_date": 1461156907, "creation_date": 1461156396, "answer_id": 36744263, "question_id": 36743973, "link": "https://stackoverflow.com/questions/36743973/running-macros-after-losing-focus/36744263#36744263", "title": "Running Macro&#39;s after losing focus", "body": "<p>I suspect you are being left with a workbook open. Make sure there aren't any Excel instances running in the background, then change your code to:</p>\n\n<pre><code>Dim xl                        As Object\nDim wb                        As Object\nSet xl = CreateObject(\"Excel.Application\")\nxl.Workbooks.Open \"\\\\path\\to\\DESKTOP\\qrap\\xlsHelper.xlsm\"\n\nFor i = 0 To 10\n    xl.Run \"xlsHelper.xlsm!copy\", \"\\\\path\\to\\DESKTOP\\qrap\\stukken\\2003 2015-2 financieel.xls\"\n\n    Selection.PasteSpecial Link:=False, DataType:=wdPasteEnhancedMetafile, _\n                           Placement:=wdInLine, DisplayAsIcon:=False\nNext\n\nxl.Activeworkbook.Close False\nxl.Quit\n</code></pre>\n\n<p>and try that.</p>\n"}], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 36744263, "answer_count": 1, "score": 1, "last_activity_date": 1531309560, "creation_date": 1461155678, "last_edit_date": 1531309560, "question_id": 36743973, "link": "https://stackoverflow.com/questions/36743973/running-macros-after-losing-focus", "title": "Running Macro&#39;s after losing focus", "body": "<p>I'm trying to copy a Range from Excel into Word and paste it as an image.</p>\n\n<p>My setup currently is:</p>\n\n<ul>\n<li>WORD runs a Macro, which creates an Excel object and opens Workbook1.xlsm</li>\n<li>WORD calls a macro on Workbook1.xlsm</li>\n<li>The macro copies a range onto the clipboard.</li>\n<li>WORD then pastes the clipboard as an image.</li>\n</ul>\n\n<p>After the pasting in WORD, I can no longer call any macro's in the referenced Excel document. My code, which lives in a WORD VBA macro:</p>\n\n<pre><code>Dim xl As Object\nSet xl = CreateObject(\"Excel.Application\")\nxl.Workbooks.Open (\"\\\\path\\to\\DESKTOP\\qrap\\xlsHelper.xlsm\")\n\nFor i = 0 To 10\n    xl.Run \"copy\", \"\\\\path\\to\\DESKTOP\\qrap\\pieces\\2003 2015-2 finance.xls\"\n\n    Selection.PasteSpecial Link:=False, DataType:=wdPasteEnhancedMetafile, _\n        Placement:=wdInLine, DisplayAsIcon:=False\nNext\n\nxl.ActiveWorkbook.Close (False)\nxl.Quit\nSet xl = Nothing\n</code></pre>\n\n<p>On the second iteration, the line <code>xl.Run ...</code> throws a <code>Runtime Error 1004: Macro cannot be executed</code>. Runs fine the first time. Runs fine if I don't switch to WORD.</p>\n\n<p>How can I refocus to Excel, so that the macro can run properly?</p>\n\n<p>Additionally, the <code>copy</code> macro in the Excel file is this:</p>\n\n<pre><code>Dim oWb As Workbook\n\nPublic Sub copy(filename As String)\n    If Not (oWb Is Nothing) Then\n        oWb.Close\n        Set oWb = Nothing\n    End If\n\n    Set oWb = Workbooks.Open(filename)\n    ActiveCell.CurrentRegion.Select\n    Selection.copy\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "for-loop", "vba"], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1461156725, "post_id": 36744044, "comment_id": 61069885, "body": "Ah cool.  I tried something similar earlier but clearly didn&#39;t use the correct formatting around ws.name. My problem now is that this fills column A, but column B is messed up because of my Rows.count.  I think I may be using it wrong.  Any advice?"}, {"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1461161622, "post_id": 36744044, "comment_id": 61074121, "body": "That&#39;s excellent.  Thank you very much @Rory, I see how that works."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1461157070, "last_edit_date": 1461157070, "creation_date": 1461155849, "answer_id": 36744044, "question_id": 36743887, "link": "https://stackoverflow.com/questions/36743887/excel-vba-perform-formula-on-sheet-based-on-cell-values-of-looped-through-work/36744044#36744044", "title": "Excel VBA - Perform Formula on Sheet Based on Cell Values of Looped-Through Worksheets", "body": "<p>You just need to add in the sheet name:</p>\n\n<pre><code>If ws.Name &lt;&gt; \"Uptime\" Then\n   With Worksheets(\"Uptime\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n     .Value2 = ws.Name\n     .Offset(, 1).Formula = \"=('\" &amp; ws.name &amp; \"'!ET40/60)/24\"\n   End With\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 36744044, "answer_count": 1, "score": 0, "last_activity_date": 1462454833, "creation_date": 1461155461, "last_edit_date": 1531164843, "question_id": 36743887, "link": "https://stackoverflow.com/questions/36743887/excel-vba-perform-formula-on-sheet-based-on-cell-values-of-looped-through-work", "title": "Excel VBA - Perform Formula on Sheet Based on Cell Values of Looped-Through Worksheets", "body": "<p>I currently have this code -</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\nIf ws.Name &lt;&gt; \"Uptime\" Then\n   Worksheets(\"Uptime\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0) = ws.Name\n</code></pre>\n\n<p>This loops through all of the sheets and adds the sheetName into Col.A.</p>\n\n<p>What I'm now struggling with is the formula that I want in Col.B.  All of my sheets have a calculated value in cell ET40.</p>\n\n<p>I want to take that value, apply formula <code>=(ET40/60)/24</code> and then place it in the corresponding cell in Col.B on my \"Uptime\" sheet.  I'm struggling with this one.</p>\n\n<p>I've tried - <code>Worksheets(\"Uptime\").Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Formula = \"=(ET40/60)/24\"</code>\nBut I think that just tries to look for ET40 on \"Uptime\" which is empty.</p>\n\n<p>I'm not sure how I get the formula in that line of code to look at the current Worksheet on the loop.</p>\n\n<p>Edit -</p>\n\n<p>Full code written with Rory's help</p>\n\n<pre><code>Sub Uptime()\n\nDim ws As Worksheet\n\nApplication.ScreenUpdating = False\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Uptime\" Then\n       With Worksheets(\"Uptime\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n        .Value2 = ws.Name\n        .Offset(, 1).Formula = \"=('\" &amp; ws.Name &amp; \"'!ET40/60)/24\"\n       End With\n    End If\nNext ws\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "function"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1461155751, "post_id": 36743838, "comment_id": 61069146, "body": "Why would you need such high amounts of elements in an array? You could try to use a collection, maybe it supports more than 2^16"}, {"owner": {"reputation": 34079, "user_id": 183579, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6cb844f49167c1c62dfb60bcbd9fe153?s=128&d=identicon&r=PG", "display_name": "Richard H", "link": "https://stackoverflow.com/users/183579/richard-h"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 1, "creation_date": 1461156002, "post_id": 36743838, "comment_id": 61069312, "body": "Arrays with &gt; 65,536 elements are no problem within the VBA code itself, it&#39;s the returning of the array to the spreadsheet that is the problem."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461158880, "post_id": 36743838, "comment_id": 61071727, "body": "Are you using excel 2003 or earlier or is your workbook saved as an .xls?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461159835, "post_id": 36743838, "comment_id": 61072547, "body": "Related: <a href=\"http://stackoverflow.com/q/11237195/11683\">stackoverflow.com/q/11237195/11683</a> (not voting as duplicate because the solution will not work)."}, {"owner": {"reputation": 34079, "user_id": 183579, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6cb844f49167c1c62dfb60bcbd9fe153?s=128&d=identicon&r=PG", "display_name": "Richard H", "link": "https://stackoverflow.com/users/183579/richard-h"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461160636, "post_id": 36743838, "comment_id": 61073223, "body": "@ScottCraner Excel 2007, is a .xlsm"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1461160867, "post_id": 36743838, "comment_id": 61073435, "body": "See the link by @GSerg. It explains that they did not fix the limitation of assigning the aray to the spreadsheet. It is not a VBA problem but excel 2007."}], "answers": [{"comments": [{"owner": {"reputation": 34079, "user_id": 183579, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6cb844f49167c1c62dfb60bcbd9fe153?s=128&d=identicon&r=PG", "display_name": "Richard H", "link": "https://stackoverflow.com/users/183579/richard-h"}, "edited": false, "score": 0, "creation_date": 1461159597, "post_id": 36745288, "comment_id": 61072342, "body": "Thanks but I think this creates a 2 dimensional array 4 x 50,000 right? As opposed to a concatenated 1 x 200,000"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461159796, "post_id": 36745288, "comment_id": 61072512, "body": "How are you going to call this from a sheet?"}, {"owner": {"reputation": 340, "user_id": 2474008, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/810145437/picture?type=large", "display_name": "Vexen Crabtree", "link": "https://stackoverflow.com/users/2474008/vexen-crabtree"}, "edited": false, "score": 0, "creation_date": 1461161667, "post_id": 36745288, "comment_id": 61074161, "body": "Richard H - the 1st code block doesn&#39;t make a 2-dimensional array as such, but, it returns a single array with 4 items, but each item is really another array. The 2nd code block makes a real multidimensional array. Without knowing what the purpose of the output is, it is hard to know which way would be best or if the 2nd method would still error."}], "tags": [], "owner": {"reputation": 340, "user_id": 2474008, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/810145437/picture?type=large", "display_name": "Vexen Crabtree", "link": "https://stackoverflow.com/users/2474008/vexen-crabtree"}, "is_accepted": false, "score": 0, "last_activity_date": 1461159204, "last_edit_date": 1461159204, "creation_date": 1461158676, "answer_id": 36745288, "question_id": 36743838, "link": "https://stackoverflow.com/questions/36743838/vba-work-around-for-the-65-536-array-limit-with-user-defined-functions/36745288#36745288", "title": "VBA: work around for the 65,536 array limit with user defined functions", "body": "<p>Break up the results into 4 array and return an array with 4 items. First code is to illustrate the split, and the 2nd bit of code is probably closer to how you'd actually want to do it (but more complicated):</p>\n\n<pre><code>Dim arr() as string, arrP1(1 to 50000) as string, arrP2(1 to 50000) as string, arrP3(1 to 50000) as string, arrP4(1 to 50000) as string\n\nReDim Preserve arr(1 To 200,000)\n\n' Populate array....\n\n'Break results into 4 array parts:\nfor a=1 to 50000\n   arrP1(a) = arr(a)\nnext\nfor a=1 to 50000\n   arrP2(a) = arr(50000+a)\nnext\nfor a=1 to 50000\n   arrP3(a) = arr(100000+a)\nnext\nfor a=1 to 50000\n   arrP4(a) = arr(150000+a)\nnext\n'Finally, return a 4-item array containing the parts:\nTestSize = Array(arrP1,arrP2,arrP3,arrP4)\n</code></pre>\n\n<p>If you arr() could be any size, then, you could do the above with a clever thing like this, using a multidimensional array. Untested:</p>\n\n<pre><code>redim preserve arrParts(ubound(arr())\\50000, 50000)\nfor a=1 to ubound(arr()) step 50000\n    for aa=1 to 50000\n       arrParts(a\\50000, a mod 50000) = arr(a)\n    next\nnext\n</code></pre>\n"}], "owner": {"reputation": 34079, "user_id": 183579, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6cb844f49167c1c62dfb60bcbd9fe153?s=128&d=identicon&r=PG", "display_name": "Richard H", "link": "https://stackoverflow.com/users/183579/richard-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2736, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467161778, "creation_date": 1461155350, "last_edit_date": 1467161778, "question_id": 36743838, "link": "https://stackoverflow.com/questions/36743838/vba-work-around-for-the-65-536-array-limit-with-user-defined-functions", "title": "VBA: work around for the 65,536 array limit with user defined functions", "body": "<p>I have a user-defined function in VBA that needs to return more than 65,536 results as an array. However attempting to return more than 65,536 results in #VALUE:</p>\n\n<pre><code>  Function TestSize()\n\n    Dim arr() As String\n    ReDim Preserve arr(1 To 200,000)  ' No problem creating and using array with &gt; 65,536 elements  \n\n    ' Populate array....\n\n    TestSize = arr()   ' Fails here, produces #VALUE,  if array &gt; 65,536\n\n  End Function\n</code></pre>\n\n<p>Appreciate this is a long-standing problem. Does anyone know of a work around?</p>\n\n<p>Also: would I face the same problem if I wrote the function in VB?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 4485533, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/669121f1bcfc9395b4a6e4cc699881af?s=128&d=identicon&r=PG&f=1", "display_name": "redviper2100", "link": "https://stackoverflow.com/users/4485533/redviper2100"}, "edited": false, "score": 0, "creation_date": 1461159976, "post_id": 36743438, "comment_id": 61072646, "body": "Could you please give me a piece of code to understand? I&#39;m not that experienced."}], "tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": false, "score": 3, "last_activity_date": 1461160395, "last_edit_date": 1461160395, "creation_date": 1461154401, "answer_id": 36743438, "question_id": 36743259, "link": "https://stackoverflow.com/questions/36743259/excel-extract-nth-first-words-from-a-string/36743438#36743438", "title": "Excel Extract nth first words from a string", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx\" rel=\"nofollow\">Split()</a>  function. It returns array of <code>String</code>, split using the delimiter and limit of words you specify.</p>\n\n<pre><code>Dim Result As Variant\nResult = Split(\"Alice,Bob,Chuck,Dave\", \",\") 'Result: {\"Alice,\"Bob\",\"Chuck\",\"Dave\"}\nResult = Split(\"Alice,Bob,Chuck,Dave\", \",\", 2) 'Result: {\"Alice,\"Bob\"}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1461165711, "last_edit_date": 1461165711, "creation_date": 1461165183, "answer_id": 36748114, "question_id": 36743259, "link": "https://stackoverflow.com/questions/36743259/excel-extract-nth-first-words-from-a-string/36748114#36748114", "title": "Excel Extract nth first words from a string", "body": "<p>@Taosique's answer using <code>Split</code> is excellent, but if you want the result returned as a string you can do the following:</p>\n\n<pre><code>Function FirstWords(myStr As String, delimiter As String, words_to_extract As Long) As Variant\n    Dim i As Long, k As Long\n    For i = 1 To Len(myStr)\n        If Mid(myStr, i, 1) = delimiter Then\n            k = k + 1\n            If k = words_to_extract Then\n                FirstWords = Mid(myStr, 1, i)\n                Exit Function\n            End If\n        End If\n    Next I\n\n    'if you get to here -- trouble\n    'unless the delimiter count is words_to_extract - 1\n    If k = words_to_extract - 1 Then\n        FirstWords = myStr\n    Else\n        FirstWords = CVErr(xlErrValue)\n    End If    End Function\n\nSub test()\n    Debug.Print FirstWords(\"This is a test. I hope it works\", \" \", 4)\n    Debug.Print FirstWords(\"This is a test. I hope it works\", \" \", 10)\nEnd Sub\n</code></pre>\n\n<p>When <code>test</code> is run it first displays the string \"This is a test.\" then prints an error condition.</p>\n\n<p>Much the same effect as the above can be achieved by first splitting the string using <code>Split</code> and then rejoining it using <code>Join</code>. A subtle difference is the behavior if there are less than <code>words_to_extract</code> words. The <code>Split</code> then <code>Join</code> approach will return the whole string. The above code treats this as an error condition and, if used as a UDF worksheet function, will display <code>#VALUE!</code> in any cell that contains it.</p>\n"}], "owner": {"reputation": 265, "user_id": 4485533, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/669121f1bcfc9395b4a6e4cc699881af?s=128&d=identicon&r=PG&f=1", "display_name": "redviper2100", "link": "https://stackoverflow.com/users/4485533/redviper2100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461165711, "creation_date": 1461153933, "question_id": 36743259, "link": "https://stackoverflow.com/questions/36743259/excel-extract-nth-first-words-from-a-string", "title": "Excel Extract nth first words from a string", "body": "<p>I'd like to create a function in vba to extract the first nth words from a string and to look like this</p>\n\n<p>ExtractWords(affected_text, delimiter, number_of_words_to_extract)</p>\n\n<p>I tried a solution but it only extracts the first two words.</p>\n\n<pre><code>Function FirstWords(myStr As Variant, delimiter,words_to_extract) As Variant\n  FirstWords = Left(myStr, InStr(InStr(1, myStr, delimiter) + 1, myStr, delimiter, vbTextCompare) - 1)\nEnd Function\n</code></pre>\n\n<p>Any ideas? Thanks</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1461154450, "creation_date": 1461154450, "answer_id": 36743461, "question_id": 36743254, "link": "https://stackoverflow.com/questions/36743254/vba-run-time-error-13/36743461#36743461", "title": "VBA Run-time error 13", "body": "<p><code>x</code> is a variable so you need to concatenate it into the rows statement, or you are using the literal text \"x\":</p>\n\n<pre><code>Rows(x &amp; \":1048576\").EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 36743461, "answer_count": 1, "score": 0, "last_activity_date": 1461154450, "creation_date": 1461153921, "question_id": 36743254, "link": "https://stackoverflow.com/questions/36743254/vba-run-time-error-13", "title": "VBA Run-time error 13", "body": "<p>I have created a simple code however it keeps coming up with run time error 13. Does anyone know why this is happening?</p>\n\n<pre><code>Dim x As Integer\nx = ActiveSheet.Range(\"ALL_PROJECTS\").row\nRows(\"x:1048576\").EntireRow.Delete\nRange(\"A3\").ClearContents\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1461154976, "last_edit_date": 1461154976, "creation_date": 1461154564, "answer_id": 36743512, "question_id": 36743190, "link": "https://stackoverflow.com/questions/36743190/apply-formula-to-a-range-of-cells/36743512#36743512", "title": "Apply formula to a range of cells", "body": "<p>You didn't properly qualify the ranges for the <code>lastRow</code> variable:</p>\n\n<pre><code>lastRow = .Cells(.Rows.Count, 5).End(xlUp).Row\n</code></pre>\n\n<p>Note the dots before <code>Cells</code> and <code>Rows</code>.</p>\n\n<p>A couple of additional points:</p>\n\n<p>Always use <code>Long</code> rather than <code>Integer</code> for row variables as there are more rows in a sheet than an Integer can hold.</p>\n\n<p>You don't need to loop to put the same formula in a column of cells.</p>\n\n<pre><code>Dim z                     As Workbook   'Budget Workbook\nDim y                     As Workbook   'Formatted - current workbook\nDim lastRow               As Long\nDim budgLastRow           As Long\n\nSet y = Workbooks(\"DLT.xlsm\")\nSet z = Workbooks.Open(\"C:\\Reports\\Budget.xlsx\")\n\n'Apply function to columns to pull costing data\nWith y.Worksheets(\"DLT\")\n    lastRow = .Cells(.Rows.Count, 5).End(xlUp).Row\n\n    With .Range(\"AI22:AJ\" &amp; lastRow)\n        .Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E22,'[Budget.xlsx]DynamicReport'!H:H)\"\n        .Value2 = .Value2\n    End With\n\n    With .Range(\"AN22:AN\" &amp; lastRow)\n        .Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E22,'[Budget.xlsx]DynamicReport'!E:E)\"\n        .Value2 = .Value2\n    End With\n\n    With .Range(\"AO22:AO\" &amp; lastRow)\n        .Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E22,'[Budget.xlsx]DynamicReport'!G:G)\"\n        .Value2 = .Value2\n    End With\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 36743512, "answer_count": 1, "score": 0, "last_activity_date": 1461159241, "creation_date": 1461153771, "last_edit_date": 1461159241, "question_id": 36743190, "link": "https://stackoverflow.com/questions/36743190/apply-formula-to-a-range-of-cells", "title": "Apply formula to a range of cells", "body": "<p>I have some code which I know works, I am applying a SUMIF formula to a range of cells.  It works but it add a load of extra row at the bottom that shouldn't be there.  I tried adding in a do until loop but it gets stuck in an infinite loop and crashes.</p>\n\n<p>This is my first lot of code which works but adds the extra row in only on the columns which have been copied over.</p>\n\n<pre><code>    Dim z As Workbook   'Budget Workbook\n    Dim y As Workbook   'Formatted - current workbook\n    Dim lastRow As Integer\n    Dim budgLastRow As Integer\n    Dim rng As Range\n\n    Set y = Workbooks(\"DLT.xlsm\")\n    Set z = Workbooks.Open(\"C:\\Reports\\Budget.xlsx\")\n\n'Apply function to columns to pull costing data\n    With y.Worksheets(\"DLT\")\n        lastRow = Cells(Rows.Count, 5).End(xlUp).Row\n\n            For Each rng In .Range(\"AI22:AI\" &amp; lastRow)\n                rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E\" &amp; rng.Row &amp; \",'[Budget.xlsx]DynamicReport'!H:H)\"\n                rng.Value = rng.Value\n            Next rng\n\n            For Each rng In .Range(\"AJ22:AJ\" &amp; lastRow)\n                rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E\" &amp; rng.Row &amp; \",'[Budget.xlsx]DynamicReport'!I:I)\"\n                rng.Value = rng.Value\n            Next rng\n\n            For Each rng In .Range(\"AN22:AN\" &amp; lastRow)\n                rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E\" &amp; rng.Row &amp; \",'[Budget.xlsx]DynamicReport'!E:E)\"\n                rng.Value = rng.Value\n            Next rng\n\n            For Each rng In .Range(\"AO22:AO\" &amp; lastRow)\n                rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$E\" &amp; rng.Row &amp; \",'[Budget.xlsx]DynamicReport'!G:G)\"\n                rng.Value = rng.Value\n            Next rng\n\n    End With\n</code></pre>\n\n<p>I think the other additional rows have been copied because the budget workbook contains more data then the formatted work book.  I have know thought to possibly delete the other unnecessary row which have been copied cross.</p>\n\n<p>So I have added this small piece of code in</p>\n\n<pre><code>    With y.Worksheets(\"Formatted\")\n        lastRow = Cells(Rows.Count, 5).End(xlUp).Row - 1\n        budgLastRow = Cells(Rows.Count, 35).End(xlUp).Row\n        Rows(\"AI\" &amp; lastRow &amp; \":AO\" &amp; budgLastRow).EntireRow.Delete\n    End With\n</code></pre>\n\n<p>I get an application-defined error Object defined error on the line</p>\n\n<pre><code> Rows(\"AI\" &amp; lastRow &amp; \":AO\" &amp; budgLastRow).EntireRow.Delete\n</code></pre>\n\n<p>This is probably not the most efficient way to do this, but its the only way I could think of.  I am fairly new to VBA only been coding a couple of months so mostly just try out different ways and see what works.  Can anyone help me please.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461155135, "post_id": 36742737, "comment_id": 61068665, "body": "Try setting <code>Set c = Nothing</code> after the highlighted <code>If</code> clause."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461158653, "post_id": 36744858, "comment_id": 61071521, "body": "I am still getting the same error using the posted code. I will try changing the wild cards and run again"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461159166, "post_id": 36744858, "comment_id": 61071987, "body": "Are you sure that the sheet name is <code>Data</code> and not possibly <code>Data </code> (with a trailing space or something)? That would typically lead to the error code you are getting. I just changed the code to check for that error. Please give it a try."}, {"owner": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461159892, "post_id": 36744858, "comment_id": 61072588, "body": "Giving me a &quot;Sheet not found, Aborting&quot; message. The sheet is automatically created with the name &quot;Data&quot; no spaces."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461160290, "post_id": 36744858, "comment_id": 61072923, "body": "Just what I thought. There is no sheet with the name <code>Data</code> in your Excel file. I just adjusted the code to use the first sheet that has &quot;Data&quot; in its name instead. Let me know if this works now."}, {"owner": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461161241, "post_id": 36744858, "comment_id": 61073798, "body": "Same error. Here is the code i use to create my data. Maybe that will shed some light on the naming."}, {"owner": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461161367, "post_id": 36744858, "comment_id": 61073905, "body": "With ThisWorkbook         Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))         ws.name = &quot;Data&quot;     End With"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "edited": false, "score": 0, "creation_date": 1461162168, "post_id": 36744858, "comment_id": 61074621, "body": "If the above code stops with <code>Sheet not found.</code> then there is no sheet by the name of <code>Data</code> in your Excel file. There could be many reasons: (1) The code generating the new sheet is run after the above code or not yet run, (2) the code generating a new sheet is run in a different workbook, (3) you have a Cyrillic keyboard layout and the <code>a</code> in <code>Data</code> is mixed with Latin characters, (4) and many more... All I can say is that the above code proves (!) that there is no sheet by the name <code>Data</code> in your Excel file at the time the code is run."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1461160235, "last_edit_date": 1461160235, "creation_date": 1461157718, "answer_id": 36744858, "question_id": 36742737, "link": "https://stackoverflow.com/questions/36742737/trying-to-remove-headers-via-vba-but-get-run-time-error-91/36744858#36744858", "title": "Trying to remove headers via vba but get run-time error 91", "body": "<p>Here is your code with the suggested adjustment (as written in the comment) and a few more minor changes. The code has been tested and works fine on my system.</p>\n\n<pre><code>Option Explicit\n\nSub RemoveHeaders()\n\nConst HdrTextOne As String = \"*Station*\"\nConst HdrTextTwo As String = \"*Export File For Future Analysis*\"\nConst HdrTextThree As String = \"*0*\"\nConst HdrKeepRowOne As Long = 3\nConst HdrKeepRowTwo As Long = 1\nConst HdrKeepRowThree As Long = 19\n\nDim c As Range\nDim lr As Long\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n    If InStr(1, ws.Name, \"Data\", vbTextCompare) Then\n        MsgBox \"Using the sheet:\" &amp; Chr(10) &amp; \"'\" &amp; ws.Name &amp; \"'\"\n        Exit For\n    Else\n        MsgBox \"Sheet not found.\" &amp; Chr(10) &amp; \"Aborting!\"\n        Exit Sub\n    End If\nNext ws\n\nApplication.ScreenUpdating = False\n\nlr = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n\nIf lr &gt; HdrKeepRowThree Then\n    With ws.Range(\"B\" &amp; HdrKeepRowOne &amp; \":B\" &amp; lr)\n        Set c = .Find(HdrTextOne, LookIn:=xlValues, SearchDirection:=xlNext)\n        If Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowOne Then\n            Do\n                c.Resize(5).EntireRow.Delete\n                Set c = .Find(HdrTextOne, LookIn:=xlValues, SearchDirection:=xlNext)\n            Loop While Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowOne\n        End If\n        Set c = Nothing\n\n\n        Set c = .Find(HdrTextTwo, LookIn:=xlValues, SearchDirection:=xlNext)\n        If Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowTwo Then\n            Do\n                c.Resize(5).EntireRow.Delete\n                Set c = .Find(HdrTextTwo, LookIn:=xlValues, SearchDirection:=xlNext)\n            Loop While Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowTwo\n        End If\n        Set c = Nothing\n    End With\nEnd If\n\nlr = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n\nIf lr &gt; HdrKeepRowThree Then\n    With ws.Range(\"D\" &amp; HdrKeepRowThree &amp; \":D\" &amp; lr)\n        Set c = .Find(HdrTextThree, LookIn:=xlValues, SearchDirection:=xlNext)\n        If Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowThree Then\n            Do\n                c.Resize(5).EntireRow.Delete\n                Set c = .Find(HdrTextThree, LookIn:=xlValues, SearchDirection:=xlNext)\n            Loop While Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowThree\n        End If\n        Set c = Nothing\n    End With\nEnd If\n\nOn Error GoTo NoBlanksFound\nws.Columns(\"C:C\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nOn Error GoTo 0\n\nNoBlanksFound:\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Note, that the <code>Find</code> method does not support wildcards such as <code>*</code>. If you wish to find a partial string then you should change your <code>Find</code> to <code>LookAt:=xlPart</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">as stipulated on MSDN</a>.</p>\n\n<p>Let me know if this solves your problems.</p>\n"}], "owner": {"reputation": 1, "user_id": 6210263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/43d2f4f9216dbc132feed358048bbdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Djhatche", "link": "https://stackoverflow.com/users/6210263/djhatche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461160235, "creation_date": 1461152582, "last_edit_date": 1461156227, "question_id": 36742737, "link": "https://stackoverflow.com/questions/36742737/trying-to-remove-headers-via-vba-but-get-run-time-error-91", "title": "Trying to remove headers via vba but get run-time error 91", "body": "<p>I am getting the Run time error 91 \"Object variable or with block variable not set\" with this line of code. What is stumping me is that sometimes it runs perfectly and others it just gives me the error. When I searched that error everything seemed to be in place. I am trying to remove rows with duplicate headers and rows that are populated by zeros. Can anyone seem to find the problem with it?</p>\n\n<pre><code>    Sub RemoveHeaders()\nConst HdrTextOne As String = \"*Station*\"\nConst HdrTextTwo As String = \"*Export File For Future Analysis*\"\nConst HdrTextThree As String = \"*0*\"\nConst HdrKeepRowOne As Long = 3\nConst HdrKeepRowTwo As Long = 1\nConst HdrKeepRowThree As Long = 19\nDim c As Range\nDim lr As Long\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Sheets(\"Data\")\n\nApplication.ScreenUpdating = False\nlr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nWith Range(\"B\" &amp; HdrKeepRowOne &amp; \":B\" &amp; lr)\n    Set c = .Find(HdrTextOne, LookIn:=xlValues, SearchDirection:=xlNext)\n    If Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowOne Then\n        Do\n            c.Resize(5).EntireRow.Delete\n            Set c = .Find(HdrTextOne, LookIn:=xlValues, SearchDirection:=xlNext)\n        Loop While Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowOne\n    End If\nEnd With\n\n lr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nWith Range(\"B\" &amp; HdrKeepRowTwo &amp; \":B\" &amp; lr)\n    Set c = .Find(HdrTextTwo, LookIn:=xlValues, SearchDirection:=xlNext)\n    If Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowTwo Then\n        Do\n            c.Resize(5).EntireRow.Delete\n            Set c = .Find(HdrTextTwo, LookIn:=xlValues, SearchDirection:=xlNext)\n        Loop While Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowTwo\n    End If\nEnd With\n\n lr = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\nWith Range(\"D\" &amp; HdrKeepRowThree &amp; \":D\" &amp; lr)\n    Set c = .Find(HdrTextThree, LookIn:=xlValues, SearchDirection:=xlNext)\n    If Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowThree Then\n        Do\n            c.Resize(5).EntireRow.Delete\n            Set c = .Find(HdrTextThree, LookIn:=xlValues, SearchDirection:=xlNext)\n        Loop While Not c Is Nothing And c.Row &lt;&gt; HdrKeepRowThree\n    End If\nEnd With\nws.Columns(\"C:C\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5998083, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b82ea90540cf3c6828ebc2c234026cd8?s=128&d=identicon&r=PG&f=1", "display_name": "Laizy", "link": "https://stackoverflow.com/users/5998083/laizy"}, "edited": false, "score": 0, "creation_date": 1461155627, "post_id": 36743397, "comment_id": 61069038, "body": "The thing is if I store it as date it looks for the value 2016-03-31. This value does exist in my sheet but with another &quot;Swedish&quot; formating option. Therefore I would like to search for the value 42460 (which stands for 2016-03-31) instead and i therefore dim as long."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 43, "user_id": 5998083, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b82ea90540cf3c6828ebc2c234026cd8?s=128&d=identicon&r=PG&f=1", "display_name": "Laizy", "link": "https://stackoverflow.com/users/5998083/laizy"}, "edited": false, "score": 0, "creation_date": 1461156773, "post_id": 36743397, "comment_id": 61069934, "body": "Had a read of <a href=\"http://www.ozgrid.com/VBA/find-dates.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/find-dates.htm</a>.  Try changing <code>EndDate</code> to a string data type, update <code>EndDate=Worksheet...</code> to <code>EndDate = Format(WorksheetFunction.EoMonth(StartDate, -1), &quot;Short Date&quot;)</code> - change &quot;Short Date&quot; to the correct format.  Then in the FIND statement change <code>EndDate</code> to <code>CDATE(EndDate)</code>."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1461157724, "last_edit_date": 1461157724, "creation_date": 1461154311, "answer_id": 36743397, "question_id": 36742518, "link": "https://stackoverflow.com/questions/36742518/find-function-underlying-date-value/36743397#36743397", "title": "Find function, underlying date value", "body": "<p>If you set your <code>EndDate</code> variable as a <code>Date</code> rather than a <code>Long</code> it should work providing the value is on the active sheet.<br>\nIf it's not you'll still get the error 91. To avoid this set a variable to store the found date and check if it contains anything before activating.</p>\n\n<pre><code>Sub Last_Day_Of_the_Month()\n\n    Dim WrkMonths As Integer\n    Dim StartDate As Date\n    Dim EndDate As Date\n    Dim rFound As Range\n\n    StartDate = Now\n    EndDate = WorksheetFunction.EoMonth(StartDate, -1)\n\n    Set rFound = Cells.Find(What:=EndDate, After:=ActiveCell, LookIn:=xlValues, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False)\n\n    If Not rFound Is Nothing Then\n        rFound.Activate\n    End If\n\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5998083, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b82ea90540cf3c6828ebc2c234026cd8?s=128&d=identicon&r=PG&f=1", "display_name": "Laizy", "link": "https://stackoverflow.com/users/5998083/laizy"}, "is_accepted": false, "score": 1, "last_activity_date": 1461157085, "creation_date": 1461157085, "answer_id": 36744562, "question_id": 36742518, "link": "https://stackoverflow.com/questions/36742518/find-function-underlying-date-value/36744562#36744562", "title": "Find function, underlying date value", "body": "<p>Abit embarassing as I can swear this code didnt work before... But I solved my issue, here is the code I used if anyone else needs it. </p>\n\n<pre><code>Sub lastdayofthemonth()\n\n\n      Dim StartDate As Date\n      Dim EndDate As Date\n\n    StartDate = Now\n    EndDate = WorksheetFunction.EoMonth(StartDate, -1)\n\n\n    Cells.Find(What:=Format(EndDate, \"MMMM YYYY\"), After:=ActiveCell, LookIn:=xlValues, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Select\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5998083, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b82ea90540cf3c6828ebc2c234026cd8?s=128&d=identicon&r=PG&f=1", "display_name": "Laizy", "link": "https://stackoverflow.com/users/5998083/laizy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461157724, "creation_date": 1461151960, "question_id": 36742518, "link": "https://stackoverflow.com/questions/36742518/find-function-underlying-date-value", "title": "Find function, underlying date value", "body": "<p>So I have been stuck with an issue regarding finding lastmonth in my sheet.\u00b4The months in my sheet are made up of EOMONTH Formulas. Therefore I would like to find the underlying value for each month\u00b4so I can disregard formating issues.</p>\n\n<pre><code>Function Last_Day_Of_the_Month()\n\nDim WrkMonths As Integer\nDim StartDate As Date\nDim EndDate As Long\n\nStartDate = Now\nEndDate = WorksheetFunction.EoMonth(StartDate, -1)\n\n\nCells.Find(What:=EndDate, After:=ActiveCell, LookIn:=xlValues, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False).Activate\n\n\nEnd Function\n</code></pre>\n\n<p>This just returns the error 91 that it cannot find the value.\nAny help would be very much appreciated.</p>\n"}, {"tags": ["excel", "vbscript", "excel-2013", "powerquery", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461155069, "post_id": 36742155, "comment_id": 61068610, "body": "What account is the scheduled task running under?"}, {"owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461165922, "post_id": 36742155, "comment_id": 61077629, "body": "A dedicated user that we use for various other scheduled jobs. Any passwords required for SQL authorisation are saved in the workbook."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461166224, "post_id": 36742155, "comment_id": 61077864, "body": "Are you logging into the server as that user when testing the manual run?"}, {"owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461168496, "post_id": 36742155, "comment_id": 61079616, "body": "Yes, I&#39;ve also tried as 2 other users. It appears that as long as the VBscript is kicked off by a user logged on to the machine it will succeed. Just not using scheduled tasks."}, {"owner": {"reputation": 521, "user_id": 3656152, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1a87c3d2e77df2882dc9c5192bbf871f?s=128&d=identicon&r=PG&f=1", "display_name": "James Heffer", "link": "https://stackoverflow.com/users/3656152/james-heffer"}, "edited": false, "score": 0, "creation_date": 1469303611, "post_id": 36742155, "comment_id": 64483495, "body": "Well, my code to refresh a power query is as follows: dim con as workbookConnection, for each con in ActiveWorkbook.Queries If Left(con.name, 7) = &quot;Query -&quot; Then dim cname as string, cname = con.name, with activeworkbook.Connections(cname).OLEDBConnection .backgroundQuery = True, .Refresh end with, end if, next. Works for me (y)"}], "owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 627, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461151071, "creation_date": 1461151071, "last_edit_date": 1531161705, "question_id": 36742155, "link": "https://stackoverflow.com/questions/36742155/excel-2013-power-query-background-refresh-method-refresh-of-object-workbo", "title": "Excel 2013 - Power Query, Background refresh. Method &#39;Refresh&#39; of object &#39;WorkbookConnection&#39; failed", "body": "<p>I have a workbook which contains several Power Query queries (data source is SQL server) which I am trying to refresh via task scheduler on a remote server. I have a VBscript which opens an Excel file (Refresh Engine) which then refreshes the file containing the queries (Target File). It's structured in this way as each month the target file has it's name changed and a copy is archived as a historic log.</p>\n\n<p><strong>If I log on to the remote server and kick the VBscript off manually the code runs with no error.</strong> However, when the script is run via scheduled tasks the Refresh Engine fails with the error recorded as '-2147417848, Method 'Refresh' of object 'WorkbookConnection' failed'.</p>\n\n<p>I've tried changing numerous connection settings without any success. Can anybody help?</p>\n\n<p>The code I am using to refresh the queries within the target workbook is as follows. (Please note various variables have already been created and bound in previous subs).</p>\n\n<pre><code>On Error GoTo ErrLog\nFor Each Cn In CurStr.Connections\n    Log.WriteLine (Now() &amp; \" Looking at \" &amp; Cn.Name)\n    bg = Cn.OLEDBConnection.BackgroundQuery\n    Cn.OLEDBConnection.BackgroundQuery = False\n    Log.WriteLine (Now() &amp; \" Refreshing \" &amp; Cn.Name)\n    Cn.Refresh\n    Cn.OLEDBConnection.BackgroundQuery = bg\nNext\nLog.WriteLine (Now() &amp; \" Refreshing model\")\nCurStr.Model.Refresh\nOn Error GoTo 0\nExit Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "mismatch"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1461149955, "post_id": 36741596, "comment_id": 61064992, "body": "What types are the variables declared as? your sample values yield AVHS8 ==7.31540576925892 for me when doubles"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461150088, "post_id": 36741596, "comment_id": 61065097, "body": "Sounds like a <code>Dim</code> problem. None of the variables you have used are declared in your code. So, VBA makes a decision for you and declares the variables for you. OH (for example) is assigned 17 and might be declared as an <code>Integer</code>. Yet, Integer would not suffice to hold any of the intermediary results from the last calculation. Try to <code>Dim</code> all variables as <code>Double</code> (just to test this theory) and try again."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461150172, "post_id": 36741596, "comment_id": 61065154, "body": "@Ralph without explicit declarations, they are <code>Variant</code> types. The type of the <code>Variant</code> for <code>OH</code> will be VT_I4 initially but will become VT_R8 if it becomes fractional."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1461150377, "post_id": 36741596, "comment_id": 61065292, "body": "You serious about using 3.14 for pi?! You <i>must</i> be an engineer. Consider using <code>Application.WorksheetFunction.Pi()</code>"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461150797, "post_id": 36741596, "comment_id": 61065562, "body": "is (DTCP+BES)^2 larger thand RAD^2?  ie are you trying to take the sqr of a negative number?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461151320, "post_id": 36741596, "comment_id": 61065911, "body": "I just ran the most on this and you are not taking the sqr of a negative."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461151439, "post_id": 36741596, "comment_id": 61065986, "body": "I also believe there is a RADIANS and DEGREES function in VBA.  if not there is definitely one excel."}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461151278, "post_id": 36742061, "comment_id": 61065890, "body": "That is dang annoying, you can use -, /, *, etc. but as soon as you pop in the + it all goes to pot!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1461150802, "creation_date": 1461150802, "answer_id": 36742061, "question_id": 36741596, "link": "https://stackoverflow.com/questions/36741596/vba-error-13-type-missmatch-vba/36742061#36742061", "title": "vba error 13 type missmatch, VBA", "body": "<p>I assume those are controls on your form rather than variables, which would explain the problem. As controls, the contents are text and when you use <code>(DTCP + BES)</code> that is actually returning <code>7.52.5</code> rather than 10, because <code>+</code> will also work as a concatenation operator. Change the last line to:</p>\n\n<pre><code>AVHS8 = (Sqr(RAD ^ 2 - (CDbl(DTCP) + CDbl(BES)) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES * 6))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9035677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ebb439ebc559c8b2c47c986a86ee60?s=128&d=identicon&r=PG&f=1", "display_name": "SiKi", "link": "https://stackoverflow.com/users/9035677/siki"}, "is_accepted": false, "score": 0, "last_activity_date": 1512070747, "creation_date": 1512070747, "answer_id": 47581356, "question_id": 36741596, "link": "https://stackoverflow.com/questions/36741596/vba-error-13-type-missmatch-vba/47581356#47581356", "title": "vba error 13 type missmatch, VBA", "body": "<pre><code>Sub Leverage()\n\nDim i As Long\nDim counter_less As Long\nDim count_pos As Long\n\nDim row_count As Long\nDim num As Variant\n\nnum = InputBox(\"Enter threshold\")\n\n\nrow_count = Cells(1, 1).CurrentRegion.Rows.Count - 2\n\ncounter_pos = 0\ncounter_less = 0\n\nFor i = 1 To row_count\n\nIf Abs(Cells(i + 2, 3)) &gt; num And Cells(i + 3, 3) &lt;&gt; \"\" Then\n\ncounter_less = counter_less + 1\n        If Cells(i + 3, 3) &lt; 0 And i Then\n            counter_pos = counter_pos + 1\n   End If\n   End If\n   Next\ncounter_pos = counter_pos / (counter_less)\ncounter_less = counter_less / row_count\nMsgBox counter_pos &amp; \" %\"`enter code here`\nEnd Sub\n\nI get error 6: Overflow. Anyone has any suggestions?\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6229702, "user_type": "registered", "profile_image": "https://graph.facebook.com/1093213284035500/picture?type=large", "display_name": "Rory Joyce", "link": "https://stackoverflow.com/users/6229702/rory-joyce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 36742061, "answer_count": 2, "score": -1, "last_activity_date": 1512070747, "creation_date": 1461149674, "last_edit_date": 1461149858, "question_id": 36741596, "link": "https://stackoverflow.com/questions/36741596/vba-error-13-type-missmatch-vba", "title": "vba error 13 type missmatch, VBA", "body": "<p>New to using VBA and know little about it. Using it for an Engineering project to solve deep seated slope stability problems. When entering in the first 7 calculations VBA solves these correctly in a user form. But when I try to calculate the 8th formula (AVHS8) it gives me an error, witch is run time error \"13\" type mismatch. I am unsure what the problem is, the formulas work in excel perfectly. if anyone could help it would be much appreciated. The problem is below.</p>\n\n<p>BES = 2.5 RAD = 18.58 DTCP = 7.5 and OH =17, these are just numbers that are set and do not change</p>\n\n<pre><code>Private Sub Calculate_Click()\nRAD = Sqr(DTCP ^ 2 + OH ^ 2)\nBES = DTCP / 3\nAVHS1 = (0)\nAVHS2 = (Sqr(RAD ^ 2 - (DTCP - BES) ^ 2) - OH)\nAVHS3 = (Sqr(RAD ^ 2 - (DTCP - BES - BES) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES))\nAVHS4 = (Sqr(RAD ^ 2 - (DTCP - BES - BES - BES) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES * 2))\nAVHS5 = (Sqr(RAD ^ 2 - (DTCP - BES - BES) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES * 3))\nAVHS6 = (Sqr(RAD ^ 2 - (DTCP - BES) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES * 4))\nAVHS7 = (Sqr(RAD ^ 2 - (DTCP) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES * 5))\n'VBA can solve all the above code. it cant solve the code below (AVHS8)\nAVHS8 = (Sqr(RAD ^ 2 - (DTCP + BES) ^ 2) - (OH) + (Tan(30 * 3.14 / 180) * BES * 6))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461149929, "post_id": 36740803, "comment_id": 61064968, "body": "What do you mean? Copy it to a VBA array rather than a spreadsheet range? You can&#39;t do that directly, but it is easy enough to copy it to a spreadsheet range and then from the range to a VBA array -- deleting the values in the range afterwards."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1461151291, "creation_date": 1461151291, "answer_id": 36742241, "question_id": 36740803, "link": "https://stackoverflow.com/questions/36740803/create-an-array-from-unique-values-from-column/36742241#36742241", "title": "Create an array from unique values from column", "body": "<p>If you want to cut out the range middleman, you can get the values directly into a 1-dimensional VBA array by using a dictionary to make sure that only unique values are grabbed:</p>\n\n<pre><code>Function UniqueVals(Col As Variant, Optional SheetName As String = \"\") As Variant\n    'Return a 1-based array of the unique values in column Col\n\n    Dim D As Variant, A As Variant, v As Variant\n    Dim i As Long, n As Long, k As Long\n    Dim ws As Worksheet\n\n    If Len(SheetName) = 0 Then\n        Set ws = ActiveSheet\n    Else\n        Set ws = Sheets(SheetName)\n    End If\n\n    n = ws.Cells(Rows.Count, Col).End(xlUp).Row\n    ReDim A(1 To n)\n    Set D = CreateObject(\"Scripting.Dictionary\")\n\n    For i = 1 To n\n        v = ws.Cells(i, Col).Value\n        If Not D.Exists(v) Then\n            D.Add v, 0\n            k = k + 1\n            A(k) = k\n        End If\n    Next i\n\n    ReDim Preserve A(1 To k)\n    UniqueVals = A\n\nEnd Function\n</code></pre>\n\n<p>For example, <code>UniqueVals(\"E\",sheetName)</code> will return an array consisting of the unique values in column E of sheetName.</p>\n"}, {"tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": false, "score": 0, "last_activity_date": 1461173306, "last_edit_date": 1461173306, "creation_date": 1461154184, "answer_id": 36743348, "question_id": 36740803, "link": "https://stackoverflow.com/questions/36740803/create-an-array-from-unique-values-from-column/36743348#36743348", "title": "Create an array from unique values from column", "body": "<p>Another version, also using a dictionary. It works for me, but I must admit that still don't know how it works (I'm a beginner). I found this code somewhere in Stackoverflow, but can't spot the place.</p>\n\n<pre><code>Dim dU1 As Object, cU1 As Variant, iU1 As Long, lrU As Long\nDim i As Integer\n\nPrivate Sub Go_Click()\n    Set dU1 = CreateObject(\"Scripting.Dictionary\")\n    lrU = Cells(Rows.Count, 1).End(xlUp).Row\n    cU1 = Range(\"E1:E\" &amp; lrU)\n    For iU1 = 1 To UBound(cU1, 1)\n        dU1(cU1(iU1, 1)) = 1\n    Next iU1\n\n    For i = 0 To dU1.Count - 1\n        MsgBox \"dU1 has \" &amp; dU1.Count &amp; \" elements and key#\" &amp; i &amp; \" is \" &amp; dU1.Keys()(i)\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1461168953, "creation_date": 1461168953, "answer_id": 36749603, "question_id": 36740803, "link": "https://stackoverflow.com/questions/36740803/create-an-array-from-unique-values-from-column/36749603#36749603", "title": "Create an array from unique values from column", "body": "<p>Here's another method using VBA's Collection object instead of a dictionary.</p>\n\n<pre><code>Sub Dural()\n    Dim sheetName As String\n    Dim V As Variant, COL As Collection\n    Dim I As Long\n    Dim vUniques() As Variant\n\nsheetName = Application.InputBox(\"Enter Sheet Name\")\n\n'Copy all data into variant array\n'  This will execute significantly faster than reading directly\n'  from the Worksheet range\n\nWith Worksheets(sheetName)\n    V = .Range(.Cells(1, \"E\"), .Cells(.Rows.Count, \"E\").End(xlUp))\nEnd With\n\n'Collect unique values\n'Use the key property of the collection object to\n'  ensure no duplicates are collected\n'  (Trying to assign the same key to two items fails with an error\n'  which we ignore)\nSet COL = New Collection\nOn Error Resume Next\nFor I = 1 To UBound(V, 1)\n    COL.Add Item:=V(I, 1), Key:=CStr(V(I, 1))\nNext I\nOn Error GoTo 0\n\n'write collection to variant array\nReDim vUniques(1 To COL.Count)\nFor I = 1 To COL.Count\n    vUniques(I) = COL(I)\nNext I\n\nStop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3571, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1461173306, "creation_date": 1461147646, "last_edit_date": 1531161705, "question_id": 36740803, "link": "https://stackoverflow.com/questions/36740803/create-an-array-from-unique-values-from-column", "title": "Create an array from unique values from column", "body": "<p>I found this code in this forumn. I want to copy this unique values into an array</p>\n\n<pre><code>Dim sheetName As String\nsheetName = Application.InputBox(\"Enter Sheet Name\")\n\nSheets(sheetName).Range(\"E:E\").AdvancedFilter Action:=xlFilterCopy, _\nCopyToRange:=Sheets(sheetName).Range(\"O:O\"), unique:=True\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "office-2016"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1461180060, "post_id": 36740772, "comment_id": 61086691, "body": "It appears that the object model does not honor that setting. My recommendation would be to format the first paragraph with &quot;Page break before&quot; paragraph formatting, and include a PageBreak at the end of the entry. Select all that, including the page break and re-create the Building Block."}, {"owner": {"reputation": 27, "user_id": 4086219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/aff70475dcfdb836675b56a35fe9e589?s=128&d=identicon&r=PG&f=1", "display_name": "Test User", "link": "https://stackoverflow.com/users/4086219/test-user"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461764746, "post_id": 36740772, "comment_id": 61347691, "body": "If you post your comment as an answer I will accept it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461778349, "post_id": 36740772, "comment_id": 61358008, "body": "Done :-) Thank you for checking back."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1461778330, "creation_date": 1461778330, "answer_id": 36896929, "question_id": 36740772, "link": "https://stackoverflow.com/questions/36740772/ms-word-building-block-not-inserted-in-its-own-page/36896929#36896929", "title": "MS Word building block not inserted in its own page", "body": "<p>It appears that the object model does not honor that setting. Apparently, only inserting the Building Block from the UI will trigger it. </p>\n\n<p>My recommendation would be to:</p>\n\n<ol>\n<li><p>Format the first paragraph of the Buidling Block entry with \"Page\nbreak before\" paragraph formatting.</p></li>\n<li><p>Then include a PageBreak (Ctrl+Enter) at the end of the entry. </p></li>\n<li><p>Select it, including the page break and re-create the Building\nBlock.</p></li>\n</ol>\n\n<p>In this way, the entire entry will always appear on a separate page from the rest of the text in the document.</p>\n"}], "owner": {"reputation": 27, "user_id": 4086219, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/aff70475dcfdb836675b56a35fe9e589?s=128&d=identicon&r=PG&f=1", "display_name": "Test User", "link": "https://stackoverflow.com/users/4086219/test-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 36896929, "answer_count": 1, "score": 0, "last_activity_date": 1461778330, "creation_date": 1461147542, "question_id": 36740772, "link": "https://stackoverflow.com/questions/36740772/ms-word-building-block-not-inserted-in-its-own-page", "title": "MS Word building block not inserted in its own page", "body": "<p>I defined a building block (QuickPart) to \"Insert in its own page\". I insert it in code (C# Word Interop) like this:</p>\n\n<pre><code>range =\n    _doc.get_AttachedTemplate()\n        .BuildingBlockEntries[blockName]\n        .Insert(Where: _selection.Range, RichText: true);\n</code></pre>\n\n<p>_doc is _word.Documents.Add(...), _selection is _doc.ActiveWindow.Selection (nothing is selected) and _word is the Application object.</p>\n\n<p>Based on the definition of the building block, I expect a page break to be automatically inserted before the building block but that is not happening. How do I make BuildingBlock.Insert honor the building block definition?</p>\n"}, {"tags": ["vba", "outlook", "outlook-2016"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1461148074, "post_id": 36740713, "comment_id": 61063805, "body": "What <i>is</i> the error?"}, {"owner": {"reputation": 27, "user_id": 1886216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05527eaa74006d1a3e34aea68c33c761?s=128&d=identicon&r=PG", "display_name": "user1886216", "link": "https://stackoverflow.com/users/1886216/user1886216"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1461162179, "post_id": 36740713, "comment_id": 61074632, "body": "Error: -2146664191 (800c8101) According to the help this error has something to to wit the OlkCategory.BackColor Property, Which seems nonsense to me."}, {"owner": {"reputation": 27, "user_id": 1886216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05527eaa74006d1a3e34aea68c33c761?s=128&d=identicon&r=PG", "display_name": "user1886216", "link": "https://stackoverflow.com/users/1886216/user1886216"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1461162942, "post_id": 36740713, "comment_id": 61075244, "body": "The rule itself doesn&#39;t seem to be relevant. If I leave out the execution the error pops up. I set Outlook to perform macro&#39;s without any restrictions."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7466622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8392934fd8907abf5294920ee80c6941?s=128&d=identicon&r=PG&f=1", "display_name": "J. Farro", "link": "https://stackoverflow.com/users/7466622/j-farro"}, "is_accepted": false, "score": 0, "last_activity_date": 1485457489, "creation_date": 1485457489, "answer_id": 41881013, "question_id": 36740713, "link": "https://stackoverflow.com/questions/36740713/outlook-2016-old-vba-code-to-fire-rules-wont-run/41881013#41881013", "title": "Outlook 2016 - old vba code to fire rules won&#39;t run", "body": "<p>Check in the rules wizard if some of the rules are marked 'From other computer'.\nIf you have any like this, then the code will break at the line:</p>\n\n<pre><code>For Each currentRule In rules\n</code></pre>\n\n<p>I have the same issue now - took me a lot of troubleshooting to figure this out. One more thing that could be an issue: if any of the rules are broken, for example refer to a directory that does not exist, the rules object will not contain any rules.</p>\n\n<p>If troubleshooting the above, remove all the suspicious rules and start adding them one by one back.</p>\n"}], "owner": {"reputation": 27, "user_id": 1886216, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/05527eaa74006d1a3e34aea68c33c761?s=128&d=identicon&r=PG", "display_name": "user1886216", "link": "https://stackoverflow.com/users/1886216/user1886216"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 825, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325525, "creation_date": 1461147392, "last_edit_date": 1593325525, "question_id": 36740713, "link": "https://stackoverflow.com/questions/36740713/outlook-2016-old-vba-code-to-fire-rules-wont-run", "title": "Outlook 2016 - old vba code to fire rules won&#39;t run", "body": "<p>Why is this code to run all enabled rules does not run in outlook-2016?\nI used it without any problem on outlook 2007, 2010 and 2013, but it is not working in outlook 2016.</p>\n\n<pre><code>Sub OrginalRunActiveCatInboxRules()\n\nDim Session As Outlook.NameSpace\nDim Report As String\nDim currentItem As Object\nDim currentRule As Outlook.Rule\nDim rules As Outlook.rules\nDim ruleList As String\nSet Session = Application.Session\n\nSet rules = Session.DefaultStore.GetRules()\n\nFor Each currentRule In rules\n\n   If currentRule.RuleType = olRuleReceive Then         \n'determine if it\u2019s an Inbox rule, if so, run it\n       If currentRule.Enabled Then\n           If Left(currentRule.name, 4) = \"Cat.\" Then\n               MsgBox currentRule.name\n               currentRule.Execute ShowProgress:=True   \n' Sortering niet laten zien\n'               ruleList = ruleList &amp; vbCrLf &amp; currentRule.Name\n           End If\n       End If\n   End If\n Next\n\n\n' tell the user what you did\n' ruleList = \"These rules were executed against the Inbox: \" &amp; vbCrLf &amp; ruleList\n' MsgBox ruleList, vbInformation, \"Macro: RunAllActiveInboxRules\"\nSet rules = Nothing\nSet currentRule = Nothing\nEnd Sub\n</code></pre>\n\n<p>The codes runs until next, but gives a error there. It does not matter if the first rule is enabled or not, starts with Cat. or not. It just won't go to the next item in the loop, but generates a error.</p>\n\n<p>What can I do to make the code working again?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "edited": false, "score": 2, "creation_date": 1461146000, "post_id": 36740000, "comment_id": 61062262, "body": "What code have you tried by yourself? Have you tried the ISNA function? In VBA: <code>Application.WorksheetFunction.IsNA(value)</code>"}, {"owner": {"reputation": 17, "user_id": 6133960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59dc2150da8dfc2ef01dfe4cd4d9a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Lakssman", "link": "https://stackoverflow.com/users/6133960/lakssman"}, "reply_to_user": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "edited": false, "score": 0, "creation_date": 1461146103, "post_id": 36740000, "comment_id": 61062340, "body": "No.. How to use that ? I was trying to get this as string and search in the usedrange which dint work"}, {"owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "edited": false, "score": 0, "creation_date": 1461146274, "post_id": 36740000, "comment_id": 61062456, "body": "You can loop trough your cells, and check for every cell value if the upper statement is true. When it&#39;s true, save the column you want. After you&#39;ve had all records, you can print the text file."}, {"owner": {"reputation": 17, "user_id": 6133960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59dc2150da8dfc2ef01dfe4cd4d9a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Lakssman", "link": "https://stackoverflow.com/users/6133960/lakssman"}, "reply_to_user": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "edited": false, "score": 0, "creation_date": 1461149152, "post_id": 36740000, "comment_id": 61064502, "body": "I am New to VB, Wouter.. could you please provide me a sample code for it.."}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1461151301, "creation_date": 1461151301, "answer_id": 36742249, "question_id": 36740000, "link": "https://stackoverflow.com/questions/36740000/vba-code-to-find-cells-containing-n-a-in-column-b-and-copy-the-corresponding/36742249#36742249", "title": "VBA code to find cells containing &quot;#N/A&quot; in column B and copy the corresponding cell value in column A to a Text file", "body": "<p>Try this:</p>\n\n<pre><code>Sub ToTextFile()\n    Dim LastRow As Long, i As Long\n    Dim str As String, strFile_Path As String\n    Dim strTxt As Variant\n\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To LastRow\n        If (Application.WorksheetFunction.IsNA(Cells(i, 2).Value)) Then\n            If str = \"\" Then\n                str = Cells(i, 1).Value\n            Else\n                str = str &amp; \",\" &amp; Cells(i, 1).Value\n            End If\n        End If\n    Next i\n\n    strTxt = Split(str, \",\")\n\n    strFile_Path = \"C:\\temp\\test.txt\" 'Change to your file path\n    Open strFile_Path For Output As #1\n\n    For i = 0 To UBound(strTxt)\n        Print #1, strTxt(i)\n    Next i\n    Close #1\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1461152016, "creation_date": 1461152016, "answer_id": 36742537, "question_id": 36740000, "link": "https://stackoverflow.com/questions/36740000/vba-code-to-find-cells-containing-n-a-in-column-b-and-copy-the-corresponding/36742537#36742537", "title": "VBA code to find cells containing &quot;#N/A&quot; in column B and copy the corresponding cell value in column A to a Text file", "body": "<p>Add a new column C with each cell having the array formula (hit ctrl+enter after pasting):</p>\n\n<pre><code>=IF(ISNA(B:B),A:A,\"\")\n</code></pre>\n\n<p>Then the body of your text file can be the following string</p>\n\n<pre><code>Debug.Print Join$(Application.Transpose( _\n    Application.Index(Worksheets(\"Sheet1\").UsedRange, 0, 3)), vbNewLine)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6133960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59dc2150da8dfc2ef01dfe4cd4d9a5a?s=128&d=identicon&r=PG&f=1", "display_name": "Lakssman", "link": "https://stackoverflow.com/users/6133960/lakssman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2950, "favorite_count": 0, "closed_date": 1461166613, "accepted_answer_id": 36742249, "answer_count": 2, "score": 0, "last_activity_date": 1461152016, "creation_date": 1461145774, "last_edit_date": 1461149394, "question_id": 36740000, "link": "https://stackoverflow.com/questions/36740000/vba-code-to-find-cells-containing-n-a-in-column-b-and-copy-the-corresponding", "closed_reason": "Needs more focus", "title": "VBA code to find cells containing &quot;#N/A&quot; in column B and copy the corresponding cell value in column A to a Text file", "body": "<p>My requirement was to vlookup for data in 2 workbooks using vba. Now in the output of vlookup there are cells which did not match and hence their value is \"#N/A\"</p>\n\n<p>Now how to select corresponding Column A values if \"#N/A\" is present in Column B and write them to a Text file.</p>\n\n<p>Example excel file</p>\n\n<pre><code>Column A    Column B\nA           1\nB           #N/A\nC           3\nD           4\nE           #N/A\n</code></pre>\n\n<p>The following output should be written in a Text file.</p>\n\n<pre><code>B\nD\n</code></pre>\n\n<p>Please help me in arriving at this though VBA. TIA</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461146478, "post_id": 36739786, "comment_id": 61062630, "body": "It would be simpler to query the data you want from your database, prepend the 100 in the query and then just drop the results straight into Excel."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461151553, "post_id": 36739786, "comment_id": 61066058, "body": "Maybe, I haven&#39;t tried this, but now I have this and wish to solve It."}], "answers": [{"comments": [{"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1461147370, "post_id": 36740340, "comment_id": 61063276, "body": "Thanks Andre, I changed everything and It works. What about If want to add this in end of rows - this doesn&#39;t work for me : For Each cell In sh.Cells(sh.Rows.Count, &quot;A&quot;).End(xlUp).Row"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1461146545, "creation_date": 1461146545, "answer_id": 36740340, "question_id": 36739786, "link": "https://stackoverflow.com/questions/36739786/access-vba-add-number-to-cell-in-excel/36740340#36740340", "title": "Access VBA - Add number to cell in Excel", "body": "<pre><code>For Each cell In XcelFile.Range(\"A:A\")\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Dim sh As Excel.Worksheet\nSet sh = wb.ActiveSheet\nFor Each cell In sh.Range(\"A:A\")\n</code></pre>\n\n<p>me thinks. </p>\n\n<p>This applies for all other places where you have <code>XcelFile.Cells</code> now, change them to <code>sh.Cells</code>.</p>\n\n<p>Note:</p>\n\n<pre><code>Dim XcelFile As Excel.Application\n</code></pre>\n\n<p>is a really really confusing name, IMHO.</p>\n"}], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 36740340, "answer_count": 1, "score": 0, "last_activity_date": 1594642241, "creation_date": 1461145256, "last_edit_date": 1594642241, "question_id": 36739786, "link": "https://stackoverflow.com/questions/36739786/access-vba-add-number-to-cell-in-excel", "title": "Access VBA - Add number to cell in Excel", "body": "<p>I'm exporting to Excel and I need to insert numbers in front of cells that allready have numbers in It. Here is my full code:</p>\n\n<pre><code>Private Sub cmdExport_Click()\n\nDim Results  As Recordset\nDim Numbering  As Integer\n\nDim FileName As String\nDim FilePath As String\n\nDim wb As Excel.Workbook\nDim XcelFile As Excel.Application\n\nFileName = \"TEST\" &amp; Format(Date, \"dd/mm/yyyy\") &amp; \".xlsx\"\n\nFilePath = CurrentProject.Path &amp; \"\\\" &amp; FileName\n\n Set XcelFile = New Excel.Application\n\n Set wb = XcelFile.Workbooks.Add\n\n Set Results  = Forms![MyForm].Form.RecordsetClone\n\n   With wb\n\n      XcelFile.ScreenUpdating = False\n\n      For Numbering = 0 To Results.Fields.Count - 1\n      XcelFile.Cells(1, Numbering + 1).Value = Results.Fields(Numbering).Name\n      Next Numbering\n\n      Results.MoveFirst\n      XcelFile.Range(\"A2\").CopyFromRecordset Results\n\n     For Each cell In XcelFile.Range(\"A:A\")\n     cell.Value = \"100\" &amp; cell.Value\n     Next cell\n\n      .SaveAs FileName:=FilePath, FileFormat:=51\n      XcelFile.ScreenUpdating = True\n\n   End With\n\n  wb.Close\n  Set XcelFile = Nothing\n\n  End Sub\n</code></pre>\n\n<p>As you see, I have tried with this:</p>\n\n<pre><code>For Each cell In XcelFile.Range(\"A:A\")\n         cell.Value = \"100\" &amp; cell.Value\n         Next cell\n</code></pre>\n\n<p>But, unfortunally, nothing happens. How could I solve this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461145739, "post_id": 36739648, "comment_id": 61062074, "body": "&quot;Change the end value&quot;...not sure what you mean, are you trying to add 2 to the value of a cell in a specific column?  Are you trying to add 2 to the end of a string (word)?"}, {"owner": {"reputation": 81, "user_id": 6209219, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0ba54a7b9001ebe2491b6ee511ba3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/6209219/antony"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461149755, "post_id": 36739648, "comment_id": 61064870, "body": "Apologies for the ambiguity. I am trying to add 2 to the value of a cell in a specific column.  Also would like to thank everyone who has posted - although I can only accept one answer, all responses have really helped me to further my understanding of VBA. Many thanks."}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 1, "last_activity_date": 1461149452, "last_edit_date": 1461149452, "creation_date": 1461146005, "answer_id": 36740089, "question_id": 36739648, "link": "https://stackoverflow.com/questions/36739648/if-column-a-contains-x-and-column-b-contains-y-then-add-value/36740089#36740089", "title": "If column A contains x AND column B contains y THEN add value", "body": "<p>EDIT: It turns out I misread your question. See revised code.</p>\n\n<pre><code>Sub BUBFindGuests()\n\n    Dim SrchRng As Range\n    lastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    Set SrchRng = Range(\"D1:D\" &amp; lastRow, \"AG1:AG\" &amp; lastRow)\n    For Each cel In SrchRng\n\n        If InStr(1, cel.Value, \"(2)\") &gt; 0 And InStr(1, cel.Value, \"Adult\") &gt; 0 Then cel.Offset(-1, 39).Value = .Offset(-1, 0).Value &amp; \"5\"\n\n    Next cel\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 2, "creation_date": 1461147122, "post_id": 36740179, "comment_id": 61063085, "body": "While I was working out the kinks to my code just like this on &quot;sheet4&quot;, I got stung and would suggest you change you definition of your last row to <code>lastrow=Sheets(&quot;SHEETNAME&quot;).Range(&quot;D&quot; &amp; Rows.Count).End(xlUp).Row</code>  Alternatively you could wrap all that code in a With statement."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1461149765, "post_id": 36740179, "comment_id": 61064874, "body": "FWIW, I think <code>Cells(x, &quot;AG&quot;)</code> is a lot easier to debug than <code>Cells(x, 33)</code> ;-)"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1461156629, "post_id": 36740179, "comment_id": 61069800, "body": "That&#39;s true, thanks. I only ever use R1C1 formats so was just force of habit"}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": true, "score": 3, "last_activity_date": 1461147180, "last_edit_date": 1461147180, "creation_date": 1461146181, "answer_id": 36740179, "question_id": 36739648, "link": "https://stackoverflow.com/questions/36739648/if-column-a-contains-x-and-column-b-contains-y-then-add-value/36740179#36740179", "title": "If column A contains x AND column B contains y THEN add value", "body": "<p>Judging by your code, you want to <em>add</em> 2 to column C, if that's the case this should do the trick:</p>\n\n<pre><code>Sub BUBFindGuests()\n\nlastRow = Sheets(\"SHEETNAME\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nFor x = 1 to lastRow\n  If InStr(1, Sheets(\"SHEETNAME\").Cells(x, 4), \"(2)\") &lt;&gt; 0 _ 'Checks column D\n  And Instr(1, Sheets(\"SHEETNAME\").Cells(x, 33), \"Adult\") &lt;&gt; 0 Then 'Checks column AG\n    Sheets(\"SHEETNAME\").Cells(x, 3).Value = _\n    Sheets(\"SHEETNAME\").Cells(x, 3).Value + 2 'Change 3 to the appropriate column \n  End If\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 513, "user_id": 5779175, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c3fbdb68c4506f159deddfebb998f852?s=128&d=identicon&r=PG&f=1", "display_name": "selmaohneh", "link": "https://stackoverflow.com/users/5779175/selmaohneh"}, "is_accepted": false, "score": 2, "last_activity_date": 1461146357, "creation_date": 1461146357, "answer_id": 36740253, "question_id": 36739648, "link": "https://stackoverflow.com/questions/36739648/if-column-a-contains-x-and-column-b-contains-y-then-add-value/36740253#36740253", "title": "If column A contains x AND column B contains y THEN add value", "body": "<p>You can search for <strong>Adult</strong> just as you searched for the <strong>(2)</strong>. Just use the InStr-function two times and combine the result-booleans. You can do that in two ways, logical with <strong>And</strong> or nested with two if-statements:</p>\n\n<ul>\n<li><code>If InStrResult1 **And** InStrResult2 Then 'do stuff End If</code> </li>\n<li><code>If InStrResult1 Then If InStrResult2 Then 'do stuff End If End If</code></li>\n</ul>\n\n<p>Sorry for the bad formation.</p>\n\n<p>You can then store the current value of your cell in a variable. Then add 2 to that variable (<code>myVariable = myVariable + 2</code>) and then set its value to your cell instead of 5.</p>\n"}], "owner": {"reputation": 81, "user_id": 6209219, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0ba54a7b9001ebe2491b6ee511ba3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/6209219/antony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 36740179, "answer_count": 3, "score": 2, "last_activity_date": 1526286944, "creation_date": 1461144968, "last_edit_date": 1526286944, "question_id": 36739648, "link": "https://stackoverflow.com/questions/36739648/if-column-a-contains-x-and-column-b-contains-y-then-add-value", "title": "If column A contains x AND column B contains y THEN add value", "body": "<p>I'm very new to macros (it's been a few days now!) but slowly working my way through. I'd like to create a macro that <em>adds</em> a value of 2 to a cell if column D contains the text \"(2)\" AND column AG contains the text \"Adult\". </p>\n\n<p>I've created a macro that so far changes the value of the cell to 5 (instead of adding to it) if column D contains the text \"(2)\" - I've spent a while messing around with \"And\" functions but I can't seem to find a way to make it take into account the both the \"(2)\" text in the D column <em>and</em> the \"Adult\" text in the AG column (I can only make it search one or the other).</p>\n\n<p>Here's my attempt (this doesn't include any of my failed attempts to include the \"Adult\" text):</p>\n\n<pre><code>Sub BUBFindGuests()\n    Dim SrchRng As Range\n    lastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    Set SrchRng = Range(\"D1:D\" &amp; lastRow, \"AG1:AG\" &amp; lastRow)\n    For Each cel In SrchRng\n        If InStr(1, cel.Value, \"(2)\") &gt; 0 Then\n            With cel.Offset(0, 39)\n                .Offset(-1, 0) = \"5\"\n            End With\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>I'm basically just trying to work out how to include the \"Adult\" text from the AG column, and also how to make the macro <em>add</em> rather than <em>change</em> the end value. I'm also relatively certain that some parts of my code are unnecessary or clunky, but with my level of experience I'm unsure of how to correct that. Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "edited": false, "score": 0, "creation_date": 1461140891, "post_id": 36737874, "comment_id": 61058403, "body": "Do you want to loop only through a particular column? If yes, then set the <code>rngTar</code> to only include that last column, for example <code>Set rngTar = wsMain.Range(wsMain.Cells(1, 1), wsMain.Cells(lRow, 1))</code> for column 1"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1461141431, "post_id": 36737874, "comment_id": 61058771, "body": "Try to look here <a href=\"http://stackoverflow.com/questions/33249555/excel-vba-loop-through-visible-filtered-rows\" title=\"excel vba loop through visible filtered rows\">stackoverflow.com/questions/33249555/&hellip;</a>"}, {"owner": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "edited": false, "score": 0, "creation_date": 1461142331, "post_id": 36737874, "comment_id": 61059422, "body": "After changing he scope of range my purpose is solve. <i><b>wsMain.Cells(1, 16), wsMain.Cells(lRow, 16)</b></i> Thnx."}], "owner": {"reputation": 125, "user_id": 5949625, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/7dd583d682204fc44525b21572b4832a?s=128&d=identicon&r=PG", "display_name": "curious K", "link": "https://stackoverflow.com/users/5949625/curious-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461140528, "creation_date": 1461140528, "last_edit_date": 1531161705, "question_id": 36737874, "link": "https://stackoverflow.com/questions/36737874/loop-through-filter-records", "title": "Loop through filter records", "body": "<p>I want to loop through filter rows but loop go through all columns and then move to next row. </p>\n\n<pre><code>Dim wsMain As Worksheet\nDim rngTar As Range\nDim lRow, lCol As Integer\n\nSet wsMain = ThisWorkbook.Sheets(\"Datewise\")\n\nlRow = wsMain.Cells(Rows.Count, 1).End(xlUp).Row\nlCol = wsMain.Cells(1, Columns.Count).End(xlToLeft).Column\n\nSet rngTar = wsMain.Range(wsMain.Cells(1, 1), wsMain.Cells(lRow, lCol))\n\nwsMain.AutoFilterMode = False\nrngTar.AutoFilter Field:=16, Criteria1:=\"=KEEP\"\n\nFor Each rng In rngTar.SpecialCells(xlCellTypeVisible)\n    MsgBox wsMain.Range(\"Q\" &amp; rng.Row).Value, , wsMain.Range(\"R\" &amp; rng.Row).Value\nNext rng\n</code></pre>\n\n<p>If I have 18 columns then above loop will move next row after 18 times loop in for next</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461179798, "post_id": 36737670, "comment_id": 61086511, "body": "Have you tried selecting the string then using Word&#39;s Find capability to search an ampersand? That will select the ampersand. Then press right-arrow to move the selection to after the ampersand. Record that in a macro, once you can do it in the UI and that will give you the code to select the ampersand in the selected string."}], "answers": [{"tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": true, "score": 1, "last_activity_date": 1461262023, "creation_date": 1461262023, "answer_id": 36777268, "question_id": 36737670, "link": "https://stackoverflow.com/questions/36737670/how-can-i-move-the-cursor-to-a-postion-where-i-want-in-office-word-by-vb/36777268#36777268", "title": "How can I move the cursor to a postion where I want in office word by vb?", "body": "<p>If you are outputting using <code>Selection.TypeText</code>, you can use </p>\n\n<pre><code>Selection.MoveStartUntil \"&amp;\", wdBackward\nSelection.MoveLeft 1\n</code></pre>\n\n<p>which will move you backwards until the first occurrence of the ampersand.</p>\n\n<p>You can also do as Cindy Meister mentioned, do a <code>Selection.Find</code> similar to... </p>\n\n<pre><code>With Selection.Find\n    .MatchWildCards = false\n    .Text = \"&amp;\"\n    .Execute\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5932926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4554d2cfc1363731f910e585b76fe59?s=128&d=identicon&r=PG&f=1", "display_name": "vern", "link": "https://stackoverflow.com/users/5932926/vern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6608, "favorite_count": 0, "accepted_answer_id": 36777268, "answer_count": 1, "score": 1, "last_activity_date": 1461262023, "creation_date": 1461139900, "last_edit_date": 1461148699, "question_id": 36737670, "link": "https://stackoverflow.com/questions/36737670/how-can-i-move-the-cursor-to-a-postion-where-i-want-in-office-word-by-vb", "title": "How can I move the cursor to a postion where I want in office word by vb?", "body": "<blockquote>\n  <p>12345qwesdfasdf22232  &amp; 021930</p>\n</blockquote>\n\n<p>Like the string above, I want to move the cursor to the position after the character <code>&amp;</code> by searching the character in the string. How can I achieve it when I using visual basic to control the word?</p>\n\n<pre><code>Option Explicit\n\nDim WordApp As Word.Application   \n\nPrivate Sub Command2_Click()\n    Set WordApp = New Word.Application\n\n    WordApp.Documents.Open CommonDialog1.FileName     \n    WordApp.Visible = True \n    WordApp.DisplayAlerts = False\n    ...\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1461141350, "post_id": 36737669, "comment_id": 61058708, "body": "does not work. the string does not come from a cell..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1461140657, "creation_date": 1461140657, "answer_id": 36737919, "question_id": 36737669, "link": "https://stackoverflow.com/questions/36737669/vba-strcomp-type-mismatch-or-subscript-out-of-range/36737919#36737919", "title": "VBA - StrComp type mismatch or subscript out of range", "body": "<pre><code>Function IsIn1dArray(stringToBeFound As String, arr As Variant) As Long\n\n    IsIn1dArray = Application.WorksheetFunction.Match(stringToBeFound, arr, 0)\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1461140759, "creation_date": 1461140759, "answer_id": 36737964, "question_id": 36737669, "link": "https://stackoverflow.com/questions/36737669/vba-strcomp-type-mismatch-or-subscript-out-of-range/36737964#36737964", "title": "VBA - StrComp type mismatch or subscript out of range", "body": "<p><code>arr</code> is an array of arrays, so you need:</p>\n\n<pre><code>If StrComp(stringToBeFound, arr(i)(col), vbTextCompare) = 0 Then\n</code></pre>\n\n<p>Note this may fail for some values as your sub arrays are not the same size, so you should test the <code>Ubound</code> of the subarray first.</p>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 36737964, "answer_count": 2, "score": 0, "last_activity_date": 1461140759, "creation_date": 1461139898, "question_id": 36737669, "link": "https://stackoverflow.com/questions/36737669/vba-strcomp-type-mismatch-or-subscript-out-of-range", "title": "VBA - StrComp type mismatch or subscript out of range", "body": "<p>I am running a For Loop to find a string inside a variant array. I am using StrComp to compare the strings. The array that I am using as the following format.\n<a href=\"https://i.stack.imgur.com/bxgam.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bxgam.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried two approaches which I will describe bellow.</p>\n\n<p><strong>1st approach returns that the subscript is out of range when I use col=0</strong></p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant, col As Integer) As Long\n  Dim i As Long\n  ' default return value if value not found in array\n  IsInArray = -1\n\n  For i = LBound(arr) To UBound(arr)\n    If StrComp(stringToBeFound, arr(i, col), vbTextCompare) = 0 Then\n      IsInArray = i\n      Exit For\n    End If\n  Next i\nEnd Function\n</code></pre>\n\n<p><strong>2nd approach tells me type mismatch at the StrComp</strong></p>\n\n<pre><code>Function IsIn1DArray(stringToBeFound As String, arr As Variant) As Long\n  Dim i As Long\n  ' default return value if value not found in array\n  IsIn1DArray = -1\n\n  For i = LBound(arr) To UBound(arr)\n    If StrComp(stringToBeFound, arr(i)) = 0 Then\n      IsIn1DArray = i\n      Exit For\n    End If\n  Next i\nEnd Function\n</code></pre>\n\n<p>I have been using the IsInArray and IsIn1DArray in the past and works but not for this case. Imagine I would like to search for the string \"[TestHeader]\" and return its index. How would you do it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3302, "user_id": 2656029, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/t7VHn.jpg?s=128&g=1", "display_name": "Romain", "link": "https://stackoverflow.com/users/2656029/romain"}, "edited": false, "score": 1, "creation_date": 1461140516, "post_id": 36737625, "comment_id": 61058165, "body": "Don&#39;t ask for code here, you should provide a minimum of research"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6218317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/79w1k.jpg?s=128&g=1", "display_name": "Heini", "link": "https://stackoverflow.com/users/6218317/heini"}, "is_accepted": false, "score": 0, "last_activity_date": 1461235570, "last_edit_date": 1461235570, "creation_date": 1461234448, "answer_id": 36766803, "question_id": 36737625, "link": "https://stackoverflow.com/questions/36737625/excel-automatically-move-complete-row-to-another-sheet/36766803#36766803", "title": "Excel / Automatically move complete row to another sheet", "body": "<p>I wrote a little script for you (in MS Excel) that searches for a \"y\" in row B and if it finds a match it copies the value from row A to the Sheet \"Tabelle2\".\nThis is just an example (I'm not here to do your work for you ;))\nPlay with it and import it in your Workbook and adjust it where needed.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim LastRow As Long\nDim LastRow2 As Long\nDim counter As Integer\n\n'get the last row in this sheet (column A)\nWith ActiveSheet\nLastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With\n\n'get the last row in the sheet \"Tabelle2\" (column A)\nWith Sheets(\"Tabelle2\")\nLastRow2 = .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With\n\n'the counter is needed to add dynamically to \"Tabelle2\"\ncounter = LastRow2 + 1\n'run from 1 to the last row in your first sheet\nFor i = 1 To LastRow\n    'search for matches\n    If Cells(i, 2).Text = \"y\" Then\n        'if found, write to \"Tabelle2\"\n        Sheets(\"Tabelle2\").Cells(counter, 1).Value = Cells(i, 2).Offset(0, -1).Value\n        counter = counter + 1\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6228934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/168f9be7c6bcb0055f4e6734e134d0de?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6228934/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1976, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1461235570, "creation_date": 1461139785, "last_edit_date": 1531161705, "question_id": 36737625, "link": "https://stackoverflow.com/questions/36737625/excel-automatically-move-complete-row-to-another-sheet", "title": "Excel / Automatically move complete row to another sheet", "body": "<p>I need to edit a excel spreadsheet so that a row automatically moves from one sheet (\"Open_Followups\") to another sheet (\"Closed_Followups\") if it contains \"Yes\" in column \"I\" (\"Event completed/closed\").</p>\n\n<p>I have no experience in VBA and was wondering if someone here could help me creating the code? </p>\n\n<p>Screenshot of the first columns in on the sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3bGBv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3bGBv.png\" alt=\"screenshot\"></a>  </p>\n\n<p>Not sure if it is important but I am using Excel 2016 on a Mac computer</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1461137231, "post_id": 36736450, "comment_id": 61055918, "body": "when I take out the &#39;6&#39; from &#39;B6&#39; I get a runtime error Application defined or object defined error on that row with the sumif function"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1461137271, "post_id": 36736450, "comment_id": 61055944, "body": "did you replace the 6  with rng.Row ?"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1461137591, "post_id": 36736450, "comment_id": 61056177, "body": "no i didn&#39;t, added it in and it works a treat.  Thanks so much for the help"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 1, "last_activity_date": 1461137235, "last_edit_date": 1461137235, "creation_date": 1461136602, "answer_id": 36736450, "question_id": 36736389, "link": "https://stackoverflow.com/questions/36736389/using-a-formula-in-vba-to-compare-cells-and-enter-results-in-another-cell/36736450#36736450", "title": "using a formula in vba to compare cells and enter results in another cell", "body": "<p>I am not sure but I guess you want to change the B6 to the rng.row </p>\n\n<p>I guess you are getting the same result in every cell of rng because you are putting B6 as the criteria for sum so change that to the corresponding row number in the B column so that you get the desired result.</p>\n\n<p>Change this:</p>\n\n<pre><code>rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$B6,'[Budget.xlsx]DynamicReport'!H:H)\"\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$B\" &amp; rng.Row &amp; \",'[Budget.xlsx]DynamicReport'!H:H)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1461138410, "creation_date": 1461138410, "answer_id": 36737118, "question_id": 36736389, "link": "https://stackoverflow.com/questions/36736389/using-a-formula-in-vba-to-compare-cells-and-enter-results-in-another-cell/36737118#36737118", "title": "using a formula in vba to compare cells and enter results in another cell", "body": "<p>pls try below</p>\n\n<pre><code>Sub ImportCosting()\n    Dim z As Workbook\n    Dim x As Workbook\n    Set x = Workbooks.Open(\"C:\\Documents\\Reports\\MEP.xlsx\")\n    With Workbooks(\"Bank.xlsx\")\n        Worksheets(\"DynamicReport\").Range(\"P5\").Value = \"Budget\"\n        Worksheets(\"DynamicReport\").Range(\"Q5\").Value = \"Forecast\"\n    End With\n    Set z = Workbooks.Open(\"C:\\Documents\\Reports\\Budget.xlsx\")\n    With x.Worksheets(\"DynamicReport\")\n        lastRow = .Cells(Rows.Count, 5).End(xlUp).Row '\"E\"\n        For Each Rng In .Range(\"P6:P\" &amp; lastRow)\n            Rng.Formula = \"=SUMIF([Budget.xlsx]DynamicReport!$C:$C,[Budget.xlsx]DynamicReport!$B$\" &amp; Rng.Row &amp; \",[Budget.xlsx]DynamicReport!H:H)\"\n            'Rng.Value = Application.WorksheetFunction.SumIf(z.Worksheets(\"DynamicReport\").Range(\"C:C\"), z.Worksheets(\"DynamicReport\").Range(\"B\" &amp; Rng.row), z.Worksheets(\"DynamicReport\").Range(\"H:H\"))\n            Rng.Value = Rng.Value\n        Next Rng\n        End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 36736450, "answer_count": 2, "score": 0, "last_activity_date": 1461138410, "creation_date": 1461136388, "question_id": 36736389, "link": "https://stackoverflow.com/questions/36736389/using-a-formula-in-vba-to-compare-cells-and-enter-results-in-another-cell", "title": "using a formula in vba to compare cells and enter results in another cell", "body": "<p>I going to use a formula in VBA to compare to columns of data and if a match is found then enter some data from one sheet to another.  I have used a formula on the first row and this works I get the desired results, I want to automate it as this will be part of other automations on the report.  I have got some code which enters a column heading then applies the sumif function to the entire column but I get the same results all the way down, it is the results for the first row.</p>\n\n<p>Code</p>\n\n<pre><code>Sub ImportCosting()\n\n    Dim z As Workbook\n    Dim x As Workbook\n\n    Set x = Workbooks.Open(\"C:\\Documents\\Reports\\MEP.xlsx\")\n\n    With Workbooks(\"MEP\")\n        Worksheets(\"DynamicReport\").Range(\"P5\").Value = \"Budget\"\n        Worksheets(\"DynamicReport\").Range(\"Q5\").Value = \"Forecast\"\n    End With\n\n    Set z = Workbooks.Open(\"C:\\Documents\\Reports\\Budget.xlsx\")\n\n    With x.Worksheets(\"DynamicReport\")\n        lastRow = .Cells(Rows.Count, 5).End(xlUp).Row\n        For Each rng In .Range(\"P6:P\" &amp; lastRow)\n            rng.Formula = \"=SUMIF('[Budget.xlsx]DynamicReport'!$C:$C,$B6,'[Budget.xlsx]DynamicReport'!H:H)\"\n            rng.Value = rng.Value\n        Next rng\n        End With\nEnd sub\n</code></pre>\n\n<p>Hope I have explained the problem correctly. Can anyone tell me where I have gone wrong and how to get it so that the sumif function is applied to each row and not the results for the first row repeated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6228660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9666130be21c41684efb96302a3361?s=128&d=identicon&r=PG&f=1", "display_name": "ravipalgoyal", "link": "https://stackoverflow.com/users/6228660/ravipalgoyal"}, "edited": false, "score": 0, "creation_date": 1461141627, "post_id": 36736368, "comment_id": 61058900, "body": "But this will only remove the tags from text, the required formatting will be gone like line break, bold text etc."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 11, "user_id": 6228660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9666130be21c41684efb96302a3361?s=128&d=identicon&r=PG&f=1", "display_name": "ravipalgoyal", "link": "https://stackoverflow.com/users/6228660/ravipalgoyal"}, "edited": false, "score": 0, "creation_date": 1461162054, "post_id": 36736368, "comment_id": 61074527, "body": "Pls check the edited code for stripping html except bold and break"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1461162008, "last_edit_date": 1461162008, "creation_date": 1461136317, "answer_id": 36736368, "question_id": 36736154, "link": "https://stackoverflow.com/questions/36736154/in-excel-how-to-convert-html-text-to-regular-text-in-multiple-cells/36736368#36736368", "title": "In Excel, how to convert HTML text to regular text in multiple cells", "body": "<p>try the below function to strip all the html tags (except Bold and break) and to get regular text by parsing the html text to this function like striphtml(your html text).</p>\n\n<pre><code>Function StripHTML(sInput As String) As String\n    Dim RegEx As Object\n    Set RegEx = CreateObject(\"vbscript.regexp\")\n    Dim sOut As String\n    With RegEx\n        .Global = True\n        .IgnoreCase = True\n        .MultiLine = True\n        .Pattern = \"&lt;(?!/?(?:br|b)\\b)[^&gt;]*&gt;\" 'Regular Expression for HTML Tags.\n    End With\n    sOut = RegEx.Replace(sInput, \"\")\n    StripHTML = sOut\n    Set RegEx = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6228660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9666130be21c41684efb96302a3361?s=128&d=identicon&r=PG&f=1", "display_name": "ravipalgoyal", "link": "https://stackoverflow.com/users/6228660/ravipalgoyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1194, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461162008, "creation_date": 1461135675, "question_id": 36736154, "link": "https://stackoverflow.com/questions/36736154/in-excel-how-to-convert-html-text-to-regular-text-in-multiple-cells", "title": "In Excel, how to convert HTML text to regular text in multiple cells", "body": "<p>I have a excel workbook with multiple sheets, each having multiple cells containing HTML text. How can I convert this text directly to regular text with all the formatting defined in HTML tags. Is it possible to have a macro which can scan all such cells and convert them at once?</p>\n"}, {"tags": ["sql", "excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 122, "user_id": 6037456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vc6wV.jpg?s=128&g=1", "display_name": "Dilshan Perera", "link": "https://stackoverflow.com/users/6037456/dilshan-perera"}, "edited": false, "score": 1, "creation_date": 1461129927, "post_id": 36734494, "comment_id": 61052100, "body": "Can you upload what you have tried yet ? So How can we suggest things"}, {"owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "reply_to_user": {"reputation": 122, "user_id": 6037456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vc6wV.jpg?s=128&g=1", "display_name": "Dilshan Perera", "link": "https://stackoverflow.com/users/6037456/dilshan-perera"}, "edited": false, "score": 0, "creation_date": 1461196004, "post_id": 36734494, "comment_id": 61094132, "body": "I have an Excel file with a date being entered by a user in cell F2. When Refresh button is clicked the following code is run pulling data from SQL Server.   Private Sub Refresh_Click()     Application.ScreenUpdating = False     Dim DateEnd As String     DateEnd = Sheets(&quot;Report&quot;).Range(&quot;F2&quot;).Value     With ActiveWorkbook.Connections(&quot;TestConnection&quot;).OLEDBConnection       .CommandText = &quot;EXEC dbo.spReport @DateEnd=&#39;&quot; &amp; DateEnd &amp; &quot;&#39;&quot;     ActiveWorkbook.Connections(&quot;TestConnection&quot;).Refresh     End With     End Sub"}, {"owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "reply_to_user": {"reputation": 122, "user_id": 6037456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vc6wV.jpg?s=128&g=1", "display_name": "Dilshan Perera", "link": "https://stackoverflow.com/users/6037456/dilshan-perera"}, "edited": false, "score": 0, "creation_date": 1461196402, "post_id": 36734494, "comment_id": 61094236, "body": "Sorry, I am new to this forum, trying to figure out to present information better?!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "edited": false, "score": 0, "creation_date": 1461198638, "post_id": 36736605, "comment_id": 61094833, "body": "I have only 1 query and 1 connection. But want to have N number of sheets that will show the results of the same query but with N different values of the same parameter. How to ensure that when I refresh sheet 1 with one value listed on sheet 1, sheet N with value on sheet N does not get refreshed using sheet 1 value? Does this make sense what I am trying to explain?"}, {"owner": {"reputation": 13262, "user_id": 6219979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e768deedd6c0ed9a87a26eff0f4c6cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/6219979/serg"}, "reply_to_user": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "edited": false, "score": 0, "creation_date": 1461223142, "post_id": 36736605, "comment_id": 61103183, "body": "It should be ensured by your VBA script. Iterate over sheets and execute SQL query for every sheet for example. Or may be you can create  a single request which will return resultset containing a separate row for every sheet."}], "tags": [], "owner": {"reputation": 13262, "user_id": 6219979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e768deedd6c0ed9a87a26eff0f4c6cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/6219979/serg"}, "is_accepted": false, "score": 0, "last_activity_date": 1461136959, "creation_date": 1461136959, "answer_id": 36736605, "question_id": 36734494, "link": "https://stackoverflow.com/questions/36734494/running-the-same-parameterized-sql-query-multiple-times-with-different-parameter/36736605#36736605", "title": "Running the same parameterized SQL query multiple times with different parameter values", "body": "<p>Generally no, you needn't. If your queries retrieve data from the same SQL server and use the same credentials, they can share the same connection. </p>\n"}], "owner": {"reputation": 1, "user_id": 6228284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e635caabe8ee03cb8f34e91a8950f8?s=128&d=identicon&r=PG&f=1", "display_name": "Hope", "link": "https://stackoverflow.com/users/6228284/hope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461136959, "creation_date": 1461129738, "last_edit_date": 1531164843, "question_id": 36734494, "link": "https://stackoverflow.com/questions/36734494/running-the-same-parameterized-sql-query-multiple-times-with-different-parameter", "title": "Running the same parameterized SQL query multiple times with different parameter values", "body": "<p>I have created a parameterized SQL query, which reads parameter from the cell within Excel 2010  sheet.\nIf I need to run the same query for a few times (say for each quarter of a year) and store the results within the same workbook (i.e. 4 sheets, Q1, Q2,Q3 and Q4), do I need to create 4 (because there are 4 quarters) data connections?\nOr is there a better solution?\nThank you.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1461130336, "post_id": 36734366, "comment_id": 61052269, "body": "do you need a <code>Set</code> in front of Table1 and Table2? and I don&#39;t think you want <code>set</code> for your next two lines."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461130565, "post_id": 36734366, "comment_id": 61052351, "body": "I&#39;d say it&#39;s because it didn&#39;t find the lookup value: did it actually populate ALL cells?"}, {"owner": {"reputation": 107, "user_id": 2726884, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2224c9d583aece900316d44f4dc51552?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/2726884/ian"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461131325, "post_id": 36734366, "comment_id": 61052655, "body": "@user3598756 I believe you are correct and the reason is the loop goes one beyond the last populated cell in Table1. What I am hoping to achieve is to avoid this error from occurring by limiting Table1 to include only cells with a value in column A. This would have to be dynamic as the number of rows in that column will change frequently."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461132353, "post_id": 36734366, "comment_id": 61053092, "body": "See posted answer (sorry I can&#39;t test nor format it properly) which also takes Into account Forward Ed&#39;s comment"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461132490, "post_id": 36734366, "comment_id": 61053172, "body": "@user3598756 got you covered, I edited your answer and added formatting to the code for you so it will read better.  Just need to wait for edits to be approved now."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461132893, "post_id": 36734366, "comment_id": 61053371, "body": "@Forward Ed thank you. But I was making an edit myself (adding newlines to try and improve a little) so I&#39;m not sure your edits weren\u2019t rejected. BTW how to access test formatting buttons from a smartphone?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461133127, "post_id": 36734366, "comment_id": 61053484, "body": "@user3598756 Give me a smart phone and I&#39;ll try and figure it out 8)...is there a way to by pass the mobile version of the site (if there is one) and go to the full version of the site in your web browser?  I am wondering if those formatting buttons at the top of the answer area are removed on a different version of this page.  YOU EDIT CODE ON YOUR SMARTPHONE ....You finger poking animal!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461133664, "post_id": 36734366, "comment_id": 61053775, "body": "@Forward Ed: I agree... :-)"}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461132744, "post_id": 36735070, "comment_id": 61053302, "body": "For future reference in case you were not aware, when you post your answer, in this case code.  I have done this for you for this post and the change will be visible when my edits have been reviewed.  If you can select all your code and then click the {} at the top of the &quot;Your Answer&quot; area, it will go through and automatically add for spaces to the front of every line which in turns makes your code very readable."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461135507, "post_id": 36735070, "comment_id": 61054808, "body": "See edited answer to prevent code from failing should the searched value not be found in Table2 first column"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461136011, "post_id": 36735070, "comment_id": 61055116, "body": "Not sure you want WsFk_Row to be incremented in any case  (as it is now). Should this not happen then simply include that increment insider the &quot;If Not found is Nothing&quot; clause by expanding it with the &quot;Then&quot; and &quot;End If&quot; keywords"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1461135395, "last_edit_date": 1461135395, "creation_date": 1461132214, "answer_id": 36735070, "question_id": 36734366, "link": "https://stackoverflow.com/questions/36734366/trouble-with-vba-vlookup/36735070#36735070", "title": "Trouble With VBA VLookup", "body": "<p>Edited to substitute \"VlookUp\" with \".Find\" method and handle possible not matchings </p>\n\n<pre><code>Dim WsFk_Row As Long, WsFk_Clm As Long\nDim found as Range\nWith Sheets(\"Requirements Update Format\")\n\n    Set Table1 = .Range(\"A1:A\" &amp; .Cells(.Rows.Count,1).End (xlUp).Row)\n\nEnd With\n\nSet Table2 = Sheets(\"Workstreams Link\").Range(\"A:B\")\n\nWsFk_Row = Sheets(\"Requirements Insert Format\").Range(\"I1\").Row\n\nWsFk_Clm = Sheets(\"Requirements Insert Format\").Range(\"I1\").Column\n\n\nFor Each cl In Table1\n   Set found = Table2. Columns(1).Find (What:=cl.Value, LookAt:=xlWhole,  LookIn:=xlValues, MatchCase=True)\n   If Not found is Nothing then Sht3.Cells(WsFk_Row, WsFk_Clm) =  found.Offset (,1)\n   WsFk_Row = WsFk_Row + 1\nNext cl\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 1, "last_activity_date": 1461132967, "creation_date": 1461132967, "answer_id": 36735279, "question_id": 36734366, "link": "https://stackoverflow.com/questions/36734366/trouble-with-vba-vlookup/36735279#36735279", "title": "Trouble With VBA VLookup", "body": "<p>I think you were on the right track. Try the following ...</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nDim WsFk_Row As Long, WsFk_Clm As Long\nDim Sht1 As Worksheet, Sht2 As Worksheet, Sht3 As Worksheet\nDim Table1 As Range, Table2 As Range\nDim cl As Range\nDim lastRow As Long\n\nSet Sht1 = Worksheets(\"Requirements Update Format\")\nSet Sht2 = Worksheets(\"Workstreams Link\")\nSet Sht3 = Worksheets(\"Requirements Insert Format\")\n\nlastRow = Sht1.Range(\"A\" &amp; Sht1.Rows.Count).End(xlUp).Row\nSet Table1 = Sheets(\"Requirements Update Format\").Range(\"A1:A\" &amp; lastRow)\n\nlastRow = Sht2.Range(\"A\" &amp; Sht2.Rows.Count).End(xlUp).Row\nSet Table2 = Sheets(\"Workstreams Link\").Range(\"A1:B\" &amp; lastRow)\n\nWsFk_Row = Sht3.Range(\"I1\").Row\nWsFk_Clm = Sht3.Range(\"I1\").Column\n\nFor Each cl In Table1\n    Sht3.Cells(WsFk_Row, WsFk_Clm) = Application.WorksheetFunction.VLookup(cl, Table2, 2, False)\n    WsFk_Row = WsFk_Row + 1\nNext cl\n\nSet Sht1 = Nothing\nSet Sht2 = Nothing\nSet Sht3 = Nothing\nSet Table1 = Nothing\nSet Table2 = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>It does this:</p>\n\n<ul>\n<li>Uses a couple of more objects, hopefully to improve readability</li>\n<li>Corrects some syntax around <code>Set</code></li>\n<li>Calculates the actual size of the tables. This prevents the cl loop from shooting past the end of the usable range.</li>\n<li>Cleans up the objects at the end - just good practice</li>\n</ul>\n"}], "owner": {"reputation": 107, "user_id": 2726884, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2224c9d583aece900316d44f4dc51552?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/2726884/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 36735279, "answer_count": 2, "score": 0, "last_activity_date": 1461135395, "creation_date": 1461129113, "last_edit_date": 1461129971, "question_id": 36734366, "link": "https://stackoverflow.com/questions/36734366/trouble-with-vba-vlookup", "title": "Trouble With VBA VLookup", "body": "<p>I am having trouble with the below VLookup since I am using a the full column range as my lookup value. </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nDim WsFk_Row As Long\nDim WsFk_Clm As Long\n\nTable1 = Sheets(\"Requirements Update Format\").Range(\"A:A\")\nTable2 = Sheets(\"Workstreams Link\").Range(\"A:B\")\nSet WsFk_Row = Sheets(\"Requirements Insert Format\").Range(\"I1\").Row\nSet WsFk_Clm = Sheets(\"Requirements Insert Format\").Range(\"I1\").Column\n\n\nFor Each cl In Table1\n    Sheets(\"Requirements Insert Format\").Cells(WsFk_Row, WsFk_Clm) = Application.WorksheetFunction.VLookup(cl, Table2, 2, False)\n    WsFk_Row = WsFk_Row + 1\nNext cl\n\nEnd Sub\n</code></pre>\n\n<p>This code appropriately populates all rows, however once completed I receive the following error \"Unable to get the VLookup property of the WorksheetFunction class\". This led me to believe the following line is where my issue begins</p>\n\n<pre><code>Table1 = Sheets(\"Requirements Update Format\").Range(\"A:A\")\n</code></pre>\n\n<p>I tried resolving this by modifying the line as below, however this prevented the process to run at all.</p>\n\n<pre><code>Table1 = Sheets(\"Requirements Update Format\").Range(Range(\"A1\"), Range(\"A1\").End(xlDown).Select)\n</code></pre>\n\n<p>Any suggestion on how I can resolve this would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 3, "creation_date": 1461131444, "post_id": 36734064, "comment_id": 61052705, "body": "&quot;It does not seem to work&quot;: what exactly doesn&#39;t work? Does the code throw any error? If so: what error and at which line? Enter debug mode and try querying  &quot;ActiveDocument&quot; right before the &quot;Set oRng. ..&quot; statement"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1461131640, "post_id": 36734064, "comment_id": 61052787, "body": "In addition to what @user3598756 asks: WHERE is the CommandButton located that triggers this code?"}, {"owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "edited": false, "score": 0, "creation_date": 1461132505, "post_id": 36734064, "comment_id": 61053181, "body": "If you&#39;re calling the macro from the Word document, then setting the <code>oRng</code> before you open Excel file might help. Or you could put <code>Word.Application.Activate</code> before trying to write to Word"}, {"owner": {"reputation": 2176, "user_id": 3888719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b29576e96d31c1d3a2047c8f1b9a9948?s=128&d=identicon&r=PG", "display_name": "Michael Delgado", "link": "https://stackoverflow.com/users/3888719/michael-delgado"}, "edited": false, "score": 0, "creation_date": 1461132887, "post_id": 36734064, "comment_id": 61053368, "body": "Yeah I just made a document and spreadsheet that seem to match your description and the code worked fine. If you could post what it is that isn&#39;t working and what exactly you do to reproduce the problem that would help!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3814847"}, "edited": false, "score": 0, "creation_date": 1461136084, "post_id": 36734064, "comment_id": 61055180, "body": "Hi Dani El, it worked like a charm! Thank you so much. Could you please copy and paste your comment as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 5968309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g0szoCYu_LQ/AAAAAAAAAAI/AAAAAAAAAEw/OpjmKaE-9XE/photo.jpg?sz=128", "display_name": "Dani El", "link": "https://stackoverflow.com/users/5968309/dani-el"}, "is_accepted": true, "score": 0, "last_activity_date": 1461136334, "creation_date": 1461136334, "answer_id": 36736374, "question_id": 36734064, "link": "https://stackoverflow.com/questions/36734064/how-to-return-focus-to-word-document-from-where-the-macro-opened-excel-file/36736374#36736374", "title": "How to return focus to Word document from where the macro opened Excel file", "body": "<p>If you're calling the macro from the Word document, then setting the <code>oRng</code> before you open Excel file might help. Or you could put <code>Word.Application.Activate</code> before trying to write to Word</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3814847"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1993, "favorite_count": 0, "accepted_answer_id": 36736374, "answer_count": 1, "score": 0, "last_activity_date": 1461136334, "creation_date": 1461127708, "last_edit_date": 1461131537, "question_id": 36734064, "link": "https://stackoverflow.com/questions/36734064/how-to-return-focus-to-word-document-from-where-the-macro-opened-excel-file", "title": "How to return focus to Word document from where the macro opened Excel file", "body": "<pre><code>Private Sub CommandButton1_Click()\nDim oRng As Word.Range\nDim arrExcelValues()\nDim i As Long\nDim x As Long\n\nSet objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\Risk Words.xlsx\")\nobjExcel.Visible = False\n\ni = 1\nx = 0\n\nDo Until objExcel.Cells(i, 1).Value = \"\"\n   ReDim Preserve arrExcelValues(x)\n   arrExcelValues(x) = objExcel.Cells(i, 1).Value\n   i = i + 1\n   x = x + 1\nLoop\nobjExcel.Quit\n\nFor i = 0 To UBound(arrExcelValues)\n    Set oRng = ActiveDocument.Range\n    Options.DefaultHighlightColorIndex = wdYellow\n    With oRng.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Text = arrExcelValues(i)\n        .MatchWholeWord = True\n        .Replacement.Highlight = True\n        .Execute Replace:=wdReplaceAll\n    End With\nNext\nEnd Sub\n</code></pre>\n\n<p>Wrote this code to pick words from the Excel file and check it in the Word file to see if they are present and highlight them. However, it does not seem to work from Set oRng = ActiveDocument.Range. Although, if I put a MsgBox before that, it does show the values picked up from the Excel and store in the array.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461131197, "post_id": 36733939, "comment_id": 61052598, "body": "Are you saying each row in a column would contain one &quot;rankable&quot; string (e.g. cell A1 is &quot;A&quot;, cell B1 is &quot;A&quot;), or are you saying a cell contains a string that you want to rank the characters on (e.g. cell A1 is &quot;AABBCA&quot;)?"}, {"owner": {"reputation": 3, "user_id": 6228122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8k0WqlvS0bI/AAAAAAAAAAI/AAAAAAAAADY/U55oqsmkElk/photo.jpg?sz=128", "display_name": "Junior Ludger", "link": "https://stackoverflow.com/users/6228122/junior-ludger"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461153236, "post_id": 36733939, "comment_id": 61067236, "body": "Yes exactly. Then in the next row I could rank them from 1 to n (the last one) that is for every criteria."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6228122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8k0WqlvS0bI/AAAAAAAAAAI/AAAAAAAAADY/U55oqsmkElk/photo.jpg?sz=128", "display_name": "Junior Ludger", "link": "https://stackoverflow.com/users/6228122/junior-ludger"}, "edited": false, "score": 0, "creation_date": 1461153637, "post_id": 36734815, "comment_id": 61067526, "body": "Wow! Fantastic! I can&#39;t believe it. It works exactly how I want it. So Much Thanks @Mrig. I still can&#39;t believe that I would find a way without VBA codification to do it."}, {"owner": {"reputation": 3, "user_id": 6228122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8k0WqlvS0bI/AAAAAAAAAAI/AAAAAAAAADY/U55oqsmkElk/photo.jpg?sz=128", "display_name": "Junior Ludger", "link": "https://stackoverflow.com/users/6228122/junior-ludger"}, "edited": false, "score": 0, "creation_date": 1461155773, "post_id": 36734815, "comment_id": 61069164, "body": "Just to inform every one that this is the best answer I have found :=A1 &amp; IF(A1=&quot;&quot;,&quot;&quot;,COUNTIF($A$1:A1,A1))"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1461131172, "creation_date": 1461131172, "answer_id": 36734815, "question_id": 36733939, "link": "https://stackoverflow.com/questions/36733939/how-to-increment-duplicate-values-from-1-to-n-by-criteria/36734815#36734815", "title": "How to increment duplicate values from 1 to n by criteria?", "body": "<p>I am assuming your data is in Column \"A\". Enter the formula in Column \"B\" and copy the formula till the row you want.</p>\n\n<pre><code>=A1 &amp; IF(A1=\"\",\"\",COUNTIF($A$1:A1,A1))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6228122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8k0WqlvS0bI/AAAAAAAAAAI/AAAAAAAAADY/U55oqsmkElk/photo.jpg?sz=128", "display_name": "Junior Ludger", "link": "https://stackoverflow.com/users/6228122/junior-ludger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "accepted_answer_id": 36734815, "answer_count": 1, "score": -1, "last_activity_date": 1461131172, "creation_date": 1461127160, "last_edit_date": 1531161705, "question_id": 36733939, "link": "https://stackoverflow.com/questions/36733939/how-to-increment-duplicate-values-from-1-to-n-by-criteria", "title": "How to increment duplicate values from 1 to n by criteria?", "body": "<p>let's say I have a list of duplicate values in a column such as:AAABBAACABC. ...AAC. Then I want Excel to Rank respectively the first A as A1,the first B as B1 the second A as A2 and the second B as B2 and so forth until the A(nth) and the B(nth). And any additional A should automatically Rank as A(nth+1). Same thing for B C etc.\nnote that I should be able to enter any new value such as X that will automatically Rank as X(nth+1) or X1 if it did not exist in the table before. </p>\n\n<p>Hoping that I made myself understood. I am waiting for anyone to help me. VBA or array formulas I have no preference once I can realise what I want.</p>\n\n<p>Note that I found a way by sorting them in accending order but it can't match for any additional value at the end of the data base.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "scientific-notation"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461129766, "post_id": 36733885, "comment_id": 61052026, "body": "Nice story. So the OP would have to check for any occurrence of &quot;D&quot; charachter to definitively state the cell content is numeric"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 1, "creation_date": 1461134915, "post_id": 36733885, "comment_id": 61054483, "body": "nice story indeed, I never noticed this behavior and would be completely unable to explain it"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 12, "last_activity_date": 1461127302, "last_edit_date": 1610973195, "creation_date": 1461126923, "answer_id": 36733885, "question_id": 36733884, "link": "https://stackoverflow.com/questions/36733884/why-does-isnumeric1-23d45-return-true/36733885#36733885", "title": "Why does IsNumeric(&quot;1.23D45&quot;) return True?", "body": "<p>This came up in <a href=\"https://chat.stackexchange.com/rooms/14929/conversation/isnumeric1-23d45\">chat</a></p>\n<hr />\n<p>According to <a href=\"https://en.wikipedia.org/wiki/Scientific_notation#Examples_and_other_notations\" rel=\"nofollow noreferrer\">Wikipedia</a>...</p>\n<blockquote>\n<p>FORTRAN also uses &quot;D&quot; to signify double precision numbers.</p>\n<p><sub>&quot;UH M\u0101noa Mathematics \u00bb Fortran lesson 3: Format, Write, etc&quot;. Math.hawaii.edu. 2012-02-12. Retrieved 2012-03-06.</sub></p>\n</blockquote>\n<p>VBA still has many traces of its BASIC ancestor (line numbers, <code>GoSub..Return</code>, <code>Rem</code>, etc.) - it just so happens that BASIC finds its roots in... FORTRAN.</p>\n<p>So that &quot;D&quot; for scientific notation is apparently nothing more than a blast from the past.</p>\n<p>Bottom line, avoid confusing whoever is maintaining your code, and stick to &quot;E&quot; (or &quot;e&quot;). But know that &quot;D&quot; (or &quot;d&quot;) is also supported, if you ever need to port some FORTRAN code to ...VBA.</p>\n"}], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1461127302, "creation_date": 1461126923, "question_id": 36733884, "link": "https://stackoverflow.com/questions/36733884/why-does-isnumeric1-23d45-return-true", "title": "Why does IsNumeric(&quot;1.23D45&quot;) return True?", "body": "<p>For the longest time, I thought <code>IsNumeric(\"1.23E45\")</code> returned <code>True</code> because the \"E\" stands for <em>scientific notation</em>, making 1.23E45 be 1.23x10<sup>45</sup>.</p>\n\n<p>Recently I noticed <code>IsNumeric(\"1.23D34\")</code> <em>also</em> returned <code>True</code>, and I'm stumped about why.</p>\n\n<p>Both <code>D</code> and <code>E</code> produce the same result:</p>\n\n<pre><code>?val(\"1.23d45\")\n 1.23E+45 \n\n?val(\"1.23e45\")\n 1.23E+45 \n</code></pre>\n\n<p>How come?</p>\n"}, {"tags": ["vba", "ms-access", "dll", "qr-code", "com-interop"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 2, "creation_date": 1461126368, "post_id": 36733688, "comment_id": 61050826, "body": "Because it is .net and it does not have com interface."}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1461157649, "post_id": 36733688, "comment_id": 61070684, "body": "Is there a way to get around this problem?"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1461188896, "post_id": 36733688, "comment_id": 61091763, "body": "You can create a com interface wrapper for this library.  See this article <a href=\"http://stackoverflow.com/questions/29783350/expose-c-sharp-class-through-com-interop\" title=\"expose c sharp class through com interop\">stackoverflow.com/questions/29783350/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1505178276, "post_id": 36733688, "comment_id": 79295000, "body": "@Jules Could you add it as an answer? Ill accept it"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1505217936, "post_id": 36733688, "comment_id": 79313979, "body": "All good, I don&#39;t think this warrant an answer :)"}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1505219374, "post_id": 36733688, "comment_id": 79315002, "body": "Add a Link xD <a href=\"https://whoisburiedhere.wordpress.com/2011/07/12/creating-a-com-object-from-scratch-with-c/\" rel=\"nofollow noreferrer\">whoisburiedhere.wordpress.com/2011/07/12/&hellip;</a> this might help someone"}], "owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1476651871, "creation_date": 1461125674, "last_edit_date": 1476651871, "question_id": 36733688, "link": "https://stackoverflow.com/questions/36733688/why-can-i-add-a-reference-to-a-net-library-in-ms-access-2013", "title": "Why Can I add a reference to a .Net library in ms access 2013?", "body": "<p>I needed a library to create QRcodes in ms access 2013 and I found this one.</p>\n\n<p><a href=\"http://en.code-bude.net/2013/10/17/qrcoder-an-open-source-qr-code-generator-implementation-in-csharp/comment-page-1/#comment-101119\" rel=\"nofollow\">http://en.code-bude.net/2013/10/17/qrcoder-an-open-source-qr-code-generator-implementation-in-csharp/comment-page-1/#comment-101119</a></p>\n\n<p>It's under MIT license so is convenient.\nI tried using the sample code provided by the author in Visual Studio C# and It worked fine. But I can't add the reference in Access 2013 W 8.1.\nI've tried to add the reference trough the VBA editor In Tools>Reference then browse for it.\nIs there a way to get around this problem?</p>\n"}, {"tags": ["vba", "excel", "recursion", "callstack"], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 2817374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1d9d9e2d65213f9b194d1d31432fa51?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/2817374/null"}, "edited": false, "score": 0, "creation_date": 1461126159, "post_id": 36733600, "comment_id": 61050779, "body": "How are the n values stored, isn&#39;t n supposed to be static? So by the time it reaches MsgBox(n), wouldn&#39;t it show just 1, but instead it shows 10 till 1."}, {"owner": {"reputation": 653, "user_id": 2817374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1d9d9e2d65213f9b194d1d31432fa51?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/2817374/null"}, "edited": false, "score": 0, "creation_date": 1461128743, "post_id": 36733600, "comment_id": 61051608, "body": "How is countup(10) associated with MsgBox(10), by order of execution?"}, {"owner": {"reputation": 653, "user_id": 2817374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1d9d9e2d65213f9b194d1d31432fa51?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/2817374/null"}, "edited": false, "score": 0, "creation_date": 1461129033, "post_id": 36733600, "comment_id": 61051732, "body": "@What happened to your comment?"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 653, "user_id": 2817374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1d9d9e2d65213f9b194d1d31432fa51?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/2817374/null"}, "edited": false, "score": 0, "creation_date": 1461156694, "post_id": 36733600, "comment_id": 61069854, "body": "@null My comment incorrectly mentioned that it passed the variable <code>n</code> ByVal. I deleted it."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 653, "user_id": 2817374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1d9d9e2d65213f9b194d1d31432fa51?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/2817374/null"}, "edited": false, "score": 0, "creation_date": 1461156742, "post_id": 36733600, "comment_id": 61069907, "body": "@null I&#39;ve updated the answer to include some commentary on what is actually happening with regard to the call stack. Hope it helps."}], "tags": [], "owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "is_accepted": true, "score": 3, "last_activity_date": 1461156539, "last_edit_date": 1461156539, "creation_date": 1461124986, "answer_id": 36733600, "question_id": 36733546, "link": "https://stackoverflow.com/questions/36733546/does-a-recursive-call-to-a-function-instantiate-it/36733600#36733600", "title": "Does a recursive call to a function instantiate it?", "body": "<p>As @EdPlunkett mentioned, <em>instantiation</em> has nothing to do with it. That deals with creating new objects. This is about calling the same function from within itself, or <em>recursion</em>.</p>\n\n<p>The program execution looks like this:</p>\n\n<pre><code>countup(10) called\n  -&gt; countup(9) called\n    -&gt; countup(8) called\n       -&gt; countup(7) called\n          -&gt; countup(6) called\n            -&gt; countup(5) called\n              -&gt; countup(4) called\n                -&gt;countup(3) called\n                  -&gt;countup(2) called\n                     -&gt; MsgBox (1)\n                  -&gt; MsgBox (2)\n                -&gt; MsgBox (3)\n              -&gt; MsgBox (4)\n            -&gt; MsgBox (5)\n          -&gt; MsgBox (6)\n        -&gt; MsgBox (7)\n      -&gt; MsgBox (8)\n    -&gt; MsgBox (9)\n  -&gt; MsgBox (10)\n</code></pre>\n\n<p>Indented 2 spaces each time to show a recursive call, or stepping back out.</p>\n\n<p>As you can see, the call stack increases until it is a full 9 levels deep (due to <code>If (n &gt; 1)</code>) before it executes the very first <code>MsgBox</code>. The code then returns back to the previous caller, which calls its <code>MsgBox</code> and continues the entire way back up the call stack, returning to each previous caller.</p>\n\n<p>Finally, we return back to <code>countup(10)</code>, which executes the final MsgBox(10), at which point we return to <code>myprogram()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2775, "user_id": 212514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ea69157590ddaa2363dd9ad4d7c7d3?s=128&d=identicon&r=PG", "display_name": "user212514", "link": "https://stackoverflow.com/users/212514/user212514"}, "is_accepted": false, "score": 1, "last_activity_date": 1461125179, "creation_date": 1461125179, "answer_id": 36733623, "question_id": 36733546, "link": "https://stackoverflow.com/questions/36733546/does-a-recursive-call-to-a-function-instantiate-it/36733623#36733623", "title": "Does a recursive call to a function instantiate it?", "body": "<p>The program starts by calling your subroutine/function <code>countup</code> and passing in the value of 10.  That value is then in the variable <code>n</code> that is the parameter to <code>countup</code>.  The function tests the value of <code>n</code> and calls <code>countup</code> again with <code>n - 1</code> (9 in the first time <code>countup</code> is called).  <code>countup</code> keeps getting called, deeper and deeper, with <code>n - 1</code> until we get down to 1.  Then we start unravelling.  The deepest layer to unravel received the <code>n</code> with 1 in it so it then calls <code>MsgBox (n)</code>, which displays 1.  As we unravel to the next level <code>n = 2</code> and so <code>MsgBox</code> displays 2.  And so on, all the way back up the stack.</p>\n"}, {"comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 1, "creation_date": 1461136328, "post_id": 36734122, "comment_id": 61055328, "body": "However, since in this example, n is never actually changed - it all works."}], "tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": -1, "last_activity_date": 1461128008, "creation_date": 1461128008, "answer_id": 36734122, "question_id": 36733546, "link": "https://stackoverflow.com/questions/36733546/does-a-recursive-call-to-a-function-instantiate-it/36734122#36734122", "title": "Does a recursive call to a function instantiate it?", "body": "<p>With handing over a parameter to a procedure like <code>countup(n As Integer)</code> actual is the short version of <code>countup(byRef n As Integer)</code>. If you change the value of <code>n</code> within your sub the value of the calling <code>n</code> is changed too.</p>\n"}, {"tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": false, "score": 0, "last_activity_date": 1461128756, "creation_date": 1461128756, "answer_id": 36734277, "question_id": 36733546, "link": "https://stackoverflow.com/questions/36733546/does-a-recursive-call-to-a-function-instantiate-it/36734277#36734277", "title": "Does a recursive call to a function instantiate it?", "body": "<p>While I agree that \"instantiate\" isn't the correct term, I think it may be a useful way of thinking of what is happening. If you change your countup subroutine slightly (see below) so that it now also stores the parameter it is passed, you really would have up to 10 instances of the variable called \"storeN\", each one with a different value. You would only be able to access the storeN in the \"current\" version of countup. But the rest are there and will be restored back into the \"earlier\" calls of countup, as the recursion unwinds.</p>\n\n<p>This is essentially exactly what is happening with the variable n. There <em>are</em> different \"instances\" of n that brought back to see daylight as the recursion unwinds. And this why MsgBox displays a different value of n for each call.</p>\n\n<p>So I think your own answer is basically correct.</p>\n\n<pre><code>Option Explicit\n\nSub countup(n As Integer)   \n   Dim storeN as Integer\n   storeN = n\n   If (n &gt; 1) Then\n      countup (n - 1)\n   End If\n   MsgBox (n)\nEnd Sub\n\nSub myprogram()\n   Call countup(10)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 653, "user_id": 2817374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1d9d9e2d65213f9b194d1d31432fa51?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/2817374/null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 36733600, "answer_count": 4, "score": 1, "last_activity_date": 1461156833, "creation_date": 1461124602, "last_edit_date": 1531164843, "question_id": 36733546, "link": "https://stackoverflow.com/questions/36733546/does-a-recursive-call-to-a-function-instantiate-it", "title": "Does a recursive call to a function instantiate it?", "body": "<p>I am trying to understand the below code snippet for counting up<br/>\nHow does the msgbox store all the values for n?<br/></p>\n\n<p>Is it because when countup(n-1) is called,it instantiates the function and then associates the n value with a msgbox instance?   </p>\n\n<pre><code>Option Explicit\n\nSub countup(n As Integer)   \n   If (n &gt; 1) Then\n      countup (n - 1)\n   End If\n   MsgBox (n)\nEnd Sub\n\nSub myprogram()\n   Call countup(10)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "user-defined-functions", "paramarray"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1461125034, "post_id": 36733128, "comment_id": 61050497, "body": "<code>Range1, Criteria1, Range2, Criteria2, ...</code> they&#39;re not <code>ParamArray</code> parameters. I think you&#39;d need a crap-ton of <code>Optional</code> parameters, kind of like <code>CallByName</code> does (with 30 optional parameters)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1461130802, "post_id": 36733128, "comment_id": 61052434, "body": "@Mat&#39;sMug - <code>CallByName</code> actually takes a <code>ParamArray</code> - <a href=\"http://stackoverflow.com/a/36316527/4088852\">check this out</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1461131014, "post_id": 36733128, "comment_id": 61052533, "body": "@Comintern gah, I went by memory.... I meant <code>Application.Run</code> then :)"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1461131590, "last_edit_date": 1461131590, "creation_date": 1461130515, "answer_id": 36734656, "question_id": 36733128, "link": "https://stackoverflow.com/questions/36733128/vba-udf-paramarray-sequence/36734656#36734656", "title": "VBA UDF ParamArray Sequence", "body": "<p>If I understand correctly what you're trying to do, you just need to iterate over the <code>ParamArray</code> <code>Step 2</code>. Add a test to make sure than the passed parameters come in pairs, then just grab them as a set of <code>Criteria</code> and <code>SumRange</code> in a loop:</p>\n\n<pre><code>Public Function PairedParamArrayIe(PhraseRange As Range, ParamArray values())\n\n    Dim counter As Integer\n    Dim Criteria As String\n    Dim SumRange As Range\n\n    If UBound(values) Mod 2 &lt;&gt; 1 Then\n        Err.Raise -1, vbNullString, \"Invalid ParamArray\"\n    End If\n\n    For counter = LBound(values) + 1 To UBound(values) Step 2\n        Criteria = values(counter - 1)\n        Set SumRange = values(counter)\n        Debug.Print Criteria\n        Debug.Print SumRange.AddressLocal\n    Next counter\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1461148828, "creation_date": 1461148828, "answer_id": 36741301, "question_id": 36733128, "link": "https://stackoverflow.com/questions/36733128/vba-udf-paramarray-sequence/36741301#36741301", "title": "VBA UDF ParamArray Sequence", "body": "<p>You'll note that for SUMIFS, unlike SUMIF, the data range comes first. That's key to your ParamArray:</p>\n\n<pre><code>Function SumIfContains(SumRange As Range, ParamArray criteria())\n    Dim x                     As Long\n    Dim n                     As Long\n    Dim dTotal                As Double\n    Dim bMatch                As Boolean\n\n    ' check for criteria ranges\n    For n = LBound(criteria) To UBound(criteria) Step 2\n        If TypeName(criteria(n)) &lt;&gt; \"Range\" Then\n            SumIfContains = CVErr(xlErrNum)\n        End If\n    Next n\n\n    ' loop through each cell in sum range\n    For x = 1 To SumRange.Cells.Count\n        bMatch = True\n        ' loop through criteria\n        For n = LBound(criteria) To UBound(criteria) Step 2\n            ' first item in pair is the range, second is the criterion\n            If InStr(1, criteria(n).Cells(x).Value2, criteria(n + 1), vbTextCompare) = 0 Then\n                ' if one doesn't match, set a flag and exit the loop\n                bMatch = False\n                Exit For\n            End If\n        Next n\n        ' only if all criteria matched is bMatch still True, and we add the sumrange cell\n        If bMatch And IsNumeric(SumRange.Cells(x).Value2) Then dTotal = dTotal + SumRange.Cells(x).Value2\n    Next x\n\n    SumIfContains = dTotal\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 1, "accepted_answer_id": 36741301, "answer_count": 2, "score": 2, "last_activity_date": 1461183625, "creation_date": 1461121884, "last_edit_date": 1592644375, "question_id": 36733128, "link": "https://stackoverflow.com/questions/36733128/vba-udf-paramarray-sequence", "title": "VBA UDF ParamArray Sequence", "body": "<p>I want to create a function that is almost exactly like SumIfs, but I'm having a hard time figuring our how to handle the ParamArray portion. I'm looking for a solution that allows the same Range1,Criteria1,Range2,Criteria2,...,Rangen,Criterian as the sum ifs but in my &quot;SumIfsContains&quot; function. I've attached the code for the singular case, &quot;SumIfContains&quot; so you can see my starting point:</p>\n<pre><code>Function SumIfContains(PhraseRange As Range, Criteria As String, SumRange As Range)\nDim element As Range\n\nElementCount = 0\nFor Each element In PhraseRange\n    ElementCount = ElementCount + 1\nNext element\n\nDim SumArray: ReDim SumArray(1 To 3, 1 To ElementCount)\n\nElementCount = 0\nFor Each element In SumRange\n    ElementCount = ElementCount + 1\n    SumArray(2, ElementCount) = element\nNext element\n\nElementCount = 0\nFor Each element In PhraseRange\n    ElementCount = ElementCount + 1\n    SumArray(1, ElementCount) = element\n    If InString(CStr(element), Criteria) Then\n        SumArray(3, ElementCount) = SumArray(2, ElementCount)\n    Else\n        SumArray(3, ElementCount) = 0\n    End If\nNext element\n\nSumIfContains = 0\nFor Item = 1 To ElementCount\n    SumIfContains = SumIfContains + CDbl(SumArray(3, Item))\nNext Item\n\nEnd Function\n</code></pre>\n<p>Before I got an answer last night I came up with a working option as follows:</p>\n<pre><code>Function SumIfsContains(SumRange As Range, ParamArray Criteria() As Variant)\nDim element As Range\nDim cCriteria As String\nDim PhraseRange As Range\n\n'Exit Function\nDim PhraseRangeArray(): ReDim PhraseRangeArray(LBound(Criteria()) To (((UBound(Criteria()) + 1) / 2) - 1))\nDim CriteriaArray(): ReDim CriteriaArray(LBound(Criteria()) To (((UBound(Criteria()) + 1) / 2) - 1))\n\nCurrentPair = 0\nFor i = LBound(Criteria()) To UBound(Criteria())\n    If i Mod 2 = 0 Then\n        PhraseRangeArray(CurrentPair) = Criteria(i)\n    Else\n        CriteriaArray(CurrentPair) = Criteria(i)\n        CurrentPair = CurrentPair + 1\n    End If\nNext i\n\nElementCount = UBound(PhraseRangeArray(0))\nDim SumRng: ReDim SumRng(1 To ElementCount)\ni = 1\nFor Each element In SumRange\n    SumRng(i) = element\n    i = i + 1\nNext element\nDim SumArray: ReDim SumArray(0 To 2 + UBound(PhraseRangeArray), 1 To ElementCount)\n\nFor i = 1 To ElementCount\n    SumArray(1, i) = SumRng(i)\n    For RC = 2 To 2 + UBound(PhraseRangeArray)\n        If InString(CStr(PhraseRangeArray(RC - 2)(i, 1)), CStr(CriteriaArray(RC - 2))) Then\n            SumArray(RC, i) = 1\n        Else\n            SumArray(RC, i) = 0\n        End If\n    Next RC\n    SumArray(0, i) = SumArray(1, i)\n    For Mult = 2 To 2 + UBound(PhraseRangeArray)\n        SumArray(0, i) = SumArray(0, i) * SumArray(Mult, i)\n    Next Mult\nNext i\n\n\nSumIfsContains = 0\nFor Item = 1 To ElementCount\n    SumIfsContains = SumIfsContains + CDbl(SumArray(0, Item))\nNext Item\n\nEnd Function\n</code></pre>\n<p>But I'm still curious how to make the Range/Criteria pair not simply be parced out of the &quot;Criteria&quot; array later.</p>\n<p><a href=\"https://i.stack.imgur.com/8uUjl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8uUjl.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461117120, "post_id": 36732419, "comment_id": 61048476, "body": "Or you can use SUMIFS"}, {"owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461117905, "post_id": 36732419, "comment_id": 61048685, "body": "I looked at SUMIFS and either it would not do the job or I did not know how to get it to do the job."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461118527, "post_id": 36732419, "comment_id": 61048833, "body": "Show some data and the formula you tried and we may be able to help."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461118703, "post_id": 36732419, "comment_id": 61048868, "body": "is it safe to assume that every employees name is unique? you sont have two different John smiths working for the company?  Or you have a unique employee code in there somewhere?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461118885, "post_id": 36732419, "comment_id": 61048910, "body": "you should be able to do this in Excel without the need for VBA as well."}, {"owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "edited": false, "score": 0, "creation_date": 1461119033, "post_id": 36732419, "comment_id": 61048948, "body": "All employee names are unique. If I can make this happen in Excel, without VBA, that would be better for me, but at this point anything that gets me started on the first separation (names) would be great."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461119276, "post_id": 36732419, "comment_id": 61049015, "body": "Sounds like a pivot table."}, {"owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "edited": false, "score": 0, "creation_date": 1461119442, "post_id": 36732419, "comment_id": 61049053, "body": "Unfortunately, it sounds like a lot of things. That is part of the problem. The starting point. As for adding code, I don&#39;t have any yet. Attempting to add some sample data."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "edited": false, "score": 0, "creation_date": 1461120080, "post_id": 36732849, "comment_id": 61049220, "body": "Looks pretty good. I will try this path and see how it works."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "edited": false, "score": 0, "creation_date": 1461120179, "post_id": 36732849, "comment_id": 61049245, "body": "@bubblesTheturtle - after looking into it, it is good practice on SO to mark the answer that answered your question by clicking the check mark next to it. Thanks."}, {"owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "edited": false, "score": 0, "creation_date": 1461120401, "post_id": 36732849, "comment_id": 61049293, "body": "I understand, but let me try it before I get too excited. Thank you for taking the time. I will work on this tomorrow and report back so that future visitors know what worked."}, {"owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "edited": false, "score": 0, "creation_date": 1461154977, "post_id": 36732849, "comment_id": 61068530, "body": "Yep, that about does it. Thanks for all the responses."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 4, "last_activity_date": 1461120082, "last_edit_date": 1461120082, "creation_date": 1461119933, "answer_id": 36732849, "question_id": 36732419, "link": "https://stackoverflow.com/questions/36732419/vba-calculate-individual-hours-from-list-of-multiple-employees/36732849#36732849", "title": "VBA calculate individual hours, from list of multiple employees", "body": "<p>Your description sounds like you want to use a pivot table. They are easy to build - this example literally took me 5 minutes to build, including typing in the data. </p>\n\n<p>As an illustration, you can take data that looks like this ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/VTzqP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VTzqP.png\" alt=\"enter image description here\"></a></p>\n\n<p>and consolidate it in a way that provides a lot of flexibility in looking at it. Such as this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ABtQI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ABtQI.png\" alt=\"enter image description here\"></a></p>\n\n<p>or this</p>\n\n<p><a href=\"https://i.stack.imgur.com/dKLQs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dKLQs.png\" alt=\"enter image description here\"></a></p>\n\n<p>There are several good, simple tutorials available on building Pivot Tables. A google search turns up plenty.</p>\n"}], "owner": {"reputation": 1, "user_id": 6211486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474ae24b6000fcf36c94209d9af20fba?s=128&d=identicon&r=PG&f=1", "display_name": "BubblesTheTurtle", "link": "https://stackoverflow.com/users/6211486/bubblestheturtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "closed_date": 1461270296, "answer_count": 1, "score": -1, "last_activity_date": 1461164799, "creation_date": 1461116725, "last_edit_date": 1461164799, "question_id": 36732419, "link": "https://stackoverflow.com/questions/36732419/vba-calculate-individual-hours-from-list-of-multiple-employees", "closed_reason": "Needs more focus", "title": "VBA calculate individual hours, from list of multiple employees", "body": "<p>I tried to avoid using VBA for this due to my lack of familiarity, but it looks like this is complex enough to require the Excel native language. </p>\n\n<p>What I have is a CSV with a list of employees hours worked each day, all in separate rows. Employee name, Date, Regular Hours, and OT Hours are in separate columns. The challenge is that for employee Bob, there may be 20 rows for one day. Bob applies a slice of time to different projects all day. Then of course there are multiple days and multiple employees. What I am trying to end up with is a report that shows all of the regular and OT hours (separately) for each employee on a daily basis. \nWhat I can't wrap my head around is how to start the compilation. I am guessing that separating each employee would be the start. Then separating each date, then adding all hours for that date. \nI appreciate any assistance. </p>\n\n<pre><code>Emp#    Name    Date        Reg     OT\nEmp1    Bob     1/1/2016    8.00    0.00\nEmp1    Bob     1/4/2016    3.00    0.00\nEmp1    Bob     1/4/2016    5.00    0.00\nEmp1    Bob     1/5/2016    2.00    0.00\nEmp1    Bob     1/5/2016    1.00    0.00\nEmp1    Bob     1/5/2016    5.00    0.00\nEmp1    Bob     1/6/2016    1.00    0.00\nEmp1    Bob     1/6/2016    2.00    0.00\nEmp1    Bob     1/6/2016    5.00    0.00\nEmp1    Bob     1/7/2016    2.00    0.00\nEmp2    Henry   1/1/2016    8.00    0.00\nEmp2    Henry   1/4/2016    8.00    0.00\nEmp2    Henry   1/5/2016    8.00    0.00\nEmp2    Henry   1/6/2016    2.00    0.00\nEmp2    Henry   1/6/2016    6.00    0.00\nEmp2    Henry   1/7/2016    1.50    0.00\nEmp2    Henry   1/7/2016    0.50    0.00\nEmp2    Henry   1/7/2016    6.00    0.00\nEmp2    Henry   1/8/2016    8.00    0.00\nEmp2    Henry   1/11/2016   8.00    0.00\nEmp2    Henry   1/12/2016   3.00    0.00\nEmp2    Henry   1/12/2016   1.00    0.00\nEmp2    Henry   1/12/2016   3.00    0.00\nEmp2    Henry   1/12/2016   1.00    0.00\nEmp2    Henry   1/13/2016   1.50    0.00\n</code></pre>\n"}, {"tags": ["vba", "excel", "regression", "excel-2013"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461121138, "post_id": 36732229, "comment_id": 61049472, "body": "Your title suggests this is an issue with doing regression in Excel. It&#39;s really an issue with programming ranges in Excel VBA. There is a lot of good content on that already in this site. <a href=\"http://stackoverflow.com/questions/22202948/using-range-function-excel-with-variables\">This</a> has a couple of simple examples."}, {"owner": {"reputation": 13, "user_id": 6227653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d8e7b3d8f3471fd06fa200f61ad893?s=128&d=identicon&r=PG&f=1", "display_name": "SilvaAger", "link": "https://stackoverflow.com/users/6227653/silvaager"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461179305, "post_id": 36732229, "comment_id": 61086193, "body": "I&#39;ve had difficulty finding enough information on the Linest function in the capacity that I&#39;m trying to use it (ie. VBA for higher polynomials), so I&#39;ve been struggling to understand exactly what I should be inputting. Can you expand further?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 2699133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c06d04c8d877c514fead7d8f235f952e?s=128&d=identicon&r=PG", "display_name": "GodLovesATrier", "link": "https://stackoverflow.com/users/2699133/godlovesatrier"}, "reply_to_user": {"reputation": 13, "user_id": 6227653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d8e7b3d8f3471fd06fa200f61ad893?s=128&d=identicon&r=PG&f=1", "display_name": "SilvaAger", "link": "https://stackoverflow.com/users/6227653/silvaager"}, "edited": false, "score": 0, "creation_date": 1461177230, "post_id": 36736279, "comment_id": 61084923, "body": "Try stepping through the code and use the locals windows to see what the variables contain. In this case x is a 2d array so I think you&#39;ll need something more like <code>x(1,1)</code>. Also I hadn&#39;t realised originally that you were  regressing against x, x^2, x^3. To do so you&#39;ll need to either add the cells on the spreadsheet or calculate the array yourself to pass to the LinEst function."}, {"owner": {"reputation": 13, "user_id": 6227653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d8e7b3d8f3471fd06fa200f61ad893?s=128&d=identicon&r=PG&f=1", "display_name": "SilvaAger", "link": "https://stackoverflow.com/users/6227653/silvaager"}, "edited": false, "score": 0, "creation_date": 1461177247, "post_id": 36736279, "comment_id": 61084934, "body": "After further investigation, this is just returning the coefficients of the linear trend to the data. How can I modify this to return the cubic or quartic coefficients?"}], "tags": [], "owner": {"reputation": 71, "user_id": 2699133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c06d04c8d877c514fead7d8f235f952e?s=128&d=identicon&r=PG", "display_name": "GodLovesATrier", "link": "https://stackoverflow.com/users/2699133/godlovesatrier"}, "is_accepted": true, "score": 1, "last_activity_date": 1461236776, "last_edit_date": 1461236776, "creation_date": 1461136043, "answer_id": 36736279, "question_id": 36732229, "link": "https://stackoverflow.com/questions/36732229/linest-polynomial-regression-in-excels-vba/36736279#36736279", "title": "Linest Polynomial Regression in Excel&#39;s VBA", "body": "<p>The first comment on your question puts you on the right track, <code>Application.Evaluate</code> takes a string (you have to build the reference to the range in that string). The second method using <code>Range</code> and <code>Cells</code> creates an object reference to the <code>Range</code>, if you want to use object references then instead of evaluating a string you would pass the references to <code>Application.WorksheetFunction.LinEst</code>.</p>\n\n<p>Here's an example using the cell references in your original question. </p>\n\n<pre><code>Public Sub TestLinest()\n\nDim x\nDim i as long\nDim evalString As String\nDim sheetDisplayName As String\nDim polyOrder as string\n\n' this is whatever the name of your sheet containing data:\nsheetDisplayName = \"Sheet1\"\n' this gets the index of the last cell in the data range\ni = Range(sheetDisplayName &amp; \"!A17\").End(xlDown).Row\n' Obviously change this depending on how many polynomial terms you need\npolyOrder = \"{1,2,3}\"\n\nevalString = \"=linest(\" &amp; sheetDisplayName &amp; \"!E6:E\" &amp; i &amp; \", \" &amp; sheetDisplayName &amp; \"!D6:D\" &amp; i &amp; \"^\" &amp; polyOrder &amp; \")\"\nx = Application.Evaluate(evalString)\n\nCells(3, 8) = x(1)\nCells(4, 8) = x(2)\nCells(5, 8) = x(3)\nCells(6, 8) = x(4) \n\nEnd Sub\n</code></pre>\n\n<p>You can see there are a couple of magic variables to fill in, in terms of ranges, sheet names and polynomial order. Perhaps this routine could be expanded to pass those as arguments to a function and return an array of coefficients?</p>\n\n<hr> \n\n<p>At this point it might be worth mentioning that you could achieve all this without using VBA, which would mean that the spreadsheet logic remains more visible to you and/or your users. Here are some example functions to enable you to do all this on a sheet, here's the gist of it:</p>\n\n<p>Get the total number of filled in cells (lets say this is in A1)</p>\n\n<pre><code>=COUNT(A17:A10000)\n</code></pre>\n\n<p>Enter this as an array formula:</p>\n\n<pre><code>=LINEST(INDIRECT(\"G17:G\"&amp;(A1+16)), INDIRECT(\"A17:A\"&amp;(A1+16))^{1,2,3})\n</code></pre>\n\n<p>The 16 and {1,2,3} in this formula can obviously be changed to suit your situation.</p>\n"}], "owner": {"reputation": 13, "user_id": 6227653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d8e7b3d8f3471fd06fa200f61ad893?s=128&d=identicon&r=PG&f=1", "display_name": "SilvaAger", "link": "https://stackoverflow.com/users/6227653/silvaager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4554, "favorite_count": 0, "accepted_answer_id": 36736279, "answer_count": 1, "score": 0, "last_activity_date": 1461236776, "creation_date": 1461115377, "last_edit_date": 1461179627, "question_id": 36732229, "link": "https://stackoverflow.com/questions/36732229/linest-polynomial-regression-in-excels-vba", "title": "Linest Polynomial Regression in Excel&#39;s VBA", "body": "<p>I am having issues finding information on using Linest in Excel's VBA in a subroutine. I need to return the polynomial coefficients (third or fourth order) for a column of x values (Column A beginning in Row 17) and a column of y values (Column G beginning in Row 17).</p>\n\n<p>The code I am currently using is shown below, and it works.</p>\n\n<pre><code>Dim X\nX = Application.Evaluate(\"=linest(g17:g61,A17:A61^{1,2,3})\")\nCells(3, 8) = X(1)\nCells(4, 8) = X(2)\nCells(5, 8) = X(3)\nCells(6, 8) = X(4) \n</code></pre>\n\n<p>Essentially, I need to be able to make this subroutine work on any length of data. Data will always begin to be entered in row 17. To do this, I have been trying to use code similar to that shown below.  </p>\n\n<pre><code>Range(Cells(i, 1), Cells(Cells(Rows.Count, 1).End(xlUp).Row, 1)), Range(Cells(i, 2), Cells(Cells(Rows.Count, 2).End(xlUp).Row, 2))\n</code></pre>\n\n<p>However, when I use similar ranges to those above instead of <code>G17:G61</code> I get type mismatch errors. I don't understand why a range of cells is different from a range of cells in the format <code>G17:G61</code>. I've also tried using the simple <code>Range(Cells(17,1),Cells(61,1))</code> instead of <code>A17:A61</code>.</p>\n\n<p>I have also tried using <code>\"G\" &amp; 17:\"G\" &amp; 61</code> instead of <code>G:17:G61</code> as I have seen some do while browsing, but that doesn't seem to fix my issues either.</p>\n\n<p>Is there another function that might be better?</p>\n\n<p>Please help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1737, "user_id": 3951929, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dcae1b2ce2db935c665c6ff45496d966?s=128&d=identicon&r=PG", "display_name": "Eduardo", "link": "https://stackoverflow.com/users/3951929/eduardo"}, "is_accepted": false, "score": 0, "last_activity_date": 1461415197, "creation_date": 1461415197, "answer_id": 36810936, "question_id": 36731884, "link": "https://stackoverflow.com/questions/36731884/excel-vba-xlmarkerstyle-not-plotting/36810936#36810936", "title": "Excel VBA xlMarkerStyle not plotting", "body": "<p>this is half an answer since it provides an explanation on why your code does not plot the individual line markers, but fails to give you the right way to do it. If you want me to take a closer look at your problem you must provide your worksheet so I can evaluate the details of your chart.</p>\n\n<p>On the other hand, your code is quite repetitive and therefore inefficient. </p>\n\n<p>I now discuss this 2 issues.</p>\n\n<ol>\n<li><p><code>Point</code> object does not have a <code>Border</code> method. This is the reason\nwhy your code is not working. This means you cannot write code things like:</p>\n\n<p><code>.Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border</code> <br><br>\nIf you want to know what methods does <code>Point</code> object has, press F2 while on VBE. If you want to know more about objects and methods you can try <a href=\"http://analysistabs.com/excel-vba/objects-properties-methods/\" rel=\"nofollow\">analysistabs.com</a> or <a href=\"http://www.dummies.com/how-to/content/object-properties-and-methods-in-excel-2016-vba-pr.html\" rel=\"nofollow\">dummies.com</a> and then <a href=\"http://www.excel-spreadsheet.com/vba/objecthierarchy.htm\" rel=\"nofollow\">excel-spreadsheet.com</a>. Again, I will be able to assist you if you share your worksheet.</p></li>\n<li><p>You repeat 32 times the code <br><br>\n<code>.Shapes(\"CHART3\").Chart.SeriesCollection(1).Points(i + 1)</code><br><br> You can\navoid this by declaring a variable <code>p</code> of type <code>Point</code> and assign\nits value right after the for-loop. I give you an ideia how can you achieve this, but for it to work properly, you should share your worksheet.\n<br><br></p>\n\n<pre><code>Sub tropical_cyclone_track_format()\n\nDim r As Range\nSet r = ActiveSheet.Range(\"E24:E31\")\n\nDim i As Integer\nFor i = 1 To ActiveSheet.Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points.Count - 1\n\nDim p As Point\nSet p = ActiveSheet.Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1)\n\nIf r(i) = \"1\" Then\n    With p\n\n        p.MarkerSize = xlMarkerStyleCircle\n        p.MarkerStyle = 2\n        p.MarkerBackgroundColor = RGB(0, 0, 0)\n        p.MarkerForegroundColor = RGB(0, 0, 0)\n        p.Format.Line.Transparency = 0\n        p.Format.Line.Weight = 1\n\n    End With\nEnd If\n\nIf r(i) = \"2\" Then\n    With p\n\n        p.MarkerSize = xlMarkerStyleCircle\n        p.MarkerStyle = 2\n        p.MarkerBackgroundColor = RGB(0, 0, 0)\n        p.MarkerForegroundColor = RGB(0, 0, 0)\n        p.Format.Line.Transparency = 0\n        p.Format.Line.Weight = 1\n\n    End With\nEnd If\n\nIf r(i) = \"3\" Then\n    With p\n\n        p.MarkerSize = xlMarkerStyleCircle\n        p.MarkerStyle = 2\n        p.MarkerBackgroundColor = RGB(0, 0, 0)\n        p.MarkerForegroundColor = RGB(0, 0, 0)\n        p.Format.Line.Transparency = 0\n        p.Format.Line.Weight = 1\n\n    End With\nEnd If\n\nIf r(i) = \"4\" Then\n    With p\n\n        p.MarkerSize = xlMarkerStyleCircle\n        p.MarkerStyle = 2\n        p.MarkerBackgroundColor = RGB(0, 0, 0)\n        p.MarkerForegroundColor = RGB(0, 0, 0)\n        p.Format.Line.Transparency = 0\n        p.Format.Line.Weight = 1\n\n    End With\nEnd If\nNext i\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 6227576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a206d233a4bb6ab396c902b62357e86?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6227576/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1461415197, "creation_date": 1461113012, "last_edit_date": 1531164843, "question_id": 36731884, "link": "https://stackoverflow.com/questions/36731884/excel-vba-xlmarkerstyle-not-plotting", "title": "Excel VBA xlMarkerStyle not plotting", "body": "<p>The following Excel VBA module is designed to change the color of various line segments based on a condition. It works great except that it will not plot the individual line markers. The problem apparently exists in each of the xlMarkerStyleCircle, MarketSize, MarkerBackgroundColor, and MarkerForegroundColor lines. I'm not sure if the problem is a related to improper object naming or improper sequencing of the object references. Any help or suggestions would be much appreciated. Likewise, if anyone sees a more efficient way of coding the same objective, please feel free to share.</p>\n\n<p>Thanks kindly...</p>\n\n<p>Cheers,\nJohn</p>\n\n<hr>\n\n<pre><code>  Sub tropical_cyclone_track_format()\n\n  With ActiveSheet\nSet r = .Range(\"E24:E31\")\nFor i = 1 To .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points.Count - 1\n\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerStyle = xlMarkerStyleCircle\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerSize = 2\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerBackgroundColor = RGB(0, 0, 0)\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerForegroundColor = RGB(0, 0, 0)\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.LineStyle = xlContinuous\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.Color = RGB(255, 255, 64)\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Transparency = 0\n  If r(i) = \"1\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Weight = 1\n\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerStyle = xlMarkerStyleCircle\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerSize = 2\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerBackgroundColor = RGB(0, 0, 0)\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerForegroundColor = RGB(0, 0, 0)\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.LineStyle = xlContinuous\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.Color = RGB(255, 153, 16)\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Transparency = 0\n  If r(i) = \"2\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Weight = 1\n\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerStyle = xlMarkerStyleCircle\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerSize = 2\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerBackgroundColor = RGB(0, 0, 0)\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerForegroundColor = RGB(0, 0, 0)\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.LineStyle = xlContinuous\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.Color = RGB(255, 3, 0)\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Transparency = 0\n  If r(i) = \"3\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Weight = 1\n\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerStyle = xlMarkerStyleCircle\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerSize = 2\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerBackgroundColor = RGB(0, 0, 0)\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).MarkerForegroundColor = RGB(0, 0, 0)\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.LineStyle = xlContinuous\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Border.Color = RGB(80, 0, 0)\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Transparency = 0\n  If r(i) = \"4\" Then .Shapes(\"CHART 3\").Chart.SeriesCollection(1).Points(i + 1).Format.Line.Weight = 1\n\n  Next i\n  End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "random-sample"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461125521, "post_id": 36731494, "comment_id": 61050604, "body": "Have you built any VBA code we can help you with?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461126208, "post_id": 36731494, "comment_id": 61050787, "body": "Further clarifying your logic, in 2006, Firm 2 has 4 peers. There are 7 total peer firms in 2006. But I need to exclude the ones Firm 2 actually had, so I need to randomly pick 4 firms from (7-4=3) 3 firms. How is that handled? Similarly - is this a pick and replace problem, or a pick and exclude problem? e.g. choose (1 from 4, 1 from 4, 1 from 4) or choose (1 from 4, 1 from 3, 1 from 2)?"}, {"owner": {"reputation": 11, "user_id": 6194098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgVHB.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/6194098/kerem"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461141375, "post_id": 36731494, "comment_id": 61058725, "body": "Hi! Many thanks for your comment! I have tried patching some codes I have found inline but so far I have nothing concrete to put here. In the case of Firm 2, it shouldn&#39;t be a problem in the actual sample, since it is sufficiently large. Finally, yes, this is a pick and exclude problem, ideally all randomly assigned values should be different. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6194098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgVHB.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/6194098/kerem"}, "is_accepted": true, "score": 0, "last_activity_date": 1461513110, "last_edit_date": 1495540778, "creation_date": 1461513110, "answer_id": 36825446, "question_id": 36731494, "link": "https://stackoverflow.com/questions/36731494/random-sampling-selection-by-category-vba/36825446#36825446", "title": "Random Sampling &amp; Selection by Category VBA", "body": "<p>Many thanks to everyone who has visited my post. </p>\n\n<p>After some initial struggling, I have managed to figure out the code myself. I am posting it below for anyone who might need it.</p>\n\n<p>Basically I used the randomisation code posted by <a href=\"https://stackoverflow.com/questions/5753063/random-selection-from-list\">this</a> gentle soul, and enhanced it for my needs using couple of flags for each new firm and each new year. Hope it is clear for everyone.</p>\n\n<p>Best</p>\n\n<pre><code>    Sub Random_Sampling()\n    '\n    Dim PeerCount, FirmCount, YearCount As Long\n    Dim Focal_CIK, fiscalYear As Long\n    Const nItemsTotal As Long = 1532\n    Dim rngList As Range\n    Dim FirmYearRange As Range\n    Dim FirmStart, FirmStartRow, YearStartRow As Long\n    Dim ExistingPeers As Range\n    Dim idx() As Long\n    Dim varRandomItems() As Variant\n    Dim i, j, k, m, n As Long\n    Dim iCntr, jCntr As Long\n    Dim booIndexIsUnique As Boolean\n\n    Set rngList = Sheets(\"Sheet2\").Range(\"A2\").Resize(nItemsTotal, 1)\n\n    FirmCount = Cells(2, 10).Value\n\nFor k = 1 To FirmCount\n\n    FirmStart = Application.WorksheetFunction.Match(k, Columns(\"E\"), 0)\n    Focal_CIK = Cells(FirmStart, 1).Value\n    YearCount = Cells(FirmStart, 7).Value\n\n  For m = 1 To YearCount\n\n    Set FirmYearRange = Range(\"H\" &amp; FirmStart &amp; \":H200000\")\n    YearStartRow = Application.WorksheetFunction.Match(m, FirmYearRange, 0) + FirmStart - 1\n    fiscalYear = Cells(YearStartRow, 3).Value\n    PeerCount = Cells(YearStartRow, 9).Value\n    Set ExistingPeers = Range(Cells(YearStartRow + PeerCount, 2), Cells(YearStartRow + PeerCount, 2))\n\n    ReDim idx(1 To PeerCount)\n    ReDim varRandomItems(1 To PeerCount)\n\n    For i = 1 To PeerCount\n\n        Do\n            booIndexIsUnique = True ' Innoncent until proven guilty\n\n            idx(i) = Int(nItemsTotal * Rnd + 1)\n\n            For j = 1 To i - 1\n                If idx(i) = idx(j) Then 'Is already picked\n                     ElseIf idx(i) = Focal_CIK Then 'Is the firm itself\n                        booIndexIsUnique = False 'If true, don't pick it\n                    Exit For\n                End If\n\n                For n = 1 To PeerCount\n                   If idx(i) = Cells(YearStartRow + n - 1, 2).Value Then 'Is one of the actual peers\n                        booIndexIsUnique = False 'If true, don't pick it\n                   Exit For\n                  Exit For\n                End If\n               Next n\n            Next j\n            If booIndexIsUnique = True Then\n                Exit Do\n            End If\n        Loop\n\n        varRandomItems(i) = rngList.Cells(idx(i), 1)\n\n        Rows(YearStartRow + PeerCount).EntireRow.Insert\n\n        'The order of the columns are very important for the following lines\n        Cells(YearStartRow + PeerCount, 1) = Focal_CIK\n        Cells(YearStartRow + PeerCount, 2) = varRandomItems(i)\n        Cells(YearStartRow + PeerCount, 3) = fiscalYear\n        Cells(YearStartRow + PeerCount, 4) = \"0\"\n\n    Next i\n\n   Next m\n\nNext k\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6194098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgVHB.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/6194098/kerem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2898, "favorite_count": 0, "accepted_answer_id": 36825446, "answer_count": 1, "score": 1, "last_activity_date": 1461513110, "creation_date": 1461110360, "last_edit_date": 1531164843, "question_id": 36731494, "link": "https://stackoverflow.com/questions/36731494/random-sampling-selection-by-category-vba", "title": "Random Sampling &amp; Selection by Category VBA", "body": "<p>I am trying to write a macro on MS Excel, which will enable me to create random samples and pick random values from those samples for each category in the data.</p>\n\n<p>To be more specific, the data is at 2 levels: firm and year, where each row represents a firm-year-peer observation. For each firm i, at a given year j, we have number of actual peers. </p>\n\n<p>What I want to do is assign to each firm, from the whole sample throughout many years, a random firm from the list of all available firms at that specific year. The trick is that the number of firms to be assigned should be identical to the number of actual peers that a firm has at that year. Also, the randomly assigned values should be different from the firm's actual peers, and of course, the firm itself.</p>\n\n<pre><code>i           j            k\n1           2006        100\n1           2006        105\n1           2006        110\n2           2006        113\n2           2006        155\n2           2006        200\n2           2006        300\n</code></pre>\n\n<p>For example, Firm 1's actual peers in year 2006 are 100, 105 and 110. However, all possible firms available are 100, 105, 110, 113, 155, 200 and 300. This means that I have to select 3 (because Firm 1 has 3 actual peers) random fictional peers from the 4 firms that are not Firm 1's peer that year (i.e. 113, 155, 200 and 300). Applying the same procedure for Firm 2, I need to select 4 random firms that are not Firm 2's actual peers from all possible firms.</p>\n\n<p>I hope this was clear. </p>\n\n<p>I started trying this function out on MS Excel, but I am open to suggestions if you think other platforms would be more useful.</p>\n\n<p>Your help would be very much appreciated!  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 436, "user_id": 1752816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079adddb5b9ce83b620808d7ba50070d?s=128&d=identicon&r=PG", "display_name": "oortCloud", "link": "https://stackoverflow.com/users/1752816/oortcloud"}, "edited": false, "score": 1, "creation_date": 1461110510, "post_id": 36731436, "comment_id": 61046790, "body": "Look at Do Until Cells(i, 1) = &quot;Runs&quot;... if Cells(i,1) &lt;&gt; &quot;Runs&quot;, this loop will run forever since nothing in this loop is modifying i"}], "answers": [{"tags": [], "owner": {"reputation": 872, "user_id": 4084981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vIO6i.png?s=128&g=1", "display_name": "Wes Larson", "link": "https://stackoverflow.com/users/4084981/wes-larson"}, "is_accepted": false, "score": 1, "last_activity_date": 1461110633, "creation_date": 1461110633, "answer_id": 36731530, "question_id": 36731436, "link": "https://stackoverflow.com/questions/36731436/why-does-this-code-keep-looping/36731530#36731530", "title": "Why does this code keep looping?", "body": "<p>Something isn't right about your loop.</p>\n\n<pre><code>Do Until Cells(i, 1) = \"Runs\"\n</code></pre>\n\n<p>I don't see anywhere in your loop that changes the value of this cell to \"Runs\".  And I don't see anywhere in your loop that increments the value of <code>i</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6227507, "user_type": "registered", "profile_image": "https://graph.facebook.com/263809000628238/picture?type=large", "display_name": "Ryan Canty", "link": "https://stackoverflow.com/users/6227507/ryan-canty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461115764, "creation_date": 1461109969, "last_edit_date": 1461115764, "question_id": 36731436, "link": "https://stackoverflow.com/questions/36731436/why-does-this-code-keep-looping", "title": "Why does this code keep looping?", "body": "<p>We are stuck in a loop and cannot get it to continue to pull values. This code will just pull the first value and keep looping.</p>\n\n<pre><code>Sub createpbp()\n\n    Dim iRows As Integer\n    Dim i As Integer 'webtext row counter\n    Dim iR As Integer\n    Dim iPr As Integer 'row counter for pbp worksheet\n    Dim wksWT As Worksheet\n\n\n    iPr = 1\n\n    Set wksWT = Worksheets(\"Webtext\") 'creating a variable for the text pulled from website\n\n    wksWT.Activate 'activate the webtext sheet\n\n    iRows = wksWT.UsedRange.rows.Count 'counts rows in the play by play\n\n    For i = 1 To iRows 'row 1 to end of rows\n        If Cells(i, 1) = \"Play By Play Innings\" Then 'if the cell value says play by play innings\n            Do Until Cells(i, 1) = \"Runs\" 'continue doing the following until reach end of inning\n                Cells(i, 1).Copy 'copy the value of the first event in inning\n                Sheets(\"Play by Play text\").Select 'open up new worksheet\n                If Cells(iPr, 1) = Null Then\n                    Cells(iPr, 1).Paste\n                Else\n                    iPr = iPr + 1\n                End If\n            Loop\n        End If\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "web-services", "excel", "business-objects"], "comments": [{"owner": {"reputation": 6468, "user_id": 3165737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Y8F1n.gif?s=128&g=1", "display_name": "\u0198\u024c\u1ec8S\u01ac\u01a0\u0191", "link": "https://stackoverflow.com/users/3165737/%c6%98%c9%8c%e1%bb%88s%c6%ac%c6%a0%c6%91"}, "edited": false, "score": 0, "creation_date": 1461147594, "post_id": 36731286, "comment_id": 61063445, "body": "From what I could find, the <code>SAPLogon</code> function only allows you to connect to SAP systems, not to BIP. There is no option to provide the URL or authentication type."}], "answers": [{"comments": [{"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 0, "creation_date": 1461791811, "post_id": 36736115, "comment_id": 61366225, "body": "It seems like this is the only option. I have asked this question on the SAP SCN also; if I do not get a different answer there, I will accept this answer."}, {"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 0, "creation_date": 1462386318, "post_id": 36736115, "comment_id": 61620765, "body": "Well, it&#39;s not the answer I was hoping for, but I have been unable to find any options in VBA. Thank you for your response and for sharing your bo-utils project; I am working through the source code now to see if I can adapt it to my needs."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1461135594, "creation_date": 1461135594, "answer_id": 36736115, "question_id": 36731286, "link": "https://stackoverflow.com/questions/36731286/automating-a-web-service-login-for-sap-business-objects-in-vba/36736115#36736115", "title": "Automating a Web Service Login for SAP Business Objects in VBA", "body": "<p>I don't think it's possible since the provided libraries to connect the web services are only for .Net and Java. I've tried to build the SOAP envelops from the WSDL, but never managed to make it work. However it's relatively easy to use the libraries from the SDK. I once built an addin for Excel in CShap to manage and refresh the reports directly from Excel: <a href=\"https://code.google.com/archive/p/bo-utils/\" rel=\"nofollow\">https://code.google.com/archive/p/bo-utils/</a> </p>\n"}], "owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2296, "favorite_count": 0, "accepted_answer_id": 36736115, "answer_count": 1, "score": 2, "last_activity_date": 1492285302, "creation_date": 1461108916, "last_edit_date": 1531164843, "question_id": 36731286, "link": "https://stackoverflow.com/questions/36731286/automating-a-web-service-login-for-sap-business-objects-in-vba", "title": "Automating a Web Service Login for SAP Business Objects in VBA", "body": "<p>Is it possible to automate the login to SAP Business Objects <strong>Web Services</strong> using the Analysis for Microsoft Excel COM add-in in Excel? When I run my code, I am presented with the below \"Logon to SAP BusinessObjects BI Platform\" window requiring a user to manually enter their web services credentials (note: these are not the same as their SAP credentials). Ideally, I would be able to set all fields (user, password, web service URL, System, and Authentication) without any user interaction.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XNY6V.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XNY6V.jpg\" alt=\"Web Service Logon Window\"></a></p>\n\n<p>I am attempting to automate the refresh of Excel workbooks connected to SAP Business Objects using VBA code. From reviewing the developer documentation available on SAP (see <a href=\"http://help.sap.com/businessobject/product_guides/AMS14/en/14SP2_aaoffice_user_en.pdf\" rel=\"nofollow noreferrer\" title=\"SAP Analysis Developer Guide\">here</a>), I am able to automate most commands. There is also a command \"SAPLogon\", but this is only able to provide the SAP logon credentials, not the web service ones.</p>\n\n<p>A sample of my code is below:</p>\n\n<pre><code>'Refresh dashboard\nLResult = Application.Run(\"SAPExecuteCommand\", \"PauseVariableSubmit\", \"Off\")\nLResult = Application.Run(\"SAPSetRefreshBehaviour\", \"On\")\nLResult = Application.Run(\"SAPExecuteCommand\", \"Refresh\")\nIf LResult = 0 Then\n    'Refresh failed. Exit with error.\n    StrMsg = \"Unable to retrieve variables or refresh any data; script will now exit.  Please close Excel, open a new instance of Analysis for Microsoft Excel, and try again.\"\n    LogMsg StrMsg\n    MsgBox StrMsg\n    GoTo Exit_UpdateDashboard\nEnd If\n</code></pre>\n\n<p>Prior to executing this block of code, I am hoping to automate the user login. I have extensively researched this and cannot find any examples of someone automating the web service login through VBA. Some of the links I've tried so far are:</p>\n\n<ul>\n<li><a href=\"http://www.d1-solutions.com/fileadmin/user_upload/d1solutions/Papers/Standard-Developmentkit-Adrian-Wyss-D1-Solutions-Zurich.pdf\" rel=\"nofollow noreferrer\">Shows a web service login in Java, not VBA</a> </li>\n<li><a href=\"http://www.dvwsolutions.com/blog/entry/how-to-upload-data-from-ms-excel-directly-into-sap-bw-without-a-big-investment-of-time-money-and-effort.html\" rel=\"nofollow noreferrer\">Uses web services through VBA to upload data; I cannot figure out the relevant portions of this code</a></li>\n<li><a href=\"https://scn.sap.com/thread/3620729\" rel=\"nofollow noreferrer\">Similar question asked at the end of this SAP SCN thread</a></li>\n</ul>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 4242182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480dc26b959b71a5c9bd9110fd4808b7?s=128&d=identicon&r=PG&f=1", "display_name": "tdub4034", "link": "https://stackoverflow.com/users/4242182/tdub4034"}, "edited": false, "score": 0, "creation_date": 1461105139, "post_id": 36730610, "comment_id": 61045062, "body": "I posted an image of original output and the reformatted report."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 1, "creation_date": 1461105690, "post_id": 36730610, "comment_id": 61045262, "body": "Please also post your code and what isn&#39;t working for you."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461105826, "post_id": 36730610, "comment_id": 61045312, "body": "@OldUgly they never have code XD"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461105861, "post_id": 36730610, "comment_id": 61045338, "body": "second time I have seen this, what does the s/b in the question refer to?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461106004, "post_id": 36730610, "comment_id": 61045379, "body": "@ForwardEd - I am going to guess it&#39;s dyslexia: 112 should be 121. Don&#39;t know what s/b means, however. (should be?)"}, {"owner": {"reputation": 3, "user_id": 4242182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480dc26b959b71a5c9bd9110fd4808b7?s=128&d=identicon&r=PG&f=1", "display_name": "tdub4034", "link": "https://stackoverflow.com/users/4242182/tdub4034"}, "edited": false, "score": 0, "creation_date": 1461109723, "post_id": 36730610, "comment_id": 61046553, "body": "Yeah, correct, it should be (s/b) &quot;121&quot;. I was in a rush leaving work."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461112484, "post_id": 36730610, "comment_id": 61047255, "body": "Questions:  1)  Do the unit numbers have leading spaces or are the cells formatted to indent.  2) Does the character - ever show up in the cell with a unit number?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461113856, "post_id": 36730610, "comment_id": 61047639, "body": "@tdub4034 - have you developed any code that we can help you with? Or are you hoping that SO to gift a solution to you?"}], "answers": [{"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 1, "last_activity_date": 1461124324, "last_edit_date": 1461124324, "creation_date": 1461118389, "answer_id": 36732613, "question_id": 36730610, "link": "https://stackoverflow.com/questions/36730610/i-need-to-move-a-subsets-subheader-from-one-cell-place-its-value-adjacent-to-it/36732613#36732613", "title": "i need to move a subset&#39;s subheader from one cell place its value adjacent to its respective row", "body": "<p>There are better ways to code the following but this will do what you require based on the information you supplied.  It will not do the formatting.  You can record a separate macro for that yourself, or just format manually.  </p>\n\n<p>If you are doing this operation multiple times, there are ways of automating last row, header row, and column numbers.  I have essentially hard coded them, but you could also tweak this to work with selected range, but I was not that bored, nor are my skills that advanced.</p>\n\n<pre><code>Option Explicit\n\nSub MakeReport()\nDim HeaderRow, FirstRow, LastRow, sPropertyCol, sTenantCol, dPropertyCol, dUnitCol, dTenantCol, CounterX, CounterY As Long\nDim wsSource, wsDest As Worksheet\nDim PropertyNumber As String\n\n'This chunk of code defines where the source information is and\n'were destination information goes in terms of column and row numbers\n\nHeaderRow = 2\nFirstRow = 3\nLastRow = 19\n\nsPropertyCol = 1\nsTenantCol = 2\n\ndPropertyCol = 1\ndUnitCol = 2\ndTenantCol = 3\n\n'This is the first row of Data on the destination sheet\nCounterY = 2\n\n'rename the sheets as required to suit your sheet names\nSet wsSource = Worksheets(\"Sheet1\")\nSet wsDest = Worksheets(\"Sheet2\")\n\n'Taking care of the rearranged header inofrmation\nwsDest.Range(\"A1\") = wsSource.Range(\"A1\")\nwsDest.Range(\"B1\") = wsSource.Range(\"A2\")\nwsDest.Range(\"C1\") = wsSource.Range(\"B1\") &amp; \" \" &amp; wsSource.Range(\"B2\")\n\n'Loop through data check if its a total row then\n'Check if its a property row\n'otherwise treat it as a unit row\n'Does not eliminate blank lines, just repeats them\n\nFor CounterX = FirstRow To LastRow\n    If InStr(wsSource.Cells(CounterX, sPropertyCol).Value, \"Total\") = 0 Then\n        If InStr(wsSource.Cells(CounterX, sPropertyCol).Value, \"-\") &lt;&gt; 0 Then\n           PropertyNumber = Left(wsSource.Cells(CounterX, sPropertyCol).Value, InStr(wsSource.Cells(CounterX, sPropertyCol).Value, \"-\") - 2)\n        Else\n           wsDest.Cells(CounterY, dPropertyCol).Value = PropertyNumber\n           wsDest.Cells(CounterY, dUnitCol).Value = wsSource.Cells(CounterX, sPropertyCol).Value\n           wsDest.Cells(CounterY, dTenantCol).Value = wsSource.Cells(CounterX, sTenantCol).Value\n           'increase the row you are going to write to next\n           CounterY = CounterY + 1\n        End If\n    Else\n        wsDest.Cells(CounterY, dUnitCol).Value = wsSource.Cells(CounterX, sPropertyCol).Value\n        'increase the row you are going to write to next\n        CounterY = CounterY + 1\n    End If\nNext CounterX\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461123875, "post_id": 36732941, "comment_id": 61050173, "body": "interesting tweaks.  Questions:  1)  Is the on error resume next there to catch the total row since both the total row and the first property row both have &quot;-&quot; in them?  2)  Do this method maintain leading zeros or does it convert the string to numbers..or is that what the nZeros is for?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461124077, "post_id": 36732941, "comment_id": 61050225, "body": "1) Yes. 2)It converts to number so the zeros get lost. So I count the zeros (nZeros) and format the cell to display them. ZeroStr ends up being &quot;0000&quot; or &quot;000&quot;. I think there&#39;s a more efficient way to do this, but haven&#39;t looked it up yet."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461124494, "post_id": 36732941, "comment_id": 61050369, "body": "Jeeped had a nice way of doing it if you were keeping it a s a string using excel formulas.  No reason it would not work here.  Just concatenate a huge string of just &quot;000000000&quot; to the left side, then take a RIGHT ( big string, number of characters to display)"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1461120659, "creation_date": 1461120659, "answer_id": 36732941, "question_id": 36730610, "link": "https://stackoverflow.com/questions/36730610/i-need-to-move-a-subsets-subheader-from-one-cell-place-its-value-adjacent-to-it/36732941#36732941", "title": "i need to move a subset&#39;s subheader from one cell place its value adjacent to its respective row", "body": "<p>Same answer, some different techniques ...</p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim srcSht As Worksheet, tarSht As Worksheet\nDim srcRng As Range, tarRange As Range\nDim myCell As Range, myStr As String, ZeroStr As String\nDim myFacility As Long, nZeros As Long\nDim srcFirstRow As Long, srcLastRow As Long, tarLastRow As Long\nDim iLoop As Long, jLoop As Long, iCount As Long\n\n\n' initialize\n    Set srcSht = Worksheets(\"Sheet1\") '&lt;~~ pick the sheet names you need\n    Set tarSht = Worksheets(\"Sheet2\")\n\n    srcFirstRow = 3\n    srcLastRow = srcSht.Range(\"A\" &amp; srcSht.Rows.Count).End(xlUp).Row\n    Set srcRng = srcSht.Range(srcSht.Cells(1, 1), srcSht.Cells(srcLastRow, 3))\n\n    myFacility = -1\n    iCount = 1\n' prepare the target sheet\n    tarLastRow = tarSht.Range(\"B\" &amp; tarSht.Rows.Count).End(xlUp).Row\n    tarSht.Range(tarSht.Cells(1, 1), tarSht.Cells(tarLastRow, 3)).Delete (xlUp)\n    tarSht.Range(\"A1\").Value = \"Property\"\n    tarSht.Range(\"B1\").Value = \"Unit\"\n    tarSht.Range(\"C1\").Value = \"Tenant Code\"\n' you may want to add some formatting of the target sheet at this point\n\n\n    For iLoop = srcFirstRow To srcLastRow\n        myStr = \"\"\n        If InStr(srcRng.Range(\"A\" &amp; iLoop).Value, \"-\") Then\n' find the facility heading, the number goes in myFacility\n            myStr = Trim(Split(srcRng.Range(\"A\" &amp; iLoop), \"-\")(0))\n            myFacility = -1\n            On Error Resume Next\n                If Len(myStr) &gt; 0 Then myFacility = CLng(myStr)\n            On Error GoTo 0\n            If myFacility = -1 Then\n                iCount = iCount + 1\n                tarSht.Cells(iCount, 2).Value = srcRng.Cells(iLoop, 1).Value\n            End If\n        Else\n' put values in target sheet\n            iCount = iCount + 1\n            tarSht.Cells(iCount, 1).Value = myFacility\n            tarSht.Cells(iCount, 2).Value = srcRng.Range(\"A\" &amp; iLoop).Value\n            nZeros = Len(Trim(srcRng.Range(\"A\" &amp; iLoop).Value))\n            ZeroStr = \"\"\n            For jLoop = 1 To nZeros\n                ZeroStr = ZeroStr &amp; \"0\"\n            Next jLoop\n            tarSht.Range(\"B\" &amp; iCount).NumberFormat = ZeroStr '&lt;~~ set this as needed\n            tarSht.Cells(iCount, 3).Value = srcRng.Range(\"B\" &amp; iLoop).Value\n        End If\n\n    Next iLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4242182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480dc26b959b71a5c9bd9110fd4808b7?s=128&d=identicon&r=PG&f=1", "display_name": "tdub4034", "link": "https://stackoverflow.com/users/4242182/tdub4034"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 36732613, "answer_count": 2, "score": -1, "last_activity_date": 1461161839, "creation_date": 1461104949, "last_edit_date": 1461161839, "question_id": 36730610, "link": "https://stackoverflow.com/questions/36730610/i-need-to-move-a-subsets-subheader-from-one-cell-place-its-value-adjacent-to-it", "title": "i need to move a subset&#39;s subheader from one cell place its value adjacent to its respective row", "body": "<p>The request sounded simple enough: \"I need you to create some code that would create a column, move the property codes to the same row as the units...\". I thought \"Cool, I'll send the code via email - after I make this project my bitch...\". That was two days ago...</p>\n\n<p>Below is a snippet of the report and the finished output. Thanks in advance for your help. Needless to say, this project was humbling. Oh yeah, I noticed the last MultiFamily unit \"112\" s/b \"112\". I'll correct that.</p>\n\n<p>Report before/after</p>\n\n<p><a href=\"https://i.stack.imgur.com/WclXS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WclXS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The actual report is over 5K records but the format is the same. Below is the actual data:</p>\n\n<pre><code>Fig 1.\n           (A)                                  |   (B)\n(01)  Property                                  | Tenant  \n(02)  Unit                                      | Code\n(03)  118 - MultiFamily Facility 1              |\n(04)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00118   \u00a0\u00a0\u00a0                         | t0103001\n(05)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00121   \u00a0\u00a0\u00a0                         | t0077028\n(06)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00124   \u00a0\u00a0\u00a0                         | t0099589\n(07)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Total 118 - MultiFamily Facility 1 |\n(08)  119 - MultiFamily Facility 2              |\n(09)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0001    \u00a0\u00a0\u00a0                         | t0103128\n(10)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0002                \u00a0\u00a0\u00a0             | t0101985\n(11)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0003    \u00a0\u00a0\u00a0                         | t0102938\n(12)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Total 119 - MultiFamily Facility 2 |\n(13)  121 - MultiFamily Facility 3              |\n(14)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0001    \u00a0\u00a0\u00a0                         | t0099507\n(15)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0002    \u00a0\u00a0\u00a0                         | t0101773\n(16)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0003    \u00a0\u00a0\u00a0                         | t0103123\n(17)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0004    \u00a0\u00a0\u00a0                         | t0099821\n(18)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0005    \u00a0\u00a0\u00a0                         | t0077281\n(19)  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Total 121- MultiFamily Facility 3  |  \n\n\nfig.2\n\n      (A)      |    (B)    |  (C)\n(01)  Property |    Unit   |  Tenant Code\n(02)  118   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a00118   |\u00a0\u00a0\u00a0t0103001\n(03)  118   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a00121   |\u00a0\u00a0\u00a0t0077028\n(04)  118   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a00124   |\u00a0\u00a0\u00a0t0099589\n(05)        \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0Total 118 - MultiFamily Facility 1 \n(06)  119   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0001    |\u00a0\u00a0\u00a0t0103128\n(07)  119   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0002    |\u00a0\u00a0\u00a0t0101985\n(08)  119   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0003    |\u00a0\u00a0\u00a0t0102938\n(09)        \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0Total 119 - MultiFamily Facility 2 \n(10)  121   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0001    |\u00a0\u00a0\u00a0t0099507\n(11)  121   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0002    |\u00a0\u00a0\u00a0t0101773\n(12)  121   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0003    |\u00a0\u00a0\u00a0t0103123\n(13)  121   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0004    |\u00a0\u00a0\u00a0t0099821\n(14)  121   \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0005    |\u00a0\u00a0\u00a0t0077281\n(15)        \u00a0\u00a0\u00a0|\u00a0\u00a0\u00a0\u00a0\u00a0Total 121 - MultiFamily Facility 3\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461104066, "post_id": 36730191, "comment_id": 61044624, "body": "<code>.Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row</code> the parent there is the worksheet, not your table."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1461104268, "post_id": 36730191, "comment_id": 61044704, "body": "Use this line instead <code>numberRows = .Range(&quot;A:A&quot;).Cells.Find(&quot;*&quot;, , , , xlByRows, xlPrevious).Row</code>.  If you want more information then see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">HERE</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1461123769, "creation_date": 1461123769, "answer_id": 36733419, "question_id": 36730191, "link": "https://stackoverflow.com/questions/36730191/vba-count-table-rows-which-contain-data/36733419#36733419", "title": "VBA Count Table Rows which Contain data", "body": "<p>Try this</p>\n\n<pre><code>Sub check()\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set ATB = .ListObjects(\"Table1\")\n        .Activate\n        numberRows = Application.CountA(.Range(\"A:A\"))\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 3436173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HOEMW.jpg?s=128&g=1", "display_name": "Danielle", "link": "https://stackoverflow.com/users/3436173/danielle"}, "is_accepted": false, "score": 0, "last_activity_date": 1461125858, "creation_date": 1461125858, "answer_id": 36733717, "question_id": 36730191, "link": "https://stackoverflow.com/questions/36730191/vba-count-table-rows-which-contain-data/36733717#36733717", "title": "VBA Count Table Rows which Contain data", "body": "<p>Try this excel formula</p>\n\n<pre><code>=COUNTA(Table1[A1])\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3893947, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/dcb9e24e894a2ecef7116ea774c51ce5?s=128&d=identicon&r=PG&f=1", "display_name": "JustNuts", "link": "https://stackoverflow.com/users/3893947/justnuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3953, "favorite_count": 0, "closed_date": 1462051832, "answer_count": 2, "score": 0, "last_activity_date": 1461125858, "creation_date": 1461102916, "last_edit_date": 1495540775, "question_id": 36730191, "link": "https://stackoverflow.com/questions/36730191/vba-count-table-rows-which-contain-data", "closed_reason": "Duplicate", "title": "VBA Count Table Rows which Contain data", "body": "<p>Follow on from <a href=\"https://stackoverflow.com/questions/18088729/row-count-where-data-exists\">earlier question</a>. I am trying to count the number of rows in a table which contain data (not counting number of rows which are part of the table).</p>\n\n<p>For example, my table is:\n<a href=\"https://i.stack.imgur.com/jMgcc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jMgcc.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code is:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(1)\n    Set ATB = .ListObjects(\"Table1\")\n    .Activate\n    numberRows = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With`\n</code></pre>\n\n<p>This returns the wrong number (trust me that column A has the same data count)\n<a href=\"https://i.stack.imgur.com/Y32O4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y32O4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Likewise, I want to use VBA to resize the table nicely but need this row count for that.</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461101439, "post_id": 36729811, "comment_id": 61043520, "body": "You didn&#39;t qualify <code>Cells(2, 10)</code> Edit: also <code>Cells(Range(&quot;J3&quot;).Row, Range(&quot;J3&quot;).Column)</code> is very...wordy?"}, {"owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461157277, "post_id": 36729811, "comment_id": 61070347, "body": "Thanks. Sorry for the wordy code, I&#39;m learning."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "edited": false, "score": 0, "creation_date": 1461157292, "post_id": 36733732, "comment_id": 61070362, "body": "Thanks for your time. Worked well !"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "edited": false, "score": 0, "creation_date": 1461161110, "post_id": 36733732, "comment_id": 61073667, "body": "please mark it as solution if you are satisfy with the code"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1461125953, "creation_date": 1461125953, "answer_id": 36733732, "question_id": 36729811, "link": "https://stackoverflow.com/questions/36729811/hlookup-with-date-already-tried-clng/36733732#36733732", "title": "HLookup() with date: Already tried CLng()", "body": "<p>try this</p>\n\n<pre><code>Sub BuscarDatos()\n    Dim y As Workbook\n    Dim x As Workbook\n    Set y = Application.ActiveWorkbook\n    Set x = Application.Workbooks.Open(\"G:\\Estudios\\Biblioteca\\Mercado Accionario Chileno\\InsertarEmpresa.xlsm\")\n    'modified line\n    y.Sheets(\"Informaci\u00f3n Financiera\").Cells(Range(\"J3\").Row, Range(\"J3\").Column) = Application.HLookup(y.Sheets(\"Informaci\u00f3n Financiera\").Cells(2, 10), x.Sheets(\"Cencosud\").Range(\"B8:J9\"), 2, False) 'modified line\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36733732, "answer_count": 1, "score": 0, "last_activity_date": 1461125953, "creation_date": 1461101288, "last_edit_date": 1461101535, "question_id": 36729811, "link": "https://stackoverflow.com/questions/36729811/hlookup-with-date-already-tried-clng", "title": "HLookup() with date: Already tried CLng()", "body": "<p>the following is my code. Basically I want to find the row value of a cell in another workbook (\"x\" in here), with matching dates. The code is running but it isn't returning the value.</p>\n\n<p><code>Cells(2,10)</code> is a date (written as dic-13), and the first row of <code>Range(\"B8:J9\")</code> is a <code>Range</code> of date as ( \"dic-11\", \"dic-12\", \"dic-13\" etc...)</p>\n\n<pre><code>Sub BuscarDatos()\nDim y As Workbook\nDim x As Workbook\n\nSet y = Application.ActiveWorkbook\nSet x = Application.Workbooks.Open(\"G:\\Estudios\\Biblioteca\\Mercado Accionario _ \nChileno\\InsertarEmpresa.xlsm\")\n\ny.Sheets(\"Informaci\u00f3n Financiera\").Cells(Range(\"J3\").Row, Range(\"J3\").Column) = _\nApplication.HLookup(CLng(Cells(2, 10)), _\nx.Sheets(\"Cencosud\").Range(\"B8:J9\"), 2, False)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1461104227, "creation_date": 1461104227, "answer_id": 36730471, "question_id": 36729431, "link": "https://stackoverflow.com/questions/36729431/using-word-vba-to-format-parts-of-table-cell-text/36730471#36730471", "title": "Using word vba to format parts of table cell text", "body": "<p>The trick is to use a Range object, rather than refer to the entire cell Range when writing the information. This gives you finer control over formatting, as you go. The formatting will always apply to the <em>current</em> content of the Range. So more like</p>\n\n<pre><code>Dim rngCell as Word.Range\nSet rngCell = tbl.Cell(nRow, 2).Range\nWith rngCell\n  'Go into the cell, rather than the entire cell\n  .Collapse wdCollapseStart\n  'other stuff\n  .Text = captionStr &amp; vbCr\n  .Font.Bold = True\n  'Move to the end of the range\n  .Collapse wdCollapseEnd\n  'Doing this in a table cell moves to the next cell, so one back\n  .MoveEnd wdCharacter, -1\n  'Now the rest of the content\n  .Text = bodyStr\n  .Font.Bold = False\nEnd With\n</code></pre>\n\n<p>Think of a Range like a Selection, and collapsing it like using the left-/right arrow key to \"collapse\" the selection to a point.</p>\n"}], "owner": {"reputation": 159, "user_id": 1413586, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/da453d61b41e954f30daf10f7703d537?s=128&d=identicon&r=PG", "display_name": "Scott Kellish", "link": "https://stackoverflow.com/users/1413586/scott-kellish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461104227, "creation_date": 1461099845, "last_edit_date": 1461100781, "question_id": 36729431, "link": "https://stackoverflow.com/questions/36729431/using-word-vba-to-format-parts-of-table-cell-text", "title": "Using word vba to format parts of table cell text", "body": "<p>I'm using the following code to combine text from two excel cells into a word table cell. I want to format the first part (captionStr) as bold but can't seem to figure out how to specify just that part of the range.</p>\n\n<p>I tried <code>.Range(0,Len(captionStr)).Font.Bold=True</code> and <code>.Range.Characters(0,Len(captionStr)).Font.Bold=True</code> but both give me \"wrong number of argument\" errors. I'm using Office 2010 with MS Word 14.0 Object Reference</p>\n\n<pre><code>With tbl.Cell(nRow, 2).Range\n    .Style = rfpDoc.Styles(wdStyleNormal)\n    captionStr = CStr(nSection) + \". \" + ActiveCell.Text\n    bodyStr = ActiveCell.Offset(0, 1).Text\n    .Text = captionStr\n    .Range.InsertParagraphAfter\n    .Range.InsertAfter(bodyStr)\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "colors", "shapes", "choropleth", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461100153, "post_id": 36729345, "comment_id": 61042936, "body": "You never set the previous selected shape back to it&#39;s old color."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1461103232, "post_id": 36729345, "comment_id": 61044277, "body": "@JNevill Not sure if you saw OldUgly&#39;s comment since he didn&#39;t tag you in the comment, but you didn&#39;t provide code to return to the original color once another selection is made."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1461103270, "post_id": 36729345, "comment_id": 61044292, "body": "Yea it seems I left that out. Hard to write on mobile"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1461103665, "post_id": 36729345, "comment_id": 61044470, "body": "@JNevill I am also curious why you would have the user create a new column with the shape name since in his example he shows that it already exists in column A? If there is a correspondence that is required, why not just modify column A (and your code accordingly)?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1461113483, "post_id": 36729345, "comment_id": 61047544, "body": "Oh yea! it is already there. Back now. Writing the rest of this mess."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1461147018, "post_id": 36729345, "comment_id": 61063011, "body": "Hi Guys, This was such great peice of work to come into this morning. It really really helped. Thank you so much for your time and expertise."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1461166412, "last_edit_date": 1461166412, "creation_date": 1461099522, "answer_id": 36729345, "question_id": 36729050, "link": "https://stackoverflow.com/questions/36729050/change-shape-colour-when-cell-is-clicked/36729345#36729345", "title": "Change Shape Colour when Cell is Clicked", "body": "<p>You can add a new subroutine in the worksheet's code that will fire when the selection changes on the sheet:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim strShapeName As String 'Variable to hold the shape name\n    Dim shp As Shape 'Variable to hold a shape object\n\n    'Detect if the click was in range A:C\n    If Not Intersect(Target, Range(\"A:C\")) Is Nothing Then\n\n        'Boom... set all the shapes to blue\n        For Each shp In Me.Shapes\n             If Left(shp.Name, 2) = \"S_\" Then shp.Fill.ForeColor.RGB = RGB(0, 0, 255)\n        Next shp        \n\n        'Grab the shape name from Column A\n        strShapeName = Cells(Target.Row, 1).Value\n\n        'Set the color of the shape to red\n        Shapes(strShapeName).Fill.ForeColor.RGB = RGB(255, 0, 0)\n    End If\nEnd Sub\n</code></pre>\n\n<p>This will detect if the selection change was to a cell in columns A, B, or C. If it was it will grab the name of the shape from Column A and then set the color of that shape to red. </p>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 1, "accepted_answer_id": 36729345, "answer_count": 1, "score": 0, "last_activity_date": 1461166412, "creation_date": 1461098565, "last_edit_date": 1531161705, "question_id": 36729050, "link": "https://stackoverflow.com/questions/36729050/change-shape-colour-when-cell-is-clicked", "title": "Change Shape Colour when Cell is Clicked", "body": "<p>I am looking for some code that will change the colour of a shape when a cell is clicked on. \nExample the shape is S_IRL which is Ireland and is located in Cell B22. </p>\n\n<p>What I would like to happen is that if Cell B22 then shape S_IRL changes from Blue to Red. Then if another cell with a country is clicked then the corresponding shape changes to red and the previous returns to it previous colour. \nAny help would be greatly appreciated \n<a href=\"https://i.stack.imgur.com/yiomd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yiomd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "powerpoint", "powerpoint-2013"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1461098631, "post_id": 36728928, "comment_id": 61042051, "body": "(1) Is the last slide actually slide 47?  If you add a slide, your code will never close the workbook.  (2) Where do you declare <code>ActiveCell</code>?  I see <code>oExcel.ActiveSheet</code> but I would have thought you would need <code>oExcel.ActiveCell</code> unless you assign a value to <code>ActiveCell</code> somewhere in the PPT code.  <b>Edit</b> welcome to the site!  Check out the <a href=\"http://stackoverflow.com/tour\">tour</a> for info and a badge :) ."}, {"owner": {"reputation": 1, "user_id": 6226872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a46a2ed6ada7f62eed20f00777e905?s=128&d=identicon&r=PG&f=1", "display_name": "msmi151", "link": "https://stackoverflow.com/users/6226872/msmi151"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1461248508, "post_id": 36728928, "comment_id": 61122107, "body": "@cxw  (1) 47 is not my last slide, but I use &#39;OnSlideShowTerminate&#39; in a separate sub to close everything out.  (2) I thought that using &#39;oExcel.Sheets(1).Range(&quot;A1&quot;).Activate&#39; has now activated A1 in the spreadsheet, making that my active cell. After that, I thought using &#39;ActiveCell.&quot;... would call back to the cell that I selected."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1461592297, "post_id": 36728928, "comment_id": 61254796, "body": "If you haven&#39;t solved this yet, would you please edit the question to include the <code>OnSlideShowTerminate</code> code?"}, {"owner": {"reputation": 1, "user_id": 6226872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a46a2ed6ada7f62eed20f00777e905?s=128&d=identicon&r=PG&f=1", "display_name": "msmi151", "link": "https://stackoverflow.com/users/6226872/msmi151"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1462205919, "post_id": 36728928, "comment_id": 61528438, "body": "I&#39;ve included the &#39;OnSlideShowTerminate&#39; code. However, the slideshow should almost always run to completion. Therefore, this code doesn&#39;t typically run @cxw"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1462207513, "post_id": 36728928, "comment_id": 61529314, "body": "I note that <code>PageChange</code> doesn&#39;t run <code>oWB.Close</code>, and <code>Terminate</code> doesn&#39;t run <code>oExcel.Quit</code>.  If you add <code>oWB.Close</code> to <code>PageChange</code> and <code>oExcel.Quit</code> to <code>Terminate</code>, does that make any difference?  Also, try adding <code>set oExcel=Nothing</code> both places you shut down Excel (shouldn&#39;t make a difference, but can&#39;t hurt).  Final thought: put <code>oExcel.</code> in front of all references to <code>ActiveSheet</code> or <code>ActiveCell</code>.  Maybe the Excel object library&#39;s top-level references are getting confused."}], "owner": {"reputation": 1, "user_id": 6226872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a46a2ed6ada7f62eed20f00777e905?s=128&d=identicon&r=PG&f=1", "display_name": "msmi151", "link": "https://stackoverflow.com/users/6226872/msmi151"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462207458, "creation_date": 1461098136, "last_edit_date": 1462207458, "question_id": 36728928, "link": "https://stackoverflow.com/questions/36728928/powerpoint-vba-code-fails-on-second-run-without-restarting-ppt", "title": "PowerPoint VBA code fails on second run without restarting ppt", "body": "<p>I'm using PowerPoint 2013 on a Surface to run a slideshow. During the slideshow, there is code that tracks the time as every slide changes and records that in a separate Excel file.</p>\n\n<p>It works how I would like on the first time that I run through PowerPoint. However, if I don't close PowerPoint and restart the program, the second time through it will not do anything. The code works until the first instance of \"ActiveSheet\" or \"ActiveCell\". As soon as it gets to that line of code, the code just stops running. It doesn't stop the slideshow, but it doesn't record any data. </p>\n\n<p>It seems like somehow PowerPoint loses the link to Excel. </p>\n\n<p>What would cause it to fail on \"ActiveSheet\" or \"ActiveCell\"? </p>\n\n<h2>Code for Timer</h2>\n\n<pre><code>Dim intSlide As Integer\nDim oExcel As Excel.Application \nDim oWB As Workbook\nDim WS As Worksheet\nDim strPart As String\nDim strCond As String\nDim intRow As Integer\n\nPublic Declare PtrSafe Sub GetSystemTime Lib \"kernel32\" (lpsystemtime As SYSTEMTIME)\nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nPublic Type SYSTEMTIME\n    Year As Integer\n    Month As Integer\n    DayOfWeek As Integer\n    Day As Integer\n    Hour As Integer\n    Minute As Integer\n    Second As Integer\n    Milliseconds As Integer\nEnd Type\n</code></pre>\n\n<h2>Code that runs with every page change</h2>\n\n<pre><code>Sub OnSlideShowPageChange(ByVal ssw As SlideShowWindow)\n    Dim sTime As SYSTEMTIME\n    Dim lngCount As Long\n    Dim check\n    Dim strFinal As String\n\n    GetSystemTime sTime\n\n    intSlide = 1\n    lngCount = 1\n    intRow = 1\n    strFinal = \"\"\n\n    intSlide = ssw.View.CurrentShowPosition\n\n    If intSlide = 1 Then\n        Set oExcel = New Excel.Application\n        Set oWB = oExcel.Workbooks.Open(\"C:\\Users\\Ayse Eren\\Desktop\\TimeSaver.xlsx\")\n        oExcel.Visible = False\n        oExcel.Sheets(1).Activate\n        oExcel.Sheets(1).Range(\"A1\").Activate\n        strCond = \"HUD\"\n        If oExcel.Sheets(1).Range(\"A1\").Value = \"\" Then\n            oExcel.Sheets(1).Range(\"A1\").Value = \"Participant\"\n            Range(\"A2\").Activate\n        Else\n            oExcel.Sheets(1).Range(\"A1\").Offset(0, 1).End(xlDown).Offset(1, 0).Activate\n            'uses column B (automatically populated) to determine where to start recording data\n        End If\n\n        intRow = ActiveCell.Row - 1\n    End If\n\n    oExcel.ActiveSheet.Range(\"A\" &amp; (intSlide + intRow)).Activate\n\n    ActiveCell.Offset(0, 1) = strCond\n    ActiveCell.Offset(0, 2) = intSlide\n    ActiveCell.Offset(0, 3) = sTime.Year\n    ActiveCell.Offset(0, 4) = sTime.Month\n    ActiveCell.Offset(0, 5) = sTime.Day\n    ActiveCell.Offset(0, 6) = sTime.Hour\n    ActiveCell.Offset(0, 7) = sTime.Minute\n    ActiveCell.Offset(0, 8) = sTime.Second\n    ActiveCell.Offset(0, 9) = sTime.Milliseconds\n\n    strFinal = ActivePresentation.Slides(intSlide).Shapes(1).TextFrame.TextRange.Text\n    ActiveCell.Offset(0, 12) = strFinal\n\n    If intSlide = 47 Then\n        oWB.Save\n        oExcel.Visible = True\n        oExcel.Quit\n    Else\n        oWB.Save\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This code runs if you exit the slide show before slide 47.</p>\n\n<h2><strong><em>Edit</em></strong></h2>\n\n<pre><code>Sub OnSlideShowTerminate(ByVal SSW As SlideShowWindow)\n    oWb.Save\n    oWb.Close\n    oExcel.Visible = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461096477, "post_id": 36728403, "comment_id": 61040800, "body": "You didn&#39;t qualify anything. In other words, how does the computer know which workbook/worksheet you want?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1461098388, "post_id": 36728403, "comment_id": 61041925, "body": "You are only showing part of the loop"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1461098818, "post_id": 36728403, "comment_id": 61042170, "body": "What have you searched for? This is a <a href=\"https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=VBA+data+from+other+worksheets\" rel=\"nofollow noreferrer\">very common</a> question.  But yes, you absolutely need to be qualifying all of your ranges....and include all the code."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1461101771, "post_id": 36728403, "comment_id": 61043671, "body": "@BruceWayne it&#39;s <b><i>very</i></b> common even if you <a href=\"https://data.stackexchange.com/stackoverflow/query/edit/475578\" rel=\"nofollow noreferrer\">only look at stack overflow</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1461102166, "post_id": 36728403, "comment_id": 61043826, "body": "@macroman - oh no doubt!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6194678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6209a91ac444bdb5520a3e08bc5ad33c?s=128&d=identicon&r=PG&f=1", "display_name": "RFerguson", "link": "https://stackoverflow.com/users/6194678/rferguson"}, "edited": false, "score": 0, "creation_date": 1461244826, "post_id": 36734178, "comment_id": 61119114, "body": "Thanks. I&#39;ll look into that. I&#39;m honestly pretty new with VBA and  this macro has been the way they&#39;ve done this process here at my new job for a while. I&#39;m attempting to pick it up and fix the issues with it. I appreciate your help."}], "tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 0, "last_activity_date": 1461128290, "creation_date": 1461128290, "answer_id": 36734178, "question_id": 36728403, "link": "https://stackoverflow.com/questions/36728403/how-do-i-make-macro-pull-data-from-different-sheets-within-a-workbook-excel-vba/36734178#36734178", "title": "How do I make macro pull data from different sheets within a workbook. Excel VBA", "body": "<p>Throw away that stupid <code>.activate</code> method learn how to work with this</p>\n\n<pre><code>Sheets(\"sheetName\").range(\"rangeName/rangeRange\")[optional].cells(\"cellRow\",\"cellColumn\")\n</code></pre>\n\n<p>it will make your job much more easier, and then you can work with sheet/range/cell as object.</p>\n\n<p>Also, when you use Range/Cell without dot and parent asignment, you working with active sheet, which may be very unpredictable. So if you use full statement, mentioned above, you cant make mistake.</p>\n"}], "owner": {"reputation": 11, "user_id": 6194678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6209a91ac444bdb5520a3e08bc5ad33c?s=128&d=identicon&r=PG&f=1", "display_name": "RFerguson", "link": "https://stackoverflow.com/users/6194678/rferguson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1821, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461128290, "creation_date": 1461096423, "question_id": 36728403, "link": "https://stackoverflow.com/questions/36728403/how-do-i-make-macro-pull-data-from-different-sheets-within-a-workbook-excel-vba", "title": "How do I make macro pull data from different sheets within a workbook. Excel VBA", "body": "<p>I'm having an issue with a macro used to pull information from one worksheet to another.  I cant figure out how to make the macro look at a different worksheet within the \"CurrentSchedule\" workbook.  When I go through the macro with the 1st (A line) worksheet everything runs smoothly, but when I try to run it through the 2nd sheet (B line) it times out.  It specifically gets stuck at the line </p>\n\n<p>\" Order = Range(\"W1\").Offset(Count, 0).Value \"</p>\n\n<pre><code>SAPorder = InputBox(\"Enter SAP Order Number:\")\nProdLine = InputBox(\"Enter the sheet# of CurrentSchedule that has this   SAP order number. Example: A line = 1; B = 2\")\nEnd Select\nCount = 0 'Count is the row in the designated column\nFlag = True\nDo While Flag\nWorkbooks(\"CurrentSchedule.xlsx\").Worksheets(ProdLine).Activate\nOrder = Range(\"W1\").Offset(Count, 0).Value \nIf Order = SAPorder Then\nnme = Range(\"B1\").Offset(Count, 0).Value \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1461096987, "last_edit_date": 1461096987, "creation_date": 1461096650, "answer_id": 36728473, "question_id": 36728262, "link": "https://stackoverflow.com/questions/36728262/excel-vba-display-values-in-a-range-of-cells/36728473#36728473", "title": "Excel VBA = Display values in a range of cells", "body": "<p>Double transpose the range and use the <code>Join()</code> method:</p>\n\n<pre><code>.Body = Join$(WorksheetFunction.Transpose(WorksheetFunction.Transpose(Range(\"B1:E1\").Value)), vbTab)\n</code></pre>\n\n<p>This will transpose the range into a single dimension array, which can then be joined with a given delimiter using the <code>Join()</code> method.</p>\n"}], "owner": {"reputation": 1, "user_id": 6226835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f32adaab61ea6ce44395fd6657c630c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gnade", "link": "https://stackoverflow.com/users/6226835/gnade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461096987, "creation_date": 1461095942, "last_edit_date": 1531164843, "question_id": 36728262, "link": "https://stackoverflow.com/questions/36728262/excel-vba-display-values-in-a-range-of-cells", "title": "Excel VBA = Display values in a range of cells", "body": "<p>Can someone help me with this? I'm still fairly new with it and I can't get it to work. I am trying to:</p>\n\n<p>Display the data in a range of cells in an email. I found this code online to get me started, but it is for text boxes:</p>\n\n<pre><code>Sub Sample()\n   'Setting up the Excel variables.\n   Dim olApp As Object\n   Dim olMailItm As Object\n   Dim iCounter As Integer\n   Dim Dest As Variant\n   Dim SDest As String\n\n   'Create the Outlook application and the empty email.\n   Set olApp = CreateObject(\"Outlook.Application\")\n   Set olMailItm = olApp.CreateItem(0)\n\n   'Using the email, add multiple recipients, using a list of addresses in column A.\n   With olMailItm\n       SDest = \"\"\n       For iCounter = 1 To WorksheetFunction.CountA(Columns(1))\n           If SDest = \"\" Then\n               SDest = Cells(iCounter, 1).Value\n           Else\n           SDest = SDest &amp; \";\" &amp; Cells(iCounter, 1).Value\n           End If\n       Next iCounter\n\n    'Do additional formatting on the BCC and Subject lines, add the body text from the spreadsheet, and send.\n       .BCC = SDest\n       .Subject = \"FYI\"\n       .Body = ActiveSheet.TextBoxes(1).Text\n       .Send\n   End With\n\n   'Clean up the Outlook application.\n   Set olMailItm = Nothing\n   Set olApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Everything works, except it is only for one text box, and I have lists and whatsits in cells that I need to send too. The code that I'm trying to use is:</p>\n\n<pre><code>.body = Activesheet.range(\"B1:E1\").Value \n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>.body = ActiveSheet.TextBoxes(1).Text\n</code></pre>\n\n<p>but that just sends a blank email. Any advice?</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1461096108, "post_id": 36728184, "comment_id": 61040578, "body": "use OR and like where code like x or y"}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1461096624, "post_id": 36728184, "comment_id": 61040880, "body": "I tried using WHERE code LIKE &#39;C10%&#39; AND code LIKE &#39;R110%&#39; but it returns nothing. OR does work but that is not what I need as I only want to return those with both."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1461096807, "post_id": 36728184, "comment_id": 61040972, "body": "Which DBMS are you actually using mysql &lt;&gt; sql server &lt;&gt; postgresql."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461097357, "post_id": 36728184, "comment_id": 61041293, "body": "The data is held in PostGreSQL. I am using oledb to connect to PG and writing it in Excel VBA."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461097896, "post_id": 36728184, "comment_id": 61041626, "body": "@BradleyS Can you please clarify? Does a code need to contain R110 AND C10 (eg. <code>R110_C10..</code>) or are you looking for codes that are either <code>R110</code> or <code>C10..</code>"}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461098751, "post_id": 36728184, "comment_id": 61042119, "body": "I have edited my question to explain the table structure better."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461099277, "post_id": 36728184, "comment_id": 61042464, "body": "The same master_id needs to find BOTH codes C10 AND R110 on different rows. So I know which Master_ids (persons) have both codes"}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 0, "creation_date": 1461101433, "post_id": 36728184, "comment_id": 61043516, "body": "@BradleyS.  What about the term and event_date columns? If there&#39;s a row with a  C10 code, when we look for a matching row with an R110 code... do the term and event_date have to match the values from the row with the C10 code, or are we just looking for any row with R10 for the same master_id ? (If the term and event_date do have to match, do we consider a NULL value to match a NULL value?) How we write the query depends on the answer to those questions."}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 0, "creation_date": 1461101580, "post_id": 36728184, "comment_id": 61043578, "body": "@BradleyS... and when we do find person 1, do we want to return two rows ...one with the C10 code and the other with the R110 code ? (This is where a sample result would be beneficial.)"}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461101615, "post_id": 36728184, "comment_id": 61043594, "body": "No the term and eventdate will just return the data associated line with the found match of code R110"}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461101768, "post_id": 36728184, "comment_id": 61043670, "body": "The result only needs to show the data from the R110 row. The C10 code is only for a match and isn&#39;t needed."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461102182, "post_id": 36728184, "comment_id": 61043837, "body": "Sample result added to initial question"}], "answers": [{"comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1461096891, "post_id": 36728510, "comment_id": 61041023, "body": "This will never return ANY rows because there is no value that can meet both predicates at the same time. That would have to be OR. And the OP stated they tried this but they want only those that have both."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461097125, "post_id": 36728510, "comment_id": 61041181, "body": "The two initial queries work fine separately, so finding the codes isn&#39;t the problem. I need to only return results if both codes exist. I know there are records with both when I search them separately."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461097157, "post_id": 36728510, "comment_id": 61041195, "body": "So if the field value has both values, then the field value must be something like <code>foo_R110_foo_C10.._foo..</code> or <code>foo_C10.._foo_R110_foo..</code>, so a query term would need to match <code>&#39;*R10*C10..*&#39;</code> OR <code>&#39;*C10..*R110*&#39;</code>"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461097318, "post_id": 36728510, "comment_id": 61041276, "body": "Updated the SQL to match only when code contains R110 AND C10"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1461097738, "post_id": 36728510, "comment_id": 61041519, "body": "Even with your edits this code will fail because you can&#39;t have a row that is both R110 AND C110"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461097964, "post_id": 36728510, "comment_id": 61041664, "body": "But the OP is suggesting that the code might contain both <code>OR does work but that is not what I need as I only want to return those with both. </code>"}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 0, "creation_date": 1461097997, "post_id": 36728510, "comment_id": 61041683, "body": "The matching patterns for code are <i>significantly</i> different than the OP original queries. What is the purpose the asterisk character? As far as I know, PostgreSQL hasn&#39;t extended the SQL standard LIKE comparison to support any wildcard characters other than percent and underscore. So those are just literal asterisk characters, and I can guarantee that there <i>no</i> rows that have a value in the code column that satisfies  both conditions."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461098307, "post_id": 36728510, "comment_id": 61041877, "body": "OK this may them be my bad wording of names. In one table are 100 rows on row 1 is C10 and row 2 is R110 and so on. Each row has a unique master_id which identifies the person. So row one could be master_id=1 with C10 and row 2 could also have master_id = 1 with R110."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461098740, "post_id": 36728510, "comment_id": 61042110, "body": "I have edited my question to explain the table structure better."}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461099485, "post_id": 36728510, "comment_id": 61042589, "body": "@Bradley: A clearer explanation is probably beneficial. But even without that, it&#39;s abundantly clear that the conditions on the code column (in the WHERE clauses of the original queries) are mutually exclusive. I applaud the efforts of those that attempt to provide an answer. But some of the answers (many notably of the &quot;try this&quot; variety) are barely more than guesses."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461101132, "post_id": 36728510, "comment_id": 61043377, "body": "Thanks for the update to the question. My approach is dealing with code substrings in a single row (and using non PostGreSql wildcards. I&#39;m AFK now, but what you need is a self join, or a subquery that uses EXISTS."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1461097271, "last_edit_date": 1461097271, "creation_date": 1461096809, "answer_id": 36728510, "question_id": 36728184, "link": "https://stackoverflow.com/questions/36728184/query-2-different-items-within-the-same-field-and-the-same-table/36728510#36728510", "title": "Query 2 different items within the same field and the same table", "body": "<p>You could try this wildcard and AND approach, to return both:</p>\n\n<p>I'm assuming that <code>R110</code> might be followed by <code>C10..</code> or vice versa.</p>\n\n<pre><code>Dim DIAG As String\n    DIAG = \"SELECT DISTINCT master_id, eventdate, code, term, surname, forename \" _\n    &amp; \"FROM srch INNER JOIN person p ON master_id=p.entity_id \" _\n    &amp; \"WHERE code LIKE '*R110*' AND code LIKE '*C10..*' \" _\n    &amp; \"ORDER BY master_id \" \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461097632, "post_id": 36728649, "comment_id": 61041458, "body": "Questioner clearly states ` SQL via oledb to attach to a PostGreSQL datasource`"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1461097687, "post_id": 36728649, "comment_id": 61041490, "body": "And the tag bombed everything. :)"}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 0, "creation_date": 1461097711, "post_id": 36728649, "comment_id": 61041500, "body": "What if code values for a given search are &#39;C10..abc&#39; and &#39;C10..def&#39;, but no code values like &#39;R110%&#39; at all? What if there is a code value like &#39;R110%&#39;.  Seems like we can demonstrate cases where this would return rows it shouldn&#39;t, and wouldn&#39;t return rows it should."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "reply_to_user": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 0, "creation_date": 1461097881, "post_id": 36728649, "comment_id": 61041615, "body": "@spencer7593 that is a valid point. I think it could easily produce some false positives. Not sure it would skip rows it shouldn&#39;t though."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461097953, "post_id": 36728649, "comment_id": 61041659, "body": "Finding the codes isn&#39;t a problem when searched on there own in the 2 separate queries."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461098012, "post_id": 36728649, "comment_id": 61041699, "body": "I used the above code by Sean Lange, but it returns an error &quot; expected expression in COUNT&quot;"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461098085, "post_id": 36728649, "comment_id": 61041739, "body": "@BradleyS the error is likely due to my code being geared for sql server. It is very likely that postgresql is a little different."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461098725, "post_id": 36728649, "comment_id": 61042105, "body": "I have edited my question to explain the table structure better."}], "tags": [], "owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "is_accepted": false, "score": 0, "last_activity_date": 1461097252, "creation_date": 1461097252, "answer_id": 36728649, "question_id": 36728184, "link": "https://stackoverflow.com/questions/36728184/query-2-different-items-within-the-same-field-and-the-same-table/36728649#36728649", "title": "Query 2 different items within the same field and the same table", "body": "<p>This is a shot in the dark. This may or may not work because we still don't know which DBMS you are using. This should work for sql server and maybe for postgresql. You may have to tweak the syntax slightly depending on which DBMS you are actually using. No matter which system you are using please don't be scared to use aliases and formatting.</p>\n\n<pre><code>SELECT s.master_id\n    , s.eventdate\n    , count(distinct s.code) as CodeCount\n    , s.term\n    , p.surname\n    , p.forename \nFROM srch s\nINNER JOIN person p ON s.master_id = p.entity_id \nWHERE s.code LIKE 'C10..%' \n    OR s.code like 'R110%'\ngroup by s.master_id\n    , s.eventdate\n    , s.term\n    , p.surname\n    , p.forename \nhaving count(distinct s.code) = 2\nORDER BY s.master_id \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461099787, "post_id": 36729125, "comment_id": 61042749, "body": "Doh! My bad! I would have discovered that if I had tested it. And it&#39;s obvious why it won&#39;t return any rows... the &quot;code&quot; column is included in the GROUP BY.  If we removed &quot;code&quot; from the GROUP BY and the SELECT list, we might get some rows back. I thinking we could re-write this, with an EXISTS (corellated subquery) predicate. Give me a few minutes."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461100418, "post_id": 36729125, "comment_id": 61043056, "body": "I&#39;ve included a table representation as well in my original question"}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461103240, "post_id": 36729125, "comment_id": 61044282, "body": "@BradleyS:  If you&#39;re just looking for a query, scroll down to the <i>bottom</i> of my answer, to the last query. Above that is my pattern for building the query.... first identifying the master_id that we want to return... only those that have a C10 and R110 code."}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461103772, "post_id": 36729125, "comment_id": 61044511, "body": "@BradleyS:  I just read the comments you left.  If you only want to return the rows with the R110  codes, the required change to the query above is pretty easy. Just remove this part.  &quot;<b><code>s.code LIKE &#39;C10..%&#39; OR</code></b>&quot;  (only the condition on &quot;s.code&quot;... leave the conditions on r.code, we need those.) And feel free to reformat the SQL text any way you want. And remove the outermost GROUP BY clause and use DISTINCT keyword in the SELECT list if you want. I find that by following the pattern like I do, it is <i>much</i> easier to write, test, rewrite and debug SQL statements."}, {"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461104712, "post_id": 36729125, "comment_id": 61044877, "body": "@BradleyS: simplified the query. Since we are only returning the R110 rows, the inline view query can be simpler. Just return master_id associated with C10 rows. We&#39;ll pickup the matching R110 rows in the outer query. The GROUP BY/DISTINCT on the outermost query isn&#39;t necessary, unless there&#39;s a need to collapse duplicate rows."}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1461134976, "post_id": 36729125, "comment_id": 61054508, "body": "That&#39;s it! Perfect. Thank you ever so much for helping me with this."}], "tags": [], "owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "is_accepted": true, "score": 0, "last_activity_date": 1461104312, "last_edit_date": 1461104312, "creation_date": 1461098774, "answer_id": 36729125, "question_id": 36728184, "link": "https://stackoverflow.com/questions/36728184/query-2-different-items-within-the-same-field-and-the-same-table/36729125#36729125", "title": "Query 2 different items within the same field and the same table", "body": "<p>Since the column references aren't qualified, we can't tell which table each column reference refers to.</p>\n\n<hr>\n\n<p>SUGGESTION: as an aid to future readers of the SQL, please consider qualifying <em>all</em> column references with the table name, or even better, a short (unique) table alias. Then the future reader won't be scouring the table definitions to figure out which table contains which column.) Also consider what is going to happen with this SQL statement when a column of the same name is added to another table used in the query.)</p>\n\n<hr>\n\n<p>We'll just have to guess at which table contains which columns.</p>\n\n<p>I'd suggest a pattern using a GROUP BY clause, rather than DISTINCT.</p>\n\n<p>And I suggest computing an aggregate on the result of an expression that tests  whether an included row satisfies the particular condition.</p>\n\n<p>And then performing a test on the aggregate, to see if any rows existed (within the group) where the condition evaluated to TRUE.</p>\n\n<p>As an example: (not tested)</p>\n\n<pre><code>SELECT s.master_id\n     , s.eventdate\n     , s.code\n     , s.term\n     , p.surname\n     , p.forename\n  FROM srch s\n INNER\n  JOIN person p \n    ON p.entity_id = s.master_id\n WHERE ( s.code LIKE 'C10..%' OR s.code LIKE 'R110%' )\n GROUP\n    BY s.master_id\n     , s.eventdate\n     , s.code\n     , s.term\n     , p.surname\n     , p.forename\nHAVING SUM(CASE WHEN s.code LIKE 'C10..%' THEN 1 ELSE 0 END) &gt; 0\n   AND SUM(CASE WHEN s.code LIKE 'R110%'  THEN 1 ELSE 0 END) &gt; 0\n ORDER BY s.master_id\n</code></pre>\n\n<p>The <strong>CASE</strong> expressions will evaluate to either 1 or 0, for each row. The SUM() aggregate will total the 1s and 0s up. The return from the aggregate will be greater than zero if there was any row (within a \"group\") that satisfied the condition.</p>\n\n<p>If there are no rows (within the group) with  code LIKE 'R110%', the SUM() will evaluate to zero, and the comparison will evaluate to FALSE, and the row will not be returned.</p>\n\n<p>NOTE: The comparison of the aggregates is in a HAVING clause because the results from the aggregates is not available when the conditions in the WHERE clause are evaluated, when the rows are accessed.</p>\n\n<p><strong>FOLLOWUP</strong></p>\n\n<p>Doh! That query above isn't going to return rows. That's my bad. There's a reason we test against some test cases. It helps us identify doofus problems like the one in the query I suggested above.</p>\n\n<p>It's impossible for that query to return any rows. The code column (as I hadn't really noticed) is in the GROUP BY clause. So at least one of the aggregate functions in the HAVING clause is guaranteed to evaluate to zero.</p>\n\n<p>(My problem was that I hadn't noticed that code was a column in the GROUP BY. Doh!)</p>\n\n<hr>\n\n<p>If all of the columns in the SELECT list need to match, <em>except</em> for the \"code\" column... (I hate to use an expensive correlated subquery when we don't have to...)  we could add \"EXISTS (correlated subquery).</p>\n\n<p>If master_id is a foreign key reference to entity_id in person, and entity_id is the primary key of person...  we could put off the join operation until <em>after</em> we had the results from srch.</p>\n\n<p>Does term and event also need to match, or just the code? How we write the query depends on that...</p>\n\n<hr>\n\n<p>Based on the responses in the comments, term and event_date don't need to match. We're looking for rows in srch for the same person (master_id) that have at least one row with the C10 code and at least one row with the R110 code.</p>\n\n<p>Identifying those values of master_id follows the same pattern in the query above, using the GROUP BY and conditional tests on aggregates in the HAVING clause.</p>\n\n<p>This is a query that should return the master_id values that have <em>both</em> a C10 code and an R110 code. This is something we can test... it doesn't return the whole resultset, in only gets us the master_id values we want to return:</p>\n\n<pre><code>SELECT r.master_id\n  FROM srch r\n WHERE ( r.code LIKE 'C10..%' OR r.code LIKE 'R110%' )\n GROUP\n    BY r.master_id\nHAVING SUM(CASE WHEN r.code LIKE 'C10..%' THEN 1 ELSE 0 END) &gt; 0\n   AND SUM(CASE WHEN r.code LIKE 'R110%'  THEN 1 ELSE 0 END) &gt; 0    \n</code></pre>\n\n<p>Once we get that, we can use that query as an inline view... wrap in parens, assign an alias and reference it like it was a table. For example:</p>\n\n<pre><code>SELECT q.*\n  FROM ( SELECT r.master_id\n           FROM srch r\n          WHERE ( r.code LIKE 'C10..%' OR r.code LIKE 'R110%' )\n          GROUP\n             BY r.master_id\n         HAVING SUM(CASE WHEN r.code LIKE 'C10..%' THEN 1 ELSE 0 END) &gt; 0\n            AND SUM(CASE WHEN r.code LIKE 'R110%'  THEN 1 ELSE 0 END) &gt; 0\n       ) q    \n</code></pre>\n\n<p>We should test whether PostgreSQL will run that. If we can't get that to run, there's no point in building on it. Once we confirm that runs, we can add a join to the srch table, get the rows that have a matching master_id with a C10 or R110 code.</p>\n\n<pre><code>SELECT q.master_id\n     , s.code\n     , s.term\n     , s.event_date\n  FROM ( SELECT r.master_id\n           FROM srch r\n          WHERE ( r.code LIKE 'C10..%' OR r.code LIKE 'R110%' )\n          GROUP\n             BY r.master_id\n         HAVING SUM(CASE WHEN r.code LIKE 'C10..%' THEN 1 ELSE 0 END) &gt; 0\n            AND SUM(CASE WHEN r.code LIKE 'R110%'  THEN 1 ELSE 0 END) &gt; 0\n       ) q\n  JOIN srch s\n    ON s.master_id = q.master_id\n   AND s.code LIKE 'R110%'\n</code></pre>\n\n<p>We can add a join to the person table, to retrieve the given name and surname by primary key lookup.</p>\n\n<pre><code>  JOIN person p\n    ON p.entity_id = s.master_id\n</code></pre>\n\n<p>add the appropriate column references to the SELECT list. The original queries had DISTINCT keyword. We can add that, or we could add GROUP BY clause. Whichever.</p>\n\n<p>We can reference master_id from either the inline view or the srch table, or even the entity_id from the person table. The join conditions guarantee us they will all be non-null and equal to each other.</p>\n\n<p>And wind up with something like this (desk checked only, not tested):</p>\n\n<pre><code>SELECT s.master_id\n     , s.code\n     , s.term\n     , s.event_date\n     , p.surname\n     , p.forename\n  FROM ( SELECT r.master_id\n           FROM srch r\n          WHERE ( r.code LIKE 'C10..%' OR r.code LIKE 'R110%' )\n          GROUP\n             BY r.master_id\n         HAVING SUM(CASE WHEN r.code LIKE 'C10..%' THEN 1 ELSE 0 END) &gt; 0\n            AND SUM(CASE WHEN r.code LIKE 'R110%'  THEN 1 ELSE 0 END) &gt; 0\n       ) q\n  JOIN srch s\n    ON s.master_id = q.master_id\n   AND s.code LIKE 'R110%'\n  JOIN person p\n    ON p.entity_id = s.master_id\n GROUP\n    BY s.master_id\n     , s.code\n     , s.term\n     , s.event_date\n     , p.surname\n     , p.forename\n ORDER\n    BY s.master_id\n     , s.code\n</code></pre>\n\n<p>And, if I haven't made some other doofus mistake again, I expect this will return the result specified by OP.  (I've attempted to provide a few comments along the way, about how we went about building the query.)</p>\n\n<p>I'd be interested in finding out how big of smoke ball this one makes.</p>\n\n<p><strong>ANOTHER FOLLOWUP</strong></p>\n\n<p>As an alternative, since we don't need to return the C10 rows, the query could actually be a little simpler. The inline view could just return us master_id values related to the C10 codes, and we can dispense with the HAVING clause with tests on the aggregates. This should return a result equivalent to the one above, perhaps even a little faster:</p>\n\n<pre><code>SELECT s.master_id\n     , s.code\n     , s.term\n     , s.event_date\n     , p.surname\n     , p.forename\n  FROM ( SELECT r.master_id\n           FROM srch r\n          WHERE r.code LIKE 'C10..%'\n          GROUP\n             BY r.master_id\n       ) q\n  JOIN srch s\n    ON s.master_id = q.master_id\n   AND s.code LIKE 'R110%'\n  JOIN person p\n    ON p.entity_id = s.master_id\n GROUP\n    BY s.master_id\n     , s.code\n     , s.term\n     , s.event_date\n     , p.surname\n     , p.forename\n ORDER\n    BY s.master_id\n     , s.code\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 36729125, "answer_count": 3, "score": 1, "last_activity_date": 1461104312, "creation_date": 1461095627, "last_edit_date": 1461102046, "question_id": 36728184, "link": "https://stackoverflow.com/questions/36728184/query-2-different-items-within-the-same-field-and-the-same-table", "title": "Query 2 different items within the same field and the same table", "body": "<p>I'm very new to SQL and I don't know how to query 2 different items within the same field and the same table.\nI'm writing this in Excel VBA using SQL via oledb to attach to a PostGreSQL datasource</p>\n\n<p>Basically I have 2 queries that I need to combine into one query.\nThe first query is the primary group.\nI need to first find all those people with the code C10%. Then of those with C10 who also have the code R110%</p>\n\n<p>The codes are in the srch table and the people names are in the person table, these are joined by master_id=p.entity_id</p>\n\n<p>Here are the 2 queries I need to combine:</p>\n\n<pre><code>Dim DIAG As String\n    DIAG = \"SELECT DISTINCT master_id, eventdate, code, term, surname, forename \" _\n    &amp; \"FROM srch INNER JOIN person p ON master_id=p.entity_id \" _\n    &amp; \"WHERE code LIKE 'C10..%' \" _\n    &amp; \"ORDER BY master_id \"\n\n\nDim DIAG As String\n    DIAG = \"SELECT DISTINCT master_id, eventdate, code, term, surname, forename \" _\n    &amp; \"FROM srch INNER JOIN person p ON master_id=p.entity_id \" _\n    &amp; \"WHERE code LIKE 'R110%' \" _\n    &amp; \"ORDER BY master_id \"  \n</code></pre>\n\n<p>The tables have 100 of rows and each has a master_id that identifies the person. Therefore row would be master_id = 1 and code = C10.\nThe next could be master_id= 1 and code R110.</p>\n\n<p>You are correct in that different codes cannot exist on the same row</p>\n\n<p>Does this help.</p>\n\n<pre><code>person table\nentity_id | surname | forename\n1         | Smith   | John\n2         | Mouse   | Mickey\n3\n\nsrch table\nmaster_id | code | term | eventdate\n1         |C10   |  DM  | 01/01/2000\n2         |R110  |  AL  | 01/01/2001\n1         |R110  |  AL  | 01/01/2002\n</code></pre>\n\n<p>I need to find person 1</p>\n\n<pre><code>Result\nmaster_id|code|term| eventdate |surname|forename\n   1     |R110| AL | 01/01/2002| Smith | John  \n</code></pre>\n"}, {"tags": ["excel", "vba", "vbe"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461095587, "post_id": 36728143, "comment_id": 61040300, "body": "Is the vbaproject password protected?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1461095844, "post_id": 36728143, "comment_id": 61040427, "body": "There is absolutely no reason that having the VBE open would affect the way your macro is working. A more plausible reason would be that you have some kind unqualified calls to sheets and cells which are defaulting to the <code>ActiveWorkbook</code> object. Without seeing all of your code though it&#39;s impossible to tell."}, {"owner": {"reputation": 135, "user_id": 4564644, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/45ae4ead48ecc947cb1375e190b0a0ec?s=128&d=identicon&r=PG&f=1", "display_name": "offcenter35", "link": "https://stackoverflow.com/users/4564644/offcenter35"}, "edited": false, "score": 0, "creation_date": 1461095865, "post_id": 36728143, "comment_id": 61040439, "body": "Nope it is not password protected."}, {"owner": {"reputation": 135, "user_id": 4564644, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/45ae4ead48ecc947cb1375e190b0a0ec?s=128&d=identicon&r=PG&f=1", "display_name": "offcenter35", "link": "https://stackoverflow.com/users/4564644/offcenter35"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1461096732, "post_id": 36728143, "comment_id": 61040943, "body": "@MacroMan What do you mean by &#39;defaulting to the ActiveWorkbook object&#39;? It sounded like an explanation for why the code runs when the editor is open, but I don&#39;t completely understand."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1461099261, "post_id": 36728143, "comment_id": 61042452, "body": "If you use something like <code>Range</code> or <code>Cells</code> without appending it to a worksheet object, the code will execute on whichever sheet is active on whichever workbook is active at that point in time. This is a commonly overlooked issue in VBA."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 4564644, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/45ae4ead48ecc947cb1375e190b0a0ec?s=128&d=identicon&r=PG&f=1", "display_name": "offcenter35", "link": "https://stackoverflow.com/users/4564644/offcenter35"}, "is_accepted": true, "score": 5, "last_activity_date": 1461100338, "creation_date": 1461100338, "answer_id": 36729562, "question_id": 36728143, "link": "https://stackoverflow.com/questions/36728143/why-do-i-need-to-have-the-vba-editor-open-to-load-data-into-a-userform/36729562#36729562", "title": "Why do I need to have the VBA editor open to load data into a Userform?", "body": "<p>This thread provided me the answer to my question:</p>\n\n<p><a href=\"http://www.xtremevbtalk.com/excel/229325-excel-crashes-unless-vba-editor.html\" rel=\"noreferrer\">http://www.xtremevbtalk.com/excel/229325-excel-crashes-unless-vba-editor.html</a></p>\n\n<p>Apparently Excel runs into memory issues when there is a Userform that has too many controls. Opening VBA editor somehow bypasses the memory issues and allows the associated macro to run properly.</p>\n\n<p>To automate this process, one simply has to add the following lines of code to the beginning of the macro:</p>\n\n<blockquote>\n  <p>Application.VBE.MainWindow.Visible = True<br>\n  Application.VBE.MainWindow.Visible = False</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11714772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eda5a72234c262ef8c8ba8534a619937?s=128&d=identicon&r=PG", "display_name": "Jamie", "link": "https://stackoverflow.com/users/11714772/jamie"}, "is_accepted": false, "score": 1, "last_activity_date": 1561741473, "creation_date": 1561741473, "answer_id": 56810791, "question_id": 36728143, "link": "https://stackoverflow.com/questions/36728143/why-do-i-need-to-have-the-vba-editor-open-to-load-data-into-a-userform/56810791#56810791", "title": "Why do I need to have the VBA editor open to load data into a Userform?", "body": "<p>I found the solution for this!! For months opening a UserForm without first having the form open in VBA editor would tank the entire program.</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/any-code-in-userforminitialize-causes-excel-to/4663cba3-a39e-4964-8a09-3e6d4c093cfd?page=2\" rel=\"nofollow noreferrer\">Another thread</a> pointed out that Excel changed to loading forms in parallel, so when one piece finishes before the other it causes the whole thing to crash. Almost like your friend texting you \"here\" when they're still 3 blocks away, and if you head outside before they get to your house you die. Anyways.</p>\n\n<p>If you call your UserForm with a button, add this to the <code>Button_click()</code> sub.</p>\n\n<pre><code>ThisWorkbook.VBProject.VBComponents(\"UserForm\").Activate\n</code></pre>\n\n<p>It tells Excel to load the form as soon as you click the button, instead of loading everything that goes into the form first. This does essentially the same thing as opening a VBA window.</p>\n"}], "owner": {"reputation": 135, "user_id": 4564644, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/45ae4ead48ecc947cb1375e190b0a0ec?s=128&d=identicon&r=PG&f=1", "display_name": "offcenter35", "link": "https://stackoverflow.com/users/4564644/offcenter35"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3239, "favorite_count": 2, "accepted_answer_id": 36729562, "answer_count": 2, "score": -1, "last_activity_date": 1598461838, "creation_date": 1461095499, "last_edit_date": 1561797288, "question_id": 36728143, "link": "https://stackoverflow.com/questions/36728143/why-do-i-need-to-have-the-vba-editor-open-to-load-data-into-a-userform", "title": "Why do I need to have the VBA editor open to load data into a Userform?", "body": "<p>I have an Excel file in which a VBA macro loads data into a Userform.</p>\n\n<p>It will sometimes crash and close Excel if I run it without the editor open.</p>\n\n<p>How to fix my file so I don't need to first open the editor?</p>\n\n<p>Sample code from the macro:</p>\n\n<pre><code>Public Sub LoadButton_Click()  \n\n    'Policy Information  \n    ZoneLatitudeTextBox.Text = Sheets(\"Saved Policy Values\").Cells(2, 2)  \n    ZoneLongitudeTextBox.Text = Sheets(\"Saved Policy Values\").Cells(3, 2)  \n    TownClassComboBox.Text = Sheets(\"Saved Policy Values\").Cells(4, 2)  \n</code></pre>\n"}]